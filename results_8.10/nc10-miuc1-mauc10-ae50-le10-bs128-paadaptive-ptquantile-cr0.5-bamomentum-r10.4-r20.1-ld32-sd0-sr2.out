  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2388, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.4792, 'compress@10': 0.5263, 'time@10': 9.7976}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2388, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.4792, 'compress@10': 0.5263, 'time@10': 9.7976}:  10%|█         | 1/10 [00:04<00:44,  4.94s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1732, 'hit_ratio@10': 0.4907, 'ndcg@10': 0.5347, 'compress@10': 0.5212, 'time@10': 8.538}:  10%|█         | 1/10 [00:12<00:44,  4.94s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.1732, 'hit_ratio@10': 0.4907, 'ndcg@10': 0.5347, 'compress@10': 0.5212, 'time@10': 8.538}:  20%|██        | 2/10 [00:12<00:50,  6.34s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8344, 'hit_ratio@10': 0.47, 'ndcg@10': 0.3565, 'compress@10': 0.538, 'time@10': 6.6616}:  20%|██        | 2/10 [00:13<00:50,  6.34s/it]  {'epoch': 0, 'num_users': 5.0, 'loss': 0.8344, 'hit_ratio@10': 0.47, 'ndcg@10': 0.3565, 'compress@10': 0.538, 'time@10': 6.6616}:  30%|███       | 3/10 [00:13<00:28,  4.13s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6569, 'hit_ratio@10': 0.54, 'ndcg@10': 0.4104, 'compress@10': 0.5329, 'time@10': 6.6088}:  30%|███       | 3/10 [00:20<00:28,  4.13s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6569, 'hit_ratio@10': 0.54, 'ndcg@10': 0.4104, 'compress@10': 0.5329, 'time@10': 6.6088}:  40%|████      | 4/10 [00:20<00:30,  5.06s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5446, 'hit_ratio@10': 0.596, 'ndcg@10': 0.4753, 'compress@10': 0.5283, 'time@10': 10.0484}:  40%|████      | 4/10 [00:32<00:30,  5.06s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5446, 'hit_ratio@10': 0.596, 'ndcg@10': 0.4753, 'compress@10': 0.5283, 'time@10': 10.0484}:  50%|█████     | 5/10 [00:32<00:37,  7.54s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.47, 'hit_ratio@10': 0.6189, 'ndcg@10': 0.5178, 'compress@10': 0.5255, 'time@10': 10.1405}:  50%|█████     | 5/10 [00:42<00:37,  7.54s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.47, 'hit_ratio@10': 0.6189, 'ndcg@10': 0.5178, 'compress@10': 0.5255, 'time@10': 10.1405}:  60%|██████    | 6/10 [00:42<00:34,  8.60s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4215, 'hit_ratio@10': 0.6276, 'ndcg@10': 0.5235, 'compress@10': 0.5247, 'time@10': 10.3323}:  60%|██████    | 6/10 [00:48<00:34,  8.60s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4215, 'hit_ratio@10': 0.6276, 'ndcg@10': 0.5235, 'compress@10': 0.5247, 'time@10': 10.3323}:  70%|███████   | 7/10 [00:48<00:23,  7.67s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3759, 'hit_ratio@10': 0.6634, 'ndcg@10': 0.5536, 'compress@10': 0.5234, 'time@10': 10.0628}:  70%|███████   | 7/10 [00:56<00:23,  7.67s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3759, 'hit_ratio@10': 0.6634, 'ndcg@10': 0.5536, 'compress@10': 0.5234, 'time@10': 10.0628}:  80%|████████  | 8/10 [00:56<00:15,  7.85s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.34, 'hit_ratio@10': 0.6818, 'ndcg@10': 0.5927, 'compress@10': 0.5224, 'time@10': 10.758}:  80%|████████  | 8/10 [01:05<00:15,  7.85s/it]  {'epoch': 0, 'num_users': 6.3333, 'loss': 0.34, 'hit_ratio@10': 0.6818, 'ndcg@10': 0.5927, 'compress@10': 0.5224, 'time@10': 10.758}:  90%|█████████ | 9/10 [01:05<00:07,  7.96s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3117, 'hit_ratio@10': 0.7068, 'ndcg@10': 0.6141, 'compress@10': 0.5213, 'time@10': 10.8094}:  90%|█████████ | 9/10 [01:16<00:07,  7.96s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3117, 'hit_ratio@10': 0.7068, 'ndcg@10': 0.6141, 'compress@10': 0.5213, 'time@10': 10.8094}: 100%|██████████| 10/10 [01:16<00:00,  9.01s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3117, 'hit_ratio@10': 0.7068, 'ndcg@10': 0.6141, 'compress@10': 0.5213, 'time@10': 10.8094}: 100%|██████████| 10/10 [01:16<00:00,  7.64s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3117367326670013
Avg hit ratio: 0.7067904365018116
Avg ndcg: 0.6141274752276594
Avg compression ratio: 0.5212749006657823
Avg train time: 10.809434604644775
Std train time: 5.494119613650908
[0.75, 0.75, 0.75, 0.75, 0.25, 0.25, 0.75, 0.25, 0.25, 0.25]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0598, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8196, 'compress@10': 0.7632, 'time@10': 8.6794}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0598, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8196, 'compress@10': 0.7632, 'time@10': 8.6794}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0571, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.839, 'compress@10': 0.7606, 'time@10': 7.9472}:  10%|█         | 1/10 [00:11<00:39,  4.38s/it] {'epoch': 1, 'num_users': 7.0, 'loss': 0.0571, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.839, 'compress@10': 0.7606, 'time@10': 7.9472}:  20%|██        | 2/10 [00:11<00:48,  6.07s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0512, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.8102, 'compress@10': 0.769, 'time@10': 6.3409}:  20%|██        | 2/10 [00:13<00:48,  6.07s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0512, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.8102, 'compress@10': 0.769, 'time@10': 6.3409}:  30%|███       | 3/10 [00:13<00:28,  4.03s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0511, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8203, 'compress@10': 0.7665, 'time@10': 6.3596}:  30%|███       | 3/10 [00:19<00:28,  4.03s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0511, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8203, 'compress@10': 0.7665, 'time@10': 6.3596}:  40%|████      | 4/10 [00:19<00:29,  4.99s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0584, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.812, 'compress@10': 0.6662, 'time@10': 9.3168}:  40%|████      | 4/10 [00:30<00:29,  4.99s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.0584, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.812, 'compress@10': 0.6662, 'time@10': 9.3168}:  50%|█████     | 5/10 [00:30<00:35,  7.01s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0618, 'hit_ratio@10': 0.7803, 'ndcg@10': 0.8124, 'compress@10': 0.5996, 'time@10': 9.5298}:  50%|█████     | 5/10 [00:40<00:35,  7.01s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0618, 'hit_ratio@10': 0.7803, 'ndcg@10': 0.8124, 'compress@10': 0.5996, 'time@10': 9.5298}:  60%|██████    | 6/10 [00:40<00:32,  8.24s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0596, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8199, 'compress@10': 0.6225, 'time@10': 9.8021}:  60%|██████    | 6/10 [00:46<00:32,  8.24s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0596, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8199, 'compress@10': 0.6225, 'time@10': 9.8021}:  70%|███████   | 7/10 [00:46<00:22,  7.43s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0568, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8265, 'compress@10': 0.5786, 'time@10': 9.58}:  70%|███████   | 7/10 [00:54<00:22,  7.43s/it]   {'epoch': 1, 'num_users': 6.125, 'loss': 0.0568, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8265, 'compress@10': 0.5786, 'time@10': 9.58}:  80%|████████  | 8/10 [00:54<00:15,  7.63s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0545, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.8365, 'compress@10': 0.5445, 'time@10': 10.1389}:  80%|████████  | 8/10 [01:02<00:15,  7.63s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0545, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.8365, 'compress@10': 0.5445, 'time@10': 10.1389}:  90%|█████████ | 9/10 [01:02<00:07,  7.54s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0538, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8375, 'compress@10': 0.5167, 'time@10': 10.1646}:  90%|█████████ | 9/10 [01:12<00:07,  7.54s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0538, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8375, 'compress@10': 0.5167, 'time@10': 10.1646}: 100%|██████████| 10/10 [01:12<00:00,  8.44s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0538, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8375, 'compress@10': 0.5167, 'time@10': 10.1646}: 100%|██████████| 10/10 [01:12<00:00,  7.25s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05377929583645384
Avg hit ratio: 0.8201937296809962
Avg ndcg: 0.8374733162180894
Avg compression ratio: 0.5167406448284161
Avg train time: 10.164562273025513
Std train time: 4.703705021524103
[0.8333333333333334, 0.8333333333333334, 0.5, 0.8333333333333334, 0.5, 0.5, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8427, 'compress@10': 0.8421, 'time@10': 8.2249}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8427, 'compress@10': 0.8421, 'time@10': 8.2249}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.7657, 'ndcg@10': 0.8449, 'compress@10': 0.8404, 'time@10': 7.6563}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.7657, 'ndcg@10': 0.8449, 'compress@10': 0.8404, 'time@10': 7.6563}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0354, 'hit_ratio@10': 0.7009, 'ndcg@10': 0.8468, 'compress@10': 0.7507, 'time@10': 6.217}:  20%|██        | 2/10 [00:12<00:47,  5.90s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.0354, 'hit_ratio@10': 0.7009, 'ndcg@10': 0.8468, 'compress@10': 0.7507, 'time@10': 6.217}:  30%|███       | 3/10 [00:12<00:27,  3.98s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0389, 'hit_ratio@10': 0.7489, 'ndcg@10': 0.8449, 'compress@10': 0.7729, 'time@10': 6.227}:  30%|███       | 3/10 [00:19<00:27,  3.98s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0389, 'hit_ratio@10': 0.7489, 'ndcg@10': 0.8449, 'compress@10': 0.7729, 'time@10': 6.227}:  40%|████      | 4/10 [00:19<00:29,  4.90s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0483, 'hit_ratio@10': 0.7631, 'ndcg@10': 0.8333, 'compress@10': 0.7203, 'time@10': 8.7352}:  40%|████      | 4/10 [00:28<00:29,  4.90s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0483, 'hit_ratio@10': 0.7631, 'ndcg@10': 0.8333, 'compress@10': 0.7203, 'time@10': 8.7352}:  50%|█████     | 5/10 [00:28<00:32,  6.53s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0531, 'hit_ratio@10': 0.7582, 'ndcg@10': 0.8298, 'compress@10': 0.6854, 'time@10': 9.0407}:  50%|█████     | 5/10 [00:39<00:32,  6.53s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0531, 'hit_ratio@10': 0.7582, 'ndcg@10': 0.8298, 'compress@10': 0.6854, 'time@10': 9.0407}:  60%|██████    | 6/10 [00:39<00:31,  7.91s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0515, 'hit_ratio@10': 0.787, 'ndcg@10': 0.8335, 'compress@10': 0.6618, 'time@10': 9.4105}:  60%|██████    | 6/10 [00:45<00:31,  7.91s/it] {'epoch': 2, 'num_users': 6.2857, 'loss': 0.0515, 'hit_ratio@10': 0.787, 'ndcg@10': 0.8335, 'compress@10': 0.6618, 'time@10': 9.4105}:  70%|███████   | 7/10 [00:45<00:21,  7.24s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8029, 'ndcg@10': 0.8404, 'compress@10': 0.6029, 'time@10': 9.205}:  70%|███████   | 7/10 [00:52<00:21,  7.24s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8029, 'ndcg@10': 0.8404, 'compress@10': 0.6029, 'time@10': 9.205}:  80%|████████  | 8/10 [00:52<00:14,  7.42s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.7899, 'ndcg@10': 0.8486, 'compress@10': 0.5571, 'time@10': 9.7302}:  80%|████████  | 8/10 [00:59<00:14,  7.42s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.7899, 'ndcg@10': 0.8486, 'compress@10': 0.5571, 'time@10': 9.7302}:  90%|█████████ | 9/10 [00:59<00:07,  7.29s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0485, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.8491, 'compress@10': 0.5199, 'time@10': 9.7633}:  90%|█████████ | 9/10 [01:10<00:07,  7.29s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0485, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.8491, 'compress@10': 0.5199, 'time@10': 9.7633}: 100%|██████████| 10/10 [01:10<00:00,  8.16s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0485, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.8491, 'compress@10': 0.5199, 'time@10': 9.7633}: 100%|██████████| 10/10 [01:10<00:00,  7.01s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04853600601692395
Avg hit ratio: 0.8040846397518724
Avg ndcg: 0.8490908407553011
Avg compression ratio: 0.5199171295076624
Avg train time: 9.76326127052307
Std train time: 4.1203135222169935
[0.875, 0.875, 0.375, 0.875, 0.625, 0.625, 0.375, 0.125, 0.125, 0.125]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.8816, 'time@10': 7.9085}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.8816, 'time@10': 7.9085}:  10%|█         | 1/10 [00:04<00:36,  4.01s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8491, 'compress@10': 0.8803, 'time@10': 7.4542}:  10%|█         | 1/10 [00:11<00:36,  4.01s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8491, 'compress@10': 0.8803, 'time@10': 7.4542}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8518, 'compress@10': 0.7416, 'time@10': 6.1798}:  20%|██        | 2/10 [00:12<00:46,  5.80s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8518, 'compress@10': 0.7416, 'time@10': 6.1798}:  30%|███       | 3/10 [00:12<00:27,  4.00s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8506, 'compress@10': 0.7761, 'time@10': 6.1728}:  30%|███       | 3/10 [00:19<00:27,  4.00s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8506, 'compress@10': 0.7761, 'time@10': 6.1728}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.8391, 'compress@10': 0.7474, 'time@10': 8.2778}:  40%|████      | 4/10 [00:27<00:29,  4.86s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.8391, 'compress@10': 0.7474, 'time@10': 8.2778}:  50%|█████     | 5/10 [00:27<00:30,  6.14s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0515, 'hit_ratio@10': 0.7743, 'ndcg@10': 0.8353, 'compress@10': 0.7284, 'time@10': 8.6673}:  50%|█████     | 5/10 [00:38<00:30,  6.14s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0515, 'hit_ratio@10': 0.7743, 'ndcg@10': 0.8353, 'compress@10': 0.7284, 'time@10': 8.6673}:  60%|██████    | 6/10 [00:38<00:30,  7.67s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0506, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8353, 'compress@10': 0.6815, 'time@10': 9.0601}:  60%|██████    | 6/10 [00:43<00:30,  7.67s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0506, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8353, 'compress@10': 0.6815, 'time@10': 9.0601}:  70%|███████   | 7/10 [00:43<00:21,  7.04s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0512, 'hit_ratio@10': 0.815, 'ndcg@10': 0.8386, 'compress@10': 0.615, 'time@10': 8.8793}:  70%|███████   | 7/10 [00:51<00:21,  7.04s/it]   {'epoch': 3, 'num_users': 6.125, 'loss': 0.0512, 'hit_ratio@10': 0.815, 'ndcg@10': 0.8386, 'compress@10': 0.615, 'time@10': 8.8793}:  80%|████████  | 8/10 [00:51<00:14,  7.24s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0514, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8493, 'compress@10': 0.5634, 'time@10': 9.4413}:  80%|████████  | 8/10 [00:58<00:14,  7.24s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0514, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8493, 'compress@10': 0.5634, 'time@10': 9.4413}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0515, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.848, 'compress@10': 0.5215, 'time@10': 9.4566}:  90%|█████████ | 9/10 [01:08<00:07,  7.16s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.0515, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.848, 'compress@10': 0.5215, 'time@10': 9.4566}: 100%|██████████| 10/10 [01:08<00:00,  7.93s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0515, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.848, 'compress@10': 0.5215, 'time@10': 9.4566}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.051502280781457035
Avg hit ratio: 0.8251834620765012
Avg ndcg: 0.8480008932130711
Avg compression ratio: 0.5215052894423899
Avg train time: 9.456581258773804
Std train time: 3.666103316759883
[0.7, 0.9, 0.3, 0.7, 0.7, 0.7, 0.3, 0.3, 0.3, 0.1]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.7158, 'time@10': 8.6054}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.7158, 'time@10': 8.6054}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8497, 'compress@10': 0.8095, 'time@10': 7.8564}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8497, 'compress@10': 0.8095, 'time@10': 7.8564}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8522, 'compress@10': 0.673, 'time@10': 6.5584}:  20%|██        | 2/10 [00:13<00:47,  6.00s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8522, 'compress@10': 0.673, 'time@10': 6.5584}:  30%|███       | 3/10 [00:13<00:29,  4.18s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8503, 'compress@10': 0.6824, 'time@10': 6.5181}:  30%|███       | 3/10 [00:19<00:29,  4.18s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8503, 'compress@10': 0.6824, 'time@10': 6.5181}:  40%|████      | 4/10 [00:19<00:30,  5.07s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0465, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8372, 'compress@10': 0.6871, 'time@10': 8.0548}:  40%|████      | 4/10 [00:27<00:30,  5.07s/it]  {'epoch': 4, 'num_users': 5.8, 'loss': 0.0465, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8372, 'compress@10': 0.6871, 'time@10': 8.0548}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.7834, 'ndcg@10': 0.8348, 'compress@10': 0.6904, 'time@10': 8.4855}:  50%|█████     | 5/10 [00:37<00:29,  5.82s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.7834, 'ndcg@10': 0.8348, 'compress@10': 0.6904, 'time@10': 8.4855}:  60%|██████    | 6/10 [00:37<00:29,  7.47s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.05, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.838, 'compress@10': 0.6386, 'time@10': 8.9264}:  60%|██████    | 6/10 [00:43<00:29,  7.47s/it]   {'epoch': 4, 'num_users': 6.2857, 'loss': 0.05, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.838, 'compress@10': 0.6386, 'time@10': 8.9264}:  70%|███████   | 7/10 [00:43<00:20,  6.93s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8431, 'compress@10': 0.5988, 'time@10': 8.8249}:  70%|███████   | 7/10 [00:51<00:20,  6.93s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8431, 'compress@10': 0.5988, 'time@10': 8.8249}:  80%|████████  | 8/10 [00:51<00:14,  7.32s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8501, 'compress@10': 0.5678, 'time@10': 9.4843}:  80%|████████  | 8/10 [00:59<00:14,  7.32s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8501, 'compress@10': 0.5678, 'time@10': 9.4843}:  90%|█████████ | 9/10 [00:59<00:07,  7.35s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8495, 'compress@10': 0.5231, 'time@10': 9.5175}:  90%|█████████ | 9/10 [01:09<00:07,  7.35s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8495, 'compress@10': 0.5231, 'time@10': 9.5175}: 100%|██████████| 10/10 [01:09<00:00,  8.12s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8495, 'compress@10': 0.5231, 'time@10': 9.5175}: 100%|██████████| 10/10 [01:09<00:00,  6.90s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04884229174254196
Avg hit ratio: 0.8249172050360507
Avg ndcg: 0.849526067839524
Avg compression ratio: 0.5230822304096132
Avg train time: 9.517526364326477
Std train time: 3.2277995215020425
[0.5833333333333333, 0.9166666666666667, 0.25, 0.5833333333333333, 0.75, 0.75, 0.41666666666666663, 0.41666666666666663, 0.25, 0.08333333333333334]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8461, 'compress@10': 0.6053, 'time@10': 9.1182}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8461, 'compress@10': 0.6053, 'time@10': 9.1182}:  10%|█         | 1/10 [00:04<00:41,  4.59s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8439, 'compress@10': 0.7623, 'time@10': 8.0795}:  10%|█         | 1/10 [00:11<00:41,  4.59s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8439, 'compress@10': 0.7623, 'time@10': 8.0795}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8483, 'compress@10': 0.6272, 'time@10': 6.8183}:  20%|██        | 2/10 [00:13<00:48,  6.08s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8483, 'compress@10': 0.6272, 'time@10': 6.8183}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8436, 'compress@10': 0.62, 'time@10': 6.7415}:  30%|███       | 3/10 [00:20<00:30,  4.30s/it]  {'epoch': 5, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8436, 'compress@10': 0.62, 'time@10': 6.7415}:  40%|████      | 4/10 [00:20<00:31,  5.19s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0461, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8321, 'compress@10': 0.647, 'time@10': 8.0881}:  40%|████      | 4/10 [00:27<00:31,  5.19s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0461, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8321, 'compress@10': 0.647, 'time@10': 8.0881}:  50%|█████     | 5/10 [00:27<00:28,  5.76s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0491, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8313, 'compress@10': 0.6651, 'time@10': 8.5038}:  50%|█████     | 5/10 [00:37<00:28,  5.76s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0491, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8313, 'compress@10': 0.6651, 'time@10': 8.5038}:  60%|██████    | 6/10 [00:37<00:29,  7.41s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0481, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8336, 'compress@10': 0.6329, 'time@10': 8.9719}:  60%|██████    | 6/10 [00:43<00:29,  7.41s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0481, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8336, 'compress@10': 0.6329, 'time@10': 8.9719}:  70%|███████   | 7/10 [00:43<00:20,  6.93s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0487, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8372, 'compress@10': 0.608, 'time@10': 8.879}:  70%|███████   | 7/10 [00:52<00:20,  6.93s/it]   {'epoch': 5, 'num_users': 6.125, 'loss': 0.0487, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8372, 'compress@10': 0.608, 'time@10': 8.879}:  80%|████████  | 8/10 [00:52<00:14,  7.35s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8558, 'compress@10': 0.5706, 'time@10': 9.4883}:  80%|████████  | 8/10 [00:59<00:14,  7.35s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8558, 'compress@10': 0.5706, 'time@10': 9.4883}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.05, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8541, 'compress@10': 0.5239, 'time@10': 9.5204}:  90%|█████████ | 9/10 [01:09<00:07,  7.31s/it]     {'epoch': 5, 'num_users': 6.3, 'loss': 0.05, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8541, 'compress@10': 0.5239, 'time@10': 9.5204}: 100%|██████████| 10/10 [01:09<00:00,  8.09s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.05, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8541, 'compress@10': 0.5239, 'time@10': 9.5204}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.05000918252181008
Avg hit ratio: 0.8513688179392764
Avg ndcg: 0.854058718822596
Avg compression ratio: 0.5239428789727966
Avg train time: 9.520405101776124
Std train time: 2.995636412276258
[0.49999999999999994, 0.9285714285714286, 0.2142857142857143, 0.49999999999999994, 0.7857142857142857, 0.7857142857142857, 0.3571428571428571, 0.5, 0.35714285714285715, 0.07142857142857144]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.5263, 'time@10': 8.9568}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.5263, 'time@10': 8.9568}:  10%|█         | 1/10 [00:04<00:40,  4.52s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8514, 'compress@10': 0.7286, 'time@10': 7.9152}:  10%|█         | 1/10 [00:11<00:40,  4.52s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8514, 'compress@10': 0.7286, 'time@10': 7.9152}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8533, 'compress@10': 0.5946, 'time@10': 6.756}:  20%|██        | 2/10 [00:13<00:47,  5.93s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8533, 'compress@10': 0.5946, 'time@10': 6.756}:  30%|███       | 3/10 [00:13<00:29,  4.26s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0361, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8468, 'compress@10': 0.5754, 'time@10': 6.721}:  30%|███       | 3/10 [00:20<00:29,  4.26s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0361, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8468, 'compress@10': 0.5754, 'time@10': 6.721}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0451, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.835, 'compress@10': 0.6183, 'time@10': 8.0782}:  40%|████      | 4/10 [00:27<00:31,  5.21s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0451, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.835, 'compress@10': 0.6183, 'time@10': 8.0782}:  50%|█████     | 5/10 [00:27<00:28,  5.78s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0476, 'hit_ratio@10': 0.829, 'ndcg@10': 0.834, 'compress@10': 0.647, 'time@10': 8.4613}:  50%|█████     | 5/10 [00:37<00:28,  5.78s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0476, 'hit_ratio@10': 0.829, 'ndcg@10': 0.834, 'compress@10': 0.647, 'time@10': 8.4613}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0475, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8375, 'compress@10': 0.6093, 'time@10': 8.9284}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0475, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8375, 'compress@10': 0.6093, 'time@10': 8.9284}:  70%|███████   | 7/10 [00:43<00:20,  6.88s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0476, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.841, 'compress@10': 0.5974, 'time@10': 8.8464}:  70%|███████   | 7/10 [00:51<00:20,  6.88s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.0476, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.841, 'compress@10': 0.5974, 'time@10': 8.8464}:  80%|████████  | 8/10 [00:51<00:14,  7.34s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0477, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8463, 'compress@10': 0.5727, 'time@10': 9.4797}:  80%|████████  | 8/10 [00:59<00:14,  7.34s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0477, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8463, 'compress@10': 0.5727, 'time@10': 9.4797}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0468, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8473, 'compress@10': 0.5247, 'time@10': 9.508}:  90%|█████████ | 9/10 [01:08<00:07,  7.33s/it]    {'epoch': 6, 'num_users': 6.3, 'loss': 0.0468, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8473, 'compress@10': 0.5247, 'time@10': 9.508}: 100%|██████████| 10/10 [01:08<00:00,  8.10s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0468, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8473, 'compress@10': 0.5247, 'time@10': 9.508}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04682182566588462
Avg hit ratio: 0.8551783417488001
Avg ndcg: 0.8472562131012633
Avg compression ratio: 0.5247221250429468
Avg train time: 9.508026003837585
Std train time: 2.99960798537479
[0.43749999999999994, 0.8125, 0.1875, 0.5625, 0.8125, 0.8125, 0.31249999999999994, 0.5625, 0.4375, 0.06250000000000001]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8399, 'compress@10': 0.4671, 'time@10': 8.6162}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8399, 'compress@10': 0.4671, 'time@10': 8.6162}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8457, 'compress@10': 0.6428, 'time@10': 7.8089}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8457, 'compress@10': 0.6428, 'time@10': 7.8089}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8495, 'compress@10': 0.5297, 'time@10': 6.8234}:  20%|██        | 2/10 [00:13<00:47,  5.93s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8495, 'compress@10': 0.5297, 'time@10': 6.8234}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8433, 'compress@10': 0.5418, 'time@10': 6.7486}:  30%|███       | 3/10 [00:20<00:30,  4.35s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8433, 'compress@10': 0.5418, 'time@10': 6.7486}:  40%|████      | 4/10 [00:20<00:31,  5.22s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8324, 'compress@10': 0.5967, 'time@10': 8.1159}:  40%|████      | 4/10 [00:27<00:31,  5.22s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8324, 'compress@10': 0.5967, 'time@10': 8.1159}:  50%|█████     | 5/10 [00:27<00:29,  5.80s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.047, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8338, 'compress@10': 0.6334, 'time@10': 8.5382}:  50%|█████     | 5/10 [00:37<00:29,  5.80s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.047, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8338, 'compress@10': 0.6334, 'time@10': 8.5382}:  60%|██████    | 6/10 [00:37<00:29,  7.46s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0457, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8362, 'compress@10': 0.5915, 'time@10': 8.948}:  60%|██████    | 6/10 [00:43<00:29,  7.46s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0457, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8362, 'compress@10': 0.5915, 'time@10': 8.948}:  70%|███████   | 7/10 [00:43<00:20,  6.90s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0454, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8414, 'compress@10': 0.5894, 'time@10': 8.8607}:  70%|███████   | 7/10 [00:51<00:20,  6.90s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0454, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8414, 'compress@10': 0.5894, 'time@10': 8.8607}:  80%|████████  | 8/10 [00:51<00:14,  7.34s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0467, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8648, 'compress@10': 0.5743, 'time@10': 9.5479}:  80%|████████  | 8/10 [00:59<00:14,  7.34s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0467, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8648, 'compress@10': 0.5743, 'time@10': 9.5479}:  90%|█████████ | 9/10 [00:59<00:07,  7.41s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.046, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8656, 'compress@10': 0.5253, 'time@10': 9.5668}:  90%|█████████ | 9/10 [01:09<00:07,  7.41s/it]    {'epoch': 7, 'num_users': 6.3, 'loss': 0.046, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8656, 'compress@10': 0.5253, 'time@10': 9.5668}: 100%|██████████| 10/10 [01:09<00:00,  8.14s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.046, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8656, 'compress@10': 0.5253, 'time@10': 9.5668}: 100%|██████████| 10/10 [01:09<00:00,  6.93s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04596984559752541
Avg hit ratio: 0.8579395482842003
Avg ndcg: 0.8655786886361423
Avg compression ratio: 0.5252616802490231
Avg train time: 9.56675853729248
Std train time: 3.0240074868627045
[0.49999999999999994, 0.7222222222222222, 0.16666666666666666, 0.6111111111111112, 0.8333333333333334, 0.8333333333333334, 0.27777777777777773, 0.5, 0.5, 0.055555555555555566]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8503, 'compress@10': 0.5263, 'time@10': 8.6617}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8503, 'compress@10': 0.5263, 'time@10': 8.6617}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8623, 'compress@10': 0.6287, 'time@10': 7.8809}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8623, 'compress@10': 0.6287, 'time@10': 7.8809}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8606, 'compress@10': 0.5144, 'time@10': 6.9857}:  20%|██        | 2/10 [00:14<00:47,  6.00s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8606, 'compress@10': 0.5144, 'time@10': 6.9857}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.8484, 'compress@10': 0.5421, 'time@10': 6.8328}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.8484, 'compress@10': 0.5421, 'time@10': 6.8328}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0445, 'hit_ratio@10': 0.7889, 'ndcg@10': 0.8364, 'compress@10': 0.601, 'time@10': 8.1941}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it] {'epoch': 8, 'num_users': 5.8, 'loss': 0.0445, 'hit_ratio@10': 0.7889, 'ndcg@10': 0.8364, 'compress@10': 0.601, 'time@10': 8.1941}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0457, 'hit_ratio@10': 0.8093, 'ndcg@10': 0.8379, 'compress@10': 0.6403, 'time@10': 8.5713}:  50%|█████     | 5/10 [00:37<00:29,  5.82s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0457, 'hit_ratio@10': 0.8093, 'ndcg@10': 0.8379, 'compress@10': 0.6403, 'time@10': 8.5713}:  60%|██████    | 6/10 [00:37<00:29,  7.41s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0457, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8443, 'compress@10': 0.5926, 'time@10': 9.0204}:  60%|██████    | 6/10 [00:43<00:29,  7.41s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0457, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8443, 'compress@10': 0.5926, 'time@10': 9.0204}:  70%|███████   | 7/10 [00:43<00:20,  6.92s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0449, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8502, 'compress@10': 0.5829, 'time@10': 8.9153}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0449, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8502, 'compress@10': 0.5829, 'time@10': 8.9153}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0447, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8555, 'compress@10': 0.5752, 'time@10': 9.5614}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0447, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8555, 'compress@10': 0.5752, 'time@10': 9.5614}:  90%|█████████ | 9/10 [00:59<00:07,  7.35s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.044, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8563, 'compress@10': 0.5254, 'time@10': 9.5709}:  90%|█████████ | 9/10 [01:09<00:07,  7.35s/it]    {'epoch': 8, 'num_users': 6.3, 'loss': 0.044, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8563, 'compress@10': 0.5254, 'time@10': 9.5709}: 100%|██████████| 10/10 [01:09<00:00,  8.08s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.044, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8563, 'compress@10': 0.5254, 'time@10': 9.5709}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04398012503218214
Avg hit ratio: 0.8484669420374005
Avg ndcg: 0.8563177832609947
Avg compression ratio: 0.52541407452752
Avg train time: 9.57085702419281
Std train time: 2.9460923653553834
[0.5499999999999999, 0.65, 0.15, 0.65, 0.8500000000000001, 0.8500000000000001, 0.35, 0.45, 0.45, 0.05000000000000001]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8429, 'compress@10': 0.5737, 'time@10': 8.5785}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8429, 'compress@10': 0.5737, 'time@10': 8.5785}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.856, 'compress@10': 0.6175, 'time@10': 7.9141}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it] {'epoch': 9, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.856, 'compress@10': 0.6175, 'time@10': 7.9141}:  20%|██        | 2/10 [00:11<00:48,  6.07s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8564, 'compress@10': 0.5021, 'time@10': 7.0094}:  20%|██        | 2/10 [00:14<00:48,  6.07s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8564, 'compress@10': 0.5021, 'time@10': 7.0094}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.8434, 'compress@10': 0.5422, 'time@10': 6.8941}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.8434, 'compress@10': 0.5422, 'time@10': 6.8941}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0421, 'hit_ratio@10': 0.7889, 'ndcg@10': 0.8337, 'compress@10': 0.6044, 'time@10': 8.228}:  40%|████      | 4/10 [00:27<00:31,  5.32s/it] {'epoch': 9, 'num_users': 5.8, 'loss': 0.0421, 'hit_ratio@10': 0.7889, 'ndcg@10': 0.8337, 'compress@10': 0.6044, 'time@10': 8.228}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0429, 'hit_ratio@10': 0.8093, 'ndcg@10': 0.8375, 'compress@10': 0.6459, 'time@10': 8.5669}:  50%|█████     | 5/10 [00:37<00:29,  5.86s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0429, 'hit_ratio@10': 0.8093, 'ndcg@10': 0.8375, 'compress@10': 0.6459, 'time@10': 8.5669}:  60%|██████    | 6/10 [00:37<00:29,  7.37s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0429, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8378, 'compress@10': 0.6073, 'time@10': 8.9949}:  60%|██████    | 6/10 [00:43<00:29,  7.37s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0429, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8378, 'compress@10': 0.6073, 'time@10': 8.9949}:  70%|███████   | 7/10 [00:43<00:20,  6.86s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0424, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8421, 'compress@10': 0.5896, 'time@10': 8.8873}:  70%|███████   | 7/10 [00:51<00:20,  6.86s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0424, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8421, 'compress@10': 0.5896, 'time@10': 8.8873}:  80%|████████  | 8/10 [00:51<00:14,  7.28s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0413, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8529, 'compress@10': 0.5758, 'time@10': 9.5615}:  80%|████████  | 8/10 [00:59<00:14,  7.28s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0413, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8529, 'compress@10': 0.5758, 'time@10': 9.5615}:  90%|█████████ | 9/10 [00:59<00:07,  7.35s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.858, 'compress@10': 0.5254, 'time@10': 9.5436}:  90%|█████████ | 9/10 [01:08<00:07,  7.35s/it]    {'epoch': 9, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.858, 'compress@10': 0.5254, 'time@10': 9.5436}: 100%|██████████| 10/10 [01:08<00:00,  7.99s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.858, 'compress@10': 0.5254, 'time@10': 9.5436}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.04072750408968091
Avg hit ratio: 0.8513240848945433
Avg ndcg: 0.8579554788742445
Avg compression ratio: 0.5254221320916663
Avg train time: 9.543642711639404
Std train time: 2.9340585424796055
[0.5909090909090908, 0.5909090909090909, 0.13636363636363635, 0.6818181818181819, 0.8636363636363638, 0.8636363636363638, 0.40909090909090906, 0.4090909090909091, 0.4090909090909091, 0.04545454545454546]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8534, 'compress@10': 0.6124, 'time@10': 8.6589}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8534, 'compress@10': 0.6124, 'time@10': 8.6589}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8671, 'compress@10': 0.6083, 'time@10': 7.8931}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8671, 'compress@10': 0.6083, 'time@10': 7.8931}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8638, 'compress@10': 0.4921, 'time@10': 7.1918}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8638, 'compress@10': 0.4921, 'time@10': 7.1918}:  30%|███       | 3/10 [00:14<00:32,  4.61s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.7901, 'ndcg@10': 0.8559, 'compress@10': 0.5424, 'time@10': 7.0026}:  30%|███       | 3/10 [00:20<00:32,  4.61s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.7901, 'ndcg@10': 0.8559, 'compress@10': 0.5424, 'time@10': 7.0026}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.04, 'hit_ratio@10': 0.8001, 'ndcg@10': 0.8449, 'compress@10': 0.6072, 'time@10': 8.3285}:  40%|████      | 4/10 [00:27<00:32,  5.34s/it]  {'epoch': 10, 'num_users': 5.8, 'loss': 0.04, 'hit_ratio@10': 0.8001, 'ndcg@10': 0.8449, 'compress@10': 0.6072, 'time@10': 8.3285}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0404, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8475, 'compress@10': 0.6504, 'time@10': 8.6599}:  50%|█████     | 5/10 [00:38<00:29,  5.89s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0404, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8475, 'compress@10': 0.6504, 'time@10': 8.6599}:  60%|██████    | 6/10 [00:38<00:29,  7.41s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0411, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8528, 'compress@10': 0.6193, 'time@10': 9.0479}:  60%|██████    | 6/10 [00:43<00:29,  7.41s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0411, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8528, 'compress@10': 0.6193, 'time@10': 9.0479}:  70%|███████   | 7/10 [00:43<00:20,  6.86s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0403, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8561, 'compress@10': 0.5951, 'time@10': 8.9205}:  70%|███████   | 7/10 [00:51<00:20,  6.86s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0403, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8561, 'compress@10': 0.5951, 'time@10': 8.9205}:  80%|████████  | 8/10 [00:51<00:14,  7.24s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0404, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8675, 'compress@10': 0.5763, 'time@10': 9.5772}:  80%|████████  | 8/10 [00:59<00:14,  7.24s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0404, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8675, 'compress@10': 0.5763, 'time@10': 9.5772}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.04, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8687, 'compress@10': 0.5254, 'time@10': 9.5327}:  90%|█████████ | 9/10 [01:08<00:07,  7.31s/it]    {'epoch': 10, 'num_users': 6.3, 'loss': 0.04, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8687, 'compress@10': 0.5254, 'time@10': 9.5327}: 100%|██████████| 10/10 [01:08<00:00,  7.88s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.04, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8687, 'compress@10': 0.5254, 'time@10': 9.5327}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.04003391078625255
Avg hit ratio: 0.8568955134659719
Avg ndcg: 0.8687372285642075
Avg compression ratio: 0.5254294436623891
Avg train time: 9.532679677009583
Std train time: 2.8543226064124276
[0.6249999999999999, 0.5416666666666667, 0.12499999999999999, 0.7083333333333334, 0.8750000000000001, 0.8750000000000001, 0.4583333333333333, 0.375, 0.375, 0.04166666666666667]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0429, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8538, 'compress@10': 0.6447, 'time@10': 8.8417}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0429, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8538, 'compress@10': 0.6447, 'time@10': 8.8417}:  10%|█         | 1/10 [00:04<00:40,  4.46s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8684, 'compress@10': 0.6006, 'time@10': 8.0364}:  10%|█         | 1/10 [00:11<00:40,  4.46s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8684, 'compress@10': 0.6006, 'time@10': 8.0364}:  20%|██        | 2/10 [00:11<00:48,  6.11s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8646, 'compress@10': 0.4837, 'time@10': 7.2319}:  20%|██        | 2/10 [00:14<00:48,  6.11s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8646, 'compress@10': 0.4837, 'time@10': 7.2319}:  30%|███       | 3/10 [00:14<00:32,  4.62s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0296, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8649, 'compress@10': 0.5425, 'time@10': 6.965}:  30%|███       | 3/10 [00:20<00:32,  4.62s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0296, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8649, 'compress@10': 0.5425, 'time@10': 6.965}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.037, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8525, 'compress@10': 0.6095, 'time@10': 8.2812}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.037, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8525, 'compress@10': 0.6095, 'time@10': 8.2812}:  50%|█████     | 5/10 [00:27<00:29,  5.81s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0373, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8553, 'compress@10': 0.6542, 'time@10': 8.6212}:  50%|█████     | 5/10 [00:37<00:29,  5.81s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0373, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8553, 'compress@10': 0.6542, 'time@10': 8.6212}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.037, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8536, 'compress@10': 0.6293, 'time@10': 9.0145}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it] {'epoch': 11, 'num_users': 6.2857, 'loss': 0.037, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8536, 'compress@10': 0.6293, 'time@10': 9.0145}:  70%|███████   | 7/10 [00:43<00:20,  6.82s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0361, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8573, 'compress@10': 0.5998, 'time@10': 8.8748}:  70%|███████   | 7/10 [00:51<00:20,  6.82s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0361, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8573, 'compress@10': 0.5998, 'time@10': 8.8748}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0361, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8655, 'compress@10': 0.5768, 'time@10': 9.5042}:  80%|████████  | 8/10 [00:58<00:14,  7.18s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0361, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8655, 'compress@10': 0.5768, 'time@10': 9.5042}:  90%|█████████ | 9/10 [00:58<00:07,  7.22s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0347, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8709, 'compress@10': 0.5254, 'time@10': 9.4445}:  90%|█████████ | 9/10 [01:07<00:07,  7.22s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0347, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8709, 'compress@10': 0.5254, 'time@10': 9.4445}: 100%|██████████| 10/10 [01:07<00:00,  7.75s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0347, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8709, 'compress@10': 0.5254, 'time@10': 9.4445}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.034713092674894516
Avg hit ratio: 0.8768190343894927
Avg ndcg: 0.8708907988828338
Avg compression ratio: 0.5254346942609492
Avg train time: 9.444507479667664
Std train time: 2.8388095119497048
[0.6538461538461537, 0.5000000000000001, 0.11538461538461538, 0.7307692307692308, 0.8846153846153847, 0.8846153846153847, 0.4230769230769231, 0.34615384615384615, 0.4230769230769231, 0.038461538461538464]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8375, 'compress@10': 0.6721, 'time@10': 8.7098}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8375, 'compress@10': 0.6721, 'time@10': 8.7098}:  10%|█         | 1/10 [00:04<00:39,  4.39s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.041, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8624, 'compress@10': 0.5941, 'time@10': 7.9908}:  10%|█         | 1/10 [00:11<00:39,  4.39s/it] {'epoch': 12, 'num_users': 7.0, 'loss': 0.041, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8624, 'compress@10': 0.5941, 'time@10': 7.9908}:  20%|██        | 2/10 [00:11<00:48,  6.11s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8607, 'compress@10': 0.4767, 'time@10': 7.1142}:  20%|██        | 2/10 [00:14<00:48,  6.11s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8607, 'compress@10': 0.4767, 'time@10': 7.1142}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8592, 'compress@10': 0.5426, 'time@10': 6.8803}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8592, 'compress@10': 0.5426, 'time@10': 6.8803}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8495, 'compress@10': 0.6114, 'time@10': 8.277}:  40%|████      | 4/10 [00:27<00:31,  5.21s/it] {'epoch': 12, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8495, 'compress@10': 0.6114, 'time@10': 8.277}:  50%|█████     | 5/10 [00:27<00:29,  5.85s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.038, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8544, 'compress@10': 0.6574, 'time@10': 8.4931}:  50%|█████     | 5/10 [00:37<00:29,  5.85s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.038, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8544, 'compress@10': 0.6574, 'time@10': 8.4931}:  60%|██████    | 6/10 [00:37<00:28,  7.13s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0376, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8601, 'compress@10': 0.6272, 'time@10': 8.9204}:  60%|██████    | 6/10 [00:42<00:28,  7.13s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0376, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8601, 'compress@10': 0.6272, 'time@10': 8.9204}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0361, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8648, 'compress@10': 0.5944, 'time@10': 8.799}:  70%|███████   | 7/10 [00:50<00:20,  6.69s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.0361, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8648, 'compress@10': 0.5944, 'time@10': 8.799}:  80%|████████  | 8/10 [00:50<00:14,  7.10s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0351, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8721, 'compress@10': 0.5772, 'time@10': 9.4357}:  80%|████████  | 8/10 [00:58<00:14,  7.10s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0351, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8721, 'compress@10': 0.5772, 'time@10': 9.4357}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0348, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8739, 'compress@10': 0.5255, 'time@10': 9.3944}:  90%|█████████ | 9/10 [01:07<00:07,  7.16s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0348, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8739, 'compress@10': 0.5255, 'time@10': 9.3944}: 100%|██████████| 10/10 [01:07<00:00,  7.75s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0348, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8739, 'compress@10': 0.5255, 'time@10': 9.3944}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03475973284859025
Avg hit ratio: 0.8666097991802575
Avg ndcg: 0.8738730309124552
Avg compression ratio: 0.5255284216165721
Avg train time: 9.394435954093932
Std train time: 2.9077380539315736
[0.6785714285714285, 0.4642857142857144, 0.10714285714285714, 0.7500000000000001, 0.8928571428571429, 0.8928571428571429, 0.4642857142857143, 0.3214285714285714, 0.39285714285714285, 0.03571428571428572]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.842, 'compress@10': 0.6955, 'time@10': 8.3823}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.842, 'compress@10': 0.6955, 'time@10': 8.3823}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0395, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8694, 'compress@10': 0.5885, 'time@10': 7.8101}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0395, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8694, 'compress@10': 0.5885, 'time@10': 7.8101}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8653, 'compress@10': 0.4706, 'time@10': 7.1633}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8653, 'compress@10': 0.4706, 'time@10': 7.1633}:  30%|███       | 3/10 [00:14<00:32,  4.63s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8627, 'compress@10': 0.5427, 'time@10': 6.9485}:  30%|███       | 3/10 [00:20<00:32,  4.63s/it]  {'epoch': 13, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8627, 'compress@10': 0.5427, 'time@10': 6.9485}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0363, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8524, 'compress@10': 0.6131, 'time@10': 8.2897}:  40%|████      | 4/10 [00:27<00:31,  5.30s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0363, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8524, 'compress@10': 0.6131, 'time@10': 8.2897}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0365, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8574, 'compress@10': 0.6601, 'time@10': 8.5113}:  50%|█████     | 5/10 [00:37<00:29,  5.87s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0365, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8574, 'compress@10': 0.6601, 'time@10': 8.5113}:  60%|██████    | 6/10 [00:37<00:28,  7.16s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0355, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.86, 'compress@10': 0.6352, 'time@10': 9.0479}:  60%|██████    | 6/10 [00:43<00:28,  7.16s/it]  {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0355, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.86, 'compress@10': 0.6352, 'time@10': 9.0479}:  70%|███████   | 7/10 [00:43<00:20,  6.84s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0342, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8647, 'compress@10': 0.5984, 'time@10': 8.9182}:  70%|███████   | 7/10 [00:51<00:20,  6.84s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0342, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8647, 'compress@10': 0.5984, 'time@10': 8.9182}:  80%|████████  | 8/10 [00:51<00:14,  7.22s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0338, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8731, 'compress@10': 0.5775, 'time@10': 9.5433}:  80%|████████  | 8/10 [00:58<00:14,  7.22s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0338, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8731, 'compress@10': 0.5775, 'time@10': 9.5433}:  90%|█████████ | 9/10 [00:58<00:07,  7.25s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8783, 'compress@10': 0.5255, 'time@10': 9.4773}:  90%|█████████ | 9/10 [01:07<00:07,  7.25s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8783, 'compress@10': 0.5255, 'time@10': 9.4773}: 100%|██████████| 10/10 [01:07<00:00,  7.76s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8783, 'compress@10': 0.5255, 'time@10': 9.4773}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.032539858560914604
Avg hit ratio: 0.8774539550244134
Avg ndcg: 0.8782645306254301
Avg compression ratio: 0.5255258878869149
Avg train time: 9.477346324920655
Std train time: 2.876254608479094
[0.7, 0.43333333333333346, 0.09999999999999999, 0.7666666666666667, 0.9, 0.9, 0.43333333333333335, 0.3, 0.43333333333333335, 0.03333333333333334]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8498, 'compress@10': 0.7158, 'time@10': 8.1562}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8498, 'compress@10': 0.7158, 'time@10': 8.1562}:  10%|█         | 1/10 [00:04<00:37,  4.12s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.873, 'compress@10': 0.5837, 'time@10': 7.7892}:  10%|█         | 1/10 [00:11<00:37,  4.12s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.873, 'compress@10': 0.5837, 'time@10': 7.7892}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8677, 'compress@10': 0.4653, 'time@10': 7.1184}:  20%|██        | 2/10 [00:14<00:48,  6.08s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8677, 'compress@10': 0.4653, 'time@10': 7.1184}:  30%|███       | 3/10 [00:14<00:32,  4.64s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8672, 'compress@10': 0.5427, 'time@10': 6.8951}:  30%|███       | 3/10 [00:20<00:32,  4.64s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8672, 'compress@10': 0.5427, 'time@10': 6.8951}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0335, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.856, 'compress@10': 0.6146, 'time@10': 8.2244}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it] {'epoch': 14, 'num_users': 5.8, 'loss': 0.0335, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.856, 'compress@10': 0.6146, 'time@10': 8.2244}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0332, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.86, 'compress@10': 0.6625, 'time@10': 8.4352}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0332, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.86, 'compress@10': 0.6625, 'time@10': 8.4352}:  60%|██████    | 6/10 [00:37<00:28,  7.09s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0326, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8665, 'compress@10': 0.633, 'time@10': 8.8559}:  60%|██████    | 6/10 [00:42<00:28,  7.09s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0326, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8665, 'compress@10': 0.633, 'time@10': 8.8559}:  70%|███████   | 7/10 [00:42<00:19,  6.65s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0315, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8724, 'compress@10': 0.5939, 'time@10': 8.7424}:  70%|███████   | 7/10 [00:50<00:19,  6.65s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0315, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8724, 'compress@10': 0.5939, 'time@10': 8.7424}:  80%|████████  | 8/10 [00:50<00:14,  7.07s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0313, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8799, 'compress@10': 0.5779, 'time@10': 9.3923}:  80%|████████  | 8/10 [00:58<00:14,  7.07s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0313, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8799, 'compress@10': 0.5779, 'time@10': 9.3923}:  90%|█████████ | 9/10 [00:58<00:07,  7.15s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0311, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8818, 'compress@10': 0.5256, 'time@10': 9.3374}:  90%|█████████ | 9/10 [01:07<00:07,  7.15s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0311, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8818, 'compress@10': 0.5256, 'time@10': 9.3374}: 100%|██████████| 10/10 [01:07<00:00,  7.69s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0311, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8818, 'compress@10': 0.5256, 'time@10': 9.3374}: 100%|██████████| 10/10 [01:07<00:00,  6.70s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.031110865675798804
Avg hit ratio: 0.8765463071167655
Avg ndcg: 0.8818228359054837
Avg compression ratio: 0.5255993599728145
Avg train time: 9.337371373176575
Std train time: 2.8121112945358173
[0.71875, 0.4062500000000001, 0.09374999999999999, 0.78125, 0.90625, 0.90625, 0.40625, 0.28125, 0.40625, 0.09375]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8681, 'compress@10': 0.7335, 'time@10': 8.4115}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8681, 'compress@10': 0.7335, 'time@10': 8.4115}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8848, 'compress@10': 0.5795, 'time@10': 7.8036}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8848, 'compress@10': 0.5795, 'time@10': 7.8036}:  20%|██        | 2/10 [00:11<00:48,  6.00s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8756, 'compress@10': 0.4607, 'time@10': 7.1556}:  20%|██        | 2/10 [00:14<00:48,  6.00s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8756, 'compress@10': 0.4607, 'time@10': 7.1556}:  30%|███       | 3/10 [00:14<00:32,  4.62s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8753, 'compress@10': 0.5428, 'time@10': 6.9523}:  30%|███       | 3/10 [00:20<00:32,  4.62s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8753, 'compress@10': 0.5428, 'time@10': 6.9523}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8631, 'compress@10': 0.6159, 'time@10': 8.3008}:  40%|████      | 4/10 [00:27<00:31,  5.31s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8631, 'compress@10': 0.6159, 'time@10': 8.3008}:  50%|█████     | 5/10 [00:27<00:29,  5.88s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0296, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8679, 'compress@10': 0.6646, 'time@10': 8.5369}:  50%|█████     | 5/10 [00:37<00:29,  5.88s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0296, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8679, 'compress@10': 0.6646, 'time@10': 8.5369}:  60%|██████    | 6/10 [00:37<00:28,  7.20s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0295, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8712, 'compress@10': 0.6311, 'time@10': 9.0305}:  60%|██████    | 6/10 [00:43<00:28,  7.20s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0295, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8712, 'compress@10': 0.6311, 'time@10': 9.0305}:  70%|███████   | 7/10 [00:43<00:20,  6.82s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.8757, 'compress@10': 0.5899, 'time@10': 8.892}:  70%|███████   | 7/10 [00:51<00:20,  6.82s/it]  {'epoch': 15, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.8757, 'compress@10': 0.5899, 'time@10': 8.892}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0299, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.895, 'compress@10': 0.5714, 'time@10': 9.5694}:  80%|████████  | 8/10 [00:58<00:14,  7.18s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0299, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.895, 'compress@10': 0.5714, 'time@10': 9.5694}:  90%|█████████ | 9/10 [00:58<00:07,  7.29s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8996, 'compress@10': 0.5257, 'time@10': 9.6163}:  90%|█████████ | 9/10 [01:09<00:07,  7.29s/it]  {'epoch': 15, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8996, 'compress@10': 0.5257, 'time@10': 9.6163}: 100%|██████████| 10/10 [01:09<00:00,  8.15s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8996, 'compress@10': 0.5257, 'time@10': 9.6163}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.02806321814926945
Avg hit ratio: 0.8863044145064519
Avg ndcg: 0.8996058251042734
Avg compression ratio: 0.5257014863192898
Avg train time: 9.616284251213074
Std train time: 2.938446704446804
[0.7352941176470589, 0.3823529411764707, 0.08823529411764705, 0.7941176470588235, 0.9117647058823529, 0.8529411764705882, 0.4411764705882353, 0.2647058823529412, 0.4411764705882353, 0.08823529411764706]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8822, 'compress@10': 0.7492, 'time@10': 8.3613}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8822, 'compress@10': 0.7492, 'time@10': 8.3613}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.893, 'compress@10': 0.5757, 'time@10': 7.8266}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it] {'epoch': 16, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.893, 'compress@10': 0.5757, 'time@10': 7.8266}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8811, 'compress@10': 0.4567, 'time@10': 7.1045}:  20%|██        | 2/10 [00:14<00:48,  6.05s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8811, 'compress@10': 0.4567, 'time@10': 7.1045}:  30%|███       | 3/10 [00:14<00:32,  4.60s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8798, 'compress@10': 0.5429, 'time@10': 6.8969}:  30%|███       | 3/10 [00:20<00:32,  4.60s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8798, 'compress@10': 0.5429, 'time@10': 6.8969}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0298, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8682, 'compress@10': 0.617, 'time@10': 8.2339}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0298, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8682, 'compress@10': 0.617, 'time@10': 8.2339}:  50%|█████     | 5/10 [00:27<00:29,  5.83s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0308, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.872, 'compress@10': 0.6569, 'time@10': 8.5014}:  50%|█████     | 5/10 [00:37<00:29,  5.83s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0308, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.872, 'compress@10': 0.6569, 'time@10': 8.5014}:  60%|██████    | 6/10 [00:37<00:28,  7.21s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0299, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8761, 'compress@10': 0.6292, 'time@10': 8.9182}:  60%|██████    | 6/10 [00:43<00:28,  7.21s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0299, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8761, 'compress@10': 0.6292, 'time@10': 8.9182}:  70%|███████   | 7/10 [00:43<00:20,  6.73s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0293, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.8807, 'compress@10': 0.5863, 'time@10': 8.8011}:  70%|███████   | 7/10 [00:51<00:20,  6.73s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0293, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.8807, 'compress@10': 0.5863, 'time@10': 8.8011}:  80%|████████  | 8/10 [00:51<00:14,  7.14s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9075, 'compress@10': 0.5719, 'time@10': 9.4763}:  80%|████████  | 8/10 [00:58<00:14,  7.14s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9075, 'compress@10': 0.5719, 'time@10': 9.4763}:  90%|█████████ | 9/10 [00:58<00:07,  7.25s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9108, 'compress@10': 0.5257, 'time@10': 9.5237}:  90%|█████████ | 9/10 [01:08<00:07,  7.25s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9108, 'compress@10': 0.5257, 'time@10': 9.5237}: 100%|██████████| 10/10 [01:08<00:00,  8.09s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9108, 'compress@10': 0.5257, 'time@10': 9.5237}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.030653396094459606
Avg hit ratio: 0.8863044145064519
Avg ndcg: 0.910774847210759
Avg compression ratio: 0.5256502933741697
Avg train time: 9.523743510246277
Std train time: 2.884404972433252
[0.75, 0.3611111111111112, 0.08333333333333333, 0.8055555555555555, 0.9166666666666666, 0.861111111111111, 0.41666666666666663, 0.25, 0.4722222222222222, 0.08333333333333334]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0521, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8545, 'compress@10': 0.7632, 'time@10': 8.5612}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0521, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8545, 'compress@10': 0.7632, 'time@10': 8.5612}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8812, 'compress@10': 0.5724, 'time@10': 7.9875}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8812, 'compress@10': 0.5724, 'time@10': 7.9875}:  20%|██        | 2/10 [00:11<00:49,  6.17s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8732, 'compress@10': 0.4531, 'time@10': 7.3298}:  20%|██        | 2/10 [00:14<00:49,  6.17s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8732, 'compress@10': 0.4531, 'time@10': 7.3298}:  30%|███       | 3/10 [00:14<00:33,  4.75s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8714, 'compress@10': 0.5429, 'time@10': 7.0546}:  30%|███       | 3/10 [00:21<00:33,  4.75s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8714, 'compress@10': 0.5429, 'time@10': 7.0546}:  40%|████      | 4/10 [00:21<00:32,  5.35s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0325, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8623, 'compress@10': 0.618, 'time@10': 8.339}:  40%|████      | 4/10 [00:27<00:32,  5.35s/it] {'epoch': 17, 'num_users': 5.8, 'loss': 0.0325, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8623, 'compress@10': 0.618, 'time@10': 8.339}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0321, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8729, 'compress@10': 0.659, 'time@10': 8.5833}:  50%|█████     | 5/10 [00:37<00:29,  5.86s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0321, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8729, 'compress@10': 0.659, 'time@10': 8.5833}:  60%|██████    | 6/10 [00:37<00:28,  7.22s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0315, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8773, 'compress@10': 0.6277, 'time@10': 9.0004}:  60%|██████    | 6/10 [00:43<00:28,  7.22s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0315, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8773, 'compress@10': 0.6277, 'time@10': 9.0004}:  70%|███████   | 7/10 [00:43<00:20,  6.75s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0305, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8816, 'compress@10': 0.5832, 'time@10': 8.8536}:  70%|███████   | 7/10 [00:51<00:20,  6.75s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0305, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8816, 'compress@10': 0.5832, 'time@10': 8.8536}:  80%|████████  | 8/10 [00:51<00:14,  7.10s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0317, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8903, 'compress@10': 0.5725, 'time@10': 9.5013}:  80%|████████  | 8/10 [00:58<00:14,  7.10s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0317, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8903, 'compress@10': 0.5725, 'time@10': 9.5013}:  90%|█████████ | 9/10 [00:58<00:07,  7.19s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0309, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8934, 'compress@10': 0.5257, 'time@10': 9.5482}:  90%|█████████ | 9/10 [01:08<00:07,  7.19s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0309, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8934, 'compress@10': 0.5257, 'time@10': 9.5482}: 100%|██████████| 10/10 [01:08<00:00,  8.06s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0309, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.8934, 'compress@10': 0.5257, 'time@10': 9.5482}: 100%|██████████| 10/10 [01:08<00:00,  6.88s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.030930281366455016
Avg hit ratio: 0.8863044145064519
Avg ndcg: 0.893415200589353
Avg compression ratio: 0.5257062793213313
Avg train time: 9.548227691650391
Std train time: 2.790422501581339
[0.7631578947368421, 0.34210526315789486, 0.07894736842105263, 0.8157894736842104, 0.9210526315789473, 0.8684210526315789, 0.3947368421052631, 0.2368421052631579, 0.5, 0.07894736842105264]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8793, 'compress@10': 0.7756, 'time@10': 8.5195}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8793, 'compress@10': 0.7756, 'time@10': 8.5195}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8962, 'compress@10': 0.5695, 'time@10': 7.8251}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8962, 'compress@10': 0.5695, 'time@10': 7.8251}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8832, 'compress@10': 0.4498, 'time@10': 7.281}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8832, 'compress@10': 0.4498, 'time@10': 7.281}:  30%|███       | 3/10 [00:14<00:32,  4.68s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8813, 'compress@10': 0.543, 'time@10': 7.024}:  30%|███       | 3/10 [00:20<00:32,  4.68s/it]  {'epoch': 18, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8813, 'compress@10': 0.543, 'time@10': 7.024}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0268, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.872, 'compress@10': 0.6189, 'time@10': 8.3505}:  40%|████      | 4/10 [00:27<00:31,  5.32s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0268, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.872, 'compress@10': 0.6189, 'time@10': 8.3505}:  50%|█████     | 5/10 [00:27<00:29,  5.88s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0257, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8811, 'compress@10': 0.661, 'time@10': 8.6165}:  50%|█████     | 5/10 [00:37<00:29,  5.88s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0257, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8811, 'compress@10': 0.661, 'time@10': 8.6165}:  60%|██████    | 6/10 [00:37<00:29,  7.27s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0258, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.8835, 'compress@10': 0.6264, 'time@10': 9.0242}:  60%|██████    | 6/10 [00:43<00:29,  7.27s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0258, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.8835, 'compress@10': 0.6264, 'time@10': 9.0242}:  70%|███████   | 7/10 [00:43<00:20,  6.78s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0253, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.8857, 'compress@10': 0.5804, 'time@10': 8.8813}:  70%|███████   | 7/10 [00:51<00:20,  6.78s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0253, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.8857, 'compress@10': 0.5804, 'time@10': 8.8813}:  80%|████████  | 8/10 [00:51<00:14,  7.15s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0246, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.891, 'compress@10': 0.5731, 'time@10': 9.5453}:  80%|████████  | 8/10 [00:58<00:14,  7.15s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0246, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.891, 'compress@10': 0.5731, 'time@10': 9.5453}:  90%|█████████ | 9/10 [00:58<00:07,  7.25s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8972, 'compress@10': 0.5258, 'time@10': 9.613}:  90%|█████████ | 9/10 [01:09<00:07,  7.25s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8972, 'compress@10': 0.5258, 'time@10': 9.613}: 100%|██████████| 10/10 [01:09<00:00,  8.18s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8972, 'compress@10': 0.5258, 'time@10': 9.613}: 100%|██████████| 10/10 [01:09<00:00,  6.92s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.022810306504890097
Avg hit ratio: 0.881673078100922
Avg ndcg: 0.897174162333598
Avg compression ratio: 0.5257553832089922
Avg train time: 9.61300048828125
Std train time: 2.848309799838723
[0.775, 0.3250000000000001, 0.075, 0.8249999999999998, 0.9249999999999999, 0.825, 0.42499999999999993, 0.275, 0.475, 0.07500000000000001]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8793, 'compress@10': 0.7868, 'time@10': 8.634}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8793, 'compress@10': 0.7868, 'time@10': 8.634}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8965, 'compress@10': 0.5668, 'time@10': 7.9684}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8965, 'compress@10': 0.5668, 'time@10': 7.9684}:  20%|██        | 2/10 [00:11<00:48,  6.11s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8834, 'compress@10': 0.4469, 'time@10': 7.1886}:  20%|██        | 2/10 [00:14<00:48,  6.11s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8834, 'compress@10': 0.4469, 'time@10': 7.1886}:  30%|███       | 3/10 [00:14<00:32,  4.68s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8868, 'compress@10': 0.543, 'time@10': 7.0165}:  30%|███       | 3/10 [00:21<00:32,  4.68s/it]  {'epoch': 19, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8868, 'compress@10': 0.543, 'time@10': 7.0165}:  40%|████      | 4/10 [00:21<00:32,  5.42s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8776, 'compress@10': 0.6197, 'time@10': 8.3003}:  40%|████      | 4/10 [00:27<00:32,  5.42s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8776, 'compress@10': 0.6197, 'time@10': 8.3003}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0253, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8855, 'compress@10': 0.6546, 'time@10': 8.5588}:  50%|█████     | 5/10 [00:37<00:29,  5.90s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0253, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8855, 'compress@10': 0.6546, 'time@10': 8.5588}:  60%|██████    | 6/10 [00:37<00:29,  7.26s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0248, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.8881, 'compress@10': 0.6251, 'time@10': 8.9899}:  60%|██████    | 6/10 [00:43<00:29,  7.26s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0248, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.8881, 'compress@10': 0.6251, 'time@10': 8.9899}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0238, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.893, 'compress@10': 0.5839, 'time@10': 8.8494}:  70%|███████   | 7/10 [00:51<00:20,  6.79s/it]  {'epoch': 19, 'num_users': 6.125, 'loss': 0.0238, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.893, 'compress@10': 0.5839, 'time@10': 8.8494}:  80%|████████  | 8/10 [00:51<00:14,  7.14s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8993, 'compress@10': 0.5735, 'time@10': 9.5319}:  80%|████████  | 8/10 [00:59<00:14,  7.14s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8993, 'compress@10': 0.5735, 'time@10': 9.5319}:  90%|█████████ | 9/10 [00:59<00:07,  7.26s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9008, 'compress@10': 0.5257, 'time@10': 9.576}:  90%|█████████ | 9/10 [01:09<00:07,  7.26s/it]     {'epoch': 19, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9008, 'compress@10': 0.5257, 'time@10': 9.576}: 100%|██████████| 10/10 [01:09<00:00,  8.11s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9008, 'compress@10': 0.5257, 'time@10': 9.576}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.023365734349615492
Avg hit ratio: 0.8959587923866362
Avg ndcg: 0.900842056817309
Avg compression ratio: 0.5257097339351597
Avg train time: 9.575951623916627
Std train time: 2.872072993860134
[0.7857142857142857, 0.30952380952380965, 0.07142857142857142, 0.8333333333333331, 0.9285714285714285, 0.8333333333333333, 0.4047619047619047, 0.2619047619047619, 0.4523809523809524, 0.11904761904761907]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0344, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8793, 'compress@10': 0.797, 'time@10': 8.7676}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0344, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8793, 'compress@10': 0.797, 'time@10': 8.7676}:  10%|█         | 1/10 [00:04<00:39,  4.43s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8971, 'compress@10': 0.5644, 'time@10': 8.0799}:  10%|█         | 1/10 [00:11<00:39,  4.43s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8971, 'compress@10': 0.5644, 'time@10': 8.0799}:  20%|██        | 2/10 [00:11<00:49,  6.19s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8838, 'compress@10': 0.4443, 'time@10': 7.2575}:  20%|██        | 2/10 [00:14<00:49,  6.19s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8838, 'compress@10': 0.4443, 'time@10': 7.2575}:  30%|███       | 3/10 [00:14<00:32,  4.67s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.856, 'ndcg@10': 0.893, 'compress@10': 0.543, 'time@10': 7.0052}:  30%|███       | 3/10 [00:20<00:32,  4.67s/it]   {'epoch': 20, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.856, 'ndcg@10': 0.893, 'compress@10': 0.543, 'time@10': 7.0052}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0235, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.885, 'compress@10': 0.6204, 'time@10': 8.3279}:  40%|████      | 4/10 [00:27<00:31,  5.31s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0235, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.885, 'compress@10': 0.6204, 'time@10': 8.3279}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0246, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8959, 'compress@10': 0.6565, 'time@10': 8.632}:  50%|█████     | 5/10 [00:38<00:29,  5.86s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0246, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8959, 'compress@10': 0.6565, 'time@10': 8.632}:  60%|██████    | 6/10 [00:38<00:29,  7.33s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0248, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.898, 'compress@10': 0.624, 'time@10': 9.0513}:  60%|██████    | 6/10 [00:43<00:29,  7.33s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 0.0248, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.898, 'compress@10': 0.624, 'time@10': 9.0513}:  70%|███████   | 7/10 [00:43<00:20,  6.84s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9023, 'compress@10': 0.5813, 'time@10': 8.898}:  70%|███████   | 7/10 [00:51<00:20,  6.84s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9023, 'compress@10': 0.5813, 'time@10': 8.898}:  80%|████████  | 8/10 [00:51<00:14,  7.16s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0242, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9134, 'compress@10': 0.5687, 'time@10': 9.5288}:  80%|████████  | 8/10 [00:59<00:14,  7.16s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0242, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9134, 'compress@10': 0.5687, 'time@10': 9.5288}:  90%|█████████ | 9/10 [00:59<00:07,  7.22s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0245, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9162, 'compress@10': 0.5258, 'time@10': 9.5693}:  90%|█████████ | 9/10 [01:09<00:07,  7.22s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0245, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9162, 'compress@10': 0.5258, 'time@10': 9.5693}: 100%|██████████| 10/10 [01:09<00:00,  8.07s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0245, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9162, 'compress@10': 0.5258, 'time@10': 9.5693}: 100%|██████████| 10/10 [01:09<00:00,  6.90s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.024490080167188708
Avg hit ratio: 0.898815935243779
Avg ndcg: 0.9161919523571376
Avg compression ratio: 0.5257814578686537
Avg train time: 9.569282698631287
Std train time: 2.846590708861332
[0.7954545454545454, 0.2954545454545456, 0.06818181818181818, 0.7954545454545453, 0.9318181818181818, 0.8409090909090908, 0.3863636363636363, 0.25, 0.4772727272727273, 0.15909090909090912]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0318, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.885, 'compress@10': 0.8062, 'time@10': 8.5825}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0318, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.885, 'compress@10': 0.8062, 'time@10': 8.5825}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9032, 'compress@10': 0.5622, 'time@10': 7.975}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9032, 'compress@10': 0.5622, 'time@10': 7.975}:  20%|██        | 2/10 [00:11<00:49,  6.14s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.783, 'ndcg@10': 0.8878, 'compress@10': 0.4419, 'time@10': 7.1493}:  20%|██        | 2/10 [00:14<00:49,  6.14s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.783, 'ndcg@10': 0.8878, 'compress@10': 0.4419, 'time@10': 7.1493}:  30%|███       | 3/10 [00:14<00:32,  4.61s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8933, 'compress@10': 0.5321, 'time@10': 6.9363}:  30%|███       | 3/10 [00:20<00:32,  4.61s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8933, 'compress@10': 0.5321, 'time@10': 6.9363}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.886, 'compress@10': 0.6123, 'time@10': 8.2926}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it] {'epoch': 21, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.886, 'compress@10': 0.6123, 'time@10': 8.2926}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8949, 'compress@10': 0.651, 'time@10': 8.5776}:  50%|█████     | 5/10 [00:37<00:29,  5.87s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8949, 'compress@10': 0.651, 'time@10': 8.5776}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0222, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8962, 'compress@10': 0.6167, 'time@10': 8.9341}:  60%|██████    | 6/10 [00:43<00:29,  7.29s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0222, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8962, 'compress@10': 0.6167, 'time@10': 8.9341}:  70%|███████   | 7/10 [00:43<00:20,  6.73s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0217, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9004, 'compress@10': 0.5735, 'time@10': 8.7971}:  70%|███████   | 7/10 [00:51<00:20,  6.73s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0217, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9004, 'compress@10': 0.5735, 'time@10': 8.7971}:  80%|████████  | 8/10 [00:51<00:14,  7.09s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0229, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9213, 'compress@10': 0.5645, 'time@10': 9.4522}:  80%|████████  | 8/10 [00:58<00:14,  7.09s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0229, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9213, 'compress@10': 0.5645, 'time@10': 9.4522}:  90%|█████████ | 9/10 [00:58<00:07,  7.18s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9255, 'compress@10': 0.5259, 'time@10': 9.5387}:  90%|█████████ | 9/10 [01:08<00:07,  7.18s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9255, 'compress@10': 0.5259, 'time@10': 9.5387}: 100%|██████████| 10/10 [01:08<00:00,  8.16s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9255, 'compress@10': 0.5259, 'time@10': 9.5387}: 100%|██████████| 10/10 [01:08<00:00,  6.90s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.02135110353947544
Avg hit ratio: 0.8877560274096776
Avg ndcg: 0.9255217104223306
Avg compression ratio: 0.5258788047256308
Avg train time: 9.538653779029847
Std train time: 2.8733852946095673
[0.8043478260869564, 0.28260869565217406, 0.06521739130434782, 0.8043478260869564, 0.9347826086956521, 0.8043478260869564, 0.4130434782608695, 0.2391304347826087, 0.5, 0.1521739130434783]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0318, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.885, 'compress@10': 0.8146, 'time@10': 8.7022}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0318, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.885, 'compress@10': 0.8146, 'time@10': 8.7022}:  10%|█         | 1/10 [00:04<00:39,  4.39s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9047, 'compress@10': 0.5602, 'time@10': 7.9774}:  10%|█         | 1/10 [00:11<00:39,  4.39s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9047, 'compress@10': 0.5602, 'time@10': 7.9774}:  20%|██        | 2/10 [00:11<00:48,  6.10s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.7723, 'ndcg@10': 0.8888, 'compress@10': 0.4397, 'time@10': 7.1796}:  20%|██        | 2/10 [00:14<00:48,  6.10s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.7723, 'ndcg@10': 0.8888, 'compress@10': 0.4397, 'time@10': 7.1796}:  30%|███       | 3/10 [00:14<00:32,  4.60s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8894, 'compress@10': 0.5326, 'time@10': 6.9693}:  30%|███       | 3/10 [00:20<00:32,  4.60s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8894, 'compress@10': 0.5326, 'time@10': 6.9693}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0262, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8842, 'compress@10': 0.6133, 'time@10': 8.3303}:  40%|████      | 4/10 [00:27<00:31,  5.30s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0262, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8842, 'compress@10': 0.6133, 'time@10': 8.3303}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0244, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8957, 'compress@10': 0.6459, 'time@10': 8.6114}:  50%|█████     | 5/10 [00:37<00:29,  5.89s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0244, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8957, 'compress@10': 0.6459, 'time@10': 8.6114}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0233, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8992, 'compress@10': 0.616, 'time@10': 8.9936}:  60%|██████    | 6/10 [00:43<00:29,  7.30s/it] {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0233, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8992, 'compress@10': 0.616, 'time@10': 8.9936}:  70%|███████   | 7/10 [00:43<00:20,  6.77s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0228, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9006, 'compress@10': 0.5716, 'time@10': 8.8324}:  70%|███████   | 7/10 [00:51<00:20,  6.77s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0228, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9006, 'compress@10': 0.5716, 'time@10': 8.8324}:  80%|████████  | 8/10 [00:51<00:14,  7.08s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0246, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9215, 'compress@10': 0.5652, 'time@10': 9.5286}:  80%|████████  | 8/10 [00:58<00:14,  7.08s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0246, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9215, 'compress@10': 0.5652, 'time@10': 9.5286}:  90%|█████████ | 9/10 [00:58<00:07,  7.24s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0252, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9197, 'compress@10': 0.5258, 'time@10': 9.5826}:  90%|█████████ | 9/10 [01:08<00:07,  7.24s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0252, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9197, 'compress@10': 0.5258, 'time@10': 9.5826}: 100%|██████████| 10/10 [01:08<00:00,  8.13s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0252, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9197, 'compress@10': 0.5258, 'time@10': 9.5826}: 100%|██████████| 10/10 [01:08<00:00,  6.90s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.025235316985592126
Avg hit ratio: 0.8865302209580648
Avg ndcg: 0.9196668993663568
Avg compression ratio: 0.525837350346702
Avg train time: 9.582639360427857
Std train time: 2.959299053146039
[0.8124999999999999, 0.2708333333333335, 0.0625, 0.8124999999999999, 0.9374999999999999, 0.7708333333333333, 0.39583333333333326, 0.22916666666666669, 0.5208333333333334, 0.18750000000000003]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8876, 'compress@10': 0.8224, 'time@10': 8.5829}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8876, 'compress@10': 0.8224, 'time@10': 8.5829}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9028, 'compress@10': 0.5584, 'time@10': 7.8499}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9028, 'compress@10': 0.5584, 'time@10': 7.8499}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.7723, 'ndcg@10': 0.8876, 'compress@10': 0.4377, 'time@10': 7.0817}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.7723, 'ndcg@10': 0.8876, 'compress@10': 0.4377, 'time@10': 7.0817}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8828, 'compress@10': 0.5331, 'time@10': 6.8945}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8828, 'compress@10': 0.5331, 'time@10': 6.8945}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8793, 'compress@10': 0.6142, 'time@10': 8.3136}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8793, 'compress@10': 0.6142, 'time@10': 8.3136}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8919, 'compress@10': 0.6412, 'time@10': 8.6269}:  50%|█████     | 5/10 [00:37<00:29,  5.90s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8919, 'compress@10': 0.6412, 'time@10': 8.6269}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0233, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8968, 'compress@10': 0.6096, 'time@10': 9.0329}:  60%|██████    | 6/10 [00:43<00:29,  7.38s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 0.0233, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8968, 'compress@10': 0.6096, 'time@10': 9.0329}:  70%|███████   | 7/10 [00:43<00:20,  6.85s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9031, 'compress@10': 0.5648, 'time@10': 8.8778}:  70%|███████   | 7/10 [00:51<00:20,  6.85s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9031, 'compress@10': 0.5648, 'time@10': 8.8778}:  80%|████████  | 8/10 [00:51<00:14,  7.16s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9076, 'compress@10': 0.5614, 'time@10': 9.511}:  80%|████████  | 8/10 [00:58<00:14,  7.16s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9076, 'compress@10': 0.5614, 'time@10': 9.511}:  90%|█████████ | 9/10 [00:58<00:07,  7.21s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0205, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9143, 'compress@10': 0.5259, 'time@10': 9.5861}:  90%|█████████ | 9/10 [01:09<00:07,  7.21s/it]  {'epoch': 23, 'num_users': 6.3, 'loss': 0.0205, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9143, 'compress@10': 0.5259, 'time@10': 9.5861}: 100%|██████████| 10/10 [01:09<00:00,  8.17s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0205, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9143, 'compress@10': 0.5259, 'time@10': 9.5861}: 100%|██████████| 10/10 [01:09<00:00,  6.92s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.020514332940223975
Avg hit ratio: 0.8858953003231441
Avg ndcg: 0.9143127834568515
Avg compression ratio: 0.5258688079897416
Avg train time: 9.586104989051819
Std train time: 2.9308512135715405
[0.8199999999999998, 0.2600000000000001, 0.06, 0.8199999999999998, 0.94, 0.7799999999999999, 0.37999999999999995, 0.22000000000000003, 0.54, 0.18000000000000002]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.89, 'compress@10': 0.8295, 'time@10': 8.7092}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.89, 'compress@10': 0.8295, 'time@10': 8.7092}:  10%|█         | 1/10 [00:04<00:39,  4.39s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0257, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.92, 'compress@10': 0.5567, 'time@10': 7.9901}:  10%|█         | 1/10 [00:11<00:39,  4.39s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0257, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.92, 'compress@10': 0.5567, 'time@10': 7.9901}:  20%|██        | 2/10 [00:11<00:48,  6.12s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8991, 'compress@10': 0.4359, 'time@10': 7.2137}:  20%|██        | 2/10 [00:14<00:48,  6.12s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8991, 'compress@10': 0.4359, 'time@10': 7.2137}:  30%|███       | 3/10 [00:14<00:32,  4.64s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9095, 'compress@10': 0.5335, 'time@10': 6.9896}:  30%|███       | 3/10 [00:20<00:32,  4.64s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9095, 'compress@10': 0.5335, 'time@10': 6.9896}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.9024, 'compress@10': 0.615, 'time@10': 8.3638}:  40%|████      | 4/10 [00:27<00:31,  5.32s/it] {'epoch': 24, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.9024, 'compress@10': 0.615, 'time@10': 8.3638}:  50%|█████     | 5/10 [00:27<00:29,  5.91s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9106, 'compress@10': 0.6434, 'time@10': 8.649}:  50%|█████     | 5/10 [00:38<00:29,  5.91s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9106, 'compress@10': 0.6434, 'time@10': 8.649}:  60%|██████    | 6/10 [00:38<00:29,  7.34s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0207, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9098, 'compress@10': 0.6093, 'time@10': 9.1163}:  60%|██████    | 6/10 [00:44<00:29,  7.34s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0207, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9098, 'compress@10': 0.6093, 'time@10': 9.1163}:  70%|███████   | 7/10 [00:44<00:20,  6.90s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0202, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9115, 'compress@10': 0.5634, 'time@10': 8.9417}:  70%|███████   | 7/10 [00:51<00:20,  6.90s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0202, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9115, 'compress@10': 0.5634, 'time@10': 8.9417}:  80%|████████  | 8/10 [00:51<00:14,  7.17s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9169, 'compress@10': 0.5623, 'time@10': 9.5588}:  80%|████████  | 8/10 [00:59<00:14,  7.17s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9169, 'compress@10': 0.5623, 'time@10': 9.5588}:  90%|█████████ | 9/10 [00:59<00:07,  7.21s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.02, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9193, 'compress@10': 0.5259, 'time@10': 9.6152}:  90%|█████████ | 9/10 [01:09<00:07,  7.21s/it]    {'epoch': 24, 'num_users': 6.3, 'loss': 0.02, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9193, 'compress@10': 0.5259, 'time@10': 9.6152}: 100%|██████████| 10/10 [01:09<00:00,  8.12s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.02, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9193, 'compress@10': 0.5259, 'time@10': 9.6152}: 100%|██████████| 10/10 [01:09<00:00,  6.92s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.01995322057011128
Avg hit ratio: 0.8886500366262675
Avg ndcg: 0.9192685972980493
Avg compression ratio: 0.5258983426068216
Avg train time: 9.615155100822449
Std train time: 2.8990144595616307
[0.8269230769230768, 0.2884615384615386, 0.05769230769230769, 0.7884615384615383, 0.9423076923076923, 0.7499999999999999, 0.4038461538461538, 0.21153846153846156, 0.5192307692307693, 0.21153846153846156]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8964, 'compress@10': 0.836, 'time@10': 8.6891}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8964, 'compress@10': 0.836, 'time@10': 8.6891}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9238, 'compress@10': 0.5737, 'time@10': 7.8944}:  10%|█         | 1/10 [00:11<00:39,  4.38s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9238, 'compress@10': 0.5737, 'time@10': 7.8944}:  20%|██        | 2/10 [00:11<00:48,  6.00s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.9016, 'compress@10': 0.4466, 'time@10': 7.0945}:  20%|██        | 2/10 [00:14<00:48,  6.00s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.9016, 'compress@10': 0.4466, 'time@10': 7.0945}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.9131, 'compress@10': 0.5339, 'time@10': 6.9568}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.9131, 'compress@10': 0.5339, 'time@10': 6.9568}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0173, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.906, 'compress@10': 0.6158, 'time@10': 8.3156}:  40%|████      | 4/10 [00:27<00:32,  5.34s/it] {'epoch': 25, 'num_users': 5.8, 'loss': 0.0173, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.906, 'compress@10': 0.6158, 'time@10': 8.3156}:  50%|█████     | 5/10 [00:27<00:29,  5.91s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9145, 'compress@10': 0.6391, 'time@10': 8.5965}:  50%|█████     | 5/10 [00:37<00:29,  5.91s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9145, 'compress@10': 0.6391, 'time@10': 8.5965}:  60%|██████    | 6/10 [00:37<00:29,  7.31s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.016, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9165, 'compress@10': 0.6089, 'time@10': 9.064}:  60%|██████    | 6/10 [00:43<00:29,  7.31s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.016, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9165, 'compress@10': 0.6089, 'time@10': 9.064}:  70%|███████   | 7/10 [00:43<00:20,  6.88s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9183, 'compress@10': 0.5621, 'time@10': 8.9045}:  70%|███████   | 7/10 [00:51<00:20,  6.88s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9183, 'compress@10': 0.5621, 'time@10': 8.9045}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9233, 'compress@10': 0.5588, 'time@10': 9.5583}:  80%|████████  | 8/10 [00:59<00:14,  7.18s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9233, 'compress@10': 0.5588, 'time@10': 9.5583}:  90%|█████████ | 9/10 [00:59<00:07,  7.26s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9283, 'compress@10': 0.5259, 'time@10': 9.6077}:  90%|█████████ | 9/10 [01:09<00:07,  7.26s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9283, 'compress@10': 0.5259, 'time@10': 9.6077}: 100%|██████████| 10/10 [01:09<00:00,  8.13s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9283, 'compress@10': 0.5259, 'time@10': 9.6077}: 100%|██████████| 10/10 [01:09<00:00,  6.92s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.015503134635874405
Avg hit ratio: 0.8790980653001027
Avg ndcg: 0.9283157160864443
Avg compression ratio: 0.525895148171929
Avg train time: 9.607653760910035
Std train time: 2.936472039757535
[0.8333333333333331, 0.31481481481481494, 0.05555555555555555, 0.7592592592592591, 0.9444444444444444, 0.7222222222222221, 0.38888888888888884, 0.24074074074074076, 0.5370370370370371, 0.20370370370370372]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0257, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9006, 'compress@10': 0.8421, 'time@10': 8.6102}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0257, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9006, 'compress@10': 0.8421, 'time@10': 8.6102}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.927, 'compress@10': 0.5895, 'time@10': 7.8932}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it] {'epoch': 26, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.927, 'compress@10': 0.5895, 'time@10': 7.8932}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.9037, 'compress@10': 0.4565, 'time@10': 7.1255}:  20%|██        | 2/10 [00:14<00:48,  6.04s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.9037, 'compress@10': 0.4565, 'time@10': 7.1255}:  30%|███       | 3/10 [00:14<00:32,  4.57s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.9133, 'compress@10': 0.5343, 'time@10': 6.9727}:  30%|███       | 3/10 [00:20<00:32,  4.57s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.9133, 'compress@10': 0.5343, 'time@10': 6.9727}:  40%|████      | 4/10 [00:20<00:32,  5.36s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0179, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.9072, 'compress@10': 0.6166, 'time@10': 8.3255}:  40%|████      | 4/10 [00:27<00:32,  5.36s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0179, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.9072, 'compress@10': 0.6166, 'time@10': 8.3255}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0197, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9167, 'compress@10': 0.6352, 'time@10': 8.6078}:  50%|█████     | 5/10 [00:37<00:29,  5.92s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0197, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9167, 'compress@10': 0.6352, 'time@10': 8.6078}:  60%|██████    | 6/10 [00:37<00:29,  7.33s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0191, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9193, 'compress@10': 0.6035, 'time@10': 9.0423}:  60%|██████    | 6/10 [00:43<00:29,  7.33s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0191, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9193, 'compress@10': 0.6035, 'time@10': 9.0423}:  70%|███████   | 7/10 [00:43<00:20,  6.85s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9238, 'compress@10': 0.5609, 'time@10': 8.8835}:  70%|███████   | 7/10 [00:51<00:20,  6.85s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9238, 'compress@10': 0.5609, 'time@10': 8.8835}:  80%|████████  | 8/10 [00:51<00:14,  7.15s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0197, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9442, 'compress@10': 0.5597, 'time@10': 9.5335}:  80%|████████  | 8/10 [00:59<00:14,  7.15s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0197, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9442, 'compress@10': 0.5597, 'time@10': 9.5335}:  90%|█████████ | 9/10 [00:59<00:07,  7.23s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0208, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9465, 'compress@10': 0.5259, 'time@10': 9.5894}:  90%|█████████ | 9/10 [01:09<00:07,  7.23s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0208, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9465, 'compress@10': 0.5259, 'time@10': 9.5894}: 100%|██████████| 10/10 [01:09<00:00,  8.13s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0208, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9465, 'compress@10': 0.5259, 'time@10': 9.5894}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.020757062755866272
Avg hit ratio: 0.8790980653001027
Avg ndcg: 0.946509348799009
Avg compression ratio: 0.5259112135852602
Avg train time: 9.589376711845398
Std train time: 2.896181844901945
[0.8392857142857141, 0.3035714285714287, 0.05357142857142857, 0.732142857142857, 0.9464285714285714, 0.732142857142857, 0.37499999999999994, 0.23214285714285715, 0.5535714285714286, 0.23214285714285715]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9006, 'compress@10': 0.8477, 'time@10': 8.6528}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9006, 'compress@10': 0.8477, 'time@10': 8.6528}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9262, 'compress@10': 0.5869, 'time@10': 7.9187}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it] {'epoch': 27, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9262, 'compress@10': 0.5869, 'time@10': 7.9187}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9032, 'compress@10': 0.4542, 'time@10': 7.1937}:  20%|██        | 2/10 [00:14<00:48,  6.05s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9032, 'compress@10': 0.4542, 'time@10': 7.1937}:  30%|███       | 3/10 [00:14<00:32,  4.62s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9132, 'compress@10': 0.5261, 'time@10': 6.996}:  30%|███       | 3/10 [00:20<00:32,  4.62s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9132, 'compress@10': 0.5261, 'time@10': 6.996}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9086, 'compress@10': 0.6103, 'time@10': 8.322}:  40%|████      | 4/10 [00:27<00:32,  5.34s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9086, 'compress@10': 0.6103, 'time@10': 8.322}:  50%|█████     | 5/10 [00:27<00:29,  5.88s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9158, 'compress@10': 0.6316, 'time@10': 8.6397}:  50%|█████     | 5/10 [00:38<00:29,  5.88s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9158, 'compress@10': 0.6316, 'time@10': 8.6397}:  60%|██████    | 6/10 [00:38<00:29,  7.37s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0192, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9143, 'compress@10': 0.5985, 'time@10': 9.0117}:  60%|██████    | 6/10 [00:43<00:29,  7.37s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0192, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9143, 'compress@10': 0.5985, 'time@10': 9.0117}:  70%|███████   | 7/10 [00:43<00:20,  6.81s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.019, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9151, 'compress@10': 0.5555, 'time@10': 8.8832}:  70%|███████   | 7/10 [00:51<00:20,  6.81s/it]   {'epoch': 27, 'num_users': 6.125, 'loss': 0.019, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9151, 'compress@10': 0.5555, 'time@10': 8.8832}:  80%|████████  | 8/10 [00:51<00:14,  7.20s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9279, 'compress@10': 0.5567, 'time@10': 9.5538}:  80%|████████  | 8/10 [00:59<00:14,  7.20s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9279, 'compress@10': 0.5567, 'time@10': 9.5538}:  90%|█████████ | 9/10 [00:59<00:07,  7.29s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0226, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9329, 'compress@10': 0.526, 'time@10': 9.6055}:  90%|█████████ | 9/10 [01:09<00:07,  7.29s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0226, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9329, 'compress@10': 0.526, 'time@10': 9.6055}: 100%|██████████| 10/10 [01:09<00:00,  8.16s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0226, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9329, 'compress@10': 0.526, 'time@10': 9.6055}: 100%|██████████| 10/10 [01:09<00:00,  6.94s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.02256943923111026
Avg hit ratio: 0.8967933788528016
Avg ndcg: 0.9328806793608464
Avg compression ratio: 0.52598354531757
Avg train time: 9.605533647537232
Std train time: 2.868008103140554
[0.8448275862068964, 0.2931034482758622, 0.05172413793103448, 0.7413793103448274, 0.9482758620689655, 0.7068965517241378, 0.396551724137931, 0.22413793103448276, 0.5689655172413793, 0.22413793103448276]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9071, 'compress@10': 0.853, 'time@10': 8.6475}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9071, 'compress@10': 0.853, 'time@10': 8.6475}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9297, 'compress@10': 0.5844, 'time@10': 7.8662}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9297, 'compress@10': 0.5844, 'time@10': 7.8662}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9055, 'compress@10': 0.452, 'time@10': 7.0539}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it]  {'epoch': 28, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9055, 'compress@10': 0.452, 'time@10': 7.0539}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9177, 'compress@10': 0.5267, 'time@10': 6.8683}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9177, 'compress@10': 0.5267, 'time@10': 6.8683}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9118, 'compress@10': 0.6112, 'time@10': 8.217}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9118, 'compress@10': 0.6112, 'time@10': 8.217}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9207, 'compress@10': 0.6282, 'time@10': 8.5185}:  50%|█████     | 5/10 [00:37<00:29,  5.82s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9207, 'compress@10': 0.6282, 'time@10': 8.5185}:  60%|██████    | 6/10 [00:37<00:29,  7.26s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9229, 'compress@10': 0.5986, 'time@10': 8.9177}:  60%|██████    | 6/10 [00:43<00:29,  7.26s/it] {'epoch': 28, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9229, 'compress@10': 0.5986, 'time@10': 8.9177}:  70%|███████   | 7/10 [00:43<00:20,  6.75s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9271, 'compress@10': 0.5545, 'time@10': 8.775}:  70%|███████   | 7/10 [00:51<00:20,  6.75s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9271, 'compress@10': 0.5545, 'time@10': 8.775}:  80%|████████  | 8/10 [00:51<00:14,  7.09s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9318, 'compress@10': 0.5575, 'time@10': 9.4035}:  80%|████████  | 8/10 [00:58<00:14,  7.09s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9318, 'compress@10': 0.5575, 'time@10': 9.4035}:  90%|█████████ | 9/10 [00:58<00:07,  7.14s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9362, 'compress@10': 0.5259, 'time@10': 9.4687}:  90%|█████████ | 9/10 [01:08<00:07,  7.14s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9362, 'compress@10': 0.5259, 'time@10': 9.4687}: 100%|██████████| 10/10 [01:08<00:00,  8.06s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9362, 'compress@10': 0.5259, 'time@10': 9.4687}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01614198582951409
Avg hit ratio: 0.9022183660519824
Avg ndcg: 0.9362466685607235
Avg compression ratio: 0.5259436734736027
Avg train time: 9.468749737739563
Std train time: 2.852441606789292
[0.8499999999999998, 0.3166666666666668, 0.05, 0.7499999999999998, 0.95, 0.6833333333333332, 0.3833333333333333, 0.21666666666666667, 0.5833333333333334, 0.21666666666666667]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0246, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.905, 'compress@10': 0.8579, 'time@10': 8.6665}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0246, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.905, 'compress@10': 0.8579, 'time@10': 8.6665}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9364, 'compress@10': 0.5983, 'time@10': 7.8221}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9364, 'compress@10': 0.5983, 'time@10': 7.8221}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.91, 'compress@10': 0.4608, 'time@10': 7.0558}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]  {'epoch': 29, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.91, 'compress@10': 0.4608, 'time@10': 7.0558}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9225, 'compress@10': 0.5353, 'time@10': 6.8935}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9225, 'compress@10': 0.5353, 'time@10': 6.8935}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.86, 'ndcg@10': 0.917, 'compress@10': 0.6184, 'time@10': 8.241}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]    {'epoch': 29, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.86, 'ndcg@10': 0.917, 'compress@10': 0.6184, 'time@10': 8.241}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9255, 'compress@10': 0.6304, 'time@10': 8.577}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9255, 'compress@10': 0.6304, 'time@10': 8.577}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.017, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9288, 'compress@10': 0.5987, 'time@10': 8.9422}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.017, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9288, 'compress@10': 0.5987, 'time@10': 8.9422}:  70%|███████   | 7/10 [00:43<00:20,  6.78s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0162, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9321, 'compress@10': 0.5537, 'time@10': 8.8003}:  70%|███████   | 7/10 [00:51<00:20,  6.78s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0162, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9321, 'compress@10': 0.5537, 'time@10': 8.8003}:  80%|████████  | 8/10 [00:51<00:14,  7.12s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9453, 'compress@10': 0.5583, 'time@10': 9.4224}:  80%|████████  | 8/10 [00:58<00:14,  7.12s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9453, 'compress@10': 0.5583, 'time@10': 9.4224}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9443, 'compress@10': 0.5259, 'time@10': 9.4922}:  90%|█████████ | 9/10 [01:08<00:07,  7.16s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9443, 'compress@10': 0.5259, 'time@10': 9.4922}: 100%|██████████| 10/10 [01:08<00:00,  8.08s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9443, 'compress@10': 0.5259, 'time@10': 9.4922}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.018522519604049804
Avg hit ratio: 0.8957667531487565
Avg ndcg: 0.9442745755673176
Avg compression ratio: 0.5259348093564417
Avg train time: 9.492174959182739
Std train time: 2.8282561563730786
[0.8548387096774192, 0.306451612903226, 0.048387096774193554, 0.725806451612903, 0.9516129032258064, 0.6935483870967741, 0.3709677419354838, 0.20967741935483872, 0.5967741935483871, 0.24193548387096775]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9071, 'compress@10': 0.8625, 'time@10': 8.3501}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9071, 'compress@10': 0.8625, 'time@10': 8.3501}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9331, 'compress@10': 0.5956, 'time@10': 7.662}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9331, 'compress@10': 0.5956, 'time@10': 7.662}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9078, 'compress@10': 0.4585, 'time@10': 6.9662}:  20%|██        | 2/10 [00:14<00:46,  5.86s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9078, 'compress@10': 0.4585, 'time@10': 6.9662}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9215, 'compress@10': 0.5278, 'time@10': 6.8085}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9215, 'compress@10': 0.5278, 'time@10': 6.8085}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9158, 'compress@10': 0.6128, 'time@10': 8.1954}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9158, 'compress@10': 0.6128, 'time@10': 8.1954}:  50%|█████     | 5/10 [00:27<00:29,  5.83s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9245, 'compress@10': 0.6274, 'time@10': 8.5427}:  50%|█████     | 5/10 [00:37<00:29,  5.83s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9245, 'compress@10': 0.6274, 'time@10': 8.5427}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9255, 'compress@10': 0.5943, 'time@10': 8.9218}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9255, 'compress@10': 0.5943, 'time@10': 8.9218}:  70%|███████   | 7/10 [00:43<00:20,  6.80s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9264, 'compress@10': 0.5491, 'time@10': 8.7615}:  70%|███████   | 7/10 [00:50<00:20,  6.80s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9264, 'compress@10': 0.5491, 'time@10': 8.7615}:  80%|████████  | 8/10 [00:50<00:14,  7.08s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9291, 'compress@10': 0.5556, 'time@10': 9.4518}:  80%|████████  | 8/10 [00:58<00:14,  7.08s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9291, 'compress@10': 0.5556, 'time@10': 9.4518}:  90%|█████████ | 9/10 [00:58<00:07,  7.22s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9339, 'compress@10': 0.526, 'time@10': 9.5118}:  90%|█████████ | 9/10 [01:08<00:07,  7.22s/it]    {'epoch': 30, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9339, 'compress@10': 0.526, 'time@10': 9.5118}: 100%|██████████| 10/10 [01:08<00:00,  8.10s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9339, 'compress@10': 0.526, 'time@10': 9.5118}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.012681189986680327
Avg hit ratio: 0.8934247152583316
Avg ndcg: 0.9339234939215547
Avg compression ratio: 0.5259987066331002
Avg train time: 9.511769723892211
Std train time: 2.9722095205159182
[0.8593749999999998, 0.29687500000000017, 0.04687500000000001, 0.7343749999999998, 0.9531249999999999, 0.6718749999999999, 0.39062499999999994, 0.234375, 0.578125, 0.234375]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9089, 'compress@10': 0.8668, 'time@10': 8.5085}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9089, 'compress@10': 0.8668, 'time@10': 8.5085}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9318, 'compress@10': 0.5932, 'time@10': 7.8275}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9318, 'compress@10': 0.5932, 'time@10': 7.8275}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9069, 'compress@10': 0.4565, 'time@10': 7.0151}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9069, 'compress@10': 0.4565, 'time@10': 7.0151}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9168, 'compress@10': 0.5283, 'time@10': 6.8634}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9168, 'compress@10': 0.5283, 'time@10': 6.8634}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9148, 'compress@10': 0.6135, 'time@10': 8.2324}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9148, 'compress@10': 0.6135, 'time@10': 8.2324}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9232, 'compress@10': 0.6244, 'time@10': 8.5464}:  50%|█████     | 5/10 [00:37<00:29,  5.86s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9232, 'compress@10': 0.6244, 'time@10': 8.5464}:  60%|██████    | 6/10 [00:37<00:29,  7.32s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9255, 'compress@10': 0.5945, 'time@10': 9.011}:  60%|██████    | 6/10 [00:43<00:29,  7.32s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9255, 'compress@10': 0.5945, 'time@10': 9.011}:  70%|███████   | 7/10 [00:43<00:20,  6.87s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9302, 'compress@10': 0.5522, 'time@10': 8.8776}:  70%|███████   | 7/10 [00:51<00:20,  6.87s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9302, 'compress@10': 0.5522, 'time@10': 8.8776}:  80%|████████  | 8/10 [00:51<00:14,  7.26s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9347, 'compress@10': 0.5564, 'time@10': 9.5078}:  80%|████████  | 8/10 [00:59<00:14,  7.26s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9347, 'compress@10': 0.5564, 'time@10': 9.5078}:  90%|█████████ | 9/10 [00:59<00:07,  7.27s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9382, 'compress@10': 0.526, 'time@10': 9.5725}:  90%|█████████ | 9/10 [01:09<00:07,  7.27s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9382, 'compress@10': 0.526, 'time@10': 9.5725}: 100%|██████████| 10/10 [01:09<00:00,  8.18s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9382, 'compress@10': 0.526, 'time@10': 9.5725}: 100%|██████████| 10/10 [01:09<00:00,  6.93s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.014523104898520883
Avg hit ratio: 0.8975675724011888
Avg ndcg: 0.9382349955721001
Avg compression ratio: 0.5259635108818045
Avg train time: 9.57246654033661
Std train time: 2.9092130493510187
[0.8636363636363634, 0.28787878787878807, 0.04545454545454546, 0.7424242424242422, 0.9545454545454545, 0.6515151515151514, 0.37878787878787873, 0.22727272727272727, 0.5909090909090909, 0.25757575757575757]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9106, 'compress@10': 0.8708, 'time@10': 8.4968}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9106, 'compress@10': 0.8708, 'time@10': 8.4968}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9394, 'compress@10': 0.5908, 'time@10': 7.7431}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9394, 'compress@10': 0.5908, 'time@10': 7.7431}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.912, 'compress@10': 0.4545, 'time@10': 7.0164}:  20%|██        | 2/10 [00:14<00:47,  5.90s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.912, 'compress@10': 0.4545, 'time@10': 7.0164}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9235, 'compress@10': 0.5288, 'time@10': 6.8542}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9235, 'compress@10': 0.5288, 'time@10': 6.8542}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0161, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9218, 'compress@10': 0.6141, 'time@10': 8.1827}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0161, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9218, 'compress@10': 0.6141, 'time@10': 8.1827}:  50%|█████     | 5/10 [00:27<00:29,  5.80s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.93, 'compress@10': 0.6216, 'time@10': 8.5149}:  50%|█████     | 5/10 [00:37<00:29,  5.80s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.93, 'compress@10': 0.6216, 'time@10': 8.5149}:  60%|██████    | 6/10 [00:37<00:29,  7.31s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9326, 'compress@10': 0.5905, 'time@10': 8.9242}:  60%|██████    | 6/10 [00:43<00:29,  7.31s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9326, 'compress@10': 0.5905, 'time@10': 8.9242}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9337, 'compress@10': 0.5478, 'time@10': 8.7986}:  70%|███████   | 7/10 [00:51<00:20,  6.79s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9337, 'compress@10': 0.5478, 'time@10': 8.7986}:  80%|████████  | 8/10 [00:51<00:14,  7.16s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.936, 'compress@10': 0.5539, 'time@10': 9.4222}:  80%|████████  | 8/10 [00:58<00:14,  7.16s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.936, 'compress@10': 0.5539, 'time@10': 9.4222}:  90%|█████████ | 9/10 [00:58<00:07,  7.19s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.94, 'compress@10': 0.526, 'time@10': 9.4631}:  90%|█████████ | 9/10 [01:08<00:07,  7.19s/it]     {'epoch': 32, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.94, 'compress@10': 0.526, 'time@10': 9.4631}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.94, 'compress@10': 0.526, 'time@10': 9.4631}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.012518243013692221
Avg hit ratio: 0.8979131945210043
Avg ndcg: 0.9400346990457737
Avg compression ratio: 0.5259813929211232
Avg train time: 9.463128924369812
Std train time: 2.815874748423535
[0.8676470588235292, 0.3088235294117649, 0.04411764705882354, 0.7499999999999998, 0.9558823529411764, 0.6323529411764705, 0.3676470588235293, 0.22058823529411764, 0.6029411764705883, 0.25]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9132, 'compress@10': 0.8746, 'time@10': 8.8061}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9132, 'compress@10': 0.8746, 'time@10': 8.8061}:  10%|█         | 1/10 [00:04<00:39,  4.44s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9405, 'compress@10': 0.6029, 'time@10': 7.9006}:  10%|█         | 1/10 [00:11<00:39,  4.44s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9405, 'compress@10': 0.6029, 'time@10': 7.9006}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9127, 'compress@10': 0.4621, 'time@10': 7.0281}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9127, 'compress@10': 0.4621, 'time@10': 7.0281}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9241, 'compress@10': 0.5363, 'time@10': 6.9248}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9241, 'compress@10': 0.5363, 'time@10': 6.9248}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9236, 'compress@10': 0.6204, 'time@10': 8.2731}:  40%|████      | 4/10 [00:27<00:31,  5.33s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9236, 'compress@10': 0.6204, 'time@10': 8.2731}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9334, 'compress@10': 0.6238, 'time@10': 8.6051}:  50%|█████     | 5/10 [00:37<00:29,  5.89s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9334, 'compress@10': 0.6238, 'time@10': 8.6051}:  60%|██████    | 6/10 [00:37<00:29,  7.39s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.016, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9354, 'compress@10': 0.5908, 'time@10': 8.9748}:  60%|██████    | 6/10 [00:43<00:29,  7.39s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.016, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9354, 'compress@10': 0.5908, 'time@10': 8.9748}:  70%|███████   | 7/10 [00:43<00:20,  6.81s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9384, 'compress@10': 0.5473, 'time@10': 8.8197}:  70%|███████   | 7/10 [00:51<00:20,  6.81s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9384, 'compress@10': 0.5473, 'time@10': 8.8197}:  80%|████████  | 8/10 [00:51<00:14,  7.12s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9409, 'compress@10': 0.5547, 'time@10': 9.4535}:  80%|████████  | 8/10 [00:58<00:14,  7.12s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9409, 'compress@10': 0.5547, 'time@10': 9.4535}:  90%|█████████ | 9/10 [00:58<00:07,  7.18s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9434, 'compress@10': 0.526, 'time@10': 9.5019}:  90%|█████████ | 9/10 [01:08<00:07,  7.18s/it]    {'epoch': 33, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9434, 'compress@10': 0.526, 'time@10': 9.5019}: 100%|██████████| 10/10 [01:08<00:00,  8.04s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9434, 'compress@10': 0.526, 'time@10': 9.5019}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.015608510345049707
Avg hit ratio: 0.9001354167432265
Avg ndcg: 0.9434429434029374
Avg compression ratio: 0.5259722330405283
Avg train time: 9.501928663253784
Std train time: 2.867317022499882
[0.8714285714285712, 0.30000000000000016, 0.042857142857142864, 0.7285714285714283, 0.9571428571428571, 0.6428571428571427, 0.3857142857142856, 0.21428571428571427, 0.5857142857142857, 0.2714285714285714]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9132, 'compress@10': 0.8782, 'time@10': 8.4731}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9132, 'compress@10': 0.8782, 'time@10': 8.4731}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9386, 'compress@10': 0.6004, 'time@10': 7.7343}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9386, 'compress@10': 0.6004, 'time@10': 7.7343}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9115, 'compress@10': 0.4601, 'time@10': 7.0879}:  20%|██        | 2/10 [00:14<00:47,  5.90s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9115, 'compress@10': 0.4601, 'time@10': 7.0879}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9234, 'compress@10': 0.5297, 'time@10': 6.9202}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9234, 'compress@10': 0.5297, 'time@10': 6.9202}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9235, 'compress@10': 0.6153, 'time@10': 8.2712}:  40%|████      | 4/10 [00:27<00:31,  5.30s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9235, 'compress@10': 0.6153, 'time@10': 8.2712}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9319, 'compress@10': 0.6212, 'time@10': 8.5961}:  50%|█████     | 5/10 [00:37<00:29,  5.87s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9319, 'compress@10': 0.6212, 'time@10': 8.5961}:  60%|██████    | 6/10 [00:37<00:29,  7.37s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9324, 'compress@10': 0.5911, 'time@10': 8.9539}:  60%|██████    | 6/10 [00:43<00:29,  7.37s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9324, 'compress@10': 0.5911, 'time@10': 8.9539}:  70%|███████   | 7/10 [00:43<00:20,  6.78s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9364, 'compress@10': 0.5468, 'time@10': 8.7951}:  70%|███████   | 7/10 [00:51<00:20,  6.78s/it]   {'epoch': 34, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9364, 'compress@10': 0.5468, 'time@10': 8.7951}:  80%|████████  | 8/10 [00:51<00:14,  7.08s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9422, 'compress@10': 0.5524, 'time@10': 9.4275}:  80%|████████  | 8/10 [00:58<00:14,  7.08s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9422, 'compress@10': 0.5524, 'time@10': 9.4275}:  90%|█████████ | 9/10 [00:58<00:07,  7.14s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.95, 'compress@10': 0.526, 'time@10': 9.4662}:  90%|█████████ | 9/10 [01:08<00:07,  7.14s/it]     {'epoch': 34, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.95, 'compress@10': 0.526, 'time@10': 9.4662}: 100%|██████████| 10/10 [01:08<00:00,  7.98s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.95, 'compress@10': 0.526, 'time@10': 9.4662}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.012539384452089982
Avg hit ratio: 0.9072219502813731
Avg ndcg: 0.950044245673217
Avg compression ratio: 0.5259948531529387
Avg train time: 9.46615915298462
Std train time: 2.816644805128215
[0.8749999999999998, 0.2916666666666668, 0.04166666666666667, 0.708333333333333, 0.9583333333333333, 0.6249999999999998, 0.4027777777777777, 0.20833333333333331, 0.5972222222222222, 0.29166666666666663]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9157, 'compress@10': 0.8816, 'time@10': 8.377}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9157, 'compress@10': 0.8816, 'time@10': 8.377}:  10%|█         | 1/10 [00:04<00:38,  4.22s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9363, 'compress@10': 0.598, 'time@10': 7.6856}:  10%|█         | 1/10 [00:11<00:38,  4.22s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9363, 'compress@10': 0.598, 'time@10': 7.6856}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9099, 'compress@10': 0.4582, 'time@10': 7.1002}:  20%|██        | 2/10 [00:14<00:47,  5.89s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9099, 'compress@10': 0.4582, 'time@10': 7.1002}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9222, 'compress@10': 0.5234, 'time@10': 6.9361}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9222, 'compress@10': 0.5234, 'time@10': 6.9361}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9229, 'compress@10': 0.6105, 'time@10': 8.2915}:  40%|████      | 4/10 [00:27<00:31,  5.33s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9229, 'compress@10': 0.6105, 'time@10': 8.2915}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9312, 'compress@10': 0.6143, 'time@10': 8.6458}:  50%|█████     | 5/10 [00:38<00:29,  5.90s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9312, 'compress@10': 0.6143, 'time@10': 8.6458}:  60%|██████    | 6/10 [00:38<00:29,  7.45s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9343, 'compress@10': 0.5875, 'time@10': 9.0635}:  60%|██████    | 6/10 [00:43<00:29,  7.45s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9343, 'compress@10': 0.5875, 'time@10': 9.0635}:  70%|███████   | 7/10 [00:43<00:20,  6.92s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9354, 'compress@10': 0.5429, 'time@10': 8.8949}:  70%|███████   | 7/10 [00:51<00:20,  6.92s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9354, 'compress@10': 0.5429, 'time@10': 8.8949}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9471, 'compress@10': 0.5503, 'time@10': 9.5122}:  80%|████████  | 8/10 [00:58<00:14,  7.18s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9471, 'compress@10': 0.5503, 'time@10': 9.5122}:  90%|█████████ | 9/10 [00:58<00:07,  7.21s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.95, 'compress@10': 0.526, 'time@10': 9.5643}:  90%|█████████ | 9/10 [01:09<00:07,  7.21s/it]     {'epoch': 35, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.95, 'compress@10': 0.526, 'time@10': 9.5643}: 100%|██████████| 10/10 [01:09<00:00,  8.09s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.95, 'compress@10': 0.526, 'time@10': 9.5643}: 100%|██████████| 10/10 [01:09<00:00,  6.90s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.012909149809128098
Avg hit ratio: 0.8914846230924329
Avg ndcg: 0.9500111151669698
Avg compression ratio: 0.5260026271308638
Avg train time: 9.56432511806488
Std train time: 2.8363689495908653
[0.8783783783783782, 0.2837837837837839, 0.04054054054054054, 0.7162162162162159, 0.9594594594594594, 0.6081081081081079, 0.3918918918918918, 0.22972972972972971, 0.6081081081081081, 0.28378378378378377]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9244, 'compress@10': 0.8848, 'time@10': 8.3924}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9244, 'compress@10': 0.8848, 'time@10': 8.3924}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8667, 'ndcg@10': 1.0076, 'compress@10': 0.5958, 'time@10': 7.7757}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8667, 'ndcg@10': 1.0076, 'compress@10': 0.5958, 'time@10': 7.7757}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9574, 'compress@10': 0.4564, 'time@10': 7.0738}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9574, 'compress@10': 0.4564, 'time@10': 7.0738}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9576, 'compress@10': 0.5239, 'time@10': 6.9392}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9576, 'compress@10': 0.5239, 'time@10': 6.9392}:  40%|████      | 4/10 [00:20<00:32,  5.35s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9516, 'compress@10': 0.6112, 'time@10': 8.3083}:  40%|████      | 4/10 [00:27<00:32,  5.35s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9516, 'compress@10': 0.6112, 'time@10': 8.3083}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9555, 'compress@10': 0.6121, 'time@10': 8.6527}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9555, 'compress@10': 0.6121, 'time@10': 8.6527}:  60%|██████    | 6/10 [00:38<00:29,  7.45s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9548, 'compress@10': 0.5841, 'time@10': 9.0345}:  60%|██████    | 6/10 [00:43<00:29,  7.45s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9548, 'compress@10': 0.5841, 'time@10': 9.0345}:  70%|███████   | 7/10 [00:43<00:20,  6.88s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9554, 'compress@10': 0.5426, 'time@10': 8.8739}:  70%|███████   | 7/10 [00:51<00:20,  6.88s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9554, 'compress@10': 0.5426, 'time@10': 8.8739}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9495, 'compress@10': 0.5511, 'time@10': 9.4997}:  80%|████████  | 8/10 [00:59<00:14,  7.18s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9495, 'compress@10': 0.5511, 'time@10': 9.4997}:  90%|█████████ | 9/10 [00:59<00:07,  7.21s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9521, 'compress@10': 0.526, 'time@10': 9.5649}:  90%|█████████ | 9/10 [01:09<00:07,  7.21s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9521, 'compress@10': 0.526, 'time@10': 9.5649}: 100%|██████████| 10/10 [01:09<00:00,  8.13s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9521, 'compress@10': 0.526, 'time@10': 9.5649}: 100%|██████████| 10/10 [01:09<00:00,  6.92s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.013668753071706025
Avg hit ratio: 0.8949766865844964
Avg ndcg: 0.9521048913110197
Avg compression ratio: 0.5260001337530879
Avg train time: 9.564927816390991
Std train time: 2.848186153930219
[0.8815789473684209, 0.30263157894736853, 0.03947368421052632, 0.7236842105263155, 0.9605263157894737, 0.5921052631578946, 0.38157894736842096, 0.22368421052631576, 0.618421052631579, 0.2763157894736842]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9266, 'compress@10': 0.8878, 'time@10': 8.4534}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9266, 'compress@10': 0.8878, 'time@10': 8.4534}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9472, 'compress@10': 0.6065, 'time@10': 7.8311}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9472, 'compress@10': 0.6065, 'time@10': 7.8311}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9172, 'compress@10': 0.4632, 'time@10': 7.1242}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9172, 'compress@10': 0.4632, 'time@10': 7.1242}:  30%|███       | 3/10 [00:14<00:32,  4.59s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9278, 'compress@10': 0.5308, 'time@10': 6.9966}:  30%|███       | 3/10 [00:21<00:32,  4.59s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9278, 'compress@10': 0.5308, 'time@10': 6.9966}:  40%|████      | 4/10 [00:21<00:32,  5.40s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9276, 'compress@10': 0.6169, 'time@10': 8.3899}:  40%|████      | 4/10 [00:28<00:32,  5.40s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9276, 'compress@10': 0.6169, 'time@10': 8.3899}:  50%|█████     | 5/10 [00:28<00:29,  5.99s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.936, 'compress@10': 0.6143, 'time@10': 8.7356}:  50%|█████     | 5/10 [00:38<00:29,  5.99s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.936, 'compress@10': 0.6143, 'time@10': 8.7356}:  60%|██████    | 6/10 [00:38<00:30,  7.52s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9409, 'compress@10': 0.5846, 'time@10': 9.1427}:  60%|██████    | 6/10 [00:44<00:30,  7.52s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9409, 'compress@10': 0.5846, 'time@10': 9.1427}:  70%|███████   | 7/10 [00:44<00:20,  6.97s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9438, 'compress@10': 0.5422, 'time@10': 8.9697}:  70%|███████   | 7/10 [00:52<00:20,  6.97s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9438, 'compress@10': 0.5422, 'time@10': 8.9697}:  80%|████████  | 8/10 [00:52<00:14,  7.23s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9463, 'compress@10': 0.5519, 'time@10': 9.5774}:  80%|████████  | 8/10 [00:59<00:14,  7.23s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9463, 'compress@10': 0.5519, 'time@10': 9.5774}:  90%|█████████ | 9/10 [00:59<00:07,  7.24s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9474, 'compress@10': 0.526, 'time@10': 9.6375}:  90%|█████████ | 9/10 [01:09<00:07,  7.24s/it]    {'epoch': 37, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9474, 'compress@10': 0.526, 'time@10': 9.6375}: 100%|██████████| 10/10 [01:09<00:00,  8.16s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9474, 'compress@10': 0.526, 'time@10': 9.6375}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.012832770754905336
Avg hit ratio: 0.9058727439321667
Avg ndcg: 0.9473715415003522
Avg compression ratio: 0.5259910450132299
Avg train time: 9.63746244907379
Std train time: 2.862358476493768
[0.8846153846153845, 0.294871794871795, 0.038461538461538464, 0.7051282051282048, 0.9615384615384616, 0.6025641025641024, 0.39743589743589736, 0.21794871794871792, 0.6025641025641026, 0.2948717948717948]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9266, 'compress@10': 0.8907, 'time@10': 8.5588}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9266, 'compress@10': 0.8907, 'time@10': 8.5588}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9499, 'compress@10': 0.6041, 'time@10': 7.7832}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9499, 'compress@10': 0.6041, 'time@10': 7.7832}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.919, 'compress@10': 0.4614, 'time@10': 7.0812}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.919, 'compress@10': 0.4614, 'time@10': 7.0812}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9294, 'compress@10': 0.5249, 'time@10': 6.8959}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9294, 'compress@10': 0.5249, 'time@10': 6.8959}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.931, 'compress@10': 0.6124, 'time@10': 8.2415}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it] {'epoch': 38, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.931, 'compress@10': 0.6124, 'time@10': 8.2415}:  50%|█████     | 5/10 [00:27<00:29,  5.83s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9387, 'compress@10': 0.6122, 'time@10': 8.5707}:  50%|█████     | 5/10 [00:37<00:29,  5.83s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9387, 'compress@10': 0.6122, 'time@10': 8.5707}:  60%|██████    | 6/10 [00:37<00:29,  7.34s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9397, 'compress@10': 0.585, 'time@10': 8.961}:  60%|██████    | 6/10 [00:43<00:29,  7.34s/it]  {'epoch': 38, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9397, 'compress@10': 0.585, 'time@10': 8.961}:  70%|███████   | 7/10 [00:43<00:20,  6.80s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9407, 'compress@10': 0.5419, 'time@10': 8.8111}:  70%|███████   | 7/10 [00:51<00:20,  6.80s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9407, 'compress@10': 0.5419, 'time@10': 8.8111}:  80%|████████  | 8/10 [00:51<00:14,  7.12s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9461, 'compress@10': 0.5499, 'time@10': 9.4631}:  80%|████████  | 8/10 [00:58<00:14,  7.12s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9461, 'compress@10': 0.5499, 'time@10': 9.4631}:  90%|█████████ | 9/10 [00:58<00:07,  7.20s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9503, 'compress@10': 0.526, 'time@10': 9.5133}:  90%|█████████ | 9/10 [01:08<00:07,  7.20s/it]    {'epoch': 38, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9503, 'compress@10': 0.526, 'time@10': 9.5133}: 100%|██████████| 10/10 [01:08<00:00,  8.06s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9503, 'compress@10': 0.526, 'time@10': 9.5133}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.011888482312709146
Avg hit ratio: 0.9114846230924328
Avg ndcg: 0.9502702433501465
Avg compression ratio: 0.5260106586151669
Avg train time: 9.513258481025696
Std train time: 2.8727070634803953
[0.8874999999999998, 0.2875000000000001, 0.037500000000000006, 0.7124999999999997, 0.9625, 0.5874999999999999, 0.3874999999999999, 0.21249999999999997, 0.6125, 0.31249999999999994]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.8934, 'time@10': 8.4011}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.8934, 'time@10': 8.4011}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9472, 'compress@10': 0.6019, 'time@10': 7.8131}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it] {'epoch': 39, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9472, 'compress@10': 0.6019, 'time@10': 7.8131}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9172, 'compress@10': 0.4596, 'time@10': 7.1921}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9172, 'compress@10': 0.4596, 'time@10': 7.1921}:  30%|███       | 3/10 [00:14<00:32,  4.65s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9278, 'compress@10': 0.5254, 'time@10': 6.9805}:  30%|███       | 3/10 [00:20<00:32,  4.65s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9278, 'compress@10': 0.5254, 'time@10': 6.9805}:  40%|████      | 4/10 [00:20<00:32,  5.33s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9302, 'compress@10': 0.613, 'time@10': 8.282}:  40%|████      | 4/10 [00:27<00:32,  5.33s/it]  {'epoch': 39, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9302, 'compress@10': 0.613, 'time@10': 8.282}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.9376, 'compress@10': 0.6103, 'time@10': 8.6356}:  50%|█████     | 5/10 [00:38<00:29,  5.86s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.9376, 'compress@10': 0.6103, 'time@10': 8.6356}:  60%|██████    | 6/10 [00:38<00:29,  7.42s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.921, 'ndcg@10': 0.9402, 'compress@10': 0.5819, 'time@10': 9.0033}:  60%|██████    | 6/10 [00:43<00:29,  7.42s/it] {'epoch': 39, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.921, 'ndcg@10': 0.9402, 'compress@10': 0.5819, 'time@10': 9.0033}:  70%|███████   | 7/10 [00:43<00:20,  6.84s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9273, 'ndcg@10': 0.9409, 'compress@10': 0.5386, 'time@10': 8.8172}:  70%|███████   | 7/10 [00:51<00:20,  6.84s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9273, 'ndcg@10': 0.9409, 'compress@10': 0.5386, 'time@10': 8.8172}:  80%|████████  | 8/10 [00:51<00:14,  7.06s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.9068, 'ndcg@10': 0.9517, 'compress@10': 0.548, 'time@10': 9.4211}:  80%|████████  | 8/10 [00:58<00:14,  7.06s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.9068, 'ndcg@10': 0.9517, 'compress@10': 0.548, 'time@10': 9.4211}:  90%|█████████ | 9/10 [00:58<00:07,  7.10s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.9555, 'compress@10': 0.526, 'time@10': 9.4946}:  90%|█████████ | 9/10 [01:08<00:07,  7.10s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.9555, 'compress@10': 0.526, 'time@10': 9.4946}: 100%|██████████| 10/10 [01:08<00:00,  8.05s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.9555, 'compress@10': 0.526, 'time@10': 9.4946}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.013315117507549074
Avg hit ratio: 0.913890638130027
Avg ndcg: 0.9554947777526859
Avg compression ratio: 0.5260250227468017
Avg train time: 9.494645595550537
Std train time: 2.748251179764092
[0.8902439024390243, 0.28048780487804886, 0.03658536585365854, 0.719512195121951, 0.9634146341463414, 0.573170731707317, 0.37804878048780477, 0.20731707317073167, 0.6219512195121951, 0.3292682926829268]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.896, 'time@10': 8.3962}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.896, 'time@10': 8.3962}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9488, 'compress@10': 0.5999, 'time@10': 7.6859}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9488, 'compress@10': 0.5999, 'time@10': 7.6859}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9183, 'compress@10': 0.458, 'time@10': 6.9774}:  20%|██        | 2/10 [00:14<00:46,  5.87s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9183, 'compress@10': 0.458, 'time@10': 6.9774}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9286, 'compress@10': 0.5259, 'time@10': 6.8204}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9286, 'compress@10': 0.5259, 'time@10': 6.8204}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9319, 'compress@10': 0.6135, 'time@10': 8.1788}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9319, 'compress@10': 0.6135, 'time@10': 8.1788}:  50%|█████     | 5/10 [00:27<00:29,  5.81s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9393, 'compress@10': 0.6084, 'time@10': 8.5758}:  50%|█████     | 5/10 [00:37<00:29,  5.81s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9393, 'compress@10': 0.6084, 'time@10': 8.5758}:  60%|██████    | 6/10 [00:37<00:29,  7.44s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9413, 'compress@10': 0.579, 'time@10': 8.9519}:  60%|██████    | 6/10 [00:43<00:29,  7.44s/it] {'epoch': 40, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9413, 'compress@10': 0.579, 'time@10': 8.9519}:  70%|███████   | 7/10 [00:43<00:20,  6.86s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9444, 'compress@10': 0.5354, 'time@10': 8.7821}:  70%|███████   | 7/10 [00:51<00:20,  6.86s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9444, 'compress@10': 0.5354, 'time@10': 8.7821}:  80%|████████  | 8/10 [00:51<00:14,  7.10s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9413, 'compress@10': 0.5462, 'time@10': 9.3988}:  80%|████████  | 8/10 [00:58<00:14,  7.10s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9413, 'compress@10': 0.5462, 'time@10': 9.3988}:  90%|█████████ | 9/10 [00:58<00:07,  7.14s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9425, 'compress@10': 0.526, 'time@10': 9.4548}:  90%|█████████ | 9/10 [01:08<00:07,  7.14s/it]     {'epoch': 40, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9425, 'compress@10': 0.526, 'time@10': 9.4548}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9425, 'compress@10': 0.526, 'time@10': 9.4548}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.011960587027697239
Avg hit ratio: 0.9106648316784138
Avg ndcg: 0.9425437559065385
Avg compression ratio: 0.5260395663277471
Avg train time: 9.4547837972641
Std train time: 2.8490809403536383
[0.8928571428571428, 0.2738095238095239, 0.03571428571428572, 0.7261904761904759, 0.9642857142857143, 0.5595238095238095, 0.36904761904761896, 0.20238095238095236, 0.6309523809523809, 0.3452380952380952]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.8985, 'time@10': 8.4591}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.8985, 'time@10': 8.4591}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9517, 'compress@10': 0.5979, 'time@10': 7.783}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]  {'epoch': 41, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9517, 'compress@10': 0.5979, 'time@10': 7.783}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9202, 'compress@10': 0.4564, 'time@10': 7.0693}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9202, 'compress@10': 0.4564, 'time@10': 7.0693}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9305, 'compress@10': 0.5263, 'time@10': 6.8821}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9305, 'compress@10': 0.5263, 'time@10': 6.8821}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9338, 'compress@10': 0.614, 'time@10': 8.2686}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9338, 'compress@10': 0.614, 'time@10': 8.2686}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9468, 'compress@10': 0.6066, 'time@10': 8.6463}:  50%|█████     | 5/10 [00:38<00:29,  5.87s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9468, 'compress@10': 0.6066, 'time@10': 8.6463}:  60%|██████    | 6/10 [00:38<00:29,  7.47s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.9482, 'compress@10': 0.5762, 'time@10': 9.0055}:  60%|██████    | 6/10 [00:43<00:29,  7.47s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.9482, 'compress@10': 0.5762, 'time@10': 9.0055}:  70%|███████   | 7/10 [00:43<00:20,  6.86s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9301, 'ndcg@10': 0.9447, 'compress@10': 0.5324, 'time@10': 8.8445}:  70%|███████   | 7/10 [00:51<00:20,  6.86s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9301, 'ndcg@10': 0.9447, 'compress@10': 0.5324, 'time@10': 8.8445}:  80%|████████  | 8/10 [00:51<00:14,  7.15s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.9532, 'compress@10': 0.5445, 'time@10': 9.423}:  80%|████████  | 8/10 [00:58<00:14,  7.15s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.9532, 'compress@10': 0.5445, 'time@10': 9.423}:  90%|█████████ | 9/10 [00:58<00:07,  7.12s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.9556, 'compress@10': 0.5261, 'time@10': 9.4732}:  90%|█████████ | 9/10 [01:08<00:07,  7.12s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.9556, 'compress@10': 0.5261, 'time@10': 9.4732}: 100%|██████████| 10/10 [01:08<00:00,  8.00s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.9556, 'compress@10': 0.5261, 'time@10': 9.4732}: 100%|██████████| 10/10 [01:08<00:00,  6.85s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.013968272159353168
Avg hit ratio: 0.9161128603522493
Avg ndcg: 0.9556219141440611
Avg compression ratio: 0.5260527554472059
Avg train time: 9.473239374160766
Std train time: 2.7983899581201372
[0.8953488372093023, 0.26744186046511637, 0.034883720930232565, 0.7325581395348835, 0.9418604651162791, 0.5697674418604651, 0.38372093023255804, 0.19767441860465113, 0.6395348837209303, 0.33720930232558133]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.9008, 'time@10': 8.2948}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.9008, 'time@10': 8.2948}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9617, 'compress@10': 0.596, 'time@10': 7.7616}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it] {'epoch': 42, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9617, 'compress@10': 0.596, 'time@10': 7.7616}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9268, 'compress@10': 0.4549, 'time@10': 7.0754}:  20%|██        | 2/10 [00:14<00:47,  6.00s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9268, 'compress@10': 0.4549, 'time@10': 7.0754}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9355, 'compress@10': 0.5267, 'time@10': 6.8756}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it]  {'epoch': 42, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9355, 'compress@10': 0.5267, 'time@10': 6.8756}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9389, 'compress@10': 0.61, 'time@10': 8.2461}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9389, 'compress@10': 0.61, 'time@10': 8.2461}:  50%|█████     | 5/10 [00:27<00:29,  5.85s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9452, 'compress@10': 0.6049, 'time@10': 8.6228}:  50%|█████     | 5/10 [00:38<00:29,  5.85s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9452, 'compress@10': 0.6049, 'time@10': 8.6228}:  60%|██████    | 6/10 [00:38<00:29,  7.45s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9464, 'compress@10': 0.5768, 'time@10': 9.0205}:  60%|██████    | 6/10 [00:43<00:29,  7.45s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9464, 'compress@10': 0.5768, 'time@10': 9.0205}:  70%|███████   | 7/10 [00:43<00:20,  6.89s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9433, 'compress@10': 0.5323, 'time@10': 8.8477}:  70%|███████   | 7/10 [00:51<00:20,  6.89s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9433, 'compress@10': 0.5323, 'time@10': 8.8477}:  80%|████████  | 8/10 [00:51<00:14,  7.15s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9369, 'compress@10': 0.5453, 'time@10': 9.4774}:  80%|████████  | 8/10 [00:58<00:14,  7.15s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9369, 'compress@10': 0.5453, 'time@10': 9.4774}:  90%|█████████ | 9/10 [00:58<00:07,  7.20s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9377, 'compress@10': 0.526, 'time@10': 9.5096}:  90%|█████████ | 9/10 [01:08<00:07,  7.20s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9377, 'compress@10': 0.526, 'time@10': 9.5096}: 100%|██████████| 10/10 [01:08<00:00,  8.01s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9377, 'compress@10': 0.526, 'time@10': 9.5096}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.014894402030515216
Avg hit ratio: 0.8945255587649475
Avg ndcg: 0.9377151929884958
Avg compression ratio: 0.5260205092493101
Avg train time: 9.50962166786194
Std train time: 2.8749499305075537
[0.8749999999999999, 0.28409090909090917, 0.034090909090909095, 0.7386363636363634, 0.9204545454545454, 0.5568181818181819, 0.3749999999999999, 0.21590909090909088, 0.6477272727272727, 0.3522727272727272]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9385, 'compress@10': 0.8816, 'time@10': 8.8471}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9385, 'compress@10': 0.8816, 'time@10': 8.8471}:  10%|█         | 1/10 [00:04<00:40,  4.46s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9531, 'compress@10': 0.5944, 'time@10': 7.9764}:  10%|█         | 1/10 [00:11<00:40,  4.46s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9531, 'compress@10': 0.5944, 'time@10': 7.9764}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9211, 'compress@10': 0.4536, 'time@10': 7.2697}:  20%|██        | 2/10 [00:14<00:48,  6.04s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9211, 'compress@10': 0.4536, 'time@10': 7.2697}:  30%|███       | 3/10 [00:14<00:32,  4.63s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9314, 'compress@10': 0.5272, 'time@10': 7.1571}:  30%|███       | 3/10 [00:21<00:32,  4.63s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9314, 'compress@10': 0.5272, 'time@10': 7.1571}:  40%|████      | 4/10 [00:21<00:33,  5.51s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.9361, 'compress@10': 0.6062, 'time@10': 8.5039}:  40%|████      | 4/10 [00:28<00:33,  5.51s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.9361, 'compress@10': 0.6062, 'time@10': 8.5039}:  50%|█████     | 5/10 [00:28<00:30,  6.04s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0066, 'hit_ratio@10': 0.9247, 'ndcg@10': 0.9429, 'compress@10': 0.5996, 'time@10': 8.8325}:  50%|█████     | 5/10 [00:38<00:30,  6.04s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0066, 'hit_ratio@10': 0.9247, 'ndcg@10': 0.9429, 'compress@10': 0.5996, 'time@10': 8.8325}:  60%|██████    | 6/10 [00:38<00:30,  7.57s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0059, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9451, 'compress@10': 0.5711, 'time@10': 9.1987}:  60%|██████    | 6/10 [00:44<00:30,  7.57s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0059, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9451, 'compress@10': 0.5711, 'time@10': 9.1987}:  70%|███████   | 7/10 [00:44<00:20,  6.97s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0064, 'hit_ratio@10': 0.935, 'ndcg@10': 0.9487, 'compress@10': 0.5295, 'time@10': 9.0001}:  70%|███████   | 7/10 [00:52<00:20,  6.97s/it]  {'epoch': 43, 'num_users': 6.125, 'loss': 0.0064, 'hit_ratio@10': 0.935, 'ndcg@10': 0.9487, 'compress@10': 0.5295, 'time@10': 9.0001}:  80%|████████  | 8/10 [00:52<00:14,  7.19s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0074, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9515, 'compress@10': 0.5437, 'time@10': 9.6198}:  80%|████████  | 8/10 [00:59<00:14,  7.19s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0074, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9515, 'compress@10': 0.5437, 'time@10': 9.6198}:  90%|█████████ | 9/10 [00:59<00:07,  7.23s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0068, 'hit_ratio@10': 0.9229, 'ndcg@10': 0.9541, 'compress@10': 0.5261, 'time@10': 9.6553}:  90%|█████████ | 9/10 [01:09<00:07,  7.23s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0068, 'hit_ratio@10': 0.9229, 'ndcg@10': 0.9541, 'compress@10': 0.5261, 'time@10': 9.6553}: 100%|██████████| 10/10 [01:09<00:00,  8.10s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0068, 'hit_ratio@10': 0.9229, 'ndcg@10': 0.9541, 'compress@10': 0.5261, 'time@10': 9.6553}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.0067809315429174484
Avg hit ratio: 0.92285377177058
Avg ndcg: 0.9540650835547121
Avg compression ratio: 0.5260595710179456
Avg train time: 9.655272960662842
Std train time: 2.8246761049377644
[0.8777777777777777, 0.27777777777777785, 0.03333333333333334, 0.7444444444444442, 0.9222222222222222, 0.5444444444444445, 0.3666666666666666, 0.2333333333333333, 0.6555555555555556, 0.34444444444444433]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9395, 'compress@10': 0.8842, 'time@10': 8.5015}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9395, 'compress@10': 0.8842, 'time@10': 8.5015}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9536, 'compress@10': 0.5926, 'time@10': 7.7062}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9536, 'compress@10': 0.5926, 'time@10': 7.7062}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9215, 'compress@10': 0.4522, 'time@10': 7.0405}:  20%|██        | 2/10 [00:14<00:46,  5.85s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9215, 'compress@10': 0.4522, 'time@10': 7.0405}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9315, 'compress@10': 0.5276, 'time@10': 6.8353}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9315, 'compress@10': 0.5276, 'time@10': 6.8353}:  40%|████      | 4/10 [00:20<00:31,  5.20s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9365, 'compress@10': 0.6068, 'time@10': 8.2074}:  40%|████      | 4/10 [00:27<00:31,  5.20s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9365, 'compress@10': 0.6068, 'time@10': 8.2074}:  50%|█████     | 5/10 [00:27<00:29,  5.81s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9499, 'compress@10': 0.5981, 'time@10': 8.5988}:  50%|█████     | 5/10 [00:37<00:29,  5.81s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9499, 'compress@10': 0.5981, 'time@10': 8.5988}:  60%|██████    | 6/10 [00:37<00:29,  7.43s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9511, 'compress@10': 0.5687, 'time@10': 9.0033}:  60%|██████    | 6/10 [00:43<00:29,  7.43s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9511, 'compress@10': 0.5687, 'time@10': 9.0033}:  70%|███████   | 7/10 [00:43<00:20,  6.88s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.972, 'compress@10': 0.5295, 'time@10': 8.8538}:  70%|███████   | 7/10 [00:51<00:20,  6.88s/it]  {'epoch': 44, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.972, 'compress@10': 0.5295, 'time@10': 8.8538}:  80%|████████  | 8/10 [00:51<00:14,  7.19s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9681, 'compress@10': 0.5446, 'time@10': 9.4638}:  80%|████████  | 8/10 [00:58<00:14,  7.19s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9681, 'compress@10': 0.5446, 'time@10': 9.4638}:  90%|█████████ | 9/10 [00:58<00:07,  7.20s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9678, 'compress@10': 0.5261, 'time@10': 9.536}:  90%|█████████ | 9/10 [01:08<00:07,  7.20s/it]    {'epoch': 44, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9678, 'compress@10': 0.5261, 'time@10': 9.536}: 100%|██████████| 10/10 [01:08<00:00,  8.13s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9678, 'compress@10': 0.5261, 'time@10': 9.536}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.017550628905975287
Avg hit ratio: 0.8986243810895763
Avg ndcg: 0.9677833639484048
Avg compression ratio: 0.5260584197911762
Avg train time: 9.536007261276245
Std train time: 2.864665003600153
[0.858695652173913, 0.27173913043478265, 0.03260869565217392, 0.7499999999999998, 0.9021739130434782, 0.5543478260869565, 0.35869565217391297, 0.24999999999999997, 0.6630434782608696, 0.3586956521739129]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9385, 'compress@10': 0.8661, 'time@10': 8.6747}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9385, 'compress@10': 0.8661, 'time@10': 8.6747}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9579, 'compress@10': 0.5807, 'time@10': 7.8465}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9579, 'compress@10': 0.5807, 'time@10': 7.8465}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9243, 'compress@10': 0.4441, 'time@10': 7.1164}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9243, 'compress@10': 0.4441, 'time@10': 7.1164}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9338, 'compress@10': 0.5228, 'time@10': 6.9266}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9338, 'compress@10': 0.5228, 'time@10': 6.9266}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9385, 'compress@10': 0.599, 'time@10': 8.3021}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9385, 'compress@10': 0.599, 'time@10': 8.3021}:  50%|█████     | 5/10 [00:27<00:29,  5.88s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0082, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9449, 'compress@10': 0.5932, 'time@10': 8.7207}:  50%|█████     | 5/10 [00:38<00:29,  5.88s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0082, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9449, 'compress@10': 0.5932, 'time@10': 8.7207}:  60%|██████    | 6/10 [00:38<00:30,  7.57s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9549, 'compress@10': 0.5634, 'time@10': 9.0763}:  60%|██████    | 6/10 [00:44<00:30,  7.57s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9549, 'compress@10': 0.5634, 'time@10': 9.0763}:  70%|███████   | 7/10 [00:44<00:20,  6.94s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9538, 'compress@10': 0.5269, 'time@10': 8.9009}:  70%|███████   | 7/10 [00:51<00:20,  6.94s/it]  {'epoch': 45, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9538, 'compress@10': 0.5269, 'time@10': 8.9009}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9561, 'compress@10': 0.5431, 'time@10': 9.5067}:  80%|████████  | 8/10 [00:59<00:14,  7.18s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9561, 'compress@10': 0.5431, 'time@10': 9.5067}:  90%|█████████ | 9/10 [00:59<00:07,  7.19s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.956, 'compress@10': 0.5261, 'time@10': 9.5557}:  90%|█████████ | 9/10 [01:09<00:07,  7.19s/it]    {'epoch': 45, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.956, 'compress@10': 0.5261, 'time@10': 9.5557}: 100%|██████████| 10/10 [01:09<00:00,  8.07s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.956, 'compress@10': 0.5261, 'time@10': 9.5557}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.01222128036924799
Avg hit ratio: 0.9021164445816398
Avg ndcg: 0.9560041947200558
Avg compression ratio: 0.526117224115626
Avg train time: 9.555694031715394
Std train time: 2.8595065123865595
[0.8404255319148936, 0.2872340425531915, 0.03191489361702128, 0.7340425531914891, 0.8829787234042552, 0.5425531914893618, 0.3723404255319148, 0.26595744680851063, 0.6702127659574468, 0.37234042553191476]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9385, 'compress@10': 0.8488, 'time@10': 8.4289}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9385, 'compress@10': 0.8488, 'time@10': 8.4289}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9531, 'compress@10': 0.5795, 'time@10': 7.731}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]  {'epoch': 46, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9531, 'compress@10': 0.5795, 'time@10': 7.731}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9211, 'compress@10': 0.4431, 'time@10': 7.035}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9211, 'compress@10': 0.4431, 'time@10': 7.035}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9312, 'compress@10': 0.5182, 'time@10': 6.844}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9312, 'compress@10': 0.5182, 'time@10': 6.844}:  40%|████      | 4/10 [00:20<00:31,  5.22s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9367, 'compress@10': 0.5916, 'time@10': 8.2095}:  40%|████      | 4/10 [00:27<00:31,  5.22s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9367, 'compress@10': 0.5916, 'time@10': 8.2095}:  50%|█████     | 5/10 [00:27<00:29,  5.83s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9428, 'compress@10': 0.5851, 'time@10': 8.5673}:  50%|█████     | 5/10 [00:37<00:29,  5.83s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9428, 'compress@10': 0.5851, 'time@10': 8.5673}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9441, 'compress@10': 0.5583, 'time@10': 8.9617}:  60%|██████    | 6/10 [00:43<00:29,  7.38s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9441, 'compress@10': 0.5583, 'time@10': 8.9617}:  70%|███████   | 7/10 [00:43<00:20,  6.83s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9229, 'ndcg@10': 0.9466, 'compress@10': 0.5244, 'time@10': 8.8254}:  70%|███████   | 7/10 [00:51<00:20,  6.83s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9229, 'ndcg@10': 0.9466, 'compress@10': 0.5244, 'time@10': 8.8254}:  80%|████████  | 8/10 [00:51<00:14,  7.17s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9432, 'compress@10': 0.5416, 'time@10': 9.4685}:  80%|████████  | 8/10 [00:58<00:14,  7.17s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9432, 'compress@10': 0.5416, 'time@10': 9.4685}:  90%|█████████ | 9/10 [00:58<00:07,  7.24s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.9103, 'ndcg@10': 0.9466, 'compress@10': 0.5261, 'time@10': 9.5294}:  90%|█████████ | 9/10 [01:08<00:07,  7.24s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.9103, 'ndcg@10': 0.9466, 'compress@10': 0.5261, 'time@10': 9.5294}: 100%|██████████| 10/10 [01:08<00:00,  8.13s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.9103, 'ndcg@10': 0.9466, 'compress@10': 0.5261, 'time@10': 9.5294}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.0094891765374818
Avg hit ratio: 0.9103192095585981
Avg ndcg: 0.9465625084178692
Avg compression ratio: 0.5261435301305589
Avg train time: 9.529366755485535
Std train time: 2.8832952144687494
[0.8229166666666666, 0.28125, 0.03125000000000001, 0.7395833333333331, 0.8854166666666665, 0.5520833333333334, 0.3854166666666666, 0.2604166666666667, 0.6770833333333334, 0.3645833333333332]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9385, 'compress@10': 0.8322, 'time@10': 8.7212}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9385, 'compress@10': 0.8322, 'time@10': 8.7212}:  10%|█         | 1/10 [00:04<00:39,  4.40s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0045, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9531, 'compress@10': 0.5683, 'time@10': 7.7733}:  10%|█         | 1/10 [00:11<00:39,  4.40s/it] {'epoch': 47, 'num_users': 7.0, 'loss': 0.0045, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9531, 'compress@10': 0.5683, 'time@10': 7.7733}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.003, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9211, 'compress@10': 0.4354, 'time@10': 7.0547}:  20%|██        | 2/10 [00:14<00:46,  5.85s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.003, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9211, 'compress@10': 0.4354, 'time@10': 7.0547}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9312, 'compress@10': 0.5138, 'time@10': 6.881}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]  {'epoch': 47, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9312, 'compress@10': 0.5138, 'time@10': 6.881}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0067, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9374, 'compress@10': 0.5886, 'time@10': 8.301}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0067, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9374, 'compress@10': 0.5886, 'time@10': 8.301}:  50%|█████     | 5/10 [00:27<00:29,  5.88s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0059, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.944, 'compress@10': 0.5842, 'time@10': 8.6212}:  50%|█████     | 5/10 [00:37<00:29,  5.88s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0059, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.944, 'compress@10': 0.5842, 'time@10': 8.6212}:  60%|██████    | 6/10 [00:37<00:29,  7.37s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0054, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9461, 'compress@10': 0.5593, 'time@10': 9.0061}:  60%|██████    | 6/10 [00:43<00:29,  7.37s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0054, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9461, 'compress@10': 0.5593, 'time@10': 9.0061}:  70%|███████   | 7/10 [00:43<00:20,  6.82s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0055, 'hit_ratio@10': 0.9229, 'ndcg@10': 0.9492, 'compress@10': 0.5246, 'time@10': 8.8666}:  70%|███████   | 7/10 [00:51<00:20,  6.82s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0055, 'hit_ratio@10': 0.9229, 'ndcg@10': 0.9492, 'compress@10': 0.5246, 'time@10': 8.8666}:  80%|████████  | 8/10 [00:51<00:14,  7.17s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0057, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9506, 'compress@10': 0.5425, 'time@10': 9.4896}:  80%|████████  | 8/10 [00:58<00:14,  7.17s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0057, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9506, 'compress@10': 0.5425, 'time@10': 9.4896}:  90%|█████████ | 9/10 [00:58<00:07,  7.21s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0077, 'hit_ratio@10': 0.9103, 'ndcg@10': 0.9494, 'compress@10': 0.5262, 'time@10': 9.5607}:  90%|█████████ | 9/10 [01:08<00:07,  7.21s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0077, 'hit_ratio@10': 0.9103, 'ndcg@10': 0.9494, 'compress@10': 0.5262, 'time@10': 9.5607}: 100%|██████████| 10/10 [01:08<00:00,  8.14s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0077, 'hit_ratio@10': 0.9103, 'ndcg@10': 0.9494, 'compress@10': 0.5262, 'time@10': 9.5607}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.007699777282640187
Avg hit ratio: 0.9103192095585981
Avg ndcg: 0.94938352209894
Avg compression ratio: 0.5261776914619675
Avg train time: 9.560745072364806
Std train time: 2.904712656484091
[0.8265306122448979, 0.2755102040816326, 0.03061224489795919, 0.7448979591836733, 0.8877551020408162, 0.5408163265306123, 0.3775510204081632, 0.25510204081632654, 0.6836734693877551, 0.37755102040816313]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9334, 'compress@10': 0.8356, 'time@10': 8.5175}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9334, 'compress@10': 0.8356, 'time@10': 8.5175}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9557, 'compress@10': 0.5673, 'time@10': 7.8097}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it] {'epoch': 48, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9557, 'compress@10': 0.5673, 'time@10': 7.8097}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9228, 'compress@10': 0.4345, 'time@10': 7.0899}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9228, 'compress@10': 0.4345, 'time@10': 7.0899}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9332, 'compress@10': 0.5144, 'time@10': 6.9222}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9332, 'compress@10': 0.5144, 'time@10': 6.9222}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9392, 'compress@10': 0.5895, 'time@10': 8.3909}:  40%|████      | 4/10 [00:27<00:31,  5.30s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9392, 'compress@10': 0.5895, 'time@10': 8.3909}:  50%|█████     | 5/10 [00:27<00:29,  5.98s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9494, 'compress@10': 0.5831, 'time@10': 8.7445}:  50%|█████     | 5/10 [00:38<00:29,  5.98s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9494, 'compress@10': 0.5831, 'time@10': 8.7445}:  60%|██████    | 6/10 [00:38<00:30,  7.53s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.9191, 'ndcg@10': 0.9507, 'compress@10': 0.5573, 'time@10': 9.0808}:  60%|██████    | 6/10 [00:44<00:30,  7.53s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.9191, 'ndcg@10': 0.9507, 'compress@10': 0.5573, 'time@10': 9.0808}:  70%|███████   | 7/10 [00:44<00:20,  6.90s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9257, 'ndcg@10': 0.9714, 'compress@10': 0.5222, 'time@10': 8.8991}:  70%|███████   | 7/10 [00:51<00:20,  6.90s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9257, 'ndcg@10': 0.9714, 'compress@10': 0.5222, 'time@10': 8.8991}:  80%|████████  | 8/10 [00:51<00:14,  7.14s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9703, 'compress@10': 0.5411, 'time@10': 9.4779}:  80%|████████  | 8/10 [00:58<00:14,  7.14s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9703, 'compress@10': 0.5411, 'time@10': 9.4779}:  90%|█████████ | 9/10 [00:58<00:07,  7.13s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.971, 'compress@10': 0.5262, 'time@10': 9.517}:  90%|█████████ | 9/10 [01:08<00:07,  7.13s/it]     {'epoch': 48, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.971, 'compress@10': 0.5262, 'time@10': 9.517}: 100%|██████████| 10/10 [01:08<00:00,  7.98s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.971, 'compress@10': 0.5262, 'time@10': 9.517}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.01365512162124766
Avg hit ratio: 0.9096842889236776
Avg ndcg: 0.9709851299462577
Avg compression ratio: 0.5261873256164827
Avg train time: 9.517018938064576
Std train time: 2.866972570533953
[0.83, 0.29, 0.030000000000000006, 0.7299999999999999, 0.8699999999999999, 0.55, 0.36999999999999994, 0.27, 0.69, 0.3699999999999999]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9385, 'compress@10': 0.8389, 'time@10': 8.3691}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9385, 'compress@10': 0.8389, 'time@10': 8.3691}:  10%|█         | 1/10 [00:04<00:38,  4.22s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9882, 'compress@10': 0.5759, 'time@10': 7.5501}:  10%|█         | 1/10 [00:10<00:38,  4.22s/it] {'epoch': 49, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9882, 'compress@10': 0.5759, 'time@10': 7.5501}:  20%|██        | 2/10 [00:10<00:45,  5.72s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9445, 'compress@10': 0.4401, 'time@10': 6.806}:  20%|██        | 2/10 [00:13<00:45,  5.72s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9445, 'compress@10': 0.4401, 'time@10': 6.806}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9495, 'compress@10': 0.515, 'time@10': 6.6121}:  30%|███       | 3/10 [00:19<00:30,  4.35s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9495, 'compress@10': 0.515, 'time@10': 6.6121}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9534, 'compress@10': 0.5865, 'time@10': 7.9484}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9534, 'compress@10': 0.5865, 'time@10': 7.9484}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.9573, 'compress@10': 0.5821, 'time@10': 8.3199}:  50%|█████     | 5/10 [00:36<00:28,  5.63s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.9573, 'compress@10': 0.5821, 'time@10': 8.3199}:  60%|██████    | 6/10 [00:36<00:28,  7.19s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9587, 'compress@10': 0.5554, 'time@10': 8.6593}:  60%|██████    | 6/10 [00:42<00:28,  7.19s/it] {'epoch': 49, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9587, 'compress@10': 0.5554, 'time@10': 8.6593}:  70%|███████   | 7/10 [00:42<00:19,  6.60s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.959, 'compress@10': 0.5223, 'time@10': 8.4984}:  70%|███████   | 7/10 [00:49<00:19,  6.60s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.959, 'compress@10': 0.5223, 'time@10': 8.4984}:  80%|████████  | 8/10 [00:49<00:13,  6.86s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0099, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.9597, 'compress@10': 0.5419, 'time@10': 9.1064}:  80%|████████  | 8/10 [00:56<00:13,  6.86s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0099, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.9597, 'compress@10': 0.5419, 'time@10': 9.1064}:  90%|█████████ | 9/10 [00:56<00:06,  6.91s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9564, 'compress@10': 0.5262, 'time@10': 9.1488}:  90%|█████████ | 9/10 [01:06<00:06,  6.91s/it]    {'epoch': 49, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9564, 'compress@10': 0.5262, 'time@10': 9.1488}: 100%|██████████| 10/10 [01:06<00:00,  7.73s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9564, 'compress@10': 0.5262, 'time@10': 9.1488}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.01098485145605773
Avg hit ratio: 0.873811273050662
Avg ndcg: 0.956392233599271
Avg compression ratio: 0.5261868430805925
Avg train time: 9.148836922645568
Std train time: 2.793336290795516
[0.8137254901960784, 0.30392156862745096, 0.02941176470588236, 0.7352941176470587, 0.8529411764705881, 0.5392156862745099, 0.3823529411764705, 0.28431372549019607, 0.676470588235294, 0.38235294117647045]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
