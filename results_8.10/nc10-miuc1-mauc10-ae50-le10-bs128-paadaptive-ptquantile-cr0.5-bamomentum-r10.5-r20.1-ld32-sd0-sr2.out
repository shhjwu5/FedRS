  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1535, 'hit_ratio@10': 0.6316, 'ndcg@10': 0.5065, 'compress@10': 0.5263, 'time@10': 9.7236}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1535, 'hit_ratio@10': 0.6316, 'ndcg@10': 0.5065, 'compress@10': 0.5263, 'time@10': 9.7236}:  10%|█         | 1/10 [00:04<00:44,  4.90s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1129, 'hit_ratio@10': 0.7029, 'ndcg@10': 0.6493, 'compress@10': 0.5212, 'time@10': 8.5076}:  10%|█         | 1/10 [00:12<00:44,  4.90s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1129, 'hit_ratio@10': 0.7029, 'ndcg@10': 0.6493, 'compress@10': 0.5212, 'time@10': 8.5076}:  20%|██        | 2/10 [00:12<00:50,  6.33s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7417, 'hit_ratio@10': 0.5638, 'ndcg@10': 0.4329, 'compress@10': 0.538, 'time@10': 6.6604}:  20%|██        | 2/10 [00:13<00:50,  6.33s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.7417, 'hit_ratio@10': 0.5638, 'ndcg@10': 0.4329, 'compress@10': 0.538, 'time@10': 6.6604}:  30%|███       | 3/10 [00:13<00:28,  4.13s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5801, 'hit_ratio@10': 0.6193, 'ndcg@10': 0.4939, 'compress@10': 0.5329, 'time@10': 6.5908}:  30%|███       | 3/10 [00:20<00:28,  4.13s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5801, 'hit_ratio@10': 0.6193, 'ndcg@10': 0.4939, 'compress@10': 0.5329, 'time@10': 6.5908}:  40%|████      | 4/10 [00:20<00:30,  5.04s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4827, 'hit_ratio@10': 0.6594, 'ndcg@10': 0.547, 'compress@10': 0.5283, 'time@10': 9.9617}:  40%|████      | 4/10 [00:31<00:30,  5.04s/it] {'epoch': 0, 'num_users': 5.8, 'loss': 0.4827, 'hit_ratio@10': 0.6594, 'ndcg@10': 0.547, 'compress@10': 0.5283, 'time@10': 9.9617}:  50%|█████     | 5/10 [00:31<00:37,  7.46s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4167, 'hit_ratio@10': 0.6681, 'ndcg@10': 0.5852, 'compress@10': 0.5255, 'time@10': 10.0495}:  50%|█████     | 5/10 [00:42<00:37,  7.46s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4167, 'hit_ratio@10': 0.6681, 'ndcg@10': 0.5852, 'compress@10': 0.5255, 'time@10': 10.0495}:  60%|██████    | 6/10 [00:42<00:34,  8.50s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.372, 'hit_ratio@10': 0.6755, 'ndcg@10': 0.5872, 'compress@10': 0.5247, 'time@10': 10.2636}:  60%|██████    | 6/10 [00:48<00:34,  8.50s/it] {'epoch': 0, 'num_users': 6.2857, 'loss': 0.372, 'hit_ratio@10': 0.6755, 'ndcg@10': 0.5872, 'compress@10': 0.5247, 'time@10': 10.2636}:  70%|███████   | 7/10 [00:48<00:22,  7.62s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3316, 'hit_ratio@10': 0.7053, 'ndcg@10': 0.6122, 'compress@10': 0.5234, 'time@10': 10.0088}:  70%|███████   | 7/10 [00:56<00:22,  7.62s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3316, 'hit_ratio@10': 0.7053, 'ndcg@10': 0.6122, 'compress@10': 0.5234, 'time@10': 10.0088}:  80%|████████  | 8/10 [00:56<00:15,  7.83s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3004, 'hit_ratio@10': 0.7095, 'ndcg@10': 0.6448, 'compress@10': 0.5224, 'time@10': 10.7351}:  80%|████████  | 8/10 [01:04<00:15,  7.83s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3004, 'hit_ratio@10': 0.7095, 'ndcg@10': 0.6448, 'compress@10': 0.5224, 'time@10': 10.7351}:  90%|█████████ | 9/10 [01:04<00:07,  7.98s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2756, 'hit_ratio@10': 0.7317, 'ndcg@10': 0.6649, 'compress@10': 0.5213, 'time@10': 10.7154}:  90%|█████████ | 9/10 [01:15<00:07,  7.98s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2756, 'hit_ratio@10': 0.7317, 'ndcg@10': 0.6649, 'compress@10': 0.5213, 'time@10': 10.7154}: 100%|██████████| 10/10 [01:15<00:00,  8.78s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2756, 'hit_ratio@10': 0.7317, 'ndcg@10': 0.6649, 'compress@10': 0.5213, 'time@10': 10.7154}: 100%|██████████| 10/10 [01:15<00:00,  7.54s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.27560226256935527
Avg hit ratio: 0.7317273217256239
Avg ndcg: 0.6649142450246172
Avg compression ratio: 0.5212734095913192
Avg train time: 10.715430808067321
Std train time: 5.427217000648282
[0.75, 0.25, 0.75, 0.75, 0.75, 0.25, 0.75, 0.25, 0.25, 0.25]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0538, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8244, 'compress@10': 0.7632, 'time@10': 9.1323}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0538, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8244, 'compress@10': 0.7632, 'time@10': 9.1323}:  10%|█         | 1/10 [00:04<00:41,  4.60s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0533, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8394, 'compress@10': 0.5187, 'time@10': 8.1214}:  10%|█         | 1/10 [00:11<00:41,  4.60s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0533, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8394, 'compress@10': 0.5187, 'time@10': 8.1214}:  20%|██        | 2/10 [00:11<00:48,  6.11s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0416, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8202, 'compress@10': 0.6077, 'time@10': 6.4493}:  20%|██        | 2/10 [00:13<00:48,  6.11s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0416, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8202, 'compress@10': 0.6077, 'time@10': 6.4493}:  30%|███       | 3/10 [00:13<00:28,  4.05s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0437, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8259, 'compress@10': 0.6455, 'time@10': 6.4516}:  30%|███       | 3/10 [00:19<00:28,  4.05s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0437, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8259, 'compress@10': 0.6455, 'time@10': 6.4516}:  40%|████      | 4/10 [00:19<00:30,  5.01s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0523, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8177, 'compress@10': 0.6674, 'time@10': 9.4438}:  40%|████      | 4/10 [00:30<00:30,  5.01s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0523, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8177, 'compress@10': 0.6674, 'time@10': 9.4438}:  50%|█████     | 5/10 [00:30<00:35,  7.12s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0564, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8164, 'compress@10': 0.6006, 'time@10': 9.6168}:  50%|█████     | 5/10 [00:41<00:35,  7.12s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0564, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8164, 'compress@10': 0.6006, 'time@10': 9.6168}:  60%|██████    | 6/10 [00:41<00:33,  8.28s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0546, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8235, 'compress@10': 0.6234, 'time@10': 9.8999}:  60%|██████    | 6/10 [00:47<00:33,  8.28s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0546, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8235, 'compress@10': 0.6234, 'time@10': 9.8999}:  70%|███████   | 7/10 [00:47<00:22,  7.48s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0524, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8302, 'compress@10': 0.5794, 'time@10': 9.6795}:  70%|███████   | 7/10 [00:55<00:22,  7.48s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0524, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8302, 'compress@10': 0.5794, 'time@10': 9.6795}:  80%|████████  | 8/10 [00:55<00:15,  7.70s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8391, 'compress@10': 0.5452, 'time@10': 10.2145}:  80%|████████  | 8/10 [01:02<00:15,  7.70s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8391, 'compress@10': 0.5452, 'time@10': 10.2145}:  90%|█████████ | 9/10 [01:02<00:07,  7.57s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.05, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8394, 'compress@10': 0.5174, 'time@10': 10.216}:  90%|█████████ | 9/10 [01:12<00:07,  7.57s/it]      {'epoch': 1, 'num_users': 6.3, 'loss': 0.05, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8394, 'compress@10': 0.5174, 'time@10': 10.216}: 100%|██████████| 10/10 [01:12<00:00,  8.41s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.05, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8394, 'compress@10': 0.5174, 'time@10': 10.216}: 100%|██████████| 10/10 [01:12<00:00,  7.28s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.050018277893908204
Avg hit ratio: 0.8286755255685646
Avg ndcg: 0.839402882527877
Avg compression ratio: 0.5173535459253261
Avg train time: 10.215957927703858
Std train time: 4.74844785923412
[0.8333333333333334, 0.5, 0.5, 0.8333333333333334, 0.8333333333333334, 0.5, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.8421, 'time@10': 8.556}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.8421, 'time@10': 8.556}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.798, 'ndcg@10': 0.851, 'compress@10': 0.6791, 'time@10': 7.9206}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.798, 'ndcg@10': 0.851, 'compress@10': 0.6791, 'time@10': 7.9206}:  20%|██        | 2/10 [00:11<00:48,  6.09s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8531, 'compress@10': 0.6432, 'time@10': 6.4138}:  20%|██        | 2/10 [00:13<00:48,  6.09s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8531, 'compress@10': 0.6432, 'time@10': 6.4138}:  30%|███       | 3/10 [00:13<00:28,  4.10s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8489, 'compress@10': 0.6922, 'time@10': 6.4409}:  30%|███       | 3/10 [00:19<00:28,  4.10s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8489, 'compress@10': 0.6922, 'time@10': 6.4409}:  40%|████      | 4/10 [00:19<00:30,  5.07s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0478, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8357, 'compress@10': 0.7211, 'time@10': 8.8621}:  40%|████      | 4/10 [00:29<00:30,  5.07s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.0478, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8357, 'compress@10': 0.7211, 'time@10': 8.8621}:  50%|█████     | 5/10 [00:29<00:33,  6.60s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0523, 'hit_ratio@10': 0.7689, 'ndcg@10': 0.8328, 'compress@10': 0.6861, 'time@10': 9.1611}:  50%|█████     | 5/10 [00:39<00:33,  6.60s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0523, 'hit_ratio@10': 0.7689, 'ndcg@10': 0.8328, 'compress@10': 0.6861, 'time@10': 9.1611}:  60%|██████    | 6/10 [00:39<00:31,  7.99s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0511, 'hit_ratio@10': 0.7962, 'ndcg@10': 0.8366, 'compress@10': 0.6624, 'time@10': 9.536}:  60%|██████    | 6/10 [00:45<00:31,  7.99s/it] {'epoch': 2, 'num_users': 6.2857, 'loss': 0.0511, 'hit_ratio@10': 0.7962, 'ndcg@10': 0.8366, 'compress@10': 0.6624, 'time@10': 9.536}:  70%|███████   | 7/10 [00:45<00:21,  7.32s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0511, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8405, 'compress@10': 0.6034, 'time@10': 9.352}:  70%|███████   | 7/10 [00:53<00:21,  7.32s/it]  {'epoch': 2, 'num_users': 6.125, 'loss': 0.0511, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8405, 'compress@10': 0.6034, 'time@10': 9.352}:  80%|████████  | 8/10 [00:53<00:15,  7.57s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0512, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.854, 'compress@10': 0.5575, 'time@10': 9.9392}:  80%|████████  | 8/10 [01:01<00:15,  7.57s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0512, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.854, 'compress@10': 0.5575, 'time@10': 9.9392}:  90%|█████████ | 9/10 [01:01<00:07,  7.50s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0509, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8527, 'compress@10': 0.5203, 'time@10': 9.9408}:  90%|█████████ | 9/10 [01:11<00:07,  7.50s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 0.0509, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8527, 'compress@10': 0.5203, 'time@10': 9.9408}: 100%|██████████| 10/10 [01:11<00:00,  8.27s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0509, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8527, 'compress@10': 0.5203, 'time@10': 9.9408}: 100%|██████████| 10/10 [01:11<00:00,  7.13s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.050898046028973465
Avg hit ratio: 0.8248219669408124
Avg ndcg: 0.8527282139196452
Avg compression ratio: 0.5203258597698089
Avg train time: 9.940778660774232
Std train time: 4.086510061206797
[0.625, 0.625, 0.375, 0.625, 0.875, 0.625, 0.375, 0.375, 0.375, 0.125]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8533, 'compress@10': 0.6447, 'time@10': 8.9562}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8533, 'compress@10': 0.6447, 'time@10': 8.9562}:  10%|█         | 1/10 [00:04<00:40,  4.54s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8542, 'compress@10': 0.6409, 'time@10': 8.1004}:  10%|█         | 1/10 [00:11<00:40,  4.54s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8542, 'compress@10': 0.6409, 'time@10': 8.1004}:  20%|██        | 2/10 [00:11<00:49,  6.15s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8552, 'compress@10': 0.582, 'time@10': 6.6756}:  20%|██        | 2/10 [00:13<00:49,  6.15s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8552, 'compress@10': 0.582, 'time@10': 6.6756}:  30%|███       | 3/10 [00:13<00:29,  4.23s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0374, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8486, 'compress@10': 0.5961, 'time@10': 6.6863}:  30%|███       | 3/10 [00:20<00:29,  4.23s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0374, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8486, 'compress@10': 0.5961, 'time@10': 6.6863}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0467, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8373, 'compress@10': 0.6524, 'time@10': 8.6522}:  40%|████      | 4/10 [00:28<00:31,  5.23s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0467, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8373, 'compress@10': 0.6524, 'time@10': 8.6522}:  50%|█████     | 5/10 [00:28<00:31,  6.34s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0506, 'hit_ratio@10': 0.7813, 'ndcg@10': 0.8349, 'compress@10': 0.6492, 'time@10': 8.9929}:  50%|█████     | 5/10 [00:39<00:31,  6.34s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0506, 'hit_ratio@10': 0.7813, 'ndcg@10': 0.8349, 'compress@10': 0.6492, 'time@10': 8.9929}:  60%|██████    | 6/10 [00:39<00:31,  7.84s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0498, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8376, 'compress@10': 0.6136, 'time@10': 9.3978}:  60%|██████    | 6/10 [00:45<00:31,  7.84s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0498, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8376, 'compress@10': 0.6136, 'time@10': 9.3978}:  70%|███████   | 7/10 [00:45<00:21,  7.22s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0519, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8438, 'compress@10': 0.586, 'time@10': 9.2616}:  70%|███████   | 7/10 [00:53<00:21,  7.22s/it]  {'epoch': 3, 'num_users': 6.125, 'loss': 0.0519, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8438, 'compress@10': 0.586, 'time@10': 9.2616}:  80%|████████  | 8/10 [00:53<00:15,  7.58s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0508, 'hit_ratio@10': 0.818, 'ndcg@10': 0.8505, 'compress@10': 0.5646, 'time@10': 9.8862}:  80%|████████  | 8/10 [01:01<00:15,  7.58s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0508, 'hit_ratio@10': 0.818, 'ndcg@10': 0.8505, 'compress@10': 0.5646, 'time@10': 9.8862}:  90%|█████████ | 9/10 [01:01<00:07,  7.55s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0505, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8497, 'compress@10': 0.5226, 'time@10': 9.876}:  90%|█████████ | 9/10 [01:11<00:07,  7.55s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0505, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8497, 'compress@10': 0.5226, 'time@10': 9.876}: 100%|██████████| 10/10 [01:11<00:00,  8.25s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0505, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8497, 'compress@10': 0.5226, 'time@10': 9.876}: 100%|██████████| 10/10 [01:11<00:00,  7.12s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.05045017109178322
Avg hit ratio: 0.8294128527575048
Avg ndcg: 0.849724239500263
Avg compression ratio: 0.5225918242364335
Avg train time: 9.8759694814682
Std train time: 3.6116848206598386
[0.5, 0.7, 0.3, 0.7, 0.9, 0.7, 0.3, 0.5, 0.3, 0.1]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8597, 'compress@10': 0.5263, 'time@10': 8.5664}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8597, 'compress@10': 0.5263, 'time@10': 8.5664}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8557, 'compress@10': 0.618, 'time@10': 7.9131}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8557, 'compress@10': 0.618, 'time@10': 7.9131}:  20%|██        | 2/10 [00:11<00:48,  6.09s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8562, 'compress@10': 0.5453, 'time@10': 6.5555}:  20%|██        | 2/10 [00:13<00:48,  6.09s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8562, 'compress@10': 0.5453, 'time@10': 6.5555}:  30%|███       | 3/10 [00:13<00:29,  4.20s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0371, 'hit_ratio@10': 0.782, 'ndcg@10': 0.849, 'compress@10': 0.5867, 'time@10': 6.5728}:  30%|███       | 3/10 [00:20<00:29,  4.20s/it]  {'epoch': 4, 'num_users': 5.0, 'loss': 0.0371, 'hit_ratio@10': 0.782, 'ndcg@10': 0.849, 'compress@10': 0.5867, 'time@10': 6.5728}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0465, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8365, 'compress@10': 0.6497, 'time@10': 7.9227}:  40%|████      | 4/10 [00:26<00:31,  5.17s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0465, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8365, 'compress@10': 0.6497, 'time@10': 7.9227}:  50%|█████     | 5/10 [00:26<00:28,  5.72s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0497, 'hit_ratio@10': 0.7877, 'ndcg@10': 0.835, 'compress@10': 0.6592, 'time@10': 8.3343}:  50%|█████     | 5/10 [00:37<00:28,  5.72s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0497, 'hit_ratio@10': 0.7877, 'ndcg@10': 0.835, 'compress@10': 0.6592, 'time@10': 8.3343}:  60%|██████    | 6/10 [00:37<00:29,  7.32s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.049, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8396, 'compress@10': 0.6119, 'time@10': 8.7638}:  60%|██████    | 6/10 [00:43<00:29,  7.32s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.049, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8396, 'compress@10': 0.6119, 'time@10': 8.7638}:  70%|███████   | 7/10 [00:43<00:20,  6.80s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0504, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.843, 'compress@10': 0.5997, 'time@10': 8.6937}:  70%|███████   | 7/10 [00:51<00:20,  6.80s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0504, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.843, 'compress@10': 0.5997, 'time@10': 8.6937}:  80%|████████  | 8/10 [00:51<00:14,  7.26s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0489, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8529, 'compress@10': 0.5686, 'time@10': 9.363}:  80%|████████  | 8/10 [00:58<00:14,  7.26s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0489, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8529, 'compress@10': 0.5686, 'time@10': 9.363}:  90%|█████████ | 9/10 [00:58<00:07,  7.30s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8522, 'compress@10': 0.5238, 'time@10': 9.3709}:  90%|█████████ | 9/10 [01:08<00:07,  7.30s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8522, 'compress@10': 0.5238, 'time@10': 9.3709}: 100%|██████████| 10/10 [01:08<00:00,  7.97s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8522, 'compress@10': 0.5238, 'time@10': 9.3709}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.048600689946611694
Avg hit ratio: 0.8303493606940127
Avg ndcg: 0.8522194055961398
Avg compression ratio: 0.523808586691395
Avg train time: 9.37087140083313
Std train time: 3.06142188026389
[0.5833333333333334, 0.5833333333333333, 0.25, 0.75, 0.9166666666666667, 0.75, 0.25, 0.5833333333333334, 0.25, 0.08333333333333334]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8561, 'compress@10': 0.6053, 'time@10': 8.5643}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8561, 'compress@10': 0.6053, 'time@10': 8.5643}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0464, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8517, 'compress@10': 0.601, 'time@10': 7.9832}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it] {'epoch': 5, 'num_users': 7.0, 'loss': 0.0464, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8517, 'compress@10': 0.601, 'time@10': 7.9832}:  20%|██        | 2/10 [00:11<00:49,  6.16s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8535, 'compress@10': 0.5197, 'time@10': 6.69}:  20%|██        | 2/10 [00:13<00:49,  6.16s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8535, 'compress@10': 0.5197, 'time@10': 6.69}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8514, 'compress@10': 0.5795, 'time@10': 6.6219}:  30%|███       | 3/10 [00:20<00:30,  4.30s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8514, 'compress@10': 0.5795, 'time@10': 6.6219}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0455, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8377, 'compress@10': 0.6473, 'time@10': 7.9708}:  40%|████      | 4/10 [00:27<00:30,  5.15s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0455, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8377, 'compress@10': 0.6473, 'time@10': 7.9708}:  50%|█████     | 5/10 [00:27<00:28,  5.72s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.048, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8364, 'compress@10': 0.6653, 'time@10': 8.3917}:  50%|█████     | 5/10 [00:37<00:28,  5.72s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.048, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8364, 'compress@10': 0.6653, 'time@10': 8.3917}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0469, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8399, 'compress@10': 0.6103, 'time@10': 8.742}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it] {'epoch': 5, 'num_users': 6.2857, 'loss': 0.0469, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8399, 'compress@10': 0.6103, 'time@10': 8.742}:  70%|███████   | 7/10 [00:43<00:20,  6.74s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0474, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8411, 'compress@10': 0.6084, 'time@10': 8.6729}:  70%|███████   | 7/10 [00:51<00:20,  6.74s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0474, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8411, 'compress@10': 0.6084, 'time@10': 8.6729}:  80%|████████  | 8/10 [00:51<00:14,  7.21s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0476, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8522, 'compress@10': 0.571, 'time@10': 9.2987}:  80%|████████  | 8/10 [00:58<00:14,  7.21s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0476, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8522, 'compress@10': 0.571, 'time@10': 9.2987}:  90%|█████████ | 9/10 [00:58<00:07,  7.20s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0469, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8529, 'compress@10': 0.5243, 'time@10': 9.3273}:  90%|█████████ | 9/10 [01:08<00:07,  7.20s/it]  {'epoch': 5, 'num_users': 6.3, 'loss': 0.0469, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8529, 'compress@10': 0.5243, 'time@10': 9.3273}: 100%|██████████| 10/10 [01:08<00:00,  7.95s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0469, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8529, 'compress@10': 0.5243, 'time@10': 9.3273}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04694621589950405
Avg hit ratio: 0.8658767544472129
Avg ndcg: 0.8528794316615684
Avg compression ratio: 0.5242799900778965
Avg train time: 9.327266359329224
Std train time: 2.935352577435109
[0.5, 0.49999999999999994, 0.2142857142857143, 0.7857142857142857, 0.9285714285714286, 0.7857142857142857, 0.2142857142857143, 0.6428571428571429, 0.35714285714285715, 0.07142857142857144]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8627, 'compress@10': 0.5263, 'time@10': 8.8835}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8627, 'compress@10': 0.5263, 'time@10': 8.8835}:  10%|█         | 1/10 [00:04<00:40,  4.48s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8591, 'compress@10': 0.5212, 'time@10': 8.085}:  10%|█         | 1/10 [00:11<00:40,  4.48s/it] {'epoch': 6, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8591, 'compress@10': 0.5212, 'time@10': 8.085}:  20%|██        | 2/10 [00:11<00:49,  6.15s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8584, 'compress@10': 0.4563, 'time@10': 6.839}:  20%|██        | 2/10 [00:14<00:49,  6.15s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8584, 'compress@10': 0.4563, 'time@10': 6.839}:  30%|███       | 3/10 [00:14<00:30,  4.35s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8556, 'compress@10': 0.5406, 'time@10': 6.7527}:  30%|███       | 3/10 [00:20<00:30,  4.35s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8556, 'compress@10': 0.5406, 'time@10': 6.7527}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0445, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8413, 'compress@10': 0.6185, 'time@10': 8.0689}:  40%|████      | 4/10 [00:27<00:31,  5.21s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0445, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8413, 'compress@10': 0.6185, 'time@10': 8.0689}:  50%|█████     | 5/10 [00:27<00:28,  5.75s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0464, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8405, 'compress@10': 0.6471, 'time@10': 8.4784}:  50%|█████     | 5/10 [00:37<00:28,  5.75s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0464, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8405, 'compress@10': 0.6471, 'time@10': 8.4784}:  60%|██████    | 6/10 [00:37<00:29,  7.39s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0464, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8461, 'compress@10': 0.5898, 'time@10': 8.839}:  60%|██████    | 6/10 [00:43<00:29,  7.39s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.0464, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8461, 'compress@10': 0.5898, 'time@10': 8.839}:  70%|███████   | 7/10 [00:43<00:20,  6.78s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0467, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8448, 'compress@10': 0.5977, 'time@10': 8.7592}:  70%|███████   | 7/10 [00:51<00:20,  6.78s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0467, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8448, 'compress@10': 0.5977, 'time@10': 8.7592}:  80%|████████  | 8/10 [00:51<00:14,  7.25s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0491, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8663, 'compress@10': 0.573, 'time@10': 9.3984}:  80%|████████  | 8/10 [00:58<00:14,  7.25s/it] {'epoch': 6, 'num_users': 6.3333, 'loss': 0.0491, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8663, 'compress@10': 0.573, 'time@10': 9.3984}:  90%|█████████ | 9/10 [00:58<00:07,  7.26s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0483, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8659, 'compress@10': 0.525, 'time@10': 9.3925}:  90%|█████████ | 9/10 [01:08<00:07,  7.26s/it]  {'epoch': 6, 'num_users': 6.3, 'loss': 0.0483, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8659, 'compress@10': 0.525, 'time@10': 9.3925}: 100%|██████████| 10/10 [01:08<00:00,  7.92s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0483, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8659, 'compress@10': 0.525, 'time@10': 9.3925}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.048283688749451915
Avg hit ratio: 0.8554445987892507
Avg ndcg: 0.8659216045681966
Avg compression ratio: 0.5249607056513105
Avg train time: 9.39248330593109
Std train time: 2.925528135716537
[0.4375, 0.43749999999999994, 0.1875, 0.8125, 0.9375, 0.8125, 0.1875, 0.6875, 0.4375, 0.06250000000000001]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8353, 'compress@10': 0.4671, 'time@10': 8.5902}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8353, 'compress@10': 0.4671, 'time@10': 8.5902}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8513, 'compress@10': 0.4614, 'time@10': 7.8644}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8513, 'compress@10': 0.4614, 'time@10': 7.8644}:  20%|██        | 2/10 [00:11<00:48,  6.00s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8533, 'compress@10': 0.4088, 'time@10': 6.8075}:  20%|██        | 2/10 [00:13<00:48,  6.00s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8533, 'compress@10': 0.4088, 'time@10': 6.8075}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0354, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8523, 'compress@10': 0.5114, 'time@10': 6.6867}:  30%|███       | 3/10 [00:20<00:30,  4.35s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0354, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8523, 'compress@10': 0.5114, 'time@10': 6.6867}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0435, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8389, 'compress@10': 0.5969, 'time@10': 8.0218}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0435, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8389, 'compress@10': 0.5969, 'time@10': 8.0218}:  50%|█████     | 5/10 [00:26<00:28,  5.71s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0448, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8391, 'compress@10': 0.6335, 'time@10': 8.4502}:  50%|█████     | 5/10 [00:37<00:28,  5.71s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0448, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8391, 'compress@10': 0.6335, 'time@10': 8.4502}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0449, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8386, 'compress@10': 0.5744, 'time@10': 8.8071}:  60%|██████    | 6/10 [00:43<00:29,  7.38s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0449, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8386, 'compress@10': 0.5744, 'time@10': 8.8071}:  70%|███████   | 7/10 [00:43<00:20,  6.77s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0451, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.838, 'compress@10': 0.5897, 'time@10': 8.7054}:  70%|███████   | 7/10 [00:51<00:20,  6.77s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.0451, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.838, 'compress@10': 0.5897, 'time@10': 8.7054}:  80%|████████  | 8/10 [00:51<00:14,  7.17s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0473, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8403, 'compress@10': 0.5745, 'time@10': 9.3541}:  80%|████████  | 8/10 [00:58<00:14,  7.17s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0473, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8403, 'compress@10': 0.5745, 'time@10': 9.3541}:  90%|█████████ | 9/10 [00:58<00:07,  7.21s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0464, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8429, 'compress@10': 0.5255, 'time@10': 9.3707}:  90%|█████████ | 9/10 [01:08<00:07,  7.21s/it]  {'epoch': 7, 'num_users': 6.3, 'loss': 0.0464, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8429, 'compress@10': 0.5255, 'time@10': 9.3707}: 100%|██████████| 10/10 [01:08<00:00,  7.94s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0464, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8429, 'compress@10': 0.5255, 'time@10': 9.3707}: 100%|██████████| 10/10 [01:08<00:00,  6.80s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04638005304363145
Avg hit ratio: 0.8788890432336952
Avg ndcg: 0.8428571320039854
Avg compression ratio: 0.5254713589538607
Avg train time: 9.370651650428773
Std train time: 2.9212543905865656
[0.5, 0.38888888888888884, 0.16666666666666666, 0.8333333333333334, 0.9444444444444444, 0.8333333333333334, 0.16666666666666666, 0.6111111111111112, 0.5, 0.055555555555555566]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8454, 'compress@10': 0.5263, 'time@10': 8.4249}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8454, 'compress@10': 0.5263, 'time@10': 8.4249}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8605, 'compress@10': 0.4675, 'time@10': 7.851}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8605, 'compress@10': 0.4675, 'time@10': 7.851}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8594, 'compress@10': 0.4069, 'time@10': 6.8965}:  20%|██        | 2/10 [00:14<00:48,  6.05s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8594, 'compress@10': 0.4069, 'time@10': 6.8965}:  30%|███       | 3/10 [00:14<00:31,  4.44s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8546, 'compress@10': 0.515, 'time@10': 6.7114}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8546, 'compress@10': 0.515, 'time@10': 6.7114}:  40%|████      | 4/10 [00:20<00:30,  5.13s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0417, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8415, 'compress@10': 0.6011, 'time@10': 8.0453}:  40%|████      | 4/10 [00:27<00:30,  5.13s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0417, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8415, 'compress@10': 0.6011, 'time@10': 8.0453}:  50%|█████     | 5/10 [00:27<00:28,  5.71s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0425, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8425, 'compress@10': 0.6404, 'time@10': 8.4411}:  50%|█████     | 5/10 [00:37<00:28,  5.71s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0425, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8425, 'compress@10': 0.6404, 'time@10': 8.4411}:  60%|██████    | 6/10 [00:37<00:29,  7.32s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0431, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8491, 'compress@10': 0.5775, 'time@10': 8.7887}:  60%|██████    | 6/10 [00:42<00:29,  7.32s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0431, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8491, 'compress@10': 0.5775, 'time@10': 8.7887}:  70%|███████   | 7/10 [00:42<00:20,  6.72s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0423, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8517, 'compress@10': 0.5831, 'time@10': 8.708}:  70%|███████   | 7/10 [00:51<00:20,  6.72s/it]  {'epoch': 8, 'num_users': 6.125, 'loss': 0.0423, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8517, 'compress@10': 0.5831, 'time@10': 8.708}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0415, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8601, 'compress@10': 0.5754, 'time@10': 9.3636}:  80%|████████  | 8/10 [00:58<00:14,  7.18s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0415, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8601, 'compress@10': 0.5754, 'time@10': 9.3636}:  90%|█████████ | 9/10 [00:58<00:07,  7.23s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8635, 'compress@10': 0.5256, 'time@10': 9.4061}:  90%|█████████ | 9/10 [01:08<00:07,  7.23s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8635, 'compress@10': 0.5256, 'time@10': 9.4061}: 100%|██████████| 10/10 [01:08<00:00,  8.03s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8635, 'compress@10': 0.5256, 'time@10': 9.4061}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.040242814102278236
Avg hit ratio: 0.8651487834934354
Avg ndcg: 0.863464040402639
Avg compression ratio: 0.5256006277859547
Avg train time: 9.406126761436463
Std train time: 2.887466170538129
[0.55, 0.35, 0.15, 0.8500000000000001, 0.95, 0.8500000000000001, 0.25, 0.55, 0.45, 0.05000000000000001]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.044, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8558, 'compress@10': 0.5737, 'time@10': 8.7728}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.044, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8558, 'compress@10': 0.5737, 'time@10': 8.7728}:  10%|█         | 1/10 [00:04<00:39,  4.42s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0382, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8694, 'compress@10': 0.4723, 'time@10': 7.8087}:  10%|█         | 1/10 [00:11<00:39,  4.42s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0382, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8694, 'compress@10': 0.4723, 'time@10': 7.8087}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8653, 'compress@10': 0.4054, 'time@10': 6.9698}:  20%|██        | 2/10 [00:13<00:46,  5.87s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8653, 'compress@10': 0.4054, 'time@10': 6.9698}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8588, 'compress@10': 0.5179, 'time@10': 6.8417}:  30%|███       | 3/10 [00:20<00:30,  4.41s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8588, 'compress@10': 0.5179, 'time@10': 6.8417}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0395, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8456, 'compress@10': 0.6045, 'time@10': 8.1932}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0395, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8456, 'compress@10': 0.6045, 'time@10': 8.1932}:  50%|█████     | 5/10 [00:27<00:29,  5.81s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8471, 'compress@10': 0.646, 'time@10': 8.5212}:  50%|█████     | 5/10 [00:37<00:29,  5.81s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8471, 'compress@10': 0.646, 'time@10': 8.5212}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0398, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8461, 'compress@10': 0.5937, 'time@10': 8.91}:  60%|██████    | 6/10 [00:43<00:29,  7.30s/it] {'epoch': 9, 'num_users': 6.2857, 'loss': 0.0398, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8461, 'compress@10': 0.5937, 'time@10': 8.91}:  70%|███████   | 7/10 [00:43<00:20,  6.77s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0385, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8511, 'compress@10': 0.5898, 'time@10': 8.8271}:  70%|███████   | 7/10 [00:51<00:20,  6.77s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0385, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8511, 'compress@10': 0.5898, 'time@10': 8.8271}:  80%|████████  | 8/10 [00:51<00:14,  7.25s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0391, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8675, 'compress@10': 0.576, 'time@10': 9.449}:  80%|████████  | 8/10 [00:58<00:14,  7.25s/it] {'epoch': 9, 'num_users': 6.3333, 'loss': 0.0391, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8675, 'compress@10': 0.576, 'time@10': 9.449}:  90%|█████████ | 9/10 [00:58<00:07,  7.25s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0393, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8661, 'compress@10': 0.5256, 'time@10': 9.5}:  90%|█████████ | 9/10 [01:08<00:07,  7.25s/it]     {'epoch': 9, 'num_users': 6.3, 'loss': 0.0393, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8661, 'compress@10': 0.5256, 'time@10': 9.5}: 100%|██████████| 10/10 [01:08<00:00,  8.10s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0393, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8661, 'compress@10': 0.5256, 'time@10': 9.5}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03932721920576028
Avg hit ratio: 0.8729963569725878
Avg ndcg: 0.866137256530975
Avg compression ratio: 0.5255899011312224
Avg train time: 9.500030636787415
Std train time: 2.8434818045191808
[0.5909090909090909, 0.3181818181818182, 0.13636363636363635, 0.8636363636363638, 0.9545454545454545, 0.8636363636363638, 0.22727272727272727, 0.5, 0.5, 0.04545454545454546]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8561, 'compress@10': 0.6124, 'time@10': 8.7949}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8561, 'compress@10': 0.6124, 'time@10': 8.7949}:  10%|█         | 1/10 [00:04<00:39,  4.43s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0402, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8656, 'compress@10': 0.4763, 'time@10': 7.8948}:  10%|█         | 1/10 [00:11<00:39,  4.43s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0402, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8656, 'compress@10': 0.4763, 'time@10': 7.8948}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8628, 'compress@10': 0.4041, 'time@10': 7.093}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]  {'epoch': 10, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8628, 'compress@10': 0.4041, 'time@10': 7.093}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8622, 'compress@10': 0.5202, 'time@10': 6.9136}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8622, 'compress@10': 0.5202, 'time@10': 6.9136}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0393, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8487, 'compress@10': 0.6073, 'time@10': 8.2326}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0393, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8487, 'compress@10': 0.6073, 'time@10': 8.2326}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.041, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.8497, 'compress@10': 0.6505, 'time@10': 8.5566}:  50%|█████     | 5/10 [00:37<00:29,  5.82s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.041, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.8497, 'compress@10': 0.6505, 'time@10': 8.5566}:  60%|██████    | 6/10 [00:37<00:29,  7.31s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0403, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8572, 'compress@10': 0.5944, 'time@10': 8.9025}:  60%|██████    | 6/10 [00:43<00:29,  7.31s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0403, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8572, 'compress@10': 0.5944, 'time@10': 8.9025}:  70%|███████   | 7/10 [00:43<00:20,  6.73s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0387, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.8615, 'compress@10': 0.5844, 'time@10': 8.8348}:  70%|███████   | 7/10 [00:51<00:20,  6.73s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0387, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.8615, 'compress@10': 0.5844, 'time@10': 8.8348}:  80%|████████  | 8/10 [00:51<00:14,  7.26s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0388, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.8674, 'compress@10': 0.5766, 'time@10': 9.4481}:  80%|████████  | 8/10 [00:58<00:14,  7.26s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0388, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.8674, 'compress@10': 0.5766, 'time@10': 9.4481}:  90%|█████████ | 9/10 [00:58<00:07,  7.25s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.8722, 'compress@10': 0.5257, 'time@10': 9.4795}:  90%|█████████ | 9/10 [01:08<00:07,  7.25s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.8722, 'compress@10': 0.5257, 'time@10': 9.4795}: 100%|██████████| 10/10 [01:08<00:00,  8.04s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.8722, 'compress@10': 0.5257, 'time@10': 9.4795}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.036896204472398594
Avg hit ratio: 0.8889198778961088
Avg ndcg: 0.8722412487432155
Avg compression ratio: 0.525685633222675
Avg train time: 9.479469156265258
Std train time: 2.7613832244577683
[0.625, 0.2916666666666667, 0.12499999999999999, 0.8750000000000001, 0.9583333333333333, 0.8750000000000001, 0.20833333333333331, 0.4583333333333333, 0.5416666666666666, 0.04166666666666667]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0514, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8496, 'compress@10': 0.6447, 'time@10': 9.0184}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0514, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8496, 'compress@10': 0.6447, 'time@10': 9.0184}:  10%|█         | 1/10 [00:04<00:40,  4.55s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0433, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8648, 'compress@10': 0.4796, 'time@10': 8.015}:  10%|█         | 1/10 [00:11<00:40,  4.55s/it] {'epoch': 11, 'num_users': 7.0, 'loss': 0.0433, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8648, 'compress@10': 0.4796, 'time@10': 8.015}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0289, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8622, 'compress@10': 0.4031, 'time@10': 7.1973}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0289, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8622, 'compress@10': 0.4031, 'time@10': 7.1973}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8644, 'compress@10': 0.5222, 'time@10': 6.966}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8644, 'compress@10': 0.5222, 'time@10': 6.966}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0401, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.852, 'compress@10': 0.6096, 'time@10': 8.2986}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0401, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.852, 'compress@10': 0.6096, 'time@10': 8.2986}:  50%|█████     | 5/10 [00:27<00:29,  5.83s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0415, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8587, 'compress@10': 0.6543, 'time@10': 8.6405}:  50%|█████     | 5/10 [00:37<00:29,  5.83s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0415, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8587, 'compress@10': 0.6543, 'time@10': 8.6405}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0405, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8608, 'compress@10': 0.5951, 'time@10': 8.9864}:  60%|██████    | 6/10 [00:43<00:29,  7.38s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0405, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8608, 'compress@10': 0.5951, 'time@10': 8.9864}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0396, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.8608, 'compress@10': 0.5799, 'time@10': 8.8878}:  70%|███████   | 7/10 [00:51<00:20,  6.79s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0396, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.8608, 'compress@10': 0.5799, 'time@10': 8.8878}:  80%|████████  | 8/10 [00:51<00:14,  7.25s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0376, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8686, 'compress@10': 0.5771, 'time@10': 9.4959}:  80%|████████  | 8/10 [00:59<00:14,  7.25s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0376, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8686, 'compress@10': 0.5771, 'time@10': 9.4959}:  90%|█████████ | 9/10 [00:59<00:07,  7.25s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8734, 'compress@10': 0.5258, 'time@10': 9.538}:  90%|█████████ | 9/10 [01:08<00:07,  7.25s/it]    {'epoch': 11, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8734, 'compress@10': 0.5258, 'time@10': 9.538}: 100%|██████████| 10/10 [01:08<00:00,  8.08s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8734, 'compress@10': 0.5258, 'time@10': 9.538}: 100%|██████████| 10/10 [01:08<00:00,  6.90s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03786481296950563
Avg hit ratio: 0.8729198778961088
Avg ndcg: 0.8733778206080876
Avg compression ratio: 0.5257676186603348
Avg train time: 9.538009667396546
Std train time: 2.7935999451360156
[0.6538461538461539, 0.2692307692307693, 0.11538461538461538, 0.8846153846153847, 0.9615384615384615, 0.8846153846153847, 0.1923076923076923, 0.4230769230769231, 0.49999999999999994, 0.11538461538461539]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8742, 'compress@10': 0.6721, 'time@10': 8.7487}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8742, 'compress@10': 0.6721, 'time@10': 8.7487}:  10%|█         | 1/10 [00:04<00:39,  4.42s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0368, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8828, 'compress@10': 0.4824, 'time@10': 7.8704}:  10%|█         | 1/10 [00:11<00:39,  4.42s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0368, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8828, 'compress@10': 0.4824, 'time@10': 7.8704}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8742, 'compress@10': 0.4022, 'time@10': 7.0774}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8742, 'compress@10': 0.4022, 'time@10': 7.0774}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8753, 'compress@10': 0.5238, 'time@10': 6.9182}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8753, 'compress@10': 0.5238, 'time@10': 6.9182}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0365, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8627, 'compress@10': 0.6115, 'time@10': 8.3003}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0365, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8627, 'compress@10': 0.6115, 'time@10': 8.3003}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0358, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8672, 'compress@10': 0.6575, 'time@10': 8.6993}:  50%|█████     | 5/10 [00:38<00:29,  5.89s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0358, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8672, 'compress@10': 0.6575, 'time@10': 8.6993}:  60%|██████    | 6/10 [00:38<00:30,  7.53s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0348, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8718, 'compress@10': 0.5956, 'time@10': 9.0569}:  60%|██████    | 6/10 [00:44<00:30,  7.53s/it] {'epoch': 12, 'num_users': 6.2857, 'loss': 0.0348, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8718, 'compress@10': 0.5956, 'time@10': 9.0569}:  70%|███████   | 7/10 [00:44<00:20,  6.91s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0333, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.876, 'compress@10': 0.5761, 'time@10': 8.9298}:  70%|███████   | 7/10 [00:52<00:20,  6.91s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0333, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.876, 'compress@10': 0.5761, 'time@10': 8.9298}:  80%|████████  | 8/10 [00:52<00:14,  7.29s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8817, 'compress@10': 0.5693, 'time@10': 9.5421}:  80%|████████  | 8/10 [00:59<00:14,  7.29s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8817, 'compress@10': 0.5693, 'time@10': 9.5421}:  90%|█████████ | 9/10 [00:59<00:07,  7.28s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.8857, 'compress@10': 0.5259, 'time@10': 9.5802}:  90%|█████████ | 9/10 [01:09<00:07,  7.28s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.8857, 'compress@10': 0.5259, 'time@10': 9.5802}: 100%|██████████| 10/10 [01:09<00:00,  8.11s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.8857, 'compress@10': 0.5259, 'time@10': 9.5802}: 100%|██████████| 10/10 [01:09<00:00,  6.93s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03099323904353956
Avg hit ratio: 0.8857928937691246
Avg ndcg: 0.8857297414239843
Avg compression ratio: 0.5258777427901881
Avg train time: 9.580186200141906
Std train time: 2.8635727562622457
[0.6785714285714286, 0.32142857142857145, 0.10714285714285714, 0.8928571428571429, 0.9642857142857142, 0.8928571428571429, 0.17857142857142855, 0.39285714285714285, 0.46428571428571425, 0.10714285714285715]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.041, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8685, 'compress@10': 0.6955, 'time@10': 8.894}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.041, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8685, 'compress@10': 0.6955, 'time@10': 8.894}:  10%|█         | 1/10 [00:04<00:40,  4.50s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8835, 'compress@10': 0.5194, 'time@10': 8.0785}:  10%|█         | 1/10 [00:11<00:40,  4.50s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8835, 'compress@10': 0.5194, 'time@10': 8.0785}:  20%|██        | 2/10 [00:11<00:49,  6.15s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8747, 'compress@10': 0.4245, 'time@10': 7.2434}:  20%|██        | 2/10 [00:14<00:49,  6.15s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8747, 'compress@10': 0.4245, 'time@10': 7.2434}:  30%|███       | 3/10 [00:14<00:32,  4.63s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8801, 'compress@10': 0.5425, 'time@10': 7.0222}:  30%|███       | 3/10 [00:21<00:32,  4.63s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8801, 'compress@10': 0.5425, 'time@10': 7.0222}:  40%|████      | 4/10 [00:21<00:31,  5.33s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0343, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8677, 'compress@10': 0.627, 'time@10': 8.4077}:  40%|████      | 4/10 [00:28<00:31,  5.33s/it] {'epoch': 13, 'num_users': 5.8, 'loss': 0.0343, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8677, 'compress@10': 0.627, 'time@10': 8.4077}:  50%|█████     | 5/10 [00:28<00:29,  5.94s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0341, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8702, 'compress@10': 0.6717, 'time@10': 8.7639}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0341, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8702, 'compress@10': 0.6717, 'time@10': 8.7639}:  60%|██████    | 6/10 [00:38<00:30,  7.52s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0359, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.8719, 'compress@10': 0.606, 'time@10': 9.1851}:  60%|██████    | 6/10 [00:44<00:30,  7.52s/it] {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0359, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.8719, 'compress@10': 0.606, 'time@10': 9.1851}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0355, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.8688, 'compress@10': 0.5815, 'time@10': 9.0403}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0355, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.8688, 'compress@10': 0.5815, 'time@10': 9.0403}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0353, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.876, 'compress@10': 0.5702, 'time@10': 9.6949}:  80%|████████  | 8/10 [01:00<00:14,  7.33s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0353, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.876, 'compress@10': 0.5702, 'time@10': 9.6949}:  90%|█████████ | 9/10 [01:00<00:07,  7.38s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.8831, 'compress@10': 0.5259, 'time@10': 9.6953}:  90%|█████████ | 9/10 [01:09<00:07,  7.38s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.8831, 'compress@10': 0.5259, 'time@10': 9.6953}: 100%|██████████| 10/10 [01:09<00:00,  8.11s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.8831, 'compress@10': 0.5259, 'time@10': 9.6953}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.0349836533101789
Avg hit ratio: 0.9079357509119819
Avg ndcg: 0.883083918807172
Avg compression ratio: 0.5259049975441323
Avg train time: 9.695341992378236
Std train time: 2.9627206314139496
[0.7000000000000001, 0.30000000000000004, 0.09999999999999999, 0.9, 0.9666666666666666, 0.8333333333333334, 0.2333333333333333, 0.36666666666666664, 0.49999999999999994, 0.1]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8732, 'compress@10': 0.7158, 'time@10': 8.7702}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8732, 'compress@10': 0.7158, 'time@10': 8.7702}:  10%|█         | 1/10 [00:04<00:39,  4.42s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.884, 'compress@10': 0.5192, 'time@10': 7.968}:  10%|█         | 1/10 [00:11<00:39,  4.42s/it]  {'epoch': 14, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.884, 'compress@10': 0.5192, 'time@10': 7.968}:  20%|██        | 2/10 [00:11<00:48,  6.06s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8751, 'compress@10': 0.4223, 'time@10': 7.1894}:  20%|██        | 2/10 [00:14<00:48,  6.06s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8751, 'compress@10': 0.4223, 'time@10': 7.1894}:  30%|███       | 3/10 [00:14<00:32,  4.59s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8756, 'compress@10': 0.5426, 'time@10': 6.9613}:  30%|███       | 3/10 [00:20<00:32,  4.59s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8756, 'compress@10': 0.5426, 'time@10': 6.9613}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0318, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8664, 'compress@10': 0.6276, 'time@10': 8.2779}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0318, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8664, 'compress@10': 0.6276, 'time@10': 8.2779}:  50%|█████     | 5/10 [00:27<00:29,  5.83s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0338, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.8749, 'compress@10': 0.6625, 'time@10': 8.657}:  50%|█████     | 5/10 [00:38<00:29,  5.83s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0338, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.8749, 'compress@10': 0.6625, 'time@10': 8.657}:  60%|██████    | 6/10 [00:38<00:29,  7.45s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.8741, 'compress@10': 0.6055, 'time@10': 9.011}:  60%|██████    | 6/10 [00:43<00:29,  7.45s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.8741, 'compress@10': 0.6055, 'time@10': 9.011}:  70%|███████   | 7/10 [00:43<00:20,  6.84s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0326, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.879, 'compress@10': 0.578, 'time@10': 8.8848}:  70%|███████   | 7/10 [00:51<00:20,  6.84s/it]  {'epoch': 14, 'num_users': 6.125, 'loss': 0.0326, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.879, 'compress@10': 0.578, 'time@10': 8.8848}:  80%|████████  | 8/10 [00:51<00:14,  7.22s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.8864, 'compress@10': 0.5709, 'time@10': 9.5428}:  80%|████████  | 8/10 [00:59<00:14,  7.22s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.8864, 'compress@10': 0.5709, 'time@10': 9.5428}:  90%|█████████ | 9/10 [00:59<00:07,  7.29s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0309, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.8895, 'compress@10': 0.5258, 'time@10': 9.5626}:  90%|█████████ | 9/10 [01:09<00:07,  7.29s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0309, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.8895, 'compress@10': 0.5258, 'time@10': 9.5626}: 100%|██████████| 10/10 [01:09<00:00,  8.06s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0309, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.8895, 'compress@10': 0.5258, 'time@10': 9.5626}: 100%|██████████| 10/10 [01:09<00:00,  6.90s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.030876692548413548
Avg hit ratio: 0.9035706715469024
Avg ndcg: 0.8895451622322856
Avg compression ratio: 0.5258351766240498
Avg train time: 9.562585878372193
Std train time: 2.8617793764814574
[0.7187500000000001, 0.28125000000000006, 0.09374999999999999, 0.90625, 0.9687499999999999, 0.84375, 0.28125, 0.34375, 0.46874999999999994, 0.09375]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0353, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8833, 'compress@10': 0.7335, 'time@10': 8.5381}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0353, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8833, 'compress@10': 0.7335, 'time@10': 8.5381}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8962, 'compress@10': 0.519, 'time@10': 7.8534}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it] {'epoch': 15, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8962, 'compress@10': 0.519, 'time@10': 7.8534}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8832, 'compress@10': 0.4204, 'time@10': 6.9466}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8832, 'compress@10': 0.4204, 'time@10': 6.9466}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8827, 'compress@10': 0.5427, 'time@10': 6.7848}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8827, 'compress@10': 0.5427, 'time@10': 6.7848}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0297, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8726, 'compress@10': 0.628, 'time@10': 8.2018}:  40%|████      | 4/10 [00:27<00:31,  5.21s/it] {'epoch': 15, 'num_users': 5.8, 'loss': 0.0297, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8726, 'compress@10': 0.628, 'time@10': 8.2018}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0296, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8802, 'compress@10': 0.6646, 'time@10': 8.5676}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0296, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8802, 'compress@10': 0.6646, 'time@10': 8.5676}:  60%|██████    | 6/10 [00:37<00:29,  7.40s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.8864, 'compress@10': 0.6139, 'time@10': 8.9735}:  60%|██████    | 6/10 [00:43<00:29,  7.40s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.8864, 'compress@10': 0.6139, 'time@10': 8.9735}:  70%|███████   | 7/10 [00:43<00:20,  6.86s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.8906, 'compress@10': 0.5825, 'time@10': 8.8431}:  70%|███████   | 7/10 [00:51<00:20,  6.86s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.8906, 'compress@10': 0.5825, 'time@10': 8.8431}:  80%|████████  | 8/10 [00:51<00:14,  7.21s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0282, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9005, 'compress@10': 0.5715, 'time@10': 9.5238}:  80%|████████  | 8/10 [00:59<00:14,  7.21s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0282, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9005, 'compress@10': 0.5715, 'time@10': 9.5238}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9051, 'compress@10': 0.5258, 'time@10': 9.5525}:  90%|█████████ | 9/10 [01:08<00:07,  7.31s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9051, 'compress@10': 0.5258, 'time@10': 9.5525}: 100%|██████████| 10/10 [01:08<00:00,  8.09s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9051, 'compress@10': 0.5258, 'time@10': 9.5525}: 100%|██████████| 10/10 [01:08<00:00,  6.90s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.02693663083302013
Avg hit ratio: 0.9057928937691246
Avg ndcg: 0.905079170725282
Avg compression ratio: 0.5258149857740813
Avg train time: 9.55245246887207
Std train time: 3.027557753704421
[0.7352941176470589, 0.26470588235294124, 0.08823529411764705, 0.9117647058823529, 0.9705882352941175, 0.8529411764705882, 0.2647058823529412, 0.3235294117647059, 0.49999999999999994, 0.08823529411764706]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8875, 'compress@10': 0.7492, 'time@10': 8.4948}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8875, 'compress@10': 0.7492, 'time@10': 8.4948}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8975, 'compress@10': 0.5188, 'time@10': 7.8552}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]  {'epoch': 16, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8975, 'compress@10': 0.5188, 'time@10': 7.8552}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.884, 'compress@10': 0.4187, 'time@10': 7.0224}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.884, 'compress@10': 0.4187, 'time@10': 7.0224}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8851, 'compress@10': 0.5428, 'time@10': 6.8025}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8851, 'compress@10': 0.5428, 'time@10': 6.8025}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.028, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.875, 'compress@10': 0.6284, 'time@10': 8.1992}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]  {'epoch': 16, 'num_users': 5.8, 'loss': 0.028, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.875, 'compress@10': 0.6284, 'time@10': 8.1992}:  50%|█████     | 5/10 [00:27<00:29,  5.81s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0277, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8829, 'compress@10': 0.6664, 'time@10': 8.5939}:  50%|█████     | 5/10 [00:37<00:29,  5.81s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0277, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8829, 'compress@10': 0.6664, 'time@10': 8.5939}:  60%|██████    | 6/10 [00:37<00:29,  7.44s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0285, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8838, 'compress@10': 0.6132, 'time@10': 9.0196}:  60%|██████    | 6/10 [00:43<00:29,  7.44s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0285, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8838, 'compress@10': 0.6132, 'time@10': 9.0196}:  70%|███████   | 7/10 [00:43<00:20,  6.91s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0281, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8846, 'compress@10': 0.5794, 'time@10': 8.8996}:  70%|███████   | 7/10 [00:51<00:20,  6.91s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0281, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8846, 'compress@10': 0.5794, 'time@10': 8.8996}:  80%|████████  | 8/10 [00:51<00:14,  7.29s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9026, 'compress@10': 0.5722, 'time@10': 9.561}:  80%|████████  | 8/10 [00:59<00:14,  7.29s/it] {'epoch': 16, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9026, 'compress@10': 0.5722, 'time@10': 9.561}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9036, 'compress@10': 0.5259, 'time@10': 9.5434}:  90%|█████████ | 9/10 [01:08<00:07,  7.34s/it] {'epoch': 16, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9036, 'compress@10': 0.5259, 'time@10': 9.5434}: 100%|██████████| 10/10 [01:08<00:00,  7.99s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9036, 'compress@10': 0.5259, 'time@10': 9.5434}: 100%|██████████| 10/10 [01:08<00:00,  6.88s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.028268459118588007
Avg hit ratio: 0.8824846230924329
Avg ndcg: 0.9036491365247276
Avg compression ratio: 0.5258622266034145
Avg train time: 9.543391513824464
Std train time: 2.9863680579294423
[0.75, 0.25000000000000006, 0.08333333333333333, 0.9166666666666666, 0.9722222222222221, 0.8055555555555556, 0.3055555555555556, 0.3055555555555556, 0.5277777777777777, 0.08333333333333334]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0309, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8927, 'compress@10': 0.7632, 'time@10': 8.5559}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0309, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8927, 'compress@10': 0.7632, 'time@10': 8.5559}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8972, 'compress@10': 0.5187, 'time@10': 7.8478}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it] {'epoch': 17, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8972, 'compress@10': 0.5187, 'time@10': 7.8478}:  20%|██        | 2/10 [00:11<00:48,  6.00s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8839, 'compress@10': 0.4172, 'time@10': 7.062}:  20%|██        | 2/10 [00:14<00:48,  6.00s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8839, 'compress@10': 0.4172, 'time@10': 7.062}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8827, 'compress@10': 0.5428, 'time@10': 6.8423}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8827, 'compress@10': 0.5428, 'time@10': 6.8423}:  40%|████      | 4/10 [00:20<00:31,  5.20s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0269, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8726, 'compress@10': 0.6288, 'time@10': 8.1935}:  40%|████      | 4/10 [00:27<00:31,  5.20s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0269, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8726, 'compress@10': 0.6288, 'time@10': 8.1935}:  50%|█████     | 5/10 [00:27<00:28,  5.79s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0286, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8867, 'compress@10': 0.659, 'time@10': 8.5975}:  50%|█████     | 5/10 [00:37<00:28,  5.79s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0286, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8867, 'compress@10': 0.659, 'time@10': 8.5975}:  60%|██████    | 6/10 [00:37<00:29,  7.44s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.888, 'compress@10': 0.6125, 'time@10': 8.9632}:  60%|██████    | 6/10 [00:43<00:29,  7.44s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.888, 'compress@10': 0.6125, 'time@10': 8.9632}:  70%|███████   | 7/10 [00:43<00:20,  6.85s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0274, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8893, 'compress@10': 0.5766, 'time@10': 8.8594}:  70%|███████   | 7/10 [00:51<00:20,  6.85s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0274, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8893, 'compress@10': 0.5766, 'time@10': 8.8594}:  80%|████████  | 8/10 [00:51<00:14,  7.27s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0291, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9154, 'compress@10': 0.5727, 'time@10': 9.5527}:  80%|████████  | 8/10 [00:59<00:14,  7.27s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0291, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9154, 'compress@10': 0.5727, 'time@10': 9.5527}:  90%|█████████ | 9/10 [00:59<00:07,  7.37s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0278, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9186, 'compress@10': 0.5258, 'time@10': 9.5313}:  90%|█████████ | 9/10 [01:08<00:07,  7.37s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0278, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9186, 'compress@10': 0.5258, 'time@10': 9.5313}: 100%|██████████| 10/10 [01:08<00:00,  7.99s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0278, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9186, 'compress@10': 0.5258, 'time@10': 9.5313}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.0277826959175664
Avg hit ratio: 0.8824846230924329
Avg ndcg: 0.9185579232240781
Avg compression ratio: 0.5258078708544568
Avg train time: 9.531291484832764
Std train time: 2.9592224638860745
[0.7631578947368421, 0.23684210526315794, 0.07894736842105263, 0.9210526315789473, 0.9736842105263157, 0.8157894736842105, 0.2894736842105263, 0.2894736842105263, 0.5526315789473684, 0.07894736842105264]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 0.7756, 'time@10': 8.5681}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 0.7756, 'time@10': 8.5681}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9121, 'compress@10': 0.5185, 'time@10': 7.8755}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9121, 'compress@10': 0.5185, 'time@10': 7.8755}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8938, 'compress@10': 0.4159, 'time@10': 7.0957}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8938, 'compress@10': 0.4159, 'time@10': 7.0957}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8923, 'compress@10': 0.5429, 'time@10': 6.8504}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8923, 'compress@10': 0.5429, 'time@10': 6.8504}:  40%|████      | 4/10 [00:20<00:31,  5.19s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8819, 'compress@10': 0.6291, 'time@10': 8.2674}:  40%|████      | 4/10 [00:27<00:31,  5.19s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8819, 'compress@10': 0.6291, 'time@10': 8.2674}:  50%|█████     | 5/10 [00:27<00:29,  5.85s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.89, 'compress@10': 0.6609, 'time@10': 8.6269}:  50%|█████     | 5/10 [00:37<00:29,  5.85s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.89, 'compress@10': 0.6609, 'time@10': 8.6269}:  60%|██████    | 6/10 [00:37<00:29,  7.42s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0247, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8937, 'compress@10': 0.6119, 'time@10': 9.0407}:  60%|██████    | 6/10 [00:43<00:29,  7.42s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0247, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8937, 'compress@10': 0.6119, 'time@10': 9.0407}:  70%|███████   | 7/10 [00:43<00:20,  6.89s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.897, 'compress@10': 0.5742, 'time@10': 8.901}:  70%|███████   | 7/10 [00:51<00:20,  6.89s/it]   {'epoch': 18, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.897, 'compress@10': 0.5742, 'time@10': 8.901}:  80%|████████  | 8/10 [00:51<00:14,  7.23s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0291, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9161, 'compress@10': 0.5732, 'time@10': 9.5598}:  80%|████████  | 8/10 [00:59<00:14,  7.23s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0291, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9161, 'compress@10': 0.5732, 'time@10': 9.5598}:  90%|█████████ | 9/10 [00:59<00:07,  7.30s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0284, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9218, 'compress@10': 0.5259, 'time@10': 9.5503}:  90%|█████████ | 9/10 [01:08<00:07,  7.30s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0284, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9218, 'compress@10': 0.5259, 'time@10': 9.5503}: 100%|██████████| 10/10 [01:08<00:00,  7.98s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0284, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9218, 'compress@10': 0.5259, 'time@10': 9.5503}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.028424413581978447
Avg hit ratio: 0.8796274802352901
Avg ndcg: 0.921818468922422
Avg compression ratio: 0.5258507767659717
Avg train time: 9.550300788879394
Std train time: 2.981834927720114
[0.775, 0.275, 0.075, 0.9249999999999999, 0.9749999999999999, 0.775, 0.275, 0.275, 0.575, 0.07500000000000001]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 0.7868, 'time@10': 8.5775}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 0.7868, 'time@10': 8.5775}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0253, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9121, 'compress@10': 0.5426, 'time@10': 7.8509}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0253, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9121, 'compress@10': 0.5426, 'time@10': 7.8509}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8938, 'compress@10': 0.4308, 'time@10': 7.0962}:  20%|██        | 2/10 [00:14<00:47,  6.00s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8938, 'compress@10': 0.4308, 'time@10': 7.0962}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8949, 'compress@10': 0.555, 'time@10': 6.8759}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8949, 'compress@10': 0.555, 'time@10': 6.8759}:  40%|████      | 4/10 [00:20<00:31,  5.22s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8856, 'compress@10': 0.6391, 'time@10': 8.2434}:  40%|████      | 4/10 [00:27<00:31,  5.22s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8856, 'compress@10': 0.6391, 'time@10': 8.2434}:  50%|█████     | 5/10 [00:27<00:29,  5.83s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0236, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.8947, 'compress@10': 0.6626, 'time@10': 8.6346}:  50%|█████     | 5/10 [00:38<00:29,  5.83s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0236, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.8947, 'compress@10': 0.6626, 'time@10': 8.6346}:  60%|██████    | 6/10 [00:38<00:29,  7.46s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8954, 'compress@10': 0.6114, 'time@10': 9.0045}:  60%|██████    | 6/10 [00:43<00:29,  7.46s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8954, 'compress@10': 0.6114, 'time@10': 9.0045}:  70%|███████   | 7/10 [00:43<00:20,  6.87s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.8988, 'compress@10': 0.5719, 'time@10': 8.8969}:  70%|███████   | 7/10 [00:51<00:20,  6.87s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.8988, 'compress@10': 0.5719, 'time@10': 8.8969}:  80%|████████  | 8/10 [00:51<00:14,  7.28s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0267, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9019, 'compress@10': 0.5736, 'time@10': 9.5913}:  80%|████████  | 8/10 [00:59<00:14,  7.28s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0267, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9019, 'compress@10': 0.5736, 'time@10': 9.5913}:  90%|█████████ | 9/10 [00:59<00:07,  7.40s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0266, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9052, 'compress@10': 0.5258, 'time@10': 9.5643}:  90%|█████████ | 9/10 [01:08<00:07,  7.40s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0266, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9052, 'compress@10': 0.5258, 'time@10': 9.5643}: 100%|██████████| 10/10 [01:08<00:00,  8.00s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0266, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9052, 'compress@10': 0.5258, 'time@10': 9.5643}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.026631269258156648
Avg hit ratio: 0.8761354167432266
Avg ndcg: 0.9052090699948441
Avg compression ratio: 0.5258401219864255
Avg train time: 9.564307451248169
Std train time: 2.9702810346900237
[0.7857142857142857, 0.2619047619047619, 0.07142857142857142, 0.9285714285714285, 0.976190476190476, 0.7380952380952381, 0.30952380952380953, 0.2619047619047619, 0.5952380952380952, 0.07142857142857144]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0259, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9019, 'compress@10': 0.797, 'time@10': 8.419}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0259, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9019, 'compress@10': 0.797, 'time@10': 8.419}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9187, 'compress@10': 0.5414, 'time@10': 7.7775}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9187, 'compress@10': 0.5414, 'time@10': 7.7775}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8982, 'compress@10': 0.4289, 'time@10': 7.0365}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8982, 'compress@10': 0.4289, 'time@10': 7.0365}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9013, 'compress@10': 0.5545, 'time@10': 6.7923}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9013, 'compress@10': 0.5545, 'time@10': 6.7923}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0221, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8928, 'compress@10': 0.6389, 'time@10': 8.1899}:  40%|████      | 4/10 [00:27<00:30,  5.15s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0221, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8928, 'compress@10': 0.6389, 'time@10': 8.1899}:  50%|█████     | 5/10 [00:27<00:28,  5.79s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9049, 'compress@10': 0.6564, 'time@10': 8.5766}:  50%|█████     | 5/10 [00:37<00:28,  5.79s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9049, 'compress@10': 0.6564, 'time@10': 8.5766}:  60%|██████    | 6/10 [00:37<00:29,  7.41s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9064, 'compress@10': 0.6108, 'time@10': 9.046}:  60%|██████    | 6/10 [00:43<00:29,  7.41s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9064, 'compress@10': 0.6108, 'time@10': 9.046}:  70%|███████   | 7/10 [00:43<00:20,  6.94s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0227, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9069, 'compress@10': 0.5698, 'time@10': 8.9167}:  70%|███████   | 7/10 [00:51<00:20,  6.94s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0227, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9069, 'compress@10': 0.5698, 'time@10': 8.9167}:  80%|████████  | 8/10 [00:51<00:14,  7.29s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0249, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9271, 'compress@10': 0.5739, 'time@10': 9.6279}:  80%|████████  | 8/10 [00:59<00:14,  7.29s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0249, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9271, 'compress@10': 0.5739, 'time@10': 9.6279}:  90%|█████████ | 9/10 [00:59<00:07,  7.42s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9303, 'compress@10': 0.5258, 'time@10': 9.5931}:  90%|█████████ | 9/10 [01:08<00:07,  7.42s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9303, 'compress@10': 0.5258, 'time@10': 9.5931}: 100%|██████████| 10/10 [01:08<00:00,  8.01s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9303, 'compress@10': 0.5258, 'time@10': 9.5931}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.023686045425868846
Avg hit ratio: 0.8847068453146552
Avg ndcg: 0.9302705986316809
Avg compression ratio: 0.5257940364483078
Avg train time: 9.593079733848572
Std train time: 3.083892654941967
[0.7954545454545454, 0.25, 0.06818181818181818, 0.9318181818181818, 0.9772727272727272, 0.75, 0.29545454545454547, 0.25, 0.6136363636363636, 0.06818181818181819]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9079, 'compress@10': 0.8062, 'time@10': 8.6097}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9079, 'compress@10': 0.8062, 'time@10': 8.6097}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9306, 'compress@10': 0.5402, 'time@10': 7.9726}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it] {'epoch': 21, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9306, 'compress@10': 0.5402, 'time@10': 7.9726}:  20%|██        | 2/10 [00:11<00:49,  6.13s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9061, 'compress@10': 0.4272, 'time@10': 7.2535}:  20%|██        | 2/10 [00:14<00:49,  6.13s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9061, 'compress@10': 0.4272, 'time@10': 7.2535}:  30%|███       | 3/10 [00:14<00:32,  4.67s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9091, 'compress@10': 0.554, 'time@10': 6.9805}:  30%|███       | 3/10 [00:20<00:32,  4.67s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9091, 'compress@10': 0.554, 'time@10': 6.9805}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9008, 'compress@10': 0.6387, 'time@10': 8.3228}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it] {'epoch': 21, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9008, 'compress@10': 0.6387, 'time@10': 8.3228}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0201, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9086, 'compress@10': 0.6582, 'time@10': 8.679}:  50%|█████     | 5/10 [00:38<00:29,  5.86s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0201, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9086, 'compress@10': 0.6582, 'time@10': 8.679}:  60%|██████    | 6/10 [00:38<00:29,  7.44s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9105, 'compress@10': 0.6104, 'time@10': 9.0999}:  60%|██████    | 6/10 [00:44<00:29,  7.44s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9105, 'compress@10': 0.6104, 'time@10': 9.0999}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0196, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9148, 'compress@10': 0.568, 'time@10': 8.944}:  70%|███████   | 7/10 [00:51<00:20,  6.92s/it]   {'epoch': 21, 'num_users': 6.125, 'loss': 0.0196, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9148, 'compress@10': 0.568, 'time@10': 8.944}:  80%|████████  | 8/10 [00:51<00:14,  7.23s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.917, 'compress@10': 0.5743, 'time@10': 9.6099}:  80%|████████  | 8/10 [00:59<00:14,  7.23s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.917, 'compress@10': 0.5743, 'time@10': 9.6099}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9215, 'compress@10': 0.5258, 'time@10': 9.5877}:  90%|█████████ | 9/10 [01:08<00:07,  7.33s/it]  {'epoch': 21, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9215, 'compress@10': 0.5258, 'time@10': 9.5877}: 100%|██████████| 10/10 [01:08<00:00,  7.98s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9215, 'compress@10': 0.5258, 'time@10': 9.5877}: 100%|██████████| 10/10 [01:08<00:00,  6.90s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.022226477417243273
Avg hit ratio: 0.8900524674344709
Avg ndcg: 0.9215081728214353
Avg compression ratio: 0.5258319645920018
Avg train time: 9.587652277946471
Std train time: 2.9227463953589425
[0.8043478260869564, 0.2391304347826087, 0.06521739130434782, 0.9347826086956521, 0.9782608695652173, 0.717391304347826, 0.28260869565217395, 0.2391304347826087, 0.6304347826086957, 0.10869565217391305]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.91, 'compress@10': 0.8146, 'time@10': 8.6303}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.91, 'compress@10': 0.8146, 'time@10': 8.6303}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9365, 'compress@10': 0.5392, 'time@10': 7.9321}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9365, 'compress@10': 0.5392, 'time@10': 7.9321}:  20%|██        | 2/10 [00:11<00:48,  6.07s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9101, 'compress@10': 0.4257, 'time@10': 7.158}:  20%|██        | 2/10 [00:14<00:48,  6.07s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9101, 'compress@10': 0.4257, 'time@10': 7.158}:  30%|███       | 3/10 [00:14<00:32,  4.60s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9126, 'compress@10': 0.5535, 'time@10': 6.9401}:  30%|███       | 3/10 [00:20<00:32,  4.60s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9126, 'compress@10': 0.5535, 'time@10': 6.9401}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9054, 'compress@10': 0.6386, 'time@10': 8.2374}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9054, 'compress@10': 0.6386, 'time@10': 8.2374}:  50%|█████     | 5/10 [00:27<00:29,  5.81s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9136, 'compress@10': 0.6528, 'time@10': 8.6173}:  50%|█████     | 5/10 [00:38<00:29,  5.81s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9136, 'compress@10': 0.6528, 'time@10': 8.6173}:  60%|██████    | 6/10 [00:38<00:29,  7.42s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9109, 'compress@10': 0.604, 'time@10': 9.0082}:  60%|██████    | 6/10 [00:43<00:29,  7.42s/it] {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9109, 'compress@10': 0.604, 'time@10': 9.0082}:  70%|███████   | 7/10 [00:43<00:20,  6.86s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0208, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9149, 'compress@10': 0.5611, 'time@10': 8.8797}:  70%|███████   | 7/10 [00:51<00:20,  6.86s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0208, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9149, 'compress@10': 0.5611, 'time@10': 8.8797}:  80%|████████  | 8/10 [00:51<00:14,  7.23s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0217, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9234, 'compress@10': 0.57, 'time@10': 9.5382}:  80%|████████  | 8/10 [00:59<00:14,  7.23s/it] {'epoch': 22, 'num_users': 6.3333, 'loss': 0.0217, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9234, 'compress@10': 0.57, 'time@10': 9.5382}:  90%|█████████ | 9/10 [00:59<00:07,  7.30s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9264, 'compress@10': 0.5259, 'time@10': 9.5449}:  90%|█████████ | 9/10 [01:08<00:07,  7.30s/it] {'epoch': 22, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9264, 'compress@10': 0.5259, 'time@10': 9.5449}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9264, 'compress@10': 0.5259, 'time@10': 9.5449}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.021559198052582107
Avg hit ratio: 0.8842588166408201
Avg ndcg: 0.9263842114011794
Avg compression ratio: 0.5258647854692586
Avg train time: 9.54491126537323
Std train time: 2.8582985756463857
[0.8124999999999999, 0.22916666666666669, 0.0625, 0.9374999999999999, 0.9791666666666665, 0.6875, 0.31250000000000006, 0.22916666666666669, 0.6458333333333334, 0.10416666666666667]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.91, 'compress@10': 0.8224, 'time@10': 8.5843}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.91, 'compress@10': 0.8224, 'time@10': 8.5843}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9345, 'compress@10': 0.5382, 'time@10': 7.8359}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9345, 'compress@10': 0.5382, 'time@10': 7.8359}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9087, 'compress@10': 0.4243, 'time@10': 7.0246}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9087, 'compress@10': 0.4243, 'time@10': 7.0246}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9168, 'compress@10': 0.5531, 'time@10': 6.7991}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9168, 'compress@10': 0.5531, 'time@10': 6.7991}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0182, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9101, 'compress@10': 0.6384, 'time@10': 8.1066}:  40%|████      | 4/10 [00:27<00:30,  5.15s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0182, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9101, 'compress@10': 0.6384, 'time@10': 8.1066}:  50%|█████     | 5/10 [00:27<00:28,  5.71s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0202, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9204, 'compress@10': 0.6478, 'time@10': 8.5134}:  50%|█████     | 5/10 [00:37<00:28,  5.71s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0202, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9204, 'compress@10': 0.6478, 'time@10': 8.5134}:  60%|██████    | 6/10 [00:37<00:29,  7.37s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0199, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9212, 'compress@10': 0.6038, 'time@10': 8.9125}:  60%|██████    | 6/10 [00:43<00:29,  7.37s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0199, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9212, 'compress@10': 0.6038, 'time@10': 8.9125}:  70%|███████   | 7/10 [00:43<00:20,  6.82s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.921, 'compress@10': 0.5597, 'time@10': 8.8118}:  70%|███████   | 7/10 [00:51<00:20,  6.82s/it]  {'epoch': 23, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.921, 'compress@10': 0.5597, 'time@10': 8.8118}:  80%|████████  | 8/10 [00:51<00:14,  7.24s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9244, 'compress@10': 0.5704, 'time@10': 9.4876}:  80%|████████  | 8/10 [00:58<00:14,  7.24s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9244, 'compress@10': 0.5704, 'time@10': 9.4876}:  90%|█████████ | 9/10 [00:58<00:07,  7.32s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9294, 'compress@10': 0.5258, 'time@10': 9.4815}:  90%|█████████ | 9/10 [01:08<00:07,  7.32s/it]    {'epoch': 23, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9294, 'compress@10': 0.5258, 'time@10': 9.4815}: 100%|██████████| 10/10 [01:08<00:00,  7.98s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9294, 'compress@10': 0.5258, 'time@10': 9.4815}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.019195404403970998
Avg hit ratio: 0.8939731023551059
Avg ndcg: 0.929424252138268
Avg compression ratio: 0.5258253998408776
Avg train time: 9.481490588188171
Std train time: 2.9151354951291455
[0.8199999999999998, 0.22000000000000003, 0.06, 0.94, 0.9799999999999999, 0.7, 0.30000000000000004, 0.26, 0.62, 0.1]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9108, 'compress@10': 0.8295, 'time@10': 8.6492}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9108, 'compress@10': 0.8295, 'time@10': 8.6492}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9341, 'compress@10': 0.5373, 'time@10': 7.8905}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9341, 'compress@10': 0.5373, 'time@10': 7.8905}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9084, 'compress@10': 0.423, 'time@10': 7.1379}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9084, 'compress@10': 0.423, 'time@10': 7.1379}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9157, 'compress@10': 0.5528, 'time@10': 6.9057}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9157, 'compress@10': 0.5528, 'time@10': 6.9057}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9101, 'compress@10': 0.6383, 'time@10': 8.2785}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9101, 'compress@10': 0.6383, 'time@10': 8.2785}:  50%|█████     | 5/10 [00:27<00:29,  5.85s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9196, 'compress@10': 0.6497, 'time@10': 8.6624}:  50%|█████     | 5/10 [00:38<00:29,  5.85s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9196, 'compress@10': 0.6497, 'time@10': 8.6624}:  60%|██████    | 6/10 [00:38<00:29,  7.47s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9218, 'compress@10': 0.6037, 'time@10': 9.0833}:  60%|██████    | 6/10 [00:44<00:29,  7.47s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9218, 'compress@10': 0.6037, 'time@10': 9.0833}:  70%|███████   | 7/10 [00:44<00:20,  6.94s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9206, 'compress@10': 0.5634, 'time@10': 8.9561}:  70%|███████   | 7/10 [00:52<00:20,  6.94s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9206, 'compress@10': 0.5634, 'time@10': 8.9561}:  80%|████████  | 8/10 [00:52<00:14,  7.31s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9243, 'compress@10': 0.5709, 'time@10': 9.6328}:  80%|████████  | 8/10 [00:59<00:14,  7.31s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9243, 'compress@10': 0.5709, 'time@10': 9.6328}:  90%|█████████ | 9/10 [00:59<00:07,  7.39s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9252, 'compress@10': 0.5259, 'time@10': 9.6184}:  90%|█████████ | 9/10 [01:09<00:07,  7.39s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9252, 'compress@10': 0.5259, 'time@10': 9.6184}: 100%|██████████| 10/10 [01:09<00:00,  8.05s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9252, 'compress@10': 0.5259, 'time@10': 9.6184}: 100%|██████████| 10/10 [01:09<00:00,  6.93s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.018260523664753947
Avg hit ratio: 0.8874016737836772
Avg ndcg: 0.9252286259238423
Avg compression ratio: 0.5258556574994243
Avg train time: 9.618432879447937
Std train time: 2.977330582394958
[0.8269230769230768, 0.21153846153846156, 0.05769230769230769, 0.9423076923076923, 0.9807692307692306, 0.673076923076923, 0.2884615384615385, 0.2884615384615385, 0.5961538461538461, 0.13461538461538464]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0305, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8639, 'compress@10': 0.836, 'time@10': 8.2397}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0305, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8639, 'compress@10': 0.836, 'time@10': 8.2397}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.911, 'compress@10': 0.5365, 'time@10': 7.6889}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.911, 'compress@10': 0.5365, 'time@10': 7.6889}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8931, 'compress@10': 0.4218, 'time@10': 7.0742}:  20%|██        | 2/10 [00:14<00:47,  5.94s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8931, 'compress@10': 0.4218, 'time@10': 7.0742}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9081, 'compress@10': 0.5524, 'time@10': 6.8592}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9081, 'compress@10': 0.5524, 'time@10': 6.8592}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9056, 'compress@10': 0.6382, 'time@10': 8.2693}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9056, 'compress@10': 0.6382, 'time@10': 8.2693}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9155, 'compress@10': 0.6452, 'time@10': 8.6608}:  50%|█████     | 5/10 [00:38<00:29,  5.87s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9155, 'compress@10': 0.6452, 'time@10': 8.6608}:  60%|██████    | 6/10 [00:38<00:29,  7.50s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.921, 'compress@10': 0.5983, 'time@10': 9.0267}:  60%|██████    | 6/10 [00:43<00:29,  7.50s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.921, 'compress@10': 0.5983, 'time@10': 9.0267}:  70%|███████   | 7/10 [00:43<00:20,  6.89s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9239, 'compress@10': 0.5621, 'time@10': 8.9247}:  70%|███████   | 7/10 [00:52<00:20,  6.89s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9239, 'compress@10': 0.5621, 'time@10': 8.9247}:  80%|████████  | 8/10 [00:52<00:14,  7.32s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9293, 'compress@10': 0.5672, 'time@10': 9.5995}:  80%|████████  | 8/10 [00:59<00:14,  7.32s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9293, 'compress@10': 0.5672, 'time@10': 9.5995}:  90%|█████████ | 9/10 [00:59<00:07,  7.39s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9329, 'compress@10': 0.5259, 'time@10': 9.6485}:  90%|█████████ | 9/10 [01:09<00:07,  7.39s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9329, 'compress@10': 0.5259, 'time@10': 9.6485}: 100%|██████████| 10/10 [01:09<00:00,  8.24s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9329, 'compress@10': 0.5259, 'time@10': 9.6485}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.01983887834879997
Avg hit ratio: 0.892664831678414
Avg ndcg: 0.9329470679126632
Avg compression ratio: 0.5258837658040101
Avg train time: 9.648523354530335
Std train time: 2.949694283454671
[0.8333333333333331, 0.20370370370370372, 0.05555555555555555, 0.9444444444444444, 0.9814814814814813, 0.6851851851851851, 0.3148148148148148, 0.2777777777777778, 0.5740740740740741, 0.12962962962962965]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8912, 'compress@10': 0.8421, 'time@10': 8.6757}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8912, 'compress@10': 0.8421, 'time@10': 8.6757}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9263, 'compress@10': 0.5357, 'time@10': 7.8479}:  10%|█         | 1/10 [00:11<00:39,  4.38s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9263, 'compress@10': 0.5357, 'time@10': 7.8479}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9032, 'compress@10': 0.4207, 'time@10': 7.0498}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9032, 'compress@10': 0.4207, 'time@10': 7.0498}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9161, 'compress@10': 0.5521, 'time@10': 6.8463}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9161, 'compress@10': 0.5521, 'time@10': 6.8463}:  40%|████      | 4/10 [00:20<00:31,  5.20s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9131, 'compress@10': 0.638, 'time@10': 8.2091}:  40%|████      | 4/10 [00:27<00:31,  5.20s/it] {'epoch': 26, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9131, 'compress@10': 0.638, 'time@10': 8.2091}:  50%|█████     | 5/10 [00:27<00:29,  5.80s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0174, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9195, 'compress@10': 0.6471, 'time@10': 8.606}:  50%|█████     | 5/10 [00:37<00:29,  5.80s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0174, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9195, 'compress@10': 0.6471, 'time@10': 8.606}:  60%|██████    | 6/10 [00:37<00:29,  7.44s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9201, 'compress@10': 0.6035, 'time@10': 9.0574}:  60%|██████    | 6/10 [00:43<00:29,  7.44s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9201, 'compress@10': 0.6035, 'time@10': 9.0574}:  70%|███████   | 7/10 [00:43<00:20,  6.95s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9252, 'compress@10': 0.5654, 'time@10': 8.9219}:  70%|███████   | 7/10 [00:51<00:20,  6.95s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9252, 'compress@10': 0.5654, 'time@10': 8.9219}:  80%|████████  | 8/10 [00:51<00:14,  7.29s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9402, 'compress@10': 0.5677, 'time@10': 9.5983}:  80%|████████  | 8/10 [00:59<00:14,  7.29s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9402, 'compress@10': 0.5677, 'time@10': 9.5983}:  90%|█████████ | 9/10 [00:59<00:07,  7.37s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9445, 'compress@10': 0.5259, 'time@10': 9.6463}:  90%|█████████ | 9/10 [01:09<00:07,  7.37s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9445, 'compress@10': 0.5259, 'time@10': 9.6463}: 100%|██████████| 10/10 [01:09<00:00,  8.22s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9445, 'compress@10': 0.5259, 'time@10': 9.6463}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.02117086003098289
Avg hit ratio: 0.8820934031069856
Avg ndcg: 0.9445324035246706
Avg compression ratio: 0.5258697104222574
Avg train time: 9.646338987350465
Std train time: 3.004728744001802
[0.8035714285714284, 0.19642857142857145, 0.05357142857142857, 0.9464285714285714, 0.982142857142857, 0.6964285714285714, 0.3035714285714286, 0.26785714285714285, 0.5892857142857143, 0.16071428571428573]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9058, 'compress@10': 0.8139, 'time@10': 8.6157}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9058, 'compress@10': 0.8139, 'time@10': 8.6157}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.935, 'compress@10': 0.5181, 'time@10': 7.9235}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it] {'epoch': 27, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.935, 'compress@10': 0.5181, 'time@10': 7.9235}:  20%|██        | 2/10 [00:11<00:48,  6.07s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9091, 'compress@10': 0.4083, 'time@10': 7.2118}:  20%|██        | 2/10 [00:14<00:48,  6.07s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9091, 'compress@10': 0.4083, 'time@10': 7.2118}:  30%|███       | 3/10 [00:14<00:32,  4.64s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9187, 'compress@10': 0.5433, 'time@10': 6.9984}:  30%|███       | 3/10 [00:20<00:32,  4.64s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9187, 'compress@10': 0.5433, 'time@10': 6.9984}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9147, 'compress@10': 0.6312, 'time@10': 8.315}:  40%|████      | 4/10 [00:27<00:31,  5.33s/it] {'epoch': 27, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9147, 'compress@10': 0.6312, 'time@10': 8.315}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9237, 'compress@10': 0.6432, 'time@10': 8.7024}:  50%|█████     | 5/10 [00:38<00:29,  5.87s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9237, 'compress@10': 0.6432, 'time@10': 8.7024}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0121, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9274, 'compress@10': 0.5986, 'time@10': 9.1422}:  60%|██████    | 6/10 [00:44<00:30,  7.51s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0121, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9274, 'compress@10': 0.5986, 'time@10': 9.1422}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9304, 'compress@10': 0.5599, 'time@10': 9.0236}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9304, 'compress@10': 0.5599, 'time@10': 9.0236}:  80%|████████  | 8/10 [00:52<00:14,  7.38s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9462, 'compress@10': 0.5645, 'time@10': 9.7028}:  80%|████████  | 8/10 [01:00<00:14,  7.38s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9462, 'compress@10': 0.5645, 'time@10': 9.7028}:  90%|█████████ | 9/10 [01:00<00:07,  7.46s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9475, 'compress@10': 0.526, 'time@10': 9.7371}:  90%|█████████ | 9/10 [01:10<00:07,  7.46s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9475, 'compress@10': 0.526, 'time@10': 9.7371}: 100%|██████████| 10/10 [01:10<00:00,  8.27s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9475, 'compress@10': 0.526, 'time@10': 9.7371}: 100%|██████████| 10/10 [01:10<00:00,  7.03s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.018042002479576973
Avg hit ratio: 0.8986013396149218
Avg ndcg: 0.9474606622022257
Avg compression ratio: 0.5260033519163396
Avg train time: 9.737120842933654
Std train time: 2.9316157709987154
[0.8103448275862067, 0.18965517241379312, 0.05172413793103448, 0.9482758620689655, 0.982758620689655, 0.6724137931034483, 0.2931034482758621, 0.25862068965517243, 0.603448275862069, 0.18965517241379312]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9042, 'compress@10': 0.8203, 'time@10': 8.8334}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9042, 'compress@10': 0.8203, 'time@10': 8.8334}:  10%|█         | 1/10 [00:04<00:40,  4.45s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9327, 'compress@10': 0.5181, 'time@10': 7.9348}:  10%|█         | 1/10 [00:11<00:40,  4.45s/it] {'epoch': 28, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9327, 'compress@10': 0.5181, 'time@10': 7.9348}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9075, 'compress@10': 0.4078, 'time@10': 7.2351}:  20%|██        | 2/10 [00:14<00:47,  6.00s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9075, 'compress@10': 0.4078, 'time@10': 7.2351}:  30%|███       | 3/10 [00:14<00:32,  4.61s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9168, 'compress@10': 0.5434, 'time@10': 6.9755}:  30%|███       | 3/10 [00:20<00:32,  4.61s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9168, 'compress@10': 0.5434, 'time@10': 6.9755}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9146, 'compress@10': 0.6313, 'time@10': 8.2407}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9146, 'compress@10': 0.6313, 'time@10': 8.2407}:  50%|█████     | 5/10 [00:27<00:28,  5.78s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.93, 'compress@10': 0.6394, 'time@10': 8.6461}:  50%|█████     | 5/10 [00:38<00:28,  5.78s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.93, 'compress@10': 0.6394, 'time@10': 8.6461}:  60%|██████    | 6/10 [00:38<00:29,  7.45s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9312, 'compress@10': 0.5939, 'time@10': 9.0164}:  60%|██████    | 6/10 [00:43<00:29,  7.45s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9312, 'compress@10': 0.5939, 'time@10': 9.0164}:  70%|███████   | 7/10 [00:43<00:20,  6.87s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.019, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9324, 'compress@10': 0.5547, 'time@10': 8.9236}:  70%|███████   | 7/10 [00:52<00:20,  6.87s/it]  {'epoch': 28, 'num_users': 6.125, 'loss': 0.019, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9324, 'compress@10': 0.5547, 'time@10': 8.9236}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9365, 'compress@10': 0.5614, 'time@10': 9.5837}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9365, 'compress@10': 0.5614, 'time@10': 9.5837}:  90%|█████████ | 9/10 [00:59<00:07,  7.37s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.899, 'ndcg@10': 0.941, 'compress@10': 0.526, 'time@10': 9.6233}:  90%|█████████ | 9/10 [01:09<00:07,  7.37s/it]      {'epoch': 28, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.899, 'ndcg@10': 0.941, 'compress@10': 0.526, 'time@10': 9.6233}: 100%|██████████| 10/10 [01:09<00:00,  8.19s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.899, 'ndcg@10': 0.941, 'compress@10': 0.526, 'time@10': 9.6233}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.022434748493786995
Avg hit ratio: 0.8989700032093919
Avg ndcg: 0.9409581937937859
Avg compression ratio: 0.5260239224170377
Avg train time: 9.623318719863892
Std train time: 2.829495220336517
[0.7833333333333332, 0.18333333333333335, 0.05, 0.95, 0.9833333333333332, 0.6833333333333333, 0.3166666666666667, 0.25, 0.6166666666666667, 0.18333333333333335]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.7947, 'time@10': 8.5967}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.7947, 'time@10': 8.5967}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9623, 'compress@10': 0.5022, 'time@10': 7.8684}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9623, 'compress@10': 0.5022, 'time@10': 7.8684}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9273, 'compress@10': 0.3967, 'time@10': 7.1024}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9273, 'compress@10': 0.3967, 'time@10': 7.1024}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9342, 'compress@10': 0.5355, 'time@10': 6.8505}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9342, 'compress@10': 0.5355, 'time@10': 6.8505}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0164, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9291, 'compress@10': 0.6251, 'time@10': 8.1107}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0164, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9291, 'compress@10': 0.6251, 'time@10': 8.1107}:  50%|█████     | 5/10 [00:27<00:28,  5.70s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9358, 'compress@10': 0.636, 'time@10': 8.5276}:  50%|█████     | 5/10 [00:37<00:28,  5.70s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9358, 'compress@10': 0.636, 'time@10': 8.5276}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9306, 'compress@10': 0.5943, 'time@10': 8.9808}:  60%|██████    | 6/10 [00:43<00:29,  7.38s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9306, 'compress@10': 0.5943, 'time@10': 8.9808}:  70%|███████   | 7/10 [00:43<00:20,  6.89s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0165, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9309, 'compress@10': 0.5539, 'time@10': 8.8648}:  70%|███████   | 7/10 [00:51<00:20,  6.89s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0165, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9309, 'compress@10': 0.5539, 'time@10': 8.8648}:  80%|████████  | 8/10 [00:51<00:14,  7.28s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9502, 'compress@10': 0.5621, 'time@10': 9.5561}:  80%|████████  | 8/10 [00:59<00:14,  7.28s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9502, 'compress@10': 0.5621, 'time@10': 9.5561}:  90%|█████████ | 9/10 [00:59<00:07,  7.37s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0208, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9472, 'compress@10': 0.5261, 'time@10': 9.6148}:  90%|█████████ | 9/10 [01:09<00:07,  7.37s/it]  {'epoch': 29, 'num_users': 6.3, 'loss': 0.0208, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9472, 'compress@10': 0.5261, 'time@10': 9.6148}: 100%|██████████| 10/10 [01:09<00:00,  8.24s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0208, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9472, 'compress@10': 0.5261, 'time@10': 9.6148}: 100%|██████████| 10/10 [01:09<00:00,  6.95s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.020773586685549912
Avg hit ratio: 0.8881763524157412
Avg ndcg: 0.9471708206930656
Avg compression ratio: 0.5260855375203669
Avg train time: 9.614784550666808
Std train time: 2.9394672574551444
[0.7580645161290321, 0.20967741935483872, 0.048387096774193554, 0.9516129032258064, 0.9516129032258063, 0.6612903225806451, 0.33870967741935487, 0.24193548387096775, 0.6290322580645161, 0.20967741935483872]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.7708, 'time@10': 8.5278}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.7708, 'time@10': 8.5278}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.9573, 'compress@10': 0.503, 'time@10': 7.8621}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]  {'epoch': 30, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.9573, 'compress@10': 0.503, 'time@10': 7.8621}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.7536, 'ndcg@10': 0.9239, 'compress@10': 0.3968, 'time@10': 7.113}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.7536, 'ndcg@10': 0.9239, 'compress@10': 0.3968, 'time@10': 7.113}:  30%|███       | 3/10 [00:14<00:32,  4.57s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.7973, 'ndcg@10': 0.9322, 'compress@10': 0.5359, 'time@10': 6.9076}:  30%|███       | 3/10 [00:20<00:32,  4.57s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.7973, 'ndcg@10': 0.9322, 'compress@10': 0.5359, 'time@10': 6.9076}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.9287, 'compress@10': 0.6192, 'time@10': 8.2651}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.9287, 'compress@10': 0.6192, 'time@10': 8.2651}:  50%|█████     | 5/10 [00:27<00:29,  5.85s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.9369, 'compress@10': 0.6275, 'time@10': 8.6553}:  50%|█████     | 5/10 [00:38<00:29,  5.85s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.9369, 'compress@10': 0.6275, 'time@10': 8.6553}:  60%|██████    | 6/10 [00:38<00:29,  7.48s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9393, 'compress@10': 0.59, 'time@10': 9.0377}:  60%|██████    | 6/10 [00:43<00:29,  7.48s/it]   {'epoch': 30, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9393, 'compress@10': 0.59, 'time@10': 9.0377}:  70%|███████   | 7/10 [00:43<00:20,  6.90s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9401, 'compress@10': 0.5492, 'time@10': 8.9121}:  70%|███████   | 7/10 [00:52<00:20,  6.90s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9401, 'compress@10': 0.5492, 'time@10': 8.9121}:  80%|████████  | 8/10 [00:52<00:14,  7.27s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9398, 'compress@10': 0.5593, 'time@10': 9.5913}:  80%|████████  | 8/10 [00:59<00:14,  7.27s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9398, 'compress@10': 0.5593, 'time@10': 9.5913}:  90%|█████████ | 9/10 [00:59<00:07,  7.36s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9425, 'compress@10': 0.5261, 'time@10': 9.6565}:  90%|█████████ | 9/10 [01:09<00:07,  7.36s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9425, 'compress@10': 0.5261, 'time@10': 9.6565}: 100%|██████████| 10/10 [01:09<00:00,  8.26s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9425, 'compress@10': 0.5261, 'time@10': 9.6565}: 100%|██████████| 10/10 [01:09<00:00,  6.99s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.01430544441108011
Avg hit ratio: 0.8835782981402677
Avg ndcg: 0.942546139086701
Avg compression ratio: 0.5261047559466294
Avg train time: 9.656477546691894
Std train time: 2.946295729896926
[0.7343749999999999, 0.234375, 0.04687500000000001, 0.9531249999999999, 0.9531249999999998, 0.671875, 0.32812500000000006, 0.234375, 0.640625, 0.203125]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8959, 'compress@10': 0.7484, 'time@10': 8.5254}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8959, 'compress@10': 0.7484, 'time@10': 8.5254}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.93, 'compress@10': 0.5037, 'time@10': 7.7517}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]  {'epoch': 31, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.93, 'compress@10': 0.5037, 'time@10': 7.7517}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9057, 'compress@10': 0.3968, 'time@10': 7.0141}:  20%|██        | 2/10 [00:14<00:47,  5.90s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9057, 'compress@10': 0.3968, 'time@10': 7.0141}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9186, 'compress@10': 0.5363, 'time@10': 6.8021}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9186, 'compress@10': 0.5363, 'time@10': 6.8021}:  40%|████      | 4/10 [00:20<00:30,  5.16s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9172, 'compress@10': 0.6199, 'time@10': 8.0795}:  40%|████      | 4/10 [00:26<00:30,  5.16s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9172, 'compress@10': 0.6199, 'time@10': 8.0795}:  50%|█████     | 5/10 [00:26<00:28,  5.69s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9286, 'compress@10': 0.6297, 'time@10': 8.513}:  50%|█████     | 5/10 [00:37<00:28,  5.69s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9286, 'compress@10': 0.6297, 'time@10': 8.513}:  60%|██████    | 6/10 [00:37<00:29,  7.40s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0172, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9319, 'compress@10': 0.5905, 'time@10': 8.9294}:  60%|██████    | 6/10 [00:43<00:29,  7.40s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0172, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9319, 'compress@10': 0.5905, 'time@10': 8.9294}:  70%|███████   | 7/10 [00:43<00:20,  6.86s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9358, 'compress@10': 0.5487, 'time@10': 8.7999}:  70%|███████   | 7/10 [00:51<00:20,  6.86s/it]  {'epoch': 31, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9358, 'compress@10': 0.5487, 'time@10': 8.7999}:  80%|████████  | 8/10 [00:51<00:14,  7.20s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9552, 'compress@10': 0.5601, 'time@10': 9.4993}:  80%|████████  | 8/10 [00:58<00:14,  7.20s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9552, 'compress@10': 0.5601, 'time@10': 9.4993}:  90%|█████████ | 9/10 [00:58<00:07,  7.32s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9572, 'compress@10': 0.5262, 'time@10': 9.5685}:  90%|█████████ | 9/10 [01:09<00:07,  7.32s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9572, 'compress@10': 0.5262, 'time@10': 9.5685}: 100%|██████████| 10/10 [01:09<00:00,  8.22s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9572, 'compress@10': 0.5262, 'time@10': 9.5685}: 100%|██████████| 10/10 [01:09<00:00,  6.92s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.02032992196516758
Avg hit ratio: 0.9117708224618241
Avg ndcg: 0.9571843488011241
Avg compression ratio: 0.5261847668525099
Avg train time: 9.568468022346497
Std train time: 2.952058304342812
[0.7424242424242423, 0.22727272727272727, 0.04545454545454546, 0.9545454545454545, 0.924242424242424, 0.6818181818181818, 0.31818181818181823, 0.22727272727272727, 0.6515151515151515, 0.22727272727272727]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.756, 'time@10': 8.5684}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.756, 'time@10': 8.5684}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9438, 'compress@10': 0.5041, 'time@10': 7.887}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it] {'epoch': 32, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9438, 'compress@10': 0.5041, 'time@10': 7.887}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9149, 'compress@10': 0.3967, 'time@10': 7.0993}:  20%|██        | 2/10 [00:14<00:48,  6.04s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9149, 'compress@10': 0.3967, 'time@10': 7.0993}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9244, 'compress@10': 0.5365, 'time@10': 6.8877}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9244, 'compress@10': 0.5365, 'time@10': 6.8877}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.9233, 'compress@10': 0.6144, 'time@10': 8.2931}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it] {'epoch': 32, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.9233, 'compress@10': 0.6144, 'time@10': 8.2931}:  50%|█████     | 5/10 [00:27<00:29,  5.88s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.9316, 'compress@10': 0.6268, 'time@10': 8.6775}:  50%|█████     | 5/10 [00:38<00:29,  5.88s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.9316, 'compress@10': 0.6268, 'time@10': 8.6775}:  60%|██████    | 6/10 [00:38<00:29,  7.50s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.933, 'compress@10': 0.5866, 'time@10': 9.0911}:  60%|██████    | 6/10 [00:44<00:29,  7.50s/it] {'epoch': 32, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.933, 'compress@10': 0.5866, 'time@10': 9.0911}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9365, 'compress@10': 0.5444, 'time@10': 8.9404}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9365, 'compress@10': 0.5444, 'time@10': 8.9404}:  80%|████████  | 8/10 [00:52<00:14,  7.26s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9364, 'compress@10': 0.5575, 'time@10': 9.5331}:  80%|████████  | 8/10 [00:59<00:14,  7.26s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9364, 'compress@10': 0.5575, 'time@10': 9.5331}:  90%|█████████ | 9/10 [00:59<00:07,  7.23s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9388, 'compress@10': 0.5262, 'time@10': 9.6148}:  90%|█████████ | 9/10 [01:09<00:07,  7.23s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9388, 'compress@10': 0.5262, 'time@10': 9.6148}: 100%|██████████| 10/10 [01:09<00:00,  8.21s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9388, 'compress@10': 0.5262, 'time@10': 9.6148}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.015318612951395897
Avg hit ratio: 0.8767477809871698
Avg ndcg: 0.9388328036683129
Avg compression ratio: 0.5261902461203356
Avg train time: 9.614804530143738
Std train time: 2.8891490518584333
[0.7205882352941175, 0.22058823529411764, 0.04411764705882354, 0.9558823529411764, 0.9264705882352938, 0.6617647058823529, 0.3382352941176471, 0.22058823529411764, 0.6617647058823529, 0.25]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.7353, 'time@10': 8.4679}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.7353, 'time@10': 8.4679}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9547, 'compress@10': 0.4905, 'time@10': 7.7502}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9547, 'compress@10': 0.4905, 'time@10': 7.7502}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9222, 'compress@10': 0.3872, 'time@10': 7.0217}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9222, 'compress@10': 0.3872, 'time@10': 7.0217}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9297, 'compress@10': 0.5298, 'time@10': 6.807}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9297, 'compress@10': 0.5298, 'time@10': 6.807}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9281, 'compress@10': 0.6094, 'time@10': 8.1886}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9281, 'compress@10': 0.6094, 'time@10': 8.1886}:  50%|█████     | 5/10 [00:27<00:28,  5.79s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0182, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9386, 'compress@10': 0.6194, 'time@10': 8.6488}:  50%|█████     | 5/10 [00:38<00:28,  5.79s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0182, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9386, 'compress@10': 0.6194, 'time@10': 8.6488}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0177, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9391, 'compress@10': 0.583, 'time@10': 9.0617}:  60%|██████    | 6/10 [00:44<00:30,  7.56s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0177, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9391, 'compress@10': 0.583, 'time@10': 9.0617}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9398, 'compress@10': 0.5405, 'time@10': 8.9356}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9398, 'compress@10': 0.5405, 'time@10': 8.9356}:  80%|████████  | 8/10 [00:52<00:14,  7.34s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.958, 'compress@10': 0.555, 'time@10': 9.6035}:  80%|████████  | 8/10 [00:59<00:14,  7.34s/it] {'epoch': 33, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.958, 'compress@10': 0.555, 'time@10': 9.6035}:  90%|█████████ | 9/10 [00:59<00:07,  7.39s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9592, 'compress@10': 0.5262, 'time@10': 9.6723}:  90%|█████████ | 9/10 [01:09<00:07,  7.39s/it] {'epoch': 33, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9592, 'compress@10': 0.5262, 'time@10': 9.6723}: 100%|██████████| 10/10 [01:09<00:00,  8.30s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9592, 'compress@10': 0.5262, 'time@10': 9.6723}: 100%|██████████| 10/10 [01:09<00:00,  7.00s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.018427073838884627
Avg hit ratio: 0.8878076888212713
Avg ndcg: 0.9592236103982493
Avg compression ratio: 0.5262374522993364
Avg train time: 9.672304511070251
Std train time: 2.998237219417892
[0.6999999999999998, 0.24285714285714285, 0.042857142857142864, 0.9571428571428571, 0.9285714285714283, 0.6714285714285714, 0.32857142857142857, 0.21428571428571427, 0.6714285714285714, 0.24285714285714285]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.7158, 'time@10': 8.5815}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.7158, 'time@10': 8.5815}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9479, 'compress@10': 0.4915, 'time@10': 7.9235}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9479, 'compress@10': 0.4915, 'time@10': 7.9235}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9177, 'compress@10': 0.3876, 'time@10': 7.0702}:  20%|██        | 2/10 [00:14<00:48,  6.08s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9177, 'compress@10': 0.3876, 'time@10': 7.0702}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9269, 'compress@10': 0.5303, 'time@10': 6.8701}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9269, 'compress@10': 0.5303, 'time@10': 6.8701}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9259, 'compress@10': 0.6103, 'time@10': 8.2013}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9259, 'compress@10': 0.6103, 'time@10': 8.2013}:  50%|█████     | 5/10 [00:27<00:29,  5.80s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9324, 'compress@10': 0.6217, 'time@10': 8.5981}:  50%|█████     | 5/10 [00:38<00:29,  5.80s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9324, 'compress@10': 0.6217, 'time@10': 8.5981}:  60%|██████    | 6/10 [00:38<00:29,  7.44s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9353, 'compress@10': 0.5836, 'time@10': 9.0038}:  60%|██████    | 6/10 [00:43<00:29,  7.44s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9353, 'compress@10': 0.5836, 'time@10': 9.0038}:  70%|███████   | 7/10 [00:43<00:20,  6.89s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9378, 'compress@10': 0.5403, 'time@10': 8.8931}:  70%|███████   | 7/10 [00:52<00:20,  6.89s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9378, 'compress@10': 0.5403, 'time@10': 8.8931}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9356, 'compress@10': 0.5559, 'time@10': 9.5317}:  80%|████████  | 8/10 [00:59<00:14,  7.30s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9356, 'compress@10': 0.5559, 'time@10': 9.5317}:  90%|█████████ | 9/10 [00:59<00:07,  7.32s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9394, 'compress@10': 0.5263, 'time@10': 9.5849}:  90%|█████████ | 9/10 [01:09<00:07,  7.32s/it]    {'epoch': 34, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9394, 'compress@10': 0.5263, 'time@10': 9.5849}: 100%|██████████| 10/10 [01:09<00:00,  8.18s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9394, 'compress@10': 0.5263, 'time@10': 9.5849}: 100%|██████████| 10/10 [01:09<00:00,  6.95s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.012466219582415405
Avg hit ratio: 0.891033495272884
Avg ndcg: 0.939438113741393
Avg compression ratio: 0.5263087879827887
Avg train time: 9.584927749633788
Std train time: 2.882685360452796
[0.6805555555555554, 0.2361111111111111, 0.04166666666666667, 0.9583333333333333, 0.9305555555555552, 0.6805555555555555, 0.3194444444444444, 0.2361111111111111, 0.6805555555555555, 0.2361111111111111]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9167, 'compress@10': 0.6974, 'time@10': 8.5039}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9167, 'compress@10': 0.6974, 'time@10': 8.5039}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9422, 'compress@10': 0.4791, 'time@10': 7.877}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]  {'epoch': 35, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9422, 'compress@10': 0.4791, 'time@10': 7.877}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0033, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9139, 'compress@10': 0.3789, 'time@10': 7.1553}:  20%|██        | 2/10 [00:14<00:48,  6.05s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0033, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9139, 'compress@10': 0.3789, 'time@10': 7.1553}:  30%|███       | 3/10 [00:14<00:32,  4.61s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9235, 'compress@10': 0.5241, 'time@10': 6.8789}:  30%|███       | 3/10 [00:20<00:32,  4.61s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9235, 'compress@10': 0.5241, 'time@10': 6.8789}:  40%|████      | 4/10 [00:20<00:31,  5.19s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9236, 'compress@10': 0.6057, 'time@10': 8.2495}:  40%|████      | 4/10 [00:27<00:31,  5.19s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9236, 'compress@10': 0.6057, 'time@10': 8.2495}:  50%|█████     | 5/10 [00:27<00:29,  5.81s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9323, 'compress@10': 0.6193, 'time@10': 8.6541}:  50%|█████     | 5/10 [00:38<00:29,  5.81s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9323, 'compress@10': 0.6193, 'time@10': 8.6541}:  60%|██████    | 6/10 [00:38<00:29,  7.48s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9358, 'compress@10': 0.5804, 'time@10': 9.0413}:  60%|██████    | 6/10 [00:43<00:29,  7.48s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9358, 'compress@10': 0.5804, 'time@10': 9.0413}:  70%|███████   | 7/10 [00:43<00:20,  6.90s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9392, 'compress@10': 0.5401, 'time@10': 8.9235}:  70%|███████   | 7/10 [00:52<00:20,  6.90s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9392, 'compress@10': 0.5401, 'time@10': 8.9235}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9583, 'compress@10': 0.5567, 'time@10': 9.5614}:  80%|████████  | 8/10 [00:59<00:14,  7.30s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9583, 'compress@10': 0.5567, 'time@10': 9.5614}:  90%|█████████ | 9/10 [00:59<00:07,  7.32s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9569, 'compress@10': 0.5264, 'time@10': 9.6176}:  90%|█████████ | 9/10 [01:09<00:07,  7.32s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9569, 'compress@10': 0.5264, 'time@10': 9.6176}: 100%|██████████| 10/10 [01:09<00:00,  8.20s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9569, 'compress@10': 0.5264, 'time@10': 9.6176}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.012871955956550094
Avg hit ratio: 0.8878076888212713
Avg ndcg: 0.9568792733709731
Avg compression ratio: 0.526382361714252
Avg train time: 9.617554640769958
Std train time: 2.897580816503973
[0.662162162162162, 0.22972972972972971, 0.04054054054054054, 0.9594594594594594, 0.9324324324324321, 0.6621621621621621, 0.33783783783783783, 0.22972972972972971, 0.6891891891891891, 0.25675675675675674]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9138, 'compress@10': 0.6799, 'time@10': 8.4548}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9138, 'compress@10': 0.6799, 'time@10': 8.4548}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.941, 'compress@10': 0.4673, 'time@10': 7.7333}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.941, 'compress@10': 0.4673, 'time@10': 7.7333}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9131, 'compress@10': 0.3707, 'time@10': 7.0496}:  20%|██        | 2/10 [00:14<00:47,  5.90s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9131, 'compress@10': 0.3707, 'time@10': 7.0496}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9235, 'compress@10': 0.5183, 'time@10': 6.8433}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9235, 'compress@10': 0.5183, 'time@10': 6.8433}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.925, 'compress@10': 0.6014, 'time@10': 8.2529}:  40%|████      | 4/10 [00:27<00:31,  5.21s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.925, 'compress@10': 0.6014, 'time@10': 8.2529}:  50%|█████     | 5/10 [00:27<00:29,  5.85s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9359, 'compress@10': 0.6127, 'time@10': 8.6383}:  50%|█████     | 5/10 [00:38<00:29,  5.85s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9359, 'compress@10': 0.6127, 'time@10': 8.6383}:  60%|██████    | 6/10 [00:38<00:29,  7.47s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9386, 'compress@10': 0.5773, 'time@10': 9.0221}:  60%|██████    | 6/10 [00:43<00:29,  7.47s/it] {'epoch': 36, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9386, 'compress@10': 0.5773, 'time@10': 9.0221}:  70%|███████   | 7/10 [00:43<00:20,  6.89s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9425, 'compress@10': 0.5366, 'time@10': 8.8976}:  70%|███████   | 7/10 [00:51<00:20,  6.89s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9425, 'compress@10': 0.5366, 'time@10': 8.8976}:  80%|████████  | 8/10 [00:51<00:14,  7.26s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.941, 'compress@10': 0.5545, 'time@10': 9.5492}:  80%|████████  | 8/10 [00:59<00:14,  7.26s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.941, 'compress@10': 0.5545, 'time@10': 9.5492}:  90%|█████████ | 9/10 [00:59<00:07,  7.32s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9441, 'compress@10': 0.5264, 'time@10': 9.62}:  90%|█████████ | 9/10 [01:09<00:07,  7.32s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9441, 'compress@10': 0.5264, 'time@10': 9.62}: 100%|██████████| 10/10 [01:09<00:00,  8.24s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9441, 'compress@10': 0.5264, 'time@10': 9.62}: 100%|██████████| 10/10 [01:09<00:00,  6.95s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.0165657550923523
Avg hit ratio: 0.874259301724497
Avg ndcg: 0.9441226501030562
Avg compression ratio: 0.5264239444325824
Avg train time: 9.619993710517884
Std train time: 2.943260620739431
[0.6710526315789471, 0.22368421052631576, 0.03947368421052632, 0.9605263157894737, 0.907894736842105, 0.6710526315789472, 0.35526315789473684, 0.22368421052631576, 0.6973684210526315, 0.25]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9193, 'compress@10': 0.6884, 'time@10': 8.7443}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9193, 'compress@10': 0.6884, 'time@10': 8.7443}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9823, 'compress@10': 0.4685, 'time@10': 7.8347}:  10%|█         | 1/10 [00:11<00:39,  4.41s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9823, 'compress@10': 0.4685, 'time@10': 7.8347}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9406, 'compress@10': 0.3713, 'time@10': 7.1211}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9406, 'compress@10': 0.3713, 'time@10': 7.1211}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9435, 'compress@10': 0.5189, 'time@10': 6.8659}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9435, 'compress@10': 0.5189, 'time@10': 6.8659}:  40%|████      | 4/10 [00:20<00:30,  5.16s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.942, 'compress@10': 0.5971, 'time@10': 8.2536}:  40%|████      | 4/10 [00:27<00:30,  5.16s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.942, 'compress@10': 0.5971, 'time@10': 8.2536}:  50%|█████     | 5/10 [00:27<00:29,  5.80s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9475, 'compress@10': 0.6106, 'time@10': 8.6672}:  50%|█████     | 5/10 [00:38<00:29,  5.80s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9475, 'compress@10': 0.6106, 'time@10': 8.6672}:  60%|██████    | 6/10 [00:38<00:29,  7.49s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9475, 'compress@10': 0.5778, 'time@10': 9.0552}:  60%|██████    | 6/10 [00:43<00:29,  7.49s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9475, 'compress@10': 0.5778, 'time@10': 9.0552}:  70%|███████   | 7/10 [00:43<00:20,  6.92s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.95, 'compress@10': 0.5363, 'time@10': 8.9295}:  70%|███████   | 7/10 [00:51<00:20,  6.92s/it]   {'epoch': 37, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.95, 'compress@10': 0.5363, 'time@10': 8.9295}:  80%|████████  | 8/10 [00:51<00:14,  7.29s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9624, 'compress@10': 0.5552, 'time@10': 9.5629}:  80%|████████  | 8/10 [00:59<00:14,  7.29s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9624, 'compress@10': 0.5552, 'time@10': 9.5629}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9642, 'compress@10': 0.5264, 'time@10': 9.6176}:  90%|█████████ | 9/10 [01:09<00:07,  7.31s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9642, 'compress@10': 0.5264, 'time@10': 9.6176}: 100%|██████████| 10/10 [01:09<00:00,  8.19s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9642, 'compress@10': 0.5264, 'time@10': 9.6176}: 100%|██████████| 10/10 [01:09<00:00,  6.94s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.014410815751735914
Avg hit ratio: 0.8881763524157412
Avg ndcg: 0.9641695004727782
Avg compression ratio: 0.5263767512734084
Avg train time: 9.617626833915711
Std train time: 2.9240921214969395
[0.6538461538461536, 0.24358974358974356, 0.038461538461538464, 0.9615384615384616, 0.91025641025641, 0.6538461538461537, 0.34615384615384615, 0.21794871794871792, 0.7051282051282051, 0.2692307692307692]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9185, 'compress@10': 0.6721, 'time@10': 8.5739}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9185, 'compress@10': 0.6721, 'time@10': 8.5739}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9491, 'compress@10': 0.47, 'time@10': 7.945}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]   {'epoch': 38, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9491, 'compress@10': 0.47, 'time@10': 7.945}:  20%|██        | 2/10 [00:11<00:48,  6.11s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9184, 'compress@10': 0.372, 'time@10': 7.1994}:  20%|██        | 2/10 [00:14<00:48,  6.11s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9184, 'compress@10': 0.372, 'time@10': 7.1994}:  30%|███       | 3/10 [00:14<00:32,  4.64s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9266, 'compress@10': 0.5197, 'time@10': 6.9126}:  30%|███       | 3/10 [00:20<00:32,  4.64s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9266, 'compress@10': 0.5197, 'time@10': 6.9126}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9282, 'compress@10': 0.5982, 'time@10': 8.2978}:  40%|████      | 4/10 [00:27<00:31,  5.21s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9282, 'compress@10': 0.5982, 'time@10': 8.2978}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9371, 'compress@10': 0.6087, 'time@10': 8.6857}:  50%|█████     | 5/10 [00:38<00:29,  5.84s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9371, 'compress@10': 0.6087, 'time@10': 8.6857}:  60%|██████    | 6/10 [00:38<00:29,  7.48s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9394, 'compress@10': 0.575, 'time@10': 9.1331}:  60%|██████    | 6/10 [00:44<00:29,  7.48s/it] {'epoch': 38, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9394, 'compress@10': 0.575, 'time@10': 9.1331}:  70%|███████   | 7/10 [00:44<00:20,  6.98s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9431, 'compress@10': 0.5331, 'time@10': 8.9794}:  70%|███████   | 7/10 [00:52<00:20,  6.98s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9431, 'compress@10': 0.5331, 'time@10': 8.9794}:  80%|████████  | 8/10 [00:52<00:14,  7.29s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9433, 'compress@10': 0.5532, 'time@10': 9.6094}:  80%|████████  | 8/10 [00:59<00:14,  7.29s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9433, 'compress@10': 0.5532, 'time@10': 9.6094}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9461, 'compress@10': 0.5264, 'time@10': 9.6934}:  90%|█████████ | 9/10 [01:10<00:07,  7.31s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9461, 'compress@10': 0.5264, 'time@10': 9.6934}: 100%|██████████| 10/10 [01:10<00:00,  8.29s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9461, 'compress@10': 0.5264, 'time@10': 9.6934}: 100%|██████████| 10/10 [01:10<00:00,  7.00s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.012837520048305958
Avg hit ratio: 0.8685450160102113
Avg ndcg: 0.9460899133604922
Avg compression ratio: 0.5264349906409568
Avg train time: 9.693438863754272
Std train time: 2.9487495680962255
[0.6624999999999998, 0.23749999999999996, 0.037500000000000006, 0.9625, 0.9124999999999998, 0.6624999999999999, 0.33749999999999997, 0.21249999999999997, 0.7124999999999999, 0.2625]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0057, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.6803, 'time@10': 8.5681}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0057, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.6803, 'time@10': 8.5681}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0042, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9466, 'compress@10': 0.4712, 'time@10': 7.8807}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0042, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9466, 'compress@10': 0.4712, 'time@10': 7.8807}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0028, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9168, 'compress@10': 0.3725, 'time@10': 7.1106}:  20%|██        | 2/10 [00:14<00:48,  6.04s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0028, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9168, 'compress@10': 0.3725, 'time@10': 7.1106}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9247, 'compress@10': 0.5203, 'time@10': 6.8811}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9247, 'compress@10': 0.5203, 'time@10': 6.8811}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9275, 'compress@10': 0.5991, 'time@10': 8.2442}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9275, 'compress@10': 0.5991, 'time@10': 8.2442}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9356, 'compress@10': 0.6109, 'time@10': 8.6338}:  50%|█████     | 5/10 [00:38<00:29,  5.82s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9356, 'compress@10': 0.6109, 'time@10': 8.6338}:  60%|██████    | 6/10 [00:38<00:29,  7.45s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9382, 'compress@10': 0.5756, 'time@10': 9.0555}:  60%|██████    | 6/10 [00:43<00:29,  7.45s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9382, 'compress@10': 0.5756, 'time@10': 9.0555}:  70%|███████   | 7/10 [00:43<00:20,  6.92s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9407, 'compress@10': 0.5331, 'time@10': 8.938}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it]  {'epoch': 39, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9407, 'compress@10': 0.5331, 'time@10': 8.938}:  80%|████████  | 8/10 [00:52<00:14,  7.31s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9454, 'compress@10': 0.5539, 'time@10': 9.5749}:  80%|████████  | 8/10 [00:59<00:14,  7.31s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9454, 'compress@10': 0.5539, 'time@10': 9.5749}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9493, 'compress@10': 0.5264, 'time@10': 9.6364}:  90%|█████████ | 9/10 [01:09<00:07,  7.33s/it]  {'epoch': 39, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9493, 'compress@10': 0.5264, 'time@10': 9.6364}: 100%|██████████| 10/10 [01:09<00:00,  8.23s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9493, 'compress@10': 0.5264, 'time@10': 9.6364}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.011696286101464465
Avg hit ratio: 0.8798711808847633
Avg ndcg: 0.9492851921056019
Avg compression ratio: 0.5264396505052245
Avg train time: 9.636375761032104
Std train time: 2.9092423965342626
[0.6463414634146339, 0.2317073170731707, 0.03658536585365854, 0.9634146341463414, 0.9146341463414632, 0.670731707317073, 0.35365853658536583, 0.20731707317073167, 0.7195121951219511, 0.25609756097560976]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9101, 'compress@10': 0.6649, 'time@10': 8.3997}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9101, 'compress@10': 0.6649, 'time@10': 8.3997}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9527, 'compress@10': 0.4607, 'time@10': 7.7173}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9527, 'compress@10': 0.4607, 'time@10': 7.7173}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9208, 'compress@10': 0.3652, 'time@10': 6.9528}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9208, 'compress@10': 0.3652, 'time@10': 6.9528}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.93, 'compress@10': 0.5151, 'time@10': 6.7683}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]  {'epoch': 40, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.93, 'compress@10': 0.5151, 'time@10': 6.7683}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9328, 'compress@10': 0.5953, 'time@10': 8.2204}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9328, 'compress@10': 0.5953, 'time@10': 8.2204}:  50%|█████     | 5/10 [00:27<00:29,  5.85s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.94, 'compress@10': 0.6091, 'time@10': 8.6343}:  50%|█████     | 5/10 [00:38<00:29,  5.85s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.94, 'compress@10': 0.6091, 'time@10': 8.6343}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9407, 'compress@10': 0.5763, 'time@10': 9.0199}:  60%|██████    | 6/10 [00:43<00:30,  7.51s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9407, 'compress@10': 0.5763, 'time@10': 9.0199}:  70%|███████   | 7/10 [00:43<00:20,  6.92s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.941, 'compress@10': 0.533, 'time@10': 8.8845}:  70%|███████   | 7/10 [00:51<00:20,  6.92s/it]   {'epoch': 40, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.941, 'compress@10': 0.533, 'time@10': 8.8845}:  80%|████████  | 8/10 [00:51<00:14,  7.26s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9423, 'compress@10': 0.5546, 'time@10': 9.584}:  80%|████████  | 8/10 [00:59<00:14,  7.26s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9423, 'compress@10': 0.5546, 'time@10': 9.584}:  90%|█████████ | 9/10 [00:59<00:07,  7.37s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9438, 'compress@10': 0.5265, 'time@10': 9.6724}:  90%|█████████ | 9/10 [01:09<00:07,  7.37s/it]  {'epoch': 40, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9438, 'compress@10': 0.5265, 'time@10': 9.6724}: 100%|██████████| 10/10 [01:09<00:00,  8.34s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9438, 'compress@10': 0.5265, 'time@10': 9.6724}: 100%|██████████| 10/10 [01:09<00:00,  6.99s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.01651273462467672
Avg hit ratio: 0.9028307302959255
Avg ndcg: 0.9437794221569419
Avg compression ratio: 0.5264756543350203
Avg train time: 9.672399663925171
Std train time: 3.0880445968833072
[0.6547619047619045, 0.24999999999999994, 0.03571428571428572, 0.9642857142857143, 0.8928571428571427, 0.6547619047619045, 0.369047619047619, 0.20238095238095236, 0.7023809523809522, 0.27380952380952384]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.6729, 'time@10': 8.6594}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.6729, 'time@10': 8.6594}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9496, 'compress@10': 0.4736, 'time@10': 7.9576}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it]   {'epoch': 41, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9496, 'compress@10': 0.4736, 'time@10': 7.9576}:  20%|██        | 2/10 [00:11<00:48,  6.09s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9188, 'compress@10': 0.3735, 'time@10': 7.1277}:  20%|██        | 2/10 [00:14<00:48,  6.09s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9188, 'compress@10': 0.3735, 'time@10': 7.1277}:  30%|███       | 3/10 [00:14<00:32,  4.57s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.929, 'compress@10': 0.5215, 'time@10': 6.9035}:  30%|███       | 3/10 [00:20<00:32,  4.57s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.929, 'compress@10': 0.5215, 'time@10': 6.9035}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9318, 'compress@10': 0.5962, 'time@10': 8.3238}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9318, 'compress@10': 0.5962, 'time@10': 8.3238}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9391, 'compress@10': 0.6073, 'time@10': 8.7259}:  50%|█████     | 5/10 [00:38<00:29,  5.89s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9391, 'compress@10': 0.6073, 'time@10': 8.7259}:  60%|██████    | 6/10 [00:38<00:30,  7.55s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9414, 'compress@10': 0.5768, 'time@10': 9.0669}:  60%|██████    | 6/10 [00:44<00:30,  7.55s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9414, 'compress@10': 0.5768, 'time@10': 9.0669}:  70%|███████   | 7/10 [00:44<00:20,  6.91s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.944, 'compress@10': 0.5329, 'time@10': 8.9254}:  70%|███████   | 7/10 [00:52<00:20,  6.91s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.944, 'compress@10': 0.5329, 'time@10': 8.9254}:  80%|████████  | 8/10 [00:52<00:14,  7.25s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0081, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9459, 'compress@10': 0.5527, 'time@10': 9.5693}:  80%|████████  | 8/10 [00:59<00:14,  7.25s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0081, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9459, 'compress@10': 0.5527, 'time@10': 9.5693}:  90%|█████████ | 9/10 [00:59<00:07,  7.30s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0077, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.949, 'compress@10': 0.5264, 'time@10': 9.6779}:  90%|█████████ | 9/10 [01:10<00:07,  7.30s/it]    {'epoch': 41, 'num_users': 6.3, 'loss': 0.0077, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.949, 'compress@10': 0.5264, 'time@10': 9.6779}: 100%|██████████| 10/10 [01:10<00:00,  8.35s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0077, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.949, 'compress@10': 0.5264, 'time@10': 9.6779}: 100%|██████████| 10/10 [01:10<00:00,  7.02s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.007711699246236665
Avg hit ratio: 0.9053192095585982
Avg ndcg: 0.9489632467040702
Avg compression ratio: 0.5264204643778627
Avg train time: 9.677892374992371
Std train time: 2.9636054788205786
[0.63953488372093, 0.2674418604651162, 0.034883720930232565, 0.9651162790697675, 0.8953488372093021, 0.63953488372093, 0.3837209302325581, 0.2209302325581395, 0.6860465116279069, 0.2674418604651163]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9271, 'compress@10': 0.6585, 'time@10': 9.002}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9271, 'compress@10': 0.6585, 'time@10': 9.002}:  10%|█         | 1/10 [00:04<00:40,  4.54s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9474, 'compress@10': 0.4748, 'time@10': 8.1082}:  10%|█         | 1/10 [00:11<00:40,  4.54s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9474, 'compress@10': 0.4748, 'time@10': 8.1082}:  20%|██        | 2/10 [00:11<00:49,  6.13s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0039, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9173, 'compress@10': 0.3741, 'time@10': 7.2944}:  20%|██        | 2/10 [00:14<00:49,  6.13s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0039, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9173, 'compress@10': 0.3741, 'time@10': 7.2944}:  30%|███       | 3/10 [00:14<00:32,  4.64s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9259, 'compress@10': 0.5222, 'time@10': 7.0323}:  30%|███       | 3/10 [00:20<00:32,  4.64s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9259, 'compress@10': 0.5222, 'time@10': 7.0323}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9293, 'compress@10': 0.5972, 'time@10': 8.3869}:  40%|████      | 4/10 [00:27<00:31,  5.30s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9293, 'compress@10': 0.5972, 'time@10': 8.3869}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9374, 'compress@10': 0.6056, 'time@10': 8.7378}:  50%|█████     | 5/10 [00:38<00:29,  5.89s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9374, 'compress@10': 0.6056, 'time@10': 8.7378}:  60%|██████    | 6/10 [00:38<00:29,  7.47s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9403, 'compress@10': 0.5774, 'time@10': 9.1292}:  60%|██████    | 6/10 [00:44<00:29,  7.47s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9403, 'compress@10': 0.5774, 'time@10': 9.1292}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9442, 'compress@10': 0.5357, 'time@10': 8.9615}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9442, 'compress@10': 0.5357, 'time@10': 8.9615}:  80%|████████  | 8/10 [00:52<00:14,  7.21s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9464, 'compress@10': 0.5534, 'time@10': 9.6085}:  80%|████████  | 8/10 [00:59<00:14,  7.21s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9464, 'compress@10': 0.5534, 'time@10': 9.6085}:  90%|█████████ | 9/10 [00:59<00:07,  7.28s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9489, 'compress@10': 0.5264, 'time@10': 9.6657}:  90%|█████████ | 9/10 [01:09<00:07,  7.28s/it]  {'epoch': 42, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9489, 'compress@10': 0.5264, 'time@10': 9.6657}: 100%|██████████| 10/10 [01:09<00:00,  8.19s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9489, 'compress@10': 0.5264, 'time@10': 9.6657}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.010698634403264842
Avg hit ratio: 0.9024620667014555
Avg ndcg: 0.9489321438656134
Avg compression ratio: 0.5264324782065001
Avg train time: 9.665675234794616
Std train time: 2.9194536269277647
[0.6249999999999998, 0.2613636363636363, 0.034090909090909095, 0.9659090909090909, 0.8977272727272726, 0.6477272727272725, 0.37499999999999994, 0.21590909090909088, 0.6931818181818181, 0.2840909090909091]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9413, 'compress@10': 0.6447, 'time@10': 8.6343}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9413, 'compress@10': 0.6447, 'time@10': 8.6343}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9526, 'compress@10': 0.465, 'time@10': 7.9418}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it]  {'epoch': 43, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9526, 'compress@10': 0.465, 'time@10': 7.9418}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9208, 'compress@10': 0.3673, 'time@10': 7.1754}:  20%|██        | 2/10 [00:14<00:48,  6.08s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9208, 'compress@10': 0.3673, 'time@10': 7.1754}:  30%|███       | 3/10 [00:14<00:32,  4.61s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9302, 'compress@10': 0.5173, 'time@10': 6.9728}:  30%|███       | 3/10 [00:20<00:32,  4.61s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9302, 'compress@10': 0.5173, 'time@10': 6.9728}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9333, 'compress@10': 0.5938, 'time@10': 8.3896}:  40%|████      | 4/10 [00:27<00:31,  5.32s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9333, 'compress@10': 0.5938, 'time@10': 8.3896}:  50%|█████     | 5/10 [00:27<00:29,  5.96s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9406, 'compress@10': 0.6041, 'time@10': 8.7544}:  50%|█████     | 5/10 [00:38<00:29,  5.96s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9406, 'compress@10': 0.6041, 'time@10': 8.7544}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9438, 'compress@10': 0.5749, 'time@10': 9.116}:  60%|██████    | 6/10 [00:44<00:30,  7.54s/it] {'epoch': 43, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9438, 'compress@10': 0.5749, 'time@10': 9.116}:  70%|███████   | 7/10 [00:44<00:20,  6.93s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9469, 'compress@10': 0.5328, 'time@10': 8.9752}:  70%|███████   | 7/10 [00:52<00:20,  6.93s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9469, 'compress@10': 0.5328, 'time@10': 8.9752}:  80%|████████  | 8/10 [00:52<00:14,  7.28s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9512, 'compress@10': 0.5516, 'time@10': 9.6122}:  80%|████████  | 8/10 [00:59<00:14,  7.28s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9512, 'compress@10': 0.5516, 'time@10': 9.6122}:  90%|█████████ | 9/10 [00:59<00:07,  7.32s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9537, 'compress@10': 0.5265, 'time@10': 9.6888}:  90%|█████████ | 9/10 [01:10<00:07,  7.32s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9537, 'compress@10': 0.5265, 'time@10': 9.6888}: 100%|██████████| 10/10 [01:10<00:00,  8.27s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9537, 'compress@10': 0.5265, 'time@10': 9.6888}: 100%|██████████| 10/10 [01:10<00:00,  7.01s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.0123495696753007
Avg hit ratio: 0.9024620667014555
Avg ndcg: 0.9537370135397822
Avg compression ratio: 0.5265043387354755
Avg train time: 9.68880295753479
Std train time: 2.923420743399051
[0.6333333333333331, 0.2555555555555555, 0.03333333333333334, 0.9666666666666667, 0.8777777777777777, 0.6333333333333331, 0.38888888888888884, 0.21111111111111108, 0.7, 0.30000000000000004]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9279, 'compress@10': 0.6526, 'time@10': 8.8494}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9279, 'compress@10': 0.6526, 'time@10': 8.8494}:  10%|█         | 1/10 [00:04<00:40,  4.46s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9726, 'compress@10': 0.4661, 'time@10': 8.0829}:  10%|█         | 1/10 [00:11<00:40,  4.46s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9726, 'compress@10': 0.4661, 'time@10': 8.0829}:  20%|██        | 2/10 [00:11<00:49,  6.16s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9341, 'compress@10': 0.3679, 'time@10': 7.2471}:  20%|██        | 2/10 [00:14<00:49,  6.16s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9341, 'compress@10': 0.3679, 'time@10': 7.2471}:  30%|███       | 3/10 [00:14<00:32,  4.65s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9413, 'compress@10': 0.5179, 'time@10': 6.9863}:  30%|███       | 3/10 [00:20<00:32,  4.65s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9413, 'compress@10': 0.5179, 'time@10': 6.9863}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9423, 'compress@10': 0.5903, 'time@10': 8.3385}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9423, 'compress@10': 0.5903, 'time@10': 8.3385}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.9199, 'ndcg@10': 0.9497, 'compress@10': 0.5989, 'time@10': 8.7172}:  50%|█████     | 5/10 [00:38<00:29,  5.87s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.9199, 'ndcg@10': 0.9497, 'compress@10': 0.5989, 'time@10': 8.7172}:  60%|██████    | 6/10 [00:38<00:29,  7.49s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.9257, 'ndcg@10': 0.9505, 'compress@10': 0.5724, 'time@10': 9.1084}:  60%|██████    | 6/10 [00:44<00:29,  7.49s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.9257, 'ndcg@10': 0.9505, 'compress@10': 0.5724, 'time@10': 9.1084}:  70%|███████   | 7/10 [00:44<00:20,  6.93s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9314, 'ndcg@10': 0.9521, 'compress@10': 0.53, 'time@10': 8.9568}:  70%|███████   | 7/10 [00:52<00:20,  6.93s/it]  {'epoch': 44, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9314, 'ndcg@10': 0.9521, 'compress@10': 0.53, 'time@10': 8.9568}:  80%|████████  | 8/10 [00:52<00:14,  7.25s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9692, 'compress@10': 0.5499, 'time@10': 9.6245}:  80%|████████  | 8/10 [00:59<00:14,  7.25s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9692, 'compress@10': 0.5499, 'time@10': 9.6245}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9727, 'compress@10': 0.5265, 'time@10': 9.6955}:  90%|█████████ | 9/10 [01:10<00:07,  7.33s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9727, 'compress@10': 0.5265, 'time@10': 9.6955}: 100%|██████████| 10/10 [01:10<00:00,  8.27s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9727, 'compress@10': 0.5265, 'time@10': 9.6955}: 100%|██████████| 10/10 [01:10<00:00,  7.00s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.017728621966041056
Avg hit ratio: 0.9171164445816398
Avg ndcg: 0.9726534179927878
Avg compression ratio: 0.526462778880213
Avg train time: 9.695478367805482
Std train time: 2.954993384705088
[0.6195652173913041, 0.27173913043478254, 0.03260869565217392, 0.967391304347826, 0.858695652173913, 0.6195652173913041, 0.4021739130434782, 0.20652173913043476, 0.7065217391304347, 0.3152173913043479]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.6396, 'time@10': 8.5924}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.6396, 'time@10': 8.5924}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9619, 'compress@10': 0.4674, 'time@10': 7.8094}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9619, 'compress@10': 0.4674, 'time@10': 7.8094}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.927, 'compress@10': 0.3685, 'time@10': 7.1879}:  20%|██        | 2/10 [00:14<00:47,  5.94s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.927, 'compress@10': 0.3685, 'time@10': 7.1879}:  30%|███       | 3/10 [00:14<00:32,  4.60s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9359, 'compress@10': 0.5185, 'time@10': 6.9649}:  30%|███       | 3/10 [00:20<00:32,  4.60s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9359, 'compress@10': 0.5185, 'time@10': 6.9649}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9389, 'compress@10': 0.5871, 'time@10': 8.3199}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9389, 'compress@10': 0.5871, 'time@10': 8.3199}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9454, 'compress@10': 0.5939, 'time@10': 8.6914}:  50%|█████     | 5/10 [00:38<00:29,  5.87s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9454, 'compress@10': 0.5939, 'time@10': 8.6914}:  60%|██████    | 6/10 [00:38<00:29,  7.48s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9471, 'compress@10': 0.57, 'time@10': 9.039}:  60%|██████    | 6/10 [00:43<00:29,  7.48s/it]   {'epoch': 45, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9471, 'compress@10': 0.57, 'time@10': 9.039}:  70%|███████   | 7/10 [00:43<00:20,  6.86s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9469, 'compress@10': 0.5274, 'time@10': 8.894}:  70%|███████   | 7/10 [00:51<00:20,  6.86s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9469, 'compress@10': 0.5274, 'time@10': 8.894}:  80%|████████  | 8/10 [00:51<00:14,  7.20s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9471, 'compress@10': 0.5482, 'time@10': 9.5803}:  80%|████████  | 8/10 [00:59<00:14,  7.20s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9471, 'compress@10': 0.5482, 'time@10': 9.5803}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9, 'ndcg@10': 0.948, 'compress@10': 0.5265, 'time@10': 9.6479}:  90%|█████████ | 9/10 [01:09<00:07,  7.31s/it]      {'epoch': 45, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9, 'ndcg@10': 0.948, 'compress@10': 0.5265, 'time@10': 9.6479}: 100%|██████████| 10/10 [01:09<00:00,  8.24s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9, 'ndcg@10': 0.948, 'compress@10': 0.5265, 'time@10': 9.6479}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.014424157704382237
Avg hit ratio: 0.8999735874387825
Avg ndcg: 0.9480056862402473
Avg compression ratio: 0.5264661703522607
Avg train time: 9.647889614105225
Std train time: 2.925345596282438
[0.606382978723404, 0.2872340425531914, 0.03191489361702128, 0.9680851063829787, 0.8617021276595744, 0.606382978723404, 0.3936170212765957, 0.20212765957446807, 0.7127659574468085, 0.3297872340425533]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6271, 'time@10': 8.5304}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6271, 'time@10': 8.5304}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9503, 'compress@10': 0.4687, 'time@10': 7.8261}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9503, 'compress@10': 0.4687, 'time@10': 7.8261}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0041, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9192, 'compress@10': 0.3692, 'time@10': 7.051}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.0041, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9192, 'compress@10': 0.3692, 'time@10': 7.051}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9302, 'compress@10': 0.5192, 'time@10': 6.8384}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9302, 'compress@10': 0.5192, 'time@10': 6.8384}:  40%|████      | 4/10 [00:20<00:31,  5.20s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9346, 'compress@10': 0.5882, 'time@10': 8.237}:  40%|████      | 4/10 [00:27<00:31,  5.20s/it]  {'epoch': 46, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9346, 'compress@10': 0.5882, 'time@10': 8.237}:  50%|█████     | 5/10 [00:27<00:29,  5.83s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9399, 'compress@10': 0.5927, 'time@10': 8.688}:  50%|█████     | 5/10 [00:38<00:29,  5.83s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9399, 'compress@10': 0.5927, 'time@10': 8.688}:  60%|██████    | 6/10 [00:38<00:30,  7.58s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9428, 'compress@10': 0.5677, 'time@10': 9.0783}:  60%|██████    | 6/10 [00:44<00:30,  7.58s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9428, 'compress@10': 0.5677, 'time@10': 9.0783}:  70%|███████   | 7/10 [00:44<00:20,  6.98s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0084, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9461, 'compress@10': 0.5249, 'time@10': 8.9284}:  70%|███████   | 7/10 [00:52<00:20,  6.98s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0084, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9461, 'compress@10': 0.5249, 'time@10': 8.9284}:  80%|████████  | 8/10 [00:52<00:14,  7.28s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0099, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9543, 'compress@10': 0.5467, 'time@10': 9.5755}:  80%|████████  | 8/10 [00:59<00:14,  7.28s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0099, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9543, 'compress@10': 0.5467, 'time@10': 9.5755}:  90%|█████████ | 9/10 [00:59<00:07,  7.32s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9566, 'compress@10': 0.5265, 'time@10': 9.6333}:  90%|█████████ | 9/10 [01:09<00:07,  7.32s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9566, 'compress@10': 0.5265, 'time@10': 9.6333}: 100%|██████████| 10/10 [01:09<00:00,  8.21s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9566, 'compress@10': 0.5265, 'time@10': 9.6333}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.009151335092757925
Avg hit ratio: 0.9000759939928022
Avg ndcg: 0.9566144521867752
Avg compression ratio: 0.5265122006044497
Avg train time: 9.633289361000061
Std train time: 2.97444358553515
[0.5937499999999997, 0.2812499999999999, 0.03125000000000001, 0.96875, 0.8645833333333333, 0.614583333333333, 0.38541666666666663, 0.21875, 0.71875, 0.32291666666666674]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 0.6151, 'time@10': 8.3334}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 0.6151, 'time@10': 8.3334}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9923, 'compress@10': 0.4598, 'time@10': 7.7311}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9923, 'compress@10': 0.4598, 'time@10': 7.7311}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9472, 'compress@10': 0.3631, 'time@10': 6.9817}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9472, 'compress@10': 0.3631, 'time@10': 6.9817}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9511, 'compress@10': 0.5148, 'time@10': 6.8192}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9511, 'compress@10': 0.5148, 'time@10': 6.8192}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9514, 'compress@10': 0.5853, 'time@10': 8.2698}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9514, 'compress@10': 0.5853, 'time@10': 8.2698}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9585, 'compress@10': 0.5916, 'time@10': 8.6761}:  50%|█████     | 5/10 [00:38<00:29,  5.90s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9585, 'compress@10': 0.5916, 'time@10': 8.6761}:  60%|██████    | 6/10 [00:38<00:30,  7.55s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9587, 'compress@10': 0.5656, 'time@10': 9.116}:  60%|██████    | 6/10 [00:44<00:30,  7.55s/it] {'epoch': 47, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9587, 'compress@10': 0.5656, 'time@10': 9.116}:  70%|███████   | 7/10 [00:44<00:21,  7.01s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9601, 'compress@10': 0.5251, 'time@10': 8.9546}:  70%|███████   | 7/10 [00:52<00:21,  7.01s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9601, 'compress@10': 0.5251, 'time@10': 8.9546}:  80%|████████  | 8/10 [00:52<00:14,  7.28s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.885, 'ndcg@10': 0.958, 'compress@10': 0.5475, 'time@10': 9.6214}:  80%|████████  | 8/10 [00:59<00:14,  7.28s/it] {'epoch': 47, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.885, 'ndcg@10': 0.958, 'compress@10': 0.5475, 'time@10': 9.6214}:  90%|█████████ | 9/10 [00:59<00:07,  7.36s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9594, 'compress@10': 0.5266, 'time@10': 9.6865}:  90%|█████████ | 9/10 [01:09<00:07,  7.36s/it] {'epoch': 47, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9594, 'compress@10': 0.5266, 'time@10': 9.6865}: 100%|██████████| 10/10 [01:09<00:00,  8.27s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9594, 'compress@10': 0.5266, 'time@10': 9.6865}: 100%|██████████| 10/10 [01:09<00:00,  6.99s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.017022292355003067
Avg hit ratio: 0.8942593017244971
Avg ndcg: 0.9594386685558975
Avg compression ratio: 0.5265647583296721
Avg train time: 9.68647484779358
Std train time: 3.0566046075704794
[0.5816326530612241, 0.29591836734693866, 0.03061224489795919, 0.9693877551020408, 0.846938775510204, 0.6224489795918364, 0.37755102040816324, 0.21428571428571427, 0.7244897959183674, 0.3367346938775511]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.6036, 'time@10': 8.7655}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.6036, 'time@10': 8.7655}:  10%|█         | 1/10 [00:04<00:39,  4.44s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9481, 'compress@10': 0.4611, 'time@10': 8.0826}:  10%|█         | 1/10 [00:11<00:39,  4.44s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9481, 'compress@10': 0.4611, 'time@10': 8.0826}:  20%|██        | 2/10 [00:11<00:49,  6.20s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.9178, 'compress@10': 0.3638, 'time@10': 7.2273}:  20%|██        | 2/10 [00:14<00:49,  6.20s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.9178, 'compress@10': 0.3638, 'time@10': 7.2273}:  30%|███       | 3/10 [00:14<00:32,  4.65s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9287, 'compress@10': 0.5155, 'time@10': 6.943}:  30%|███       | 3/10 [00:20<00:32,  4.65s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9287, 'compress@10': 0.5155, 'time@10': 6.943}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9349, 'compress@10': 0.5824, 'time@10': 8.2839}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9349, 'compress@10': 0.5824, 'time@10': 8.2839}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.942, 'compress@10': 0.5904, 'time@10': 8.6428}:  50%|█████     | 5/10 [00:38<00:29,  5.82s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.942, 'compress@10': 0.5904, 'time@10': 8.6428}:  60%|██████    | 6/10 [00:38<00:29,  7.40s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.948, 'compress@10': 0.5636, 'time@10': 8.9919}:  60%|██████    | 6/10 [00:43<00:29,  7.40s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.948, 'compress@10': 0.5636, 'time@10': 8.9919}:  70%|███████   | 7/10 [00:43<00:20,  6.81s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9504, 'compress@10': 0.5227, 'time@10': 8.843}:  70%|███████   | 7/10 [00:51<00:20,  6.81s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9504, 'compress@10': 0.5227, 'time@10': 8.843}:  80%|████████  | 8/10 [00:51<00:14,  7.14s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9539, 'compress@10': 0.546, 'time@10': 9.4579}:  80%|████████  | 8/10 [00:58<00:14,  7.14s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9539, 'compress@10': 0.546, 'time@10': 9.4579}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9561, 'compress@10': 0.5266, 'time@10': 9.4886}:  90%|█████████ | 9/10 [01:08<00:07,  7.16s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9561, 'compress@10': 0.5266, 'time@10': 9.4886}: 100%|██████████| 10/10 [01:08<00:00,  7.98s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9561, 'compress@10': 0.5266, 'time@10': 9.4886}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.01113818281140774
Avg hit ratio: 0.9010795782221928
Avg ndcg: 0.9561221429024279
Avg compression ratio: 0.5266024983196119
Avg train time: 9.488624048233032
Std train time: 2.824630365884391
[0.5899999999999996, 0.3099999999999999, 0.030000000000000006, 0.97, 0.83, 0.6099999999999997, 0.38999999999999996, 0.21, 0.73, 0.33000000000000007]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9378, 'compress@10': 0.6116, 'time@10': 8.1035}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9378, 'compress@10': 0.6116, 'time@10': 8.1035}:  10%|█         | 1/10 [00:04<00:36,  4.09s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.893, 'ndcg@10': 0.984, 'compress@10': 0.4719, 'time@10': 7.4771}:  10%|█         | 1/10 [00:10<00:36,  4.09s/it]  {'epoch': 49, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.893, 'ndcg@10': 0.984, 'compress@10': 0.4719, 'time@10': 7.4771}:  20%|██        | 2/10 [00:10<00:45,  5.74s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9417, 'compress@10': 0.3708, 'time@10': 6.8329}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9417, 'compress@10': 0.3708, 'time@10': 6.8329}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9462, 'compress@10': 0.5209, 'time@10': 6.6534}:  30%|███       | 3/10 [00:19<00:30,  4.40s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9462, 'compress@10': 0.5209, 'time@10': 6.6534}:  40%|████      | 4/10 [00:19<00:30,  5.09s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9488, 'compress@10': 0.5834, 'time@10': 7.9952}:  40%|████      | 4/10 [00:26<00:30,  5.09s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9488, 'compress@10': 0.5834, 'time@10': 7.9952}:  50%|█████     | 5/10 [00:26<00:28,  5.68s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9567, 'compress@10': 0.5893, 'time@10': 8.3418}:  50%|█████     | 5/10 [00:36<00:28,  5.68s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9567, 'compress@10': 0.5893, 'time@10': 8.3418}:  60%|██████    | 6/10 [00:36<00:28,  7.19s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9568, 'compress@10': 0.5643, 'time@10': 8.6817}:  60%|██████    | 6/10 [00:42<00:28,  7.19s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9568, 'compress@10': 0.5643, 'time@10': 8.6817}:  70%|███████   | 7/10 [00:42<00:19,  6.60s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9584, 'compress@10': 0.5228, 'time@10': 8.5235}:  70%|███████   | 7/10 [00:49<00:19,  6.60s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9584, 'compress@10': 0.5228, 'time@10': 8.5235}:  80%|████████  | 8/10 [00:49<00:13,  6.87s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9572, 'compress@10': 0.5467, 'time@10': 9.1192}:  80%|████████  | 8/10 [00:56<00:13,  6.87s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9572, 'compress@10': 0.5467, 'time@10': 9.1192}:  90%|█████████ | 9/10 [00:56<00:06,  6.91s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9566, 'compress@10': 0.5265, 'time@10': 9.13}:  90%|█████████ | 9/10 [01:05<00:06,  6.91s/it]     {'epoch': 49, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9566, 'compress@10': 0.5265, 'time@10': 9.13}: 100%|██████████| 10/10 [01:05<00:00,  7.64s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9566, 'compress@10': 0.5265, 'time@10': 9.13}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.015148251407767788
Avg hit ratio: 0.8967477809871698
Avg ndcg: 0.9566134044281854
Avg compression ratio: 0.526542577654151
Avg train time: 9.130008864402772
Std train time: 2.7402593852224224
[0.5784313725490192, 0.3235294117647058, 0.02941176470588236, 0.9705882352941176, 0.8137254901960784, 0.6176470588235291, 0.38235294117647056, 0.20588235294117646, 0.7352941176470588, 0.34313725490196084]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
