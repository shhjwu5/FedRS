  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1459, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5121, 'compress@10': 0.9766, 'time@10': 5.681}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1459, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5121, 'compress@10': 0.9766, 'time@10': 5.681}:  10%|█         | 1/10 [00:02<00:25,  2.88s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1069, 'hit_ratio@10': 0.6927, 'ndcg@10': 0.663, 'compress@10': 0.9741, 'time@10': 4.9063}:  10%|█         | 1/10 [00:07<00:25,  2.88s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1069, 'hit_ratio@10': 0.6927, 'ndcg@10': 0.663, 'compress@10': 0.9741, 'time@10': 4.9063}:  20%|██        | 2/10 [00:07<00:29,  3.64s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6776, 'hit_ratio@10': 0.6523, 'ndcg@10': 0.4593, 'compress@10': 0.9699, 'time@10': 3.8177}:  20%|██        | 2/10 [00:07<00:29,  3.64s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6776, 'hit_ratio@10': 0.6523, 'ndcg@10': 0.4593, 'compress@10': 0.9699, 'time@10': 3.8177}:  30%|███       | 3/10 [00:07<00:16,  2.37s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5291, 'hit_ratio@10': 0.6856, 'ndcg@10': 0.5205, 'compress@10': 0.9705, 'time@10': 3.7803}:  30%|███       | 3/10 [00:11<00:16,  2.37s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5291, 'hit_ratio@10': 0.6856, 'ndcg@10': 0.5205, 'compress@10': 0.9705, 'time@10': 3.7803}:  40%|████      | 4/10 [00:11<00:17,  2.90s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4417, 'hit_ratio@10': 0.7125, 'ndcg@10': 0.5705, 'compress@10': 0.9699, 'time@10': 5.7379}:  40%|████      | 4/10 [00:18<00:17,  2.90s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4417, 'hit_ratio@10': 0.7125, 'ndcg@10': 0.5705, 'compress@10': 0.9699, 'time@10': 5.7379}:  50%|█████     | 5/10 [00:18<00:21,  4.32s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.3822, 'hit_ratio@10': 0.7123, 'ndcg@10': 0.6104, 'compress@10': 0.9702, 'time@10': 5.7978}:  50%|█████     | 5/10 [00:24<00:21,  4.32s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.3822, 'hit_ratio@10': 0.7123, 'ndcg@10': 0.6104, 'compress@10': 0.9702, 'time@10': 5.7978}:  60%|██████    | 6/10 [00:24<00:19,  4.94s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3403, 'hit_ratio@10': 0.7305, 'ndcg@10': 0.6131, 'compress@10': 0.9716, 'time@10': 5.9216}:  60%|██████    | 6/10 [00:27<00:19,  4.94s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3403, 'hit_ratio@10': 0.7305, 'ndcg@10': 0.6131, 'compress@10': 0.9716, 'time@10': 5.9216}:  70%|███████   | 7/10 [00:27<00:13,  4.43s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3032, 'hit_ratio@10': 0.7535, 'ndcg@10': 0.6381, 'compress@10': 0.9717, 'time@10': 5.7614}:  70%|███████   | 7/10 [00:32<00:13,  4.43s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3032, 'hit_ratio@10': 0.7535, 'ndcg@10': 0.6381, 'compress@10': 0.9717, 'time@10': 5.7614}:  80%|████████  | 8/10 [00:32<00:09,  4.51s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2745, 'hit_ratio@10': 0.7491, 'ndcg@10': 0.6693, 'compress@10': 0.9706, 'time@10': 6.1801}:  80%|████████  | 8/10 [00:37<00:09,  4.51s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2745, 'hit_ratio@10': 0.7491, 'ndcg@10': 0.6693, 'compress@10': 0.9706, 'time@10': 6.1801}:  90%|█████████ | 9/10 [00:37<00:04,  4.60s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2522, 'hit_ratio@10': 0.7674, 'ndcg@10': 0.6873, 'compress@10': 0.9705, 'time@10': 6.1534}:  90%|█████████ | 9/10 [00:43<00:04,  4.60s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2522, 'hit_ratio@10': 0.7674, 'ndcg@10': 0.6873, 'compress@10': 0.9705, 'time@10': 6.1534}: 100%|██████████| 10/10 [00:43<00:00,  5.02s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2522, 'hit_ratio@10': 0.7674, 'ndcg@10': 0.6873, 'compress@10': 0.9705, 'time@10': 6.1534}: 100%|██████████| 10/10 [00:43<00:00,  4.34s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.25217708778054154
Avg hit ratio: 0.7674042559967857
Avg ndcg: 0.6872851650173504
Avg compression ratio: 0.9704731512271287
Avg train time: 6.153363108634949
Std train time: 3.1599070589658225
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.9771, 'time@10': 4.4612}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.9771, 'time@10': 4.4612}:  10%|█         | 1/10 [00:02<00:20,  2.27s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0514, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8522, 'compress@10': 0.9805, 'time@10': 4.2927}:  10%|█         | 1/10 [00:06<00:20,  2.27s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0514, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8522, 'compress@10': 0.9805, 'time@10': 4.2927}:  20%|██        | 2/10 [00:06<00:27,  3.38s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8393, 'compress@10': 0.9736, 'time@10': 3.4676}:  20%|██        | 2/10 [00:07<00:27,  3.38s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8393, 'compress@10': 0.9736, 'time@10': 3.4676}:  30%|███       | 3/10 [00:07<00:15,  2.27s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.041, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8402, 'compress@10': 0.9742, 'time@10': 3.509}:  30%|███       | 3/10 [00:11<00:15,  2.27s/it]  {'epoch': 1, 'num_users': 5.0, 'loss': 0.041, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8402, 'compress@10': 0.9742, 'time@10': 3.509}:  40%|████      | 4/10 [00:11<00:16,  2.82s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0501, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8293, 'compress@10': 0.9727, 'time@10': 5.2463}:  40%|████      | 4/10 [00:17<00:16,  2.82s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0501, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8293, 'compress@10': 0.9727, 'time@10': 5.2463}:  50%|█████     | 5/10 [00:17<00:20,  4.02s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0544, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8265, 'compress@10': 0.9729, 'time@10': 5.3826}:  50%|█████     | 5/10 [00:23<00:20,  4.02s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0544, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8265, 'compress@10': 0.9729, 'time@10': 5.3826}:  60%|██████    | 6/10 [00:23<00:18,  4.73s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0527, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8328, 'compress@10': 0.9746, 'time@10': 5.5485}:  60%|██████    | 6/10 [00:26<00:18,  4.73s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0527, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8328, 'compress@10': 0.9746, 'time@10': 5.5485}:  70%|███████   | 7/10 [00:26<00:12,  4.26s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8384, 'compress@10': 0.9748, 'time@10': 5.438}:  70%|███████   | 7/10 [00:31<00:12,  4.26s/it]   {'epoch': 1, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8384, 'compress@10': 0.9748, 'time@10': 5.438}:  80%|████████  | 8/10 [00:31<00:08,  4.41s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0492, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8467, 'compress@10': 0.9754, 'time@10': 5.7759}:  80%|████████  | 8/10 [00:35<00:08,  4.41s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0492, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8467, 'compress@10': 0.9754, 'time@10': 5.7759}:  90%|█████████ | 9/10 [00:35<00:04,  4.37s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8472, 'compress@10': 0.9757, 'time@10': 5.7913}:  90%|█████████ | 9/10 [00:41<00:04,  4.37s/it]  {'epoch': 1, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8472, 'compress@10': 0.9757, 'time@10': 5.7913}: 100%|██████████| 10/10 [00:41<00:00,  4.86s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8472, 'compress@10': 0.9757, 'time@10': 5.7913}: 100%|██████████| 10/10 [00:41<00:00,  4.16s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.04882154465498613
Avg hit ratio: 0.8258183827114218
Avg ndcg: 0.8472427281149091
Avg compression ratio: 0.975684855309191
Avg train time: 5.7912510395050045
Std train time: 2.741610139351245
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.9767, 'time@10': 4.5533}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.9767, 'time@10': 4.5533}:  10%|█         | 1/10 [00:02<00:20,  2.31s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8481, 'compress@10': 0.9768, 'time@10': 4.3343}:  10%|█         | 1/10 [00:06<00:20,  2.31s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8481, 'compress@10': 0.9768, 'time@10': 4.3343}:  20%|██        | 2/10 [00:06<00:27,  3.40s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0337, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8511, 'compress@10': 0.9782, 'time@10': 3.5478}:  20%|██        | 2/10 [00:07<00:27,  3.40s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0337, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8511, 'compress@10': 0.9782, 'time@10': 3.5478}:  30%|███       | 3/10 [00:07<00:16,  2.32s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8485, 'compress@10': 0.9776, 'time@10': 3.579}:  30%|███       | 3/10 [00:11<00:16,  2.32s/it]  {'epoch': 2, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8485, 'compress@10': 0.9776, 'time@10': 3.579}:  40%|████      | 4/10 [00:11<00:17,  2.87s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.8355, 'compress@10': 0.9748, 'time@10': 5.0702}:  40%|████      | 4/10 [00:16<00:17,  2.87s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.8355, 'compress@10': 0.9748, 'time@10': 5.0702}:  50%|█████     | 5/10 [00:16<00:19,  3.85s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0512, 'hit_ratio@10': 0.7673, 'ndcg@10': 0.8326, 'compress@10': 0.9741, 'time@10': 5.2472}:  50%|█████     | 5/10 [00:22<00:19,  3.85s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0512, 'hit_ratio@10': 0.7673, 'ndcg@10': 0.8326, 'compress@10': 0.9741, 'time@10': 5.2472}:  60%|██████    | 6/10 [00:22<00:18,  4.64s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0501, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.8347, 'compress@10': 0.9754, 'time@10': 5.4348}:  60%|██████    | 6/10 [00:26<00:18,  4.64s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0501, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.8347, 'compress@10': 0.9754, 'time@10': 5.4348}:  70%|███████   | 7/10 [00:26<00:12,  4.21s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8391, 'compress@10': 0.9762, 'time@10': 5.3362}:  70%|███████   | 7/10 [00:30<00:12,  4.21s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8391, 'compress@10': 0.9762, 'time@10': 5.3362}:  80%|████████  | 8/10 [00:30<00:08,  4.36s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8459, 'compress@10': 0.9765, 'time@10': 5.6838}:  80%|████████  | 8/10 [00:35<00:08,  4.36s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8459, 'compress@10': 0.9765, 'time@10': 5.6838}:  90%|█████████ | 9/10 [00:35<00:04,  4.33s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8468, 'compress@10': 0.9766, 'time@10': 5.7107}:  90%|█████████ | 9/10 [00:41<00:04,  4.33s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8468, 'compress@10': 0.9766, 'time@10': 5.7107}: 100%|██████████| 10/10 [00:41<00:00,  4.84s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8468, 'compress@10': 0.9766, 'time@10': 5.7107}: 100%|██████████| 10/10 [00:41<00:00,  4.12s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04934128041877164
Avg hit ratio: 0.8181040969971362
Avg ndcg: 0.8468486316494662
Avg compression ratio: 0.9765604509848338
Avg train time: 5.710729122161865
Std train time: 2.4498705301185844
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8455, 'compress@10': 0.9717, 'time@10': 4.0947}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8455, 'compress@10': 0.9717, 'time@10': 4.0947}:  10%|█         | 1/10 [00:02<00:18,  2.08s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.798, 'ndcg@10': 0.846, 'compress@10': 0.9739, 'time@10': 4.0914}:  10%|█         | 1/10 [00:06<00:18,  2.08s/it]   {'epoch': 3, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.798, 'ndcg@10': 0.846, 'compress@10': 0.9739, 'time@10': 4.0914}:  20%|██        | 2/10 [00:06<00:26,  3.29s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8497, 'compress@10': 0.9756, 'time@10': 3.4503}:  20%|██        | 2/10 [00:07<00:26,  3.29s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8497, 'compress@10': 0.9756, 'time@10': 3.4503}:  30%|███       | 3/10 [00:07<00:16,  2.30s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0367, 'hit_ratio@10': 0.774, 'ndcg@10': 0.844, 'compress@10': 0.9757, 'time@10': 3.5322}:  30%|███       | 3/10 [00:11<00:16,  2.30s/it]  {'epoch': 3, 'num_users': 5.0, 'loss': 0.0367, 'hit_ratio@10': 0.774, 'ndcg@10': 0.844, 'compress@10': 0.9757, 'time@10': 3.5322}:  40%|████      | 4/10 [00:11<00:17,  2.90s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.7832, 'ndcg@10': 0.8337, 'compress@10': 0.9735, 'time@10': 4.7448}:  40%|████      | 4/10 [00:15<00:17,  2.90s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.7832, 'ndcg@10': 0.8337, 'compress@10': 0.9735, 'time@10': 4.7448}:  50%|█████     | 5/10 [00:15<00:17,  3.60s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0495, 'hit_ratio@10': 0.7897, 'ndcg@10': 0.8324, 'compress@10': 0.973, 'time@10': 4.975}:  50%|█████     | 5/10 [00:22<00:17,  3.60s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0495, 'hit_ratio@10': 0.7897, 'ndcg@10': 0.8324, 'compress@10': 0.973, 'time@10': 4.975}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0497, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8359, 'compress@10': 0.9741, 'time@10': 5.2075}:  60%|██████    | 6/10 [00:25<00:17,  4.47s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0497, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8359, 'compress@10': 0.9741, 'time@10': 5.2075}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8471, 'compress@10': 0.9753, 'time@10': 5.1359}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8471, 'compress@10': 0.9753, 'time@10': 5.1359}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0492, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8563, 'compress@10': 0.9757, 'time@10': 5.5019}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0492, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8563, 'compress@10': 0.9757, 'time@10': 5.5019}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8548, 'compress@10': 0.9756, 'time@10': 5.5423}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8548, 'compress@10': 0.9756, 'time@10': 5.5423}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8548, 'compress@10': 0.9756, 'time@10': 5.5423}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04885039736006146
Avg hit ratio: 0.8344251415439871
Avg ndcg: 0.8548078874053676
Avg compression ratio: 0.975634073803762
Avg train time: 5.54229896068573
Std train time: 2.142267732350552
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8592, 'compress@10': 0.9712, 'time@10': 4.6998}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8592, 'compress@10': 0.9712, 'time@10': 4.6998}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8552, 'compress@10': 0.9742, 'time@10': 4.2845}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8552, 'compress@10': 0.9742, 'time@10': 4.2845}:  20%|██        | 2/10 [00:06<00:26,  3.34s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8559, 'compress@10': 0.9747, 'time@10': 3.6072}:  20%|██        | 2/10 [00:07<00:26,  3.34s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8559, 'compress@10': 0.9747, 'time@10': 3.6072}:  30%|███       | 3/10 [00:07<00:16,  2.34s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8492, 'compress@10': 0.975, 'time@10': 3.6209}:  30%|███       | 3/10 [00:11<00:16,  2.34s/it]  {'epoch': 4, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8492, 'compress@10': 0.975, 'time@10': 3.6209}:  40%|████      | 4/10 [00:11<00:17,  2.89s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0461, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8365, 'compress@10': 0.9729, 'time@10': 4.5298}:  40%|████      | 4/10 [00:15<00:17,  2.89s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0461, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8365, 'compress@10': 0.9729, 'time@10': 4.5298}:  50%|█████     | 5/10 [00:15<00:16,  3.33s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0488, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8352, 'compress@10': 0.973, 'time@10': 4.7813}:  50%|█████     | 5/10 [00:21<00:16,  3.33s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0488, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8352, 'compress@10': 0.973, 'time@10': 4.7813}:  60%|██████    | 6/10 [00:21<00:17,  4.27s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0482, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8348, 'compress@10': 0.9738, 'time@10': 5.0443}:  60%|██████    | 6/10 [00:24<00:17,  4.27s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0482, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8348, 'compress@10': 0.9738, 'time@10': 5.0443}:  70%|███████   | 7/10 [00:24<00:11,  3.97s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0489, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8428, 'compress@10': 0.9751, 'time@10': 4.9926}:  70%|███████   | 7/10 [00:29<00:11,  3.97s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0489, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8428, 'compress@10': 0.9751, 'time@10': 4.9926}:  80%|████████  | 8/10 [00:29<00:08,  4.19s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0528, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8579, 'compress@10': 0.9749, 'time@10': 5.3836}:  80%|████████  | 8/10 [00:33<00:08,  4.19s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0528, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8579, 'compress@10': 0.9749, 'time@10': 5.3836}:  90%|█████████ | 9/10 [00:33<00:04,  4.22s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0518, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8578, 'compress@10': 0.9749, 'time@10': 5.4275}:  90%|█████████ | 9/10 [00:39<00:04,  4.22s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0518, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8578, 'compress@10': 0.9749, 'time@10': 5.4275}: 100%|██████████| 10/10 [00:39<00:00,  4.73s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0518, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8578, 'compress@10': 0.9749, 'time@10': 5.4275}: 100%|██████████| 10/10 [00:39<00:00,  3.97s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.051760715075215555
Avg hit ratio: 0.8525874559321078
Avg ndcg: 0.8577654601148366
Avg compression ratio: 0.9749269747183528
Avg train time: 5.42753849029541
Std train time: 1.8908721299604667
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8466, 'compress@10': 0.9716, 'time@10': 4.621}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8466, 'compress@10': 0.9716, 'time@10': 4.621}:  10%|█         | 1/10 [00:02<00:21,  2.36s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8498, 'compress@10': 0.9749, 'time@10': 4.4315}:  10%|█         | 1/10 [00:06<00:21,  2.36s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8498, 'compress@10': 0.9749, 'time@10': 4.4315}:  20%|██        | 2/10 [00:06<00:27,  3.49s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8522, 'compress@10': 0.9743, 'time@10': 3.8251}:  20%|██        | 2/10 [00:07<00:27,  3.49s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8522, 'compress@10': 0.9743, 'time@10': 3.8251}:  30%|███       | 3/10 [00:07<00:17,  2.51s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8485, 'compress@10': 0.9751, 'time@10': 3.7998}:  30%|███       | 3/10 [00:11<00:17,  2.51s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8485, 'compress@10': 0.9751, 'time@10': 3.7998}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0447, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8359, 'compress@10': 0.9732, 'time@10': 4.6688}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0447, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8359, 'compress@10': 0.9732, 'time@10': 4.6688}:  50%|█████     | 5/10 [00:15<00:17,  3.40s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0467, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8353, 'compress@10': 0.9735, 'time@10': 4.9031}:  50%|█████     | 5/10 [00:21<00:17,  3.40s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0467, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8353, 'compress@10': 0.9735, 'time@10': 4.9031}:  60%|██████    | 6/10 [00:21<00:17,  4.32s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0463, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8391, 'compress@10': 0.974, 'time@10': 5.1582}:  60%|██████    | 6/10 [00:25<00:17,  4.32s/it] {'epoch': 5, 'num_users': 6.2857, 'loss': 0.0463, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8391, 'compress@10': 0.974, 'time@10': 5.1582}:  70%|███████   | 7/10 [00:25<00:12,  4.02s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0473, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8464, 'compress@10': 0.9754, 'time@10': 5.0937}:  70%|███████   | 7/10 [00:30<00:12,  4.02s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0473, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8464, 'compress@10': 0.9754, 'time@10': 5.0937}:  80%|████████  | 8/10 [00:30<00:08,  4.23s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0503, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8621, 'compress@10': 0.9765, 'time@10': 5.4728}:  80%|████████  | 8/10 [00:34<00:08,  4.23s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0503, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8621, 'compress@10': 0.9765, 'time@10': 5.4728}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.863, 'compress@10': 0.9766, 'time@10': 5.5158}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]     {'epoch': 5, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.863, 'compress@10': 0.9766, 'time@10': 5.5158}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.863, 'compress@10': 0.9766, 'time@10': 5.5158}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.049004679020055265
Avg hit ratio: 0.8612382495829015
Avg ndcg: 0.8630182178858108
Avg compression ratio: 0.9765978790073875
Avg train time: 5.515763664245606
Std train time: 1.803243108608249
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 0.9699, 'time@10': 4.3798}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 0.9699, 'time@10': 4.3798}:  10%|█         | 1/10 [00:02<00:20,  2.23s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0434, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8623, 'compress@10': 0.9744, 'time@10': 3.9516}:  10%|█         | 1/10 [00:05<00:20,  2.23s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0434, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8623, 'compress@10': 0.9744, 'time@10': 3.9516}:  20%|██        | 2/10 [00:05<00:24,  3.01s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8606, 'compress@10': 0.9733, 'time@10': 3.4955}:  20%|██        | 2/10 [00:07<00:24,  3.01s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8606, 'compress@10': 0.9733, 'time@10': 3.4955}:  30%|███       | 3/10 [00:07<00:15,  2.24s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8603, 'compress@10': 0.9745, 'time@10': 3.5411}:  30%|███       | 3/10 [00:10<00:15,  2.24s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8603, 'compress@10': 0.9745, 'time@10': 3.5411}:  40%|████      | 4/10 [00:10<00:16,  2.82s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0428, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8461, 'compress@10': 0.9731, 'time@10': 4.4458}:  40%|████      | 4/10 [00:14<00:16,  2.82s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0428, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8461, 'compress@10': 0.9731, 'time@10': 4.4458}:  50%|█████     | 5/10 [00:14<00:16,  3.27s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0442, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8446, 'compress@10': 0.9736, 'time@10': 4.7402}:  50%|█████     | 5/10 [00:21<00:16,  3.27s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0442, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8446, 'compress@10': 0.9736, 'time@10': 4.7402}:  60%|██████    | 6/10 [00:21<00:17,  4.29s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.043, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8474, 'compress@10': 0.9736, 'time@10': 5.0572}:  60%|██████    | 6/10 [00:24<00:17,  4.29s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.043, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8474, 'compress@10': 0.9736, 'time@10': 5.0572}:  70%|███████   | 7/10 [00:24<00:12,  4.04s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0443, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8533, 'compress@10': 0.9751, 'time@10': 5.0103}:  70%|███████   | 7/10 [00:29<00:12,  4.04s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0443, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8533, 'compress@10': 0.9751, 'time@10': 5.0103}:  80%|████████  | 8/10 [00:29<00:08,  4.26s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8587, 'compress@10': 0.9752, 'time@10': 5.3976}:  80%|████████  | 8/10 [00:33<00:08,  4.26s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8587, 'compress@10': 0.9752, 'time@10': 5.3976}:  90%|█████████ | 9/10 [00:33<00:04,  4.27s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0461, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8602, 'compress@10': 0.9755, 'time@10': 5.4548}:  90%|█████████ | 9/10 [00:39<00:04,  4.27s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0461, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8602, 'compress@10': 0.9755, 'time@10': 5.4548}: 100%|██████████| 10/10 [00:39<00:00,  4.80s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0461, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8602, 'compress@10': 0.9755, 'time@10': 5.4548}: 100%|██████████| 10/10 [00:39<00:00,  3.97s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04612879776332958
Avg hit ratio: 0.8685838717027172
Avg ndcg: 0.8601567149441852
Avg compression ratio: 0.9754723176889307
Avg train time: 5.454786539077759
Std train time: 1.8985301326982225
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8348, 'compress@10': 0.9706, 'time@10': 4.7193}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8348, 'compress@10': 0.9706, 'time@10': 4.7193}:  10%|█         | 1/10 [00:02<00:21,  2.40s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8571, 'compress@10': 0.9745, 'time@10': 3.9486}:  10%|█         | 1/10 [00:05<00:21,  2.40s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8571, 'compress@10': 0.9745, 'time@10': 3.9486}:  20%|██        | 2/10 [00:05<00:23,  2.88s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8571, 'compress@10': 0.973, 'time@10': 3.5688}:  20%|██        | 2/10 [00:07<00:23,  2.88s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8571, 'compress@10': 0.973, 'time@10': 3.5688}:  30%|███       | 3/10 [00:07<00:15,  2.23s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8559, 'compress@10': 0.9743, 'time@10': 3.6214}:  30%|███       | 3/10 [00:10<00:15,  2.23s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8559, 'compress@10': 0.9743, 'time@10': 3.6214}:  40%|████      | 4/10 [00:10<00:17,  2.86s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0421, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8427, 'compress@10': 0.973, 'time@10': 4.5538}:  40%|████      | 4/10 [00:15<00:17,  2.86s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.0421, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8427, 'compress@10': 0.973, 'time@10': 4.5538}:  50%|█████     | 5/10 [00:15<00:16,  3.33s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0428, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8438, 'compress@10': 0.9733, 'time@10': 4.8188}:  50%|█████     | 5/10 [00:21<00:16,  3.33s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0428, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8438, 'compress@10': 0.9733, 'time@10': 4.8188}:  60%|██████    | 6/10 [00:21<00:17,  4.30s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.042, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8508, 'compress@10': 0.973, 'time@10': 5.0912}:  60%|██████    | 6/10 [00:24<00:17,  4.30s/it]  {'epoch': 7, 'num_users': 6.2857, 'loss': 0.042, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8508, 'compress@10': 0.973, 'time@10': 5.0912}:  70%|███████   | 7/10 [00:24<00:12,  4.01s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0429, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8512, 'compress@10': 0.9746, 'time@10': 5.0379}:  70%|███████   | 7/10 [00:29<00:12,  4.01s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0429, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8512, 'compress@10': 0.9746, 'time@10': 5.0379}:  80%|████████  | 8/10 [00:29<00:08,  4.23s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0426, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8594, 'compress@10': 0.9756, 'time@10': 5.4236}:  80%|████████  | 8/10 [00:33<00:08,  4.23s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0426, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8594, 'compress@10': 0.9756, 'time@10': 5.4236}:  90%|█████████ | 9/10 [00:33<00:04,  4.25s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0416, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8632, 'compress@10': 0.976, 'time@10': 5.475}:  90%|█████████ | 9/10 [00:39<00:04,  4.25s/it]     {'epoch': 7, 'num_users': 6.3, 'loss': 0.0416, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8632, 'compress@10': 0.976, 'time@10': 5.475}: 100%|██████████| 10/10 [00:39<00:00,  4.79s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0416, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8632, 'compress@10': 0.976, 'time@10': 5.475}: 100%|██████████| 10/10 [00:39<00:00,  3.96s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04158630648228513
Avg hit ratio: 0.8615677855440165
Avg ndcg: 0.8632444227451872
Avg compression ratio: 0.9760273758526488
Avg train time: 5.475024628639221
Std train time: 1.892378940105656
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0437, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.9693, 'time@10': 4.9814}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0437, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.9693, 'time@10': 4.9814}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8668, 'compress@10': 0.9734, 'time@10': 4.3236}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8668, 'compress@10': 0.9734, 'time@10': 4.3236}:  20%|██        | 2/10 [00:06<00:25,  3.22s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8636, 'compress@10': 0.972, 'time@10': 3.7451}:  20%|██        | 2/10 [00:07<00:25,  3.22s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8636, 'compress@10': 0.972, 'time@10': 3.7451}:  30%|███       | 3/10 [00:07<00:16,  2.36s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8591, 'compress@10': 0.9733, 'time@10': 3.7418}:  30%|███       | 3/10 [00:11<00:16,  2.36s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8591, 'compress@10': 0.9733, 'time@10': 3.7418}:  40%|████      | 4/10 [00:11<00:17,  2.92s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0399, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8456, 'compress@10': 0.9724, 'time@10': 4.6373}:  40%|████      | 4/10 [00:15<00:17,  2.92s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0399, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8456, 'compress@10': 0.9724, 'time@10': 4.6373}:  50%|█████     | 5/10 [00:15<00:16,  3.36s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8479, 'compress@10': 0.973, 'time@10': 4.8744}:  50%|█████     | 5/10 [00:21<00:16,  3.36s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8479, 'compress@10': 0.973, 'time@10': 4.8744}:  60%|██████    | 6/10 [00:21<00:17,  4.29s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0399, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8496, 'compress@10': 0.9727, 'time@10': 5.145}:  60%|██████    | 6/10 [00:25<00:17,  4.29s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0399, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8496, 'compress@10': 0.9727, 'time@10': 5.145}:  70%|███████   | 7/10 [00:25<00:12,  4.01s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0398, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8526, 'compress@10': 0.9742, 'time@10': 5.0907}:  70%|███████   | 7/10 [00:29<00:12,  4.01s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0398, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8526, 'compress@10': 0.9742, 'time@10': 5.0907}:  80%|████████  | 8/10 [00:29<00:08,  4.24s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.041, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8729, 'compress@10': 0.9745, 'time@10': 5.4741}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.041, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8729, 'compress@10': 0.9745, 'time@10': 5.4741}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.041, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8714, 'compress@10': 0.9749, 'time@10': 5.5278}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.041, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8714, 'compress@10': 0.9749, 'time@10': 5.5278}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.041, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8714, 'compress@10': 0.9749, 'time@10': 5.5278}: 100%|██████████| 10/10 [00:40<00:00,  4.01s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04098839683212235
Avg hit ratio: 0.8684474847921366
Avg ndcg: 0.8714449871011996
Avg compression ratio: 0.9748557017228363
Avg train time: 5.527823758125305
Std train time: 1.8623253855053954
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0564, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8249, 'compress@10': 0.9691, 'time@10': 5.0219}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0564, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8249, 'compress@10': 0.9691, 'time@10': 5.0219}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8479, 'compress@10': 0.9722, 'time@10': 4.4638}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8479, 'compress@10': 0.9722, 'time@10': 4.4638}:  20%|██        | 2/10 [00:06<00:26,  3.37s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.851, 'compress@10': 0.9705, 'time@10': 3.7731}:  20%|██        | 2/10 [00:07<00:26,  3.37s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.851, 'compress@10': 0.9705, 'time@10': 3.7731}:  30%|███       | 3/10 [00:07<00:16,  2.42s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8551, 'compress@10': 0.9718, 'time@10': 3.7486}:  30%|███       | 3/10 [00:11<00:16,  2.42s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8551, 'compress@10': 0.9718, 'time@10': 3.7486}:  40%|████      | 4/10 [00:11<00:17,  2.93s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.041, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8453, 'compress@10': 0.9711, 'time@10': 4.6367}:  40%|████      | 4/10 [00:15<00:17,  2.93s/it] {'epoch': 9, 'num_users': 5.8, 'loss': 0.041, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8453, 'compress@10': 0.9711, 'time@10': 4.6367}:  50%|█████     | 5/10 [00:15<00:16,  3.36s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0406, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8488, 'compress@10': 0.9719, 'time@10': 4.8807}:  50%|█████     | 5/10 [00:21<00:16,  3.36s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0406, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8488, 'compress@10': 0.9719, 'time@10': 4.8807}:  60%|██████    | 6/10 [00:21<00:17,  4.31s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0396, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8574, 'compress@10': 0.9715, 'time@10': 5.1285}:  60%|██████    | 6/10 [00:25<00:17,  4.31s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0396, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8574, 'compress@10': 0.9715, 'time@10': 5.1285}:  70%|███████   | 7/10 [00:25<00:11,  3.99s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0384, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8616, 'compress@10': 0.973, 'time@10': 5.0757}:  70%|███████   | 7/10 [00:29<00:11,  3.99s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0384, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8616, 'compress@10': 0.973, 'time@10': 5.0757}:  80%|████████  | 8/10 [00:29<00:08,  4.23s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0384, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8685, 'compress@10': 0.9744, 'time@10': 5.4521}:  80%|████████  | 8/10 [00:34<00:08,  4.23s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0384, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8685, 'compress@10': 0.9744, 'time@10': 5.4521}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8737, 'compress@10': 0.9751, 'time@10': 5.5011}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8737, 'compress@10': 0.9751, 'time@10': 5.5011}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8737, 'compress@10': 0.9751, 'time@10': 5.5011}: 100%|██████████| 10/10 [00:40<00:00,  4.01s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.036446347523285856
Avg hit ratio: 0.8643710057156577
Avg ndcg: 0.8736545572164058
Avg compression ratio: 0.9751000924064817
Avg train time: 5.501107859611511
Std train time: 1.84949730711273
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8517, 'compress@10': 0.9684, 'time@10': 4.9848}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8517, 'compress@10': 0.9684, 'time@10': 4.9848}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8606, 'compress@10': 0.9718, 'time@10': 4.3525}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8606, 'compress@10': 0.9718, 'time@10': 4.3525}:  20%|██        | 2/10 [00:06<00:26,  3.25s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8594, 'compress@10': 0.9702, 'time@10': 3.8804}:  20%|██        | 2/10 [00:07<00:26,  3.25s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8594, 'compress@10': 0.9702, 'time@10': 3.8804}:  30%|███       | 3/10 [00:07<00:17,  2.51s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8624, 'compress@10': 0.9712, 'time@10': 3.6865}:  30%|███       | 3/10 [00:11<00:17,  2.51s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8624, 'compress@10': 0.9712, 'time@10': 3.6865}:  40%|████      | 4/10 [00:11<00:16,  2.76s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0386, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8509, 'compress@10': 0.9708, 'time@10': 4.6469}:  40%|████      | 4/10 [00:15<00:16,  2.76s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0386, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8509, 'compress@10': 0.9708, 'time@10': 4.6469}:  50%|█████     | 5/10 [00:15<00:16,  3.31s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0385, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8542, 'compress@10': 0.9717, 'time@10': 4.8953}:  50%|█████     | 5/10 [00:21<00:16,  3.31s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0385, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8542, 'compress@10': 0.9717, 'time@10': 4.8953}:  60%|██████    | 6/10 [00:21<00:17,  4.29s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0387, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8597, 'compress@10': 0.9712, 'time@10': 5.1418}:  60%|██████    | 6/10 [00:24<00:17,  4.29s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0387, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8597, 'compress@10': 0.9712, 'time@10': 5.1418}:  70%|███████   | 7/10 [00:24<00:11,  3.98s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0369, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.865, 'compress@10': 0.9727, 'time@10': 5.0841}:  70%|███████   | 7/10 [00:29<00:11,  3.98s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.0369, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.865, 'compress@10': 0.9727, 'time@10': 5.0841}:  80%|████████  | 8/10 [00:29<00:08,  4.22s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0377, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8841, 'compress@10': 0.9729, 'time@10': 5.4639}:  80%|████████  | 8/10 [00:33<00:08,  4.22s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0377, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8841, 'compress@10': 0.9729, 'time@10': 5.4639}:  90%|█████████ | 9/10 [00:33<00:04,  4.24s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0376, 'hit_ratio@10': 0.882, 'ndcg@10': 0.8832, 'compress@10': 0.9734, 'time@10': 5.5114}:  90%|█████████ | 9/10 [00:39<00:04,  4.24s/it]    {'epoch': 10, 'num_users': 6.3, 'loss': 0.0376, 'hit_ratio@10': 0.882, 'ndcg@10': 0.8832, 'compress@10': 0.9734, 'time@10': 5.5114}: 100%|██████████| 10/10 [00:39<00:00,  4.78s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0376, 'hit_ratio@10': 0.882, 'ndcg@10': 0.8832, 'compress@10': 0.9734, 'time@10': 5.5114}: 100%|██████████| 10/10 [00:39<00:00,  3.99s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03762270963092491
Avg hit ratio: 0.8820217993664512
Avg ndcg: 0.883181373963961
Avg compression ratio: 0.9734050409103927
Avg train time: 5.511361503601075
Std train time: 1.903064104454996
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.85, 'compress@10': 0.9679, 'time@10': 5.0977}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.85, 'compress@10': 0.9679, 'time@10': 5.0977}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8667, 'compress@10': 0.972, 'time@10': 4.4589}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8667, 'compress@10': 0.972, 'time@10': 4.4589}:  20%|██        | 2/10 [00:06<00:26,  3.35s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8635, 'compress@10': 0.9707, 'time@10': 3.9693}:  20%|██        | 2/10 [00:08<00:26,  3.35s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8635, 'compress@10': 0.9707, 'time@10': 3.9693}:  30%|███       | 3/10 [00:08<00:17,  2.52s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8675, 'compress@10': 0.971, 'time@10': 3.7535}:  30%|███       | 3/10 [00:11<00:17,  2.52s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8675, 'compress@10': 0.971, 'time@10': 3.7535}:  40%|████      | 4/10 [00:11<00:16,  2.77s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0347, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8558, 'compress@10': 0.9706, 'time@10': 4.5676}:  40%|████      | 4/10 [00:15<00:16,  2.77s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0347, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8558, 'compress@10': 0.9706, 'time@10': 4.5676}:  50%|█████     | 5/10 [00:15<00:15,  3.20s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0353, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8597, 'compress@10': 0.9717, 'time@10': 4.829}:  50%|█████     | 5/10 [00:21<00:15,  3.20s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0353, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8597, 'compress@10': 0.9717, 'time@10': 4.829}:  60%|██████    | 6/10 [00:21<00:16,  4.21s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0353, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.8599, 'compress@10': 0.9708, 'time@10': 5.0868}:  60%|██████    | 6/10 [00:24<00:16,  4.21s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0353, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.8599, 'compress@10': 0.9708, 'time@10': 5.0868}:  70%|███████   | 7/10 [00:24<00:11,  3.93s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0339, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.866, 'compress@10': 0.9723, 'time@10': 5.036}:  70%|███████   | 7/10 [00:29<00:11,  3.93s/it]   {'epoch': 11, 'num_users': 6.125, 'loss': 0.0339, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.866, 'compress@10': 0.9723, 'time@10': 5.036}:  80%|████████  | 8/10 [00:29<00:08,  4.31s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0335, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8712, 'compress@10': 0.9737, 'time@10': 5.4369}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0335, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8712, 'compress@10': 0.9737, 'time@10': 5.4369}:  90%|█████████ | 9/10 [00:34<00:04,  4.33s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8761, 'compress@10': 0.9743, 'time@10': 5.488}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]    {'epoch': 11, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8761, 'compress@10': 0.9743, 'time@10': 5.488}: 100%|██████████| 10/10 [00:40<00:00,  4.84s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8761, 'compress@10': 0.9743, 'time@10': 5.488}: 100%|██████████| 10/10 [00:40<00:00,  4.01s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03244429069830458
Avg hit ratio: 0.8812020079524323
Avg ndcg: 0.876111323935322
Avg compression ratio: 0.9742873440454899
Avg train time: 5.487982940673828
Std train time: 1.8126734026355886
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8467, 'compress@10': 0.9677, 'time@10': 5.0013}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8467, 'compress@10': 0.9677, 'time@10': 5.0013}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8679, 'compress@10': 0.9711, 'time@10': 4.4506}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]  {'epoch': 12, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8679, 'compress@10': 0.9711, 'time@10': 4.4506}:  20%|██        | 2/10 [00:06<00:26,  3.37s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8643, 'compress@10': 0.9702, 'time@10': 4.0018}:  20%|██        | 2/10 [00:08<00:26,  3.37s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8643, 'compress@10': 0.9702, 'time@10': 4.0018}:  30%|███       | 3/10 [00:08<00:17,  2.56s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8684, 'compress@10': 0.9706, 'time@10': 3.8584}:  30%|███       | 3/10 [00:11<00:17,  2.56s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8684, 'compress@10': 0.9706, 'time@10': 3.8584}:  40%|████      | 4/10 [00:11<00:17,  2.92s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0337, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8581, 'compress@10': 0.9704, 'time@10': 4.6316}:  40%|████      | 4/10 [00:15<00:17,  2.92s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0337, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8581, 'compress@10': 0.9704, 'time@10': 4.6316}:  50%|█████     | 5/10 [00:15<00:16,  3.27s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0334, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8628, 'compress@10': 0.9718, 'time@10': 4.8968}:  50%|█████     | 5/10 [00:21<00:16,  3.27s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0334, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8628, 'compress@10': 0.9718, 'time@10': 4.8968}:  60%|██████    | 6/10 [00:21<00:17,  4.29s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0324, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8702, 'compress@10': 0.9713, 'time@10': 5.1539}:  60%|██████    | 6/10 [00:25<00:17,  4.29s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0324, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8702, 'compress@10': 0.9713, 'time@10': 5.1539}:  70%|███████   | 7/10 [00:25<00:11,  4.00s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8727, 'compress@10': 0.9726, 'time@10': 5.0939}:  70%|███████   | 7/10 [00:29<00:11,  4.00s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8727, 'compress@10': 0.9726, 'time@10': 5.0939}:  80%|████████  | 8/10 [00:29<00:08,  4.22s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0306, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8796, 'compress@10': 0.9733, 'time@10': 5.478}:  80%|████████  | 8/10 [00:34<00:08,  4.22s/it] {'epoch': 12, 'num_users': 6.3333, 'loss': 0.0306, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8796, 'compress@10': 0.9733, 'time@10': 5.478}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8853, 'compress@10': 0.974, 'time@10': 5.5239}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8853, 'compress@10': 0.974, 'time@10': 5.5239}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8853, 'compress@10': 0.974, 'time@10': 5.5239}: 100%|██████████| 10/10 [00:40<00:00,  4.01s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.029124407682573655
Avg hit ratio: 0.8816531357719812
Avg ndcg: 0.8852898813414036
Avg compression ratio: 0.9739954481911832
Avg train time: 5.523892331123352
Std train time: 1.7297321664861764
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.871, 'compress@10': 0.9669, 'time@10': 5.0212}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.871, 'compress@10': 0.9669, 'time@10': 5.0212}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8839, 'compress@10': 0.9699, 'time@10': 4.5479}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8839, 'compress@10': 0.9699, 'time@10': 4.5479}:  20%|██        | 2/10 [00:06<00:27,  3.48s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.875, 'compress@10': 0.9693, 'time@10': 4.0118}:  20%|██        | 2/10 [00:08<00:27,  3.48s/it]  {'epoch': 13, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.875, 'compress@10': 0.9693, 'time@10': 4.0118}:  30%|███       | 3/10 [00:08<00:18,  2.58s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8759, 'compress@10': 0.9694, 'time@10': 3.8698}:  30%|███       | 3/10 [00:11<00:18,  2.58s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8759, 'compress@10': 0.9694, 'time@10': 3.8698}:  40%|████      | 4/10 [00:11<00:17,  2.94s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.866, 'compress@10': 0.9694, 'time@10': 4.6332}:  40%|████      | 4/10 [00:15<00:17,  2.94s/it] {'epoch': 13, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.866, 'compress@10': 0.9694, 'time@10': 4.6332}:  50%|█████     | 5/10 [00:15<00:16,  3.28s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8751, 'compress@10': 0.9702, 'time@10': 4.9035}:  50%|█████     | 5/10 [00:21<00:16,  3.28s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8751, 'compress@10': 0.9702, 'time@10': 4.9035}:  60%|██████    | 6/10 [00:21<00:17,  4.30s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0335, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8781, 'compress@10': 0.9701, 'time@10': 5.138}:  60%|██████    | 6/10 [00:25<00:17,  4.30s/it]  {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0335, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8781, 'compress@10': 0.9701, 'time@10': 5.138}:  70%|███████   | 7/10 [00:25<00:11,  3.98s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0318, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8843, 'compress@10': 0.9714, 'time@10': 5.0809}:  70%|███████   | 7/10 [00:29<00:11,  3.98s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0318, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8843, 'compress@10': 0.9714, 'time@10': 5.0809}:  80%|████████  | 8/10 [00:29<00:08,  4.22s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0309, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.891, 'compress@10': 0.9719, 'time@10': 5.4627}:  80%|████████  | 8/10 [00:34<00:08,  4.22s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0309, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.891, 'compress@10': 0.9719, 'time@10': 5.4627}:  90%|█████████ | 9/10 [00:34<00:04,  4.24s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8919, 'compress@10': 0.9726, 'time@10': 5.5097}:  90%|█████████ | 9/10 [00:40<00:04,  4.24s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8919, 'compress@10': 0.9726, 'time@10': 5.5097}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8919, 'compress@10': 0.9726, 'time@10': 5.5097}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03043941645242349
Avg hit ratio: 0.8850122299884609
Avg ndcg: 0.8918850909219536
Avg compression ratio: 0.9726484159395241
Avg train time: 5.509658789634704
Std train time: 1.7160684970097375
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0446, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.877, 'compress@10': 0.9644, 'time@10': 5.0048}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0446, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.877, 'compress@10': 0.9644, 'time@10': 5.0048}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.891, 'compress@10': 0.9676, 'time@10': 4.547}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it] {'epoch': 14, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.891, 'compress@10': 0.9676, 'time@10': 4.547}:  20%|██        | 2/10 [00:06<00:27,  3.47s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8797, 'compress@10': 0.9679, 'time@10': 4.0743}:  20%|██        | 2/10 [00:08<00:27,  3.47s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8797, 'compress@10': 0.9679, 'time@10': 4.0743}:  30%|███       | 3/10 [00:08<00:18,  2.62s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8792, 'compress@10': 0.968, 'time@10': 3.966}:  30%|███       | 3/10 [00:11<00:18,  2.62s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8792, 'compress@10': 0.968, 'time@10': 3.966}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0312, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8695, 'compress@10': 0.9683, 'time@10': 4.7001}:  40%|████      | 4/10 [00:15<00:18,  3.04s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0312, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8695, 'compress@10': 0.9683, 'time@10': 4.7001}:  50%|█████     | 5/10 [00:15<00:16,  3.34s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0314, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8773, 'compress@10': 0.9673, 'time@10': 4.9453}:  50%|█████     | 5/10 [00:22<00:16,  3.34s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0314, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8773, 'compress@10': 0.9673, 'time@10': 4.9453}:  60%|██████    | 6/10 [00:22<00:17,  4.31s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0314, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.8756, 'compress@10': 0.9669, 'time@10': 5.2046}:  60%|██████    | 6/10 [00:25<00:17,  4.31s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0314, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.8756, 'compress@10': 0.9669, 'time@10': 5.2046}:  70%|███████   | 7/10 [00:25<00:12,  4.02s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0309, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.8739, 'compress@10': 0.9681, 'time@10': 5.1501}:  70%|███████   | 7/10 [00:30<00:12,  4.02s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0309, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.8739, 'compress@10': 0.9681, 'time@10': 5.1501}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.03, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.8822, 'compress@10': 0.9688, 'time@10': 5.544}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]  {'epoch': 14, 'num_users': 6.3333, 'loss': 0.03, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.8822, 'compress@10': 0.9688, 'time@10': 5.544}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.8882, 'compress@10': 0.9699, 'time@10': 5.5867}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.8882, 'compress@10': 0.9699, 'time@10': 5.5867}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.8882, 'compress@10': 0.9699, 'time@10': 5.5867}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.028090588923456793
Avg hit ratio: 0.9066500366262675
Avg ndcg: 0.8882319522595152
Avg compression ratio: 0.9698818676817484
Avg train time: 5.58668532371521
Std train time: 1.6972968490498086
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8789, 'compress@10': 0.9675, 'time@10': 5.0817}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8789, 'compress@10': 0.9675, 'time@10': 5.0817}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8951, 'compress@10': 0.9677, 'time@10': 4.5745}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8951, 'compress@10': 0.9677, 'time@10': 4.5745}:  20%|██        | 2/10 [00:06<00:27,  3.48s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8825, 'compress@10': 0.9683, 'time@10': 4.2521}:  20%|██        | 2/10 [00:08<00:27,  3.48s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8825, 'compress@10': 0.9683, 'time@10': 4.2521}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8832, 'compress@10': 0.968, 'time@10': 4.055}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]  {'epoch': 15, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8832, 'compress@10': 0.968, 'time@10': 4.055}:  40%|████      | 4/10 [00:12<00:18,  3.04s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0291, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8738, 'compress@10': 0.9684, 'time@10': 4.7206}:  40%|████      | 4/10 [00:15<00:18,  3.04s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0291, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8738, 'compress@10': 0.9684, 'time@10': 4.7206}:  50%|█████     | 5/10 [00:15<00:16,  3.29s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0276, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8823, 'compress@10': 0.9672, 'time@10': 4.9568}:  50%|█████     | 5/10 [00:21<00:16,  3.29s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0276, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8823, 'compress@10': 0.9672, 'time@10': 4.9568}:  60%|██████    | 6/10 [00:21<00:17,  4.27s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0275, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8886, 'compress@10': 0.9671, 'time@10': 5.2081}:  60%|██████    | 6/10 [00:25<00:17,  4.27s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0275, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8886, 'compress@10': 0.9671, 'time@10': 5.2081}:  70%|███████   | 7/10 [00:25<00:11,  3.99s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.027, 'hit_ratio@10': 0.884, 'ndcg@10': 0.8908, 'compress@10': 0.9686, 'time@10': 5.1379}:  70%|███████   | 7/10 [00:30<00:11,  3.99s/it]   {'epoch': 15, 'num_users': 6.125, 'loss': 0.027, 'hit_ratio@10': 0.884, 'ndcg@10': 0.8908, 'compress@10': 0.9686, 'time@10': 5.1379}:  80%|████████  | 8/10 [00:30<00:08,  4.21s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8979, 'compress@10': 0.9694, 'time@10': 5.5161}:  80%|████████  | 8/10 [00:34<00:08,  4.21s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8979, 'compress@10': 0.9694, 'time@10': 5.5161}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9044, 'compress@10': 0.9703, 'time@10': 5.5636}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9044, 'compress@10': 0.9703, 'time@10': 5.5636}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9044, 'compress@10': 0.9703, 'time@10': 5.5636}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.02636781079421934
Avg hit ratio: 0.8820750238254481
Avg ndcg: 0.9043783714846556
Avg compression ratio: 0.9702604971478002
Avg train time: 5.56361756324768
Std train time: 1.5991736262416214
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8819, 'compress@10': 0.9674, 'time@10': 5.0275}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8819, 'compress@10': 0.9674, 'time@10': 5.0275}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8898, 'compress@10': 0.9673, 'time@10': 4.5926}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8898, 'compress@10': 0.9673, 'time@10': 4.5926}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8789, 'compress@10': 0.9682, 'time@10': 4.068}:  20%|██        | 2/10 [00:08<00:28,  3.52s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8789, 'compress@10': 0.9682, 'time@10': 4.068}:  30%|███       | 3/10 [00:08<00:18,  2.62s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8839, 'compress@10': 0.9676, 'time@10': 3.9294}:  30%|███       | 3/10 [00:11<00:18,  2.62s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8839, 'compress@10': 0.9676, 'time@10': 3.9294}:  40%|████      | 4/10 [00:11<00:17,  2.99s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0279, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8759, 'compress@10': 0.968, 'time@10': 4.5477}:  40%|████      | 4/10 [00:15<00:17,  2.99s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0279, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8759, 'compress@10': 0.968, 'time@10': 4.5477}:  50%|█████     | 5/10 [00:15<00:15,  3.19s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0284, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8835, 'compress@10': 0.9671, 'time@10': 4.8167}:  50%|█████     | 5/10 [00:21<00:15,  3.19s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0284, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8835, 'compress@10': 0.9671, 'time@10': 4.8167}:  60%|██████    | 6/10 [00:21<00:16,  4.21s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0289, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8857, 'compress@10': 0.9669, 'time@10': 5.08}:  60%|██████    | 6/10 [00:24<00:16,  4.21s/it]  {'epoch': 16, 'num_users': 6.2857, 'loss': 0.0289, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8857, 'compress@10': 0.9669, 'time@10': 5.08}:  70%|███████   | 7/10 [00:24<00:11,  3.94s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0275, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.892, 'compress@10': 0.9678, 'time@10': 5.0314}:  70%|███████   | 7/10 [00:29<00:11,  3.94s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0275, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.892, 'compress@10': 0.9678, 'time@10': 5.0314}:  80%|████████  | 8/10 [00:29<00:08,  4.19s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9055, 'compress@10': 0.9685, 'time@10': 5.4238}:  80%|████████  | 8/10 [00:34<00:08,  4.19s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9055, 'compress@10': 0.9685, 'time@10': 5.4238}:  90%|█████████ | 9/10 [00:34<00:04,  4.23s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9047, 'compress@10': 0.9696, 'time@10': 5.4739}:  90%|█████████ | 9/10 [00:39<00:04,  4.23s/it]    {'epoch': 16, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9047, 'compress@10': 0.9696, 'time@10': 5.4739}: 100%|██████████| 10/10 [00:39<00:00,  4.77s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9047, 'compress@10': 0.9696, 'time@10': 5.4739}: 100%|██████████| 10/10 [00:39<00:00,  4.00s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.027504378467399254
Avg hit ratio: 0.8879731023551057
Avg ndcg: 0.9047039775513619
Avg compression ratio: 0.9695666139418344
Avg train time: 5.473892283439636
Std train time: 1.625906296689133
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.967, 'time@10': 5.0901}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.967, 'time@10': 5.0901}:  10%|█         | 1/10 [00:02<00:23,  2.61s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9004, 'compress@10': 0.967, 'time@10': 4.6616}:  10%|█         | 1/10 [00:06<00:23,  2.61s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9004, 'compress@10': 0.967, 'time@10': 4.6616}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.886, 'compress@10': 0.9682, 'time@10': 4.2878}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.886, 'compress@10': 0.9682, 'time@10': 4.2878}:  30%|███       | 3/10 [00:08<00:19,  2.78s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.894, 'compress@10': 0.9672, 'time@10': 4.0585}:  30%|███       | 3/10 [00:12<00:19,  2.78s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.894, 'compress@10': 0.9672, 'time@10': 4.0585}:  40%|████      | 4/10 [00:12<00:18,  3.03s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0255, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8852, 'compress@10': 0.9685, 'time@10': 4.7033}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0255, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8852, 'compress@10': 0.9685, 'time@10': 4.7033}:  50%|█████     | 5/10 [00:15<00:16,  3.26s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0264, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8958, 'compress@10': 0.9662, 'time@10': 4.9416}:  50%|█████     | 5/10 [00:21<00:16,  3.26s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0264, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8958, 'compress@10': 0.9662, 'time@10': 4.9416}:  60%|██████    | 6/10 [00:21<00:17,  4.25s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0261, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8958, 'compress@10': 0.9662, 'time@10': 5.1952}:  60%|██████    | 6/10 [00:25<00:17,  4.25s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0261, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8958, 'compress@10': 0.9662, 'time@10': 5.1952}:  70%|███████   | 7/10 [00:25<00:11,  3.97s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0266, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8992, 'compress@10': 0.967, 'time@10': 5.1339}:  70%|███████   | 7/10 [00:30<00:11,  3.97s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 0.0266, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8992, 'compress@10': 0.967, 'time@10': 5.1339}:  80%|████████  | 8/10 [00:30<00:08,  4.22s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.923, 'compress@10': 0.9676, 'time@10': 5.5223}:  80%|████████  | 8/10 [00:34<00:08,  4.22s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.923, 'compress@10': 0.9676, 'time@10': 5.5223}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0258, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.927, 'compress@10': 0.9694, 'time@10': 5.57}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]     {'epoch': 17, 'num_users': 6.3, 'loss': 0.0258, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.927, 'compress@10': 0.9694, 'time@10': 5.57}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0258, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.927, 'compress@10': 0.9694, 'time@10': 5.57}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.025760149404751558
Avg hit ratio: 0.8730524674344708
Avg ndcg: 0.9270148781176578
Avg compression ratio: 0.9693686161004585
Avg train time: 5.569985866546631
Std train time: 1.6074048681189024
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8936, 'compress@10': 0.9649, 'time@10': 5.1203}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8936, 'compress@10': 0.9649, 'time@10': 5.1203}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.908, 'compress@10': 0.9644, 'time@10': 4.6564}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it] {'epoch': 18, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.908, 'compress@10': 0.9644, 'time@10': 4.6564}:  20%|██        | 2/10 [00:06<00:28,  3.56s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.891, 'compress@10': 0.9666, 'time@10': 4.2697}:  20%|██        | 2/10 [00:08<00:28,  3.56s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.891, 'compress@10': 0.9666, 'time@10': 4.2697}:  30%|███       | 3/10 [00:08<00:19,  2.75s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8974, 'compress@10': 0.9652, 'time@10': 4.0469}:  30%|███       | 3/10 [00:12<00:19,  2.75s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8974, 'compress@10': 0.9652, 'time@10': 4.0469}:  40%|████      | 4/10 [00:12<00:18,  3.03s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8891, 'compress@10': 0.9681, 'time@10': 4.615}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it]  {'epoch': 18, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8891, 'compress@10': 0.9681, 'time@10': 4.615}:  50%|█████     | 5/10 [00:15<00:15,  3.19s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0226, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8988, 'compress@10': 0.9662, 'time@10': 4.8839}:  50%|█████     | 5/10 [00:21<00:15,  3.19s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0226, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8988, 'compress@10': 0.9662, 'time@10': 4.8839}:  60%|██████    | 6/10 [00:21<00:16,  4.24s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0229, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9027, 'compress@10': 0.9663, 'time@10': 5.136}:  60%|██████    | 6/10 [00:25<00:16,  4.24s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.0229, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9027, 'compress@10': 0.9663, 'time@10': 5.136}:  70%|███████   | 7/10 [00:25<00:11,  3.95s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0218, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9073, 'compress@10': 0.967, 'time@10': 5.082}:  70%|███████   | 7/10 [00:29<00:11,  3.95s/it]  {'epoch': 18, 'num_users': 6.125, 'loss': 0.0218, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9073, 'compress@10': 0.967, 'time@10': 5.082}:  80%|████████  | 8/10 [00:29<00:08,  4.20s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9296, 'compress@10': 0.9679, 'time@10': 5.4777}:  80%|████████  | 8/10 [00:34<00:08,  4.20s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9296, 'compress@10': 0.9679, 'time@10': 5.4777}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0282, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9279, 'compress@10': 0.9695, 'time@10': 5.5285}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0282, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9279, 'compress@10': 0.9695, 'time@10': 5.5285}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0282, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9279, 'compress@10': 0.9695, 'time@10': 5.5285}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.028156892998051207
Avg hit ratio: 0.8787667531487566
Avg ndcg: 0.9279235773344301
Avg compression ratio: 0.9695208618254403
Avg train time: 5.528546738624573
Std train time: 1.577506147579744
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8958, 'compress@10': 0.9639, 'time@10': 5.0394}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8958, 'compress@10': 0.9639, 'time@10': 5.0394}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9181, 'compress@10': 0.9637, 'time@10': 4.6443}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9181, 'compress@10': 0.9637, 'time@10': 4.6443}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8978, 'compress@10': 0.9662, 'time@10': 4.2772}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8978, 'compress@10': 0.9662, 'time@10': 4.2772}:  30%|███       | 3/10 [00:08<00:19,  2.77s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9099, 'compress@10': 0.9631, 'time@10': 4.0626}:  30%|███       | 3/10 [00:12<00:19,  2.77s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9099, 'compress@10': 0.9631, 'time@10': 4.0626}:  40%|████      | 4/10 [00:12<00:18,  3.04s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0219, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9013, 'compress@10': 0.9674, 'time@10': 4.6731}:  40%|████      | 4/10 [00:15<00:18,  3.04s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0219, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9013, 'compress@10': 0.9674, 'time@10': 4.6731}:  50%|█████     | 5/10 [00:15<00:16,  3.24s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0214, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9082, 'compress@10': 0.9657, 'time@10': 4.9326}:  50%|█████     | 5/10 [00:22<00:16,  3.24s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0214, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9082, 'compress@10': 0.9657, 'time@10': 4.9326}:  60%|██████    | 6/10 [00:22<00:17,  4.28s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0221, 'hit_ratio@10': 0.886, 'ndcg@10': 0.905, 'compress@10': 0.9658, 'time@10': 5.2021}:  60%|██████    | 6/10 [00:25<00:17,  4.28s/it]  {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0221, 'hit_ratio@10': 0.886, 'ndcg@10': 0.905, 'compress@10': 0.9658, 'time@10': 5.2021}:  70%|███████   | 7/10 [00:25<00:12,  4.01s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.022, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9024, 'compress@10': 0.9663, 'time@10': 5.1359}:  70%|███████   | 7/10 [00:30<00:12,  4.01s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.022, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9024, 'compress@10': 0.9663, 'time@10': 5.1359}:  80%|████████  | 8/10 [00:30<00:08,  4.23s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0244, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9028, 'compress@10': 0.9682, 'time@10': 5.5111}:  80%|████████  | 8/10 [00:34<00:08,  4.23s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0244, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9028, 'compress@10': 0.9682, 'time@10': 5.5111}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0243, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9089, 'compress@10': 0.9695, 'time@10': 5.5594}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0243, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9089, 'compress@10': 0.9695, 'time@10': 5.5594}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0243, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9089, 'compress@10': 0.9695, 'time@10': 5.5594}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.024255798033394782
Avg hit ratio: 0.8893381817201851
Avg ndcg: 0.9089330808884901
Avg compression ratio: 0.969470807252317
Avg train time: 5.559398221969604
Std train time: 1.574351123991606
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8984, 'compress@10': 0.9672, 'time@10': 5.0635}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8984, 'compress@10': 0.9672, 'time@10': 5.0635}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9283, 'compress@10': 0.9655, 'time@10': 4.6374}:  10%|█         | 1/10 [00:07<00:23,  2.57s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9283, 'compress@10': 0.9655, 'time@10': 4.6374}:  20%|██        | 2/10 [00:07<00:29,  3.69s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9046, 'compress@10': 0.9677, 'time@10': 4.2584}:  20%|██        | 2/10 [00:08<00:29,  3.69s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9046, 'compress@10': 0.9677, 'time@10': 4.2584}:  30%|███       | 3/10 [00:08<00:19,  2.82s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.9128, 'compress@10': 0.9632, 'time@10': 4.0068}:  30%|███       | 3/10 [00:12<00:19,  2.82s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.9128, 'compress@10': 0.9632, 'time@10': 4.0068}:  40%|████      | 4/10 [00:12<00:18,  3.01s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0219, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.9042, 'compress@10': 0.9678, 'time@10': 4.606}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0219, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.9042, 'compress@10': 0.9678, 'time@10': 4.606}:  50%|█████     | 5/10 [00:15<00:15,  3.20s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0236, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.914, 'compress@10': 0.9668, 'time@10': 4.8671}:  50%|█████     | 5/10 [00:21<00:15,  3.20s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0236, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.914, 'compress@10': 0.9668, 'time@10': 4.8671}:  60%|██████    | 6/10 [00:21<00:16,  4.22s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9175, 'compress@10': 0.9669, 'time@10': 5.1305}:  60%|██████    | 6/10 [00:25<00:16,  4.22s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9175, 'compress@10': 0.9669, 'time@10': 5.1305}:  70%|███████   | 7/10 [00:25<00:11,  3.95s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0216, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9179, 'compress@10': 0.9679, 'time@10': 5.077}:  70%|███████   | 7/10 [00:30<00:11,  3.95s/it]  {'epoch': 20, 'num_users': 6.125, 'loss': 0.0216, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9179, 'compress@10': 0.9679, 'time@10': 5.077}:  80%|████████  | 8/10 [00:30<00:08,  4.20s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0244, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9364, 'compress@10': 0.9679, 'time@10': 5.4559}:  80%|████████  | 8/10 [00:34<00:08,  4.20s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0244, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9364, 'compress@10': 0.9679, 'time@10': 5.4559}:  90%|█████████ | 9/10 [00:34<00:04,  4.23s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9402, 'compress@10': 0.9695, 'time@10': 5.5068}:  90%|█████████ | 9/10 [00:40<00:04,  4.23s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9402, 'compress@10': 0.9695, 'time@10': 5.5068}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9402, 'compress@10': 0.9695, 'time@10': 5.5068}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.0223039681101839
Avg hit ratio: 0.8946838038400008
Avg ndcg: 0.9402014605400744
Avg compression ratio: 0.9695337649769327
Avg train time: 5.506780219078064
Std train time: 1.5764097158318338
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9001, 'compress@10': 0.9666, 'time@10': 5.1391}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9001, 'compress@10': 0.9666, 'time@10': 5.1391}:  10%|█         | 1/10 [00:02<00:23,  2.61s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9293, 'compress@10': 0.9624, 'time@10': 4.7}:  10%|█         | 1/10 [00:06<00:23,  2.61s/it]   {'epoch': 21, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9293, 'compress@10': 0.9624, 'time@10': 4.7}:  20%|██        | 2/10 [00:06<00:28,  3.62s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9052, 'compress@10': 0.967, 'time@10': 4.3297}:  20%|██        | 2/10 [00:08<00:28,  3.62s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9052, 'compress@10': 0.967, 'time@10': 4.3297}:  30%|███       | 3/10 [00:08<00:19,  2.80s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.9175, 'compress@10': 0.9616, 'time@10': 4.0742}:  30%|███       | 3/10 [00:12<00:19,  2.80s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.9175, 'compress@10': 0.9616, 'time@10': 4.0742}:  40%|████      | 4/10 [00:12<00:18,  3.02s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0182, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.9099, 'compress@10': 0.9669, 'time@10': 4.6851}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0182, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.9099, 'compress@10': 0.9669, 'time@10': 4.6851}:  50%|█████     | 5/10 [00:15<00:16,  3.23s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9184, 'compress@10': 0.9676, 'time@10': 4.92}:  50%|█████     | 5/10 [00:21<00:16,  3.23s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9184, 'compress@10': 0.9676, 'time@10': 4.92}:  60%|██████    | 6/10 [00:21<00:16,  4.22s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9179, 'compress@10': 0.9676, 'time@10': 5.1634}:  60%|██████    | 6/10 [00:25<00:16,  4.22s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9179, 'compress@10': 0.9676, 'time@10': 5.1634}:  70%|███████   | 7/10 [00:25<00:11,  3.93s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9222, 'compress@10': 0.9686, 'time@10': 5.102}:  70%|███████   | 7/10 [00:29<00:11,  3.93s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9222, 'compress@10': 0.9686, 'time@10': 5.102}:  80%|████████  | 8/10 [00:29<00:08,  4.18s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9234, 'compress@10': 0.9701, 'time@10': 5.4669}:  80%|████████  | 8/10 [00:34<00:08,  4.18s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9234, 'compress@10': 0.9701, 'time@10': 5.4669}:  90%|█████████ | 9/10 [00:34<00:04,  4.20s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9237, 'compress@10': 0.9714, 'time@10': 5.5189}:  90%|█████████ | 9/10 [00:40<00:04,  4.20s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9237, 'compress@10': 0.9714, 'time@10': 5.5189}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9237, 'compress@10': 0.9714, 'time@10': 5.5189}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.019943969406453356
Avg hit ratio: 0.8832552324114294
Avg ndcg: 0.9237312495260255
Avg compression ratio: 0.9713953422700372
Avg train time: 5.5189170122146605
Std train time: 1.5375274364950786
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.918, 'compress@10': 0.9696, 'time@10': 5.0208}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.918, 'compress@10': 0.9696, 'time@10': 5.0208}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9365, 'compress@10': 0.9634, 'time@10': 4.6423}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9365, 'compress@10': 0.9634, 'time@10': 4.6423}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.91, 'compress@10': 0.9698, 'time@10': 4.3279}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]  {'epoch': 22, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.91, 'compress@10': 0.9698, 'time@10': 4.3279}:  30%|███       | 3/10 [00:08<00:19,  2.81s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.921, 'compress@10': 0.9632, 'time@10': 4.0552}:  30%|███       | 3/10 [00:12<00:19,  2.81s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.921, 'compress@10': 0.9632, 'time@10': 4.0552}:  40%|████      | 4/10 [00:12<00:17,  3.00s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.9143, 'compress@10': 0.9684, 'time@10': 4.735}:  40%|████      | 4/10 [00:15<00:17,  3.00s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.9143, 'compress@10': 0.9684, 'time@10': 4.735}:  50%|█████     | 5/10 [00:15<00:16,  3.27s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9219, 'compress@10': 0.969, 'time@10': 4.9311}:  50%|█████     | 5/10 [00:21<00:16,  3.27s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9219, 'compress@10': 0.969, 'time@10': 4.9311}:  60%|██████    | 6/10 [00:21<00:16,  4.19s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9212, 'compress@10': 0.9688, 'time@10': 5.1799}:  60%|██████    | 6/10 [00:25<00:16,  4.19s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9212, 'compress@10': 0.9688, 'time@10': 5.1799}:  70%|███████   | 7/10 [00:25<00:11,  3.92s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0186, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9217, 'compress@10': 0.9698, 'time@10': 5.1193}:  70%|███████   | 7/10 [00:29<00:11,  3.92s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0186, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9217, 'compress@10': 0.9698, 'time@10': 5.1193}:  80%|████████  | 8/10 [00:29<00:08,  4.18s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9372, 'compress@10': 0.9696, 'time@10': 5.4963}:  80%|████████  | 8/10 [00:34<00:08,  4.18s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9372, 'compress@10': 0.9696, 'time@10': 5.4963}:  90%|█████████ | 9/10 [00:34<00:04,  4.22s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9398, 'compress@10': 0.9707, 'time@10': 5.5434}:  90%|█████████ | 9/10 [00:40<00:04,  4.22s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9398, 'compress@10': 0.9707, 'time@10': 5.5434}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9398, 'compress@10': 0.9707, 'time@10': 5.5434}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.02007967920879857
Avg hit ratio: 0.8946838038400008
Avg ndcg: 0.939785082373087
Avg compression ratio: 0.9706520566965166
Avg train time: 5.543431043624878
Std train time: 1.59399595408335
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.913, 'compress@10': 0.9681, 'time@10': 5.1586}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.913, 'compress@10': 0.9681, 'time@10': 5.1586}:  10%|█         | 1/10 [00:02<00:23,  2.62s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9294, 'compress@10': 0.9646, 'time@10': 4.7112}:  10%|█         | 1/10 [00:06<00:23,  2.62s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9294, 'compress@10': 0.9646, 'time@10': 4.7112}:  20%|██        | 2/10 [00:06<00:28,  3.61s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9053, 'compress@10': 0.9705, 'time@10': 4.4425}:  20%|██        | 2/10 [00:08<00:28,  3.61s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9053, 'compress@10': 0.9705, 'time@10': 4.4425}:  30%|███       | 3/10 [00:08<00:20,  2.87s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9181, 'compress@10': 0.9632, 'time@10': 4.1308}:  30%|███       | 3/10 [00:12<00:20,  2.87s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9181, 'compress@10': 0.9632, 'time@10': 4.1308}:  40%|████      | 4/10 [00:12<00:18,  3.01s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0185, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9118, 'compress@10': 0.9688, 'time@10': 4.8024}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0185, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9118, 'compress@10': 0.9688, 'time@10': 4.8024}:  50%|█████     | 5/10 [00:15<00:16,  3.29s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9221, 'compress@10': 0.9703, 'time@10': 4.9693}:  50%|█████     | 5/10 [00:21<00:16,  3.29s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9221, 'compress@10': 0.9703, 'time@10': 4.9693}:  60%|██████    | 6/10 [00:21<00:16,  4.16s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0184, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9253, 'compress@10': 0.9706, 'time@10': 5.2108}:  60%|██████    | 6/10 [00:25<00:16,  4.16s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0184, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9253, 'compress@10': 0.9706, 'time@10': 5.2108}:  70%|███████   | 7/10 [00:25<00:11,  3.91s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9291, 'compress@10': 0.9722, 'time@10': 5.1481}:  70%|███████   | 7/10 [00:29<00:11,  3.91s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9291, 'compress@10': 0.9722, 'time@10': 5.1481}:  80%|████████  | 8/10 [00:29<00:08,  4.18s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.88, 'ndcg@10': 0.9309, 'compress@10': 0.9731, 'time@10': 5.5181}:  80%|████████  | 8/10 [00:34<00:08,  4.18s/it] {'epoch': 23, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.88, 'ndcg@10': 0.9309, 'compress@10': 0.9731, 'time@10': 5.5181}:  90%|█████████ | 9/10 [00:34<00:04,  4.21s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9353, 'compress@10': 0.974, 'time@10': 5.5652}:  90%|█████████ | 9/10 [00:40<00:04,  4.21s/it]  {'epoch': 23, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9353, 'compress@10': 0.974, 'time@10': 5.5652}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9353, 'compress@10': 0.974, 'time@10': 5.5652}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.01769149608691705
Avg hit ratio: 0.8897068453146553
Avg ndcg: 0.9353134150033601
Avg compression ratio: 0.9740439961318794
Avg train time: 5.565248131752014
Std train time: 1.5679297734105389
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.918, 'compress@10': 0.9707, 'time@10': 5.0003}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.918, 'compress@10': 0.9707, 'time@10': 5.0003}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9389, 'compress@10': 0.9678, 'time@10': 4.6159}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9389, 'compress@10': 0.9678, 'time@10': 4.6159}:  20%|██        | 2/10 [00:06<00:28,  3.56s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9117, 'compress@10': 0.9718, 'time@10': 4.388}:  20%|██        | 2/10 [00:08<00:28,  3.56s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9117, 'compress@10': 0.9718, 'time@10': 4.388}:  30%|███       | 3/10 [00:08<00:20,  2.86s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9232, 'compress@10': 0.9651, 'time@10': 4.1099}:  30%|███       | 3/10 [00:12<00:20,  2.86s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9232, 'compress@10': 0.9651, 'time@10': 4.1099}:  40%|████      | 4/10 [00:12<00:18,  3.04s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9189, 'compress@10': 0.971, 'time@10': 4.8266}:  40%|████      | 4/10 [00:16<00:18,  3.04s/it]  {'epoch': 24, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9189, 'compress@10': 0.971, 'time@10': 4.8266}:  50%|█████     | 5/10 [00:16<00:16,  3.34s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9269, 'compress@10': 0.9728, 'time@10': 5.022}:  50%|█████     | 5/10 [00:22<00:16,  3.34s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9269, 'compress@10': 0.9728, 'time@10': 5.022}:  60%|██████    | 6/10 [00:22<00:17,  4.26s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.929, 'compress@10': 0.9737, 'time@10': 5.2626}:  60%|██████    | 6/10 [00:25<00:17,  4.26s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.929, 'compress@10': 0.9737, 'time@10': 5.2626}:  70%|███████   | 7/10 [00:25<00:11,  3.98s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0178, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9293, 'compress@10': 0.9748, 'time@10': 5.1952}:  70%|███████   | 7/10 [00:30<00:11,  3.98s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0178, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9293, 'compress@10': 0.9748, 'time@10': 5.1952}:  80%|████████  | 8/10 [00:30<00:08,  4.23s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0184, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9349, 'compress@10': 0.975, 'time@10': 5.553}:  80%|████████  | 8/10 [00:34<00:08,  4.23s/it] {'epoch': 24, 'num_users': 6.3333, 'loss': 0.0184, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9349, 'compress@10': 0.975, 'time@10': 5.553}:  90%|█████████ | 9/10 [00:34<00:04,  4.24s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9355, 'compress@10': 0.9753, 'time@10': 5.5962}:  90%|█████████ | 9/10 [00:40<00:04,  4.24s/it] {'epoch': 24, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9355, 'compress@10': 0.9753, 'time@10': 5.5962}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9355, 'compress@10': 0.9753, 'time@10': 5.5962}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.019603976516448053
Avg hit ratio: 0.8958338294416393
Avg ndcg: 0.9355286600883783
Avg compression ratio: 0.9753338717334851
Avg train time: 5.59615728855133
Std train time: 1.582013279562078
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.918, 'compress@10': 0.9718, 'time@10': 5.0405}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.918, 'compress@10': 0.9718, 'time@10': 5.0405}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9393, 'compress@10': 0.9711, 'time@10': 4.5885}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9393, 'compress@10': 0.9711, 'time@10': 4.5885}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9119, 'compress@10': 0.9748, 'time@10': 4.3805}:  20%|██        | 2/10 [00:08<00:28,  3.52s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9119, 'compress@10': 0.9748, 'time@10': 4.3805}:  30%|███       | 3/10 [00:08<00:19,  2.84s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9238, 'compress@10': 0.9695, 'time@10': 4.1006}:  30%|███       | 3/10 [00:12<00:19,  2.84s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9238, 'compress@10': 0.9695, 'time@10': 4.1006}:  40%|████      | 4/10 [00:12<00:18,  3.02s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9195, 'compress@10': 0.9746, 'time@10': 4.8215}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9195, 'compress@10': 0.9746, 'time@10': 4.8215}:  50%|█████     | 5/10 [00:15<00:16,  3.33s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9264, 'compress@10': 0.9762, 'time@10': 4.9736}:  50%|█████     | 5/10 [00:21<00:16,  3.33s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9264, 'compress@10': 0.9762, 'time@10': 4.9736}:  60%|██████    | 6/10 [00:21<00:16,  4.16s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9263, 'compress@10': 0.9769, 'time@10': 5.2276}:  60%|██████    | 6/10 [00:25<00:16,  4.16s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9263, 'compress@10': 0.9769, 'time@10': 5.2276}:  70%|███████   | 7/10 [00:25<00:11,  3.92s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9315, 'compress@10': 0.9778, 'time@10': 5.1625}:  70%|███████   | 7/10 [00:29<00:11,  3.92s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9315, 'compress@10': 0.9778, 'time@10': 5.1625}:  80%|████████  | 8/10 [00:29<00:08,  4.18s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9403, 'compress@10': 0.9777, 'time@10': 5.5383}:  80%|████████  | 8/10 [00:34<00:08,  4.18s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9403, 'compress@10': 0.9777, 'time@10': 5.5383}:  90%|█████████ | 9/10 [00:34<00:04,  4.22s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9435, 'compress@10': 0.978, 'time@10': 5.5822}:  90%|█████████ | 9/10 [00:40<00:04,  4.22s/it]    {'epoch': 25, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9435, 'compress@10': 0.978, 'time@10': 5.5822}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9435, 'compress@10': 0.978, 'time@10': 5.5822}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.01728432092131788
Avg hit ratio: 0.8917068453146552
Avg ndcg: 0.9435198106506999
Avg compression ratio: 0.978007373218117
Avg train time: 5.582234406471253
Std train time: 1.6119879593335338
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.918, 'compress@10': 0.9768, 'time@10': 4.9947}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.918, 'compress@10': 0.9768, 'time@10': 4.9947}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9393, 'compress@10': 0.9766, 'time@10': 4.6305}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9393, 'compress@10': 0.9766, 'time@10': 4.6305}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9119, 'compress@10': 0.9792, 'time@10': 4.4029}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9119, 'compress@10': 0.9792, 'time@10': 4.4029}:  30%|███       | 3/10 [00:08<00:20,  2.86s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9244, 'compress@10': 0.9742, 'time@10': 4.1339}:  30%|███       | 3/10 [00:12<00:20,  2.86s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9244, 'compress@10': 0.9742, 'time@10': 4.1339}:  40%|████      | 4/10 [00:12<00:18,  3.07s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9209, 'compress@10': 0.9785, 'time@10': 4.8468}:  40%|████      | 4/10 [00:16<00:18,  3.07s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9209, 'compress@10': 0.9785, 'time@10': 4.8468}:  50%|█████     | 5/10 [00:16<00:16,  3.36s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9322, 'compress@10': 0.9791, 'time@10': 4.9958}:  50%|█████     | 5/10 [00:21<00:16,  3.36s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9322, 'compress@10': 0.9791, 'time@10': 4.9958}:  60%|██████    | 6/10 [00:21<00:16,  4.18s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9346, 'compress@10': 0.9798, 'time@10': 5.2328}:  60%|██████    | 6/10 [00:25<00:16,  4.18s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9346, 'compress@10': 0.9798, 'time@10': 5.2328}:  70%|███████   | 7/10 [00:25<00:11,  3.92s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9377, 'compress@10': 0.981, 'time@10': 5.1639}:  70%|███████   | 7/10 [00:29<00:11,  3.92s/it]  {'epoch': 26, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9377, 'compress@10': 0.981, 'time@10': 5.1639}:  80%|████████  | 8/10 [00:29<00:08,  4.17s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9391, 'compress@10': 0.9816, 'time@10': 5.545}:  80%|████████  | 8/10 [00:34<00:08,  4.17s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9391, 'compress@10': 0.9816, 'time@10': 5.545}:  90%|█████████ | 9/10 [00:34<00:04,  4.22s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9428, 'compress@10': 0.9813, 'time@10': 5.5894}:  90%|█████████ | 9/10 [00:40<00:04,  4.22s/it]  {'epoch': 26, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9428, 'compress@10': 0.9813, 'time@10': 5.5894}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9428, 'compress@10': 0.9813, 'time@10': 5.5894}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.014446016430385459
Avg hit ratio: 0.8974211310289408
Avg ndcg: 0.9427691781574499
Avg compression ratio: 0.9812615626358332
Avg train time: 5.589440655708313
Std train time: 1.59797269688884
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9151, 'compress@10': 0.9798, 'time@10': 5.0773}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9151, 'compress@10': 0.9798, 'time@10': 5.0773}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9458, 'compress@10': 0.9798, 'time@10': 4.6643}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9458, 'compress@10': 0.9798, 'time@10': 4.6643}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9163, 'compress@10': 0.9823, 'time@10': 4.4485}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9163, 'compress@10': 0.9823, 'time@10': 4.4485}:  30%|███       | 3/10 [00:08<00:20,  2.88s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9278, 'compress@10': 0.9771, 'time@10': 4.2177}:  30%|███       | 3/10 [00:12<00:20,  2.88s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9278, 'compress@10': 0.9771, 'time@10': 4.2177}:  40%|████      | 4/10 [00:12<00:18,  3.16s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9232, 'compress@10': 0.9809, 'time@10': 4.8729}:  40%|████      | 4/10 [00:16<00:18,  3.16s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9232, 'compress@10': 0.9809, 'time@10': 4.8729}:  50%|█████     | 5/10 [00:16<00:16,  3.39s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9309, 'compress@10': 0.9824, 'time@10': 5.017}:  50%|█████     | 5/10 [00:22<00:16,  3.39s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9309, 'compress@10': 0.9824, 'time@10': 5.017}:  60%|██████    | 6/10 [00:22<00:16,  4.20s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9338, 'compress@10': 0.9829, 'time@10': 5.2691}:  60%|██████    | 6/10 [00:25<00:16,  4.20s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9338, 'compress@10': 0.9829, 'time@10': 5.2691}:  70%|███████   | 7/10 [00:25<00:11,  3.95s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9362, 'compress@10': 0.9837, 'time@10': 5.1977}:  70%|███████   | 7/10 [00:30<00:11,  3.95s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9362, 'compress@10': 0.9837, 'time@10': 5.1977}:  80%|████████  | 8/10 [00:30<00:08,  4.20s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9399, 'compress@10': 0.9843, 'time@10': 5.5735}:  80%|████████  | 8/10 [00:34<00:08,  4.20s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9399, 'compress@10': 0.9843, 'time@10': 5.5735}:  90%|█████████ | 9/10 [00:34<00:04,  4.24s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9392, 'compress@10': 0.9838, 'time@10': 5.618}:  90%|█████████ | 9/10 [00:40<00:04,  4.24s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9392, 'compress@10': 0.9838, 'time@10': 5.618}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9392, 'compress@10': 0.9838, 'time@10': 5.618}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.016148447068594477
Avg hit ratio: 0.9123417659495757
Avg ndcg: 0.939226276277813
Avg compression ratio: 0.9837592459919806
Avg train time: 5.61797981262207
Std train time: 1.5418846492848204
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9137, 'compress@10': 0.9825, 'time@10': 4.9873}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9137, 'compress@10': 0.9825, 'time@10': 4.9873}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9583, 'compress@10': 0.9817, 'time@10': 4.6073}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9583, 'compress@10': 0.9817, 'time@10': 4.6073}:  20%|██        | 2/10 [00:06<00:28,  3.55s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9246, 'compress@10': 0.9842, 'time@10': 4.3971}:  20%|██        | 2/10 [00:08<00:28,  3.55s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9246, 'compress@10': 0.9842, 'time@10': 4.3971}:  30%|███       | 3/10 [00:08<00:19,  2.86s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9346, 'compress@10': 0.9792, 'time@10': 4.173}:  30%|███       | 3/10 [00:12<00:19,  2.86s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9346, 'compress@10': 0.9792, 'time@10': 4.173}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.93, 'compress@10': 0.9826, 'time@10': 4.8104}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it] {'epoch': 28, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.93, 'compress@10': 0.9826, 'time@10': 4.8104}:  50%|█████     | 5/10 [00:16<00:16,  3.34s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9367, 'compress@10': 0.9836, 'time@10': 4.972}:  50%|█████     | 5/10 [00:21<00:16,  3.34s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9367, 'compress@10': 0.9836, 'time@10': 4.972}:  60%|██████    | 6/10 [00:21<00:16,  4.18s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9366, 'compress@10': 0.984, 'time@10': 5.2211}:  60%|██████    | 6/10 [00:25<00:16,  4.18s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9366, 'compress@10': 0.984, 'time@10': 5.2211}:  70%|███████   | 7/10 [00:25<00:11,  3.93s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9397, 'compress@10': 0.9849, 'time@10': 5.1577}:  70%|███████   | 7/10 [00:30<00:11,  3.93s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9397, 'compress@10': 0.9849, 'time@10': 5.1577}:  80%|████████  | 8/10 [00:30<00:08,  4.19s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.959, 'compress@10': 0.9849, 'time@10': 5.5272}:  80%|████████  | 8/10 [00:34<00:08,  4.19s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.959, 'compress@10': 0.9849, 'time@10': 5.5272}:  90%|█████████ | 9/10 [00:34<00:04,  4.22s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9606, 'compress@10': 0.9845, 'time@10': 5.5727}:  90%|█████████ | 9/10 [00:40<00:04,  4.22s/it]  {'epoch': 28, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9606, 'compress@10': 0.9845, 'time@10': 5.5727}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9606, 'compress@10': 0.9845, 'time@10': 5.5727}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.015362627552223085
Avg hit ratio: 0.9022782738860837
Avg ndcg: 0.9605752190743981
Avg compression ratio: 0.9844592012112139
Avg train time: 5.57272207736969
Std train time: 1.5135928561596748
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9153, 'compress@10': 0.9824, 'time@10': 5.0369}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9153, 'compress@10': 0.9824, 'time@10': 5.0369}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.893, 'ndcg@10': 0.938, 'compress@10': 0.9822, 'time@10': 4.6385}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it]  {'epoch': 29, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.893, 'ndcg@10': 0.938, 'compress@10': 0.9822, 'time@10': 4.6385}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9111, 'compress@10': 0.9848, 'time@10': 4.4222}:  20%|██        | 2/10 [00:08<00:28,  3.57s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9111, 'compress@10': 0.9848, 'time@10': 4.4222}:  30%|███       | 3/10 [00:08<00:20,  2.87s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9228, 'compress@10': 0.9799, 'time@10': 4.2054}:  30%|███       | 3/10 [00:12<00:20,  2.87s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9228, 'compress@10': 0.9799, 'time@10': 4.2054}:  40%|████      | 4/10 [00:12<00:18,  3.16s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9214, 'compress@10': 0.9831, 'time@10': 4.8843}:  40%|████      | 4/10 [00:16<00:18,  3.16s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9214, 'compress@10': 0.9831, 'time@10': 4.8843}:  50%|█████     | 5/10 [00:16<00:17,  3.42s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0161, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9339, 'compress@10': 0.9836, 'time@10': 5.0001}:  50%|█████     | 5/10 [00:21<00:17,  3.42s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0161, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9339, 'compress@10': 0.9836, 'time@10': 5.0001}:  60%|██████    | 6/10 [00:21<00:16,  4.17s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.936, 'compress@10': 0.9842, 'time@10': 5.2526}:  60%|██████    | 6/10 [00:25<00:16,  4.17s/it] {'epoch': 29, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.936, 'compress@10': 0.9842, 'time@10': 5.2526}:  70%|███████   | 7/10 [00:25<00:11,  3.93s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9383, 'compress@10': 0.985, 'time@10': 5.1781}:  70%|███████   | 7/10 [00:30<00:11,  3.93s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9383, 'compress@10': 0.985, 'time@10': 5.1781}:  80%|████████  | 8/10 [00:30<00:08,  4.17s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9396, 'compress@10': 0.9849, 'time@10': 5.5547}:  80%|████████  | 8/10 [00:34<00:08,  4.17s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9396, 'compress@10': 0.9849, 'time@10': 5.5547}:  90%|█████████ | 9/10 [00:34<00:04,  4.22s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9445, 'compress@10': 0.9841, 'time@10': 5.5972}:  90%|█████████ | 9/10 [00:40<00:04,  4.22s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9445, 'compress@10': 0.9841, 'time@10': 5.5972}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9445, 'compress@10': 0.9841, 'time@10': 5.5972}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.019013097314340904
Avg hit ratio: 0.8875414317808206
Avg ndcg: 0.9444688122840981
Avg compression ratio: 0.9841390549401563
Avg train time: 5.5971643924713135
Std train time: 1.5537299411255263
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9075, 'compress@10': 0.9827, 'time@10': 5.0298}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9075, 'compress@10': 0.9827, 'time@10': 5.0298}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9536, 'compress@10': 0.9832, 'time@10': 4.6163}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9536, 'compress@10': 0.9832, 'time@10': 4.6163}:  20%|██        | 2/10 [00:06<00:28,  3.55s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9214, 'compress@10': 0.9858, 'time@10': 4.3954}:  20%|██        | 2/10 [00:08<00:28,  3.55s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9214, 'compress@10': 0.9858, 'time@10': 4.3954}:  30%|███       | 3/10 [00:08<00:19,  2.85s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9314, 'compress@10': 0.9809, 'time@10': 4.1798}:  30%|███       | 3/10 [00:12<00:19,  2.85s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9314, 'compress@10': 0.9809, 'time@10': 4.1798}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9295, 'compress@10': 0.9838, 'time@10': 4.8475}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9295, 'compress@10': 0.9838, 'time@10': 4.8475}:  50%|█████     | 5/10 [00:16<00:16,  3.37s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9362, 'compress@10': 0.9854, 'time@10': 4.9719}:  50%|█████     | 5/10 [00:21<00:16,  3.37s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9362, 'compress@10': 0.9854, 'time@10': 4.9719}:  60%|██████    | 6/10 [00:21<00:16,  4.14s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9381, 'compress@10': 0.9856, 'time@10': 5.2117}:  60%|██████    | 6/10 [00:25<00:16,  4.14s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9381, 'compress@10': 0.9856, 'time@10': 5.2117}:  70%|███████   | 7/10 [00:25<00:11,  3.89s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9349, 'compress@10': 0.9864, 'time@10': 5.1463}:  70%|███████   | 7/10 [00:29<00:11,  3.89s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9349, 'compress@10': 0.9864, 'time@10': 5.1463}:  80%|████████  | 8/10 [00:29<00:08,  4.16s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9334, 'compress@10': 0.9871, 'time@10': 5.5253}:  80%|████████  | 8/10 [00:34<00:08,  4.16s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9334, 'compress@10': 0.9871, 'time@10': 5.5253}:  90%|█████████ | 9/10 [00:34<00:04,  4.21s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9377, 'compress@10': 0.9864, 'time@10': 5.5724}:  90%|█████████ | 9/10 [00:40<00:04,  4.21s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9377, 'compress@10': 0.9864, 'time@10': 5.5724}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9377, 'compress@10': 0.9864, 'time@10': 5.5724}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.016782297635447536
Avg hit ratio: 0.8853192095585983
Avg ndcg: 0.9377317175880082
Avg compression ratio: 0.9864465104741162
Avg train time: 5.572424912452698
Std train time: 1.5416349202487976
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.9848, 'time@10': 5.1502}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.9848, 'time@10': 5.1502}:  10%|█         | 1/10 [00:02<00:23,  2.61s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9537, 'compress@10': 0.9849, 'time@10': 4.6814}:  10%|█         | 1/10 [00:06<00:23,  2.61s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9537, 'compress@10': 0.9849, 'time@10': 4.6814}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9215, 'compress@10': 0.9873, 'time@10': 4.4594}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9215, 'compress@10': 0.9873, 'time@10': 4.4594}:  30%|███       | 3/10 [00:08<00:20,  2.88s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9309, 'compress@10': 0.9835, 'time@10': 4.2609}:  30%|███       | 3/10 [00:12<00:20,  2.88s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9309, 'compress@10': 0.9835, 'time@10': 4.2609}:  40%|████      | 4/10 [00:12<00:19,  3.21s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.9284, 'compress@10': 0.986, 'time@10': 4.9185}:  40%|████      | 4/10 [00:16<00:19,  3.21s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.9284, 'compress@10': 0.986, 'time@10': 4.9185}:  50%|█████     | 5/10 [00:16<00:17,  3.43s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9356, 'compress@10': 0.9868, 'time@10': 5.0229}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9356, 'compress@10': 0.9868, 'time@10': 5.0229}:  60%|██████    | 6/10 [00:22<00:16,  4.16s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9361, 'compress@10': 0.987, 'time@10': 5.2615}:  60%|██████    | 6/10 [00:25<00:16,  4.16s/it] {'epoch': 31, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9361, 'compress@10': 0.987, 'time@10': 5.2615}:  70%|███████   | 7/10 [00:25<00:11,  3.91s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9383, 'compress@10': 0.9879, 'time@10': 5.1903}:  70%|███████   | 7/10 [00:30<00:11,  3.91s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9383, 'compress@10': 0.9879, 'time@10': 5.1903}:  80%|████████  | 8/10 [00:30<00:08,  4.17s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9562, 'compress@10': 0.988, 'time@10': 5.5626}:  80%|████████  | 8/10 [00:34<00:08,  4.17s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9562, 'compress@10': 0.988, 'time@10': 5.5626}:  90%|█████████ | 9/10 [00:34<00:04,  4.21s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9584, 'compress@10': 0.9872, 'time@10': 5.6065}:  90%|█████████ | 9/10 [00:40<00:04,  4.21s/it]  {'epoch': 31, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9584, 'compress@10': 0.9872, 'time@10': 5.6065}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9584, 'compress@10': 0.9872, 'time@10': 5.6065}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.016301751589014323
Avg hit ratio: 0.8925183903061662
Avg ndcg: 0.9584263958238635
Avg compression ratio: 0.9872100310025956
Avg train time: 5.606454825401306
Std train time: 1.516919375539892
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9218, 'compress@10': 0.9851, 'time@10': 5.0394}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9218, 'compress@10': 0.9851, 'time@10': 5.0394}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9401, 'compress@10': 0.9857, 'time@10': 4.6014}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it] {'epoch': 32, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9401, 'compress@10': 0.9857, 'time@10': 4.6014}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9124, 'compress@10': 0.988, 'time@10': 4.3677}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9124, 'compress@10': 0.988, 'time@10': 4.3677}:  30%|███       | 3/10 [00:08<00:19,  2.82s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9247, 'compress@10': 0.9852, 'time@10': 4.1717}:  30%|███       | 3/10 [00:12<00:19,  2.82s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9247, 'compress@10': 0.9852, 'time@10': 4.1717}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9236, 'compress@10': 0.9873, 'time@10': 4.8506}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9236, 'compress@10': 0.9873, 'time@10': 4.8506}:  50%|█████     | 5/10 [00:16<00:16,  3.39s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.94, 'compress@10': 0.9873, 'time@10': 4.9592}:  50%|█████     | 5/10 [00:21<00:16,  3.39s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.94, 'compress@10': 0.9873, 'time@10': 4.9592}:  60%|██████    | 6/10 [00:21<00:16,  4.12s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9408, 'compress@10': 0.9875, 'time@10': 5.2145}:  60%|██████    | 6/10 [00:25<00:16,  4.12s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9408, 'compress@10': 0.9875, 'time@10': 5.2145}:  70%|███████   | 7/10 [00:25<00:11,  3.89s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9441, 'compress@10': 0.9882, 'time@10': 5.1545}:  70%|███████   | 7/10 [00:29<00:11,  3.89s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9441, 'compress@10': 0.9882, 'time@10': 5.1545}:  80%|████████  | 8/10 [00:29<00:08,  4.17s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9391, 'compress@10': 0.9886, 'time@10': 5.5305}:  80%|████████  | 8/10 [00:34<00:08,  4.17s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9391, 'compress@10': 0.9886, 'time@10': 5.5305}:  90%|█████████ | 9/10 [00:34<00:04,  4.21s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9397, 'compress@10': 0.9874, 'time@10': 5.5748}:  90%|█████████ | 9/10 [00:40<00:04,  4.21s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9397, 'compress@10': 0.9874, 'time@10': 5.5748}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9397, 'compress@10': 0.9874, 'time@10': 5.5748}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.0165629076698337
Avg hit ratio: 0.8971164445816399
Avg ndcg: 0.93973873088331
Avg compression ratio: 0.9873812969016924
Avg train time: 5.574836730957031
Std train time: 1.5504109962347536
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.9862, 'time@10': 5.0165}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.9862, 'time@10': 5.0165}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9902, 'compress@10': 0.9865, 'time@10': 4.5871}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9902, 'compress@10': 0.9865, 'time@10': 4.5871}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9459, 'compress@10': 0.9886, 'time@10': 4.3797}:  20%|██        | 2/10 [00:08<00:28,  3.52s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9459, 'compress@10': 0.9886, 'time@10': 4.3797}:  30%|███       | 3/10 [00:08<00:19,  2.84s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9495, 'compress@10': 0.9862, 'time@10': 4.1675}:  30%|███       | 3/10 [00:12<00:19,  2.84s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9495, 'compress@10': 0.9862, 'time@10': 4.1675}:  40%|████      | 4/10 [00:12<00:18,  3.12s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9442, 'compress@10': 0.9881, 'time@10': 4.9084}:  40%|████      | 4/10 [00:16<00:18,  3.12s/it] {'epoch': 33, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9442, 'compress@10': 0.9881, 'time@10': 4.9084}:  50%|█████     | 5/10 [00:16<00:17,  3.43s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9489, 'compress@10': 0.9887, 'time@10': 5.0469}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9489, 'compress@10': 0.9887, 'time@10': 5.0469}:  60%|██████    | 6/10 [00:22<00:16,  4.23s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9492, 'compress@10': 0.9887, 'time@10': 5.2661}:  60%|██████    | 6/10 [00:25<00:16,  4.23s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9492, 'compress@10': 0.9887, 'time@10': 5.2661}:  70%|███████   | 7/10 [00:25<00:11,  3.93s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.948, 'compress@10': 0.989, 'time@10': 5.1906}:  70%|███████   | 7/10 [00:30<00:11,  3.93s/it]   {'epoch': 33, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.948, 'compress@10': 0.989, 'time@10': 5.1906}:  80%|████████  | 8/10 [00:30<00:08,  4.18s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0165, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9594, 'compress@10': 0.9894, 'time@10': 5.563}:  80%|████████  | 8/10 [00:34<00:08,  4.18s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0165, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9594, 'compress@10': 0.9894, 'time@10': 5.563}:  90%|█████████ | 9/10 [00:34<00:04,  4.22s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9609, 'compress@10': 0.9884, 'time@10': 5.6177}:  90%|█████████ | 9/10 [00:40<00:04,  4.22s/it]  {'epoch': 33, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9609, 'compress@10': 0.9884, 'time@10': 5.6177}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9609, 'compress@10': 0.9884, 'time@10': 5.6177}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.01584435883749676
Avg hit ratio: 0.8938906381300269
Avg ndcg: 0.9609057846938802
Avg compression ratio: 0.988404271415454
Avg train time: 5.617690849304199
Std train time: 1.5911364824638572
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.9852, 'time@10': 5.0563}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.9852, 'time@10': 5.0563}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.947, 'compress@10': 0.9867, 'time@10': 4.6389}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.947, 'compress@10': 0.9867, 'time@10': 4.6389}:  20%|██        | 2/10 [00:06<00:28,  3.56s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.917, 'compress@10': 0.9887, 'time@10': 4.4232}:  20%|██        | 2/10 [00:08<00:28,  3.56s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.917, 'compress@10': 0.9887, 'time@10': 4.4232}:  30%|███       | 3/10 [00:08<00:20,  2.87s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9266, 'compress@10': 0.9872, 'time@10': 4.211}:  30%|███       | 3/10 [00:12<00:20,  2.87s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9266, 'compress@10': 0.9872, 'time@10': 4.211}:  40%|████      | 4/10 [00:12<00:18,  3.16s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9258, 'compress@10': 0.9889, 'time@10': 4.9396}:  40%|████      | 4/10 [00:16<00:18,  3.16s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9258, 'compress@10': 0.9889, 'time@10': 4.9396}:  50%|█████     | 5/10 [00:16<00:17,  3.45s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.934, 'compress@10': 0.9892, 'time@10': 5.0523}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.934, 'compress@10': 0.9892, 'time@10': 5.0523}:  60%|██████    | 6/10 [00:22<00:16,  4.20s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9363, 'compress@10': 0.9891, 'time@10': 5.2745}:  60%|██████    | 6/10 [00:25<00:16,  4.20s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9363, 'compress@10': 0.9891, 'time@10': 5.2745}:  70%|███████   | 7/10 [00:25<00:11,  3.92s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9374, 'compress@10': 0.9897, 'time@10': 5.1946}:  70%|███████   | 7/10 [00:30<00:11,  3.92s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9374, 'compress@10': 0.9897, 'time@10': 5.1946}:  80%|████████  | 8/10 [00:30<00:08,  4.16s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9364, 'compress@10': 0.9901, 'time@10': 5.5669}:  80%|████████  | 8/10 [00:34<00:08,  4.16s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9364, 'compress@10': 0.9901, 'time@10': 5.5669}:  90%|█████████ | 9/10 [00:34<00:04,  4.21s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9393, 'compress@10': 0.9894, 'time@10': 5.608}:  90%|█████████ | 9/10 [00:40<00:04,  4.21s/it]     {'epoch': 34, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9393, 'compress@10': 0.9894, 'time@10': 5.608}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9393, 'compress@10': 0.9894, 'time@10': 5.608}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.012996550403444065
Avg hit ratio: 0.8957441967577792
Avg ndcg: 0.9393467951659298
Avg compression ratio: 0.9893557477103008
Avg train time: 5.607960271835327
Std train time: 1.572583418784354
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.9873, 'time@10': 5.0694}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.9873, 'time@10': 5.0694}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9586, 'compress@10': 0.988, 'time@10': 4.6349}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9586, 'compress@10': 0.988, 'time@10': 4.6349}:  20%|██        | 2/10 [00:06<00:28,  3.56s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9248, 'compress@10': 0.9897, 'time@10': 4.4515}:  20%|██        | 2/10 [00:08<00:28,  3.56s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9248, 'compress@10': 0.9897, 'time@10': 4.4515}:  30%|███       | 3/10 [00:08<00:20,  2.88s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9348, 'compress@10': 0.9888, 'time@10': 4.2321}:  30%|███       | 3/10 [00:12<00:20,  2.88s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9348, 'compress@10': 0.9888, 'time@10': 4.2321}:  40%|████      | 4/10 [00:12<00:19,  3.17s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9325, 'compress@10': 0.9901, 'time@10': 4.9101}:  40%|████      | 4/10 [00:16<00:19,  3.17s/it] {'epoch': 35, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9325, 'compress@10': 0.9901, 'time@10': 4.9101}:  50%|█████     | 5/10 [00:16<00:17,  3.42s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9387, 'compress@10': 0.9893, 'time@10': 5.0233}:  50%|█████     | 5/10 [00:21<00:17,  3.42s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9387, 'compress@10': 0.9893, 'time@10': 5.0233}:  60%|██████    | 6/10 [00:21<00:16,  4.17s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.939, 'compress@10': 0.9893, 'time@10': 5.232}:  60%|██████    | 6/10 [00:25<00:16,  4.17s/it]  {'epoch': 35, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.939, 'compress@10': 0.9893, 'time@10': 5.232}:  70%|███████   | 7/10 [00:25<00:11,  3.88s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9422, 'compress@10': 0.9899, 'time@10': 5.1705}:  70%|███████   | 7/10 [00:30<00:11,  3.88s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9422, 'compress@10': 0.9899, 'time@10': 5.1705}:  80%|████████  | 8/10 [00:30<00:08,  4.17s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.945, 'compress@10': 0.9902, 'time@10': 5.5496}:  80%|████████  | 8/10 [00:34<00:08,  4.17s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.945, 'compress@10': 0.9902, 'time@10': 5.5496}:  90%|█████████ | 9/10 [00:34<00:04,  4.22s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9478, 'compress@10': 0.9882, 'time@10': 5.5987}:  90%|█████████ | 9/10 [00:40<00:04,  4.22s/it]  {'epoch': 35, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9478, 'compress@10': 0.9882, 'time@10': 5.5987}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9478, 'compress@10': 0.9882, 'time@10': 5.5987}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.013550103052598328
Avg hit ratio: 0.9085450160102113
Avg ndcg: 0.9478386383887353
Avg compression ratio: 0.988166508862944
Avg train time: 5.598713111877442
Std train time: 1.5278158429630984
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.9868, 'time@10': 5.1447}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.9868, 'time@10': 5.1447}:  10%|█         | 1/10 [00:02<00:23,  2.61s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9436, 'compress@10': 0.9877, 'time@10': 4.6889}:  10%|█         | 1/10 [00:06<00:23,  2.61s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9436, 'compress@10': 0.9877, 'time@10': 4.6889}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9148, 'compress@10': 0.9894, 'time@10': 4.4502}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9148, 'compress@10': 0.9894, 'time@10': 4.4502}:  30%|███       | 3/10 [00:08<00:20,  2.88s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9276, 'compress@10': 0.9887, 'time@10': 4.2327}:  30%|███       | 3/10 [00:12<00:20,  2.88s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9276, 'compress@10': 0.9887, 'time@10': 4.2327}:  40%|████      | 4/10 [00:12<00:19,  3.17s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9277, 'compress@10': 0.99, 'time@10': 4.9453}:  40%|████      | 4/10 [00:16<00:19,  3.17s/it]  {'epoch': 36, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9277, 'compress@10': 0.99, 'time@10': 4.9453}:  50%|█████     | 5/10 [00:16<00:17,  3.45s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9361, 'compress@10': 0.9892, 'time@10': 5.0585}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9361, 'compress@10': 0.9892, 'time@10': 5.0585}:  60%|██████    | 6/10 [00:22<00:16,  4.20s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9387, 'compress@10': 0.9893, 'time@10': 5.2462}:  60%|██████    | 6/10 [00:25<00:16,  4.20s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9387, 'compress@10': 0.9893, 'time@10': 5.2462}:  70%|███████   | 7/10 [00:25<00:11,  3.88s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.941, 'compress@10': 0.9893, 'time@10': 5.1759}:  70%|███████   | 7/10 [00:30<00:11,  3.88s/it]  {'epoch': 36, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.941, 'compress@10': 0.9893, 'time@10': 5.1759}:  80%|████████  | 8/10 [00:30<00:08,  4.16s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9513, 'compress@10': 0.9896, 'time@10': 5.5473}:  80%|████████  | 8/10 [00:34<00:08,  4.16s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9513, 'compress@10': 0.9896, 'time@10': 5.5473}:  90%|█████████ | 9/10 [00:34<00:04,  4.20s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9546, 'compress@10': 0.9885, 'time@10': 5.588}:  90%|█████████ | 9/10 [00:40<00:04,  4.20s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9546, 'compress@10': 0.9885, 'time@10': 5.588}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9546, 'compress@10': 0.9885, 'time@10': 5.588}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.014917159360719448
Avg hit ratio: 0.878601339614922
Avg ndcg: 0.9546197864458609
Avg compression ratio: 0.9884691261785286
Avg train time: 5.588019871711731
Std train time: 1.5395434429306758
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9189, 'compress@10': 0.9864, 'time@10': 5.0011}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9189, 'compress@10': 0.9864, 'time@10': 5.0011}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9421, 'compress@10': 0.988, 'time@10': 4.5769}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]  {'epoch': 37, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9421, 'compress@10': 0.988, 'time@10': 4.5769}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9138, 'compress@10': 0.9896, 'time@10': 4.3384}:  20%|██        | 2/10 [00:08<00:28,  3.51s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9138, 'compress@10': 0.9896, 'time@10': 4.3384}:  30%|███       | 3/10 [00:08<00:19,  2.81s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9255, 'compress@10': 0.9892, 'time@10': 4.1581}:  30%|███       | 3/10 [00:12<00:19,  2.81s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9255, 'compress@10': 0.9892, 'time@10': 4.1581}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.93, 'compress@10': 0.9904, 'time@10': 4.8891}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]  {'epoch': 37, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.93, 'compress@10': 0.9904, 'time@10': 4.8891}:  50%|█████     | 5/10 [00:16<00:17,  3.43s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0081, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9375, 'compress@10': 0.9903, 'time@10': 5.0356}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0081, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9375, 'compress@10': 0.9903, 'time@10': 5.0356}:  60%|██████    | 6/10 [00:22<00:16,  4.24s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.9399, 'compress@10': 0.9903, 'time@10': 5.2404}:  60%|██████    | 6/10 [00:25<00:16,  4.24s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.9399, 'compress@10': 0.9903, 'time@10': 5.2404}:  70%|███████   | 7/10 [00:25<00:11,  3.92s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0088, 'hit_ratio@10': 0.9301, 'ndcg@10': 0.9412, 'compress@10': 0.9906, 'time@10': 5.1763}:  70%|███████   | 7/10 [00:30<00:11,  3.92s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0088, 'hit_ratio@10': 0.9301, 'ndcg@10': 0.9412, 'compress@10': 0.9906, 'time@10': 5.1763}:  80%|████████  | 8/10 [00:30<00:08,  4.19s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9405, 'compress@10': 0.991, 'time@10': 5.5519}:  80%|████████  | 8/10 [00:34<00:08,  4.19s/it] {'epoch': 37, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9405, 'compress@10': 0.991, 'time@10': 5.5519}:  90%|█████████ | 9/10 [00:34<00:04,  4.23s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9441, 'compress@10': 0.9893, 'time@10': 5.5911}:  90%|█████████ | 9/10 [00:40<00:04,  4.23s/it] {'epoch': 37, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9441, 'compress@10': 0.9893, 'time@10': 5.5911}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9441, 'compress@10': 0.9893, 'time@10': 5.5911}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.010315531819270746
Avg hit ratio: 0.9103985746379634
Avg ndcg: 0.9440609894462109
Avg compression ratio: 0.9892503602933918
Avg train time: 5.591149950027466
Std train time: 1.5719609824115341
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9877, 'time@10': 5.0684}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9877, 'time@10': 5.0684}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9493, 'compress@10': 0.9885, 'time@10': 4.6229}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9493, 'compress@10': 0.9885, 'time@10': 4.6229}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9186, 'compress@10': 0.99, 'time@10': 4.3965}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9186, 'compress@10': 0.99, 'time@10': 4.3965}:  30%|███       | 3/10 [00:08<00:19,  2.84s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9291, 'compress@10': 0.9896, 'time@10': 4.1843}:  30%|███       | 3/10 [00:12<00:19,  2.84s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9291, 'compress@10': 0.9896, 'time@10': 4.1843}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9321, 'compress@10': 0.9907, 'time@10': 4.9391}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9321, 'compress@10': 0.9907, 'time@10': 4.9391}:  50%|█████     | 5/10 [00:16<00:17,  3.45s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9393, 'compress@10': 0.9897, 'time@10': 5.0627}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9393, 'compress@10': 0.9897, 'time@10': 5.0627}:  60%|██████    | 6/10 [00:22<00:16,  4.22s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9413, 'compress@10': 0.9897, 'time@10': 5.261}:  60%|██████    | 6/10 [00:25<00:16,  4.22s/it] {'epoch': 38, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9413, 'compress@10': 0.9897, 'time@10': 5.261}:  70%|███████   | 7/10 [00:25<00:11,  3.91s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9439, 'compress@10': 0.9902, 'time@10': 5.1867}:  70%|███████   | 7/10 [00:30<00:11,  3.91s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9439, 'compress@10': 0.9902, 'time@10': 5.1867}:  80%|████████  | 8/10 [00:30<00:08,  4.16s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9465, 'compress@10': 0.9905, 'time@10': 5.5649}:  80%|████████  | 8/10 [00:34<00:08,  4.16s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9465, 'compress@10': 0.9905, 'time@10': 5.5649}:  90%|█████████ | 9/10 [00:34<00:04,  4.22s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.95, 'compress@10': 0.9896, 'time@10': 5.5998}:  90%|█████████ | 9/10 [00:40<00:04,  4.22s/it]    {'epoch': 38, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.95, 'compress@10': 0.9896, 'time@10': 5.5998}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.95, 'compress@10': 0.9896, 'time@10': 5.5998}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.012143295129127004
Avg hit ratio: 0.9158906381300269
Avg ndcg: 0.9500163561963054
Avg compression ratio: 0.9895813235704957
Avg train time: 5.599762749671936
Std train time: 1.5958342730692858
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9322, 'compress@10': 0.988, 'time@10': 5.2502}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9322, 'compress@10': 0.988, 'time@10': 5.2502}:  10%|█         | 1/10 [00:02<00:23,  2.66s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9807, 'compress@10': 0.9885, 'time@10': 4.7366}:  10%|█         | 1/10 [00:06<00:23,  2.66s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9807, 'compress@10': 0.9885, 'time@10': 4.7366}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9395, 'compress@10': 0.99, 'time@10': 4.4723}:  20%|██        | 2/10 [00:08<00:28,  3.60s/it]  {'epoch': 39, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9395, 'compress@10': 0.99, 'time@10': 4.4723}:  30%|███       | 3/10 [00:08<00:20,  2.88s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.945, 'compress@10': 0.9898, 'time@10': 4.259}:  30%|███       | 3/10 [00:12<00:20,  2.88s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.945, 'compress@10': 0.9898, 'time@10': 4.259}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9469, 'compress@10': 0.9908, 'time@10': 4.9398}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9469, 'compress@10': 0.9908, 'time@10': 4.9398}:  50%|█████     | 5/10 [00:16<00:17,  3.43s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0164, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9588, 'compress@10': 0.9892, 'time@10': 5.0329}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0164, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9588, 'compress@10': 0.9892, 'time@10': 5.0329}:  60%|██████    | 6/10 [00:22<00:16,  4.15s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0167, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9585, 'compress@10': 0.9892, 'time@10': 5.2188}:  60%|██████    | 6/10 [00:25<00:16,  4.15s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0167, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9585, 'compress@10': 0.9892, 'time@10': 5.2188}:  70%|███████   | 7/10 [00:25<00:11,  3.84s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9592, 'compress@10': 0.9894, 'time@10': 5.152}:  70%|███████   | 7/10 [00:29<00:11,  3.84s/it]   {'epoch': 39, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9592, 'compress@10': 0.9894, 'time@10': 5.152}:  80%|████████  | 8/10 [00:29<00:08,  4.12s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9702, 'compress@10': 0.9897, 'time@10': 5.524}:  80%|████████  | 8/10 [00:34<00:08,  4.12s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9702, 'compress@10': 0.9897, 'time@10': 5.524}:  90%|█████████ | 9/10 [00:34<00:04,  4.17s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9654, 'compress@10': 0.9897, 'time@10': 5.5656}:  90%|█████████ | 9/10 [00:40<00:04,  4.17s/it]  {'epoch': 39, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9654, 'compress@10': 0.9897, 'time@10': 5.5656}: 100%|██████████| 10/10 [00:40<00:00,  4.73s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9654, 'compress@10': 0.9897, 'time@10': 5.5656}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.01861327646926771
Avg hit ratio: 0.8983791173926996
Avg ndcg: 0.9653884957714082
Avg compression ratio: 0.9896591891992331
Avg train time: 5.5655779361724855
Std train time: 1.5112737495431365
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9231, 'compress@10': 0.988, 'time@10': 5.0216}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9231, 'compress@10': 0.988, 'time@10': 5.0216}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9418, 'compress@10': 0.9893, 'time@10': 4.6115}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9418, 'compress@10': 0.9893, 'time@10': 4.6115}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9136, 'compress@10': 0.9906, 'time@10': 4.3965}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9136, 'compress@10': 0.9906, 'time@10': 4.3965}:  30%|███       | 3/10 [00:08<00:19,  2.85s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9257, 'compress@10': 0.9904, 'time@10': 4.2121}:  30%|███       | 3/10 [00:12<00:19,  2.85s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9257, 'compress@10': 0.9904, 'time@10': 4.2121}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9317, 'compress@10': 0.9913, 'time@10': 4.9368}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9317, 'compress@10': 0.9913, 'time@10': 4.9368}:  50%|█████     | 5/10 [00:16<00:17,  3.46s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.9323, 'ndcg@10': 0.9391, 'compress@10': 0.9907, 'time@10': 5.0359}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.9323, 'ndcg@10': 0.9391, 'compress@10': 0.9907, 'time@10': 5.0359}:  60%|██████    | 6/10 [00:22<00:16,  4.18s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.9363, 'ndcg@10': 0.9413, 'compress@10': 0.9905, 'time@10': 5.2082}:  60%|██████    | 6/10 [00:25<00:16,  4.18s/it] {'epoch': 40, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.9363, 'ndcg@10': 0.9413, 'compress@10': 0.9905, 'time@10': 5.2082}:  70%|███████   | 7/10 [00:25<00:11,  3.85s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9407, 'ndcg@10': 0.9442, 'compress@10': 0.9905, 'time@10': 5.1642}:  70%|███████   | 7/10 [00:30<00:11,  3.85s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9407, 'ndcg@10': 0.9442, 'compress@10': 0.9905, 'time@10': 5.1642}:  80%|████████  | 8/10 [00:30<00:08,  4.18s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.9155, 'ndcg@10': 0.9396, 'compress@10': 0.991, 'time@10': 5.5415}:  80%|████████  | 8/10 [00:34<00:08,  4.18s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.9155, 'ndcg@10': 0.9396, 'compress@10': 0.991, 'time@10': 5.5415}:  90%|█████████ | 9/10 [00:34<00:04,  4.22s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.9217, 'ndcg@10': 0.9432, 'compress@10': 0.9896, 'time@10': 5.5922}:  90%|█████████ | 9/10 [00:40<00:04,  4.22s/it]  {'epoch': 40, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.9217, 'ndcg@10': 0.9432, 'compress@10': 0.9896, 'time@10': 5.5922}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.9217, 'ndcg@10': 0.9432, 'compress@10': 0.9896, 'time@10': 5.5922}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.010779108902744843
Avg hit ratio: 0.921707330398332
Avg ndcg: 0.943232447686978
Avg compression ratio: 0.9896131963485132
Avg train time: 5.5922054052352905
Std train time: 1.5380097298778763
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.9878, 'time@10': 5.0803}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.9878, 'time@10': 5.0803}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9948, 'compress@10': 0.9879, 'time@10': 4.6622}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9948, 'compress@10': 0.9879, 'time@10': 4.6622}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9489, 'compress@10': 0.9895, 'time@10': 4.408}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9489, 'compress@10': 0.9895, 'time@10': 4.408}:  30%|███       | 3/10 [00:08<00:19,  2.86s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.953, 'compress@10': 0.9896, 'time@10': 4.216}:  30%|███       | 3/10 [00:12<00:19,  2.86s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.953, 'compress@10': 0.9896, 'time@10': 4.216}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9544, 'compress@10': 0.9906, 'time@10': 4.911}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9544, 'compress@10': 0.9906, 'time@10': 4.911}:  50%|█████     | 5/10 [00:16<00:17,  3.43s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9574, 'compress@10': 0.9886, 'time@10': 5.0144}:  50%|█████     | 5/10 [00:21<00:17,  3.43s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9574, 'compress@10': 0.9886, 'time@10': 5.0144}:  60%|██████    | 6/10 [00:21<00:16,  4.16s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9577, 'compress@10': 0.9888, 'time@10': 5.1993}:  60%|██████    | 6/10 [00:25<00:16,  4.16s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9577, 'compress@10': 0.9888, 'time@10': 5.1993}:  70%|███████   | 7/10 [00:25<00:11,  3.84s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9258, 'ndcg@10': 0.9585, 'compress@10': 0.9885, 'time@10': 5.132}:  70%|███████   | 7/10 [00:29<00:11,  3.84s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9258, 'ndcg@10': 0.9585, 'compress@10': 0.9885, 'time@10': 5.132}:  80%|████████  | 8/10 [00:29<00:08,  4.12s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9593, 'compress@10': 0.989, 'time@10': 5.5082}:  80%|████████  | 8/10 [00:34<00:08,  4.12s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9593, 'compress@10': 0.989, 'time@10': 5.5082}:  90%|█████████ | 9/10 [00:34<00:04,  4.17s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9184, 'ndcg@10': 0.9612, 'compress@10': 0.9887, 'time@10': 5.558}:  90%|█████████ | 9/10 [00:40<00:04,  4.17s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9184, 'ndcg@10': 0.9612, 'compress@10': 0.9887, 'time@10': 5.558}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9184, 'ndcg@10': 0.9612, 'compress@10': 0.9887, 'time@10': 5.558}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.012402241680104793
Avg hit ratio: 0.9183791173926996
Avg ndcg: 0.9612297136692604
Avg compression ratio: 0.9886958404543961
Avg train time: 5.558004260063171
Std train time: 1.5252726426996857
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9411, 'compress@10': 0.9865, 'time@10': 5.0203}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9411, 'compress@10': 0.9865, 'time@10': 5.0203}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9572, 'compress@10': 0.9875, 'time@10': 4.6067}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it] {'epoch': 42, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9572, 'compress@10': 0.9875, 'time@10': 4.6067}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9238, 'compress@10': 0.9889, 'time@10': 4.389}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9238, 'compress@10': 0.9889, 'time@10': 4.389}:  30%|███       | 3/10 [00:08<00:19,  2.85s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.934, 'compress@10': 0.9891, 'time@10': 4.2016}:  30%|███       | 3/10 [00:12<00:19,  2.85s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.934, 'compress@10': 0.9891, 'time@10': 4.2016}:  40%|████      | 4/10 [00:12<00:19,  3.17s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9392, 'compress@10': 0.9901, 'time@10': 4.9394}:  40%|████      | 4/10 [00:16<00:19,  3.17s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9392, 'compress@10': 0.9901, 'time@10': 4.9394}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9461, 'compress@10': 0.9898, 'time@10': 5.056}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9461, 'compress@10': 0.9898, 'time@10': 5.056}:  60%|██████    | 6/10 [00:22<00:16,  4.22s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9479, 'compress@10': 0.9897, 'time@10': 5.2648}:  60%|██████    | 6/10 [00:25<00:16,  4.22s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9479, 'compress@10': 0.9897, 'time@10': 5.2648}:  70%|███████   | 7/10 [00:25<00:11,  3.92s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.944, 'compress@10': 0.9894, 'time@10': 5.1971}:  70%|███████   | 7/10 [00:30<00:11,  3.92s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.944, 'compress@10': 0.9894, 'time@10': 5.1971}:  80%|████████  | 8/10 [00:30<00:08,  4.19s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9432, 'compress@10': 0.9897, 'time@10': 5.5565}:  80%|████████  | 8/10 [00:34<00:08,  4.19s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9432, 'compress@10': 0.9897, 'time@10': 5.5565}:  90%|█████████ | 9/10 [00:34<00:04,  4.21s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9452, 'compress@10': 0.9892, 'time@10': 5.5987}:  90%|█████████ | 9/10 [00:40<00:04,  4.21s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9452, 'compress@10': 0.9892, 'time@10': 5.5987}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9452, 'compress@10': 0.9892, 'time@10': 5.5987}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.013559569768768685
Avg hit ratio: 0.9066842889236778
Avg ndcg: 0.9451868448446786
Avg compression ratio: 0.9892269900592394
Avg train time: 5.598704504966736
Std train time: 1.5455974549015175
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.987, 'time@10': 5.1039}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.987, 'time@10': 5.1039}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0071, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9483, 'compress@10': 0.9879, 'time@10': 4.6572}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0071, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9483, 'compress@10': 0.9879, 'time@10': 4.6572}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9179, 'compress@10': 0.9892, 'time@10': 4.4191}:  20%|██        | 2/10 [00:08<00:28,  3.57s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9179, 'compress@10': 0.9892, 'time@10': 4.4191}:  30%|███       | 3/10 [00:08<00:19,  2.86s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.929, 'compress@10': 0.9893, 'time@10': 4.2141}:  30%|███       | 3/10 [00:12<00:19,  2.86s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.929, 'compress@10': 0.9893, 'time@10': 4.2141}:  40%|████      | 4/10 [00:12<00:18,  3.17s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9344, 'compress@10': 0.9902, 'time@10': 4.8892}:  40%|████      | 4/10 [00:16<00:18,  3.17s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9344, 'compress@10': 0.9902, 'time@10': 4.8892}:  50%|█████     | 5/10 [00:16<00:17,  3.41s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9415, 'compress@10': 0.9897, 'time@10': 5.0076}:  50%|█████     | 5/10 [00:21<00:17,  3.41s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9415, 'compress@10': 0.9897, 'time@10': 5.0076}:  60%|██████    | 6/10 [00:21<00:16,  4.16s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0074, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9433, 'compress@10': 0.9896, 'time@10': 5.1921}:  60%|██████    | 6/10 [00:25<00:16,  4.16s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0074, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9433, 'compress@10': 0.9896, 'time@10': 5.1921}:  70%|███████   | 7/10 [00:25<00:11,  3.85s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.956, 'compress@10': 0.9897, 'time@10': 5.1331}:  70%|███████   | 7/10 [00:29<00:11,  3.85s/it]  {'epoch': 43, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.956, 'compress@10': 0.9897, 'time@10': 5.1331}:  80%|████████  | 8/10 [00:29<00:08,  4.14s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0076, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9577, 'compress@10': 0.9901, 'time@10': 5.5181}:  80%|████████  | 8/10 [00:34<00:08,  4.14s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0076, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9577, 'compress@10': 0.9901, 'time@10': 5.5181}:  90%|█████████ | 9/10 [00:34<00:04,  4.20s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9583, 'compress@10': 0.9889, 'time@10': 5.561}:  90%|█████████ | 9/10 [00:40<00:04,  4.20s/it]    {'epoch': 43, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9583, 'compress@10': 0.9889, 'time@10': 5.561}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9583, 'compress@10': 0.9889, 'time@10': 5.561}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.008622576239745109
Avg hit ratio: 0.9099100953752906
Avg ndcg: 0.9582883097875452
Avg compression ratio: 0.9889182888839196
Avg train time: 5.560980296134948
Std train time: 1.5245203681326205
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0067, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9301, 'compress@10': 0.9871, 'time@10': 5.089}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0067, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9301, 'compress@10': 0.9871, 'time@10': 5.089}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9489, 'compress@10': 0.9873, 'time@10': 4.6659}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it] {'epoch': 44, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9489, 'compress@10': 0.9873, 'time@10': 4.6659}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9183, 'compress@10': 0.9886, 'time@10': 4.4716}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9183, 'compress@10': 0.9886, 'time@10': 4.4716}:  30%|███       | 3/10 [00:08<00:20,  2.91s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9301, 'compress@10': 0.9889, 'time@10': 4.2675}:  30%|███       | 3/10 [00:12<00:20,  2.91s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9301, 'compress@10': 0.9889, 'time@10': 4.2675}:  40%|████      | 4/10 [00:12<00:19,  3.22s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0083, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9359, 'compress@10': 0.9898, 'time@10': 5.0299}:  40%|████      | 4/10 [00:16<00:19,  3.22s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0083, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9359, 'compress@10': 0.9898, 'time@10': 5.0299}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0079, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9427, 'compress@10': 0.9898, 'time@10': 5.1688}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0079, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9427, 'compress@10': 0.9898, 'time@10': 5.1688}:  60%|██████    | 6/10 [00:22<00:17,  4.34s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9495, 'compress@10': 0.9894, 'time@10': 5.3217}:  60%|██████    | 6/10 [00:25<00:17,  4.34s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9495, 'compress@10': 0.9894, 'time@10': 5.3217}:  70%|███████   | 7/10 [00:25<00:11,  3.95s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9475, 'compress@10': 0.9881, 'time@10': 5.2407}:  70%|███████   | 7/10 [00:30<00:11,  3.95s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9475, 'compress@10': 0.9881, 'time@10': 5.2407}:  80%|████████  | 8/10 [00:30<00:08,  4.19s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9508, 'compress@10': 0.9884, 'time@10': 5.6069}:  80%|████████  | 8/10 [00:34<00:08,  4.19s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9508, 'compress@10': 0.9884, 'time@10': 5.6069}:  90%|█████████ | 9/10 [00:34<00:04,  4.23s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9534, 'compress@10': 0.9881, 'time@10': 5.6412}:  90%|█████████ | 9/10 [00:40<00:04,  4.23s/it]    {'epoch': 44, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9534, 'compress@10': 0.9881, 'time@10': 5.6412}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9534, 'compress@10': 0.9881, 'time@10': 5.6412}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.011081915666527902
Avg hit ratio: 0.893033495272884
Avg ndcg: 0.9533911876279009
Avg compression ratio: 0.9880811684179609
Avg train time: 5.641203260421753
Std train time: 1.5619868302448905
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9847, 'time@10': 5.0065}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9847, 'time@10': 5.0065}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9483, 'compress@10': 0.9862, 'time@10': 4.6059}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9483, 'compress@10': 0.9862, 'time@10': 4.6059}:  20%|██        | 2/10 [00:06<00:28,  3.55s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9179, 'compress@10': 0.9874, 'time@10': 4.3947}:  20%|██        | 2/10 [00:08<00:28,  3.55s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9179, 'compress@10': 0.9874, 'time@10': 4.3947}:  30%|███       | 3/10 [00:08<00:19,  2.85s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.929, 'compress@10': 0.9878, 'time@10': 4.2348}:  30%|███       | 3/10 [00:12<00:19,  2.85s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.929, 'compress@10': 0.9878, 'time@10': 4.2348}:  40%|████      | 4/10 [00:12<00:19,  3.22s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9354, 'compress@10': 0.9887, 'time@10': 4.9807}:  40%|████      | 4/10 [00:16<00:19,  3.22s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9354, 'compress@10': 0.9887, 'time@10': 4.9807}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9421, 'compress@10': 0.9889, 'time@10': 5.0674}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9421, 'compress@10': 0.9889, 'time@10': 5.0674}:  60%|██████    | 6/10 [00:22<00:16,  4.22s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.945, 'compress@10': 0.9884, 'time@10': 5.273}:  60%|██████    | 6/10 [00:25<00:16,  4.22s/it]  {'epoch': 45, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.945, 'compress@10': 0.9884, 'time@10': 5.273}:  70%|███████   | 7/10 [00:25<00:11,  3.92s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9636, 'compress@10': 0.9885, 'time@10': 5.1997}:  70%|███████   | 7/10 [00:30<00:11,  3.92s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9636, 'compress@10': 0.9885, 'time@10': 5.1997}:  80%|████████  | 8/10 [00:30<00:08,  4.17s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9748, 'compress@10': 0.9885, 'time@10': 5.5928}:  80%|████████  | 8/10 [00:34<00:08,  4.17s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9748, 'compress@10': 0.9885, 'time@10': 5.5928}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9696, 'compress@10': 0.987, 'time@10': 5.634}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]     {'epoch': 45, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9696, 'compress@10': 0.987, 'time@10': 5.634}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9696, 'compress@10': 0.987, 'time@10': 5.634}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.01564896391872979
Avg hit ratio: 0.9051993938903955
Avg ndcg: 0.9696117022821064
Avg compression ratio: 0.9870233971066089
Avg train time: 5.63396520614624
Std train time: 1.6000376250259776
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0049, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 0.9851, 'time@10': 4.9864}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0049, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 0.9851, 'time@10': 4.9864}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9575, 'compress@10': 0.9859, 'time@10': 4.5733}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it] {'epoch': 46, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9575, 'compress@10': 0.9859, 'time@10': 4.5733}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9241, 'compress@10': 0.9869, 'time@10': 4.3862}:  20%|██        | 2/10 [00:08<00:28,  3.52s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9241, 'compress@10': 0.9869, 'time@10': 4.3862}:  30%|███       | 3/10 [00:08<00:19,  2.85s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9336, 'compress@10': 0.9875, 'time@10': 4.2152}:  30%|███       | 3/10 [00:12<00:19,  2.85s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9336, 'compress@10': 0.9875, 'time@10': 4.2152}:  40%|████      | 4/10 [00:12<00:19,  3.20s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.939, 'compress@10': 0.9884, 'time@10': 4.9578}:  40%|████      | 4/10 [00:16<00:19,  3.20s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.939, 'compress@10': 0.9884, 'time@10': 4.9578}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9441, 'compress@10': 0.989, 'time@10': 5.0608}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9441, 'compress@10': 0.989, 'time@10': 5.0608}:  60%|██████    | 6/10 [00:22<00:16,  4.21s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.946, 'compress@10': 0.9885, 'time@10': 5.216}:  60%|██████    | 6/10 [00:25<00:16,  4.21s/it] {'epoch': 46, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.946, 'compress@10': 0.9885, 'time@10': 5.216}:  70%|███████   | 7/10 [00:25<00:11,  3.85s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.923, 'ndcg@10': 0.9484, 'compress@10': 0.9883, 'time@10': 5.1495}:  70%|███████   | 7/10 [00:29<00:11,  3.85s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.923, 'ndcg@10': 0.9484, 'compress@10': 0.9883, 'time@10': 5.1495}:  80%|████████  | 8/10 [00:29<00:08,  4.13s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9507, 'compress@10': 0.9888, 'time@10': 5.5266}:  80%|████████  | 8/10 [00:34<00:08,  4.13s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9507, 'compress@10': 0.9888, 'time@10': 5.5266}:  90%|█████████ | 9/10 [00:34<00:04,  4.19s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9534, 'compress@10': 0.9883, 'time@10': 5.5784}:  90%|█████████ | 9/10 [00:40<00:04,  4.19s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9534, 'compress@10': 0.9883, 'time@10': 5.5784}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9534, 'compress@10': 0.9883, 'time@10': 5.5784}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.013097472077011462
Avg hit ratio: 0.901871180884763
Avg ndcg: 0.9533770060326127
Avg compression ratio: 0.9883152946795656
Avg train time: 5.578360652923584
Std train time: 1.5488268313460398
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9858, 'time@10': 5.1006}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9858, 'time@10': 5.1006}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9483, 'compress@10': 0.9861, 'time@10': 4.6772}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9483, 'compress@10': 0.9861, 'time@10': 4.6772}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9179, 'compress@10': 0.9873, 'time@10': 4.4499}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9179, 'compress@10': 0.9873, 'time@10': 4.4499}:  30%|███       | 3/10 [00:08<00:20,  2.88s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.901, 'ndcg@10': 0.929, 'compress@10': 0.9875, 'time@10': 4.2578}:  30%|███       | 3/10 [00:12<00:20,  2.88s/it]  {'epoch': 47, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.901, 'ndcg@10': 0.929, 'compress@10': 0.9875, 'time@10': 4.2578}:  40%|████      | 4/10 [00:12<00:19,  3.21s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9358, 'compress@10': 0.9884, 'time@10': 5.0755}:  40%|████      | 4/10 [00:16<00:19,  3.21s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9358, 'compress@10': 0.9884, 'time@10': 5.0755}:  50%|█████     | 5/10 [00:16<00:17,  3.57s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0082, 'hit_ratio@10': 0.927, 'ndcg@10': 0.9425, 'compress@10': 0.989, 'time@10': 5.1628}:  50%|█████     | 5/10 [00:22<00:17,  3.57s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0082, 'hit_ratio@10': 0.927, 'ndcg@10': 0.9425, 'compress@10': 0.989, 'time@10': 5.1628}:  60%|██████    | 6/10 [00:22<00:17,  4.28s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.9317, 'ndcg@10': 0.945, 'compress@10': 0.9887, 'time@10': 5.305}:  60%|██████    | 6/10 [00:25<00:17,  4.28s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.9317, 'ndcg@10': 0.945, 'compress@10': 0.9887, 'time@10': 5.305}:  70%|███████   | 7/10 [00:25<00:11,  3.90s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9367, 'ndcg@10': 0.9547, 'compress@10': 0.9884, 'time@10': 5.2264}:  70%|███████   | 7/10 [00:30<00:11,  3.90s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9367, 'ndcg@10': 0.9547, 'compress@10': 0.9884, 'time@10': 5.2264}:  80%|████████  | 8/10 [00:30<00:08,  4.16s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0091, 'hit_ratio@10': 0.9278, 'ndcg@10': 0.9558, 'compress@10': 0.9885, 'time@10': 5.5952}:  80%|████████  | 8/10 [00:34<00:08,  4.16s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0091, 'hit_ratio@10': 0.9278, 'ndcg@10': 0.9558, 'compress@10': 0.9885, 'time@10': 5.5952}:  90%|█████████ | 9/10 [00:34<00:04,  4.21s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9328, 'ndcg@10': 0.9578, 'compress@10': 0.9879, 'time@10': 5.6321}:  90%|█████████ | 9/10 [00:40<00:04,  4.21s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9328, 'ndcg@10': 0.9578, 'compress@10': 0.9879, 'time@10': 5.6321}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9328, 'ndcg@10': 0.9578, 'compress@10': 0.9879, 'time@10': 5.6321}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.009159091557164666
Avg hit ratio: 0.9327672382324333
Avg ndcg: 0.957808905700251
Avg compression ratio: 0.9879435835386932
Avg train time: 5.632125020027161
Std train time: 1.6068814466251513
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0067, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9856, 'time@10': 5.0523}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0067, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.9856, 'time@10': 5.0523}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0039, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9576, 'compress@10': 0.9853, 'time@10': 4.5931}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it] {'epoch': 48, 'num_users': 7.0, 'loss': 0.0039, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9576, 'compress@10': 0.9853, 'time@10': 4.5931}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0026, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9241, 'compress@10': 0.9867, 'time@10': 4.3895}:  20%|██        | 2/10 [00:08<00:28,  3.52s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0026, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9241, 'compress@10': 0.9867, 'time@10': 4.3895}:  30%|███       | 3/10 [00:08<00:19,  2.84s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9336, 'compress@10': 0.9871, 'time@10': 4.1948}:  30%|███       | 3/10 [00:12<00:19,  2.84s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9336, 'compress@10': 0.9871, 'time@10': 4.1948}:  40%|████      | 4/10 [00:12<00:18,  3.16s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0065, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9393, 'compress@10': 0.988, 'time@10': 4.9489}:  40%|████      | 4/10 [00:16<00:18,  3.16s/it] {'epoch': 48, 'num_users': 5.8, 'loss': 0.0065, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9393, 'compress@10': 0.988, 'time@10': 4.9489}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0078, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9458, 'compress@10': 0.9886, 'time@10': 5.0514}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0078, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9458, 'compress@10': 0.9886, 'time@10': 5.0514}:  60%|██████    | 6/10 [00:22<00:16,  4.20s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9475, 'compress@10': 0.9883, 'time@10': 5.2058}:  60%|██████    | 6/10 [00:25<00:16,  4.20s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9475, 'compress@10': 0.9883, 'time@10': 5.2058}:  70%|███████   | 7/10 [00:25<00:11,  3.84s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0074, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9498, 'compress@10': 0.9873, 'time@10': 5.1479}:  70%|███████   | 7/10 [00:29<00:11,  3.84s/it]  {'epoch': 48, 'num_users': 6.125, 'loss': 0.0074, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9498, 'compress@10': 0.9873, 'time@10': 5.1479}:  80%|████████  | 8/10 [00:29<00:08,  4.14s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0084, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9512, 'compress@10': 0.9878, 'time@10': 5.5297}:  80%|████████  | 8/10 [00:34<00:08,  4.14s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0084, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9512, 'compress@10': 0.9878, 'time@10': 5.5297}:  90%|█████████ | 9/10 [00:34<00:04,  4.21s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9489, 'compress@10': 0.9866, 'time@10': 5.5749}:  90%|█████████ | 9/10 [00:40<00:04,  4.21s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9489, 'compress@10': 0.9866, 'time@10': 5.5749}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9489, 'compress@10': 0.9866, 'time@10': 5.5749}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.009934825262047586
Avg hit ratio: 0.9016049238443127
Avg ndcg: 0.9488746832360674
Avg compression ratio: 0.9865934241969285
Avg train time: 5.574873423576355
Std train time: 1.5710976605590785
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9833, 'time@10': 5.0724}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9833, 'time@10': 5.0724}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9489, 'compress@10': 0.9851, 'time@10': 4.6519}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it] {'epoch': 49, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9489, 'compress@10': 0.9851, 'time@10': 4.6519}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9183, 'compress@10': 0.9861, 'time@10': 4.4434}:  20%|██        | 2/10 [00:08<00:28,  3.57s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9183, 'compress@10': 0.9861, 'time@10': 4.4434}:  30%|███       | 3/10 [00:08<00:20,  2.88s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9293, 'compress@10': 0.9863, 'time@10': 4.2544}:  30%|███       | 3/10 [00:12<00:20,  2.88s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9293, 'compress@10': 0.9863, 'time@10': 4.2544}:  40%|████      | 4/10 [00:12<00:19,  3.21s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9361, 'compress@10': 0.9872, 'time@10': 5.0173}:  40%|████      | 4/10 [00:16<00:19,  3.21s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9361, 'compress@10': 0.9872, 'time@10': 5.0173}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9428, 'compress@10': 0.988, 'time@10': 5.0741}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9428, 'compress@10': 0.988, 'time@10': 5.0741}:  60%|██████    | 6/10 [00:22<00:16,  4.16s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9507, 'compress@10': 0.9873, 'time@10': 5.2277}:  60%|██████    | 6/10 [00:25<00:16,  4.16s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9507, 'compress@10': 0.9873, 'time@10': 5.2277}:  70%|███████   | 7/10 [00:25<00:11,  3.82s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9523, 'compress@10': 0.9867, 'time@10': 5.1621}:  70%|███████   | 7/10 [00:29<00:11,  3.82s/it]  {'epoch': 49, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9523, 'compress@10': 0.9867, 'time@10': 5.1621}:  80%|████████  | 8/10 [00:29<00:08,  4.11s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9545, 'compress@10': 0.9869, 'time@10': 5.53}:  80%|████████  | 8/10 [00:34<00:08,  4.11s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9545, 'compress@10': 0.9869, 'time@10': 5.53}:  90%|█████████ | 9/10 [00:34<00:04,  4.16s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9567, 'compress@10': 0.9861, 'time@10': 5.5668}:  90%|█████████ | 9/10 [00:40<00:04,  4.16s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9567, 'compress@10': 0.9861, 'time@10': 5.5668}: 100%|██████████| 10/10 [00:40<00:00,  4.71s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9567, 'compress@10': 0.9861, 'time@10': 5.5668}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.01000686054724192
Avg hit ratio: 0.9016049238443127
Avg ndcg: 0.9567324226455851
Avg compression ratio: 0.9861170773814296
Avg train time: 5.566831398010254
Std train time: 1.5453646963602947
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
