  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2273, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.5026, 'compress@10': 0.5263, 'time@10': 9.5787}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2273, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.5026, 'compress@10': 0.5263, 'time@10': 9.5787}:  10%|█         | 1/10 [00:04<00:43,  4.83s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1621, 'hit_ratio@10': 0.5654, 'ndcg@10': 0.5544, 'compress@10': 0.5212, 'time@10': 8.3446}:  10%|█         | 1/10 [00:11<00:43,  4.83s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1621, 'hit_ratio@10': 0.5654, 'ndcg@10': 0.5544, 'compress@10': 0.5212, 'time@10': 8.3446}:  20%|██        | 2/10 [00:11<00:49,  6.19s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9432, 'hit_ratio@10': 0.4245, 'ndcg@10': 0.3696, 'compress@10': 0.538, 'time@10': 6.482}:  20%|██        | 2/10 [00:13<00:49,  6.19s/it]  {'epoch': 0, 'num_users': 5.0, 'loss': 0.9432, 'hit_ratio@10': 0.4245, 'ndcg@10': 0.3696, 'compress@10': 0.538, 'time@10': 6.482}:  30%|███       | 3/10 [00:13<00:28,  4.01s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7431, 'hit_ratio@10': 0.497, 'ndcg@10': 0.4139, 'compress@10': 0.5329, 'time@10': 6.4367}:  30%|███       | 3/10 [00:19<00:28,  4.01s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7431, 'hit_ratio@10': 0.497, 'ndcg@10': 0.4139, 'compress@10': 0.5329, 'time@10': 6.4367}:  40%|████      | 4/10 [00:19<00:29,  4.93s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.6139, 'hit_ratio@10': 0.5616, 'ndcg@10': 0.4781, 'compress@10': 0.5283, 'time@10': 9.7581}:  40%|████      | 4/10 [00:31<00:29,  4.93s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.6139, 'hit_ratio@10': 0.5616, 'ndcg@10': 0.4781, 'compress@10': 0.5283, 'time@10': 9.7581}:  50%|█████     | 5/10 [00:31<00:36,  7.35s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5268, 'hit_ratio@10': 0.5902, 'ndcg@10': 0.5248, 'compress@10': 0.5255, 'time@10': 9.8821}:  50%|█████     | 5/10 [00:41<00:36,  7.35s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5268, 'hit_ratio@10': 0.5902, 'ndcg@10': 0.5248, 'compress@10': 0.5255, 'time@10': 9.8821}:  60%|██████    | 6/10 [00:41<00:33,  8.44s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4725, 'hit_ratio@10': 0.5916, 'ndcg@10': 0.5248, 'compress@10': 0.5247, 'time@10': 10.1274}:  60%|██████    | 6/10 [00:47<00:33,  8.44s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4725, 'hit_ratio@10': 0.5916, 'ndcg@10': 0.5248, 'compress@10': 0.5247, 'time@10': 10.1274}:  70%|███████   | 7/10 [00:47<00:22,  7.59s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.4215, 'hit_ratio@10': 0.6319, 'ndcg@10': 0.5535, 'compress@10': 0.5234, 'time@10': 9.8618}:  70%|███████   | 7/10 [00:55<00:22,  7.59s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.4215, 'hit_ratio@10': 0.6319, 'ndcg@10': 0.5535, 'compress@10': 0.5234, 'time@10': 9.8618}:  80%|████████  | 8/10 [00:55<00:15,  7.73s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3822, 'hit_ratio@10': 0.6474, 'ndcg@10': 0.5917, 'compress@10': 0.5224, 'time@10': 10.5596}:  80%|████████  | 8/10 [01:03<00:15,  7.73s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3822, 'hit_ratio@10': 0.6474, 'ndcg@10': 0.5917, 'compress@10': 0.5224, 'time@10': 10.5596}:  90%|█████████ | 9/10 [01:03<00:07,  7.85s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3498, 'hit_ratio@10': 0.6759, 'ndcg@10': 0.6126, 'compress@10': 0.5213, 'time@10': 10.5008}:  90%|█████████ | 9/10 [01:13<00:07,  7.85s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3498, 'hit_ratio@10': 0.6759, 'ndcg@10': 0.6126, 'compress@10': 0.5213, 'time@10': 10.5008}: 100%|██████████| 10/10 [01:13<00:00,  8.52s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3498, 'hit_ratio@10': 0.6759, 'ndcg@10': 0.6126, 'compress@10': 0.5213, 'time@10': 10.5008}: 100%|██████████| 10/10 [01:13<00:00,  7.39s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.34979944219968984
Avg hit ratio: 0.6758738708942443
Avg ndcg: 0.6125561800934953
Avg compression ratio: 0.5212749006657823
Avg train time: 10.500825023651123
Std train time: 5.355577259285252
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0597, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8254, 'compress@10': 0.5263, 'time@10': 9.7384}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0597, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8254, 'compress@10': 0.5263, 'time@10': 9.7384}:  10%|█         | 1/10 [00:04<00:44,  4.90s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0569, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8413, 'compress@10': 0.5212, 'time@10': 8.4556}:  10%|█         | 1/10 [00:12<00:44,  4.90s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0569, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8413, 'compress@10': 0.5212, 'time@10': 8.4556}:  20%|██        | 2/10 [00:12<00:50,  6.26s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0498, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.7968, 'compress@10': 0.538, 'time@10': 6.6552}:  20%|██        | 2/10 [00:13<00:50,  6.26s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.0498, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.7968, 'compress@10': 0.538, 'time@10': 6.6552}:  30%|███       | 3/10 [00:13<00:28,  4.11s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0502, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8086, 'compress@10': 0.5329, 'time@10': 6.5901}:  30%|███       | 3/10 [00:20<00:28,  4.11s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0502, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8086, 'compress@10': 0.5329, 'time@10': 6.5901}:  40%|████      | 4/10 [00:20<00:30,  5.03s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0578, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8041, 'compress@10': 0.5283, 'time@10': 9.5127}:  40%|████      | 4/10 [00:30<00:30,  5.03s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0578, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8041, 'compress@10': 0.5283, 'time@10': 9.5127}:  50%|█████     | 5/10 [00:30<00:35,  7.05s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0612, 'hit_ratio@10': 0.7803, 'ndcg@10': 0.8051, 'compress@10': 0.5255, 'time@10': 9.7069}:  50%|█████     | 5/10 [00:41<00:35,  7.05s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0612, 'hit_ratio@10': 0.7803, 'ndcg@10': 0.8051, 'compress@10': 0.5255, 'time@10': 9.7069}:  60%|██████    | 6/10 [00:41<00:33,  8.30s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.059, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.814, 'compress@10': 0.5247, 'time@10': 9.9314}:  60%|██████    | 6/10 [00:47<00:33,  8.30s/it]  {'epoch': 1, 'num_users': 6.2857, 'loss': 0.059, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.814, 'compress@10': 0.5247, 'time@10': 9.9314}:  70%|███████   | 7/10 [00:47<00:22,  7.45s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0564, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8219, 'compress@10': 0.5234, 'time@10': 9.6859}:  70%|███████   | 7/10 [00:55<00:22,  7.45s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0564, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8219, 'compress@10': 0.5234, 'time@10': 9.6859}:  80%|████████  | 8/10 [00:55<00:15,  7.63s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0542, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.832, 'compress@10': 0.5224, 'time@10': 10.2355}:  80%|████████  | 8/10 [01:02<00:15,  7.63s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0542, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.832, 'compress@10': 0.5224, 'time@10': 10.2355}:  90%|█████████ | 9/10 [01:02<00:07,  7.54s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0534, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8334, 'compress@10': 0.5213, 'time@10': 10.2613}:  90%|█████████ | 9/10 [01:13<00:07,  7.54s/it]  {'epoch': 1, 'num_users': 6.3, 'loss': 0.0534, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8334, 'compress@10': 0.5213, 'time@10': 10.2613}: 100%|██████████| 10/10 [01:13<00:00,  8.46s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0534, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8334, 'compress@10': 0.5213, 'time@10': 10.2613}: 100%|██████████| 10/10 [01:13<00:00,  7.30s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.053432649470664395
Avg hit ratio: 0.8201937296809962
Avg ndcg: 0.833378606786322
Avg compression ratio: 0.5212749006657823
Avg train time: 10.26127736568451
Std train time: 4.712178521378559
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.5263, 'time@10': 8.3456}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.5263, 'time@10': 8.3456}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8494, 'compress@10': 0.5212, 'time@10': 7.7868}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8494, 'compress@10': 0.5212, 'time@10': 7.7868}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8498, 'compress@10': 0.538, 'time@10': 6.34}:  20%|██        | 2/10 [00:13<00:48,  6.02s/it]  {'epoch': 2, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8498, 'compress@10': 0.538, 'time@10': 6.34}:  30%|███       | 3/10 [00:13<00:28,  4.07s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8491, 'compress@10': 0.5329, 'time@10': 6.3719}:  30%|███       | 3/10 [00:19<00:28,  4.07s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8491, 'compress@10': 0.5329, 'time@10': 6.3719}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0485, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8371, 'compress@10': 0.5283, 'time@10': 8.8483}:  40%|████      | 4/10 [00:29<00:30,  5.03s/it]  {'epoch': 2, 'num_users': 5.8, 'loss': 0.0485, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8371, 'compress@10': 0.5283, 'time@10': 8.8483}:  50%|█████     | 5/10 [00:29<00:33,  6.61s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.053, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8334, 'compress@10': 0.5255, 'time@10': 9.1018}:  50%|█████     | 5/10 [00:39<00:33,  6.61s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.053, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8334, 'compress@10': 0.5255, 'time@10': 9.1018}:  60%|██████    | 6/10 [00:39<00:31,  7.90s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0514, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8366, 'compress@10': 0.5247, 'time@10': 9.4068}:  60%|██████    | 6/10 [00:45<00:31,  7.90s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0514, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8366, 'compress@10': 0.5247, 'time@10': 9.4068}:  70%|███████   | 7/10 [00:45<00:21,  7.17s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0502, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8423, 'compress@10': 0.5234, 'time@10': 9.2435}:  70%|███████   | 7/10 [00:53<00:21,  7.17s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0502, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8423, 'compress@10': 0.5234, 'time@10': 9.2435}:  80%|████████  | 8/10 [00:53<00:14,  7.48s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0483, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8502, 'compress@10': 0.5224, 'time@10': 9.8213}:  80%|████████  | 8/10 [01:00<00:14,  7.48s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0483, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8502, 'compress@10': 0.5224, 'time@10': 9.8213}:  90%|█████████ | 9/10 [01:00<00:07,  7.41s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8502, 'compress@10': 0.5213, 'time@10': 9.8649}:  90%|█████████ | 9/10 [01:10<00:07,  7.41s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8502, 'compress@10': 0.5213, 'time@10': 9.8649}: 100%|██████████| 10/10 [01:10<00:00,  8.30s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8502, 'compress@10': 0.5213, 'time@10': 9.8649}: 100%|██████████| 10/10 [01:10<00:00,  7.09s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04813471030900511
Avg hit ratio: 0.8176156177344632
Avg ndcg: 0.8502241937423379
Avg compression ratio: 0.5212749006657823
Avg train time: 9.86490592956543
Std train time: 4.0912431867083185
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.5263, 'time@10': 8.5218}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.5263, 'time@10': 8.5218}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8482, 'compress@10': 0.5212, 'time@10': 7.8346}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8482, 'compress@10': 0.5212, 'time@10': 7.8346}:  20%|██        | 2/10 [00:11<00:48,  6.00s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8512, 'compress@10': 0.538, 'time@10': 6.4729}:  20%|██        | 2/10 [00:13<00:48,  6.00s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8512, 'compress@10': 0.538, 'time@10': 6.4729}:  30%|███       | 3/10 [00:13<00:28,  4.13s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.7642, 'ndcg@10': 0.846, 'compress@10': 0.5329, 'time@10': 6.4184}:  30%|███       | 3/10 [00:19<00:28,  4.13s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.7642, 'ndcg@10': 0.846, 'compress@10': 0.5329, 'time@10': 6.4184}:  40%|████      | 4/10 [00:19<00:29,  4.99s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7754, 'ndcg@10': 0.8355, 'compress@10': 0.5283, 'time@10': 8.3703}:  40%|████      | 4/10 [00:27<00:29,  4.99s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7754, 'ndcg@10': 0.8355, 'compress@10': 0.5283, 'time@10': 8.3703}:  50%|█████     | 5/10 [00:27<00:30,  6.12s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0517, 'hit_ratio@10': 0.7721, 'ndcg@10': 0.8339, 'compress@10': 0.5255, 'time@10': 8.7623}:  50%|█████     | 5/10 [00:38<00:30,  6.12s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0517, 'hit_ratio@10': 0.7721, 'ndcg@10': 0.8339, 'compress@10': 0.5255, 'time@10': 8.7623}:  60%|██████    | 6/10 [00:38<00:30,  7.70s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.7989, 'ndcg@10': 0.8351, 'compress@10': 0.5247, 'time@10': 9.1416}:  60%|██████    | 6/10 [00:44<00:30,  7.70s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.7989, 'ndcg@10': 0.8351, 'compress@10': 0.5247, 'time@10': 9.1416}:  70%|███████   | 7/10 [00:44<00:21,  7.06s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0514, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8433, 'compress@10': 0.5234, 'time@10': 9.0107}:  70%|███████   | 7/10 [00:52<00:21,  7.06s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0514, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8433, 'compress@10': 0.5234, 'time@10': 9.0107}:  80%|████████  | 8/10 [00:52<00:14,  7.40s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0512, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8528, 'compress@10': 0.5224, 'time@10': 9.6316}:  80%|████████  | 8/10 [00:59<00:14,  7.40s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0512, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8528, 'compress@10': 0.5224, 'time@10': 9.6316}:  90%|█████████ | 9/10 [00:59<00:07,  7.38s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8509, 'compress@10': 0.5213, 'time@10': 9.716}:  90%|█████████ | 9/10 [01:10<00:07,  7.38s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8509, 'compress@10': 0.5213, 'time@10': 9.716}: 100%|██████████| 10/10 [01:10<00:00,  8.35s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8509, 'compress@10': 0.5213, 'time@10': 9.716}: 100%|██████████| 10/10 [01:10<00:00,  7.03s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.051095152132811614
Avg hit ratio: 0.8181271384717904
Avg ndcg: 0.8509042093436341
Avg compression ratio: 0.5212749006657823
Avg train time: 9.716017961502075
Std train time: 3.582092650164468
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8518, 'compress@10': 0.5263, 'time@10': 9.0039}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8518, 'compress@10': 0.5263, 'time@10': 9.0039}:  10%|█         | 1/10 [00:04<00:40,  4.54s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8571, 'compress@10': 0.5212, 'time@10': 8.1117}:  10%|█         | 1/10 [00:11<00:40,  4.54s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8571, 'compress@10': 0.5212, 'time@10': 8.1117}:  20%|██        | 2/10 [00:11<00:49,  6.14s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8571, 'compress@10': 0.538, 'time@10': 6.6751}:  20%|██        | 2/10 [00:13<00:49,  6.14s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8571, 'compress@10': 0.538, 'time@10': 6.6751}:  30%|███       | 3/10 [00:13<00:29,  4.22s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8501, 'compress@10': 0.5329, 'time@10': 6.5831}:  30%|███       | 3/10 [00:20<00:29,  4.22s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8501, 'compress@10': 0.5329, 'time@10': 6.5831}:  40%|████      | 4/10 [00:20<00:30,  5.06s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0468, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8371, 'compress@10': 0.5283, 'time@10': 8.1069}:  40%|████      | 4/10 [00:27<00:30,  5.06s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0468, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8371, 'compress@10': 0.5283, 'time@10': 8.1069}:  50%|█████     | 5/10 [00:27<00:29,  5.81s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0504, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8356, 'compress@10': 0.5255, 'time@10': 8.5065}:  50%|█████     | 5/10 [00:37<00:29,  5.81s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0504, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8356, 'compress@10': 0.5255, 'time@10': 8.5065}:  60%|██████    | 6/10 [00:37<00:29,  7.42s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0501, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8379, 'compress@10': 0.5247, 'time@10': 8.9176}:  60%|██████    | 6/10 [00:43<00:29,  7.42s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0501, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8379, 'compress@10': 0.5247, 'time@10': 8.9176}:  70%|███████   | 7/10 [00:43<00:20,  6.87s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8447, 'compress@10': 0.5234, 'time@10': 8.8132}:  70%|███████   | 7/10 [00:51<00:20,  6.87s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8447, 'compress@10': 0.5234, 'time@10': 8.8132}:  80%|████████  | 8/10 [00:51<00:14,  7.26s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8509, 'compress@10': 0.5224, 'time@10': 9.476}:  80%|████████  | 8/10 [00:59<00:14,  7.26s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8509, 'compress@10': 0.5224, 'time@10': 9.476}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8508, 'compress@10': 0.5213, 'time@10': 9.5505}:  90%|█████████ | 9/10 [01:09<00:07,  7.31s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8508, 'compress@10': 0.5213, 'time@10': 9.5505}: 100%|██████████| 10/10 [01:09<00:00,  8.22s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8508, 'compress@10': 0.5213, 'time@10': 9.5505}: 100%|██████████| 10/10 [01:09<00:00,  6.93s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04954388312483239
Avg hit ratio: 0.8392029193217649
Avg ndcg: 0.8508477740945024
Avg compression ratio: 0.5212749006657823
Avg train time: 9.550513887405396
Std train time: 3.2426935929455656
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.5263, 'time@10': 8.643}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.5263, 'time@10': 8.643}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8569, 'compress@10': 0.5212, 'time@10': 7.8937}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8569, 'compress@10': 0.5212, 'time@10': 7.8937}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.857, 'compress@10': 0.538, 'time@10': 6.7069}:  20%|██        | 2/10 [00:13<00:48,  6.02s/it]  {'epoch': 5, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.857, 'compress@10': 0.538, 'time@10': 6.7069}:  30%|███       | 3/10 [00:13<00:29,  4.28s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0374, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8578, 'compress@10': 0.5329, 'time@10': 6.6412}:  30%|███       | 3/10 [00:20<00:29,  4.28s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0374, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8578, 'compress@10': 0.5329, 'time@10': 6.6412}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.844, 'compress@10': 0.5283, 'time@10': 8.1041}:  40%|████      | 4/10 [00:27<00:30,  5.15s/it] {'epoch': 5, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.844, 'compress@10': 0.5283, 'time@10': 8.1041}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0494, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.841, 'compress@10': 0.5255, 'time@10': 8.5148}:  50%|█████     | 5/10 [00:37<00:29,  5.82s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0494, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.841, 'compress@10': 0.5255, 'time@10': 8.5148}:  60%|██████    | 6/10 [00:37<00:29,  7.45s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0485, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8435, 'compress@10': 0.5247, 'time@10': 8.9883}:  60%|██████    | 6/10 [00:43<00:29,  7.45s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0485, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8435, 'compress@10': 0.5247, 'time@10': 8.9883}:  70%|███████   | 7/10 [00:43<00:20,  6.96s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0493, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8542, 'compress@10': 0.5234, 'time@10': 8.8756}:  70%|███████   | 7/10 [00:51<00:20,  6.96s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.0493, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8542, 'compress@10': 0.5234, 'time@10': 8.8756}:  80%|████████  | 8/10 [00:51<00:14,  7.33s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8696, 'compress@10': 0.5224, 'time@10': 9.5171}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8696, 'compress@10': 0.5224, 'time@10': 9.5171}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8677, 'compress@10': 0.5213, 'time@10': 9.5887}:  90%|█████████ | 9/10 [01:09<00:07,  7.34s/it]    {'epoch': 5, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8677, 'compress@10': 0.5213, 'time@10': 9.5887}: 100%|██████████| 10/10 [01:09<00:00,  8.24s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8677, 'compress@10': 0.5213, 'time@10': 9.5887}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04895310816430085
Avg hit ratio: 0.8426509479955999
Avg ndcg: 0.8677275056107876
Avg compression ratio: 0.5212749006657823
Avg train time: 9.588669896125793
Std train time: 3.125659758601033
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0464, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8563, 'compress@10': 0.5263, 'time@10': 8.8499}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0464, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8563, 'compress@10': 0.5263, 'time@10': 8.8499}:  10%|█         | 1/10 [00:04<00:40,  4.46s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.798, 'ndcg@10': 0.848, 'compress@10': 0.5212, 'time@10': 8.0113}:  10%|█         | 1/10 [00:11<00:40,  4.46s/it]  {'epoch': 6, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.798, 'ndcg@10': 0.848, 'compress@10': 0.5212, 'time@10': 8.0113}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.851, 'compress@10': 0.538, 'time@10': 6.8282}:  20%|██        | 2/10 [00:13<00:48,  6.08s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.851, 'compress@10': 0.538, 'time@10': 6.8282}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.842, 'compress@10': 0.5329, 'time@10': 6.6846}:  30%|███       | 3/10 [00:20<00:30,  4.34s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.842, 'compress@10': 0.5329, 'time@10': 6.6846}:  40%|████      | 4/10 [00:20<00:30,  5.11s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8312, 'compress@10': 0.5283, 'time@10': 8.1092}:  40%|████      | 4/10 [00:27<00:30,  5.11s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8312, 'compress@10': 0.5283, 'time@10': 8.1092}:  50%|█████     | 5/10 [00:27<00:28,  5.77s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0487, 'hit_ratio@10': 0.8146, 'ndcg@10': 0.8322, 'compress@10': 0.5255, 'time@10': 8.5132}:  50%|█████     | 5/10 [00:37<00:28,  5.77s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0487, 'hit_ratio@10': 0.8146, 'ndcg@10': 0.8322, 'compress@10': 0.5255, 'time@10': 8.5132}:  60%|██████    | 6/10 [00:37<00:29,  7.41s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0478, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8348, 'compress@10': 0.5247, 'time@10': 8.9673}:  60%|██████    | 6/10 [00:43<00:29,  7.41s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0478, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8348, 'compress@10': 0.5247, 'time@10': 8.9673}:  70%|███████   | 7/10 [00:43<00:20,  6.91s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0477, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8429, 'compress@10': 0.5234, 'time@10': 8.8609}:  70%|███████   | 7/10 [00:51<00:20,  6.91s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0477, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8429, 'compress@10': 0.5234, 'time@10': 8.8609}:  80%|████████  | 8/10 [00:51<00:14,  7.30s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0521, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8598, 'compress@10': 0.5224, 'time@10': 9.523}:  80%|████████  | 8/10 [00:59<00:14,  7.30s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0521, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8598, 'compress@10': 0.5224, 'time@10': 9.523}:  90%|█████████ | 9/10 [00:59<00:07,  7.35s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0509, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8585, 'compress@10': 0.5213, 'time@10': 9.5797}:  90%|█████████ | 9/10 [01:09<00:07,  7.35s/it]  {'epoch': 6, 'num_users': 6.3, 'loss': 0.0509, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8585, 'compress@10': 0.5213, 'time@10': 9.5797}: 100%|██████████| 10/10 [01:09<00:00,  8.21s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0509, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8585, 'compress@10': 0.5213, 'time@10': 9.5797}: 100%|██████████| 10/10 [01:09<00:00,  6.94s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.050900709457778096
Avg hit ratio: 0.849361649480495
Avg ndcg: 0.8585140689537415
Avg compression ratio: 0.5212749006657823
Avg train time: 9.579681205749512
Std train time: 3.1093334660413983
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.5263, 'time@10': 8.5872}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.5263, 'time@10': 8.5872}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0443, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8588, 'compress@10': 0.5212, 'time@10': 7.8829}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0443, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8588, 'compress@10': 0.5212, 'time@10': 7.8829}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0296, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8583, 'compress@10': 0.538, 'time@10': 6.8478}:  20%|██        | 2/10 [00:13<00:48,  6.04s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0296, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8583, 'compress@10': 0.538, 'time@10': 6.8478}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8498, 'compress@10': 0.5329, 'time@10': 6.7185}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8498, 'compress@10': 0.5329, 'time@10': 6.7185}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0437, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8379, 'compress@10': 0.5283, 'time@10': 8.1775}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0437, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8379, 'compress@10': 0.5283, 'time@10': 8.1775}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0456, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8387, 'compress@10': 0.5255, 'time@10': 8.5975}:  50%|█████     | 5/10 [00:38<00:29,  5.84s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0456, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8387, 'compress@10': 0.5255, 'time@10': 8.5975}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0453, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8422, 'compress@10': 0.5247, 'time@10': 8.9879}:  60%|██████    | 6/10 [00:43<00:30,  7.51s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0453, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8422, 'compress@10': 0.5247, 'time@10': 8.9879}:  70%|███████   | 7/10 [00:43<00:20,  6.92s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.045, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8502, 'compress@10': 0.5234, 'time@10': 8.8804}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it]   {'epoch': 7, 'num_users': 6.125, 'loss': 0.045, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8502, 'compress@10': 0.5234, 'time@10': 8.8804}:  80%|████████  | 8/10 [00:52<00:14,  7.32s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0475, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8706, 'compress@10': 0.5224, 'time@10': 9.5121}:  80%|████████  | 8/10 [00:59<00:14,  7.32s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0475, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8706, 'compress@10': 0.5224, 'time@10': 9.5121}:  90%|█████████ | 9/10 [00:59<00:07,  7.32s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0462, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8702, 'compress@10': 0.5213, 'time@10': 9.5782}:  90%|█████████ | 9/10 [01:09<00:07,  7.32s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0462, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8702, 'compress@10': 0.5213, 'time@10': 9.5782}: 100%|██████████| 10/10 [01:09<00:00,  8.22s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0462, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8702, 'compress@10': 0.5213, 'time@10': 9.5782}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04623924822514428
Avg hit ratio: 0.8529395482842002
Avg ndcg: 0.8701546500777042
Avg compression ratio: 0.5212749006657823
Avg train time: 9.578174495697022
Std train time: 3.027539460306742
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8329, 'compress@10': 0.5263, 'time@10': 8.7739}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8329, 'compress@10': 0.5263, 'time@10': 8.7739}:  10%|█         | 1/10 [00:04<00:39,  4.42s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0456, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8488, 'compress@10': 0.5212, 'time@10': 7.9414}:  10%|█         | 1/10 [00:11<00:39,  4.42s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0456, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8488, 'compress@10': 0.5212, 'time@10': 7.9414}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8516, 'compress@10': 0.538, 'time@10': 6.9945}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8516, 'compress@10': 0.538, 'time@10': 6.9945}:  30%|███       | 3/10 [00:14<00:31,  4.45s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8478, 'compress@10': 0.5329, 'time@10': 6.836}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8478, 'compress@10': 0.5329, 'time@10': 6.836}:  40%|████      | 4/10 [00:20<00:31,  5.22s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0425, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.836, 'compress@10': 0.5283, 'time@10': 8.2894}:  40%|████      | 4/10 [00:27<00:31,  5.22s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0425, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.836, 'compress@10': 0.5283, 'time@10': 8.2894}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0439, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8386, 'compress@10': 0.5255, 'time@10': 8.6533}:  50%|█████     | 5/10 [00:38<00:29,  5.89s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0439, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8386, 'compress@10': 0.5255, 'time@10': 8.6533}:  60%|██████    | 6/10 [00:38<00:29,  7.46s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0431, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.8411, 'compress@10': 0.5247, 'time@10': 9.0996}:  60%|██████    | 6/10 [00:44<00:29,  7.46s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0431, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.8411, 'compress@10': 0.5247, 'time@10': 9.0996}:  70%|███████   | 7/10 [00:44<00:20,  6.96s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0432, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8496, 'compress@10': 0.5234, 'time@10': 8.9706}:  70%|███████   | 7/10 [00:52<00:20,  6.96s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0432, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8496, 'compress@10': 0.5234, 'time@10': 8.9706}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0465, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8495, 'compress@10': 0.5224, 'time@10': 9.5942}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0465, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8495, 'compress@10': 0.5224, 'time@10': 9.5942}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0454, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8527, 'compress@10': 0.5213, 'time@10': 9.6391}:  90%|█████████ | 9/10 [01:09<00:07,  7.33s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0454, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8527, 'compress@10': 0.5213, 'time@10': 9.6391}: 100%|██████████| 10/10 [01:09<00:00,  8.18s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0454, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8527, 'compress@10': 0.5213, 'time@10': 9.6391}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04539785314419427
Avg hit ratio: 0.8633875769580353
Avg ndcg: 0.8526513703240362
Avg compression ratio: 0.5212749006657823
Avg train time: 9.639068460464477
Std train time: 3.012710211442772
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8572, 'compress@10': 0.5263, 'time@10': 8.8471}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8572, 'compress@10': 0.5263, 'time@10': 8.8471}:  10%|█         | 1/10 [00:04<00:40,  4.47s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0423, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8556, 'compress@10': 0.5212, 'time@10': 8.0202}:  10%|█         | 1/10 [00:11<00:40,  4.47s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0423, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8556, 'compress@10': 0.5212, 'time@10': 8.0202}:  20%|██        | 2/10 [00:11<00:48,  6.09s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8561, 'compress@10': 0.538, 'time@10': 7.1544}:  20%|██        | 2/10 [00:14<00:48,  6.09s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8561, 'compress@10': 0.538, 'time@10': 7.1544}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8503, 'compress@10': 0.5329, 'time@10': 6.9676}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8503, 'compress@10': 0.5329, 'time@10': 6.9676}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0412, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8385, 'compress@10': 0.5283, 'time@10': 8.3557}:  40%|████      | 4/10 [00:27<00:31,  5.31s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0412, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8385, 'compress@10': 0.5283, 'time@10': 8.3557}:  50%|█████     | 5/10 [00:27<00:29,  5.91s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0422, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8412, 'compress@10': 0.5255, 'time@10': 8.7266}:  50%|█████     | 5/10 [00:38<00:29,  5.91s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0422, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8412, 'compress@10': 0.5255, 'time@10': 8.7266}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0423, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8483, 'compress@10': 0.5247, 'time@10': 9.0714}:  60%|██████    | 6/10 [00:44<00:30,  7.51s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0423, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8483, 'compress@10': 0.5247, 'time@10': 9.0714}:  70%|███████   | 7/10 [00:44<00:20,  6.89s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0426, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8561, 'compress@10': 0.5234, 'time@10': 8.9534}:  70%|███████   | 7/10 [00:52<00:20,  6.89s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0426, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8561, 'compress@10': 0.5234, 'time@10': 8.9534}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0417, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8634, 'compress@10': 0.5224, 'time@10': 9.6183}:  80%|████████  | 8/10 [00:59<00:14,  7.30s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0417, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8634, 'compress@10': 0.5224, 'time@10': 9.6183}:  90%|█████████ | 9/10 [00:59<00:07,  7.36s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0408, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.8644, 'compress@10': 0.5213, 'time@10': 9.6969}:  90%|█████████ | 9/10 [01:10<00:07,  7.36s/it]  {'epoch': 9, 'num_users': 6.3, 'loss': 0.0408, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.8644, 'compress@10': 0.5213, 'time@10': 9.6969}: 100%|██████████| 10/10 [01:10<00:00,  8.32s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0408, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.8644, 'compress@10': 0.5213, 'time@10': 9.6969}: 100%|██████████| 10/10 [01:10<00:00,  7.02s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.04078162920840853
Avg hit ratio: 0.8676097991802575
Avg ndcg: 0.8643768725620742
Avg compression ratio: 0.5212749006657823
Avg train time: 9.696934032440186
Std train time: 2.9513872331418067
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8401, 'compress@10': 0.5263, 'time@10': 8.7917}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8401, 'compress@10': 0.5263, 'time@10': 8.7917}:  10%|█         | 1/10 [00:04<00:39,  4.44s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8485, 'compress@10': 0.5212, 'time@10': 7.9695}:  10%|█         | 1/10 [00:11<00:39,  4.44s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8485, 'compress@10': 0.5212, 'time@10': 7.9695}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8514, 'compress@10': 0.538, 'time@10': 7.1123}:  20%|██        | 2/10 [00:14<00:48,  6.05s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8514, 'compress@10': 0.538, 'time@10': 7.1123}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8625, 'compress@10': 0.5329, 'time@10': 6.9229}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8625, 'compress@10': 0.5329, 'time@10': 6.9229}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0432, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8491, 'compress@10': 0.5283, 'time@10': 8.3478}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0432, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8491, 'compress@10': 0.5283, 'time@10': 8.3478}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0434, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8503, 'compress@10': 0.5255, 'time@10': 8.7238}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0434, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8503, 'compress@10': 0.5255, 'time@10': 8.7238}:  60%|██████    | 6/10 [00:38<00:30,  7.52s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0434, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8487, 'compress@10': 0.5247, 'time@10': 9.0919}:  60%|██████    | 6/10 [00:44<00:30,  7.52s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0434, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8487, 'compress@10': 0.5247, 'time@10': 9.0919}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0433, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8549, 'compress@10': 0.5234, 'time@10': 8.9693}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0433, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8549, 'compress@10': 0.5234, 'time@10': 8.9693}:  80%|████████  | 8/10 [00:52<00:14,  7.32s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0437, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8625, 'compress@10': 0.5224, 'time@10': 9.5919}:  80%|████████  | 8/10 [00:59<00:14,  7.32s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0437, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8625, 'compress@10': 0.5224, 'time@10': 9.5919}:  90%|█████████ | 9/10 [00:59<00:07,  7.32s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0431, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8647, 'compress@10': 0.5213, 'time@10': 9.6477}:  90%|█████████ | 9/10 [01:09<00:07,  7.32s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0431, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8647, 'compress@10': 0.5213, 'time@10': 9.6477}: 100%|██████████| 10/10 [01:09<00:00,  8.20s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0431, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8647, 'compress@10': 0.5213, 'time@10': 9.6477}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.04314599557849837
Avg hit ratio: 0.8593046276492796
Avg ndcg: 0.864721049286769
Avg compression ratio: 0.5212749006657823
Avg train time: 9.647666597366333
Std train time: 2.9286815864735
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.5263, 'time@10': 8.4876}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.5263, 'time@10': 8.4876}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8643, 'compress@10': 0.5212, 'time@10': 7.8345}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8643, 'compress@10': 0.5212, 'time@10': 7.8345}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8619, 'compress@10': 0.538, 'time@10': 6.985}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it]   {'epoch': 11, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8619, 'compress@10': 0.538, 'time@10': 6.985}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8457, 'compress@10': 0.5329, 'time@10': 6.8286}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8457, 'compress@10': 0.5329, 'time@10': 6.8286}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0383, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8365, 'compress@10': 0.5283, 'time@10': 8.2382}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0383, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8365, 'compress@10': 0.5283, 'time@10': 8.2382}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0384, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8418, 'compress@10': 0.5255, 'time@10': 8.6587}:  50%|█████     | 5/10 [00:38<00:29,  5.87s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0384, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8418, 'compress@10': 0.5255, 'time@10': 8.6587}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0388, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8505, 'compress@10': 0.5247, 'time@10': 9.0666}:  60%|██████    | 6/10 [00:44<00:30,  7.54s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0388, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8505, 'compress@10': 0.5247, 'time@10': 9.0666}:  70%|███████   | 7/10 [00:44<00:20,  6.97s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.039, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8557, 'compress@10': 0.5234, 'time@10': 8.9352}:  70%|███████   | 7/10 [00:52<00:20,  6.97s/it]  {'epoch': 11, 'num_users': 6.125, 'loss': 0.039, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8557, 'compress@10': 0.5234, 'time@10': 8.9352}:  80%|████████  | 8/10 [00:52<00:14,  7.32s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0378, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8634, 'compress@10': 0.5224, 'time@10': 9.5791}:  80%|████████  | 8/10 [00:59<00:14,  7.32s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0378, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8634, 'compress@10': 0.5224, 'time@10': 9.5791}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0365, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8671, 'compress@10': 0.5213, 'time@10': 9.642}:  90%|█████████ | 9/10 [01:09<00:07,  7.34s/it]    {'epoch': 11, 'num_users': 6.3, 'loss': 0.0365, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8671, 'compress@10': 0.5213, 'time@10': 9.642}: 100%|██████████| 10/10 [01:09<00:00,  8.24s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0365, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8671, 'compress@10': 0.5213, 'time@10': 9.642}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03649075005944536
Avg hit ratio: 0.8642916406362925
Avg ndcg: 0.8671414658033951
Avg compression ratio: 0.5212749006657823
Avg train time: 9.641954898834229
Std train time: 2.9780229461045926
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8438, 'compress@10': 0.5263, 'time@10': 8.4926}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8438, 'compress@10': 0.5263, 'time@10': 8.4926}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8609, 'compress@10': 0.5212, 'time@10': 7.8144}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8609, 'compress@10': 0.5212, 'time@10': 7.8144}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8597, 'compress@10': 0.538, 'time@10': 7.0533}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8597, 'compress@10': 0.538, 'time@10': 7.0533}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8557, 'compress@10': 0.5329, 'time@10': 6.8713}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8557, 'compress@10': 0.5329, 'time@10': 6.8713}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0364, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8457, 'compress@10': 0.5283, 'time@10': 8.3728}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0364, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8457, 'compress@10': 0.5283, 'time@10': 8.3728}:  50%|█████     | 5/10 [00:27<00:29,  5.97s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0373, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8489, 'compress@10': 0.5255, 'time@10': 8.7464}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0373, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8489, 'compress@10': 0.5255, 'time@10': 8.7464}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0369, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8483, 'compress@10': 0.5247, 'time@10': 9.1418}:  60%|██████    | 6/10 [00:44<00:30,  7.56s/it] {'epoch': 12, 'num_users': 6.2857, 'loss': 0.0369, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8483, 'compress@10': 0.5247, 'time@10': 9.1418}:  70%|███████   | 7/10 [00:44<00:20,  6.98s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0371, 'hit_ratio@10': 0.88, 'ndcg@10': 0.8538, 'compress@10': 0.5234, 'time@10': 9.0267}:  70%|███████   | 7/10 [00:52<00:20,  6.98s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.0371, 'hit_ratio@10': 0.88, 'ndcg@10': 0.8538, 'compress@10': 0.5234, 'time@10': 9.0267}:  80%|████████  | 8/10 [00:52<00:14,  7.39s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0376, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8661, 'compress@10': 0.5224, 'time@10': 9.6071}:  80%|████████  | 8/10 [00:59<00:14,  7.39s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0376, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8661, 'compress@10': 0.5224, 'time@10': 9.6071}:  90%|█████████ | 9/10 [00:59<00:07,  7.32s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.037, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.8692, 'compress@10': 0.5213, 'time@10': 9.6616}:  90%|█████████ | 9/10 [01:09<00:07,  7.32s/it]    {'epoch': 12, 'num_users': 6.3, 'loss': 0.037, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.8692, 'compress@10': 0.5213, 'time@10': 9.6616}: 100%|██████████| 10/10 [01:09<00:00,  8.20s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.037, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.8692, 'compress@10': 0.5213, 'time@10': 9.6616}: 100%|██████████| 10/10 [01:09<00:00,  6.99s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03698053706177137
Avg hit ratio: 0.8794408014170323
Avg ndcg: 0.8692429229640488
Avg compression ratio: 0.5212749006657823
Avg train time: 9.66162314414978
Std train time: 2.930724677512358
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8481, 'compress@10': 0.5263, 'time@10': 8.6547}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8481, 'compress@10': 0.5263, 'time@10': 8.6547}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8659, 'compress@10': 0.5212, 'time@10': 7.9539}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8659, 'compress@10': 0.5212, 'time@10': 7.9539}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.863, 'compress@10': 0.538, 'time@10': 7.089}:  20%|██        | 2/10 [00:14<00:48,  6.08s/it]   {'epoch': 13, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.863, 'compress@10': 0.538, 'time@10': 7.089}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0256, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8661, 'compress@10': 0.5329, 'time@10': 6.9095}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0256, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8661, 'compress@10': 0.5329, 'time@10': 6.9095}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0327, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8551, 'compress@10': 0.5283, 'time@10': 8.3532}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0327, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8551, 'compress@10': 0.5283, 'time@10': 8.3532}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0328, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8595, 'compress@10': 0.5255, 'time@10': 8.6843}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0328, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8595, 'compress@10': 0.5255, 'time@10': 8.6843}:  60%|██████    | 6/10 [00:38<00:29,  7.45s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8666, 'compress@10': 0.5247, 'time@10': 9.1245}:  60%|██████    | 6/10 [00:44<00:29,  7.45s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8666, 'compress@10': 0.5247, 'time@10': 9.1245}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0335, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.8684, 'compress@10': 0.5234, 'time@10': 8.9835}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0335, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.8684, 'compress@10': 0.5234, 'time@10': 8.9835}:  80%|████████  | 8/10 [00:52<00:14,  7.29s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8724, 'compress@10': 0.5224, 'time@10': 9.6053}:  80%|████████  | 8/10 [00:59<00:14,  7.29s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8724, 'compress@10': 0.5224, 'time@10': 9.6053}:  90%|█████████ | 9/10 [00:59<00:07,  7.30s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.032, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8781, 'compress@10': 0.5213, 'time@10': 9.6715}:  90%|█████████ | 9/10 [01:09<00:07,  7.30s/it]    {'epoch': 13, 'num_users': 6.3, 'loss': 0.032, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8781, 'compress@10': 0.5213, 'time@10': 9.6715}: 100%|██████████| 10/10 [01:09<00:00,  8.23s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.032, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8781, 'compress@10': 0.5213, 'time@10': 9.6715}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03199829994367487
Avg hit ratio: 0.8866500366262675
Avg ndcg: 0.8780621656598088
Avg compression ratio: 0.5212749006657823
Avg train time: 9.671517181396485
Std train time: 2.971790977511816
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.044, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8497, 'compress@10': 0.5263, 'time@10': 8.678}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.044, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8497, 'compress@10': 0.5263, 'time@10': 8.678}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8642, 'compress@10': 0.5212, 'time@10': 8.0264}:  10%|█         | 1/10 [00:11<00:39,  4.38s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8642, 'compress@10': 0.5212, 'time@10': 8.0264}:  20%|██        | 2/10 [00:11<00:49,  6.16s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8618, 'compress@10': 0.538, 'time@10': 7.1505}:  20%|██        | 2/10 [00:14<00:49,  6.16s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8618, 'compress@10': 0.538, 'time@10': 7.1505}:  30%|███       | 3/10 [00:14<00:32,  4.60s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.862, 'compress@10': 0.5329, 'time@10': 6.9961}:  30%|███       | 3/10 [00:21<00:32,  4.60s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.862, 'compress@10': 0.5329, 'time@10': 6.9961}:  40%|████      | 4/10 [00:21<00:32,  5.38s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0337, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8527, 'compress@10': 0.5283, 'time@10': 8.4398}:  40%|████      | 4/10 [00:28<00:32,  5.38s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0337, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8527, 'compress@10': 0.5283, 'time@10': 8.4398}:  50%|█████     | 5/10 [00:28<00:30,  6.01s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0336, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8579, 'compress@10': 0.5255, 'time@10': 8.7765}:  50%|█████     | 5/10 [00:38<00:30,  6.01s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0336, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8579, 'compress@10': 0.5255, 'time@10': 8.7765}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0332, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8574, 'compress@10': 0.5247, 'time@10': 9.1456}:  60%|██████    | 6/10 [00:44<00:30,  7.54s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0332, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8574, 'compress@10': 0.5247, 'time@10': 9.1456}:  70%|███████   | 7/10 [00:44<00:20,  6.94s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0334, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8598, 'compress@10': 0.5234, 'time@10': 9.0363}:  70%|███████   | 7/10 [00:52<00:20,  6.94s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0334, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8598, 'compress@10': 0.5234, 'time@10': 9.0363}:  80%|████████  | 8/10 [00:52<00:14,  7.38s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0326, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8671, 'compress@10': 0.5224, 'time@10': 9.6735}:  80%|████████  | 8/10 [01:00<00:14,  7.38s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0326, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8671, 'compress@10': 0.5224, 'time@10': 9.6735}:  90%|█████████ | 9/10 [01:00<00:07,  7.39s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8702, 'compress@10': 0.5213, 'time@10': 9.7192}:  90%|█████████ | 9/10 [01:10<00:07,  7.39s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8702, 'compress@10': 0.5213, 'time@10': 9.7192}: 100%|██████████| 10/10 [01:10<00:00,  8.25s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8702, 'compress@10': 0.5213, 'time@10': 9.7192}: 100%|██████████| 10/10 [01:10<00:00,  7.04s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.03251587015612896
Avg hit ratio: 0.8842440215886734
Avg ndcg: 0.8701758281025667
Avg compression ratio: 0.5212749006657823
Avg train time: 9.719225287437439
Std train time: 2.9434304117229293
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8492, 'compress@10': 0.5263, 'time@10': 8.4593}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8492, 'compress@10': 0.5263, 'time@10': 8.4593}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8715, 'compress@10': 0.5212, 'time@10': 7.8221}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8715, 'compress@10': 0.5212, 'time@10': 7.8221}:  20%|██        | 2/10 [00:11<00:48,  6.00s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8667, 'compress@10': 0.538, 'time@10': 7.0052}:  20%|██        | 2/10 [00:14<00:48,  6.00s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8667, 'compress@10': 0.538, 'time@10': 7.0052}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8631, 'compress@10': 0.5329, 'time@10': 6.8424}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8631, 'compress@10': 0.5329, 'time@10': 6.8424}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0335, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8538, 'compress@10': 0.5283, 'time@10': 8.293}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it] {'epoch': 15, 'num_users': 5.8, 'loss': 0.0335, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8538, 'compress@10': 0.5283, 'time@10': 8.293}:  50%|█████     | 5/10 [00:27<00:29,  5.91s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.033, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8615, 'compress@10': 0.5255, 'time@10': 8.6624}:  50%|█████     | 5/10 [00:38<00:29,  5.91s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.033, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8615, 'compress@10': 0.5255, 'time@10': 8.6624}:  60%|██████    | 6/10 [00:38<00:29,  7.49s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.033, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8693, 'compress@10': 0.5247, 'time@10': 9.0979}:  60%|██████    | 6/10 [00:44<00:29,  7.49s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.033, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8693, 'compress@10': 0.5247, 'time@10': 9.0979}:  70%|███████   | 7/10 [00:44<00:20,  6.97s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0328, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8716, 'compress@10': 0.5234, 'time@10': 9.0011}:  70%|███████   | 7/10 [00:52<00:20,  6.97s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0328, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8716, 'compress@10': 0.5234, 'time@10': 9.0011}:  80%|████████  | 8/10 [00:52<00:14,  7.41s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0323, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.8805, 'compress@10': 0.5224, 'time@10': 9.6543}:  80%|████████  | 8/10 [00:59<00:14,  7.41s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0323, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.8805, 'compress@10': 0.5224, 'time@10': 9.6543}:  90%|█████████ | 9/10 [00:59<00:07,  7.43s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0311, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.8855, 'compress@10': 0.5213, 'time@10': 9.7325}:  90%|█████████ | 9/10 [01:10<00:07,  7.43s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0311, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.8855, 'compress@10': 0.5213, 'time@10': 9.7325}: 100%|██████████| 10/10 [01:10<00:00,  8.37s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0311, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.8855, 'compress@10': 0.5213, 'time@10': 9.7325}: 100%|██████████| 10/10 [01:10<00:00,  7.04s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.031143347205728415
Avg hit ratio: 0.8871011644458162
Avg ndcg: 0.8854634391956709
Avg compression ratio: 0.5212749006657823
Avg train time: 9.732459473609925
Std train time: 3.0178089954133
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8641, 'compress@10': 0.5263, 'time@10': 8.6827}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8641, 'compress@10': 0.5263, 'time@10': 8.6827}:  10%|█         | 1/10 [00:04<00:39,  4.39s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8818, 'compress@10': 0.5212, 'time@10': 7.9328}:  10%|█         | 1/10 [00:11<00:39,  4.39s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8818, 'compress@10': 0.5212, 'time@10': 7.9328}:  20%|██        | 2/10 [00:11<00:48,  6.06s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8736, 'compress@10': 0.538, 'time@10': 7.0683}:  20%|██        | 2/10 [00:14<00:48,  6.06s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8736, 'compress@10': 0.538, 'time@10': 7.0683}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8654, 'compress@10': 0.5329, 'time@10': 6.8972}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8654, 'compress@10': 0.5329, 'time@10': 6.8972}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0311, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8577, 'compress@10': 0.5283, 'time@10': 8.3383}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0311, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8577, 'compress@10': 0.5283, 'time@10': 8.3383}:  50%|█████     | 5/10 [00:27<00:29,  5.93s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0299, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8656, 'compress@10': 0.5255, 'time@10': 8.685}:  50%|█████     | 5/10 [00:38<00:29,  5.93s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0299, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8656, 'compress@10': 0.5255, 'time@10': 8.685}:  60%|██████    | 6/10 [00:38<00:29,  7.47s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0299, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8671, 'compress@10': 0.5247, 'time@10': 9.0919}:  60%|██████    | 6/10 [00:44<00:29,  7.47s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0299, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8671, 'compress@10': 0.5247, 'time@10': 9.0919}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0293, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8716, 'compress@10': 0.5234, 'time@10': 8.9458}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0293, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8716, 'compress@10': 0.5234, 'time@10': 8.9458}:  80%|████████  | 8/10 [00:52<00:14,  7.25s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0292, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.8809, 'compress@10': 0.5224, 'time@10': 9.5924}:  80%|████████  | 8/10 [00:59<00:14,  7.25s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0292, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.8809, 'compress@10': 0.5224, 'time@10': 9.5924}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.029, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.8848, 'compress@10': 0.5213, 'time@10': 9.6598}:  90%|█████████ | 9/10 [01:09<00:07,  7.31s/it]    {'epoch': 16, 'num_users': 6.3, 'loss': 0.029, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.8848, 'compress@10': 0.5213, 'time@10': 9.6598}: 100%|██████████| 10/10 [01:09<00:00,  8.23s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.029, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.8848, 'compress@10': 0.5213, 'time@10': 9.6598}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.0289977493921108
Avg hit ratio: 0.8785297358743878
Avg ndcg: 0.8847565197764851
Avg compression ratio: 0.5212749006657823
Avg train time: 9.659765648841859
Std train time: 2.9960286032164163
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8503, 'compress@10': 0.5263, 'time@10': 8.7295}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8503, 'compress@10': 0.5263, 'time@10': 8.7295}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8741, 'compress@10': 0.5212, 'time@10': 7.9793}:  10%|█         | 1/10 [00:11<00:39,  4.41s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8741, 'compress@10': 0.5212, 'time@10': 7.9793}:  20%|██        | 2/10 [00:11<00:48,  6.09s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8685, 'compress@10': 0.538, 'time@10': 7.1227}:  20%|██        | 2/10 [00:14<00:48,  6.09s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8685, 'compress@10': 0.538, 'time@10': 7.1227}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8569, 'compress@10': 0.5329, 'time@10': 6.9521}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8569, 'compress@10': 0.5329, 'time@10': 6.9521}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8518, 'compress@10': 0.5283, 'time@10': 8.4337}:  40%|████      | 4/10 [00:28<00:31,  5.32s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8518, 'compress@10': 0.5283, 'time@10': 8.4337}:  50%|█████     | 5/10 [00:28<00:30,  6.00s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8605, 'compress@10': 0.5255, 'time@10': 8.7542}:  50%|█████     | 5/10 [00:38<00:30,  6.00s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8605, 'compress@10': 0.5255, 'time@10': 8.7542}:  60%|██████    | 6/10 [00:38<00:29,  7.50s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8692, 'compress@10': 0.5247, 'time@10': 9.1513}:  60%|██████    | 6/10 [00:44<00:29,  7.50s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8692, 'compress@10': 0.5247, 'time@10': 9.1513}:  70%|███████   | 7/10 [00:44<00:20,  6.94s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0273, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8749, 'compress@10': 0.5234, 'time@10': 9.0192}:  70%|███████   | 7/10 [00:52<00:20,  6.94s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0273, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8749, 'compress@10': 0.5234, 'time@10': 9.0192}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8832, 'compress@10': 0.5224, 'time@10': 9.6438}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8832, 'compress@10': 0.5224, 'time@10': 9.6438}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0258, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.8889, 'compress@10': 0.5213, 'time@10': 9.7219}:  90%|█████████ | 9/10 [01:10<00:07,  7.34s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0258, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.8889, 'compress@10': 0.5213, 'time@10': 9.7219}: 100%|██████████| 10/10 [01:10<00:00,  8.31s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0258, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.8889, 'compress@10': 0.5213, 'time@10': 9.7219}: 100%|██████████| 10/10 [01:10<00:00,  7.03s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02580358498150126
Avg hit ratio: 0.8874698280402864
Avg ndcg: 0.8888990995193643
Avg compression ratio: 0.5212749006657823
Avg train time: 9.721885228157044
Std train time: 2.984839715571808
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0433, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8411, 'compress@10': 0.5263, 'time@10': 8.562}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0433, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8411, 'compress@10': 0.5263, 'time@10': 8.562}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8788, 'compress@10': 0.5212, 'time@10': 7.8441}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8788, 'compress@10': 0.5212, 'time@10': 7.8441}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8716, 'compress@10': 0.538, 'time@10': 7.0167}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8716, 'compress@10': 0.538, 'time@10': 7.0167}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8879, 'compress@10': 0.5329, 'time@10': 6.841}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8879, 'compress@10': 0.5329, 'time@10': 6.841}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0298, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8774, 'compress@10': 0.5283, 'time@10': 8.3428}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0298, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8774, 'compress@10': 0.5283, 'time@10': 8.3428}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0288, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8832, 'compress@10': 0.5255, 'time@10': 8.6959}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0288, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8832, 'compress@10': 0.5255, 'time@10': 8.6959}:  60%|██████    | 6/10 [00:38<00:29,  7.49s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0285, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8838, 'compress@10': 0.5247, 'time@10': 9.0809}:  60%|██████    | 6/10 [00:43<00:29,  7.49s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0285, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8838, 'compress@10': 0.5247, 'time@10': 9.0809}:  70%|███████   | 7/10 [00:43<00:20,  6.92s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0266, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.8895, 'compress@10': 0.5234, 'time@10': 8.9573}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0266, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.8895, 'compress@10': 0.5234, 'time@10': 8.9573}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.88, 'ndcg@10': 0.8968, 'compress@10': 0.5224, 'time@10': 9.5834}:  80%|████████  | 8/10 [00:59<00:14,  7.30s/it]  {'epoch': 18, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.88, 'ndcg@10': 0.8968, 'compress@10': 0.5224, 'time@10': 9.5834}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0261, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9022, 'compress@10': 0.5213, 'time@10': 9.6563}:  90%|█████████ | 9/10 [01:09<00:07,  7.31s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0261, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9022, 'compress@10': 0.5213, 'time@10': 9.6563}: 100%|██████████| 10/10 [01:09<00:00,  8.25s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0261, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9022, 'compress@10': 0.5213, 'time@10': 9.6563}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.026080638789187087
Avg hit ratio: 0.8896920502625086
Avg ndcg: 0.9021532502248325
Avg compression ratio: 0.5212749006657823
Avg train time: 9.656264472007752
Std train time: 3.0022545507664797
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8586, 'compress@10': 0.5263, 'time@10': 8.5292}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8586, 'compress@10': 0.5263, 'time@10': 8.5292}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0309, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8846, 'compress@10': 0.5212, 'time@10': 7.8413}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0309, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8846, 'compress@10': 0.5212, 'time@10': 7.8413}:  20%|██        | 2/10 [00:11<00:48,  6.00s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8754, 'compress@10': 0.538, 'time@10': 7.0517}:  20%|██        | 2/10 [00:14<00:48,  6.00s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8754, 'compress@10': 0.538, 'time@10': 7.0517}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8648, 'compress@10': 0.5329, 'time@10': 6.8956}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8648, 'compress@10': 0.5329, 'time@10': 6.8956}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0289, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8598, 'compress@10': 0.5283, 'time@10': 8.3852}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0289, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8598, 'compress@10': 0.5283, 'time@10': 8.3852}:  50%|█████     | 5/10 [00:27<00:29,  5.98s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0275, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8704, 'compress@10': 0.5255, 'time@10': 8.7512}:  50%|█████     | 5/10 [00:38<00:29,  5.98s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0275, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8704, 'compress@10': 0.5255, 'time@10': 8.7512}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0269, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8774, 'compress@10': 0.5247, 'time@10': 9.1267}:  60%|██████    | 6/10 [00:44<00:30,  7.56s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0269, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8774, 'compress@10': 0.5247, 'time@10': 9.1267}:  70%|███████   | 7/10 [00:44<00:20,  6.96s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0257, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.8846, 'compress@10': 0.5234, 'time@10': 9.0058}:  70%|███████   | 7/10 [00:52<00:20,  6.96s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0257, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.8846, 'compress@10': 0.5234, 'time@10': 9.0058}:  80%|████████  | 8/10 [00:52<00:14,  7.35s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0254, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.8934, 'compress@10': 0.5224, 'time@10': 9.6384}:  80%|████████  | 8/10 [00:59<00:14,  7.35s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0254, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.8934, 'compress@10': 0.5224, 'time@10': 9.6384}:  90%|█████████ | 9/10 [00:59<00:07,  7.36s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.8961, 'compress@10': 0.5213, 'time@10': 9.7042}:  90%|█████████ | 9/10 [01:10<00:07,  7.36s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.8961, 'compress@10': 0.5213, 'time@10': 9.7042}: 100%|██████████| 10/10 [01:10<00:00,  8.28s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.8961, 'compress@10': 0.5213, 'time@10': 9.7042}: 100%|██████████| 10/10 [01:10<00:00,  7.02s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.02506646039221557
Avg hit ratio: 0.8891615573635947
Avg ndcg: 0.8961400640090181
Avg compression ratio: 0.5212749006657823
Avg train time: 9.704214525222778
Std train time: 2.9887531936888325
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.864, 'compress@10': 0.5263, 'time@10': 8.8039}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.864, 'compress@10': 0.5263, 'time@10': 8.8039}:  10%|█         | 1/10 [00:04<00:39,  4.44s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8908, 'compress@10': 0.5212, 'time@10': 8.0614}:  10%|█         | 1/10 [00:11<00:39,  4.44s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8908, 'compress@10': 0.5212, 'time@10': 8.0614}:  20%|██        | 2/10 [00:11<00:49,  6.16s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8796, 'compress@10': 0.538, 'time@10': 7.1553}:  20%|██        | 2/10 [00:14<00:49,  6.16s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8796, 'compress@10': 0.538, 'time@10': 7.1553}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.87, 'compress@10': 0.5329, 'time@10': 6.9625}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.87, 'compress@10': 0.5329, 'time@10': 6.9625}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0255, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8643, 'compress@10': 0.5283, 'time@10': 8.4112}:  40%|████      | 4/10 [00:28<00:31,  5.31s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0255, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8643, 'compress@10': 0.5283, 'time@10': 8.4112}:  50%|█████     | 5/10 [00:28<00:29,  5.97s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8738, 'compress@10': 0.5255, 'time@10': 8.7404}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8738, 'compress@10': 0.5255, 'time@10': 8.7404}:  60%|██████    | 6/10 [00:38<00:29,  7.48s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0254, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.875, 'compress@10': 0.5247, 'time@10': 9.1172}:  60%|██████    | 6/10 [00:44<00:29,  7.48s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 0.0254, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.875, 'compress@10': 0.5247, 'time@10': 9.1172}:  70%|███████   | 7/10 [00:44<00:20,  6.91s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0247, 'hit_ratio@10': 0.892, 'ndcg@10': 0.8799, 'compress@10': 0.5234, 'time@10': 8.9925}:  70%|███████   | 7/10 [00:52<00:20,  6.91s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0247, 'hit_ratio@10': 0.892, 'ndcg@10': 0.8799, 'compress@10': 0.5234, 'time@10': 8.9925}:  80%|████████  | 8/10 [00:52<00:14,  7.31s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0244, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8892, 'compress@10': 0.5224, 'time@10': 9.6056}:  80%|████████  | 8/10 [00:59<00:14,  7.31s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0244, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.8892, 'compress@10': 0.5224, 'time@10': 9.6056}:  90%|█████████ | 9/10 [00:59<00:07,  7.30s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0227, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.8959, 'compress@10': 0.5213, 'time@10': 9.6602}:  90%|█████████ | 9/10 [01:09<00:07,  7.30s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0227, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.8959, 'compress@10': 0.5213, 'time@10': 9.6602}: 100%|██████████| 10/10 [01:09<00:00,  8.20s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0227, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.8959, 'compress@10': 0.5213, 'time@10': 9.6602}: 100%|██████████| 10/10 [01:09<00:00,  6.99s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.022736259481311447
Avg hit ratio: 0.8885035952540197
Avg ndcg: 0.8958611742290887
Avg compression ratio: 0.5212749006657823
Avg train time: 9.660161805152892
Std train time: 2.930462596032828
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.86, 'compress@10': 0.5263, 'time@10': 8.6952}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.86, 'compress@10': 0.5263, 'time@10': 8.6952}:  10%|█         | 1/10 [00:04<00:39,  4.39s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8889, 'compress@10': 0.5212, 'time@10': 7.9429}:  10%|█         | 1/10 [00:11<00:39,  4.39s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8889, 'compress@10': 0.5212, 'time@10': 7.9429}:  20%|██        | 2/10 [00:11<00:48,  6.06s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8783, 'compress@10': 0.538, 'time@10': 7.0917}:  20%|██        | 2/10 [00:14<00:48,  6.06s/it]  {'epoch': 21, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8783, 'compress@10': 0.538, 'time@10': 7.0917}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8809, 'compress@10': 0.5329, 'time@10': 6.9505}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8809, 'compress@10': 0.5329, 'time@10': 6.9505}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8738, 'compress@10': 0.5283, 'time@10': 8.4151}:  40%|████      | 4/10 [00:28<00:32,  5.34s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8738, 'compress@10': 0.5283, 'time@10': 8.4151}:  50%|█████     | 5/10 [00:28<00:30,  6.00s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0267, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8883, 'compress@10': 0.5255, 'time@10': 8.7628}:  50%|█████     | 5/10 [00:38<00:30,  6.00s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0267, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8883, 'compress@10': 0.5255, 'time@10': 8.7628}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0255, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8935, 'compress@10': 0.5247, 'time@10': 9.1594}:  60%|██████    | 6/10 [00:44<00:30,  7.54s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0255, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8935, 'compress@10': 0.5247, 'time@10': 9.1594}:  70%|███████   | 7/10 [00:44<00:20,  6.98s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0247, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.8955, 'compress@10': 0.5234, 'time@10': 9.0099}:  70%|███████   | 7/10 [00:52<00:20,  6.98s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0247, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.8955, 'compress@10': 0.5234, 'time@10': 9.0099}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0247, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9032, 'compress@10': 0.5224, 'time@10': 9.6174}:  80%|████████  | 8/10 [00:59<00:14,  7.30s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0247, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9032, 'compress@10': 0.5224, 'time@10': 9.6174}:  90%|█████████ | 9/10 [00:59<00:07,  7.29s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9034, 'compress@10': 0.5213, 'time@10': 9.6883}:  90%|█████████ | 9/10 [01:10<00:07,  7.29s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9034, 'compress@10': 0.5213, 'time@10': 9.6883}: 100%|██████████| 10/10 [01:10<00:00,  8.24s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9034, 'compress@10': 0.5213, 'time@10': 9.6883}: 100%|██████████| 10/10 [01:10<00:00,  7.01s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.024806418481211255
Avg hit ratio: 0.8849321666825911
Avg ndcg: 0.9033561677947539
Avg compression ratio: 0.5212749006657823
Avg train time: 9.688331365585327
Std train time: 2.9518279735050608
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8824, 'compress@10': 0.5263, 'time@10': 8.6839}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8824, 'compress@10': 0.5263, 'time@10': 8.6839}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.905, 'compress@10': 0.5212, 'time@10': 7.9293}:  10%|█         | 1/10 [00:11<00:39,  4.38s/it] {'epoch': 22, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.905, 'compress@10': 0.5212, 'time@10': 7.9293}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.889, 'compress@10': 0.538, 'time@10': 7.0963}:  20%|██        | 2/10 [00:14<00:48,  6.05s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.889, 'compress@10': 0.538, 'time@10': 7.0963}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8977, 'compress@10': 0.5329, 'time@10': 6.9402}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8977, 'compress@10': 0.5329, 'time@10': 6.9402}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8891, 'compress@10': 0.5283, 'time@10': 8.3839}:  40%|████      | 4/10 [00:27<00:31,  5.32s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8891, 'compress@10': 0.5283, 'time@10': 8.3839}:  50%|█████     | 5/10 [00:27<00:29,  5.97s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0213, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8985, 'compress@10': 0.5255, 'time@10': 8.7459}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0213, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8985, 'compress@10': 0.5255, 'time@10': 8.7459}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9023, 'compress@10': 0.5247, 'time@10': 9.1194}:  60%|██████    | 6/10 [00:44<00:30,  7.54s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9023, 'compress@10': 0.5247, 'time@10': 9.1194}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0215, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9063, 'compress@10': 0.5234, 'time@10': 8.9767}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0215, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9063, 'compress@10': 0.5234, 'time@10': 8.9767}:  80%|████████  | 8/10 [00:52<00:14,  7.29s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.919, 'compress@10': 0.5224, 'time@10': 9.5793}:  80%|████████  | 8/10 [00:59<00:14,  7.29s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.919, 'compress@10': 0.5224, 'time@10': 9.5793}:  90%|█████████ | 9/10 [00:59<00:07,  7.27s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9206, 'compress@10': 0.5213, 'time@10': 9.6442}:  90%|█████████ | 9/10 [01:09<00:07,  7.27s/it]  {'epoch': 22, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9206, 'compress@10': 0.5213, 'time@10': 9.6442}: 100%|██████████| 10/10 [01:09<00:00,  8.20s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9206, 'compress@10': 0.5213, 'time@10': 9.6442}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.023263695345756952
Avg hit ratio: 0.8750524674344708
Avg ndcg: 0.9206129148340473
Avg compression ratio: 0.5212749006657823
Avg train time: 9.64416046142578
Std train time: 2.9110056990924904
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8779, 'compress@10': 0.5263, 'time@10': 8.596}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8779, 'compress@10': 0.5263, 'time@10': 8.596}:  10%|█         | 1/10 [00:04<00:39,  4.33s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9105, 'compress@10': 0.5212, 'time@10': 7.8132}:  10%|█         | 1/10 [00:11<00:39,  4.33s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9105, 'compress@10': 0.5212, 'time@10': 7.8132}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8927, 'compress@10': 0.538, 'time@10': 7.0192}:  20%|██        | 2/10 [00:14<00:47,  5.94s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8927, 'compress@10': 0.538, 'time@10': 7.0192}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.899, 'compress@10': 0.5329, 'time@10': 6.898}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.899, 'compress@10': 0.5329, 'time@10': 6.898}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8918, 'compress@10': 0.5283, 'time@10': 8.3661}:  40%|████      | 4/10 [00:27<00:31,  5.31s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8918, 'compress@10': 0.5283, 'time@10': 8.3661}:  50%|█████     | 5/10 [00:27<00:29,  5.97s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0217, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.902, 'compress@10': 0.5255, 'time@10': 8.7149}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0217, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.902, 'compress@10': 0.5255, 'time@10': 8.7149}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9011, 'compress@10': 0.5247, 'time@10': 9.0697}:  60%|██████    | 6/10 [00:44<00:30,  7.51s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9011, 'compress@10': 0.5247, 'time@10': 9.0697}:  70%|███████   | 7/10 [00:44<00:20,  6.90s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9037, 'compress@10': 0.5234, 'time@10': 8.974}:  70%|███████   | 7/10 [00:52<00:20,  6.90s/it]  {'epoch': 23, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9037, 'compress@10': 0.5234, 'time@10': 8.974}:  80%|████████  | 8/10 [00:52<00:14,  7.36s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0246, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9251, 'compress@10': 0.5224, 'time@10': 9.5996}:  80%|████████  | 8/10 [00:59<00:14,  7.36s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0246, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9251, 'compress@10': 0.5224, 'time@10': 9.5996}:  90%|█████████ | 9/10 [00:59<00:07,  7.35s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9301, 'compress@10': 0.5213, 'time@10': 9.6632}:  90%|█████████ | 9/10 [01:09<00:07,  7.35s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9301, 'compress@10': 0.5213, 'time@10': 9.6632}: 100%|██████████| 10/10 [01:09<00:00,  8.25s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9301, 'compress@10': 0.5213, 'time@10': 9.6632}: 100%|██████████| 10/10 [01:09<00:00,  7.00s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.022416533508317044
Avg hit ratio: 0.9006238960058994
Avg ndcg: 0.9300969455316999
Avg compression ratio: 0.5212749006657823
Avg train time: 9.663199019432067
Std train time: 2.937331136238076
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 0.5263, 'time@10': 8.8181}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 0.5263, 'time@10': 8.8181}:  10%|█         | 1/10 [00:04<00:40,  4.45s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9221, 'compress@10': 0.5212, 'time@10': 8.0591}:  10%|█         | 1/10 [00:11<00:40,  4.45s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9221, 'compress@10': 0.5212, 'time@10': 8.0591}:  20%|██        | 2/10 [00:11<00:49,  6.15s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9005, 'compress@10': 0.538, 'time@10': 7.216}:  20%|██        | 2/10 [00:14<00:49,  6.15s/it]  {'epoch': 24, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9005, 'compress@10': 0.538, 'time@10': 7.216}:  30%|███       | 3/10 [00:14<00:32,  4.62s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9064, 'compress@10': 0.5329, 'time@10': 7.0506}:  30%|███       | 3/10 [00:21<00:32,  4.62s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9064, 'compress@10': 0.5329, 'time@10': 7.0506}:  40%|████      | 4/10 [00:21<00:32,  5.40s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8989, 'compress@10': 0.5283, 'time@10': 8.4643}:  40%|████      | 4/10 [00:28<00:32,  5.40s/it] {'epoch': 24, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8989, 'compress@10': 0.5283, 'time@10': 8.4643}:  50%|█████     | 5/10 [00:28<00:30,  6.01s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9087, 'compress@10': 0.5255, 'time@10': 8.8006}:  50%|█████     | 5/10 [00:38<00:30,  6.01s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9087, 'compress@10': 0.5255, 'time@10': 8.8006}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0212, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9135, 'compress@10': 0.5247, 'time@10': 9.1503}:  60%|██████    | 6/10 [00:44<00:30,  7.54s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0212, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9135, 'compress@10': 0.5247, 'time@10': 9.1503}:  70%|███████   | 7/10 [00:44<00:20,  6.93s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9155, 'compress@10': 0.5234, 'time@10': 9.0272}:  70%|███████   | 7/10 [00:52<00:20,  6.93s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9155, 'compress@10': 0.5234, 'time@10': 9.0272}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9152, 'compress@10': 0.5224, 'time@10': 9.6307}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9152, 'compress@10': 0.5224, 'time@10': 9.6307}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9202, 'compress@10': 0.5213, 'time@10': 9.6814}:  90%|█████████ | 9/10 [01:10<00:07,  7.31s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9202, 'compress@10': 0.5213, 'time@10': 9.6814}: 100%|██████████| 10/10 [01:10<00:00,  8.20s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9202, 'compress@10': 0.5213, 'time@10': 9.6814}: 100%|██████████| 10/10 [01:10<00:00,  7.01s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.02316787285402612
Avg hit ratio: 0.8989925596003694
Avg ndcg: 0.9202240671782558
Avg compression ratio: 0.5212749006657823
Avg train time: 9.681380081176759
Std train time: 2.8557013565357017
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9028, 'compress@10': 0.5263, 'time@10': 8.7549}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9028, 'compress@10': 0.5263, 'time@10': 8.7549}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9227, 'compress@10': 0.5212, 'time@10': 7.9539}:  10%|█         | 1/10 [00:11<00:39,  4.41s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9227, 'compress@10': 0.5212, 'time@10': 7.9539}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9008, 'compress@10': 0.538, 'time@10': 7.2098}:  20%|██        | 2/10 [00:14<00:48,  6.05s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9008, 'compress@10': 0.538, 'time@10': 7.2098}:  30%|███       | 3/10 [00:14<00:32,  4.61s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9119, 'compress@10': 0.5329, 'time@10': 7.0842}:  30%|███       | 3/10 [00:21<00:32,  4.61s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9119, 'compress@10': 0.5329, 'time@10': 7.0842}:  40%|████      | 4/10 [00:21<00:32,  5.45s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9053, 'compress@10': 0.5283, 'time@10': 8.5728}:  40%|████      | 4/10 [00:28<00:32,  5.45s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9053, 'compress@10': 0.5283, 'time@10': 8.5728}:  50%|█████     | 5/10 [00:28<00:30,  6.12s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9134, 'compress@10': 0.5255, 'time@10': 8.9054}:  50%|█████     | 5/10 [00:39<00:30,  6.12s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9134, 'compress@10': 0.5255, 'time@10': 8.9054}:  60%|██████    | 6/10 [00:39<00:30,  7.65s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0205, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9114, 'compress@10': 0.5247, 'time@10': 9.2466}:  60%|██████    | 6/10 [00:44<00:30,  7.65s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0205, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9114, 'compress@10': 0.5247, 'time@10': 9.2466}:  70%|███████   | 7/10 [00:44<00:21,  7.00s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9146, 'compress@10': 0.5234, 'time@10': 9.0767}:  70%|███████   | 7/10 [00:52<00:21,  7.00s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9146, 'compress@10': 0.5234, 'time@10': 9.0767}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.89, 'ndcg@10': 0.92, 'compress@10': 0.5224, 'time@10': 9.6744}:  80%|████████  | 8/10 [01:00<00:14,  7.30s/it]   {'epoch': 25, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.89, 'ndcg@10': 0.92, 'compress@10': 0.5224, 'time@10': 9.6744}:  90%|█████████ | 9/10 [01:00<00:07,  7.29s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9246, 'compress@10': 0.5213, 'time@10': 9.7323}:  90%|█████████ | 9/10 [01:10<00:07,  7.29s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9246, 'compress@10': 0.5213, 'time@10': 9.7323}: 100%|██████████| 10/10 [01:10<00:00,  8.22s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9246, 'compress@10': 0.5213, 'time@10': 9.7323}: 100%|██████████| 10/10 [01:10<00:00,  7.03s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.018668622906935266
Avg hit ratio: 0.8987703373781473
Avg ndcg: 0.9245991197873327
Avg compression ratio: 0.5212749006657823
Avg train time: 9.732290720939636
Std train time: 2.914894563403633
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9028, 'compress@10': 0.5263, 'time@10': 8.5355}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9028, 'compress@10': 0.5263, 'time@10': 8.5355}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9305, 'compress@10': 0.5212, 'time@10': 7.8037}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9305, 'compress@10': 0.5212, 'time@10': 7.8037}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.906, 'compress@10': 0.538, 'time@10': 7.009}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]   {'epoch': 26, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.906, 'compress@10': 0.538, 'time@10': 7.009}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9167, 'compress@10': 0.5329, 'time@10': 6.8382}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9167, 'compress@10': 0.5329, 'time@10': 6.8382}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9102, 'compress@10': 0.5283, 'time@10': 8.2551}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it] {'epoch': 26, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9102, 'compress@10': 0.5283, 'time@10': 8.2551}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9193, 'compress@10': 0.5255, 'time@10': 8.6368}:  50%|█████     | 5/10 [00:38<00:29,  5.87s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9193, 'compress@10': 0.5255, 'time@10': 8.6368}:  60%|██████    | 6/10 [00:38<00:29,  7.47s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9215, 'compress@10': 0.5247, 'time@10': 9.0329}:  60%|██████    | 6/10 [00:43<00:29,  7.47s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9215, 'compress@10': 0.5247, 'time@10': 9.0329}:  70%|███████   | 7/10 [00:43<00:20,  6.91s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0165, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.923, 'compress@10': 0.5234, 'time@10': 8.9033}:  70%|███████   | 7/10 [00:51<00:20,  6.91s/it]  {'epoch': 26, 'num_users': 6.125, 'loss': 0.0165, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.923, 'compress@10': 0.5234, 'time@10': 8.9033}:  80%|████████  | 8/10 [00:51<00:14,  7.26s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9279, 'compress@10': 0.5224, 'time@10': 9.5491}:  80%|████████  | 8/10 [00:59<00:14,  7.26s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9279, 'compress@10': 0.5224, 'time@10': 9.5491}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9322, 'compress@10': 0.5213, 'time@10': 9.6064}:  90%|█████████ | 9/10 [01:09<00:07,  7.31s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9322, 'compress@10': 0.5213, 'time@10': 9.6064}: 100%|██████████| 10/10 [01:09<00:00,  8.19s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9322, 'compress@10': 0.5213, 'time@10': 9.6064}: 100%|██████████| 10/10 [01:09<00:00,  6.94s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.016083057512596026
Avg hit ratio: 0.8949096102916136
Avg ndcg: 0.9321773260202078
Avg compression ratio: 0.5212749006657823
Avg train time: 9.606375122070313
Std train time: 2.9596430715423163
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0237, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9028, 'compress@10': 0.5263, 'time@10': 8.6461}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0237, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9028, 'compress@10': 0.5263, 'time@10': 8.6461}:  10%|█         | 1/10 [00:04<00:40,  4.50s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9305, 'compress@10': 0.5212, 'time@10': 7.9243}:  10%|█         | 1/10 [00:11<00:40,  4.50s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9305, 'compress@10': 0.5212, 'time@10': 7.9243}:  20%|██        | 2/10 [00:11<00:48,  6.11s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9061, 'compress@10': 0.538, 'time@10': 7.0365}:  20%|██        | 2/10 [00:14<00:48,  6.11s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9061, 'compress@10': 0.538, 'time@10': 7.0365}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9168, 'compress@10': 0.5329, 'time@10': 6.843}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9168, 'compress@10': 0.5329, 'time@10': 6.843}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9109, 'compress@10': 0.5283, 'time@10': 8.3129}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9109, 'compress@10': 0.5283, 'time@10': 8.3129}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.019, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9231, 'compress@10': 0.5255, 'time@10': 8.6654}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.019, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9231, 'compress@10': 0.5255, 'time@10': 8.6654}:  60%|██████    | 6/10 [00:38<00:29,  7.46s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0194, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9225, 'compress@10': 0.5247, 'time@10': 9.0541}:  60%|██████    | 6/10 [00:44<00:29,  7.46s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0194, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9225, 'compress@10': 0.5247, 'time@10': 9.0541}:  70%|███████   | 7/10 [00:44<00:20,  6.90s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9261, 'compress@10': 0.5234, 'time@10': 8.9121}:  70%|███████   | 7/10 [00:51<00:20,  6.90s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9261, 'compress@10': 0.5234, 'time@10': 8.9121}:  80%|████████  | 8/10 [00:51<00:14,  7.23s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9325, 'compress@10': 0.5224, 'time@10': 9.5134}:  80%|████████  | 8/10 [00:59<00:14,  7.23s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9325, 'compress@10': 0.5224, 'time@10': 9.5134}:  90%|█████████ | 9/10 [00:59<00:07,  7.22s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.937, 'compress@10': 0.5213, 'time@10': 9.5971}:  90%|█████████ | 9/10 [01:09<00:07,  7.22s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.937, 'compress@10': 0.5213, 'time@10': 9.5971}: 100%|██████████| 10/10 [01:09<00:00,  8.20s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.937, 'compress@10': 0.5213, 'time@10': 9.5971}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.018902683926419382
Avg hit ratio: 0.9038497024575124
Avg ndcg: 0.9369639206066612
Avg compression ratio: 0.5212749006657823
Avg train time: 9.597104907035828
Std train time: 2.9545713956676574
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.905, 'compress@10': 0.5263, 'time@10': 8.522}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.905, 'compress@10': 0.5263, 'time@10': 8.522}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9321, 'compress@10': 0.5212, 'time@10': 7.958}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9321, 'compress@10': 0.5212, 'time@10': 7.958}:  20%|██        | 2/10 [00:11<00:49,  6.14s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9071, 'compress@10': 0.538, 'time@10': 7.1604}:  20%|██        | 2/10 [00:14<00:49,  6.14s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9071, 'compress@10': 0.538, 'time@10': 7.1604}:  30%|███       | 3/10 [00:14<00:32,  4.63s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9182, 'compress@10': 0.5329, 'time@10': 6.9725}:  30%|███       | 3/10 [00:21<00:32,  4.63s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9182, 'compress@10': 0.5329, 'time@10': 6.9725}:  40%|████      | 4/10 [00:21<00:32,  5.35s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9125, 'compress@10': 0.5283, 'time@10': 8.4049}:  40%|████      | 4/10 [00:28<00:32,  5.35s/it] {'epoch': 28, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9125, 'compress@10': 0.5283, 'time@10': 8.4049}:  50%|█████     | 5/10 [00:28<00:29,  5.98s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9212, 'compress@10': 0.5255, 'time@10': 8.7604}:  50%|█████     | 5/10 [00:38<00:29,  5.98s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9212, 'compress@10': 0.5255, 'time@10': 8.7604}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9233, 'compress@10': 0.5247, 'time@10': 9.1411}:  60%|██████    | 6/10 [00:44<00:30,  7.54s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9233, 'compress@10': 0.5247, 'time@10': 9.1411}:  70%|███████   | 7/10 [00:44<00:20,  6.96s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9227, 'compress@10': 0.5234, 'time@10': 9.008}:  70%|███████   | 7/10 [00:52<00:20,  6.96s/it]  {'epoch': 28, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9227, 'compress@10': 0.5234, 'time@10': 9.008}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9303, 'compress@10': 0.5224, 'time@10': 9.6306}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9303, 'compress@10': 0.5224, 'time@10': 9.6306}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9315, 'compress@10': 0.5213, 'time@10': 9.6855}:  90%|█████████ | 9/10 [01:10<00:07,  7.33s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9315, 'compress@10': 0.5213, 'time@10': 9.6855}: 100%|██████████| 10/10 [01:10<00:00,  8.22s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9315, 'compress@10': 0.5213, 'time@10': 9.6855}: 100%|██████████| 10/10 [01:10<00:00,  7.01s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.017573382288658988
Avg hit ratio: 0.8984016737836772
Avg ndcg: 0.9315189031849563
Avg compression ratio: 0.5212749006657823
Avg train time: 9.685460901260376
Std train time: 2.9149650218214265
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.905, 'compress@10': 0.5263, 'time@10': 8.5545}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.905, 'compress@10': 0.5263, 'time@10': 8.5545}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.933, 'compress@10': 0.5212, 'time@10': 7.9062}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.933, 'compress@10': 0.5212, 'time@10': 7.9062}:  20%|██        | 2/10 [00:11<00:48,  6.07s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9077, 'compress@10': 0.538, 'time@10': 7.0999}:  20%|██        | 2/10 [00:14<00:48,  6.07s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9077, 'compress@10': 0.538, 'time@10': 7.0999}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9186, 'compress@10': 0.5329, 'time@10': 6.9386}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9186, 'compress@10': 0.5329, 'time@10': 6.9386}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.913, 'compress@10': 0.5283, 'time@10': 8.403}:  40%|████      | 4/10 [00:28<00:31,  5.33s/it]  {'epoch': 29, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.913, 'compress@10': 0.5283, 'time@10': 8.403}:  50%|█████     | 5/10 [00:28<00:29,  5.99s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9219, 'compress@10': 0.5255, 'time@10': 8.745}:  50%|█████     | 5/10 [00:38<00:29,  5.99s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9219, 'compress@10': 0.5255, 'time@10': 8.745}:  60%|██████    | 6/10 [00:38<00:30,  7.52s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9247, 'compress@10': 0.5247, 'time@10': 9.1097}:  60%|██████    | 6/10 [00:44<00:30,  7.52s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9247, 'compress@10': 0.5247, 'time@10': 9.1097}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9253, 'compress@10': 0.5234, 'time@10': 8.9912}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9253, 'compress@10': 0.5234, 'time@10': 8.9912}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9321, 'compress@10': 0.5224, 'time@10': 9.6223}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9321, 'compress@10': 0.5224, 'time@10': 9.6223}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9362, 'compress@10': 0.5213, 'time@10': 9.6785}:  90%|█████████ | 9/10 [01:10<00:07,  7.34s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9362, 'compress@10': 0.5213, 'time@10': 9.6785}: 100%|██████████| 10/10 [01:10<00:00,  8.23s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9362, 'compress@10': 0.5213, 'time@10': 9.6785}: 100%|██████████| 10/10 [01:10<00:00,  7.00s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.01508806390372083
Avg hit ratio: 0.9042183660519824
Avg ndcg: 0.9361803195942262
Avg compression ratio: 0.5212749006657823
Avg train time: 9.678544402122498
Std train time: 2.946028160665317
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.905, 'compress@10': 0.5263, 'time@10': 8.6534}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.905, 'compress@10': 0.5263, 'time@10': 8.6534}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9316, 'compress@10': 0.5212, 'time@10': 7.8873}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9316, 'compress@10': 0.5212, 'time@10': 7.8873}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9068, 'compress@10': 0.538, 'time@10': 7.0331}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9068, 'compress@10': 0.538, 'time@10': 7.0331}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9184, 'compress@10': 0.5329, 'time@10': 6.88}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9184, 'compress@10': 0.5329, 'time@10': 6.88}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9142, 'compress@10': 0.5283, 'time@10': 8.3157}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9142, 'compress@10': 0.5283, 'time@10': 8.3157}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9266, 'compress@10': 0.5255, 'time@10': 8.7014}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9266, 'compress@10': 0.5255, 'time@10': 8.7014}:  60%|██████    | 6/10 [00:38<00:30,  7.53s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0177, 'hit_ratio@10': 0.9218, 'ndcg@10': 0.9285, 'compress@10': 0.5247, 'time@10': 9.0867}:  60%|██████    | 6/10 [00:44<00:30,  7.53s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0177, 'hit_ratio@10': 0.9218, 'ndcg@10': 0.9285, 'compress@10': 0.5247, 'time@10': 9.0867}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.928, 'ndcg@10': 0.9329, 'compress@10': 0.5234, 'time@10': 8.9686}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it]  {'epoch': 30, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.928, 'ndcg@10': 0.9329, 'compress@10': 0.5234, 'time@10': 8.9686}:  80%|████████  | 8/10 [00:52<00:14,  7.34s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9361, 'compress@10': 0.5224, 'time@10': 9.5952}:  80%|████████  | 8/10 [00:59<00:14,  7.34s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9361, 'compress@10': 0.5224, 'time@10': 9.5952}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.9144, 'ndcg@10': 0.9421, 'compress@10': 0.5213, 'time@10': 9.663}:  90%|█████████ | 9/10 [01:09<00:07,  7.34s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.9144, 'ndcg@10': 0.9421, 'compress@10': 0.5213, 'time@10': 9.663}: 100%|██████████| 10/10 [01:09<00:00,  8.26s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.9144, 'ndcg@10': 0.9421, 'compress@10': 0.5213, 'time@10': 9.663}: 100%|██████████| 10/10 [01:09<00:00,  7.00s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.01679220777886315
Avg hit ratio: 0.9144211310289407
Avg ndcg: 0.9421391198599212
Avg compression ratio: 0.5212749006657823
Avg train time: 9.663045573234559
Std train time: 2.953307409731579
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9152, 'compress@10': 0.5263, 'time@10': 8.8445}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9152, 'compress@10': 0.5263, 'time@10': 8.8445}:  10%|█         | 1/10 [00:04<00:40,  4.46s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9403, 'compress@10': 0.5212, 'time@10': 7.9749}:  10%|█         | 1/10 [00:11<00:40,  4.46s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9403, 'compress@10': 0.5212, 'time@10': 7.9749}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9126, 'compress@10': 0.538, 'time@10': 7.0726}:  20%|██        | 2/10 [00:14<00:48,  6.04s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9126, 'compress@10': 0.538, 'time@10': 7.0726}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9231, 'compress@10': 0.5329, 'time@10': 6.9566}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9231, 'compress@10': 0.5329, 'time@10': 6.9566}:  40%|████      | 4/10 [00:20<00:32,  5.35s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9193, 'compress@10': 0.5283, 'time@10': 8.4537}:  40%|████      | 4/10 [00:28<00:32,  5.35s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9193, 'compress@10': 0.5283, 'time@10': 8.4537}:  50%|█████     | 5/10 [00:28<00:30,  6.04s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9276, 'compress@10': 0.5255, 'time@10': 8.7884}:  50%|█████     | 5/10 [00:38<00:30,  6.04s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9276, 'compress@10': 0.5255, 'time@10': 8.7884}:  60%|██████    | 6/10 [00:38<00:30,  7.55s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0123, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.9285, 'compress@10': 0.5247, 'time@10': 9.1879}:  60%|██████    | 6/10 [00:44<00:30,  7.55s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0123, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.9285, 'compress@10': 0.5247, 'time@10': 9.1879}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9252, 'ndcg@10': 0.9294, 'compress@10': 0.5234, 'time@10': 9.0587}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9252, 'ndcg@10': 0.9294, 'compress@10': 0.5234, 'time@10': 9.0587}:  80%|████████  | 8/10 [00:52<00:14,  7.37s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9338, 'compress@10': 0.5224, 'time@10': 9.6718}:  80%|████████  | 8/10 [01:00<00:14,  7.37s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9338, 'compress@10': 0.5224, 'time@10': 9.6718}:  90%|█████████ | 9/10 [01:00<00:07,  7.36s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9369, 'compress@10': 0.5213, 'time@10': 9.7537}:  90%|█████████ | 9/10 [01:10<00:07,  7.36s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9369, 'compress@10': 0.5213, 'time@10': 9.7537}: 100%|██████████| 10/10 [01:10<00:00,  8.34s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9369, 'compress@10': 0.5213, 'time@10': 9.7537}: 100%|██████████| 10/10 [01:10<00:00,  7.05s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.013172190902904219
Avg hit ratio: 0.9179131945210044
Avg ndcg: 0.9368776879707209
Avg compression ratio: 0.5212749006657823
Avg train time: 9.753687214851379
Std train time: 3.0008031756964444
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 0.5263, 'time@10': 8.611}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 0.5263, 'time@10': 8.611}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9385, 'compress@10': 0.5212, 'time@10': 7.9168}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9385, 'compress@10': 0.5212, 'time@10': 7.9168}:  20%|██        | 2/10 [00:11<00:48,  6.06s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9114, 'compress@10': 0.538, 'time@10': 7.0544}:  20%|██        | 2/10 [00:14<00:48,  6.06s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9114, 'compress@10': 0.538, 'time@10': 7.0544}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9213, 'compress@10': 0.5329, 'time@10': 6.8976}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9213, 'compress@10': 0.5329, 'time@10': 6.8976}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.92, 'ndcg@10': 0.9186, 'compress@10': 0.5283, 'time@10': 8.3658}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]  {'epoch': 32, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.92, 'ndcg@10': 0.9186, 'compress@10': 0.5283, 'time@10': 8.3658}:  50%|█████     | 5/10 [00:27<00:29,  5.96s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.9296, 'ndcg@10': 0.9268, 'compress@10': 0.5255, 'time@10': 8.7174}:  50%|█████     | 5/10 [00:38<00:29,  5.96s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.9296, 'ndcg@10': 0.9268, 'compress@10': 0.5255, 'time@10': 8.7174}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.9339, 'ndcg@10': 0.9296, 'compress@10': 0.5247, 'time@10': 9.1088}:  60%|██████    | 6/10 [00:44<00:30,  7.51s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.9339, 'ndcg@10': 0.9296, 'compress@10': 0.5247, 'time@10': 9.1088}:  70%|███████   | 7/10 [00:44<00:20,  6.94s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9386, 'ndcg@10': 0.9278, 'compress@10': 0.5234, 'time@10': 8.9713}:  70%|███████   | 7/10 [00:52<00:20,  6.94s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9386, 'ndcg@10': 0.9278, 'compress@10': 0.5234, 'time@10': 8.9713}:  80%|████████  | 8/10 [00:52<00:14,  7.29s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.9169, 'ndcg@10': 0.9326, 'compress@10': 0.5224, 'time@10': 9.5621}:  80%|████████  | 8/10 [00:59<00:14,  7.29s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.9169, 'ndcg@10': 0.9326, 'compress@10': 0.5224, 'time@10': 9.5621}:  90%|█████████ | 9/10 [00:59<00:07,  7.26s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.9229, 'ndcg@10': 0.9366, 'compress@10': 0.5213, 'time@10': 9.6329}:  90%|█████████ | 9/10 [01:09<00:07,  7.26s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.9229, 'ndcg@10': 0.9366, 'compress@10': 0.5213, 'time@10': 9.6329}: 100%|██████████| 10/10 [01:09<00:00,  8.20s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.9229, 'ndcg@10': 0.9366, 'compress@10': 0.5213, 'time@10': 9.6329}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.012752333426637969
Avg hit ratio: 0.9229100953752905
Avg ndcg: 0.9366382913931025
Avg compression ratio: 0.5212749006657823
Avg train time: 9.632917237281799
Std train time: 2.926149989464825
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.5263, 'time@10': 8.7517}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.5263, 'time@10': 8.7517}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9419, 'compress@10': 0.5212, 'time@10': 7.9473}:  10%|█         | 1/10 [00:11<00:39,  4.41s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9419, 'compress@10': 0.5212, 'time@10': 7.9473}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9136, 'compress@10': 0.538, 'time@10': 7.1229}:  20%|██        | 2/10 [00:14<00:48,  6.04s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9136, 'compress@10': 0.538, 'time@10': 7.1229}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9225, 'compress@10': 0.5329, 'time@10': 6.9351}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9225, 'compress@10': 0.5329, 'time@10': 6.9351}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9211, 'compress@10': 0.5283, 'time@10': 8.3655}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9211, 'compress@10': 0.5283, 'time@10': 8.3655}:  50%|█████     | 5/10 [00:27<00:29,  5.93s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0173, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.936, 'compress@10': 0.5255, 'time@10': 8.7179}:  50%|█████     | 5/10 [00:38<00:29,  5.93s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0173, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.936, 'compress@10': 0.5255, 'time@10': 8.7179}:  60%|██████    | 6/10 [00:38<00:29,  7.49s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.9293, 'ndcg@10': 0.9369, 'compress@10': 0.5247, 'time@10': 9.1044}:  60%|██████    | 6/10 [00:44<00:29,  7.49s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.9293, 'ndcg@10': 0.9369, 'compress@10': 0.5247, 'time@10': 9.1044}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.9346, 'ndcg@10': 0.94, 'compress@10': 0.5234, 'time@10': 8.9723}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it]   {'epoch': 33, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.9346, 'ndcg@10': 0.94, 'compress@10': 0.5234, 'time@10': 8.9723}:  80%|████████  | 8/10 [00:52<00:14,  7.29s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9438, 'compress@10': 0.5224, 'time@10': 9.5941}:  80%|████████  | 8/10 [00:59<00:14,  7.29s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9438, 'compress@10': 0.5224, 'time@10': 9.5941}:  90%|█████████ | 9/10 [00:59<00:07,  7.30s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.9197, 'ndcg@10': 0.9466, 'compress@10': 0.5213, 'time@10': 9.662}:  90%|█████████ | 9/10 [01:09<00:07,  7.30s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.9197, 'ndcg@10': 0.9466, 'compress@10': 0.5213, 'time@10': 9.662}: 100%|██████████| 10/10 [01:09<00:00,  8.23s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.9197, 'ndcg@10': 0.9466, 'compress@10': 0.5213, 'time@10': 9.662}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.017649131504080744
Avg hit ratio: 0.9196842889236777
Avg ndcg: 0.9465566589294155
Avg compression ratio: 0.5212749006657823
Avg train time: 9.662042546272279
Std train time: 2.9316477284661016
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.5263, 'time@10': 8.5608}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.5263, 'time@10': 8.5608}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.943, 'compress@10': 0.5212, 'time@10': 7.9077}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.943, 'compress@10': 0.5212, 'time@10': 7.9077}:  20%|██        | 2/10 [00:11<00:48,  6.07s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9144, 'compress@10': 0.538, 'time@10': 7.0338}:  20%|██        | 2/10 [00:14<00:48,  6.07s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9144, 'compress@10': 0.538, 'time@10': 7.0338}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9254, 'compress@10': 0.5329, 'time@10': 6.9437}:  30%|███       | 3/10 [00:21<00:31,  4.52s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9254, 'compress@10': 0.5329, 'time@10': 6.9437}:  40%|████      | 4/10 [00:21<00:32,  5.39s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9252, 'compress@10': 0.5283, 'time@10': 8.4115}:  40%|████      | 4/10 [00:28<00:32,  5.39s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9252, 'compress@10': 0.5283, 'time@10': 8.4115}:  50%|█████     | 5/10 [00:28<00:30,  6.03s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9332, 'compress@10': 0.5255, 'time@10': 8.7691}:  50%|█████     | 5/10 [00:38<00:30,  6.03s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9332, 'compress@10': 0.5255, 'time@10': 8.7691}:  60%|██████    | 6/10 [00:38<00:30,  7.58s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9339, 'compress@10': 0.5247, 'time@10': 9.1544}:  60%|██████    | 6/10 [00:44<00:30,  7.58s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9339, 'compress@10': 0.5247, 'time@10': 9.1544}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9379, 'compress@10': 0.5234, 'time@10': 9.0167}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it]    {'epoch': 34, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9379, 'compress@10': 0.5234, 'time@10': 9.0167}:  80%|████████  | 8/10 [00:52<00:14,  7.34s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9579, 'compress@10': 0.5224, 'time@10': 9.659}:  80%|████████  | 8/10 [01:00<00:14,  7.34s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9579, 'compress@10': 0.5224, 'time@10': 9.659}:  90%|█████████ | 9/10 [01:00<00:07,  7.37s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9577, 'compress@10': 0.5213, 'time@10': 9.7026}:  90%|█████████ | 9/10 [01:10<00:07,  7.37s/it] {'epoch': 34, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9577, 'compress@10': 0.5213, 'time@10': 9.7026}: 100%|██████████| 10/10 [01:10<00:00,  8.22s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9577, 'compress@10': 0.5213, 'time@10': 9.7026}: 100%|██████████| 10/10 [01:10<00:00,  7.02s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.013491356442135848
Avg hit ratio: 0.8978307302959255
Avg ndcg: 0.9577399613232244
Avg compression ratio: 0.5212749006657823
Avg train time: 9.702595615386963
Std train time: 2.993916667290162
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.5263, 'time@10': 8.8183}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.5263, 'time@10': 8.8183}:  10%|█         | 1/10 [00:04<00:39,  4.44s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9424, 'compress@10': 0.5212, 'time@10': 8.017}:  10%|█         | 1/10 [00:11<00:39,  4.44s/it] {'epoch': 35, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9424, 'compress@10': 0.5212, 'time@10': 8.017}:  20%|██        | 2/10 [00:11<00:48,  6.10s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.914, 'compress@10': 0.538, 'time@10': 7.1196}:  20%|██        | 2/10 [00:14<00:48,  6.10s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.914, 'compress@10': 0.538, 'time@10': 7.1196}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9251, 'compress@10': 0.5329, 'time@10': 6.941}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9251, 'compress@10': 0.5329, 'time@10': 6.941}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9257, 'compress@10': 0.5283, 'time@10': 8.407}:  40%|████      | 4/10 [00:28<00:31,  5.29s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9257, 'compress@10': 0.5283, 'time@10': 8.407}:  50%|█████     | 5/10 [00:28<00:29,  5.97s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9336, 'compress@10': 0.5255, 'time@10': 8.7902}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9336, 'compress@10': 0.5255, 'time@10': 8.7902}:  60%|██████    | 6/10 [00:38<00:30,  7.59s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9357, 'compress@10': 0.5247, 'time@10': 9.152}:  60%|██████    | 6/10 [00:44<00:30,  7.59s/it] {'epoch': 35, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9357, 'compress@10': 0.5247, 'time@10': 9.152}:  70%|███████   | 7/10 [00:44<00:20,  6.97s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9356, 'compress@10': 0.5234, 'time@10': 9.0042}:  70%|███████   | 7/10 [00:52<00:20,  6.97s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9356, 'compress@10': 0.5234, 'time@10': 9.0042}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9378, 'compress@10': 0.5224, 'time@10': 9.6465}:  80%|████████  | 8/10 [00:59<00:14,  7.30s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9378, 'compress@10': 0.5224, 'time@10': 9.6465}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.9416, 'compress@10': 0.5213, 'time@10': 9.7237}:  90%|█████████ | 9/10 [01:10<00:07,  7.34s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.9416, 'compress@10': 0.5213, 'time@10': 9.7237}: 100%|██████████| 10/10 [01:10<00:00,  8.30s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.9416, 'compress@10': 0.5213, 'time@10': 9.7237}: 100%|██████████| 10/10 [01:10<00:00,  7.03s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.01566960099944305
Avg hit ratio: 0.9092593017244969
Avg ndcg: 0.9416324335738008
Avg compression ratio: 0.5212749006657823
Avg train time: 9.723656749725341
Std train time: 3.014031454701923
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.5263, 'time@10': 8.7502}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.5263, 'time@10': 8.7502}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9497, 'compress@10': 0.5212, 'time@10': 7.8983}:  10%|█         | 1/10 [00:11<00:39,  4.41s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9497, 'compress@10': 0.5212, 'time@10': 7.8983}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9188, 'compress@10': 0.538, 'time@10': 7.0321}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9188, 'compress@10': 0.538, 'time@10': 7.0321}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9273, 'compress@10': 0.5329, 'time@10': 6.8656}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9273, 'compress@10': 0.5329, 'time@10': 6.8656}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9284, 'compress@10': 0.5283, 'time@10': 8.3191}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9284, 'compress@10': 0.5283, 'time@10': 8.3191}:  50%|█████     | 5/10 [00:27<00:29,  5.91s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0152, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9429, 'compress@10': 0.5255, 'time@10': 8.7063}:  50%|█████     | 5/10 [00:38<00:29,  5.91s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0152, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9429, 'compress@10': 0.5255, 'time@10': 8.7063}:  60%|██████    | 6/10 [00:38<00:30,  7.53s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9438, 'compress@10': 0.5247, 'time@10': 9.0847}:  60%|██████    | 6/10 [00:44<00:30,  7.53s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9438, 'compress@10': 0.5247, 'time@10': 9.0847}:  70%|███████   | 7/10 [00:44<00:20,  6.94s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9454, 'compress@10': 0.5234, 'time@10': 8.9553}:  70%|███████   | 7/10 [00:52<00:20,  6.94s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9454, 'compress@10': 0.5234, 'time@10': 8.9553}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9562, 'compress@10': 0.5224, 'time@10': 9.5712}:  80%|████████  | 8/10 [00:59<00:14,  7.30s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9562, 'compress@10': 0.5224, 'time@10': 9.5712}:  90%|█████████ | 9/10 [00:59<00:07,  7.30s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9581, 'compress@10': 0.5213, 'time@10': 9.6396}:  90%|█████████ | 9/10 [01:09<00:07,  7.30s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9581, 'compress@10': 0.5213, 'time@10': 9.6396}: 100%|██████████| 10/10 [01:09<00:00,  8.22s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9581, 'compress@10': 0.5213, 'time@10': 9.6396}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.01651446120231822
Avg hit ratio: 0.914338666803862
Avg ndcg: 0.9581445432062328
Avg compression ratio: 0.5212749006657823
Avg train time: 9.63957998752594
Std train time: 2.9617528495324907
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.5263, 'time@10': 8.7683}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.5263, 'time@10': 8.7683}:  10%|█         | 1/10 [00:04<00:39,  4.42s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9459, 'compress@10': 0.5212, 'time@10': 8.0335}:  10%|█         | 1/10 [00:11<00:39,  4.42s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9459, 'compress@10': 0.5212, 'time@10': 8.0335}:  20%|██        | 2/10 [00:11<00:49,  6.14s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9163, 'compress@10': 0.538, 'time@10': 7.2244}:  20%|██        | 2/10 [00:14<00:49,  6.14s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9163, 'compress@10': 0.538, 'time@10': 7.2244}:  30%|███       | 3/10 [00:14<00:32,  4.63s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9269, 'compress@10': 0.5329, 'time@10': 7.0313}:  30%|███       | 3/10 [00:21<00:32,  4.63s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9269, 'compress@10': 0.5329, 'time@10': 7.0313}:  40%|████      | 4/10 [00:21<00:32,  5.36s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9283, 'compress@10': 0.5283, 'time@10': 8.4184}:  40%|████      | 4/10 [00:28<00:32,  5.36s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9283, 'compress@10': 0.5283, 'time@10': 8.4184}:  50%|█████     | 5/10 [00:28<00:29,  5.96s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9343, 'compress@10': 0.5255, 'time@10': 8.7707}:  50%|█████     | 5/10 [00:38<00:29,  5.96s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9343, 'compress@10': 0.5255, 'time@10': 8.7707}:  60%|██████    | 6/10 [00:38<00:30,  7.53s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.9348, 'compress@10': 0.5247, 'time@10': 9.1558}:  60%|██████    | 6/10 [00:44<00:30,  7.53s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.9348, 'compress@10': 0.5247, 'time@10': 9.1558}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0119, 'hit_ratio@10': 0.9152, 'ndcg@10': 0.9385, 'compress@10': 0.5234, 'time@10': 9.0235}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0119, 'hit_ratio@10': 0.9152, 'ndcg@10': 0.9385, 'compress@10': 0.5234, 'time@10': 9.0235}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9423, 'compress@10': 0.5224, 'time@10': 9.65}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it] {'epoch': 37, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9423, 'compress@10': 0.5224, 'time@10': 9.65}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9452, 'compress@10': 0.5213, 'time@10': 9.715}:  90%|█████████ | 9/10 [01:10<00:07,  7.34s/it]  {'epoch': 37, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9452, 'compress@10': 0.5213, 'time@10': 9.715}: 100%|██████████| 10/10 [01:10<00:00,  8.27s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9452, 'compress@10': 0.5213, 'time@10': 9.715}: 100%|██████████| 10/10 [01:10<00:00,  7.03s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.012733111792052476
Avg hit ratio: 0.9041799366451319
Avg ndcg: 0.9451635851099842
Avg compression ratio: 0.5212749006657823
Avg train time: 9.715027976036072
Std train time: 2.8898612153038767
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.5263, 'time@10': 8.9388}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.5263, 'time@10': 8.9388}:  10%|█         | 1/10 [00:04<00:40,  4.51s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.944, 'compress@10': 0.5212, 'time@10': 7.997}:  10%|█         | 1/10 [00:11<00:40,  4.51s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.944, 'compress@10': 0.5212, 'time@10': 7.997}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9151, 'compress@10': 0.538, 'time@10': 7.1528}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9151, 'compress@10': 0.538, 'time@10': 7.1528}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9259, 'compress@10': 0.5329, 'time@10': 6.9461}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9259, 'compress@10': 0.5329, 'time@10': 6.9461}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9282, 'compress@10': 0.5283, 'time@10': 8.4037}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9282, 'compress@10': 0.5283, 'time@10': 8.4037}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0081, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9359, 'compress@10': 0.5255, 'time@10': 8.7525}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0081, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9359, 'compress@10': 0.5255, 'time@10': 8.7525}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9383, 'compress@10': 0.5247, 'time@10': 9.1244}:  60%|██████    | 6/10 [00:44<00:30,  7.51s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9383, 'compress@10': 0.5247, 'time@10': 9.1244}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9352, 'compress@10': 0.5234, 'time@10': 8.9931}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9352, 'compress@10': 0.5234, 'time@10': 8.9931}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0088, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9374, 'compress@10': 0.5224, 'time@10': 9.6333}:  80%|████████  | 8/10 [00:59<00:14,  7.30s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0088, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9374, 'compress@10': 0.5224, 'time@10': 9.6333}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9475, 'compress@10': 0.5213, 'time@10': 9.6798}:  90%|█████████ | 9/10 [01:09<00:07,  7.33s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9475, 'compress@10': 0.5213, 'time@10': 9.6798}: 100%|██████████| 10/10 [01:09<00:00,  8.20s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9475, 'compress@10': 0.5213, 'time@10': 9.6798}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.010254102938738038
Avg hit ratio: 0.9064021588673541
Avg ndcg: 0.9474922969477511
Avg compression ratio: 0.5212749006657823
Avg train time: 9.679800987243652
Std train time: 2.986457264605368
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.5263, 'time@10': 8.4861}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.5263, 'time@10': 8.4861}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9505, 'compress@10': 0.5212, 'time@10': 7.8044}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9505, 'compress@10': 0.5212, 'time@10': 7.8044}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9194, 'compress@10': 0.538, 'time@10': 6.9609}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9194, 'compress@10': 0.538, 'time@10': 6.9609}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9292, 'compress@10': 0.5329, 'time@10': 6.8063}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9292, 'compress@10': 0.5329, 'time@10': 6.8063}:  40%|████      | 4/10 [00:20<00:31,  5.22s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.92, 'ndcg@10': 0.9307, 'compress@10': 0.5283, 'time@10': 8.255}:  40%|████      | 4/10 [00:27<00:31,  5.22s/it]   {'epoch': 39, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.92, 'ndcg@10': 0.9307, 'compress@10': 0.5283, 'time@10': 8.255}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.9259, 'ndcg@10': 0.9382, 'compress@10': 0.5255, 'time@10': 8.6264}:  50%|█████     | 5/10 [00:38<00:29,  5.89s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.9259, 'ndcg@10': 0.9382, 'compress@10': 0.5255, 'time@10': 8.6264}:  60%|██████    | 6/10 [00:38<00:29,  7.46s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9308, 'ndcg@10': 0.9404, 'compress@10': 0.5247, 'time@10': 9.0205}:  60%|██████    | 6/10 [00:43<00:29,  7.46s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9308, 'ndcg@10': 0.9404, 'compress@10': 0.5247, 'time@10': 9.0205}:  70%|███████   | 7/10 [00:43<00:20,  6.90s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9358, 'ndcg@10': 0.9433, 'compress@10': 0.5234, 'time@10': 8.8978}:  70%|███████   | 7/10 [00:51<00:20,  6.90s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9358, 'ndcg@10': 0.9433, 'compress@10': 0.5234, 'time@10': 8.8978}:  80%|████████  | 8/10 [00:51<00:14,  7.27s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.9207, 'ndcg@10': 0.9472, 'compress@10': 0.5224, 'time@10': 9.5523}:  80%|████████  | 8/10 [00:59<00:14,  7.27s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.9207, 'ndcg@10': 0.9472, 'compress@10': 0.5224, 'time@10': 9.5523}:  90%|█████████ | 9/10 [00:59<00:07,  7.32s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.9264, 'ndcg@10': 0.9502, 'compress@10': 0.5213, 'time@10': 9.6125}:  90%|█████████ | 9/10 [01:09<00:07,  7.32s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.9264, 'ndcg@10': 0.9502, 'compress@10': 0.5213, 'time@10': 9.6125}: 100%|██████████| 10/10 [01:09<00:00,  8.21s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.9264, 'ndcg@10': 0.9502, 'compress@10': 0.5213, 'time@10': 9.6125}: 100%|██████████| 10/10 [01:09<00:00,  6.95s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.010619878585613602
Avg hit ratio: 0.9264021588673541
Avg ndcg: 0.9502061800361931
Avg compression ratio: 0.5212749006657823
Avg train time: 9.612490582466126
Std train time: 3.0021722035868517
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.5263, 'time@10': 8.4392}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.5263, 'time@10': 8.4392}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9566, 'compress@10': 0.5212, 'time@10': 7.7753}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9566, 'compress@10': 0.5212, 'time@10': 7.7753}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9235, 'compress@10': 0.538, 'time@10': 6.9436}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9235, 'compress@10': 0.538, 'time@10': 6.9436}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9322, 'compress@10': 0.5329, 'time@10': 6.8312}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9322, 'compress@10': 0.5329, 'time@10': 6.8312}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9336, 'compress@10': 0.5283, 'time@10': 8.3125}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9336, 'compress@10': 0.5283, 'time@10': 8.3125}:  50%|█████     | 5/10 [00:27<00:29,  5.95s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0156, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9415, 'compress@10': 0.5255, 'time@10': 8.6437}:  50%|█████     | 5/10 [00:38<00:29,  5.95s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0156, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9415, 'compress@10': 0.5255, 'time@10': 8.6437}:  60%|██████    | 6/10 [00:38<00:29,  7.44s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9401, 'compress@10': 0.5247, 'time@10': 9.0293}:  60%|██████    | 6/10 [00:43<00:29,  7.44s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9401, 'compress@10': 0.5247, 'time@10': 9.0293}:  70%|███████   | 7/10 [00:43<00:20,  6.88s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.015, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9433, 'compress@10': 0.5234, 'time@10': 8.9096}:  70%|███████   | 7/10 [00:51<00:20,  6.88s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 0.015, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9433, 'compress@10': 0.5234, 'time@10': 8.9096}:  80%|████████  | 8/10 [00:51<00:14,  7.27s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9438, 'compress@10': 0.5224, 'time@10': 9.5156}:  80%|████████  | 8/10 [00:59<00:14,  7.27s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9438, 'compress@10': 0.5224, 'time@10': 9.5156}:  90%|█████████ | 9/10 [00:59<00:07,  7.25s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9463, 'compress@10': 0.5213, 'time@10': 9.6019}:  90%|█████████ | 9/10 [01:09<00:07,  7.25s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9463, 'compress@10': 0.5213, 'time@10': 9.6019}: 100%|██████████| 10/10 [01:09<00:00,  8.23s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9463, 'compress@10': 0.5213, 'time@10': 9.6019}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.015608230665046647
Avg hit ratio: 0.8870370795022747
Avg ndcg: 0.9462524981599788
Avg compression ratio: 0.5212749006657823
Avg train time: 9.60187895298004
Std train time: 2.94134052577818
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.5263, 'time@10': 8.5893}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.5263, 'time@10': 8.5893}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.947, 'compress@10': 0.5212, 'time@10': 7.8754}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.947, 'compress@10': 0.5212, 'time@10': 7.8754}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0045, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.917, 'compress@10': 0.538, 'time@10': 7.0469}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0045, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.917, 'compress@10': 0.538, 'time@10': 7.0469}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.928, 'compress@10': 0.5329, 'time@10': 6.8421}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.928, 'compress@10': 0.5329, 'time@10': 6.8421}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9318, 'compress@10': 0.5283, 'time@10': 8.328}:  40%|████      | 4/10 [00:27<00:31,  5.21s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9318, 'compress@10': 0.5283, 'time@10': 8.328}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0069, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9392, 'compress@10': 0.5255, 'time@10': 8.6995}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0069, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9392, 'compress@10': 0.5255, 'time@10': 8.6995}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0066, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9411, 'compress@10': 0.5247, 'time@10': 9.0902}:  60%|██████    | 6/10 [00:44<00:30,  7.51s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0066, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9411, 'compress@10': 0.5247, 'time@10': 9.0902}:  70%|███████   | 7/10 [00:44<00:20,  6.94s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.007, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9445, 'compress@10': 0.5234, 'time@10': 8.97}:  70%|███████   | 7/10 [00:52<00:20,  6.94s/it]     {'epoch': 41, 'num_users': 6.125, 'loss': 0.007, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9445, 'compress@10': 0.5234, 'time@10': 8.97}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0078, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9467, 'compress@10': 0.5224, 'time@10': 9.611}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0078, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9467, 'compress@10': 0.5224, 'time@10': 9.611}:  90%|█████████ | 9/10 [00:59<00:07,  7.35s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0077, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9496, 'compress@10': 0.5213, 'time@10': 9.6648}:  90%|█████████ | 9/10 [01:09<00:07,  7.35s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 0.0077, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9496, 'compress@10': 0.5213, 'time@10': 9.6648}: 100%|██████████| 10/10 [01:09<00:00,  8.23s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0077, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9496, 'compress@10': 0.5213, 'time@10': 9.6648}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.0077409455657272115
Avg hit ratio: 0.9036474225642307
Avg ndcg: 0.9496402108838563
Avg compression ratio: 0.5212749006657823
Avg train time: 9.664771962165833
Std train time: 3.0165845149368327
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.5263, 'time@10': 8.9342}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.5263, 'time@10': 8.9342}:  10%|█         | 1/10 [00:04<00:40,  4.50s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9502, 'compress@10': 0.5212, 'time@10': 8.0383}:  10%|█         | 1/10 [00:11<00:40,  4.50s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9502, 'compress@10': 0.5212, 'time@10': 8.0383}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9192, 'compress@10': 0.538, 'time@10': 7.128}:  20%|██        | 2/10 [00:14<00:48,  6.08s/it]  {'epoch': 42, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9192, 'compress@10': 0.538, 'time@10': 7.128}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.929, 'compress@10': 0.5329, 'time@10': 6.9728}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.929, 'compress@10': 0.5329, 'time@10': 6.9728}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.9323, 'compress@10': 0.5283, 'time@10': 8.4394}:  40%|████      | 4/10 [00:28<00:31,  5.33s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.9323, 'compress@10': 0.5283, 'time@10': 8.4394}:  50%|█████     | 5/10 [00:28<00:29,  6.00s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9396, 'compress@10': 0.5255, 'time@10': 8.7635}:  50%|█████     | 5/10 [00:38<00:29,  6.00s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9396, 'compress@10': 0.5255, 'time@10': 8.7635}:  60%|██████    | 6/10 [00:38<00:30,  7.50s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9412, 'compress@10': 0.5247, 'time@10': 9.1386}:  60%|██████    | 6/10 [00:44<00:30,  7.50s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9412, 'compress@10': 0.5247, 'time@10': 9.1386}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9407, 'compress@10': 0.5234, 'time@10': 9.0008}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9407, 'compress@10': 0.5234, 'time@10': 9.0008}:  80%|████████  | 8/10 [00:52<00:14,  7.29s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9436, 'compress@10': 0.5224, 'time@10': 9.5935}:  80%|████████  | 8/10 [00:59<00:14,  7.29s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9436, 'compress@10': 0.5224, 'time@10': 9.5935}:  90%|█████████ | 9/10 [00:59<00:07,  7.26s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9449, 'compress@10': 0.5213, 'time@10': 9.6471}:  90%|█████████ | 9/10 [01:09<00:07,  7.26s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9449, 'compress@10': 0.5213, 'time@10': 9.6471}: 100%|██████████| 10/10 [01:09<00:00,  8.16s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9449, 'compress@10': 0.5213, 'time@10': 9.6471}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.01230253421485375
Avg hit ratio: 0.8981993938903956
Avg ndcg: 0.944851959311174
Avg compression ratio: 0.5212749006657823
Avg train time: 9.647127056121827
Std train time: 2.925097274510678
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9285, 'compress@10': 0.5263, 'time@10': 8.4726}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9285, 'compress@10': 0.5263, 'time@10': 8.4726}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9548, 'compress@10': 0.5212, 'time@10': 7.8118}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9548, 'compress@10': 0.5212, 'time@10': 7.8118}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9222, 'compress@10': 0.538, 'time@10': 6.9952}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9222, 'compress@10': 0.538, 'time@10': 6.9952}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9313, 'compress@10': 0.5329, 'time@10': 6.8504}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9313, 'compress@10': 0.5329, 'time@10': 6.8504}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9348, 'compress@10': 0.5283, 'time@10': 8.3243}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]  {'epoch': 43, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9348, 'compress@10': 0.5283, 'time@10': 8.3243}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9423, 'compress@10': 0.5255, 'time@10': 8.7078}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9423, 'compress@10': 0.5255, 'time@10': 8.7078}:  60%|██████    | 6/10 [00:38<00:30,  7.55s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9438, 'compress@10': 0.5247, 'time@10': 9.0897}:  60%|██████    | 6/10 [00:44<00:30,  7.55s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9438, 'compress@10': 0.5247, 'time@10': 9.0897}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9464, 'compress@10': 0.5234, 'time@10': 8.9576}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9464, 'compress@10': 0.5234, 'time@10': 8.9576}:  80%|████████  | 8/10 [00:52<00:14,  7.31s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9477, 'compress@10': 0.5224, 'time@10': 9.5718}:  80%|████████  | 8/10 [00:59<00:14,  7.31s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9477, 'compress@10': 0.5224, 'time@10': 9.5718}:  90%|█████████ | 9/10 [00:59<00:07,  7.30s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0098, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9506, 'compress@10': 0.5213, 'time@10': 9.6436}:  90%|█████████ | 9/10 [01:09<00:07,  7.30s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0098, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9506, 'compress@10': 0.5213, 'time@10': 9.6436}: 100%|██████████| 10/10 [01:09<00:00,  8.23s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0098, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9506, 'compress@10': 0.5213, 'time@10': 9.6436}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.009828535433384175
Avg hit ratio: 0.8911128603522492
Avg ndcg: 0.9506020485589145
Avg compression ratio: 0.5212749006657823
Avg train time: 9.643630194664002
Std train time: 2.9615888227076064
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9234, 'compress@10': 0.5263, 'time@10': 8.5116}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9234, 'compress@10': 0.5263, 'time@10': 8.5116}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0063, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9456, 'compress@10': 0.5212, 'time@10': 7.9112}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0063, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9456, 'compress@10': 0.5212, 'time@10': 7.9112}:  20%|██        | 2/10 [00:11<00:48,  6.09s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0044, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9161, 'compress@10': 0.538, 'time@10': 7.0668}:  20%|██        | 2/10 [00:14<00:48,  6.09s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0044, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9161, 'compress@10': 0.538, 'time@10': 7.0668}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.9267, 'compress@10': 0.5329, 'time@10': 6.8882}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.9267, 'compress@10': 0.5329, 'time@10': 6.8882}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9314, 'compress@10': 0.5283, 'time@10': 8.3456}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9314, 'compress@10': 0.5283, 'time@10': 8.3456}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9364, 'compress@10': 0.5255, 'time@10': 8.7003}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9364, 'compress@10': 0.5255, 'time@10': 8.7003}:  60%|██████    | 6/10 [00:38<00:29,  7.50s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9375, 'compress@10': 0.5247, 'time@10': 9.0802}:  60%|██████    | 6/10 [00:44<00:29,  7.50s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9375, 'compress@10': 0.5247, 'time@10': 9.0802}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9408, 'compress@10': 0.5234, 'time@10': 8.9486}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9408, 'compress@10': 0.5234, 'time@10': 8.9486}:  80%|████████  | 8/10 [00:52<00:14,  7.28s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9437, 'compress@10': 0.5224, 'time@10': 9.5503}:  80%|████████  | 8/10 [00:59<00:14,  7.28s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9437, 'compress@10': 0.5224, 'time@10': 9.5503}:  90%|█████████ | 9/10 [00:59<00:07,  7.26s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0097, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9468, 'compress@10': 0.5213, 'time@10': 9.602}:  90%|█████████ | 9/10 [01:09<00:07,  7.26s/it]    {'epoch': 44, 'num_users': 6.3, 'loss': 0.0097, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9468, 'compress@10': 0.5213, 'time@10': 9.602}: 100%|██████████| 10/10 [01:09<00:00,  8.14s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0097, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9468, 'compress@10': 0.5213, 'time@10': 9.602}: 100%|██████████| 10/10 [01:09<00:00,  6.95s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.009745417329367383
Avg hit ratio: 0.8957109146277228
Avg ndcg: 0.9467670247955198
Avg compression ratio: 0.5212749006657823
Avg train time: 9.602014708518983
Std train time: 2.914988776739547
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9097, 'compress@10': 0.5263, 'time@10': 8.5757}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9097, 'compress@10': 0.5263, 'time@10': 8.5757}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9487, 'compress@10': 0.5212, 'time@10': 7.8545}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9487, 'compress@10': 0.5212, 'time@10': 7.8545}:  20%|██        | 2/10 [00:11<00:48,  6.00s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9182, 'compress@10': 0.538, 'time@10': 7.0473}:  20%|██        | 2/10 [00:14<00:48,  6.00s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9182, 'compress@10': 0.538, 'time@10': 7.0473}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9282, 'compress@10': 0.5329, 'time@10': 6.9114}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9282, 'compress@10': 0.5329, 'time@10': 6.9114}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9333, 'compress@10': 0.5283, 'time@10': 8.371}:  40%|████      | 4/10 [00:27<00:31,  5.32s/it] {'epoch': 45, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9333, 'compress@10': 0.5283, 'time@10': 8.371}:  50%|█████     | 5/10 [00:27<00:29,  5.98s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9404, 'compress@10': 0.5255, 'time@10': 8.7267}:  50%|█████     | 5/10 [00:38<00:29,  5.98s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9404, 'compress@10': 0.5255, 'time@10': 8.7267}:  60%|██████    | 6/10 [00:38<00:30,  7.53s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9426, 'compress@10': 0.5247, 'time@10': 9.138}:  60%|██████    | 6/10 [00:44<00:30,  7.53s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9426, 'compress@10': 0.5247, 'time@10': 9.138}:  70%|███████   | 7/10 [00:44<00:20,  6.98s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9455, 'compress@10': 0.5234, 'time@10': 9.0003}:  70%|███████   | 7/10 [00:52<00:20,  6.98s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9455, 'compress@10': 0.5234, 'time@10': 9.0003}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9474, 'compress@10': 0.5224, 'time@10': 9.6364}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it] {'epoch': 45, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9474, 'compress@10': 0.5224, 'time@10': 9.6364}:  90%|█████████ | 9/10 [00:59<00:07,  7.35s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9515, 'compress@10': 0.5213, 'time@10': 9.7025}:  90%|█████████ | 9/10 [01:10<00:07,  7.35s/it] {'epoch': 45, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9515, 'compress@10': 0.5213, 'time@10': 9.7025}: 100%|██████████| 10/10 [01:10<00:00,  8.27s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9515, 'compress@10': 0.5213, 'time@10': 9.7025}: 100%|██████████| 10/10 [01:10<00:00,  7.01s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.010258366259138426
Avg hit ratio: 0.9006878731530683
Avg ndcg: 0.9515014269313975
Avg compression ratio: 0.5212749006657823
Avg train time: 9.702487516403199
Std train time: 2.9877526878489835
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9234, 'compress@10': 0.5263, 'time@10': 8.335}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9234, 'compress@10': 0.5263, 'time@10': 8.335}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9557, 'compress@10': 0.5212, 'time@10': 7.709}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9557, 'compress@10': 0.5212, 'time@10': 7.709}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9228, 'compress@10': 0.538, 'time@10': 6.889}:  20%|██        | 2/10 [00:13<00:47,  5.92s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9228, 'compress@10': 0.538, 'time@10': 6.889}:  30%|███       | 3/10 [00:13<00:31,  4.43s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9323, 'compress@10': 0.5329, 'time@10': 6.7932}:  30%|███       | 3/10 [00:20<00:31,  4.43s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9323, 'compress@10': 0.5329, 'time@10': 6.7932}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9366, 'compress@10': 0.5283, 'time@10': 8.3027}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9366, 'compress@10': 0.5283, 'time@10': 8.3027}:  50%|█████     | 5/10 [00:27<00:29,  5.97s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0081, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9433, 'compress@10': 0.5255, 'time@10': 8.6769}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0081, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9433, 'compress@10': 0.5255, 'time@10': 8.6769}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9445, 'compress@10': 0.5247, 'time@10': 9.0962}:  60%|██████    | 6/10 [00:44<00:30,  7.54s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9445, 'compress@10': 0.5247, 'time@10': 9.0962}:  70%|███████   | 7/10 [00:44<00:20,  6.98s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0088, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9478, 'compress@10': 0.5234, 'time@10': 8.9549}:  70%|███████   | 7/10 [00:52<00:20,  6.98s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0088, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9478, 'compress@10': 0.5234, 'time@10': 8.9549}:  80%|████████  | 8/10 [00:52<00:14,  7.31s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0096, 'hit_ratio@10': 0.877, 'ndcg@10': 0.95, 'compress@10': 0.5224, 'time@10': 9.5793}:  80%|████████  | 8/10 [00:59<00:14,  7.31s/it]  {'epoch': 46, 'num_users': 6.3333, 'loss': 0.0096, 'hit_ratio@10': 0.877, 'ndcg@10': 0.95, 'compress@10': 0.5224, 'time@10': 9.5793}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9547, 'compress@10': 0.5213, 'time@10': 9.629}:  90%|█████████ | 9/10 [01:09<00:07,  7.31s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9547, 'compress@10': 0.5213, 'time@10': 9.629}: 100%|██████████| 10/10 [01:09<00:00,  8.18s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9547, 'compress@10': 0.5213, 'time@10': 9.629}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.01104761259979702
Avg hit ratio: 0.8870370795022747
Avg ndcg: 0.9547037877737671
Avg compression ratio: 0.5212749006657823
Avg train time: 9.62900185585022
Std train time: 3.024781395739631
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9176, 'compress@10': 0.5263, 'time@10': 8.4494}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9176, 'compress@10': 0.5263, 'time@10': 8.4494}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9427, 'compress@10': 0.5212, 'time@10': 7.7911}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9427, 'compress@10': 0.5212, 'time@10': 7.7911}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9142, 'compress@10': 0.538, 'time@10': 7.0453}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9142, 'compress@10': 0.538, 'time@10': 7.0453}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.9258, 'compress@10': 0.5329, 'time@10': 6.8721}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.9258, 'compress@10': 0.5329, 'time@10': 6.8721}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9325, 'compress@10': 0.5283, 'time@10': 8.2885}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9325, 'compress@10': 0.5283, 'time@10': 8.2885}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9473, 'compress@10': 0.5255, 'time@10': 8.6469}:  50%|█████     | 5/10 [00:38<00:29,  5.90s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9473, 'compress@10': 0.5255, 'time@10': 8.6469}:  60%|██████    | 6/10 [00:38<00:29,  7.45s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9482, 'compress@10': 0.5247, 'time@10': 9.0557}:  60%|██████    | 6/10 [00:43<00:29,  7.45s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9482, 'compress@10': 0.5247, 'time@10': 9.0557}:  70%|███████   | 7/10 [00:43<00:20,  6.91s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9502, 'compress@10': 0.5234, 'time@10': 8.9519}:  70%|███████   | 7/10 [00:52<00:20,  6.91s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9502, 'compress@10': 0.5234, 'time@10': 8.9519}:  80%|████████  | 8/10 [00:52<00:14,  7.34s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9653, 'compress@10': 0.5224, 'time@10': 9.5791}:  80%|████████  | 8/10 [00:59<00:14,  7.34s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9653, 'compress@10': 0.5224, 'time@10': 9.5791}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9664, 'compress@10': 0.5213, 'time@10': 9.6402}:  90%|█████████ | 9/10 [01:09<00:07,  7.34s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9664, 'compress@10': 0.5213, 'time@10': 9.6402}: 100%|██████████| 10/10 [01:09<00:00,  8.23s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9664, 'compress@10': 0.5213, 'time@10': 9.6402}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.013732607232432439
Avg hit ratio: 0.8928537717705799
Avg ndcg: 0.9663505645545156
Avg compression ratio: 0.5212749006657823
Avg train time: 9.640175390243531
Std train time: 2.9124631698382824
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0046, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 0.5263, 'time@10': 8.4965}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0046, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 0.5263, 'time@10': 8.4965}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9645, 'compress@10': 0.5212, 'time@10': 7.9167}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9645, 'compress@10': 0.5212, 'time@10': 7.9167}:  20%|██        | 2/10 [00:11<00:48,  6.11s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9287, 'compress@10': 0.538, 'time@10': 7.1204}:  20%|██        | 2/10 [00:14<00:48,  6.11s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9287, 'compress@10': 0.538, 'time@10': 7.1204}:  30%|███       | 3/10 [00:14<00:32,  4.60s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9362, 'compress@10': 0.5329, 'time@10': 6.9741}:  30%|███       | 3/10 [00:21<00:32,  4.60s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9362, 'compress@10': 0.5329, 'time@10': 6.9741}:  40%|████      | 4/10 [00:21<00:32,  5.38s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9408, 'compress@10': 0.5283, 'time@10': 8.3393}:  40%|████      | 4/10 [00:27<00:32,  5.38s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9408, 'compress@10': 0.5283, 'time@10': 8.3393}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9468, 'compress@10': 0.5255, 'time@10': 8.714}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9468, 'compress@10': 0.5255, 'time@10': 8.714}:  60%|██████    | 6/10 [00:38<00:30,  7.53s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0081, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9485, 'compress@10': 0.5247, 'time@10': 9.1281}:  60%|██████    | 6/10 [00:44<00:30,  7.53s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0081, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9485, 'compress@10': 0.5247, 'time@10': 9.1281}:  70%|███████   | 7/10 [00:44<00:20,  6.98s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.008, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9505, 'compress@10': 0.5234, 'time@10': 9.0177}:  70%|███████   | 7/10 [00:52<00:20,  6.98s/it]  {'epoch': 48, 'num_users': 6.125, 'loss': 0.008, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9505, 'compress@10': 0.5234, 'time@10': 9.0177}:  80%|████████  | 8/10 [00:52<00:14,  7.40s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9422, 'compress@10': 0.5224, 'time@10': 9.618}:  80%|████████  | 8/10 [00:59<00:14,  7.40s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9422, 'compress@10': 0.5224, 'time@10': 9.618}:  90%|█████████ | 9/10 [00:59<00:07,  7.35s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9456, 'compress@10': 0.5213, 'time@10': 9.6563}:  90%|█████████ | 9/10 [01:10<00:07,  7.35s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9456, 'compress@10': 0.5213, 'time@10': 9.6563}: 100%|██████████| 10/10 [01:10<00:00,  8.18s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9456, 'compress@10': 0.5213, 'time@10': 9.6563}: 100%|██████████| 10/10 [01:10<00:00,  7.00s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.01154892646429446
Avg hit ratio: 0.894338666803862
Avg ndcg: 0.9456270073243893
Avg compression ratio: 0.5212749006657823
Avg train time: 9.656345653533936
Std train time: 2.831685147273325
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.5263, 'time@10': 8.5539}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.5263, 'time@10': 8.5539}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9483, 'compress@10': 0.5212, 'time@10': 7.7187}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it] {'epoch': 49, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9483, 'compress@10': 0.5212, 'time@10': 7.7187}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9179, 'compress@10': 0.538, 'time@10': 6.9537}:  20%|██        | 2/10 [00:13<00:46,  5.85s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9179, 'compress@10': 0.538, 'time@10': 6.9537}:  30%|███       | 3/10 [00:13<00:31,  4.43s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9285, 'compress@10': 0.5329, 'time@10': 6.7485}:  30%|███       | 3/10 [00:20<00:31,  4.43s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9285, 'compress@10': 0.5329, 'time@10': 6.7485}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9348, 'compress@10': 0.5283, 'time@10': 8.1325}:  40%|████      | 4/10 [00:27<00:30,  5.12s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9348, 'compress@10': 0.5283, 'time@10': 8.1325}:  50%|█████     | 5/10 [00:27<00:28,  5.75s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9416, 'compress@10': 0.5255, 'time@10': 8.4876}:  50%|█████     | 5/10 [00:37<00:28,  5.75s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9416, 'compress@10': 0.5255, 'time@10': 8.4876}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9434, 'compress@10': 0.5247, 'time@10': 8.8424}:  60%|██████    | 6/10 [00:42<00:29,  7.30s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9434, 'compress@10': 0.5247, 'time@10': 8.8424}:  70%|███████   | 7/10 [00:42<00:20,  6.72s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.007, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9467, 'compress@10': 0.5234, 'time@10': 8.7265}:  70%|███████   | 7/10 [00:50<00:20,  6.72s/it]  {'epoch': 49, 'num_users': 6.125, 'loss': 0.007, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9467, 'compress@10': 0.5234, 'time@10': 8.7265}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9492, 'compress@10': 0.5224, 'time@10': 9.3686}:  80%|████████  | 8/10 [00:58<00:14,  7.11s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9492, 'compress@10': 0.5224, 'time@10': 9.3686}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9514, 'compress@10': 0.5213, 'time@10': 9.4343}:  90%|█████████ | 9/10 [01:08<00:07,  7.16s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9514, 'compress@10': 0.5213, 'time@10': 9.4343}: 100%|██████████| 10/10 [01:08<00:00,  8.06s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9514, 'compress@10': 0.5213, 'time@10': 9.4343}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.010921983752087343
Avg hit ratio: 0.8925414317808207
Avg ndcg: 0.9513679609238942
Avg compression ratio: 0.5212749006657823
Avg train time: 9.434300088882447
Std train time: 2.891654042986297
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
