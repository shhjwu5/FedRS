  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2313, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.4914, 'compress@10': 0.0536, 'time@10': 5.722}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2313, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.4914, 'compress@10': 0.0536, 'time@10': 5.722}:  10%|█         | 1/10 [00:02<00:26,  2.91s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.164, 'hit_ratio@10': 0.539, 'ndcg@10': 0.5574, 'compress@10': 0.0434, 'time@10': 4.9512}:  10%|█         | 1/10 [00:07<00:26,  2.91s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.164, 'hit_ratio@10': 0.539, 'ndcg@10': 0.5574, 'compress@10': 0.0434, 'time@10': 4.9512}:  20%|██        | 2/10 [00:07<00:29,  3.68s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9138, 'hit_ratio@10': 0.5022, 'ndcg@10': 0.3716, 'compress@10': 0.0769, 'time@10': 3.8564}:  20%|██        | 2/10 [00:08<00:29,  3.68s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9138, 'hit_ratio@10': 0.5022, 'ndcg@10': 0.3716, 'compress@10': 0.0769, 'time@10': 3.8564}:  30%|███       | 3/10 [00:08<00:16,  2.40s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7206, 'hit_ratio@10': 0.5463, 'ndcg@10': 0.4199, 'compress@10': 0.0669, 'time@10': 3.814}:  30%|███       | 3/10 [00:11<00:16,  2.40s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.7206, 'hit_ratio@10': 0.5463, 'ndcg@10': 0.4199, 'compress@10': 0.0669, 'time@10': 3.814}:  40%|████      | 4/10 [00:11<00:17,  2.92s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5956, 'hit_ratio@10': 0.601, 'ndcg@10': 0.4839, 'compress@10': 0.0576, 'time@10': 5.7791}:  40%|████      | 4/10 [00:18<00:17,  2.92s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5956, 'hit_ratio@10': 0.601, 'ndcg@10': 0.4839, 'compress@10': 0.0576, 'time@10': 5.7791}:  50%|█████     | 5/10 [00:18<00:21,  4.34s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5111, 'hit_ratio@10': 0.6157, 'ndcg@10': 0.5298, 'compress@10': 0.0519, 'time@10': 5.8352}:  50%|█████     | 5/10 [00:24<00:21,  4.34s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5111, 'hit_ratio@10': 0.6157, 'ndcg@10': 0.5298, 'compress@10': 0.0519, 'time@10': 5.8352}:  60%|██████    | 6/10 [00:24<00:19,  4.96s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4595, 'hit_ratio@10': 0.6134, 'ndcg@10': 0.5291, 'compress@10': 0.0503, 'time@10': 5.9475}:  60%|██████    | 6/10 [00:28<00:19,  4.96s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4595, 'hit_ratio@10': 0.6134, 'ndcg@10': 0.5291, 'compress@10': 0.0503, 'time@10': 5.9475}:  70%|███████   | 7/10 [00:28<00:13,  4.43s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.4104, 'hit_ratio@10': 0.6511, 'ndcg@10': 0.5533, 'compress@10': 0.0477, 'time@10': 5.7921}:  70%|███████   | 7/10 [00:32<00:13,  4.43s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.4104, 'hit_ratio@10': 0.6511, 'ndcg@10': 0.5533, 'compress@10': 0.0477, 'time@10': 5.7921}:  80%|████████  | 8/10 [00:32<00:09,  4.53s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3736, 'hit_ratio@10': 0.6581, 'ndcg@10': 0.5895, 'compress@10': 0.0457, 'time@10': 6.1964}:  80%|████████  | 8/10 [00:37<00:09,  4.53s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3736, 'hit_ratio@10': 0.6581, 'ndcg@10': 0.5895, 'compress@10': 0.0457, 'time@10': 6.1964}:  90%|█████████ | 9/10 [00:37<00:04,  4.60s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3425, 'hit_ratio@10': 0.6855, 'ndcg@10': 0.6064, 'compress@10': 0.0435, 'time@10': 6.1711}:  90%|█████████ | 9/10 [00:43<00:04,  4.60s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3425, 'hit_ratio@10': 0.6855, 'ndcg@10': 0.6064, 'compress@10': 0.0435, 'time@10': 6.1711}: 100%|██████████| 10/10 [00:43<00:00,  5.03s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3425, 'hit_ratio@10': 0.6855, 'ndcg@10': 0.6064, 'compress@10': 0.0435, 'time@10': 6.1711}: 100%|██████████| 10/10 [00:43<00:00,  4.36s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3425170803757291
Avg hit ratio: 0.6854519828407775
Avg ndcg: 0.6064024923785053
Avg compression ratio: 0.043453084136524135
Avg train time: 6.1710820436477665
Std train time: 3.1532437365635184
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0623, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.7853, 'compress@10': 0.0534, 'time@10': 4.3481}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0623, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.7853, 'compress@10': 0.0534, 'time@10': 4.3481}:  10%|█         | 1/10 [00:02<00:19,  2.22s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0583, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8213, 'compress@10': 0.0432, 'time@10': 4.2778}:  10%|█         | 1/10 [00:06<00:19,  2.22s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0583, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8213, 'compress@10': 0.0432, 'time@10': 4.2778}:  20%|██        | 2/10 [00:06<00:27,  3.41s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0534, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.7508, 'compress@10': 0.0766, 'time@10': 3.4503}:  20%|██        | 2/10 [00:07<00:27,  3.41s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0534, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.7508, 'compress@10': 0.0766, 'time@10': 3.4503}:  30%|███       | 3/10 [00:07<00:15,  2.28s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.053, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.7745, 'compress@10': 0.0666, 'time@10': 3.5079}:  30%|███       | 3/10 [00:11<00:15,  2.28s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.053, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.7745, 'compress@10': 0.0666, 'time@10': 3.5079}:  40%|████      | 4/10 [00:11<00:17,  2.85s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.06, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.7762, 'compress@10': 0.0574, 'time@10': 5.2525}:  40%|████      | 4/10 [00:17<00:17,  2.85s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.06, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.7762, 'compress@10': 0.0574, 'time@10': 5.2525}:  50%|█████     | 5/10 [00:17<00:20,  4.04s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0631, 'hit_ratio@10': 0.7877, 'ndcg@10': 0.7825, 'compress@10': 0.0516, 'time@10': 5.4003}:  50%|█████     | 5/10 [00:23<00:20,  4.04s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0631, 'hit_ratio@10': 0.7877, 'ndcg@10': 0.7825, 'compress@10': 0.0516, 'time@10': 5.4003}:  60%|██████    | 6/10 [00:23<00:19,  4.77s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0605, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.7946, 'compress@10': 0.05, 'time@10': 5.5694}:  60%|██████    | 6/10 [00:26<00:19,  4.77s/it]  {'epoch': 1, 'num_users': 6.2857, 'loss': 0.0605, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.7946, 'compress@10': 0.05, 'time@10': 5.5694}:  70%|███████   | 7/10 [00:26<00:12,  4.30s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0577, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8046, 'compress@10': 0.0474, 'time@10': 5.4812}:  70%|███████   | 7/10 [00:31<00:12,  4.30s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0577, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8046, 'compress@10': 0.0474, 'time@10': 5.4812}:  80%|████████  | 8/10 [00:31<00:08,  4.49s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0553, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.8174, 'compress@10': 0.0454, 'time@10': 5.8233}:  80%|████████  | 8/10 [00:36<00:08,  4.49s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0553, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.8174, 'compress@10': 0.0454, 'time@10': 5.8233}:  90%|█████████ | 9/10 [00:36<00:04,  4.44s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0545, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8206, 'compress@10': 0.0432, 'time@10': 5.8276}:  90%|█████████ | 9/10 [00:41<00:04,  4.44s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0545, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8206, 'compress@10': 0.0432, 'time@10': 5.8276}: 100%|██████████| 10/10 [00:41<00:00,  4.89s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0545, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8206, 'compress@10': 0.0432, 'time@10': 5.8276}: 100%|██████████| 10/10 [00:41<00:00,  4.19s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05447799901906044
Avg hit ratio: 0.8217810312682978
Avg ndcg: 0.8205934157199394
Avg compression ratio: 0.04321652611392811
Avg train time: 5.8275548934936525
Std train time: 2.7522280892381366
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8456, 'compress@10': 0.0532, 'time@10': 5.3633}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8456, 'compress@10': 0.0532, 'time@10': 5.3633}:  10%|█         | 1/10 [00:02<00:24,  2.72s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8511, 'compress@10': 0.043, 'time@10': 4.7729}:  10%|█         | 1/10 [00:06<00:24,  2.72s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8511, 'compress@10': 0.043, 'time@10': 4.7729}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.851, 'compress@10': 0.0764, 'time@10': 3.8382}:  20%|██        | 2/10 [00:07<00:28,  3.60s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.851, 'compress@10': 0.0764, 'time@10': 3.8382}:  30%|███       | 3/10 [00:07<00:16,  2.43s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0394, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8496, 'compress@10': 0.0664, 'time@10': 3.7973}:  30%|███       | 3/10 [00:11<00:16,  2.43s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0394, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8496, 'compress@10': 0.0664, 'time@10': 3.7973}:  40%|████      | 4/10 [00:11<00:17,  2.93s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.049, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8375, 'compress@10': 0.0573, 'time@10': 5.2287}:  40%|████      | 4/10 [00:17<00:17,  2.93s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.049, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8375, 'compress@10': 0.0573, 'time@10': 5.2287}:  50%|█████     | 5/10 [00:17<00:19,  3.87s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0534, 'hit_ratio@10': 0.7874, 'ndcg@10': 0.834, 'compress@10': 0.0516, 'time@10': 5.3796}:  50%|█████     | 5/10 [00:23<00:19,  3.87s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0534, 'hit_ratio@10': 0.7874, 'ndcg@10': 0.834, 'compress@10': 0.0516, 'time@10': 5.3796}:  60%|██████    | 6/10 [00:23<00:18,  4.65s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0518, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8381, 'compress@10': 0.05, 'time@10': 5.5682}:  60%|██████    | 6/10 [00:26<00:18,  4.65s/it]  {'epoch': 2, 'num_users': 6.2857, 'loss': 0.0518, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8381, 'compress@10': 0.05, 'time@10': 5.5682}:  70%|███████   | 7/10 [00:26<00:12,  4.24s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8446, 'compress@10': 0.0474, 'time@10': 5.4589}:  70%|███████   | 7/10 [00:31<00:12,  4.24s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8446, 'compress@10': 0.0474, 'time@10': 5.4589}:  80%|████████  | 8/10 [00:31<00:08,  4.40s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.854, 'compress@10': 0.0454, 'time@10': 5.791}:  80%|████████  | 8/10 [00:35<00:08,  4.40s/it] {'epoch': 2, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.854, 'compress@10': 0.0454, 'time@10': 5.791}:  90%|█████████ | 9/10 [00:35<00:04,  4.35s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8545, 'compress@10': 0.0432, 'time@10': 5.7968}:  90%|█████████ | 9/10 [00:41<00:04,  4.35s/it] {'epoch': 2, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8545, 'compress@10': 0.0432, 'time@10': 5.7968}: 100%|██████████| 10/10 [00:41<00:00,  4.83s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8545, 'compress@10': 0.0432, 'time@10': 5.7968}: 100%|██████████| 10/10 [00:41<00:00,  4.17s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04905648330203554
Avg hit ratio: 0.8273104462034853
Avg ndcg: 0.8544642449000692
Avg compression ratio: 0.04318842378180078
Avg train time: 5.796843886375427
Std train time: 2.4027614173213863
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.0532, 'time@10': 4.2673}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.0532, 'time@10': 4.2673}:  10%|█         | 1/10 [00:02<00:19,  2.17s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8482, 'compress@10': 0.043, 'time@10': 4.2311}:  10%|█         | 1/10 [00:06<00:19,  2.17s/it]  {'epoch': 3, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8482, 'compress@10': 0.043, 'time@10': 4.2311}:  20%|██        | 2/10 [00:06<00:27,  3.38s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8512, 'compress@10': 0.0765, 'time@10': 3.5413}:  20%|██        | 2/10 [00:07<00:27,  3.38s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8512, 'compress@10': 0.0765, 'time@10': 3.5413}:  30%|███       | 3/10 [00:07<00:16,  2.35s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.7561, 'ndcg@10': 0.8479, 'compress@10': 0.0664, 'time@10': 3.5734}:  30%|███       | 3/10 [00:11<00:16,  2.35s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.7561, 'ndcg@10': 0.8479, 'compress@10': 0.0664, 'time@10': 3.5734}:  40%|████      | 4/10 [00:11<00:17,  2.89s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0473, 'hit_ratio@10': 0.7689, 'ndcg@10': 0.8362, 'compress@10': 0.0573, 'time@10': 4.8174}:  40%|████      | 4/10 [00:16<00:17,  2.89s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0473, 'hit_ratio@10': 0.7689, 'ndcg@10': 0.8362, 'compress@10': 0.0573, 'time@10': 4.8174}:  50%|█████     | 5/10 [00:16<00:18,  3.64s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0514, 'hit_ratio@10': 0.7667, 'ndcg@10': 0.834, 'compress@10': 0.0516, 'time@10': 5.0461}:  50%|█████     | 5/10 [00:22<00:18,  3.64s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0514, 'hit_ratio@10': 0.7667, 'ndcg@10': 0.834, 'compress@10': 0.0516, 'time@10': 5.0461}:  60%|██████    | 6/10 [00:22<00:18,  4.52s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.7943, 'ndcg@10': 0.8368, 'compress@10': 0.05, 'time@10': 5.2949}:  60%|██████    | 6/10 [00:25<00:18,  4.52s/it] {'epoch': 3, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.7943, 'ndcg@10': 0.8368, 'compress@10': 0.05, 'time@10': 5.2949}:  70%|███████   | 7/10 [00:25<00:12,  4.17s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8093, 'ndcg@10': 0.8395, 'compress@10': 0.0474, 'time@10': 5.219}:  70%|███████   | 7/10 [00:30<00:12,  4.17s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8093, 'ndcg@10': 0.8395, 'compress@10': 0.0474, 'time@10': 5.219}:  80%|████████  | 8/10 [00:30<00:08,  4.34s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.7987, 'ndcg@10': 0.8495, 'compress@10': 0.0454, 'time@10': 5.5929}:  80%|████████  | 8/10 [00:34<00:08,  4.34s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.7987, 'ndcg@10': 0.8495, 'compress@10': 0.0454, 'time@10': 5.5929}:  90%|█████████ | 9/10 [00:34<00:04,  4.34s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8495, 'compress@10': 0.0432, 'time@10': 5.6138}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8495, 'compress@10': 0.0432, 'time@10': 5.6138}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8495, 'compress@10': 0.0432, 'time@10': 5.6138}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04871621956141227
Avg hit ratio: 0.8120441891630346
Avg ndcg: 0.8494712742483305
Avg compression ratio: 0.04319286240893968
Avg train time: 5.613832306861878
Std train time: 2.200450748439461
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8501, 'compress@10': 0.0531, 'time@10': 4.1595}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8501, 'compress@10': 0.0531, 'time@10': 4.1595}:  10%|█         | 1/10 [00:02<00:19,  2.17s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.798, 'ndcg@10': 0.849, 'compress@10': 0.043, 'time@10': 4.2312}:  10%|█         | 1/10 [00:06<00:19,  2.17s/it]   {'epoch': 4, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.798, 'ndcg@10': 0.849, 'compress@10': 0.043, 'time@10': 4.2312}:  20%|██        | 2/10 [00:06<00:27,  3.45s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0334, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8517, 'compress@10': 0.0764, 'time@10': 3.5986}:  20%|██        | 2/10 [00:07<00:27,  3.45s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0334, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8517, 'compress@10': 0.0764, 'time@10': 3.5986}:  30%|███       | 3/10 [00:07<00:16,  2.43s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0371, 'hit_ratio@10': 0.7561, 'ndcg@10': 0.8485, 'compress@10': 0.0664, 'time@10': 3.6192}:  30%|███       | 3/10 [00:11<00:16,  2.43s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0371, 'hit_ratio@10': 0.7561, 'ndcg@10': 0.8485, 'compress@10': 0.0664, 'time@10': 3.6192}:  40%|████      | 4/10 [00:11<00:17,  2.94s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0469, 'hit_ratio@10': 0.7729, 'ndcg@10': 0.8357, 'compress@10': 0.0573, 'time@10': 4.5355}:  40%|████      | 4/10 [00:15<00:17,  2.94s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0469, 'hit_ratio@10': 0.7729, 'ndcg@10': 0.8357, 'compress@10': 0.0573, 'time@10': 4.5355}:  50%|█████     | 5/10 [00:15<00:16,  3.37s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0505, 'hit_ratio@10': 0.7737, 'ndcg@10': 0.834, 'compress@10': 0.0516, 'time@10': 4.8055}:  50%|█████     | 5/10 [00:21<00:16,  3.37s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0505, 'hit_ratio@10': 0.7737, 'ndcg@10': 0.834, 'compress@10': 0.0516, 'time@10': 4.8055}:  60%|██████    | 6/10 [00:21<00:17,  4.33s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0497, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8385, 'compress@10': 0.05, 'time@10': 5.0854}:  60%|██████    | 6/10 [00:25<00:17,  4.33s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0497, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8385, 'compress@10': 0.05, 'time@10': 5.0854}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8461, 'compress@10': 0.0474, 'time@10': 5.0366}:  70%|███████   | 7/10 [00:29<00:12,  4.04s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8461, 'compress@10': 0.0474, 'time@10': 5.0366}:  80%|████████  | 8/10 [00:29<00:08,  4.26s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0518, 'hit_ratio@10': 0.8161, 'ndcg@10': 0.8618, 'compress@10': 0.0454, 'time@10': 5.4165}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0518, 'hit_ratio@10': 0.8161, 'ndcg@10': 0.8618, 'compress@10': 0.0454, 'time@10': 5.4165}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0512, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8605, 'compress@10': 0.0432, 'time@10': 5.4542}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0512, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8605, 'compress@10': 0.0432, 'time@10': 5.4542}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0512, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8605, 'compress@10': 0.0432, 'time@10': 5.4542}: 100%|██████████| 10/10 [00:40<00:00,  4.00s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.05123747145242543
Avg hit ratio: 0.8276949828138284
Avg ndcg: 0.8605173614083039
Avg compression ratio: 0.04315534868958871
Avg train time: 5.454159808158875
Std train time: 1.8798368666293477
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 0.0531, 'time@10': 4.4786}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 0.0531, 'time@10': 4.4786}:  10%|█         | 1/10 [00:02<00:20,  2.28s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8525, 'compress@10': 0.043, 'time@10': 4.3081}:  10%|█         | 1/10 [00:06<00:20,  2.28s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8525, 'compress@10': 0.043, 'time@10': 4.3081}:  20%|██        | 2/10 [00:06<00:27,  3.40s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8541, 'compress@10': 0.0764, 'time@10': 3.6889}:  20%|██        | 2/10 [00:07<00:27,  3.40s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8541, 'compress@10': 0.0764, 'time@10': 3.6889}:  30%|███       | 3/10 [00:07<00:17,  2.43s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8489, 'compress@10': 0.0664, 'time@10': 3.6986}:  30%|███       | 3/10 [00:11<00:17,  2.43s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8489, 'compress@10': 0.0664, 'time@10': 3.6986}:  40%|████      | 4/10 [00:11<00:17,  2.96s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0454, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8361, 'compress@10': 0.0573, 'time@10': 4.6167}:  40%|████      | 4/10 [00:15<00:17,  2.96s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0454, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8361, 'compress@10': 0.0573, 'time@10': 4.6167}:  50%|█████     | 5/10 [00:15<00:17,  3.40s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0486, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8343, 'compress@10': 0.0515, 'time@10': 4.8733}:  50%|█████     | 5/10 [00:21<00:17,  3.40s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0486, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8343, 'compress@10': 0.0515, 'time@10': 4.8733}:  60%|██████    | 6/10 [00:21<00:17,  4.35s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0475, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.836, 'compress@10': 0.05, 'time@10': 5.1383}:  60%|██████    | 6/10 [00:25<00:17,  4.35s/it]   {'epoch': 5, 'num_users': 6.2857, 'loss': 0.0475, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.836, 'compress@10': 0.05, 'time@10': 5.1383}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.048, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8423, 'compress@10': 0.0474, 'time@10': 5.0863}:  70%|███████   | 7/10 [00:30<00:12,  4.04s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.048, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8423, 'compress@10': 0.0474, 'time@10': 5.0863}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0483, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8474, 'compress@10': 0.0454, 'time@10': 5.4717}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0483, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8474, 'compress@10': 0.0454, 'time@10': 5.4717}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0478, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.8478, 'compress@10': 0.0431, 'time@10': 5.5001}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0478, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.8478, 'compress@10': 0.0431, 'time@10': 5.5001}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0478, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.8478, 'compress@10': 0.0431, 'time@10': 5.5001}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04781755409545723
Avg hit ratio: 0.8367938051384571
Avg ndcg: 0.8478192981512942
Avg compression ratio: 0.043146950829013445
Avg train time: 5.500057721138001
Std train time: 1.8724729831966562
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8598, 'compress@10': 0.0531, 'time@10': 3.8951}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8598, 'compress@10': 0.0531, 'time@10': 3.8951}:  10%|█         | 1/10 [00:02<00:18,  2.01s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8569, 'compress@10': 0.043, 'time@10': 4.0118}:  10%|█         | 1/10 [00:06<00:18,  2.01s/it]  {'epoch': 6, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8569, 'compress@10': 0.043, 'time@10': 4.0118}:  20%|██        | 2/10 [00:06<00:26,  3.28s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.857, 'compress@10': 0.0764, 'time@10': 3.5689}:  20%|██        | 2/10 [00:07<00:26,  3.28s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.857, 'compress@10': 0.0764, 'time@10': 3.5689}:  30%|███       | 3/10 [00:07<00:16,  2.41s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8508, 'compress@10': 0.0664, 'time@10': 3.6095}:  30%|███       | 3/10 [00:11<00:16,  2.41s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8508, 'compress@10': 0.0664, 'time@10': 3.6095}:  40%|████      | 4/10 [00:11<00:17,  2.95s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0456, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8378, 'compress@10': 0.0573, 'time@10': 4.5435}:  40%|████      | 4/10 [00:15<00:17,  2.95s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0456, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8378, 'compress@10': 0.0573, 'time@10': 4.5435}:  50%|█████     | 5/10 [00:15<00:16,  3.39s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0481, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8367, 'compress@10': 0.0515, 'time@10': 4.8387}:  50%|█████     | 5/10 [00:21<00:16,  3.39s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0481, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8367, 'compress@10': 0.0515, 'time@10': 4.8387}:  60%|██████    | 6/10 [00:21<00:17,  4.40s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0478, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8409, 'compress@10': 0.0499, 'time@10': 5.1074}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0478, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8409, 'compress@10': 0.0499, 'time@10': 5.1074}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0473, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8486, 'compress@10': 0.0474, 'time@10': 5.0655}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0473, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8486, 'compress@10': 0.0474, 'time@10': 5.0655}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0484, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8688, 'compress@10': 0.0453, 'time@10': 5.4722}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0484, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8688, 'compress@10': 0.0453, 'time@10': 5.4722}:  90%|█████████ | 9/10 [00:34<00:04,  4.34s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0478, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8687, 'compress@10': 0.0431, 'time@10': 5.5111}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0478, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8687, 'compress@10': 0.0431, 'time@10': 5.5111}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0478, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8687, 'compress@10': 0.0431, 'time@10': 5.5111}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04781163752713515
Avg hit ratio: 0.8614251415439871
Avg ndcg: 0.8686948811472851
Avg compression ratio: 0.04310537132018151
Avg train time: 5.511087083816529
Std train time: 1.9094119904351379
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8563, 'compress@10': 0.0531, 'time@10': 4.3711}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8563, 'compress@10': 0.0531, 'time@10': 4.3711}:  10%|█         | 1/10 [00:02<00:20,  2.24s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.045, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8575, 'compress@10': 0.043, 'time@10': 4.2517}:  10%|█         | 1/10 [00:06<00:20,  2.24s/it]  {'epoch': 7, 'num_users': 7.0, 'loss': 0.045, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8575, 'compress@10': 0.043, 'time@10': 4.2517}:  20%|██        | 2/10 [00:06<00:27,  3.38s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8574, 'compress@10': 0.0764, 'time@10': 3.7939}:  20%|██        | 2/10 [00:07<00:27,  3.38s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8574, 'compress@10': 0.0764, 'time@10': 3.7939}:  30%|███       | 3/10 [00:07<00:17,  2.51s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8527, 'compress@10': 0.0663, 'time@10': 3.7881}:  30%|███       | 3/10 [00:11<00:17,  2.51s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8527, 'compress@10': 0.0663, 'time@10': 3.7881}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0446, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8391, 'compress@10': 0.0572, 'time@10': 4.701}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.0446, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8391, 'compress@10': 0.0572, 'time@10': 4.701}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0466, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8386, 'compress@10': 0.0515, 'time@10': 4.9545}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0466, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8386, 'compress@10': 0.0515, 'time@10': 4.9545}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0452, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8425, 'compress@10': 0.0499, 'time@10': 5.2204}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0452, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8425, 'compress@10': 0.0499, 'time@10': 5.2204}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0452, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.851, 'compress@10': 0.0473, 'time@10': 5.1661}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.0452, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.851, 'compress@10': 0.0473, 'time@10': 5.1661}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0452, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8561, 'compress@10': 0.0453, 'time@10': 5.5645}:  80%|████████  | 8/10 [00:34<00:08,  4.33s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0452, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8561, 'compress@10': 0.0453, 'time@10': 5.5645}:  90%|█████████ | 9/10 [00:34<00:04,  4.36s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0445, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8576, 'compress@10': 0.043, 'time@10': 5.5932}:  90%|█████████ | 9/10 [00:40<00:04,  4.36s/it]    {'epoch': 7, 'num_users': 6.3, 'loss': 0.0445, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8576, 'compress@10': 0.043, 'time@10': 5.5932}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0445, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8576, 'compress@10': 0.043, 'time@10': 5.5932}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.044479857799320996
Avg hit ratio: 0.8729395482842002
Avg ndcg: 0.8576063475957811
Avg compression ratio: 0.0430457742456501
Avg train time: 5.593152928352356
Std train time: 1.8580701069860512
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8632, 'compress@10': 0.053, 'time@10': 4.448}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8632, 'compress@10': 0.053, 'time@10': 4.448}:  10%|█         | 1/10 [00:02<00:20,  2.28s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8604, 'compress@10': 0.0429, 'time@10': 4.1635}:  10%|█         | 1/10 [00:06<00:20,  2.28s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8604, 'compress@10': 0.0429, 'time@10': 4.1635}:  20%|██        | 2/10 [00:06<00:25,  3.24s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8593, 'compress@10': 0.0763, 'time@10': 3.7648}:  20%|██        | 2/10 [00:07<00:25,  3.24s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8593, 'compress@10': 0.0763, 'time@10': 3.7648}:  30%|███       | 3/10 [00:07<00:17,  2.46s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0371, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8459, 'compress@10': 0.0663, 'time@10': 3.7727}:  30%|███       | 3/10 [00:11<00:17,  2.46s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0371, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8459, 'compress@10': 0.0663, 'time@10': 3.7727}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.045, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8336, 'compress@10': 0.0571, 'time@10': 4.7112}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it] {'epoch': 8, 'num_users': 5.8, 'loss': 0.045, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8336, 'compress@10': 0.0571, 'time@10': 4.7112}:  50%|█████     | 5/10 [00:15<00:17,  3.47s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0462, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8344, 'compress@10': 0.0514, 'time@10': 4.9802}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0462, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8344, 'compress@10': 0.0514, 'time@10': 4.9802}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0453, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8396, 'compress@10': 0.0498, 'time@10': 5.2382}:  60%|██████    | 6/10 [00:25<00:17,  4.46s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0453, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8396, 'compress@10': 0.0498, 'time@10': 5.2382}:  70%|███████   | 7/10 [00:25<00:12,  4.12s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0449, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.847, 'compress@10': 0.0472, 'time@10': 5.1757}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it]  {'epoch': 8, 'num_users': 6.125, 'loss': 0.0449, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.847, 'compress@10': 0.0472, 'time@10': 5.1757}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0444, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8574, 'compress@10': 0.0452, 'time@10': 5.567}:  80%|████████  | 8/10 [00:34<00:08,  4.33s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0444, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8574, 'compress@10': 0.0452, 'time@10': 5.567}:  90%|█████████ | 9/10 [00:34<00:04,  4.35s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0435, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8592, 'compress@10': 0.043, 'time@10': 5.6028}:  90%|█████████ | 9/10 [00:40<00:04,  4.35s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0435, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8592, 'compress@10': 0.043, 'time@10': 5.6028}: 100%|██████████| 10/10 [00:40<00:00,  4.85s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0435, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8592, 'compress@10': 0.043, 'time@10': 5.6028}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04349964520007403
Avg hit ratio: 0.8625304341008924
Avg ndcg: 0.8592164928053461
Avg compression ratio: 0.0429649268082973
Avg train time: 5.602773547172546
Std train time: 1.8722799454240031
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8524, 'compress@10': 0.0529, 'time@10': 4.2357}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8524, 'compress@10': 0.0529, 'time@10': 4.2357}:  10%|█         | 1/10 [00:02<00:19,  2.16s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8637, 'compress@10': 0.0428, 'time@10': 4.1253}:  10%|█         | 1/10 [00:06<00:19,  2.16s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8637, 'compress@10': 0.0428, 'time@10': 4.1253}:  20%|██        | 2/10 [00:06<00:26,  3.28s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8615, 'compress@10': 0.0762, 'time@10': 3.7915}:  20%|██        | 2/10 [00:07<00:26,  3.28s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8615, 'compress@10': 0.0762, 'time@10': 3.7915}:  30%|███       | 3/10 [00:07<00:17,  2.51s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8512, 'compress@10': 0.0662, 'time@10': 3.7922}:  30%|███       | 3/10 [00:11<00:17,  2.51s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8512, 'compress@10': 0.0662, 'time@10': 3.7922}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.042, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8391, 'compress@10': 0.057, 'time@10': 4.6989}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it] {'epoch': 9, 'num_users': 5.8, 'loss': 0.042, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8391, 'compress@10': 0.057, 'time@10': 4.6989}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.043, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8401, 'compress@10': 0.0513, 'time@10': 4.9486}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.043, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8401, 'compress@10': 0.0513, 'time@10': 4.9486}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.042, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8428, 'compress@10': 0.0497, 'time@10': 5.2152}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.042, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8428, 'compress@10': 0.0497, 'time@10': 5.2152}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0419, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8495, 'compress@10': 0.0471, 'time@10': 5.1714}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0419, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8495, 'compress@10': 0.0471, 'time@10': 5.1714}:  80%|████████  | 8/10 [00:30<00:08,  4.35s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0419, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8572, 'compress@10': 0.0451, 'time@10': 5.5611}:  80%|████████  | 8/10 [00:34<00:08,  4.35s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0419, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8572, 'compress@10': 0.0451, 'time@10': 5.5611}:  90%|█████████ | 9/10 [00:34<00:04,  4.36s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8586, 'compress@10': 0.0429, 'time@10': 5.5982}:  90%|█████████ | 9/10 [00:40<00:04,  4.36s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8586, 'compress@10': 0.0429, 'time@10': 5.5982}: 100%|██████████| 10/10 [00:40<00:00,  4.86s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8586, 'compress@10': 0.0429, 'time@10': 5.5982}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.041103522000798545
Avg hit ratio: 0.8677331990778511
Avg ndcg: 0.8585547884156253
Avg compression ratio: 0.042876336632708546
Avg train time: 5.598202538490296
Std train time: 1.8209431976698858
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8725, 'compress@10': 0.0529, 'time@10': 4.3033}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8725, 'compress@10': 0.0529, 'time@10': 4.3033}:  10%|█         | 1/10 [00:02<00:19,  2.19s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8729, 'compress@10': 0.0427, 'time@10': 4.072}:  10%|█         | 1/10 [00:06<00:19,  2.19s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8729, 'compress@10': 0.0427, 'time@10': 4.072}:  20%|██        | 2/10 [00:06<00:25,  3.18s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8676, 'compress@10': 0.0762, 'time@10': 3.7245}:  20%|██        | 2/10 [00:07<00:25,  3.18s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8676, 'compress@10': 0.0762, 'time@10': 3.7245}:  30%|███       | 3/10 [00:07<00:17,  2.44s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8602, 'compress@10': 0.0661, 'time@10': 3.7385}:  30%|███       | 3/10 [00:11<00:17,  2.44s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8602, 'compress@10': 0.0661, 'time@10': 3.7385}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0399, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8465, 'compress@10': 0.0569, 'time@10': 4.6501}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0399, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8465, 'compress@10': 0.0569, 'time@10': 4.6501}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0404, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8475, 'compress@10': 0.0512, 'time@10': 4.9045}:  50%|█████     | 5/10 [00:21<00:17,  3.43s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0404, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8475, 'compress@10': 0.0512, 'time@10': 4.9045}:  60%|██████    | 6/10 [00:21<00:17,  4.38s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0406, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8548, 'compress@10': 0.0496, 'time@10': 5.1795}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0406, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8548, 'compress@10': 0.0496, 'time@10': 5.1795}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0408, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8556, 'compress@10': 0.047, 'time@10': 5.1284}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.0408, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8556, 'compress@10': 0.047, 'time@10': 5.1284}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0396, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8641, 'compress@10': 0.045, 'time@10': 5.5347}:  80%|████████  | 8/10 [00:34<00:08,  4.33s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0396, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8641, 'compress@10': 0.045, 'time@10': 5.5347}:  90%|█████████ | 9/10 [00:34<00:04,  4.36s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0388, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8677, 'compress@10': 0.0428, 'time@10': 5.5607}:  90%|█████████ | 9/10 [00:40<00:04,  4.36s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0388, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8677, 'compress@10': 0.0428, 'time@10': 5.5607}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0388, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8677, 'compress@10': 0.0428, 'time@10': 5.5607}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.038806996862227064
Avg hit ratio: 0.8620189133635654
Avg ndcg: 0.8677239188931661
Avg compression ratio: 0.04281582634286034
Avg train time: 5.560653591156006
Std train time: 1.8618759030884464
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.836, 'compress@10': 0.0528, 'time@10': 4.3185}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.836, 'compress@10': 0.0528, 'time@10': 4.3185}:  10%|█         | 1/10 [00:02<00:19,  2.20s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8595, 'compress@10': 0.0427, 'time@10': 4.1895}:  10%|█         | 1/10 [00:06<00:19,  2.20s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8595, 'compress@10': 0.0427, 'time@10': 4.1895}:  20%|██        | 2/10 [00:06<00:26,  3.32s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8587, 'compress@10': 0.0761, 'time@10': 3.8977}:  20%|██        | 2/10 [00:07<00:26,  3.32s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8587, 'compress@10': 0.0761, 'time@10': 3.8977}:  30%|███       | 3/10 [00:07<00:18,  2.57s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8562, 'compress@10': 0.066, 'time@10': 3.8738}:  30%|███       | 3/10 [00:11<00:18,  2.57s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8562, 'compress@10': 0.066, 'time@10': 3.8738}:  40%|████      | 4/10 [00:11<00:18,  3.07s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0384, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8447, 'compress@10': 0.0569, 'time@10': 4.7399}:  40%|████      | 4/10 [00:15<00:18,  3.07s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0384, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8447, 'compress@10': 0.0569, 'time@10': 4.7399}:  50%|█████     | 5/10 [00:15<00:17,  3.46s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0388, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8474, 'compress@10': 0.0512, 'time@10': 4.9883}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0388, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8474, 'compress@10': 0.0512, 'time@10': 4.9883}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8481, 'compress@10': 0.0496, 'time@10': 5.224}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it] {'epoch': 11, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8481, 'compress@10': 0.0496, 'time@10': 5.224}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0391, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8516, 'compress@10': 0.047, 'time@10': 5.1609}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0391, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8516, 'compress@10': 0.047, 'time@10': 5.1609}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0377, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8606, 'compress@10': 0.045, 'time@10': 5.5393}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0377, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8606, 'compress@10': 0.045, 'time@10': 5.5393}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0375, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8627, 'compress@10': 0.0428, 'time@10': 5.5771}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.0375, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8627, 'compress@10': 0.0428, 'time@10': 5.5771}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0375, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8627, 'compress@10': 0.0428, 'time@10': 5.5771}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03748364540881016
Avg hit ratio: 0.8617900077662386
Avg ndcg: 0.8627459389513762
Avg compression ratio: 0.04276956253921123
Avg train time: 5.577146720886231
Std train time: 1.7436543978954804
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8645, 'compress@10': 0.0528, 'time@10': 4.6295}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8645, 'compress@10': 0.0528, 'time@10': 4.6295}:  10%|█         | 1/10 [00:02<00:21,  2.35s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8763, 'compress@10': 0.0426, 'time@10': 4.3525}:  10%|█         | 1/10 [00:06<00:21,  2.35s/it] {'epoch': 12, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8763, 'compress@10': 0.0426, 'time@10': 4.3525}:  20%|██        | 2/10 [00:06<00:27,  3.39s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8699, 'compress@10': 0.0761, 'time@10': 3.9944}:  20%|██        | 2/10 [00:08<00:27,  3.39s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8699, 'compress@10': 0.0761, 'time@10': 3.9944}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8655, 'compress@10': 0.066, 'time@10': 3.9443}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8655, 'compress@10': 0.066, 'time@10': 3.9443}:  40%|████      | 4/10 [00:11<00:18,  3.09s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8531, 'compress@10': 0.0569, 'time@10': 4.8025}:  40%|████      | 4/10 [00:16<00:18,  3.09s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8531, 'compress@10': 0.0569, 'time@10': 4.8025}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0371, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8549, 'compress@10': 0.0511, 'time@10': 5.0418}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0371, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8549, 'compress@10': 0.0511, 'time@10': 5.0418}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0366, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8624, 'compress@10': 0.0496, 'time@10': 5.2842}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0366, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8624, 'compress@10': 0.0496, 'time@10': 5.2842}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0366, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8634, 'compress@10': 0.047, 'time@10': 5.2124}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.0366, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8634, 'compress@10': 0.047, 'time@10': 5.2124}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0374, 'hit_ratio@10': 0.852, 'ndcg@10': 0.872, 'compress@10': 0.0449, 'time@10': 5.5904}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0374, 'hit_ratio@10': 0.852, 'ndcg@10': 0.872, 'compress@10': 0.0449, 'time@10': 5.5904}:  90%|█████████ | 9/10 [00:34<00:04,  4.32s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0355, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.8772, 'compress@10': 0.0427, 'time@10': 5.6377}:  90%|█████████ | 9/10 [00:41<00:04,  4.32s/it] {'epoch': 12, 'num_users': 6.3, 'loss': 0.0355, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.8772, 'compress@10': 0.0427, 'time@10': 5.6377}: 100%|██████████| 10/10 [00:41<00:00,  4.87s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0355, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.8772, 'compress@10': 0.0427, 'time@10': 5.6377}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03553247606953217
Avg hit ratio: 0.8645138628585147
Avg ndcg: 0.8772327521917742
Avg compression ratio: 0.04274471279235488
Avg train time: 5.637699818611145
Std train time: 1.75060843813663
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8551, 'compress@10': 0.0528, 'time@10': 4.7301}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8551, 'compress@10': 0.0528, 'time@10': 4.7301}:  10%|█         | 1/10 [00:02<00:21,  2.41s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8758, 'compress@10': 0.0426, 'time@10': 4.247}:  10%|█         | 1/10 [00:06<00:21,  2.41s/it] {'epoch': 13, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8758, 'compress@10': 0.0426, 'time@10': 4.247}:  20%|██        | 2/10 [00:06<00:25,  3.23s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8696, 'compress@10': 0.0761, 'time@10': 3.9285}:  20%|██        | 2/10 [00:07<00:25,  3.23s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8696, 'compress@10': 0.0761, 'time@10': 3.9285}:  30%|███       | 3/10 [00:07<00:17,  2.52s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8654, 'compress@10': 0.066, 'time@10': 3.8985}:  30%|███       | 3/10 [00:11<00:17,  2.52s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8654, 'compress@10': 0.066, 'time@10': 3.8985}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0348, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8551, 'compress@10': 0.0569, 'time@10': 4.7515}:  40%|████      | 4/10 [00:15<00:18,  3.05s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0348, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8551, 'compress@10': 0.0569, 'time@10': 4.7515}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.035, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8582, 'compress@10': 0.0511, 'time@10': 4.9929}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.035, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8582, 'compress@10': 0.0511, 'time@10': 4.9929}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0346, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8633, 'compress@10': 0.0496, 'time@10': 5.242}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it] {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0346, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8633, 'compress@10': 0.0496, 'time@10': 5.242}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0342, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8662, 'compress@10': 0.0469, 'time@10': 5.176}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0342, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8662, 'compress@10': 0.0469, 'time@10': 5.176}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0343, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8741, 'compress@10': 0.0449, 'time@10': 5.5318}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0343, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8741, 'compress@10': 0.0449, 'time@10': 5.5318}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.034, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8754, 'compress@10': 0.0427, 'time@10': 5.5791}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]    {'epoch': 13, 'num_users': 6.3, 'loss': 0.034, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8754, 'compress@10': 0.0427, 'time@10': 5.5791}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.034, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8754, 'compress@10': 0.0427, 'time@10': 5.5791}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03403247473484832
Avg hit ratio: 0.8765836585598894
Avg ndcg: 0.875397434807228
Avg compression ratio: 0.04272328784208793
Avg train time: 5.579081892967224
Std train time: 1.7190068566175136
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0397, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8622, 'compress@10': 0.0528, 'time@10': 4.3744}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0397, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8622, 'compress@10': 0.0528, 'time@10': 4.3744}:  10%|█         | 1/10 [00:02<00:20,  2.22s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8767, 'compress@10': 0.0426, 'time@10': 4.1351}:  10%|█         | 1/10 [00:06<00:20,  2.22s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8767, 'compress@10': 0.0426, 'time@10': 4.1351}:  20%|██        | 2/10 [00:06<00:25,  3.23s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8702, 'compress@10': 0.076, 'time@10': 3.84}:  20%|██        | 2/10 [00:07<00:25,  3.23s/it]     {'epoch': 14, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8702, 'compress@10': 0.076, 'time@10': 3.84}:  30%|███       | 3/10 [00:07<00:17,  2.52s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8649, 'compress@10': 0.066, 'time@10': 3.8175}:  30%|███       | 3/10 [00:11<00:17,  2.52s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8649, 'compress@10': 0.066, 'time@10': 3.8175}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0343, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.8538, 'compress@10': 0.0568, 'time@10': 4.7183}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0343, 'hit_ratio@10': 0.8693, 'ndcg@10': 0.8538, 'compress@10': 0.0568, 'time@10': 4.7183}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0335, 'hit_ratio@10': 0.88, 'ndcg@10': 0.8581, 'compress@10': 0.0511, 'time@10': 4.9672}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0335, 'hit_ratio@10': 0.88, 'ndcg@10': 0.8581, 'compress@10': 0.0511, 'time@10': 4.9672}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0328, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.8634, 'compress@10': 0.0495, 'time@10': 5.2163}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0328, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.8634, 'compress@10': 0.0495, 'time@10': 5.2163}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.8689, 'compress@10': 0.0469, 'time@10': 5.1594}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.8689, 'compress@10': 0.0469, 'time@10': 5.1594}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0322, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.8836, 'compress@10': 0.0449, 'time@10': 5.5177}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0322, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.8836, 'compress@10': 0.0449, 'time@10': 5.5177}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0305, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8886, 'compress@10': 0.0427, 'time@10': 5.5701}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0305, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8886, 'compress@10': 0.0427, 'time@10': 5.5701}: 100%|██████████| 10/10 [00:40<00:00,  4.84s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0305, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8886, 'compress@10': 0.0427, 'time@10': 5.5701}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.030489797350100795
Avg hit ratio: 0.8902849572611882
Avg ndcg: 0.8886202157895786
Avg compression ratio: 0.04271150306868981
Avg train time: 5.570076179504395
Std train time: 1.7610108753368137
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8443, 'compress@10': 0.0528, 'time@10': 4.4591}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8443, 'compress@10': 0.0528, 'time@10': 4.4591}:  10%|█         | 1/10 [00:02<00:20,  2.27s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8657, 'compress@10': 0.0426, 'time@10': 4.342}:  10%|█         | 1/10 [00:06<00:20,  2.27s/it] {'epoch': 15, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8657, 'compress@10': 0.0426, 'time@10': 4.342}:  20%|██        | 2/10 [00:06<00:27,  3.44s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8629, 'compress@10': 0.076, 'time@10': 3.9414}:  20%|██        | 2/10 [00:08<00:27,  3.44s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8629, 'compress@10': 0.076, 'time@10': 3.9414}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8595, 'compress@10': 0.066, 'time@10': 3.9023}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8595, 'compress@10': 0.066, 'time@10': 3.9023}:  40%|████      | 4/10 [00:11<00:18,  3.10s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0337, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.851, 'compress@10': 0.0568, 'time@10': 4.7847}:  40%|████      | 4/10 [00:16<00:18,  3.10s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0337, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.851, 'compress@10': 0.0568, 'time@10': 4.7847}:  50%|█████     | 5/10 [00:16<00:17,  3.50s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0329, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8571, 'compress@10': 0.0511, 'time@10': 5.0216}:  50%|█████     | 5/10 [00:22<00:17,  3.50s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0329, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8571, 'compress@10': 0.0511, 'time@10': 5.0216}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0322, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8632, 'compress@10': 0.0495, 'time@10': 5.2779}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0322, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8632, 'compress@10': 0.0495, 'time@10': 5.2779}:  70%|███████   | 7/10 [00:25<00:12,  4.11s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0304, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8698, 'compress@10': 0.0469, 'time@10': 5.2062}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0304, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8698, 'compress@10': 0.0469, 'time@10': 5.2062}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0305, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8785, 'compress@10': 0.0449, 'time@10': 5.5505}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0305, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8785, 'compress@10': 0.0449, 'time@10': 5.5505}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8804, 'compress@10': 0.0427, 'time@10': 5.6028}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8804, 'compress@10': 0.0427, 'time@10': 5.6028}: 100%|██████████| 10/10 [00:40<00:00,  4.84s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8804, 'compress@10': 0.0427, 'time@10': 5.6028}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.03123956596506889
Avg hit ratio: 0.8815706715469025
Avg ndcg: 0.880441191200348
Avg compression ratio: 0.042704160656145976
Avg train time: 5.602843642234802
Std train time: 1.7347053791520304
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.867, 'compress@10': 0.0527, 'time@10': 4.227}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.867, 'compress@10': 0.0527, 'time@10': 4.227}:  10%|█         | 1/10 [00:02<00:19,  2.15s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8863, 'compress@10': 0.0426, 'time@10': 4.1595}:  10%|█         | 1/10 [00:06<00:19,  2.15s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8863, 'compress@10': 0.0426, 'time@10': 4.1595}:  20%|██        | 2/10 [00:06<00:26,  3.32s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8766, 'compress@10': 0.076, 'time@10': 3.778}:  20%|██        | 2/10 [00:07<00:26,  3.32s/it]  {'epoch': 16, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8766, 'compress@10': 0.076, 'time@10': 3.778}:  30%|███       | 3/10 [00:07<00:17,  2.51s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0265, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8733, 'compress@10': 0.066, 'time@10': 3.7842}:  30%|███       | 3/10 [00:11<00:17,  2.51s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0265, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8733, 'compress@10': 0.066, 'time@10': 3.7842}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8617, 'compress@10': 0.0568, 'time@10': 4.6827}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8617, 'compress@10': 0.0568, 'time@10': 4.6827}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0322, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8664, 'compress@10': 0.0511, 'time@10': 4.9379}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0322, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8664, 'compress@10': 0.0511, 'time@10': 4.9379}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0318, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8712, 'compress@10': 0.0495, 'time@10': 5.2203}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0318, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8712, 'compress@10': 0.0495, 'time@10': 5.2203}:  70%|███████   | 7/10 [00:25<00:12,  4.11s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0306, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8774, 'compress@10': 0.0469, 'time@10': 5.1761}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0306, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8774, 'compress@10': 0.0469, 'time@10': 5.1761}:  80%|████████  | 8/10 [00:30<00:08,  4.36s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0297, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8851, 'compress@10': 0.0449, 'time@10': 5.5174}:  80%|████████  | 8/10 [00:34<00:08,  4.36s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0297, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8851, 'compress@10': 0.0449, 'time@10': 5.5174}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8891, 'compress@10': 0.0427, 'time@10': 5.5651}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8891, 'compress@10': 0.0427, 'time@10': 5.5651}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8891, 'compress@10': 0.0427, 'time@10': 5.5651}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.029158980044881922
Avg hit ratio: 0.8685932279378799
Avg ndcg: 0.8890677437233275
Avg compression ratio: 0.04269332175529664
Avg train time: 5.565058493614197
Std train time: 1.7616870664656945
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8802, 'compress@10': 0.0527, 'time@10': 4.0817}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8802, 'compress@10': 0.0527, 'time@10': 4.0817}:  10%|█         | 1/10 [00:02<00:18,  2.08s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8987, 'compress@10': 0.0426, 'time@10': 3.9597}:  10%|█         | 1/10 [00:05<00:18,  2.08s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8987, 'compress@10': 0.0426, 'time@10': 3.9597}:  20%|██        | 2/10 [00:05<00:25,  3.14s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8848, 'compress@10': 0.076, 'time@10': 3.6857}:  20%|██        | 2/10 [00:07<00:25,  3.14s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8848, 'compress@10': 0.076, 'time@10': 3.6857}:  30%|███       | 3/10 [00:07<00:17,  2.44s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.839, 'ndcg@10': 0.883, 'compress@10': 0.066, 'time@10': 3.7082}:  30%|███       | 3/10 [00:11<00:17,  2.44s/it]  {'epoch': 17, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.839, 'ndcg@10': 0.883, 'compress@10': 0.066, 'time@10': 3.7082}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0287, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8711, 'compress@10': 0.0568, 'time@10': 4.6295}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0287, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8711, 'compress@10': 0.0568, 'time@10': 4.6295}:  50%|█████     | 5/10 [00:15<00:17,  3.42s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0289, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.875, 'compress@10': 0.0511, 'time@10': 4.8925}:  50%|█████     | 5/10 [00:21<00:17,  3.42s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0289, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.875, 'compress@10': 0.0511, 'time@10': 4.8925}:  60%|██████    | 6/10 [00:21<00:17,  4.38s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0289, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8779, 'compress@10': 0.0495, 'time@10': 5.1593}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0289, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8779, 'compress@10': 0.0495, 'time@10': 5.1593}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0281, 'hit_ratio@10': 0.884, 'ndcg@10': 0.882, 'compress@10': 0.0469, 'time@10': 5.101}:  70%|███████   | 7/10 [00:29<00:12,  4.07s/it]    {'epoch': 17, 'num_users': 6.125, 'loss': 0.0281, 'hit_ratio@10': 0.884, 'ndcg@10': 0.882, 'compress@10': 0.0469, 'time@10': 5.101}:  80%|████████  | 8/10 [00:29<00:08,  4.28s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0275, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.8892, 'compress@10': 0.0449, 'time@10': 5.439}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0275, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.8892, 'compress@10': 0.0449, 'time@10': 5.439}:  90%|█████████ | 9/10 [00:34<00:04,  4.23s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0263, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8949, 'compress@10': 0.0427, 'time@10': 5.5024}:  90%|█████████ | 9/10 [00:40<00:04,  4.23s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0263, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8949, 'compress@10': 0.0427, 'time@10': 5.5024}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0263, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8949, 'compress@10': 0.0427, 'time@10': 5.5024}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02628680495112761
Avg hit ratio: 0.8849393351413726
Avg ndcg: 0.8948962075192263
Avg compression ratio: 0.04268916033663768
Avg train time: 5.502351403236389
Std train time: 1.769366564773238
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8752, 'compress@10': 0.0527, 'time@10': 4.1088}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8752, 'compress@10': 0.0527, 'time@10': 4.1088}:  10%|█         | 1/10 [00:02<00:18,  2.09s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8989, 'compress@10': 0.0426, 'time@10': 4.0529}:  10%|█         | 1/10 [00:06<00:18,  2.09s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8989, 'compress@10': 0.0426, 'time@10': 4.0529}:  20%|██        | 2/10 [00:06<00:25,  3.24s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.885, 'compress@10': 0.076, 'time@10': 3.7132}:  20%|██        | 2/10 [00:07<00:25,  3.24s/it]  {'epoch': 18, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.885, 'compress@10': 0.076, 'time@10': 3.7132}:  30%|███       | 3/10 [00:07<00:17,  2.47s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.886, 'compress@10': 0.066, 'time@10': 3.7165}:  30%|███       | 3/10 [00:11<00:17,  2.47s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.886, 'compress@10': 0.066, 'time@10': 3.7165}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0284, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8751, 'compress@10': 0.0568, 'time@10': 4.6405}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0284, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8751, 'compress@10': 0.0568, 'time@10': 4.6405}:  50%|█████     | 5/10 [00:15<00:17,  3.42s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8819, 'compress@10': 0.0511, 'time@10': 4.9084}:  50%|█████     | 5/10 [00:21<00:17,  3.42s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8819, 'compress@10': 0.0511, 'time@10': 4.9084}:  60%|██████    | 6/10 [00:21<00:17,  4.40s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0281, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8843, 'compress@10': 0.0495, 'time@10': 5.1731}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0281, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8843, 'compress@10': 0.0495, 'time@10': 5.1731}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0271, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.8888, 'compress@10': 0.0469, 'time@10': 5.1216}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0271, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.8888, 'compress@10': 0.0469, 'time@10': 5.1216}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0272, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.8959, 'compress@10': 0.0449, 'time@10': 5.466}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0272, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.8959, 'compress@10': 0.0449, 'time@10': 5.466}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8976, 'compress@10': 0.0427, 'time@10': 5.5263}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]  {'epoch': 18, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8976, 'compress@10': 0.0427, 'time@10': 5.5263}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8976, 'compress@10': 0.0427, 'time@10': 5.5263}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.027581371285710345
Avg hit ratio: 0.8904602586622961
Avg ndcg: 0.8975999965371354
Avg compression ratio: 0.042689329662003186
Avg train time: 5.526284146308899
Std train time: 1.7857119396431242
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8705, 'compress@10': 0.0527, 'time@10': 4.1365}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8705, 'compress@10': 0.0527, 'time@10': 4.1365}:  10%|█         | 1/10 [00:02<00:18,  2.10s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8996, 'compress@10': 0.0426, 'time@10': 4.1069}:  10%|█         | 1/10 [00:06<00:18,  2.10s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8996, 'compress@10': 0.0426, 'time@10': 4.1069}:  20%|██        | 2/10 [00:06<00:26,  3.30s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8855, 'compress@10': 0.076, 'time@10': 3.754}:  20%|██        | 2/10 [00:07<00:26,  3.30s/it]  {'epoch': 19, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8855, 'compress@10': 0.076, 'time@10': 3.754}:  30%|███       | 3/10 [00:07<00:17,  2.51s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8856, 'compress@10': 0.066, 'time@10': 3.7451}:  30%|███       | 3/10 [00:11<00:17,  2.51s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8856, 'compress@10': 0.066, 'time@10': 3.7451}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0285, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8765, 'compress@10': 0.0568, 'time@10': 4.6541}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0285, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8765, 'compress@10': 0.0568, 'time@10': 4.6541}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0282, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8835, 'compress@10': 0.0511, 'time@10': 4.9163}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0282, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8835, 'compress@10': 0.0511, 'time@10': 4.9163}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0278, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8867, 'compress@10': 0.0495, 'time@10': 5.1765}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0278, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8867, 'compress@10': 0.0495, 'time@10': 5.1765}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0268, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.8915, 'compress@10': 0.0469, 'time@10': 5.1166}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0268, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.8915, 'compress@10': 0.0469, 'time@10': 5.1166}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9093, 'compress@10': 0.0449, 'time@10': 5.4761}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9093, 'compress@10': 0.0449, 'time@10': 5.4761}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9138, 'compress@10': 0.0427, 'time@10': 5.5363}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9138, 'compress@10': 0.0427, 'time@10': 5.5363}: 100%|██████████| 10/10 [00:40<00:00,  4.97s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9138, 'compress@10': 0.0427, 'time@10': 5.5363}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.02547533999408418
Avg hit ratio: 0.8927329859350234
Avg ndcg: 0.9137896610368534
Avg compression ratio: 0.04268656231571013
Avg train time: 5.536283373832703
Std train time: 1.7892137337900746
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8816, 'compress@10': 0.0527, 'time@10': 4.1706}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8816, 'compress@10': 0.0527, 'time@10': 4.1706}:  10%|█         | 1/10 [00:02<00:19,  2.12s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9081, 'compress@10': 0.0426, 'time@10': 3.9992}:  10%|█         | 1/10 [00:05<00:19,  2.12s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9081, 'compress@10': 0.0426, 'time@10': 3.9992}:  20%|██        | 2/10 [00:05<00:25,  3.15s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8911, 'compress@10': 0.076, 'time@10': 3.8316}:  20%|██        | 2/10 [00:07<00:25,  3.15s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8911, 'compress@10': 0.076, 'time@10': 3.8316}:  30%|███       | 3/10 [00:07<00:17,  2.52s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8866, 'compress@10': 0.066, 'time@10': 3.8119}:  30%|███       | 3/10 [00:11<00:17,  2.52s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8866, 'compress@10': 0.066, 'time@10': 3.8119}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0275, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.879, 'compress@10': 0.0568, 'time@10': 4.7427}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0275, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.879, 'compress@10': 0.0568, 'time@10': 4.7427}:  50%|█████     | 5/10 [00:15<00:17,  3.47s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0256, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.8883, 'compress@10': 0.0511, 'time@10': 4.9961}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0256, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.8883, 'compress@10': 0.0511, 'time@10': 4.9961}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0261, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8897, 'compress@10': 0.0495, 'time@10': 5.2491}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0261, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8897, 'compress@10': 0.0495, 'time@10': 5.2491}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.025, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.8946, 'compress@10': 0.0469, 'time@10': 5.188}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]   {'epoch': 20, 'num_users': 6.125, 'loss': 0.025, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.8946, 'compress@10': 0.0469, 'time@10': 5.188}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9133, 'compress@10': 0.0449, 'time@10': 5.5342}:  80%|████████  | 8/10 [00:34<00:08,  4.33s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9133, 'compress@10': 0.0449, 'time@10': 5.5342}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9128, 'compress@10': 0.0427, 'time@10': 5.5774}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9128, 'compress@10': 0.0427, 'time@10': 5.5774}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9128, 'compress@10': 0.0427, 'time@10': 5.5774}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.02726937279876837
Avg hit ratio: 0.893367906569944
Avg ndcg: 0.9127747550227093
Avg compression ratio: 0.042687813296539805
Avg train time: 5.577411246299744
Std train time: 1.7658277897429087
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8861, 'compress@10': 0.0527, 'time@10': 4.1364}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8861, 'compress@10': 0.0527, 'time@10': 4.1364}:  10%|█         | 1/10 [00:02<00:18,  2.11s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9104, 'compress@10': 0.0426, 'time@10': 4.1032}:  10%|█         | 1/10 [00:06<00:18,  2.11s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9104, 'compress@10': 0.0426, 'time@10': 4.1032}:  20%|██        | 2/10 [00:06<00:26,  3.29s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8926, 'compress@10': 0.076, 'time@10': 3.8322}:  20%|██        | 2/10 [00:07<00:26,  3.29s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8926, 'compress@10': 0.076, 'time@10': 3.8322}:  30%|███       | 3/10 [00:07<00:17,  2.56s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8871, 'compress@10': 0.066, 'time@10': 3.8171}:  30%|███       | 3/10 [00:11<00:17,  2.56s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8871, 'compress@10': 0.066, 'time@10': 3.8171}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.88, 'compress@10': 0.0568, 'time@10': 4.7195}:  40%|████      | 4/10 [00:15<00:18,  3.05s/it] {'epoch': 21, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.88, 'compress@10': 0.0568, 'time@10': 4.7195}:  50%|█████     | 5/10 [00:15<00:17,  3.47s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0257, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8893, 'compress@10': 0.0511, 'time@10': 4.9708}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0257, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8893, 'compress@10': 0.0511, 'time@10': 4.9708}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.025, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.8914, 'compress@10': 0.0495, 'time@10': 5.2377}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it] {'epoch': 21, 'num_users': 6.2857, 'loss': 0.025, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.8914, 'compress@10': 0.0495, 'time@10': 5.2377}:  70%|███████   | 7/10 [00:25<00:12,  4.11s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0241, 'hit_ratio@10': 0.9152, 'ndcg@10': 0.896, 'compress@10': 0.0469, 'time@10': 5.1778}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0241, 'hit_ratio@10': 0.9152, 'ndcg@10': 0.896, 'compress@10': 0.0469, 'time@10': 5.1778}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0253, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9048, 'compress@10': 0.0449, 'time@10': 5.5103}:  80%|████████  | 8/10 [00:34<00:08,  4.33s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0253, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9048, 'compress@10': 0.0449, 'time@10': 5.5103}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9099, 'compress@10': 0.0427, 'time@10': 5.5665}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]  {'epoch': 21, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9099, 'compress@10': 0.0427, 'time@10': 5.5665}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9099, 'compress@10': 0.0427, 'time@10': 5.5665}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.024136233791498592
Avg hit ratio: 0.9041615573635948
Avg ndcg: 0.9098832923426597
Avg compression ratio: 0.04268737065231756
Avg train time: 5.5665203332901
Std train time: 1.7337547326507716
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0335, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8861, 'compress@10': 0.0527, 'time@10': 4.3932}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0335, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8861, 'compress@10': 0.0527, 'time@10': 4.3932}:  10%|█         | 1/10 [00:02<00:20,  2.23s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9113, 'compress@10': 0.0426, 'time@10': 4.2184}:  10%|█         | 1/10 [00:06<00:20,  2.23s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9113, 'compress@10': 0.0426, 'time@10': 4.2184}:  20%|██        | 2/10 [00:06<00:26,  3.32s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8932, 'compress@10': 0.076, 'time@10': 4.1656}:  20%|██        | 2/10 [00:08<00:26,  3.32s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8932, 'compress@10': 0.076, 'time@10': 4.1656}:  30%|███       | 3/10 [00:08<00:19,  2.75s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8959, 'compress@10': 0.066, 'time@10': 4.0655}:  30%|███       | 3/10 [00:12<00:19,  2.75s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8959, 'compress@10': 0.066, 'time@10': 4.0655}:  40%|████      | 4/10 [00:12<00:19,  3.17s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0233, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8882, 'compress@10': 0.0568, 'time@10': 4.9522}:  40%|████      | 4/10 [00:16<00:19,  3.17s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0233, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8882, 'compress@10': 0.0568, 'time@10': 4.9522}:  50%|█████     | 5/10 [00:16<00:17,  3.57s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0244, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8996, 'compress@10': 0.0511, 'time@10': 5.1609}:  50%|█████     | 5/10 [00:22<00:17,  3.57s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0244, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8996, 'compress@10': 0.0511, 'time@10': 5.1609}:  60%|██████    | 6/10 [00:22<00:17,  4.48s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0237, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9017, 'compress@10': 0.0495, 'time@10': 5.3958}:  60%|██████    | 6/10 [00:26<00:17,  4.48s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0237, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9017, 'compress@10': 0.0495, 'time@10': 5.3958}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0233, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9029, 'compress@10': 0.0469, 'time@10': 5.3155}:  70%|███████   | 7/10 [00:30<00:12,  4.14s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0233, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9029, 'compress@10': 0.0469, 'time@10': 5.3155}:  80%|████████  | 8/10 [00:30<00:08,  4.35s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9078, 'compress@10': 0.0449, 'time@10': 5.653}:  80%|████████  | 8/10 [00:35<00:08,  4.35s/it] {'epoch': 22, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9078, 'compress@10': 0.0449, 'time@10': 5.653}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9132, 'compress@10': 0.0427, 'time@10': 5.6879}:  90%|█████████ | 9/10 [00:41<00:04,  4.31s/it] {'epoch': 22, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9132, 'compress@10': 0.0427, 'time@10': 5.6879}: 100%|██████████| 10/10 [00:41<00:00,  4.84s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9132, 'compress@10': 0.0427, 'time@10': 5.6879}: 100%|██████████| 10/10 [00:41<00:00,  4.12s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.02190185042819098
Avg hit ratio: 0.883447271649309
Avg ndcg: 0.9132305635433162
Avg compression ratio: 0.04268842619304642
Avg train time: 5.687893414497376
Std train time: 1.6798853747352762
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0311, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8891, 'compress@10': 0.0527, 'time@10': 4.6419}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0311, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8891, 'compress@10': 0.0527, 'time@10': 4.6419}:  10%|█         | 1/10 [00:02<00:21,  2.36s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9156, 'compress@10': 0.0426, 'time@10': 4.3537}:  10%|█         | 1/10 [00:06<00:21,  2.36s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9156, 'compress@10': 0.0426, 'time@10': 4.3537}:  20%|██        | 2/10 [00:06<00:27,  3.38s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8961, 'compress@10': 0.076, 'time@10': 4.1066}:  20%|██        | 2/10 [00:08<00:27,  3.38s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8961, 'compress@10': 0.076, 'time@10': 4.1066}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.839, 'ndcg@10': 0.9035, 'compress@10': 0.066, 'time@10': 4.0147}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.839, 'ndcg@10': 0.9035, 'compress@10': 0.066, 'time@10': 4.0147}:  40%|████      | 4/10 [00:12<00:18,  3.12s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0223, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8942, 'compress@10': 0.0568, 'time@10': 4.8975}:  40%|████      | 4/10 [00:16<00:18,  3.12s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0223, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8942, 'compress@10': 0.0568, 'time@10': 4.8975}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9033, 'compress@10': 0.0511, 'time@10': 5.115}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.9033, 'compress@10': 0.0511, 'time@10': 5.115}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.022, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9036, 'compress@10': 0.0495, 'time@10': 5.3482}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.022, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9036, 'compress@10': 0.0495, 'time@10': 5.3482}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.021, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9087, 'compress@10': 0.0469, 'time@10': 5.2599}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.021, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9087, 'compress@10': 0.0469, 'time@10': 5.2599}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9141, 'compress@10': 0.0449, 'time@10': 5.6201}:  80%|████████  | 8/10 [00:35<00:08,  4.29s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9141, 'compress@10': 0.0449, 'time@10': 5.6201}:  90%|█████████ | 9/10 [00:35<00:04,  4.30s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.915, 'compress@10': 0.0427, 'time@10': 5.6527}:  90%|█████████ | 9/10 [00:41<00:04,  4.30s/it]    {'epoch': 23, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.915, 'compress@10': 0.0427, 'time@10': 5.6527}: 100%|██████████| 10/10 [00:41<00:00,  4.82s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.915, 'compress@10': 0.0427, 'time@10': 5.6527}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.02088935591008498
Avg hit ratio: 0.8897964779985154
Avg ndcg: 0.9149830046950733
Avg compression ratio: 0.042683781536534224
Avg train time: 5.652738499641418
Std train time: 1.7262702245416148
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8913, 'compress@10': 0.0527, 'time@10': 4.7966}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8913, 'compress@10': 0.0527, 'time@10': 4.7966}:  10%|█         | 1/10 [00:02<00:21,  2.44s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9217, 'compress@10': 0.0426, 'time@10': 4.3952}:  10%|█         | 1/10 [00:06<00:21,  2.44s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9217, 'compress@10': 0.0426, 'time@10': 4.3952}:  20%|██        | 2/10 [00:06<00:27,  3.38s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9002, 'compress@10': 0.076, 'time@10': 4.1079}:  20%|██        | 2/10 [00:08<00:27,  3.38s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9002, 'compress@10': 0.076, 'time@10': 4.1079}:  30%|███       | 3/10 [00:08<00:18,  2.66s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9076, 'compress@10': 0.066, 'time@10': 4.0316}:  30%|███       | 3/10 [00:12<00:18,  2.66s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9076, 'compress@10': 0.066, 'time@10': 4.0316}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0209, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8978, 'compress@10': 0.0568, 'time@10': 4.9009}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0209, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8978, 'compress@10': 0.0568, 'time@10': 4.9009}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9069, 'compress@10': 0.0511, 'time@10': 5.1217}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9069, 'compress@10': 0.0511, 'time@10': 5.1217}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9078, 'compress@10': 0.0495, 'time@10': 5.3521}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9078, 'compress@10': 0.0495, 'time@10': 5.3521}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0203, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9093, 'compress@10': 0.0469, 'time@10': 5.2669}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0203, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9093, 'compress@10': 0.0469, 'time@10': 5.2669}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0208, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9194, 'compress@10': 0.0449, 'time@10': 5.6676}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0208, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9194, 'compress@10': 0.0449, 'time@10': 5.6676}:  90%|█████████ | 9/10 [00:35<00:04,  4.36s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9244, 'compress@10': 0.0427, 'time@10': 5.6897}:  90%|█████████ | 9/10 [00:41<00:04,  4.36s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9244, 'compress@10': 0.0427, 'time@10': 5.6897}: 100%|██████████| 10/10 [00:41<00:00,  4.84s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9244, 'compress@10': 0.0427, 'time@10': 5.6897}: 100%|██████████| 10/10 [00:41<00:00,  4.11s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.01916774280135304
Avg hit ratio: 0.8972818581154745
Avg ndcg: 0.9243799964563587
Avg compression ratio: 0.04268369284759448
Avg train time: 5.689741563796997
Std train time: 1.7805758159440126
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8951, 'compress@10': 0.0527, 'time@10': 4.9041}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8951, 'compress@10': 0.0527, 'time@10': 4.9041}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9231, 'compress@10': 0.0426, 'time@10': 4.4318}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9231, 'compress@10': 0.0426, 'time@10': 4.4318}:  20%|██        | 2/10 [00:06<00:27,  3.41s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9011, 'compress@10': 0.076, 'time@10': 4.2223}:  20%|██        | 2/10 [00:08<00:27,  3.41s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9011, 'compress@10': 0.076, 'time@10': 4.2223}:  30%|███       | 3/10 [00:08<00:19,  2.74s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8966, 'compress@10': 0.066, 'time@10': 4.0976}:  30%|███       | 3/10 [00:12<00:19,  2.74s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8966, 'compress@10': 0.066, 'time@10': 4.0976}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0204, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8901, 'compress@10': 0.0568, 'time@10': 4.9523}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0204, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8901, 'compress@10': 0.0568, 'time@10': 4.9523}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.903, 'compress@10': 0.0511, 'time@10': 5.1671}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.903, 'compress@10': 0.0511, 'time@10': 5.1671}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0212, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9066, 'compress@10': 0.0495, 'time@10': 5.4053}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0212, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9066, 'compress@10': 0.0495, 'time@10': 5.4053}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0205, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9095, 'compress@10': 0.0469, 'time@10': 5.3068}:  70%|███████   | 7/10 [00:30<00:12,  4.14s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0205, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9095, 'compress@10': 0.0469, 'time@10': 5.3068}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0228, 'hit_ratio@10': 0.882, 'ndcg@10': 0.932, 'compress@10': 0.0449, 'time@10': 5.6651}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it] {'epoch': 25, 'num_users': 6.3333, 'loss': 0.0228, 'hit_ratio@10': 0.882, 'ndcg@10': 0.932, 'compress@10': 0.0449, 'time@10': 5.6651}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0238, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9311, 'compress@10': 0.0427, 'time@10': 5.6701}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it] {'epoch': 25, 'num_users': 6.3, 'loss': 0.0238, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9311, 'compress@10': 0.0427, 'time@10': 5.6701}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0238, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9311, 'compress@10': 0.0427, 'time@10': 5.6701}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.023838662449944974
Avg hit ratio: 0.8915675724011887
Avg ndcg: 0.9311269303679713
Avg compression ratio: 0.04268946167717126
Avg train time: 5.670147061347961
Std train time: 1.7048201723745642
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8943, 'compress@10': 0.0527, 'time@10': 5.0244}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8943, 'compress@10': 0.0527, 'time@10': 5.0244}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9215, 'compress@10': 0.0426, 'time@10': 4.4481}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9215, 'compress@10': 0.0426, 'time@10': 4.4481}:  20%|██        | 2/10 [00:06<00:26,  3.35s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9001, 'compress@10': 0.076, 'time@10': 4.2515}:  20%|██        | 2/10 [00:08<00:26,  3.35s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9001, 'compress@10': 0.076, 'time@10': 4.2515}:  30%|███       | 3/10 [00:08<00:19,  2.72s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8903, 'compress@10': 0.066, 'time@10': 4.1482}:  30%|███       | 3/10 [00:12<00:19,  2.72s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8903, 'compress@10': 0.066, 'time@10': 4.1482}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.021, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8857, 'compress@10': 0.0568, 'time@10': 4.9862}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.021, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8857, 'compress@10': 0.0568, 'time@10': 4.9862}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8979, 'compress@10': 0.0511, 'time@10': 5.2048}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8979, 'compress@10': 0.0511, 'time@10': 5.2048}:  60%|██████    | 6/10 [00:22<00:18,  4.50s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0198, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9001, 'compress@10': 0.0495, 'time@10': 5.4338}:  60%|██████    | 6/10 [00:26<00:18,  4.50s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0198, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9001, 'compress@10': 0.0495, 'time@10': 5.4338}:  70%|███████   | 7/10 [00:26<00:12,  4.16s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.019, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9058, 'compress@10': 0.0469, 'time@10': 5.3292}:  70%|███████   | 7/10 [00:30<00:12,  4.16s/it]  {'epoch': 26, 'num_users': 6.125, 'loss': 0.019, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9058, 'compress@10': 0.0469, 'time@10': 5.3292}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9088, 'compress@10': 0.0449, 'time@10': 5.7171}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9088, 'compress@10': 0.0449, 'time@10': 5.7171}:  90%|█████████ | 9/10 [00:35<00:04,  4.35s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9154, 'compress@10': 0.0427, 'time@10': 5.6941}:  90%|█████████ | 9/10 [00:40<00:04,  4.35s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9154, 'compress@10': 0.0427, 'time@10': 5.6941}: 100%|██████████| 10/10 [00:40<00:00,  4.72s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9154, 'compress@10': 0.0427, 'time@10': 5.6941}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.019175966561662827
Avg hit ratio: 0.8944247152583316
Avg ndcg: 0.9154038614144175
Avg compression ratio: 0.04268597303794177
Avg train time: 5.694085049629211
Std train time: 1.7379066047592122
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8943, 'compress@10': 0.0527, 'time@10': 4.7724}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8943, 'compress@10': 0.0527, 'time@10': 4.7724}:  10%|█         | 1/10 [00:02<00:21,  2.43s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.925, 'compress@10': 0.0426, 'time@10': 4.3503}:  10%|█         | 1/10 [00:06<00:21,  2.43s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.925, 'compress@10': 0.0426, 'time@10': 4.3503}:  20%|██        | 2/10 [00:06<00:26,  3.33s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9024, 'compress@10': 0.076, 'time@10': 4.1877}:  20%|██        | 2/10 [00:08<00:26,  3.33s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9024, 'compress@10': 0.076, 'time@10': 4.1877}:  30%|███       | 3/10 [00:08<00:18,  2.71s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9058, 'compress@10': 0.066, 'time@10': 4.0804}:  30%|███       | 3/10 [00:12<00:18,  2.71s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9058, 'compress@10': 0.066, 'time@10': 4.0804}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.9003, 'compress@10': 0.0568, 'time@10': 4.9378}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.9003, 'compress@10': 0.0568, 'time@10': 4.9378}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0191, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9103, 'compress@10': 0.0511, 'time@10': 5.1473}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0191, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9103, 'compress@10': 0.0511, 'time@10': 5.1473}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9142, 'compress@10': 0.0495, 'time@10': 5.3824}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9142, 'compress@10': 0.0495, 'time@10': 5.3824}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9138, 'compress@10': 0.0469, 'time@10': 5.286}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it]  {'epoch': 27, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9138, 'compress@10': 0.0469, 'time@10': 5.286}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9188, 'compress@10': 0.0449, 'time@10': 5.6602}:  80%|████████  | 8/10 [00:35<00:08,  4.29s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9188, 'compress@10': 0.0449, 'time@10': 5.6602}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9239, 'compress@10': 0.0427, 'time@10': 5.6539}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9239, 'compress@10': 0.0427, 'time@10': 5.6539}: 100%|██████████| 10/10 [00:40<00:00,  4.72s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9239, 'compress@10': 0.0427, 'time@10': 5.6539}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.016776168630284066
Avg hit ratio: 0.8909326517662681
Avg ndcg: 0.9238534879767242
Avg compression ratio: 0.04268556079055463
Avg train time: 5.653922057151794
Std train time: 1.7204589275991704
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0257, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.897, 'compress@10': 0.0527, 'time@10': 4.7744}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0257, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.897, 'compress@10': 0.0527, 'time@10': 4.7744}:  10%|█         | 1/10 [00:02<00:21,  2.43s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9269, 'compress@10': 0.0426, 'time@10': 4.3509}:  10%|█         | 1/10 [00:06<00:21,  2.43s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9269, 'compress@10': 0.0426, 'time@10': 4.3509}:  20%|██        | 2/10 [00:06<00:26,  3.34s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9037, 'compress@10': 0.076, 'time@10': 4.1764}:  20%|██        | 2/10 [00:08<00:26,  3.34s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9037, 'compress@10': 0.076, 'time@10': 4.1764}:  30%|███       | 3/10 [00:08<00:18,  2.70s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9113, 'compress@10': 0.066, 'time@10': 4.0696}:  30%|███       | 3/10 [00:12<00:18,  2.70s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9113, 'compress@10': 0.066, 'time@10': 4.0696}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9059, 'compress@10': 0.0568, 'time@10': 4.9461}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9059, 'compress@10': 0.0568, 'time@10': 4.9461}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.019, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9172, 'compress@10': 0.0511, 'time@10': 5.1581}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.019, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9172, 'compress@10': 0.0511, 'time@10': 5.1581}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0194, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9165, 'compress@10': 0.0495, 'time@10': 5.3805}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0194, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9165, 'compress@10': 0.0495, 'time@10': 5.3805}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9212, 'compress@10': 0.0469, 'time@10': 5.2788}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9212, 'compress@10': 0.0469, 'time@10': 5.2788}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9257, 'compress@10': 0.0449, 'time@10': 5.6567}:  80%|████████  | 8/10 [00:35<00:08,  4.27s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9257, 'compress@10': 0.0449, 'time@10': 5.6567}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.927, 'compress@10': 0.0427, 'time@10': 5.6534}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]    {'epoch': 28, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.927, 'compress@10': 0.0427, 'time@10': 5.6534}: 100%|██████████| 10/10 [00:40<00:00,  4.72s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.927, 'compress@10': 0.0427, 'time@10': 5.6534}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01890126948373059
Avg hit ratio: 0.8986469374805537
Avg ndcg: 0.9269999840373642
Avg compression ratio: 0.042692434252666014
Avg train time: 5.653359866142273
Std train time: 1.7416337252443093
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9018, 'compress@10': 0.0527, 'time@10': 4.9784}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9018, 'compress@10': 0.0527, 'time@10': 4.9784}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9267, 'compress@10': 0.0426, 'time@10': 4.5853}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9267, 'compress@10': 0.0426, 'time@10': 4.5853}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9035, 'compress@10': 0.076, 'time@10': 4.3044}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9035, 'compress@10': 0.076, 'time@10': 4.3044}:  30%|███       | 3/10 [00:08<00:19,  2.79s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9144, 'compress@10': 0.066, 'time@10': 4.1673}:  30%|███       | 3/10 [00:12<00:19,  2.79s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9144, 'compress@10': 0.066, 'time@10': 4.1673}:  40%|████      | 4/10 [00:12<00:19,  3.21s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9112, 'compress@10': 0.0568, 'time@10': 4.9854}:  40%|████      | 4/10 [00:16<00:19,  3.21s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9112, 'compress@10': 0.0568, 'time@10': 4.9854}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9203, 'compress@10': 0.0511, 'time@10': 5.205}:  50%|█████     | 5/10 [00:23<00:17,  3.55s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9203, 'compress@10': 0.0511, 'time@10': 5.205}:  60%|██████    | 6/10 [00:23<00:18,  4.50s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9225, 'compress@10': 0.0495, 'time@10': 5.4135}:  60%|██████    | 6/10 [00:26<00:18,  4.50s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9225, 'compress@10': 0.0495, 'time@10': 5.4135}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9256, 'compress@10': 0.0469, 'time@10': 5.3149}:  70%|███████   | 7/10 [00:31<00:12,  4.13s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9256, 'compress@10': 0.0469, 'time@10': 5.3149}:  80%|████████  | 8/10 [00:31<00:08,  4.30s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9397, 'compress@10': 0.0449, 'time@10': 5.6827}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9397, 'compress@10': 0.0449, 'time@10': 5.6827}:  90%|█████████ | 9/10 [00:35<00:04,  4.32s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9432, 'compress@10': 0.0427, 'time@10': 5.6639}:  90%|█████████ | 9/10 [00:40<00:04,  4.32s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9432, 'compress@10': 0.0427, 'time@10': 5.6639}: 100%|██████████| 10/10 [00:40<00:00,  4.69s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9432, 'compress@10': 0.0427, 'time@10': 5.6639}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.015178264158153524
Avg hit ratio: 0.8907104295440458
Avg ndcg: 0.943199387196422
Avg compression ratio: 0.04268868991478682
Avg train time: 5.66390962600708
Std train time: 1.6728665644147458
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9008, 'compress@10': 0.0528, 'time@10': 5.3277}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9008, 'compress@10': 0.0528, 'time@10': 5.3277}:  10%|█         | 1/10 [00:02<00:24,  2.70s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9268, 'compress@10': 0.0426, 'time@10': 4.6712}:  10%|█         | 1/10 [00:06<00:24,  2.70s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9268, 'compress@10': 0.0426, 'time@10': 4.6712}:  20%|██        | 2/10 [00:06<00:27,  3.50s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9036, 'compress@10': 0.076, 'time@10': 4.3998}:  20%|██        | 2/10 [00:08<00:27,  3.50s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9036, 'compress@10': 0.076, 'time@10': 4.3998}:  30%|███       | 3/10 [00:08<00:19,  2.80s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9109, 'compress@10': 0.066, 'time@10': 4.2369}:  30%|███       | 3/10 [00:12<00:19,  2.80s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9109, 'compress@10': 0.066, 'time@10': 4.2369}:  40%|████      | 4/10 [00:12<00:19,  3.19s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9054, 'compress@10': 0.0568, 'time@10': 5.0803}:  40%|████      | 4/10 [00:16<00:19,  3.19s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9054, 'compress@10': 0.0568, 'time@10': 5.0803}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.915, 'compress@10': 0.0511, 'time@10': 5.2651}:  50%|█████     | 5/10 [00:23<00:17,  3.58s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.915, 'compress@10': 0.0511, 'time@10': 5.2651}:  60%|██████    | 6/10 [00:23<00:17,  4.48s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9179, 'compress@10': 0.0495, 'time@10': 5.4403}:  60%|██████    | 6/10 [00:26<00:17,  4.48s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9179, 'compress@10': 0.0495, 'time@10': 5.4403}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9186, 'compress@10': 0.0469, 'time@10': 5.3453}:  70%|███████   | 7/10 [00:31<00:12,  4.09s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9186, 'compress@10': 0.0469, 'time@10': 5.3453}:  80%|████████  | 8/10 [00:31<00:08,  4.29s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9203, 'compress@10': 0.0449, 'time@10': 5.7106}:  80%|████████  | 8/10 [00:35<00:08,  4.29s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9203, 'compress@10': 0.0449, 'time@10': 5.7106}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9221, 'compress@10': 0.0427, 'time@10': 5.6787}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9221, 'compress@10': 0.0427, 'time@10': 5.6787}: 100%|██████████| 10/10 [00:40<00:00,  4.66s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9221, 'compress@10': 0.0427, 'time@10': 5.6787}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.01814232278539011
Avg hit ratio: 0.9015040803376966
Avg ndcg: 0.9220928059013824
Avg compression ratio: 0.042693758343641294
Avg train time: 5.678700470924378
Std train time: 1.6843915600103017
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0236, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9008, 'compress@10': 0.0528, 'time@10': 4.6959}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0236, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9008, 'compress@10': 0.0528, 'time@10': 4.6959}:  10%|█         | 1/10 [00:02<00:21,  2.38s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9308, 'compress@10': 0.0426, 'time@10': 4.3708}:  10%|█         | 1/10 [00:06<00:21,  2.38s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9308, 'compress@10': 0.0426, 'time@10': 4.3708}:  20%|██        | 2/10 [00:06<00:27,  3.39s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9062, 'compress@10': 0.076, 'time@10': 4.1916}:  20%|██        | 2/10 [00:08<00:27,  3.39s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9062, 'compress@10': 0.076, 'time@10': 4.1916}:  30%|███       | 3/10 [00:08<00:19,  2.74s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9178, 'compress@10': 0.066, 'time@10': 4.091}:  30%|███       | 3/10 [00:12<00:19,  2.74s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9178, 'compress@10': 0.066, 'time@10': 4.091}:  40%|████      | 4/10 [00:12<00:19,  3.17s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9104, 'compress@10': 0.0568, 'time@10': 4.9568}:  40%|████      | 4/10 [00:16<00:19,  3.17s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9104, 'compress@10': 0.0568, 'time@10': 4.9568}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9239, 'compress@10': 0.0511, 'time@10': 5.1571}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9239, 'compress@10': 0.0511, 'time@10': 5.1571}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.898, 'ndcg@10': 0.925, 'compress@10': 0.0495, 'time@10': 5.3867}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]  {'epoch': 31, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.898, 'ndcg@10': 0.925, 'compress@10': 0.0495, 'time@10': 5.3867}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0182, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.9289, 'compress@10': 0.0469, 'time@10': 5.2976}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0182, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.9289, 'compress@10': 0.0469, 'time@10': 5.2976}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9322, 'compress@10': 0.0449, 'time@10': 5.6803}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9322, 'compress@10': 0.0449, 'time@10': 5.6803}:  90%|█████████ | 9/10 [00:35<00:04,  4.34s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9367, 'compress@10': 0.0427, 'time@10': 5.6552}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9367, 'compress@10': 0.0427, 'time@10': 5.6552}: 100%|██████████| 10/10 [00:40<00:00,  4.69s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9367, 'compress@10': 0.0427, 'time@10': 5.6552}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.01643601090865214
Avg hit ratio: 0.8892183660519825
Avg ndcg: 0.9367355804289075
Avg compression ratio: 0.04269371898319732
Avg train time: 5.655219721794128
Std train time: 1.7314946463123817
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.905, 'compress@10': 0.0528, 'time@10': 4.7972}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.905, 'compress@10': 0.0528, 'time@10': 4.7972}:  10%|█         | 1/10 [00:02<00:21,  2.44s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9349, 'compress@10': 0.0426, 'time@10': 4.464}:  10%|█         | 1/10 [00:06<00:21,  2.44s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9349, 'compress@10': 0.0426, 'time@10': 4.464}:  20%|██        | 2/10 [00:06<00:27,  3.46s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.909, 'compress@10': 0.076, 'time@10': 4.2437}:  20%|██        | 2/10 [00:08<00:27,  3.46s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.909, 'compress@10': 0.076, 'time@10': 4.2437}:  30%|███       | 3/10 [00:08<00:19,  2.76s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9198, 'compress@10': 0.066, 'time@10': 4.1159}:  30%|███       | 3/10 [00:12<00:19,  2.76s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9198, 'compress@10': 0.066, 'time@10': 4.1159}:  40%|████      | 4/10 [00:12<00:18,  3.16s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9136, 'compress@10': 0.0568, 'time@10': 4.984}:  40%|████      | 4/10 [00:16<00:18,  3.16s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9136, 'compress@10': 0.0568, 'time@10': 4.984}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9233, 'compress@10': 0.0511, 'time@10': 5.1804}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9233, 'compress@10': 0.0511, 'time@10': 5.1804}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9269, 'compress@10': 0.0495, 'time@10': 5.3678}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9269, 'compress@10': 0.0495, 'time@10': 5.3678}:  70%|███████   | 7/10 [00:26<00:12,  4.08s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9276, 'compress@10': 0.0469, 'time@10': 5.295}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9276, 'compress@10': 0.0469, 'time@10': 5.295}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9318, 'compress@10': 0.0449, 'time@10': 5.6793}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9318, 'compress@10': 0.0449, 'time@10': 5.6793}:  90%|█████████ | 9/10 [00:35<00:04,  4.35s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9335, 'compress@10': 0.0427, 'time@10': 5.6604}:  90%|█████████ | 9/10 [00:40<00:04,  4.35s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9335, 'compress@10': 0.0427, 'time@10': 5.6604}: 100%|██████████| 10/10 [00:40<00:00,  4.71s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9335, 'compress@10': 0.0427, 'time@10': 5.6604}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.01535481411918011
Avg hit ratio: 0.8955675724011888
Avg ndcg: 0.9334699008576823
Avg compression ratio: 0.042699809323500475
Avg train time: 5.660386323928833
Std train time: 1.7139891403418896
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9077, 'compress@10': 0.0528, 'time@10': 4.7322}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9077, 'compress@10': 0.0528, 'time@10': 4.7322}:  10%|█         | 1/10 [00:02<00:21,  2.41s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9322, 'compress@10': 0.0426, 'time@10': 4.3826}:  10%|█         | 1/10 [00:06<00:21,  2.41s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9322, 'compress@10': 0.0426, 'time@10': 4.3826}:  20%|██        | 2/10 [00:06<00:27,  3.39s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9072, 'compress@10': 0.076, 'time@10': 4.1956}:  20%|██        | 2/10 [00:08<00:27,  3.39s/it]  {'epoch': 33, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9072, 'compress@10': 0.076, 'time@10': 4.1956}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9196, 'compress@10': 0.066, 'time@10': 4.0954}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9196, 'compress@10': 0.066, 'time@10': 4.0954}:  40%|████      | 4/10 [00:12<00:18,  3.17s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0133, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9153, 'compress@10': 0.0568, 'time@10': 4.9549}:  40%|████      | 4/10 [00:16<00:18,  3.17s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0133, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9153, 'compress@10': 0.0568, 'time@10': 4.9549}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.925, 'compress@10': 0.0511, 'time@10': 5.1531}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.925, 'compress@10': 0.0511, 'time@10': 5.1531}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9244, 'compress@10': 0.0495, 'time@10': 5.3447}:  60%|██████    | 6/10 [00:25<00:17,  4.45s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9244, 'compress@10': 0.0495, 'time@10': 5.3447}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9261, 'compress@10': 0.0469, 'time@10': 5.2685}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9261, 'compress@10': 0.0469, 'time@10': 5.2685}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9381, 'compress@10': 0.0449, 'time@10': 5.6248}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9381, 'compress@10': 0.0449, 'time@10': 5.6248}:  90%|█████████ | 9/10 [00:35<00:04,  4.29s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9417, 'compress@10': 0.0427, 'time@10': 5.6091}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9417, 'compress@10': 0.0427, 'time@10': 5.6091}: 100%|██████████| 10/10 [00:40<00:00,  4.66s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9417, 'compress@10': 0.0427, 'time@10': 5.6091}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.016745545571422084
Avg hit ratio: 0.9062787589697606
Avg ndcg: 0.9417181499284719
Avg compression ratio: 0.0426994039060498
Avg train time: 5.609056305885315
Std train time: 1.66008584112238
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9136, 'compress@10': 0.0528, 'time@10': 4.921}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9136, 'compress@10': 0.0528, 'time@10': 4.921}:  10%|█         | 1/10 [00:02<00:22,  2.50s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9349, 'compress@10': 0.0426, 'time@10': 4.4834}:  10%|█         | 1/10 [00:06<00:22,  2.50s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9349, 'compress@10': 0.0426, 'time@10': 4.4834}:  20%|██        | 2/10 [00:06<00:27,  3.43s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.749, 'ndcg@10': 0.909, 'compress@10': 0.076, 'time@10': 4.2557}:  20%|██        | 2/10 [00:08<00:27,  3.43s/it]   {'epoch': 34, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.749, 'ndcg@10': 0.909, 'compress@10': 0.076, 'time@10': 4.2557}:  30%|███       | 3/10 [00:08<00:19,  2.75s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9209, 'compress@10': 0.066, 'time@10': 4.1388}:  30%|███       | 3/10 [00:12<00:19,  2.75s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9209, 'compress@10': 0.066, 'time@10': 4.1388}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.9181, 'compress@10': 0.0568, 'time@10': 5.0119}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.9181, 'compress@10': 0.0568, 'time@10': 5.0119}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.9318, 'compress@10': 0.0511, 'time@10': 5.2025}:  50%|█████     | 5/10 [00:22<00:17,  3.58s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.9318, 'compress@10': 0.0511, 'time@10': 5.2025}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9341, 'compress@10': 0.0495, 'time@10': 5.3852}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9341, 'compress@10': 0.0495, 'time@10': 5.3852}:  70%|███████   | 7/10 [00:26<00:12,  4.08s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9376, 'compress@10': 0.0469, 'time@10': 5.3132}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9376, 'compress@10': 0.0469, 'time@10': 5.3132}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9347, 'compress@10': 0.0449, 'time@10': 5.7062}:  80%|████████  | 8/10 [00:35<00:08,  4.33s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9347, 'compress@10': 0.0449, 'time@10': 5.7062}:  90%|█████████ | 9/10 [00:35<00:04,  4.37s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9385, 'compress@10': 0.0427, 'time@10': 5.6707}:  90%|█████████ | 9/10 [00:40<00:04,  4.37s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9385, 'compress@10': 0.0427, 'time@10': 5.6707}: 100%|██████████| 10/10 [00:40<00:00,  4.69s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9385, 'compress@10': 0.0427, 'time@10': 5.6707}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.017102276247127086
Avg hit ratio: 0.8801958096610049
Avg ndcg: 0.9385285660723387
Avg compression ratio: 0.04270131135626113
Avg train time: 5.670710825920105
Std train time: 1.7353450134765547
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9158, 'compress@10': 0.0528, 'time@10': 4.648}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9158, 'compress@10': 0.0528, 'time@10': 4.648}:  10%|█         | 1/10 [00:02<00:21,  2.37s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9461, 'compress@10': 0.0426, 'time@10': 4.4657}:  10%|█         | 1/10 [00:06<00:21,  2.37s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9461, 'compress@10': 0.0426, 'time@10': 4.4657}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9165, 'compress@10': 0.076, 'time@10': 4.2269}:  20%|██        | 2/10 [00:08<00:28,  3.52s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9165, 'compress@10': 0.076, 'time@10': 4.2269}:  30%|███       | 3/10 [00:08<00:19,  2.79s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9257, 'compress@10': 0.066, 'time@10': 4.1108}:  30%|███       | 3/10 [00:12<00:19,  2.79s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9257, 'compress@10': 0.066, 'time@10': 4.1108}:  40%|████      | 4/10 [00:12<00:19,  3.19s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.9226, 'compress@10': 0.0568, 'time@10': 4.9444}:  40%|████      | 4/10 [00:16<00:19,  3.19s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.9226, 'compress@10': 0.0568, 'time@10': 4.9444}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9311, 'compress@10': 0.0511, 'time@10': 5.1576}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9311, 'compress@10': 0.0511, 'time@10': 5.1576}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9337, 'compress@10': 0.0495, 'time@10': 5.334}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it]  {'epoch': 35, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9337, 'compress@10': 0.0495, 'time@10': 5.334}:  70%|███████   | 7/10 [00:26<00:12,  4.07s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9458, 'compress@10': 0.0469, 'time@10': 5.2572}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9458, 'compress@10': 0.0469, 'time@10': 5.2572}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9475, 'compress@10': 0.0449, 'time@10': 5.6279}:  80%|████████  | 8/10 [00:35<00:08,  4.29s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9475, 'compress@10': 0.0449, 'time@10': 5.6279}:  90%|█████████ | 9/10 [00:35<00:04,  4.30s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9497, 'compress@10': 0.0427, 'time@10': 5.5995}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9497, 'compress@10': 0.0427, 'time@10': 5.5995}: 100%|██████████| 10/10 [00:40<00:00,  4.64s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9497, 'compress@10': 0.0427, 'time@10': 5.5995}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.014596072710722038
Avg hit ratio: 0.8661763524157413
Avg ndcg: 0.9497063872396806
Avg compression ratio: 0.04269572626461353
Avg train time: 5.599542355537414
Std train time: 1.6565371840827259
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9158, 'compress@10': 0.0528, 'time@10': 4.7216}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9158, 'compress@10': 0.0528, 'time@10': 4.7216}:  10%|█         | 1/10 [00:02<00:21,  2.42s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9418, 'compress@10': 0.0426, 'time@10': 4.4607}:  10%|█         | 1/10 [00:06<00:21,  2.42s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9418, 'compress@10': 0.0426, 'time@10': 4.4607}:  20%|██        | 2/10 [00:06<00:27,  3.49s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9136, 'compress@10': 0.076, 'time@10': 4.265}:  20%|██        | 2/10 [00:08<00:27,  3.49s/it]   {'epoch': 36, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9136, 'compress@10': 0.076, 'time@10': 4.265}:  30%|███       | 3/10 [00:08<00:19,  2.80s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9236, 'compress@10': 0.066, 'time@10': 4.1421}:  30%|███       | 3/10 [00:12<00:19,  2.80s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9236, 'compress@10': 0.066, 'time@10': 4.1421}:  40%|████      | 4/10 [00:12<00:19,  3.20s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9218, 'compress@10': 0.0568, 'time@10': 4.9927}:  40%|████      | 4/10 [00:16<00:19,  3.20s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9218, 'compress@10': 0.0568, 'time@10': 4.9927}:  50%|█████     | 5/10 [00:16<00:17,  3.57s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9305, 'compress@10': 0.0511, 'time@10': 5.2086}:  50%|█████     | 5/10 [00:23<00:17,  3.57s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9305, 'compress@10': 0.0511, 'time@10': 5.2086}:  60%|██████    | 6/10 [00:23<00:18,  4.51s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0123, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.931, 'compress@10': 0.0495, 'time@10': 5.3973}:  60%|██████    | 6/10 [00:26<00:18,  4.51s/it] {'epoch': 36, 'num_users': 6.2857, 'loss': 0.0123, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.931, 'compress@10': 0.0495, 'time@10': 5.3973}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9345, 'compress@10': 0.0469, 'time@10': 5.3147}:  70%|███████   | 7/10 [00:31<00:12,  4.12s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9345, 'compress@10': 0.0469, 'time@10': 5.3147}:  80%|████████  | 8/10 [00:31<00:08,  4.33s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9376, 'compress@10': 0.0449, 'time@10': 5.6983}:  80%|████████  | 8/10 [00:35<00:08,  4.33s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9376, 'compress@10': 0.0449, 'time@10': 5.6983}:  90%|█████████ | 9/10 [00:35<00:04,  4.36s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9034, 'ndcg@10': 0.941, 'compress@10': 0.0427, 'time@10': 5.6561}:  90%|█████████ | 9/10 [00:40<00:04,  4.36s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9034, 'ndcg@10': 0.941, 'compress@10': 0.0427, 'time@10': 5.6561}: 100%|██████████| 10/10 [00:40<00:00,  4.65s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9034, 'ndcg@10': 0.941, 'compress@10': 0.0427, 'time@10': 5.6561}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.012559641312433076
Avg hit ratio: 0.9034216161126176
Avg ndcg: 0.9409900811007196
Avg compression ratio: 0.042694012152519265
Avg train time: 5.656140279769898
Std train time: 1.7043459726356
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9158, 'compress@10': 0.0528, 'time@10': 4.5503}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9158, 'compress@10': 0.0528, 'time@10': 4.5503}:  10%|█         | 1/10 [00:02<00:20,  2.32s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9412, 'compress@10': 0.0426, 'time@10': 4.397}:  10%|█         | 1/10 [00:06<00:20,  2.32s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9412, 'compress@10': 0.0426, 'time@10': 4.397}:  20%|██        | 2/10 [00:06<00:27,  3.48s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9132, 'compress@10': 0.076, 'time@10': 4.1908}:  20%|██        | 2/10 [00:08<00:27,  3.48s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9132, 'compress@10': 0.076, 'time@10': 4.1908}:  30%|███       | 3/10 [00:08<00:19,  2.77s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9244, 'compress@10': 0.066, 'time@10': 4.0832}:  30%|███       | 3/10 [00:12<00:19,  2.77s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9244, 'compress@10': 0.066, 'time@10': 4.0832}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9212, 'compress@10': 0.0568, 'time@10': 4.9179}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9212, 'compress@10': 0.0568, 'time@10': 4.9179}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9302, 'compress@10': 0.0511, 'time@10': 5.1324}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9302, 'compress@10': 0.0511, 'time@10': 5.1324}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9327, 'compress@10': 0.0495, 'time@10': 5.34}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]  {'epoch': 37, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9327, 'compress@10': 0.0495, 'time@10': 5.34}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9367, 'compress@10': 0.0469, 'time@10': 5.2667}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9367, 'compress@10': 0.0469, 'time@10': 5.2667}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9447, 'compress@10': 0.0449, 'time@10': 5.6463}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9447, 'compress@10': 0.0449, 'time@10': 5.6463}:  90%|█████████ | 9/10 [00:35<00:04,  4.34s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9457, 'compress@10': 0.0427, 'time@10': 5.6444}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9457, 'compress@10': 0.0427, 'time@10': 5.6444}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9457, 'compress@10': 0.0427, 'time@10': 5.6444}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.012922443354840519
Avg hit ratio: 0.9030529525181479
Avg ndcg: 0.9457182194856142
Avg compression ratio: 0.042692399323545585
Avg train time: 5.644429469108582
Std train time: 1.6804442781163444
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.0528, 'time@10': 4.9272}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.0528, 'time@10': 4.9272}:  10%|█         | 1/10 [00:02<00:22,  2.50s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9428, 'compress@10': 0.0426, 'time@10': 4.41}:  10%|█         | 1/10 [00:06<00:22,  2.50s/it]   {'epoch': 38, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9428, 'compress@10': 0.0426, 'time@10': 4.41}:  20%|██        | 2/10 [00:06<00:26,  3.34s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9143, 'compress@10': 0.076, 'time@10': 4.2296}:  20%|██        | 2/10 [00:08<00:26,  3.34s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9143, 'compress@10': 0.076, 'time@10': 4.2296}:  30%|███       | 3/10 [00:08<00:19,  2.72s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9256, 'compress@10': 0.066, 'time@10': 4.1124}:  30%|███       | 3/10 [00:12<00:19,  2.72s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9256, 'compress@10': 0.066, 'time@10': 4.1124}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9242, 'compress@10': 0.0568, 'time@10': 4.9587}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9242, 'compress@10': 0.0568, 'time@10': 4.9587}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9373, 'compress@10': 0.0511, 'time@10': 5.1934}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9373, 'compress@10': 0.0511, 'time@10': 5.1934}:  60%|██████    | 6/10 [00:22<00:18,  4.51s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9396, 'compress@10': 0.0495, 'time@10': 5.395}:  60%|██████    | 6/10 [00:26<00:18,  4.51s/it] {'epoch': 38, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9396, 'compress@10': 0.0495, 'time@10': 5.395}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9423, 'compress@10': 0.0469, 'time@10': 5.3065}:  70%|███████   | 7/10 [00:30<00:12,  4.13s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9423, 'compress@10': 0.0469, 'time@10': 5.3065}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9388, 'compress@10': 0.0449, 'time@10': 5.6537}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9388, 'compress@10': 0.0449, 'time@10': 5.6537}:  90%|█████████ | 9/10 [00:35<00:04,  4.30s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9426, 'compress@10': 0.0427, 'time@10': 5.6514}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9426, 'compress@10': 0.0427, 'time@10': 5.6514}: 100%|██████████| 10/10 [00:40<00:00,  4.72s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9426, 'compress@10': 0.0427, 'time@10': 5.6514}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.015636672066760008
Avg hit ratio: 0.9004620667014555
Avg ndcg: 0.942580826563575
Avg compression ratio: 0.04269035788676101
Avg train time: 5.651358485221863
Std train time: 1.6643489492926256
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.0528, 'time@10': 5.05}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.0528, 'time@10': 5.05}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9455, 'compress@10': 0.0426, 'time@10': 4.5566}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9455, 'compress@10': 0.0426, 'time@10': 4.5566}:  20%|██        | 2/10 [00:06<00:27,  3.47s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.916, 'compress@10': 0.076, 'time@10': 4.3165}:  20%|██        | 2/10 [00:08<00:27,  3.47s/it]  {'epoch': 39, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.916, 'compress@10': 0.076, 'time@10': 4.3165}:  30%|███       | 3/10 [00:08<00:19,  2.78s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.901, 'ndcg@10': 0.927, 'compress@10': 0.066, 'time@10': 4.1782}:  30%|███       | 3/10 [00:12<00:19,  2.78s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.901, 'ndcg@10': 0.927, 'compress@10': 0.066, 'time@10': 4.1782}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9253, 'compress@10': 0.0568, 'time@10': 5.0075}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9253, 'compress@10': 0.0568, 'time@10': 5.0075}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9337, 'compress@10': 0.0511, 'time@10': 5.2031}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9337, 'compress@10': 0.0511, 'time@10': 5.2031}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9352, 'compress@10': 0.0495, 'time@10': 5.4019}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9352, 'compress@10': 0.0495, 'time@10': 5.4019}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.9289, 'ndcg@10': 0.9393, 'compress@10': 0.0469, 'time@10': 5.3197}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.9289, 'ndcg@10': 0.9393, 'compress@10': 0.0469, 'time@10': 5.3197}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0098, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9422, 'compress@10': 0.0449, 'time@10': 5.6586}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0098, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9422, 'compress@10': 0.0449, 'time@10': 5.6586}:  90%|█████████ | 9/10 [00:35<00:04,  4.28s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9451, 'compress@10': 0.0427, 'time@10': 5.6492}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]    {'epoch': 39, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9451, 'compress@10': 0.0427, 'time@10': 5.6492}: 100%|██████████| 10/10 [00:40<00:00,  4.69s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9451, 'compress@10': 0.0427, 'time@10': 5.6492}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.010691469429081713
Avg hit ratio: 0.9179735874387827
Avg ndcg: 0.9450851482875684
Avg compression ratio: 0.04269492991944281
Avg train time: 5.649209022521973
Std train time: 1.6211115340621107
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.0528, 'time@10': 4.9916}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.0528, 'time@10': 4.9916}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9428, 'compress@10': 0.0426, 'time@10': 4.598}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]  {'epoch': 40, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9428, 'compress@10': 0.0426, 'time@10': 4.598}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9143, 'compress@10': 0.076, 'time@10': 4.338}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9143, 'compress@10': 0.076, 'time@10': 4.338}:  30%|███       | 3/10 [00:08<00:19,  2.81s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9256, 'compress@10': 0.066, 'time@10': 4.1699}:  30%|███       | 3/10 [00:12<00:19,  2.81s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9256, 'compress@10': 0.066, 'time@10': 4.1699}:  40%|████      | 4/10 [00:12<00:19,  3.17s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9253, 'compress@10': 0.0568, 'time@10': 4.9776}:  40%|████      | 4/10 [00:16<00:19,  3.17s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9253, 'compress@10': 0.0568, 'time@10': 4.9776}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9335, 'compress@10': 0.0511, 'time@10': 5.1548}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9335, 'compress@10': 0.0511, 'time@10': 5.1548}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9359, 'compress@10': 0.0495, 'time@10': 5.3445}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9359, 'compress@10': 0.0495, 'time@10': 5.3445}:  70%|███████   | 7/10 [00:25<00:12,  4.03s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9429, 'compress@10': 0.0469, 'time@10': 5.2735}:  70%|███████   | 7/10 [00:30<00:12,  4.03s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9429, 'compress@10': 0.0469, 'time@10': 5.2735}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9452, 'compress@10': 0.0449, 'time@10': 5.6241}:  80%|████████  | 8/10 [00:35<00:08,  4.28s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9452, 'compress@10': 0.0449, 'time@10': 5.6241}:  90%|█████████ | 9/10 [00:35<00:04,  4.27s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9481, 'compress@10': 0.0427, 'time@10': 5.6241}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]  {'epoch': 40, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9481, 'compress@10': 0.0427, 'time@10': 5.6241}: 100%|██████████| 10/10 [00:40<00:00,  4.70s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9481, 'compress@10': 0.0427, 'time@10': 5.6241}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.014158494780762901
Avg hit ratio: 0.9024620667014555
Avg ndcg: 0.948072005627931
Avg compression ratio: 0.042686923694531545
Avg train time: 5.62410991191864
Std train time: 1.6028142204260751
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9111, 'compress@10': 0.0528, 'time@10': 5.0737}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9111, 'compress@10': 0.0528, 'time@10': 5.0737}:  10%|█         | 1/10 [00:02<00:24,  2.68s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9394, 'compress@10': 0.0426, 'time@10': 4.5857}:  10%|█         | 1/10 [00:06<00:24,  2.68s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9394, 'compress@10': 0.0426, 'time@10': 4.5857}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.912, 'compress@10': 0.076, 'time@10': 4.3356}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.912, 'compress@10': 0.076, 'time@10': 4.3356}:  30%|███       | 3/10 [00:08<00:19,  2.82s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9239, 'compress@10': 0.066, 'time@10': 4.1924}:  30%|███       | 3/10 [00:12<00:19,  2.82s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9239, 'compress@10': 0.066, 'time@10': 4.1924}:  40%|████      | 4/10 [00:12<00:19,  3.21s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9243, 'compress@10': 0.0568, 'time@10': 5.0142}:  40%|████      | 4/10 [00:16<00:19,  3.21s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9243, 'compress@10': 0.0568, 'time@10': 5.0142}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9324, 'compress@10': 0.0511, 'time@10': 5.1894}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9324, 'compress@10': 0.0511, 'time@10': 5.1894}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9349, 'compress@10': 0.0495, 'time@10': 5.4153}:  60%|██████    | 6/10 [00:26<00:17,  4.43s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9349, 'compress@10': 0.0495, 'time@10': 5.4153}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9315, 'compress@10': 0.0469, 'time@10': 5.3359}:  70%|███████   | 7/10 [00:31<00:12,  4.10s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9315, 'compress@10': 0.0469, 'time@10': 5.3359}:  80%|████████  | 8/10 [00:31<00:08,  4.33s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9441, 'compress@10': 0.0449, 'time@10': 5.6763}:  80%|████████  | 8/10 [00:35<00:08,  4.33s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9441, 'compress@10': 0.0449, 'time@10': 5.6763}:  90%|█████████ | 9/10 [00:35<00:04,  4.30s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9469, 'compress@10': 0.0427, 'time@10': 5.6695}:  90%|█████████ | 9/10 [00:41<00:04,  4.30s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9469, 'compress@10': 0.0427, 'time@10': 5.6695}: 100%|██████████| 10/10 [00:41<00:00,  4.72s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9469, 'compress@10': 0.0427, 'time@10': 5.6695}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.01566644819050795
Avg hit ratio: 0.8901763524157411
Avg ndcg: 0.946934006880231
Avg compression ratio: 0.04269759266272657
Avg train time: 5.6695081233978275
Std train time: 1.6237877395891855
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9094, 'compress@10': 0.0528, 'time@10': 5.0985}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9094, 'compress@10': 0.0528, 'time@10': 5.0985}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.893, 'ndcg@10': 0.938, 'compress@10': 0.0426, 'time@10': 4.5573}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it]  {'epoch': 42, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.893, 'ndcg@10': 0.938, 'compress@10': 0.0426, 'time@10': 4.5573}:  20%|██        | 2/10 [00:06<00:27,  3.46s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.911, 'compress@10': 0.076, 'time@10': 4.3158}:  20%|██        | 2/10 [00:08<00:27,  3.46s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.911, 'compress@10': 0.076, 'time@10': 4.3158}:  30%|███       | 3/10 [00:08<00:19,  2.77s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9232, 'compress@10': 0.066, 'time@10': 4.1696}:  30%|███       | 3/10 [00:12<00:19,  2.77s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9232, 'compress@10': 0.066, 'time@10': 4.1696}:  40%|████      | 4/10 [00:12<00:18,  3.17s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9252, 'compress@10': 0.0568, 'time@10': 4.9974}:  40%|████      | 4/10 [00:16<00:18,  3.17s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9252, 'compress@10': 0.0568, 'time@10': 4.9974}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9336, 'compress@10': 0.0511, 'time@10': 5.1794}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9336, 'compress@10': 0.0511, 'time@10': 5.1794}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9363, 'compress@10': 0.0495, 'time@10': 5.405}:  60%|██████    | 6/10 [00:26<00:17,  4.42s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9363, 'compress@10': 0.0495, 'time@10': 5.405}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9405, 'compress@10': 0.0469, 'time@10': 5.3261}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9405, 'compress@10': 0.0469, 'time@10': 5.3261}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9376, 'compress@10': 0.0449, 'time@10': 5.691}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9376, 'compress@10': 0.0449, 'time@10': 5.691}:  90%|█████████ | 9/10 [00:35<00:04,  4.33s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9397, 'compress@10': 0.0427, 'time@10': 5.6923}:  90%|█████████ | 9/10 [00:41<00:04,  4.33s/it] {'epoch': 42, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9397, 'compress@10': 0.0427, 'time@10': 5.6923}: 100%|██████████| 10/10 [00:41<00:00,  4.77s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9397, 'compress@10': 0.0427, 'time@10': 5.6923}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.013608645068703736
Avg hit ratio: 0.8866842889236777
Avg ndcg: 0.9396929580049157
Avg compression ratio: 0.042688530312772706
Avg train time: 5.692292046546936
Std train time: 1.6722905209300516
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.915, 'compress@10': 0.0528, 'time@10': 4.9002}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.915, 'compress@10': 0.0528, 'time@10': 4.9002}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9435, 'compress@10': 0.0426, 'time@10': 4.5119}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9435, 'compress@10': 0.0426, 'time@10': 4.5119}:  20%|██        | 2/10 [00:06<00:27,  3.47s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9147, 'compress@10': 0.076, 'time@10': 4.2884}:  20%|██        | 2/10 [00:08<00:27,  3.47s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9147, 'compress@10': 0.076, 'time@10': 4.2884}:  30%|███       | 3/10 [00:08<00:19,  2.78s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.926, 'compress@10': 0.066, 'time@10': 4.1557}:  30%|███       | 3/10 [00:12<00:19,  2.78s/it]   {'epoch': 43, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.926, 'compress@10': 0.066, 'time@10': 4.1557}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9276, 'compress@10': 0.0568, 'time@10': 5.001}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9276, 'compress@10': 0.0568, 'time@10': 5.001}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9418, 'compress@10': 0.0511, 'time@10': 5.1881}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9418, 'compress@10': 0.0511, 'time@10': 5.1881}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9434, 'compress@10': 0.0495, 'time@10': 5.396}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9434, 'compress@10': 0.0495, 'time@10': 5.396}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.958, 'compress@10': 0.0469, 'time@10': 5.3093}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.958, 'compress@10': 0.0469, 'time@10': 5.3093}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9613, 'compress@10': 0.0449, 'time@10': 5.6435}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9613, 'compress@10': 0.0449, 'time@10': 5.6435}:  90%|█████████ | 9/10 [00:35<00:04,  4.27s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9628, 'compress@10': 0.0427, 'time@10': 5.643}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9628, 'compress@10': 0.0427, 'time@10': 5.643}: 100%|██████████| 10/10 [00:40<00:00,  4.70s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9628, 'compress@10': 0.0427, 'time@10': 5.643}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.013903637642915006
Avg hit ratio: 0.8923985746379633
Avg ndcg: 0.9628247735929725
Avg compression ratio: 0.04268776188199167
Avg train time: 5.64302294254303
Std train time: 1.6255675913462515
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9111, 'compress@10': 0.0528, 'time@10': 4.9236}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9111, 'compress@10': 0.0528, 'time@10': 4.9236}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9394, 'compress@10': 0.0426, 'time@10': 4.573}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9394, 'compress@10': 0.0426, 'time@10': 4.573}:  20%|██        | 2/10 [00:06<00:28,  3.55s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.749, 'ndcg@10': 0.912, 'compress@10': 0.076, 'time@10': 4.3196}:  20%|██        | 2/10 [00:08<00:28,  3.55s/it]  {'epoch': 44, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.749, 'ndcg@10': 0.912, 'compress@10': 0.076, 'time@10': 4.3196}:  30%|███       | 3/10 [00:08<00:19,  2.82s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9239, 'compress@10': 0.066, 'time@10': 4.1918}:  30%|███       | 3/10 [00:12<00:19,  2.82s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9239, 'compress@10': 0.066, 'time@10': 4.1918}:  40%|████      | 4/10 [00:12<00:19,  3.22s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.9267, 'compress@10': 0.0568, 'time@10': 5.0139}:  40%|████      | 4/10 [00:16<00:19,  3.22s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.9267, 'compress@10': 0.0568, 'time@10': 5.0139}:  50%|█████     | 5/10 [00:16<00:17,  3.57s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9349, 'compress@10': 0.0511, 'time@10': 5.2013}:  50%|█████     | 5/10 [00:22<00:17,  3.57s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9349, 'compress@10': 0.0511, 'time@10': 5.2013}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.937, 'compress@10': 0.0495, 'time@10': 5.4315}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it] {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.937, 'compress@10': 0.0495, 'time@10': 5.4315}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9391, 'compress@10': 0.0469, 'time@10': 5.3463}:  70%|███████   | 7/10 [00:31<00:12,  4.13s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9391, 'compress@10': 0.0469, 'time@10': 5.3463}:  80%|████████  | 8/10 [00:31<00:08,  4.34s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9376, 'compress@10': 0.0449, 'time@10': 5.6608}:  80%|████████  | 8/10 [00:35<00:08,  4.34s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9376, 'compress@10': 0.0449, 'time@10': 5.6608}:  90%|█████████ | 9/10 [00:35<00:04,  4.27s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9399, 'compress@10': 0.0427, 'time@10': 5.6528}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9399, 'compress@10': 0.0427, 'time@10': 5.6528}: 100%|██████████| 10/10 [00:40<00:00,  4.69s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9399, 'compress@10': 0.0427, 'time@10': 5.6528}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.013592472419783008
Avg hit ratio: 0.8734021588673542
Avg ndcg: 0.9399074751080597
Avg compression ratio: 0.04268832109809265
Avg train time: 5.652756404876709
Std train time: 1.586109426799586
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9114, 'compress@10': 0.0528, 'time@10': 4.9645}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9114, 'compress@10': 0.0528, 'time@10': 4.9645}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9396, 'compress@10': 0.0426, 'time@10': 4.6189}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9396, 'compress@10': 0.0426, 'time@10': 4.6189}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9121, 'compress@10': 0.076, 'time@10': 4.3538}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9121, 'compress@10': 0.076, 'time@10': 4.3538}:  30%|███       | 3/10 [00:08<00:19,  2.84s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.924, 'compress@10': 0.066, 'time@10': 4.198}:  30%|███       | 3/10 [00:12<00:19,  2.84s/it]  {'epoch': 45, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.924, 'compress@10': 0.066, 'time@10': 4.198}:  40%|████      | 4/10 [00:12<00:19,  3.21s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9273, 'compress@10': 0.0568, 'time@10': 5.0322}:  40%|████      | 4/10 [00:16<00:19,  3.21s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9273, 'compress@10': 0.0568, 'time@10': 5.0322}:  50%|█████     | 5/10 [00:16<00:17,  3.57s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9345, 'compress@10': 0.0511, 'time@10': 5.2184}:  50%|█████     | 5/10 [00:22<00:17,  3.57s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9345, 'compress@10': 0.0511, 'time@10': 5.2184}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9375, 'compress@10': 0.0495, 'time@10': 5.4444}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9375, 'compress@10': 0.0495, 'time@10': 5.4444}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9416, 'compress@10': 0.0469, 'time@10': 5.3574}:  70%|███████   | 7/10 [00:31<00:12,  4.13s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9416, 'compress@10': 0.0469, 'time@10': 5.3574}:  80%|████████  | 8/10 [00:31<00:08,  4.34s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0096, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9456, 'compress@10': 0.0449, 'time@10': 5.6824}:  80%|████████  | 8/10 [00:35<00:08,  4.34s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0096, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9456, 'compress@10': 0.0449, 'time@10': 5.6824}:  90%|█████████ | 9/10 [00:35<00:04,  4.29s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9487, 'compress@10': 0.0427, 'time@10': 5.6683}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9487, 'compress@10': 0.0427, 'time@10': 5.6683}: 100%|██████████| 10/10 [00:40<00:00,  4.69s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9487, 'compress@10': 0.0427, 'time@10': 5.6683}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.00894549565447929
Avg hit ratio: 0.8952557174951062
Avg ndcg: 0.9486639173325043
Avg compression ratio: 0.04268360516982743
Avg train time: 5.668284749984741
Std train time: 1.6155386552822297
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9192, 'compress@10': 0.0528, 'time@10': 4.9063}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9192, 'compress@10': 0.0528, 'time@10': 4.9063}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 0.0426, 'time@10': 4.5298}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it] {'epoch': 46, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 0.0426, 'time@10': 4.5298}:  20%|██        | 2/10 [00:06<00:27,  3.49s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9159, 'compress@10': 0.076, 'time@10': 4.3005}:  20%|██        | 2/10 [00:08<00:27,  3.49s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9159, 'compress@10': 0.076, 'time@10': 4.3005}:  30%|███       | 3/10 [00:08<00:19,  2.83s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9269, 'compress@10': 0.066, 'time@10': 4.1706}:  30%|███       | 3/10 [00:12<00:19,  2.83s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9269, 'compress@10': 0.066, 'time@10': 4.1706}:  40%|████      | 4/10 [00:12<00:19,  3.22s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9299, 'compress@10': 0.0568, 'time@10': 4.9954}:  40%|████      | 4/10 [00:16<00:19,  3.22s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9299, 'compress@10': 0.0568, 'time@10': 4.9954}:  50%|█████     | 5/10 [00:16<00:17,  3.57s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9422, 'compress@10': 0.0511, 'time@10': 5.179}:  50%|█████     | 5/10 [00:22<00:17,  3.57s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9422, 'compress@10': 0.0511, 'time@10': 5.179}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0121, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9441, 'compress@10': 0.0495, 'time@10': 5.4051}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0121, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9441, 'compress@10': 0.0495, 'time@10': 5.4051}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.958, 'compress@10': 0.0469, 'time@10': 5.3253}:  70%|███████   | 7/10 [00:31<00:12,  4.11s/it]  {'epoch': 46, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.958, 'compress@10': 0.0469, 'time@10': 5.3253}:  80%|████████  | 8/10 [00:31<00:08,  4.33s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9567, 'compress@10': 0.0449, 'time@10': 5.6395}:  80%|████████  | 8/10 [00:35<00:08,  4.33s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9567, 'compress@10': 0.0449, 'time@10': 5.6395}:  90%|█████████ | 9/10 [00:35<00:04,  4.26s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9574, 'compress@10': 0.0427, 'time@10': 5.6181}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9574, 'compress@10': 0.0427, 'time@10': 5.6181}: 100%|██████████| 10/10 [00:40<00:00,  4.63s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9574, 'compress@10': 0.0427, 'time@10': 5.6181}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.014061306196535927
Avg hit ratio: 0.8854656509308463
Avg ndcg: 0.9574120181598019
Avg compression ratio: 0.04268362903422212
Avg train time: 5.618072819709778
Std train time: 1.583371232788479
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9096, 'compress@10': 0.0528, 'time@10': 5.121}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9096, 'compress@10': 0.0528, 'time@10': 5.121}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9375, 'compress@10': 0.0426, 'time@10': 4.6717}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9375, 'compress@10': 0.0426, 'time@10': 4.6717}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9107, 'compress@10': 0.076, 'time@10': 4.3779}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9107, 'compress@10': 0.076, 'time@10': 4.3779}:  30%|███       | 3/10 [00:08<00:19,  2.83s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.923, 'compress@10': 0.066, 'time@10': 4.2157}:  30%|███       | 3/10 [00:12<00:19,  2.83s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.923, 'compress@10': 0.066, 'time@10': 4.2157}:  40%|████      | 4/10 [00:12<00:19,  3.22s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9278, 'compress@10': 0.0568, 'time@10': 5.0468}:  40%|████      | 4/10 [00:16<00:19,  3.22s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9278, 'compress@10': 0.0568, 'time@10': 5.0468}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9358, 'compress@10': 0.0511, 'time@10': 5.2234}:  50%|█████     | 5/10 [00:22<00:17,  3.58s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9358, 'compress@10': 0.0511, 'time@10': 5.2234}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9388, 'compress@10': 0.0495, 'time@10': 5.4543}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9388, 'compress@10': 0.0495, 'time@10': 5.4543}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9412, 'compress@10': 0.0469, 'time@10': 5.3733}:  70%|███████   | 7/10 [00:31<00:12,  4.13s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9412, 'compress@10': 0.0469, 'time@10': 5.3733}:  80%|████████  | 8/10 [00:31<00:08,  4.36s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9494, 'compress@10': 0.0449, 'time@10': 5.6892}:  80%|████████  | 8/10 [00:35<00:08,  4.36s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9494, 'compress@10': 0.0449, 'time@10': 5.6892}:  90%|█████████ | 9/10 [00:35<00:04,  4.29s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.952, 'compress@10': 0.0427, 'time@10': 5.6705}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.952, 'compress@10': 0.0427, 'time@10': 5.6705}: 100%|██████████| 10/10 [00:40<00:00,  4.68s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.952, 'compress@10': 0.0427, 'time@10': 5.6705}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.011204458779887645
Avg hit ratio: 0.8905450160102113
Avg ndcg: 0.9520096756443743
Avg compression ratio: 0.04268245956855378
Avg train time: 5.67049765586853
Std train time: 1.6065824358186453
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.0528, 'time@10': 4.7477}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.0528, 'time@10': 4.7477}:  10%|█         | 1/10 [00:02<00:21,  2.42s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9448, 'compress@10': 0.0426, 'time@10': 4.4557}:  10%|█         | 1/10 [00:06<00:21,  2.42s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9448, 'compress@10': 0.0426, 'time@10': 4.4557}:  20%|██        | 2/10 [00:06<00:28,  3.50s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9156, 'compress@10': 0.076, 'time@10': 4.2537}:  20%|██        | 2/10 [00:08<00:28,  3.50s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9156, 'compress@10': 0.076, 'time@10': 4.2537}:  30%|███       | 3/10 [00:08<00:19,  2.80s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9266, 'compress@10': 0.066, 'time@10': 4.1241}:  30%|███       | 3/10 [00:12<00:19,  2.80s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9266, 'compress@10': 0.066, 'time@10': 4.1241}:  40%|████      | 4/10 [00:12<00:19,  3.19s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9312, 'compress@10': 0.0568, 'time@10': 4.993}:  40%|████      | 4/10 [00:16<00:19,  3.19s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9312, 'compress@10': 0.0568, 'time@10': 4.993}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9384, 'compress@10': 0.0511, 'time@10': 5.167}:  50%|█████     | 5/10 [00:22<00:17,  3.58s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9384, 'compress@10': 0.0511, 'time@10': 5.167}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9411, 'compress@10': 0.0495, 'time@10': 5.3948}:  60%|██████    | 6/10 [00:26<00:17,  4.43s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9411, 'compress@10': 0.0495, 'time@10': 5.3948}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0093, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9452, 'compress@10': 0.0469, 'time@10': 5.3097}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0093, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9452, 'compress@10': 0.0469, 'time@10': 5.3097}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9416, 'compress@10': 0.0449, 'time@10': 5.6144}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9416, 'compress@10': 0.0449, 'time@10': 5.6144}:  90%|█████████ | 9/10 [00:35<00:04,  4.23s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9444, 'compress@10': 0.0427, 'time@10': 5.6098}:  90%|█████████ | 9/10 [00:40<00:04,  4.23s/it]    {'epoch': 48, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9444, 'compress@10': 0.0427, 'time@10': 5.6098}: 100%|██████████| 10/10 [00:40<00:00,  4.66s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9444, 'compress@10': 0.0427, 'time@10': 5.6098}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.013045373510503343
Avg hit ratio: 0.8966279653189669
Avg ndcg: 0.9444108130375275
Avg compression ratio: 0.04268296642604858
Avg train time: 5.609771752357483
Std train time: 1.6092050043930037
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9332, 'compress@10': 0.0528, 'time@10': 4.7926}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9332, 'compress@10': 0.0528, 'time@10': 4.7926}:  10%|█         | 1/10 [00:02<00:21,  2.44s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9505, 'compress@10': 0.0426, 'time@10': 4.4947}:  10%|█         | 1/10 [00:06<00:21,  2.44s/it] {'epoch': 49, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9505, 'compress@10': 0.0426, 'time@10': 4.4947}:  20%|██        | 2/10 [00:06<00:27,  3.50s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9194, 'compress@10': 0.076, 'time@10': 4.2869}:  20%|██        | 2/10 [00:08<00:27,  3.50s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9194, 'compress@10': 0.076, 'time@10': 4.2869}:  30%|███       | 3/10 [00:08<00:19,  2.80s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9295, 'compress@10': 0.066, 'time@10': 4.1719}:  30%|███       | 3/10 [00:12<00:19,  2.80s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9295, 'compress@10': 0.066, 'time@10': 4.1719}:  40%|████      | 4/10 [00:12<00:19,  3.22s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9357, 'compress@10': 0.0568, 'time@10': 5.0308}:  40%|████      | 4/10 [00:16<00:19,  3.22s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9357, 'compress@10': 0.0568, 'time@10': 5.0308}:  50%|█████     | 5/10 [00:16<00:18,  3.60s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9417, 'compress@10': 0.0511, 'time@10': 5.1351}:  50%|█████     | 5/10 [00:22<00:18,  3.60s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9417, 'compress@10': 0.0511, 'time@10': 5.1351}:  60%|██████    | 6/10 [00:22<00:17,  4.31s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9436, 'compress@10': 0.0495, 'time@10': 5.27}:  60%|██████    | 6/10 [00:25<00:17,  4.31s/it]  {'epoch': 49, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9436, 'compress@10': 0.0495, 'time@10': 5.27}:  70%|███████   | 7/10 [00:25<00:11,  3.91s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9683, 'compress@10': 0.0469, 'time@10': 5.1474}:  70%|███████   | 7/10 [00:29<00:11,  3.91s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9683, 'compress@10': 0.0469, 'time@10': 5.1474}:  80%|████████  | 8/10 [00:29<00:08,  4.04s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9749, 'compress@10': 0.0449, 'time@10': 5.3575}:  80%|████████  | 8/10 [00:33<00:08,  4.04s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9749, 'compress@10': 0.0449, 'time@10': 5.3575}:  90%|█████████ | 9/10 [00:33<00:03,  3.89s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9751, 'compress@10': 0.0427, 'time@10': 5.2604}:  90%|█████████ | 9/10 [00:37<00:03,  3.89s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9751, 'compress@10': 0.0427, 'time@10': 5.2604}: 100%|██████████| 10/10 [00:37<00:00,  4.06s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9751, 'compress@10': 0.0427, 'time@10': 5.2604}: 100%|██████████| 10/10 [00:37<00:00,  3.79s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.012476749342409468
Avg hit ratio: 0.9024620667014555
Avg ndcg: 0.9751004357043627
Avg compression ratio: 0.04268289912991657
Avg train time: 5.260423183441162
Std train time: 1.4597384540634724
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
