  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.164, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5081, 'compress@10': 0.5263, 'time@10': 9.8614}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.164, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5081, 'compress@10': 0.5263, 'time@10': 9.8614}:  10%|█         | 1/10 [00:04<00:44,  4.97s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1172, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.6521, 'compress@10': 0.5212, 'time@10': 8.5153}:  10%|█         | 1/10 [00:12<00:44,  4.97s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1172, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.6521, 'compress@10': 0.5212, 'time@10': 8.5153}:  20%|██        | 2/10 [00:12<00:50,  6.29s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7408, 'hit_ratio@10': 0.5764, 'ndcg@10': 0.4347, 'compress@10': 0.538, 'time@10': 6.6262}:  20%|██        | 2/10 [00:13<00:50,  6.29s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.7408, 'hit_ratio@10': 0.5764, 'ndcg@10': 0.4347, 'compress@10': 0.538, 'time@10': 6.6262}:  30%|███       | 3/10 [00:13<00:28,  4.08s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5801, 'hit_ratio@10': 0.6287, 'ndcg@10': 0.4857, 'compress@10': 0.5329, 'time@10': 6.5797}:  30%|███       | 3/10 [00:20<00:28,  4.08s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5801, 'hit_ratio@10': 0.6287, 'ndcg@10': 0.4857, 'compress@10': 0.5329, 'time@10': 6.5797}:  40%|████      | 4/10 [00:20<00:30,  5.03s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4826, 'hit_ratio@10': 0.667, 'ndcg@10': 0.54, 'compress@10': 0.5283, 'time@10': 10.0637}:  40%|████      | 4/10 [00:32<00:30,  5.03s/it]  {'epoch': 0, 'num_users': 5.8, 'loss': 0.4826, 'hit_ratio@10': 0.667, 'ndcg@10': 0.54, 'compress@10': 0.5283, 'time@10': 10.0637}:  50%|█████     | 5/10 [00:32<00:37,  7.56s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4164, 'hit_ratio@10': 0.6669, 'ndcg@10': 0.5856, 'compress@10': 0.5255, 'time@10': 10.1618}:  50%|█████     | 5/10 [00:42<00:37,  7.56s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4164, 'hit_ratio@10': 0.6669, 'ndcg@10': 0.5856, 'compress@10': 0.5255, 'time@10': 10.1618}:  60%|██████    | 6/10 [00:42<00:34,  8.62s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3719, 'hit_ratio@10': 0.6802, 'ndcg@10': 0.5854, 'compress@10': 0.5247, 'time@10': 10.3327}:  60%|██████    | 6/10 [00:48<00:34,  8.62s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3719, 'hit_ratio@10': 0.6802, 'ndcg@10': 0.5854, 'compress@10': 0.5247, 'time@10': 10.3327}:  70%|███████   | 7/10 [00:48<00:23,  7.67s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3312, 'hit_ratio@10': 0.7095, 'ndcg@10': 0.612, 'compress@10': 0.5234, 'time@10': 10.0604}:  70%|███████   | 7/10 [00:56<00:23,  7.67s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.3312, 'hit_ratio@10': 0.7095, 'ndcg@10': 0.612, 'compress@10': 0.5234, 'time@10': 10.0604}:  80%|████████  | 8/10 [00:56<00:15,  7.84s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2996, 'hit_ratio@10': 0.7132, 'ndcg@10': 0.6452, 'compress@10': 0.5224, 'time@10': 10.7526}:  80%|████████  | 8/10 [01:04<00:15,  7.84s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2996, 'hit_ratio@10': 0.7132, 'ndcg@10': 0.6452, 'compress@10': 0.5224, 'time@10': 10.7526}:  90%|█████████ | 9/10 [01:04<00:07,  7.94s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2749, 'hit_ratio@10': 0.735, 'ndcg@10': 0.6652, 'compress@10': 0.5213, 'time@10': 10.7237}:  90%|█████████ | 9/10 [01:15<00:07,  7.94s/it]    {'epoch': 0, 'num_users': 6.3, 'loss': 0.2749, 'hit_ratio@10': 0.735, 'ndcg@10': 0.6652, 'compress@10': 0.5213, 'time@10': 10.7237}: 100%|██████████| 10/10 [01:15<00:00,  8.74s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2749, 'hit_ratio@10': 0.735, 'ndcg@10': 0.6652, 'compress@10': 0.5213, 'time@10': 10.7237}: 100%|██████████| 10/10 [01:15<00:00,  7.55s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.27485344445273263
Avg hit ratio: 0.7350422757774201
Avg ndcg: 0.6651901549421715
Avg compression ratio: 0.5212749006657823
Avg train time: 10.72369601726532
Std train time: 5.550540607804892
[0.75, 0.25, 0.75, 0.75, 0.75, 0.25, 0.75, 0.25, 0.25, 0.25]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0521, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8415, 'compress@10': 0.7632, 'time@10': 8.6421}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0521, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8415, 'compress@10': 0.7632, 'time@10': 8.6421}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0525, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8496, 'compress@10': 0.5187, 'time@10': 7.9072}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0525, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8496, 'compress@10': 0.5187, 'time@10': 7.9072}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0418, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.8213, 'compress@10': 0.6077, 'time@10': 6.2988}:  20%|██        | 2/10 [00:13<00:48,  6.04s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0418, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.8213, 'compress@10': 0.6077, 'time@10': 6.2988}:  30%|███       | 3/10 [00:13<00:27,  4.00s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0437, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8277, 'compress@10': 0.6455, 'time@10': 6.3161}:  30%|███       | 3/10 [00:19<00:27,  4.00s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0437, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8277, 'compress@10': 0.6455, 'time@10': 6.3161}:  40%|████      | 4/10 [00:19<00:29,  4.95s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0524, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8192, 'compress@10': 0.6674, 'time@10': 9.2119}:  40%|████      | 4/10 [00:30<00:29,  4.95s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0524, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8192, 'compress@10': 0.6674, 'time@10': 9.2119}:  50%|█████     | 5/10 [00:30<00:35,  7.04s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0565, 'hit_ratio@10': 0.7782, 'ndcg@10': 0.8176, 'compress@10': 0.6006, 'time@10': 9.422}:  50%|█████     | 5/10 [00:40<00:35,  7.04s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0565, 'hit_ratio@10': 0.7782, 'ndcg@10': 0.8176, 'compress@10': 0.6006, 'time@10': 9.422}:  60%|██████    | 6/10 [00:40<00:32,  8.22s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0546, 'hit_ratio@10': 0.8042, 'ndcg@10': 0.8255, 'compress@10': 0.6234, 'time@10': 9.6771}:  60%|██████    | 6/10 [00:46<00:32,  8.22s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0546, 'hit_ratio@10': 0.8042, 'ndcg@10': 0.8255, 'compress@10': 0.6234, 'time@10': 9.6771}:  70%|███████   | 7/10 [00:46<00:22,  7.38s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0523, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8313, 'compress@10': 0.5794, 'time@10': 9.4777}:  70%|███████   | 7/10 [00:54<00:22,  7.38s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0523, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8313, 'compress@10': 0.5794, 'time@10': 9.4777}:  80%|████████  | 8/10 [00:54<00:15,  7.62s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8001, 'ndcg@10': 0.8401, 'compress@10': 0.5452, 'time@10': 10.0206}:  80%|████████  | 8/10 [01:01<00:15,  7.62s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8001, 'ndcg@10': 0.8401, 'compress@10': 0.5452, 'time@10': 10.0206}:  90%|█████████ | 9/10 [01:01<00:07,  7.49s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8407, 'compress@10': 0.5174, 'time@10': 10.0611}:  90%|█████████ | 9/10 [01:12<00:07,  7.49s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8407, 'compress@10': 0.5174, 'time@10': 10.0611}: 100%|██████████| 10/10 [01:12<00:00,  8.41s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8407, 'compress@10': 0.5174, 'time@10': 10.0611}: 100%|██████████| 10/10 [01:12<00:00,  7.23s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.04990779391672708
Avg hit ratio: 0.8132536375150977
Avg ndcg: 0.8407231580165581
Avg compression ratio: 0.5173535808019302
Avg train time: 10.061148023605346
Std train time: 4.604022522614584
[0.8333333333333334, 0.5, 0.5, 0.8333333333333334, 0.8333333333333334, 0.5, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.8421, 'time@10': 8.0217}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.8421, 'time@10': 8.0217}:  10%|█         | 1/10 [00:04<00:36,  4.05s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.798, 'ndcg@10': 0.85, 'compress@10': 0.6791, 'time@10': 7.6048}:  10%|█         | 1/10 [00:11<00:36,  4.05s/it]   {'epoch': 2, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.798, 'ndcg@10': 0.85, 'compress@10': 0.6791, 'time@10': 7.6048}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8524, 'compress@10': 0.6432, 'time@10': 6.181}:  20%|██        | 2/10 [00:12<00:47,  5.92s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8524, 'compress@10': 0.6432, 'time@10': 6.181}:  30%|███       | 3/10 [00:12<00:27,  3.99s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8501, 'compress@10': 0.6922, 'time@10': 6.128}:  30%|███       | 3/10 [00:18<00:27,  3.99s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8501, 'compress@10': 0.6922, 'time@10': 6.128}:  40%|████      | 4/10 [00:18<00:28,  4.79s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8369, 'compress@10': 0.7211, 'time@10': 8.409}:  40%|████      | 4/10 [00:27<00:28,  4.79s/it]  {'epoch': 2, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8369, 'compress@10': 0.7211, 'time@10': 8.409}:  50%|█████     | 5/10 [00:27<00:31,  6.24s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0521, 'hit_ratio@10': 0.7723, 'ndcg@10': 0.8337, 'compress@10': 0.6861, 'time@10': 8.7757}:  50%|█████     | 5/10 [00:38<00:31,  6.24s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0521, 'hit_ratio@10': 0.7723, 'ndcg@10': 0.8337, 'compress@10': 0.6861, 'time@10': 8.7757}:  60%|██████    | 6/10 [00:38<00:30,  7.74s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.7991, 'ndcg@10': 0.8348, 'compress@10': 0.6624, 'time@10': 9.1531}:  60%|██████    | 6/10 [00:44<00:30,  7.74s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.7991, 'ndcg@10': 0.8348, 'compress@10': 0.6624, 'time@10': 9.1531}:  70%|███████   | 7/10 [00:44<00:21,  7.08s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0514, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8372, 'compress@10': 0.6034, 'time@10': 8.9921}:  70%|███████   | 7/10 [00:52<00:21,  7.08s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0514, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.8372, 'compress@10': 0.6034, 'time@10': 8.9921}:  80%|████████  | 8/10 [00:52<00:14,  7.34s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0503, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8449, 'compress@10': 0.5575, 'time@10': 9.5522}:  80%|████████  | 8/10 [00:59<00:14,  7.34s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0503, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8449, 'compress@10': 0.5575, 'time@10': 9.5522}:  90%|█████████ | 9/10 [00:59<00:07,  7.25s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8457, 'compress@10': 0.5203, 'time@10': 9.5892}:  90%|█████████ | 9/10 [01:09<00:07,  7.25s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8457, 'compress@10': 0.5203, 'time@10': 9.5892}: 100%|██████████| 10/10 [01:09<00:00,  8.09s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8457, 'compress@10': 0.5203, 'time@10': 9.5892}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04974788738514241
Avg hit ratio: 0.8211076812265267
Avg ndcg: 0.8457171814247024
Avg compression ratio: 0.5203258669819708
Avg train time: 9.589213061332703
Std train time: 3.8829932302120453
[0.625, 0.625, 0.375, 0.875, 0.875, 0.625, 0.375, 0.375, 0.125, 0.125]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8533, 'compress@10': 0.6447, 'time@10': 8.5232}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8533, 'compress@10': 0.6447, 'time@10': 8.5232}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8566, 'compress@10': 0.6409, 'time@10': 7.9731}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8566, 'compress@10': 0.6409, 'time@10': 7.9731}:  20%|██        | 2/10 [00:11<00:49,  6.16s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8568, 'compress@10': 0.582, 'time@10': 6.5651}:  20%|██        | 2/10 [00:13<00:49,  6.16s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8568, 'compress@10': 0.582, 'time@10': 6.5651}:  30%|███       | 3/10 [00:13<00:29,  4.22s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8514, 'compress@10': 0.6564, 'time@10': 6.4071}:  30%|███       | 3/10 [00:19<00:29,  4.22s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8514, 'compress@10': 0.6564, 'time@10': 6.4071}:  40%|████      | 4/10 [00:19<00:29,  4.91s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0462, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8395, 'compress@10': 0.7006, 'time@10': 8.1255}:  40%|████      | 4/10 [00:27<00:29,  4.91s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0462, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8395, 'compress@10': 0.7006, 'time@10': 8.1255}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8364, 'compress@10': 0.6894, 'time@10': 8.5531}:  50%|█████     | 5/10 [00:37<00:29,  5.86s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8364, 'compress@10': 0.6894, 'time@10': 8.5531}:  60%|██████    | 6/10 [00:37<00:30,  7.51s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8379, 'compress@10': 0.6481, 'time@10': 8.9439}:  60%|██████    | 6/10 [00:43<00:30,  7.51s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8379, 'compress@10': 0.6481, 'time@10': 8.9439}:  70%|███████   | 7/10 [00:43<00:20,  6.91s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0515, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8501, 'compress@10': 0.6162, 'time@10': 8.8272}:  70%|███████   | 7/10 [00:51<00:20,  6.91s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0515, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8501, 'compress@10': 0.6162, 'time@10': 8.8272}:  80%|████████  | 8/10 [00:51<00:14,  7.27s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8592, 'compress@10': 0.5644, 'time@10': 9.369}:  80%|████████  | 8/10 [00:58<00:14,  7.27s/it]  {'epoch': 3, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8592, 'compress@10': 0.5644, 'time@10': 9.369}:  90%|█████████ | 9/10 [00:58<00:07,  7.15s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8587, 'compress@10': 0.5224, 'time@10': 9.3956}:  90%|█████████ | 9/10 [01:08<00:07,  7.15s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8587, 'compress@10': 0.5224, 'time@10': 9.3956}: 100%|██████████| 10/10 [01:08<00:00,  7.93s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8587, 'compress@10': 0.5224, 'time@10': 9.3956}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.049473946992069695
Avg hit ratio: 0.8294922178368699
Avg ndcg: 0.8587336580026239
Avg compression ratio: 0.5224132499402163
Avg train time: 9.395573997497559
Std train time: 3.2513484849745793
[0.5, 0.7, 0.3, 0.7, 0.9, 0.7, 0.5, 0.5, 0.1, 0.1]
[10, 10, 14, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8568, 'compress@10': 0.5263, 'time@10': 9.2613}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8568, 'compress@10': 0.5263, 'time@10': 9.2613}:  10%|█         | 1/10 [00:04<00:42,  4.67s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8695, 'compress@10': 0.618, 'time@10': 8.1753}:  10%|█         | 1/10 [00:11<00:42,  4.67s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8695, 'compress@10': 0.618, 'time@10': 8.1753}:  20%|██        | 2/10 [00:11<00:48,  6.12s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8654, 'compress@10': 0.5453, 'time@10': 6.7477}:  20%|██        | 2/10 [00:13<00:48,  6.12s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8654, 'compress@10': 0.5453, 'time@10': 6.7477}:  30%|███       | 3/10 [00:13<00:29,  4.23s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0361, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8585, 'compress@10': 0.5867, 'time@10': 6.7101}:  30%|███       | 3/10 [00:20<00:29,  4.23s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0361, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8585, 'compress@10': 0.5867, 'time@10': 6.7101}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0451, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.846, 'compress@10': 0.6497, 'time@10': 8.434}:  40%|████      | 4/10 [00:28<00:31,  5.18s/it]  {'epoch': 4, 'num_users': 5.8, 'loss': 0.0451, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.846, 'compress@10': 0.6497, 'time@10': 8.434}:  50%|█████     | 5/10 [00:28<00:30,  6.09s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0485, 'hit_ratio@10': 0.7962, 'ndcg@10': 0.8427, 'compress@10': 0.6592, 'time@10': 8.7739}:  50%|█████     | 5/10 [00:38<00:30,  6.09s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0485, 'hit_ratio@10': 0.7962, 'ndcg@10': 0.8427, 'compress@10': 0.6592, 'time@10': 8.7739}:  60%|██████    | 6/10 [00:38<00:30,  7.59s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0482, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.844, 'compress@10': 0.6393, 'time@10': 9.1818}:  60%|██████    | 6/10 [00:44<00:30,  7.59s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0482, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.844, 'compress@10': 0.6393, 'time@10': 9.1818}:  70%|███████   | 7/10 [00:44<00:21,  7.02s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0489, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8516, 'compress@10': 0.6237, 'time@10': 9.048}:  70%|███████   | 7/10 [00:52<00:21,  7.02s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0489, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8516, 'compress@10': 0.6237, 'time@10': 9.048}:  80%|████████  | 8/10 [00:52<00:14,  7.38s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0492, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8564, 'compress@10': 0.5684, 'time@10': 9.5743}:  80%|████████  | 8/10 [00:59<00:14,  7.38s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0492, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8564, 'compress@10': 0.5684, 'time@10': 9.5743}:  90%|█████████ | 9/10 [00:59<00:07,  7.24s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8562, 'compress@10': 0.5236, 'time@10': 9.5556}:  90%|█████████ | 9/10 [01:08<00:07,  7.24s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8562, 'compress@10': 0.5236, 'time@10': 9.5556}: 100%|██████████| 10/10 [01:08<00:00,  7.91s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8562, 'compress@10': 0.5236, 'time@10': 9.5556}: 100%|██████████| 10/10 [01:08<00:00,  6.90s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04861308090912459
Avg hit ratio: 0.8354445987892507
Avg ndcg: 0.8561778852103217
Avg compression ratio: 0.5235797570350663
Avg train time: 9.555570340156555
Std train time: 3.2476635937610885
[0.4166666666666667, 0.75, 0.25, 0.5833333333333333, 0.9166666666666667, 0.75, 0.4166666666666667, 0.5833333333333334, 0.25, 0.08333333333333334]
[10, 10, 15, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.4474, 'time@10': 8.5513}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.4474, 'time@10': 8.5513}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8626, 'compress@10': 0.6027, 'time@10': 7.7794}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8626, 'compress@10': 0.6027, 'time@10': 7.7794}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8608, 'compress@10': 0.5209, 'time@10': 6.589}:  20%|██        | 2/10 [00:13<00:47,  5.92s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8608, 'compress@10': 0.5209, 'time@10': 6.589}:  30%|███       | 3/10 [00:13<00:29,  4.19s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0361, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8552, 'compress@10': 0.5402, 'time@10': 6.553}:  30%|███       | 3/10 [00:19<00:29,  4.19s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0361, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8552, 'compress@10': 0.5402, 'time@10': 6.553}:  40%|████      | 4/10 [00:19<00:30,  5.10s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0444, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.844, 'compress@10': 0.6158, 'time@10': 8.3344}:  40%|████      | 4/10 [00:27<00:30,  5.10s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0444, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.844, 'compress@10': 0.6158, 'time@10': 8.3344}:  50%|█████     | 5/10 [00:27<00:30,  6.06s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0471, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8419, 'compress@10': 0.6391, 'time@10': 8.726}:  50%|█████     | 5/10 [00:38<00:30,  6.06s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0471, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8419, 'compress@10': 0.6391, 'time@10': 8.726}:  60%|██████    | 6/10 [00:38<00:30,  7.64s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0464, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8445, 'compress@10': 0.6107, 'time@10': 9.1387}:  60%|██████    | 6/10 [00:44<00:30,  7.64s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0464, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8445, 'compress@10': 0.6107, 'time@10': 9.1387}:  70%|███████   | 7/10 [00:44<00:21,  7.06s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0467, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8515, 'compress@10': 0.6087, 'time@10': 9.0306}:  70%|███████   | 7/10 [00:52<00:21,  7.06s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0467, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8515, 'compress@10': 0.6087, 'time@10': 9.0306}:  80%|████████  | 8/10 [00:52<00:14,  7.46s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0455, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8584, 'compress@10': 0.5713, 'time@10': 9.626}:  80%|████████  | 8/10 [00:59<00:14,  7.46s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0455, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8584, 'compress@10': 0.5713, 'time@10': 9.626}:  90%|█████████ | 9/10 [00:59<00:07,  7.39s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0449, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8583, 'compress@10': 0.5245, 'time@10': 9.5855}:  90%|█████████ | 9/10 [01:09<00:07,  7.39s/it]  {'epoch': 5, 'num_users': 6.3, 'loss': 0.0449, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8583, 'compress@10': 0.5245, 'time@10': 9.5855}: 100%|██████████| 10/10 [01:09<00:00,  7.97s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0449, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8583, 'compress@10': 0.5245, 'time@10': 9.5855}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04492349962485967
Avg hit ratio: 0.8698096781543301
Avg ndcg: 0.8583426321729654
Avg compression ratio: 0.5245489356545764
Avg train time: 9.585505366325378
Std train time: 3.335335418908121
[0.35714285714285715, 0.7857142857142857, 0.2142857142857143, 0.6428571428571428, 0.9285714285714286, 0.7857142857142857, 0.35714285714285715, 0.6428571428571429, 0.2142857142857143, 0.07142857142857144]
[10, 10, 16, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.391, 'time@10': 8.8}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.391, 'time@10': 8.8}:  10%|█         | 1/10 [00:04<00:39,  4.44s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8491, 'compress@10': 0.5918, 'time@10': 7.9765}:  10%|█         | 1/10 [00:11<00:39,  4.44s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8491, 'compress@10': 0.5918, 'time@10': 7.9765}:  20%|██        | 2/10 [00:11<00:48,  6.06s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8517, 'compress@10': 0.5034, 'time@10': 6.7725}:  20%|██        | 2/10 [00:13<00:48,  6.06s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8517, 'compress@10': 0.5034, 'time@10': 6.7725}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8511, 'compress@10': 0.5414, 'time@10': 6.6868}:  30%|███       | 3/10 [00:20<00:30,  4.30s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8511, 'compress@10': 0.5414, 'time@10': 6.6868}:  40%|████      | 4/10 [00:20<00:30,  5.16s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0439, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8413, 'compress@10': 0.6191, 'time@10': 8.3728}:  40%|████      | 4/10 [00:27<00:30,  5.16s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0439, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8413, 'compress@10': 0.6191, 'time@10': 8.3728}:  50%|█████     | 5/10 [00:27<00:30,  6.04s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0459, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8406, 'compress@10': 0.6477, 'time@10': 8.7488}:  50%|█████     | 5/10 [00:38<00:30,  6.04s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0459, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8406, 'compress@10': 0.6477, 'time@10': 8.7488}:  60%|██████    | 6/10 [00:38<00:30,  7.61s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.045, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8454, 'compress@10': 0.6099, 'time@10': 9.1417}:  60%|██████    | 6/10 [00:44<00:30,  7.61s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.045, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8454, 'compress@10': 0.6099, 'time@10': 9.1417}:  70%|███████   | 7/10 [00:44<00:21,  7.02s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0452, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8527, 'compress@10': 0.6153, 'time@10': 9.0385}:  70%|███████   | 7/10 [00:52<00:21,  7.02s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0452, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8527, 'compress@10': 0.6153, 'time@10': 9.0385}:  80%|████████  | 8/10 [00:52<00:14,  7.44s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0442, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8617, 'compress@10': 0.5732, 'time@10': 9.5829}:  80%|████████  | 8/10 [00:59<00:14,  7.44s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0442, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8617, 'compress@10': 0.5732, 'time@10': 9.5829}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.043, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8625, 'compress@10': 0.5251, 'time@10': 9.5498}:  90%|█████████ | 9/10 [01:09<00:07,  7.31s/it]    {'epoch': 6, 'num_users': 6.3, 'loss': 0.043, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8625, 'compress@10': 0.5251, 'time@10': 9.5498}: 100%|██████████| 10/10 [01:09<00:00,  7.92s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.043, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8625, 'compress@10': 0.5251, 'time@10': 9.5498}: 100%|██████████| 10/10 [01:09<00:00,  6.90s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04297621653319132
Avg hit ratio: 0.8698096781543301
Avg ndcg: 0.8625353567396686
Avg compression ratio: 0.5251381761026791
Avg train time: 9.549765396118165
Std train time: 3.158378482369437
[0.4375, 0.6875, 0.1875, 0.6875, 0.9375, 0.8125, 0.3125, 0.6875, 0.1875, 0.06250000000000001]
[10, 10, 17, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.4671, 'time@10': 8.6427}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.4671, 'time@10': 8.6427}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8614, 'compress@10': 0.5823, 'time@10': 7.9083}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8614, 'compress@10': 0.5823, 'time@10': 7.9083}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.86, 'compress@10': 0.4894, 'time@10': 6.8019}:  20%|██        | 2/10 [00:13<00:48,  6.04s/it]  {'epoch': 7, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.86, 'compress@10': 0.4894, 'time@10': 6.8019}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8584, 'compress@10': 0.5417, 'time@10': 6.6715}:  30%|███       | 3/10 [00:20<00:30,  4.34s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8584, 'compress@10': 0.5417, 'time@10': 6.6715}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0422, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8473, 'compress@10': 0.6211, 'time@10': 8.3655}:  40%|████      | 4/10 [00:27<00:30,  5.12s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0422, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8473, 'compress@10': 0.6211, 'time@10': 8.3655}:  50%|█████     | 5/10 [00:27<00:30,  6.02s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0437, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8478, 'compress@10': 0.6537, 'time@10': 8.789}:  50%|█████     | 5/10 [00:38<00:30,  6.02s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0437, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8478, 'compress@10': 0.6537, 'time@10': 8.789}:  60%|██████    | 6/10 [00:38<00:30,  7.69s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0429, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8468, 'compress@10': 0.6089, 'time@10': 9.1696}:  60%|██████    | 6/10 [00:44<00:30,  7.69s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0429, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8468, 'compress@10': 0.6089, 'time@10': 9.1696}:  70%|███████   | 7/10 [00:44<00:21,  7.06s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0429, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.8546, 'compress@10': 0.6198, 'time@10': 9.044}:  70%|███████   | 7/10 [00:52<00:21,  7.06s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.0429, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.8546, 'compress@10': 0.6198, 'time@10': 9.044}:  80%|████████  | 8/10 [00:52<00:14,  7.43s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0424, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8649, 'compress@10': 0.5744, 'time@10': 9.6431}:  80%|████████  | 8/10 [00:59<00:14,  7.43s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0424, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8649, 'compress@10': 0.5744, 'time@10': 9.6431}:  90%|█████████ | 9/10 [00:59<00:07,  7.37s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0421, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8659, 'compress@10': 0.5253, 'time@10': 9.591}:  90%|█████████ | 9/10 [01:09<00:07,  7.37s/it]    {'epoch': 7, 'num_users': 6.3, 'loss': 0.0421, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8659, 'compress@10': 0.5253, 'time@10': 9.591}: 100%|██████████| 10/10 [01:09<00:00,  7.92s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0421, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8659, 'compress@10': 0.5253, 'time@10': 9.591}: 100%|██████████| 10/10 [01:09<00:00,  6.92s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04205278892288733
Avg hit ratio: 0.8768161483866066
Avg ndcg: 0.8659448627665547
Avg compression ratio: 0.5253256289788879
Avg train time: 9.590975880622864
Std train time: 3.2320558611743775
[0.5, 0.6111111111111112, 0.16666666666666666, 0.7222222222222222, 0.9444444444444444, 0.8333333333333334, 0.2777777777777778, 0.7222222222222222, 0.16666666666666666, 0.055555555555555566]
[10, 10, 18, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0548, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8333, 'compress@10': 0.5263, 'time@10': 8.9453}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0548, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8333, 'compress@10': 0.5263, 'time@10': 8.9453}:  10%|█         | 1/10 [00:04<00:40,  4.51s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0448, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8585, 'compress@10': 0.575, 'time@10': 8.1246}:  10%|█         | 1/10 [00:11<00:40,  4.51s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.0448, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8585, 'compress@10': 0.575, 'time@10': 8.1246}:  20%|██        | 2/10 [00:11<00:49,  6.18s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.858, 'compress@10': 0.4786, 'time@10': 7.2311}:  20%|██        | 2/10 [00:14<00:49,  6.18s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.858, 'compress@10': 0.4786, 'time@10': 7.2311}:  30%|███       | 3/10 [00:14<00:32,  4.62s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8618, 'compress@10': 0.542, 'time@10': 7.0248}:  30%|███       | 3/10 [00:21<00:32,  4.62s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8618, 'compress@10': 0.542, 'time@10': 7.0248}:  40%|████      | 4/10 [00:21<00:32,  5.34s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0414, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8507, 'compress@10': 0.6227, 'time@10': 8.6718}:  40%|████      | 4/10 [00:28<00:32,  5.34s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0414, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8507, 'compress@10': 0.6227, 'time@10': 8.6718}:  50%|█████     | 5/10 [00:28<00:30,  6.18s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0422, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8508, 'compress@10': 0.6584, 'time@10': 8.9721}:  50%|█████     | 5/10 [00:39<00:30,  6.18s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0422, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8508, 'compress@10': 0.6584, 'time@10': 8.9721}:  60%|██████    | 6/10 [00:39<00:30,  7.65s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0424, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8568, 'compress@10': 0.6082, 'time@10': 9.2737}:  60%|██████    | 6/10 [00:44<00:30,  7.65s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0424, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8568, 'compress@10': 0.6082, 'time@10': 9.2737}:  70%|███████   | 7/10 [00:44<00:20,  6.97s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0418, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8622, 'compress@10': 0.6234, 'time@10': 9.1331}:  70%|███████   | 7/10 [00:52<00:20,  6.97s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0418, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8622, 'compress@10': 0.6234, 'time@10': 9.1331}:  80%|████████  | 8/10 [00:52<00:14,  7.36s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0419, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8786, 'compress@10': 0.5753, 'time@10': 9.6982}:  80%|████████  | 8/10 [01:00<00:14,  7.36s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0419, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8786, 'compress@10': 0.5753, 'time@10': 9.6982}:  90%|█████████ | 9/10 [01:00<00:07,  7.29s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0409, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8793, 'compress@10': 0.5255, 'time@10': 9.6532}:  90%|█████████ | 9/10 [01:09<00:07,  7.29s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0409, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8793, 'compress@10': 0.5255, 'time@10': 9.6532}: 100%|██████████| 10/10 [01:09<00:00,  7.91s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0409, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8793, 'compress@10': 0.5255, 'time@10': 9.6532}: 100%|██████████| 10/10 [01:09<00:00,  6.94s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.0408559976181734
Avg hit ratio: 0.8792091764112138
Avg ndcg: 0.8792622661221958
Avg compression ratio: 0.525472316401846
Avg train time: 9.653187346458434
Std train time: 3.02845266504563
[0.55, 0.55, 0.15, 0.75, 0.95, 0.8500000000000001, 0.35, 0.65, 0.15, 0.05000000000000001]
[10, 10, 18, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8595, 'compress@10': 0.5737, 'time@10': 8.4936}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8595, 'compress@10': 0.5737, 'time@10': 8.4936}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8762, 'compress@10': 0.5691, 'time@10': 7.8626}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8762, 'compress@10': 0.5691, 'time@10': 7.8626}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8698, 'compress@10': 0.4699, 'time@10': 6.9518}:  20%|██        | 2/10 [00:14<00:48,  6.04s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8698, 'compress@10': 0.4699, 'time@10': 6.9518}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8737, 'compress@10': 0.5421, 'time@10': 6.8348}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8737, 'compress@10': 0.5421, 'time@10': 6.8348}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0359, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8607, 'compress@10': 0.6239, 'time@10': 8.4955}:  40%|████      | 4/10 [00:28<00:31,  5.28s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0359, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8607, 'compress@10': 0.6239, 'time@10': 8.4955}:  50%|█████     | 5/10 [00:28<00:30,  6.12s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.037, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.861, 'compress@10': 0.6621, 'time@10': 8.8118}:  50%|█████     | 5/10 [00:38<00:30,  6.12s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.037, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.861, 'compress@10': 0.6621, 'time@10': 8.8118}:  60%|██████    | 6/10 [00:38<00:30,  7.59s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0377, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8562, 'compress@10': 0.6213, 'time@10': 9.1725}:  60%|██████    | 6/10 [00:44<00:30,  7.59s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0377, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8562, 'compress@10': 0.6213, 'time@10': 9.1725}:  70%|███████   | 7/10 [00:44<00:20,  6.97s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0376, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8619, 'compress@10': 0.6261, 'time@10': 9.0475}:  70%|███████   | 7/10 [00:52<00:20,  6.97s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0376, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8619, 'compress@10': 0.6261, 'time@10': 9.0475}:  80%|████████  | 8/10 [00:52<00:14,  7.37s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.039, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8853, 'compress@10': 0.5759, 'time@10': 9.5903}:  80%|████████  | 8/10 [00:59<00:14,  7.37s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.039, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8853, 'compress@10': 0.5759, 'time@10': 9.5903}:  90%|█████████ | 9/10 [00:59<00:07,  7.25s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0385, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8865, 'compress@10': 0.5255, 'time@10': 9.5737}:  90%|█████████ | 9/10 [01:09<00:07,  7.25s/it]  {'epoch': 9, 'num_users': 6.3, 'loss': 0.0385, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8865, 'compress@10': 0.5255, 'time@10': 9.5737}: 100%|██████████| 10/10 [01:09<00:00,  7.94s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0385, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8865, 'compress@10': 0.5255, 'time@10': 9.5737}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03847829067845134
Avg hit ratio: 0.8736732912437496
Avg ndcg: 0.8865457359726318
Avg compression ratio: 0.525474882178121
Avg train time: 9.573677611351012
Std train time: 3.0278440866524043
[0.5909090909090909, 0.5, 0.13636363636363635, 0.7727272727272727, 0.9545454545454545, 0.7727272727272728, 0.40909090909090906, 0.5909090909090909, 0.22727272727272727, 0.04545454545454546]
[10, 10, 19, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8431, 'compress@10': 0.6124, 'time@10': 8.6263}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8431, 'compress@10': 0.6124, 'time@10': 8.6263}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0395, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8654, 'compress@10': 0.5643, 'time@10': 7.8965}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0395, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8654, 'compress@10': 0.5643, 'time@10': 7.8965}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8627, 'compress@10': 0.4628, 'time@10': 6.9657}:  20%|██        | 2/10 [00:14<00:48,  6.04s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8627, 'compress@10': 0.4628, 'time@10': 6.9657}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8661, 'compress@10': 0.5423, 'time@10': 6.7529}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8661, 'compress@10': 0.5423, 'time@10': 6.7529}:  40%|████      | 4/10 [00:20<00:30,  5.13s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0353, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8545, 'compress@10': 0.6249, 'time@10': 8.5781}:  40%|████      | 4/10 [00:28<00:30,  5.13s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0353, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8545, 'compress@10': 0.6249, 'time@10': 8.5781}:  50%|█████     | 5/10 [00:28<00:30,  6.16s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0357, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8563, 'compress@10': 0.6504, 'time@10': 8.8717}:  50%|█████     | 5/10 [00:38<00:30,  6.16s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0357, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8563, 'compress@10': 0.6504, 'time@10': 8.8717}:  60%|██████    | 6/10 [00:38<00:30,  7.59s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.036, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8634, 'compress@10': 0.6193, 'time@10': 9.2183}:  60%|██████    | 6/10 [00:44<00:30,  7.59s/it] {'epoch': 10, 'num_users': 6.2857, 'loss': 0.036, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8634, 'compress@10': 0.6193, 'time@10': 9.2183}:  70%|███████   | 7/10 [00:44<00:20,  6.97s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0355, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.8683, 'compress@10': 0.6172, 'time@10': 9.1015}:  70%|███████   | 7/10 [00:52<00:20,  6.97s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0355, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.8683, 'compress@10': 0.6172, 'time@10': 9.1015}:  80%|████████  | 8/10 [00:52<00:14,  7.40s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0368, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8751, 'compress@10': 0.5763, 'time@10': 9.6851}:  80%|████████  | 8/10 [00:59<00:14,  7.40s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0368, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8751, 'compress@10': 0.5763, 'time@10': 9.6851}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0353, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8789, 'compress@10': 0.5254, 'time@10': 9.6324}:  90%|█████████ | 9/10 [01:09<00:07,  7.34s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0353, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8789, 'compress@10': 0.5254, 'time@10': 9.6324}: 100%|██████████| 10/10 [01:09<00:00,  7.91s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0353, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8789, 'compress@10': 0.5254, 'time@10': 9.6324}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03533419161649547
Avg hit ratio: 0.8854313986334359
Avg ndcg: 0.8788635209449002
Avg compression ratio: 0.5254177417352126
Avg train time: 9.632394337654114
Std train time: 3.264930979694586
[0.625, 0.4583333333333333, 0.12499999999999999, 0.7916666666666666, 0.9583333333333333, 0.7083333333333334, 0.4583333333333333, 0.5416666666666667, 0.29166666666666663, 0.04166666666666667]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0499, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8462, 'compress@10': 0.6447, 'time@10': 8.6681}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0499, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8462, 'compress@10': 0.6447, 'time@10': 8.6681}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8727, 'compress@10': 0.5603, 'time@10': 7.9757}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it] {'epoch': 11, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8727, 'compress@10': 0.5603, 'time@10': 7.9757}:  20%|██        | 2/10 [00:11<00:48,  6.11s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8675, 'compress@10': 0.4568, 'time@10': 7.1084}:  20%|██        | 2/10 [00:14<00:48,  6.11s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8675, 'compress@10': 0.4568, 'time@10': 7.1084}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8685, 'compress@10': 0.5424, 'time@10': 6.8665}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8685, 'compress@10': 0.5424, 'time@10': 6.8665}:  40%|████      | 4/10 [00:20<00:31,  5.20s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0353, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8599, 'compress@10': 0.6258, 'time@10': 8.5627}:  40%|████      | 4/10 [00:28<00:31,  5.20s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0353, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8599, 'compress@10': 0.6258, 'time@10': 8.5627}:  50%|█████     | 5/10 [00:28<00:30,  6.11s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0357, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8621, 'compress@10': 0.6406, 'time@10': 8.8917}:  50%|█████     | 5/10 [00:38<00:30,  6.11s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0357, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8621, 'compress@10': 0.6406, 'time@10': 8.8917}:  60%|██████    | 6/10 [00:38<00:30,  7.63s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0349, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8611, 'compress@10': 0.6177, 'time@10': 9.2281}:  60%|██████    | 6/10 [00:44<00:30,  7.63s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0349, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8611, 'compress@10': 0.6177, 'time@10': 9.2281}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0339, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8677, 'compress@10': 0.6098, 'time@10': 9.0685}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0339, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8677, 'compress@10': 0.6098, 'time@10': 9.0685}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0333, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8734, 'compress@10': 0.5767, 'time@10': 9.6311}:  80%|████████  | 8/10 [00:59<00:14,  7.30s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0333, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8734, 'compress@10': 0.5767, 'time@10': 9.6311}:  90%|█████████ | 9/10 [00:59<00:07,  7.25s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.033, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8768, 'compress@10': 0.5254, 'time@10': 9.595}:  90%|█████████ | 9/10 [01:08<00:07,  7.25s/it]     {'epoch': 11, 'num_users': 6.3, 'loss': 0.033, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8768, 'compress@10': 0.5254, 'time@10': 9.595}: 100%|██████████| 10/10 [01:08<00:00,  7.88s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.033, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8768, 'compress@10': 0.5254, 'time@10': 9.595}: 100%|██████████| 10/10 [01:08<00:00,  6.90s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03297255061979819
Avg hit ratio: 0.8698789422235942
Avg ndcg: 0.8767892977972291
Avg compression ratio: 0.5253701326120664
Avg train time: 9.594979310035706
Std train time: 3.099036527012953
[0.6538461538461539, 0.4230769230769231, 0.11538461538461538, 0.8076923076923077, 0.9615384615384615, 0.7307692307692308, 0.5, 0.5000000000000001, 0.2692307692307692, 0.038461538461538464]
[10, 10, 20, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8553, 'compress@10': 0.6721, 'time@10': 8.5673}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8553, 'compress@10': 0.6721, 'time@10': 8.5673}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8786, 'compress@10': 0.5569, 'time@10': 7.8471}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8786, 'compress@10': 0.5569, 'time@10': 7.8471}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8714, 'compress@10': 0.4518, 'time@10': 7.0047}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8714, 'compress@10': 0.4518, 'time@10': 7.0047}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0289, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8739, 'compress@10': 0.5425, 'time@10': 6.78}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]  {'epoch': 12, 'num_users': 5.0, 'loss': 0.0289, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8739, 'compress@10': 0.5425, 'time@10': 6.78}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0329, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8645, 'compress@10': 0.6265, 'time@10': 8.5237}:  40%|████      | 4/10 [00:28<00:30,  5.15s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0329, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8645, 'compress@10': 0.6265, 'time@10': 8.5237}:  50%|█████     | 5/10 [00:28<00:30,  6.10s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0348, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8672, 'compress@10': 0.6448, 'time@10': 8.8601}:  50%|█████     | 5/10 [00:38<00:30,  6.10s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0348, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8672, 'compress@10': 0.6448, 'time@10': 8.8601}:  60%|██████    | 6/10 [00:38<00:30,  7.63s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0346, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8721, 'compress@10': 0.627, 'time@10': 9.226}:  60%|██████    | 6/10 [00:44<00:30,  7.63s/it]  {'epoch': 12, 'num_users': 6.2857, 'loss': 0.0346, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8721, 'compress@10': 0.627, 'time@10': 9.226}:  70%|███████   | 7/10 [00:44<00:21,  7.01s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0328, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8782, 'compress@10': 0.6129, 'time@10': 9.0788}:  70%|███████   | 7/10 [00:52<00:21,  7.01s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0328, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8782, 'compress@10': 0.6129, 'time@10': 9.0788}:  80%|████████  | 8/10 [00:52<00:14,  7.36s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8843, 'compress@10': 0.5771, 'time@10': 9.6744}:  80%|████████  | 8/10 [00:59<00:14,  7.36s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8843, 'compress@10': 0.5771, 'time@10': 9.6744}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8884, 'compress@10': 0.5254, 'time@10': 9.6321}:  90%|█████████ | 9/10 [01:09<00:07,  7.33s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8884, 'compress@10': 0.5254, 'time@10': 9.6321}: 100%|██████████| 10/10 [01:09<00:00,  7.93s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8884, 'compress@10': 0.5254, 'time@10': 9.6321}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03019772742175572
Avg hit ratio: 0.873104748675207
Avg ndcg: 0.8883971953047884
Avg compression ratio: 0.5253815665110889
Avg train time: 9.632104301452637
Std train time: 3.203946826893156
[0.6785714285714286, 0.39285714285714285, 0.10714285714285714, 0.8214285714285714, 0.9642857142857142, 0.7500000000000001, 0.5357142857142857, 0.4642857142857144, 0.25, 0.03571428571428572]
[10, 10, 21, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8725, 'compress@10': 0.6955, 'time@10': 8.6181}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8725, 'compress@10': 0.6955, 'time@10': 8.6181}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.89, 'compress@10': 0.554, 'time@10': 7.9886}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it]   {'epoch': 13, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.89, 'compress@10': 0.554, 'time@10': 7.9886}:  20%|██        | 2/10 [00:11<00:49,  6.14s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8791, 'compress@10': 0.4475, 'time@10': 7.2182}:  20%|██        | 2/10 [00:14<00:49,  6.14s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8791, 'compress@10': 0.4475, 'time@10': 7.2182}:  30%|███       | 3/10 [00:14<00:32,  4.65s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8827, 'compress@10': 0.5426, 'time@10': 6.9764}:  30%|███       | 3/10 [00:20<00:32,  4.65s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8827, 'compress@10': 0.5426, 'time@10': 6.9764}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0279, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8747, 'compress@10': 0.6271, 'time@10': 8.7109}:  40%|████      | 4/10 [00:28<00:31,  5.30s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0279, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8747, 'compress@10': 0.6271, 'time@10': 8.7109}:  50%|█████     | 5/10 [00:28<00:31,  6.22s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8787, 'compress@10': 0.6485, 'time@10': 9.05}:  50%|█████     | 5/10 [00:39<00:31,  6.22s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8787, 'compress@10': 0.6485, 'time@10': 9.05}:  60%|██████    | 6/10 [00:39<00:31,  7.77s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8767, 'compress@10': 0.635, 'time@10': 9.451}:  60%|██████    | 6/10 [00:45<00:31,  7.77s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8767, 'compress@10': 0.635, 'time@10': 9.451}:  70%|███████   | 7/10 [00:45<00:21,  7.20s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8835, 'compress@10': 0.6156, 'time@10': 9.2696}:  70%|███████   | 7/10 [00:53<00:21,  7.20s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8835, 'compress@10': 0.6156, 'time@10': 9.2696}:  80%|████████  | 8/10 [00:53<00:14,  7.47s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.027, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.89, 'compress@10': 0.5774, 'time@10': 9.8428}:  80%|████████  | 8/10 [01:00<00:14,  7.47s/it]  {'epoch': 13, 'num_users': 6.3333, 'loss': 0.027, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.89, 'compress@10': 0.5774, 'time@10': 9.8428}:  90%|█████████ | 9/10 [01:00<00:07,  7.40s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8919, 'compress@10': 0.5254, 'time@10': 9.8056}:  90%|█████████ | 9/10 [01:10<00:07,  7.40s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8919, 'compress@10': 0.5254, 'time@10': 9.8056}: 100%|██████████| 10/10 [01:10<00:00,  8.05s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8919, 'compress@10': 0.5254, 'time@10': 9.8056}: 100%|██████████| 10/10 [01:10<00:00,  7.04s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.026943879862264458
Avg hit ratio: 0.885447271649309
Avg ndcg: 0.8918907020300528
Avg compression ratio: 0.5253897440429479
Avg train time: 9.805616354942321
Std train time: 3.178862228517247
[0.7000000000000001, 0.36666666666666664, 0.09999999999999999, 0.8333333333333333, 0.9666666666666666, 0.7666666666666667, 0.5666666666666667, 0.43333333333333346, 0.23333333333333334, 0.03333333333333334]
[10, 10, 21, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8599, 'compress@10': 0.7158, 'time@10': 8.4483}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8599, 'compress@10': 0.7158, 'time@10': 8.4483}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.888, 'compress@10': 0.5514, 'time@10': 7.8239}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]  {'epoch': 14, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.888, 'compress@10': 0.5514, 'time@10': 7.8239}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8777, 'compress@10': 0.4438, 'time@10': 7.0929}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8777, 'compress@10': 0.4438, 'time@10': 7.0929}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8795, 'compress@10': 0.5427, 'time@10': 6.8349}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8795, 'compress@10': 0.5427, 'time@10': 6.8349}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8751, 'compress@10': 0.6276, 'time@10': 8.5854}:  40%|████      | 4/10 [00:28<00:31,  5.18s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8751, 'compress@10': 0.6276, 'time@10': 8.5854}:  50%|█████     | 5/10 [00:28<00:30,  6.13s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8796, 'compress@10': 0.6516, 'time@10': 8.9}:  50%|█████     | 5/10 [00:38<00:30,  6.13s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8796, 'compress@10': 0.6516, 'time@10': 8.9}:  60%|██████    | 6/10 [00:38<00:30,  7.62s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0289, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8839, 'compress@10': 0.642, 'time@10': 9.2472}:  60%|██████    | 6/10 [00:44<00:30,  7.62s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0289, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8839, 'compress@10': 0.642, 'time@10': 9.2472}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0274, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.8897, 'compress@10': 0.6179, 'time@10': 9.0739}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0274, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.8897, 'compress@10': 0.6179, 'time@10': 9.0739}:  80%|████████  | 8/10 [00:52<00:14,  7.28s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.898, 'compress@10': 0.5776, 'time@10': 9.6809}:  80%|████████  | 8/10 [00:59<00:14,  7.28s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.898, 'compress@10': 0.5776, 'time@10': 9.6809}:  90%|█████████ | 9/10 [00:59<00:07,  7.29s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9008, 'compress@10': 0.5254, 'time@10': 9.6121}:  90%|█████████ | 9/10 [01:08<00:07,  7.29s/it]  {'epoch': 14, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9008, 'compress@10': 0.5254, 'time@10': 9.6121}: 100%|██████████| 10/10 [01:08<00:00,  7.83s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9008, 'compress@10': 0.5254, 'time@10': 9.6121}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.027314315466103245
Avg hit ratio: 0.8907928937691247
Avg ndcg: 0.9007677119279229
Avg compression ratio: 0.5253956693097505
Avg train time: 9.612125682830811
Std train time: 3.2050722733631685
[0.7187500000000001, 0.40625, 0.09374999999999999, 0.8437499999999999, 0.9687499999999999, 0.71875, 0.53125, 0.4062500000000001, 0.28125, 0.03125000000000001]
[10, 10, 21, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0353, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8819, 'compress@10': 0.7335, 'time@10': 8.4568}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0353, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8819, 'compress@10': 0.7335, 'time@10': 8.4568}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0299, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8997, 'compress@10': 0.5795, 'time@10': 7.8831}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0299, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8997, 'compress@10': 0.5795, 'time@10': 7.8831}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8855, 'compress@10': 0.4607, 'time@10': 7.1222}:  20%|██        | 2/10 [00:14<00:48,  6.08s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8855, 'compress@10': 0.4607, 'time@10': 7.1222}:  30%|███       | 3/10 [00:14<00:32,  4.60s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8886, 'compress@10': 0.5579, 'time@10': 6.9054}:  30%|███       | 3/10 [00:20<00:32,  4.60s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8886, 'compress@10': 0.5579, 'time@10': 6.9054}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0268, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8857, 'compress@10': 0.6402, 'time@10': 8.6798}:  40%|████      | 4/10 [00:28<00:31,  5.27s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0268, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8857, 'compress@10': 0.6402, 'time@10': 8.6798}:  50%|█████     | 5/10 [00:28<00:31,  6.23s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8928, 'compress@10': 0.6543, 'time@10': 9.0143}:  50%|█████     | 5/10 [00:39<00:31,  6.23s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8928, 'compress@10': 0.6543, 'time@10': 9.0143}:  60%|██████    | 6/10 [00:39<00:31,  7.76s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.89, 'compress@10': 0.6394, 'time@10': 9.3845}:  60%|██████    | 6/10 [00:45<00:31,  7.76s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.89, 'compress@10': 0.6394, 'time@10': 9.3845}:  70%|███████   | 7/10 [00:45<00:21,  7.13s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0281, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.8947, 'compress@10': 0.6124, 'time@10': 9.2191}:  70%|███████   | 7/10 [00:53<00:21,  7.13s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0281, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.8947, 'compress@10': 0.6124, 'time@10': 9.2191}:  80%|████████  | 8/10 [00:53<00:14,  7.44s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0279, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9013, 'compress@10': 0.5779, 'time@10': 9.8001}:  80%|████████  | 8/10 [01:00<00:14,  7.44s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0279, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9013, 'compress@10': 0.5779, 'time@10': 9.8001}:  90%|█████████ | 9/10 [01:00<00:07,  7.39s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0267, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9061, 'compress@10': 0.5254, 'time@10': 9.7541}:  90%|█████████ | 9/10 [01:09<00:07,  7.39s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0267, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9061, 'compress@10': 0.5254, 'time@10': 9.7541}: 100%|██████████| 10/10 [01:09<00:00,  8.00s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0267, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9061, 'compress@10': 0.5254, 'time@10': 9.7541}: 100%|██████████| 10/10 [01:09<00:00,  7.00s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.026743388469119344
Avg hit ratio: 0.8857135286897597
Avg ndcg: 0.9060765256597266
Avg compression ratio: 0.5254114188013097
Avg train time: 9.754101467132568
Std train time: 3.206294502649159
[0.7352941176470589, 0.38235294117647056, 0.08823529411764705, 0.8529411764705881, 0.9705882352941175, 0.7352941176470589, 0.5588235294117647, 0.3823529411764707, 0.2647058823529412, 0.02941176470588236]
[10, 10, 21, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8819, 'compress@10': 0.7492, 'time@10': 8.3375}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8819, 'compress@10': 0.7492, 'time@10': 8.3375}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9009, 'compress@10': 0.5757, 'time@10': 7.7655}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9009, 'compress@10': 0.5757, 'time@10': 7.7655}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8863, 'compress@10': 0.4567, 'time@10': 7.0784}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8863, 'compress@10': 0.4567, 'time@10': 7.0784}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.89, 'compress@10': 0.557, 'time@10': 6.8086}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it]    {'epoch': 16, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.89, 'compress@10': 0.557, 'time@10': 6.8086}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0256, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8878, 'compress@10': 0.6399, 'time@10': 8.5813}:  40%|████      | 4/10 [00:28<00:30,  5.15s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0256, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.8878, 'compress@10': 0.6399, 'time@10': 8.5813}:  50%|█████     | 5/10 [00:28<00:30,  6.13s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0264, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8915, 'compress@10': 0.6567, 'time@10': 8.9047}:  50%|█████     | 5/10 [00:38<00:30,  6.13s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0264, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8915, 'compress@10': 0.6567, 'time@10': 8.9047}:  60%|██████    | 6/10 [00:38<00:30,  7.64s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0262, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8918, 'compress@10': 0.6453, 'time@10': 9.2533}:  60%|██████    | 6/10 [00:44<00:30,  7.64s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0262, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8918, 'compress@10': 0.6453, 'time@10': 9.2533}:  70%|███████   | 7/10 [00:44<00:21,  7.01s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.8959, 'compress@10': 0.6146, 'time@10': 9.1133}:  70%|███████   | 7/10 [00:52<00:21,  7.01s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.8959, 'compress@10': 0.6146, 'time@10': 9.1133}:  80%|████████  | 8/10 [00:52<00:14,  7.38s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0263, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9162, 'compress@10': 0.5781, 'time@10': 9.7191}:  80%|████████  | 8/10 [01:00<00:14,  7.38s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0263, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9162, 'compress@10': 0.5781, 'time@10': 9.7191}:  90%|█████████ | 9/10 [01:00<00:07,  7.36s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.915, 'compress@10': 0.5254, 'time@10': 9.6944}:  90%|█████████ | 9/10 [01:09<00:07,  7.36s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.915, 'compress@10': 0.5254, 'time@10': 9.6944}: 100%|██████████| 10/10 [01:09<00:00,  8.02s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.915, 'compress@10': 0.5254, 'time@10': 9.6944}: 100%|██████████| 10/10 [01:09<00:00,  6.95s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.026388055633721635
Avg hit ratio: 0.8879357509119818
Avg ndcg: 0.914964273823806
Avg compression ratio: 0.5254161502832179
Avg train time: 9.694361019134522
Std train time: 3.209779064809402
[0.75, 0.3611111111111111, 0.08333333333333333, 0.8611111111111109, 0.9722222222222221, 0.75, 0.5277777777777778, 0.3611111111111112, 0.3055555555555556, 0.027777777777777783]
[10, 10, 21, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.032, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.7632, 'time@10': 8.2909}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.032, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.7632, 'time@10': 8.2909}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9073, 'compress@10': 0.5724, 'time@10': 7.7661}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9073, 'compress@10': 0.5724, 'time@10': 7.7661}:  20%|██        | 2/10 [00:11<00:48,  6.00s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8906, 'compress@10': 0.4531, 'time@10': 7.0424}:  20%|██        | 2/10 [00:14<00:48,  6.00s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8906, 'compress@10': 0.4531, 'time@10': 7.0424}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8943, 'compress@10': 0.5563, 'time@10': 6.8389}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8943, 'compress@10': 0.5563, 'time@10': 6.8389}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0241, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8924, 'compress@10': 0.6396, 'time@10': 8.6079}:  40%|████      | 4/10 [00:28<00:31,  5.23s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0241, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8924, 'compress@10': 0.6396, 'time@10': 8.6079}:  50%|█████     | 5/10 [00:28<00:30,  6.19s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0229, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8993, 'compress@10': 0.6589, 'time@10': 8.9037}:  50%|█████     | 5/10 [00:38<00:30,  6.19s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0229, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8993, 'compress@10': 0.6589, 'time@10': 8.9037}:  60%|██████    | 6/10 [00:38<00:30,  7.63s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0232, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9012, 'compress@10': 0.6429, 'time@10': 9.2768}:  60%|██████    | 6/10 [00:44<00:30,  7.63s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0232, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9012, 'compress@10': 0.6429, 'time@10': 9.2768}:  70%|███████   | 7/10 [00:44<00:21,  7.03s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9052, 'compress@10': 0.6099, 'time@10': 9.1308}:  70%|███████   | 7/10 [00:52<00:21,  7.03s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9052, 'compress@10': 0.6099, 'time@10': 9.1308}:  80%|████████  | 8/10 [00:52<00:14,  7.38s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9292, 'compress@10': 0.5783, 'time@10': 9.7514}:  80%|████████  | 8/10 [01:00<00:14,  7.38s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9292, 'compress@10': 0.5783, 'time@10': 9.7514}:  90%|█████████ | 9/10 [01:00<00:07,  7.39s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9323, 'compress@10': 0.5255, 'time@10': 9.6924}:  90%|█████████ | 9/10 [01:09<00:07,  7.39s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9323, 'compress@10': 0.5255, 'time@10': 9.6924}: 100%|██████████| 10/10 [01:09<00:00,  7.95s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9323, 'compress@10': 0.5255, 'time@10': 9.6924}: 100%|██████████| 10/10 [01:09<00:00,  6.94s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.025099149383699365
Avg hit ratio: 0.8931989088067187
Avg ndcg: 0.9323449914011446
Avg compression ratio: 0.5254861276397655
Avg train time: 9.69236762523651
Std train time: 3.2324188433523586
[0.7631578947368421, 0.34210526315789475, 0.07894736842105263, 0.8684210526315788, 0.9736842105263157, 0.7105263157894737, 0.5526315789473685, 0.34210526315789486, 0.34210526315789475, 0.026315789473684216]
[10, 10, 21, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8926, 'compress@10': 0.7756, 'time@10': 8.2326}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8926, 'compress@10': 0.7756, 'time@10': 8.2326}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9165, 'compress@10': 0.5695, 'time@10': 7.7014}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9165, 'compress@10': 0.5695, 'time@10': 7.7014}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8967, 'compress@10': 0.4498, 'time@10': 6.9679}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8967, 'compress@10': 0.4498, 'time@10': 6.9679}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9011, 'compress@10': 0.5556, 'time@10': 6.7474}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9011, 'compress@10': 0.5556, 'time@10': 6.7474}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8985, 'compress@10': 0.6394, 'time@10': 8.5633}:  40%|████      | 4/10 [00:28<00:30,  5.15s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8985, 'compress@10': 0.6394, 'time@10': 8.5633}:  50%|█████     | 5/10 [00:28<00:30,  6.16s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9072, 'compress@10': 0.6523, 'time@10': 8.876}:  50%|█████     | 5/10 [00:38<00:30,  6.16s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9072, 'compress@10': 0.6523, 'time@10': 8.876}:  60%|██████    | 6/10 [00:38<00:30,  7.63s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0255, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9021, 'compress@10': 0.6406, 'time@10': 9.2192}:  60%|██████    | 6/10 [00:44<00:30,  7.63s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0255, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9021, 'compress@10': 0.6406, 'time@10': 9.2192}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0243, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9063, 'compress@10': 0.6056, 'time@10': 9.0654}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0243, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9063, 'compress@10': 0.6056, 'time@10': 9.0654}:  80%|████████  | 8/10 [00:52<00:14,  7.32s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0272, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9058, 'compress@10': 0.5785, 'time@10': 9.6832}:  80%|████████  | 8/10 [00:59<00:14,  7.32s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0272, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9058, 'compress@10': 0.5785, 'time@10': 9.6832}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9094, 'compress@10': 0.5255, 'time@10': 9.636}:  90%|█████████ | 9/10 [01:09<00:07,  7.33s/it]       {'epoch': 18, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9094, 'compress@10': 0.5255, 'time@10': 9.636}: 100%|██████████| 10/10 [01:09<00:00,  7.92s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9094, 'compress@10': 0.5255, 'time@10': 9.636}: 100%|██████████| 10/10 [01:09<00:00,  6.90s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.027577508612295493
Avg hit ratio: 0.8999961438297601
Avg ndcg: 0.9094408371530603
Avg compression ratio: 0.5254526890643247
Avg train time: 9.635964274406433
Std train time: 3.2742524552265437
[0.775, 0.325, 0.075, 0.8249999999999998, 0.9749999999999999, 0.725, 0.525, 0.3250000000000001, 0.375, 0.07500000000000001]
[10, 10, 21, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8926, 'compress@10': 0.7868, 'time@10': 8.29}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8926, 'compress@10': 0.7868, 'time@10': 8.29}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9175, 'compress@10': 0.5668, 'time@10': 7.7389}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9175, 'compress@10': 0.5668, 'time@10': 7.7389}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8974, 'compress@10': 0.4469, 'time@10': 6.925}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8974, 'compress@10': 0.4469, 'time@10': 6.925}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9033, 'compress@10': 0.543, 'time@10': 6.7301}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9033, 'compress@10': 0.543, 'time@10': 6.7301}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9006, 'compress@10': 0.6295, 'time@10': 8.5153}:  40%|████      | 4/10 [00:28<00:30,  5.15s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9006, 'compress@10': 0.6295, 'time@10': 8.5153}:  50%|█████     | 5/10 [00:28<00:30,  6.13s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0217, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.907, 'compress@10': 0.6464, 'time@10': 8.8286}:  50%|█████     | 5/10 [00:38<00:30,  6.13s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0217, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.907, 'compress@10': 0.6464, 'time@10': 8.8286}:  60%|██████    | 6/10 [00:38<00:30,  7.59s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.9109, 'compress@10': 0.6318, 'time@10': 9.1986}:  60%|██████    | 6/10 [00:44<00:30,  7.59s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.9109, 'compress@10': 0.6318, 'time@10': 9.1986}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0204, 'hit_ratio@10': 0.9243, 'ndcg@10': 0.9119, 'compress@10': 0.5959, 'time@10': 9.0522}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0204, 'hit_ratio@10': 0.9243, 'ndcg@10': 0.9119, 'compress@10': 0.5959, 'time@10': 9.0522}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9266, 'compress@10': 0.5733, 'time@10': 9.6625}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9266, 'compress@10': 0.5733, 'time@10': 9.6625}:  90%|█████████ | 9/10 [00:59<00:07,  7.32s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9286, 'compress@10': 0.5256, 'time@10': 9.6184}:  90%|█████████ | 9/10 [01:08<00:07,  7.32s/it]    {'epoch': 19, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9286, 'compress@10': 0.5256, 'time@10': 9.6184}: 100%|██████████| 10/10 [01:08<00:00,  7.92s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9286, 'compress@10': 0.5256, 'time@10': 9.6184}: 100%|██████████| 10/10 [01:08<00:00,  6.90s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.022023423078604082
Avg hit ratio: 0.9142818581154744
Avg ndcg: 0.9286466012711028
Avg compression ratio: 0.5255759027189801
Avg train time: 9.618393182754517
Std train time: 3.2505274586638198
[0.7857142857142857, 0.30952380952380953, 0.07142857142857142, 0.8333333333333331, 0.976190476190476, 0.738095238095238, 0.5, 0.30952380952380965, 0.40476190476190477, 0.07142857142857144]
[10, 10, 22, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8951, 'compress@10': 0.797, 'time@10': 8.7245}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8951, 'compress@10': 0.797, 'time@10': 8.7245}:  10%|█         | 1/10 [00:04<00:39,  4.40s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0246, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.918, 'compress@10': 0.5644, 'time@10': 8.0371}:  10%|█         | 1/10 [00:11<00:39,  4.40s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0246, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.918, 'compress@10': 0.5644, 'time@10': 8.0371}:  20%|██        | 2/10 [00:11<00:49,  6.16s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8977, 'compress@10': 0.4443, 'time@10': 7.1282}:  20%|██        | 2/10 [00:14<00:49,  6.16s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8977, 'compress@10': 0.4443, 'time@10': 7.1282}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9071, 'compress@10': 0.543, 'time@10': 6.8923}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9071, 'compress@10': 0.543, 'time@10': 6.8923}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9051, 'compress@10': 0.6298, 'time@10': 8.6716}:  40%|████      | 4/10 [00:28<00:31,  5.23s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9051, 'compress@10': 0.6298, 'time@10': 8.6716}:  50%|█████     | 5/10 [00:28<00:31,  6.20s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9132, 'compress@10': 0.6488, 'time@10': 8.9306}:  50%|█████     | 5/10 [00:38<00:31,  6.20s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9132, 'compress@10': 0.6488, 'time@10': 8.9306}:  60%|██████    | 6/10 [00:38<00:30,  7.58s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9098, 'compress@10': 0.6304, 'time@10': 9.2998}:  60%|██████    | 6/10 [00:44<00:30,  7.58s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9098, 'compress@10': 0.6304, 'time@10': 9.2998}:  70%|███████   | 7/10 [00:44<00:20,  7.00s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9133, 'compress@10': 0.5927, 'time@10': 9.1374}:  70%|███████   | 7/10 [00:52<00:20,  7.00s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9133, 'compress@10': 0.5927, 'time@10': 9.1374}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.021, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9115, 'compress@10': 0.5737, 'time@10': 9.8095}:  80%|████████  | 8/10 [01:00<00:14,  7.33s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.021, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9115, 'compress@10': 0.5737, 'time@10': 9.8095}:  90%|█████████ | 9/10 [01:00<00:07,  7.43s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.917, 'compress@10': 0.5256, 'time@10': 9.7484}:  90%|█████████ | 9/10 [01:09<00:07,  7.43s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.917, 'compress@10': 0.5256, 'time@10': 9.7484}: 100%|██████████| 10/10 [01:09<00:00,  7.99s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.917, 'compress@10': 0.5256, 'time@10': 9.7484}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.021110089766746453
Avg hit ratio: 0.8828532866869029
Avg ndcg: 0.9169513219927262
Avg compression ratio: 0.5256266594970779
Avg train time: 9.748416924476624
Std train time: 3.3461128110744043
[0.7954545454545454, 0.29545454545454547, 0.06818181818181818, 0.8409090909090907, 0.9772727272727272, 0.7045454545454545, 0.5227272727272727, 0.2954545454545456, 0.4318181818181818, 0.06818181818181819]
[10, 10, 23, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8973, 'compress@10': 0.8062, 'time@10': 8.5199}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8973, 'compress@10': 0.8062, 'time@10': 8.5199}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9204, 'compress@10': 0.5622, 'time@10': 7.9003}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9204, 'compress@10': 0.5622, 'time@10': 7.9003}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8993, 'compress@10': 0.4419, 'time@10': 7.2367}:  20%|██        | 2/10 [00:14<00:48,  6.08s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8993, 'compress@10': 0.4419, 'time@10': 7.2367}:  30%|███       | 3/10 [00:14<00:32,  4.67s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9106, 'compress@10': 0.5431, 'time@10': 6.9582}:  30%|███       | 3/10 [00:20<00:32,  4.67s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9106, 'compress@10': 0.5431, 'time@10': 6.9582}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9081, 'compress@10': 0.63, 'time@10': 8.6811}:  40%|████      | 4/10 [00:28<00:31,  5.26s/it]  {'epoch': 21, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9081, 'compress@10': 0.63, 'time@10': 8.6811}:  50%|█████     | 5/10 [00:28<00:30,  6.18s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0221, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9172, 'compress@10': 0.6435, 'time@10': 8.958}:  50%|█████     | 5/10 [00:38<00:30,  6.18s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0221, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9172, 'compress@10': 0.6435, 'time@10': 8.958}:  60%|██████    | 6/10 [00:38<00:30,  7.61s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9177, 'compress@10': 0.629, 'time@10': 9.3013}:  60%|██████    | 6/10 [00:44<00:30,  7.61s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9177, 'compress@10': 0.629, 'time@10': 9.3013}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0212, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9189, 'compress@10': 0.5898, 'time@10': 9.124}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0212, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9189, 'compress@10': 0.5898, 'time@10': 9.124}:  80%|████████  | 8/10 [00:52<00:14,  7.29s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9319, 'compress@10': 0.5741, 'time@10': 9.7466}:  80%|████████  | 8/10 [01:00<00:14,  7.29s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9319, 'compress@10': 0.5741, 'time@10': 9.7466}:  90%|█████████ | 9/10 [01:00<00:07,  7.33s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9342, 'compress@10': 0.5256, 'time@10': 9.7215}:  90%|█████████ | 9/10 [01:09<00:07,  7.33s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9342, 'compress@10': 0.5256, 'time@10': 9.7215}: 100%|██████████| 10/10 [01:09<00:00,  8.01s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9342, 'compress@10': 0.5256, 'time@10': 9.7215}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.022513669691164123
Avg hit ratio: 0.8984247152583317
Avg ndcg: 0.934166753943428
Avg compression ratio: 0.5255922458916078
Avg train time: 9.721456050872803
Std train time: 3.1732461603643367
[0.8043478260869564, 0.28260869565217395, 0.06521739130434782, 0.8478260869565215, 0.9782608695652173, 0.717391304347826, 0.5, 0.28260869565217406, 0.4565217391304348, 0.06521739130434784]
[10, 10, 23, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8993, 'compress@10': 0.8146, 'time@10': 8.5104}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8993, 'compress@10': 0.8146, 'time@10': 8.5104}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9306, 'compress@10': 0.5602, 'time@10': 7.8155}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9306, 'compress@10': 0.5602, 'time@10': 7.8155}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9061, 'compress@10': 0.4397, 'time@10': 7.264}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it]  {'epoch': 22, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9061, 'compress@10': 0.4397, 'time@10': 7.264}:  30%|███       | 3/10 [00:14<00:32,  4.67s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9164, 'compress@10': 0.5431, 'time@10': 7.0249}:  30%|███       | 3/10 [00:20<00:32,  4.67s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9164, 'compress@10': 0.5431, 'time@10': 7.0249}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9142, 'compress@10': 0.6302, 'time@10': 8.7798}:  40%|████      | 4/10 [00:28<00:31,  5.33s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9142, 'compress@10': 0.6302, 'time@10': 8.7798}:  50%|█████     | 5/10 [00:28<00:31,  6.27s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0173, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9202, 'compress@10': 0.6458, 'time@10': 9.0226}:  50%|█████     | 5/10 [00:39<00:31,  6.27s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0173, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9202, 'compress@10': 0.6458, 'time@10': 9.0226}:  60%|██████    | 6/10 [00:39<00:30,  7.63s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0173, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9227, 'compress@10': 0.6278, 'time@10': 9.3908}:  60%|██████    | 6/10 [00:44<00:30,  7.63s/it] {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0173, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9227, 'compress@10': 0.6278, 'time@10': 9.3908}:  70%|███████   | 7/10 [00:44<00:21,  7.06s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.9255, 'compress@10': 0.5872, 'time@10': 9.1907}:  70%|███████   | 7/10 [00:52<00:21,  7.06s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.9255, 'compress@10': 0.5872, 'time@10': 9.1907}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9224, 'compress@10': 0.5744, 'time@10': 9.8233}:  80%|████████  | 8/10 [01:00<00:14,  7.30s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9224, 'compress@10': 0.5744, 'time@10': 9.8233}:  90%|█████████ | 9/10 [01:00<00:07,  7.36s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9271, 'compress@10': 0.5256, 'time@10': 9.771}:  90%|█████████ | 9/10 [01:09<00:07,  7.36s/it]    {'epoch': 22, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9271, 'compress@10': 0.5256, 'time@10': 9.771}: 100%|██████████| 10/10 [01:09<00:00,  7.97s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9271, 'compress@10': 0.5256, 'time@10': 9.771}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.018590300242037755
Avg hit ratio: 0.9035040803376967
Avg ndcg: 0.9270885920657062
Avg compression ratio: 0.5256377017490117
Avg train time: 9.770997858047485
Std train time: 3.2223911275597614
[0.8124999999999999, 0.27083333333333337, 0.0625, 0.8541666666666664, 0.9791666666666665, 0.6875, 0.4791666666666667, 0.2708333333333335, 0.4791666666666667, 0.10416666666666669]
[10, 10, 23, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9069, 'compress@10': 0.8224, 'time@10': 8.855}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9069, 'compress@10': 0.8224, 'time@10': 8.855}:  10%|█         | 1/10 [00:04<00:40,  4.47s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9348, 'compress@10': 0.5584, 'time@10': 7.9541}:  10%|█         | 1/10 [00:11<00:40,  4.47s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9348, 'compress@10': 0.5584, 'time@10': 7.9541}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9089, 'compress@10': 0.4377, 'time@10': 7.1808}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9089, 'compress@10': 0.4377, 'time@10': 7.1808}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9203, 'compress@10': 0.5431, 'time@10': 6.9643}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9203, 'compress@10': 0.5431, 'time@10': 6.9643}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9193, 'compress@10': 0.6304, 'time@10': 8.7187}:  40%|████      | 4/10 [00:28<00:31,  5.27s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9193, 'compress@10': 0.6304, 'time@10': 8.7187}:  50%|█████     | 5/10 [00:28<00:31,  6.22s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.9169, 'ndcg@10': 0.9246, 'compress@10': 0.6411, 'time@10': 8.9831}:  50%|█████     | 5/10 [00:39<00:31,  6.22s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.9169, 'ndcg@10': 0.9246, 'compress@10': 0.6411, 'time@10': 8.9831}:  60%|██████    | 6/10 [00:39<00:30,  7.62s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9177, 'compress@10': 0.6209, 'time@10': 9.3491}:  60%|██████    | 6/10 [00:44<00:30,  7.62s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9177, 'compress@10': 0.6209, 'time@10': 9.3491}:  70%|███████   | 7/10 [00:44<00:21,  7.03s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.9291, 'ndcg@10': 0.9226, 'compress@10': 0.5798, 'time@10': 9.1354}:  70%|███████   | 7/10 [00:52<00:21,  7.03s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.9291, 'ndcg@10': 0.9226, 'compress@10': 0.5798, 'time@10': 9.1354}:  80%|████████  | 8/10 [00:52<00:14,  7.24s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9271, 'compress@10': 0.5702, 'time@10': 9.8128}:  80%|████████  | 8/10 [01:00<00:14,  7.24s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9271, 'compress@10': 0.5702, 'time@10': 9.8128}:  90%|█████████ | 9/10 [01:00<00:07,  7.37s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9295, 'compress@10': 0.5257, 'time@10': 9.7679}:  90%|█████████ | 9/10 [01:09<00:07,  7.37s/it]  {'epoch': 23, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9295, 'compress@10': 0.5257, 'time@10': 9.7679}: 100%|██████████| 10/10 [01:09<00:00,  8.00s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9295, 'compress@10': 0.5257, 'time@10': 9.7679}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.0191270846704579
Avg hit ratio: 0.9153013153607379
Avg ndcg: 0.9295462775551971
Avg compression ratio: 0.5256781003438935
Avg train time: 9.767917919158936
Std train time: 3.3291823790026336
[0.8199999999999998, 0.26, 0.06, 0.8199999999999997, 0.9799999999999999, 0.7, 0.5, 0.2600000000000001, 0.46, 0.14]
[10, 10, 23, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9108, 'compress@10': 0.8295, 'time@10': 8.537}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9108, 'compress@10': 0.8295, 'time@10': 8.537}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.932, 'compress@10': 0.5567, 'time@10': 7.8912}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.932, 'compress@10': 0.5567, 'time@10': 7.8912}:  20%|██        | 2/10 [00:11<00:48,  6.06s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9071, 'compress@10': 0.4359, 'time@10': 7.2412}:  20%|██        | 2/10 [00:14<00:48,  6.06s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9071, 'compress@10': 0.4359, 'time@10': 7.2412}:  30%|███       | 3/10 [00:14<00:32,  4.67s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9193, 'compress@10': 0.5335, 'time@10': 6.9925}:  30%|███       | 3/10 [00:20<00:32,  4.67s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9193, 'compress@10': 0.5335, 'time@10': 6.9925}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9203, 'compress@10': 0.6229, 'time@10': 8.7218}:  40%|████      | 4/10 [00:28<00:31,  5.30s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9203, 'compress@10': 0.6229, 'time@10': 8.7218}:  50%|█████     | 5/10 [00:28<00:31,  6.23s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9232, 'compress@10': 0.6368, 'time@10': 9.0909}:  50%|█████     | 5/10 [00:39<00:31,  6.23s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9232, 'compress@10': 0.6368, 'time@10': 9.0909}:  60%|██████    | 6/10 [00:39<00:31,  7.84s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9257, 'compress@10': 0.6202, 'time@10': 9.4255}:  60%|██████    | 6/10 [00:45<00:31,  7.84s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9257, 'compress@10': 0.6202, 'time@10': 9.4255}:  70%|███████   | 7/10 [00:45<00:21,  7.16s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0162, 'hit_ratio@10': 0.9223, 'ndcg@10': 0.9275, 'compress@10': 0.5778, 'time@10': 9.2121}:  70%|███████   | 7/10 [00:53<00:21,  7.16s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0162, 'hit_ratio@10': 0.9223, 'ndcg@10': 0.9275, 'compress@10': 0.5778, 'time@10': 9.2121}:  80%|████████  | 8/10 [00:53<00:14,  7.35s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9308, 'compress@10': 0.5664, 'time@10': 9.8532}:  80%|████████  | 8/10 [01:00<00:14,  7.35s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9308, 'compress@10': 0.5664, 'time@10': 9.8532}:  90%|█████████ | 9/10 [01:00<00:07,  7.41s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9351, 'compress@10': 0.5257, 'time@10': 9.8531}:  90%|█████████ | 9/10 [01:10<00:07,  7.41s/it]    {'epoch': 24, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9351, 'compress@10': 0.5257, 'time@10': 9.8531}: 100%|██████████| 10/10 [01:10<00:00,  8.17s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9351, 'compress@10': 0.5257, 'time@10': 9.8531}: 100%|██████████| 10/10 [01:10<00:00,  7.07s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.016840086380375548
Avg hit ratio: 0.90699614382976
Avg ndcg: 0.9351272109234374
Avg compression ratio: 0.5257207640470096
Avg train time: 9.853140044212342
Std train time: 3.2381668332897378
[0.8269230769230768, 0.25, 0.05769230769230769, 0.8269230769230766, 0.9807692307692306, 0.7115384615384615, 0.4807692307692308, 0.2500000000000001, 0.4807692307692308, 0.13461538461538464]
[10, 10, 23, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9129, 'compress@10': 0.836, 'time@10': 8.513}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9129, 'compress@10': 0.836, 'time@10': 8.513}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9374, 'compress@10': 0.5551, 'time@10': 7.857}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9374, 'compress@10': 0.5551, 'time@10': 7.857}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9107, 'compress@10': 0.4342, 'time@10': 7.194}:  20%|██        | 2/10 [00:14<00:48,  6.04s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9107, 'compress@10': 0.4342, 'time@10': 7.194}:  30%|███       | 3/10 [00:14<00:32,  4.64s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9213, 'compress@10': 0.5339, 'time@10': 6.9775}:  30%|███       | 3/10 [00:20<00:32,  4.64s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9213, 'compress@10': 0.5339, 'time@10': 6.9775}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9208, 'compress@10': 0.6234, 'time@10': 8.6974}:  40%|████      | 4/10 [00:28<00:31,  5.32s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9208, 'compress@10': 0.6234, 'time@10': 8.6974}:  50%|█████     | 5/10 [00:28<00:31,  6.22s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.9149, 'ndcg@10': 0.927, 'compress@10': 0.6391, 'time@10': 9.0246}:  50%|█████     | 5/10 [00:39<00:31,  6.22s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.9149, 'ndcg@10': 0.927, 'compress@10': 0.6391, 'time@10': 9.0246}:  60%|██████    | 6/10 [00:39<00:30,  7.75s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.9213, 'ndcg@10': 0.9275, 'compress@10': 0.6195, 'time@10': 9.4015}:  60%|██████    | 6/10 [00:45<00:30,  7.75s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.9213, 'ndcg@10': 0.9275, 'compress@10': 0.6195, 'time@10': 9.4015}:  70%|███████   | 7/10 [00:45<00:21,  7.13s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9276, 'ndcg@10': 0.9314, 'compress@10': 0.576, 'time@10': 9.1964}:  70%|███████   | 7/10 [00:53<00:21,  7.13s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9276, 'ndcg@10': 0.9314, 'compress@10': 0.576, 'time@10': 9.1964}:  80%|████████  | 8/10 [00:53<00:14,  7.34s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.9134, 'ndcg@10': 0.9323, 'compress@10': 0.567, 'time@10': 9.845}:  80%|████████  | 8/10 [01:00<00:14,  7.34s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.9134, 'ndcg@10': 0.9323, 'compress@10': 0.567, 'time@10': 9.845}:  90%|█████████ | 9/10 [01:00<00:07,  7.41s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.9198, 'ndcg@10': 0.9368, 'compress@10': 0.5258, 'time@10': 9.7933}:  90%|█████████ | 9/10 [01:10<00:07,  7.41s/it] {'epoch': 25, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.9198, 'ndcg@10': 0.9368, 'compress@10': 0.5258, 'time@10': 9.7933}: 100%|██████████| 10/10 [01:10<00:00,  8.02s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.9198, 'ndcg@10': 0.9368, 'compress@10': 0.5258, 'time@10': 9.7933}: 100%|██████████| 10/10 [01:10<00:00,  7.00s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.017520794895192874
Avg hit ratio: 0.9197897946234109
Avg ndcg: 0.9367675748969988
Avg compression ratio: 0.5257550244839317
Avg train time: 9.793261337280274
Std train time: 3.2449362236916075
[0.8333333333333331, 0.24074074074074076, 0.05555555555555555, 0.833333333333333, 0.9814814814814813, 0.6851851851851851, 0.5, 0.24074074074074084, 0.46296296296296297, 0.16666666666666669]
[10, 10, 23, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9058, 'compress@10': 0.8421, 'time@10': 8.2823}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9058, 'compress@10': 0.8421, 'time@10': 8.2823}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9428, 'compress@10': 0.5537, 'time@10': 7.6981}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it] {'epoch': 26, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9428, 'compress@10': 0.5537, 'time@10': 7.6981}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9143, 'compress@10': 0.4326, 'time@10': 7.0075}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9143, 'compress@10': 0.4326, 'time@10': 7.0075}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9244, 'compress@10': 0.5343, 'time@10': 6.8402}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9244, 'compress@10': 0.5343, 'time@10': 6.8402}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9238, 'compress@10': 0.6238, 'time@10': 8.5543}:  40%|████      | 4/10 [00:28<00:31,  5.26s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9238, 'compress@10': 0.6238, 'time@10': 8.5543}:  50%|█████     | 5/10 [00:28<00:30,  6.15s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9287, 'compress@10': 0.6352, 'time@10': 8.8926}:  50%|█████     | 5/10 [00:38<00:30,  6.15s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9287, 'compress@10': 0.6352, 'time@10': 8.8926}:  60%|██████    | 6/10 [00:38<00:30,  7.67s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0194, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.922, 'compress@10': 0.6187, 'time@10': 9.2226}:  60%|██████    | 6/10 [00:44<00:30,  7.67s/it] {'epoch': 26, 'num_users': 6.2857, 'loss': 0.0194, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.922, 'compress@10': 0.6187, 'time@10': 9.2226}:  70%|███████   | 7/10 [00:44<00:21,  7.01s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0186, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9265, 'compress@10': 0.5742, 'time@10': 9.0397}:  70%|███████   | 7/10 [00:52<00:21,  7.01s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0186, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9265, 'compress@10': 0.5742, 'time@10': 9.0397}:  80%|████████  | 8/10 [00:52<00:14,  7.26s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9307, 'compress@10': 0.5635, 'time@10': 9.7083}:  80%|████████  | 8/10 [00:59<00:14,  7.26s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9307, 'compress@10': 0.5635, 'time@10': 9.7083}:  90%|█████████ | 9/10 [00:59<00:07,  7.36s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.934, 'compress@10': 0.5257, 'time@10': 9.719}:  90%|█████████ | 9/10 [01:09<00:07,  7.36s/it]     {'epoch': 26, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.934, 'compress@10': 0.5257, 'time@10': 9.719}: 100%|██████████| 10/10 [01:09<00:00,  8.13s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.934, 'compress@10': 0.5257, 'time@10': 9.719}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.018304115601214165
Avg hit ratio: 0.9024620667014555
Avg ndcg: 0.9339607978505754
Avg compression ratio: 0.5257446544203227
Avg train time: 9.719027709960937
Std train time: 3.236031760022018
[0.8035714285714284, 0.26785714285714285, 0.05357142857142857, 0.8035714285714283, 0.982142857142857, 0.6964285714285714, 0.5178571428571429, 0.23214285714285723, 0.48214285714285715, 0.16071428571428573]
[10, 10, 23, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9065, 'compress@10': 0.8139, 'time@10': 8.7863}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9065, 'compress@10': 0.8139, 'time@10': 8.7863}:  10%|█         | 1/10 [00:04<00:39,  4.43s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.936, 'compress@10': 0.5527, 'time@10': 7.934}:  10%|█         | 1/10 [00:11<00:39,  4.43s/it]  {'epoch': 27, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.936, 'compress@10': 0.5527, 'time@10': 7.934}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9097, 'compress@10': 0.4314, 'time@10': 7.2451}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9097, 'compress@10': 0.4314, 'time@10': 7.2451}:  30%|███       | 3/10 [00:14<00:32,  4.62s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9221, 'compress@10': 0.5262, 'time@10': 6.9725}:  30%|███       | 3/10 [00:20<00:32,  4.62s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9221, 'compress@10': 0.5262, 'time@10': 6.9725}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9252, 'compress@10': 0.6174, 'time@10': 8.7336}:  40%|████      | 4/10 [00:28<00:31,  5.24s/it] {'epoch': 27, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9252, 'compress@10': 0.6174, 'time@10': 8.7336}:  50%|█████     | 5/10 [00:28<00:31,  6.21s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9321, 'compress@10': 0.6317, 'time@10': 9.0326}:  50%|█████     | 5/10 [00:39<00:31,  6.21s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9321, 'compress@10': 0.6317, 'time@10': 9.0326}:  60%|██████    | 6/10 [00:39<00:30,  7.69s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9343, 'compress@10': 0.6182, 'time@10': 9.3747}:  60%|██████    | 6/10 [00:44<00:30,  7.69s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9343, 'compress@10': 0.6182, 'time@10': 9.3747}:  70%|███████   | 7/10 [00:44<00:21,  7.06s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9376, 'compress@10': 0.5727, 'time@10': 9.151}:  70%|███████   | 7/10 [00:52<00:21,  7.06s/it]  {'epoch': 27, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9376, 'compress@10': 0.5727, 'time@10': 9.151}:  80%|████████  | 8/10 [00:52<00:14,  7.24s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9408, 'compress@10': 0.5643, 'time@10': 9.7431}:  80%|████████  | 8/10 [00:59<00:14,  7.24s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9408, 'compress@10': 0.5643, 'time@10': 9.7431}:  90%|█████████ | 9/10 [00:59<00:07,  7.25s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.943, 'compress@10': 0.5258, 'time@10': 9.7145}:  90%|█████████ | 9/10 [01:09<00:07,  7.25s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.943, 'compress@10': 0.5258, 'time@10': 9.7145}: 100%|██████████| 10/10 [01:09<00:00,  7.94s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.943, 'compress@10': 0.5258, 'time@10': 9.7145}: 100%|██████████| 10/10 [01:09<00:00,  6.94s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.017249701210482943
Avg hit ratio: 0.9054216161126177
Avg ndcg: 0.9429927016591092
Avg compression ratio: 0.5258339487399739
Avg train time: 9.714502716064453
Std train time: 3.2084049705280537
[0.8103448275862067, 0.25862068965517243, 0.05172413793103448, 0.8103448275862066, 0.982758620689655, 0.6724137931034483, 0.5, 0.22413793103448285, 0.5, 0.18965517241379312]
[10, 10, 23, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8819, 'compress@10': 0.8203, 'time@10': 8.8489}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8819, 'compress@10': 0.8203, 'time@10': 8.8489}:  10%|█         | 1/10 [00:04<00:40,  4.46s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9219, 'compress@10': 0.5514, 'time@10': 8.0079}:  10%|█         | 1/10 [00:11<00:40,  4.46s/it] {'epoch': 28, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9219, 'compress@10': 0.5514, 'time@10': 8.0079}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9003, 'compress@10': 0.43, 'time@10': 7.3818}:  20%|██        | 2/10 [00:14<00:48,  6.08s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9003, 'compress@10': 0.43, 'time@10': 7.3818}:  30%|███       | 3/10 [00:14<00:33,  4.72s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9146, 'compress@10': 0.5268, 'time@10': 7.1114}:  30%|███       | 3/10 [00:21<00:33,  4.72s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9146, 'compress@10': 0.5268, 'time@10': 7.1114}:  40%|████      | 4/10 [00:21<00:32,  5.36s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9172, 'compress@10': 0.6181, 'time@10': 8.8407}:  40%|████      | 4/10 [00:29<00:32,  5.36s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9172, 'compress@10': 0.6181, 'time@10': 8.8407}:  50%|█████     | 5/10 [00:29<00:31,  6.28s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9314, 'compress@10': 0.6283, 'time@10': 9.141}:  50%|█████     | 5/10 [00:39<00:31,  6.28s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9314, 'compress@10': 0.6283, 'time@10': 9.141}:  60%|██████    | 6/10 [00:39<00:31,  7.78s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0171, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9342, 'compress@10': 0.6128, 'time@10': 9.4696}:  60%|██████    | 6/10 [00:45<00:31,  7.78s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0171, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9342, 'compress@10': 0.6128, 'time@10': 9.4696}:  70%|███████   | 7/10 [00:45<00:21,  7.12s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0162, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9381, 'compress@10': 0.567, 'time@10': 9.252}:  70%|███████   | 7/10 [00:53<00:21,  7.12s/it]   {'epoch': 28, 'num_users': 6.125, 'loss': 0.0162, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9381, 'compress@10': 0.567, 'time@10': 9.252}:  80%|████████  | 8/10 [00:53<00:14,  7.32s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9487, 'compress@10': 0.5612, 'time@10': 9.8366}:  80%|████████  | 8/10 [01:00<00:14,  7.32s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9487, 'compress@10': 0.5612, 'time@10': 9.8366}:  90%|█████████ | 9/10 [01:00<00:07,  7.32s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9506, 'compress@10': 0.5259, 'time@10': 9.8528}:  90%|█████████ | 9/10 [01:10<00:07,  7.32s/it]  {'epoch': 28, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9506, 'compress@10': 0.5259, 'time@10': 9.8528}: 100%|██████████| 10/10 [01:10<00:00,  8.16s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9506, 'compress@10': 0.5259, 'time@10': 9.8528}: 100%|██████████| 10/10 [01:10<00:00,  7.06s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.019441038675044035
Avg hit ratio: 0.8996049238443126
Avg ndcg: 0.9506368360141864
Avg compression ratio: 0.5258612996103523
Avg train time: 9.852780985832215
Std train time: 3.146089733883776
[0.8166666666666665, 0.25, 0.05, 0.8166666666666664, 0.9499999999999998, 0.6833333333333333, 0.5166666666666667, 0.21666666666666676, 0.5166666666666667, 0.18333333333333335]
[10, 10, 23, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8941, 'compress@10': 0.8263, 'time@10': 8.7414}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8941, 'compress@10': 0.8263, 'time@10': 8.7414}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9273, 'compress@10': 0.5503, 'time@10': 7.865}:  10%|█         | 1/10 [00:11<00:39,  4.41s/it]  {'epoch': 29, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9273, 'compress@10': 0.5503, 'time@10': 7.865}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9039, 'compress@10': 0.4287, 'time@10': 7.1375}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9039, 'compress@10': 0.4287, 'time@10': 7.1375}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.916, 'compress@10': 0.5274, 'time@10': 6.9508}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.916, 'compress@10': 0.5274, 'time@10': 6.9508}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0133, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9211, 'compress@10': 0.6121, 'time@10': 8.7801}:  40%|████      | 4/10 [00:28<00:31,  5.29s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0133, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9211, 'compress@10': 0.6121, 'time@10': 8.7801}:  50%|█████     | 5/10 [00:28<00:31,  6.30s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9291, 'compress@10': 0.6251, 'time@10': 9.024}:  50%|█████     | 5/10 [00:39<00:31,  6.30s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9291, 'compress@10': 0.6251, 'time@10': 9.024}:  60%|██████    | 6/10 [00:39<00:30,  7.65s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9209, 'compress@10': 0.6124, 'time@10': 9.3888}:  60%|██████    | 6/10 [00:44<00:30,  7.65s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9209, 'compress@10': 0.6124, 'time@10': 9.3888}:  70%|███████   | 7/10 [00:44<00:21,  7.05s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9262, 'compress@10': 0.5657, 'time@10': 9.1679}:  70%|███████   | 7/10 [00:52<00:21,  7.05s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9262, 'compress@10': 0.5657, 'time@10': 9.1679}:  80%|████████  | 8/10 [00:52<00:14,  7.25s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.932, 'compress@10': 0.5618, 'time@10': 9.7748}:  80%|████████  | 8/10 [00:59<00:14,  7.25s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.932, 'compress@10': 0.5618, 'time@10': 9.7748}:  90%|█████████ | 9/10 [00:59<00:07,  7.28s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9349, 'compress@10': 0.5258, 'time@10': 9.7777}:  90%|█████████ | 9/10 [01:09<00:07,  7.28s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9349, 'compress@10': 0.5258, 'time@10': 9.7777}: 100%|██████████| 10/10 [01:09<00:00,  8.07s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9349, 'compress@10': 0.5258, 'time@10': 9.7777}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.01774995511411617
Avg hit ratio: 0.891033495272884
Avg ndcg: 0.9349366304726224
Avg compression ratio: 0.5258201532843013
Avg train time: 9.777673935890197
Std train time: 3.2968016585448554
[0.8225806451612901, 0.24193548387096775, 0.048387096774193554, 0.8225806451612901, 0.9193548387096773, 0.6612903225806451, 0.5322580645161291, 0.2096774193548388, 0.5322580645161291, 0.20967741935483872]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9015, 'compress@10': 0.8319, 'time@10': 8.5754}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9015, 'compress@10': 0.8319, 'time@10': 8.5754}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9439, 'compress@10': 0.5492, 'time@10': 7.8089}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9439, 'compress@10': 0.5492, 'time@10': 7.8089}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.915, 'compress@10': 0.4275, 'time@10': 7.1571}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.915, 'compress@10': 0.4275, 'time@10': 7.1571}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9252, 'compress@10': 0.5279, 'time@10': 6.9801}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9252, 'compress@10': 0.5279, 'time@10': 6.9801}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9262, 'compress@10': 0.6065, 'time@10': 8.3812}:  40%|████      | 4/10 [00:27<00:32,  5.34s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9262, 'compress@10': 0.6065, 'time@10': 8.3812}:  50%|█████     | 5/10 [00:27<00:29,  5.95s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9319, 'compress@10': 0.6169, 'time@10': 8.714}:  50%|█████     | 5/10 [00:38<00:29,  5.95s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9319, 'compress@10': 0.6169, 'time@10': 8.714}:  60%|██████    | 6/10 [00:38<00:29,  7.47s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9346, 'compress@10': 0.6075, 'time@10': 9.0798}:  60%|██████    | 6/10 [00:43<00:29,  7.47s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9346, 'compress@10': 0.6075, 'time@10': 9.0798}:  70%|███████   | 7/10 [00:43<00:20,  6.88s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9384, 'compress@10': 0.5606, 'time@10': 8.8855}:  70%|███████   | 7/10 [00:51<00:20,  6.88s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9384, 'compress@10': 0.5606, 'time@10': 8.8855}:  80%|████████  | 8/10 [00:51<00:14,  7.10s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9396, 'compress@10': 0.5589, 'time@10': 9.5181}:  80%|████████  | 8/10 [00:58<00:14,  7.10s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9396, 'compress@10': 0.5589, 'time@10': 9.5181}:  90%|█████████ | 9/10 [00:58<00:07,  7.17s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9433, 'compress@10': 0.5258, 'time@10': 9.5698}:  90%|█████████ | 9/10 [01:08<00:07,  7.17s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9433, 'compress@10': 0.5258, 'time@10': 9.5698}: 100%|██████████| 10/10 [01:08<00:00,  8.07s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9433, 'compress@10': 0.5258, 'time@10': 9.5698}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.012559453424241895
Avg hit ratio: 0.8932557174951062
Avg ndcg: 0.9432722020139443
Avg compression ratio: 0.5257791618870615
Avg train time: 9.569824743270875
Std train time: 2.88906733374928
[0.8281249999999998, 0.265625, 0.04687500000000001, 0.8281249999999998, 0.8906249999999999, 0.671875, 0.5156250000000001, 0.20312500000000008, 0.5468750000000001, 0.203125]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9048, 'compress@10': 0.8372, 'time@10': 8.5531}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9048, 'compress@10': 0.8372, 'time@10': 8.5531}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9401, 'compress@10': 0.5632, 'time@10': 7.818}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it] {'epoch': 31, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9401, 'compress@10': 0.5632, 'time@10': 7.818}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9125, 'compress@10': 0.4365, 'time@10': 7.2108}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9125, 'compress@10': 0.4365, 'time@10': 7.2108}:  30%|███       | 3/10 [00:14<00:32,  4.63s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9237, 'compress@10': 0.5359, 'time@10': 6.9926}:  30%|███       | 3/10 [00:20<00:32,  4.63s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9237, 'compress@10': 0.5359, 'time@10': 6.9926}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.925, 'compress@10': 0.6073, 'time@10': 8.417}:  40%|████      | 4/10 [00:27<00:31,  5.32s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.925, 'compress@10': 0.6073, 'time@10': 8.417}:  50%|█████     | 5/10 [00:27<00:29,  5.96s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9307, 'compress@10': 0.6193, 'time@10': 8.7707}:  50%|█████     | 5/10 [00:38<00:29,  5.96s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9307, 'compress@10': 0.6193, 'time@10': 8.7707}:  60%|██████    | 6/10 [00:38<00:30,  7.53s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9335, 'compress@10': 0.6072, 'time@10': 9.0965}:  60%|██████    | 6/10 [00:44<00:30,  7.53s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9335, 'compress@10': 0.6072, 'time@10': 9.0965}:  70%|███████   | 7/10 [00:44<00:20,  6.89s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9377, 'compress@10': 0.5596, 'time@10': 8.9169}:  70%|███████   | 7/10 [00:51<00:20,  6.89s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9377, 'compress@10': 0.5596, 'time@10': 8.9169}:  80%|████████  | 8/10 [00:51<00:14,  7.15s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.947, 'compress@10': 0.5596, 'time@10': 9.5472}:  80%|████████  | 8/10 [00:59<00:14,  7.15s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.947, 'compress@10': 0.5596, 'time@10': 9.5472}:  90%|█████████ | 9/10 [00:59<00:07,  7.20s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9474, 'compress@10': 0.5258, 'time@10': 9.5603}:  90%|█████████ | 9/10 [01:08<00:07,  7.20s/it]  {'epoch': 31, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9474, 'compress@10': 0.5258, 'time@10': 9.5603}: 100%|██████████| 10/10 [01:08<00:00,  7.98s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9474, 'compress@10': 0.5258, 'time@10': 9.5603}: 100%|██████████| 10/10 [01:08<00:00,  6.88s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.017567522215163174
Avg hit ratio: 0.8885450160102113
Avg ndcg: 0.9473780200264569
Avg compression ratio: 0.5257689592579844
Avg train time: 9.560286927223206
Std train time: 2.882302208176391
[0.8333333333333331, 0.25757575757575757, 0.04545454545454546, 0.8030303030303028, 0.8636363636363635, 0.6818181818181818, 0.5303030303030304, 0.19696969696969704, 0.5606060606060607, 0.22727272727272727]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9084, 'compress@10': 0.8421, 'time@10': 8.5562}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9084, 'compress@10': 0.8421, 'time@10': 8.5562}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.937, 'compress@10': 0.5618, 'time@10': 7.788}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]  {'epoch': 32, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.937, 'compress@10': 0.5618, 'time@10': 7.788}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9104, 'compress@10': 0.4351, 'time@10': 7.1864}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9104, 'compress@10': 0.4351, 'time@10': 7.1864}:  30%|███       | 3/10 [00:14<00:32,  4.60s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9222, 'compress@10': 0.5289, 'time@10': 6.9582}:  30%|███       | 3/10 [00:20<00:32,  4.60s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9222, 'compress@10': 0.5289, 'time@10': 6.9582}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9255, 'compress@10': 0.5964, 'time@10': 8.3902}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9255, 'compress@10': 0.5964, 'time@10': 8.3902}:  50%|█████     | 5/10 [00:27<00:29,  5.93s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.933, 'compress@10': 0.6118, 'time@10': 8.7296}:  50%|█████     | 5/10 [00:38<00:29,  5.93s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.933, 'compress@10': 0.6118, 'time@10': 8.7296}:  60%|██████    | 6/10 [00:38<00:29,  7.48s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0109, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9326, 'compress@10': 0.6028, 'time@10': 9.1168}:  60%|██████    | 6/10 [00:44<00:29,  7.48s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0109, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9326, 'compress@10': 0.6028, 'time@10': 9.1168}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9365, 'compress@10': 0.555, 'time@10': 8.9145}:  70%|███████   | 7/10 [00:51<00:20,  6.92s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9365, 'compress@10': 0.555, 'time@10': 8.9145}:  80%|████████  | 8/10 [00:51<00:14,  7.11s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9388, 'compress@10': 0.557, 'time@10': 9.5557}:  80%|████████  | 8/10 [00:58<00:14,  7.11s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9388, 'compress@10': 0.557, 'time@10': 9.5557}:  90%|█████████ | 9/10 [00:58<00:07,  7.20s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9426, 'compress@10': 0.5258, 'time@10': 9.6008}:  90%|█████████ | 9/10 [01:09<00:07,  7.20s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9426, 'compress@10': 0.5258, 'time@10': 9.6008}: 100%|██████████| 10/10 [01:09<00:00,  8.08s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9426, 'compress@10': 0.5258, 'time@10': 9.6008}: 100%|██████████| 10/10 [01:09<00:00,  6.90s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.011272798225486675
Avg hit ratio: 0.9007109146277228
Avg ndcg: 0.9425524326913536
Avg compression ratio: 0.5257728498671653
Avg train time: 9.600766372680663
Std train time: 2.946500646816827
[0.8382352941176469, 0.25, 0.04411764705882354, 0.8088235294117645, 0.8676470588235293, 0.6617647058823529, 0.5441176470588236, 0.19117647058823536, 0.573529411764706, 0.22058823529411764]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9175, 'compress@10': 0.8467, 'time@10': 8.5215}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9175, 'compress@10': 0.8467, 'time@10': 8.5215}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9416, 'compress@10': 0.5605, 'time@10': 7.7601}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9416, 'compress@10': 0.5605, 'time@10': 7.7601}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9135, 'compress@10': 0.4339, 'time@10': 7.1311}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9135, 'compress@10': 0.4339, 'time@10': 7.1311}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9245, 'compress@10': 0.5293, 'time@10': 6.9362}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9245, 'compress@10': 0.5293, 'time@10': 6.9362}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9263, 'compress@10': 0.5975, 'time@10': 8.3464}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9263, 'compress@10': 0.5975, 'time@10': 8.3464}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9327, 'compress@10': 0.6095, 'time@10': 8.6997}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9327, 'compress@10': 0.6095, 'time@10': 8.6997}:  60%|██████    | 6/10 [00:38<00:29,  7.48s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9356, 'compress@10': 0.6027, 'time@10': 9.1152}:  60%|██████    | 6/10 [00:44<00:29,  7.48s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9356, 'compress@10': 0.6027, 'time@10': 9.1152}:  70%|███████   | 7/10 [00:44<00:20,  6.94s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9356, 'compress@10': 0.5542, 'time@10': 8.9201}:  70%|███████   | 7/10 [00:51<00:20,  6.94s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9356, 'compress@10': 0.5542, 'time@10': 8.9201}:  80%|████████  | 8/10 [00:51<00:14,  7.15s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9524, 'compress@10': 0.5577, 'time@10': 9.5463}:  80%|████████  | 8/10 [00:58<00:14,  7.15s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9524, 'compress@10': 0.5577, 'time@10': 9.5463}:  90%|█████████ | 9/10 [00:58<00:07,  7.20s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9533, 'compress@10': 0.5257, 'time@10': 9.5725}:  90%|█████████ | 9/10 [01:08<00:07,  7.20s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9533, 'compress@10': 0.5257, 'time@10': 9.5725}: 100%|██████████| 10/10 [01:08<00:00,  8.03s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9533, 'compress@10': 0.5257, 'time@10': 9.5725}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.015885522682793606
Avg hit ratio: 0.8846842889236777
Avg ndcg: 0.9532676171637405
Avg compression ratio: 0.5257461469951923
Avg train time: 9.572487831115723
Std train time: 2.9186963123672327
[0.8428571428571426, 0.24285714285714285, 0.042857142857142864, 0.8142857142857141, 0.8428571428571427, 0.6714285714285714, 0.5285714285714286, 0.18571428571428578, 0.5857142857142857, 0.24285714285714285]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9175, 'compress@10': 0.8511, 'time@10': 8.2981}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9175, 'compress@10': 0.8511, 'time@10': 8.2981}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9536, 'compress@10': 0.5592, 'time@10': 7.6342}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9536, 'compress@10': 0.5592, 'time@10': 7.6342}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9215, 'compress@10': 0.4327, 'time@10': 6.9999}:  20%|██        | 2/10 [00:14<00:46,  5.85s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9215, 'compress@10': 0.4327, 'time@10': 6.9999}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9316, 'compress@10': 0.5297, 'time@10': 6.8673}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9316, 'compress@10': 0.5297, 'time@10': 6.8673}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9339, 'compress@10': 0.593, 'time@10': 8.2488}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9339, 'compress@10': 0.593, 'time@10': 8.2488}:  50%|█████     | 5/10 [00:27<00:29,  5.88s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9368, 'compress@10': 0.6073, 'time@10': 8.5885}:  50%|█████     | 5/10 [00:37<00:29,  5.88s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9368, 'compress@10': 0.6073, 'time@10': 8.5885}:  60%|██████    | 6/10 [00:37<00:29,  7.39s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9391, 'compress@10': 0.5987, 'time@10': 9.0098}:  60%|██████    | 6/10 [00:43<00:29,  7.39s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9391, 'compress@10': 0.5987, 'time@10': 9.0098}:  70%|███████   | 7/10 [00:43<00:20,  6.87s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.943, 'compress@10': 0.55, 'time@10': 8.8102}:  70%|███████   | 7/10 [00:51<00:20,  6.87s/it]    {'epoch': 34, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.943, 'compress@10': 0.55, 'time@10': 8.8102}:  80%|████████  | 8/10 [00:51<00:14,  7.06s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.885, 'ndcg@10': 0.94, 'compress@10': 0.5553, 'time@10': 9.4514}:  80%|████████  | 8/10 [00:58<00:14,  7.06s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.885, 'ndcg@10': 0.94, 'compress@10': 0.5553, 'time@10': 9.4514}:  90%|█████████ | 9/10 [00:58<00:07,  7.14s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9436, 'compress@10': 0.5258, 'time@10': 9.4863}:  90%|█████████ | 9/10 [01:08<00:07,  7.14s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9436, 'compress@10': 0.5258, 'time@10': 9.4863}: 100%|██████████| 10/10 [01:08<00:00,  7.98s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9436, 'compress@10': 0.5258, 'time@10': 9.4863}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.014624418797441207
Avg hit ratio: 0.8942593017244971
Avg ndcg: 0.943599006220739
Avg compression ratio: 0.5257652462277841
Avg train time: 9.486276412010193
Std train time: 2.907500903896602
[0.8194444444444442, 0.2638888888888889, 0.04166666666666667, 0.7916666666666664, 0.8472222222222221, 0.6805555555555555, 0.5416666666666666, 0.1805555555555556, 0.5972222222222222, 0.2361111111111111]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.915, 'compress@10': 0.8289, 'time@10': 8.4643}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.915, 'compress@10': 0.8289, 'time@10': 8.4643}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9418, 'compress@10': 0.5583, 'time@10': 7.6964}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9418, 'compress@10': 0.5583, 'time@10': 7.6964}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9136, 'compress@10': 0.4317, 'time@10': 7.0961}:  20%|██        | 2/10 [00:14<00:46,  5.85s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9136, 'compress@10': 0.4317, 'time@10': 7.0961}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9257, 'compress@10': 0.5236, 'time@10': 6.9228}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9257, 'compress@10': 0.5236, 'time@10': 6.9228}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9308, 'compress@10': 0.5889, 'time@10': 8.3428}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9308, 'compress@10': 0.5889, 'time@10': 8.3428}:  50%|█████     | 5/10 [00:27<00:29,  5.93s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9379, 'compress@10': 0.6054, 'time@10': 8.6665}:  50%|█████     | 5/10 [00:38<00:29,  5.93s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9379, 'compress@10': 0.6054, 'time@10': 8.6665}:  60%|██████    | 6/10 [00:38<00:29,  7.42s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9384, 'compress@10': 0.5989, 'time@10': 9.0536}:  60%|██████    | 6/10 [00:43<00:29,  7.42s/it] {'epoch': 35, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9384, 'compress@10': 0.5989, 'time@10': 9.0536}:  70%|███████   | 7/10 [00:43<00:20,  6.87s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9409, 'compress@10': 0.5495, 'time@10': 8.8772}:  70%|███████   | 7/10 [00:51<00:20,  6.87s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9409, 'compress@10': 0.5495, 'time@10': 8.8772}:  80%|████████  | 8/10 [00:51<00:14,  7.13s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9522, 'compress@10': 0.5561, 'time@10': 9.479}:  80%|████████  | 8/10 [00:58<00:14,  7.13s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9522, 'compress@10': 0.5561, 'time@10': 9.479}:  90%|█████████ | 9/10 [00:58<00:07,  7.15s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9525, 'compress@10': 0.5258, 'time@10': 9.5196}:  90%|█████████ | 9/10 [01:08<00:07,  7.15s/it]  {'epoch': 35, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9525, 'compress@10': 0.5258, 'time@10': 9.5196}: 100%|██████████| 10/10 [01:08<00:00,  8.00s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9525, 'compress@10': 0.5258, 'time@10': 9.5196}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.015183248636848754
Avg hit ratio: 0.894627965318967
Avg ndcg: 0.952484980971214
Avg compression ratio: 0.5258321899330209
Avg train time: 9.519582152366638
Std train time: 2.8536819098474497
[0.8243243243243241, 0.25675675675675674, 0.04054054054054054, 0.797297297297297, 0.8243243243243242, 0.6621621621621621, 0.5540540540540541, 0.1756756756756757, 0.6081081081081081, 0.25675675675675674]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9249, 'compress@10': 0.8336, 'time@10': 8.6834}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9249, 'compress@10': 0.8336, 'time@10': 8.6834}:  10%|█         | 1/10 [00:04<00:39,  4.39s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9463, 'compress@10': 0.5571, 'time@10': 7.8576}:  10%|█         | 1/10 [00:11<00:39,  4.39s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9463, 'compress@10': 0.5571, 'time@10': 7.8576}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9166, 'compress@10': 0.4306, 'time@10': 7.1957}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9166, 'compress@10': 0.4306, 'time@10': 7.1957}:  30%|███       | 3/10 [00:14<00:32,  4.60s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9268, 'compress@10': 0.5241, 'time@10': 6.9552}:  30%|███       | 3/10 [00:20<00:32,  4.60s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9268, 'compress@10': 0.5241, 'time@10': 6.9552}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9321, 'compress@10': 0.5849, 'time@10': 8.4535}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]  {'epoch': 36, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9321, 'compress@10': 0.5849, 'time@10': 8.4535}:  50%|█████     | 5/10 [00:27<00:29,  5.98s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9451, 'compress@10': 0.599, 'time@10': 8.767}:  50%|█████     | 5/10 [00:38<00:29,  5.98s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9451, 'compress@10': 0.599, 'time@10': 8.767}:  60%|██████    | 6/10 [00:38<00:29,  7.48s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9462, 'compress@10': 0.5951, 'time@10': 9.2221}:  60%|██████    | 6/10 [00:44<00:29,  7.48s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9462, 'compress@10': 0.5951, 'time@10': 9.2221}:  70%|███████   | 7/10 [00:44<00:20,  7.00s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9452, 'compress@10': 0.5456, 'time@10': 9.0008}:  70%|███████   | 7/10 [00:51<00:20,  7.00s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9452, 'compress@10': 0.5456, 'time@10': 9.0008}:  80%|████████  | 8/10 [00:51<00:14,  7.15s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9465, 'compress@10': 0.5538, 'time@10': 9.6095}:  80%|████████  | 8/10 [00:59<00:14,  7.15s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9465, 'compress@10': 0.5538, 'time@10': 9.6095}:  90%|█████████ | 9/10 [00:59<00:07,  7.19s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9496, 'compress@10': 0.5258, 'time@10': 9.6289}:  90%|█████████ | 9/10 [01:08<00:07,  7.19s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9496, 'compress@10': 0.5258, 'time@10': 9.6289}: 100%|██████████| 10/10 [01:08<00:00,  8.01s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9496, 'compress@10': 0.5258, 'time@10': 9.6289}: 100%|██████████| 10/10 [01:08<00:00,  6.90s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.013831321250777809
Avg hit ratio: 0.8961128603522491
Avg ndcg: 0.949553327834934
Avg compression ratio: 0.5257994520597504
Avg train time: 9.628944826126098
Std train time: 3.011433379942124
[0.8289473684210524, 0.25, 0.03947368421052632, 0.8026315789473681, 0.8026315789473684, 0.6710526315789472, 0.5394736842105263, 0.1973684210526316, 0.618421052631579, 0.25]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9215, 'compress@10': 0.8379, 'time@10': 8.6421}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9215, 'compress@10': 0.8379, 'time@10': 8.6421}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9533, 'compress@10': 0.5561, 'time@10': 7.7673}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9533, 'compress@10': 0.5561, 'time@10': 7.7673}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9212, 'compress@10': 0.4296, 'time@10': 7.1322}:  20%|██        | 2/10 [00:14<00:46,  5.87s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9212, 'compress@10': 0.4296, 'time@10': 7.1322}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9321, 'compress@10': 0.5246, 'time@10': 6.9224}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9321, 'compress@10': 0.5246, 'time@10': 6.9224}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9351, 'compress@10': 0.581, 'time@10': 8.3084}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9351, 'compress@10': 0.581, 'time@10': 8.3084}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9417, 'compress@10': 0.5972, 'time@10': 8.6098}:  50%|█████     | 5/10 [00:37<00:29,  5.87s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9417, 'compress@10': 0.5972, 'time@10': 8.6098}:  60%|██████    | 6/10 [00:37<00:29,  7.33s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9433, 'compress@10': 0.5916, 'time@10': 8.9904}:  60%|██████    | 6/10 [00:43<00:29,  7.33s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9433, 'compress@10': 0.5916, 'time@10': 8.9904}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.959, 'compress@10': 0.5452, 'time@10': 8.7804}:  70%|███████   | 7/10 [00:50<00:20,  6.79s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.959, 'compress@10': 0.5452, 'time@10': 8.7804}:  80%|████████  | 8/10 [00:50<00:13,  6.96s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9658, 'compress@10': 0.5545, 'time@10': 9.3962}:  80%|████████  | 8/10 [00:57<00:13,  6.96s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9658, 'compress@10': 0.5545, 'time@10': 9.3962}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9651, 'compress@10': 0.5258, 'time@10': 9.4311}:  90%|█████████ | 9/10 [01:07<00:07,  7.04s/it]  {'epoch': 37, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9651, 'compress@10': 0.5258, 'time@10': 9.4311}: 100%|██████████| 10/10 [01:07<00:00,  7.88s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9651, 'compress@10': 0.5258, 'time@10': 9.4311}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.016684655296666635
Avg hit ratio: 0.8879100953752908
Avg ndcg: 0.965061024333524
Avg compression ratio: 0.5257984389645294
Avg train time: 9.431054759025574
Std train time: 2.8563941127402908
[0.8333333333333331, 0.2692307692307692, 0.038461538461538464, 0.7820512820512818, 0.7820512820512819, 0.6538461538461537, 0.5256410256410257, 0.21794871794871798, 0.6282051282051282, 0.2692307692307692]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9174, 'compress@10': 0.8421, 'time@10': 8.3966}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9174, 'compress@10': 0.8421, 'time@10': 8.3966}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9415, 'compress@10': 0.5674, 'time@10': 7.7463}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9415, 'compress@10': 0.5674, 'time@10': 7.7463}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9134, 'compress@10': 0.4369, 'time@10': 7.1108}:  20%|██        | 2/10 [00:14<00:47,  5.94s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9134, 'compress@10': 0.4369, 'time@10': 7.1108}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.925, 'compress@10': 0.5251, 'time@10': 6.9286}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.925, 'compress@10': 0.5251, 'time@10': 6.9286}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9316, 'compress@10': 0.5774, 'time@10': 8.3363}:  40%|████      | 4/10 [00:27<00:31,  5.31s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9316, 'compress@10': 0.5774, 'time@10': 8.3363}:  50%|█████     | 5/10 [00:27<00:29,  5.93s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9455, 'compress@10': 0.5914, 'time@10': 8.7129}:  50%|█████     | 5/10 [00:38<00:29,  5.93s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9455, 'compress@10': 0.5914, 'time@10': 8.7129}:  60%|██████    | 6/10 [00:38<00:30,  7.53s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9449, 'compress@10': 0.5847, 'time@10': 9.0997}:  60%|██████    | 6/10 [00:44<00:30,  7.53s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9449, 'compress@10': 0.5847, 'time@10': 9.0997}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9618, 'compress@10': 0.5417, 'time@10': 8.8891}:  70%|███████   | 7/10 [00:51<00:20,  6.95s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9618, 'compress@10': 0.5417, 'time@10': 8.8891}:  80%|████████  | 8/10 [00:51<00:14,  7.11s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9615, 'compress@10': 0.5525, 'time@10': 9.472}:  80%|████████  | 8/10 [00:58<00:14,  7.11s/it] {'epoch': 38, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9615, 'compress@10': 0.5525, 'time@10': 9.472}:  90%|█████████ | 9/10 [00:58<00:07,  7.11s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9631, 'compress@10': 0.5258, 'time@10': 9.5107}:  90%|█████████ | 9/10 [01:08<00:07,  7.11s/it] {'epoch': 38, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9631, 'compress@10': 0.5258, 'time@10': 9.5107}: 100%|██████████| 10/10 [01:08<00:00,  7.97s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9631, 'compress@10': 0.5258, 'time@10': 9.5107}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.014651884959698372
Avg hit ratio: 0.8981200288110305
Avg ndcg: 0.9630931701681321
Avg compression ratio: 0.5258063065765585
Avg train time: 9.510707926750182
Std train time: 2.844753458498735
[0.8124999999999998, 0.2625, 0.037500000000000006, 0.7874999999999998, 0.7624999999999998, 0.6624999999999999, 0.5375, 0.23750000000000004, 0.6375, 0.2625]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.8224, 'time@10': 8.3802}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.8224, 'time@10': 8.3802}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9437, 'compress@10': 0.5543, 'time@10': 7.7106}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it] {'epoch': 39, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9437, 'compress@10': 0.5543, 'time@10': 7.7106}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9148, 'compress@10': 0.4279, 'time@10': 7.098}:  20%|██        | 2/10 [00:14<00:47,  5.90s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9148, 'compress@10': 0.4279, 'time@10': 7.098}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9273, 'compress@10': 0.5197, 'time@10': 6.8945}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9273, 'compress@10': 0.5197, 'time@10': 6.8945}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9327, 'compress@10': 0.5692, 'time@10': 8.3633}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9327, 'compress@10': 0.5692, 'time@10': 8.3633}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0082, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9397, 'compress@10': 0.586, 'time@10': 8.715}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0082, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9397, 'compress@10': 0.586, 'time@10': 8.715}:  60%|██████    | 6/10 [00:38<00:29,  7.50s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9416, 'compress@10': 0.5817, 'time@10': 9.0963}:  60%|██████    | 6/10 [00:44<00:29,  7.50s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9416, 'compress@10': 0.5817, 'time@10': 9.0963}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9447, 'compress@10': 0.5414, 'time@10': 8.8912}:  70%|███████   | 7/10 [00:51<00:20,  6.92s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9447, 'compress@10': 0.5414, 'time@10': 8.8912}:  80%|████████  | 8/10 [00:51<00:14,  7.10s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0107, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9599, 'compress@10': 0.5532, 'time@10': 9.5008}:  80%|████████  | 8/10 [00:58<00:14,  7.10s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0107, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9599, 'compress@10': 0.5532, 'time@10': 9.5008}:  90%|█████████ | 9/10 [00:58<00:07,  7.14s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9598, 'compress@10': 0.5258, 'time@10': 9.5494}:  90%|█████████ | 9/10 [01:08<00:07,  7.14s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9598, 'compress@10': 0.5258, 'time@10': 9.5494}: 100%|██████████| 10/10 [01:08<00:00,  8.03s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9598, 'compress@10': 0.5258, 'time@10': 9.5494}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.012264464377531287
Avg hit ratio: 0.8932557174951062
Avg ndcg: 0.9598330824636667
Avg compression ratio: 0.525838206102077
Avg train time: 9.549359321594238
Std train time: 2.9314421321906026
[0.8170731707317072, 0.25609756097560976, 0.03658536585365854, 0.7926829268292681, 0.7439024390243901, 0.646341463414634, 0.524390243902439, 0.2560975609756098, 0.646341463414634, 0.2804878048780488]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.8267, 'time@10': 8.4306}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.8267, 'time@10': 8.4306}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9389, 'compress@10': 0.5534, 'time@10': 7.6782}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9389, 'compress@10': 0.5534, 'time@10': 7.6782}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9117, 'compress@10': 0.427, 'time@10': 7.1218}:  20%|██        | 2/10 [00:14<00:46,  5.85s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9117, 'compress@10': 0.427, 'time@10': 7.1218}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9249, 'compress@10': 0.5203, 'time@10': 6.935}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9249, 'compress@10': 0.5203, 'time@10': 6.935}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9303, 'compress@10': 0.566, 'time@10': 8.3525}:  40%|████      | 4/10 [00:27<00:31,  5.30s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9303, 'compress@10': 0.566, 'time@10': 8.3525}:  50%|█████     | 5/10 [00:27<00:29,  5.93s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9379, 'compress@10': 0.5807, 'time@10': 8.7081}:  50%|█████     | 5/10 [00:38<00:29,  5.93s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9379, 'compress@10': 0.5807, 'time@10': 8.7081}:  60%|██████    | 6/10 [00:38<00:29,  7.49s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9398, 'compress@10': 0.5754, 'time@10': 9.051}:  60%|██████    | 6/10 [00:43<00:29,  7.49s/it] {'epoch': 40, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9398, 'compress@10': 0.5754, 'time@10': 9.051}:  70%|███████   | 7/10 [00:43<00:20,  6.87s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9488, 'compress@10': 0.5381, 'time@10': 8.842}:  70%|███████   | 7/10 [00:51<00:20,  6.87s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9488, 'compress@10': 0.5381, 'time@10': 8.842}:  80%|████████  | 8/10 [00:51<00:14,  7.04s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9464, 'compress@10': 0.5513, 'time@10': 9.455}:  80%|████████  | 8/10 [00:58<00:14,  7.04s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9464, 'compress@10': 0.5513, 'time@10': 9.455}:  90%|█████████ | 9/10 [00:58<00:07,  7.10s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9495, 'compress@10': 0.5258, 'time@10': 9.4984}:  90%|█████████ | 9/10 [01:08<00:07,  7.10s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9495, 'compress@10': 0.5258, 'time@10': 9.4984}: 100%|██████████| 10/10 [01:08<00:00,  7.97s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9495, 'compress@10': 0.5258, 'time@10': 9.4984}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.011586158412567462
Avg hit ratio: 0.907033495272884
Avg ndcg: 0.9494518054744068
Avg compression ratio: 0.5258345629675181
Avg train time: 9.498415565490722
Std train time: 2.8634204390403872
[0.7976190476190474, 0.27380952380952384, 0.03571428571428572, 0.7976190476190474, 0.7499999999999999, 0.6309523809523808, 0.511904761904762, 0.2738095238095239, 0.6547619047619047, 0.27380952380952384]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9245, 'compress@10': 0.8083, 'time@10': 8.4892}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9245, 'compress@10': 0.8083, 'time@10': 8.4892}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9569, 'compress@10': 0.5527, 'time@10': 7.7959}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9569, 'compress@10': 0.5527, 'time@10': 7.7959}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9236, 'compress@10': 0.4263, 'time@10': 7.2473}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9236, 'compress@10': 0.4263, 'time@10': 7.2473}:  30%|███       | 3/10 [00:14<00:32,  4.66s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9339, 'compress@10': 0.521, 'time@10': 7.0434}:  30%|███       | 3/10 [00:21<00:32,  4.66s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9339, 'compress@10': 0.521, 'time@10': 7.0434}:  40%|████      | 4/10 [00:21<00:32,  5.38s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9376, 'compress@10': 0.5678, 'time@10': 8.4086}:  40%|████      | 4/10 [00:27<00:32,  5.38s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9376, 'compress@10': 0.5678, 'time@10': 8.4086}:  50%|█████     | 5/10 [00:27<00:29,  5.95s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9489, 'compress@10': 0.5797, 'time@10': 8.7797}:  50%|█████     | 5/10 [00:38<00:29,  5.95s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9489, 'compress@10': 0.5797, 'time@10': 8.7797}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9478, 'compress@10': 0.5728, 'time@10': 9.082}:  60%|██████    | 6/10 [00:44<00:30,  7.56s/it] {'epoch': 41, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9478, 'compress@10': 0.5728, 'time@10': 9.082}:  70%|███████   | 7/10 [00:44<00:20,  6.88s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9589, 'compress@10': 0.538, 'time@10': 8.8682}:  70%|███████   | 7/10 [00:51<00:20,  6.88s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9589, 'compress@10': 0.538, 'time@10': 8.8682}:  80%|████████  | 8/10 [00:51<00:14,  7.05s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9698, 'compress@10': 0.5521, 'time@10': 9.4904}:  80%|████████  | 8/10 [00:58<00:14,  7.05s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9698, 'compress@10': 0.5521, 'time@10': 9.4904}:  90%|█████████ | 9/10 [00:58<00:07,  7.12s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9672, 'compress@10': 0.5259, 'time@10': 9.5649}:  90%|█████████ | 9/10 [01:09<00:07,  7.12s/it]    {'epoch': 41, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9672, 'compress@10': 0.5259, 'time@10': 9.5649}: 100%|██████████| 10/10 [01:09<00:00,  8.10s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9672, 'compress@10': 0.5259, 'time@10': 9.5649}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.01698067259520141
Avg hit ratio: 0.9043156253292077
Avg ndcg: 0.9672490336964626
Avg compression ratio: 0.5258875707705515
Avg train time: 9.564935326576233
Std train time: 2.818572707497531
[0.7790697674418603, 0.2674418604651163, 0.034883720930232565, 0.7790697674418603, 0.7325581395348836, 0.6395348837209301, 0.5232558139534884, 0.2906976744186047, 0.6627906976744184, 0.29069767441860467]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9281, 'compress@10': 0.7907, 'time@10': 8.7192}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9281, 'compress@10': 0.7907, 'time@10': 8.7192}:  10%|█         | 1/10 [00:04<00:39,  4.40s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9474, 'compress@10': 0.5409, 'time@10': 7.8928}:  10%|█         | 1/10 [00:11<00:39,  4.40s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9474, 'compress@10': 0.5409, 'time@10': 7.8928}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9173, 'compress@10': 0.4182, 'time@10': 7.2228}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9173, 'compress@10': 0.4182, 'time@10': 7.2228}:  30%|███       | 3/10 [00:14<00:32,  4.62s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9285, 'compress@10': 0.5104, 'time@10': 7.0338}:  30%|███       | 3/10 [00:20<00:32,  4.62s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9285, 'compress@10': 0.5104, 'time@10': 7.0338}:  40%|████      | 4/10 [00:20<00:32,  5.36s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9354, 'compress@10': 0.5559, 'time@10': 8.453}:  40%|████      | 4/10 [00:28<00:32,  5.36s/it] {'epoch': 42, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9354, 'compress@10': 0.5559, 'time@10': 8.453}:  50%|█████     | 5/10 [00:28<00:29,  5.99s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0071, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9422, 'compress@10': 0.5712, 'time@10': 8.7956}:  50%|█████     | 5/10 [00:38<00:29,  5.99s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0071, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9422, 'compress@10': 0.5712, 'time@10': 8.7956}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0067, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9444, 'compress@10': 0.567, 'time@10': 9.1837}:  60%|██████    | 6/10 [00:44<00:30,  7.54s/it] {'epoch': 42, 'num_users': 6.2857, 'loss': 0.0067, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9444, 'compress@10': 0.567, 'time@10': 9.1837}:  70%|███████   | 7/10 [00:44<00:20,  6.97s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.008, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9529, 'compress@10': 0.535, 'time@10': 8.9799}:  70%|███████   | 7/10 [00:52<00:20,  6.97s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.008, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9529, 'compress@10': 0.535, 'time@10': 8.9799}:  80%|████████  | 8/10 [00:52<00:14,  7.17s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9535, 'compress@10': 0.5503, 'time@10': 9.5894}:  80%|████████  | 8/10 [00:59<00:14,  7.17s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9535, 'compress@10': 0.5503, 'time@10': 9.5894}:  90%|█████████ | 9/10 [00:59<00:07,  7.20s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.9559, 'compress@10': 0.5259, 'time@10': 9.631}:  90%|█████████ | 9/10 [01:09<00:07,  7.20s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.9559, 'compress@10': 0.5259, 'time@10': 9.631}: 100%|██████████| 10/10 [01:09<00:00,  8.08s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.9559, 'compress@10': 0.5259, 'time@10': 9.631}: 100%|██████████| 10/10 [01:09<00:00,  6.93s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.008591939939525941
Avg hit ratio: 0.9174851081761097
Avg ndcg: 0.9558556258172963
Avg compression ratio: 0.52594461819326
Avg train time: 9.631048345565796
Std train time: 2.8956080282507135
[0.784090909090909, 0.2613636363636364, 0.034090909090909095, 0.784090909090909, 0.7386363636363635, 0.6249999999999999, 0.5113636363636364, 0.3068181818181819, 0.6704545454545453, 0.2840909090909091]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.93, 'compress@10': 0.7954, 'time@10': 8.6616}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.93, 'compress@10': 0.7954, 'time@10': 8.6616}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9528, 'compress@10': 0.5403, 'time@10': 7.8511}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9528, 'compress@10': 0.5403, 'time@10': 7.8511}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9209, 'compress@10': 0.4176, 'time@10': 7.241}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9209, 'compress@10': 0.4176, 'time@10': 7.241}:  30%|███       | 3/10 [00:14<00:32,  4.63s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9318, 'compress@10': 0.5111, 'time@10': 7.0191}:  30%|███       | 3/10 [00:20<00:32,  4.63s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9318, 'compress@10': 0.5111, 'time@10': 7.0191}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9366, 'compress@10': 0.5577, 'time@10': 8.4485}:  40%|████      | 4/10 [00:28<00:31,  5.33s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9366, 'compress@10': 0.5577, 'time@10': 8.4485}:  50%|█████     | 5/10 [00:28<00:29,  5.97s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9427, 'compress@10': 0.5703, 'time@10': 8.7845}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9427, 'compress@10': 0.5703, 'time@10': 8.7845}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.9443, 'compress@10': 0.5647, 'time@10': 9.1931}:  60%|██████    | 6/10 [00:44<00:30,  7.51s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.9443, 'compress@10': 0.5647, 'time@10': 9.1931}:  70%|███████   | 7/10 [00:44<00:20,  6.97s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9301, 'ndcg@10': 0.9575, 'compress@10': 0.5349, 'time@10': 9.0093}:  70%|███████   | 7/10 [00:52<00:20,  6.97s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9301, 'ndcg@10': 0.9575, 'compress@10': 0.5349, 'time@10': 9.0093}:  80%|████████  | 8/10 [00:52<00:14,  7.23s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9665, 'compress@10': 0.551, 'time@10': 9.5745}:  80%|████████  | 8/10 [00:59<00:14,  7.23s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9665, 'compress@10': 0.551, 'time@10': 9.5745}:  90%|█████████ | 9/10 [00:59<00:07,  7.18s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.919, 'ndcg@10': 0.964, 'compress@10': 0.5259, 'time@10': 9.6091}:  90%|█████████ | 9/10 [01:09<00:07,  7.18s/it]    {'epoch': 43, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.919, 'ndcg@10': 0.964, 'compress@10': 0.5259, 'time@10': 9.6091}: 100%|██████████| 10/10 [01:09<00:00,  8.04s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.919, 'ndcg@10': 0.964, 'compress@10': 0.5259, 'time@10': 9.6091}: 100%|██████████| 10/10 [01:09<00:00,  6.92s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.014155838792480729
Avg hit ratio: 0.918970003209392
Avg ndcg: 0.9640032779154127
Avg compression ratio: 0.5259458251258375
Avg train time: 9.60910210609436
Std train time: 2.8353860282700025
[0.7888888888888888, 0.2555555555555556, 0.03333333333333334, 0.7888888888888888, 0.7222222222222221, 0.611111111111111, 0.5, 0.3222222222222223, 0.6777777777777776, 0.30000000000000004]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9174, 'compress@10': 0.8, 'time@10': 8.4385}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9174, 'compress@10': 0.8, 'time@10': 8.4385}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9451, 'compress@10': 0.5398, 'time@10': 7.8701}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9451, 'compress@10': 0.5398, 'time@10': 7.8701}:  20%|██        | 2/10 [00:11<00:48,  6.07s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9158, 'compress@10': 0.417, 'time@10': 7.2097}:  20%|██        | 2/10 [00:14<00:48,  6.07s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9158, 'compress@10': 0.417, 'time@10': 7.2097}:  30%|███       | 3/10 [00:14<00:32,  4.66s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9274, 'compress@10': 0.5119, 'time@10': 6.9948}:  30%|███       | 3/10 [00:20<00:32,  4.66s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9274, 'compress@10': 0.5119, 'time@10': 6.9948}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9345, 'compress@10': 0.555, 'time@10': 8.4131}:  40%|████      | 4/10 [00:28<00:32,  5.34s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9345, 'compress@10': 0.555, 'time@10': 8.4131}:  50%|█████     | 5/10 [00:28<00:29,  5.97s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9399, 'compress@10': 0.5658, 'time@10': 8.7552}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9399, 'compress@10': 0.5658, 'time@10': 8.7552}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.94, 'compress@10': 0.5593, 'time@10': 9.1296}:  60%|██████    | 6/10 [00:44<00:30,  7.51s/it]  {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.94, 'compress@10': 0.5593, 'time@10': 9.1296}:  70%|███████   | 7/10 [00:44<00:20,  6.93s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9246, 'ndcg@10': 0.9453, 'compress@10': 0.5321, 'time@10': 8.9356}:  70%|███████   | 7/10 [00:51<00:20,  6.93s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9246, 'ndcg@10': 0.9453, 'compress@10': 0.5321, 'time@10': 8.9356}:  80%|████████  | 8/10 [00:51<00:14,  7.15s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9465, 'compress@10': 0.5493, 'time@10': 9.5747}:  80%|████████  | 8/10 [00:59<00:14,  7.15s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9465, 'compress@10': 0.5493, 'time@10': 9.5747}:  90%|█████████ | 9/10 [00:59<00:07,  7.22s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9496, 'compress@10': 0.5259, 'time@10': 9.6414}:  90%|█████████ | 9/10 [01:09<00:07,  7.22s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9496, 'compress@10': 0.5259, 'time@10': 9.6414}: 100%|██████████| 10/10 [01:09<00:00,  8.16s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9496, 'compress@10': 0.5259, 'time@10': 9.6414}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.01262488790240771
Avg hit ratio: 0.9230969873363761
Avg ndcg: 0.9496075192834897
Avg compression ratio: 0.525941161658252
Avg train time: 9.641405630111695
Std train time: 2.9217386900028988
[0.7934782608695651, 0.27173913043478265, 0.03260869565217392, 0.7717391304347825, 0.7065217391304347, 0.6195652173913043, 0.5108695652173914, 0.3152173913043479, 0.684782608695652, 0.29347826086956524]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9233, 'compress@10': 0.8043, 'time@10': 8.4903}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9233, 'compress@10': 0.8043, 'time@10': 8.4903}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9455, 'compress@10': 0.5498, 'time@10': 7.7857}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9455, 'compress@10': 0.5498, 'time@10': 7.7857}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9161, 'compress@10': 0.4235, 'time@10': 7.1927}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9161, 'compress@10': 0.4235, 'time@10': 7.1927}:  30%|███       | 3/10 [00:14<00:32,  4.62s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9276, 'compress@10': 0.5126, 'time@10': 7.0439}:  30%|███       | 3/10 [00:21<00:32,  4.62s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9276, 'compress@10': 0.5126, 'time@10': 7.0439}:  40%|████      | 4/10 [00:21<00:32,  5.42s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0077, 'hit_ratio@10': 0.9257, 'ndcg@10': 0.9356, 'compress@10': 0.5525, 'time@10': 8.418}:  40%|████      | 4/10 [00:28<00:32,  5.42s/it] {'epoch': 45, 'num_users': 5.8, 'loss': 0.0077, 'hit_ratio@10': 0.9257, 'ndcg@10': 0.9356, 'compress@10': 0.5525, 'time@10': 8.418}:  50%|█████     | 5/10 [00:28<00:29,  5.99s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.9344, 'ndcg@10': 0.9423, 'compress@10': 0.5651, 'time@10': 8.7713}:  50%|█████     | 5/10 [00:38<00:29,  5.99s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.9344, 'ndcg@10': 0.9423, 'compress@10': 0.5651, 'time@10': 8.7713}:  60%|██████    | 6/10 [00:38<00:30,  7.55s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.938, 'ndcg@10': 0.9439, 'compress@10': 0.5602, 'time@10': 9.112}:  60%|██████    | 6/10 [00:44<00:30,  7.55s/it] {'epoch': 45, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.938, 'ndcg@10': 0.9439, 'compress@10': 0.5602, 'time@10': 9.112}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0075, 'hit_ratio@10': 0.9422, 'ndcg@10': 0.9464, 'compress@10': 0.532, 'time@10': 8.9277}:  70%|███████   | 7/10 [00:51<00:20,  6.92s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0075, 'hit_ratio@10': 0.9422, 'ndcg@10': 0.9464, 'compress@10': 0.532, 'time@10': 8.9277}:  80%|████████  | 8/10 [00:51<00:14,  7.16s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.9328, 'ndcg@10': 0.9625, 'compress@10': 0.55, 'time@10': 9.5615}:  80%|████████  | 8/10 [00:59<00:14,  7.16s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.9328, 'ndcg@10': 0.9625, 'compress@10': 0.55, 'time@10': 9.5615}:  90%|█████████ | 9/10 [00:59<00:07,  7.22s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9372, 'ndcg@10': 0.9606, 'compress@10': 0.5259, 'time@10': 9.6082}:  90%|█████████ | 9/10 [01:09<00:07,  7.22s/it] {'epoch': 45, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9372, 'ndcg@10': 0.9606, 'compress@10': 0.5259, 'time@10': 9.6082}: 100%|██████████| 10/10 [01:09<00:00,  8.10s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9372, 'ndcg@10': 0.9606, 'compress@10': 0.5259, 'time@10': 9.6082}: 100%|██████████| 10/10 [01:09<00:00,  6.94s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.011115893806376237
Avg hit ratio: 0.9372188511356592
Avg ndcg: 0.9605929947896193
Avg compression ratio: 0.5259204115734967
Avg train time: 9.608246660232544
Std train time: 2.8419711514502604
[0.7978723404255318, 0.2659574468085107, 0.03191489361702128, 0.7765957446808509, 0.6914893617021276, 0.6063829787234042, 0.5212765957446809, 0.3085106382978724, 0.6914893617021275, 0.30851063829787234]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9255, 'compress@10': 0.8085, 'time@10': 8.7234}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9255, 'compress@10': 0.8085, 'time@10': 8.7234}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9476, 'compress@10': 0.5491, 'time@10': 7.9636}:  10%|█         | 1/10 [00:11<00:39,  4.41s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9476, 'compress@10': 0.5491, 'time@10': 7.9636}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9175, 'compress@10': 0.4228, 'time@10': 7.4184}:  20%|██        | 2/10 [00:14<00:48,  6.08s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9175, 'compress@10': 0.4228, 'time@10': 7.4184}:  30%|███       | 3/10 [00:14<00:33,  4.77s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9293, 'compress@10': 0.5132, 'time@10': 7.1552}:  30%|███       | 3/10 [00:21<00:33,  4.77s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9293, 'compress@10': 0.5132, 'time@10': 7.1552}:  40%|████      | 4/10 [00:21<00:32,  5.41s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9369, 'compress@10': 0.5501, 'time@10': 8.5785}:  40%|████      | 4/10 [00:28<00:32,  5.41s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9369, 'compress@10': 0.5501, 'time@10': 8.5785}:  50%|█████     | 5/10 [00:28<00:30,  6.05s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9434, 'compress@10': 0.5609, 'time@10': 8.9097}:  50%|█████     | 5/10 [00:39<00:30,  6.05s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9434, 'compress@10': 0.5609, 'time@10': 8.9097}:  60%|██████    | 6/10 [00:39<00:30,  7.60s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9453, 'compress@10': 0.558, 'time@10': 9.229}:  60%|██████    | 6/10 [00:44<00:30,  7.60s/it]  {'epoch': 46, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9453, 'compress@10': 0.558, 'time@10': 9.229}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9482, 'compress@10': 0.5293, 'time@10': 9.0306}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9482, 'compress@10': 0.5293, 'time@10': 9.0306}:  80%|████████  | 8/10 [00:52<00:14,  7.18s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9462, 'compress@10': 0.5483, 'time@10': 9.6232}:  80%|████████  | 8/10 [00:59<00:14,  7.18s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9462, 'compress@10': 0.5483, 'time@10': 9.6232}:  90%|█████████ | 9/10 [00:59<00:07,  7.19s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9493, 'compress@10': 0.5259, 'time@10': 9.6504}:  90%|█████████ | 9/10 [01:09<00:07,  7.19s/it]     {'epoch': 46, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9493, 'compress@10': 0.5259, 'time@10': 9.6504}: 100%|██████████| 10/10 [01:09<00:00,  8.04s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9493, 'compress@10': 0.5259, 'time@10': 9.6504}: 100%|██████████| 10/10 [01:09<00:00,  6.95s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.009950729783067328
Avg hit ratio: 0.9054216161126177
Avg ndcg: 0.9492826441858903
Avg compression ratio: 0.5258916559541056
Avg train time: 9.65037453174591
Std train time: 2.818091229098464
[0.7812499999999999, 0.28125000000000006, 0.03125000000000001, 0.7812499999999999, 0.6979166666666666, 0.5937499999999999, 0.53125, 0.30208333333333337, 0.6979166666666665, 0.3020833333333333]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9255, 'compress@10': 0.7928, 'time@10': 8.4027}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9255, 'compress@10': 0.7928, 'time@10': 8.4027}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9635, 'compress@10': 0.5486, 'time@10': 7.7467}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it] {'epoch': 47, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9635, 'compress@10': 0.5486, 'time@10': 7.7467}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9281, 'compress@10': 0.4223, 'time@10': 7.1712}:  20%|██        | 2/10 [00:14<00:47,  5.94s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9281, 'compress@10': 0.4223, 'time@10': 7.1712}:  30%|███       | 3/10 [00:14<00:32,  4.62s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9371, 'compress@10': 0.514, 'time@10': 6.9554}:  30%|███       | 3/10 [00:20<00:32,  4.62s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9371, 'compress@10': 0.514, 'time@10': 6.9554}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9421, 'compress@10': 0.552, 'time@10': 8.4172}:  40%|████      | 4/10 [00:27<00:31,  5.30s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9421, 'compress@10': 0.552, 'time@10': 8.4172}:  50%|█████     | 5/10 [00:27<00:29,  5.97s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9486, 'compress@10': 0.5604, 'time@10': 8.7651}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9486, 'compress@10': 0.5604, 'time@10': 8.7651}:  60%|██████    | 6/10 [00:38<00:30,  7.53s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9496, 'compress@10': 0.5589, 'time@10': 9.1253}:  60%|██████    | 6/10 [00:44<00:30,  7.53s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9496, 'compress@10': 0.5589, 'time@10': 9.1253}:  70%|███████   | 7/10 [00:44<00:20,  6.93s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9543, 'compress@10': 0.5293, 'time@10': 8.9662}:  70%|███████   | 7/10 [00:52<00:20,  6.93s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9543, 'compress@10': 0.5293, 'time@10': 8.9662}:  80%|████████  | 8/10 [00:52<00:14,  7.24s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9655, 'compress@10': 0.549, 'time@10': 9.5608}:  80%|████████  | 8/10 [00:59<00:14,  7.24s/it] {'epoch': 47, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9655, 'compress@10': 0.549, 'time@10': 9.5608}:  90%|█████████ | 9/10 [00:59<00:07,  7.23s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9643, 'compress@10': 0.5259, 'time@10': 9.5999}:  90%|█████████ | 9/10 [01:09<00:07,  7.23s/it] {'epoch': 47, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9643, 'compress@10': 0.5259, 'time@10': 9.5999}: 100%|██████████| 10/10 [01:09<00:00,  8.08s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9643, 'compress@10': 0.5259, 'time@10': 9.5999}: 100%|██████████| 10/10 [01:09<00:00,  6.93s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.01358068239082653
Avg hit ratio: 0.8888112730506619
Avg ndcg: 0.964348811827106
Avg compression ratio: 0.5259122272897441
Avg train time: 9.59994990825653
Std train time: 2.867767065118059
[0.7653061224489794, 0.2959183673469388, 0.03061224489795919, 0.7653061224489794, 0.7040816326530612, 0.6020408163265305, 0.5204081632653061, 0.2959183673469388, 0.7040816326530611, 0.31632653061224486]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9255, 'compress@10': 0.7777, 'time@10': 8.4517}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9255, 'compress@10': 0.7777, 'time@10': 8.4517}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9367, 'compress@10': 0.5481, 'time@10': 7.779}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it] {'epoch': 48, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9367, 'compress@10': 0.5481, 'time@10': 7.779}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.9102, 'compress@10': 0.4218, 'time@10': 7.1286}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.9102, 'compress@10': 0.4218, 'time@10': 7.1286}:  30%|███       | 3/10 [00:14<00:32,  4.59s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9237, 'compress@10': 0.5098, 'time@10': 6.9807}:  30%|███       | 3/10 [00:20<00:32,  4.59s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9237, 'compress@10': 0.5098, 'time@10': 6.9807}:  40%|████      | 4/10 [00:20<00:32,  5.37s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.9325, 'compress@10': 0.5498, 'time@10': 8.3439}:  40%|████      | 4/10 [00:27<00:32,  5.37s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.9325, 'compress@10': 0.5498, 'time@10': 8.3439}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9399, 'compress@10': 0.56, 'time@10': 8.7368}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9399, 'compress@10': 0.56, 'time@10': 8.7368}:  60%|██████    | 6/10 [00:38<00:30,  7.57s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0067, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9424, 'compress@10': 0.5571, 'time@10': 9.0976}:  60%|██████    | 6/10 [00:44<00:30,  7.57s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0067, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9424, 'compress@10': 0.5571, 'time@10': 9.0976}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0071, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9449, 'compress@10': 0.5269, 'time@10': 8.8849}:  70%|███████   | 7/10 [00:51<00:20,  6.95s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0071, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9449, 'compress@10': 0.5269, 'time@10': 8.8849}:  80%|████████  | 8/10 [00:51<00:14,  7.10s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9474, 'compress@10': 0.5476, 'time@10': 9.445}:  80%|████████  | 8/10 [00:58<00:14,  7.10s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9474, 'compress@10': 0.5476, 'time@10': 9.445}:  90%|█████████ | 9/10 [00:58<00:07,  7.07s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0075, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9504, 'compress@10': 0.526, 'time@10': 9.4519}:  90%|█████████ | 9/10 [01:08<00:07,  7.07s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0075, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9504, 'compress@10': 0.526, 'time@10': 9.4519}: 100%|██████████| 10/10 [01:08<00:00,  7.84s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0075, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9504, 'compress@10': 0.526, 'time@10': 9.4519}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.007477522502451511
Avg hit ratio: 0.8975875147301293
Avg ndcg: 0.9504230555250194
Avg compression ratio: 0.5259951608190345
Avg train time: 9.45189390182495
Std train time: 2.7584267572043104
[0.7499999999999999, 0.31000000000000005, 0.030000000000000006, 0.7699999999999999, 0.71, 0.5899999999999999, 0.51, 0.31000000000000005, 0.7099999999999999, 0.30999999999999994]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9255, 'compress@10': 0.7632, 'time@10': 8.162}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9255, 'compress@10': 0.7632, 'time@10': 8.162}:  10%|█         | 1/10 [00:04<00:37,  4.12s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0298, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9849, 'compress@10': 0.5477, 'time@10': 7.4427}:  10%|█         | 1/10 [00:10<00:37,  4.12s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0298, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9849, 'compress@10': 0.5477, 'time@10': 7.4427}:  20%|██        | 2/10 [00:10<00:45,  5.67s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9423, 'compress@10': 0.4213, 'time@10': 6.8346}:  20%|██        | 2/10 [00:13<00:45,  5.67s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9423, 'compress@10': 0.4213, 'time@10': 6.8346}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9478, 'compress@10': 0.5105, 'time@10': 6.7159}:  30%|███       | 3/10 [00:20<00:30,  4.38s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9478, 'compress@10': 0.5105, 'time@10': 6.7159}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.9519, 'compress@10': 0.5516, 'time@10': 8.1209}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.9519, 'compress@10': 0.5516, 'time@10': 8.1209}:  50%|█████     | 5/10 [00:27<00:29,  5.81s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.9559, 'compress@10': 0.5595, 'time@10': 8.4706}:  50%|█████     | 5/10 [00:37<00:29,  5.81s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.9559, 'compress@10': 0.5595, 'time@10': 8.4706}:  60%|██████    | 6/10 [00:37<00:29,  7.32s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.9564, 'compress@10': 0.5552, 'time@10': 8.7992}:  60%|██████    | 6/10 [00:42<00:29,  7.32s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.9564, 'compress@10': 0.5552, 'time@10': 8.7992}:  70%|███████   | 7/10 [00:42<00:20,  6.70s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0154, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.98, 'compress@10': 0.527, 'time@10': 8.6304}:  70%|███████   | 7/10 [00:50<00:20,  6.70s/it]    {'epoch': 49, 'num_users': 6.125, 'loss': 0.0154, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.98, 'compress@10': 0.527, 'time@10': 8.6304}:  80%|████████  | 8/10 [00:50<00:13,  6.95s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9823, 'compress@10': 0.5483, 'time@10': 9.1497}:  80%|████████  | 8/10 [00:56<00:13,  6.95s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9823, 'compress@10': 0.5483, 'time@10': 9.1497}:  90%|█████████ | 9/10 [00:56<00:06,  6.87s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9771, 'compress@10': 0.526, 'time@10': 9.1464}:  90%|█████████ | 9/10 [01:06<00:06,  6.87s/it]    {'epoch': 49, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9771, 'compress@10': 0.526, 'time@10': 9.1464}: 100%|██████████| 10/10 [01:06<00:00,  7.58s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9771, 'compress@10': 0.526, 'time@10': 9.1464}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.016690053017123417
Avg hit ratio: 0.8796049238443127
Avg ndcg: 0.977142907563221
Avg compression ratio: 0.5260360299923076
Avg train time: 9.146354746818542
Std train time: 2.685576421701005
[0.7352941176470588, 0.32352941176470595, 0.02941176470588236, 0.7745098039215685, 0.696078431372549, 0.5784313725490194, 0.5, 0.32352941176470595, 0.7156862745098038, 0.32352941176470584]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
