  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2387, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.4472, 'compress@10': 0.5263, 'time@10': 9.7573}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2387, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.4472, 'compress@10': 0.5263, 'time@10': 9.7573}:  10%|█         | 1/10 [00:04<00:44,  4.92s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1727, 'hit_ratio@10': 0.5068, 'ndcg@10': 0.519, 'compress@10': 0.5212, 'time@10': 8.4339}:  10%|█         | 1/10 [00:12<00:44,  4.92s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.1727, 'hit_ratio@10': 0.5068, 'ndcg@10': 0.519, 'compress@10': 0.5212, 'time@10': 8.4339}:  20%|██        | 2/10 [00:12<00:49,  6.23s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9356, 'hit_ratio@10': 0.3855, 'ndcg@10': 0.346, 'compress@10': 0.538, 'time@10': 6.5559}:  20%|██        | 2/10 [00:13<00:49,  6.23s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.9356, 'hit_ratio@10': 0.3855, 'ndcg@10': 0.346, 'compress@10': 0.538, 'time@10': 6.5559}:  30%|███       | 3/10 [00:13<00:28,  4.04s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7381, 'hit_ratio@10': 0.4677, 'ndcg@10': 0.3969, 'compress@10': 0.5329, 'time@10': 6.4948}:  30%|███       | 3/10 [00:19<00:28,  4.04s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7381, 'hit_ratio@10': 0.4677, 'ndcg@10': 0.3969, 'compress@10': 0.5329, 'time@10': 6.4948}:  40%|████      | 4/10 [00:19<00:29,  4.95s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.6101, 'hit_ratio@10': 0.5381, 'ndcg@10': 0.4635, 'compress@10': 0.5283, 'time@10': 9.7962}:  40%|████      | 4/10 [00:31<00:29,  4.95s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.6101, 'hit_ratio@10': 0.5381, 'ndcg@10': 0.4635, 'compress@10': 0.5283, 'time@10': 9.7962}:  50%|█████     | 5/10 [00:31<00:36,  7.33s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5239, 'hit_ratio@10': 0.5781, 'ndcg@10': 0.5099, 'compress@10': 0.5255, 'time@10': 9.9098}:  50%|█████     | 5/10 [00:41<00:36,  7.33s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5239, 'hit_ratio@10': 0.5781, 'ndcg@10': 0.5099, 'compress@10': 0.5255, 'time@10': 9.9098}:  60%|██████    | 6/10 [00:41<00:33,  8.41s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4705, 'hit_ratio@10': 0.5812, 'ndcg@10': 0.5118, 'compress@10': 0.5247, 'time@10': 10.1053}:  60%|██████    | 6/10 [00:47<00:33,  8.41s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4705, 'hit_ratio@10': 0.5812, 'ndcg@10': 0.5118, 'compress@10': 0.5247, 'time@10': 10.1053}:  70%|███████   | 7/10 [00:47<00:22,  7.52s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.421, 'hit_ratio@10': 0.6228, 'ndcg@10': 0.5309, 'compress@10': 0.5234, 'time@10': 9.8495}:  70%|███████   | 7/10 [00:55<00:22,  7.52s/it]   {'epoch': 0, 'num_users': 6.125, 'loss': 0.421, 'hit_ratio@10': 0.6228, 'ndcg@10': 0.5309, 'compress@10': 0.5234, 'time@10': 9.8495}:  80%|████████  | 8/10 [00:55<00:15,  7.70s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3815, 'hit_ratio@10': 0.6425, 'ndcg@10': 0.5714, 'compress@10': 0.5224, 'time@10': 10.5292}:  80%|████████  | 8/10 [01:03<00:15,  7.70s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3815, 'hit_ratio@10': 0.6425, 'ndcg@10': 0.5714, 'compress@10': 0.5224, 'time@10': 10.5292}:  90%|█████████ | 9/10 [01:03<00:07,  7.80s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3493, 'hit_ratio@10': 0.6715, 'ndcg@10': 0.5933, 'compress@10': 0.5213, 'time@10': 10.5084}:  90%|█████████ | 9/10 [01:14<00:07,  7.80s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3493, 'hit_ratio@10': 0.6715, 'ndcg@10': 0.5933, 'compress@10': 0.5213, 'time@10': 10.5084}: 100%|██████████| 10/10 [01:14<00:00,  8.59s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3493, 'hit_ratio@10': 0.6715, 'ndcg@10': 0.5933, 'compress@10': 0.5213, 'time@10': 10.5084}: 100%|██████████| 10/10 [01:14<00:00,  7.41s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.349284082500723
Avg hit ratio: 0.671460687397869
Avg ndcg: 0.593254159671198
Avg compression ratio: 0.5212749006657823
Avg train time: 10.508415412902831
Std train time: 5.307096548579479
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0656, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.7547, 'compress@10': 0.5263, 'time@10': 9.7563}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0656, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.7547, 'compress@10': 0.5263, 'time@10': 9.7563}:  10%|█         | 1/10 [00:04<00:44,  4.92s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0601, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8054, 'compress@10': 0.5212, 'time@10': 8.4052}:  10%|█         | 1/10 [00:12<00:44,  4.92s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0601, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8054, 'compress@10': 0.5212, 'time@10': 8.4052}:  20%|██        | 2/10 [00:12<00:49,  6.20s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0559, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.7838, 'compress@10': 0.538, 'time@10': 6.6223}:  20%|██        | 2/10 [00:13<00:49,  6.20s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.0559, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.7838, 'compress@10': 0.538, 'time@10': 6.6223}:  30%|███       | 3/10 [00:13<00:28,  4.08s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0549, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.7998, 'compress@10': 0.5329, 'time@10': 6.5992}:  30%|███       | 3/10 [00:20<00:28,  4.08s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0549, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.7998, 'compress@10': 0.5329, 'time@10': 6.5992}:  40%|████      | 4/10 [00:20<00:30,  5.07s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0616, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.7946, 'compress@10': 0.5283, 'time@10': 9.4913}:  40%|████      | 4/10 [00:30<00:30,  5.07s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0616, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.7946, 'compress@10': 0.5283, 'time@10': 9.4913}:  50%|█████     | 5/10 [00:30<00:35,  7.05s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0643, 'hit_ratio@10': 0.7749, 'ndcg@10': 0.7975, 'compress@10': 0.5255, 'time@10': 9.7002}:  50%|█████     | 5/10 [00:41<00:35,  7.05s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0643, 'hit_ratio@10': 0.7749, 'ndcg@10': 0.7975, 'compress@10': 0.5255, 'time@10': 9.7002}:  60%|██████    | 6/10 [00:41<00:33,  8.32s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.062, 'hit_ratio@10': 0.8013, 'ndcg@10': 0.8057, 'compress@10': 0.5247, 'time@10': 9.9314}:  60%|██████    | 6/10 [00:47<00:33,  8.32s/it] {'epoch': 1, 'num_users': 6.2857, 'loss': 0.062, 'hit_ratio@10': 0.8013, 'ndcg@10': 0.8057, 'compress@10': 0.5247, 'time@10': 9.9314}:  70%|███████   | 7/10 [00:47<00:22,  7.46s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.059, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8139, 'compress@10': 0.5234, 'time@10': 9.6811}:  70%|███████   | 7/10 [00:55<00:22,  7.46s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.059, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8139, 'compress@10': 0.5234, 'time@10': 9.6811}:  80%|████████  | 8/10 [00:55<00:15,  7.64s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0566, 'hit_ratio@10': 0.8042, 'ndcg@10': 0.8255, 'compress@10': 0.5224, 'time@10': 10.2392}:  80%|████████  | 8/10 [01:02<00:15,  7.64s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0566, 'hit_ratio@10': 0.8042, 'ndcg@10': 0.8255, 'compress@10': 0.5224, 'time@10': 10.2392}:  90%|█████████ | 9/10 [01:02<00:07,  7.56s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0556, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8275, 'compress@10': 0.5213, 'time@10': 10.2247}:  90%|█████████ | 9/10 [01:12<00:07,  7.56s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.0556, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8275, 'compress@10': 0.5213, 'time@10': 10.2247}: 100%|██████████| 10/10 [01:12<00:00,  8.36s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0556, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8275, 'compress@10': 0.5213, 'time@10': 10.2247}: 100%|██████████| 10/10 [01:12<00:00,  7.27s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05561776065957532
Avg hit ratio: 0.8169679232293834
Avg ndcg: 0.8274752014550011
Avg compression ratio: 0.5212749006657823
Avg train time: 10.224749159812927
Std train time: 4.685316615963898
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8457, 'compress@10': 0.5263, 'time@10': 9.3412}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8457, 'compress@10': 0.5263, 'time@10': 9.3412}:  10%|█         | 1/10 [00:04<00:42,  4.71s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8509, 'compress@10': 0.5212, 'time@10': 8.2018}:  10%|█         | 1/10 [00:11<00:42,  4.71s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8509, 'compress@10': 0.5212, 'time@10': 8.2018}:  20%|██        | 2/10 [00:11<00:48,  6.11s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8417, 'compress@10': 0.538, 'time@10': 6.6075}:  20%|██        | 2/10 [00:13<00:48,  6.11s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8417, 'compress@10': 0.538, 'time@10': 6.6075}:  30%|███       | 3/10 [00:13<00:28,  4.12s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.04, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8415, 'compress@10': 0.5329, 'time@10': 6.5487}:  30%|███       | 3/10 [00:19<00:28,  4.12s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.04, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8415, 'compress@10': 0.5329, 'time@10': 6.5487}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0494, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.8313, 'compress@10': 0.5283, 'time@10': 9.043}:  40%|████      | 4/10 [00:29<00:30,  5.02s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0494, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.8313, 'compress@10': 0.5283, 'time@10': 9.043}:  50%|█████     | 5/10 [00:29<00:33,  6.65s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0537, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8281, 'compress@10': 0.5255, 'time@10': 9.3085}:  50%|█████     | 5/10 [00:40<00:33,  6.65s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0537, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8281, 'compress@10': 0.5255, 'time@10': 9.3085}:  60%|██████    | 6/10 [00:40<00:32,  8.02s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.052, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8336, 'compress@10': 0.5247, 'time@10': 9.6008}:  60%|██████    | 6/10 [00:45<00:32,  8.02s/it] {'epoch': 2, 'num_users': 6.2857, 'loss': 0.052, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8336, 'compress@10': 0.5247, 'time@10': 9.6008}:  70%|███████   | 7/10 [00:45<00:21,  7.27s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8399, 'compress@10': 0.5234, 'time@10': 9.3963}:  70%|███████   | 7/10 [00:53<00:21,  7.27s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8399, 'compress@10': 0.5234, 'time@10': 9.3963}:  80%|████████  | 8/10 [00:53<00:15,  7.50s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.848, 'compress@10': 0.5224, 'time@10': 10.0149}:  80%|████████  | 8/10 [01:01<00:15,  7.50s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.848, 'compress@10': 0.5224, 'time@10': 10.0149}:  90%|█████████ | 9/10 [01:01<00:07,  7.51s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0484, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8479, 'compress@10': 0.5213, 'time@10': 10.0276}:  90%|█████████ | 9/10 [01:11<00:07,  7.51s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 0.0484, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8479, 'compress@10': 0.5213, 'time@10': 10.0276}: 100%|██████████| 10/10 [01:11<00:00,  8.34s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0484, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8479, 'compress@10': 0.5213, 'time@10': 10.0276}: 100%|██████████| 10/10 [01:11<00:00,  7.16s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04837197604959783
Avg hit ratio: 0.8279013320201776
Avg ndcg: 0.8479481288987019
Avg compression ratio: 0.5212749006657823
Avg train time: 10.027580714225769
Std train time: 4.218190669553463
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8463, 'compress@10': 0.5263, 'time@10': 8.2909}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8463, 'compress@10': 0.5263, 'time@10': 8.2909}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.847, 'compress@10': 0.5212, 'time@10': 7.6729}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it] {'epoch': 3, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.847, 'compress@10': 0.5212, 'time@10': 7.6729}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8482, 'compress@10': 0.538, 'time@10': 6.3235}:  20%|██        | 2/10 [00:13<00:47,  5.90s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8482, 'compress@10': 0.538, 'time@10': 6.3235}:  30%|███       | 3/10 [00:13<00:28,  4.05s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8479, 'compress@10': 0.5329, 'time@10': 6.3398}:  30%|███       | 3/10 [00:19<00:28,  4.05s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8479, 'compress@10': 0.5329, 'time@10': 6.3398}:  40%|████      | 4/10 [00:19<00:29,  4.99s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8361, 'compress@10': 0.5283, 'time@10': 8.3062}:  40%|████      | 4/10 [00:27<00:29,  4.99s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8361, 'compress@10': 0.5283, 'time@10': 8.3062}:  50%|█████     | 5/10 [00:27<00:30,  6.12s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0517, 'hit_ratio@10': 0.778, 'ndcg@10': 0.8335, 'compress@10': 0.5255, 'time@10': 8.6714}:  50%|█████     | 5/10 [00:38<00:30,  6.12s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0517, 'hit_ratio@10': 0.778, 'ndcg@10': 0.8335, 'compress@10': 0.5255, 'time@10': 8.6714}:  60%|██████    | 6/10 [00:38<00:30,  7.62s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0505, 'hit_ratio@10': 0.804, 'ndcg@10': 0.8347, 'compress@10': 0.5247, 'time@10': 9.0513}:  60%|██████    | 6/10 [00:43<00:30,  7.62s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0505, 'hit_ratio@10': 0.804, 'ndcg@10': 0.8347, 'compress@10': 0.5247, 'time@10': 9.0513}:  70%|███████   | 7/10 [00:43<00:20,  6.99s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8422, 'compress@10': 0.5234, 'time@10': 8.9264}:  70%|███████   | 7/10 [00:51<00:20,  6.99s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8422, 'compress@10': 0.5234, 'time@10': 8.9264}:  80%|████████  | 8/10 [00:51<00:14,  7.34s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.819, 'ndcg@10': 0.8498, 'compress@10': 0.5224, 'time@10': 9.5499}:  80%|████████  | 8/10 [00:59<00:14,  7.34s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.819, 'ndcg@10': 0.8498, 'compress@10': 0.5224, 'time@10': 9.5499}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.05, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8504, 'compress@10': 0.5213, 'time@10': 9.6238}:  90%|█████████ | 9/10 [01:09<00:07,  7.33s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.05, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8504, 'compress@10': 0.5213, 'time@10': 9.6238}: 100%|██████████| 10/10 [01:09<00:00,  8.27s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.05, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8504, 'compress@10': 0.5213, 'time@10': 9.6238}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.050014508745245254
Avg hit ratio: 0.8302699956146476
Avg ndcg: 0.8504363303622098
Avg compression ratio: 0.5212749006657823
Avg train time: 9.623773741722108
Std train time: 3.5840316857764556
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.5263, 'time@10': 8.468}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.5263, 'time@10': 8.468}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8643, 'compress@10': 0.5212, 'time@10': 7.8392}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8643, 'compress@10': 0.5212, 'time@10': 7.8392}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0334, 'hit_ratio@10': 0.6856, 'ndcg@10': 0.8619, 'compress@10': 0.538, 'time@10': 6.5524}:  20%|██        | 2/10 [00:13<00:48,  6.02s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0334, 'hit_ratio@10': 0.6856, 'ndcg@10': 0.8619, 'compress@10': 0.538, 'time@10': 6.5524}:  30%|███       | 3/10 [00:13<00:29,  4.20s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.7374, 'ndcg@10': 0.8532, 'compress@10': 0.5329, 'time@10': 6.5101}:  30%|███       | 3/10 [00:19<00:29,  4.20s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.7374, 'ndcg@10': 0.8532, 'compress@10': 0.5329, 'time@10': 6.5101}:  40%|████      | 4/10 [00:19<00:30,  5.08s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0473, 'hit_ratio@10': 0.7579, 'ndcg@10': 0.8388, 'compress@10': 0.5283, 'time@10': 8.0092}:  40%|████      | 4/10 [00:27<00:30,  5.08s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0473, 'hit_ratio@10': 0.7579, 'ndcg@10': 0.8388, 'compress@10': 0.5283, 'time@10': 8.0092}:  50%|█████     | 5/10 [00:27<00:28,  5.78s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0508, 'hit_ratio@10': 0.7649, 'ndcg@10': 0.8362, 'compress@10': 0.5255, 'time@10': 8.4529}:  50%|█████     | 5/10 [00:37<00:28,  5.78s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0508, 'hit_ratio@10': 0.7649, 'ndcg@10': 0.8362, 'compress@10': 0.5255, 'time@10': 8.4529}:  60%|██████    | 6/10 [00:37<00:29,  7.46s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.7928, 'ndcg@10': 0.8367, 'compress@10': 0.5247, 'time@10': 8.9116}:  60%|██████    | 6/10 [00:43<00:29,  7.46s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.7928, 'ndcg@10': 0.8367, 'compress@10': 0.5247, 'time@10': 8.9116}:  70%|███████   | 7/10 [00:43<00:20,  6.94s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0508, 'hit_ratio@10': 0.808, 'ndcg@10': 0.8455, 'compress@10': 0.5234, 'time@10': 8.7914}:  70%|███████   | 7/10 [00:51<00:20,  6.94s/it]  {'epoch': 4, 'num_users': 6.125, 'loss': 0.0508, 'hit_ratio@10': 0.808, 'ndcg@10': 0.8455, 'compress@10': 0.5234, 'time@10': 8.7914}:  80%|████████  | 8/10 [00:51<00:14,  7.27s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.7976, 'ndcg@10': 0.852, 'compress@10': 0.5224, 'time@10': 9.4412}:  80%|████████  | 8/10 [00:58<00:14,  7.27s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.7976, 'ndcg@10': 0.852, 'compress@10': 0.5224, 'time@10': 9.4412}:  90%|█████████ | 9/10 [00:58<00:07,  7.30s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8521, 'compress@10': 0.5213, 'time@10': 9.535}:  90%|█████████ | 9/10 [01:09<00:07,  7.30s/it]    {'epoch': 4, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8521, 'compress@10': 0.5213, 'time@10': 9.535}: 100%|██████████| 10/10 [01:09<00:00,  8.26s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8521, 'compress@10': 0.5213, 'time@10': 9.535}: 100%|██████████| 10/10 [01:09<00:00,  6.93s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04880674890792962
Avg hit ratio: 0.8110001543448064
Avg ndcg: 0.8520732751221056
Avg compression ratio: 0.5212749006657823
Avg train time: 9.53501272201538
Std train time: 3.20065200246334
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8568, 'compress@10': 0.5263, 'time@10': 8.9376}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8568, 'compress@10': 0.5263, 'time@10': 8.9376}:  10%|█         | 1/10 [00:04<00:40,  4.52s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8706, 'compress@10': 0.5212, 'time@10': 8.0984}:  10%|█         | 1/10 [00:11<00:40,  4.52s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8706, 'compress@10': 0.5212, 'time@10': 8.0984}:  20%|██        | 2/10 [00:11<00:49,  6.15s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8661, 'compress@10': 0.538, 'time@10': 6.8087}:  20%|██        | 2/10 [00:13<00:49,  6.15s/it]  {'epoch': 5, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8661, 'compress@10': 0.538, 'time@10': 6.8087}:  30%|███       | 3/10 [00:13<00:30,  4.33s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8572, 'compress@10': 0.5329, 'time@10': 6.6934}:  30%|███       | 3/10 [00:20<00:30,  4.33s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8572, 'compress@10': 0.5329, 'time@10': 6.6934}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0462, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8434, 'compress@10': 0.5283, 'time@10': 8.1549}:  40%|████      | 4/10 [00:27<00:30,  5.14s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0462, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8434, 'compress@10': 0.5283, 'time@10': 8.1549}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0492, 'hit_ratio@10': 0.7924, 'ndcg@10': 0.8402, 'compress@10': 0.5255, 'time@10': 8.5718}:  50%|█████     | 5/10 [00:38<00:29,  5.82s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0492, 'hit_ratio@10': 0.7924, 'ndcg@10': 0.8402, 'compress@10': 0.5255, 'time@10': 8.5718}:  60%|██████    | 6/10 [00:38<00:29,  7.48s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0486, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8404, 'compress@10': 0.5247, 'time@10': 8.9923}:  60%|██████    | 6/10 [00:43<00:29,  7.48s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0486, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8404, 'compress@10': 0.5247, 'time@10': 8.9923}:  70%|███████   | 7/10 [00:43<00:20,  6.93s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0486, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8451, 'compress@10': 0.5234, 'time@10': 8.8722}:  70%|███████   | 7/10 [00:51<00:20,  6.93s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0486, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8451, 'compress@10': 0.5234, 'time@10': 8.8722}:  80%|████████  | 8/10 [00:51<00:14,  7.29s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.051, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8616, 'compress@10': 0.5224, 'time@10': 9.5341}:  80%|████████  | 8/10 [00:59<00:14,  7.29s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.051, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8616, 'compress@10': 0.5224, 'time@10': 9.5341}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8613, 'compress@10': 0.5213, 'time@10': 9.6104}:  90%|█████████ | 9/10 [01:09<00:07,  7.34s/it]  {'epoch': 5, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8613, 'compress@10': 0.5213, 'time@10': 9.6104}: 100%|██████████| 10/10 [01:09<00:00,  8.27s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8613, 'compress@10': 0.5213, 'time@10': 9.6104}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.0501389094887872
Avg hit ratio: 0.8275080908527428
Avg ndcg: 0.8612556058020724
Avg compression ratio: 0.5212749006657823
Avg train time: 9.610373973846436
Std train time: 3.1588461375843737
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 0.5263, 'time@10': 8.6683}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 0.5263, 'time@10': 8.6683}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8621, 'compress@10': 0.5212, 'time@10': 8.0636}:  10%|█         | 1/10 [00:11<00:39,  4.38s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8621, 'compress@10': 0.5212, 'time@10': 8.0636}:  20%|██        | 2/10 [00:11<00:49,  6.23s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8605, 'compress@10': 0.538, 'time@10': 6.8584}:  20%|██        | 2/10 [00:14<00:49,  6.23s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8605, 'compress@10': 0.538, 'time@10': 6.8584}:  30%|███       | 3/10 [00:14<00:30,  4.42s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8576, 'compress@10': 0.5329, 'time@10': 6.7758}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8576, 'compress@10': 0.5329, 'time@10': 6.7758}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0456, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8438, 'compress@10': 0.5283, 'time@10': 8.2285}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0456, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8438, 'compress@10': 0.5283, 'time@10': 8.2285}:  50%|█████     | 5/10 [00:27<00:29,  5.91s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0481, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8417, 'compress@10': 0.5255, 'time@10': 8.6596}:  50%|█████     | 5/10 [00:38<00:29,  5.91s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0481, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8417, 'compress@10': 0.5255, 'time@10': 8.6596}:  60%|██████    | 6/10 [00:38<00:30,  7.59s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0474, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8417, 'compress@10': 0.5247, 'time@10': 9.0714}:  60%|██████    | 6/10 [00:44<00:30,  7.59s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0474, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8417, 'compress@10': 0.5247, 'time@10': 9.0714}:  70%|███████   | 7/10 [00:44<00:21,  7.01s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0472, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.846, 'compress@10': 0.5234, 'time@10': 8.9493}:  70%|███████   | 7/10 [00:52<00:21,  7.01s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.0472, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.846, 'compress@10': 0.5234, 'time@10': 8.9493}:  80%|████████  | 8/10 [00:52<00:14,  7.37s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0476, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.8504, 'compress@10': 0.5224, 'time@10': 9.6072}:  80%|████████  | 8/10 [01:00<00:14,  7.37s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0476, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.8504, 'compress@10': 0.5224, 'time@10': 9.6072}:  90%|█████████ | 9/10 [01:00<00:07,  7.40s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0468, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8512, 'compress@10': 0.5213, 'time@10': 9.6843}:  90%|█████████ | 9/10 [01:10<00:07,  7.40s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0468, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8512, 'compress@10': 0.5213, 'time@10': 9.6843}: 100%|██████████| 10/10 [01:10<00:00,  8.33s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0468, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8512, 'compress@10': 0.5213, 'time@10': 9.6843}: 100%|██████████| 10/10 [01:10<00:00,  7.05s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04676126083592682
Avg hit ratio: 0.8440795194241714
Avg ndcg: 0.8512497698320842
Avg compression ratio: 0.5212749006657823
Avg train time: 9.684315133094788
Std train time: 3.113982450956124
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.5263, 'time@10': 8.5386}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.5263, 'time@10': 8.5386}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8625, 'compress@10': 0.5212, 'time@10': 7.8293}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8625, 'compress@10': 0.5212, 'time@10': 7.8293}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8607, 'compress@10': 0.538, 'time@10': 6.8321}:  20%|██        | 2/10 [00:13<00:47,  5.98s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8607, 'compress@10': 0.538, 'time@10': 6.8321}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0362, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8628, 'compress@10': 0.5329, 'time@10': 6.7294}:  30%|███       | 3/10 [00:20<00:30,  4.37s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0362, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8628, 'compress@10': 0.5329, 'time@10': 6.7294}:  40%|████      | 4/10 [00:20<00:31,  5.20s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0448, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8487, 'compress@10': 0.5283, 'time@10': 8.2558}:  40%|████      | 4/10 [00:27<00:31,  5.20s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0448, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8487, 'compress@10': 0.5283, 'time@10': 8.2558}:  50%|█████     | 5/10 [00:27<00:29,  5.93s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0466, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8465, 'compress@10': 0.5255, 'time@10': 8.6626}:  50%|█████     | 5/10 [00:38<00:29,  5.93s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0466, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8465, 'compress@10': 0.5255, 'time@10': 8.6626}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0459, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8477, 'compress@10': 0.5247, 'time@10': 9.1072}:  60%|██████    | 6/10 [00:44<00:30,  7.56s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0459, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8477, 'compress@10': 0.5247, 'time@10': 9.1072}:  70%|███████   | 7/10 [00:44<00:21,  7.03s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0453, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8514, 'compress@10': 0.5234, 'time@10': 9.0028}:  70%|███████   | 7/10 [00:52<00:21,  7.03s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0453, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8514, 'compress@10': 0.5234, 'time@10': 9.0028}:  80%|████████  | 8/10 [00:52<00:14,  7.44s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8571, 'compress@10': 0.5224, 'time@10': 9.637}:  80%|████████  | 8/10 [00:59<00:14,  7.44s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8571, 'compress@10': 0.5224, 'time@10': 9.637}:  90%|█████████ | 9/10 [00:59<00:07,  7.42s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8575, 'compress@10': 0.5213, 'time@10': 9.7068}:  90%|█████████ | 9/10 [01:10<00:07,  7.42s/it]  {'epoch': 7, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8575, 'compress@10': 0.5213, 'time@10': 9.7068}: 100%|██████████| 10/10 [01:10<00:00,  8.33s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8575, 'compress@10': 0.5213, 'time@10': 9.7068}: 100%|██████████| 10/10 [01:10<00:00,  7.04s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04749974624867993
Avg hit ratio: 0.8733811067257587
Avg ndcg: 0.8575113862082157
Avg compression ratio: 0.5212749006657823
Avg train time: 9.706786465644836
Std train time: 3.1139553963107884
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.862, 'compress@10': 0.5263, 'time@10': 8.494}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.862, 'compress@10': 0.5263, 'time@10': 8.494}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0436, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8681, 'compress@10': 0.5212, 'time@10': 7.8089}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0436, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8681, 'compress@10': 0.5212, 'time@10': 7.8089}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8645, 'compress@10': 0.538, 'time@10': 6.8998}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8645, 'compress@10': 0.538, 'time@10': 6.8998}:  30%|███       | 3/10 [00:14<00:30,  4.43s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8647, 'compress@10': 0.5329, 'time@10': 6.813}:  30%|███       | 3/10 [00:20<00:30,  4.43s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8647, 'compress@10': 0.5329, 'time@10': 6.813}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0426, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8504, 'compress@10': 0.5283, 'time@10': 8.2689}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0426, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8504, 'compress@10': 0.5283, 'time@10': 8.2689}:  50%|█████     | 5/10 [00:27<00:29,  5.93s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0439, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8485, 'compress@10': 0.5255, 'time@10': 8.6688}:  50%|█████     | 5/10 [00:38<00:29,  5.93s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0439, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8485, 'compress@10': 0.5255, 'time@10': 8.6688}:  60%|██████    | 6/10 [00:38<00:30,  7.55s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0431, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8501, 'compress@10': 0.5247, 'time@10': 9.0694}:  60%|██████    | 6/10 [00:44<00:30,  7.55s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0431, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8501, 'compress@10': 0.5247, 'time@10': 9.0694}:  70%|███████   | 7/10 [00:44<00:20,  6.97s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0425, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8546, 'compress@10': 0.5234, 'time@10': 8.9459}:  70%|███████   | 7/10 [00:52<00:20,  6.97s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0425, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8546, 'compress@10': 0.5234, 'time@10': 8.9459}:  80%|████████  | 8/10 [00:52<00:14,  7.34s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.042, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8623, 'compress@10': 0.5224, 'time@10': 9.5908}:  80%|████████  | 8/10 [00:59<00:14,  7.34s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.042, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8623, 'compress@10': 0.5224, 'time@10': 9.5908}:  90%|█████████ | 9/10 [00:59<00:07,  7.36s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8631, 'compress@10': 0.5213, 'time@10': 9.6382}:  90%|█████████ | 9/10 [01:09<00:07,  7.36s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8631, 'compress@10': 0.5213, 'time@10': 9.6382}: 100%|██████████| 10/10 [01:09<00:00,  8.21s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8631, 'compress@10': 0.5213, 'time@10': 9.6382}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.041119316587588314
Avg hit ratio: 0.8650319003765523
Avg ndcg: 0.8630942361465216
Avg compression ratio: 0.5212749006657823
Avg train time: 9.638155269622803
Std train time: 3.0153837641790693
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.053, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8399, 'compress@10': 0.5263, 'time@10': 8.6067}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.053, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8399, 'compress@10': 0.5263, 'time@10': 8.6067}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8486, 'compress@10': 0.5212, 'time@10': 7.9106}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8486, 'compress@10': 0.5212, 'time@10': 7.9106}:  20%|██        | 2/10 [00:11<00:48,  6.06s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8514, 'compress@10': 0.538, 'time@10': 7.0131}:  20%|██        | 2/10 [00:14<00:48,  6.06s/it]  {'epoch': 9, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8514, 'compress@10': 0.538, 'time@10': 7.0131}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0337, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8577, 'compress@10': 0.5329, 'time@10': 6.8684}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0337, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8577, 'compress@10': 0.5329, 'time@10': 6.8684}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0417, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8443, 'compress@10': 0.5283, 'time@10': 8.301}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it] {'epoch': 9, 'num_users': 5.8, 'loss': 0.0417, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8443, 'compress@10': 0.5283, 'time@10': 8.301}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0426, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.845, 'compress@10': 0.5255, 'time@10': 8.6979}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0426, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.845, 'compress@10': 0.5255, 'time@10': 8.6979}:  60%|██████    | 6/10 [00:38<00:30,  7.55s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0414, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8514, 'compress@10': 0.5247, 'time@10': 9.0838}:  60%|██████    | 6/10 [00:44<00:30,  7.55s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0414, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8514, 'compress@10': 0.5247, 'time@10': 9.0838}:  70%|███████   | 7/10 [00:44<00:20,  6.96s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8574, 'compress@10': 0.5234, 'time@10': 8.9773}:  70%|███████   | 7/10 [00:52<00:20,  6.96s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8574, 'compress@10': 0.5234, 'time@10': 8.9773}:  80%|████████  | 8/10 [00:52<00:14,  7.38s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0423, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8637, 'compress@10': 0.5224, 'time@10': 9.6456}:  80%|████████  | 8/10 [01:00<00:14,  7.38s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0423, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8637, 'compress@10': 0.5224, 'time@10': 9.6456}:  90%|█████████ | 9/10 [01:00<00:07,  7.43s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8645, 'compress@10': 0.5213, 'time@10': 9.7133}:  90%|█████████ | 9/10 [01:10<00:07,  7.43s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8645, 'compress@10': 0.5213, 'time@10': 9.7133}: 100%|██████████| 10/10 [01:10<00:00,  8.33s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8645, 'compress@10': 0.5213, 'time@10': 9.7133}: 100%|██████████| 10/10 [01:10<00:00,  7.04s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.04105355366052372
Avg hit ratio: 0.8668161483866067
Avg ndcg: 0.8645274536240753
Avg compression ratio: 0.5212749006657823
Avg train time: 9.713334035873412
Std train time: 3.0213922966046898
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8605, 'compress@10': 0.5263, 'time@10': 8.6281}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8605, 'compress@10': 0.5263, 'time@10': 8.6281}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8689, 'compress@10': 0.5212, 'time@10': 7.9127}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8689, 'compress@10': 0.5212, 'time@10': 7.9127}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.028, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.865, 'compress@10': 0.538, 'time@10': 7.1689}:  20%|██        | 2/10 [00:14<00:48,  6.05s/it]  {'epoch': 10, 'num_users': 5.0, 'loss': 0.028, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.865, 'compress@10': 0.538, 'time@10': 7.1689}:  30%|███       | 3/10 [00:14<00:32,  4.60s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8678, 'compress@10': 0.5329, 'time@10': 6.9852}:  30%|███       | 3/10 [00:20<00:32,  4.60s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8678, 'compress@10': 0.5329, 'time@10': 6.9852}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0395, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8537, 'compress@10': 0.5283, 'time@10': 8.4224}:  40%|████      | 4/10 [00:28<00:32,  5.34s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0395, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8537, 'compress@10': 0.5283, 'time@10': 8.4224}:  50%|█████     | 5/10 [00:28<00:29,  5.98s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0402, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.8545, 'compress@10': 0.5255, 'time@10': 8.8126}:  50%|█████     | 5/10 [00:38<00:29,  5.98s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0402, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.8545, 'compress@10': 0.5255, 'time@10': 8.8126}:  60%|██████    | 6/10 [00:38<00:30,  7.62s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0391, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8591, 'compress@10': 0.5247, 'time@10': 9.1825}:  60%|██████    | 6/10 [00:44<00:30,  7.62s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0391, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8591, 'compress@10': 0.5247, 'time@10': 9.1825}:  70%|███████   | 7/10 [00:44<00:21,  7.01s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0391, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.864, 'compress@10': 0.5234, 'time@10': 9.0495}:  70%|███████   | 7/10 [00:52<00:21,  7.01s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.0391, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.864, 'compress@10': 0.5234, 'time@10': 9.0495}:  80%|████████  | 8/10 [00:52<00:14,  7.37s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0378, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8705, 'compress@10': 0.5224, 'time@10': 9.7028}:  80%|████████  | 8/10 [01:00<00:14,  7.37s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0378, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8705, 'compress@10': 0.5224, 'time@10': 9.7028}:  90%|█████████ | 9/10 [01:00<00:07,  7.41s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.037, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8719, 'compress@10': 0.5213, 'time@10': 9.7659}:  90%|█████████ | 9/10 [01:10<00:07,  7.41s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.037, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8719, 'compress@10': 0.5213, 'time@10': 9.7659}: 100%|██████████| 10/10 [01:10<00:00,  8.33s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.037, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8719, 'compress@10': 0.5213, 'time@10': 9.7659}: 100%|██████████| 10/10 [01:10<00:00,  7.06s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03698673764264456
Avg hit ratio: 0.8676732912437496
Avg ndcg: 0.8719259029261259
Avg compression ratio: 0.5212748930363877
Avg train time: 9.76588740348816
Std train time: 2.974132592680284
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8453, 'compress@10': 0.5263, 'time@10': 8.8258}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8453, 'compress@10': 0.5263, 'time@10': 8.8258}:  10%|█         | 1/10 [00:04<00:40,  4.45s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8669, 'compress@10': 0.5212, 'time@10': 8.0637}:  10%|█         | 1/10 [00:11<00:40,  4.45s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8669, 'compress@10': 0.5212, 'time@10': 8.0637}:  20%|██        | 2/10 [00:11<00:49,  6.15s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8636, 'compress@10': 0.538, 'time@10': 7.2647}:  20%|██        | 2/10 [00:14<00:49,  6.15s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8636, 'compress@10': 0.538, 'time@10': 7.2647}:  30%|███       | 3/10 [00:14<00:32,  4.65s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8698, 'compress@10': 0.5329, 'time@10': 7.1037}:  30%|███       | 3/10 [00:21<00:32,  4.65s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8698, 'compress@10': 0.5329, 'time@10': 7.1037}:  40%|████      | 4/10 [00:21<00:32,  5.44s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8555, 'compress@10': 0.5283, 'time@10': 8.5531}:  40%|████      | 4/10 [00:28<00:32,  5.44s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8555, 'compress@10': 0.5283, 'time@10': 8.5531}:  50%|█████     | 5/10 [00:28<00:30,  6.08s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0381, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8573, 'compress@10': 0.5255, 'time@10': 8.9063}:  50%|█████     | 5/10 [00:39<00:30,  6.08s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0381, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8573, 'compress@10': 0.5255, 'time@10': 8.9063}:  60%|██████    | 6/10 [00:39<00:30,  7.66s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0373, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8622, 'compress@10': 0.5247, 'time@10': 9.2916}:  60%|██████    | 6/10 [00:45<00:30,  7.66s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0373, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8622, 'compress@10': 0.5247, 'time@10': 9.2916}:  70%|███████   | 7/10 [00:45<00:21,  7.06s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0371, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8672, 'compress@10': 0.5234, 'time@10': 9.1487}:  70%|███████   | 7/10 [00:53<00:21,  7.06s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0371, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8672, 'compress@10': 0.5234, 'time@10': 9.1487}:  80%|████████  | 8/10 [00:53<00:14,  7.42s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0379, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8754, 'compress@10': 0.5224, 'time@10': 9.7966}:  80%|████████  | 8/10 [01:00<00:14,  7.42s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0379, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8754, 'compress@10': 0.5224, 'time@10': 9.7966}:  90%|█████████ | 9/10 [01:00<00:07,  7.45s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8774, 'compress@10': 0.5213, 'time@10': 9.8507}:  90%|█████████ | 9/10 [01:11<00:07,  7.45s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8774, 'compress@10': 0.5213, 'time@10': 9.8507}: 100%|██████████| 10/10 [01:11<00:00,  8.36s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8774, 'compress@10': 0.5213, 'time@10': 9.8507}: 100%|██████████| 10/10 [01:11<00:00,  7.12s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.036856488837005416
Avg hit ratio: 0.8797935919956293
Avg ndcg: 0.8773534367392166
Avg compression ratio: 0.5212749006657823
Avg train time: 9.850688004493714
Std train time: 2.9822316812750493
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.849, 'compress@10': 0.5263, 'time@10': 8.7595}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.849, 'compress@10': 0.5263, 'time@10': 8.7595}:  10%|█         | 1/10 [00:04<00:39,  4.42s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8722, 'compress@10': 0.5212, 'time@10': 7.9822}:  10%|█         | 1/10 [00:11<00:39,  4.42s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8722, 'compress@10': 0.5212, 'time@10': 7.9822}:  20%|██        | 2/10 [00:11<00:48,  6.09s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8671, 'compress@10': 0.538, 'time@10': 7.1923}:  20%|██        | 2/10 [00:14<00:48,  6.09s/it]  {'epoch': 12, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8671, 'compress@10': 0.538, 'time@10': 7.1923}:  30%|███       | 3/10 [00:14<00:32,  4.61s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8734, 'compress@10': 0.5329, 'time@10': 7.005}:  30%|███       | 3/10 [00:21<00:32,  4.61s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8734, 'compress@10': 0.5329, 'time@10': 7.005}:  40%|████      | 4/10 [00:21<00:32,  5.35s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.036, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8586, 'compress@10': 0.5283, 'time@10': 8.3701}:  40%|████      | 4/10 [00:27<00:32,  5.35s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.036, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8586, 'compress@10': 0.5283, 'time@10': 8.3701}:  50%|█████     | 5/10 [00:27<00:29,  5.93s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0362, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8622, 'compress@10': 0.5255, 'time@10': 8.7583}:  50%|█████     | 5/10 [00:38<00:29,  5.93s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0362, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8622, 'compress@10': 0.5255, 'time@10': 8.7583}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0356, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8642, 'compress@10': 0.5247, 'time@10': 9.1744}:  60%|██████    | 6/10 [00:44<00:30,  7.56s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0356, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8642, 'compress@10': 0.5247, 'time@10': 9.1744}:  70%|███████   | 7/10 [00:44<00:21,  7.01s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0354, 'hit_ratio@10': 0.897, 'ndcg@10': 0.8692, 'compress@10': 0.5234, 'time@10': 9.0524}:  70%|███████   | 7/10 [00:52<00:21,  7.01s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.0354, 'hit_ratio@10': 0.897, 'ndcg@10': 0.8692, 'compress@10': 0.5234, 'time@10': 9.0524}:  80%|████████  | 8/10 [00:52<00:14,  7.40s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0351, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8758, 'compress@10': 0.5224, 'time@10': 9.6923}:  80%|████████  | 8/10 [01:00<00:14,  7.40s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0351, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8758, 'compress@10': 0.5224, 'time@10': 9.6923}:  90%|█████████ | 9/10 [01:00<00:07,  7.41s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0341, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.8787, 'compress@10': 0.5213, 'time@10': 9.7425}:  90%|█████████ | 9/10 [01:10<00:07,  7.41s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0341, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.8787, 'compress@10': 0.5213, 'time@10': 9.7425}: 100%|██████████| 10/10 [01:10<00:00,  8.28s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0341, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.8787, 'compress@10': 0.5213, 'time@10': 9.7425}: 100%|██████████| 10/10 [01:10<00:00,  7.05s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03409136203943669
Avg hit ratio: 0.8839198778961087
Avg ndcg: 0.87874436777255
Avg compression ratio: 0.5212749006657823
Avg train time: 9.74248731136322
Std train time: 2.9152295645298376
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8678, 'compress@10': 0.5263, 'time@10': 8.8047}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8678, 'compress@10': 0.5263, 'time@10': 8.8047}:  10%|█         | 1/10 [00:04<00:39,  4.44s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8842, 'compress@10': 0.5212, 'time@10': 8.0261}:  10%|█         | 1/10 [00:11<00:39,  4.44s/it] {'epoch': 13, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8842, 'compress@10': 0.5212, 'time@10': 8.0261}:  20%|██        | 2/10 [00:11<00:48,  6.11s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8752, 'compress@10': 0.538, 'time@10': 7.2481}:  20%|██        | 2/10 [00:14<00:48,  6.11s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8752, 'compress@10': 0.538, 'time@10': 7.2481}:  30%|███       | 3/10 [00:14<00:32,  4.64s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8809, 'compress@10': 0.5329, 'time@10': 7.042}:  30%|███       | 3/10 [00:21<00:32,  4.64s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8809, 'compress@10': 0.5329, 'time@10': 7.042}:  40%|████      | 4/10 [00:21<00:32,  5.36s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0347, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8657, 'compress@10': 0.5283, 'time@10': 8.4613}:  40%|████      | 4/10 [00:28<00:32,  5.36s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0347, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8657, 'compress@10': 0.5283, 'time@10': 8.4613}:  50%|█████     | 5/10 [00:28<00:29,  5.99s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0343, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8677, 'compress@10': 0.5255, 'time@10': 8.8406}:  50%|█████     | 5/10 [00:38<00:29,  5.99s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0343, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8677, 'compress@10': 0.5255, 'time@10': 8.8406}:  60%|██████    | 6/10 [00:38<00:30,  7.62s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0338, 'hit_ratio@10': 0.889, 'ndcg@10': 0.8726, 'compress@10': 0.5247, 'time@10': 9.207}:  60%|██████    | 6/10 [00:44<00:30,  7.62s/it]  {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0338, 'hit_ratio@10': 0.889, 'ndcg@10': 0.8726, 'compress@10': 0.5247, 'time@10': 9.207}:  70%|███████   | 7/10 [00:44<00:21,  7.00s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0336, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.8779, 'compress@10': 0.5234, 'time@10': 9.1057}:  70%|███████   | 7/10 [00:53<00:21,  7.00s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0336, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.8779, 'compress@10': 0.5234, 'time@10': 9.1057}:  80%|████████  | 8/10 [00:53<00:14,  7.46s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.034, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.886, 'compress@10': 0.5224, 'time@10': 9.7228}:  80%|████████  | 8/10 [01:00<00:14,  7.46s/it] {'epoch': 13, 'num_users': 6.3333, 'loss': 0.034, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.886, 'compress@10': 0.5224, 'time@10': 9.7228}:  90%|█████████ | 9/10 [01:00<00:07,  7.43s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0331, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.8882, 'compress@10': 0.5213, 'time@10': 9.7861}:  90%|█████████ | 9/10 [01:10<00:07,  7.43s/it] {'epoch': 13, 'num_users': 6.3, 'loss': 0.0331, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.8882, 'compress@10': 0.5213, 'time@10': 9.7861}: 100%|██████████| 10/10 [01:10<00:00,  8.35s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0331, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.8882, 'compress@10': 0.5213, 'time@10': 9.7861}: 100%|██████████| 10/10 [01:10<00:00,  7.09s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03313365403639758
Avg hit ratio: 0.88859322793788
Avg ndcg: 0.8882355311536259
Avg compression ratio: 0.5212749006657823
Avg train time: 9.786141729354858
Std train time: 2.8974333133551924
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.857, 'compress@10': 0.5263, 'time@10': 8.5595}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.857, 'compress@10': 0.5263, 'time@10': 8.5595}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0354, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8795, 'compress@10': 0.5212, 'time@10': 7.932}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0354, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8795, 'compress@10': 0.5212, 'time@10': 7.932}:  20%|██        | 2/10 [00:11<00:48,  6.10s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.872, 'compress@10': 0.538, 'time@10': 7.2335}:  20%|██        | 2/10 [00:14<00:48,  6.10s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.872, 'compress@10': 0.538, 'time@10': 7.2335}:  30%|███       | 3/10 [00:14<00:32,  4.66s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8809, 'compress@10': 0.5329, 'time@10': 7.0288}:  30%|███       | 3/10 [00:21<00:32,  4.66s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8809, 'compress@10': 0.5329, 'time@10': 7.0288}:  40%|████      | 4/10 [00:21<00:32,  5.37s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0328, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8666, 'compress@10': 0.5283, 'time@10': 8.48}:  40%|████      | 4/10 [00:28<00:32,  5.37s/it]  {'epoch': 14, 'num_users': 5.8, 'loss': 0.0328, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8666, 'compress@10': 0.5283, 'time@10': 8.48}:  50%|█████     | 5/10 [00:28<00:30,  6.02s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0322, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8707, 'compress@10': 0.5255, 'time@10': 8.8469}:  50%|█████     | 5/10 [00:38<00:30,  6.02s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0322, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8707, 'compress@10': 0.5255, 'time@10': 8.8469}:  60%|██████    | 6/10 [00:38<00:30,  7.62s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0327, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8693, 'compress@10': 0.5247, 'time@10': 9.2255}:  60%|██████    | 6/10 [00:44<00:30,  7.62s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0327, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8693, 'compress@10': 0.5247, 'time@10': 9.2255}:  70%|███████   | 7/10 [00:44<00:21,  7.03s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0326, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8756, 'compress@10': 0.5234, 'time@10': 9.1038}:  70%|███████   | 7/10 [00:53<00:21,  7.03s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0326, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8756, 'compress@10': 0.5234, 'time@10': 9.1038}:  80%|████████  | 8/10 [00:53<00:14,  7.43s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0319, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8804, 'compress@10': 0.5224, 'time@10': 9.7285}:  80%|████████  | 8/10 [01:00<00:14,  7.43s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0319, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8804, 'compress@10': 0.5224, 'time@10': 9.7285}:  90%|█████████ | 9/10 [01:00<00:07,  7.42s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0311, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.8845, 'compress@10': 0.5213, 'time@10': 9.7934}:  90%|█████████ | 9/10 [01:10<00:07,  7.42s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0311, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.8845, 'compress@10': 0.5213, 'time@10': 9.7934}: 100%|██████████| 10/10 [01:10<00:00,  8.35s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0311, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.8845, 'compress@10': 0.5213, 'time@10': 9.7934}: 100%|██████████| 10/10 [01:10<00:00,  7.09s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.031096776206011433
Avg hit ratio: 0.8787135286897596
Avg ndcg: 0.8844886327311791
Avg compression ratio: 0.5212749006657823
Avg train time: 9.793446683883667
Std train time: 2.9275828598498714
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8548, 'compress@10': 0.5263, 'time@10': 8.3828}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8548, 'compress@10': 0.5263, 'time@10': 8.3828}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0364, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.875, 'compress@10': 0.5212, 'time@10': 7.8552}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it] {'epoch': 15, 'num_users': 7.0, 'loss': 0.0364, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.875, 'compress@10': 0.5212, 'time@10': 7.8552}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.869, 'compress@10': 0.538, 'time@10': 7.1287}:  20%|██        | 2/10 [00:14<00:48,  6.08s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.869, 'compress@10': 0.538, 'time@10': 7.1287}:  30%|███       | 3/10 [00:14<00:32,  4.62s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8774, 'compress@10': 0.5329, 'time@10': 6.9581}:  30%|███       | 3/10 [00:20<00:32,  4.62s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8774, 'compress@10': 0.5329, 'time@10': 6.9581}:  40%|████      | 4/10 [00:20<00:32,  5.36s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0324, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8644, 'compress@10': 0.5283, 'time@10': 8.4193}:  40%|████      | 4/10 [00:28<00:32,  5.36s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0324, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8644, 'compress@10': 0.5283, 'time@10': 8.4193}:  50%|█████     | 5/10 [00:28<00:30,  6.01s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0321, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.869, 'compress@10': 0.5255, 'time@10': 8.7673}:  50%|█████     | 5/10 [00:38<00:30,  6.01s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0321, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.869, 'compress@10': 0.5255, 'time@10': 8.7673}:  60%|██████    | 6/10 [00:38<00:30,  7.55s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.032, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.8749, 'compress@10': 0.5247, 'time@10': 9.1426}:  60%|██████    | 6/10 [00:44<00:30,  7.55s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.032, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.8749, 'compress@10': 0.5247, 'time@10': 9.1426}:  70%|███████   | 7/10 [00:44<00:20,  6.96s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0318, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.8806, 'compress@10': 0.5234, 'time@10': 9.0486}:  70%|███████   | 7/10 [00:52<00:20,  6.96s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0318, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.8806, 'compress@10': 0.5234, 'time@10': 9.0486}:  80%|████████  | 8/10 [00:52<00:14,  7.43s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0309, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8861, 'compress@10': 0.5224, 'time@10': 9.6782}:  80%|████████  | 8/10 [01:00<00:14,  7.43s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0309, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8861, 'compress@10': 0.5224, 'time@10': 9.6782}:  90%|█████████ | 9/10 [01:00<00:07,  7.42s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8902, 'compress@10': 0.5213, 'time@10': 9.7456}:  90%|█████████ | 9/10 [01:10<00:07,  7.42s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8902, 'compress@10': 0.5213, 'time@10': 9.7456}: 100%|██████████| 10/10 [01:10<00:00,  8.34s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8902, 'compress@10': 0.5213, 'time@10': 9.7456}: 100%|██████████| 10/10 [01:10<00:00,  7.06s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.029743805206620122
Avg hit ratio: 0.8864278144040453
Avg ndcg: 0.8902225900042025
Avg compression ratio: 0.5212748868289898
Avg train time: 9.745575404167175
Std train time: 2.928652781006479
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0404, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8701, 'compress@10': 0.5263, 'time@10': 8.8464}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0404, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8701, 'compress@10': 0.5263, 'time@10': 8.8464}:  10%|█         | 1/10 [00:04<00:40,  4.46s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0334, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8897, 'compress@10': 0.5212, 'time@10': 8.0146}:  10%|█         | 1/10 [00:11<00:40,  4.46s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0334, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8897, 'compress@10': 0.5212, 'time@10': 8.0146}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8788, 'compress@10': 0.538, 'time@10': 7.2447}:  20%|██        | 2/10 [00:14<00:48,  6.08s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8788, 'compress@10': 0.538, 'time@10': 7.2447}:  30%|███       | 3/10 [00:14<00:32,  4.63s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8869, 'compress@10': 0.5329, 'time@10': 7.0423}:  30%|███       | 3/10 [00:21<00:32,  4.63s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8869, 'compress@10': 0.5329, 'time@10': 7.0423}:  40%|████      | 4/10 [00:21<00:32,  5.35s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0309, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8729, 'compress@10': 0.5283, 'time@10': 8.4139}:  40%|████      | 4/10 [00:28<00:32,  5.35s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0309, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8729, 'compress@10': 0.5283, 'time@10': 8.4139}:  50%|█████     | 5/10 [00:28<00:29,  5.94s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8771, 'compress@10': 0.5255, 'time@10': 8.7567}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8771, 'compress@10': 0.5255, 'time@10': 8.7567}:  60%|██████    | 6/10 [00:38<00:29,  7.50s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0324, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.8734, 'compress@10': 0.5247, 'time@10': 9.1404}:  60%|██████    | 6/10 [00:44<00:29,  7.50s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0324, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.8734, 'compress@10': 0.5247, 'time@10': 9.1404}:  70%|███████   | 7/10 [00:44<00:20,  6.93s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0323, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.8811, 'compress@10': 0.5234, 'time@10': 9.0275}:  70%|███████   | 7/10 [00:52<00:20,  6.93s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0323, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.8811, 'compress@10': 0.5234, 'time@10': 9.0275}:  80%|████████  | 8/10 [00:52<00:14,  7.36s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0313, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8884, 'compress@10': 0.5224, 'time@10': 9.6723}:  80%|████████  | 8/10 [01:00<00:14,  7.36s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0313, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8884, 'compress@10': 0.5224, 'time@10': 9.6723}:  90%|█████████ | 9/10 [01:00<00:07,  7.39s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8904, 'compress@10': 0.5213, 'time@10': 9.7297}:  90%|█████████ | 9/10 [01:10<00:07,  7.39s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8904, 'compress@10': 0.5213, 'time@10': 9.7297}: 100%|██████████| 10/10 [01:10<00:00,  8.28s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8904, 'compress@10': 0.5213, 'time@10': 9.7297}: 100%|██████████| 10/10 [01:10<00:00,  7.03s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.031162825458039813
Avg hit ratio: 0.8835706715469025
Avg ndcg: 0.8904117786792112
Avg compression ratio: 0.5212748868289898
Avg train time: 9.729682326316833
Std train time: 2.893235650097985
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8665, 'compress@10': 0.5263, 'time@10': 8.7394}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8665, 'compress@10': 0.5263, 'time@10': 8.7394}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.032, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8905, 'compress@10': 0.5212, 'time@10': 7.9167}:  10%|█         | 1/10 [00:11<00:39,  4.41s/it] {'epoch': 17, 'num_users': 7.0, 'loss': 0.032, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8905, 'compress@10': 0.5212, 'time@10': 7.9167}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8794, 'compress@10': 0.538, 'time@10': 7.1536}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8794, 'compress@10': 0.538, 'time@10': 7.1536}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8889, 'compress@10': 0.5329, 'time@10': 6.9773}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8889, 'compress@10': 0.5329, 'time@10': 6.9773}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0281, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8752, 'compress@10': 0.5283, 'time@10': 8.3723}:  40%|████      | 4/10 [00:27<00:31,  5.32s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0281, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8752, 'compress@10': 0.5283, 'time@10': 8.3723}:  50%|█████     | 5/10 [00:27<00:29,  5.93s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.881, 'compress@10': 0.5255, 'time@10': 8.7653}:  50%|█████     | 5/10 [00:38<00:29,  5.93s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.881, 'compress@10': 0.5255, 'time@10': 8.7653}:  60%|██████    | 6/10 [00:38<00:30,  7.58s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0281, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.8851, 'compress@10': 0.5247, 'time@10': 9.1275}:  60%|██████    | 6/10 [00:44<00:30,  7.58s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0281, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.8851, 'compress@10': 0.5247, 'time@10': 9.1275}:  70%|███████   | 7/10 [00:44<00:20,  6.96s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0282, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.8899, 'compress@10': 0.5234, 'time@10': 9.0384}:  70%|███████   | 7/10 [00:52<00:20,  6.96s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0282, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.8899, 'compress@10': 0.5234, 'time@10': 9.0384}:  80%|████████  | 8/10 [00:52<00:14,  7.44s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8959, 'compress@10': 0.5224, 'time@10': 9.6776}:  80%|████████  | 8/10 [01:00<00:14,  7.44s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8959, 'compress@10': 0.5224, 'time@10': 9.6776}:  90%|█████████ | 9/10 [01:00<00:07,  7.44s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9001, 'compress@10': 0.5213, 'time@10': 9.7185}:  90%|█████████ | 9/10 [01:10<00:07,  7.44s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9001, 'compress@10': 0.5213, 'time@10': 9.7185}: 100%|██████████| 10/10 [01:10<00:00,  8.27s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9001, 'compress@10': 0.5213, 'time@10': 9.7185}: 100%|██████████| 10/10 [01:10<00:00,  7.04s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02615409203673552
Avg hit ratio: 0.8864278144040453
Avg ndcg: 0.9001458373605861
Avg compression ratio: 0.5212749006657823
Avg train time: 9.718485951423645
Std train time: 2.903280320570204
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8753, 'compress@10': 0.5263, 'time@10': 8.6272}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8753, 'compress@10': 0.5263, 'time@10': 8.6272}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8973, 'compress@10': 0.5212, 'time@10': 7.8069}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it]  {'epoch': 18, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8973, 'compress@10': 0.5212, 'time@10': 7.8069}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8839, 'compress@10': 0.538, 'time@10': 7.1176}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8839, 'compress@10': 0.538, 'time@10': 7.1176}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8921, 'compress@10': 0.5329, 'time@10': 6.9634}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8921, 'compress@10': 0.5329, 'time@10': 6.9634}:  40%|████      | 4/10 [00:20<00:32,  5.33s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0272, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8789, 'compress@10': 0.5283, 'time@10': 8.3359}:  40%|████      | 4/10 [00:27<00:32,  5.33s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0272, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8789, 'compress@10': 0.5283, 'time@10': 8.3359}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0262, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8869, 'compress@10': 0.5255, 'time@10': 8.6961}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0262, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8869, 'compress@10': 0.5255, 'time@10': 8.6961}:  60%|██████    | 6/10 [00:38<00:29,  7.49s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0264, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.885, 'compress@10': 0.5247, 'time@10': 9.0858}:  60%|██████    | 6/10 [00:44<00:29,  7.49s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.0264, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.885, 'compress@10': 0.5247, 'time@10': 9.0858}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0263, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.8907, 'compress@10': 0.5234, 'time@10': 8.9617}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0263, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.8907, 'compress@10': 0.5234, 'time@10': 8.9617}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0259, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8971, 'compress@10': 0.5224, 'time@10': 9.5994}:  80%|████████  | 8/10 [00:59<00:14,  7.30s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0259, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8971, 'compress@10': 0.5224, 'time@10': 9.5994}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8994, 'compress@10': 0.5213, 'time@10': 9.6657}:  90%|█████████ | 9/10 [01:09<00:07,  7.33s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8994, 'compress@10': 0.5213, 'time@10': 9.6657}: 100%|██████████| 10/10 [01:09<00:00,  8.25s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8994, 'compress@10': 0.5213, 'time@10': 9.6657}: 100%|██████████| 10/10 [01:09<00:00,  6.99s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.02590395528039214
Avg hit ratio: 0.8835706715469025
Avg ndcg: 0.8994129991472107
Avg compression ratio: 0.5212748967914804
Avg train time: 9.66565980911255
Std train time: 2.880392607254458
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8753, 'compress@10': 0.5263, 'time@10': 8.7177}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8753, 'compress@10': 0.5263, 'time@10': 8.7177}:  10%|█         | 1/10 [00:04<00:39,  4.40s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0292, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9012, 'compress@10': 0.5212, 'time@10': 7.9267}:  10%|█         | 1/10 [00:11<00:39,  4.40s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0292, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9012, 'compress@10': 0.5212, 'time@10': 7.9267}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8865, 'compress@10': 0.538, 'time@10': 7.1315}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8865, 'compress@10': 0.538, 'time@10': 7.1315}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8905, 'compress@10': 0.5329, 'time@10': 6.9574}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8905, 'compress@10': 0.5329, 'time@10': 6.9574}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0273, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8791, 'compress@10': 0.5283, 'time@10': 8.3679}:  40%|████      | 4/10 [00:27<00:31,  5.31s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0273, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8791, 'compress@10': 0.5283, 'time@10': 8.3679}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0274, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8869, 'compress@10': 0.5255, 'time@10': 8.7398}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0274, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8869, 'compress@10': 0.5255, 'time@10': 8.7398}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0272, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8907, 'compress@10': 0.5247, 'time@10': 9.0943}:  60%|██████    | 6/10 [00:44<00:30,  7.54s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0272, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8907, 'compress@10': 0.5247, 'time@10': 9.0943}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.027, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.8965, 'compress@10': 0.5234, 'time@10': 8.978}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it]  {'epoch': 19, 'num_users': 6.125, 'loss': 0.027, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.8965, 'compress@10': 0.5234, 'time@10': 8.978}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0265, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9028, 'compress@10': 0.5224, 'time@10': 9.6075}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0265, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9028, 'compress@10': 0.5224, 'time@10': 9.6075}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0245, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9083, 'compress@10': 0.5213, 'time@10': 9.6551}:  90%|█████████ | 9/10 [01:09<00:07,  7.34s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 0.0245, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9083, 'compress@10': 0.5213, 'time@10': 9.6551}: 100%|██████████| 10/10 [01:09<00:00,  8.20s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0245, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9083, 'compress@10': 0.5213, 'time@10': 9.6551}: 100%|██████████| 10/10 [01:09<00:00,  6.99s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.02453411656079172
Avg hit ratio: 0.8915071794834104
Avg ndcg: 0.9082885947843271
Avg compression ratio: 0.5212749006657823
Avg train time: 9.655138182640076
Std train time: 2.9002539959886247
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.033, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8795, 'compress@10': 0.5263, 'time@10': 8.6709}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.033, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8795, 'compress@10': 0.5263, 'time@10': 8.6709}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9041, 'compress@10': 0.5212, 'time@10': 7.8883}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9041, 'compress@10': 0.5212, 'time@10': 7.8883}:  20%|██        | 2/10 [00:11<00:48,  6.00s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8884, 'compress@10': 0.538, 'time@10': 7.0924}:  20%|██        | 2/10 [00:14<00:48,  6.00s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8884, 'compress@10': 0.538, 'time@10': 7.0924}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8982, 'compress@10': 0.5329, 'time@10': 6.9681}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8982, 'compress@10': 0.5329, 'time@10': 6.9681}:  40%|████      | 4/10 [00:20<00:32,  5.36s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0242, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8862, 'compress@10': 0.5283, 'time@10': 8.3459}:  40%|████      | 4/10 [00:27<00:32,  5.36s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0242, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8862, 'compress@10': 0.5283, 'time@10': 8.3459}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0244, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8943, 'compress@10': 0.5255, 'time@10': 8.7374}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0244, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8943, 'compress@10': 0.5255, 'time@10': 8.7374}:  60%|██████    | 6/10 [00:38<00:30,  7.57s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0244, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8957, 'compress@10': 0.5247, 'time@10': 9.1093}:  60%|██████    | 6/10 [00:44<00:30,  7.57s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0244, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8957, 'compress@10': 0.5247, 'time@10': 9.1093}:  70%|███████   | 7/10 [00:44<00:20,  6.97s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0245, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9014, 'compress@10': 0.5234, 'time@10': 8.996}:  70%|███████   | 7/10 [00:52<00:20,  6.97s/it]  {'epoch': 20, 'num_users': 6.125, 'loss': 0.0245, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9014, 'compress@10': 0.5234, 'time@10': 8.996}:  80%|████████  | 8/10 [00:52<00:14,  7.38s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0242, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.907, 'compress@10': 0.5224, 'time@10': 9.6194}:  80%|████████  | 8/10 [00:59<00:14,  7.38s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0242, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.907, 'compress@10': 0.5224, 'time@10': 9.6194}:  90%|█████████ | 9/10 [00:59<00:07,  7.36s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9078, 'compress@10': 0.5213, 'time@10': 9.6741}:  90%|█████████ | 9/10 [01:10<00:07,  7.36s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9078, 'compress@10': 0.5213, 'time@10': 9.6741}: 100%|██████████| 10/10 [01:10<00:00,  8.24s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9078, 'compress@10': 0.5213, 'time@10': 9.6741}: 100%|██████████| 10/10 [01:10<00:00,  7.02s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.02473008610899526
Avg hit ratio: 0.8775901287921661
Avg ndcg: 0.9078261667609102
Avg compression ratio: 0.5212748907284495
Avg train time: 9.67414312362671
Std train time: 2.87323533121527
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.884, 'compress@10': 0.5263, 'time@10': 8.5568}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.884, 'compress@10': 0.5263, 'time@10': 8.5568}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0246, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9125, 'compress@10': 0.5212, 'time@10': 7.8502}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0246, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9125, 'compress@10': 0.5212, 'time@10': 7.8502}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8941, 'compress@10': 0.538, 'time@10': 7.1675}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8941, 'compress@10': 0.538, 'time@10': 7.1675}:  30%|███       | 3/10 [00:14<00:32,  4.61s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9008, 'compress@10': 0.5329, 'time@10': 6.956}:  30%|███       | 3/10 [00:20<00:32,  4.61s/it]  {'epoch': 21, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9008, 'compress@10': 0.5329, 'time@10': 6.956}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8896, 'compress@10': 0.5283, 'time@10': 8.3551}:  40%|████      | 4/10 [00:27<00:31,  5.30s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8896, 'compress@10': 0.5283, 'time@10': 8.3551}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.8989, 'compress@10': 0.5255, 'time@10': 8.7344}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.8989, 'compress@10': 0.5255, 'time@10': 8.7344}:  60%|██████    | 6/10 [00:38<00:30,  7.53s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9016, 'compress@10': 0.5247, 'time@10': 9.0976}:  60%|██████    | 6/10 [00:44<00:30,  7.53s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9016, 'compress@10': 0.5247, 'time@10': 9.0976}:  70%|███████   | 7/10 [00:44<00:20,  6.93s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.907, 'compress@10': 0.5234, 'time@10': 8.9616}:  70%|███████   | 7/10 [00:52<00:20,  6.93s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.907, 'compress@10': 0.5234, 'time@10': 8.9616}:  80%|████████  | 8/10 [00:52<00:14,  7.28s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9137, 'compress@10': 0.5224, 'time@10': 9.6165}:  80%|████████  | 8/10 [00:59<00:14,  7.28s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9137, 'compress@10': 0.5224, 'time@10': 9.6165}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9186, 'compress@10': 0.5213, 'time@10': 9.6854}:  90%|█████████ | 9/10 [01:10<00:07,  7.34s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9186, 'compress@10': 0.5213, 'time@10': 9.6854}: 100%|██████████| 10/10 [01:10<00:00,  8.27s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9186, 'compress@10': 0.5213, 'time@10': 9.6854}: 100%|██████████| 10/10 [01:10<00:00,  7.00s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.021125185094620472
Avg hit ratio: 0.8910560516638615
Avg ndcg: 0.9186372068841557
Avg compression ratio: 0.5212749006657823
Avg train time: 9.685395956039429
Std train time: 2.927166258552404
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0311, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8891, 'compress@10': 0.5263, 'time@10': 8.6336}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0311, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8891, 'compress@10': 0.5263, 'time@10': 8.6336}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.916, 'compress@10': 0.5212, 'time@10': 7.9385}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it] {'epoch': 22, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.916, 'compress@10': 0.5212, 'time@10': 7.9385}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8964, 'compress@10': 0.538, 'time@10': 7.1627}:  20%|██        | 2/10 [00:14<00:48,  6.08s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8964, 'compress@10': 0.538, 'time@10': 7.1627}:  30%|███       | 3/10 [00:14<00:32,  4.61s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9056, 'compress@10': 0.5329, 'time@10': 6.9744}:  30%|███       | 3/10 [00:20<00:32,  4.61s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9056, 'compress@10': 0.5329, 'time@10': 6.9744}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0221, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8947, 'compress@10': 0.5283, 'time@10': 8.3471}:  40%|████      | 4/10 [00:27<00:32,  5.34s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0221, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8947, 'compress@10': 0.5283, 'time@10': 8.3471}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.023, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9052, 'compress@10': 0.5255, 'time@10': 8.7229}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.023, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9052, 'compress@10': 0.5255, 'time@10': 8.7229}:  60%|██████    | 6/10 [00:38<00:30,  7.53s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0229, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9051, 'compress@10': 0.5247, 'time@10': 9.1042}:  60%|██████    | 6/10 [00:44<00:30,  7.53s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0229, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9051, 'compress@10': 0.5247, 'time@10': 9.1042}:  70%|███████   | 7/10 [00:44<00:20,  6.94s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9104, 'compress@10': 0.5234, 'time@10': 8.9734}:  70%|███████   | 7/10 [00:52<00:20,  6.94s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9104, 'compress@10': 0.5234, 'time@10': 8.9734}:  80%|████████  | 8/10 [00:52<00:14,  7.31s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0233, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9153, 'compress@10': 0.5224, 'time@10': 9.5812}:  80%|████████  | 8/10 [00:59<00:14,  7.31s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0233, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9153, 'compress@10': 0.5224, 'time@10': 9.5812}:  90%|█████████ | 9/10 [00:59<00:07,  7.29s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9183, 'compress@10': 0.5213, 'time@10': 9.6496}:  90%|█████████ | 9/10 [01:09<00:07,  7.29s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9183, 'compress@10': 0.5213, 'time@10': 9.6496}: 100%|██████████| 10/10 [01:09<00:00,  8.22s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9183, 'compress@10': 0.5213, 'time@10': 9.6496}: 100%|██████████| 10/10 [01:09<00:00,  7.00s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.02332156111630333
Avg hit ratio: 0.8904211310289408
Avg ndcg: 0.9183484111096313
Avg compression ratio: 0.5212749006657823
Avg train time: 9.649648356437684
Std train time: 2.846203210508591
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8891, 'compress@10': 0.5263, 'time@10': 8.3652}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8891, 'compress@10': 0.5263, 'time@10': 8.3652}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9195, 'compress@10': 0.5212, 'time@10': 7.9038}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it] {'epoch': 23, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9195, 'compress@10': 0.5212, 'time@10': 7.9038}:  20%|██        | 2/10 [00:11<00:49,  6.14s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8987, 'compress@10': 0.538, 'time@10': 7.1206}:  20%|██        | 2/10 [00:14<00:49,  6.14s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8987, 'compress@10': 0.538, 'time@10': 7.1206}:  30%|███       | 3/10 [00:14<00:32,  4.68s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9058, 'compress@10': 0.5329, 'time@10': 6.9425}:  30%|███       | 3/10 [00:21<00:32,  4.68s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9058, 'compress@10': 0.5329, 'time@10': 6.9425}:  40%|████      | 4/10 [00:21<00:32,  5.38s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0211, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8967, 'compress@10': 0.5283, 'time@10': 8.407}:  40%|████      | 4/10 [00:28<00:32,  5.38s/it] {'epoch': 23, 'num_users': 5.8, 'loss': 0.0211, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8967, 'compress@10': 0.5283, 'time@10': 8.407}:  50%|█████     | 5/10 [00:28<00:30,  6.03s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0214, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9037, 'compress@10': 0.5255, 'time@10': 8.7607}:  50%|█████     | 5/10 [00:38<00:30,  6.03s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0214, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9037, 'compress@10': 0.5255, 'time@10': 8.7607}:  60%|██████    | 6/10 [00:38<00:30,  7.57s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0213, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9072, 'compress@10': 0.5247, 'time@10': 9.1139}:  60%|██████    | 6/10 [00:44<00:30,  7.57s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 0.0213, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9072, 'compress@10': 0.5247, 'time@10': 9.1139}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0215, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9121, 'compress@10': 0.5234, 'time@10': 9.0004}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0215, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9121, 'compress@10': 0.5234, 'time@10': 9.0004}:  80%|████████  | 8/10 [00:52<00:14,  7.36s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.021, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9165, 'compress@10': 0.5224, 'time@10': 9.666}:  80%|████████  | 8/10 [01:00<00:14,  7.36s/it]  {'epoch': 23, 'num_users': 6.3333, 'loss': 0.021, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9165, 'compress@10': 0.5224, 'time@10': 9.666}:  90%|█████████ | 9/10 [01:00<00:07,  7.42s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9222, 'compress@10': 0.5213, 'time@10': 9.7299}:  90%|█████████ | 9/10 [01:10<00:07,  7.42s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9222, 'compress@10': 0.5213, 'time@10': 9.7299}: 100%|██████████| 10/10 [01:10<00:00,  8.32s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9222, 'compress@10': 0.5213, 'time@10': 9.7299}: 100%|██████████| 10/10 [01:10<00:00,  7.06s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.019393170477077223
Avg hit ratio: 0.8906049238443126
Avg ndcg: 0.9222208978810723
Avg compression ratio: 0.5212749006657823
Avg train time: 9.729850935935975
Std train time: 2.98923476667489
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8951, 'compress@10': 0.5263, 'time@10': 8.3592}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8951, 'compress@10': 0.5263, 'time@10': 8.3592}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9241, 'compress@10': 0.5212, 'time@10': 7.8087}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9241, 'compress@10': 0.5212, 'time@10': 7.8087}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9018, 'compress@10': 0.538, 'time@10': 7.061}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it]  {'epoch': 24, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9018, 'compress@10': 0.538, 'time@10': 7.061}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9109, 'compress@10': 0.5329, 'time@10': 6.9094}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9109, 'compress@10': 0.5329, 'time@10': 6.9094}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9023, 'compress@10': 0.5283, 'time@10': 8.3334}:  40%|████      | 4/10 [00:27<00:31,  5.32s/it]  {'epoch': 24, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9023, 'compress@10': 0.5283, 'time@10': 8.3334}:  50%|█████     | 5/10 [00:27<00:29,  5.95s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9106, 'compress@10': 0.5255, 'time@10': 8.7342}:  50%|█████     | 5/10 [00:38<00:29,  5.95s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9106, 'compress@10': 0.5255, 'time@10': 8.7342}:  60%|██████    | 6/10 [00:38<00:30,  7.59s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9108, 'compress@10': 0.5247, 'time@10': 9.1083}:  60%|██████    | 6/10 [00:44<00:30,  7.59s/it] {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9108, 'compress@10': 0.5247, 'time@10': 9.1083}:  70%|███████   | 7/10 [00:44<00:20,  6.98s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0194, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9157, 'compress@10': 0.5234, 'time@10': 8.9912}:  70%|███████   | 7/10 [00:52<00:20,  6.98s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0194, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9157, 'compress@10': 0.5234, 'time@10': 8.9912}:  80%|████████  | 8/10 [00:52<00:14,  7.37s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.92, 'compress@10': 0.5224, 'time@10': 9.5929}:  80%|████████  | 8/10 [00:59<00:14,  7.37s/it] {'epoch': 24, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.92, 'compress@10': 0.5224, 'time@10': 9.5929}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9209, 'compress@10': 0.5213, 'time@10': 9.647}:  90%|█████████ | 9/10 [01:09<00:07,  7.33s/it]  {'epoch': 24, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9209, 'compress@10': 0.5213, 'time@10': 9.647}: 100%|██████████| 10/10 [01:09<00:00,  8.21s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9209, 'compress@10': 0.5213, 'time@10': 9.647}: 100%|██████████| 10/10 [01:09<00:00,  7.00s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.019854043731727715
Avg hit ratio: 0.8934620667014554
Avg ndcg: 0.9209452727155865
Avg compression ratio: 0.5212749006657823
Avg train time: 9.647013950347901
Std train time: 2.8738072948314746
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8974, 'compress@10': 0.5263, 'time@10': 8.925}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8974, 'compress@10': 0.5263, 'time@10': 8.925}:  10%|█         | 1/10 [00:04<00:40,  4.50s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9248, 'compress@10': 0.5212, 'time@10': 8.0452}:  10%|█         | 1/10 [00:11<00:40,  4.50s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9248, 'compress@10': 0.5212, 'time@10': 8.0452}:  20%|██        | 2/10 [00:11<00:48,  6.09s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9022, 'compress@10': 0.538, 'time@10': 7.2694}:  20%|██        | 2/10 [00:14<00:48,  6.09s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9022, 'compress@10': 0.538, 'time@10': 7.2694}:  30%|███       | 3/10 [00:14<00:32,  4.63s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9143, 'compress@10': 0.5329, 'time@10': 7.1006}:  30%|███       | 3/10 [00:21<00:32,  4.63s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9143, 'compress@10': 0.5329, 'time@10': 7.1006}:  40%|████      | 4/10 [00:21<00:32,  5.42s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9064, 'compress@10': 0.5283, 'time@10': 8.4536}:  40%|████      | 4/10 [00:28<00:32,  5.42s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9064, 'compress@10': 0.5283, 'time@10': 8.4536}:  50%|█████     | 5/10 [00:28<00:29,  5.98s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0182, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9142, 'compress@10': 0.5255, 'time@10': 8.8119}:  50%|█████     | 5/10 [00:38<00:29,  5.98s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0182, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9142, 'compress@10': 0.5255, 'time@10': 8.8119}:  60%|██████    | 6/10 [00:38<00:30,  7.57s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0184, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9177, 'compress@10': 0.5247, 'time@10': 9.1994}:  60%|██████    | 6/10 [00:44<00:30,  7.57s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0184, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9177, 'compress@10': 0.5247, 'time@10': 9.1994}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0186, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9207, 'compress@10': 0.5234, 'time@10': 9.0675}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0186, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9207, 'compress@10': 0.5234, 'time@10': 9.0675}:  80%|████████  | 8/10 [00:52<00:14,  7.37s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9247, 'compress@10': 0.5224, 'time@10': 9.6764}:  80%|████████  | 8/10 [01:00<00:14,  7.37s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9247, 'compress@10': 0.5224, 'time@10': 9.6764}:  90%|█████████ | 9/10 [01:00<00:07,  7.35s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.929, 'compress@10': 0.5213, 'time@10': 9.7485}:  90%|█████████ | 9/10 [01:10<00:07,  7.35s/it]    {'epoch': 25, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.929, 'compress@10': 0.5213, 'time@10': 9.7485}: 100%|██████████| 10/10 [01:10<00:00,  8.31s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.929, 'compress@10': 0.5213, 'time@10': 9.7485}: 100%|██████████| 10/10 [01:10<00:00,  7.06s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.018476533922273934
Avg hit ratio: 0.8985414317808205
Avg ndcg: 0.9290095280408991
Avg compression ratio: 0.5212749006657823
Avg train time: 9.74851634502411
Std train time: 2.8356232561593253
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9012, 'compress@10': 0.5263, 'time@10': 8.8863}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9012, 'compress@10': 0.5263, 'time@10': 8.8863}:  10%|█         | 1/10 [00:04<00:40,  4.48s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9289, 'compress@10': 0.5212, 'time@10': 7.9929}:  10%|█         | 1/10 [00:11<00:40,  4.48s/it] {'epoch': 26, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9289, 'compress@10': 0.5212, 'time@10': 7.9929}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.905, 'compress@10': 0.538, 'time@10': 7.1586}:  20%|██        | 2/10 [00:14<00:48,  6.04s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.905, 'compress@10': 0.538, 'time@10': 7.1586}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9183, 'compress@10': 0.5329, 'time@10': 6.9705}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9183, 'compress@10': 0.5329, 'time@10': 6.9705}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9113, 'compress@10': 0.5283, 'time@10': 8.4245}:  40%|████      | 4/10 [00:28<00:31,  5.30s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9113, 'compress@10': 0.5283, 'time@10': 8.4245}:  50%|█████     | 5/10 [00:28<00:29,  5.97s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0189, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.9191, 'compress@10': 0.5255, 'time@10': 8.766}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0189, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.9191, 'compress@10': 0.5255, 'time@10': 8.766}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.9236, 'ndcg@10': 0.9187, 'compress@10': 0.5247, 'time@10': 9.1208}:  60%|██████    | 6/10 [00:44<00:30,  7.51s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.9236, 'ndcg@10': 0.9187, 'compress@10': 0.5247, 'time@10': 9.1208}:  70%|███████   | 7/10 [00:44<00:20,  6.91s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.021, 'hit_ratio@10': 0.9296, 'ndcg@10': 0.9149, 'compress@10': 0.5234, 'time@10': 9.0073}:  70%|███████   | 7/10 [00:52<00:20,  6.91s/it]  {'epoch': 26, 'num_users': 6.125, 'loss': 0.021, 'hit_ratio@10': 0.9296, 'ndcg@10': 0.9149, 'compress@10': 0.5234, 'time@10': 9.0073}:  80%|████████  | 8/10 [00:52<00:14,  7.34s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9212, 'compress@10': 0.5224, 'time@10': 9.5992}:  80%|████████  | 8/10 [00:59<00:14,  7.34s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9212, 'compress@10': 0.5224, 'time@10': 9.5992}:  90%|█████████ | 9/10 [00:59<00:07,  7.30s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.9157, 'ndcg@10': 0.9303, 'compress@10': 0.5213, 'time@10': 9.6667}:  90%|█████████ | 9/10 [01:09<00:07,  7.30s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.9157, 'ndcg@10': 0.9303, 'compress@10': 0.5213, 'time@10': 9.6667}: 100%|██████████| 10/10 [01:09<00:00,  8.23s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.9157, 'ndcg@10': 0.9303, 'compress@10': 0.5213, 'time@10': 9.6667}: 100%|██████████| 10/10 [01:09<00:00,  6.99s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.02223103786756101
Avg hit ratio: 0.9156842889236778
Avg ndcg: 0.9302871503736443
Avg compression ratio: 0.5212749006657823
Avg train time: 9.666662764549255
Std train time: 2.8917139785885384
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9012, 'compress@10': 0.5263, 'time@10': 8.7417}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9012, 'compress@10': 0.5263, 'time@10': 8.7417}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9283, 'compress@10': 0.5212, 'time@10': 8.0038}:  10%|█         | 1/10 [00:11<00:39,  4.41s/it] {'epoch': 27, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9283, 'compress@10': 0.5212, 'time@10': 8.0038}:  20%|██        | 2/10 [00:11<00:49,  6.13s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9046, 'compress@10': 0.538, 'time@10': 7.2037}:  20%|██        | 2/10 [00:14<00:49,  6.13s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9046, 'compress@10': 0.538, 'time@10': 7.2037}:  30%|███       | 3/10 [00:14<00:32,  4.63s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.918, 'compress@10': 0.5329, 'time@10': 7.0028}:  30%|███       | 3/10 [00:21<00:32,  4.63s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.918, 'compress@10': 0.5329, 'time@10': 7.0028}:  40%|████      | 4/10 [00:21<00:32,  5.34s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9126, 'compress@10': 0.5283, 'time@10': 8.4314}:  40%|████      | 4/10 [00:28<00:32,  5.34s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9126, 'compress@10': 0.5283, 'time@10': 8.4314}:  50%|█████     | 5/10 [00:28<00:29,  5.98s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0154, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9212, 'compress@10': 0.5255, 'time@10': 8.7658}:  50%|█████     | 5/10 [00:38<00:29,  5.98s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0154, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9212, 'compress@10': 0.5255, 'time@10': 8.7658}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9242, 'compress@10': 0.5247, 'time@10': 9.1225}:  60%|██████    | 6/10 [00:44<00:30,  7.51s/it] {'epoch': 27, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9242, 'compress@10': 0.5247, 'time@10': 9.1225}:  70%|███████   | 7/10 [00:44<00:20,  6.91s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0154, 'hit_ratio@10': 0.909, 'ndcg@10': 0.9283, 'compress@10': 0.5234, 'time@10': 9.0008}:  70%|███████   | 7/10 [00:52<00:20,  6.91s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0154, 'hit_ratio@10': 0.909, 'ndcg@10': 0.9283, 'compress@10': 0.5234, 'time@10': 9.0008}:  80%|████████  | 8/10 [00:52<00:14,  7.31s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9345, 'compress@10': 0.5224, 'time@10': 9.6161}:  80%|████████  | 8/10 [00:59<00:14,  7.31s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9345, 'compress@10': 0.5224, 'time@10': 9.6161}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9386, 'compress@10': 0.5213, 'time@10': 9.6934}:  90%|█████████ | 9/10 [01:10<00:07,  7.31s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9386, 'compress@10': 0.5213, 'time@10': 9.6934}: 100%|██████████| 10/10 [01:10<00:00,  8.27s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9386, 'compress@10': 0.5213, 'time@10': 9.6934}: 100%|██████████| 10/10 [01:10<00:00,  7.02s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.016356897003645208
Avg hit ratio: 0.8991763524157411
Avg ndcg: 0.9385794839203617
Avg compression ratio: 0.5212749006657823
Avg train time: 9.69339861869812
Std train time: 2.8905961321328815
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9028, 'compress@10': 0.5263, 'time@10': 8.7641}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9028, 'compress@10': 0.5263, 'time@10': 8.7641}:  10%|█         | 1/10 [00:04<00:39,  4.42s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.893, 'ndcg@10': 0.931, 'compress@10': 0.5212, 'time@10': 8.0915}:  10%|█         | 1/10 [00:11<00:39,  4.42s/it]  {'epoch': 28, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.893, 'ndcg@10': 0.931, 'compress@10': 0.5212, 'time@10': 8.0915}:  20%|██        | 2/10 [00:11<00:49,  6.21s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9064, 'compress@10': 0.538, 'time@10': 7.2861}:  20%|██        | 2/10 [00:14<00:49,  6.21s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9064, 'compress@10': 0.538, 'time@10': 7.2861}:  30%|███       | 3/10 [00:14<00:32,  4.68s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9194, 'compress@10': 0.5329, 'time@10': 7.0679}:  30%|███       | 3/10 [00:21<00:32,  4.68s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9194, 'compress@10': 0.5329, 'time@10': 7.0679}:  40%|████      | 4/10 [00:21<00:32,  5.38s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9153, 'compress@10': 0.5283, 'time@10': 8.4621}:  40%|████      | 4/10 [00:28<00:32,  5.38s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9153, 'compress@10': 0.5283, 'time@10': 8.4621}:  50%|█████     | 5/10 [00:28<00:29,  5.99s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0149, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9235, 'compress@10': 0.5255, 'time@10': 8.8028}:  50%|█████     | 5/10 [00:38<00:29,  5.99s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0149, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9235, 'compress@10': 0.5255, 'time@10': 8.8028}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9237, 'compress@10': 0.5247, 'time@10': 9.1975}:  60%|██████    | 6/10 [00:44<00:30,  7.54s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9237, 'compress@10': 0.5247, 'time@10': 9.1975}:  70%|███████   | 7/10 [00:44<00:20,  6.98s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9336, 'compress@10': 0.5234, 'time@10': 9.0516}:  70%|███████   | 7/10 [00:52<00:20,  6.98s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9336, 'compress@10': 0.5234, 'time@10': 9.0516}:  80%|████████  | 8/10 [00:52<00:14,  7.32s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9362, 'compress@10': 0.5224, 'time@10': 9.6393}:  80%|████████  | 8/10 [00:59<00:14,  7.32s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9362, 'compress@10': 0.5224, 'time@10': 9.6393}:  90%|█████████ | 9/10 [00:59<00:07,  7.29s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9386, 'compress@10': 0.5213, 'time@10': 9.6928}:  90%|█████████ | 9/10 [01:10<00:07,  7.29s/it]  {'epoch': 28, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9386, 'compress@10': 0.5213, 'time@10': 9.6928}: 100%|██████████| 10/10 [01:10<00:00,  8.19s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9386, 'compress@10': 0.5213, 'time@10': 9.6928}: 100%|██████████| 10/10 [01:10<00:00,  7.01s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01933270341652946
Avg hit ratio: 0.8985414317808205
Avg ndcg: 0.9386244239772292
Avg compression ratio: 0.5212749006657823
Avg train time: 9.692761731147765
Std train time: 2.838720491956037
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9046, 'compress@10': 0.5263, 'time@10': 8.945}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9046, 'compress@10': 0.5263, 'time@10': 8.945}:  10%|█         | 1/10 [00:04<00:40,  4.52s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9333, 'compress@10': 0.5212, 'time@10': 8.0494}:  10%|█         | 1/10 [00:11<00:40,  4.52s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9333, 'compress@10': 0.5212, 'time@10': 8.0494}:  20%|██        | 2/10 [00:11<00:48,  6.09s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9079, 'compress@10': 0.538, 'time@10': 7.2104}:  20%|██        | 2/10 [00:14<00:48,  6.09s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9079, 'compress@10': 0.538, 'time@10': 7.2104}:  30%|███       | 3/10 [00:14<00:32,  4.59s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9211, 'compress@10': 0.5329, 'time@10': 7.059}:  30%|███       | 3/10 [00:21<00:32,  4.59s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9211, 'compress@10': 0.5329, 'time@10': 7.059}:  40%|████      | 4/10 [00:21<00:32,  5.40s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9172, 'compress@10': 0.5283, 'time@10': 8.4891}:  40%|████      | 4/10 [00:28<00:32,  5.40s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9172, 'compress@10': 0.5283, 'time@10': 8.4891}:  50%|█████     | 5/10 [00:28<00:30,  6.03s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0172, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9269, 'compress@10': 0.5255, 'time@10': 8.847}:  50%|█████     | 5/10 [00:38<00:30,  6.03s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0172, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9269, 'compress@10': 0.5255, 'time@10': 8.847}:  60%|██████    | 6/10 [00:38<00:30,  7.61s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.017, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9293, 'compress@10': 0.5247, 'time@10': 9.2034}:  60%|██████    | 6/10 [00:44<00:30,  7.61s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.017, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9293, 'compress@10': 0.5247, 'time@10': 9.2034}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9382, 'compress@10': 0.5234, 'time@10': 9.0676}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9382, 'compress@10': 0.5234, 'time@10': 9.0676}:  80%|████████  | 8/10 [00:52<00:14,  7.36s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9375, 'compress@10': 0.5224, 'time@10': 9.6787}:  80%|████████  | 8/10 [01:00<00:14,  7.36s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9375, 'compress@10': 0.5224, 'time@10': 9.6787}:  90%|█████████ | 9/10 [01:00<00:07,  7.35s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9412, 'compress@10': 0.5213, 'time@10': 9.7159}:  90%|█████████ | 9/10 [01:10<00:07,  7.35s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9412, 'compress@10': 0.5213, 'time@10': 9.7159}: 100%|██████████| 10/10 [01:10<00:00,  8.19s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9412, 'compress@10': 0.5213, 'time@10': 9.7159}: 100%|██████████| 10/10 [01:10<00:00,  7.03s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.01797884169106394
Avg hit ratio: 0.8956049238443127
Avg ndcg: 0.9412032886763301
Avg compression ratio: 0.5212749006657823
Avg train time: 9.715897822380066
Std train time: 2.9023303059680625
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9093, 'compress@10': 0.5263, 'time@10': 8.7919}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9093, 'compress@10': 0.5263, 'time@10': 8.7919}:  10%|█         | 1/10 [00:04<00:39,  4.43s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9341, 'compress@10': 0.5212, 'time@10': 8.1019}:  10%|█         | 1/10 [00:11<00:39,  4.43s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9341, 'compress@10': 0.5212, 'time@10': 8.1019}:  20%|██        | 2/10 [00:11<00:49,  6.21s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9085, 'compress@10': 0.538, 'time@10': 7.2448}:  20%|██        | 2/10 [00:14<00:49,  6.21s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9085, 'compress@10': 0.538, 'time@10': 7.2448}:  30%|███       | 3/10 [00:14<00:32,  4.65s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9215, 'compress@10': 0.5329, 'time@10': 6.9967}:  30%|███       | 3/10 [00:20<00:32,  4.65s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9215, 'compress@10': 0.5329, 'time@10': 6.9967}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9172, 'compress@10': 0.5283, 'time@10': 8.4509}:  40%|████      | 4/10 [00:28<00:31,  5.30s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9172, 'compress@10': 0.5283, 'time@10': 8.4509}:  50%|█████     | 5/10 [00:28<00:29,  5.98s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9256, 'compress@10': 0.5255, 'time@10': 8.8107}:  50%|█████     | 5/10 [00:38<00:29,  5.98s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9256, 'compress@10': 0.5255, 'time@10': 8.8107}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.926, 'compress@10': 0.5247, 'time@10': 9.1877}:  60%|██████    | 6/10 [00:44<00:30,  7.56s/it] {'epoch': 30, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.926, 'compress@10': 0.5247, 'time@10': 9.1877}:  70%|███████   | 7/10 [00:44<00:20,  6.98s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9349, 'compress@10': 0.5234, 'time@10': 9.0528}:  70%|███████   | 7/10 [00:52<00:20,  6.98s/it]  {'epoch': 30, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9349, 'compress@10': 0.5234, 'time@10': 9.0528}:  80%|████████  | 8/10 [00:52<00:14,  7.35s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9474, 'compress@10': 0.5224, 'time@10': 9.6993}:  80%|████████  | 8/10 [01:00<00:14,  7.35s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9474, 'compress@10': 0.5224, 'time@10': 9.6993}:  90%|█████████ | 9/10 [01:00<00:07,  7.39s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9501, 'compress@10': 0.5213, 'time@10': 9.7491}:  90%|█████████ | 9/10 [01:10<00:07,  7.39s/it]    {'epoch': 30, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9501, 'compress@10': 0.5213, 'time@10': 9.7491}: 100%|██████████| 10/10 [01:10<00:00,  8.27s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9501, 'compress@10': 0.5213, 'time@10': 9.7491}: 100%|██████████| 10/10 [01:10<00:00,  7.04s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.016300036268995143
Avg hit ratio: 0.884033495272884
Avg ndcg: 0.950071043809514
Avg compression ratio: 0.5212749006657823
Avg train time: 9.749091529846192
Std train time: 2.9929106431488814
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9093, 'compress@10': 0.5263, 'time@10': 8.5523}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9093, 'compress@10': 0.5263, 'time@10': 8.5523}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9342, 'compress@10': 0.5212, 'time@10': 7.8859}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it] {'epoch': 31, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9342, 'compress@10': 0.5212, 'time@10': 7.8859}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9085, 'compress@10': 0.538, 'time@10': 7.1533}:  20%|██        | 2/10 [00:14<00:48,  6.05s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9085, 'compress@10': 0.538, 'time@10': 7.1533}:  30%|███       | 3/10 [00:14<00:32,  4.60s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9214, 'compress@10': 0.5329, 'time@10': 6.9626}:  30%|███       | 3/10 [00:20<00:32,  4.60s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9214, 'compress@10': 0.5329, 'time@10': 6.9626}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9175, 'compress@10': 0.5283, 'time@10': 8.3332}:  40%|████      | 4/10 [00:27<00:31,  5.32s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9175, 'compress@10': 0.5283, 'time@10': 8.3332}:  50%|█████     | 5/10 [00:27<00:29,  5.91s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9256, 'compress@10': 0.5255, 'time@10': 8.748}:  50%|█████     | 5/10 [00:38<00:29,  5.91s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9256, 'compress@10': 0.5255, 'time@10': 8.748}:  60%|██████    | 6/10 [00:38<00:30,  7.59s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9285, 'compress@10': 0.5247, 'time@10': 9.1155}:  60%|██████    | 6/10 [00:44<00:30,  7.59s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9285, 'compress@10': 0.5247, 'time@10': 9.1155}:  70%|███████   | 7/10 [00:44<00:20,  6.97s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.936, 'compress@10': 0.5234, 'time@10': 8.9809}:  70%|███████   | 7/10 [00:52<00:20,  6.97s/it]   {'epoch': 31, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.936, 'compress@10': 0.5234, 'time@10': 8.9809}:  80%|████████  | 8/10 [00:52<00:14,  7.32s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.936, 'compress@10': 0.5224, 'time@10': 9.5864}:  80%|████████  | 8/10 [00:59<00:14,  7.32s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.936, 'compress@10': 0.5224, 'time@10': 9.5864}:  90%|█████████ | 9/10 [00:59<00:07,  7.30s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9372, 'compress@10': 0.5213, 'time@10': 9.6552}:  90%|█████████ | 9/10 [01:10<00:07,  7.30s/it]  {'epoch': 31, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9372, 'compress@10': 0.5213, 'time@10': 9.6552}: 100%|██████████| 10/10 [01:10<00:00,  8.23s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9372, 'compress@10': 0.5213, 'time@10': 9.6552}: 100%|██████████| 10/10 [01:10<00:00,  7.00s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.01718955754552239
Avg hit ratio: 0.8983192095585982
Avg ndcg: 0.9372414768927421
Avg compression ratio: 0.5212749006657823
Avg train time: 9.65515069961548
Std train time: 2.8424136034707583
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9103, 'compress@10': 0.5263, 'time@10': 8.8367}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9103, 'compress@10': 0.5263, 'time@10': 8.8367}:  10%|█         | 1/10 [00:04<00:40,  4.46s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9366, 'compress@10': 0.5212, 'time@10': 7.9546}:  10%|█         | 1/10 [00:11<00:40,  4.46s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9366, 'compress@10': 0.5212, 'time@10': 7.9546}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9101, 'compress@10': 0.538, 'time@10': 7.1833}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9101, 'compress@10': 0.538, 'time@10': 7.1833}:  30%|███       | 3/10 [00:14<00:32,  4.57s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9228, 'compress@10': 0.5329, 'time@10': 7.0208}:  30%|███       | 3/10 [00:20<00:32,  4.57s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9228, 'compress@10': 0.5329, 'time@10': 7.0208}:  40%|████      | 4/10 [00:20<00:32,  5.36s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9201, 'compress@10': 0.5283, 'time@10': 8.4571}:  40%|████      | 4/10 [00:28<00:32,  5.36s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9201, 'compress@10': 0.5283, 'time@10': 8.4571}:  50%|█████     | 5/10 [00:28<00:30,  6.00s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9288, 'compress@10': 0.5255, 'time@10': 8.7975}:  50%|█████     | 5/10 [00:38<00:30,  6.00s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9288, 'compress@10': 0.5255, 'time@10': 8.7975}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9291, 'compress@10': 0.5247, 'time@10': 9.1649}:  60%|██████    | 6/10 [00:44<00:30,  7.54s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9291, 'compress@10': 0.5247, 'time@10': 9.1649}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9155, 'ndcg@10': 0.9382, 'compress@10': 0.5234, 'time@10': 9.0229}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9155, 'ndcg@10': 0.9382, 'compress@10': 0.5234, 'time@10': 9.0229}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9389, 'compress@10': 0.5224, 'time@10': 9.6505}:  80%|████████  | 8/10 [00:59<00:14,  7.30s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9389, 'compress@10': 0.5224, 'time@10': 9.6505}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9421, 'compress@10': 0.5213, 'time@10': 9.7074}:  90%|█████████ | 9/10 [01:10<00:07,  7.33s/it]    {'epoch': 32, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9421, 'compress@10': 0.5213, 'time@10': 9.7074}: 100%|██████████| 10/10 [01:10<00:00,  8.23s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9421, 'compress@10': 0.5213, 'time@10': 9.7074}: 100%|██████████| 10/10 [01:10<00:00,  7.01s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.014036706329593421
Avg hit ratio: 0.9015450160102111
Avg ndcg: 0.94214648515671
Avg compression ratio: 0.5212749006657823
Avg train time: 9.707426595687867
Std train time: 2.9263345619519123
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.5263, 'time@10': 8.7894}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.5263, 'time@10': 8.7894}:  10%|█         | 1/10 [00:04<00:39,  4.43s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9405, 'compress@10': 0.5212, 'time@10': 7.9499}:  10%|█         | 1/10 [00:11<00:39,  4.43s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9405, 'compress@10': 0.5212, 'time@10': 7.9499}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9127, 'compress@10': 0.538, 'time@10': 7.133}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9127, 'compress@10': 0.538, 'time@10': 7.133}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9245, 'compress@10': 0.5329, 'time@10': 6.9306}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9245, 'compress@10': 0.5329, 'time@10': 6.9306}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9225, 'compress@10': 0.5283, 'time@10': 8.3516}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9225, 'compress@10': 0.5283, 'time@10': 8.3516}:  50%|█████     | 5/10 [00:27<00:29,  5.91s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9304, 'compress@10': 0.5255, 'time@10': 8.7123}:  50%|█████     | 5/10 [00:38<00:29,  5.91s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9304, 'compress@10': 0.5255, 'time@10': 8.7123}:  60%|██████    | 6/10 [00:38<00:29,  7.49s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0124, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9334, 'compress@10': 0.5247, 'time@10': 9.0827}:  60%|██████    | 6/10 [00:44<00:29,  7.49s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0124, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9334, 'compress@10': 0.5247, 'time@10': 9.0827}:  70%|███████   | 7/10 [00:44<00:20,  6.90s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.9361, 'compress@10': 0.5234, 'time@10': 8.9565}:  70%|███████   | 7/10 [00:52<00:20,  6.90s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.9361, 'compress@10': 0.5234, 'time@10': 8.9565}:  80%|████████  | 8/10 [00:52<00:14,  7.28s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9391, 'compress@10': 0.5224, 'time@10': 9.5773}:  80%|████████  | 8/10 [00:59<00:14,  7.28s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9391, 'compress@10': 0.5224, 'time@10': 9.5773}:  90%|█████████ | 9/10 [00:59<00:07,  7.29s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9429, 'compress@10': 0.5213, 'time@10': 9.6514}:  90%|█████████ | 9/10 [01:09<00:07,  7.29s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9429, 'compress@10': 0.5213, 'time@10': 9.6514}: 100%|██████████| 10/10 [01:09<00:00,  8.24s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9429, 'compress@10': 0.5213, 'time@10': 9.6514}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.013348280278840257
Avg hit ratio: 0.9026842889236777
Avg ndcg: 0.9429370707959487
Avg compression ratio: 0.5212749006657823
Avg train time: 9.651402449607849
Std train time: 2.917080645559349
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.5263, 'time@10': 8.6488}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.5263, 'time@10': 8.6488}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9434, 'compress@10': 0.5212, 'time@10': 7.9673}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9434, 'compress@10': 0.5212, 'time@10': 7.9673}:  20%|██        | 2/10 [00:11<00:48,  6.10s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9147, 'compress@10': 0.538, 'time@10': 7.1937}:  20%|██        | 2/10 [00:14<00:48,  6.10s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9147, 'compress@10': 0.538, 'time@10': 7.1937}:  30%|███       | 3/10 [00:14<00:32,  4.62s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9266, 'compress@10': 0.5329, 'time@10': 7.0448}:  30%|███       | 3/10 [00:21<00:32,  4.62s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9266, 'compress@10': 0.5329, 'time@10': 7.0448}:  40%|████      | 4/10 [00:21<00:32,  5.42s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9245, 'compress@10': 0.5283, 'time@10': 8.482}:  40%|████      | 4/10 [00:28<00:32,  5.42s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9245, 'compress@10': 0.5283, 'time@10': 8.482}:  50%|█████     | 5/10 [00:28<00:30,  6.05s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9338, 'compress@10': 0.5255, 'time@10': 8.8572}:  50%|█████     | 5/10 [00:39<00:30,  6.05s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9338, 'compress@10': 0.5255, 'time@10': 8.8572}:  60%|██████    | 6/10 [00:39<00:30,  7.65s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9337, 'compress@10': 0.5247, 'time@10': 9.2137}:  60%|██████    | 6/10 [00:44<00:30,  7.65s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9337, 'compress@10': 0.5247, 'time@10': 9.2137}:  70%|███████   | 7/10 [00:44<00:21,  7.02s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9384, 'compress@10': 0.5234, 'time@10': 9.0841}:  70%|███████   | 7/10 [00:53<00:21,  7.02s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9384, 'compress@10': 0.5234, 'time@10': 9.0841}:  80%|████████  | 8/10 [00:53<00:14,  7.40s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9435, 'compress@10': 0.5224, 'time@10': 9.7247}:  80%|████████  | 8/10 [01:00<00:14,  7.40s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9435, 'compress@10': 0.5224, 'time@10': 9.7247}:  90%|█████████ | 9/10 [01:00<00:07,  7.42s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9468, 'compress@10': 0.5213, 'time@10': 9.7855}:  90%|█████████ | 9/10 [01:10<00:07,  7.42s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9468, 'compress@10': 0.5213, 'time@10': 9.7855}: 100%|██████████| 10/10 [01:10<00:00,  8.33s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9468, 'compress@10': 0.5213, 'time@10': 9.7855}: 100%|██████████| 10/10 [01:10<00:00,  7.09s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.014353681774941281
Avg hit ratio: 0.9114815239467191
Avg ndcg: 0.9467676010798295
Avg compression ratio: 0.5212749006657823
Avg train time: 9.785471367836
Std train time: 2.940658913509969
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.5263, 'time@10': 8.8432}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.5263, 'time@10': 8.8432}:  10%|█         | 1/10 [00:04<00:40,  4.46s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9417, 'compress@10': 0.5212, 'time@10': 8.0275}:  10%|█         | 1/10 [00:11<00:40,  4.46s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9417, 'compress@10': 0.5212, 'time@10': 8.0275}:  20%|██        | 2/10 [00:11<00:48,  6.10s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9135, 'compress@10': 0.538, 'time@10': 7.1834}:  20%|██        | 2/10 [00:14<00:48,  6.10s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9135, 'compress@10': 0.538, 'time@10': 7.1834}:  30%|███       | 3/10 [00:14<00:32,  4.59s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9255, 'compress@10': 0.5329, 'time@10': 6.9598}:  30%|███       | 3/10 [00:20<00:32,  4.59s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9255, 'compress@10': 0.5329, 'time@10': 6.9598}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9254, 'compress@10': 0.5283, 'time@10': 8.3535}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9254, 'compress@10': 0.5283, 'time@10': 8.3535}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9333, 'compress@10': 0.5255, 'time@10': 8.7164}:  50%|█████     | 5/10 [00:38<00:29,  5.90s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9333, 'compress@10': 0.5255, 'time@10': 8.7164}:  60%|██████    | 6/10 [00:38<00:29,  7.49s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9356, 'compress@10': 0.5247, 'time@10': 9.093}:  60%|██████    | 6/10 [00:44<00:29,  7.49s/it] {'epoch': 35, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9356, 'compress@10': 0.5247, 'time@10': 9.093}:  70%|███████   | 7/10 [00:44<00:20,  6.91s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9387, 'compress@10': 0.5234, 'time@10': 8.9874}:  70%|███████   | 7/10 [00:52<00:20,  6.91s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9387, 'compress@10': 0.5234, 'time@10': 8.9874}:  80%|████████  | 8/10 [00:52<00:14,  7.35s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9388, 'compress@10': 0.5224, 'time@10': 9.5827}:  80%|████████  | 8/10 [00:59<00:14,  7.35s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9388, 'compress@10': 0.5224, 'time@10': 9.5827}:  90%|█████████ | 9/10 [00:59<00:07,  7.30s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.942, 'compress@10': 0.5213, 'time@10': 9.6373}:  90%|█████████ | 9/10 [01:09<00:07,  7.30s/it]    {'epoch': 35, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.942, 'compress@10': 0.5213, 'time@10': 9.6373}: 100%|██████████| 10/10 [01:09<00:00,  8.19s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.942, 'compress@10': 0.5213, 'time@10': 9.6373}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.010937419887647692
Avg hit ratio: 0.9053985746379635
Avg ndcg: 0.9420231461315811
Avg compression ratio: 0.5212748877514427
Avg train time: 9.637335348129273
Std train time: 2.852605953114471
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9202, 'compress@10': 0.5263, 'time@10': 8.6808}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9202, 'compress@10': 0.5263, 'time@10': 8.6808}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9522, 'compress@10': 0.5212, 'time@10': 7.888}:  10%|█         | 1/10 [00:11<00:39,  4.38s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.0201, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9522, 'compress@10': 0.5212, 'time@10': 7.888}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9205, 'compress@10': 0.538, 'time@10': 7.156}:  20%|██        | 2/10 [00:14<00:47,  6.00s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9205, 'compress@10': 0.538, 'time@10': 7.156}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9304, 'compress@10': 0.5329, 'time@10': 6.9567}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9304, 'compress@10': 0.5329, 'time@10': 6.9567}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.929, 'compress@10': 0.5283, 'time@10': 8.4751}:  40%|████      | 4/10 [00:28<00:31,  5.29s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.929, 'compress@10': 0.5283, 'time@10': 8.4751}:  50%|█████     | 5/10 [00:28<00:30,  6.02s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9364, 'compress@10': 0.5255, 'time@10': 8.808}:  50%|█████     | 5/10 [00:38<00:30,  6.02s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9364, 'compress@10': 0.5255, 'time@10': 8.808}:  60%|██████    | 6/10 [00:38<00:30,  7.55s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9382, 'compress@10': 0.5247, 'time@10': 9.2243}:  60%|██████    | 6/10 [00:44<00:30,  7.55s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9382, 'compress@10': 0.5247, 'time@10': 9.2243}:  70%|███████   | 7/10 [00:44<00:21,  7.01s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9362, 'compress@10': 0.5234, 'time@10': 9.0876}:  70%|███████   | 7/10 [00:52<00:21,  7.01s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9362, 'compress@10': 0.5234, 'time@10': 9.0876}:  80%|████████  | 8/10 [00:52<00:14,  7.38s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.944, 'compress@10': 0.5224, 'time@10': 9.6692}:  80%|████████  | 8/10 [00:59<00:14,  7.38s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.944, 'compress@10': 0.5224, 'time@10': 9.6692}:  90%|█████████ | 9/10 [00:59<00:07,  7.32s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.943, 'compress@10': 0.5213, 'time@10': 9.7329}:  90%|█████████ | 9/10 [01:10<00:07,  7.32s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.943, 'compress@10': 0.5213, 'time@10': 9.7329}: 100%|██████████| 10/10 [01:10<00:00,  8.26s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.943, 'compress@10': 0.5213, 'time@10': 9.7329}: 100%|██████████| 10/10 [01:10<00:00,  7.02s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.017338441054065807
Avg hit ratio: 0.9113791173926996
Avg ndcg: 0.9430390562773315
Avg compression ratio: 0.5212748945130448
Avg train time: 9.732903289794923
Std train time: 2.9567938415097053
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9202, 'compress@10': 0.5263, 'time@10': 8.591}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9202, 'compress@10': 0.5263, 'time@10': 8.591}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9439, 'compress@10': 0.5212, 'time@10': 7.8738}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9439, 'compress@10': 0.5212, 'time@10': 7.8738}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.915, 'compress@10': 0.538, 'time@10': 7.1952}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it]  {'epoch': 37, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.915, 'compress@10': 0.538, 'time@10': 7.1952}:  30%|███       | 3/10 [00:14<00:32,  4.62s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9268, 'compress@10': 0.5329, 'time@10': 7.0104}:  30%|███       | 3/10 [00:20<00:32,  4.62s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9268, 'compress@10': 0.5329, 'time@10': 7.0104}:  40%|████      | 4/10 [00:20<00:32,  5.36s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9274, 'compress@10': 0.5283, 'time@10': 8.5075}:  40%|████      | 4/10 [00:28<00:32,  5.36s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9274, 'compress@10': 0.5283, 'time@10': 8.5075}:  50%|█████     | 5/10 [00:28<00:30,  6.05s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9351, 'compress@10': 0.5255, 'time@10': 8.8341}:  50%|█████     | 5/10 [00:38<00:30,  6.05s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9351, 'compress@10': 0.5255, 'time@10': 8.8341}:  60%|██████    | 6/10 [00:38<00:30,  7.58s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9333, 'compress@10': 0.5247, 'time@10': 9.1974}:  60%|██████    | 6/10 [00:44<00:30,  7.58s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9333, 'compress@10': 0.5247, 'time@10': 9.1974}:  70%|███████   | 7/10 [00:44<00:20,  6.98s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9327, 'compress@10': 0.5234, 'time@10': 9.0686}:  70%|███████   | 7/10 [00:52<00:20,  6.98s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9327, 'compress@10': 0.5234, 'time@10': 9.0686}:  80%|████████  | 8/10 [00:52<00:14,  7.37s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9287, 'compress@10': 0.5224, 'time@10': 9.6631}:  80%|████████  | 8/10 [00:59<00:14,  7.37s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9287, 'compress@10': 0.5224, 'time@10': 9.6631}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9106, 'ndcg@10': 0.9335, 'compress@10': 0.5213, 'time@10': 9.7209}:  90%|█████████ | 9/10 [01:10<00:07,  7.33s/it]  {'epoch': 37, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9106, 'ndcg@10': 0.9335, 'compress@10': 0.5213, 'time@10': 9.7209}: 100%|██████████| 10/10 [01:10<00:00,  8.24s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9106, 'ndcg@10': 0.9335, 'compress@10': 0.5213, 'time@10': 9.7209}: 100%|██████████| 10/10 [01:10<00:00,  7.03s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.012943219151836664
Avg hit ratio: 0.9106243810895762
Avg ndcg: 0.9334526241973187
Avg compression ratio: 0.5212748962631665
Avg train time: 9.720928502082824
Std train time: 2.905972655775376
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9223, 'compress@10': 0.5263, 'time@10': 8.723}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9223, 'compress@10': 0.5263, 'time@10': 8.723}:  10%|█         | 1/10 [00:04<00:39,  4.40s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9464, 'compress@10': 0.5212, 'time@10': 7.893}:  10%|█         | 1/10 [00:11<00:39,  4.40s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9464, 'compress@10': 0.5212, 'time@10': 7.893}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9167, 'compress@10': 0.538, 'time@10': 7.1567}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9167, 'compress@10': 0.538, 'time@10': 7.1567}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9279, 'compress@10': 0.5329, 'time@10': 6.9549}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9279, 'compress@10': 0.5329, 'time@10': 6.9549}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9282, 'compress@10': 0.5283, 'time@10': 8.3361}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9282, 'compress@10': 0.5283, 'time@10': 8.3361}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9362, 'compress@10': 0.5255, 'time@10': 8.6994}:  50%|█████     | 5/10 [00:38<00:29,  5.89s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9362, 'compress@10': 0.5255, 'time@10': 8.6994}:  60%|██████    | 6/10 [00:38<00:29,  7.48s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9386, 'compress@10': 0.5247, 'time@10': 9.1022}:  60%|██████    | 6/10 [00:44<00:29,  7.48s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9386, 'compress@10': 0.5247, 'time@10': 9.1022}:  70%|███████   | 7/10 [00:44<00:20,  6.93s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9387, 'compress@10': 0.5234, 'time@10': 8.9766}:  70%|███████   | 7/10 [00:52<00:20,  6.93s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9387, 'compress@10': 0.5234, 'time@10': 8.9766}:  80%|████████  | 8/10 [00:52<00:14,  7.31s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9565, 'compress@10': 0.5224, 'time@10': 9.6173}:  80%|████████  | 8/10 [00:59<00:14,  7.31s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9565, 'compress@10': 0.5224, 'time@10': 9.6173}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9583, 'compress@10': 0.5213, 'time@10': 9.6717}:  90%|█████████ | 9/10 [01:09<00:07,  7.34s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9583, 'compress@10': 0.5213, 'time@10': 9.6717}: 100%|██████████| 10/10 [01:09<00:00,  8.22s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9583, 'compress@10': 0.5213, 'time@10': 9.6717}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.015651810971128978
Avg hit ratio: 0.8863156253292077
Avg ndcg: 0.9583441427524176
Avg compression ratio: 0.521274890208265
Avg train time: 9.671651101112365
Std train time: 2.911213536205549
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9202, 'compress@10': 0.5263, 'time@10': 8.819}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9202, 'compress@10': 0.5263, 'time@10': 8.819}:  10%|█         | 1/10 [00:04<00:40,  4.45s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9439, 'compress@10': 0.5212, 'time@10': 7.9326}:  10%|█         | 1/10 [00:11<00:40,  4.45s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9439, 'compress@10': 0.5212, 'time@10': 7.9326}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.915, 'compress@10': 0.538, 'time@10': 7.1381}:  20%|██        | 2/10 [00:14<00:47,  6.00s/it]  {'epoch': 39, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.915, 'compress@10': 0.538, 'time@10': 7.1381}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9268, 'compress@10': 0.5329, 'time@10': 6.964}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9268, 'compress@10': 0.5329, 'time@10': 6.964}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9281, 'compress@10': 0.5283, 'time@10': 8.3581}:  40%|████      | 4/10 [00:27<00:31,  5.31s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9281, 'compress@10': 0.5283, 'time@10': 8.3581}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9361, 'compress@10': 0.5255, 'time@10': 8.7107}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9361, 'compress@10': 0.5255, 'time@10': 8.7107}:  60%|██████    | 6/10 [00:38<00:29,  7.49s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9386, 'compress@10': 0.5247, 'time@10': 9.0952}:  60%|██████    | 6/10 [00:44<00:29,  7.49s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9386, 'compress@10': 0.5247, 'time@10': 9.0952}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.9094, 'ndcg@10': 0.9418, 'compress@10': 0.5234, 'time@10': 8.9953}:  70%|███████   | 7/10 [00:52<00:20,  6.92s/it]  {'epoch': 39, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.9094, 'ndcg@10': 0.9418, 'compress@10': 0.5234, 'time@10': 8.9953}:  80%|████████  | 8/10 [00:52<00:14,  7.37s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9437, 'compress@10': 0.5224, 'time@10': 9.6046}:  80%|████████  | 8/10 [00:59<00:14,  7.37s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9437, 'compress@10': 0.5224, 'time@10': 9.6046}:  90%|█████████ | 9/10 [00:59<00:07,  7.34s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.947, 'compress@10': 0.5213, 'time@10': 9.6403}:  90%|█████████ | 9/10 [01:09<00:07,  7.34s/it]    {'epoch': 39, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.947, 'compress@10': 0.5213, 'time@10': 9.6403}: 100%|██████████| 10/10 [01:09<00:00,  8.16s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.947, 'compress@10': 0.5213, 'time@10': 9.6403}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.009921947874199233
Avg hit ratio: 0.8995644732554748
Avg ndcg: 0.9469792598907469
Avg compression ratio: 0.5212749006657823
Avg train time: 9.640278649330138
Std train time: 2.8624109978126246
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9223, 'compress@10': 0.5263, 'time@10': 8.5538}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9223, 'compress@10': 0.5263, 'time@10': 8.5538}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.945, 'compress@10': 0.5212, 'time@10': 7.8467}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.945, 'compress@10': 0.5212, 'time@10': 7.8467}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9157, 'compress@10': 0.538, 'time@10': 7.0882}:  20%|██        | 2/10 [00:14<00:47,  6.00s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9157, 'compress@10': 0.538, 'time@10': 7.0882}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9274, 'compress@10': 0.5329, 'time@10': 6.9016}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9274, 'compress@10': 0.5329, 'time@10': 6.9016}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9284, 'compress@10': 0.5283, 'time@10': 8.2942}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9284, 'compress@10': 0.5283, 'time@10': 8.2942}:  50%|█████     | 5/10 [00:27<00:29,  5.88s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9356, 'compress@10': 0.5255, 'time@10': 8.6292}:  50%|█████     | 5/10 [00:38<00:29,  5.88s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9356, 'compress@10': 0.5255, 'time@10': 8.6292}:  60%|██████    | 6/10 [00:38<00:29,  7.40s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9338, 'compress@10': 0.5247, 'time@10': 9.0377}:  60%|██████    | 6/10 [00:43<00:29,  7.40s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9338, 'compress@10': 0.5247, 'time@10': 9.0377}:  70%|███████   | 7/10 [00:43<00:20,  6.87s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0119, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9385, 'compress@10': 0.5234, 'time@10': 8.896}:  70%|███████   | 7/10 [00:51<00:20,  6.87s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 0.0119, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9385, 'compress@10': 0.5234, 'time@10': 8.896}:  80%|████████  | 8/10 [00:51<00:14,  7.21s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9406, 'compress@10': 0.5224, 'time@10': 9.4962}:  80%|████████  | 8/10 [00:58<00:14,  7.21s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9406, 'compress@10': 0.5224, 'time@10': 9.4962}:  90%|█████████ | 9/10 [00:58<00:07,  7.20s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9426, 'compress@10': 0.5213, 'time@10': 9.5821}:  90%|█████████ | 9/10 [01:09<00:07,  7.20s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9426, 'compress@10': 0.5213, 'time@10': 9.5821}: 100%|██████████| 10/10 [01:09<00:00,  8.19s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9426, 'compress@10': 0.5213, 'time@10': 9.5821}: 100%|██████████| 10/10 [01:09<00:00,  6.93s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.013813014679126101
Avg hit ratio: 0.8848076888212711
Avg ndcg: 0.9425972408487017
Avg compression ratio: 0.5212749006657823
Avg train time: 9.582051110267638
Std train time: 2.8593891578492245
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9223, 'compress@10': 0.5263, 'time@10': 8.3893}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9223, 'compress@10': 0.5263, 'time@10': 8.3893}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9456, 'compress@10': 0.5212, 'time@10': 7.7566}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9456, 'compress@10': 0.5212, 'time@10': 7.7566}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9161, 'compress@10': 0.538, 'time@10': 7.0412}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9161, 'compress@10': 0.538, 'time@10': 7.0412}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9275, 'compress@10': 0.5329, 'time@10': 6.8609}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9275, 'compress@10': 0.5329, 'time@10': 6.8609}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.929, 'compress@10': 0.5283, 'time@10': 8.2762}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.929, 'compress@10': 0.5283, 'time@10': 8.2762}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9366, 'compress@10': 0.5255, 'time@10': 8.6191}:  50%|█████     | 5/10 [00:37<00:29,  5.89s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9366, 'compress@10': 0.5255, 'time@10': 8.6191}:  60%|██████    | 6/10 [00:37<00:29,  7.41s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9397, 'compress@10': 0.5247, 'time@10': 8.988}:  60%|██████    | 6/10 [00:43<00:29,  7.41s/it] {'epoch': 41, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9397, 'compress@10': 0.5247, 'time@10': 8.988}:  70%|███████   | 7/10 [00:43<00:20,  6.83s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9569, 'compress@10': 0.5234, 'time@10': 8.8525}:  70%|███████   | 7/10 [00:51<00:20,  6.83s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9569, 'compress@10': 0.5234, 'time@10': 8.8525}:  80%|████████  | 8/10 [00:51<00:14,  7.19s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9577, 'compress@10': 0.5224, 'time@10': 9.486}:  80%|████████  | 8/10 [00:58<00:14,  7.19s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9577, 'compress@10': 0.5224, 'time@10': 9.486}:  90%|█████████ | 9/10 [00:58<00:07,  7.23s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9596, 'compress@10': 0.5213, 'time@10': 9.5517}:  90%|█████████ | 9/10 [01:09<00:07,  7.23s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9596, 'compress@10': 0.5213, 'time@10': 9.5517}: 100%|██████████| 10/10 [01:09<00:00,  8.14s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9596, 'compress@10': 0.5213, 'time@10': 9.5517}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.009296517904099216
Avg hit ratio: 0.8920299110434934
Avg ndcg: 0.9595853430735293
Avg compression ratio: 0.5212749006657823
Avg train time: 9.55169951915741
Std train time: 2.8960884462859364
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.5263, 'time@10': 8.4962}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.5263, 'time@10': 8.4962}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9477, 'compress@10': 0.5212, 'time@10': 7.8223}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9477, 'compress@10': 0.5212, 'time@10': 7.8223}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9175, 'compress@10': 0.538, 'time@10': 7.1344}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9175, 'compress@10': 0.538, 'time@10': 7.1344}:  30%|███       | 3/10 [00:14<00:32,  4.59s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9287, 'compress@10': 0.5329, 'time@10': 6.9283}:  30%|███       | 3/10 [00:20<00:32,  4.59s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9287, 'compress@10': 0.5329, 'time@10': 6.9283}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9305, 'compress@10': 0.5283, 'time@10': 8.349}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it] {'epoch': 42, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9305, 'compress@10': 0.5283, 'time@10': 8.349}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9355, 'compress@10': 0.5255, 'time@10': 8.6963}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9355, 'compress@10': 0.5255, 'time@10': 8.6963}:  60%|██████    | 6/10 [00:38<00:29,  7.47s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0109, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.938, 'compress@10': 0.5247, 'time@10': 9.0711}:  60%|██████    | 6/10 [00:43<00:29,  7.47s/it] {'epoch': 42, 'num_users': 6.2857, 'loss': 0.0109, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.938, 'compress@10': 0.5247, 'time@10': 9.0711}:  70%|███████   | 7/10 [00:43<00:20,  6.89s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9416, 'compress@10': 0.5234, 'time@10': 8.9321}:  70%|███████   | 7/10 [00:51<00:20,  6.89s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9416, 'compress@10': 0.5234, 'time@10': 8.9321}:  80%|████████  | 8/10 [00:51<00:14,  7.24s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9533, 'compress@10': 0.5224, 'time@10': 9.5282}:  80%|████████  | 8/10 [00:59<00:14,  7.24s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9533, 'compress@10': 0.5224, 'time@10': 9.5282}:  90%|█████████ | 9/10 [00:59<00:07,  7.22s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9535, 'compress@10': 0.5213, 'time@10': 9.5905}:  90%|█████████ | 9/10 [01:09<00:07,  7.22s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9535, 'compress@10': 0.5213, 'time@10': 9.5905}: 100%|██████████| 10/10 [01:09<00:00,  8.14s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9535, 'compress@10': 0.5213, 'time@10': 9.5905}: 100%|██████████| 10/10 [01:09<00:00,  6.93s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.01335044415386398
Avg hit ratio: 0.8890370795022747
Avg ndcg: 0.9535148241975021
Avg compression ratio: 0.5212749006657823
Avg train time: 9.590538263320923
Std train time: 2.848958988176429
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9223, 'compress@10': 0.5263, 'time@10': 8.579}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9223, 'compress@10': 0.5263, 'time@10': 8.579}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9546, 'compress@10': 0.5212, 'time@10': 7.9008}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9546, 'compress@10': 0.5212, 'time@10': 7.9008}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9221, 'compress@10': 0.538, 'time@10': 7.111}:  20%|██        | 2/10 [00:14<00:48,  6.05s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9221, 'compress@10': 0.538, 'time@10': 7.111}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9322, 'compress@10': 0.5329, 'time@10': 6.9172}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9322, 'compress@10': 0.5329, 'time@10': 6.9172}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.934, 'compress@10': 0.5283, 'time@10': 8.3624}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it] {'epoch': 43, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.934, 'compress@10': 0.5283, 'time@10': 8.3624}:  50%|█████     | 5/10 [00:27<00:29,  5.95s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.874, 'ndcg@10': 0.941, 'compress@10': 0.5255, 'time@10': 8.7193}:  50%|█████     | 5/10 [00:38<00:29,  5.95s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.874, 'ndcg@10': 0.941, 'compress@10': 0.5255, 'time@10': 8.7193}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9434, 'compress@10': 0.5247, 'time@10': 9.0623}:  60%|██████    | 6/10 [00:44<00:30,  7.51s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9434, 'compress@10': 0.5247, 'time@10': 9.0623}:  70%|███████   | 7/10 [00:44<00:20,  6.88s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9462, 'compress@10': 0.5234, 'time@10': 8.9309}:  70%|███████   | 7/10 [00:52<00:20,  6.88s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9462, 'compress@10': 0.5234, 'time@10': 8.9309}:  80%|████████  | 8/10 [00:52<00:14,  7.26s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.883, 'ndcg@10': 0.946, 'compress@10': 0.5224, 'time@10': 9.5507}:  80%|████████  | 8/10 [00:59<00:14,  7.26s/it] {'epoch': 43, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.883, 'ndcg@10': 0.946, 'compress@10': 0.5224, 'time@10': 9.5507}:  90%|█████████ | 9/10 [00:59<00:07,  7.27s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0104, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.949, 'compress@10': 0.5213, 'time@10': 9.6139}:  90%|█████████ | 9/10 [01:09<00:07,  7.27s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 0.0104, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.949, 'compress@10': 0.5213, 'time@10': 9.6139}: 100%|██████████| 10/10 [01:09<00:00,  8.18s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0104, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.949, 'compress@10': 0.5213, 'time@10': 9.6139}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.010371700591123831
Avg hit ratio: 0.8923985746379633
Avg ndcg: 0.9489981353739696
Avg compression ratio: 0.5212748951310653
Avg train time: 9.613851475715638
Std train time: 2.909143315830525
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.5263, 'time@10': 8.631}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.5263, 'time@10': 8.631}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9477, 'compress@10': 0.5212, 'time@10': 7.8609}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9477, 'compress@10': 0.5212, 'time@10': 7.8609}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9175, 'compress@10': 0.538, 'time@10': 7.0986}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9175, 'compress@10': 0.538, 'time@10': 7.0986}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9285, 'compress@10': 0.5329, 'time@10': 6.9194}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9285, 'compress@10': 0.5329, 'time@10': 6.9194}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9309, 'compress@10': 0.5283, 'time@10': 8.4169}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9309, 'compress@10': 0.5283, 'time@10': 8.4169}:  50%|█████     | 5/10 [00:27<00:29,  5.99s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9388, 'compress@10': 0.5255, 'time@10': 8.7901}:  50%|█████     | 5/10 [00:38<00:29,  5.99s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9388, 'compress@10': 0.5255, 'time@10': 8.7901}:  60%|██████    | 6/10 [00:38<00:30,  7.59s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9413, 'compress@10': 0.5247, 'time@10': 9.17}:  60%|██████    | 6/10 [00:44<00:30,  7.59s/it]  {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9413, 'compress@10': 0.5247, 'time@10': 9.17}:  70%|███████   | 7/10 [00:44<00:20,  7.00s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9568, 'compress@10': 0.5234, 'time@10': 9.0195}:  70%|███████   | 7/10 [00:52<00:20,  7.00s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9568, 'compress@10': 0.5234, 'time@10': 9.0195}:  80%|████████  | 8/10 [00:52<00:14,  7.32s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9694, 'compress@10': 0.5224, 'time@10': 9.644}:  80%|████████  | 8/10 [00:59<00:14,  7.32s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9694, 'compress@10': 0.5224, 'time@10': 9.644}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9701, 'compress@10': 0.5213, 'time@10': 9.6921}:  90%|█████████ | 9/10 [01:09<00:07,  7.33s/it]  {'epoch': 44, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9701, 'compress@10': 0.5213, 'time@10': 9.6921}: 100%|██████████| 10/10 [01:09<00:00,  8.20s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9701, 'compress@10': 0.5213, 'time@10': 9.6921}: 100%|██████████| 10/10 [01:09<00:00,  7.00s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.013165086147271918
Avg hit ratio: 0.896259301724497
Avg ndcg: 0.970122245965978
Avg compression ratio: 0.5212749006657823
Avg train time: 9.692108392715454
Std train time: 2.9950311912986782
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9209, 'compress@10': 0.5263, 'time@10': 8.875}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9209, 'compress@10': 0.5263, 'time@10': 8.875}:  10%|█         | 1/10 [00:04<00:40,  4.47s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9425, 'compress@10': 0.5212, 'time@10': 8.0684}:  10%|█         | 1/10 [00:11<00:40,  4.47s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9425, 'compress@10': 0.5212, 'time@10': 8.0684}:  20%|██        | 2/10 [00:11<00:49,  6.14s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9141, 'compress@10': 0.538, 'time@10': 7.2999}:  20%|██        | 2/10 [00:14<00:49,  6.14s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9141, 'compress@10': 0.538, 'time@10': 7.2999}:  30%|███       | 3/10 [00:14<00:32,  4.67s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9261, 'compress@10': 0.5329, 'time@10': 7.0656}:  30%|███       | 3/10 [00:21<00:32,  4.67s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9261, 'compress@10': 0.5329, 'time@10': 7.0656}:  40%|████      | 4/10 [00:21<00:32,  5.35s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9301, 'compress@10': 0.5283, 'time@10': 8.4628}:  40%|████      | 4/10 [00:28<00:32,  5.35s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9301, 'compress@10': 0.5283, 'time@10': 8.4628}:  50%|█████     | 5/10 [00:28<00:29,  5.97s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0067, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9377, 'compress@10': 0.5255, 'time@10': 8.7955}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0067, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9377, 'compress@10': 0.5255, 'time@10': 8.7955}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.01, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9422, 'compress@10': 0.5247, 'time@10': 9.1903}:  60%|██████    | 6/10 [00:44<00:30,  7.51s/it]  {'epoch': 45, 'num_users': 6.2857, 'loss': 0.01, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9422, 'compress@10': 0.5247, 'time@10': 9.1903}:  70%|███████   | 7/10 [00:44<00:20,  6.96s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9576, 'compress@10': 0.5234, 'time@10': 9.0844}:  70%|███████   | 7/10 [00:52<00:20,  6.96s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9576, 'compress@10': 0.5234, 'time@10': 9.0844}:  80%|████████  | 8/10 [00:52<00:14,  7.41s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9562, 'compress@10': 0.5224, 'time@10': 9.694}:  80%|████████  | 8/10 [01:00<00:14,  7.41s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9562, 'compress@10': 0.5224, 'time@10': 9.694}:  90%|█████████ | 9/10 [01:00<00:07,  7.38s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9573, 'compress@10': 0.5213, 'time@10': 9.7467}:  90%|█████████ | 9/10 [01:10<00:07,  7.38s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9573, 'compress@10': 0.5213, 'time@10': 9.7467}: 100%|██████████| 10/10 [01:10<00:00,  8.27s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9573, 'compress@10': 0.5213, 'time@10': 9.7467}: 100%|██████████| 10/10 [01:10<00:00,  7.04s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.014075739867232148
Avg hit ratio: 0.895970003209392
Avg ndcg: 0.9572966009712104
Avg compression ratio: 0.5212749006657823
Avg train time: 9.746737480163574
Std train time: 2.864424744175087
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9213, 'compress@10': 0.5263, 'time@10': 8.7563}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9213, 'compress@10': 0.5263, 'time@10': 8.7563}:  10%|█         | 1/10 [00:04<00:39,  4.42s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9577, 'compress@10': 0.5212, 'time@10': 7.9886}:  10%|█         | 1/10 [00:11<00:39,  4.42s/it]  {'epoch': 46, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9577, 'compress@10': 0.5212, 'time@10': 7.9886}:  20%|██        | 2/10 [00:11<00:48,  6.09s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9242, 'compress@10': 0.538, 'time@10': 7.1817}:  20%|██        | 2/10 [00:14<00:48,  6.09s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9242, 'compress@10': 0.538, 'time@10': 7.1817}:  30%|███       | 3/10 [00:14<00:32,  4.60s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9337, 'compress@10': 0.5329, 'time@10': 6.9996}:  30%|███       | 3/10 [00:20<00:32,  4.60s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9337, 'compress@10': 0.5329, 'time@10': 6.9996}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.936, 'compress@10': 0.5283, 'time@10': 8.4173}:  40%|████      | 4/10 [00:28<00:32,  5.34s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.936, 'compress@10': 0.5283, 'time@10': 8.4173}:  50%|█████     | 5/10 [00:28<00:29,  5.97s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9425, 'compress@10': 0.5255, 'time@10': 8.7874}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9425, 'compress@10': 0.5255, 'time@10': 8.7874}:  60%|██████    | 6/10 [00:38<00:30,  7.57s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9439, 'compress@10': 0.5247, 'time@10': 9.1446}:  60%|██████    | 6/10 [00:44<00:30,  7.57s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9439, 'compress@10': 0.5247, 'time@10': 9.1446}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9459, 'compress@10': 0.5234, 'time@10': 9.0088}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9459, 'compress@10': 0.5234, 'time@10': 9.0088}:  80%|████████  | 8/10 [00:52<00:14,  7.32s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.943, 'compress@10': 0.5224, 'time@10': 9.6276}:  80%|████████  | 8/10 [00:59<00:14,  7.32s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.943, 'compress@10': 0.5224, 'time@10': 9.6276}:  90%|█████████ | 9/10 [00:59<00:07,  7.32s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9464, 'compress@10': 0.5213, 'time@10': 9.6826}:  90%|█████████ | 9/10 [01:10<00:07,  7.32s/it]  {'epoch': 46, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9464, 'compress@10': 0.5213, 'time@10': 9.6826}: 100%|██████████| 10/10 [01:10<00:00,  8.21s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9464, 'compress@10': 0.5213, 'time@10': 9.6826}: 100%|██████████| 10/10 [01:10<00:00,  7.01s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.012754378149271977
Avg hit ratio: 0.8822398444792332
Avg ndcg: 0.9464389774043849
Avg compression ratio: 0.5212749006657823
Avg train time: 9.682563424110413
Std train time: 2.898746622646404
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 0.5263, 'time@10': 8.445}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 0.5263, 'time@10': 8.445}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9445, 'compress@10': 0.5212, 'time@10': 7.8595}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9445, 'compress@10': 0.5212, 'time@10': 7.8595}:  20%|██        | 2/10 [00:11<00:48,  6.06s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9154, 'compress@10': 0.538, 'time@10': 7.1474}:  20%|██        | 2/10 [00:14<00:48,  6.06s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9154, 'compress@10': 0.538, 'time@10': 7.1474}:  30%|███       | 3/10 [00:14<00:32,  4.61s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9269, 'compress@10': 0.5329, 'time@10': 6.9489}:  30%|███       | 3/10 [00:20<00:32,  4.61s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9269, 'compress@10': 0.5329, 'time@10': 6.9489}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9317, 'compress@10': 0.5283, 'time@10': 8.4112}:  40%|████      | 4/10 [00:28<00:31,  5.32s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9317, 'compress@10': 0.5283, 'time@10': 8.4112}:  50%|█████     | 5/10 [00:28<00:29,  5.98s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0069, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9391, 'compress@10': 0.5255, 'time@10': 8.787}:  50%|█████     | 5/10 [00:38<00:29,  5.98s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0069, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9391, 'compress@10': 0.5255, 'time@10': 8.787}:  60%|██████    | 6/10 [00:38<00:30,  7.59s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9415, 'compress@10': 0.5247, 'time@10': 9.1821}:  60%|██████    | 6/10 [00:44<00:30,  7.59s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9415, 'compress@10': 0.5247, 'time@10': 9.1821}:  70%|███████   | 7/10 [00:44<00:21,  7.01s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0081, 'hit_ratio@10': 0.905, 'ndcg@10': 0.94, 'compress@10': 0.5234, 'time@10': 9.0328}:  70%|███████   | 7/10 [00:52<00:21,  7.01s/it]    {'epoch': 47, 'num_users': 6.125, 'loss': 0.0081, 'hit_ratio@10': 0.905, 'ndcg@10': 0.94, 'compress@10': 0.5234, 'time@10': 9.0328}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0076, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9429, 'compress@10': 0.5224, 'time@10': 9.662}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0076, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9429, 'compress@10': 0.5224, 'time@10': 9.662}:  90%|█████████ | 9/10 [00:59<00:07,  7.35s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.943, 'compress@10': 0.5213, 'time@10': 9.7177}:  90%|█████████ | 9/10 [01:10<00:07,  7.35s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.943, 'compress@10': 0.5213, 'time@10': 9.7177}: 100%|██████████| 10/10 [01:10<00:00,  8.25s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.943, 'compress@10': 0.5213, 'time@10': 9.7177}: 100%|██████████| 10/10 [01:10<00:00,  7.02s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.008937965800956372
Avg hit ratio: 0.9045644732554748
Avg ndcg: 0.942971396454336
Avg compression ratio: 0.5212748930363877
Avg train time: 9.717714166641235
Std train time: 2.9630278259399616
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9223, 'compress@10': 0.5263, 'time@10': 8.6055}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9223, 'compress@10': 0.5263, 'time@10': 8.6055}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9689, 'compress@10': 0.5212, 'time@10': 7.9351}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it] {'epoch': 48, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9689, 'compress@10': 0.5212, 'time@10': 7.9351}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9317, 'compress@10': 0.538, 'time@10': 7.1896}:  20%|██        | 2/10 [00:14<00:48,  6.08s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9317, 'compress@10': 0.538, 'time@10': 7.1896}:  30%|███       | 3/10 [00:14<00:32,  4.64s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9398, 'compress@10': 0.5329, 'time@10': 6.9883}:  30%|███       | 3/10 [00:20<00:32,  4.64s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9398, 'compress@10': 0.5329, 'time@10': 6.9883}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9434, 'compress@10': 0.5283, 'time@10': 8.4641}:  40%|████      | 4/10 [00:28<00:32,  5.34s/it] {'epoch': 48, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9434, 'compress@10': 0.5283, 'time@10': 8.4641}:  50%|█████     | 5/10 [00:28<00:30,  6.02s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9481, 'compress@10': 0.5255, 'time@10': 8.857}:  50%|█████     | 5/10 [00:39<00:30,  6.02s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9481, 'compress@10': 0.5255, 'time@10': 8.857}:  60%|██████    | 6/10 [00:39<00:30,  7.66s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9498, 'compress@10': 0.5247, 'time@10': 9.2494}:  60%|██████    | 6/10 [00:44<00:30,  7.66s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9498, 'compress@10': 0.5247, 'time@10': 9.2494}:  70%|███████   | 7/10 [00:44<00:21,  7.07s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9509, 'compress@10': 0.5234, 'time@10': 9.0756}:  70%|███████   | 7/10 [00:52<00:21,  7.07s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9509, 'compress@10': 0.5234, 'time@10': 9.0756}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9525, 'compress@10': 0.5224, 'time@10': 9.6404}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9525, 'compress@10': 0.5224, 'time@10': 9.6404}:  90%|█████████ | 9/10 [00:59<00:07,  7.26s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.955, 'compress@10': 0.5213, 'time@10': 9.6799}:  90%|█████████ | 9/10 [01:09<00:07,  7.26s/it]    {'epoch': 48, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.955, 'compress@10': 0.5213, 'time@10': 9.6799}: 100%|██████████| 10/10 [01:09<00:00,  8.13s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.955, 'compress@10': 0.5213, 'time@10': 9.6799}: 100%|██████████| 10/10 [01:09<00:00,  7.00s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.010138252145208582
Avg hit ratio: 0.8850969873363761
Avg ndcg: 0.954980151781162
Avg compression ratio: 0.5212749006657823
Avg train time: 9.679915118217469
Std train time: 2.901395456309225
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9249, 'compress@10': 0.5263, 'time@10': 8.3775}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9249, 'compress@10': 0.5263, 'time@10': 8.3775}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0063, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9445, 'compress@10': 0.5212, 'time@10': 7.7226}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it] {'epoch': 49, 'num_users': 7.0, 'loss': 0.0063, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9445, 'compress@10': 0.5212, 'time@10': 7.7226}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9154, 'compress@10': 0.538, 'time@10': 6.9847}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9154, 'compress@10': 0.538, 'time@10': 6.9847}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9276, 'compress@10': 0.5329, 'time@10': 6.8423}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9276, 'compress@10': 0.5329, 'time@10': 6.8423}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0064, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9345, 'compress@10': 0.5283, 'time@10': 8.2711}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0064, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9345, 'compress@10': 0.5283, 'time@10': 8.2711}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0057, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9414, 'compress@10': 0.5255, 'time@10': 8.6274}:  50%|█████     | 5/10 [00:38<00:29,  5.90s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0057, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9414, 'compress@10': 0.5255, 'time@10': 8.6274}:  60%|██████    | 6/10 [00:38<00:29,  7.45s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0063, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9444, 'compress@10': 0.5247, 'time@10': 8.9971}:  60%|██████    | 6/10 [00:43<00:29,  7.45s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0063, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9444, 'compress@10': 0.5247, 'time@10': 8.9971}:  70%|███████   | 7/10 [00:43<00:20,  6.86s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0069, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9485, 'compress@10': 0.5234, 'time@10': 8.8629}:  70%|███████   | 7/10 [00:51<00:20,  6.86s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0069, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9485, 'compress@10': 0.5234, 'time@10': 8.8629}:  80%|████████  | 8/10 [00:51<00:14,  7.21s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0065, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9505, 'compress@10': 0.5224, 'time@10': 9.468}:  80%|████████  | 8/10 [00:58<00:14,  7.21s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0065, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9505, 'compress@10': 0.5224, 'time@10': 9.468}:  90%|█████████ | 9/10 [00:58<00:07,  7.20s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0079, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.951, 'compress@10': 0.5213, 'time@10': 9.5127}:  90%|█████████ | 9/10 [01:08<00:07,  7.20s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0079, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.951, 'compress@10': 0.5213, 'time@10': 9.5127}: 100%|██████████| 10/10 [01:08<00:00,  8.05s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0079, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.951, 'compress@10': 0.5213, 'time@10': 9.5127}: 100%|██████████| 10/10 [01:08<00:00,  6.88s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.007897690466635882
Avg hit ratio: 0.898112860352249
Avg ndcg: 0.9509603680021291
Avg compression ratio: 0.5212749006657823
Avg train time: 9.51268286705017
Std train time: 2.8686988891945937
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
