  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2008, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5235, 'compress@10': 0.5263, 'time@10': 9.677}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2008, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5235, 'compress@10': 0.5263, 'time@10': 9.677}:  10%|█         | 1/10 [00:04<00:43,  4.88s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1478, 'hit_ratio@10': 0.5917, 'ndcg@10': 0.5751, 'compress@10': 0.5212, 'time@10': 8.3459}:  10%|█         | 1/10 [00:11<00:43,  4.88s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1478, 'hit_ratio@10': 0.5917, 'ndcg@10': 0.5751, 'compress@10': 0.5212, 'time@10': 8.3459}:  20%|██        | 2/10 [00:11<00:49,  6.16s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8862, 'hit_ratio@10': 0.5373, 'ndcg@10': 0.3834, 'compress@10': 0.538, 'time@10': 6.5286}:  20%|██        | 2/10 [00:13<00:49,  6.16s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.8862, 'hit_ratio@10': 0.5373, 'ndcg@10': 0.3834, 'compress@10': 0.538, 'time@10': 6.5286}:  30%|███       | 3/10 [00:13<00:28,  4.03s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6972, 'hit_ratio@10': 0.5905, 'ndcg@10': 0.43, 'compress@10': 0.5329, 'time@10': 6.4891}:  30%|███       | 3/10 [00:19<00:28,  4.03s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.6972, 'hit_ratio@10': 0.5905, 'ndcg@10': 0.43, 'compress@10': 0.5329, 'time@10': 6.4891}:  40%|████      | 4/10 [00:19<00:29,  4.97s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5768, 'hit_ratio@10': 0.6364, 'ndcg@10': 0.492, 'compress@10': 0.5283, 'time@10': 9.7723}:  40%|████      | 4/10 [00:31<00:29,  4.97s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5768, 'hit_ratio@10': 0.6364, 'ndcg@10': 0.492, 'compress@10': 0.5283, 'time@10': 9.7723}:  50%|█████     | 5/10 [00:31<00:36,  7.32s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4958, 'hit_ratio@10': 0.6525, 'ndcg@10': 0.5365, 'compress@10': 0.5255, 'time@10': 9.8639}:  50%|█████     | 5/10 [00:41<00:36,  7.32s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4958, 'hit_ratio@10': 0.6525, 'ndcg@10': 0.5365, 'compress@10': 0.5255, 'time@10': 9.8639}:  60%|██████    | 6/10 [00:41<00:33,  8.36s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4449, 'hit_ratio@10': 0.6508, 'ndcg@10': 0.5381, 'compress@10': 0.5247, 'time@10': 10.1277}:  60%|██████    | 6/10 [00:47<00:33,  8.36s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4449, 'hit_ratio@10': 0.6508, 'ndcg@10': 0.5381, 'compress@10': 0.5247, 'time@10': 10.1277}:  70%|███████   | 7/10 [00:47<00:22,  7.56s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3963, 'hit_ratio@10': 0.6837, 'ndcg@10': 0.5671, 'compress@10': 0.5234, 'time@10': 9.8622}:  70%|███████   | 7/10 [00:55<00:22,  7.56s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.3963, 'hit_ratio@10': 0.6837, 'ndcg@10': 0.5671, 'compress@10': 0.5234, 'time@10': 9.8622}:  80%|████████  | 8/10 [00:55<00:15,  7.71s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3592, 'hit_ratio@10': 0.6934, 'ndcg@10': 0.6041, 'compress@10': 0.5224, 'time@10': 10.5433}:  80%|████████  | 8/10 [01:03<00:15,  7.71s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3592, 'hit_ratio@10': 0.6934, 'ndcg@10': 0.6041, 'compress@10': 0.5224, 'time@10': 10.5433}:  90%|█████████ | 9/10 [01:03<00:07,  7.81s/it{'epoch': 0, 'num_users': 6.3, 'loss': 0.3287, 'hit_ratio@10': 0.7173, 'ndcg@10': 0.6273, 'compress@10': 0.5213, 'time@10': 10.4967}:  90%|█████████ | 9/10 [01:13<00:07,  7.81s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3287, 'hit_ratio@10': 0.7173, 'ndcg@10': 0.6273, 'compress@10': 0.5213, 'time@10': 10.4967}: 100%|██████████| 10/10 [01:13<00:00,  8.52s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3287, 'hit_ratio@10': 0.7173, 'ndcg@10': 0.6273, 'compress@10': 0.5213, 'time@10': 10.4967}: 100%|██████████| 10/10 [01:13<00:00,  7.38s/EpocEpoch: 0
Avg # of users: 6.3
Avg Loss: 0.3286524475680182
Avg hit ratio: 0.7172798859318383
Avg ndcg: 0.6272525604768907
Avg compression ratio: 0.5212749006657823
Avg train time: 10.49674744606018
Std train time: 5.2883961784976785
[0.75, 0.25, 0.75, 0.75, 0.75, 0.25, 0.75, 0.25, 0.25, 0.25]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?i{'e{'epoch': 1, 'num_users': 7.0, 'loss': 0.0594, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8215, 'compress@10': 0.7632, 'time@10': 9.0507}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0594, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8215, 'compress@10': 0.7632, 'time@10': 9.0507}:  10%|█         | 1/10 [00:04<00:41,  4.56s{'e{'epoch': 1, 'num_users': 7.0, 'loss': 0.0564, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8352, 'compress@10': 0.5187, 'time@10': 7.944}:  10%|█         | 1/10 [00:11<00:41,  4.56s/it] {'epoch': 1, 'num_users': 7.0, 'loss': 0.0564, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8352, 'compress@10': 0.5187, 'time@10': 7.944}:  20%|██        | 2/10 [00:11<00:47,  5.92s/{'{'epoch': 1, 'num_users': 5.0, 'loss': 0.0489, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.7814, 'compress@10': 0.6077, 'time@10': 6.3319}:  20%|██        | 2/10 [00:13<00:47,  5.92s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0489, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.7814, 'compress@10': 0.6077, 'time@10': 6.3319}:  30%|███       | 3/10 [00:13<00:27,  3.94s/{'{'epoch': 1, 'num_users': 5.0, 'loss': 0.0495, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.7971, 'compress@10': 0.6455, 'time@10': 6.3354}:  30%|███       | 3/10 [00:19<00:27,  3.94s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0495, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.7971, 'compress@10': 0.6455, 'time@10': 6.3354}:  40%|████      | 4/10 [00:19<00:29,  4.91s/{'{'epoch': 1, 'num_users': 5.8, 'loss': 0.0571, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.7952, 'compress@10': 0.6674, 'time@10': 9.2533}:  40%|████      | 4/10 [00:29<00:29,  4.91s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0571, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.7952, 'compress@10': 0.6674, 'time@10': 9.2533}:  50%|█████     | 5/10 [00:29<00:34,  6.92s/{'{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0605, 'hit_ratio@10': 0.784, 'ndcg@10': 0.7978, 'compress@10': 0.6006, 'time@10': 9.3954}:  50%|█████     | 5/10 [00:40<00:34,  6.92s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0605, 'hit_ratio@10': 0.784, 'ndcg@10': 0.7978, 'compress@10': 0.6006, 'time@10': 9.3954}:  60%|██████    | 6/10 [00:40<00:32,  8.02s/it{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0582, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.808, 'compress@10': 0.6234, 'time@10': 9.6625}:  60%|██████    | 6/10 [00:45<00:32,  8.02s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0582, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.808, 'compress@10': 0.6234, 'time@10': 9.6625}:  70%|███████   | 7/10 [00:45<00:21,  7.25s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0556, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8166, 'compress@10': 0.5794, 'time@10': 9.4391}:  70%|███████   | 7/10 [00:53<00:21,  7.25s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0556, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8166, 'compress@10': 0.5794, 'time@10': 9.4391}:  80%|████████  | 8/10 [00:53<00:14,  7.46s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0535, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8273, 'compress@10': 0.5452, 'time@10': 9.9763}:  80%|████████  | 8/10 [01:00<00:14,  7.46s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0535, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8273, 'compress@10': 0.5452, 'time@10': 9.9763}:  90%|█████████ | 9/10 [01:00<00:07,  7.37s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0528, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8293, 'compress@10': 0.5174, 'time@10': 9.9594}:  90%|█████████ | 9/10 [01:10<00:07,  7.37s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0528, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8293, 'compress@10': 0.5174, 'time@10': 9.9594}: 100%|██████████| 10/10 [01:10<00:00,  8.13s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0528, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8293, 'compress@10': 0.5174, 'time@10': 9.9594}: 100%|██████████| 10/10 [01:10<00:00,  7.06s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05280129570725602
Avg hit ratio: 0.8224159519032185
Avg ndcg: 0.8292553910245282
Avg compression ratio: 0.5173535990694341
Avg train time: 9.959365081787109
Std train time: 4.642605174369619
[0.8333333333333334, 0.5, 0.5, 0.8333333333333334, 0.8333333333333334, 0.5, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8427, 'compress@10': 0.8421, 'time@10': 8.5039}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8427, 'compress@10': 0.8421, 'time@10': 8.5039}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.798, 'ndcg@10': 0.847, 'compress@10': 0.6791, 'time@10': 7.7953}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]  {'epoch': 2, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.798, 'ndcg@10': 0.847, 'compress@10': 0.6791, 'time@10': 7.7953}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8482, 'compress@10': 0.6432, 'time@10': 6.3274}:  20%|██        | 2/10 [00:13<00:47,  5.96s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8482, 'compress@10': 0.6432, 'time@10': 6.3274}:  30%|███       | 3/10 [00:13<00:28,  4.03s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0388, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8458, 'compress@10': 0.6922, 'time@10': 6.2673}:  30%|███       | 3/10 [00:19<00:28,  4.03s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0388, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8458, 'compress@10': 0.6922, 'time@10': 6.2673}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0482, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8346, 'compress@10': 0.7211, 'time@10': 8.7374}:  40%|████      | 4/10 [00:28<00:29,  4.86s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0482, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8346, 'compress@10': 0.7211, 'time@10': 8.7374}:  50%|█████     | 5/10 [00:28<00:32,  6.47s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0528, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8322, 'compress@10': 0.6861, 'time@10': 8.9924}:  50%|█████     | 5/10 [00:38<00:32,  6.47s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0528, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8322, 'compress@10': 0.6861, 'time@10': 8.9924}:  60%|██████    | 6/10 [00:38<00:31,  7.78s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0512, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8358, 'compress@10': 0.6624, 'time@10': 9.3234}:  60%|██████    | 6/10 [00:44<00:31,  7.78s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0512, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8358, 'compress@10': 0.6624, 'time@10': 9.3234}:  70%|███████   | 7/10 [00:44<00:21,  7.10s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.84, 'compress@10': 0.6034, 'time@10': 9.1289}:  70%|███████   | 7/10 [00:52<00:21,  7.10s/it]   {'epoch': 2, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.84, 'compress@10': 0.6034, 'time@10': 9.1289}:  80%|████████  | 8/10 [00:52<00:14,  7.32s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.049, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8497, 'compress@10': 0.5575, 'time@10': 9.6906}:  80%|████████  | 8/10 [00:59<00:14,  7.32s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.049, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8497, 'compress@10': 0.5575, 'time@10': 9.6906}:  90%|█████████ | 9/10 [00:59<00:07,  7.26s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8498, 'compress@10': 0.5203, 'time@10': 9.7065}:  90%|█████████ | 9/10 [01:09<00:07,  7.26s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8498, 'compress@10': 0.5203, 'time@10': 9.7065}: 100%|██████████| 10/10 [01:09<00:00,  8.07s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8498, 'compress@10': 0.5203, 'time@10': 9.7065}: 100%|██████████| 10/10 [01:09<00:00,  6.94s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.0489441812926801
Avg hit ratio: 0.8296791097979554
Avg ndcg: 0.849766670043201
Avg compression ratio: 0.520325842791
Avg train time: 9.706532835960388
Std train time: 4.09166216083112
[0.625, 0.625, 0.375, 0.875, 0.875, 0.625, 0.375, 0.125, 0.125, 0.375]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.6447, 'time@10': 8.68}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.6447, 'time@10': 8.68}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8524, 'compress@10': 0.6409, 'time@10': 7.9059}:  10%|█         | 1/10 [00:11<00:39,  4.38s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8524, 'compress@10': 0.6409, 'time@10': 7.9059}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.854, 'compress@10': 0.582, 'time@10': 6.493}:  20%|██        | 2/10 [00:13<00:48,  6.02s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.854, 'compress@10': 0.582, 'time@10': 6.493}:  30%|███       | 3/10 [00:13<00:28,  4.12s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8528, 'compress@10': 0.6564, 'time@10': 6.3845}:  30%|███       | 3/10 [00:19<00:28,  4.12s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8528, 'compress@10': 0.6564, 'time@10': 6.3845}:  40%|████      | 4/10 [00:19<00:29,  4.90s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8405, 'compress@10': 0.7006, 'time@10': 8.2831}:  40%|████      | 4/10 [00:27<00:29,  4.90s/it]  {'epoch': 3, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8405, 'compress@10': 0.7006, 'time@10': 8.2831}:  50%|█████     | 5/10 [00:27<00:30,  6.01s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0513, 'hit_ratio@10': 0.7797, 'ndcg@10': 0.8378, 'compress@10': 0.6894, 'time@10': 8.6171}:  50%|█████     | 5/10 [00:37<00:30,  6.01s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0513, 'hit_ratio@10': 0.7797, 'ndcg@10': 0.8378, 'compress@10': 0.6894, 'time@10': 8.6171}:  60%|██████    | 6/10 [00:37<00:29,  7.48s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.051, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.8427, 'compress@10': 0.6481, 'time@10': 9.019}:  60%|██████    | 6/10 [00:43<00:29,  7.48s/it]  {'epoch': 3, 'num_users': 6.2857, 'loss': 0.051, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.8427, 'compress@10': 0.6481, 'time@10': 9.019}:  70%|███████   | 7/10 [00:43<00:20,  6.91s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0522, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8399, 'compress@10': 0.5858, 'time@10': 8.8699}:  70%|███████   | 7/10 [00:51<00:20,  6.91s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0522, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8399, 'compress@10': 0.5858, 'time@10': 8.8699}:  80%|████████  | 8/10 [00:51<00:14,  7.22s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0522, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8507, 'compress@10': 0.5374, 'time@10': 9.4442}:  80%|████████  | 8/10 [00:58<00:14,  7.22s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0522, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8507, 'compress@10': 0.5374, 'time@10': 9.4442}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0515, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8502, 'compress@10': 0.5226, 'time@10': 9.5107}:  90%|█████████ | 9/10 [01:08<00:07,  7.16s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0515, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8502, 'compress@10': 0.5226, 'time@10': 9.5107}: 100%|██████████| 10/10 [01:08<00:00,  8.09s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0515, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8502, 'compress@10': 0.5226, 'time@10': 9.5107}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.0514710008065809
Avg hit ratio: 0.8284092685281141
Avg ndcg: 0.8502015355279777
Avg compression ratio: 0.5225593067173977
Avg train time: 9.510689234733581
Std train time: 3.4774498678812593
[0.5, 0.5, 0.3, 0.9, 0.9, 0.7, 0.3, 0.3, 0.3, 0.3]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8597, 'compress@10': 0.5263, 'time@10': 8.711}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8597, 'compress@10': 0.5263, 'time@10': 8.711}:  10%|█         | 1/10 [00:04<00:39,  4.40s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8564, 'compress@10': 0.5212, 'time@10': 8.0262}:  10%|█         | 1/10 [00:11<00:39,  4.40s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8564, 'compress@10': 0.5212, 'time@10': 8.0262}:  20%|██        | 2/10 [00:11<00:49,  6.15s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8567, 'compress@10': 0.4808, 'time@10': 6.6545}:  20%|██        | 2/10 [00:13<00:49,  6.15s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8567, 'compress@10': 0.4808, 'time@10': 6.6545}:  30%|███       | 3/10 [00:13<00:29,  4.25s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8463, 'compress@10': 0.5865, 'time@10': 6.4402}:  30%|███       | 3/10 [00:19<00:29,  4.25s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8463, 'compress@10': 0.5865, 'time@10': 6.4402}:  40%|████      | 4/10 [00:19<00:29,  4.88s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0482, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8342, 'compress@10': 0.6496, 'time@10': 7.8191}:  40%|████      | 4/10 [00:26<00:29,  4.88s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0482, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8342, 'compress@10': 0.6496, 'time@10': 7.8191}:  50%|█████     | 5/10 [00:26<00:27,  5.54s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0513, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.8332, 'compress@10': 0.6591, 'time@10': 8.2511}:  50%|█████     | 5/10 [00:36<00:27,  5.54s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0513, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.8332, 'compress@10': 0.6591, 'time@10': 8.2511}:  60%|██████    | 6/10 [00:36<00:28,  7.21s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0498, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8384, 'compress@10': 0.6118, 'time@10': 8.7059}:  60%|██████    | 6/10 [00:42<00:28,  7.21s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0498, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8384, 'compress@10': 0.6118, 'time@10': 8.7059}:  70%|███████   | 7/10 [00:42<00:20,  6.73s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8376, 'compress@10': 0.5753, 'time@10': 8.6219}:  70%|███████   | 7/10 [00:50<00:20,  6.73s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8376, 'compress@10': 0.5753, 'time@10': 8.6219}:  80%|████████  | 8/10 [00:50<00:14,  7.16s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.845, 'compress@10': 0.547, 'time@10': 9.2808}:  80%|████████  | 8/10 [00:57<00:14,  7.16s/it] {'epoch': 4, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.845, 'compress@10': 0.547, 'time@10': 9.2808}:  90%|█████████ | 9/10 [00:57<00:07,  7.21s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0492, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.845, 'compress@10': 0.5239, 'time@10': 9.3681}:  90%|█████████ | 9/10 [01:08<00:07,  7.21s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.0492, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.845, 'compress@10': 0.5239, 'time@10': 9.3681}: 100%|██████████| 10/10 [01:08<00:00,  8.13s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0492, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.845, 'compress@10': 0.5239, 'time@10': 9.3681}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.049174578615134724
Avg hit ratio: 0.834571582916235
Avg ndcg: 0.8449956877736117
Avg compression ratio: 0.5238566329240474
Avg train time: 9.368050718307495
Std train time: 3.1214656912642056
[0.4166666666666667, 0.5833333333333334, 0.25, 0.9166666666666667, 0.9166666666666667, 0.75, 0.25, 0.41666666666666663, 0.25, 0.25]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8502, 'compress@10': 0.4474, 'time@10': 8.6297}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8502, 'compress@10': 0.4474, 'time@10': 8.6297}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8488, 'compress@10': 0.5221, 'time@10': 7.9677}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it]  {'epoch': 5, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8488, 'compress@10': 0.5221, 'time@10': 7.9677}:  20%|██        | 2/10 [00:11<00:48,  6.11s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8516, 'compress@10': 0.4671, 'time@10': 6.7859}:  20%|██        | 2/10 [00:13<00:48,  6.11s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8516, 'compress@10': 0.4671, 'time@10': 6.7859}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.7561, 'ndcg@10': 0.8444, 'compress@10': 0.5802, 'time@10': 6.5589}:  30%|███       | 3/10 [00:19<00:30,  4.35s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.7561, 'ndcg@10': 0.8444, 'compress@10': 0.5802, 'time@10': 6.5589}:  40%|████      | 4/10 [00:19<00:29,  4.97s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0467, 'hit_ratio@10': 0.7729, 'ndcg@10': 0.8327, 'compress@10': 0.6478, 'time@10': 7.8773}:  40%|████      | 4/10 [00:26<00:29,  4.97s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0467, 'hit_ratio@10': 0.7729, 'ndcg@10': 0.8327, 'compress@10': 0.6478, 'time@10': 7.8773}:  50%|█████     | 5/10 [00:26<00:27,  5.56s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0493, 'hit_ratio@10': 0.7848, 'ndcg@10': 0.8323, 'compress@10': 0.6658, 'time@10': 8.2885}:  50%|█████     | 5/10 [00:36<00:27,  5.56s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0493, 'hit_ratio@10': 0.7848, 'ndcg@10': 0.8323, 'compress@10': 0.6658, 'time@10': 8.2885}:  60%|██████    | 6/10 [00:36<00:28,  7.20s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.049, 'hit_ratio@10': 0.8098, 'ndcg@10': 0.8401, 'compress@10': 0.6107, 'time@10': 8.6987}:  60%|██████    | 6/10 [00:42<00:28,  7.20s/it] {'epoch': 5, 'num_users': 6.2857, 'loss': 0.049, 'hit_ratio@10': 0.8098, 'ndcg@10': 0.8401, 'compress@10': 0.6107, 'time@10': 8.6987}:  70%|███████   | 7/10 [00:42<00:20,  6.68s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0485, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8422, 'compress@10': 0.5885, 'time@10': 8.6212}:  70%|███████   | 7/10 [00:50<00:20,  6.68s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0485, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8422, 'compress@10': 0.5885, 'time@10': 8.6212}:  80%|████████  | 8/10 [00:50<00:14,  7.14s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8543, 'compress@10': 0.5533, 'time@10': 9.2617}:  80%|████████  | 8/10 [00:57<00:14,  7.14s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8543, 'compress@10': 0.5533, 'time@10': 9.2617}:  90%|█████████ | 9/10 [00:57<00:07,  7.17s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0479, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8541, 'compress@10': 0.5247, 'time@10': 9.3336}:  90%|█████████ | 9/10 [01:07<00:07,  7.17s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0479, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8541, 'compress@10': 0.5247, 'time@10': 9.3336}: 100%|██████████| 10/10 [01:07<00:00,  8.05s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0479, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8541, 'compress@10': 0.5247, 'time@10': 9.3336}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.047921361170451406
Avg hit ratio: 0.834361649480495
Avg ndcg: 0.8540504684412493
Avg compression ratio: 0.5246573356718763
Avg train time: 9.333637523651124
Std train time: 2.951677923775012
[0.5, 0.5, 0.2142857142857143, 0.9285714285714286, 0.9285714285714286, 0.7857142857142857, 0.2142857142857143, 0.3571428571428571, 0.35714285714285715, 0.2142857142857143]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8571, 'compress@10': 0.5263, 'time@10': 8.7437}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8571, 'compress@10': 0.5263, 'time@10': 8.7437}:  10%|█         | 1/10 [00:04<00:39,  4.42s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8567, 'compress@10': 0.5212, 'time@10': 8.0669}:  10%|█         | 1/10 [00:11<00:39,  4.42s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8567, 'compress@10': 0.5212, 'time@10': 8.0669}:  20%|██        | 2/10 [00:11<00:49,  6.19s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8568, 'compress@10': 0.4563, 'time@10': 6.9629}:  20%|██        | 2/10 [00:14<00:49,  6.19s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8568, 'compress@10': 0.4563, 'time@10': 6.9629}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8504, 'compress@10': 0.575, 'time@10': 6.6648}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8504, 'compress@10': 0.575, 'time@10': 6.6648}:  40%|████      | 4/10 [00:20<00:29,  5.00s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0434, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8372, 'compress@10': 0.646, 'time@10': 7.9228}:  40%|████      | 4/10 [00:26<00:29,  5.00s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0434, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8372, 'compress@10': 0.646, 'time@10': 7.9228}:  50%|█████     | 5/10 [00:26<00:27,  5.54s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0458, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8379, 'compress@10': 0.6701, 'time@10': 8.3379}:  50%|█████     | 5/10 [00:37<00:27,  5.54s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0458, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8379, 'compress@10': 0.6701, 'time@10': 8.3379}:  60%|██████    | 6/10 [00:37<00:28,  7.21s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0466, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8347, 'compress@10': 0.6095, 'time@10': 8.7243}:  60%|██████    | 6/10 [00:42<00:28,  7.21s/it]  {'epoch': 6, 'num_users': 6.2857, 'loss': 0.0466, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8347, 'compress@10': 0.6095, 'time@10': 8.7243}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0461, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8385, 'compress@10': 0.5802, 'time@10': 8.644}:  70%|███████   | 7/10 [00:50<00:20,  6.67s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0461, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8385, 'compress@10': 0.5802, 'time@10': 8.644}:  80%|████████  | 8/10 [00:50<00:14,  7.13s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0491, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8528, 'compress@10': 0.5575, 'time@10': 9.2799}:  80%|████████  | 8/10 [00:57<00:14,  7.13s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0491, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8528, 'compress@10': 0.5575, 'time@10': 9.2799}:  90%|█████████ | 9/10 [00:57<00:07,  7.16s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.8539, 'compress@10': 0.5249, 'time@10': 9.3548}:  90%|█████████ | 9/10 [01:08<00:07,  7.16s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.8539, 'compress@10': 0.5249, 'time@10': 9.3548}: 100%|██████████| 10/10 [01:08<00:00,  8.06s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.8539, 'compress@10': 0.5249, 'time@10': 9.3548}: 100%|██████████| 10/10 [01:08<00:00,  6.80s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04857496307461996
Avg hit ratio: 0.8618796404500989
Avg ndcg: 0.853900042155159
Avg compression ratio: 0.5249421151990776
Avg train time: 9.354847192764282
Std train time: 2.8700149267008332
[0.4375, 0.4375, 0.1875, 0.9375, 0.9375, 0.8125, 0.3125, 0.31249999999999994, 0.4375, 0.1875]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8661, 'compress@10': 0.4671, 'time@10': 8.6228}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8661, 'compress@10': 0.4671, 'time@10': 8.6228}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0448, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8608, 'compress@10': 0.4614, 'time@10': 7.8661}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0448, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8608, 'compress@10': 0.4614, 'time@10': 7.8661}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8596, 'compress@10': 0.4088, 'time@10': 6.8283}:  20%|██        | 2/10 [00:13<00:47,  5.99s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8596, 'compress@10': 0.4088, 'time@10': 6.8283}:  30%|███       | 3/10 [00:13<00:30,  4.36s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8526, 'compress@10': 0.5415, 'time@10': 6.5583}:  30%|███       | 3/10 [00:19<00:30,  4.36s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8526, 'compress@10': 0.5415, 'time@10': 6.5583}:  40%|████      | 4/10 [00:19<00:29,  4.92s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0428, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8403, 'compress@10': 0.621, 'time@10': 7.7615}:  40%|████      | 4/10 [00:26<00:29,  4.92s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.0428, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8403, 'compress@10': 0.621, 'time@10': 7.7615}:  50%|█████     | 5/10 [00:26<00:27,  5.43s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0446, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.841, 'compress@10': 0.6536, 'time@10': 8.1618}:  50%|█████     | 5/10 [00:36<00:27,  5.43s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0446, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.841, 'compress@10': 0.6536, 'time@10': 8.1618}:  60%|██████    | 6/10 [00:36<00:28,  7.05s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0448, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8471, 'compress@10': 0.6088, 'time@10': 8.583}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0448, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8471, 'compress@10': 0.6088, 'time@10': 8.583}:  70%|███████   | 7/10 [00:41<00:19,  6.57s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0435, 'hit_ratio@10': 0.882, 'ndcg@10': 0.8507, 'compress@10': 0.5742, 'time@10': 8.51}:  70%|███████   | 7/10 [00:49<00:19,  6.57s/it]   {'epoch': 7, 'num_users': 6.125, 'loss': 0.0435, 'hit_ratio@10': 0.882, 'ndcg@10': 0.8507, 'compress@10': 0.5742, 'time@10': 8.51}:  80%|████████  | 8/10 [00:49<00:14,  7.04s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0441, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8551, 'compress@10': 0.5608, 'time@10': 9.203}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0441, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8551, 'compress@10': 0.5608, 'time@10': 9.203}:  90%|█████████ | 9/10 [00:57<00:07,  7.15s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0432, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8565, 'compress@10': 0.5253, 'time@10': 9.2678}:  90%|█████████ | 9/10 [01:07<00:07,  7.15s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0432, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8565, 'compress@10': 0.5253, 'time@10': 9.2678}: 100%|██████████| 10/10 [01:07<00:00,  8.00s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0432, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8565, 'compress@10': 0.5253, 'time@10': 9.2678}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.0431582002100976
Avg hit ratio: 0.873035484605943
Avg ndcg: 0.8564770462322917
Avg compression ratio: 0.5253122607226445
Avg train time: 9.26784257888794
Std train time: 2.914643238432389
[0.5, 0.3888888888888889, 0.16666666666666666, 0.9444444444444444, 0.9444444444444444, 0.8333333333333334, 0.2777777777777778, 0.27777777777777773, 0.5, 0.16666666666666666]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8459, 'compress@10': 0.5263, 'time@10': 8.5643}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8459, 'compress@10': 0.5263, 'time@10': 8.5643}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8548, 'compress@10': 0.4675, 'time@10': 7.975}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8548, 'compress@10': 0.4675, 'time@10': 7.975}:  20%|██        | 2/10 [00:11<00:49,  6.14s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8556, 'compress@10': 0.4069, 'time@10': 7.0435}:  20%|██        | 2/10 [00:14<00:49,  6.14s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8556, 'compress@10': 0.4069, 'time@10': 7.0435}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8508, 'compress@10': 0.5418, 'time@10': 6.7108}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8508, 'compress@10': 0.5418, 'time@10': 6.7108}:  40%|████      | 4/10 [00:20<00:30,  5.02s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0408, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8391, 'compress@10': 0.6225, 'time@10': 7.8795}:  40%|████      | 4/10 [00:26<00:30,  5.02s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0408, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8391, 'compress@10': 0.6225, 'time@10': 7.8795}:  50%|█████     | 5/10 [00:26<00:27,  5.48s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0422, 'hit_ratio@10': 0.842, 'ndcg@10': 0.841, 'compress@10': 0.6583, 'time@10': 8.2696}:  50%|█████     | 5/10 [00:36<00:27,  5.48s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0422, 'hit_ratio@10': 0.842, 'ndcg@10': 0.841, 'compress@10': 0.6583, 'time@10': 8.2696}:  60%|██████    | 6/10 [00:36<00:28,  7.11s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0415, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8419, 'compress@10': 0.608, 'time@10': 8.6936}:  60%|██████    | 6/10 [00:42<00:28,  7.11s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0415, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8419, 'compress@10': 0.608, 'time@10': 8.6936}:  70%|███████   | 7/10 [00:42<00:19,  6.63s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0406, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8464, 'compress@10': 0.5693, 'time@10': 8.6033}:  70%|███████   | 7/10 [00:50<00:19,  6.63s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0406, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8464, 'compress@10': 0.5693, 'time@10': 8.6033}:  80%|████████  | 8/10 [00:50<00:14,  7.07s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0415, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8687, 'compress@10': 0.5632, 'time@10': 9.2774}:  80%|████████  | 8/10 [00:57<00:14,  7.07s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0415, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8687, 'compress@10': 0.5632, 'time@10': 9.2774}:  90%|█████████ | 9/10 [00:57<00:07,  7.16s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.041, 'hit_ratio@10': 0.871, 'ndcg@10': 0.872, 'compress@10': 0.5255, 'time@10': 9.3207}:  90%|█████████ | 9/10 [01:07<00:07,  7.16s/it]      {'epoch': 8, 'num_users': 6.3, 'loss': 0.041, 'hit_ratio@10': 0.871, 'ndcg@10': 0.872, 'compress@10': 0.5255, 'time@10': 9.3207}: 100%|██████████| 10/10 [01:07<00:00,  7.96s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.041, 'hit_ratio@10': 0.871, 'ndcg@10': 0.872, 'compress@10': 0.5255, 'time@10': 9.3207}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04098707835583697
Avg hit ratio: 0.8709590055294638
Avg ndcg: 0.8719844345172222
Avg compression ratio: 0.5254598405755102
Avg train time: 9.320735096931458
Std train time: 2.828423544733158
[0.55, 0.35, 0.15, 0.95, 0.95, 0.8500000000000001, 0.25, 0.24999999999999997, 0.55, 0.15]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8441, 'compress@10': 0.5737, 'time@10': 8.8766}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8441, 'compress@10': 0.5737, 'time@10': 8.8766}:  10%|█         | 1/10 [00:04<00:40,  4.47s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8617, 'compress@10': 0.4723, 'time@10': 7.9617}:  10%|█         | 1/10 [00:11<00:40,  4.47s/it] {'epoch': 9, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8617, 'compress@10': 0.4723, 'time@10': 7.9617}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8602, 'compress@10': 0.4054, 'time@10': 6.9048}:  20%|██        | 2/10 [00:13<00:48,  6.01s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8602, 'compress@10': 0.4054, 'time@10': 6.9048}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8541, 'compress@10': 0.542, 'time@10': 6.645}:  30%|███       | 3/10 [00:19<00:30,  4.37s/it]  {'epoch': 9, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8541, 'compress@10': 0.542, 'time@10': 6.645}:  40%|████      | 4/10 [00:19<00:29,  4.98s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0407, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8424, 'compress@10': 0.6238, 'time@10': 7.8699}:  40%|████      | 4/10 [00:26<00:29,  4.98s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0407, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8424, 'compress@10': 0.6238, 'time@10': 7.8699}:  50%|█████     | 5/10 [00:26<00:27,  5.50s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0415, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8443, 'compress@10': 0.662, 'time@10': 8.2689}:  50%|█████     | 5/10 [00:36<00:27,  5.50s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0415, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8443, 'compress@10': 0.662, 'time@10': 8.2689}:  60%|██████    | 6/10 [00:36<00:28,  7.13s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0412, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8519, 'compress@10': 0.6075, 'time@10': 8.7176}:  60%|██████    | 6/10 [00:42<00:28,  7.13s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0412, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8519, 'compress@10': 0.6075, 'time@10': 8.7176}:  70%|███████   | 7/10 [00:42<00:20,  6.68s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0407, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8514, 'compress@10': 0.5654, 'time@10': 8.6406}:  70%|███████   | 7/10 [00:50<00:20,  6.68s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0407, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8514, 'compress@10': 0.5654, 'time@10': 8.6406}:  80%|████████  | 8/10 [00:50<00:14,  7.15s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.04, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8589, 'compress@10': 0.5652, 'time@10': 9.2997}:  80%|████████  | 8/10 [00:57<00:14,  7.15s/it] {'epoch': 9, 'num_users': 6.3333, 'loss': 0.04, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8589, 'compress@10': 0.5652, 'time@10': 9.2997}:  90%|█████████ | 9/10 [00:57<00:07,  7.20s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0396, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8591, 'compress@10': 0.5256, 'time@10': 9.2841}:  90%|█████████ | 9/10 [01:07<00:07,  7.20s/it] {'epoch': 9, 'num_users': 6.3, 'loss': 0.0396, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8591, 'compress@10': 0.5256, 'time@10': 9.2841}: 100%|██████████| 10/10 [01:07<00:00,  7.81s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0396, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8591, 'compress@10': 0.5256, 'time@10': 9.2841}: 100%|██████████| 10/10 [01:07<00:00,  6.70s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.039629840409384845
Avg hit ratio: 0.8572216783405239
Avg ndcg: 0.8590758787065654
Avg compression ratio: 0.525577058520048
Avg train time: 9.28407986164093
Std train time: 2.8992004019612234
[0.5909090909090909, 0.3181818181818182, 0.13636363636363635, 0.9545454545454545, 0.9545454545454545, 0.8636363636363638, 0.3181818181818182, 0.22727272727272724, 0.5, 0.13636363636363635]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8551, 'compress@10': 0.6124, 'time@10': 8.86}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8551, 'compress@10': 0.6124, 'time@10': 8.86}:  10%|█         | 1/10 [00:04<00:40,  4.47s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0392, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8694, 'compress@10': 0.4763, 'time@10': 8.0211}:  10%|█         | 1/10 [00:11<00:40,  4.47s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0392, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8694, 'compress@10': 0.4763, 'time@10': 8.0211}:  20%|██        | 2/10 [00:11<00:48,  6.09s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8653, 'compress@10': 0.4041, 'time@10': 6.95}:  20%|██        | 2/10 [00:14<00:48,  6.09s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8653, 'compress@10': 0.4041, 'time@10': 6.95}:  30%|███       | 3/10 [00:14<00:30,  4.43s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8558, 'compress@10': 0.5421, 'time@10': 6.6532}:  30%|███       | 3/10 [00:19<00:30,  4.43s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8558, 'compress@10': 0.5421, 'time@10': 6.6532}:  40%|████      | 4/10 [00:19<00:29,  4.97s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.039, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.845, 'compress@10': 0.6248, 'time@10': 7.9705}:  40%|████      | 4/10 [00:26<00:29,  4.97s/it]  {'epoch': 10, 'num_users': 5.8, 'loss': 0.039, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.845, 'compress@10': 0.6248, 'time@10': 7.9705}:  50%|█████     | 5/10 [00:26<00:27,  5.58s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0392, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8468, 'compress@10': 0.6651, 'time@10': 8.3273}:  50%|█████     | 5/10 [00:36<00:27,  5.58s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0392, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8468, 'compress@10': 0.6651, 'time@10': 8.3273}:  60%|██████    | 6/10 [00:36<00:28,  7.13s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0382, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.848, 'compress@10': 0.6194, 'time@10': 8.7438}:  60%|██████    | 6/10 [00:42<00:28,  7.13s/it] {'epoch': 10, 'num_users': 6.2857, 'loss': 0.0382, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.848, 'compress@10': 0.6194, 'time@10': 8.7438}:  70%|███████   | 7/10 [00:42<00:19,  6.65s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0369, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8544, 'compress@10': 0.5732, 'time@10': 8.646}:  70%|███████   | 7/10 [00:50<00:19,  6.65s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0369, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8544, 'compress@10': 0.5732, 'time@10': 8.646}:  80%|████████  | 8/10 [00:50<00:14,  7.08s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0354, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8625, 'compress@10': 0.5666, 'time@10': 9.3282}:  80%|████████  | 8/10 [00:57<00:14,  7.08s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0354, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8625, 'compress@10': 0.5666, 'time@10': 9.3282}:  90%|█████████ | 9/10 [00:57<00:07,  7.19s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0339, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.868, 'compress@10': 0.5256, 'time@10': 9.3188}:  90%|█████████ | 9/10 [01:07<00:07,  7.19s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0339, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.868, 'compress@10': 0.5256, 'time@10': 9.3188}: 100%|██████████| 10/10 [01:07<00:00,  7.83s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0339, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.868, 'compress@10': 0.5256, 'time@10': 9.3188}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03385658275341305
Avg hit ratio: 0.857351548470394
Avg ndcg: 0.8679858402080207
Avg compression ratio: 0.5255708305953786
Avg train time: 9.318811845779418
Std train time: 2.986654553238273
[0.625, 0.2916666666666667, 0.12499999999999999, 0.9583333333333333, 0.9583333333333333, 0.8750000000000001, 0.375, 0.20833333333333331, 0.4583333333333333, 0.12499999999999999]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8505, 'compress@10': 0.6447, 'time@10': 8.6597}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8505, 'compress@10': 0.6447, 'time@10': 8.6597}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8692, 'compress@10': 0.4796, 'time@10': 7.8782}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8692, 'compress@10': 0.4796, 'time@10': 7.8782}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8652, 'compress@10': 0.4031, 'time@10': 7.1027}:  20%|██        | 2/10 [00:14<00:47,  6.00s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8652, 'compress@10': 0.4031, 'time@10': 7.1027}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8489, 'compress@10': 0.5423, 'time@10': 6.7969}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8489, 'compress@10': 0.5423, 'time@10': 6.7969}:  40%|████      | 4/10 [00:20<00:30,  5.09s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8411, 'compress@10': 0.6256, 'time@10': 8.063}:  40%|████      | 4/10 [00:26<00:30,  5.09s/it] {'epoch': 11, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8411, 'compress@10': 0.6256, 'time@10': 8.063}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.038, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8447, 'compress@10': 0.6677, 'time@10': 8.4617}:  50%|█████     | 5/10 [00:37<00:28,  5.63s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.038, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8447, 'compress@10': 0.6677, 'time@10': 8.4617}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0374, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8539, 'compress@10': 0.6294, 'time@10': 8.8941}:  60%|██████    | 6/10 [00:43<00:29,  7.29s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0374, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8539, 'compress@10': 0.6294, 'time@10': 8.8941}:  70%|███████   | 7/10 [00:43<00:20,  6.80s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0362, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8593, 'compress@10': 0.5796, 'time@10': 8.771}:  70%|███████   | 7/10 [00:51<00:20,  6.80s/it]  {'epoch': 11, 'num_users': 6.125, 'loss': 0.0362, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8593, 'compress@10': 0.5796, 'time@10': 8.771}:  80%|████████  | 8/10 [00:51<00:14,  7.16s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0348, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8675, 'compress@10': 0.5679, 'time@10': 9.4693}:  80%|████████  | 8/10 [00:58<00:14,  7.16s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0348, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8675, 'compress@10': 0.5679, 'time@10': 9.4693}:  90%|█████████ | 9/10 [00:58<00:07,  7.29s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.874, 'ndcg@10': 0.868, 'compress@10': 0.5256, 'time@10': 9.4611}:  90%|█████████ | 9/10 [01:08<00:07,  7.29s/it]     {'epoch': 11, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.874, 'ndcg@10': 0.868, 'compress@10': 0.5256, 'time@10': 9.4611}: 100%|██████████| 10/10 [01:08<00:00,  7.95s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.874, 'ndcg@10': 0.868, 'compress@10': 0.5256, 'time@10': 9.4611}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03504318709908243
Avg hit ratio: 0.8739554213000732
Avg ndcg: 0.8680290721956536
Avg compression ratio: 0.5255640174732801
Avg train time: 9.461091661453247
Std train time: 2.942747680376681
[0.6538461538461539, 0.2692307692307693, 0.11538461538461538, 0.9615384615384615, 0.9615384615384615, 0.8846153846153847, 0.34615384615384615, 0.1923076923076923, 0.4230769230769231, 0.1923076923076923]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8637, 'compress@10': 0.6721, 'time@10': 8.784}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8637, 'compress@10': 0.6721, 'time@10': 8.784}:  10%|█         | 1/10 [00:04<00:39,  4.44s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8795, 'compress@10': 0.4824, 'time@10': 7.9227}:  10%|█         | 1/10 [00:11<00:39,  4.44s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8795, 'compress@10': 0.4824, 'time@10': 7.9227}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.872, 'compress@10': 0.4022, 'time@10': 7.1441}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.872, 'compress@10': 0.4022, 'time@10': 7.1441}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8665, 'compress@10': 0.5424, 'time@10': 6.7925}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8665, 'compress@10': 0.5424, 'time@10': 6.7925}:  40%|████      | 4/10 [00:20<00:30,  5.05s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0336, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8548, 'compress@10': 0.6264, 'time@10': 7.9936}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0336, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8548, 'compress@10': 0.6264, 'time@10': 7.9936}:  50%|█████     | 5/10 [00:26<00:27,  5.55s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0351, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8562, 'compress@10': 0.6698, 'time@10': 8.3524}:  50%|█████     | 5/10 [00:36<00:27,  5.55s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0351, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8562, 'compress@10': 0.6698, 'time@10': 8.3524}:  60%|██████    | 6/10 [00:36<00:28,  7.12s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0353, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.862, 'compress@10': 0.6273, 'time@10': 8.7177}:  60%|██████    | 6/10 [00:42<00:28,  7.12s/it] {'epoch': 12, 'num_users': 6.2857, 'loss': 0.0353, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.862, 'compress@10': 0.6273, 'time@10': 8.7177}:  70%|███████   | 7/10 [00:42<00:19,  6.59s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0339, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.868, 'compress@10': 0.5758, 'time@10': 8.6219}:  70%|███████   | 7/10 [00:50<00:19,  6.59s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0339, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.868, 'compress@10': 0.5758, 'time@10': 8.6219}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0338, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8792, 'compress@10': 0.5607, 'time@10': 9.2497}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0338, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8792, 'compress@10': 0.5607, 'time@10': 9.2497}:  90%|█████████ | 9/10 [00:57<00:07,  7.08s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8845, 'compress@10': 0.5257, 'time@10': 9.2739}:  90%|█████████ | 9/10 [01:06<00:07,  7.08s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8845, 'compress@10': 0.5257, 'time@10': 9.2739}: 100%|██████████| 10/10 [01:06<00:00,  7.84s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8845, 'compress@10': 0.5257, 'time@10': 9.2739}: 100%|██████████| 10/10 [01:06<00:00,  6.70s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03178965984171157
Avg hit ratio: 0.8765297358743878
Avg ndcg: 0.8845135423019318
Avg compression ratio: 0.5256917795390971
Avg train time: 9.273941206932069
Std train time: 2.7179587411775317
[0.6785714285714286, 0.25000000000000006, 0.10714285714285714, 0.9642857142857142, 0.9642857142857142, 0.8928571428571429, 0.39285714285714285, 0.17857142857142855, 0.39285714285714285, 0.17857142857142855]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8639, 'compress@10': 0.6955, 'time@10': 8.8309}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8639, 'compress@10': 0.6955, 'time@10': 8.8309}:  10%|█         | 1/10 [00:04<00:40,  4.45s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8818, 'compress@10': 0.4848, 'time@10': 7.8559}:  10%|█         | 1/10 [00:11<00:40,  4.45s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8818, 'compress@10': 0.4848, 'time@10': 7.8559}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8736, 'compress@10': 0.4015, 'time@10': 7.0047}:  20%|██        | 2/10 [00:14<00:47,  5.90s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8736, 'compress@10': 0.4015, 'time@10': 7.0047}:  30%|███       | 3/10 [00:14<00:31,  4.44s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8715, 'compress@10': 0.5425, 'time@10': 6.6932}:  30%|███       | 3/10 [00:19<00:31,  4.44s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8715, 'compress@10': 0.5425, 'time@10': 6.6932}:  40%|████      | 4/10 [00:19<00:29,  4.97s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0316, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8581, 'compress@10': 0.627, 'time@10': 7.9222}:  40%|████      | 4/10 [00:26<00:29,  4.97s/it] {'epoch': 13, 'num_users': 5.8, 'loss': 0.0316, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8581, 'compress@10': 0.627, 'time@10': 7.9222}:  50%|█████     | 5/10 [00:26<00:27,  5.51s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0326, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8633, 'compress@10': 0.6717, 'time@10': 8.312}:  50%|█████     | 5/10 [00:36<00:27,  5.51s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0326, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8633, 'compress@10': 0.6717, 'time@10': 8.312}:  60%|██████    | 6/10 [00:36<00:28,  7.14s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0327, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.8638, 'compress@10': 0.6353, 'time@10': 8.7435}:  60%|██████    | 6/10 [00:42<00:28,  7.14s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0327, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.8638, 'compress@10': 0.6353, 'time@10': 8.7435}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0322, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.8664, 'compress@10': 0.5812, 'time@10': 8.6498}:  70%|███████   | 7/10 [00:50<00:20,  6.67s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0322, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.8664, 'compress@10': 0.5812, 'time@10': 8.6498}:  80%|████████  | 8/10 [00:50<00:14,  7.10s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.883, 'compress@10': 0.5622, 'time@10': 9.338}:  80%|████████  | 8/10 [00:57<00:14,  7.10s/it] {'epoch': 13, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.883, 'compress@10': 0.5622, 'time@10': 9.338}:  90%|█████████ | 9/10 [00:57<00:07,  7.21s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.8819, 'compress@10': 0.5257, 'time@10': 9.3594}:  90%|█████████ | 9/10 [01:07<00:07,  7.21s/it] {'epoch': 13, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.8819, 'compress@10': 0.5257, 'time@10': 9.3594}: 100%|██████████| 10/10 [01:07<00:00,  7.95s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.8819, 'compress@10': 0.5257, 'time@10': 9.3594}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03254400600662633
Avg hit ratio: 0.8828284371730891
Avg ndcg: 0.8818847173607631
Avg compression ratio: 0.5256763410079536
Avg train time: 9.359378385543824
Std train time: 2.9091967962839416
[0.7000000000000001, 0.2333333333333334, 0.09999999999999999, 0.9666666666666666, 0.9666666666666666, 0.9, 0.36666666666666664, 0.16666666666666666, 0.36666666666666664, 0.2333333333333333]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8372, 'compress@10': 0.7158, 'time@10': 8.6068}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8372, 'compress@10': 0.7158, 'time@10': 8.6068}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8747, 'compress@10': 0.4869, 'time@10': 7.6666}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8747, 'compress@10': 0.4869, 'time@10': 7.6666}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8689, 'compress@10': 0.4008, 'time@10': 6.9453}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8689, 'compress@10': 0.4008, 'time@10': 6.9453}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8651, 'compress@10': 0.5426, 'time@10': 6.6588}:  30%|███       | 3/10 [00:19<00:30,  4.41s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8651, 'compress@10': 0.5426, 'time@10': 6.6588}:  40%|████      | 4/10 [00:19<00:29,  4.97s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0318, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8568, 'compress@10': 0.6275, 'time@10': 7.875}:  40%|████      | 4/10 [00:26<00:29,  4.97s/it] {'epoch': 14, 'num_users': 5.8, 'loss': 0.0318, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8568, 'compress@10': 0.6275, 'time@10': 7.875}:  50%|█████     | 5/10 [00:26<00:27,  5.50s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0305, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8652, 'compress@10': 0.6733, 'time@10': 8.2835}:  50%|█████     | 5/10 [00:36<00:27,  5.50s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0305, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8652, 'compress@10': 0.6733, 'time@10': 8.2835}:  60%|██████    | 6/10 [00:36<00:28,  7.15s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8711, 'compress@10': 0.6331, 'time@10': 8.738}:  60%|██████    | 6/10 [00:42<00:28,  7.15s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8711, 'compress@10': 0.6331, 'time@10': 8.738}:  70%|███████   | 7/10 [00:42<00:20,  6.70s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8743, 'compress@10': 0.5778, 'time@10': 8.6371}:  70%|███████   | 7/10 [00:50<00:20,  6.70s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8743, 'compress@10': 0.5778, 'time@10': 8.6371}:  80%|████████  | 8/10 [00:50<00:14,  7.10s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0294, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8952, 'compress@10': 0.5563, 'time@10': 9.2708}:  80%|████████  | 8/10 [00:57<00:14,  7.10s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0294, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8952, 'compress@10': 0.5563, 'time@10': 9.2708}:  90%|█████████ | 9/10 [00:57<00:07,  7.14s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8999, 'compress@10': 0.5258, 'time@10': 9.306}:  90%|█████████ | 9/10 [01:07<00:07,  7.14s/it]    {'epoch': 14, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8999, 'compress@10': 0.5258, 'time@10': 9.306}: 100%|██████████| 10/10 [01:07<00:00,  7.92s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8999, 'compress@10': 0.5258, 'time@10': 9.306}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.02761380777302048
Avg hit ratio: 0.8842440215886734
Avg ndcg: 0.89991725657104
Avg compression ratio: 0.5257801147975398
Avg train time: 9.3059752702713
Std train time: 2.8060418307031365
[0.7187500000000001, 0.28125000000000006, 0.09374999999999999, 0.9687499999999999, 0.9687499999999999, 0.84375, 0.34375, 0.15625, 0.40625, 0.21874999999999997]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0346, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8568, 'compress@10': 0.7335, 'time@10': 8.8579}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0346, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8568, 'compress@10': 0.7335, 'time@10': 8.8579}:  10%|█         | 1/10 [00:04<00:40,  4.47s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8816, 'compress@10': 0.519, 'time@10': 7.8547}:  10%|█         | 1/10 [00:11<00:40,  4.47s/it] {'epoch': 15, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8816, 'compress@10': 0.519, 'time@10': 7.8547}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8734, 'compress@10': 0.4204, 'time@10': 7.0895}:  20%|██        | 2/10 [00:14<00:47,  5.89s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8734, 'compress@10': 0.4204, 'time@10': 7.0895}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8624, 'compress@10': 0.5578, 'time@10': 6.7219}:  30%|███       | 3/10 [00:19<00:31,  4.49s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8624, 'compress@10': 0.5578, 'time@10': 6.7219}:  40%|████      | 4/10 [00:19<00:29,  4.95s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0285, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8552, 'compress@10': 0.6401, 'time@10': 7.9259}:  40%|████      | 4/10 [00:26<00:29,  4.95s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0285, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8552, 'compress@10': 0.6401, 'time@10': 7.9259}:  50%|█████     | 5/10 [00:26<00:27,  5.48s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0297, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8626, 'compress@10': 0.6746, 'time@10': 8.3301}:  50%|█████     | 5/10 [00:36<00:27,  5.48s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0297, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8626, 'compress@10': 0.6746, 'time@10': 8.3301}:  60%|██████    | 6/10 [00:36<00:28,  7.15s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0312, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8678, 'compress@10': 0.6311, 'time@10': 8.7863}:  60%|██████    | 6/10 [00:42<00:28,  7.15s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0312, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8678, 'compress@10': 0.6311, 'time@10': 8.7863}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.03, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8745, 'compress@10': 0.5747, 'time@10': 8.6819}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it]  {'epoch': 15, 'num_users': 6.125, 'loss': 0.03, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8745, 'compress@10': 0.5747, 'time@10': 8.6819}:  80%|████████  | 8/10 [00:50<00:14,  7.12s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0311, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9009, 'compress@10': 0.5579, 'time@10': 9.3134}:  80%|████████  | 8/10 [00:57<00:14,  7.12s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0311, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9009, 'compress@10': 0.5579, 'time@10': 9.3134}:  90%|█████████ | 9/10 [00:57<00:07,  7.15s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9063, 'compress@10': 0.5258, 'time@10': 9.3482}:  90%|█████████ | 9/10 [01:07<00:07,  7.15s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9063, 'compress@10': 0.5258, 'time@10': 9.3482}: 100%|██████████| 10/10 [01:07<00:00,  7.94s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9063, 'compress@10': 0.5258, 'time@10': 9.3482}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.03172400679733098
Avg hit ratio: 0.8815706715469025
Avg ndcg: 0.9063146324506108
Avg compression ratio: 0.5257719795320178
Avg train time: 9.348173785209656
Std train time: 2.8144866101726813
[0.6764705882352943, 0.26470588235294124, 0.08823529411764705, 0.9705882352941175, 0.9705882352941175, 0.7941176470588235, 0.38235294117647056, 0.14705882352941177, 0.4411764705882353, 0.2647058823529411]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0395, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8566, 'compress@10': 0.6935, 'time@10': 8.5393}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0395, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8566, 'compress@10': 0.6935, 'time@10': 8.5393}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0328, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8842, 'compress@10': 0.491, 'time@10': 7.72}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it]   {'epoch': 16, 'num_users': 7.0, 'loss': 0.0328, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8842, 'compress@10': 0.491, 'time@10': 7.72}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8752, 'compress@10': 0.4001, 'time@10': 6.9947}:  20%|██        | 2/10 [00:14<00:46,  5.86s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8752, 'compress@10': 0.4001, 'time@10': 6.9947}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8619, 'compress@10': 0.543, 'time@10': 6.6472}:  30%|███       | 3/10 [00:19<00:31,  4.46s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8619, 'compress@10': 0.543, 'time@10': 6.6472}:  40%|████      | 4/10 [00:19<00:29,  4.93s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0285, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8576, 'compress@10': 0.6286, 'time@10': 7.8837}:  40%|████      | 4/10 [00:26<00:29,  4.93s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0285, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8576, 'compress@10': 0.6286, 'time@10': 7.8837}:  50%|█████     | 5/10 [00:26<00:27,  5.48s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.872, 'ndcg@10': 0.8693, 'compress@10': 0.657, 'time@10': 8.3193}:  50%|█████     | 5/10 [00:36<00:27,  5.48s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.872, 'ndcg@10': 0.8693, 'compress@10': 0.657, 'time@10': 8.3193}:  60%|██████    | 6/10 [00:36<00:28,  7.20s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.8712, 'compress@10': 0.6213, 'time@10': 8.7058}:  60%|██████    | 6/10 [00:42<00:28,  7.20s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.8712, 'compress@10': 0.6213, 'time@10': 8.7058}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0272, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.8791, 'compress@10': 0.565, 'time@10': 8.6213}:  70%|███████   | 7/10 [00:50<00:19,  6.66s/it]  {'epoch': 16, 'num_users': 6.125, 'loss': 0.0272, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.8791, 'compress@10': 0.565, 'time@10': 8.6213}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0293, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.902, 'compress@10': 0.5531, 'time@10': 9.2682}:  80%|████████  | 8/10 [00:57<00:14,  7.11s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0293, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.902, 'compress@10': 0.5531, 'time@10': 9.2682}:  90%|█████████ | 9/10 [00:57<00:07,  7.15s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0282, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9054, 'compress@10': 0.5259, 'time@10': 9.2996}:  90%|█████████ | 9/10 [01:07<00:07,  7.15s/it]  {'epoch': 16, 'num_users': 6.3, 'loss': 0.0282, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9054, 'compress@10': 0.5259, 'time@10': 9.2996}: 100%|██████████| 10/10 [01:07<00:00,  7.92s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0282, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9054, 'compress@10': 0.5259, 'time@10': 9.2996}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.028234172564873306
Avg hit ratio: 0.8826274802352903
Avg ndcg: 0.9054360269986864
Avg compression ratio: 0.5258929434774793
Avg train time: 9.299556255340576
Std train time: 2.8126743676987838
[0.6944444444444446, 0.25000000000000006, 0.08333333333333333, 0.9722222222222221, 0.9722222222222221, 0.8055555555555555, 0.3611111111111111, 0.1388888888888889, 0.4722222222222222, 0.24999999999999994]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0395, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8575, 'compress@10': 0.7105, 'time@10': 8.5008}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0395, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8575, 'compress@10': 0.7105, 'time@10': 8.5008}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0334, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8826, 'compress@10': 0.4924, 'time@10': 7.7376}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0334, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8826, 'compress@10': 0.4924, 'time@10': 7.7376}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8741, 'compress@10': 0.3997, 'time@10': 6.9957}:  20%|██        | 2/10 [00:14<00:47,  5.89s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8741, 'compress@10': 0.3997, 'time@10': 6.9957}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8643, 'compress@10': 0.5431, 'time@10': 6.6759}:  30%|███       | 3/10 [00:19<00:31,  4.47s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8643, 'compress@10': 0.5431, 'time@10': 6.6759}:  40%|████      | 4/10 [00:19<00:29,  4.98s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0275, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8603, 'compress@10': 0.629, 'time@10': 7.9369}:  40%|████      | 4/10 [00:26<00:29,  4.98s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0275, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8603, 'compress@10': 0.629, 'time@10': 7.9369}:  50%|█████     | 5/10 [00:26<00:27,  5.54s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0258, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8722, 'compress@10': 0.6591, 'time@10': 8.3255}:  50%|█████     | 5/10 [00:36<00:27,  5.54s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0258, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8722, 'compress@10': 0.6591, 'time@10': 8.3255}:  60%|██████    | 6/10 [00:36<00:28,  7.16s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0251, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8819, 'compress@10': 0.6202, 'time@10': 8.7626}:  60%|██████    | 6/10 [00:42<00:28,  7.16s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0251, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8819, 'compress@10': 0.6202, 'time@10': 8.7626}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.024, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.8889, 'compress@10': 0.5631, 'time@10': 8.6658}:  70%|███████   | 7/10 [00:50<00:20,  6.69s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 0.024, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.8889, 'compress@10': 0.5631, 'time@10': 8.6658}:  80%|████████  | 8/10 [00:50<00:14,  7.12s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0242, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8945, 'compress@10': 0.5547, 'time@10': 9.3306}:  80%|████████  | 8/10 [00:57<00:14,  7.12s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0242, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8945, 'compress@10': 0.5547, 'time@10': 9.3306}:  90%|█████████ | 9/10 [00:57<00:07,  7.19s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.901, 'compress@10': 0.5259, 'time@10': 9.3677}:  90%|█████████ | 9/10 [01:07<00:07,  7.19s/it]    {'epoch': 17, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.901, 'compress@10': 0.5259, 'time@10': 9.3677}: 100%|██████████| 10/10 [01:07<00:00,  7.98s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.901, 'compress@10': 0.5259, 'time@10': 9.3677}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.022810637176212158
Avg hit ratio: 0.8822588166408201
Avg ndcg: 0.9010168788330825
Avg compression ratio: 0.5259341146042902
Avg train time: 9.367720007896423
Std train time: 2.872617947561888
[0.7105263157894739, 0.2894736842105264, 0.07894736842105263, 0.9736842105263157, 0.9736842105263157, 0.763157894736842, 0.34210526315789475, 0.13157894736842105, 0.5, 0.23684210526315785]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8565, 'compress@10': 0.7258, 'time@10': 8.6261}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8565, 'compress@10': 0.7258, 'time@10': 8.6261}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8909, 'compress@10': 0.5191, 'time@10': 7.7944}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8909, 'compress@10': 0.5191, 'time@10': 7.7944}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8797, 'compress@10': 0.4162, 'time@10': 7.0888}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8797, 'compress@10': 0.4162, 'time@10': 7.0888}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8725, 'compress@10': 0.5558, 'time@10': 6.7404}:  30%|███       | 3/10 [00:19<00:31,  4.52s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8725, 'compress@10': 0.5558, 'time@10': 6.7404}:  40%|████      | 4/10 [00:19<00:29,  5.00s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0256, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8707, 'compress@10': 0.6395, 'time@10': 7.9138}:  40%|████      | 4/10 [00:26<00:29,  5.00s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0256, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8707, 'compress@10': 0.6395, 'time@10': 7.9138}:  50%|█████     | 5/10 [00:26<00:27,  5.48s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0268, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8827, 'compress@10': 0.661, 'time@10': 8.3526}:  50%|█████     | 5/10 [00:36<00:27,  5.48s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0268, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8827, 'compress@10': 0.661, 'time@10': 8.3526}:  60%|██████    | 6/10 [00:36<00:28,  7.22s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0277, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8868, 'compress@10': 0.6192, 'time@10': 8.7114}:  60%|██████    | 6/10 [00:42<00:28,  7.22s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0277, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8868, 'compress@10': 0.6192, 'time@10': 8.7114}:  70%|███████   | 7/10 [00:42<00:19,  6.65s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0259, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.8934, 'compress@10': 0.5613, 'time@10': 8.6027}:  70%|███████   | 7/10 [00:50<00:19,  6.65s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0259, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.8934, 'compress@10': 0.5613, 'time@10': 8.6027}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0245, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.8999, 'compress@10': 0.5561, 'time@10': 9.2368}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0245, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.8999, 'compress@10': 0.5561, 'time@10': 9.2368}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9015, 'compress@10': 0.5259, 'time@10': 9.2844}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9015, 'compress@10': 0.5259, 'time@10': 9.2844}: 100%|██████████| 10/10 [01:07<00:00,  7.91s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9015, 'compress@10': 0.5259, 'time@10': 9.2844}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.024390739534846172
Avg hit ratio: 0.885115959497963
Avg ndcg: 0.9015186849551282
Avg compression ratio: 0.5259187245987544
Avg train time: 9.284388446807862
Std train time: 2.7270445017879212
[0.7250000000000002, 0.2750000000000001, 0.075, 0.9749999999999999, 0.9749999999999999, 0.7749999999999999, 0.375, 0.125, 0.475, 0.22499999999999995]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8812, 'compress@10': 0.7395, 'time@10': 8.4142}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8812, 'compress@10': 0.7395, 'time@10': 8.4142}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.906, 'compress@10': 0.5189, 'time@10': 7.7548}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it] {'epoch': 19, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.906, 'compress@10': 0.5189, 'time@10': 7.7548}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.8897, 'compress@10': 0.415, 'time@10': 7.0429}:  20%|██        | 2/10 [00:14<00:47,  5.94s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.8897, 'compress@10': 0.415, 'time@10': 7.0429}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.8923, 'compress@10': 0.5552, 'time@10': 6.6988}:  30%|███       | 3/10 [00:19<00:31,  4.53s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.8923, 'compress@10': 0.5552, 'time@10': 6.6988}:  40%|████      | 4/10 [00:19<00:29,  4.99s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8875, 'compress@10': 0.6393, 'time@10': 7.8342}:  40%|████      | 4/10 [00:26<00:29,  4.99s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8875, 'compress@10': 0.6393, 'time@10': 7.8342}:  50%|█████     | 5/10 [00:26<00:27,  5.44s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0209, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8966, 'compress@10': 0.6627, 'time@10': 8.2388}:  50%|█████     | 5/10 [00:36<00:27,  5.44s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0209, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8966, 'compress@10': 0.6627, 'time@10': 8.2388}:  60%|██████    | 6/10 [00:36<00:28,  7.09s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0214, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8956, 'compress@10': 0.6252, 'time@10': 8.6637}:  60%|██████    | 6/10 [00:42<00:28,  7.09s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0214, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8956, 'compress@10': 0.6252, 'time@10': 8.6637}:  70%|███████   | 7/10 [00:42<00:19,  6.62s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0209, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9008, 'compress@10': 0.5658, 'time@10': 8.5742}:  70%|███████   | 7/10 [00:50<00:19,  6.62s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0209, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9008, 'compress@10': 0.5658, 'time@10': 8.5742}:  80%|████████  | 8/10 [00:50<00:14,  7.05s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9077, 'compress@10': 0.5574, 'time@10': 9.2747}:  80%|████████  | 8/10 [00:57<00:14,  7.05s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9077, 'compress@10': 0.5574, 'time@10': 9.2747}:  90%|█████████ | 9/10 [00:57<00:07,  7.18s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9131, 'compress@10': 0.5259, 'time@10': 9.3416}:  90%|█████████ | 9/10 [01:07<00:07,  7.18s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9131, 'compress@10': 0.5259, 'time@10': 9.3416}: 100%|██████████| 10/10 [01:07<00:00,  8.06s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9131, 'compress@10': 0.5259, 'time@10': 9.3416}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.020748303331369233
Avg hit ratio: 0.8824584824720649
Avg ndcg: 0.9131342219939601
Avg compression ratio: 0.525897218371039
Avg train time: 9.341626358032226
Std train time: 2.824673726625423
[0.6904761904761907, 0.261904761904762, 0.07142857142857142, 0.976190476190476, 0.976190476190476, 0.7857142857142856, 0.40476190476190477, 0.11904761904761904, 0.5, 0.21428571428571425]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.903, 'compress@10': 0.7068, 'time@10': 8.4822}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.903, 'compress@10': 0.7068, 'time@10': 8.4822}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9259, 'compress@10': 0.4962, 'time@10': 7.7008}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9259, 'compress@10': 0.4962, 'time@10': 7.7008}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.903, 'compress@10': 0.3989, 'time@10': 7.0267}:  20%|██        | 2/10 [00:14<00:46,  5.85s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.903, 'compress@10': 0.3989, 'time@10': 7.0267}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.7914, 'ndcg@10': 0.9063, 'compress@10': 0.5434, 'time@10': 6.7156}:  30%|███       | 3/10 [00:19<00:31,  4.49s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.7914, 'ndcg@10': 0.9063, 'compress@10': 0.5434, 'time@10': 6.7156}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.9002, 'compress@10': 0.63, 'time@10': 7.889}:  40%|████      | 4/10 [00:26<00:30,  5.02s/it]  {'epoch': 20, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.9002, 'compress@10': 0.63, 'time@10': 7.889}:  50%|█████     | 5/10 [00:26<00:27,  5.49s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.9092, 'compress@10': 0.6568, 'time@10': 8.2995}:  50%|█████     | 5/10 [00:36<00:27,  5.49s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.9092, 'compress@10': 0.6568, 'time@10': 8.2995}:  60%|██████    | 6/10 [00:36<00:28,  7.16s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0194, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9144, 'compress@10': 0.6242, 'time@10': 8.7241}:  60%|██████    | 6/10 [00:42<00:28,  7.16s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0194, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9144, 'compress@10': 0.6242, 'time@10': 8.7241}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0193, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.919, 'compress@10': 0.5642, 'time@10': 8.6133}:  70%|███████   | 7/10 [00:50<00:20,  6.67s/it]  {'epoch': 20, 'num_users': 6.125, 'loss': 0.0193, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.919, 'compress@10': 0.5642, 'time@10': 8.6133}:  80%|████████  | 8/10 [00:50<00:14,  7.05s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.9345, 'compress@10': 0.5586, 'time@10': 9.2527}:  80%|████████  | 8/10 [00:57<00:14,  7.05s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.9345, 'compress@10': 0.5586, 'time@10': 9.2527}:  90%|█████████ | 9/10 [00:57<00:07,  7.11s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9369, 'compress@10': 0.526, 'time@10': 9.3333}:  90%|█████████ | 9/10 [01:07<00:07,  7.11s/it]    {'epoch': 20, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9369, 'compress@10': 0.526, 'time@10': 9.3333}: 100%|██████████| 10/10 [01:07<00:00,  8.03s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9369, 'compress@10': 0.526, 'time@10': 9.3333}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.022070340186699528
Avg hit ratio: 0.8743381817201851
Avg ndcg: 0.9369003627106745
Avg compression ratio: 0.525993464554782
Avg train time: 9.333309483528136
Std train time: 2.7564145350962983
[0.7045454545454547, 0.25000000000000006, 0.06818181818181818, 0.9772727272727272, 0.9772727272727272, 0.7499999999999999, 0.38636363636363635, 0.11363636363636363, 0.5227272727272727, 0.24999999999999997]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8962, 'compress@10': 0.7201, 'time@10': 8.5209}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8962, 'compress@10': 0.7201, 'time@10': 8.5209}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.919, 'compress@10': 0.4971, 'time@10': 7.8322}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it] {'epoch': 21, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.919, 'compress@10': 0.4971, 'time@10': 7.8322}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8984, 'compress@10': 0.3985, 'time@10': 7.0813}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8984, 'compress@10': 0.3985, 'time@10': 7.0813}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.889, 'compress@10': 0.5434, 'time@10': 6.7123}:  30%|███       | 3/10 [00:19<00:31,  4.55s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.889, 'compress@10': 0.5434, 'time@10': 6.7123}:  40%|████      | 4/10 [00:19<00:29,  4.98s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0198, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8875, 'compress@10': 0.6303, 'time@10': 7.8392}:  40%|████      | 4/10 [00:26<00:29,  4.98s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0198, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8875, 'compress@10': 0.6303, 'time@10': 7.8392}:  50%|█████     | 5/10 [00:26<00:27,  5.42s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0234, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9011, 'compress@10': 0.6512, 'time@10': 8.2571}:  50%|█████     | 5/10 [00:36<00:27,  5.42s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0234, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9011, 'compress@10': 0.6512, 'time@10': 8.2571}:  60%|██████    | 6/10 [00:36<00:28,  7.11s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0244, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9028, 'compress@10': 0.6168, 'time@10': 8.6395}:  60%|██████    | 6/10 [00:42<00:28,  7.11s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0244, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9028, 'compress@10': 0.6168, 'time@10': 8.6395}:  70%|███████   | 7/10 [00:42<00:19,  6.58s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9079, 'compress@10': 0.5571, 'time@10': 8.5368}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9079, 'compress@10': 0.5571, 'time@10': 8.5368}:  80%|████████  | 8/10 [00:49<00:13,  6.99s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0244, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9081, 'compress@10': 0.5548, 'time@10': 9.1872}:  80%|████████  | 8/10 [00:57<00:13,  6.99s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0244, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9081, 'compress@10': 0.5548, 'time@10': 9.1872}:  90%|█████████ | 9/10 [00:57<00:07,  7.07s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0246, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9132, 'compress@10': 0.526, 'time@10': 9.2661}:  90%|█████████ | 9/10 [01:07<00:07,  7.07s/it]    {'epoch': 21, 'num_users': 6.3, 'loss': 0.0246, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9132, 'compress@10': 0.526, 'time@10': 9.2661}: 100%|██████████| 10/10 [01:07<00:00,  7.98s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0246, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9132, 'compress@10': 0.526, 'time@10': 9.2661}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.02460467197265092
Avg hit ratio: 0.8811354167432265
Avg ndcg: 0.9132468537973605
Avg compression ratio: 0.5260191860324496
Avg train time: 9.266068077087402
Std train time: 2.726638411052307
[0.673913043478261, 0.23913043478260876, 0.06521739130434782, 0.9782608695652173, 0.9782608695652173, 0.7608695652173912, 0.41304347826086957, 0.10869565217391304, 0.5434782608695652, 0.23913043478260868]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9063, 'compress@10': 0.6911, 'time@10': 8.517}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9063, 'compress@10': 0.6911, 'time@10': 8.517}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9211, 'compress@10': 0.4774, 'time@10': 7.8405}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9211, 'compress@10': 0.4774, 'time@10': 7.8405}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8997, 'compress@10': 0.3845, 'time@10': 7.0998}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8997, 'compress@10': 0.3845, 'time@10': 7.0998}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8956, 'compress@10': 0.5331, 'time@10': 6.7805}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8956, 'compress@10': 0.5331, 'time@10': 6.7805}:  40%|████      | 4/10 [00:20<00:30,  5.08s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0195, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8946, 'compress@10': 0.6222, 'time@10': 7.9101}:  40%|████      | 4/10 [00:26<00:30,  5.08s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0195, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8946, 'compress@10': 0.6222, 'time@10': 7.9101}:  50%|█████     | 5/10 [00:26<00:27,  5.50s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.9032, 'compress@10': 0.6462, 'time@10': 8.3272}:  50%|█████     | 5/10 [00:36<00:27,  5.50s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.9032, 'compress@10': 0.6462, 'time@10': 8.3272}:  60%|██████    | 6/10 [00:36<00:28,  7.18s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.867, 'ndcg@10': 0.906, 'compress@10': 0.6163, 'time@10': 8.7894}:  60%|██████    | 6/10 [00:42<00:28,  7.18s/it]  {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.867, 'ndcg@10': 0.906, 'compress@10': 0.6163, 'time@10': 8.7894}:  70%|███████   | 7/10 [00:42<00:20,  6.74s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9099, 'compress@10': 0.556, 'time@10': 8.6876}:  70%|███████   | 7/10 [00:50<00:20,  6.74s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9099, 'compress@10': 0.556, 'time@10': 8.6876}:  80%|████████  | 8/10 [00:50<00:14,  7.14s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9155, 'compress@10': 0.5561, 'time@10': 9.3564}:  80%|████████  | 8/10 [00:58<00:14,  7.14s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9155, 'compress@10': 0.5561, 'time@10': 9.3564}:  90%|█████████ | 9/10 [00:58<00:07,  7.22s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9213, 'compress@10': 0.5261, 'time@10': 9.4144}:  90%|█████████ | 9/10 [01:08<00:07,  7.22s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9213, 'compress@10': 0.5261, 'time@10': 9.4144}: 100%|██████████| 10/10 [01:08<00:00,  8.07s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9213, 'compress@10': 0.5261, 'time@10': 9.4144}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.016238179243820317
Avg hit ratio: 0.8703417659495758
Avg ndcg: 0.9213029147409856
Avg compression ratio: 0.5261025304384462
Avg train time: 9.414365601539611
Std train time: 2.7969468819232435
[0.6875000000000001, 0.27083333333333337, 0.0625, 0.9791666666666665, 0.9791666666666665, 0.7291666666666666, 0.4375, 0.10416666666666666, 0.5208333333333333, 0.22916666666666666]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9101, 'compress@10': 0.7039, 'time@10': 8.5198}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9101, 'compress@10': 0.7039, 'time@10': 8.5198}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9323, 'compress@10': 0.4992, 'time@10': 7.8517}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9323, 'compress@10': 0.4992, 'time@10': 7.8517}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9073, 'compress@10': 0.3982, 'time@10': 7.0655}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9073, 'compress@10': 0.3982, 'time@10': 7.0655}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.908, 'compress@10': 0.5437, 'time@10': 6.7353}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.908, 'compress@10': 0.5437, 'time@10': 6.7353}:  40%|████      | 4/10 [00:20<00:30,  5.03s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.9066, 'compress@10': 0.6308, 'time@10': 7.9365}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.9066, 'compress@10': 0.6308, 'time@10': 7.9365}:  50%|█████     | 5/10 [00:26<00:27,  5.53s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9159, 'compress@10': 0.6482, 'time@10': 8.3663}:  50%|█████     | 5/10 [00:37<00:27,  5.53s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9159, 'compress@10': 0.6482, 'time@10': 8.3663}:  60%|██████    | 6/10 [00:37<00:28,  7.23s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9203, 'compress@10': 0.6213, 'time@10': 8.7467}:  60%|██████    | 6/10 [00:42<00:28,  7.23s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9203, 'compress@10': 0.6213, 'time@10': 8.7467}:  70%|███████   | 7/10 [00:42<00:20,  6.68s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9252, 'compress@10': 0.5599, 'time@10': 8.636}:  70%|███████   | 7/10 [00:50<00:20,  6.68s/it]  {'epoch': 23, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9252, 'compress@10': 0.5599, 'time@10': 8.636}:  80%|████████  | 8/10 [00:50<00:14,  7.07s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9301, 'compress@10': 0.5571, 'time@10': 9.2779}:  80%|████████  | 8/10 [00:57<00:14,  7.07s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9301, 'compress@10': 0.5571, 'time@10': 9.2779}:  90%|█████████ | 9/10 [00:57<00:07,  7.12s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9294, 'compress@10': 0.526, 'time@10': 9.3604}:  90%|█████████ | 9/10 [01:07<00:07,  7.12s/it]    {'epoch': 23, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9294, 'compress@10': 0.526, 'time@10': 9.3604}: 100%|██████████| 10/10 [01:07<00:00,  8.05s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9294, 'compress@10': 0.526, 'time@10': 9.3604}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.019539199527638284
Avg hit ratio: 0.8754211310289408
Avg ndcg: 0.9293990973395505
Avg compression ratio: 0.5260355058580826
Avg train time: 9.360438704490662
Std train time: 2.781316572493032
[0.7000000000000001, 0.26, 0.06, 0.9799999999999999, 0.9799999999999999, 0.7, 0.42, 0.13999999999999999, 0.49999999999999994, 0.26]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9101, 'compress@10': 0.7158, 'time@10': 8.3688}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9101, 'compress@10': 0.7158, 'time@10': 8.3688}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9349, 'compress@10': 0.4998, 'time@10': 7.7831}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9349, 'compress@10': 0.4998, 'time@10': 7.7831}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9089, 'compress@10': 0.398, 'time@10': 7.0891}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9089, 'compress@10': 0.398, 'time@10': 7.0891}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.7914, 'ndcg@10': 0.9128, 'compress@10': 0.5437, 'time@10': 6.7377}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.7914, 'ndcg@10': 0.9128, 'compress@10': 0.5437, 'time@10': 6.7377}:  40%|████      | 4/10 [00:20<00:30,  5.03s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.9108, 'compress@10': 0.631, 'time@10': 7.9657}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it] {'epoch': 24, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.9108, 'compress@10': 0.631, 'time@10': 7.9657}:  50%|█████     | 5/10 [00:26<00:27,  5.55s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9232, 'compress@10': 0.6436, 'time@10': 8.3917}:  50%|█████     | 5/10 [00:37<00:27,  5.55s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9232, 'compress@10': 0.6436, 'time@10': 8.3917}:  60%|██████    | 6/10 [00:37<00:29,  7.25s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.02, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9223, 'compress@10': 0.615, 'time@10': 8.7926}:  60%|██████    | 6/10 [00:42<00:29,  7.25s/it]   {'epoch': 24, 'num_users': 6.2857, 'loss': 0.02, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9223, 'compress@10': 0.615, 'time@10': 8.7926}:  70%|███████   | 7/10 [00:42<00:20,  6.73s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0195, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9251, 'compress@10': 0.5587, 'time@10': 8.6739}:  70%|███████   | 7/10 [00:50<00:20,  6.73s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0195, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9251, 'compress@10': 0.5587, 'time@10': 8.6739}:  80%|████████  | 8/10 [00:50<00:14,  7.09s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9419, 'compress@10': 0.5537, 'time@10': 9.3117}:  80%|████████  | 8/10 [00:57<00:14,  7.09s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9419, 'compress@10': 0.5537, 'time@10': 9.3117}:  90%|█████████ | 9/10 [00:57<00:07,  7.14s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9449, 'compress@10': 0.5261, 'time@10': 9.3946}:  90%|█████████ | 9/10 [01:08<00:07,  7.14s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9449, 'compress@10': 0.5261, 'time@10': 9.3946}: 100%|██████████| 10/10 [01:08<00:00,  8.08s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9449, 'compress@10': 0.5261, 'time@10': 9.3946}: 100%|██████████| 10/10 [01:08<00:00,  6.80s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.02182925517492212
Avg hit ratio: 0.8754810388630423
Avg ndcg: 0.9449031058450883
Avg compression ratio: 0.5260564553885058
Avg train time: 9.394613814353942
Std train time: 2.794710906730007
[0.6730769230769231, 0.25, 0.05769230769230769, 0.9807692307692306, 0.9807692307692306, 0.7115384615384615, 0.4423076923076923, 0.1346153846153846, 0.5192307692307692, 0.25]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9087, 'compress@10': 0.6903, 'time@10': 8.2147}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9087, 'compress@10': 0.6903, 'time@10': 8.2147}:  10%|█         | 1/10 [00:04<00:37,  4.14s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9354, 'compress@10': 0.4822, 'time@10': 7.6776}:  10%|█         | 1/10 [00:11<00:37,  4.14s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9354, 'compress@10': 0.4822, 'time@10': 7.6776}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9093, 'compress@10': 0.3856, 'time@10': 6.9935}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9093, 'compress@10': 0.3856, 'time@10': 6.9935}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.7922, 'ndcg@10': 0.9145, 'compress@10': 0.5346, 'time@10': 6.7098}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.7922, 'ndcg@10': 0.9145, 'compress@10': 0.5346, 'time@10': 6.7098}:  40%|████      | 4/10 [00:20<00:30,  5.07s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.9127, 'compress@10': 0.6239, 'time@10': 7.9179}:  40%|████      | 4/10 [00:26<00:30,  5.07s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.9127, 'compress@10': 0.6239, 'time@10': 7.9179}:  50%|█████     | 5/10 [00:26<00:27,  5.55s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9191, 'compress@10': 0.6395, 'time@10': 8.3234}:  50%|█████     | 5/10 [00:36<00:27,  5.55s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9191, 'compress@10': 0.6395, 'time@10': 8.3234}:  60%|██████    | 6/10 [00:36<00:28,  7.20s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9203, 'compress@10': 0.6146, 'time@10': 8.7356}:  60%|██████    | 6/10 [00:42<00:28,  7.20s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9203, 'compress@10': 0.6146, 'time@10': 8.7356}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0148, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9242, 'compress@10': 0.5577, 'time@10': 8.6091}:  70%|███████   | 7/10 [00:50<00:20,  6.69s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.0148, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9242, 'compress@10': 0.5577, 'time@10': 8.6091}:  80%|████████  | 8/10 [00:50<00:14,  7.03s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9195, 'compress@10': 0.5549, 'time@10': 9.2608}:  80%|████████  | 8/10 [00:57<00:14,  7.03s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9195, 'compress@10': 0.5549, 'time@10': 9.2608}:  90%|█████████ | 9/10 [00:57<00:07,  7.11s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9266, 'compress@10': 0.5261, 'time@10': 9.3458}:  90%|█████████ | 9/10 [01:07<00:07,  7.11s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9266, 'compress@10': 0.5261, 'time@10': 9.3458}: 100%|██████████| 10/10 [01:07<00:00,  8.05s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9266, 'compress@10': 0.5261, 'time@10': 9.3458}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.01865753123907138
Avg hit ratio: 0.8764615816177785
Avg ndcg: 0.9265647655575456
Avg compression ratio: 0.5261260325245564
Avg train time: 9.345773124694825
Std train time: 2.7881800054313466
[0.6481481481481483, 0.24074074074074076, 0.05555555555555555, 0.9444444444444443, 0.9814814814814813, 0.7222222222222221, 0.46296296296296297, 0.12962962962962962, 0.537037037037037, 0.2777777777777778]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9154, 'compress@10': 0.6667, 'time@10': 8.2854}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9154, 'compress@10': 0.6667, 'time@10': 8.2854}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9406, 'compress@10': 0.4659, 'time@10': 7.6668}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9406, 'compress@10': 0.4659, 'time@10': 7.6668}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9128, 'compress@10': 0.3741, 'time@10': 7.0504}:  20%|██        | 2/10 [00:14<00:47,  5.89s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9128, 'compress@10': 0.3741, 'time@10': 7.0504}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9158, 'compress@10': 0.5172, 'time@10': 6.7592}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9158, 'compress@10': 0.5172, 'time@10': 6.7592}:  40%|████      | 4/10 [00:20<00:30,  5.09s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9147, 'compress@10': 0.6101, 'time@10': 7.9377}:  40%|████      | 4/10 [00:26<00:30,  5.09s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9147, 'compress@10': 0.6101, 'time@10': 7.9377}:  50%|█████     | 5/10 [00:26<00:27,  5.55s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9238, 'compress@10': 0.6298, 'time@10': 8.33}:  50%|█████     | 5/10 [00:36<00:27,  5.55s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9238, 'compress@10': 0.6298, 'time@10': 8.33}:  60%|██████    | 6/10 [00:36<00:28,  7.17s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9271, 'compress@10': 0.6091, 'time@10': 8.7393}:  60%|██████    | 6/10 [00:42<00:28,  7.17s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9271, 'compress@10': 0.6091, 'time@10': 8.7393}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9303, 'compress@10': 0.5522, 'time@10': 8.6062}:  70%|███████   | 7/10 [00:50<00:20,  6.67s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9303, 'compress@10': 0.5522, 'time@10': 8.6062}:  80%|████████  | 8/10 [00:50<00:14,  7.00s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9341, 'compress@10': 0.552, 'time@10': 9.2293}:  80%|████████  | 8/10 [00:57<00:14,  7.00s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9341, 'compress@10': 0.552, 'time@10': 9.2293}:  90%|█████████ | 9/10 [00:57<00:07,  7.05s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9382, 'compress@10': 0.5262, 'time@10': 9.3286}:  90%|█████████ | 9/10 [01:07<00:07,  7.05s/it]  {'epoch': 26, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9382, 'compress@10': 0.5262, 'time@10': 9.3286}: 100%|██████████| 10/10 [01:07<00:00,  8.04s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9382, 'compress@10': 0.5262, 'time@10': 9.3286}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.012152521076794208
Avg hit ratio: 0.8928870539006363
Avg ndcg: 0.9381653789367645
Avg compression ratio: 0.5262421657054233
Avg train time: 9.328610587120057
Std train time: 2.7078674666077016
[0.6607142857142858, 0.26785714285714285, 0.05357142857142857, 0.9464285714285713, 0.982142857142857, 0.6964285714285713, 0.44642857142857145, 0.1607142857142857, 0.5178571428571428, 0.26785714285714285]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9112, 'compress@10': 0.6786, 'time@10': 8.2218}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9112, 'compress@10': 0.6786, 'time@10': 8.2218}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9391, 'compress@10': 0.485, 'time@10': 7.6917}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it]  {'epoch': 27, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9391, 'compress@10': 0.485, 'time@10': 7.6917}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9118, 'compress@10': 0.3863, 'time@10': 7.0297}:  20%|██        | 2/10 [00:14<00:47,  5.94s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9118, 'compress@10': 0.3863, 'time@10': 7.0297}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9164, 'compress@10': 0.5268, 'time@10': 6.7187}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9164, 'compress@10': 0.5268, 'time@10': 6.7187}:  40%|████      | 4/10 [00:20<00:30,  5.05s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9154, 'compress@10': 0.6179, 'time@10': 7.9312}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9154, 'compress@10': 0.6179, 'time@10': 7.9312}:  50%|█████     | 5/10 [00:26<00:27,  5.55s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9335, 'compress@10': 0.6321, 'time@10': 8.2984}:  50%|█████     | 5/10 [00:36<00:27,  5.55s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9335, 'compress@10': 0.6321, 'time@10': 8.2984}:  60%|██████    | 6/10 [00:36<00:28,  7.12s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9338, 'compress@10': 0.6088, 'time@10': 8.6981}:  60%|██████    | 6/10 [00:42<00:28,  7.12s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9338, 'compress@10': 0.6088, 'time@10': 8.6981}:  70%|███████   | 7/10 [00:42<00:19,  6.62s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0194, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9366, 'compress@10': 0.5558, 'time@10': 8.6162}:  70%|███████   | 7/10 [00:50<00:19,  6.62s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0194, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9366, 'compress@10': 0.5558, 'time@10': 8.6162}:  80%|████████  | 8/10 [00:50<00:14,  7.08s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9522, 'compress@10': 0.5531, 'time@10': 9.2129}:  80%|████████  | 8/10 [00:57<00:14,  7.08s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9522, 'compress@10': 0.5531, 'time@10': 9.2129}:  90%|█████████ | 9/10 [00:57<00:07,  7.07s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9516, 'compress@10': 0.5262, 'time@10': 9.315}:  90%|█████████ | 9/10 [01:07<00:07,  7.07s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9516, 'compress@10': 0.5262, 'time@10': 9.315}: 100%|██████████| 10/10 [01:07<00:00,  8.06s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9516, 'compress@10': 0.5262, 'time@10': 9.315}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.021448209382478472
Avg hit ratio: 0.9018271460665348
Avg ndcg: 0.9515630840776975
Avg compression ratio: 0.5262196052614824
Avg train time: 9.315011620521545
Std train time: 2.6730546769592967
[0.6379310344827587, 0.29310344827586204, 0.05172413793103448, 0.9137931034482757, 0.9482758620689654, 0.7068965517241378, 0.4655172413793104, 0.15517241379310343, 0.5344827586206896, 0.29310344827586204]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9065, 'compress@10': 0.657, 'time@10': 8.2128}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9065, 'compress@10': 0.657, 'time@10': 8.2128}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9447, 'compress@10': 0.4864, 'time@10': 7.7341}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9447, 'compress@10': 0.4864, 'time@10': 7.7341}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9155, 'compress@10': 0.3867, 'time@10': 7.037}:  20%|██        | 2/10 [00:14<00:47,  6.00s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9155, 'compress@10': 0.3867, 'time@10': 7.037}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9198, 'compress@10': 0.5192, 'time@10': 6.7221}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9198, 'compress@10': 0.5192, 'time@10': 6.7221}:  40%|████      | 4/10 [00:20<00:30,  5.06s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9193, 'compress@10': 0.6052, 'time@10': 7.9231}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9193, 'compress@10': 0.6052, 'time@10': 7.9231}:  50%|█████     | 5/10 [00:26<00:27,  5.54s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.928, 'compress@10': 0.6233, 'time@10': 8.2711}:  50%|█████     | 5/10 [00:36<00:27,  5.54s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.928, 'compress@10': 0.6233, 'time@10': 8.2711}:  60%|██████    | 6/10 [00:36<00:28,  7.07s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9288, 'compress@10': 0.6038, 'time@10': 8.6831}:  60%|██████    | 6/10 [00:42<00:28,  7.07s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9288, 'compress@10': 0.6038, 'time@10': 8.6831}:  70%|███████   | 7/10 [00:42<00:19,  6.60s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9324, 'compress@10': 0.5507, 'time@10': 8.5568}:  70%|███████   | 7/10 [00:49<00:19,  6.60s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9324, 'compress@10': 0.5507, 'time@10': 8.5568}:  80%|████████  | 8/10 [00:49<00:13,  6.95s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9297, 'compress@10': 0.5504, 'time@10': 9.2035}:  80%|████████  | 8/10 [00:57<00:13,  6.95s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9297, 'compress@10': 0.5504, 'time@10': 9.2035}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9335, 'compress@10': 0.5263, 'time@10': 9.3185}:  90%|█████████ | 9/10 [01:07<00:07,  7.04s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9335, 'compress@10': 0.5263, 'time@10': 9.3185}: 100%|██████████| 10/10 [01:07<00:00,  8.07s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9335, 'compress@10': 0.5263, 'time@10': 9.3185}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.014301065041736578
Avg hit ratio: 0.9021958096610048
Avg ndcg: 0.9334813677254878
Avg compression ratio: 0.5262812349813163
Avg train time: 9.318531894683838
Std train time: 2.7634582286089175
[0.65, 0.2833333333333333, 0.05, 0.9166666666666665, 0.95, 0.6833333333333332, 0.4833333333333334, 0.14999999999999997, 0.5499999999999999, 0.2833333333333333]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8815, 'compress@10': 0.6684, 'time@10': 8.3676}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8815, 'compress@10': 0.6684, 'time@10': 8.3676}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9222, 'compress@10': 0.4874, 'time@10': 7.8}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]   {'epoch': 29, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9222, 'compress@10': 0.4874, 'time@10': 7.8}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9005, 'compress@10': 0.3869, 'time@10': 7.0529}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9005, 'compress@10': 0.3869, 'time@10': 7.0529}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.908, 'compress@10': 0.5201, 'time@10': 6.7533}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.908, 'compress@10': 0.5201, 'time@10': 6.7533}:  40%|████      | 4/10 [00:20<00:30,  5.08s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9099, 'compress@10': 0.6062, 'time@10': 7.9447}:  40%|████      | 4/10 [00:26<00:30,  5.08s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9099, 'compress@10': 0.6062, 'time@10': 7.9447}:  50%|█████     | 5/10 [00:26<00:27,  5.56s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9212, 'compress@10': 0.6203, 'time@10': 8.2976}:  50%|█████     | 5/10 [00:36<00:27,  5.56s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9212, 'compress@10': 0.6203, 'time@10': 8.2976}:  60%|██████    | 6/10 [00:36<00:28,  7.10s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9248, 'compress@10': 0.6037, 'time@10': 8.7531}:  60%|██████    | 6/10 [00:42<00:28,  7.10s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9248, 'compress@10': 0.6037, 'time@10': 8.7531}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9291, 'compress@10': 0.55, 'time@10': 8.6209}:  70%|███████   | 7/10 [00:50<00:20,  6.67s/it]   {'epoch': 29, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9291, 'compress@10': 0.55, 'time@10': 8.6209}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9362, 'compress@10': 0.5514, 'time@10': 9.2296}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9362, 'compress@10': 0.5514, 'time@10': 9.2296}:  90%|█████████ | 9/10 [00:57<00:07,  7.03s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.937, 'compress@10': 0.5262, 'time@10': 9.3355}:  90%|█████████ | 9/10 [01:07<00:07,  7.03s/it]     {'epoch': 29, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.937, 'compress@10': 0.5262, 'time@10': 9.3355}: 100%|██████████| 10/10 [01:07<00:00,  8.05s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.937, 'compress@10': 0.5262, 'time@10': 9.3355}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.014968634169198917
Avg hit ratio: 0.9021164445816398
Avg ndcg: 0.9370220331427097
Avg compression ratio: 0.5262337891168957
Avg train time: 9.335530829429626
Std train time: 2.7308255004171134
[0.6612903225806451, 0.27419354838709675, 0.048387096774193554, 0.9193548387096773, 0.9193548387096774, 0.6935483870967741, 0.46774193548387105, 0.1451612903225806, 0.564516129032258, 0.3064516129032258]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9087, 'compress@10': 0.6791, 'time@10': 8.0279}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9087, 'compress@10': 0.6791, 'time@10': 8.0279}:  10%|█         | 1/10 [00:04<00:36,  4.05s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9376, 'compress@10': 0.4884, 'time@10': 7.5984}:  10%|█         | 1/10 [00:11<00:36,  4.05s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9376, 'compress@10': 0.4884, 'time@10': 7.5984}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9108, 'compress@10': 0.387, 'time@10': 6.9599}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9108, 'compress@10': 0.387, 'time@10': 6.9599}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9186, 'compress@10': 0.5208, 'time@10': 6.6649}:  30%|███       | 3/10 [00:19<00:31,  4.52s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9186, 'compress@10': 0.5208, 'time@10': 6.6649}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9203, 'compress@10': 0.6008, 'time@10': 7.8945}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9203, 'compress@10': 0.6008, 'time@10': 7.8945}:  50%|█████     | 5/10 [00:26<00:27,  5.54s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9289, 'compress@10': 0.6174, 'time@10': 8.2638}:  50%|█████     | 5/10 [00:36<00:27,  5.54s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9289, 'compress@10': 0.6174, 'time@10': 8.2638}:  60%|██████    | 6/10 [00:36<00:28,  7.11s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9309, 'compress@10': 0.5991, 'time@10': 8.7109}:  60%|██████    | 6/10 [00:42<00:28,  7.11s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9309, 'compress@10': 0.5991, 'time@10': 8.7109}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9323, 'compress@10': 0.5454, 'time@10': 8.6066}:  70%|███████   | 7/10 [00:50<00:19,  6.66s/it]  {'epoch': 30, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9323, 'compress@10': 0.5454, 'time@10': 8.6066}:  80%|████████  | 8/10 [00:50<00:14,  7.06s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0165, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9243, 'compress@10': 0.5489, 'time@10': 9.1987}:  80%|████████  | 8/10 [00:57<00:14,  7.06s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0165, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9243, 'compress@10': 0.5489, 'time@10': 9.1987}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.93, 'compress@10': 0.5262, 'time@10': 9.2956}:  90%|█████████ | 9/10 [01:07<00:07,  7.04s/it]     {'epoch': 30, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.93, 'compress@10': 0.5262, 'time@10': 9.2956}: 100%|██████████| 10/10 [01:07<00:00,  8.02s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.93, 'compress@10': 0.5262, 'time@10': 9.2956}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.016412814652541872
Avg hit ratio: 0.8871958096610049
Avg ndcg: 0.9300027228512731
Avg compression ratio: 0.5262379959291988
Avg train time: 9.295585179328919
Std train time: 2.7070223039646284
[0.640625, 0.296875, 0.04687500000000001, 0.9218749999999999, 0.921875, 0.6718749999999999, 0.4843750000000001, 0.14062499999999994, 0.578125, 0.296875]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.895, 'compress@10': 0.6595, 'time@10': 8.2265}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.895, 'compress@10': 0.6595, 'time@10': 8.2265}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9344, 'compress@10': 0.4895, 'time@10': 7.7277}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9344, 'compress@10': 0.4895, 'time@10': 7.7277}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9086, 'compress@10': 0.3874, 'time@10': 7.0384}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9086, 'compress@10': 0.3874, 'time@10': 7.0384}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9157, 'compress@10': 0.5217, 'time@10': 6.7157}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9157, 'compress@10': 0.5217, 'time@10': 6.7157}:  40%|████      | 4/10 [00:20<00:30,  5.05s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9188, 'compress@10': 0.602, 'time@10': 7.8535}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9188, 'compress@10': 0.602, 'time@10': 7.8535}:  50%|█████     | 5/10 [00:26<00:27,  5.48s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9281, 'compress@10': 0.6149, 'time@10': 8.1893}:  50%|█████     | 5/10 [00:36<00:27,  5.48s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9281, 'compress@10': 0.6149, 'time@10': 8.1893}:  60%|██████    | 6/10 [00:36<00:27,  6.98s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.929, 'compress@10': 0.5992, 'time@10': 8.6414}:  60%|██████    | 6/10 [00:41<00:27,  6.98s/it] {'epoch': 31, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.929, 'compress@10': 0.5992, 'time@10': 8.6414}:  70%|███████   | 7/10 [00:41<00:19,  6.57s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.894, 'ndcg@10': 0.936, 'compress@10': 0.5449, 'time@10': 8.5313}:  70%|███████   | 7/10 [00:49<00:19,  6.57s/it]  {'epoch': 31, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.894, 'ndcg@10': 0.936, 'compress@10': 0.5449, 'time@10': 8.5313}:  80%|████████  | 8/10 [00:49<00:13,  6.96s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.939, 'compress@10': 0.55, 'time@10': 9.1417}:  80%|████████  | 8/10 [00:56<00:13,  6.96s/it] {'epoch': 31, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.939, 'compress@10': 0.55, 'time@10': 9.1417}:  90%|█████████ | 9/10 [00:56<00:06,  6.99s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9427, 'compress@10': 0.5263, 'time@10': 9.236}:  90%|█████████ | 9/10 [01:06<00:06,  6.99s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9427, 'compress@10': 0.5263, 'time@10': 9.236}: 100%|██████████| 10/10 [01:06<00:00,  7.95s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9427, 'compress@10': 0.5263, 'time@10': 9.236}: 100%|██████████| 10/10 [01:06<00:00,  6.69s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.014677118882812446
Avg hit ratio: 0.8986243810895763
Avg ndcg: 0.9427211750326011
Avg compression ratio: 0.5262584757298747
Avg train time: 9.236025500297547
Std train time: 2.6602411094655545
[0.6515151515151515, 0.2878787878787879, 0.04545454545454546, 0.9242424242424241, 0.9242424242424242, 0.6515151515151514, 0.5000000000000001, 0.1363636363636363, 0.5606060606060606, 0.3181818181818182]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9136, 'compress@10': 0.6698, 'time@10': 8.732}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9136, 'compress@10': 0.6698, 'time@10': 8.732}:  10%|█         | 1/10 [00:04<00:39,  4.40s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9402, 'compress@10': 0.4904, 'time@10': 8.0148}:  10%|█         | 1/10 [00:11<00:39,  4.40s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9402, 'compress@10': 0.4904, 'time@10': 8.0148}:  20%|██        | 2/10 [00:11<00:49,  6.13s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9125, 'compress@10': 0.3875, 'time@10': 7.2141}:  20%|██        | 2/10 [00:14<00:49,  6.13s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9125, 'compress@10': 0.3875, 'time@10': 7.2141}:  30%|███       | 3/10 [00:14<00:32,  4.63s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9219, 'compress@10': 0.5224, 'time@10': 6.8337}:  30%|███       | 3/10 [00:20<00:32,  4.63s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9219, 'compress@10': 0.5224, 'time@10': 6.8337}:  40%|████      | 4/10 [00:20<00:30,  5.06s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9227, 'compress@10': 0.603, 'time@10': 8.0045}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9227, 'compress@10': 0.603, 'time@10': 8.0045}:  50%|█████     | 5/10 [00:26<00:27,  5.54s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9422, 'compress@10': 0.6124, 'time@10': 8.3313}:  50%|█████     | 5/10 [00:36<00:27,  5.54s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9422, 'compress@10': 0.6124, 'time@10': 8.3313}:  60%|██████    | 6/10 [00:36<00:28,  7.05s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9441, 'compress@10': 0.5992, 'time@10': 8.7517}:  60%|██████    | 6/10 [00:42<00:28,  7.05s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9441, 'compress@10': 0.5992, 'time@10': 8.7517}:  70%|███████   | 7/10 [00:42<00:19,  6.60s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9465, 'compress@10': 0.5444, 'time@10': 8.6267}:  70%|███████   | 7/10 [00:50<00:19,  6.60s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9465, 'compress@10': 0.5444, 'time@10': 8.6267}:  80%|████████  | 8/10 [00:50<00:13,  6.98s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9541, 'compress@10': 0.5476, 'time@10': 9.246}:  80%|████████  | 8/10 [00:57<00:13,  6.98s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9541, 'compress@10': 0.5476, 'time@10': 9.246}:  90%|█████████ | 9/10 [00:57<00:07,  7.03s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9564, 'compress@10': 0.5262, 'time@10': 9.3365}:  90%|█████████ | 9/10 [01:07<00:07,  7.03s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9564, 'compress@10': 0.5262, 'time@10': 9.3365}: 100%|██████████| 10/10 [01:07<00:00,  8.01s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9564, 'compress@10': 0.5262, 'time@10': 9.3365}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.0123820833039178
Avg hit ratio: 0.8907902797070879
Avg ndcg: 0.9564188382513276
Avg compression ratio: 0.5262334632616504
Avg train time: 9.336468291282653
Std train time: 2.7181493455028427
[0.6617647058823529, 0.27941176470588236, 0.04411764705882354, 0.9264705882352939, 0.926470588235294, 0.6617647058823528, 0.48529411764705893, 0.13235294117647053, 0.5735294117647058, 0.3088235294117647]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8978, 'compress@10': 0.6796, 'time@10': 8.3192}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8978, 'compress@10': 0.6796, 'time@10': 8.3192}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9327, 'compress@10': 0.4911, 'time@10': 7.931}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9327, 'compress@10': 0.4911, 'time@10': 7.931}:  20%|██        | 2/10 [00:11<00:49,  6.19s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9075, 'compress@10': 0.3876, 'time@10': 7.2218}:  20%|██        | 2/10 [00:14<00:49,  6.19s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9075, 'compress@10': 0.3876, 'time@10': 7.2218}:  30%|███       | 3/10 [00:14<00:32,  4.70s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9147, 'compress@10': 0.523, 'time@10': 6.8265}:  30%|███       | 3/10 [00:20<00:32,  4.70s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9147, 'compress@10': 0.523, 'time@10': 6.8265}:  40%|████      | 4/10 [00:20<00:30,  5.09s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.9186, 'compress@10': 0.604, 'time@10': 7.9779}:  40%|████      | 4/10 [00:26<00:30,  5.09s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.9186, 'compress@10': 0.604, 'time@10': 7.9779}:  50%|█████     | 5/10 [00:26<00:27,  5.54s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.928, 'compress@10': 0.6149, 'time@10': 8.279}:  50%|█████     | 5/10 [00:36<00:27,  5.54s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.928, 'compress@10': 0.6149, 'time@10': 8.279}:  60%|██████    | 6/10 [00:36<00:27,  6.99s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9317, 'compress@10': 0.5993, 'time@10': 8.7158}:  60%|██████    | 6/10 [00:42<00:27,  6.99s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9317, 'compress@10': 0.5993, 'time@10': 8.7158}:  70%|███████   | 7/10 [00:42<00:19,  6.57s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9327, 'compress@10': 0.544, 'time@10': 8.6133}:  70%|███████   | 7/10 [00:50<00:19,  6.57s/it]  {'epoch': 33, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9327, 'compress@10': 0.544, 'time@10': 8.6133}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9267, 'compress@10': 0.5487, 'time@10': 9.2492}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9267, 'compress@10': 0.5487, 'time@10': 9.2492}:  90%|█████████ | 9/10 [00:57<00:07,  7.07s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9292, 'compress@10': 0.5262, 'time@10': 9.3415}:  90%|█████████ | 9/10 [01:07<00:07,  7.07s/it]    {'epoch': 33, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9292, 'compress@10': 0.5262, 'time@10': 9.3415}: 100%|██████████| 10/10 [01:07<00:00,  8.04s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9292, 'compress@10': 0.5262, 'time@10': 9.3415}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.01570909684729359
Avg hit ratio: 0.8850299110434934
Avg ndcg: 0.9291786520059692
Avg compression ratio: 0.5262451411919343
Avg train time: 9.341546297073364
Std train time: 2.7003042079887556
[0.6714285714285714, 0.27142857142857146, 0.042857142857142864, 0.9285714285714284, 0.8999999999999999, 0.6428571428571427, 0.47142857142857153, 0.15714285714285708, 0.5857142857142856, 0.32857142857142857]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.6887, 'time@10': 8.4556}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.6887, 'time@10': 8.4556}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9466, 'compress@10': 0.4918, 'time@10': 7.8812}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9466, 'compress@10': 0.4918, 'time@10': 7.8812}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9168, 'compress@10': 0.3878, 'time@10': 7.1083}:  20%|██        | 2/10 [00:14<00:48,  6.08s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9168, 'compress@10': 0.3878, 'time@10': 7.1083}:  30%|███       | 3/10 [00:14<00:32,  4.59s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9251, 'compress@10': 0.5236, 'time@10': 6.7169}:  30%|███       | 3/10 [00:20<00:32,  4.59s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9251, 'compress@10': 0.5236, 'time@10': 6.7169}:  40%|████      | 4/10 [00:20<00:29,  4.98s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9293, 'compress@10': 0.5993, 'time@10': 7.8392}:  40%|████      | 4/10 [00:26<00:29,  4.98s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9293, 'compress@10': 0.5993, 'time@10': 7.8392}:  50%|█████     | 5/10 [00:26<00:27,  5.42s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9362, 'compress@10': 0.6079, 'time@10': 8.2077}:  50%|█████     | 5/10 [00:36<00:27,  5.42s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9362, 'compress@10': 0.6079, 'time@10': 8.2077}:  60%|██████    | 6/10 [00:36<00:28,  7.01s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9412, 'compress@10': 0.5914, 'time@10': 8.7025}:  60%|██████    | 6/10 [00:42<00:28,  7.01s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9412, 'compress@10': 0.5914, 'time@10': 8.7025}:  70%|███████   | 7/10 [00:42<00:19,  6.64s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9668, 'compress@10': 0.5401, 'time@10': 8.589}:  70%|███████   | 7/10 [00:50<00:19,  6.64s/it]  {'epoch': 34, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9668, 'compress@10': 0.5401, 'time@10': 8.589}:  80%|████████  | 8/10 [00:50<00:14,  7.02s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9699, 'compress@10': 0.5465, 'time@10': 9.2244}:  80%|████████  | 8/10 [00:57<00:14,  7.02s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9699, 'compress@10': 0.5465, 'time@10': 9.2244}:  90%|█████████ | 9/10 [00:57<00:07,  7.07s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9695, 'compress@10': 0.5262, 'time@10': 9.3079}:  90%|█████████ | 9/10 [01:07<00:07,  7.07s/it]    {'epoch': 34, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9695, 'compress@10': 0.5262, 'time@10': 9.3079}: 100%|██████████| 10/10 [01:07<00:00,  8.01s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9695, 'compress@10': 0.5262, 'time@10': 9.3079}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.017028597558770155
Avg hit ratio: 0.8870934031069855
Avg ndcg: 0.9695226533493164
Avg compression ratio: 0.5262300814110941
Avg train time: 9.307930874824525
Std train time: 2.7576786793744956
[0.6527777777777777, 0.2916666666666667, 0.04166666666666667, 0.9027777777777776, 0.8749999999999999, 0.6249999999999998, 0.4861111111111112, 0.1805555555555555, 0.5972222222222221, 0.3472222222222222]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9162, 'compress@10': 0.671, 'time@10': 8.5034}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9162, 'compress@10': 0.671, 'time@10': 8.5034}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9447, 'compress@10': 0.4928, 'time@10': 7.9386}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9447, 'compress@10': 0.4928, 'time@10': 7.9386}:  20%|██        | 2/10 [00:11<00:49,  6.13s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9155, 'compress@10': 0.3881, 'time@10': 7.2568}:  20%|██        | 2/10 [00:14<00:49,  6.13s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9155, 'compress@10': 0.3881, 'time@10': 7.2568}:  30%|███       | 3/10 [00:14<00:32,  4.70s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9267, 'compress@10': 0.5176, 'time@10': 6.8232}:  30%|███       | 3/10 [00:20<00:32,  4.70s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9267, 'compress@10': 0.5176, 'time@10': 6.8232}:  40%|████      | 4/10 [00:20<00:30,  5.04s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9291, 'compress@10': 0.5896, 'time@10': 7.9283}:  40%|████      | 4/10 [00:26<00:30,  5.04s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9291, 'compress@10': 0.5896, 'time@10': 7.9283}:  50%|█████     | 5/10 [00:26<00:27,  5.46s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.9106, 'ndcg@10': 0.9375, 'compress@10': 0.5969, 'time@10': 8.3057}:  50%|█████     | 5/10 [00:36<00:27,  5.46s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.9106, 'ndcg@10': 0.9375, 'compress@10': 0.5969, 'time@10': 8.3057}:  60%|██████    | 6/10 [00:36<00:28,  7.08s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9382, 'compress@10': 0.584, 'time@10': 8.7563}:  60%|██████    | 6/10 [00:42<00:28,  7.08s/it] {'epoch': 35, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9382, 'compress@10': 0.584, 'time@10': 8.7563}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9369, 'compress@10': 0.5365, 'time@10': 8.6381}:  70%|███████   | 7/10 [00:50<00:19,  6.66s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9369, 'compress@10': 0.5365, 'time@10': 8.6381}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9301, 'compress@10': 0.5445, 'time@10': 9.2739}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9301, 'compress@10': 0.5445, 'time@10': 9.2739}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9329, 'compress@10': 0.5263, 'time@10': 9.3681}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9329, 'compress@10': 0.5263, 'time@10': 9.3681}: 100%|██████████| 10/10 [01:07<00:00,  8.07s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9329, 'compress@10': 0.5263, 'time@10': 9.3681}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.015142582818510547
Avg hit ratio: 0.9029331368499449
Avg ndcg: 0.9328637381823821
Avg compression ratio: 0.5262627312336333
Avg train time: 9.368079209327698
Std train time: 2.712905838851516
[0.6351351351351351, 0.2837837837837838, 0.04054054054054054, 0.8783783783783782, 0.8783783783783783, 0.6081081081081079, 0.5000000000000001, 0.20270270270270266, 0.608108108108108, 0.36486486486486486]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9138, 'compress@10': 0.6543, 'time@10': 8.3749}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9138, 'compress@10': 0.6543, 'time@10': 8.3749}:  10%|█         | 1/10 [00:04<00:38,  4.22s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9403, 'compress@10': 0.4806, 'time@10': 7.7251}:  10%|█         | 1/10 [00:11<00:38,  4.22s/it]  {'epoch': 36, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9403, 'compress@10': 0.4806, 'time@10': 7.7251}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9126, 'compress@10': 0.3796, 'time@10': 7.0676}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9126, 'compress@10': 0.3796, 'time@10': 7.0676}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9199, 'compress@10': 0.5054, 'time@10': 6.6931}:  30%|███       | 3/10 [00:19<00:31,  4.55s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9199, 'compress@10': 0.5054, 'time@10': 6.6931}:  40%|████      | 4/10 [00:19<00:29,  4.97s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9266, 'compress@10': 0.5805, 'time@10': 7.8326}:  40%|████      | 4/10 [00:26<00:29,  4.97s/it]  {'epoch': 36, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9266, 'compress@10': 0.5805, 'time@10': 7.8326}:  50%|█████     | 5/10 [00:26<00:27,  5.42s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9356, 'compress@10': 0.5865, 'time@10': 8.221}:  50%|█████     | 5/10 [00:36<00:27,  5.42s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9356, 'compress@10': 0.5865, 'time@10': 8.221}:  60%|██████    | 6/10 [00:36<00:28,  7.05s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9383, 'compress@10': 0.577, 'time@10': 8.6549}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9383, 'compress@10': 0.577, 'time@10': 8.6549}:  70%|███████   | 7/10 [00:41<00:19,  6.60s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9547, 'compress@10': 0.5331, 'time@10': 8.547}:  70%|███████   | 7/10 [00:49<00:19,  6.60s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9547, 'compress@10': 0.5331, 'time@10': 8.547}:  80%|████████  | 8/10 [00:49<00:13,  6.99s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9559, 'compress@10': 0.5427, 'time@10': 9.1712}:  80%|████████  | 8/10 [00:56<00:13,  6.99s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9559, 'compress@10': 0.5427, 'time@10': 9.1712}:  90%|█████████ | 9/10 [00:56<00:07,  7.03s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9581, 'compress@10': 0.5263, 'time@10': 9.2534}:  90%|█████████ | 9/10 [01:06<00:07,  7.03s/it]  {'epoch': 36, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9581, 'compress@10': 0.5263, 'time@10': 9.2534}: 100%|██████████| 10/10 [01:06<00:00,  7.96s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9581, 'compress@10': 0.5263, 'time@10': 9.2534}: 100%|██████████| 10/10 [01:06<00:00,  6.69s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.012868116632835745
Avg hit ratio: 0.8864584824720648
Avg ndcg: 0.9580720344882394
Avg compression ratio: 0.526323834426686
Avg train time: 9.253435921669006
Std train time: 2.6988984981579076
[0.6447368421052632, 0.27631578947368424, 0.03947368421052632, 0.8815789473684209, 0.881578947368421, 0.6184210526315788, 0.486842105263158, 0.22368421052631574, 0.5921052631578947, 0.35526315789473684]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.6634, 'time@10': 8.4912}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.6634, 'time@10': 8.4912}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9588, 'compress@10': 0.4815, 'time@10': 7.8968}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9588, 'compress@10': 0.4815, 'time@10': 7.8968}:  20%|██        | 2/10 [00:11<00:48,  6.09s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9249, 'compress@10': 0.3799, 'time@10': 7.137}:  20%|██        | 2/10 [00:14<00:48,  6.09s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9249, 'compress@10': 0.3799, 'time@10': 7.137}:  30%|███       | 3/10 [00:14<00:32,  4.61s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9327, 'compress@10': 0.5064, 'time@10': 6.7669}:  30%|███       | 3/10 [00:20<00:32,  4.61s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9327, 'compress@10': 0.5064, 'time@10': 6.7669}:  40%|████      | 4/10 [00:20<00:30,  5.04s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9352, 'compress@10': 0.5819, 'time@10': 7.9664}:  40%|████      | 4/10 [00:26<00:30,  5.04s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9352, 'compress@10': 0.5819, 'time@10': 7.9664}:  50%|█████     | 5/10 [00:26<00:27,  5.54s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.945, 'compress@10': 0.5894, 'time@10': 8.3456}:  50%|█████     | 5/10 [00:36<00:27,  5.54s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.945, 'compress@10': 0.5894, 'time@10': 8.3456}:  60%|██████    | 6/10 [00:36<00:28,  7.15s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9462, 'compress@10': 0.5777, 'time@10': 8.7673}:  60%|██████    | 6/10 [00:42<00:28,  7.15s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9462, 'compress@10': 0.5777, 'time@10': 8.7673}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9679, 'compress@10': 0.5362, 'time@10': 8.6514}:  70%|███████   | 7/10 [00:50<00:20,  6.67s/it]  {'epoch': 37, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9679, 'compress@10': 0.5362, 'time@10': 8.6514}:  80%|████████  | 8/10 [00:50<00:14,  7.05s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9847, 'compress@10': 0.5437, 'time@10': 9.2654}:  80%|████████  | 8/10 [00:57<00:14,  7.05s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9847, 'compress@10': 0.5437, 'time@10': 9.2654}:  90%|█████████ | 9/10 [00:57<00:07,  7.08s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9791, 'compress@10': 0.5263, 'time@10': 9.3437}:  90%|█████████ | 9/10 [01:07<00:07,  7.08s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9791, 'compress@10': 0.5263, 'time@10': 9.3437}: 100%|██████████| 10/10 [01:07<00:00,  8.01s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9791, 'compress@10': 0.5263, 'time@10': 9.3437}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.018327088513776478
Avg hit ratio: 0.8960334952728841
Avg ndcg: 0.9791273890666415
Avg compression ratio: 0.5263332337622029
Avg train time: 9.343715953826905
Std train time: 2.7353956173864686
[0.6282051282051282, 0.2948717948717949, 0.038461538461538464, 0.8589743589743588, 0.8589743589743589, 0.628205128205128, 0.4743589743589745, 0.24358974358974353, 0.6025641025641025, 0.3717948717948718]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9246, 'compress@10': 0.6478, 'time@10': 8.567}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9246, 'compress@10': 0.6478, 'time@10': 8.567}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9462, 'compress@10': 0.4827, 'time@10': 7.9791}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9462, 'compress@10': 0.4827, 'time@10': 7.9791}:  20%|██        | 2/10 [00:11<00:49,  6.15s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9165, 'compress@10': 0.3804, 'time@10': 7.2424}:  20%|██        | 2/10 [00:14<00:49,  6.15s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9165, 'compress@10': 0.3804, 'time@10': 7.2424}:  30%|███       | 3/10 [00:14<00:32,  4.68s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9274, 'compress@10': 0.5013, 'time@10': 6.913}:  30%|███       | 3/10 [00:20<00:32,  4.68s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9274, 'compress@10': 0.5013, 'time@10': 6.913}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9329, 'compress@10': 0.5734, 'time@10': 8.0985}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9329, 'compress@10': 0.5734, 'time@10': 8.0985}:  50%|█████     | 5/10 [00:27<00:28,  5.64s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.9106, 'ndcg@10': 0.9401, 'compress@10': 0.5839, 'time@10': 8.4649}:  50%|█████     | 5/10 [00:37<00:28,  5.64s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.9106, 'ndcg@10': 0.9401, 'compress@10': 0.5839, 'time@10': 8.4649}:  60%|██████    | 6/10 [00:37<00:28,  7.24s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.942, 'compress@10': 0.5713, 'time@10': 8.8966}:  60%|██████    | 6/10 [00:43<00:28,  7.24s/it]  {'epoch': 38, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.942, 'compress@10': 0.5713, 'time@10': 8.8966}:  70%|███████   | 7/10 [00:43<00:20,  6.76s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9449, 'compress@10': 0.533, 'time@10': 8.7691}:  70%|███████   | 7/10 [00:51<00:20,  6.76s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9449, 'compress@10': 0.533, 'time@10': 8.7691}:  80%|████████  | 8/10 [00:51<00:14,  7.13s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9465, 'compress@10': 0.542, 'time@10': 9.3666}:  80%|████████  | 8/10 [00:58<00:14,  7.13s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9465, 'compress@10': 0.542, 'time@10': 9.3666}:  90%|█████████ | 9/10 [00:58<00:07,  7.13s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9495, 'compress@10': 0.5264, 'time@10': 9.4532}:  90%|█████████ | 9/10 [01:08<00:07,  7.13s/it]  {'epoch': 38, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9495, 'compress@10': 0.5264, 'time@10': 9.4532}: 100%|██████████| 10/10 [01:08<00:00,  8.10s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9495, 'compress@10': 0.5264, 'time@10': 9.4532}: 100%|██████████| 10/10 [01:08<00:00,  6.85s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.01104098031425747
Avg hit ratio: 0.9086474225642306
Avg ndcg: 0.9495459832423718
Avg compression ratio: 0.5264034555410423
Avg train time: 9.453179621696473
Std train time: 2.6927473919854568
[0.6375, 0.28750000000000003, 0.037500000000000006, 0.8624999999999998, 0.8624999999999999, 0.6124999999999998, 0.48750000000000016, 0.23749999999999993, 0.6124999999999999, 0.3625]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9311, 'compress@10': 0.6566, 'time@10': 8.7425}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9311, 'compress@10': 0.6566, 'time@10': 8.7425}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9501, 'compress@10': 0.4835, 'time@10': 7.9139}:  10%|█         | 1/10 [00:11<00:39,  4.41s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9501, 'compress@10': 0.4835, 'time@10': 7.9139}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9191, 'compress@10': 0.3807, 'time@10': 7.1583}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9191, 'compress@10': 0.3807, 'time@10': 7.1583}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9288, 'compress@10': 0.5024, 'time@10': 6.8615}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9288, 'compress@10': 0.5024, 'time@10': 6.8615}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.934, 'compress@10': 0.5749, 'time@10': 8.043}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it]  {'epoch': 39, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.934, 'compress@10': 0.5749, 'time@10': 8.043}:  50%|█████     | 5/10 [00:26<00:28,  5.60s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0104, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9416, 'compress@10': 0.5826, 'time@10': 8.406}:  50%|█████     | 5/10 [00:37<00:28,  5.60s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0104, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9416, 'compress@10': 0.5826, 'time@10': 8.406}:  60%|██████    | 6/10 [00:37<00:28,  7.18s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9436, 'compress@10': 0.572, 'time@10': 8.8311}:  60%|██████    | 6/10 [00:42<00:28,  7.18s/it] {'epoch': 39, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9436, 'compress@10': 0.572, 'time@10': 8.8311}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9469, 'compress@10': 0.5329, 'time@10': 8.7189}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9469, 'compress@10': 0.5329, 'time@10': 8.7189}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9639, 'compress@10': 0.543, 'time@10': 9.3071}:  80%|████████  | 8/10 [00:57<00:14,  7.11s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9639, 'compress@10': 0.543, 'time@10': 9.3071}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9625, 'compress@10': 0.5264, 'time@10': 9.3817}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]  {'epoch': 39, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9625, 'compress@10': 0.5264, 'time@10': 9.3817}: 100%|██████████| 10/10 [01:07<00:00,  8.01s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9625, 'compress@10': 0.5264, 'time@10': 9.3817}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.012673778918972886
Avg hit ratio: 0.8935219745355569
Avg ndcg: 0.9625241353990311
Avg compression ratio: 0.5263630645637286
Avg train time: 9.381662631034851
Std train time: 2.6726347391945047
[0.6219512195121951, 0.2804878048780488, 0.03658536585365854, 0.8658536585365852, 0.8658536585365852, 0.6219512195121949, 0.4756097560975611, 0.23170731707317066, 0.621951219512195, 0.3780487804878049]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.936, 'compress@10': 0.6418, 'time@10': 8.3944}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.936, 'compress@10': 0.6418, 'time@10': 8.3944}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9606, 'compress@10': 0.4728, 'time@10': 7.7621}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9606, 'compress@10': 0.4728, 'time@10': 7.7621}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9261, 'compress@10': 0.3733, 'time@10': 7.0346}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9261, 'compress@10': 0.3733, 'time@10': 7.0346}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9347, 'compress@10': 0.4976, 'time@10': 6.7171}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9347, 'compress@10': 0.4976, 'time@10': 6.7171}:  40%|████      | 4/10 [00:20<00:30,  5.04s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9388, 'compress@10': 0.5718, 'time@10': 8.0426}:  40%|████      | 4/10 [00:26<00:30,  5.04s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9388, 'compress@10': 0.5718, 'time@10': 8.0426}:  50%|█████     | 5/10 [00:26<00:28,  5.64s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.945, 'compress@10': 0.5815, 'time@10': 8.3773}:  50%|█████     | 5/10 [00:36<00:28,  5.64s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.945, 'compress@10': 0.5815, 'time@10': 8.3773}:  60%|██████    | 6/10 [00:36<00:28,  7.16s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9458, 'compress@10': 0.5694, 'time@10': 8.7826}:  60%|██████    | 6/10 [00:42<00:28,  7.16s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9458, 'compress@10': 0.5694, 'time@10': 8.7826}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9616, 'compress@10': 0.5299, 'time@10': 8.6515}:  70%|███████   | 7/10 [00:50<00:19,  6.66s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9616, 'compress@10': 0.5299, 'time@10': 8.6515}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.959, 'compress@10': 0.5414, 'time@10': 9.2611}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.959, 'compress@10': 0.5414, 'time@10': 9.2611}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9608, 'compress@10': 0.5264, 'time@10': 9.3514}:  90%|█████████ | 9/10 [01:07<00:07,  7.04s/it]  {'epoch': 40, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9608, 'compress@10': 0.5264, 'time@10': 9.3514}: 100%|██████████| 10/10 [01:07<00:00,  8.02s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9608, 'compress@10': 0.5264, 'time@10': 9.3514}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.01220885204168682
Avg hit ratio: 0.9011128603522491
Avg ndcg: 0.960841026986316
Avg compression ratio: 0.5264447884791351
Avg train time: 9.35141146183014
Std train time: 2.8113853901979806
[0.6071428571428571, 0.29761904761904767, 0.03571428571428572, 0.869047619047619, 0.869047619047619, 0.6071428571428569, 0.4642857142857144, 0.24999999999999992, 0.6309523809523808, 0.36904761904761907]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.913, 'compress@10': 0.6278, 'time@10': 8.5453}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.913, 'compress@10': 0.6278, 'time@10': 8.5453}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9415, 'compress@10': 0.474, 'time@10': 7.8231}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9415, 'compress@10': 0.474, 'time@10': 7.8231}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9134, 'compress@10': 0.3739, 'time@10': 7.114}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9134, 'compress@10': 0.3739, 'time@10': 7.114}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9248, 'compress@10': 0.4988, 'time@10': 6.8207}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9248, 'compress@10': 0.4988, 'time@10': 6.8207}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9318, 'compress@10': 0.5734, 'time@10': 8.0527}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9318, 'compress@10': 0.5734, 'time@10': 8.0527}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.91, 'ndcg@10': 0.9481, 'compress@10': 0.5805, 'time@10': 8.4216}:  50%|█████     | 5/10 [00:37<00:28,  5.63s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.91, 'ndcg@10': 0.9481, 'compress@10': 0.5805, 'time@10': 8.4216}:  60%|██████    | 6/10 [00:37<00:28,  7.22s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9559, 'compress@10': 0.5669, 'time@10': 8.8497}:  60%|██████    | 6/10 [00:42<00:28,  7.22s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9559, 'compress@10': 0.5669, 'time@10': 8.8497}:  70%|███████   | 7/10 [00:42<00:20,  6.74s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9709, 'compress@10': 0.53, 'time@10': 8.77}:  70%|███████   | 7/10 [00:51<00:20,  6.74s/it]     {'epoch': 41, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9709, 'compress@10': 0.53, 'time@10': 8.77}:  80%|████████  | 8/10 [00:51<00:14,  7.22s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9801, 'compress@10': 0.5424, 'time@10': 9.3783}:  80%|████████  | 8/10 [00:58<00:14,  7.22s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9801, 'compress@10': 0.5424, 'time@10': 9.3783}:  90%|█████████ | 9/10 [00:58<00:07,  7.20s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9752, 'compress@10': 0.5265, 'time@10': 9.4555}:  90%|█████████ | 9/10 [01:08<00:07,  7.20s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9752, 'compress@10': 0.5265, 'time@10': 9.4555}: 100%|██████████| 10/10 [01:08<00:00,  8.12s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9752, 'compress@10': 0.5265, 'time@10': 9.4555}: 100%|██████████| 10/10 [01:08<00:00,  6.85s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.01767588800108716
Avg hit ratio: 0.9111589433015578
Avg ndcg: 0.9751645461370773
Avg compression ratio: 0.5264827016561694
Avg train time: 9.455507636070251
Std train time: 2.734292794639213
[0.5930232558139534, 0.2906976744186047, 0.034883720930232565, 0.8488372093023255, 0.8488372093023255, 0.6162790697674416, 0.47674418604651175, 0.2674418604651162, 0.6395348837209301, 0.38372093023255816]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.936, 'compress@10': 0.6144, 'time@10': 8.4612}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.936, 'compress@10': 0.6144, 'time@10': 8.4612}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9876, 'compress@10': 0.464, 'time@10': 7.8064}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it] {'epoch': 42, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9876, 'compress@10': 0.464, 'time@10': 7.8064}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9441, 'compress@10': 0.3669, 'time@10': 7.0856}:  20%|██        | 2/10 [00:14<00:47,  6.00s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9441, 'compress@10': 0.3669, 'time@10': 7.0856}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9484, 'compress@10': 0.4888, 'time@10': 6.809}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9484, 'compress@10': 0.4888, 'time@10': 6.809}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9511, 'compress@10': 0.5614, 'time@10': 8.0356}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9511, 'compress@10': 0.5614, 'time@10': 8.0356}:  50%|█████     | 5/10 [00:26<00:28,  5.64s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9553, 'compress@10': 0.5719, 'time@10': 8.3786}:  50%|█████     | 5/10 [00:37<00:28,  5.64s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9553, 'compress@10': 0.5719, 'time@10': 8.3786}:  60%|██████    | 6/10 [00:37<00:28,  7.16s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9554, 'compress@10': 0.5613, 'time@10': 8.7709}:  60%|██████    | 6/10 [00:42<00:28,  7.16s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9554, 'compress@10': 0.5613, 'time@10': 8.7709}:  70%|███████   | 7/10 [00:42<00:19,  6.65s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9576, 'compress@10': 0.5272, 'time@10': 8.6642}:  70%|███████   | 7/10 [00:50<00:19,  6.65s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9576, 'compress@10': 0.5272, 'time@10': 8.6642}:  80%|████████  | 8/10 [00:50<00:14,  7.07s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9576, 'compress@10': 0.5408, 'time@10': 9.2543}:  80%|████████  | 8/10 [00:57<00:14,  7.07s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9576, 'compress@10': 0.5408, 'time@10': 9.2543}:  90%|█████████ | 9/10 [00:57<00:07,  7.06s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0114, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9596, 'compress@10': 0.5265, 'time@10': 9.3453}:  90%|█████████ | 9/10 [01:07<00:07,  7.06s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0114, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9596, 'compress@10': 0.5265, 'time@10': 9.3453}: 100%|██████████| 10/10 [01:07<00:00,  8.03s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0114, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9596, 'compress@10': 0.5265, 'time@10': 9.3453}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.011445528071745202
Avg hit ratio: 0.898890638130027
Avg ndcg: 0.9595814634748958
Avg compression ratio: 0.5265260734377781
Avg train time: 9.345348072052001
Std train time: 2.6727661680783985
[0.5795454545454545, 0.3068181818181819, 0.034090909090909095, 0.8522727272727272, 0.8522727272727272, 0.6022727272727271, 0.46590909090909105, 0.284090909090909, 0.6477272727272726, 0.375]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9342, 'compress@10': 0.6017, 'time@10': 8.4271}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9342, 'compress@10': 0.6017, 'time@10': 8.4271}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9476, 'compress@10': 0.4654, 'time@10': 7.8171}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9476, 'compress@10': 0.4654, 'time@10': 7.8171}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9175, 'compress@10': 0.3676, 'time@10': 7.1007}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9175, 'compress@10': 0.3676, 'time@10': 7.1007}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9287, 'compress@10': 0.4901, 'time@10': 6.8192}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9287, 'compress@10': 0.4901, 'time@10': 6.8192}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.009, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9356, 'compress@10': 0.5631, 'time@10': 8.1041}:  40%|████      | 4/10 [00:27<00:30,  5.15s/it] {'epoch': 43, 'num_users': 5.8, 'loss': 0.009, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9356, 'compress@10': 0.5631, 'time@10': 8.1041}:  50%|█████     | 5/10 [00:27<00:28,  5.69s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9423, 'compress@10': 0.5711, 'time@10': 8.4808}:  50%|█████     | 5/10 [00:37<00:28,  5.69s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9423, 'compress@10': 0.5711, 'time@10': 8.4808}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9446, 'compress@10': 0.5592, 'time@10': 8.8839}:  60%|██████    | 6/10 [00:43<00:29,  7.29s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9446, 'compress@10': 0.5592, 'time@10': 8.8839}:  70%|███████   | 7/10 [00:43<00:20,  6.77s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9497, 'compress@10': 0.5273, 'time@10': 8.7896}:  70%|███████   | 7/10 [00:51<00:20,  6.77s/it]  {'epoch': 43, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9497, 'compress@10': 0.5273, 'time@10': 8.7896}:  80%|████████  | 8/10 [00:51<00:14,  7.21s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9631, 'compress@10': 0.5418, 'time@10': 9.4082}:  80%|████████  | 8/10 [00:58<00:14,  7.21s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9631, 'compress@10': 0.5418, 'time@10': 9.4082}:  90%|█████████ | 9/10 [00:58<00:07,  7.21s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9608, 'compress@10': 0.5266, 'time@10': 9.4912}:  90%|█████████ | 9/10 [01:08<00:07,  7.21s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9608, 'compress@10': 0.5266, 'time@10': 9.4912}: 100%|██████████| 10/10 [01:08<00:00,  8.16s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9608, 'compress@10': 0.5266, 'time@10': 9.4912}: 100%|██████████| 10/10 [01:08<00:00,  6.88s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.012405959520084487
Avg hit ratio: 0.8907902797070879
Avg ndcg: 0.9607746549341118
Avg compression ratio: 0.526559224065911
Avg train time: 9.49121825695038
Std train time: 2.784699590443582
[0.5666666666666667, 0.3222222222222223, 0.03333333333333334, 0.8555555555555555, 0.8333333333333333, 0.5888888888888887, 0.4555555555555557, 0.29999999999999993, 0.6555555555555554, 0.3888888888888889]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.936, 'compress@10': 0.5895, 'time@10': 8.2619}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.936, 'compress@10': 0.5895, 'time@10': 8.2619}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9419, 'compress@10': 0.4668, 'time@10': 7.6777}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9419, 'compress@10': 0.4668, 'time@10': 7.6777}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9137, 'compress@10': 0.3683, 'time@10': 7.1106}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9137, 'compress@10': 0.3683, 'time@10': 7.1106}:  30%|███       | 3/10 [00:14<00:32,  4.60s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9255, 'compress@10': 0.4914, 'time@10': 6.8381}:  30%|███       | 3/10 [00:20<00:32,  4.60s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9255, 'compress@10': 0.4914, 'time@10': 6.8381}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9335, 'compress@10': 0.5605, 'time@10': 8.11}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]   {'epoch': 44, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9335, 'compress@10': 0.5605, 'time@10': 8.11}:  50%|█████     | 5/10 [00:27<00:28,  5.71s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9407, 'compress@10': 0.5667, 'time@10': 8.4873}:  50%|█████     | 5/10 [00:37<00:28,  5.71s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9407, 'compress@10': 0.5667, 'time@10': 8.4873}:  60%|██████    | 6/10 [00:37<00:29,  7.31s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9432, 'compress@10': 0.554, 'time@10': 8.8911}:  60%|██████    | 6/10 [00:43<00:29,  7.31s/it] {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9432, 'compress@10': 0.554, 'time@10': 8.8911}:  70%|███████   | 7/10 [00:43<00:20,  6.78s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9497, 'compress@10': 0.5247, 'time@10': 8.7785}:  70%|███████   | 7/10 [00:51<00:20,  6.78s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9497, 'compress@10': 0.5247, 'time@10': 8.7785}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9482, 'compress@10': 0.5403, 'time@10': 9.3787}:  80%|████████  | 8/10 [00:58<00:14,  7.18s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9482, 'compress@10': 0.5403, 'time@10': 9.3787}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9511, 'compress@10': 0.5266, 'time@10': 9.4581}:  90%|█████████ | 9/10 [01:08<00:07,  7.16s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9511, 'compress@10': 0.5266, 'time@10': 9.4581}: 100%|██████████| 10/10 [01:08<00:00,  8.10s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9511, 'compress@10': 0.5266, 'time@10': 9.4581}: 100%|██████████| 10/10 [01:08<00:00,  6.85s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.01177036989248745
Avg hit ratio: 0.8910565367475385
Avg ndcg: 0.9511381124120437
Avg compression ratio: 0.5265858077528618
Avg train time: 9.458086800575256
Std train time: 2.7238005147376554
[0.5543478260869565, 0.3369565217391305, 0.03260869565217392, 0.858695652173913, 0.8152173913043478, 0.5978260869565215, 0.4456521739130436, 0.3152173913043478, 0.6630434782608695, 0.3804347826086957]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.936, 'compress@10': 0.5778, 'time@10': 8.5777}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.936, 'compress@10': 0.5778, 'time@10': 8.5777}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9519, 'compress@10': 0.4681, 'time@10': 7.8879}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9519, 'compress@10': 0.4681, 'time@10': 7.8879}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.004, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9203, 'compress@10': 0.369, 'time@10': 7.1276}:  20%|██        | 2/10 [00:14<00:48,  6.04s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.004, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9203, 'compress@10': 0.369, 'time@10': 7.1276}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9305, 'compress@10': 0.4927, 'time@10': 6.855}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9305, 'compress@10': 0.4927, 'time@10': 6.855}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9371, 'compress@10': 0.5579, 'time@10': 8.1767}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9371, 'compress@10': 0.5579, 'time@10': 8.1767}:  50%|█████     | 5/10 [00:27<00:28,  5.74s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.9448, 'compress@10': 0.5661, 'time@10': 8.5578}:  50%|█████     | 5/10 [00:37<00:28,  5.74s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.9448, 'compress@10': 0.5661, 'time@10': 8.5578}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9537, 'compress@10': 0.552, 'time@10': 8.9581}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it]  {'epoch': 45, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9537, 'compress@10': 0.552, 'time@10': 8.9581}:  70%|███████   | 7/10 [00:43<00:20,  6.82s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9574, 'compress@10': 0.5249, 'time@10': 8.8295}:  70%|███████   | 7/10 [00:51<00:20,  6.82s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9574, 'compress@10': 0.5249, 'time@10': 8.8295}:  80%|████████  | 8/10 [00:51<00:14,  7.19s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.975, 'compress@10': 0.5413, 'time@10': 9.4417}:  80%|████████  | 8/10 [00:58<00:14,  7.19s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.975, 'compress@10': 0.5413, 'time@10': 9.4417}:  90%|█████████ | 9/10 [00:58<00:07,  7.19s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.971, 'compress@10': 0.5266, 'time@10': 9.5195}:  90%|█████████ | 9/10 [01:08<00:07,  7.19s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.971, 'compress@10': 0.5266, 'time@10': 9.5195}: 100%|██████████| 10/10 [01:08<00:00,  8.14s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.971, 'compress@10': 0.5266, 'time@10': 9.5195}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.015736953326841822
Avg hit ratio: 0.8795255587649476
Avg ndcg: 0.9709649548523668
Avg compression ratio: 0.526613063423776
Avg train time: 9.519495511054993
Std train time: 2.824840302715739
[0.5425531914893618, 0.3297872340425532, 0.03191489361702128, 0.8404255319148936, 0.7978723404255319, 0.6063829787234041, 0.45744680851063846, 0.32978723404255317, 0.6702127659574467, 0.39361702127659576]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9371, 'compress@10': 0.5666, 'time@10': 8.3837}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9371, 'compress@10': 0.5666, 'time@10': 8.3837}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9524, 'compress@10': 0.459, 'time@10': 7.715}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]  {'epoch': 46, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9524, 'compress@10': 0.459, 'time@10': 7.715}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0027, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9207, 'compress@10': 0.3628, 'time@10': 7.0313}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0027, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9207, 'compress@10': 0.3628, 'time@10': 7.0313}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0045, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.9311, 'compress@10': 0.4836, 'time@10': 6.7945}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0045, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.9311, 'compress@10': 0.4836, 'time@10': 6.7945}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0053, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.9389, 'compress@10': 0.5473, 'time@10': 8.0971}:  40%|████      | 4/10 [00:26<00:30,  5.15s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0053, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.9389, 'compress@10': 0.5473, 'time@10': 8.0971}:  50%|█████     | 5/10 [00:26<00:28,  5.71s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0046, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9453, 'compress@10': 0.5586, 'time@10': 8.494}:  50%|█████     | 5/10 [00:37<00:28,  5.71s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0046, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9453, 'compress@10': 0.5586, 'time@10': 8.494}:  60%|██████    | 6/10 [00:37<00:29,  7.34s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.005, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9474, 'compress@10': 0.5472, 'time@10': 8.9382}:  60%|██████    | 6/10 [00:43<00:29,  7.34s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.005, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9474, 'compress@10': 0.5472, 'time@10': 8.9382}:  70%|███████   | 7/10 [00:43<00:20,  6.85s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0061, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9523, 'compress@10': 0.5224, 'time@10': 8.8176}:  70%|███████   | 7/10 [00:51<00:20,  6.85s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0061, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9523, 'compress@10': 0.5224, 'time@10': 8.8176}:  80%|████████  | 8/10 [00:51<00:14,  7.22s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0076, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9524, 'compress@10': 0.5399, 'time@10': 9.4495}:  80%|████████  | 8/10 [00:58<00:14,  7.22s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0076, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9524, 'compress@10': 0.5399, 'time@10': 9.4495}:  90%|█████████ | 9/10 [00:58<00:07,  7.24s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.007, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9549, 'compress@10': 0.5267, 'time@10': 9.5178}:  90%|█████████ | 9/10 [01:08<00:07,  7.24s/it]    {'epoch': 46, 'num_users': 6.3, 'loss': 0.007, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9549, 'compress@10': 0.5267, 'time@10': 9.5178}: 100%|██████████| 10/10 [01:08<00:00,  8.15s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.007, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9549, 'compress@10': 0.5267, 'time@10': 9.5178}: 100%|██████████| 10/10 [01:08<00:00,  6.88s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.0070171546783775575
Avg hit ratio: 0.8893617082785165
Avg ndcg: 0.9548828450741309
Avg compression ratio: 0.526651274352534
Avg train time: 9.517788195610047
Std train time: 2.8513596778349366
[0.5312500000000001, 0.3229166666666667, 0.03125000000000001, 0.8437499999999999, 0.8020833333333334, 0.5937499999999998, 0.46875000000000017, 0.34375, 0.6770833333333333, 0.3854166666666667]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.936, 'compress@10': 0.5559, 'time@10': 8.4404}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.936, 'compress@10': 0.5559, 'time@10': 8.4404}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9715, 'compress@10': 0.4503, 'time@10': 7.6712}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9715, 'compress@10': 0.4503, 'time@10': 7.6712}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9334, 'compress@10': 0.3568, 'time@10': 6.9905}:  20%|██        | 2/10 [00:14<00:46,  5.84s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9334, 'compress@10': 0.3568, 'time@10': 6.9905}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.9403, 'compress@10': 0.4799, 'time@10': 6.7924}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.9403, 'compress@10': 0.4799, 'time@10': 6.7924}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.9463, 'compress@10': 0.5451, 'time@10': 8.1641}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.9463, 'compress@10': 0.5451, 'time@10': 8.1641}:  50%|█████     | 5/10 [00:27<00:28,  5.79s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0101, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.951, 'compress@10': 0.5547, 'time@10': 8.5723}:  50%|█████     | 5/10 [00:37<00:28,  5.79s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0101, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.951, 'compress@10': 0.5547, 'time@10': 8.5723}:  60%|██████    | 6/10 [00:37<00:29,  7.44s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9521, 'compress@10': 0.5455, 'time@10': 8.9676}:  60%|██████    | 6/10 [00:43<00:29,  7.44s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9521, 'compress@10': 0.5455, 'time@10': 8.9676}:  70%|███████   | 7/10 [00:43<00:20,  6.87s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9575, 'compress@10': 0.5226, 'time@10': 8.8828}:  70%|███████   | 7/10 [00:51<00:20,  6.87s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9575, 'compress@10': 0.5226, 'time@10': 8.8828}:  80%|████████  | 8/10 [00:51<00:14,  7.34s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9648, 'compress@10': 0.5408, 'time@10': 9.4761}:  80%|████████  | 8/10 [00:58<00:14,  7.34s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9648, 'compress@10': 0.5408, 'time@10': 9.4761}:  90%|█████████ | 9/10 [00:58<00:07,  7.28s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9611, 'compress@10': 0.5267, 'time@10': 9.5627}:  90%|█████████ | 9/10 [01:09<00:07,  7.28s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9611, 'compress@10': 0.5267, 'time@10': 9.5627}: 100%|██████████| 10/10 [01:09<00:00,  8.24s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9611, 'compress@10': 0.5267, 'time@10': 9.5627}: 100%|██████████| 10/10 [01:09<00:00,  6.94s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.01197237533632704
Avg hit ratio: 0.8801763524157412
Avg ndcg: 0.9611490391907053
Avg compression ratio: 0.5266628392812741
Avg train time: 9.562716150283814
Std train time: 2.829407959756008
[0.5204081632653063, 0.33673469387755106, 0.03061224489795919, 0.846938775510204, 0.7857142857142857, 0.5816326530612242, 0.45918367346938793, 0.35714285714285715, 0.6836734693877551, 0.3979591836734694]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9371, 'compress@10': 0.5456, 'time@10': 8.69}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9371, 'compress@10': 0.5456, 'time@10': 8.69}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.952, 'compress@10': 0.4519, 'time@10': 7.8884}:  10%|█         | 1/10 [00:11<00:39,  4.38s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.952, 'compress@10': 0.4519, 'time@10': 7.8884}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9203, 'compress@10': 0.3576, 'time@10': 7.0778}:  20%|██        | 2/10 [00:14<00:47,  6.00s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9203, 'compress@10': 0.3576, 'time@10': 7.0778}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.9309, 'compress@10': 0.4813, 'time@10': 6.8296}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.9309, 'compress@10': 0.4813, 'time@10': 6.8296}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0072, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.9388, 'compress@10': 0.5431, 'time@10': 8.1466}:  40%|████      | 4/10 [00:27<00:30,  5.15s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0072, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.9388, 'compress@10': 0.5431, 'time@10': 8.1466}:  50%|█████     | 5/10 [00:27<00:28,  5.73s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0071, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9453, 'compress@10': 0.551, 'time@10': 8.5362}:  50%|█████     | 5/10 [00:37<00:28,  5.73s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0071, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9453, 'compress@10': 0.551, 'time@10': 8.5362}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.947, 'compress@10': 0.541, 'time@10': 8.9546}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it] {'epoch': 48, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.947, 'compress@10': 0.541, 'time@10': 8.9546}:  70%|███████   | 7/10 [00:43<00:20,  6.84s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0072, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.95, 'compress@10': 0.5203, 'time@10': 8.8369}:  70%|███████   | 7/10 [00:51<00:20,  6.84s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0072, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.95, 'compress@10': 0.5203, 'time@10': 8.8369}:  80%|████████  | 8/10 [00:51<00:14,  7.22s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9513, 'compress@10': 0.5395, 'time@10': 9.4213}:  80%|████████  | 8/10 [00:58<00:14,  7.22s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9513, 'compress@10': 0.5395, 'time@10': 9.4213}:  90%|█████████ | 9/10 [00:58<00:07,  7.18s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0082, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9539, 'compress@10': 0.5267, 'time@10': 9.5082}:  90%|█████████ | 9/10 [01:08<00:07,  7.18s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0082, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9539, 'compress@10': 0.5267, 'time@10': 9.5082}: 100%|██████████| 10/10 [01:08<00:00,  8.15s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0082, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9539, 'compress@10': 0.5267, 'time@10': 9.5082}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.008222762586866784
Avg hit ratio: 0.8881359018269036
Avg ndcg: 0.9539272870864893
Avg compression ratio: 0.5266863513119808
Avg train time: 9.50816993713379
Std train time: 2.803797599746378
[0.5100000000000001, 0.35000000000000003, 0.030000000000000006, 0.85, 0.79, 0.5699999999999997, 0.4500000000000002, 0.37, 0.69, 0.39]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9371, 'compress@10': 0.5358, 'time@10': 8.2877}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9371, 'compress@10': 0.5358, 'time@10': 8.2877}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9563, 'compress@10': 0.4534, 'time@10': 7.6865}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it] {'epoch': 49, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9563, 'compress@10': 0.4534, 'time@10': 7.6865}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9233, 'compress@10': 0.3584, 'time@10': 7.0276}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9233, 'compress@10': 0.3584, 'time@10': 7.0276}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9331, 'compress@10': 0.4827, 'time@10': 6.8032}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9331, 'compress@10': 0.4827, 'time@10': 6.8032}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9401, 'compress@10': 0.545, 'time@10': 8.2071}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9401, 'compress@10': 0.545, 'time@10': 8.2071}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.9464, 'compress@10': 0.5507, 'time@10': 8.5901}:  50%|█████     | 5/10 [00:37<00:29,  5.82s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.9464, 'compress@10': 0.5507, 'time@10': 8.5901}:  60%|██████    | 6/10 [00:37<00:29,  7.43s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9479, 'compress@10': 0.5395, 'time@10': 9.0327}:  60%|██████    | 6/10 [00:43<00:29,  7.43s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9479, 'compress@10': 0.5395, 'time@10': 9.0327}:  70%|███████   | 7/10 [00:43<00:20,  6.92s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9509, 'compress@10': 0.5206, 'time@10': 8.8829}:  70%|███████   | 7/10 [00:51<00:20,  6.92s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9509, 'compress@10': 0.5206, 'time@10': 8.8829}:  80%|████████  | 8/10 [00:51<00:14,  7.23s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9677, 'compress@10': 0.5404, 'time@10': 9.479}:  80%|████████  | 8/10 [00:58<00:14,  7.23s/it] {'epoch': 49, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9677, 'compress@10': 0.5404, 'time@10': 9.479}:  90%|█████████ | 9/10 [00:58<00:07,  7.21s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9646, 'compress@10': 0.5267, 'time@10': 9.529}:  90%|█████████ | 9/10 [01:08<00:07,  7.21s/it]  {'epoch': 49, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9646, 'compress@10': 0.5267, 'time@10': 9.529}: 100%|██████████| 10/10 [01:08<00:00,  8.07s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9646, 'compress@10': 0.5267, 'time@10': 9.529}: 100%|██████████| 10/10 [01:08<00:00,  6.88s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.012179697414022413
Avg hit ratio: 0.8788271460665349
Avg ndcg: 0.9646463341751417
Avg compression ratio: 0.5267125243064006
Avg train time: 9.528981184959411
Std train time: 2.8818579877408057
[0.5000000000000001, 0.36274509803921573, 0.02941176470588236, 0.8529411764705882, 0.7941176470588236, 0.5588235294117644, 0.44117647058823545, 0.3627450980392157, 0.696078431372549, 0.4019607843137255]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
 10, 21, 10, 6, 10, 10, 10, 9, 10]
