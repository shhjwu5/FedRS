  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1568, 'hit_ratio@10': 0.6316, 'ndcg@10': 0.4991, 'compress@10': 0.5082, 'time@10': 5.9546}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1568, 'hit_ratio@10': 0.6316, 'ndcg@10': 0.4991, 'compress@10': 0.5082, 'time@10': 5.9546}:  10%|█         | 1/10 [00:03<00:27,  3.02s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1142, 'hit_ratio@10': 0.7029, 'ndcg@10': 0.6498, 'compress@10': 0.5193, 'time@10': 5.0538}:  10%|█         | 1/10 [00:07<00:27,  3.02s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1142, 'hit_ratio@10': 0.7029, 'ndcg@10': 0.6498, 'compress@10': 0.5193, 'time@10': 5.0538}:  20%|██        | 2/10 [00:07<00:29,  3.71s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.77, 'hit_ratio@10': 0.6114, 'ndcg@10': 0.4332, 'compress@10': 0.5323, 'time@10': 3.9041}:  20%|██        | 2/10 [00:08<00:29,  3.71s/it]  {'epoch': 0, 'num_users': 5.0, 'loss': 0.77, 'hit_ratio@10': 0.6114, 'ndcg@10': 0.4332, 'compress@10': 0.5323, 'time@10': 3.9041}:  30%|███       | 3/10 [00:08<00:16,  2.40s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6012, 'hit_ratio@10': 0.6639, 'ndcg@10': 0.492, 'compress@10': 0.528, 'time@10': 3.8513}:  30%|███       | 3/10 [00:11<00:16,  2.40s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6012, 'hit_ratio@10': 0.6639, 'ndcg@10': 0.492, 'compress@10': 0.528, 'time@10': 3.8513}:  40%|████      | 4/10 [00:11<00:17,  2.93s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4996, 'hit_ratio@10': 0.6952, 'ndcg@10': 0.5459, 'compress@10': 0.5494, 'time@10': 5.825}:  40%|████      | 4/10 [00:18<00:17,  2.93s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4996, 'hit_ratio@10': 0.6952, 'ndcg@10': 0.5459, 'compress@10': 0.5494, 'time@10': 5.825}:  50%|█████     | 5/10 [00:18<00:21,  4.36s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4307, 'hit_ratio@10': 0.6904, 'ndcg@10': 0.5863, 'compress@10': 0.5565, 'time@10': 5.8786}:  50%|█████     | 5/10 [00:24<00:21,  4.36s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4307, 'hit_ratio@10': 0.6904, 'ndcg@10': 0.5863, 'compress@10': 0.5565, 'time@10': 5.8786}:  60%|██████    | 6/10 [00:24<00:19,  4.98s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3835, 'hit_ratio@10': 0.7003, 'ndcg@10': 0.5892, 'compress@10': 0.5504, 'time@10': 6.0028}:  60%|██████    | 6/10 [00:28<00:19,  4.98s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3835, 'hit_ratio@10': 0.7003, 'ndcg@10': 0.5892, 'compress@10': 0.5504, 'time@10': 6.0028}:  70%|███████   | 7/10 [00:28<00:13,  4.48s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3414, 'hit_ratio@10': 0.7271, 'ndcg@10': 0.6155, 'compress@10': 0.5591, 'time@10': 5.8388}:  70%|███████   | 7/10 [00:33<00:13,  4.48s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3414, 'hit_ratio@10': 0.7271, 'ndcg@10': 0.6155, 'compress@10': 0.5591, 'time@10': 5.8388}:  80%|████████  | 8/10 [00:33<00:09,  4.56s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3089, 'hit_ratio@10': 0.7257, 'ndcg@10': 0.6481, 'compress@10': 0.5532, 'time@10': 6.2452}:  80%|████████  | 8/10 [00:37<00:09,  4.56s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3089, 'hit_ratio@10': 0.7257, 'ndcg@10': 0.6481, 'compress@10': 0.5532, 'time@10': 6.2452}:  90%|█████████ | 9/10 [00:37<00:04,  4.63s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2833, 'hit_ratio@10': 0.7463, 'ndcg@10': 0.6678, 'compress@10': 0.5575, 'time@10': 6.2031}:  90%|█████████ | 9/10 [00:43<00:04,  4.63s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2833, 'hit_ratio@10': 0.7463, 'ndcg@10': 0.6678, 'compress@10': 0.5575, 'time@10': 6.2031}: 100%|██████████| 10/10 [00:43<00:00,  5.01s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2833, 'hit_ratio@10': 0.7463, 'ndcg@10': 0.6678, 'compress@10': 0.5575, 'time@10': 6.2031}: 100%|██████████| 10/10 [00:43<00:00,  4.37s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.2832895252910227
Avg hit ratio: 0.7462828772811794
Avg ndcg: 0.6678018625074215
Avg compression ratio: 0.5574697167046025
Avg train time: 6.2031432628631595
Std train time: 3.190335445391186
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0522, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8459, 'compress@10': 0.4637, 'time@10': 5.0685}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0522, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8459, 'compress@10': 0.4637, 'time@10': 5.0685}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0526, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8501, 'compress@10': 0.5063, 'time@10': 4.6215}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0526, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8501, 'compress@10': 0.5063, 'time@10': 4.6215}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0412, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.8245, 'compress@10': 0.531, 'time@10': 3.6724}:  20%|██        | 2/10 [00:07<00:28,  3.54s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.0412, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.8245, 'compress@10': 0.531, 'time@10': 3.6724}:  30%|███       | 3/10 [00:07<00:16,  2.35s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0433, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8291, 'compress@10': 0.5163, 'time@10': 3.6804}:  30%|███       | 3/10 [00:11<00:16,  2.35s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0433, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8291, 'compress@10': 0.5163, 'time@10': 3.6804}:  40%|████      | 4/10 [00:11<00:17,  2.90s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0521, 'hit_ratio@10': 0.7836, 'ndcg@10': 0.8203, 'compress@10': 0.5185, 'time@10': 5.4018}:  40%|████      | 4/10 [00:17<00:17,  2.90s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0521, 'hit_ratio@10': 0.7836, 'ndcg@10': 0.8203, 'compress@10': 0.5185, 'time@10': 5.4018}:  50%|█████     | 5/10 [00:17<00:20,  4.08s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0563, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8189, 'compress@10': 0.5433, 'time@10': 5.5255}:  50%|█████     | 5/10 [00:23<00:20,  4.08s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0563, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8189, 'compress@10': 0.5433, 'time@10': 5.5255}:  60%|██████    | 6/10 [00:23<00:19,  4.80s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0543, 'hit_ratio@10': 0.8048, 'ndcg@10': 0.8254, 'compress@10': 0.548, 'time@10': 5.669}:  60%|██████    | 6/10 [00:27<00:19,  4.80s/it] {'epoch': 1, 'num_users': 6.2857, 'loss': 0.0543, 'hit_ratio@10': 0.8048, 'ndcg@10': 0.8254, 'compress@10': 0.548, 'time@10': 5.669}:  70%|███████   | 7/10 [00:27<00:12,  4.31s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0523, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8318, 'compress@10': 0.5535, 'time@10': 5.5364}:  70%|███████   | 7/10 [00:31<00:12,  4.31s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0523, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8318, 'compress@10': 0.5535, 'time@10': 5.5364}:  80%|████████  | 8/10 [00:31<00:08,  4.42s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.8403, 'compress@10': 0.5601, 'time@10': 5.8761}:  80%|████████  | 8/10 [00:36<00:08,  4.42s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.8403, 'compress@10': 0.5601, 'time@10': 5.8761}:  90%|█████████ | 9/10 [00:36<00:04,  4.39s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8405, 'compress@10': 0.5658, 'time@10': 5.865}:  90%|█████████ | 9/10 [00:41<00:04,  4.39s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8405, 'compress@10': 0.5658, 'time@10': 5.865}: 100%|██████████| 10/10 [00:41<00:00,  4.83s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8405, 'compress@10': 0.5658, 'time@10': 5.865}: 100%|██████████| 10/10 [00:41<00:00,  4.19s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.049949026619981095
Avg hit ratio: 0.8165552248166851
Avg ndcg: 0.8405451732312468
Avg compression ratio: 0.5657672031438208
Avg train time: 5.865039300918579
Std train time: 2.7512391322535725
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.851, 'compress@10': 0.3881, 'time@10': 4.976}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.851, 'compress@10': 0.3881, 'time@10': 4.976}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8469, 'compress@10': 0.4445, 'time@10': 4.6137}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8469, 'compress@10': 0.4445, 'time@10': 4.6137}:  20%|██        | 2/10 [00:06<00:28,  3.56s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8503, 'compress@10': 0.5003, 'time@10': 3.7221}:  20%|██        | 2/10 [00:07<00:28,  3.56s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8503, 'compress@10': 0.5003, 'time@10': 3.7221}:  30%|███       | 3/10 [00:07<00:16,  2.40s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.849, 'compress@10': 0.4777, 'time@10': 3.7252}:  30%|███       | 3/10 [00:11<00:16,  2.40s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.849, 'compress@10': 0.4777, 'time@10': 3.7252}:  40%|████      | 4/10 [00:11<00:17,  2.94s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8364, 'compress@10': 0.4792, 'time@10': 5.159}:  40%|████      | 4/10 [00:17<00:17,  2.94s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8364, 'compress@10': 0.4792, 'time@10': 5.159}:  50%|█████     | 5/10 [00:17<00:19,  3.86s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0518, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.8338, 'compress@10': 0.5058, 'time@10': 5.3198}:  50%|█████     | 5/10 [00:23<00:19,  3.86s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0518, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.8338, 'compress@10': 0.5058, 'time@10': 5.3198}:  60%|██████    | 6/10 [00:23<00:18,  4.64s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0505, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.8356, 'compress@10': 0.4938, 'time@10': 5.5177}:  60%|██████    | 6/10 [00:26<00:18,  4.64s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0505, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.8356, 'compress@10': 0.4938, 'time@10': 5.5177}:  70%|███████   | 7/10 [00:26<00:12,  4.23s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0509, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8337, 'compress@10': 0.4962, 'time@10': 5.4193}:  70%|███████   | 7/10 [00:31<00:12,  4.23s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0509, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8337, 'compress@10': 0.4962, 'time@10': 5.4193}:  80%|████████  | 8/10 [00:31<00:08,  4.40s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8411, 'compress@10': 0.5101, 'time@10': 5.7619}:  80%|████████  | 8/10 [00:35<00:08,  4.40s/it] {'epoch': 2, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8411, 'compress@10': 0.5101, 'time@10': 5.7619}:  90%|█████████ | 9/10 [00:35<00:04,  4.37s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8423, 'compress@10': 0.5062, 'time@10': 5.7608}:  90%|█████████ | 9/10 [00:41<00:04,  4.37s/it] {'epoch': 2, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8423, 'compress@10': 0.5062, 'time@10': 5.7608}: 100%|██████████| 10/10 [00:41<00:00,  4.81s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.8423, 'compress@10': 0.5062, 'time@10': 5.7608}: 100%|██████████| 10/10 [00:41<00:00,  4.15s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.049595376046141476
Avg hit ratio: 0.8213299034487489
Avg ndcg: 0.8422536144724375
Avg compression ratio: 0.5062255505127575
Avg train time: 5.760795664787293
Std train time: 2.3992424169344044
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.412, 'time@10': 4.997}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.412, 'time@10': 4.997}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8513, 'compress@10': 0.4257, 'time@10': 4.6078}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8513, 'compress@10': 0.4257, 'time@10': 4.6078}:  20%|██        | 2/10 [00:06<00:28,  3.55s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8533, 'compress@10': 0.449, 'time@10': 3.8101}:  20%|██        | 2/10 [00:07<00:28,  3.55s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8533, 'compress@10': 0.449, 'time@10': 3.8101}:  30%|███       | 3/10 [00:07<00:17,  2.45s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0365, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8508, 'compress@10': 0.4198, 'time@10': 3.7873}:  30%|███       | 3/10 [00:11<00:17,  2.45s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0365, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8508, 'compress@10': 0.4198, 'time@10': 3.7873}:  40%|████      | 4/10 [00:11<00:17,  2.97s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8392, 'compress@10': 0.4206, 'time@10': 4.9299}:  40%|████      | 4/10 [00:16<00:17,  2.97s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8392, 'compress@10': 0.4206, 'time@10': 4.9299}:  50%|█████     | 5/10 [00:16<00:18,  3.63s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0497, 'hit_ratio@10': 0.785, 'ndcg@10': 0.8369, 'compress@10': 0.4361, 'time@10': 5.1241}:  50%|█████     | 5/10 [00:22<00:18,  3.63s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0497, 'hit_ratio@10': 0.785, 'ndcg@10': 0.8369, 'compress@10': 0.4361, 'time@10': 5.1241}:  60%|██████    | 6/10 [00:22<00:17,  4.48s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0494, 'hit_ratio@10': 0.81, 'ndcg@10': 0.8379, 'compress@10': 0.421, 'time@10': 5.3338}:  60%|██████    | 6/10 [00:25<00:17,  4.48s/it]  {'epoch': 3, 'num_users': 6.2857, 'loss': 0.0494, 'hit_ratio@10': 0.81, 'ndcg@10': 0.8379, 'compress@10': 0.421, 'time@10': 5.3338}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0498, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8397, 'compress@10': 0.4232, 'time@10': 5.2523}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0498, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8397, 'compress@10': 0.4232, 'time@10': 5.2523}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8496, 'compress@10': 0.442, 'time@10': 5.6158}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8496, 'compress@10': 0.442, 'time@10': 5.6158}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8485, 'compress@10': 0.4347, 'time@10': 5.6254}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]  {'epoch': 3, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8485, 'compress@10': 0.4347, 'time@10': 5.6254}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8485, 'compress@10': 0.4347, 'time@10': 5.6254}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04864661621944263
Avg hit ratio: 0.831635074979727
Avg ndcg: 0.8484873982765635
Avg compression ratio: 0.4346887013432702
Avg train time: 5.625393176078797
Std train time: 2.076275568639414
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8571, 'compress@10': 0.4707, 'time@10': 4.4918}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8571, 'compress@10': 0.4707, 'time@10': 4.4918}:  10%|█         | 1/10 [00:02<00:20,  2.29s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8551, 'compress@10': 0.434, 'time@10': 4.3347}:  10%|█         | 1/10 [00:06<00:20,  2.29s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8551, 'compress@10': 0.434, 'time@10': 4.3347}:  20%|██        | 2/10 [00:06<00:27,  3.42s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8558, 'compress@10': 0.438, 'time@10': 3.6571}:  20%|██        | 2/10 [00:07<00:27,  3.42s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8558, 'compress@10': 0.438, 'time@10': 3.6571}:  30%|███       | 3/10 [00:07<00:16,  2.40s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8544, 'compress@10': 0.4098, 'time@10': 3.6728}:  30%|███       | 3/10 [00:11<00:16,  2.40s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8544, 'compress@10': 0.4098, 'time@10': 3.6728}:  40%|████      | 4/10 [00:11<00:17,  2.94s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0462, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.841, 'compress@10': 0.4045, 'time@10': 4.5771}:  40%|████      | 4/10 [00:15<00:17,  2.94s/it] {'epoch': 4, 'num_users': 5.8, 'loss': 0.0462, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.841, 'compress@10': 0.4045, 'time@10': 4.5771}:  50%|█████     | 5/10 [00:15<00:16,  3.37s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0498, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8381, 'compress@10': 0.4006, 'time@10': 4.8377}:  50%|█████     | 5/10 [00:21<00:16,  3.37s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0498, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8381, 'compress@10': 0.4006, 'time@10': 4.8377}:  60%|██████    | 6/10 [00:21<00:17,  4.33s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0506, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8457, 'compress@10': 0.387, 'time@10': 5.1075}:  60%|██████    | 6/10 [00:25<00:17,  4.33s/it]  {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0506, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8457, 'compress@10': 0.387, 'time@10': 5.1075}:  70%|███████   | 7/10 [00:25<00:12,  4.03s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0511, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8495, 'compress@10': 0.3863, 'time@10': 5.0594}:  70%|███████   | 7/10 [00:29<00:12,  4.03s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0511, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8495, 'compress@10': 0.3863, 'time@10': 5.0594}:  80%|████████  | 8/10 [00:29<00:08,  4.27s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0525, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8565, 'compress@10': 0.3885, 'time@10': 5.4588}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0525, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8565, 'compress@10': 0.3885, 'time@10': 5.4588}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.052, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.855, 'compress@10': 0.385, 'time@10': 5.4798}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]      {'epoch': 4, 'num_users': 6.3, 'loss': 0.052, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.855, 'compress@10': 0.385, 'time@10': 5.4798}: 100%|██████████| 10/10 [00:40<00:00,  4.73s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.052, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.855, 'compress@10': 0.385, 'time@10': 5.4798}: 100%|██████████| 10/10 [00:40<00:00,  4.00s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.05197044673262743
Avg hit ratio: 0.8490795194241715
Avg ndcg: 0.8549754450321222
Avg compression ratio: 0.3850285992708268
Avg train time: 5.479751777648926
Std train time: 1.895082452563486
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.4933, 'time@10': 4.9493}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.4933, 'time@10': 4.9493}:  10%|█         | 1/10 [00:02<00:22,  2.51s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8596, 'compress@10': 0.4603, 'time@10': 4.5274}:  10%|█         | 1/10 [00:06<00:22,  2.51s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8596, 'compress@10': 0.4603, 'time@10': 4.5274}:  20%|██        | 2/10 [00:06<00:27,  3.47s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8588, 'compress@10': 0.4566, 'time@10': 3.8358}:  20%|██        | 2/10 [00:07<00:27,  3.47s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8588, 'compress@10': 0.4566, 'time@10': 3.8358}:  30%|███       | 3/10 [00:07<00:17,  2.46s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0373, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8514, 'compress@10': 0.4271, 'time@10': 3.8071}:  30%|███       | 3/10 [00:11<00:17,  2.46s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0373, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8514, 'compress@10': 0.4271, 'time@10': 3.8071}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0461, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8378, 'compress@10': 0.4157, 'time@10': 4.6834}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0461, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8378, 'compress@10': 0.4157, 'time@10': 4.6834}:  50%|█████     | 5/10 [00:15<00:16,  3.39s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8369, 'compress@10': 0.3993, 'time@10': 4.9385}:  50%|█████     | 5/10 [00:22<00:16,  3.39s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8369, 'compress@10': 0.3993, 'time@10': 4.9385}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0479, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8376, 'compress@10': 0.3888, 'time@10': 5.1796}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0479, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8376, 'compress@10': 0.3888, 'time@10': 5.1796}:  70%|███████   | 7/10 [00:25<00:12,  4.03s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0486, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.84, 'compress@10': 0.3906, 'time@10': 5.1225}:  70%|███████   | 7/10 [00:30<00:12,  4.03s/it]   {'epoch': 5, 'num_users': 6.125, 'loss': 0.0486, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.84, 'compress@10': 0.3906, 'time@10': 5.1225}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8445, 'compress@10': 0.3904, 'time@10': 5.4993}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8445, 'compress@10': 0.3904, 'time@10': 5.4993}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8475, 'compress@10': 0.386, 'time@10': 5.5041}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]     {'epoch': 5, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8475, 'compress@10': 0.386, 'time@10': 5.5041}: 100%|██████████| 10/10 [00:40<00:00,  4.68s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8475, 'compress@10': 0.386, 'time@10': 5.5041}: 100%|██████████| 10/10 [00:40<00:00,  4.01s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04897077938937651
Avg hit ratio: 0.8606538339984858
Avg ndcg: 0.8474687648817054
Avg compression ratio: 0.3859850878457255
Avg train time: 5.504111218452453
Std train time: 1.827499330537899
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8561, 'compress@10': 0.4979, 'time@10': 4.2653}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8561, 'compress@10': 0.4979, 'time@10': 4.2653}:  10%|█         | 1/10 [00:02<00:19,  2.17s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8548, 'compress@10': 0.4447, 'time@10': 4.2278}:  10%|█         | 1/10 [00:06<00:19,  2.17s/it] {'epoch': 6, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8548, 'compress@10': 0.4447, 'time@10': 4.2278}:  20%|██        | 2/10 [00:06<00:27,  3.38s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8556, 'compress@10': 0.4501, 'time@10': 3.697}:  20%|██        | 2/10 [00:07<00:27,  3.38s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8556, 'compress@10': 0.4501, 'time@10': 3.697}:  30%|███       | 3/10 [00:07<00:17,  2.46s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8409, 'compress@10': 0.4291, 'time@10': 3.6995}:  30%|███       | 3/10 [00:11<00:17,  2.46s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8409, 'compress@10': 0.4291, 'time@10': 3.6995}:  40%|████      | 4/10 [00:11<00:17,  2.97s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8301, 'compress@10': 0.4171, 'time@10': 4.652}:  40%|████      | 4/10 [00:15<00:17,  2.97s/it] {'epoch': 6, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8301, 'compress@10': 0.4171, 'time@10': 4.652}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0473, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8313, 'compress@10': 0.4005, 'time@10': 4.9125}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0473, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8313, 'compress@10': 0.4005, 'time@10': 4.9125}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0467, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8369, 'compress@10': 0.3902, 'time@10': 5.173}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.0467, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8369, 'compress@10': 0.3902, 'time@10': 5.173}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0468, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8399, 'compress@10': 0.3915, 'time@10': 5.1228}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0468, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8399, 'compress@10': 0.3915, 'time@10': 5.1228}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0457, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8486, 'compress@10': 0.3899, 'time@10': 5.5019}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0457, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8486, 'compress@10': 0.3899, 'time@10': 5.5019}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0444, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8509, 'compress@10': 0.3837, 'time@10': 5.5227}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0444, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8509, 'compress@10': 0.3837, 'time@10': 5.5227}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0444, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8509, 'compress@10': 0.3837, 'time@10': 5.5227}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04442753217689299
Avg hit ratio: 0.8665109768556288
Avg ndcg: 0.8509276364404922
Avg compression ratio: 0.3837370966882035
Avg train time: 5.522655129432678
Std train time: 1.8774336290703475
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.5032, 'time@10': 4.6974}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.5032, 'time@10': 4.6974}:  10%|█         | 1/10 [00:02<00:21,  2.41s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0436, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8639, 'compress@10': 0.433, 'time@10': 4.4682}:  10%|█         | 1/10 [00:06<00:21,  2.41s/it]  {'epoch': 7, 'num_users': 7.0, 'loss': 0.0436, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8639, 'compress@10': 0.433, 'time@10': 4.4682}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8616, 'compress@10': 0.4427, 'time@10': 3.9184}:  20%|██        | 2/10 [00:08<00:28,  3.51s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8616, 'compress@10': 0.4427, 'time@10': 3.9184}:  30%|███       | 3/10 [00:08<00:17,  2.57s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8519, 'compress@10': 0.4283, 'time@10': 3.8771}:  30%|███       | 3/10 [00:11<00:17,  2.57s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8519, 'compress@10': 0.4283, 'time@10': 3.8771}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0426, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8387, 'compress@10': 0.416, 'time@10': 4.7506}:  40%|████      | 4/10 [00:16<00:18,  3.05s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.0426, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8387, 'compress@10': 0.416, 'time@10': 4.7506}:  50%|█████     | 5/10 [00:16<00:17,  3.45s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0438, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8404, 'compress@10': 0.4, 'time@10': 4.9849}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0438, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8404, 'compress@10': 0.4, 'time@10': 4.9849}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0427, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8458, 'compress@10': 0.3903, 'time@10': 5.2207}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0427, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8458, 'compress@10': 0.3903, 'time@10': 5.2207}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0423, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8476, 'compress@10': 0.391, 'time@10': 5.1593}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.0423, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8476, 'compress@10': 0.391, 'time@10': 5.1593}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0417, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8561, 'compress@10': 0.3869, 'time@10': 5.5431}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0417, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8561, 'compress@10': 0.3869, 'time@10': 5.5431}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.041, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8588, 'compress@10': 0.3828, 'time@10': 5.5732}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]    {'epoch': 7, 'num_users': 6.3, 'loss': 0.041, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8588, 'compress@10': 0.3828, 'time@10': 5.5732}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.041, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8588, 'compress@10': 0.3828, 'time@10': 5.5732}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04101177950625335
Avg hit ratio: 0.8569359640548095
Avg ndcg: 0.8587981163030649
Avg compression ratio: 0.3828375392605022
Avg train time: 5.573189115524292
Std train time: 1.7909829383730977
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0479, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8388, 'compress@10': 0.4755, 'time@10': 4.2091}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0479, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8388, 'compress@10': 0.4755, 'time@10': 4.2091}:  10%|█         | 1/10 [00:02<00:19,  2.14s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0424, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.854, 'compress@10': 0.4099, 'time@10': 4.2034}:  10%|█         | 1/10 [00:06<00:19,  2.14s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.0424, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.854, 'compress@10': 0.4099, 'time@10': 4.2034}:  20%|██        | 2/10 [00:06<00:26,  3.37s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.855, 'compress@10': 0.4256, 'time@10': 3.7949}:  20%|██        | 2/10 [00:07<00:26,  3.37s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.855, 'compress@10': 0.4256, 'time@10': 3.7949}:  30%|███       | 3/10 [00:07<00:17,  2.53s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8519, 'compress@10': 0.4181, 'time@10': 3.7815}:  30%|███       | 3/10 [00:11<00:17,  2.53s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8519, 'compress@10': 0.4181, 'time@10': 3.7815}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0396, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8395, 'compress@10': 0.4077, 'time@10': 4.741}:  40%|████      | 4/10 [00:16<00:18,  3.02s/it] {'epoch': 8, 'num_users': 5.8, 'loss': 0.0396, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8395, 'compress@10': 0.4077, 'time@10': 4.741}:  50%|█████     | 5/10 [00:16<00:17,  3.50s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0405, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.842, 'compress@10': 0.3932, 'time@10': 4.98}:  50%|█████     | 5/10 [00:22<00:17,  3.50s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0405, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.842, 'compress@10': 0.3932, 'time@10': 4.98}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0398, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8489, 'compress@10': 0.3848, 'time@10': 5.2331}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0398, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8489, 'compress@10': 0.3848, 'time@10': 5.2331}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0394, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8514, 'compress@10': 0.3856, 'time@10': 5.1776}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0394, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8514, 'compress@10': 0.3856, 'time@10': 5.1776}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0408, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8765, 'compress@10': 0.3793, 'time@10': 5.5616}:  80%|████████  | 8/10 [00:34<00:08,  4.33s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0408, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8765, 'compress@10': 0.3793, 'time@10': 5.5616}:  90%|█████████ | 9/10 [00:34<00:04,  4.34s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0403, 'hit_ratio@10': 0.869, 'ndcg@10': 0.8767, 'compress@10': 0.3758, 'time@10': 5.5683}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]    {'epoch': 8, 'num_users': 6.3, 'loss': 0.0403, 'hit_ratio@10': 0.869, 'ndcg@10': 0.8767, 'compress@10': 0.3758, 'time@10': 5.5683}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0403, 'hit_ratio@10': 0.869, 'ndcg@10': 0.8767, 'compress@10': 0.3758, 'time@10': 5.5683}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.040343394711660915
Avg hit ratio: 0.8689963569725878
Avg ndcg: 0.8767433992958823
Avg compression ratio: 0.3757934787929947
Avg train time: 5.568259835243225
Std train time: 1.8605071361988472
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0446, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.4339, 'time@10': 4.821}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0446, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.4339, 'time@10': 4.821}:  10%|█         | 1/10 [00:02<00:22,  2.45s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.863, 'compress@10': 0.3837, 'time@10': 4.523}:  10%|█         | 1/10 [00:06<00:22,  2.45s/it] {'epoch': 9, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.863, 'compress@10': 0.3837, 'time@10': 4.523}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.861, 'compress@10': 0.4054, 'time@10': 4.0658}:  20%|██        | 2/10 [00:08<00:28,  3.52s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.861, 'compress@10': 0.4054, 'time@10': 4.0658}:  30%|███       | 3/10 [00:08<00:18,  2.65s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.857, 'compress@10': 0.4095, 'time@10': 3.9829}:  30%|███       | 3/10 [00:12<00:18,  2.65s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.857, 'compress@10': 0.4095, 'time@10': 3.9829}:  40%|████      | 4/10 [00:12<00:18,  3.09s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0387, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8453, 'compress@10': 0.4006, 'time@10': 4.8509}:  40%|████      | 4/10 [00:16<00:18,  3.09s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0387, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8453, 'compress@10': 0.4006, 'time@10': 4.8509}:  50%|█████     | 5/10 [00:16<00:17,  3.50s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.039, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8488, 'compress@10': 0.3872, 'time@10': 5.0758}:  50%|█████     | 5/10 [00:22<00:17,  3.50s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.039, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8488, 'compress@10': 0.3872, 'time@10': 5.0758}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0383, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8525, 'compress@10': 0.3809, 'time@10': 5.3084}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0383, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8525, 'compress@10': 0.3809, 'time@10': 5.3084}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0373, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8561, 'compress@10': 0.3824, 'time@10': 5.2466}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0373, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8561, 'compress@10': 0.3824, 'time@10': 5.2466}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0394, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8758, 'compress@10': 0.3768, 'time@10': 5.619}:  80%|████████  | 8/10 [00:35<00:08,  4.33s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0394, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8758, 'compress@10': 0.3768, 'time@10': 5.619}:  90%|█████████ | 9/10 [00:35<00:04,  4.34s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0384, 'hit_ratio@10': 0.872, 'ndcg@10': 0.877, 'compress@10': 0.3731, 'time@10': 5.6363}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]    {'epoch': 9, 'num_users': 6.3, 'loss': 0.0384, 'hit_ratio@10': 0.872, 'ndcg@10': 0.877, 'compress@10': 0.3731, 'time@10': 5.6363}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0384, 'hit_ratio@10': 0.872, 'ndcg@10': 0.877, 'compress@10': 0.3731, 'time@10': 5.6363}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03837809299743804
Avg hit ratio: 0.8720059263505782
Avg ndcg: 0.8770015529270221
Avg compression ratio: 0.373087045820926
Avg train time: 5.636291456222534
Std train time: 1.749195190637005
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.3906, 'time@10': 3.8106}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.3906, 'time@10': 3.8106}:  10%|█         | 1/10 [00:01<00:17,  1.98s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0407, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8653, 'compress@10': 0.3563, 'time@10': 4.057}:  10%|█         | 1/10 [00:06<00:17,  1.98s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0407, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8653, 'compress@10': 0.3563, 'time@10': 4.057}:  20%|██        | 2/10 [00:06<00:26,  3.37s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8626, 'compress@10': 0.3882, 'time@10': 3.7632}:  20%|██        | 2/10 [00:07<00:26,  3.37s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8626, 'compress@10': 0.3882, 'time@10': 3.7632}:  30%|███       | 3/10 [00:07<00:18,  2.58s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8542, 'compress@10': 0.4042, 'time@10': 3.7481}:  30%|███       | 3/10 [00:11<00:18,  2.58s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8542, 'compress@10': 0.4042, 'time@10': 3.7481}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0407, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8431, 'compress@10': 0.396, 'time@10': 4.6565}:  40%|████      | 4/10 [00:15<00:18,  3.04s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.0407, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8431, 'compress@10': 0.396, 'time@10': 4.6565}:  50%|█████     | 5/10 [00:15<00:17,  3.46s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8478, 'compress@10': 0.3843, 'time@10': 4.9133}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8478, 'compress@10': 0.3843, 'time@10': 4.9133}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0392, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8556, 'compress@10': 0.3775, 'time@10': 5.1684}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0392, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8556, 'compress@10': 0.3775, 'time@10': 5.1684}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0378, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.8612, 'compress@10': 0.3799, 'time@10': 5.1114}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0378, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.8612, 'compress@10': 0.3799, 'time@10': 5.1114}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0376, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8675, 'compress@10': 0.3805, 'time@10': 5.4723}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0376, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8675, 'compress@10': 0.3805, 'time@10': 5.4723}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.037, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8724, 'compress@10': 0.3776, 'time@10': 5.4821}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]    {'epoch': 10, 'num_users': 6.3, 'loss': 0.037, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8724, 'compress@10': 0.3776, 'time@10': 5.4821}: 100%|██████████| 10/10 [00:40<00:00,  4.68s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.037, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8724, 'compress@10': 0.3776, 'time@10': 5.4821}: 100%|██████████| 10/10 [00:40<00:00,  4.01s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.036963490058938724
Avg hit ratio: 0.8742281485728005
Avg ndcg: 0.8724155617502992
Avg compression ratio: 0.37759688006347525
Avg train time: 5.482062482833863
Std train time: 1.772666101505792
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8405, 'compress@10': 0.3801, 'time@10': 4.6487}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8405, 'compress@10': 0.3801, 'time@10': 4.6487}:  10%|█         | 1/10 [00:02<00:21,  2.36s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0406, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8569, 'compress@10': 0.3476, 'time@10': 4.2967}:  10%|█         | 1/10 [00:06<00:21,  2.36s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0406, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8569, 'compress@10': 0.3476, 'time@10': 4.2967}:  20%|██        | 2/10 [00:06<00:26,  3.32s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.857, 'compress@10': 0.3851, 'time@10': 3.9054}:  20%|██        | 2/10 [00:07<00:26,  3.32s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.857, 'compress@10': 0.3851, 'time@10': 3.9054}:  30%|███       | 3/10 [00:07<00:17,  2.54s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.845, 'compress@10': 0.401, 'time@10': 3.876}:  30%|███       | 3/10 [00:11<00:17,  2.54s/it]  {'epoch': 11, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.845, 'compress@10': 0.401, 'time@10': 3.876}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0389, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8369, 'compress@10': 0.393, 'time@10': 4.7706}:  40%|████      | 4/10 [00:16<00:18,  3.05s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0389, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8369, 'compress@10': 0.393, 'time@10': 4.7706}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0393, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8431, 'compress@10': 0.3824, 'time@10': 4.9973}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0393, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8431, 'compress@10': 0.3824, 'time@10': 4.9973}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.039, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8489, 'compress@10': 0.3778, 'time@10': 5.2776}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it] {'epoch': 11, 'num_users': 6.2857, 'loss': 0.039, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8489, 'compress@10': 0.3778, 'time@10': 5.2776}:  70%|███████   | 7/10 [00:25<00:12,  4.11s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0376, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8548, 'compress@10': 0.3778, 'time@10': 5.1985}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0376, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8548, 'compress@10': 0.3778, 'time@10': 5.1985}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0359, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8625, 'compress@10': 0.3784, 'time@10': 5.5434}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0359, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8625, 'compress@10': 0.3784, 'time@10': 5.5434}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0357, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8634, 'compress@10': 0.3743, 'time@10': 5.5546}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0357, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8634, 'compress@10': 0.3743, 'time@10': 5.5546}: 100%|██████████| 10/10 [00:40<00:00,  4.71s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0357, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8634, 'compress@10': 0.3743, 'time@10': 5.5546}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03568287963390869
Avg hit ratio: 0.8698789422235942
Avg ndcg: 0.8633957312105414
Avg compression ratio: 0.3742908542727346
Avg train time: 5.554634690284729
Std train time: 1.75915017572663
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0395, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8681, 'compress@10': 0.3765, 'time@10': 4.9418}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0395, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8681, 'compress@10': 0.3765, 'time@10': 4.9418}:  10%|█         | 1/10 [00:02<00:22,  2.51s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8732, 'compress@10': 0.3445, 'time@10': 4.3706}:  10%|█         | 1/10 [00:06<00:22,  2.51s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8732, 'compress@10': 0.3445, 'time@10': 4.3706}:  20%|██        | 2/10 [00:06<00:26,  3.29s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8678, 'compress@10': 0.3814, 'time@10': 3.9517}:  20%|██        | 2/10 [00:07<00:26,  3.29s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8678, 'compress@10': 0.3814, 'time@10': 3.9517}:  30%|███       | 3/10 [00:07<00:17,  2.53s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8677, 'compress@10': 0.3902, 'time@10': 3.9086}:  30%|███       | 3/10 [00:11<00:17,  2.53s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8677, 'compress@10': 0.3902, 'time@10': 3.9086}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0334, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8557, 'compress@10': 0.3837, 'time@10': 4.8244}:  40%|████      | 4/10 [00:16<00:18,  3.04s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0334, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8557, 'compress@10': 0.3837, 'time@10': 4.8244}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0336, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8604, 'compress@10': 0.3742, 'time@10': 5.0527}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0336, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8604, 'compress@10': 0.3742, 'time@10': 5.0527}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0332, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8646, 'compress@10': 0.3713, 'time@10': 5.3027}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0332, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8646, 'compress@10': 0.3713, 'time@10': 5.3027}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0333, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.8631, 'compress@10': 0.3702, 'time@10': 5.2338}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0333, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.8631, 'compress@10': 0.3702, 'time@10': 5.2338}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0331, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8714, 'compress@10': 0.3701, 'time@10': 5.6036}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0331, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8714, 'compress@10': 0.3701, 'time@10': 5.6036}:  90%|█████████ | 9/10 [00:34<00:04,  4.32s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.8777, 'compress@10': 0.3674, 'time@10': 5.6213}:  90%|█████████ | 9/10 [00:40<00:04,  4.32s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.8777, 'compress@10': 0.3674, 'time@10': 5.6213}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.8777, 'compress@10': 0.3674, 'time@10': 5.6213}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03122321349600053
Avg hit ratio: 0.8837135286897595
Avg ndcg: 0.8776946117275504
Avg compression ratio: 0.3674216328452799
Avg train time: 5.621291470527649
Std train time: 1.8119852876085645
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0398, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8639, 'compress@10': 0.37, 'time@10': 4.9185}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0398, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8639, 'compress@10': 0.37, 'time@10': 4.9185}:  10%|█         | 1/10 [00:02<00:22,  2.50s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8792, 'compress@10': 0.3394, 'time@10': 4.301}:  10%|█         | 1/10 [00:06<00:22,  2.50s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8792, 'compress@10': 0.3394, 'time@10': 4.301}:  20%|██        | 2/10 [00:06<00:25,  3.22s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8718, 'compress@10': 0.3757, 'time@10': 3.924}:  20%|██        | 2/10 [00:07<00:25,  3.22s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8718, 'compress@10': 0.3757, 'time@10': 3.924}:  30%|███       | 3/10 [00:07<00:17,  2.49s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8732, 'compress@10': 0.382, 'time@10': 3.9111}:  30%|███       | 3/10 [00:11<00:17,  2.49s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8732, 'compress@10': 0.382, 'time@10': 3.9111}:  40%|████      | 4/10 [00:11<00:18,  3.06s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0314, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8611, 'compress@10': 0.3768, 'time@10': 4.8428}:  40%|████      | 4/10 [00:16<00:18,  3.06s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0314, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8611, 'compress@10': 0.3768, 'time@10': 4.8428}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0309, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8659, 'compress@10': 0.3616, 'time@10': 5.0659}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0309, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8659, 'compress@10': 0.3616, 'time@10': 5.0659}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0306, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8708, 'compress@10': 0.3599, 'time@10': 5.3059}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0306, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8708, 'compress@10': 0.3599, 'time@10': 5.3059}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0299, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.8745, 'compress@10': 0.3588, 'time@10': 5.2353}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0299, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.8745, 'compress@10': 0.3588, 'time@10': 5.2353}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0301, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8895, 'compress@10': 0.3575, 'time@10': 5.5941}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0301, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8895, 'compress@10': 0.3575, 'time@10': 5.5941}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0306, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.8891, 'compress@10': 0.3582, 'time@10': 5.6166}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0306, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.8891, 'compress@10': 0.3582, 'time@10': 5.6166}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0306, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.8891, 'compress@10': 0.3582, 'time@10': 5.6166}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03062738254981532
Avg hit ratio: 0.8865706715469024
Avg ndcg: 0.8891100151642716
Avg compression ratio: 0.3582411673785245
Avg train time: 5.616638541221619
Std train time: 1.802396923740137
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0397, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8714, 'compress@10': 0.3623, 'time@10': 4.9211}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0397, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8714, 'compress@10': 0.3623, 'time@10': 4.9211}:  10%|█         | 1/10 [00:02<00:22,  2.50s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8865, 'compress@10': 0.3349, 'time@10': 4.3822}:  10%|█         | 1/10 [00:06<00:22,  2.50s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8865, 'compress@10': 0.3349, 'time@10': 4.3822}:  20%|██        | 2/10 [00:06<00:26,  3.31s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8767, 'compress@10': 0.3704, 'time@10': 3.9745}:  20%|██        | 2/10 [00:07<00:26,  3.31s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8767, 'compress@10': 0.3704, 'time@10': 3.9745}:  30%|███       | 3/10 [00:07<00:17,  2.54s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8783, 'compress@10': 0.3737, 'time@10': 3.9096}:  30%|███       | 3/10 [00:11<00:17,  2.54s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8783, 'compress@10': 0.3737, 'time@10': 3.9096}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0305, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.868, 'compress@10': 0.3701, 'time@10': 4.7838}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it] {'epoch': 14, 'num_users': 5.8, 'loss': 0.0305, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.868, 'compress@10': 0.3701, 'time@10': 4.7838}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.031, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.871, 'compress@10': 0.3549, 'time@10': 5.0186}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.031, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.871, 'compress@10': 0.3549, 'time@10': 5.0186}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0316, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8763, 'compress@10': 0.3539, 'time@10': 5.2639}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0316, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8763, 'compress@10': 0.3539, 'time@10': 5.2639}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0308, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.8788, 'compress@10': 0.3527, 'time@10': 5.1988}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0308, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.8788, 'compress@10': 0.3527, 'time@10': 5.1988}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9022, 'compress@10': 0.3515, 'time@10': 5.5648}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9022, 'compress@10': 0.3515, 'time@10': 5.5648}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0313, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9042, 'compress@10': 0.3507, 'time@10': 5.5787}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]  {'epoch': 14, 'num_users': 6.3, 'loss': 0.0313, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9042, 'compress@10': 0.3507, 'time@10': 5.5787}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0313, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9042, 'compress@10': 0.3507, 'time@10': 5.5787}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.03133253008308504
Avg hit ratio: 0.888157973134204
Avg ndcg: 0.9041520668429535
Avg compression ratio: 0.3507096758390981
Avg train time: 5.578670001029968
Std train time: 1.7604471557366097
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8643, 'compress@10': 0.3569, 'time@10': 4.9381}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8643, 'compress@10': 0.3569, 'time@10': 4.9381}:  10%|█         | 1/10 [00:02<00:22,  2.51s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0354, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8901, 'compress@10': 0.3281, 'time@10': 4.3915}:  10%|█         | 1/10 [00:06<00:22,  2.51s/it] {'epoch': 15, 'num_users': 7.0, 'loss': 0.0354, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8901, 'compress@10': 0.3281, 'time@10': 4.3915}:  20%|██        | 2/10 [00:06<00:26,  3.32s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8791, 'compress@10': 0.3638, 'time@10': 3.9714}:  20%|██        | 2/10 [00:07<00:26,  3.32s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8791, 'compress@10': 0.3638, 'time@10': 3.9714}:  30%|███       | 3/10 [00:07<00:17,  2.54s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8843, 'compress@10': 0.3641, 'time@10': 3.9259}:  30%|███       | 3/10 [00:11<00:17,  2.54s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8843, 'compress@10': 0.3641, 'time@10': 3.9259}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0314, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8732, 'compress@10': 0.3622, 'time@10': 4.7832}:  40%|████      | 4/10 [00:15<00:18,  3.05s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0314, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8732, 'compress@10': 0.3622, 'time@10': 4.7832}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0325, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8816, 'compress@10': 0.3504, 'time@10': 5.029}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0325, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8816, 'compress@10': 0.3504, 'time@10': 5.029}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0324, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8822, 'compress@10': 0.351, 'time@10': 5.2722}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0324, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8822, 'compress@10': 0.351, 'time@10': 5.2722}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0314, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8845, 'compress@10': 0.3499, 'time@10': 5.2051}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0314, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8845, 'compress@10': 0.3499, 'time@10': 5.2051}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0344, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9126, 'compress@10': 0.348, 'time@10': 5.5623}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0344, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9126, 'compress@10': 0.348, 'time@10': 5.5623}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0326, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9164, 'compress@10': 0.3492, 'time@10': 5.5775}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]  {'epoch': 15, 'num_users': 6.3, 'loss': 0.0326, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9164, 'compress@10': 0.3492, 'time@10': 5.5775}: 100%|██████████| 10/10 [00:40<00:00,  4.74s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0326, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9164, 'compress@10': 0.3492, 'time@10': 5.5775}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.03256294041149653
Avg hit ratio: 0.880303929422775
Avg ndcg: 0.9163700239612507
Avg compression ratio: 0.3491727316978591
Avg train time: 5.5775329828262326
Std train time: 1.7359109212774289
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0392, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8684, 'compress@10': 0.3509, 'time@10': 4.8339}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0392, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8684, 'compress@10': 0.3509, 'time@10': 4.8339}:  10%|█         | 1/10 [00:02<00:22,  2.45s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.033, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8927, 'compress@10': 0.3217, 'time@10': 4.3875}:  10%|█         | 1/10 [00:06<00:22,  2.45s/it]  {'epoch': 16, 'num_users': 7.0, 'loss': 0.033, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8927, 'compress@10': 0.3217, 'time@10': 4.3875}:  20%|██        | 2/10 [00:06<00:26,  3.35s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8808, 'compress@10': 0.3593, 'time@10': 3.984}:  20%|██        | 2/10 [00:08<00:26,  3.35s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8808, 'compress@10': 0.3593, 'time@10': 3.984}:  30%|███       | 3/10 [00:08<00:17,  2.57s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8822, 'compress@10': 0.3584, 'time@10': 3.9273}:  30%|███       | 3/10 [00:11<00:17,  2.57s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8822, 'compress@10': 0.3584, 'time@10': 3.9273}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8728, 'compress@10': 0.3574, 'time@10': 4.8184}:  40%|████      | 4/10 [00:16<00:18,  3.05s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8728, 'compress@10': 0.3574, 'time@10': 4.8184}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0313, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8809, 'compress@10': 0.3392, 'time@10': 5.0472}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0313, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8809, 'compress@10': 0.3392, 'time@10': 5.0472}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0302, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8856, 'compress@10': 0.3413, 'time@10': 5.295}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it] {'epoch': 16, 'num_users': 6.2857, 'loss': 0.0302, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8856, 'compress@10': 0.3413, 'time@10': 5.295}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0294, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8876, 'compress@10': 0.341, 'time@10': 5.2263}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0294, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8876, 'compress@10': 0.341, 'time@10': 5.2263}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8913, 'compress@10': 0.3443, 'time@10': 5.6167}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8913, 'compress@10': 0.3443, 'time@10': 5.6167}:  90%|█████████ | 9/10 [00:34<00:04,  4.34s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8912, 'compress@10': 0.3457, 'time@10': 5.639}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]    {'epoch': 16, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8912, 'compress@10': 0.3457, 'time@10': 5.639}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8912, 'compress@10': 0.3457, 'time@10': 5.639}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.030204072357492527
Avg hit ratio: 0.8745896437084892
Avg ndcg: 0.8912026707061832
Avg compression ratio: 0.34574610740229134
Avg train time: 5.639026498794555
Std train time: 1.8091111205830652
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8696, 'compress@10': 0.3517, 'time@10': 4.8372}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8696, 'compress@10': 0.3517, 'time@10': 4.8372}:  10%|█         | 1/10 [00:02<00:22,  2.46s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8945, 'compress@10': 0.3211, 'time@10': 4.3308}:  10%|█         | 1/10 [00:06<00:22,  2.46s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8945, 'compress@10': 0.3211, 'time@10': 4.3308}:  20%|██        | 2/10 [00:06<00:26,  3.29s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.882, 'compress@10': 0.3605, 'time@10': 3.9299}:  20%|██        | 2/10 [00:07<00:26,  3.29s/it]  {'epoch': 17, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.882, 'compress@10': 0.3605, 'time@10': 3.9299}:  30%|███       | 3/10 [00:07<00:17,  2.52s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8744, 'compress@10': 0.3552, 'time@10': 3.881}:  30%|███       | 3/10 [00:11<00:17,  2.52s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8744, 'compress@10': 0.3552, 'time@10': 3.881}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8669, 'compress@10': 0.355, 'time@10': 4.7611}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8669, 'compress@10': 0.355, 'time@10': 4.7611}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.027, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8774, 'compress@10': 0.3355, 'time@10': 4.9917}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.027, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8774, 'compress@10': 0.3355, 'time@10': 4.9917}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0272, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8814, 'compress@10': 0.3381, 'time@10': 5.2649}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0272, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8814, 'compress@10': 0.3381, 'time@10': 5.2649}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0267, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8832, 'compress@10': 0.3375, 'time@10': 5.1941}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0267, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8832, 'compress@10': 0.3375, 'time@10': 5.1941}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0253, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8903, 'compress@10': 0.3422, 'time@10': 5.5627}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0253, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8903, 'compress@10': 0.3422, 'time@10': 5.5627}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.8977, 'compress@10': 0.3332, 'time@10': 5.5845}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.8977, 'compress@10': 0.3332, 'time@10': 5.5845}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.8977, 'compress@10': 0.3332, 'time@10': 5.5845}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02358621813621913
Avg hit ratio: 0.8785035952540197
Avg ndcg: 0.8976514667549443
Avg compression ratio: 0.33317993388858586
Avg train time: 5.5845448017120365
Std train time: 1.784265729182688
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8581, 'compress@10': 0.3457, 'time@10': 4.7674}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8581, 'compress@10': 0.3457, 'time@10': 4.7674}:  10%|█         | 1/10 [00:02<00:21,  2.42s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8928, 'compress@10': 0.3178, 'time@10': 4.2585}:  10%|█         | 1/10 [00:06<00:21,  2.42s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8928, 'compress@10': 0.3178, 'time@10': 4.2585}:  20%|██        | 2/10 [00:06<00:25,  3.23s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8809, 'compress@10': 0.3572, 'time@10': 3.8887}:  20%|██        | 2/10 [00:07<00:25,  3.23s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8809, 'compress@10': 0.3572, 'time@10': 3.8887}:  30%|███       | 3/10 [00:07<00:17,  2.49s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8844, 'compress@10': 0.3518, 'time@10': 3.8413}:  30%|███       | 3/10 [00:11<00:17,  2.49s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8844, 'compress@10': 0.3518, 'time@10': 3.8413}:  40%|████      | 4/10 [00:11<00:17,  3.00s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0267, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8764, 'compress@10': 0.352, 'time@10': 4.746}:  40%|████      | 4/10 [00:15<00:17,  3.00s/it]  {'epoch': 18, 'num_users': 5.8, 'loss': 0.0267, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8764, 'compress@10': 0.352, 'time@10': 4.746}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0276, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8878, 'compress@10': 0.3395, 'time@10': 4.9974}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0276, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8878, 'compress@10': 0.3395, 'time@10': 4.9974}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8878, 'compress@10': 0.3423, 'time@10': 5.2515}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8878, 'compress@10': 0.3423, 'time@10': 5.2515}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0269, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.892, 'compress@10': 0.3377, 'time@10': 5.1837}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]  {'epoch': 18, 'num_users': 6.125, 'loss': 0.0269, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.892, 'compress@10': 0.3377, 'time@10': 5.1837}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.8999, 'compress@10': 0.34, 'time@10': 5.549}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it] {'epoch': 18, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.8999, 'compress@10': 0.34, 'time@10': 5.549}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0266, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9066, 'compress@10': 0.3346, 'time@10': 5.5732}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0266, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9066, 'compress@10': 0.3346, 'time@10': 5.5732}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0266, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9066, 'compress@10': 0.3346, 'time@10': 5.5732}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.026646405789919912
Avg hit ratio: 0.8882813730317975
Avg ndcg: 0.9065586449841678
Avg compression ratio: 0.3346396834710915
Avg train time: 5.573173260688781
Std train time: 1.796200358634945
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8783, 'compress@10': 0.3381, 'time@10': 4.808}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8783, 'compress@10': 0.3381, 'time@10': 4.808}:  10%|█         | 1/10 [00:02<00:21,  2.44s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9106, 'compress@10': 0.3125, 'time@10': 4.2731}:  10%|█         | 1/10 [00:06<00:21,  2.44s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9106, 'compress@10': 0.3125, 'time@10': 4.2731}:  20%|██        | 2/10 [00:06<00:25,  3.24s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8928, 'compress@10': 0.3507, 'time@10': 3.9077}:  20%|██        | 2/10 [00:07<00:25,  3.24s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8928, 'compress@10': 0.3507, 'time@10': 3.9077}:  30%|███       | 3/10 [00:07<00:17,  2.50s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8994, 'compress@10': 0.3474, 'time@10': 3.874}:  30%|███       | 3/10 [00:11<00:17,  2.50s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8994, 'compress@10': 0.3474, 'time@10': 3.874}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8904, 'compress@10': 0.3487, 'time@10': 4.7705}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8904, 'compress@10': 0.3487, 'time@10': 4.7705}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.023, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8994, 'compress@10': 0.3364, 'time@10': 5.009}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.023, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8994, 'compress@10': 0.3364, 'time@10': 5.009}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0227, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9018, 'compress@10': 0.3401, 'time@10': 5.2618}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0227, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9018, 'compress@10': 0.3401, 'time@10': 5.2618}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0224, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9045, 'compress@10': 0.3364, 'time@10': 5.197}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]   {'epoch': 19, 'num_users': 6.125, 'loss': 0.0224, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9045, 'compress@10': 0.3364, 'time@10': 5.197}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9289, 'compress@10': 0.3365, 'time@10': 5.5559}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9289, 'compress@10': 0.3365, 'time@10': 5.5559}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9295, 'compress@10': 0.3364, 'time@10': 5.5648}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9295, 'compress@10': 0.3364, 'time@10': 5.5648}: 100%|██████████| 10/10 [00:40<00:00,  4.72s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9295, 'compress@10': 0.3364, 'time@10': 5.5648}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.02470153677945896
Avg hit ratio: 0.8925035952540197
Avg ndcg: 0.9294712786678894
Avg compression ratio: 0.33636124835851994
Avg train time: 5.564780211448669
Std train time: 1.7711113882242386
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8806, 'compress@10': 0.3224, 'time@10': 4.889}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8806, 'compress@10': 0.3224, 'time@10': 4.889}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.893, 'ndcg@10': 0.913, 'compress@10': 0.3042, 'time@10': 4.3279}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it] {'epoch': 20, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.893, 'ndcg@10': 0.913, 'compress@10': 0.3042, 'time@10': 4.3279}:  20%|██        | 2/10 [00:06<00:26,  3.26s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8944, 'compress@10': 0.343, 'time@10': 3.9229}:  20%|██        | 2/10 [00:07<00:26,  3.26s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8944, 'compress@10': 0.343, 'time@10': 3.9229}:  30%|███       | 3/10 [00:07<00:17,  2.50s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9048, 'compress@10': 0.3385, 'time@10': 3.8769}:  30%|███       | 3/10 [00:11<00:17,  2.50s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9048, 'compress@10': 0.3385, 'time@10': 3.8769}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0222, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.896, 'compress@10': 0.3414, 'time@10': 4.7594}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.0222, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.896, 'compress@10': 0.3414, 'time@10': 4.7594}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9046, 'compress@10': 0.3265, 'time@10': 5.0017}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9046, 'compress@10': 0.3265, 'time@10': 5.0017}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0223, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9061, 'compress@10': 0.3307, 'time@10': 5.2552}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 0.0223, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9061, 'compress@10': 0.3307, 'time@10': 5.2552}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0222, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.9055, 'compress@10': 0.3273, 'time@10': 5.1755}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0222, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.9055, 'compress@10': 0.3273, 'time@10': 5.1755}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0253, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9177, 'compress@10': 0.3292, 'time@10': 5.5404}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0253, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9177, 'compress@10': 0.3292, 'time@10': 5.5404}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.923, 'compress@10': 0.3289, 'time@10': 5.5699}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]    {'epoch': 20, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.923, 'compress@10': 0.3289, 'time@10': 5.5699}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.923, 'compress@10': 0.3289, 'time@10': 5.5699}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.023387115736128405
Avg hit ratio: 0.8998271460665347
Avg ndcg: 0.9230251329758229
Avg compression ratio: 0.32889970405512164
Avg train time: 5.569921517372132
Std train time: 1.780332171657928
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.041, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8584, 'compress@10': 0.3062, 'time@10': 4.8667}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.041, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8584, 'compress@10': 0.3062, 'time@10': 4.8667}:  10%|█         | 1/10 [00:02<00:22,  2.47s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8982, 'compress@10': 0.2983, 'time@10': 4.3429}:  10%|█         | 1/10 [00:06<00:22,  2.47s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8982, 'compress@10': 0.2983, 'time@10': 4.3429}:  20%|██        | 2/10 [00:06<00:26,  3.29s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8845, 'compress@10': 0.3351, 'time@10': 3.9489}:  20%|██        | 2/10 [00:07<00:26,  3.29s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8845, 'compress@10': 0.3351, 'time@10': 3.9489}:  30%|███       | 3/10 [00:07<00:17,  2.53s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8842, 'compress@10': 0.3305, 'time@10': 3.9102}:  30%|███       | 3/10 [00:11<00:17,  2.53s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8842, 'compress@10': 0.3305, 'time@10': 3.9102}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8804, 'compress@10': 0.3351, 'time@10': 4.7663}:  40%|████      | 4/10 [00:15<00:18,  3.04s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8804, 'compress@10': 0.3351, 'time@10': 4.7663}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0292, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.8945, 'compress@10': 0.3219, 'time@10': 4.9958}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0292, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.8945, 'compress@10': 0.3219, 'time@10': 4.9958}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0285, 'hit_ratio@10': 0.901, 'ndcg@10': 0.8968, 'compress@10': 0.3267, 'time@10': 5.2773}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it] {'epoch': 21, 'num_users': 6.2857, 'loss': 0.0285, 'hit_ratio@10': 0.901, 'ndcg@10': 0.8968, 'compress@10': 0.3267, 'time@10': 5.2773}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0272, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.8992, 'compress@10': 0.3291, 'time@10': 5.206}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0272, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.8992, 'compress@10': 0.3291, 'time@10': 5.206}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.888, 'ndcg@10': 0.8994, 'compress@10': 0.3318, 'time@10': 5.5706}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.888, 'ndcg@10': 0.8994, 'compress@10': 0.3318, 'time@10': 5.5706}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9048, 'compress@10': 0.331, 'time@10': 5.5861}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]    {'epoch': 21, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9048, 'compress@10': 0.331, 'time@10': 5.5861}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9048, 'compress@10': 0.331, 'time@10': 5.5861}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.026779022020224218
Avg hit ratio: 0.896970003209392
Avg ndcg: 0.9047884534067441
Avg compression ratio: 0.3310328013349811
Avg train time: 5.586060857772827
Std train time: 1.7590337843117776
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.861, 'compress@10': 0.3209, 'time@10': 4.786}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.861, 'compress@10': 0.3209, 'time@10': 4.786}:  10%|█         | 1/10 [00:02<00:21,  2.43s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9131, 'compress@10': 0.3068, 'time@10': 4.2076}:  10%|█         | 1/10 [00:06<00:21,  2.43s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9131, 'compress@10': 0.3068, 'time@10': 4.2076}:  20%|██        | 2/10 [00:06<00:25,  3.16s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8945, 'compress@10': 0.3401, 'time@10': 3.8493}:  20%|██        | 2/10 [00:07<00:25,  3.16s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8945, 'compress@10': 0.3401, 'time@10': 3.8493}:  30%|███       | 3/10 [00:07<00:17,  2.45s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8994, 'compress@10': 0.3361, 'time@10': 3.8289}:  30%|███       | 3/10 [00:11<00:17,  2.45s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8994, 'compress@10': 0.3361, 'time@10': 3.8289}:  40%|████      | 4/10 [00:11<00:17,  2.99s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0236, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8937, 'compress@10': 0.3395, 'time@10': 4.715}:  40%|████      | 4/10 [00:15<00:17,  2.99s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0236, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8937, 'compress@10': 0.3395, 'time@10': 4.715}:  50%|█████     | 5/10 [00:15<00:17,  3.41s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0229, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9034, 'compress@10': 0.3273, 'time@10': 4.9615}:  50%|█████     | 5/10 [00:21<00:17,  3.41s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0229, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9034, 'compress@10': 0.3273, 'time@10': 4.9615}:  60%|██████    | 6/10 [00:21<00:17,  4.37s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0214, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9095, 'compress@10': 0.3313, 'time@10': 5.2321}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0214, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9095, 'compress@10': 0.3313, 'time@10': 5.2321}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0203, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9141, 'compress@10': 0.3277, 'time@10': 5.1565}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0203, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9141, 'compress@10': 0.3277, 'time@10': 5.1565}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9277, 'compress@10': 0.3267, 'time@10': 5.5391}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9277, 'compress@10': 0.3267, 'time@10': 5.5391}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.9278, 'compress@10': 0.3278, 'time@10': 5.563}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]     {'epoch': 22, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.9278, 'compress@10': 0.3278, 'time@10': 5.563}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.9278, 'compress@10': 0.3278, 'time@10': 5.563}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.023040515412278247
Avg hit ratio: 0.9087441967577791
Avg ndcg: 0.9278212141896335
Avg compression ratio: 0.3278245722899653
Avg train time: 5.562988591194153
Std train time: 1.8153826960699597
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8963, 'compress@10': 0.3212, 'time@10': 4.7868}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8963, 'compress@10': 0.3212, 'time@10': 4.7868}:  10%|█         | 1/10 [00:02<00:21,  2.43s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9283, 'compress@10': 0.3149, 'time@10': 4.217}:  10%|█         | 1/10 [00:06<00:21,  2.43s/it] {'epoch': 23, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9283, 'compress@10': 0.3149, 'time@10': 4.217}:  20%|██        | 2/10 [00:06<00:25,  3.17s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9046, 'compress@10': 0.3391, 'time@10': 3.8095}:  20%|██        | 2/10 [00:07<00:25,  3.17s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9046, 'compress@10': 0.3391, 'time@10': 3.8095}:  30%|███       | 3/10 [00:07<00:16,  2.42s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9155, 'compress@10': 0.336, 'time@10': 3.793}:  30%|███       | 3/10 [00:11<00:16,  2.42s/it]  {'epoch': 23, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9155, 'compress@10': 0.336, 'time@10': 3.793}:  40%|████      | 4/10 [00:11<00:17,  2.96s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9076, 'compress@10': 0.3391, 'time@10': 4.687}:  40%|████      | 4/10 [00:15<00:17,  2.96s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9076, 'compress@10': 0.3391, 'time@10': 4.687}:  50%|█████     | 5/10 [00:15<00:16,  3.40s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9162, 'compress@10': 0.3251, 'time@10': 4.9325}:  50%|█████     | 5/10 [00:21<00:16,  3.40s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9162, 'compress@10': 0.3251, 'time@10': 4.9325}:  60%|██████    | 6/10 [00:21<00:17,  4.35s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9153, 'compress@10': 0.329, 'time@10': 5.1895}:  60%|██████    | 6/10 [00:25<00:17,  4.35s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9153, 'compress@10': 0.329, 'time@10': 5.1895}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9151, 'compress@10': 0.3352, 'time@10': 5.1176}:  70%|███████   | 7/10 [00:29<00:12,  4.04s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9151, 'compress@10': 0.3352, 'time@10': 5.1176}:  80%|████████  | 8/10 [00:29<00:08,  4.24s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9265, 'compress@10': 0.3331, 'time@10': 5.4887}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9265, 'compress@10': 0.3331, 'time@10': 5.4887}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9313, 'compress@10': 0.3343, 'time@10': 5.5345}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9313, 'compress@10': 0.3343, 'time@10': 5.5345}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9313, 'compress@10': 0.3343, 'time@10': 5.5345}: 100%|██████████| 10/10 [00:40<00:00,  4.01s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.017142881061951023
Avg hit ratio: 0.9094815239467191
Avg ndcg: 0.9312691636365699
Avg compression ratio: 0.3342964940080518
Avg train time: 5.534531283378601
Std train time: 1.805987100626978
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0351, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8598, 'compress@10': 0.3048, 'time@10': 5.0255}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0351, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8598, 'compress@10': 0.3048, 'time@10': 5.0255}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.893, 'ndcg@10': 0.909, 'compress@10': 0.3066, 'time@10': 4.3729}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]  {'epoch': 24, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.893, 'ndcg@10': 0.909, 'compress@10': 0.3066, 'time@10': 4.3729}:  20%|██        | 2/10 [00:06<00:26,  3.27s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.8917, 'compress@10': 0.3326, 'time@10': 4.0713}:  20%|██        | 2/10 [00:08<00:26,  3.27s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.8917, 'compress@10': 0.3326, 'time@10': 4.0713}:  30%|███       | 3/10 [00:08<00:18,  2.59s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9026, 'compress@10': 0.3284, 'time@10': 3.9947}:  30%|███       | 3/10 [00:11<00:18,  2.59s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9026, 'compress@10': 0.3284, 'time@10': 3.9947}:  40%|████      | 4/10 [00:11<00:18,  3.07s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0192, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8988, 'compress@10': 0.3323, 'time@10': 4.8497}:  40%|████      | 4/10 [00:16<00:18,  3.07s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0192, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.8988, 'compress@10': 0.3323, 'time@10': 4.8497}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9146, 'compress@10': 0.3204, 'time@10': 5.0699}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9146, 'compress@10': 0.3204, 'time@10': 5.0699}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9147, 'compress@10': 0.3255, 'time@10': 5.295}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it] {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9147, 'compress@10': 0.3255, 'time@10': 5.295}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0211, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9151, 'compress@10': 0.3252, 'time@10': 5.223}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0211, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9151, 'compress@10': 0.3252, 'time@10': 5.223}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.021, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9182, 'compress@10': 0.3257, 'time@10': 5.6}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]  {'epoch': 24, 'num_users': 6.3333, 'loss': 0.021, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9182, 'compress@10': 0.3257, 'time@10': 5.6}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9216, 'compress@10': 0.3282, 'time@10': 5.6318}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9216, 'compress@10': 0.3282, 'time@10': 5.6318}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9216, 'compress@10': 0.3282, 'time@10': 5.6318}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.02143841607204184
Avg hit ratio: 0.8826842889236778
Avg ndcg: 0.9216425972128025
Avg compression ratio: 0.3281980907276016
Avg train time: 5.631805682182312
Std train time: 1.740185885716417
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9066, 'compress@10': 0.3156, 'time@10': 5.0939}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9066, 'compress@10': 0.3156, 'time@10': 5.0939}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9297, 'compress@10': 0.309, 'time@10': 4.4422}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it] {'epoch': 25, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9297, 'compress@10': 0.309, 'time@10': 4.4422}:  20%|██        | 2/10 [00:06<00:26,  3.33s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9055, 'compress@10': 0.3318, 'time@10': 3.9452}:  20%|██        | 2/10 [00:07<00:26,  3.33s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9055, 'compress@10': 0.3318, 'time@10': 3.9452}:  30%|███       | 3/10 [00:07<00:17,  2.50s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9028, 'compress@10': 0.3273, 'time@10': 3.8959}:  30%|███       | 3/10 [00:11<00:17,  2.50s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9028, 'compress@10': 0.3273, 'time@10': 3.8959}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0227, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8995, 'compress@10': 0.3302, 'time@10': 4.7846}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0227, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8995, 'compress@10': 0.3302, 'time@10': 4.7846}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9093, 'compress@10': 0.3211, 'time@10': 5.025}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9093, 'compress@10': 0.3211, 'time@10': 5.025}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.02, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9136, 'compress@10': 0.3226, 'time@10': 5.2687}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.02, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9136, 'compress@10': 0.3226, 'time@10': 5.2687}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0194, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9161, 'compress@10': 0.3205, 'time@10': 5.198}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0194, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9161, 'compress@10': 0.3205, 'time@10': 5.198}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9209, 'compress@10': 0.3228, 'time@10': 5.5983}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9209, 'compress@10': 0.3228, 'time@10': 5.5983}:  90%|█████████ | 9/10 [00:34<00:04,  4.34s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9293, 'compress@10': 0.3274, 'time@10': 5.6267}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9293, 'compress@10': 0.3274, 'time@10': 5.6267}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9293, 'compress@10': 0.3274, 'time@10': 5.6267}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.019147751849053547
Avg hit ratio: 0.8834016737836772
Avg ndcg: 0.9292962351597656
Avg compression ratio: 0.32735223492075294
Avg train time: 5.626686859130859
Std train time: 1.8512626630763513
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9006, 'compress@10': 0.3129, 'time@10': 4.9292}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9006, 'compress@10': 0.3129, 'time@10': 4.9292}:  10%|█         | 1/10 [00:02<00:22,  2.50s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9385, 'compress@10': 0.3125, 'time@10': 4.3806}:  10%|█         | 1/10 [00:06<00:22,  2.50s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9385, 'compress@10': 0.3125, 'time@10': 4.3806}:  20%|██        | 2/10 [00:06<00:26,  3.31s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9114, 'compress@10': 0.3317, 'time@10': 3.9499}:  20%|██        | 2/10 [00:07<00:26,  3.31s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9114, 'compress@10': 0.3317, 'time@10': 3.9499}:  30%|███       | 3/10 [00:07<00:17,  2.52s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9074, 'compress@10': 0.3249, 'time@10': 3.895}:  30%|███       | 3/10 [00:11<00:17,  2.52s/it]  {'epoch': 26, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9074, 'compress@10': 0.3249, 'time@10': 3.895}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.9042, 'compress@10': 0.3266, 'time@10': 4.7668}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.9042, 'compress@10': 0.3266, 'time@10': 4.7668}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9142, 'compress@10': 0.314, 'time@10': 4.9963}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9142, 'compress@10': 0.314, 'time@10': 4.9963}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9173, 'compress@10': 0.3175, 'time@10': 5.2534}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9173, 'compress@10': 0.3175, 'time@10': 5.2534}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.922, 'compress@10': 0.3147, 'time@10': 5.1776}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]  {'epoch': 26, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.922, 'compress@10': 0.3147, 'time@10': 5.1776}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0179, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9296, 'compress@10': 0.3177, 'time@10': 5.5628}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0179, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9296, 'compress@10': 0.3177, 'time@10': 5.5628}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9338, 'compress@10': 0.3234, 'time@10': 5.6047}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9338, 'compress@10': 0.3234, 'time@10': 5.6047}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9338, 'compress@10': 0.3234, 'time@10': 5.6047}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.018931536782852507
Avg hit ratio: 0.8827667531487565
Avg ndcg: 0.9338437174482106
Avg compression ratio: 0.32341719991980966
Avg train time: 5.604682612419128
Std train time: 1.801938304147806
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9163, 'compress@10': 0.2996, 'time@10': 4.7551}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9163, 'compress@10': 0.2996, 'time@10': 4.7551}:  10%|█         | 1/10 [00:02<00:21,  2.42s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9391, 'compress@10': 0.2997, 'time@10': 4.2858}:  10%|█         | 1/10 [00:06<00:21,  2.42s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9391, 'compress@10': 0.2997, 'time@10': 4.2858}:  20%|██        | 2/10 [00:06<00:26,  3.26s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9118, 'compress@10': 0.3202, 'time@10': 4.0011}:  20%|██        | 2/10 [00:08<00:26,  3.26s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9118, 'compress@10': 0.3202, 'time@10': 4.0011}:  30%|███       | 3/10 [00:08<00:18,  2.58s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.909, 'compress@10': 0.3133, 'time@10': 3.9449}:  30%|███       | 3/10 [00:11<00:18,  2.58s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.909, 'compress@10': 0.3133, 'time@10': 3.9449}:  40%|████      | 4/10 [00:11<00:18,  3.07s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.906, 'compress@10': 0.3157, 'time@10': 4.8247}:  40%|████      | 4/10 [00:16<00:18,  3.07s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.906, 'compress@10': 0.3157, 'time@10': 4.8247}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9219, 'compress@10': 0.3046, 'time@10': 5.1019}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9219, 'compress@10': 0.3046, 'time@10': 5.1019}:  60%|██████    | 6/10 [00:22<00:18,  4.53s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9231, 'compress@10': 0.3103, 'time@10': 5.3472}:  60%|██████    | 6/10 [00:26<00:18,  4.53s/it] {'epoch': 27, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9231, 'compress@10': 0.3103, 'time@10': 5.3472}:  70%|███████   | 7/10 [00:26<00:12,  4.18s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0178, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9225, 'compress@10': 0.3146, 'time@10': 5.2687}:  70%|███████   | 7/10 [00:30<00:12,  4.18s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0178, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9225, 'compress@10': 0.3146, 'time@10': 5.2687}:  80%|████████  | 8/10 [00:30<00:08,  4.37s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9423, 'compress@10': 0.324, 'time@10': 5.6388}:  80%|████████  | 8/10 [00:35<00:08,  4.37s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9423, 'compress@10': 0.324, 'time@10': 5.6388}:  90%|█████████ | 9/10 [00:35<00:04,  4.36s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9442, 'compress@10': 0.3286, 'time@10': 5.6656}:  90%|█████████ | 9/10 [00:41<00:04,  4.36s/it]  {'epoch': 27, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9442, 'compress@10': 0.3286, 'time@10': 5.6656}: 100%|██████████| 10/10 [00:41<00:00,  4.85s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9442, 'compress@10': 0.3286, 'time@10': 5.6656}: 100%|██████████| 10/10 [00:41<00:00,  4.12s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.021384810953314078
Avg hit ratio: 0.8774211310289409
Avg ndcg: 0.944191596769224
Avg compression ratio: 0.3286117320756204
Avg train time: 5.665619730949402
Std train time: 1.776314786904503
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.918, 'compress@10': 0.2937, 'time@10': 5.0153}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.918, 'compress@10': 0.2937, 'time@10': 5.0153}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9361, 'compress@10': 0.2861, 'time@10': 4.3437}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9361, 'compress@10': 0.2861, 'time@10': 4.3437}:  20%|██        | 2/10 [00:06<00:25,  3.23s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9098, 'compress@10': 0.314, 'time@10': 4.0976}:  20%|██        | 2/10 [00:08<00:25,  3.23s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9098, 'compress@10': 0.314, 'time@10': 4.0976}:  30%|███       | 3/10 [00:08<00:18,  2.60s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9182, 'compress@10': 0.307, 'time@10': 4.0067}:  30%|███       | 3/10 [00:11<00:18,  2.60s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9182, 'compress@10': 0.307, 'time@10': 4.0067}:  40%|████      | 4/10 [00:11<00:18,  3.06s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.914, 'compress@10': 0.3088, 'time@10': 4.8557}:  40%|████      | 4/10 [00:16<00:18,  3.06s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.914, 'compress@10': 0.3088, 'time@10': 4.8557}:  50%|█████     | 5/10 [00:16<00:17,  3.46s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9236, 'compress@10': 0.2973, 'time@10': 5.0972}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9236, 'compress@10': 0.2973, 'time@10': 5.0972}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9271, 'compress@10': 0.3026, 'time@10': 5.3363}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9271, 'compress@10': 0.3026, 'time@10': 5.3363}:  70%|███████   | 7/10 [00:25<00:12,  4.11s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9312, 'compress@10': 0.3051, 'time@10': 5.2547}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9312, 'compress@10': 0.3051, 'time@10': 5.2547}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0165, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9279, 'compress@10': 0.3153, 'time@10': 5.6227}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0165, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9279, 'compress@10': 0.3153, 'time@10': 5.6227}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9327, 'compress@10': 0.3214, 'time@10': 5.6461}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9327, 'compress@10': 0.3214, 'time@10': 5.6461}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9327, 'compress@10': 0.3214, 'time@10': 5.6461}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.015436194845480667
Avg hit ratio: 0.9007703373781473
Avg ndcg: 0.9327097514994618
Avg compression ratio: 0.321398608440162
Avg train time: 5.646147274971009
Std train time: 1.7349920516421333
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.918, 'compress@10': 0.2985, 'time@10': 4.7703}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.918, 'compress@10': 0.2985, 'time@10': 4.7703}:  10%|█         | 1/10 [00:02<00:21,  2.42s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9875, 'compress@10': 0.2994, 'time@10': 4.2394}:  10%|█         | 1/10 [00:06<00:21,  2.42s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9875, 'compress@10': 0.2994, 'time@10': 4.2394}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.944, 'compress@10': 0.3188, 'time@10': 4.027}:  20%|██        | 2/10 [00:08<00:25,  3.20s/it]  {'epoch': 29, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.944, 'compress@10': 0.3188, 'time@10': 4.027}:  30%|███       | 3/10 [00:08<00:18,  2.62s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.9449, 'compress@10': 0.312, 'time@10': 3.9785}:  30%|███       | 3/10 [00:11<00:18,  2.62s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.9449, 'compress@10': 0.312, 'time@10': 3.9785}:  40%|████      | 4/10 [00:11<00:18,  3.11s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.937, 'compress@10': 0.3114, 'time@10': 4.8331}:  40%|████      | 4/10 [00:16<00:18,  3.11s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.937, 'compress@10': 0.3114, 'time@10': 4.8331}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.9425, 'compress@10': 0.3025, 'time@10': 5.0575}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.9425, 'compress@10': 0.3025, 'time@10': 5.0575}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0169, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9416, 'compress@10': 0.3085, 'time@10': 5.3065}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0169, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9416, 'compress@10': 0.3085, 'time@10': 5.3065}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9431, 'compress@10': 0.3151, 'time@10': 5.2238}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9431, 'compress@10': 0.3151, 'time@10': 5.2238}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0169, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.9461, 'compress@10': 0.3283, 'time@10': 5.5982}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0169, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.9461, 'compress@10': 0.3283, 'time@10': 5.5982}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9457, 'compress@10': 0.3339, 'time@10': 5.6218}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9457, 'compress@10': 0.3339, 'time@10': 5.6218}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9457, 'compress@10': 0.3339, 'time@10': 5.6218}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.019137091386508005
Avg hit ratio: 0.8758497024575123
Avg ndcg: 0.9457085872725164
Avg compression ratio: 0.3339236162801634
Avg train time: 5.621797108650208
Std train time: 1.7350253770938262
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.918, 'compress@10': 0.3005, 'time@10': 4.6081}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.918, 'compress@10': 0.3005, 'time@10': 4.6081}:  10%|█         | 1/10 [00:02<00:21,  2.34s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9418, 'compress@10': 0.3077, 'time@10': 4.1858}:  10%|█         | 1/10 [00:06<00:21,  2.34s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9418, 'compress@10': 0.3077, 'time@10': 4.1858}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9135, 'compress@10': 0.3273, 'time@10': 4.0048}:  20%|██        | 2/10 [00:08<00:25,  3.20s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9135, 'compress@10': 0.3273, 'time@10': 4.0048}:  30%|███       | 3/10 [00:08<00:18,  2.59s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9235, 'compress@10': 0.3218, 'time@10': 3.9399}:  30%|███       | 3/10 [00:11<00:18,  2.59s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9235, 'compress@10': 0.3218, 'time@10': 3.9399}:  40%|████      | 4/10 [00:11<00:18,  3.07s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.9214, 'compress@10': 0.3201, 'time@10': 4.8114}:  40%|████      | 4/10 [00:16<00:18,  3.07s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.9214, 'compress@10': 0.3201, 'time@10': 4.8114}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9372, 'compress@10': 0.3127, 'time@10': 5.0417}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9372, 'compress@10': 0.3127, 'time@10': 5.0417}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9366, 'compress@10': 0.3187, 'time@10': 5.283}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it] {'epoch': 30, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9366, 'compress@10': 0.3187, 'time@10': 5.283}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9394, 'compress@10': 0.3265, 'time@10': 5.2025}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9394, 'compress@10': 0.3265, 'time@10': 5.2025}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9414, 'compress@10': 0.3358, 'time@10': 5.5821}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9414, 'compress@10': 0.3358, 'time@10': 5.5821}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9447, 'compress@10': 0.3405, 'time@10': 5.6075}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9447, 'compress@10': 0.3405, 'time@10': 5.6075}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9447, 'compress@10': 0.3405, 'time@10': 5.6075}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.014933021534454648
Avg hit ratio: 0.8890755089091252
Avg ndcg: 0.9446964355992646
Avg compression ratio: 0.3404839437520578
Avg train time: 5.607529950141907
Std train time: 1.7500323142668197
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9202, 'compress@10': 0.3087, 'time@10': 4.5926}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9202, 'compress@10': 0.3087, 'time@10': 4.5926}:  10%|█         | 1/10 [00:02<00:21,  2.34s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9477, 'compress@10': 0.3162, 'time@10': 4.2323}:  10%|█         | 1/10 [00:06<00:21,  2.34s/it] {'epoch': 31, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9477, 'compress@10': 0.3162, 'time@10': 4.2323}:  20%|██        | 2/10 [00:06<00:26,  3.26s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9175, 'compress@10': 0.3367, 'time@10': 3.9971}:  20%|██        | 2/10 [00:08<00:26,  3.26s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9175, 'compress@10': 0.3367, 'time@10': 3.9971}:  30%|███       | 3/10 [00:08<00:18,  2.60s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.917, 'compress@10': 0.3353, 'time@10': 3.9435}:  30%|███       | 3/10 [00:11<00:18,  2.60s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.917, 'compress@10': 0.3353, 'time@10': 3.9435}:  40%|████      | 4/10 [00:11<00:18,  3.08s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0169, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9161, 'compress@10': 0.3304, 'time@10': 4.7977}:  40%|████      | 4/10 [00:16<00:18,  3.08s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0169, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9161, 'compress@10': 0.3304, 'time@10': 4.7977}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9256, 'compress@10': 0.3202, 'time@10': 5.0579}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9256, 'compress@10': 0.3202, 'time@10': 5.0579}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9291, 'compress@10': 0.3258, 'time@10': 5.2956}:  60%|██████    | 6/10 [00:25<00:17,  4.46s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9291, 'compress@10': 0.3258, 'time@10': 5.2956}:  70%|███████   | 7/10 [00:25<00:12,  4.12s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.933, 'compress@10': 0.3339, 'time@10': 5.2158}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it]   {'epoch': 31, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.933, 'compress@10': 0.3339, 'time@10': 5.2158}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9353, 'compress@10': 0.344, 'time@10': 5.5851}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9353, 'compress@10': 0.344, 'time@10': 5.5851}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9356, 'compress@10': 0.3488, 'time@10': 5.6123}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]  {'epoch': 31, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9356, 'compress@10': 0.3488, 'time@10': 5.6123}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9356, 'compress@10': 0.3488, 'time@10': 5.6123}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.014687477178433495
Avg hit ratio: 0.8853192095585983
Avg ndcg: 0.9356247208412926
Avg compression ratio: 0.3488421349425071
Avg train time: 5.612333965301514
Std train time: 1.7281290714836277
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9247, 'compress@10': 0.3156, 'time@10': 4.7936}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9247, 'compress@10': 0.3156, 'time@10': 4.7936}:  10%|█         | 1/10 [00:02<00:21,  2.44s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9584, 'compress@10': 0.3219, 'time@10': 4.3067}:  10%|█         | 1/10 [00:06<00:21,  2.44s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9584, 'compress@10': 0.3219, 'time@10': 4.3067}:  20%|██        | 2/10 [00:06<00:26,  3.27s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9246, 'compress@10': 0.3437, 'time@10': 3.9574}:  20%|██        | 2/10 [00:07<00:26,  3.27s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9246, 'compress@10': 0.3437, 'time@10': 3.9574}:  30%|███       | 3/10 [00:07<00:17,  2.54s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9226, 'compress@10': 0.341, 'time@10': 3.9144}:  30%|███       | 3/10 [00:11<00:17,  2.54s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9226, 'compress@10': 0.341, 'time@10': 3.9144}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.9216, 'compress@10': 0.3362, 'time@10': 4.8175}:  40%|████      | 4/10 [00:16<00:18,  3.05s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.9216, 'compress@10': 0.3362, 'time@10': 4.8175}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9305, 'compress@10': 0.3273, 'time@10': 5.0576}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9305, 'compress@10': 0.3273, 'time@10': 5.0576}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9347, 'compress@10': 0.3339, 'time@10': 5.2923}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9347, 'compress@10': 0.3339, 'time@10': 5.2923}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9378, 'compress@10': 0.3434, 'time@10': 5.2111}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]   {'epoch': 32, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9378, 'compress@10': 0.3434, 'time@10': 5.2111}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9407, 'compress@10': 0.3552, 'time@10': 5.5879}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9407, 'compress@10': 0.3552, 'time@10': 5.5879}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9443, 'compress@10': 0.3597, 'time@10': 5.5936}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9443, 'compress@10': 0.3597, 'time@10': 5.5936}: 100%|██████████| 10/10 [00:40<00:00,  4.73s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9443, 'compress@10': 0.3597, 'time@10': 5.5936}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.012904999263869635
Avg hit ratio: 0.8768302452122485
Avg ndcg: 0.9442592092000087
Avg compression ratio: 0.3597083403727043
Avg train time: 5.59356107711792
Std train time: 1.7937337745717266
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9228, 'compress@10': 0.3269, 'time@10': 4.634}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9228, 'compress@10': 0.3269, 'time@10': 4.634}:  10%|█         | 1/10 [00:02<00:21,  2.36s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9442, 'compress@10': 0.3382, 'time@10': 4.2503}:  10%|█         | 1/10 [00:06<00:21,  2.36s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9442, 'compress@10': 0.3382, 'time@10': 4.2503}:  20%|██        | 2/10 [00:06<00:26,  3.27s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9151, 'compress@10': 0.3587, 'time@10': 4.0236}:  20%|██        | 2/10 [00:08<00:26,  3.27s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9151, 'compress@10': 0.3587, 'time@10': 4.0236}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9237, 'compress@10': 0.3522, 'time@10': 3.9612}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9237, 'compress@10': 0.3522, 'time@10': 3.9612}:  40%|████      | 4/10 [00:11<00:18,  3.09s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9228, 'compress@10': 0.3455, 'time@10': 4.8184}:  40%|████      | 4/10 [00:16<00:18,  3.09s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9228, 'compress@10': 0.3455, 'time@10': 4.8184}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9406, 'compress@10': 0.3297, 'time@10': 5.039}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9406, 'compress@10': 0.3297, 'time@10': 5.039}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9381, 'compress@10': 0.3377, 'time@10': 5.287}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9381, 'compress@10': 0.3377, 'time@10': 5.287}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9407, 'compress@10': 0.3466, 'time@10': 5.2154}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9407, 'compress@10': 0.3466, 'time@10': 5.2154}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9563, 'compress@10': 0.3561, 'time@10': 5.6078}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9563, 'compress@10': 0.3561, 'time@10': 5.6078}:  90%|█████████ | 9/10 [00:34<00:04,  4.33s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9558, 'compress@10': 0.3617, 'time@10': 5.6423}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9558, 'compress@10': 0.3617, 'time@10': 5.6423}: 100%|██████████| 10/10 [00:40<00:00,  4.84s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9558, 'compress@10': 0.3617, 'time@10': 5.6423}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.018855532331547922
Avg hit ratio: 0.904338666803862
Avg ndcg: 0.955817394309794
Avg compression ratio: 0.36168098497220114
Avg train time: 5.642295289039612
Std train time: 1.756918563936922
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.919, 'compress@10': 0.3267, 'time@10': 4.5749}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.919, 'compress@10': 0.3267, 'time@10': 4.5749}:  10%|█         | 1/10 [00:02<00:21,  2.34s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9453, 'compress@10': 0.3296, 'time@10': 4.2932}:  10%|█         | 1/10 [00:06<00:21,  2.34s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9453, 'compress@10': 0.3296, 'time@10': 4.2932}:  20%|██        | 2/10 [00:06<00:26,  3.36s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9159, 'compress@10': 0.353, 'time@10': 3.9653}:  20%|██        | 2/10 [00:08<00:26,  3.36s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9159, 'compress@10': 0.353, 'time@10': 3.9653}:  30%|███       | 3/10 [00:08<00:18,  2.60s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9262, 'compress@10': 0.3498, 'time@10': 3.9176}:  30%|███       | 3/10 [00:11<00:18,  2.60s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9262, 'compress@10': 0.3498, 'time@10': 3.9176}:  40%|████      | 4/10 [00:11<00:18,  3.09s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9254, 'compress@10': 0.3351, 'time@10': 4.795}:  40%|████      | 4/10 [00:16<00:18,  3.09s/it]  {'epoch': 34, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9254, 'compress@10': 0.3351, 'time@10': 4.795}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9337, 'compress@10': 0.3246, 'time@10': 5.0349}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9337, 'compress@10': 0.3246, 'time@10': 5.0349}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9365, 'compress@10': 0.3323, 'time@10': 5.2653}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9365, 'compress@10': 0.3323, 'time@10': 5.2653}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0088, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9397, 'compress@10': 0.3411, 'time@10': 5.1797}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0088, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9397, 'compress@10': 0.3411, 'time@10': 5.1797}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9323, 'compress@10': 0.3446, 'time@10': 5.5637}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9323, 'compress@10': 0.3446, 'time@10': 5.5637}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9367, 'compress@10': 0.3514, 'time@10': 5.5852}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9367, 'compress@10': 0.3514, 'time@10': 5.5852}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9367, 'compress@10': 0.3514, 'time@10': 5.5852}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.012081183436132358
Avg hit ratio: 0.9046842889236777
Avg ndcg: 0.9366825889079614
Avg compression ratio: 0.3513761789285925
Avg train time: 5.585208916664124
Std train time: 1.7678374705050832
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9021, 'compress@10': 0.337, 'time@10': 4.5007}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9021, 'compress@10': 0.337, 'time@10': 4.5007}:  10%|█         | 1/10 [00:02<00:20,  2.29s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9968, 'compress@10': 0.3372, 'time@10': 4.215}:  10%|█         | 1/10 [00:06<00:20,  2.29s/it] {'epoch': 35, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9968, 'compress@10': 0.3372, 'time@10': 4.215}:  20%|██        | 2/10 [00:06<00:26,  3.28s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9503, 'compress@10': 0.3568, 'time@10': 3.8423}:  20%|██        | 2/10 [00:07<00:26,  3.28s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9503, 'compress@10': 0.3568, 'time@10': 3.8423}:  30%|███       | 3/10 [00:07<00:17,  2.51s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9521, 'compress@10': 0.3547, 'time@10': 3.8386}:  30%|███       | 3/10 [00:11<00:17,  2.51s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9521, 'compress@10': 0.3547, 'time@10': 3.8386}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9469, 'compress@10': 0.3381, 'time@10': 4.7435}:  40%|████      | 4/10 [00:15<00:18,  3.04s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9469, 'compress@10': 0.3381, 'time@10': 4.7435}:  50%|█████     | 5/10 [00:15<00:17,  3.47s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9526, 'compress@10': 0.3277, 'time@10': 4.9931}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9526, 'compress@10': 0.3277, 'time@10': 4.9931}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9521, 'compress@10': 0.3346, 'time@10': 5.2445}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9521, 'compress@10': 0.3346, 'time@10': 5.2445}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9519, 'compress@10': 0.3428, 'time@10': 5.1762}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9519, 'compress@10': 0.3428, 'time@10': 5.1762}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.952, 'compress@10': 0.3486, 'time@10': 5.5643}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.952, 'compress@10': 0.3486, 'time@10': 5.5643}:  90%|█████████ | 9/10 [00:34<00:04,  4.33s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9526, 'compress@10': 0.3552, 'time@10': 5.6008}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]  {'epoch': 35, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9526, 'compress@10': 0.3552, 'time@10': 5.6008}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9526, 'compress@10': 0.3552, 'time@10': 5.6008}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.015064119942876519
Avg hit ratio: 0.9011128603522491
Avg ndcg: 0.9526270108087005
Avg compression ratio: 0.3551646538630294
Avg train time: 5.600784397125244
Std train time: 1.8198737339820006
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8962, 'compress@10': 0.3427, 'time@10': 4.4395}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8962, 'compress@10': 0.3427, 'time@10': 4.4395}:  10%|█         | 1/10 [00:02<00:20,  2.30s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9314, 'compress@10': 0.3532, 'time@10': 4.2142}:  10%|█         | 1/10 [00:06<00:20,  2.30s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9314, 'compress@10': 0.3532, 'time@10': 4.2142}:  20%|██        | 2/10 [00:06<00:26,  3.32s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9067, 'compress@10': 0.368, 'time@10': 3.9498}:  20%|██        | 2/10 [00:08<00:26,  3.32s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9067, 'compress@10': 0.368, 'time@10': 3.9498}:  30%|███       | 3/10 [00:08<00:18,  2.60s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9181, 'compress@10': 0.3632, 'time@10': 3.9005}:  30%|███       | 3/10 [00:11<00:18,  2.60s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9181, 'compress@10': 0.3632, 'time@10': 3.9005}:  40%|████      | 4/10 [00:11<00:18,  3.07s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9193, 'compress@10': 0.3405, 'time@10': 4.7804}:  40%|████      | 4/10 [00:16<00:18,  3.07s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9193, 'compress@10': 0.3405, 'time@10': 4.7804}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.9106, 'ndcg@10': 0.9283, 'compress@10': 0.3314, 'time@10': 5.0124}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.9106, 'ndcg@10': 0.9283, 'compress@10': 0.3314, 'time@10': 5.0124}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9327, 'compress@10': 0.3384, 'time@10': 5.2323}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9327, 'compress@10': 0.3384, 'time@10': 5.2323}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9338, 'compress@10': 0.3412, 'time@10': 5.1581}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9338, 'compress@10': 0.3412, 'time@10': 5.1581}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0165, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9522, 'compress@10': 0.3493, 'time@10': 5.5301}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0165, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9522, 'compress@10': 0.3493, 'time@10': 5.5301}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9571, 'compress@10': 0.3552, 'time@10': 5.548}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9571, 'compress@10': 0.3552, 'time@10': 5.548}: 100%|██████████| 10/10 [00:40<00:00,  4.72s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9571, 'compress@10': 0.3552, 'time@10': 5.548}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.017878562296744466
Avg hit ratio: 0.9115045654213734
Avg ndcg: 0.9571314250880526
Avg compression ratio: 0.3551843211288591
Avg train time: 5.548041272163391
Std train time: 1.7316310341074024
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9126, 'compress@10': 0.3458, 'time@10': 4.7032}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9126, 'compress@10': 0.3458, 'time@10': 4.7032}:  10%|█         | 1/10 [00:02<00:21,  2.39s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9429, 'compress@10': 0.3339, 'time@10': 4.2956}:  10%|█         | 1/10 [00:06<00:21,  2.39s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9429, 'compress@10': 0.3339, 'time@10': 4.2956}:  20%|██        | 2/10 [00:06<00:26,  3.29s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9143, 'compress@10': 0.3565, 'time@10': 4.0535}:  20%|██        | 2/10 [00:08<00:26,  3.29s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9143, 'compress@10': 0.3565, 'time@10': 4.0535}:  30%|███       | 3/10 [00:08<00:18,  2.62s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9228, 'compress@10': 0.3521, 'time@10': 3.9852}:  30%|███       | 3/10 [00:11<00:18,  2.62s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9228, 'compress@10': 0.3521, 'time@10': 3.9852}:  40%|████      | 4/10 [00:11<00:18,  3.10s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9235, 'compress@10': 0.3285, 'time@10': 4.8717}:  40%|████      | 4/10 [00:16<00:18,  3.10s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9235, 'compress@10': 0.3285, 'time@10': 4.8717}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9334, 'compress@10': 0.3231, 'time@10': 5.0966}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9334, 'compress@10': 0.3231, 'time@10': 5.0966}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9352, 'compress@10': 0.3297, 'time@10': 5.3122}:  60%|██████    | 6/10 [00:25<00:17,  4.45s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9352, 'compress@10': 0.3297, 'time@10': 5.3122}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9386, 'compress@10': 0.3325, 'time@10': 5.2257}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]  {'epoch': 37, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9386, 'compress@10': 0.3325, 'time@10': 5.2257}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9352, 'compress@10': 0.3317, 'time@10': 5.61}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it] {'epoch': 37, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9352, 'compress@10': 0.3317, 'time@10': 5.61}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9394, 'compress@10': 0.3387, 'time@10': 5.6204}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it] {'epoch': 37, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9394, 'compress@10': 0.3387, 'time@10': 5.6204}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9394, 'compress@10': 0.3387, 'time@10': 5.6204}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.013752868852287109
Avg hit ratio: 0.8960334952728841
Avg ndcg: 0.9393687863360389
Avg compression ratio: 0.338684398064977
Avg train time: 5.6204105615615845
Std train time: 1.7604225377849658
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.346, 'time@10': 4.6552}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.346, 'time@10': 4.6552}:  10%|█         | 1/10 [00:02<00:21,  2.37s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9407, 'compress@10': 0.334, 'time@10': 4.2296}:  10%|█         | 1/10 [00:06<00:21,  2.37s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9407, 'compress@10': 0.334, 'time@10': 4.2296}:  20%|██        | 2/10 [00:06<00:25,  3.24s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9128, 'compress@10': 0.3567, 'time@10': 4.0392}:  20%|██        | 2/10 [00:08<00:25,  3.24s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9128, 'compress@10': 0.3567, 'time@10': 4.0392}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9239, 'compress@10': 0.3506, 'time@10': 3.9613}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9239, 'compress@10': 0.3506, 'time@10': 3.9613}:  40%|████      | 4/10 [00:11<00:18,  3.07s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9258, 'compress@10': 0.3271, 'time@10': 4.8357}:  40%|████      | 4/10 [00:16<00:18,  3.07s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9258, 'compress@10': 0.3271, 'time@10': 4.8357}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9352, 'compress@10': 0.3241, 'time@10': 5.0605}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9352, 'compress@10': 0.3241, 'time@10': 5.0605}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9379, 'compress@10': 0.3277, 'time@10': 5.2854}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9379, 'compress@10': 0.3277, 'time@10': 5.2854}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9401, 'compress@10': 0.3314, 'time@10': 5.2205}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9401, 'compress@10': 0.3314, 'time@10': 5.2205}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.943, 'compress@10': 0.3315, 'time@10': 5.617}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it] {'epoch': 38, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.943, 'compress@10': 0.3315, 'time@10': 5.617}:  90%|█████████ | 9/10 [00:34<00:04,  4.34s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9463, 'compress@10': 0.3371, 'time@10': 5.6294}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9463, 'compress@10': 0.3371, 'time@10': 5.6294}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9463, 'compress@10': 0.3371, 'time@10': 5.6294}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.010530166004142449
Avg hit ratio: 0.8956648316784139
Avg ndcg: 0.946284679132968
Avg compression ratio: 0.337135044619975
Avg train time: 5.6293587446212765
Std train time: 1.7650256982997021
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.3454, 'time@10': 4.5386}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.3454, 'time@10': 4.5386}:  10%|█         | 1/10 [00:02<00:20,  2.30s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9412, 'compress@10': 0.3353, 'time@10': 4.1845}:  10%|█         | 1/10 [00:06<00:20,  2.30s/it]  {'epoch': 39, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9412, 'compress@10': 0.3353, 'time@10': 4.1845}:  20%|██        | 2/10 [00:06<00:25,  3.22s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9132, 'compress@10': 0.3576, 'time@10': 3.9707}:  20%|██        | 2/10 [00:07<00:25,  3.22s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9132, 'compress@10': 0.3576, 'time@10': 3.9707}:  30%|███       | 3/10 [00:07<00:18,  2.58s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8232, 'ndcg@10': 0.9245, 'compress@10': 0.3514, 'time@10': 3.9134}:  30%|███       | 3/10 [00:11<00:18,  2.58s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8232, 'ndcg@10': 0.9245, 'compress@10': 0.3514, 'time@10': 3.9134}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9266, 'compress@10': 0.3304, 'time@10': 4.7943}:  40%|████      | 4/10 [00:15<00:18,  3.05s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9266, 'compress@10': 0.3304, 'time@10': 4.7943}:  50%|█████     | 5/10 [00:15<00:17,  3.47s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9362, 'compress@10': 0.3278, 'time@10': 5.0205}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9362, 'compress@10': 0.3278, 'time@10': 5.0205}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9401, 'compress@10': 0.3303, 'time@10': 5.2601}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9401, 'compress@10': 0.3303, 'time@10': 5.2601}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9393, 'compress@10': 0.3348, 'time@10': 5.1931}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9393, 'compress@10': 0.3348, 'time@10': 5.1931}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9406, 'compress@10': 0.3319, 'time@10': 5.569}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9406, 'compress@10': 0.3319, 'time@10': 5.569}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9492, 'compress@10': 0.3373, 'time@10': 5.5875}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9492, 'compress@10': 0.3373, 'time@10': 5.5875}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9492, 'compress@10': 0.3373, 'time@10': 5.5875}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.015092699011732371
Avg hit ratio: 0.8860104537982296
Avg ndcg: 0.9492233440221811
Avg compression ratio: 0.33729387603113936
Avg train time: 5.587471961975098
Std train time: 1.7460240144991146
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9189, 'compress@10': 0.3431, 'time@10': 4.6607}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9189, 'compress@10': 0.3431, 'time@10': 4.6607}:  10%|█         | 1/10 [00:02<00:21,  2.37s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9458, 'compress@10': 0.3342, 'time@10': 4.2424}:  10%|█         | 1/10 [00:06<00:21,  2.37s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9458, 'compress@10': 0.3342, 'time@10': 4.2424}:  20%|██        | 2/10 [00:06<00:25,  3.25s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9162, 'compress@10': 0.3565, 'time@10': 3.9443}:  20%|██        | 2/10 [00:07<00:25,  3.25s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9162, 'compress@10': 0.3565, 'time@10': 3.9443}:  30%|███       | 3/10 [00:07<00:17,  2.55s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9322, 'compress@10': 0.3502, 'time@10': 3.9007}:  30%|███       | 3/10 [00:11<00:17,  2.55s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9322, 'compress@10': 0.3502, 'time@10': 3.9007}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9333, 'compress@10': 0.3325, 'time@10': 4.8482}:  40%|████      | 4/10 [00:16<00:18,  3.05s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9333, 'compress@10': 0.3325, 'time@10': 4.8482}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9406, 'compress@10': 0.3273, 'time@10': 5.089}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9406, 'compress@10': 0.3273, 'time@10': 5.089}:  60%|██████    | 6/10 [00:22<00:17,  4.48s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.941, 'compress@10': 0.328, 'time@10': 5.323}:  60%|██████    | 6/10 [00:25<00:17,  4.48s/it]  {'epoch': 40, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.941, 'compress@10': 0.328, 'time@10': 5.323}:  70%|███████   | 7/10 [00:25<00:12,  4.13s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9423, 'compress@10': 0.3281, 'time@10': 5.2532}:  70%|███████   | 7/10 [00:30<00:12,  4.13s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9423, 'compress@10': 0.3281, 'time@10': 5.2532}:  80%|████████  | 8/10 [00:30<00:08,  4.34s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9446, 'compress@10': 0.3246, 'time@10': 5.6155}:  80%|████████  | 8/10 [00:34<00:08,  4.34s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9446, 'compress@10': 0.3246, 'time@10': 5.6155}:  90%|█████████ | 9/10 [00:34<00:04,  4.33s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9475, 'compress@10': 0.3278, 'time@10': 5.6362}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9475, 'compress@10': 0.3278, 'time@10': 5.6362}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9475, 'compress@10': 0.3278, 'time@10': 5.6362}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.0105438874545076
Avg hit ratio: 0.9088906381300269
Avg ndcg: 0.9475463614100725
Avg compression ratio: 0.3277693669576037
Avg train time: 5.636153435707092
Std train time: 1.8072538094514983
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9214, 'compress@10': 0.3387, 'time@10': 4.6915}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9214, 'compress@10': 0.3387, 'time@10': 4.6915}:  10%|█         | 1/10 [00:02<00:21,  2.39s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9905, 'compress@10': 0.3298, 'time@10': 4.2458}:  10%|█         | 1/10 [00:06<00:21,  2.39s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9905, 'compress@10': 0.3298, 'time@10': 4.2458}:  20%|██        | 2/10 [00:06<00:25,  3.25s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.946, 'compress@10': 0.3526, 'time@10': 4.0073}:  20%|██        | 2/10 [00:08<00:25,  3.25s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.946, 'compress@10': 0.3526, 'time@10': 4.0073}:  30%|███       | 3/10 [00:08<00:18,  2.59s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9541, 'compress@10': 0.3464, 'time@10': 3.9367}:  30%|███       | 3/10 [00:11<00:18,  2.59s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9541, 'compress@10': 0.3464, 'time@10': 3.9367}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9523, 'compress@10': 0.3335, 'time@10': 4.8093}:  40%|████      | 4/10 [00:15<00:18,  3.05s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9523, 'compress@10': 0.3335, 'time@10': 4.8093}:  50%|█████     | 5/10 [00:15<00:17,  3.46s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9571, 'compress@10': 0.3259, 'time@10': 5.0404}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9571, 'compress@10': 0.3259, 'time@10': 5.0404}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9567, 'compress@10': 0.3261, 'time@10': 5.2518}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9567, 'compress@10': 0.3261, 'time@10': 5.2518}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9576, 'compress@10': 0.3259, 'time@10': 5.1861}:  70%|███████   | 7/10 [00:30<00:12,  4.04s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9576, 'compress@10': 0.3259, 'time@10': 5.1861}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9586, 'compress@10': 0.3227, 'time@10': 5.5647}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9586, 'compress@10': 0.3227, 'time@10': 5.5647}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9601, 'compress@10': 0.3246, 'time@10': 5.6044}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9601, 'compress@10': 0.3246, 'time@10': 5.6044}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9601, 'compress@10': 0.3246, 'time@10': 5.6044}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.013384585399773793
Avg hit ratio: 0.9057672382324334
Avg ndcg: 0.9601435596076261
Avg compression ratio: 0.32458108106076067
Avg train time: 5.604376435279846
Std train time: 1.738049161746685
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9214, 'compress@10': 0.3344, 'time@10': 4.5521}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9214, 'compress@10': 0.3344, 'time@10': 4.5521}:  10%|█         | 1/10 [00:02<00:20,  2.31s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9599, 'compress@10': 0.3269, 'time@10': 4.1736}:  10%|█         | 1/10 [00:06<00:20,  2.31s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9599, 'compress@10': 0.3269, 'time@10': 4.1736}:  20%|██        | 2/10 [00:06<00:25,  3.21s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9257, 'compress@10': 0.3495, 'time@10': 3.9386}:  20%|██        | 2/10 [00:07<00:25,  3.21s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9257, 'compress@10': 0.3495, 'time@10': 3.9386}:  30%|███       | 3/10 [00:07<00:17,  2.55s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9339, 'compress@10': 0.3431, 'time@10': 3.8838}:  30%|███       | 3/10 [00:11<00:17,  2.55s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9339, 'compress@10': 0.3431, 'time@10': 3.8838}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9363, 'compress@10': 0.3317, 'time@10': 4.7715}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9363, 'compress@10': 0.3317, 'time@10': 4.7715}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9436, 'compress@10': 0.3221, 'time@10': 4.9998}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9436, 'compress@10': 0.3221, 'time@10': 4.9998}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9478, 'compress@10': 0.3223, 'time@10': 5.2218}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9478, 'compress@10': 0.3223, 'time@10': 5.2218}:  70%|███████   | 7/10 [00:25<00:12,  4.03s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9481, 'compress@10': 0.3219, 'time@10': 5.1618}:  70%|███████   | 7/10 [00:30<00:12,  4.03s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9481, 'compress@10': 0.3219, 'time@10': 5.1618}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9506, 'compress@10': 0.3194, 'time@10': 5.5485}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9506, 'compress@10': 0.3194, 'time@10': 5.5485}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9533, 'compress@10': 0.3209, 'time@10': 5.5702}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9533, 'compress@10': 0.3209, 'time@10': 5.5702}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9533, 'compress@10': 0.3209, 'time@10': 5.5702}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.012903120484165387
Avg hit ratio: 0.8720370795022747
Avg ndcg: 0.9532920061984671
Avg compression ratio: 0.3209144513360653
Avg train time: 5.5702426671981815
Std train time: 1.7624669666801145
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9214, 'compress@10': 0.3298, 'time@10': 4.7951}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9214, 'compress@10': 0.3298, 'time@10': 4.7951}:  10%|█         | 1/10 [00:02<00:21,  2.43s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9446, 'compress@10': 0.3221, 'time@10': 4.2971}:  10%|█         | 1/10 [00:06<00:21,  2.43s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9446, 'compress@10': 0.3221, 'time@10': 4.2971}:  20%|██        | 2/10 [00:06<00:26,  3.26s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9154, 'compress@10': 0.3453, 'time@10': 4.1069}:  20%|██        | 2/10 [00:08<00:26,  3.26s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9154, 'compress@10': 0.3453, 'time@10': 4.1069}:  30%|███       | 3/10 [00:08<00:18,  2.64s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9291, 'compress@10': 0.3391, 'time@10': 4.0171}:  30%|███       | 3/10 [00:11<00:18,  2.64s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9291, 'compress@10': 0.3391, 'time@10': 4.0171}:  40%|████      | 4/10 [00:11<00:18,  3.09s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.9334, 'compress@10': 0.3306, 'time@10': 4.8754}:  40%|████      | 4/10 [00:16<00:18,  3.09s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.9334, 'compress@10': 0.3306, 'time@10': 4.8754}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9407, 'compress@10': 0.32, 'time@10': 5.0977}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9407, 'compress@10': 0.32, 'time@10': 5.0977}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9421, 'compress@10': 0.3199, 'time@10': 5.3013}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9421, 'compress@10': 0.3199, 'time@10': 5.3013}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9435, 'compress@10': 0.3196, 'time@10': 5.2461}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]  {'epoch': 43, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9435, 'compress@10': 0.3196, 'time@10': 5.2461}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9626, 'compress@10': 0.3178, 'time@10': 5.6254}:  80%|████████  | 8/10 [00:34<00:08,  4.33s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9626, 'compress@10': 0.3178, 'time@10': 5.6254}:  90%|█████████ | 9/10 [00:34<00:04,  4.34s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9641, 'compress@10': 0.3178, 'time@10': 5.6531}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9641, 'compress@10': 0.3178, 'time@10': 5.6531}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9641, 'compress@10': 0.3178, 'time@10': 5.6531}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.014779709165075136
Avg hit ratio: 0.8825414317808205
Avg ndcg: 0.9640774481051858
Avg compression ratio: 0.31784782212407015
Avg train time: 5.653121876716614
Std train time: 1.7135624616361584
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.3247, 'time@10': 4.6863}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.3247, 'time@10': 4.6863}:  10%|█         | 1/10 [00:02<00:21,  2.38s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9608, 'compress@10': 0.3176, 'time@10': 4.2716}:  10%|█         | 1/10 [00:06<00:21,  2.38s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9608, 'compress@10': 0.3176, 'time@10': 4.2716}:  20%|██        | 2/10 [00:06<00:26,  3.27s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9263, 'compress@10': 0.3413, 'time@10': 4.0077}:  20%|██        | 2/10 [00:08<00:26,  3.27s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9263, 'compress@10': 0.3413, 'time@10': 4.0077}:  30%|███       | 3/10 [00:08<00:18,  2.59s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9352, 'compress@10': 0.3353, 'time@10': 3.9394}:  30%|███       | 3/10 [00:11<00:18,  2.59s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9352, 'compress@10': 0.3353, 'time@10': 3.9394}:  40%|████      | 4/10 [00:11<00:18,  3.06s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.9383, 'compress@10': 0.3278, 'time@10': 4.8176}:  40%|████      | 4/10 [00:16<00:18,  3.06s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.9383, 'compress@10': 0.3278, 'time@10': 4.8176}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9444, 'compress@10': 0.3166, 'time@10': 5.0357}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9444, 'compress@10': 0.3166, 'time@10': 5.0357}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.863, 'ndcg@10': 0.946, 'compress@10': 0.3162, 'time@10': 5.248}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]   {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.863, 'ndcg@10': 0.946, 'compress@10': 0.3162, 'time@10': 5.248}:  70%|███████   | 7/10 [00:25<00:12,  4.03s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9483, 'compress@10': 0.316, 'time@10': 5.1851}:  70%|███████   | 7/10 [00:30<00:12,  4.03s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9483, 'compress@10': 0.316, 'time@10': 5.1851}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9401, 'compress@10': 0.3135, 'time@10': 5.5702}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9401, 'compress@10': 0.3135, 'time@10': 5.5702}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9438, 'compress@10': 0.3124, 'time@10': 5.6017}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9438, 'compress@10': 0.3124, 'time@10': 5.6017}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9438, 'compress@10': 0.3124, 'time@10': 5.6017}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.011715849753515488
Avg hit ratio: 0.8818271460665349
Avg ndcg: 0.9437968485521206
Avg compression ratio: 0.31244319323860587
Avg train time: 5.601700210571289
Std train time: 1.7478055054646553
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9114, 'compress@10': 0.3197, 'time@10': 4.8413}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9114, 'compress@10': 0.3197, 'time@10': 4.8413}:  10%|█         | 1/10 [00:02<00:22,  2.46s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9396, 'compress@10': 0.3136, 'time@10': 4.2997}:  10%|█         | 1/10 [00:06<00:22,  2.46s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9396, 'compress@10': 0.3136, 'time@10': 4.2997}:  20%|██        | 2/10 [00:06<00:25,  3.25s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.7705, 'ndcg@10': 0.9121, 'compress@10': 0.3373, 'time@10': 4.0475}:  20%|██        | 2/10 [00:08<00:25,  3.25s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.7705, 'ndcg@10': 0.9121, 'compress@10': 0.3373, 'time@10': 4.0475}:  30%|███       | 3/10 [00:08<00:18,  2.60s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.81, 'ndcg@10': 0.925, 'compress@10': 0.3312, 'time@10': 3.9782}:  30%|███       | 3/10 [00:11<00:18,  2.60s/it]   {'epoch': 45, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.81, 'ndcg@10': 0.925, 'compress@10': 0.3312, 'time@10': 3.9782}:  40%|████      | 4/10 [00:11<00:18,  3.08s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.84, 'ndcg@10': 0.9304, 'compress@10': 0.3245, 'time@10': 4.8592}:  40%|████      | 4/10 [00:16<00:18,  3.08s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.84, 'ndcg@10': 0.9304, 'compress@10': 0.3245, 'time@10': 4.8592}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9426, 'compress@10': 0.3122, 'time@10': 5.0757}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9426, 'compress@10': 0.3122, 'time@10': 5.0757}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9458, 'compress@10': 0.3117, 'time@10': 5.2723}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9458, 'compress@10': 0.3117, 'time@10': 5.2723}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9478, 'compress@10': 0.3112, 'time@10': 5.1962}:  70%|███████   | 7/10 [00:30<00:12,  4.04s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9478, 'compress@10': 0.3112, 'time@10': 5.1962}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9499, 'compress@10': 0.3095, 'time@10': 5.5668}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9499, 'compress@10': 0.3095, 'time@10': 5.5668}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9506, 'compress@10': 0.3081, 'time@10': 5.5881}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9506, 'compress@10': 0.3081, 'time@10': 5.5881}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9506, 'compress@10': 0.3081, 'time@10': 5.5881}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.009863596162469948
Avg hit ratio: 0.8842029781197862
Avg ndcg: 0.9505996747993415
Avg compression ratio: 0.3081273220395103
Avg train time: 5.588068556785584
Std train time: 1.7273485117557699
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.3149, 'time@10': 4.8214}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.3149, 'time@10': 4.8214}:  10%|█         | 1/10 [00:02<00:22,  2.45s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9477, 'compress@10': 0.308, 'time@10': 4.2124}:  10%|█         | 1/10 [00:06<00:22,  2.45s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9477, 'compress@10': 0.308, 'time@10': 4.2124}:  20%|██        | 2/10 [00:06<00:26,  3.29s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9175, 'compress@10': 0.3324, 'time@10': 4.0032}:  20%|██        | 2/10 [00:08<00:26,  3.29s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9175, 'compress@10': 0.3324, 'time@10': 4.0032}:  30%|███       | 3/10 [00:08<00:18,  2.64s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8028, 'ndcg@10': 0.9296, 'compress@10': 0.3265, 'time@10': 3.9464}:  30%|███       | 3/10 [00:12<00:18,  2.64s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8028, 'ndcg@10': 0.9296, 'compress@10': 0.3265, 'time@10': 3.9464}:  40%|████      | 4/10 [00:12<00:18,  3.10s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.934, 'compress@10': 0.3199, 'time@10': 4.8102}:  40%|████      | 4/10 [00:16<00:18,  3.10s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.934, 'compress@10': 0.3199, 'time@10': 4.8102}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9412, 'compress@10': 0.308, 'time@10': 5.0628}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9412, 'compress@10': 0.308, 'time@10': 5.0628}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.867, 'ndcg@10': 0.9414, 'compress@10': 0.3075, 'time@10': 5.2775}:  60%|██████    | 6/10 [00:25<00:17,  4.47s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.867, 'ndcg@10': 0.9414, 'compress@10': 0.3075, 'time@10': 5.2775}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.88, 'ndcg@10': 0.9438, 'compress@10': 0.307, 'time@10': 5.2053}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]    {'epoch': 46, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.88, 'ndcg@10': 0.9438, 'compress@10': 0.307, 'time@10': 5.2053}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9469, 'compress@10': 0.3056, 'time@10': 5.5789}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9469, 'compress@10': 0.3056, 'time@10': 5.5789}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9491, 'compress@10': 0.304, 'time@10': 5.6182}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9491, 'compress@10': 0.304, 'time@10': 5.6182}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9491, 'compress@10': 0.304, 'time@10': 5.6182}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.00994912596756593
Avg hit ratio: 0.8789100953752905
Avg ndcg: 0.9491426609962179
Avg compression ratio: 0.3040275152777878
Avg train time: 5.61816554069519
Std train time: 1.7405894154719106
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.3109, 'time@10': 4.7036}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.3109, 'time@10': 4.7036}:  10%|█         | 1/10 [00:02<00:21,  2.39s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9661, 'compress@10': 0.3042, 'time@10': 4.1955}:  10%|█         | 1/10 [00:06<00:21,  2.39s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9661, 'compress@10': 0.3042, 'time@10': 4.1955}:  20%|██        | 2/10 [00:06<00:25,  3.18s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9297, 'compress@10': 0.3287, 'time@10': 3.9489}:  20%|██        | 2/10 [00:07<00:25,  3.18s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9297, 'compress@10': 0.3287, 'time@10': 3.9489}:  30%|███       | 3/10 [00:07<00:17,  2.53s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9406, 'compress@10': 0.3227, 'time@10': 3.8963}:  30%|███       | 3/10 [00:11<00:17,  2.53s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9406, 'compress@10': 0.3227, 'time@10': 3.8963}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.9437, 'compress@10': 0.3161, 'time@10': 4.7754}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.9437, 'compress@10': 0.3161, 'time@10': 4.7754}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9549, 'compress@10': 0.3043, 'time@10': 5.0115}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9549, 'compress@10': 0.3043, 'time@10': 5.0115}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9556, 'compress@10': 0.3036, 'time@10': 5.2457}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it] {'epoch': 47, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9556, 'compress@10': 0.3036, 'time@10': 5.2457}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9548, 'compress@10': 0.3031, 'time@10': 5.185}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9548, 'compress@10': 0.3031, 'time@10': 5.185}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9544, 'compress@10': 0.3015, 'time@10': 5.5545}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9544, 'compress@10': 0.3015, 'time@10': 5.5545}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9593, 'compress@10': 0.3001, 'time@10': 5.5805}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9593, 'compress@10': 0.3001, 'time@10': 5.5805}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9593, 'compress@10': 0.3001, 'time@10': 5.5805}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.012809306369694812
Avg hit ratio: 0.878970003209392
Avg ndcg: 0.9593165489366685
Avg compression ratio: 0.3001048960737701
Avg train time: 5.580480146408081
Std train time: 1.7448010730856571
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0045, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.3076, 'time@10': 4.9402}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0045, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.3076, 'time@10': 4.9402}:  10%|█         | 1/10 [00:02<00:22,  2.51s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0057, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9514, 'compress@10': 0.3017, 'time@10': 4.2977}:  10%|█         | 1/10 [00:06<00:22,  2.51s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0057, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9514, 'compress@10': 0.3017, 'time@10': 4.2977}:  20%|██        | 2/10 [00:06<00:25,  3.21s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.749, 'ndcg@10': 0.92, 'compress@10': 0.3262, 'time@10': 4.0226}:  20%|██        | 2/10 [00:07<00:25,  3.21s/it]   {'epoch': 48, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.749, 'ndcg@10': 0.92, 'compress@10': 0.3262, 'time@10': 4.0226}:  30%|███       | 3/10 [00:07<00:17,  2.55s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9338, 'compress@10': 0.3199, 'time@10': 3.9696}:  30%|███       | 3/10 [00:11<00:17,  2.55s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9338, 'compress@10': 0.3199, 'time@10': 3.9696}:  40%|████      | 4/10 [00:11<00:18,  3.07s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9388, 'compress@10': 0.3132, 'time@10': 4.8337}:  40%|████      | 4/10 [00:16<00:18,  3.07s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9388, 'compress@10': 0.3132, 'time@10': 4.8337}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0104, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9426, 'compress@10': 0.3022, 'time@10': 5.0758}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0104, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9426, 'compress@10': 0.3022, 'time@10': 5.0758}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9451, 'compress@10': 0.3013, 'time@10': 5.335}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it] {'epoch': 48, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9451, 'compress@10': 0.3013, 'time@10': 5.335}:  70%|███████   | 7/10 [00:25<00:12,  4.13s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.947, 'compress@10': 0.3007, 'time@10': 5.2716}:  70%|███████   | 7/10 [00:30<00:12,  4.13s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.947, 'compress@10': 0.3007, 'time@10': 5.2716}:  80%|████████  | 8/10 [00:30<00:08,  4.36s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9483, 'compress@10': 0.2987, 'time@10': 5.6579}:  80%|████████  | 8/10 [00:35<00:08,  4.36s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9483, 'compress@10': 0.2987, 'time@10': 5.6579}:  90%|█████████ | 9/10 [00:35<00:04,  4.38s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9484, 'compress@10': 0.2971, 'time@10': 5.6761}:  90%|█████████ | 9/10 [00:40<00:04,  4.38s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9484, 'compress@10': 0.2971, 'time@10': 5.6761}: 100%|██████████| 10/10 [00:40<00:00,  4.84s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9484, 'compress@10': 0.2971, 'time@10': 5.6761}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.011474043707621647
Avg hit ratio: 0.8771164445816397
Avg ndcg: 0.9484317293990845
Avg compression ratio: 0.2971259450310518
Avg train time: 5.676052498817444
Std train time: 1.7838266959143174
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9305, 'compress@10': 0.3053, 'time@10': 4.646}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9305, 'compress@10': 0.3053, 'time@10': 4.646}:  10%|█         | 1/10 [00:02<00:21,  2.36s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9491, 'compress@10': 0.2984, 'time@10': 4.1262}:  10%|█         | 1/10 [00:06<00:21,  2.36s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9491, 'compress@10': 0.2984, 'time@10': 4.1262}:  20%|██        | 2/10 [00:06<00:24,  3.12s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9185, 'compress@10': 0.3229, 'time@10': 3.88}:  20%|██        | 2/10 [00:07<00:24,  3.12s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9185, 'compress@10': 0.3229, 'time@10': 3.88}:  30%|███       | 3/10 [00:07<00:17,  2.48s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9303, 'compress@10': 0.3166, 'time@10': 3.8522}:  30%|███       | 3/10 [00:11<00:17,  2.48s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9303, 'compress@10': 0.3166, 'time@10': 3.8522}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.936, 'compress@10': 0.3098, 'time@10': 4.7318}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.936, 'compress@10': 0.3098, 'time@10': 4.7318}:  50%|█████     | 5/10 [00:15<00:17,  3.42s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.008, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.9428, 'compress@10': 0.2978, 'time@10': 4.9714}:  50%|█████     | 5/10 [00:21<00:17,  3.42s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.008, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.9428, 'compress@10': 0.2978, 'time@10': 4.9714}:  60%|██████    | 6/10 [00:21<00:17,  4.37s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.9459, 'compress@10': 0.2971, 'time@10': 5.1797}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.9459, 'compress@10': 0.2971, 'time@10': 5.1797}:  70%|███████   | 7/10 [00:25<00:12,  4.02s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9502, 'compress@10': 0.2967, 'time@10': 5.0819}:  70%|███████   | 7/10 [00:29<00:12,  4.02s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9502, 'compress@10': 0.2967, 'time@10': 5.0819}:  80%|████████  | 8/10 [00:29<00:08,  4.15s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0084, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.9522, 'compress@10': 0.2949, 'time@10': 5.4165}:  80%|████████  | 8/10 [00:33<00:08,  4.15s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0084, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.9522, 'compress@10': 0.2949, 'time@10': 5.4165}:  90%|█████████ | 9/10 [00:33<00:04,  4.13s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0076, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9547, 'compress@10': 0.2935, 'time@10': 5.3974}:  90%|█████████ | 9/10 [00:39<00:04,  4.13s/it]    {'epoch': 49, 'num_users': 6.3, 'loss': 0.0076, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9547, 'compress@10': 0.2935, 'time@10': 5.3974}: 100%|██████████| 10/10 [00:39<00:00,  4.48s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0076, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9547, 'compress@10': 0.2935, 'time@10': 5.3974}: 100%|██████████| 10/10 [00:39<00:00,  3.90s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.007626596855656575
Avg hit ratio: 0.8710334952728841
Avg ndcg: 0.9547268829786306
Avg compression ratio: 0.2934902311614215
Avg train time: 5.397431468963623
Std train time: 1.6899368355647075
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
