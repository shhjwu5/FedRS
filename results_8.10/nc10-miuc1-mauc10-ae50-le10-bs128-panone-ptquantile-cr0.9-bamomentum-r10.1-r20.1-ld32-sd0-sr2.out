  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.164, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.4936, 'compress@10': 0.9052, 'time@10': 8.8998}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.164, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.4936, 'compress@10': 0.9052, 'time@10': 8.8998}:  10%|█         | 1/10 [00:04<00:40,  4.49s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1188, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.6431, 'compress@10': 0.9042, 'time@10': 7.6681}:  10%|█         | 1/10 [00:10<00:40,  4.49s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1188, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.6431, 'compress@10': 0.9042, 'time@10': 7.6681}:  20%|██        | 2/10 [00:10<00:45,  5.66s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7458, 'hit_ratio@10': 0.451, 'ndcg@10': 0.4288, 'compress@10': 0.9076, 'time@10': 5.9753}:  20%|██        | 2/10 [00:12<00:45,  5.66s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.7458, 'hit_ratio@10': 0.451, 'ndcg@10': 0.4288, 'compress@10': 0.9076, 'time@10': 5.9753}:  30%|███       | 3/10 [00:12<00:25,  3.68s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5836, 'hit_ratio@10': 0.5347, 'ndcg@10': 0.4832, 'compress@10': 0.9066, 'time@10': 5.9259}:  30%|███       | 3/10 [00:18<00:25,  3.68s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5836, 'hit_ratio@10': 0.5347, 'ndcg@10': 0.4832, 'compress@10': 0.9066, 'time@10': 5.9259}:  40%|████      | 4/10 [00:18<00:27,  4.53s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4856, 'hit_ratio@10': 0.5918, 'ndcg@10': 0.5372, 'compress@10': 0.9057, 'time@10': 9.0043}:  40%|████      | 4/10 [00:28<00:27,  4.53s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4856, 'hit_ratio@10': 0.5918, 'ndcg@10': 0.5372, 'compress@10': 0.9057, 'time@10': 9.0043}:  50%|█████     | 5/10 [00:28<00:33,  6.75s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4191, 'hit_ratio@10': 0.608, 'ndcg@10': 0.5795, 'compress@10': 0.9051, 'time@10': 9.1598}:  50%|█████     | 5/10 [00:38<00:33,  6.75s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4191, 'hit_ratio@10': 0.608, 'ndcg@10': 0.5795, 'compress@10': 0.9051, 'time@10': 9.1598}:  60%|██████    | 6/10 [00:38<00:31,  7.85s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3752, 'hit_ratio@10': 0.6297, 'ndcg@10': 0.5799, 'compress@10': 0.9049, 'time@10': 9.3503}:  60%|██████    | 6/10 [00:44<00:31,  7.85s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3752, 'hit_ratio@10': 0.6297, 'ndcg@10': 0.5799, 'compress@10': 0.9049, 'time@10': 9.3503}:  70%|███████   | 7/10 [00:44<00:21,  7.02s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3342, 'hit_ratio@10': 0.6653, 'ndcg@10': 0.6061, 'compress@10': 0.9047, 'time@10': 9.1273}:  70%|███████   | 7/10 [00:51<00:21,  7.02s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3342, 'hit_ratio@10': 0.6653, 'ndcg@10': 0.6061, 'compress@10': 0.9047, 'time@10': 9.1273}:  80%|████████  | 8/10 [00:51<00:14,  7.21s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3031, 'hit_ratio@10': 0.6802, 'ndcg@10': 0.6393, 'compress@10': 0.9045, 'time@10': 9.7422}:  80%|████████  | 8/10 [00:59<00:14,  7.21s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3031, 'hit_ratio@10': 0.6802, 'ndcg@10': 0.6393, 'compress@10': 0.9045, 'time@10': 9.7422}:  90%|█████████ | 9/10 [00:59<00:07,  7.26s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.278, 'hit_ratio@10': 0.7054, 'ndcg@10': 0.6596, 'compress@10': 0.9042, 'time@10': 9.7139}:  90%|█████████ | 9/10 [01:08<00:07,  7.26s/it]    {'epoch': 0, 'num_users': 6.3, 'loss': 0.278, 'hit_ratio@10': 0.7054, 'ndcg@10': 0.6596, 'compress@10': 0.9042, 'time@10': 9.7139}: 100%|██████████| 10/10 [01:08<00:00,  7.95s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.278, 'hit_ratio@10': 0.7054, 'ndcg@10': 0.6596, 'compress@10': 0.9042, 'time@10': 9.7139}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.27804153585823804
Avg hit ratio: 0.705384798751522
Avg ndcg: 0.6596248956253921
Avg compression ratio: 0.9042398979678792
Avg train time: 9.713937187194825
Std train time: 4.920485434980541
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0519, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8305, 'compress@10': 0.9052, 'time@10': 7.7618}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0519, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8305, 'compress@10': 0.9052, 'time@10': 7.7618}:  10%|█         | 1/10 [00:03<00:35,  3.92s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0524, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8424, 'compress@10': 0.9042, 'time@10': 7.1315}:  10%|█         | 1/10 [00:10<00:35,  3.92s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0524, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8424, 'compress@10': 0.9042, 'time@10': 7.1315}:  20%|██        | 2/10 [00:10<00:43,  5.46s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0416, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8132, 'compress@10': 0.9076, 'time@10': 5.7299}:  20%|██        | 2/10 [00:11<00:43,  5.46s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0416, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8132, 'compress@10': 0.9076, 'time@10': 5.7299}:  30%|███       | 3/10 [00:11<00:25,  3.65s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0436, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8206, 'compress@10': 0.9066, 'time@10': 5.8078}:  30%|███       | 3/10 [00:18<00:25,  3.65s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0436, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8206, 'compress@10': 0.9066, 'time@10': 5.8078}:  40%|████      | 4/10 [00:18<00:27,  4.62s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0525, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8136, 'compress@10': 0.9057, 'time@10': 8.989}:  40%|████      | 4/10 [00:28<00:27,  4.62s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.0525, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8136, 'compress@10': 0.9057, 'time@10': 8.989}:  50%|█████     | 5/10 [00:28<00:34,  6.88s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0567, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8127, 'compress@10': 0.9051, 'time@10': 9.1277}:  50%|█████     | 5/10 [00:38<00:34,  6.88s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0567, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8127, 'compress@10': 0.9051, 'time@10': 9.1277}:  60%|██████    | 6/10 [00:38<00:31,  7.89s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0547, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8198, 'compress@10': 0.9049, 'time@10': 9.3583}:  60%|██████    | 6/10 [00:44<00:31,  7.89s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0547, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8198, 'compress@10': 0.9049, 'time@10': 9.3583}:  70%|███████   | 7/10 [00:44<00:21,  7.08s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0525, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8261, 'compress@10': 0.9047, 'time@10': 9.1377}:  70%|███████   | 7/10 [00:51<00:21,  7.08s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0525, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8261, 'compress@10': 0.9047, 'time@10': 9.1377}:  80%|████████  | 8/10 [00:51<00:14,  7.26s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8354, 'compress@10': 0.9045, 'time@10': 9.5809}:  80%|████████  | 8/10 [00:58<00:14,  7.26s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8354, 'compress@10': 0.9045, 'time@10': 9.5809}:  90%|█████████ | 9/10 [00:58<00:07,  7.05s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8365, 'compress@10': 0.9042, 'time@10': 9.6389}:  90%|█████████ | 9/10 [01:08<00:07,  7.05s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8365, 'compress@10': 0.9042, 'time@10': 9.6389}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8365, 'compress@10': 0.9042, 'time@10': 9.6389}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.050126188366670446
Avg hit ratio: 0.8238183827114218
Avg ndcg: 0.8364620500932756
Avg compression ratio: 0.9042398871491631
Avg train time: 9.638872194290162
Std train time: 4.848015487622691
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.9052, 'time@10': 7.8767}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.9052, 'time@10': 7.8767}:  10%|█         | 1/10 [00:03<00:35,  3.97s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8468, 'compress@10': 0.9042, 'time@10': 7.2683}:  10%|█         | 1/10 [00:10<00:35,  3.97s/it]  {'epoch': 2, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8468, 'compress@10': 0.9042, 'time@10': 7.2683}:  20%|██        | 2/10 [00:10<00:44,  5.57s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8503, 'compress@10': 0.9076, 'time@10': 5.8779}:  20%|██        | 2/10 [00:12<00:44,  5.57s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8503, 'compress@10': 0.9076, 'time@10': 5.8779}:  30%|███       | 3/10 [00:12<00:26,  3.75s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.038, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8491, 'compress@10': 0.9066, 'time@10': 5.8811}:  30%|███       | 3/10 [00:18<00:26,  3.75s/it]  {'epoch': 2, 'num_users': 5.0, 'loss': 0.038, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8491, 'compress@10': 0.9066, 'time@10': 5.8811}:  40%|████      | 4/10 [00:18<00:27,  4.61s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0478, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.8357, 'compress@10': 0.9057, 'time@10': 8.2888}:  40%|████      | 4/10 [00:27<00:27,  4.61s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0478, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.8357, 'compress@10': 0.9057, 'time@10': 8.2888}:  50%|█████     | 5/10 [00:27<00:30,  6.19s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0524, 'hit_ratio@10': 0.7673, 'ndcg@10': 0.833, 'compress@10': 0.9051, 'time@10': 8.599}:  50%|█████     | 5/10 [00:37<00:30,  6.19s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0524, 'hit_ratio@10': 0.7673, 'ndcg@10': 0.833, 'compress@10': 0.9051, 'time@10': 8.599}:  60%|██████    | 6/10 [00:37<00:30,  7.55s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.051, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.8343, 'compress@10': 0.9049, 'time@10': 8.87}:  60%|██████    | 6/10 [00:42<00:30,  7.55s/it] {'epoch': 2, 'num_users': 6.2857, 'loss': 0.051, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.8343, 'compress@10': 0.9049, 'time@10': 8.87}:  70%|███████   | 7/10 [00:42<00:20,  6.81s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8348, 'compress@10': 0.9047, 'time@10': 8.7063}:  70%|███████   | 7/10 [00:50<00:20,  6.81s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8348, 'compress@10': 0.9047, 'time@10': 8.7063}:  80%|████████  | 8/10 [00:50<00:14,  7.06s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8433, 'compress@10': 0.9045, 'time@10': 9.1544}:  80%|████████  | 8/10 [00:56<00:14,  7.06s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8433, 'compress@10': 0.9045, 'time@10': 9.1544}:  90%|█████████ | 9/10 [00:56<00:06,  6.86s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0503, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8432, 'compress@10': 0.9042, 'time@10': 9.187}:  90%|█████████ | 9/10 [01:06<00:06,  6.86s/it]    {'epoch': 2, 'num_users': 6.3, 'loss': 0.0503, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8432, 'compress@10': 0.9042, 'time@10': 9.187}: 100%|██████████| 10/10 [01:06<00:00,  7.68s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0503, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8432, 'compress@10': 0.9042, 'time@10': 9.187}: 100%|██████████| 10/10 [01:06<00:00,  6.62s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.05029913819813788
Avg hit ratio: 0.8181040969971362
Avg ndcg: 0.8432050375706703
Avg compression ratio: 0.9042398831348375
Avg train time: 9.187005615234375
Std train time: 3.8768625260238125
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8565, 'compress@10': 0.9052, 'time@10': 8.0314}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8565, 'compress@10': 0.9052, 'time@10': 8.0314}:  10%|█         | 1/10 [00:04<00:36,  4.06s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8504, 'compress@10': 0.9042, 'time@10': 7.505}:  10%|█         | 1/10 [00:11<00:36,  4.06s/it]  {'epoch': 3, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8504, 'compress@10': 0.9042, 'time@10': 7.505}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8526, 'compress@10': 0.9076, 'time@10': 6.1021}:  20%|██        | 2/10 [00:12<00:46,  5.80s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8526, 'compress@10': 0.9076, 'time@10': 6.1021}:  30%|███       | 3/10 [00:12<00:27,  3.92s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0374, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8481, 'compress@10': 0.9066, 'time@10': 6.0516}:  30%|███       | 3/10 [00:18<00:27,  3.92s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0374, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8481, 'compress@10': 0.9066, 'time@10': 6.0516}:  40%|████      | 4/10 [00:18<00:28,  4.72s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0469, 'hit_ratio@10': 0.772, 'ndcg@10': 0.8367, 'compress@10': 0.9057, 'time@10': 7.8718}:  40%|████      | 4/10 [00:26<00:28,  4.72s/it] {'epoch': 3, 'num_users': 5.8, 'loss': 0.0469, 'hit_ratio@10': 0.772, 'ndcg@10': 0.8367, 'compress@10': 0.9057, 'time@10': 7.8718}:  50%|█████     | 5/10 [00:26<00:28,  5.76s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0509, 'hit_ratio@10': 0.773, 'ndcg@10': 0.8345, 'compress@10': 0.9051, 'time@10': 8.1435}:  50%|█████     | 5/10 [00:35<00:28,  5.76s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0509, 'hit_ratio@10': 0.773, 'ndcg@10': 0.8345, 'compress@10': 0.9051, 'time@10': 8.1435}:  60%|██████    | 6/10 [00:35<00:28,  7.05s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.7997, 'ndcg@10': 0.8379, 'compress@10': 0.9049, 'time@10': 8.4918}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.7997, 'ndcg@10': 0.8379, 'compress@10': 0.9049, 'time@10': 8.4918}:  70%|███████   | 7/10 [00:41<00:19,  6.48s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0525, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8404, 'compress@10': 0.9047, 'time@10': 8.3741}:  70%|███████   | 7/10 [00:48<00:19,  6.48s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0525, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8404, 'compress@10': 0.9047, 'time@10': 8.3741}:  80%|████████  | 8/10 [00:48<00:13,  6.83s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0508, 'hit_ratio@10': 0.8093, 'ndcg@10': 0.849, 'compress@10': 0.9045, 'time@10': 8.962}:  80%|████████  | 8/10 [00:55<00:13,  6.83s/it] {'epoch': 3, 'num_users': 6.3333, 'loss': 0.0508, 'hit_ratio@10': 0.8093, 'ndcg@10': 0.849, 'compress@10': 0.9045, 'time@10': 8.962}:  90%|█████████ | 9/10 [00:55<00:06,  6.85s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8484, 'compress@10': 0.9042, 'time@10': 9.0099}:  90%|█████████ | 9/10 [01:05<00:06,  6.85s/it] {'epoch': 3, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8484, 'compress@10': 0.9042, 'time@10': 9.0099}: 100%|██████████| 10/10 [01:05<00:00,  7.66s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8484, 'compress@10': 0.9042, 'time@10': 9.0099}: 100%|██████████| 10/10 [01:05<00:00,  6.51s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.05043873194868705
Avg hit ratio: 0.8215521256709712
Avg ndcg: 0.8484380947009577
Avg compression ratio: 0.9042398812711013
Avg train time: 9.009945917129517
Std train time: 3.3441648995669353
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.851, 'compress@10': 0.9052, 'time@10': 7.9013}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.851, 'compress@10': 0.9052, 'time@10': 7.9013}:  10%|█         | 1/10 [00:03<00:35,  3.99s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8517, 'compress@10': 0.9042, 'time@10': 7.234}:  10%|█         | 1/10 [00:10<00:35,  3.99s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8517, 'compress@10': 0.9042, 'time@10': 7.234}:  20%|██        | 2/10 [00:10<00:44,  5.53s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8535, 'compress@10': 0.9076, 'time@10': 6.0704}:  20%|██        | 2/10 [00:12<00:44,  5.53s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8535, 'compress@10': 0.9076, 'time@10': 6.0704}:  30%|███       | 3/10 [00:12<00:27,  3.87s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0407, 'hit_ratio@10': 0.782, 'ndcg@10': 0.849, 'compress@10': 0.9066, 'time@10': 6.0354}:  30%|███       | 3/10 [00:18<00:27,  3.87s/it]  {'epoch': 4, 'num_users': 5.0, 'loss': 0.0407, 'hit_ratio@10': 0.782, 'ndcg@10': 0.849, 'compress@10': 0.9066, 'time@10': 6.0354}:  40%|████      | 4/10 [00:18<00:28,  4.70s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0495, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8358, 'compress@10': 0.9057, 'time@10': 7.4573}:  40%|████      | 4/10 [00:25<00:28,  4.70s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0495, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8358, 'compress@10': 0.9057, 'time@10': 7.4573}:  50%|█████     | 5/10 [00:25<00:26,  5.40s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0524, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.8338, 'compress@10': 0.9051, 'time@10': 7.9118}:  50%|█████     | 5/10 [00:35<00:26,  5.40s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0524, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.8338, 'compress@10': 0.9051, 'time@10': 7.9118}:  60%|██████    | 6/10 [00:35<00:28,  7.04s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0514, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8411, 'compress@10': 0.9049, 'time@10': 8.2734}:  60%|██████    | 6/10 [00:40<00:28,  7.04s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0514, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8411, 'compress@10': 0.9049, 'time@10': 8.2734}:  70%|███████   | 7/10 [00:40<00:19,  6.46s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0524, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8458, 'compress@10': 0.9047, 'time@10': 8.1705}:  70%|███████   | 7/10 [00:48<00:19,  6.46s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0524, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8458, 'compress@10': 0.9047, 'time@10': 8.1705}:  80%|████████  | 8/10 [00:48<00:13,  6.78s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0519, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8559, 'compress@10': 0.9045, 'time@10': 8.7314}:  80%|████████  | 8/10 [00:54<00:13,  6.78s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0519, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8559, 'compress@10': 0.9045, 'time@10': 8.7314}:  90%|█████████ | 9/10 [00:54<00:06,  6.74s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0512, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8559, 'compress@10': 0.9042, 'time@10': 8.7977}:  90%|█████████ | 9/10 [01:04<00:06,  6.74s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0512, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8559, 'compress@10': 0.9042, 'time@10': 8.7977}: 100%|██████████| 10/10 [01:04<00:00,  7.57s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0512, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8559, 'compress@10': 0.9042, 'time@10': 8.7977}: 100%|██████████| 10/10 [01:04<00:00,  6.41s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.051235785269221804
Avg hit ratio: 0.8374287257733778
Avg ndcg: 0.8558534916390249
Avg compression ratio: 0.9042398749080232
Avg train time: 8.797746586799622
Std train time: 2.911940122241286
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8531, 'compress@10': 0.9052, 'time@10': 8.5203}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8531, 'compress@10': 0.9052, 'time@10': 8.5203}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8516, 'compress@10': 0.9042, 'time@10': 7.582}:  10%|█         | 1/10 [00:10<00:38,  4.30s/it]   {'epoch': 5, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8516, 'compress@10': 0.9042, 'time@10': 7.582}:  20%|██        | 2/10 [00:10<00:45,  5.70s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8534, 'compress@10': 0.9076, 'time@10': 6.3832}:  20%|██        | 2/10 [00:13<00:45,  5.70s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8534, 'compress@10': 0.9076, 'time@10': 6.3832}:  30%|███       | 3/10 [00:13<00:28,  4.02s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8411, 'compress@10': 0.9066, 'time@10': 6.2504}:  30%|███       | 3/10 [00:18<00:28,  4.02s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8411, 'compress@10': 0.9066, 'time@10': 6.2504}:  40%|████      | 4/10 [00:18<00:28,  4.76s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0473, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8292, 'compress@10': 0.9057, 'time@10': 7.5485}:  40%|████      | 4/10 [00:25<00:28,  4.76s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0473, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8292, 'compress@10': 0.9057, 'time@10': 7.5485}:  50%|█████     | 5/10 [00:25<00:26,  5.35s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0499, 'hit_ratio@10': 0.8038, 'ndcg@10': 0.8295, 'compress@10': 0.9051, 'time@10': 7.8972}:  50%|█████     | 5/10 [00:34<00:26,  5.35s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0499, 'hit_ratio@10': 0.8038, 'ndcg@10': 0.8295, 'compress@10': 0.9051, 'time@10': 7.8972}:  60%|██████    | 6/10 [00:34<00:27,  6.82s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8304, 'compress@10': 0.9049, 'time@10': 8.2911}:  60%|██████    | 6/10 [00:40<00:27,  6.82s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8304, 'compress@10': 0.9049, 'time@10': 8.2911}:  70%|███████   | 7/10 [00:40<00:19,  6.35s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0502, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8319, 'compress@10': 0.9047, 'time@10': 8.2006}:  70%|███████   | 7/10 [00:47<00:19,  6.35s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0502, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8319, 'compress@10': 0.9047, 'time@10': 8.2006}:  80%|████████  | 8/10 [00:47<00:13,  6.75s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.051, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8613, 'compress@10': 0.9045, 'time@10': 8.8028}:  80%|████████  | 8/10 [00:54<00:13,  6.75s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.051, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8613, 'compress@10': 0.9045, 'time@10': 8.8028}:  90%|█████████ | 9/10 [00:54<00:06,  6.78s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8602, 'compress@10': 0.9042, 'time@10': 8.8704}:  90%|█████████ | 9/10 [01:04<00:06,  6.78s/it]  {'epoch': 5, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8602, 'compress@10': 0.9042, 'time@10': 8.8704}: 100%|██████████| 10/10 [01:04<00:00,  7.62s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8602, 'compress@10': 0.9042, 'time@10': 8.8704}: 100%|██████████| 10/10 [01:04<00:00,  6.43s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.0500605744702173
Avg hit ratio: 0.8457743478931935
Avg ndcg: 0.8601739275270118
Avg compression ratio: 0.9042398804119459
Avg train time: 8.870406985282898
Std train time: 2.8537750815035303
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8639, 'compress@10': 0.9052, 'time@10': 7.9395}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8639, 'compress@10': 0.9052, 'time@10': 7.9395}:  10%|█         | 1/10 [00:04<00:36,  4.01s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8613, 'compress@10': 0.9042, 'time@10': 7.2972}:  10%|█         | 1/10 [00:10<00:36,  4.01s/it] {'epoch': 6, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8613, 'compress@10': 0.9042, 'time@10': 7.2972}:  20%|██        | 2/10 [00:10<00:44,  5.58s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8599, 'compress@10': 0.9076, 'time@10': 6.2886}:  20%|██        | 2/10 [00:12<00:44,  5.58s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8599, 'compress@10': 0.9076, 'time@10': 6.2886}:  30%|███       | 3/10 [00:12<00:28,  4.03s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.852, 'compress@10': 0.9066, 'time@10': 6.2251}:  30%|███       | 3/10 [00:18<00:28,  4.03s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.852, 'compress@10': 0.9066, 'time@10': 6.2251}:  40%|████      | 4/10 [00:18<00:29,  4.84s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0445, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8391, 'compress@10': 0.9057, 'time@10': 7.882}:  40%|████      | 4/10 [00:26<00:29,  4.84s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0445, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8391, 'compress@10': 0.9057, 'time@10': 7.882}:  50%|█████     | 5/10 [00:26<00:28,  5.72s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0467, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8381, 'compress@10': 0.9051, 'time@10': 8.1815}:  50%|█████     | 5/10 [00:35<00:28,  5.72s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0467, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8381, 'compress@10': 0.9051, 'time@10': 8.1815}:  60%|██████    | 6/10 [00:35<00:28,  7.09s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0467, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8443, 'compress@10': 0.9049, 'time@10': 8.5618}:  60%|██████    | 6/10 [00:41<00:28,  7.09s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0467, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8443, 'compress@10': 0.9049, 'time@10': 8.5618}:  70%|███████   | 7/10 [00:41<00:19,  6.55s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.047, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8415, 'compress@10': 0.9047, 'time@10': 8.4369}:  70%|███████   | 7/10 [00:49<00:19,  6.55s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.047, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8415, 'compress@10': 0.9047, 'time@10': 8.4369}:  80%|████████  | 8/10 [00:49<00:13,  6.89s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0479, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8505, 'compress@10': 0.9045, 'time@10': 9.0237}:  80%|████████  | 8/10 [00:55<00:13,  6.89s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0479, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8505, 'compress@10': 0.9045, 'time@10': 9.0237}:  90%|█████████ | 9/10 [00:55<00:06,  6.89s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0471, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.854, 'compress@10': 0.9042, 'time@10': 9.0991}:  90%|█████████ | 9/10 [01:05<00:06,  6.89s/it]    {'epoch': 6, 'num_users': 6.3, 'loss': 0.0471, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.854, 'compress@10': 0.9042, 'time@10': 9.0991}: 100%|██████████| 10/10 [01:05<00:00,  7.79s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0471, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.854, 'compress@10': 0.9042, 'time@10': 9.0991}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04712428971338499
Avg hit ratio: 0.8594251415439871
Avg ndcg: 0.8539951573021553
Avg compression ratio: 0.9042398588616471
Avg train time: 9.099086546897889
Std train time: 3.1115641972710133
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8399, 'compress@10': 0.9052, 'time@10': 8.0288}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8399, 'compress@10': 0.9052, 'time@10': 8.0288}:  10%|█         | 1/10 [00:04<00:36,  4.09s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.044, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8544, 'compress@10': 0.9042, 'time@10': 7.4208}:  10%|█         | 1/10 [00:10<00:36,  4.09s/it] {'epoch': 7, 'num_users': 7.0, 'loss': 0.044, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8544, 'compress@10': 0.9042, 'time@10': 7.4208}:  20%|██        | 2/10 [00:10<00:45,  5.71s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8553, 'compress@10': 0.9076, 'time@10': 6.4753}:  20%|██        | 2/10 [00:13<00:45,  5.71s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8553, 'compress@10': 0.9076, 'time@10': 6.4753}:  30%|███       | 3/10 [00:13<00:29,  4.22s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8484, 'compress@10': 0.9066, 'time@10': 6.3761}:  30%|███       | 3/10 [00:19<00:29,  4.22s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8484, 'compress@10': 0.9066, 'time@10': 6.3761}:  40%|████      | 4/10 [00:19<00:29,  4.97s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0425, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8366, 'compress@10': 0.9057, 'time@10': 7.727}:  40%|████      | 4/10 [00:26<00:29,  4.97s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.0425, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8366, 'compress@10': 0.9057, 'time@10': 7.727}:  50%|█████     | 5/10 [00:26<00:27,  5.57s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0443, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8374, 'compress@10': 0.9051, 'time@10': 8.0752}:  50%|█████     | 5/10 [00:35<00:27,  5.57s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0443, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8374, 'compress@10': 0.9051, 'time@10': 8.0752}:  60%|██████    | 6/10 [00:35<00:28,  7.02s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0436, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8381, 'compress@10': 0.9049, 'time@10': 8.5065}:  60%|██████    | 6/10 [00:41<00:28,  7.02s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0436, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8381, 'compress@10': 0.9049, 'time@10': 8.5065}:  70%|███████   | 7/10 [00:41<00:19,  6.56s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0439, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.836, 'compress@10': 0.9047, 'time@10': 8.3914}:  70%|███████   | 7/10 [00:49<00:19,  6.56s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.0439, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.836, 'compress@10': 0.9047, 'time@10': 8.3914}:  80%|████████  | 8/10 [00:49<00:13,  6.90s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0428, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8444, 'compress@10': 0.9045, 'time@10': 9.0359}:  80%|████████  | 8/10 [00:56<00:13,  6.90s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0428, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8444, 'compress@10': 0.9045, 'time@10': 9.0359}:  90%|█████████ | 9/10 [00:56<00:06,  6.97s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0423, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8466, 'compress@10': 0.9042, 'time@10': 9.1008}:  90%|█████████ | 9/10 [01:06<00:06,  6.97s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0423, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8466, 'compress@10': 0.9042, 'time@10': 9.1008}: 100%|██████████| 10/10 [01:06<00:00,  7.82s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0423, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8466, 'compress@10': 0.9042, 'time@10': 9.1008}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04226184164878148
Avg hit ratio: 0.8484604718051237
Avg ndcg: 0.8465576183299193
Avg compression ratio: 0.9042398955496335
Avg train time: 9.100797200202942
Std train time: 2.9188030862346266
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.9052, 'time@10': 8.3377}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.9052, 'time@10': 8.3377}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0428, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8631, 'compress@10': 0.9042, 'time@10': 7.6078}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0428, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8631, 'compress@10': 0.9042, 'time@10': 7.6078}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8611, 'compress@10': 0.9076, 'time@10': 6.9194}:  20%|██        | 2/10 [00:13<00:46,  5.80s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8611, 'compress@10': 0.9076, 'time@10': 6.9194}:  30%|███       | 3/10 [00:13<00:31,  4.43s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8526, 'compress@10': 0.9066, 'time@10': 6.7461}:  30%|███       | 3/10 [00:20<00:31,  4.43s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8526, 'compress@10': 0.9066, 'time@10': 6.7461}:  40%|████      | 4/10 [00:20<00:30,  5.16s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0414, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8409, 'compress@10': 0.9057, 'time@10': 8.1136}:  40%|████      | 4/10 [00:27<00:30,  5.16s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0414, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8409, 'compress@10': 0.9057, 'time@10': 8.1136}:  50%|█████     | 5/10 [00:27<00:28,  5.76s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0427, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8416, 'compress@10': 0.9051, 'time@10': 8.3969}:  50%|█████     | 5/10 [00:36<00:28,  5.76s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0427, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8416, 'compress@10': 0.9051, 'time@10': 8.3969}:  60%|██████    | 6/10 [00:36<00:28,  7.15s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0426, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8483, 'compress@10': 0.9049, 'time@10': 8.7716}:  60%|██████    | 6/10 [00:42<00:28,  7.15s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0426, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.8483, 'compress@10': 0.9049, 'time@10': 8.7716}:  70%|███████   | 7/10 [00:42<00:19,  6.63s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0418, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8509, 'compress@10': 0.9047, 'time@10': 8.6397}:  70%|███████   | 7/10 [00:50<00:19,  6.63s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0418, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8509, 'compress@10': 0.9047, 'time@10': 8.6397}:  80%|████████  | 8/10 [00:50<00:13,  6.98s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0405, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.859, 'compress@10': 0.9045, 'time@10': 9.2591}:  80%|████████  | 8/10 [00:57<00:13,  6.98s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0405, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.859, 'compress@10': 0.9045, 'time@10': 9.2591}:  90%|█████████ | 9/10 [00:57<00:07,  7.05s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0395, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8625, 'compress@10': 0.9042, 'time@10': 9.3279}:  90%|█████████ | 9/10 [01:07<00:07,  7.05s/it]  {'epoch': 8, 'num_users': 6.3, 'loss': 0.0395, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8625, 'compress@10': 0.9042, 'time@10': 9.3279}: 100%|██████████| 10/10 [01:07<00:00,  7.96s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0395, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8625, 'compress@10': 0.9042, 'time@10': 9.3279}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.039494484098941206
Avg hit ratio: 0.8595773549220068
Avg ndcg: 0.8625127181178651
Avg compression ratio: 0.9042398794308346
Avg train time: 9.327910256385803
Std train time: 2.8107412209475098
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8403, 'compress@10': 0.9052, 'time@10': 8.4941}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8403, 'compress@10': 0.9052, 'time@10': 8.4941}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8579, 'compress@10': 0.9042, 'time@10': 7.7773}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8579, 'compress@10': 0.9042, 'time@10': 7.7773}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8576, 'compress@10': 0.9076, 'time@10': 6.8291}:  20%|██        | 2/10 [00:13<00:47,  5.94s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8576, 'compress@10': 0.9076, 'time@10': 6.8291}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8517, 'compress@10': 0.9066, 'time@10': 6.7006}:  30%|███       | 3/10 [00:20<00:30,  4.37s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8517, 'compress@10': 0.9066, 'time@10': 6.7006}:  40%|████      | 4/10 [00:20<00:30,  5.16s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0405, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8406, 'compress@10': 0.9057, 'time@10': 8.056}:  40%|████      | 4/10 [00:27<00:30,  5.16s/it] {'epoch': 9, 'num_users': 5.8, 'loss': 0.0405, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8406, 'compress@10': 0.9057, 'time@10': 8.056}:  50%|█████     | 5/10 [00:27<00:28,  5.74s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0412, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8421, 'compress@10': 0.9051, 'time@10': 8.3794}:  50%|█████     | 5/10 [00:37<00:28,  5.74s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0412, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8421, 'compress@10': 0.9051, 'time@10': 8.3794}:  60%|██████    | 6/10 [00:37<00:28,  7.20s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0405, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8438, 'compress@10': 0.9049, 'time@10': 8.7678}:  60%|██████    | 6/10 [00:42<00:28,  7.20s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0405, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8438, 'compress@10': 0.9049, 'time@10': 8.7678}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.039, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8497, 'compress@10': 0.9047, 'time@10': 8.6353}:  70%|███████   | 7/10 [00:50<00:20,  6.67s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.039, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8497, 'compress@10': 0.9047, 'time@10': 8.6353}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0391, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8669, 'compress@10': 0.9045, 'time@10': 9.2556}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0391, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8669, 'compress@10': 0.9045, 'time@10': 9.2556}:  90%|█████████ | 9/10 [00:57<00:07,  7.05s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0388, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.867, 'compress@10': 0.9042, 'time@10': 9.3249}:  90%|█████████ | 9/10 [01:07<00:07,  7.05s/it]    {'epoch': 9, 'num_users': 6.3, 'loss': 0.0388, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.867, 'compress@10': 0.9042, 'time@10': 9.3249}: 100%|██████████| 10/10 [01:07<00:00,  7.96s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0388, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.867, 'compress@10': 0.9042, 'time@10': 9.3249}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.038806643092607604
Avg hit ratio: 0.8619263946768191
Avg ndcg: 0.8669845160083034
Avg compression ratio: 0.9042398920858418
Avg train time: 9.324922132492066
Std train time: 2.862706310495044
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0436, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.85, 'compress@10': 0.9052, 'time@10': 8.6241}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0436, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.85, 'compress@10': 0.9052, 'time@10': 8.6241}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.863, 'compress@10': 0.9042, 'time@10': 7.8327}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.863, 'compress@10': 0.9042, 'time@10': 7.8327}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8611, 'compress@10': 0.9076, 'time@10': 6.8639}:  20%|██        | 2/10 [00:13<00:47,  5.95s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8611, 'compress@10': 0.9076, 'time@10': 6.8639}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8507, 'compress@10': 0.9066, 'time@10': 6.7036}:  30%|███       | 3/10 [00:20<00:30,  4.38s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8507, 'compress@10': 0.9066, 'time@10': 6.7036}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0391, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8401, 'compress@10': 0.9057, 'time@10': 8.0637}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0391, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8401, 'compress@10': 0.9057, 'time@10': 8.0637}:  50%|█████     | 5/10 [00:26<00:28,  5.72s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0395, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8432, 'compress@10': 0.9051, 'time@10': 8.3722}:  50%|█████     | 5/10 [00:36<00:28,  5.72s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0395, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8432, 'compress@10': 0.9051, 'time@10': 8.3722}:  60%|██████    | 6/10 [00:36<00:28,  7.16s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0388, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8515, 'compress@10': 0.9049, 'time@10': 8.7687}:  60%|██████    | 6/10 [00:42<00:28,  7.16s/it] {'epoch': 10, 'num_users': 6.2857, 'loss': 0.0388, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8515, 'compress@10': 0.9049, 'time@10': 8.7687}:  70%|███████   | 7/10 [00:42<00:19,  6.65s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.038, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8572, 'compress@10': 0.9047, 'time@10': 8.6369}:  70%|███████   | 7/10 [00:50<00:19,  6.65s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.038, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8572, 'compress@10': 0.9047, 'time@10': 8.6369}:  80%|████████  | 8/10 [00:50<00:14,  7.00s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0393, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8844, 'compress@10': 0.9045, 'time@10': 9.2256}:  80%|████████  | 8/10 [00:57<00:14,  7.00s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0393, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8844, 'compress@10': 0.9045, 'time@10': 9.2256}:  90%|█████████ | 9/10 [00:57<00:07,  7.00s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0377, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8875, 'compress@10': 0.9042, 'time@10': 9.283}:  90%|█████████ | 9/10 [01:07<00:07,  7.00s/it]    {'epoch': 10, 'num_users': 6.3, 'loss': 0.0377, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8875, 'compress@10': 0.9042, 'time@10': 9.283}: 100%|██████████| 10/10 [01:07<00:00,  7.88s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0377, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8875, 'compress@10': 0.9042, 'time@10': 9.283}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.037723020213908456
Avg hit ratio: 0.8662055921818231
Avg ndcg: 0.8874832647071254
Avg compression ratio: 0.904239884147262
Avg train time: 9.283024096488953
Std train time: 2.826156150646885
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8479, 'compress@10': 0.9052, 'time@10': 8.543}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8479, 'compress@10': 0.9052, 'time@10': 8.543}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.865, 'compress@10': 0.9042, 'time@10': 7.8078}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.865, 'compress@10': 0.9042, 'time@10': 7.8078}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8624, 'compress@10': 0.9076, 'time@10': 6.9175}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8624, 'compress@10': 0.9076, 'time@10': 6.9175}:  30%|███       | 3/10 [00:14<00:30,  4.43s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8539, 'compress@10': 0.9066, 'time@10': 6.8205}:  30%|███       | 3/10 [00:20<00:30,  4.43s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8539, 'compress@10': 0.9066, 'time@10': 6.8205}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0381, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8437, 'compress@10': 0.9057, 'time@10': 8.1824}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0381, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8437, 'compress@10': 0.9057, 'time@10': 8.1824}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0399, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8462, 'compress@10': 0.9051, 'time@10': 8.473}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0399, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8462, 'compress@10': 0.9051, 'time@10': 8.473}:  60%|██████    | 6/10 [00:37<00:28,  7.24s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0393, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8518, 'compress@10': 0.9049, 'time@10': 8.8635}:  60%|██████    | 6/10 [00:43<00:28,  7.24s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0393, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8518, 'compress@10': 0.9049, 'time@10': 8.8635}:  70%|███████   | 7/10 [00:43<00:20,  6.72s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0382, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8577, 'compress@10': 0.9047, 'time@10': 8.7163}:  70%|███████   | 7/10 [00:50<00:20,  6.72s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0382, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8577, 'compress@10': 0.9047, 'time@10': 8.7163}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0401, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8838, 'compress@10': 0.9045, 'time@10': 9.3181}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0401, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8838, 'compress@10': 0.9045, 'time@10': 9.3181}:  90%|█████████ | 9/10 [00:57<00:07,  7.06s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0396, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8813, 'compress@10': 0.9042, 'time@10': 9.3937}:  90%|█████████ | 9/10 [01:07<00:07,  7.06s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0396, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8813, 'compress@10': 0.9042, 'time@10': 9.3937}: 100%|██████████| 10/10 [01:07<00:00,  8.00s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0396, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8813, 'compress@10': 0.9042, 'time@10': 9.3937}: 100%|██████████| 10/10 [01:07<00:00,  6.80s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03956925160551798
Avg hit ratio: 0.8692027061789369
Avg ndcg: 0.8812617340518406
Avg compression ratio: 0.9042398599164632
Avg train time: 9.393717980384826
Std train time: 2.8246580133884915
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0437, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8502, 'compress@10': 0.9052, 'time@10': 8.3719}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0437, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8502, 'compress@10': 0.9052, 'time@10': 8.3719}:  10%|█         | 1/10 [00:04<00:38,  4.22s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8679, 'compress@10': 0.9042, 'time@10': 7.6688}:  10%|█         | 1/10 [00:11<00:38,  4.22s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8679, 'compress@10': 0.9042, 'time@10': 7.6688}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8643, 'compress@10': 0.9076, 'time@10': 6.7569}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8643, 'compress@10': 0.9076, 'time@10': 6.7569}:  30%|███       | 3/10 [00:13<00:30,  4.33s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0289, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8576, 'compress@10': 0.9066, 'time@10': 6.6281}:  30%|███       | 3/10 [00:20<00:30,  4.33s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0289, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8576, 'compress@10': 0.9066, 'time@10': 6.6281}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0354, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.8482, 'compress@10': 0.9057, 'time@10': 8.1335}:  40%|████      | 4/10 [00:27<00:30,  5.10s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0354, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.8482, 'compress@10': 0.9057, 'time@10': 8.1335}:  50%|█████     | 5/10 [00:27<00:29,  5.83s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0357, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8529, 'compress@10': 0.9051, 'time@10': 8.4657}:  50%|█████     | 5/10 [00:37<00:29,  5.83s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0357, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8529, 'compress@10': 0.9051, 'time@10': 8.4657}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0347, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.8593, 'compress@10': 0.9049, 'time@10': 8.8385}:  60%|██████    | 6/10 [00:42<00:29,  7.30s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0347, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.8593, 'compress@10': 0.9049, 'time@10': 8.8385}:  70%|███████   | 7/10 [00:42<00:20,  6.74s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0336, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8655, 'compress@10': 0.9047, 'time@10': 8.6906}:  70%|███████   | 7/10 [00:50<00:20,  6.74s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0336, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8655, 'compress@10': 0.9047, 'time@10': 8.6906}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.034, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8703, 'compress@10': 0.9045, 'time@10': 9.2997}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.034, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8703, 'compress@10': 0.9045, 'time@10': 9.2997}:  90%|█████████ | 9/10 [00:57<00:07,  7.07s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0321, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.8764, 'compress@10': 0.9042, 'time@10': 9.3698}:  90%|█████████ | 9/10 [01:07<00:07,  7.07s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.0321, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.8764, 'compress@10': 0.9042, 'time@10': 9.3698}: 100%|██████████| 10/10 [01:07<00:00,  7.99s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0321, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.8764, 'compress@10': 0.9042, 'time@10': 9.3698}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03210655294740918
Avg hit ratio: 0.8748789422235941
Avg ndcg: 0.8764054070788825
Avg compression ratio: 0.9042398820023493
Avg train time: 9.369805169105529
Std train time: 2.983774857241134
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0514, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8407, 'compress@10': 0.9052, 'time@10': 8.5509}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0514, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8407, 'compress@10': 0.9052, 'time@10': 8.5509}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8623, 'compress@10': 0.9042, 'time@10': 7.801}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it] {'epoch': 13, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8623, 'compress@10': 0.9042, 'time@10': 7.801}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8606, 'compress@10': 0.9076, 'time@10': 6.8726}:  20%|██        | 2/10 [00:13<00:47,  5.95s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8606, 'compress@10': 0.9076, 'time@10': 6.8726}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8482, 'compress@10': 0.9066, 'time@10': 6.7077}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8482, 'compress@10': 0.9066, 'time@10': 6.7077}:  40%|████      | 4/10 [00:20<00:30,  5.13s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8425, 'compress@10': 0.9057, 'time@10': 8.0938}:  40%|████      | 4/10 [00:27<00:30,  5.13s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8425, 'compress@10': 0.9057, 'time@10': 8.0938}:  50%|█████     | 5/10 [00:27<00:28,  5.75s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.036, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8482, 'compress@10': 0.9051, 'time@10': 8.4572}:  50%|█████     | 5/10 [00:37<00:28,  5.75s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.036, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8482, 'compress@10': 0.9051, 'time@10': 8.4572}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0354, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.8547, 'compress@10': 0.9049, 'time@10': 8.8163}:  60%|██████    | 6/10 [00:42<00:29,  7.30s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0354, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.8547, 'compress@10': 0.9049, 'time@10': 8.8163}:  70%|███████   | 7/10 [00:42<00:20,  6.72s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0345, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.8592, 'compress@10': 0.9047, 'time@10': 8.6782}:  70%|███████   | 7/10 [00:50<00:20,  6.72s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0345, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.8592, 'compress@10': 0.9047, 'time@10': 8.6782}:  80%|████████  | 8/10 [00:50<00:14,  7.05s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0328, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8672, 'compress@10': 0.9045, 'time@10': 9.2648}:  80%|████████  | 8/10 [00:57<00:14,  7.05s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0328, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8672, 'compress@10': 0.9045, 'time@10': 9.2648}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0319, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.8733, 'compress@10': 0.9042, 'time@10': 9.3324}:  90%|█████████ | 9/10 [01:07<00:07,  7.04s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0319, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.8733, 'compress@10': 0.9042, 'time@10': 9.3324}: 100%|██████████| 10/10 [01:07<00:00,  7.96s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0319, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.8733, 'compress@10': 0.9042, 'time@10': 9.3324}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03193925384512659
Avg hit ratio: 0.8936500366262676
Avg ndcg: 0.8733326642629494
Avg compression ratio: 0.9042398660368194
Avg train time: 9.33240897655487
Std train time: 2.8404566191844816
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8424, 'compress@10': 0.9052, 'time@10': 8.3437}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8424, 'compress@10': 0.9052, 'time@10': 8.3437}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8688, 'compress@10': 0.9042, 'time@10': 7.6676}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8688, 'compress@10': 0.9042, 'time@10': 7.6676}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8649, 'compress@10': 0.9076, 'time@10': 6.7475}:  20%|██        | 2/10 [00:13<00:46,  5.87s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8649, 'compress@10': 0.9076, 'time@10': 6.7475}:  30%|███       | 3/10 [00:13<00:30,  4.33s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8568, 'compress@10': 0.9066, 'time@10': 6.6735}:  30%|███       | 3/10 [00:20<00:30,  4.33s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8568, 'compress@10': 0.9066, 'time@10': 6.6735}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0327, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8494, 'compress@10': 0.9057, 'time@10': 8.0425}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0327, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8494, 'compress@10': 0.9057, 'time@10': 8.0425}:  50%|█████     | 5/10 [00:27<00:28,  5.76s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0335, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8558, 'compress@10': 0.9051, 'time@10': 8.3991}:  50%|█████     | 5/10 [00:37<00:28,  5.76s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0335, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8558, 'compress@10': 0.9051, 'time@10': 8.3991}:  60%|██████    | 6/10 [00:37<00:29,  7.28s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8593, 'compress@10': 0.9049, 'time@10': 8.7656}:  60%|██████    | 6/10 [00:42<00:29,  7.28s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8593, 'compress@10': 0.9049, 'time@10': 8.7656}:  70%|███████   | 7/10 [00:42<00:20,  6.70s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0333, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8659, 'compress@10': 0.9047, 'time@10': 8.6139}:  70%|███████   | 7/10 [00:50<00:20,  6.70s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0333, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8659, 'compress@10': 0.9047, 'time@10': 8.6139}:  80%|████████  | 8/10 [00:50<00:13,  6.99s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8737, 'compress@10': 0.9045, 'time@10': 9.2333}:  80%|████████  | 8/10 [00:57<00:13,  6.99s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8737, 'compress@10': 0.9045, 'time@10': 9.2333}:  90%|█████████ | 9/10 [00:57<00:07,  7.03s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.8755, 'compress@10': 0.9042, 'time@10': 9.3074}:  90%|█████████ | 9/10 [01:07<00:07,  7.03s/it]  {'epoch': 14, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.8755, 'compress@10': 0.9042, 'time@10': 9.3074}: 100%|██████████| 10/10 [01:07<00:00,  7.95s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.8755, 'compress@10': 0.9042, 'time@10': 9.3074}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.031712705138892246
Avg hit ratio: 0.8803174015194388
Avg ndcg: 0.8754862661963481
Avg compression ratio: 0.9042399039538884
Avg train time: 9.307402896881104
Std train time: 2.870568416381396
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8592, 'compress@10': 0.9052, 'time@10': 8.2878}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8592, 'compress@10': 0.9052, 'time@10': 8.2878}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8819, 'compress@10': 0.9042, 'time@10': 7.5903}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8819, 'compress@10': 0.9042, 'time@10': 7.5903}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8737, 'compress@10': 0.9076, 'time@10': 6.7152}:  20%|██        | 2/10 [00:13<00:46,  5.80s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8737, 'compress@10': 0.9076, 'time@10': 6.7152}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.873, 'compress@10': 0.9066, 'time@10': 6.5674}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.873, 'compress@10': 0.9066, 'time@10': 6.5674}:  40%|████      | 4/10 [00:19<00:30,  5.04s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0296, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8635, 'compress@10': 0.9057, 'time@10': 7.9615}:  40%|████      | 4/10 [00:26<00:30,  5.04s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0296, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8635, 'compress@10': 0.9057, 'time@10': 7.9615}:  50%|█████     | 5/10 [00:26<00:28,  5.67s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0303, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8698, 'compress@10': 0.9051, 'time@10': 8.3441}:  50%|█████     | 5/10 [00:36<00:28,  5.67s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0303, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8698, 'compress@10': 0.9051, 'time@10': 8.3441}:  60%|██████    | 6/10 [00:36<00:28,  7.25s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0302, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.8714, 'compress@10': 0.9049, 'time@10': 8.7251}:  60%|██████    | 6/10 [00:42<00:28,  7.25s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0302, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.8714, 'compress@10': 0.9049, 'time@10': 8.7251}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0292, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.8767, 'compress@10': 0.9047, 'time@10': 8.5846}:  70%|███████   | 7/10 [00:50<00:20,  6.69s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0292, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.8767, 'compress@10': 0.9047, 'time@10': 8.5846}:  80%|████████  | 8/10 [00:50<00:13,  6.99s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0294, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.8917, 'compress@10': 0.9045, 'time@10': 9.2139}:  80%|████████  | 8/10 [00:57<00:13,  6.99s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0294, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.8917, 'compress@10': 0.9045, 'time@10': 9.2139}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.8975, 'compress@10': 0.9042, 'time@10': 9.2857}:  90%|█████████ | 9/10 [01:07<00:07,  7.04s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.8975, 'compress@10': 0.9042, 'time@10': 9.2857}: 100%|██████████| 10/10 [01:07<00:00,  7.95s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.8975, 'compress@10': 0.9042, 'time@10': 9.2857}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.027554727914536253
Avg hit ratio: 0.9057928937691246
Avg ndcg: 0.8975485249779881
Avg compression ratio: 0.904239895626268
Avg train time: 9.285694813728332
Std train time: 2.9199860044857053
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8639, 'compress@10': 0.9052, 'time@10': 8.3462}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8639, 'compress@10': 0.9052, 'time@10': 8.3462}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0327, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8874, 'compress@10': 0.9042, 'time@10': 7.7327}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0327, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8874, 'compress@10': 0.9042, 'time@10': 7.7327}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8773, 'compress@10': 0.9076, 'time@10': 6.829}:  20%|██        | 2/10 [00:13<00:47,  5.95s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8773, 'compress@10': 0.9076, 'time@10': 6.829}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8711, 'compress@10': 0.9066, 'time@10': 6.6229}:  30%|███       | 3/10 [00:19<00:30,  4.39s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8711, 'compress@10': 0.9066, 'time@10': 6.6229}:  40%|████      | 4/10 [00:19<00:30,  5.05s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.862, 'compress@10': 0.9057, 'time@10': 8.0412}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.862, 'compress@10': 0.9057, 'time@10': 8.0412}:  50%|█████     | 5/10 [00:26<00:28,  5.71s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0289, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8701, 'compress@10': 0.9051, 'time@10': 8.3982}:  50%|█████     | 5/10 [00:37<00:28,  5.71s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0289, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8701, 'compress@10': 0.9051, 'time@10': 8.3982}:  60%|██████    | 6/10 [00:37<00:28,  7.25s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.029, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.8765, 'compress@10': 0.9049, 'time@10': 8.7826}:  60%|██████    | 6/10 [00:42<00:28,  7.25s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.029, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.8765, 'compress@10': 0.9049, 'time@10': 8.7826}:  70%|███████   | 7/10 [00:42<00:20,  6.70s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.028, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.8817, 'compress@10': 0.9047, 'time@10': 8.6491}:  70%|███████   | 7/10 [00:50<00:20,  6.70s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.028, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.8817, 'compress@10': 0.9047, 'time@10': 8.6491}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0296, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9081, 'compress@10': 0.9045, 'time@10': 9.2759}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0296, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9081, 'compress@10': 0.9045, 'time@10': 9.2759}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9139, 'compress@10': 0.9042, 'time@10': 9.3458}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9139, 'compress@10': 0.9042, 'time@10': 9.3458}: 100%|██████████| 10/10 [01:07<00:00,  7.99s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9139, 'compress@10': 0.9042, 'time@10': 9.3458}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.02919099998143696
Avg hit ratio: 0.8961354167432265
Avg ndcg: 0.9139214991604897
Avg compression ratio: 0.9042398682327303
Avg train time: 9.345777106285095
Std train time: 2.9350655806353885
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0368, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8762, 'compress@10': 0.9052, 'time@10': 8.3099}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0368, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8762, 'compress@10': 0.9052, 'time@10': 8.3099}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8967, 'compress@10': 0.9042, 'time@10': 7.7571}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it] {'epoch': 17, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8967, 'compress@10': 0.9042, 'time@10': 7.7571}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8835, 'compress@10': 0.9076, 'time@10': 6.818}:  20%|██        | 2/10 [00:13<00:47,  5.99s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8835, 'compress@10': 0.9076, 'time@10': 6.818}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8765, 'compress@10': 0.9066, 'time@10': 6.6609}:  30%|███       | 3/10 [00:20<00:30,  4.40s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8765, 'compress@10': 0.9066, 'time@10': 6.6609}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0278, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8686, 'compress@10': 0.9057, 'time@10': 8.1531}:  40%|████      | 4/10 [00:27<00:30,  5.12s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0278, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8686, 'compress@10': 0.9057, 'time@10': 8.1531}:  50%|█████     | 5/10 [00:27<00:29,  5.83s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0283, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8761, 'compress@10': 0.9051, 'time@10': 8.4568}:  50%|█████     | 5/10 [00:37<00:29,  5.83s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0283, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8761, 'compress@10': 0.9051, 'time@10': 8.4568}:  60%|██████    | 6/10 [00:37<00:29,  7.26s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0291, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.8726, 'compress@10': 0.9049, 'time@10': 8.8226}:  60%|██████    | 6/10 [00:42<00:29,  7.26s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0291, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.8726, 'compress@10': 0.9049, 'time@10': 8.8226}:  70%|███████   | 7/10 [00:42<00:20,  6.70s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.8793, 'compress@10': 0.9047, 'time@10': 8.6508}:  70%|███████   | 7/10 [00:50<00:20,  6.70s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.8793, 'compress@10': 0.9047, 'time@10': 8.6508}:  80%|████████  | 8/10 [00:50<00:13,  6.95s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0323, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9008, 'compress@10': 0.9045, 'time@10': 9.2684}:  80%|████████  | 8/10 [00:57<00:13,  6.95s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0323, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9008, 'compress@10': 0.9045, 'time@10': 9.2684}:  90%|█████████ | 9/10 [00:57<00:07,  7.01s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9033, 'compress@10': 0.9042, 'time@10': 9.3507}:  90%|█████████ | 9/10 [01:07<00:07,  7.01s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9033, 'compress@10': 0.9042, 'time@10': 9.3507}: 100%|██████████| 10/10 [01:07<00:00,  7.97s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9033, 'compress@10': 0.9042, 'time@10': 9.3507}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.031590905328695164
Avg hit ratio: 0.8932782738860837
Avg ndcg: 0.9032545339355178
Avg compression ratio: 0.9042398571234601
Avg train time: 9.350691747665405
Std train time: 2.980781361721608
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8743, 'compress@10': 0.9052, 'time@10': 8.4323}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8743, 'compress@10': 0.9052, 'time@10': 8.4323}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.897, 'compress@10': 0.9042, 'time@10': 7.651}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]  {'epoch': 18, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.897, 'compress@10': 0.9042, 'time@10': 7.651}:  20%|██        | 2/10 [00:11<00:46,  5.82s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8837, 'compress@10': 0.9076, 'time@10': 6.7367}:  20%|██        | 2/10 [00:13<00:46,  5.82s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8837, 'compress@10': 0.9076, 'time@10': 6.7367}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8785, 'compress@10': 0.9066, 'time@10': 6.5901}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8785, 'compress@10': 0.9066, 'time@10': 6.5901}:  40%|████      | 4/10 [00:19<00:30,  5.05s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0271, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8723, 'compress@10': 0.9057, 'time@10': 8.024}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0271, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8723, 'compress@10': 0.9057, 'time@10': 8.024}:  50%|█████     | 5/10 [00:26<00:28,  5.72s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0286, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8828, 'compress@10': 0.9051, 'time@10': 8.3796}:  50%|█████     | 5/10 [00:36<00:28,  5.72s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0286, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8828, 'compress@10': 0.9051, 'time@10': 8.3796}:  60%|██████    | 6/10 [00:36<00:28,  7.24s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0276, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.8876, 'compress@10': 0.9049, 'time@10': 8.7559}:  60%|██████    | 6/10 [00:42<00:28,  7.24s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0276, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.8876, 'compress@10': 0.9049, 'time@10': 8.7559}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0268, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.8916, 'compress@10': 0.9047, 'time@10': 8.5921}:  70%|███████   | 7/10 [00:49<00:20,  6.69s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0268, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.8916, 'compress@10': 0.9047, 'time@10': 8.5921}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0291, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8953, 'compress@10': 0.9045, 'time@10': 9.2014}:  80%|████████  | 8/10 [00:57<00:13,  6.94s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0291, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8953, 'compress@10': 0.9045, 'time@10': 9.2014}:  90%|█████████ | 9/10 [00:57<00:06,  6.99s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.903, 'compress@10': 0.9042, 'time@10': 9.2756}:  90%|█████████ | 9/10 [01:07<00:06,  6.99s/it]     {'epoch': 18, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.903, 'compress@10': 0.9042, 'time@10': 9.2756}: 100%|██████████| 10/10 [01:07<00:00,  7.91s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.903, 'compress@10': 0.9042, 'time@10': 9.2756}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.02699700708044677
Avg hit ratio: 0.887563988171798
Avg ndcg: 0.9030111200448434
Avg compression ratio: 0.9042398918546644
Avg train time: 9.27557406425476
Std train time: 2.93397906008354
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8876, 'compress@10': 0.9052, 'time@10': 8.2479}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8876, 'compress@10': 0.9052, 'time@10': 8.2479}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.903, 'compress@10': 0.9042, 'time@10': 7.6092}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]  {'epoch': 19, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.903, 'compress@10': 0.9042, 'time@10': 7.6092}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8877, 'compress@10': 0.9076, 'time@10': 6.8217}:  20%|██        | 2/10 [00:13<00:46,  5.85s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8877, 'compress@10': 0.9076, 'time@10': 6.8217}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8654, 'compress@10': 0.9066, 'time@10': 6.652}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it]  {'epoch': 19, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8654, 'compress@10': 0.9066, 'time@10': 6.652}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0264, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.863, 'compress@10': 0.9057, 'time@10': 8.0216}:  40%|████      | 4/10 [00:26<00:30,  5.10s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0264, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.863, 'compress@10': 0.9057, 'time@10': 8.0216}:  50%|█████     | 5/10 [00:26<00:28,  5.71s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0256, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8739, 'compress@10': 0.9051, 'time@10': 8.3822}:  50%|█████     | 5/10 [00:37<00:28,  5.71s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0256, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8739, 'compress@10': 0.9051, 'time@10': 8.3822}:  60%|██████    | 6/10 [00:37<00:28,  7.24s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0265, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.8753, 'compress@10': 0.9049, 'time@10': 8.761}:  60%|██████    | 6/10 [00:42<00:28,  7.24s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0265, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.8753, 'compress@10': 0.9049, 'time@10': 8.761}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0254, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.8822, 'compress@10': 0.9047, 'time@10': 8.6055}:  70%|███████   | 7/10 [00:50<00:20,  6.69s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0254, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.8822, 'compress@10': 0.9047, 'time@10': 8.6055}:  80%|████████  | 8/10 [00:50<00:13,  6.97s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9045, 'compress@10': 0.9045, 'time@10': 9.2479}:  80%|████████  | 8/10 [00:57<00:13,  6.97s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9045, 'compress@10': 0.9045, 'time@10': 9.2479}:  90%|█████████ | 9/10 [00:57<00:07,  7.05s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9116, 'compress@10': 0.9042, 'time@10': 9.313}:  90%|█████████ | 9/10 [01:07<00:07,  7.05s/it]    {'epoch': 19, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9116, 'compress@10': 0.9042, 'time@10': 9.313}: 100%|██████████| 10/10 [01:07<00:00,  7.94s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9116, 'compress@10': 0.9042, 'time@10': 9.313}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.027531582405702464
Avg hit ratio: 0.8932782738860837
Avg ndcg: 0.9116421555186622
Avg compression ratio: 0.9042398949403416
Avg train time: 9.313027405738831
Std train time: 2.8944762807867233
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8875, 'compress@10': 0.9052, 'time@10': 8.2988}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8875, 'compress@10': 0.9052, 'time@10': 8.2988}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9135, 'compress@10': 0.9042, 'time@10': 7.6916}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9135, 'compress@10': 0.9042, 'time@10': 7.6916}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8947, 'compress@10': 0.9076, 'time@10': 6.8289}:  20%|██        | 2/10 [00:13<00:47,  5.91s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8947, 'compress@10': 0.9076, 'time@10': 6.8289}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8829, 'compress@10': 0.9066, 'time@10': 6.6297}:  30%|███       | 3/10 [00:19<00:30,  4.40s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8829, 'compress@10': 0.9066, 'time@10': 6.6297}:  40%|████      | 4/10 [00:19<00:30,  5.06s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8774, 'compress@10': 0.9057, 'time@10': 8.0341}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8774, 'compress@10': 0.9057, 'time@10': 8.0341}:  50%|█████     | 5/10 [00:26<00:28,  5.74s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0227, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8883, 'compress@10': 0.9051, 'time@10': 8.4094}:  50%|█████     | 5/10 [00:37<00:28,  5.74s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0227, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8883, 'compress@10': 0.9051, 'time@10': 8.4094}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.023, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.8905, 'compress@10': 0.9049, 'time@10': 8.7726}:  60%|██████    | 6/10 [00:42<00:29,  7.30s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 0.023, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.8905, 'compress@10': 0.9049, 'time@10': 8.7726}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0223, 'hit_ratio@10': 0.9, 'ndcg@10': 0.8958, 'compress@10': 0.9047, 'time@10': 8.5832}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it]   {'epoch': 20, 'num_users': 6.125, 'loss': 0.0223, 'hit_ratio@10': 0.9, 'ndcg@10': 0.8958, 'compress@10': 0.9047, 'time@10': 8.5832}:  80%|████████  | 8/10 [00:50<00:13,  6.90s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0228, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8998, 'compress@10': 0.9045, 'time@10': 9.2287}:  80%|████████  | 8/10 [00:57<00:13,  6.90s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0228, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8998, 'compress@10': 0.9045, 'time@10': 9.2287}:  90%|█████████ | 9/10 [00:57<00:07,  7.01s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0229, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9051, 'compress@10': 0.9042, 'time@10': 9.2932}:  90%|█████████ | 9/10 [01:07<00:07,  7.01s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0229, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9051, 'compress@10': 0.9042, 'time@10': 9.2932}: 100%|██████████| 10/10 [01:07<00:00,  7.90s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0229, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9051, 'compress@10': 0.9042, 'time@10': 9.2932}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.022901956294434412
Avg hit ratio: 0.8863381817201852
Avg ndcg: 0.9050984737865949
Avg compression ratio: 0.9042398694693816
Avg train time: 9.293184161186218
Std train time: 2.9542632957090396
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.9052, 'time@10': 8.3765}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.9052, 'time@10': 8.3765}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9191, 'compress@10': 0.9042, 'time@10': 7.611}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it] {'epoch': 21, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9191, 'compress@10': 0.9042, 'time@10': 7.611}:  20%|██        | 2/10 [00:11<00:46,  5.79s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8985, 'compress@10': 0.9076, 'time@10': 6.73}:  20%|██        | 2/10 [00:13<00:46,  5.79s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8985, 'compress@10': 0.9076, 'time@10': 6.73}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.853, 'ndcg@10': 0.896, 'compress@10': 0.9066, 'time@10': 6.5803}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.853, 'ndcg@10': 0.896, 'compress@10': 0.9066, 'time@10': 6.5803}:  40%|████      | 4/10 [00:19<00:30,  5.04s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0209, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.8891, 'compress@10': 0.9057, 'time@10': 7.9865}:  40%|████      | 4/10 [00:26<00:30,  5.04s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0209, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.8891, 'compress@10': 0.9057, 'time@10': 7.9865}:  50%|█████     | 5/10 [00:26<00:28,  5.69s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0233, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9034, 'compress@10': 0.9051, 'time@10': 8.3326}:  50%|█████     | 5/10 [00:36<00:28,  5.69s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0233, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9034, 'compress@10': 0.9051, 'time@10': 8.3326}:  60%|██████    | 6/10 [00:36<00:28,  7.19s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.906, 'compress@10': 0.9049, 'time@10': 8.751}:  60%|██████    | 6/10 [00:42<00:28,  7.19s/it]  {'epoch': 21, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.906, 'compress@10': 0.9049, 'time@10': 8.751}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0224, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9095, 'compress@10': 0.9047, 'time@10': 8.593}:  70%|███████   | 7/10 [00:49<00:20,  6.69s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0224, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9095, 'compress@10': 0.9047, 'time@10': 8.593}:  80%|████████  | 8/10 [00:49<00:13,  6.96s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9248, 'compress@10': 0.9045, 'time@10': 9.2014}:  80%|████████  | 8/10 [00:57<00:13,  6.96s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9248, 'compress@10': 0.9045, 'time@10': 9.2014}:  90%|█████████ | 9/10 [00:57<00:06,  6.99s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9292, 'compress@10': 0.9042, 'time@10': 9.2642}:  90%|█████████ | 9/10 [01:06<00:06,  6.99s/it]    {'epoch': 21, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9292, 'compress@10': 0.9042, 'time@10': 9.2642}: 100%|██████████| 10/10 [01:06<00:00,  7.88s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9292, 'compress@10': 0.9042, 'time@10': 9.2642}: 100%|██████████| 10/10 [01:06<00:00,  6.69s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.022364841665588713
Avg hit ratio: 0.9009925596003695
Avg ndcg: 0.9292067087797939
Avg compression ratio: 0.9042398809593137
Avg train time: 9.264213013648988
Std train time: 2.915295623781205
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8913, 'compress@10': 0.9052, 'time@10': 8.2844}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8913, 'compress@10': 0.9052, 'time@10': 8.2844}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.928, 'compress@10': 0.9042, 'time@10': 7.6863}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it] {'epoch': 22, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.928, 'compress@10': 0.9042, 'time@10': 7.6863}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9044, 'compress@10': 0.9076, 'time@10': 6.7277}:  20%|██        | 2/10 [00:13<00:47,  5.91s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9044, 'compress@10': 0.9076, 'time@10': 6.7277}:  30%|███       | 3/10 [00:13<00:30,  4.33s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9062, 'compress@10': 0.9066, 'time@10': 6.631}:  30%|███       | 3/10 [00:20<00:30,  4.33s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9062, 'compress@10': 0.9066, 'time@10': 6.631}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8981, 'compress@10': 0.9057, 'time@10': 8.0088}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8981, 'compress@10': 0.9057, 'time@10': 8.0088}:  50%|█████     | 5/10 [00:26<00:28,  5.74s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9063, 'compress@10': 0.9051, 'time@10': 8.3478}:  50%|█████     | 5/10 [00:37<00:28,  5.74s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9063, 'compress@10': 0.9051, 'time@10': 8.3478}:  60%|██████    | 6/10 [00:37<00:28,  7.21s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0208, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.903, 'compress@10': 0.9049, 'time@10': 8.7141}:  60%|██████    | 6/10 [00:42<00:28,  7.21s/it] {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0208, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.903, 'compress@10': 0.9049, 'time@10': 8.7141}:  70%|███████   | 7/10 [00:42<00:19,  6.65s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0202, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9069, 'compress@10': 0.9047, 'time@10': 8.5477}:  70%|███████   | 7/10 [00:49<00:19,  6.65s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0202, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9069, 'compress@10': 0.9047, 'time@10': 8.5477}:  80%|████████  | 8/10 [00:49<00:13,  6.90s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9104, 'compress@10': 0.9045, 'time@10': 9.1744}:  80%|████████  | 8/10 [00:57<00:13,  6.90s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9104, 'compress@10': 0.9045, 'time@10': 9.1744}:  90%|█████████ | 9/10 [00:57<00:06,  6.97s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9139, 'compress@10': 0.9042, 'time@10': 9.2508}:  90%|█████████ | 9/10 [01:07<00:06,  6.97s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9139, 'compress@10': 0.9042, 'time@10': 9.2508}: 100%|██████████| 10/10 [01:07<00:00,  7.92s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9139, 'compress@10': 0.9042, 'time@10': 9.2508}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.021349130215423163
Avg hit ratio: 0.8866274802352901
Avg ndcg: 0.9138959355088918
Avg compression ratio: 0.9042398851940818
Avg train time: 9.250790429115295
Std train time: 2.893889774987916
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9027, 'compress@10': 0.9052, 'time@10': 8.2728}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9027, 'compress@10': 0.9052, 'time@10': 8.2728}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9214, 'compress@10': 0.9042, 'time@10': 7.6244}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9214, 'compress@10': 0.9042, 'time@10': 7.6244}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9, 'compress@10': 0.9076, 'time@10': 6.8098}:  20%|██        | 2/10 [00:13<00:46,  5.84s/it]   {'epoch': 23, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9, 'compress@10': 0.9076, 'time@10': 6.8098}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9064, 'compress@10': 0.9066, 'time@10': 6.6635}:  30%|███       | 3/10 [00:20<00:30,  4.38s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9064, 'compress@10': 0.9066, 'time@10': 6.6635}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8979, 'compress@10': 0.9057, 'time@10': 8.0138}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it]  {'epoch': 23, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8979, 'compress@10': 0.9057, 'time@10': 8.0138}:  50%|█████     | 5/10 [00:26<00:28,  5.71s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9066, 'compress@10': 0.9051, 'time@10': 8.3778}:  50%|█████     | 5/10 [00:37<00:28,  5.71s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9066, 'compress@10': 0.9051, 'time@10': 8.3778}:  60%|██████    | 6/10 [00:37<00:28,  7.25s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.91, 'compress@10': 0.9049, 'time@10': 8.7474}:  60%|██████    | 6/10 [00:42<00:28,  7.25s/it]  {'epoch': 23, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.91, 'compress@10': 0.9049, 'time@10': 8.7474}:  70%|███████   | 7/10 [00:42<00:20,  6.68s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9115, 'compress@10': 0.9047, 'time@10': 8.5715}:  70%|███████   | 7/10 [00:49<00:20,  6.68s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9115, 'compress@10': 0.9047, 'time@10': 8.5715}:  80%|████████  | 8/10 [00:49<00:13,  6.90s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9169, 'compress@10': 0.9045, 'time@10': 9.1875}:  80%|████████  | 8/10 [00:57<00:13,  6.90s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9169, 'compress@10': 0.9045, 'time@10': 9.1875}:  90%|█████████ | 9/10 [00:57<00:06,  6.96s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9215, 'compress@10': 0.9042, 'time@10': 9.2672}:  90%|█████████ | 9/10 [01:07<00:06,  6.96s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9215, 'compress@10': 0.9042, 'time@10': 9.2672}: 100%|██████████| 10/10 [01:07<00:00,  7.91s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9215, 'compress@10': 0.9042, 'time@10': 9.2672}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.018683293984575154
Avg hit ratio: 0.894563988171798
Avg ndcg: 0.9214818436200873
Avg compression ratio: 0.9042398616878922
Avg train time: 9.26720097064972
Std train time: 2.8439006462183243
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9112, 'compress@10': 0.9052, 'time@10': 8.2851}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9112, 'compress@10': 0.9052, 'time@10': 8.2851}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9264, 'compress@10': 0.9042, 'time@10': 7.6149}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it] {'epoch': 24, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9264, 'compress@10': 0.9042, 'time@10': 7.6149}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9033, 'compress@10': 0.9076, 'time@10': 6.741}:  20%|██        | 2/10 [00:13<00:46,  5.83s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9033, 'compress@10': 0.9076, 'time@10': 6.741}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9095, 'compress@10': 0.9066, 'time@10': 6.5522}:  30%|███       | 3/10 [00:19<00:30,  4.32s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9095, 'compress@10': 0.9066, 'time@10': 6.5522}:  40%|████      | 4/10 [00:19<00:29,  4.99s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0204, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.902, 'compress@10': 0.9057, 'time@10': 7.8992}:  40%|████      | 4/10 [00:26<00:29,  4.99s/it] {'epoch': 24, 'num_users': 5.8, 'loss': 0.0204, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.902, 'compress@10': 0.9057, 'time@10': 7.8992}:  50%|█████     | 5/10 [00:26<00:28,  5.60s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0222, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9134, 'compress@10': 0.9051, 'time@10': 8.2667}:  50%|█████     | 5/10 [00:36<00:28,  5.60s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0222, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9134, 'compress@10': 0.9051, 'time@10': 8.2667}:  60%|██████    | 6/10 [00:36<00:28,  7.15s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0225, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9153, 'compress@10': 0.9049, 'time@10': 8.6701}:  60%|██████    | 6/10 [00:42<00:28,  7.15s/it] {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0225, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9153, 'compress@10': 0.9049, 'time@10': 8.6701}:  70%|███████   | 7/10 [00:42<00:19,  6.63s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0213, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9208, 'compress@10': 0.9047, 'time@10': 8.5628}:  70%|███████   | 7/10 [00:49<00:19,  6.63s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0213, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9208, 'compress@10': 0.9047, 'time@10': 8.5628}:  80%|████████  | 8/10 [00:49<00:14,  7.02s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9288, 'compress@10': 0.9045, 'time@10': 9.1637}:  80%|████████  | 8/10 [00:56<00:14,  7.02s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9288, 'compress@10': 0.9045, 'time@10': 9.1637}:  90%|█████████ | 9/10 [00:56<00:07,  7.02s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9336, 'compress@10': 0.9042, 'time@10': 9.2308}:  90%|█████████ | 9/10 [01:06<00:07,  7.02s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9336, 'compress@10': 0.9042, 'time@10': 9.2308}: 100%|██████████| 10/10 [01:06<00:00,  7.90s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9336, 'compress@10': 0.9042, 'time@10': 9.2308}: 100%|██████████| 10/10 [01:06<00:00,  6.69s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.02165898847744322
Avg hit ratio: 0.8831354167432266
Avg ndcg: 0.9335585393159642
Avg compression ratio: 0.9042398779208503
Avg train time: 9.230841994285583
Std train time: 2.830692328881087
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9139, 'compress@10': 0.9052, 'time@10': 8.2988}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9139, 'compress@10': 0.9052, 'time@10': 8.2988}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9419, 'compress@10': 0.9042, 'time@10': 7.6282}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9419, 'compress@10': 0.9042, 'time@10': 7.6282}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9136, 'compress@10': 0.9076, 'time@10': 6.8117}:  20%|██        | 2/10 [00:13<00:46,  5.84s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9136, 'compress@10': 0.9076, 'time@10': 6.8117}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9145, 'compress@10': 0.9066, 'time@10': 6.6467}:  30%|███       | 3/10 [00:20<00:30,  4.37s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9145, 'compress@10': 0.9066, 'time@10': 6.6467}:  40%|████      | 4/10 [00:20<00:30,  5.09s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.9076, 'compress@10': 0.9057, 'time@10': 8.1304}:  40%|████      | 4/10 [00:27<00:30,  5.09s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.9076, 'compress@10': 0.9057, 'time@10': 8.1304}:  50%|█████     | 5/10 [00:27<00:29,  5.80s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0174, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9164, 'compress@10': 0.9051, 'time@10': 8.4579}:  50%|█████     | 5/10 [00:37<00:29,  5.80s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0174, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9164, 'compress@10': 0.9051, 'time@10': 8.4579}:  60%|██████    | 6/10 [00:37<00:29,  7.28s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9141, 'compress@10': 0.9049, 'time@10': 8.7955}:  60%|██████    | 6/10 [00:42<00:29,  7.28s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9141, 'compress@10': 0.9049, 'time@10': 8.7955}:  70%|███████   | 7/10 [00:42<00:20,  6.68s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.018, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9182, 'compress@10': 0.9047, 'time@10': 8.6356}:  70%|███████   | 7/10 [00:50<00:20,  6.68s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.018, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9182, 'compress@10': 0.9047, 'time@10': 8.6356}:  80%|████████  | 8/10 [00:50<00:13,  6.96s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9191, 'compress@10': 0.9045, 'time@10': 9.2414}:  80%|████████  | 8/10 [00:57<00:13,  6.96s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9191, 'compress@10': 0.9045, 'time@10': 9.2414}:  90%|█████████ | 9/10 [00:57<00:06,  7.00s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9243, 'compress@10': 0.9042, 'time@10': 9.3076}:  90%|█████████ | 9/10 [01:07<00:06,  7.00s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9243, 'compress@10': 0.9042, 'time@10': 9.3076}: 100%|██████████| 10/10 [01:07<00:00,  7.91s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9243, 'compress@10': 0.9042, 'time@10': 9.3076}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.0188866758910503
Avg hit ratio: 0.8805445309265343
Avg ndcg: 0.9243212819940178
Avg compression ratio: 0.9042399024382275
Avg train time: 9.307556915283204
Std train time: 2.9241254631770714
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9139, 'compress@10': 0.9052, 'time@10': 8.3331}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9139, 'compress@10': 0.9052, 'time@10': 8.3331}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.941, 'compress@10': 0.9042, 'time@10': 7.6583}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it] {'epoch': 26, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.941, 'compress@10': 0.9042, 'time@10': 7.6583}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.913, 'compress@10': 0.9076, 'time@10': 6.8091}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.913, 'compress@10': 0.9076, 'time@10': 6.8091}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9206, 'compress@10': 0.9066, 'time@10': 6.6246}:  30%|███       | 3/10 [00:19<00:30,  4.37s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9206, 'compress@10': 0.9066, 'time@10': 6.6246}:  40%|████      | 4/10 [00:19<00:30,  5.06s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.9125, 'compress@10': 0.9057, 'time@10': 8.019}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it] {'epoch': 26, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.9125, 'compress@10': 0.9057, 'time@10': 8.019}:  50%|█████     | 5/10 [00:26<00:28,  5.70s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0159, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9217, 'compress@10': 0.9051, 'time@10': 8.3776}:  50%|█████     | 5/10 [00:36<00:28,  5.70s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0159, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9217, 'compress@10': 0.9051, 'time@10': 8.3776}:  60%|██████    | 6/10 [00:36<00:28,  7.23s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9246, 'compress@10': 0.9049, 'time@10': 8.7881}:  60%|██████    | 6/10 [00:42<00:28,  7.23s/it]  {'epoch': 26, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9246, 'compress@10': 0.9049, 'time@10': 8.7881}:  70%|███████   | 7/10 [00:42<00:20,  6.72s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0154, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9239, 'compress@10': 0.9047, 'time@10': 8.617}:  70%|███████   | 7/10 [00:50<00:20,  6.72s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0154, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9239, 'compress@10': 0.9047, 'time@10': 8.617}:  80%|████████  | 8/10 [00:50<00:13,  6.95s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9271, 'compress@10': 0.9045, 'time@10': 9.2313}:  80%|████████  | 8/10 [00:57<00:13,  6.95s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.9271, 'compress@10': 0.9045, 'time@10': 9.2313}:  90%|█████████ | 9/10 [00:57<00:07,  7.00s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9299, 'compress@10': 0.9042, 'time@10': 9.2837}:  90%|█████████ | 9/10 [01:06<00:07,  7.00s/it]  {'epoch': 26, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9299, 'compress@10': 0.9042, 'time@10': 9.2837}: 100%|██████████| 10/10 [01:06<00:00,  7.86s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9299, 'compress@10': 0.9042, 'time@10': 9.2837}: 100%|██████████| 10/10 [01:06<00:00,  6.70s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.016358262287539643
Avg hit ratio: 0.8774211310289409
Avg ndcg: 0.9299264955791683
Avg compression ratio: 0.9042398514204362
Avg train time: 9.283650946617126
Std train time: 2.907288066856066
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9139, 'compress@10': 0.9052, 'time@10': 8.2197}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9139, 'compress@10': 0.9052, 'time@10': 8.2197}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9387, 'compress@10': 0.9042, 'time@10': 7.6755}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9387, 'compress@10': 0.9042, 'time@10': 7.6755}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9115, 'compress@10': 0.9076, 'time@10': 6.9181}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9115, 'compress@10': 0.9076, 'time@10': 6.9181}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9216, 'compress@10': 0.9066, 'time@10': 6.7225}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9216, 'compress@10': 0.9066, 'time@10': 6.7225}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9148, 'compress@10': 0.9057, 'time@10': 8.0948}:  40%|████      | 4/10 [00:27<00:30,  5.14s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9148, 'compress@10': 0.9057, 'time@10': 8.0948}:  50%|█████     | 5/10 [00:27<00:28,  5.75s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0204, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9279, 'compress@10': 0.9051, 'time@10': 8.4373}:  50%|█████     | 5/10 [00:37<00:28,  5.75s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0204, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9279, 'compress@10': 0.9051, 'time@10': 8.4373}:  60%|██████    | 6/10 [00:37<00:29,  7.26s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0219, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9268, 'compress@10': 0.9049, 'time@10': 8.8139}:  60%|██████    | 6/10 [00:42<00:29,  7.26s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0219, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9268, 'compress@10': 0.9049, 'time@10': 8.8139}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0201, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9301, 'compress@10': 0.9047, 'time@10': 8.6473}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0201, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9301, 'compress@10': 0.9047, 'time@10': 8.6473}:  80%|████████  | 8/10 [00:50<00:13,  6.97s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9346, 'compress@10': 0.9045, 'time@10': 9.2725}:  80%|████████  | 8/10 [00:57<00:13,  6.97s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9346, 'compress@10': 0.9045, 'time@10': 9.2725}:  90%|█████████ | 9/10 [00:57<00:07,  7.03s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9384, 'compress@10': 0.9042, 'time@10': 9.3373}:  90%|█████████ | 9/10 [01:07<00:07,  7.03s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9384, 'compress@10': 0.9042, 'time@10': 9.3373}: 100%|██████████| 10/10 [01:07<00:00,  8.02s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9384, 'compress@10': 0.9042, 'time@10': 9.3373}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.019149915435371964
Avg hit ratio: 0.891195324577328
Avg ndcg: 0.9384370942235926
Avg compression ratio: 0.9042398599741756
Avg train time: 9.337290835380553
Std train time: 2.858371859824227
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9177, 'compress@10': 0.9052, 'time@10': 8.2793}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9177, 'compress@10': 0.9052, 'time@10': 8.2793}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9416, 'compress@10': 0.9042, 'time@10': 7.5695}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9416, 'compress@10': 0.9042, 'time@10': 7.5695}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9134, 'compress@10': 0.9076, 'time@10': 6.6952}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9134, 'compress@10': 0.9076, 'time@10': 6.6952}:  30%|███       | 3/10 [00:13<00:29,  4.29s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9235, 'compress@10': 0.9066, 'time@10': 6.5248}:  30%|███       | 3/10 [00:19<00:29,  4.29s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9235, 'compress@10': 0.9066, 'time@10': 6.5248}:  40%|████      | 4/10 [00:19<00:29,  4.98s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9169, 'compress@10': 0.9057, 'time@10': 7.916}:  40%|████      | 4/10 [00:26<00:29,  4.98s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9169, 'compress@10': 0.9057, 'time@10': 7.916}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9259, 'compress@10': 0.9051, 'time@10': 8.3224}:  50%|█████     | 5/10 [00:36<00:28,  5.63s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9259, 'compress@10': 0.9051, 'time@10': 8.3224}:  60%|██████    | 6/10 [00:36<00:28,  7.25s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9267, 'compress@10': 0.9049, 'time@10': 8.6824}:  60%|██████    | 6/10 [00:42<00:28,  7.25s/it] {'epoch': 28, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9267, 'compress@10': 0.9049, 'time@10': 8.6824}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9305, 'compress@10': 0.9047, 'time@10': 8.5217}:  70%|███████   | 7/10 [00:49<00:20,  6.67s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9305, 'compress@10': 0.9047, 'time@10': 8.5217}:  80%|████████  | 8/10 [00:49<00:13,  6.91s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9504, 'compress@10': 0.9045, 'time@10': 9.1932}:  80%|████████  | 8/10 [00:57<00:13,  6.91s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9504, 'compress@10': 0.9045, 'time@10': 9.1932}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9511, 'compress@10': 0.9042, 'time@10': 9.2371}:  90%|█████████ | 9/10 [01:06<00:07,  7.04s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9511, 'compress@10': 0.9042, 'time@10': 9.2371}: 100%|██████████| 10/10 [01:06<00:00,  7.85s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9511, 'compress@10': 0.9042, 'time@10': 9.2371}: 100%|██████████| 10/10 [01:06<00:00,  6.67s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01871666479398145
Avg hit ratio: 0.8858497024575123
Avg ndcg: 0.9511414722170869
Avg compression ratio: 0.9042398744240444
Avg train time: 9.237140655517578
Std train time: 2.985414704427902
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9198, 'compress@10': 0.9052, 'time@10': 8.1779}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9198, 'compress@10': 0.9052, 'time@10': 8.1779}:  10%|█         | 1/10 [00:04<00:37,  4.13s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9426, 'compress@10': 0.9042, 'time@10': 7.4975}:  10%|█         | 1/10 [00:10<00:37,  4.13s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9426, 'compress@10': 0.9042, 'time@10': 7.4975}:  20%|██        | 2/10 [00:10<00:45,  5.73s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9141, 'compress@10': 0.9076, 'time@10': 6.6978}:  20%|██        | 2/10 [00:13<00:45,  5.73s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9141, 'compress@10': 0.9076, 'time@10': 6.6978}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9241, 'compress@10': 0.9066, 'time@10': 6.5281}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9241, 'compress@10': 0.9066, 'time@10': 6.5281}:  40%|████      | 4/10 [00:19<00:29,  4.99s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9171, 'compress@10': 0.9057, 'time@10': 7.9342}:  40%|████      | 4/10 [00:26<00:29,  4.99s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9171, 'compress@10': 0.9057, 'time@10': 7.9342}:  50%|█████     | 5/10 [00:26<00:28,  5.65s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9252, 'compress@10': 0.9051, 'time@10': 8.2966}:  50%|█████     | 5/10 [00:36<00:28,  5.65s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9252, 'compress@10': 0.9051, 'time@10': 8.2966}:  60%|██████    | 6/10 [00:36<00:28,  7.18s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9281, 'compress@10': 0.9049, 'time@10': 8.7338}:  60%|██████    | 6/10 [00:42<00:28,  7.18s/it] {'epoch': 29, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9281, 'compress@10': 0.9049, 'time@10': 8.7338}:  70%|███████   | 7/10 [00:42<00:20,  6.70s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9317, 'compress@10': 0.9047, 'time@10': 8.5739}:  70%|███████   | 7/10 [00:49<00:20,  6.70s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9317, 'compress@10': 0.9047, 'time@10': 8.5739}:  80%|████████  | 8/10 [00:49<00:13,  6.95s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9266, 'compress@10': 0.9045, 'time@10': 9.1863}:  80%|████████  | 8/10 [00:56<00:13,  6.95s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9266, 'compress@10': 0.9045, 'time@10': 9.1863}:  90%|█████████ | 9/10 [00:56<00:06,  6.99s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.929, 'compress@10': 0.9042, 'time@10': 9.2434}:  90%|█████████ | 9/10 [01:06<00:06,  6.99s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.929, 'compress@10': 0.9042, 'time@10': 9.2434}: 100%|██████████| 10/10 [01:06<00:00,  7.86s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.929, 'compress@10': 0.9042, 'time@10': 9.2434}: 100%|██████████| 10/10 [01:06<00:00,  6.67s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.018783152451169204
Avg hit ratio: 0.8824247152583317
Avg ndcg: 0.9290267381631582
Avg compression ratio: 0.9042398812639597
Avg train time: 9.24341552257538
Std train time: 2.9213978397765676
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9198, 'compress@10': 0.9052, 'time@10': 8.2996}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9198, 'compress@10': 0.9052, 'time@10': 8.2996}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9442, 'compress@10': 0.9042, 'time@10': 7.5799}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]  {'epoch': 30, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9442, 'compress@10': 0.9042, 'time@10': 7.5799}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9152, 'compress@10': 0.9076, 'time@10': 6.8067}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9152, 'compress@10': 0.9076, 'time@10': 6.8067}:  30%|███       | 3/10 [00:13<00:30,  4.36s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9237, 'compress@10': 0.9066, 'time@10': 6.693}:  30%|███       | 3/10 [00:20<00:30,  4.36s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9237, 'compress@10': 0.9066, 'time@10': 6.693}:  40%|████      | 4/10 [00:20<00:30,  5.16s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.9182, 'compress@10': 0.9057, 'time@10': 8.083}:  40%|████      | 4/10 [00:27<00:30,  5.16s/it] {'epoch': 30, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.9182, 'compress@10': 0.9057, 'time@10': 8.083}:  50%|█████     | 5/10 [00:27<00:28,  5.77s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9277, 'compress@10': 0.9051, 'time@10': 8.4134}:  50%|█████     | 5/10 [00:37<00:28,  5.77s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9277, 'compress@10': 0.9051, 'time@10': 8.4134}:  60%|██████    | 6/10 [00:37<00:28,  7.25s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0169, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.93, 'compress@10': 0.9049, 'time@10': 8.7376}:  60%|██████    | 6/10 [00:42<00:28,  7.25s/it] {'epoch': 30, 'num_users': 6.2857, 'loss': 0.0169, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.93, 'compress@10': 0.9049, 'time@10': 8.7376}:  70%|███████   | 7/10 [00:42<00:19,  6.64s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0165, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9325, 'compress@10': 0.9047, 'time@10': 8.6255}:  70%|███████   | 7/10 [00:50<00:19,  6.64s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0165, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9325, 'compress@10': 0.9047, 'time@10': 8.6255}:  80%|████████  | 8/10 [00:50<00:14,  7.03s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9517, 'compress@10': 0.9045, 'time@10': 9.2642}:  80%|████████  | 8/10 [00:57<00:14,  7.03s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9517, 'compress@10': 0.9045, 'time@10': 9.2642}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9544, 'compress@10': 0.9042, 'time@10': 9.3463}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9544, 'compress@10': 0.9042, 'time@10': 9.3463}: 100%|██████████| 10/10 [01:07<00:00,  8.03s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9544, 'compress@10': 0.9042, 'time@10': 9.3463}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.01831480250900762
Avg hit ratio: 0.893932651766268
Avg ndcg: 0.9543771189226959
Avg compression ratio: 0.9042399010758355
Avg train time: 9.346326780319213
Std train time: 2.8598922612501756
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9198, 'compress@10': 0.9052, 'time@10': 8.0644}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9198, 'compress@10': 0.9052, 'time@10': 8.0644}:  10%|█         | 1/10 [00:04<00:36,  4.07s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9563, 'compress@10': 0.9042, 'time@10': 7.4822}:  10%|█         | 1/10 [00:11<00:36,  4.07s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9563, 'compress@10': 0.9042, 'time@10': 7.4822}:  20%|██        | 2/10 [00:11<00:46,  5.76s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9232, 'compress@10': 0.9076, 'time@10': 6.7336}:  20%|██        | 2/10 [00:13<00:46,  5.76s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9232, 'compress@10': 0.9076, 'time@10': 6.7336}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8012, 'ndcg@10': 0.9294, 'compress@10': 0.9066, 'time@10': 6.6017}:  30%|███       | 3/10 [00:19<00:30,  4.34s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8012, 'ndcg@10': 0.9294, 'compress@10': 0.9066, 'time@10': 6.6017}:  40%|████      | 4/10 [00:19<00:30,  5.09s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9241, 'compress@10': 0.9057, 'time@10': 7.9742}:  40%|████      | 4/10 [00:26<00:30,  5.09s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9241, 'compress@10': 0.9057, 'time@10': 7.9742}:  50%|█████     | 5/10 [00:26<00:28,  5.70s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0172, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9344, 'compress@10': 0.9051, 'time@10': 8.3503}:  50%|█████     | 5/10 [00:36<00:28,  5.70s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0172, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9344, 'compress@10': 0.9051, 'time@10': 8.3503}:  60%|██████    | 6/10 [00:36<00:29,  7.25s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9362, 'compress@10': 0.9049, 'time@10': 8.7522}:  60%|██████    | 6/10 [00:42<00:29,  7.25s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9362, 'compress@10': 0.9049, 'time@10': 8.7522}:  70%|███████   | 7/10 [00:42<00:20,  6.72s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9377, 'compress@10': 0.9047, 'time@10': 8.5826}:  70%|███████   | 7/10 [00:49<00:20,  6.72s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9377, 'compress@10': 0.9047, 'time@10': 8.5826}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9402, 'compress@10': 0.9045, 'time@10': 9.216}:  80%|████████  | 8/10 [00:57<00:13,  6.94s/it] {'epoch': 31, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9402, 'compress@10': 0.9045, 'time@10': 9.216}:  90%|█████████ | 9/10 [00:57<00:07,  7.03s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.941, 'compress@10': 0.9042, 'time@10': 9.2944}:  90%|█████████ | 9/10 [01:07<00:07,  7.03s/it]  {'epoch': 31, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.941, 'compress@10': 0.9042, 'time@10': 9.2944}: 100%|██████████| 10/10 [01:07<00:00,  7.96s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.941, 'compress@10': 0.9042, 'time@10': 9.2944}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.018858634149538478
Avg hit ratio: 0.8813980895542866
Avg ndcg: 0.9409704835437491
Avg compression ratio: 0.9042398979678792
Avg train time: 9.294410848617554
Std train time: 2.898431147474245
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9216, 'compress@10': 0.9052, 'time@10': 8.2548}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9216, 'compress@10': 0.9052, 'time@10': 8.2548}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9441, 'compress@10': 0.9042, 'time@10': 7.5021}:  10%|█         | 1/10 [00:10<00:37,  4.19s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9441, 'compress@10': 0.9042, 'time@10': 7.5021}:  20%|██        | 2/10 [00:10<00:45,  5.72s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9151, 'compress@10': 0.9076, 'time@10': 6.7412}:  20%|██        | 2/10 [00:13<00:45,  5.72s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9151, 'compress@10': 0.9076, 'time@10': 6.7412}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9242, 'compress@10': 0.9066, 'time@10': 6.5965}:  30%|███       | 3/10 [00:19<00:30,  4.32s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9242, 'compress@10': 0.9066, 'time@10': 6.5965}:  40%|████      | 4/10 [00:19<00:30,  5.07s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9205, 'compress@10': 0.9057, 'time@10': 7.9765}:  40%|████      | 4/10 [00:26<00:30,  5.07s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9205, 'compress@10': 0.9057, 'time@10': 7.9765}:  50%|█████     | 5/10 [00:26<00:28,  5.69s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9295, 'compress@10': 0.9051, 'time@10': 8.3658}:  50%|█████     | 5/10 [00:36<00:28,  5.69s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9295, 'compress@10': 0.9051, 'time@10': 8.3658}:  60%|██████    | 6/10 [00:36<00:29,  7.27s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9321, 'compress@10': 0.9049, 'time@10': 8.7365}:  60%|██████    | 6/10 [00:42<00:29,  7.27s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9321, 'compress@10': 0.9049, 'time@10': 8.7365}:  70%|███████   | 7/10 [00:42<00:20,  6.70s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9356, 'compress@10': 0.9047, 'time@10': 8.5611}:  70%|███████   | 7/10 [00:49<00:20,  6.70s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9356, 'compress@10': 0.9047, 'time@10': 8.5611}:  80%|████████  | 8/10 [00:49<00:13,  6.92s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9453, 'compress@10': 0.9045, 'time@10': 9.2123}:  80%|████████  | 8/10 [00:57<00:13,  6.92s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9453, 'compress@10': 0.9045, 'time@10': 9.2123}:  90%|█████████ | 9/10 [00:57<00:07,  7.02s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9484, 'compress@10': 0.9042, 'time@10': 9.2615}:  90%|█████████ | 9/10 [01:06<00:07,  7.02s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9484, 'compress@10': 0.9042, 'time@10': 9.2615}: 100%|██████████| 10/10 [01:06<00:00,  7.86s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9484, 'compress@10': 0.9042, 'time@10': 9.2615}: 100%|██████████| 10/10 [01:06<00:00,  6.69s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.012063920362425973
Avg hit ratio: 0.8898870539006362
Avg ndcg: 0.948362510673633
Avg compression ratio: 0.9042399036492424
Avg train time: 9.26150302886963
Std train time: 2.9281797659551025
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9216, 'compress@10': 0.9052, 'time@10': 8.257}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9216, 'compress@10': 0.9052, 'time@10': 8.257}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9393, 'compress@10': 0.9042, 'time@10': 7.5876}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9393, 'compress@10': 0.9042, 'time@10': 7.5876}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9119, 'compress@10': 0.9076, 'time@10': 6.7402}:  20%|██        | 2/10 [00:13<00:46,  5.81s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9119, 'compress@10': 0.9076, 'time@10': 6.7402}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.921, 'compress@10': 0.9066, 'time@10': 6.5982}:  30%|███       | 3/10 [00:19<00:30,  4.32s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.921, 'compress@10': 0.9066, 'time@10': 6.5982}:  40%|████      | 4/10 [00:19<00:30,  5.07s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9186, 'compress@10': 0.9057, 'time@10': 8.0084}:  40%|████      | 4/10 [00:26<00:30,  5.07s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9186, 'compress@10': 0.9057, 'time@10': 8.0084}:  50%|█████     | 5/10 [00:26<00:28,  5.71s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9356, 'compress@10': 0.9051, 'time@10': 8.3779}:  50%|█████     | 5/10 [00:37<00:28,  5.71s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9356, 'compress@10': 0.9051, 'time@10': 8.3779}:  60%|██████    | 6/10 [00:37<00:29,  7.26s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9345, 'compress@10': 0.9049, 'time@10': 8.8088}:  60%|██████    | 6/10 [00:42<00:29,  7.26s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9345, 'compress@10': 0.9049, 'time@10': 8.8088}:  70%|███████   | 7/10 [00:42<00:20,  6.76s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9374, 'compress@10': 0.9047, 'time@10': 8.6411}:  70%|███████   | 7/10 [00:50<00:20,  6.76s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9374, 'compress@10': 0.9047, 'time@10': 8.6411}:  80%|████████  | 8/10 [00:50<00:13,  7.00s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9379, 'compress@10': 0.9045, 'time@10': 9.2565}:  80%|████████  | 8/10 [00:57<00:13,  7.00s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9379, 'compress@10': 0.9045, 'time@10': 9.2565}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9405, 'compress@10': 0.9042, 'time@10': 9.319}:  90%|█████████ | 9/10 [01:07<00:07,  7.04s/it]     {'epoch': 33, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9405, 'compress@10': 0.9042, 'time@10': 9.319}: 100%|██████████| 10/10 [01:07<00:00,  7.93s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9405, 'compress@10': 0.9042, 'time@10': 9.319}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.01695835496507887
Avg hit ratio: 0.8937477809871698
Avg ndcg: 0.9404983681478815
Avg compression ratio: 0.9042398955496335
Avg train time: 9.31895956993103
Std train time: 2.937854238763116
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9216, 'compress@10': 0.9052, 'time@10': 8.2614}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9216, 'compress@10': 0.9052, 'time@10': 8.2614}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9716, 'compress@10': 0.9042, 'time@10': 7.5669}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9716, 'compress@10': 0.9042, 'time@10': 7.5669}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9334, 'compress@10': 0.9076, 'time@10': 6.7278}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9334, 'compress@10': 0.9076, 'time@10': 6.7278}:  30%|███       | 3/10 [00:13<00:30,  4.31s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9384, 'compress@10': 0.9066, 'time@10': 6.548}:  30%|███       | 3/10 [00:19<00:30,  4.31s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9384, 'compress@10': 0.9066, 'time@10': 6.548}:  40%|████      | 4/10 [00:19<00:29,  4.99s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0153, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9336, 'compress@10': 0.9057, 'time@10': 7.9614}:  40%|████      | 4/10 [00:26<00:29,  4.99s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0153, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9336, 'compress@10': 0.9057, 'time@10': 7.9614}:  50%|█████     | 5/10 [00:26<00:28,  5.66s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9404, 'compress@10': 0.9051, 'time@10': 8.3493}:  50%|█████     | 5/10 [00:36<00:28,  5.66s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9404, 'compress@10': 0.9051, 'time@10': 8.3493}:  60%|██████    | 6/10 [00:36<00:28,  7.25s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.904, 'ndcg@10': 0.9417, 'compress@10': 0.9049, 'time@10': 8.6975}:  60%|██████    | 6/10 [00:42<00:28,  7.25s/it] {'epoch': 34, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.904, 'ndcg@10': 0.9417, 'compress@10': 0.9049, 'time@10': 8.6975}:  70%|███████   | 7/10 [00:42<00:19,  6.65s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.9416, 'compress@10': 0.9047, 'time@10': 8.5277}:  70%|███████   | 7/10 [00:49<00:19,  6.65s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.9416, 'compress@10': 0.9047, 'time@10': 8.5277}:  80%|████████  | 8/10 [00:49<00:13,  6.88s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9564, 'compress@10': 0.9045, 'time@10': 9.1812}:  80%|████████  | 8/10 [00:56<00:13,  6.88s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9564, 'compress@10': 0.9045, 'time@10': 9.1812}:  90%|█████████ | 9/10 [00:56<00:07,  7.00s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9556, 'compress@10': 0.9042, 'time@10': 9.2797}:  90%|█████████ | 9/10 [01:07<00:07,  7.00s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9556, 'compress@10': 0.9042, 'time@10': 9.2797}: 100%|██████████| 10/10 [01:07<00:00,  7.99s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9556, 'compress@10': 0.9042, 'time@10': 9.2797}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.016135252143910074
Avg hit ratio: 0.9048076888212713
Avg ndcg: 0.9556118527105018
Avg compression ratio: 0.9042398857408311
Avg train time: 9.279676079750061
Std train time: 2.972640563736946
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9239, 'compress@10': 0.9052, 'time@10': 8.2809}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9239, 'compress@10': 0.9052, 'time@10': 8.2809}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9458, 'compress@10': 0.9042, 'time@10': 7.5503}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9458, 'compress@10': 0.9042, 'time@10': 7.5503}:  20%|██        | 2/10 [00:11<00:46,  5.75s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9163, 'compress@10': 0.9076, 'time@10': 6.7952}:  20%|██        | 2/10 [00:13<00:46,  5.75s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9163, 'compress@10': 0.9076, 'time@10': 6.7952}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9266, 'compress@10': 0.9066, 'time@10': 6.6401}:  30%|███       | 3/10 [00:19<00:30,  4.35s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9266, 'compress@10': 0.9066, 'time@10': 6.6401}:  40%|████      | 4/10 [00:19<00:30,  5.08s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9243, 'compress@10': 0.9057, 'time@10': 8.0282}:  40%|████      | 4/10 [00:26<00:30,  5.08s/it]  {'epoch': 35, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9243, 'compress@10': 0.9057, 'time@10': 8.0282}:  50%|█████     | 5/10 [00:26<00:28,  5.71s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9328, 'compress@10': 0.9051, 'time@10': 8.3804}:  50%|█████     | 5/10 [00:36<00:28,  5.71s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9328, 'compress@10': 0.9051, 'time@10': 8.3804}:  60%|██████    | 6/10 [00:36<00:28,  7.23s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9358, 'compress@10': 0.9049, 'time@10': 8.764}:  60%|██████    | 6/10 [00:42<00:28,  7.23s/it] {'epoch': 35, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9358, 'compress@10': 0.9049, 'time@10': 8.764}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.9205, 'ndcg@10': 0.9379, 'compress@10': 0.9047, 'time@10': 8.5987}:  70%|███████   | 7/10 [00:49<00:20,  6.69s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.9205, 'ndcg@10': 0.9379, 'compress@10': 0.9047, 'time@10': 8.5987}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9386, 'compress@10': 0.9045, 'time@10': 9.2291}:  80%|████████  | 8/10 [00:57<00:13,  6.94s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9386, 'compress@10': 0.9045, 'time@10': 9.2291}:  90%|█████████ | 9/10 [00:57<00:07,  7.01s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9141, 'ndcg@10': 0.9442, 'compress@10': 0.9042, 'time@10': 9.2893}:  90%|█████████ | 9/10 [01:07<00:07,  7.01s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9141, 'ndcg@10': 0.9442, 'compress@10': 0.9042, 'time@10': 9.2893}: 100%|██████████| 10/10 [01:07<00:00,  7.90s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9141, 'ndcg@10': 0.9442, 'compress@10': 0.9042, 'time@10': 9.2893}: 100%|██████████| 10/10 [01:07<00:00,  6.70s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.011689807579545478
Avg hit ratio: 0.9141164445816399
Avg ndcg: 0.944196532107528
Avg compression ratio: 0.9042398846608061
Avg train time: 9.289274072647094
Std train time: 2.892785948950764
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9239, 'compress@10': 0.9052, 'time@10': 8.3803}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9239, 'compress@10': 0.9052, 'time@10': 8.3803}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9466, 'compress@10': 0.9042, 'time@10': 7.5709}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9466, 'compress@10': 0.9042, 'time@10': 7.5709}:  20%|██        | 2/10 [00:11<00:45,  5.74s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9168, 'compress@10': 0.9076, 'time@10': 6.7441}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9168, 'compress@10': 0.9076, 'time@10': 6.7441}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9258, 'compress@10': 0.9066, 'time@10': 6.5786}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9258, 'compress@10': 0.9066, 'time@10': 6.5786}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9244, 'compress@10': 0.9057, 'time@10': 7.9701}:  40%|████      | 4/10 [00:26<00:30,  5.02s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9244, 'compress@10': 0.9057, 'time@10': 7.9701}:  50%|█████     | 5/10 [00:26<00:28,  5.66s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9353, 'compress@10': 0.9051, 'time@10': 8.3425}:  50%|█████     | 5/10 [00:36<00:28,  5.66s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9353, 'compress@10': 0.9051, 'time@10': 8.3425}:  60%|██████    | 6/10 [00:36<00:28,  7.22s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9337, 'compress@10': 0.9049, 'time@10': 8.7121}:  60%|██████    | 6/10 [00:42<00:28,  7.22s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9337, 'compress@10': 0.9049, 'time@10': 8.7121}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.937, 'compress@10': 0.9047, 'time@10': 8.5545}:  70%|███████   | 7/10 [00:49<00:19,  6.66s/it]  {'epoch': 36, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.937, 'compress@10': 0.9047, 'time@10': 8.5545}:  80%|████████  | 8/10 [00:49<00:13,  6.92s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0169, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9475, 'compress@10': 0.9045, 'time@10': 9.2166}:  80%|████████  | 8/10 [00:57<00:13,  6.92s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0169, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9475, 'compress@10': 0.9045, 'time@10': 9.2166}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9472, 'compress@10': 0.9042, 'time@10': 9.2692}:  90%|█████████ | 9/10 [01:06<00:07,  7.04s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9472, 'compress@10': 0.9042, 'time@10': 9.2692}: 100%|██████████| 10/10 [01:06<00:00,  7.89s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9472, 'compress@10': 0.9042, 'time@10': 9.2692}: 100%|██████████| 10/10 [01:06<00:00,  6.69s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.01736417094310744
Avg hit ratio: 0.9054426094561917
Avg ndcg: 0.9472365332207575
Avg compression ratio: 0.9042398849188567
Avg train time: 9.269221115112305
Std train time: 2.9592531610567208
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.9052, 'time@10': 8.3016}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.9052, 'time@10': 8.3016}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9505, 'compress@10': 0.9042, 'time@10': 7.5361}:  10%|█         | 1/10 [00:10<00:37,  4.19s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9505, 'compress@10': 0.9042, 'time@10': 7.5361}:  20%|██        | 2/10 [00:10<00:45,  5.73s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9194, 'compress@10': 0.9076, 'time@10': 6.7297}:  20%|██        | 2/10 [00:13<00:45,  5.73s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9194, 'compress@10': 0.9076, 'time@10': 6.7297}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9283, 'compress@10': 0.9066, 'time@10': 6.5881}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9283, 'compress@10': 0.9066, 'time@10': 6.5881}:  40%|████      | 4/10 [00:19<00:30,  5.05s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9274, 'compress@10': 0.9057, 'time@10': 7.9546}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9274, 'compress@10': 0.9057, 'time@10': 7.9546}:  50%|█████     | 5/10 [00:26<00:28,  5.66s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9315, 'compress@10': 0.9051, 'time@10': 8.3368}:  50%|█████     | 5/10 [00:36<00:28,  5.66s/it] {'epoch': 37, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9315, 'compress@10': 0.9051, 'time@10': 8.3368}:  60%|██████    | 6/10 [00:36<00:28,  7.24s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9343, 'compress@10': 0.9049, 'time@10': 8.6769}:  60%|██████    | 6/10 [00:42<00:28,  7.24s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9343, 'compress@10': 0.9049, 'time@10': 8.6769}:  70%|███████   | 7/10 [00:42<00:19,  6.63s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.938, 'compress@10': 0.9047, 'time@10': 8.5251}:  70%|███████   | 7/10 [00:49<00:19,  6.63s/it]  {'epoch': 37, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.938, 'compress@10': 0.9047, 'time@10': 8.5251}:  80%|████████  | 8/10 [00:49<00:13,  6.91s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9388, 'compress@10': 0.9045, 'time@10': 9.1579}:  80%|████████  | 8/10 [00:56<00:13,  6.91s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9388, 'compress@10': 0.9045, 'time@10': 9.1579}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9427, 'compress@10': 0.9042, 'time@10': 9.2377}:  90%|█████████ | 9/10 [01:06<00:06,  6.98s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9427, 'compress@10': 0.9042, 'time@10': 9.2377}: 100%|██████████| 10/10 [01:06<00:00,  7.91s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9427, 'compress@10': 0.9042, 'time@10': 9.2377}: 100%|██████████| 10/10 [01:06<00:00,  6.69s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.012348661946567191
Avg hit ratio: 0.9108906381300269
Avg ndcg: 0.9427136124171849
Avg compression ratio: 0.9042398800458031
Avg train time: 9.237706637382507
Std train time: 2.8739115073238266
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9286, 'compress@10': 0.9052, 'time@10': 8.2747}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9286, 'compress@10': 0.9052, 'time@10': 8.2747}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.952, 'compress@10': 0.9042, 'time@10': 7.4917}:  10%|█         | 1/10 [00:10<00:37,  4.17s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.952, 'compress@10': 0.9042, 'time@10': 7.4917}:  20%|██        | 2/10 [00:10<00:45,  5.69s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9204, 'compress@10': 0.9076, 'time@10': 6.6718}:  20%|██        | 2/10 [00:13<00:45,  5.69s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9204, 'compress@10': 0.9076, 'time@10': 6.6718}:  30%|███       | 3/10 [00:13<00:29,  4.25s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9297, 'compress@10': 0.9066, 'time@10': 6.5223}:  30%|███       | 3/10 [00:19<00:29,  4.25s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9297, 'compress@10': 0.9066, 'time@10': 6.5223}:  40%|████      | 4/10 [00:19<00:29,  4.99s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9287, 'compress@10': 0.9057, 'time@10': 7.8782}:  40%|████      | 4/10 [00:26<00:29,  4.99s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9287, 'compress@10': 0.9057, 'time@10': 7.8782}:  50%|█████     | 5/10 [00:26<00:27,  5.60s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9366, 'compress@10': 0.9051, 'time@10': 8.286}:  50%|█████     | 5/10 [00:36<00:27,  5.60s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9366, 'compress@10': 0.9051, 'time@10': 8.286}:  60%|██████    | 6/10 [00:36<00:28,  7.22s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.939, 'compress@10': 0.9049, 'time@10': 8.6615}:  60%|██████    | 6/10 [00:42<00:28,  7.22s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.939, 'compress@10': 0.9049, 'time@10': 8.6615}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9152, 'ndcg@10': 0.9422, 'compress@10': 0.9047, 'time@10': 8.5102}:  70%|███████   | 7/10 [00:49<00:19,  6.66s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9152, 'ndcg@10': 0.9422, 'compress@10': 0.9047, 'time@10': 8.5102}:  80%|████████  | 8/10 [00:49<00:13,  6.92s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9531, 'compress@10': 0.9045, 'time@10': 9.1377}:  80%|████████  | 8/10 [00:56<00:13,  6.92s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9531, 'compress@10': 0.9045, 'time@10': 9.1377}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9544, 'compress@10': 0.9042, 'time@10': 9.2118}:  90%|█████████ | 9/10 [01:06<00:06,  6.98s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9544, 'compress@10': 0.9042, 'time@10': 9.2118}: 100%|██████████| 10/10 [01:06<00:00,  7.89s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9544, 'compress@10': 0.9042, 'time@10': 9.2118}: 100%|██████████| 10/10 [01:06<00:00,  6.66s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.01311775495879105
Avg hit ratio: 0.9098870539006363
Avg ndcg: 0.9543703508706024
Avg compression ratio: 0.904239898504321
Avg train time: 9.211779570579528
Std train time: 2.8868621035770374
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.9052, 'time@10': 7.9962}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.9052, 'time@10': 7.9962}:  10%|█         | 1/10 [00:04<00:36,  4.04s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9477, 'compress@10': 0.9042, 'time@10': 7.3619}:  10%|█         | 1/10 [00:10<00:36,  4.04s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9477, 'compress@10': 0.9042, 'time@10': 7.3619}:  20%|██        | 2/10 [00:10<00:45,  5.64s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9175, 'compress@10': 0.9076, 'time@10': 6.6164}:  20%|██        | 2/10 [00:13<00:45,  5.64s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9175, 'compress@10': 0.9076, 'time@10': 6.6164}:  30%|███       | 3/10 [00:13<00:29,  4.25s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9273, 'compress@10': 0.9066, 'time@10': 6.4933}:  30%|███       | 3/10 [00:19<00:29,  4.25s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9273, 'compress@10': 0.9066, 'time@10': 6.4933}:  40%|████      | 4/10 [00:19<00:30,  5.01s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9269, 'compress@10': 0.9057, 'time@10': 7.8637}:  40%|████      | 4/10 [00:26<00:30,  5.01s/it]  {'epoch': 39, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9269, 'compress@10': 0.9057, 'time@10': 7.8637}:  50%|█████     | 5/10 [00:26<00:28,  5.62s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9391, 'compress@10': 0.9051, 'time@10': 8.2567}:  50%|█████     | 5/10 [00:36<00:28,  5.62s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9391, 'compress@10': 0.9051, 'time@10': 8.2567}:  60%|██████    | 6/10 [00:36<00:28,  7.20s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.904, 'ndcg@10': 0.9412, 'compress@10': 0.9049, 'time@10': 8.6696}:  60%|██████    | 6/10 [00:42<00:28,  7.20s/it]  {'epoch': 39, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.904, 'ndcg@10': 0.9412, 'compress@10': 0.9049, 'time@10': 8.6696}:  70%|███████   | 7/10 [00:42<00:20,  6.68s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.9432, 'compress@10': 0.9047, 'time@10': 8.5114}:  70%|███████   | 7/10 [00:49<00:20,  6.68s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.9432, 'compress@10': 0.9047, 'time@10': 8.5114}:  80%|████████  | 8/10 [00:49<00:13,  6.92s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.944, 'compress@10': 0.9045, 'time@10': 9.115}:  80%|████████  | 8/10 [00:56<00:13,  6.92s/it] {'epoch': 39, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.944, 'compress@10': 0.9045, 'time@10': 9.115}:  90%|█████████ | 9/10 [00:56<00:06,  6.95s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9452, 'compress@10': 0.9042, 'time@10': 9.1754}:  90%|█████████ | 9/10 [01:06<00:06,  6.95s/it] {'epoch': 39, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9452, 'compress@10': 0.9042, 'time@10': 9.1754}: 100%|██████████| 10/10 [01:06<00:00,  7.81s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9452, 'compress@10': 0.9042, 'time@10': 9.1754}: 100%|██████████| 10/10 [01:06<00:00,  6.63s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.013144185743772333
Avg hit ratio: 0.907664831678414
Avg ndcg: 0.9451737328365916
Avg compression ratio: 0.9042399015427843
Avg train time: 9.175438332557679
Std train time: 2.857289748333847
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9099, 'compress@10': 0.9052, 'time@10': 8.1674}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9099, 'compress@10': 0.9052, 'time@10': 8.1674}:  10%|█         | 1/10 [00:04<00:37,  4.13s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9388, 'compress@10': 0.9042, 'time@10': 7.5691}:  10%|█         | 1/10 [00:11<00:37,  4.13s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9388, 'compress@10': 0.9042, 'time@10': 7.5691}:  20%|██        | 2/10 [00:11<00:46,  5.82s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9116, 'compress@10': 0.9076, 'time@10': 6.7376}:  20%|██        | 2/10 [00:13<00:46,  5.82s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9116, 'compress@10': 0.9076, 'time@10': 6.7376}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9236, 'compress@10': 0.9066, 'time@10': 6.5503}:  30%|███       | 3/10 [00:19<00:30,  4.34s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9236, 'compress@10': 0.9066, 'time@10': 6.5503}:  40%|████      | 4/10 [00:19<00:30,  5.01s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.925, 'compress@10': 0.9057, 'time@10': 7.9009}:  40%|████      | 4/10 [00:26<00:30,  5.01s/it] {'epoch': 40, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.925, 'compress@10': 0.9057, 'time@10': 7.9009}:  50%|█████     | 5/10 [00:26<00:28,  5.61s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9335, 'compress@10': 0.9051, 'time@10': 8.2859}:  50%|█████     | 5/10 [00:36<00:28,  5.61s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9335, 'compress@10': 0.9051, 'time@10': 8.2859}:  60%|██████    | 6/10 [00:36<00:28,  7.19s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9363, 'compress@10': 0.9049, 'time@10': 8.633}:  60%|██████    | 6/10 [00:42<00:28,  7.19s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9363, 'compress@10': 0.9049, 'time@10': 8.633}:  70%|███████   | 7/10 [00:42<00:19,  6.60s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9421, 'compress@10': 0.9047, 'time@10': 8.4883}:  70%|███████   | 7/10 [00:49<00:19,  6.60s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9421, 'compress@10': 0.9047, 'time@10': 8.4883}:  80%|████████  | 8/10 [00:49<00:13,  6.89s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9585, 'compress@10': 0.9045, 'time@10': 9.1229}:  80%|████████  | 8/10 [00:56<00:13,  6.89s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9585, 'compress@10': 0.9045, 'time@10': 9.1229}:  90%|█████████ | 9/10 [00:56<00:06,  6.97s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9604, 'compress@10': 0.9042, 'time@10': 9.1769}:  90%|█████████ | 9/10 [01:06<00:06,  6.97s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9604, 'compress@10': 0.9042, 'time@10': 9.1769}: 100%|██████████| 10/10 [01:06<00:00,  7.81s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9604, 'compress@10': 0.9042, 'time@10': 9.1769}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.013320946984193425
Avg hit ratio: 0.900232676020452
Avg ndcg: 0.96036483108234
Avg compression ratio: 0.9042398913877155
Avg train time: 9.176888704299927
Std train time: 2.8584717969412523
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9199, 'compress@10': 0.9052, 'time@10': 8.3062}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9199, 'compress@10': 0.9052, 'time@10': 8.3062}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9438, 'compress@10': 0.9042, 'time@10': 7.5745}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9438, 'compress@10': 0.9042, 'time@10': 7.5745}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9149, 'compress@10': 0.9076, 'time@10': 6.7567}:  20%|██        | 2/10 [00:13<00:46,  5.80s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9149, 'compress@10': 0.9076, 'time@10': 6.7567}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9253, 'compress@10': 0.9066, 'time@10': 6.6009}:  30%|███       | 3/10 [00:19<00:30,  4.34s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9253, 'compress@10': 0.9066, 'time@10': 6.6009}:  40%|████      | 4/10 [00:19<00:30,  5.06s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9269, 'compress@10': 0.9057, 'time@10': 7.9455}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9269, 'compress@10': 0.9057, 'time@10': 7.9455}:  50%|█████     | 5/10 [00:26<00:28,  5.65s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9374, 'compress@10': 0.9051, 'time@10': 8.3323}:  50%|█████     | 5/10 [00:36<00:28,  5.65s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9374, 'compress@10': 0.9051, 'time@10': 8.3323}:  60%|██████    | 6/10 [00:36<00:28,  7.23s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9407, 'compress@10': 0.9049, 'time@10': 8.7088}:  60%|██████    | 6/10 [00:42<00:28,  7.23s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9407, 'compress@10': 0.9049, 'time@10': 8.7088}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9582, 'compress@10': 0.9047, 'time@10': 8.5498}:  70%|███████   | 7/10 [00:49<00:20,  6.67s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9582, 'compress@10': 0.9047, 'time@10': 8.5498}:  80%|████████  | 8/10 [00:49<00:13,  6.93s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9569, 'compress@10': 0.9045, 'time@10': 9.1674}:  80%|████████  | 8/10 [00:56<00:13,  6.93s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9569, 'compress@10': 0.9045, 'time@10': 9.1674}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9596, 'compress@10': 0.9042, 'time@10': 9.2114}:  90%|█████████ | 9/10 [01:06<00:06,  6.98s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9596, 'compress@10': 0.9042, 'time@10': 9.2114}: 100%|██████████| 10/10 [01:06<00:00,  7.80s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9596, 'compress@10': 0.9042, 'time@10': 9.2114}: 100%|██████████| 10/10 [01:06<00:00,  6.66s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.013172550307224428
Avg hit ratio: 0.9073192095585985
Avg ndcg: 0.9595696276898418
Avg compression ratio: 0.9042399034174465
Avg train time: 9.211367058753968
Std train time: 2.8464673729803183
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9284, 'compress@10': 0.9052, 'time@10': 8.2326}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9284, 'compress@10': 0.9052, 'time@10': 8.2326}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9553, 'compress@10': 0.9042, 'time@10': 7.4929}:  10%|█         | 1/10 [00:10<00:37,  4.15s/it] {'epoch': 42, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9553, 'compress@10': 0.9042, 'time@10': 7.4929}:  20%|██        | 2/10 [00:10<00:45,  5.70s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9226, 'compress@10': 0.9076, 'time@10': 6.7142}:  20%|██        | 2/10 [00:13<00:45,  5.70s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9226, 'compress@10': 0.9076, 'time@10': 6.7142}:  30%|███       | 3/10 [00:13<00:30,  4.29s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.932, 'compress@10': 0.9066, 'time@10': 6.54}:  30%|███       | 3/10 [00:19<00:30,  4.29s/it]   {'epoch': 42, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.932, 'compress@10': 0.9066, 'time@10': 6.54}:  40%|████      | 4/10 [00:19<00:29,  4.99s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9341, 'compress@10': 0.9057, 'time@10': 7.8805}:  40%|████      | 4/10 [00:26<00:29,  4.99s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9341, 'compress@10': 0.9057, 'time@10': 7.8805}:  50%|█████     | 5/10 [00:26<00:27,  5.59s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9355, 'compress@10': 0.9051, 'time@10': 8.2895}:  50%|█████     | 5/10 [00:36<00:27,  5.59s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9355, 'compress@10': 0.9051, 'time@10': 8.2895}:  60%|██████    | 6/10 [00:36<00:28,  7.22s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.939, 'compress@10': 0.9049, 'time@10': 8.6537}:  60%|██████    | 6/10 [00:42<00:28,  7.22s/it] {'epoch': 42, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.939, 'compress@10': 0.9049, 'time@10': 8.6537}:  70%|███████   | 7/10 [00:42<00:19,  6.64s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9672, 'compress@10': 0.9047, 'time@10': 8.4948}:  70%|███████   | 7/10 [00:49<00:19,  6.64s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9672, 'compress@10': 0.9047, 'time@10': 8.4948}:  80%|████████  | 8/10 [00:49<00:13,  6.89s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9746, 'compress@10': 0.9045, 'time@10': 9.1173}:  80%|████████  | 8/10 [00:56<00:13,  6.89s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9746, 'compress@10': 0.9045, 'time@10': 9.1173}:  90%|█████████ | 9/10 [00:56<00:06,  6.95s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.972, 'compress@10': 0.9042, 'time@10': 9.184}:  90%|█████████ | 9/10 [01:06<00:06,  6.95s/it]     {'epoch': 42, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.972, 'compress@10': 0.9042, 'time@10': 9.184}: 100%|██████████| 10/10 [01:06<00:00,  7.84s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.972, 'compress@10': 0.9042, 'time@10': 9.184}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.01846021912069706
Avg hit ratio: 0.9073192095585985
Avg ndcg: 0.9720305896938974
Avg compression ratio: 0.9042398997153359
Avg train time: 9.183984351158141
Std train time: 2.8520731158335817
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9199, 'compress@10': 0.9052, 'time@10': 8.2869}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9199, 'compress@10': 0.9052, 'time@10': 8.2869}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9646, 'compress@10': 0.9042, 'time@10': 7.5088}:  10%|█         | 1/10 [00:10<00:37,  4.18s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9646, 'compress@10': 0.9042, 'time@10': 7.5088}:  20%|██        | 2/10 [00:10<00:45,  5.70s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.9288, 'compress@10': 0.9076, 'time@10': 6.6913}:  20%|██        | 2/10 [00:13<00:45,  5.70s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.9288, 'compress@10': 0.9076, 'time@10': 6.6913}:  30%|███       | 3/10 [00:13<00:29,  4.27s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9372, 'compress@10': 0.9066, 'time@10': 6.5174}:  30%|███       | 3/10 [00:19<00:29,  4.27s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9372, 'compress@10': 0.9066, 'time@10': 6.5174}:  40%|████      | 4/10 [00:19<00:29,  4.96s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9382, 'compress@10': 0.9057, 'time@10': 7.8416}:  40%|████      | 4/10 [00:26<00:29,  4.96s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9382, 'compress@10': 0.9057, 'time@10': 7.8416}:  50%|█████     | 5/10 [00:26<00:27,  5.56s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9445, 'compress@10': 0.9051, 'time@10': 8.2166}:  50%|█████     | 5/10 [00:36<00:27,  5.56s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9445, 'compress@10': 0.9051, 'time@10': 8.2166}:  60%|██████    | 6/10 [00:36<00:28,  7.11s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9457, 'compress@10': 0.9049, 'time@10': 8.584}:  60%|██████    | 6/10 [00:41<00:28,  7.11s/it] {'epoch': 43, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9457, 'compress@10': 0.9049, 'time@10': 8.584}:  70%|███████   | 7/10 [00:41<00:19,  6.57s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0084, 'hit_ratio@10': 0.9246, 'ndcg@10': 0.9483, 'compress@10': 0.9047, 'time@10': 8.4491}:  70%|███████   | 7/10 [00:49<00:19,  6.57s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0084, 'hit_ratio@10': 0.9246, 'ndcg@10': 0.9483, 'compress@10': 0.9047, 'time@10': 8.4491}:  80%|████████  | 8/10 [00:49<00:13,  6.88s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9495, 'compress@10': 0.9045, 'time@10': 9.0934}:  80%|████████  | 8/10 [00:56<00:13,  6.88s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9495, 'compress@10': 0.9045, 'time@10': 9.0934}:  90%|█████████ | 9/10 [00:56<00:06,  6.97s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0084, 'hit_ratio@10': 0.9174, 'ndcg@10': 0.9522, 'compress@10': 0.9042, 'time@10': 9.152}:  90%|█████████ | 9/10 [01:06<00:06,  6.97s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0084, 'hit_ratio@10': 0.9174, 'ndcg@10': 0.9522, 'compress@10': 0.9042, 'time@10': 9.152}: 100%|██████████| 10/10 [01:06<00:00,  7.82s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0084, 'hit_ratio@10': 0.9174, 'ndcg@10': 0.9522, 'compress@10': 0.9042, 'time@10': 9.152}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.00838332575650587
Avg hit ratio: 0.9173755331633091
Avg ndcg: 0.9522335680437338
Avg compression ratio: 0.904239907887795
Avg train time: 9.152039551734925
Std train time: 2.8593713288698663
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9247, 'compress@10': 0.9052, 'time@10': 8.03}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9247, 'compress@10': 0.9052, 'time@10': 8.03}:  10%|█         | 1/10 [00:04<00:36,  4.05s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9462, 'compress@10': 0.9042, 'time@10': 7.3881}:  10%|█         | 1/10 [00:10<00:36,  4.05s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9462, 'compress@10': 0.9042, 'time@10': 7.3881}:  20%|██        | 2/10 [00:10<00:45,  5.66s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9165, 'compress@10': 0.9076, 'time@10': 6.5775}:  20%|██        | 2/10 [00:13<00:45,  5.66s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9165, 'compress@10': 0.9076, 'time@10': 6.5775}:  30%|███       | 3/10 [00:13<00:29,  4.22s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.927, 'compress@10': 0.9066, 'time@10': 6.4297}:  30%|███       | 3/10 [00:19<00:29,  4.22s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.927, 'compress@10': 0.9066, 'time@10': 6.4297}:  40%|████      | 4/10 [00:19<00:29,  4.93s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.9076, 'ndcg@10': 0.9305, 'compress@10': 0.9057, 'time@10': 7.7689}:  40%|████      | 4/10 [00:25<00:29,  4.93s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.9076, 'ndcg@10': 0.9305, 'compress@10': 0.9057, 'time@10': 7.7689}:  50%|█████     | 5/10 [00:25<00:27,  5.53s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9439, 'compress@10': 0.9051, 'time@10': 8.166}:  50%|█████     | 5/10 [00:36<00:27,  5.53s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9439, 'compress@10': 0.9051, 'time@10': 8.166}:  60%|██████    | 6/10 [00:36<00:28,  7.12s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9251, 'ndcg@10': 0.9462, 'compress@10': 0.9049, 'time@10': 8.5335}:  60%|██████    | 6/10 [00:41<00:28,  7.12s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9251, 'ndcg@10': 0.9462, 'compress@10': 0.9049, 'time@10': 8.5335}:  70%|███████   | 7/10 [00:41<00:19,  6.56s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9309, 'ndcg@10': 0.9499, 'compress@10': 0.9047, 'time@10': 8.3937}:  70%|███████   | 7/10 [00:49<00:19,  6.56s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9309, 'ndcg@10': 0.9499, 'compress@10': 0.9047, 'time@10': 8.3937}:  80%|████████  | 8/10 [00:49<00:13,  6.84s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0119, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9625, 'compress@10': 0.9045, 'time@10': 9.0354}:  80%|████████  | 8/10 [00:56<00:13,  6.84s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0119, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9625, 'compress@10': 0.9045, 'time@10': 9.0354}:  90%|█████████ | 9/10 [00:56<00:06,  6.93s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9626, 'compress@10': 0.9042, 'time@10': 9.0971}:  90%|█████████ | 9/10 [01:05<00:06,  6.93s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9626, 'compress@10': 0.9042, 'time@10': 9.0971}: 100%|██████████| 10/10 [01:05<00:00,  7.78s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9626, 'compress@10': 0.9042, 'time@10': 9.0971}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.012454116188171525
Avg hit ratio: 0.9224446575872722
Avg ndcg: 0.9625991991316981
Avg compression ratio: 0.90423989698866
Avg train time: 9.097113919258117
Std train time: 2.8703267831976267
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9247, 'compress@10': 0.9052, 'time@10': 8.1388}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9247, 'compress@10': 0.9052, 'time@10': 8.1388}:  10%|█         | 1/10 [00:04<00:36,  4.11s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.893, 'ndcg@10': 0.99, 'compress@10': 0.9042, 'time@10': 7.5106}:  10%|█         | 1/10 [00:11<00:36,  4.11s/it]   {'epoch': 45, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.893, 'ndcg@10': 0.99, 'compress@10': 0.9042, 'time@10': 7.5106}:  20%|██        | 2/10 [00:11<00:46,  5.76s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9457, 'compress@10': 0.9076, 'time@10': 6.7115}:  20%|██        | 2/10 [00:13<00:46,  5.76s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9457, 'compress@10': 0.9076, 'time@10': 6.7115}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9484, 'compress@10': 0.9066, 'time@10': 6.5879}:  30%|███       | 3/10 [00:19<00:30,  4.32s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9484, 'compress@10': 0.9066, 'time@10': 6.5879}:  40%|████      | 4/10 [00:19<00:30,  5.08s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9488, 'compress@10': 0.9057, 'time@10': 7.9594}:  40%|████      | 4/10 [00:26<00:30,  5.08s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9488, 'compress@10': 0.9057, 'time@10': 7.9594}:  50%|█████     | 5/10 [00:26<00:28,  5.69s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0124, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9535, 'compress@10': 0.9051, 'time@10': 8.349}:  50%|█████     | 5/10 [00:36<00:28,  5.69s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0124, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9535, 'compress@10': 0.9051, 'time@10': 8.349}:  60%|██████    | 6/10 [00:36<00:29,  7.27s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9543, 'compress@10': 0.9049, 'time@10': 8.7367}:  60%|██████    | 6/10 [00:42<00:29,  7.27s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9543, 'compress@10': 0.9049, 'time@10': 8.7367}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0148, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9766, 'compress@10': 0.9047, 'time@10': 8.5669}:  70%|███████   | 7/10 [00:49<00:20,  6.71s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0148, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9766, 'compress@10': 0.9047, 'time@10': 8.5669}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9729, 'compress@10': 0.9045, 'time@10': 9.1802}:  80%|████████  | 8/10 [00:57<00:13,  6.94s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9729, 'compress@10': 0.9045, 'time@10': 9.1802}:  90%|█████████ | 9/10 [00:57<00:06,  6.99s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9734, 'compress@10': 0.9042, 'time@10': 9.2348}:  90%|█████████ | 9/10 [01:06<00:06,  6.99s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9734, 'compress@10': 0.9042, 'time@10': 9.2348}: 100%|██████████| 10/10 [01:06<00:00,  7.85s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9734, 'compress@10': 0.9042, 'time@10': 9.2348}: 100%|██████████| 10/10 [01:06<00:00,  6.68s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.014303600560231989
Avg hit ratio: 0.9073192095585985
Avg ndcg: 0.9733598717967432
Avg compression ratio: 0.9042398850355635
Avg train time: 9.234783291816711
Std train time: 2.86809109322001
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9351, 'compress@10': 0.9052, 'time@10': 8.1361}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9351, 'compress@10': 0.9052, 'time@10': 8.1361}:  10%|█         | 1/10 [00:04<00:36,  4.10s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9492, 'compress@10': 0.9042, 'time@10': 7.4655}:  10%|█         | 1/10 [00:10<00:36,  4.10s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9492, 'compress@10': 0.9042, 'time@10': 7.4655}:  20%|██        | 2/10 [00:10<00:45,  5.71s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9185, 'compress@10': 0.9076, 'time@10': 6.6592}:  20%|██        | 2/10 [00:13<00:45,  5.71s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9185, 'compress@10': 0.9076, 'time@10': 6.6592}:  30%|███       | 3/10 [00:13<00:29,  4.27s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.901, 'ndcg@10': 0.93, 'compress@10': 0.9066, 'time@10': 6.5133}:  30%|███       | 3/10 [00:19<00:29,  4.27s/it]   {'epoch': 46, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.901, 'ndcg@10': 0.93, 'compress@10': 0.9066, 'time@10': 6.5133}:  40%|████      | 4/10 [00:19<00:29,  5.00s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9344, 'compress@10': 0.9057, 'time@10': 7.8927}:  40%|████      | 4/10 [00:26<00:29,  5.00s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9344, 'compress@10': 0.9057, 'time@10': 7.8927}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.008, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9413, 'compress@10': 0.9051, 'time@10': 8.2837}:  50%|█████     | 5/10 [00:36<00:28,  5.63s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.008, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9413, 'compress@10': 0.9051, 'time@10': 8.2837}:  60%|██████    | 6/10 [00:36<00:28,  7.21s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.9285, 'ndcg@10': 0.9471, 'compress@10': 0.9049, 'time@10': 8.6534}:  60%|██████    | 6/10 [00:42<00:28,  7.21s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.9285, 'ndcg@10': 0.9471, 'compress@10': 0.9049, 'time@10': 8.6534}:  70%|███████   | 7/10 [00:42<00:19,  6.64s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.9339, 'ndcg@10': 0.9539, 'compress@10': 0.9047, 'time@10': 8.5073}:  70%|███████   | 7/10 [00:49<00:19,  6.64s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.9339, 'ndcg@10': 0.9539, 'compress@10': 0.9047, 'time@10': 8.5073}:  80%|████████  | 8/10 [00:49<00:13,  6.92s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.9158, 'ndcg@10': 0.9697, 'compress@10': 0.9045, 'time@10': 9.1512}:  80%|████████  | 8/10 [00:56<00:13,  6.92s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.9158, 'ndcg@10': 0.9697, 'compress@10': 0.9045, 'time@10': 9.1512}:  90%|█████████ | 9/10 [00:56<00:07,  7.00s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.922, 'ndcg@10': 0.9669, 'compress@10': 0.9042, 'time@10': 9.2035}:  90%|█████████ | 9/10 [01:06<00:07,  7.00s/it]    {'epoch': 46, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.922, 'ndcg@10': 0.9669, 'compress@10': 0.9042, 'time@10': 9.2035}: 100%|██████████| 10/10 [01:06<00:00,  7.84s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.922, 'ndcg@10': 0.9669, 'compress@10': 0.9042, 'time@10': 9.2035}: 100%|██████████| 10/10 [01:06<00:00,  6.65s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.014943175119479696
Avg hit ratio: 0.9219735874387827
Avg ndcg: 0.9668741506049008
Avg compression ratio: 0.9042399034174465
Avg train time: 9.203487634658813
Std train time: 2.910837611714739
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9307, 'compress@10': 0.9052, 'time@10': 8.3982}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9307, 'compress@10': 0.9052, 'time@10': 8.3982}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9523, 'compress@10': 0.9042, 'time@10': 7.6657}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9523, 'compress@10': 0.9042, 'time@10': 7.6657}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9206, 'compress@10': 0.9076, 'time@10': 6.8217}:  20%|██        | 2/10 [00:13<00:46,  5.84s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9206, 'compress@10': 0.9076, 'time@10': 6.8217}:  30%|███       | 3/10 [00:13<00:30,  4.36s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9311, 'compress@10': 0.9066, 'time@10': 6.681}:  30%|███       | 3/10 [00:20<00:30,  4.36s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9311, 'compress@10': 0.9066, 'time@10': 6.681}:  40%|████      | 4/10 [00:20<00:30,  5.13s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9361, 'compress@10': 0.9057, 'time@10': 8.07}:  40%|████      | 4/10 [00:26<00:30,  5.13s/it] {'epoch': 47, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9361, 'compress@10': 0.9057, 'time@10': 8.07}:  50%|█████     | 5/10 [00:26<00:28,  5.75s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0101, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9424, 'compress@10': 0.9051, 'time@10': 8.4336}:  50%|█████     | 5/10 [00:37<00:28,  5.75s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0101, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9424, 'compress@10': 0.9051, 'time@10': 8.4336}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.9446, 'compress@10': 0.9049, 'time@10': 8.8072}:  60%|██████    | 6/10 [00:42<00:29,  7.29s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.9446, 'compress@10': 0.9049, 'time@10': 8.8072}:  70%|███████   | 7/10 [00:42<00:20,  6.73s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.9241, 'ndcg@10': 0.9522, 'compress@10': 0.9047, 'time@10': 8.6292}:  70%|███████   | 7/10 [00:50<00:20,  6.73s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.9241, 'ndcg@10': 0.9522, 'compress@10': 0.9047, 'time@10': 8.6292}:  80%|████████  | 8/10 [00:50<00:13,  6.95s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9521, 'compress@10': 0.9045, 'time@10': 9.2085}:  80%|████████  | 8/10 [00:57<00:13,  6.95s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9521, 'compress@10': 0.9045, 'time@10': 9.2085}:  90%|█████████ | 9/10 [00:57<00:06,  6.95s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.9141, 'ndcg@10': 0.9546, 'compress@10': 0.9042, 'time@10': 9.2614}:  90%|█████████ | 9/10 [01:06<00:06,  6.95s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.9141, 'ndcg@10': 0.9546, 'compress@10': 0.9042, 'time@10': 9.2614}: 100%|██████████| 10/10 [01:06<00:00,  7.82s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.9141, 'ndcg@10': 0.9546, 'compress@10': 0.9042, 'time@10': 9.2614}: 100%|██████████| 10/10 [01:06<00:00,  6.70s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.010875785185125593
Avg hit ratio: 0.9141394860562941
Avg ndcg: 0.9545798567329331
Avg compression ratio: 0.9042398957814294
Avg train time: 9.261373376846313
Std train time: 2.831743289635651
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9247, 'compress@10': 0.9052, 'time@10': 8.0988}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9247, 'compress@10': 0.9052, 'time@10': 8.0988}:  10%|█         | 1/10 [00:04<00:36,  4.09s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9566, 'compress@10': 0.9042, 'time@10': 7.4273}:  10%|█         | 1/10 [00:10<00:36,  4.09s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9566, 'compress@10': 0.9042, 'time@10': 7.4273}:  20%|██        | 2/10 [00:10<00:45,  5.68s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9234, 'compress@10': 0.9076, 'time@10': 6.6451}:  20%|██        | 2/10 [00:13<00:45,  5.68s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9234, 'compress@10': 0.9076, 'time@10': 6.6451}:  30%|███       | 3/10 [00:13<00:29,  4.26s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9321, 'compress@10': 0.9066, 'time@10': 6.4663}:  30%|███       | 3/10 [00:19<00:29,  4.26s/it]  {'epoch': 48, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9321, 'compress@10': 0.9066, 'time@10': 6.4663}:  40%|████      | 4/10 [00:19<00:29,  4.94s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.938, 'compress@10': 0.9057, 'time@10': 7.8562}:  40%|████      | 4/10 [00:26<00:29,  4.94s/it] {'epoch': 48, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.938, 'compress@10': 0.9057, 'time@10': 7.8562}:  50%|█████     | 5/10 [00:26<00:27,  5.59s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9444, 'compress@10': 0.9051, 'time@10': 8.2308}:  50%|█████     | 5/10 [00:36<00:27,  5.59s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9444, 'compress@10': 0.9051, 'time@10': 8.2308}:  60%|██████    | 6/10 [00:36<00:28,  7.14s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9467, 'compress@10': 0.9049, 'time@10': 8.5837}:  60%|██████    | 6/10 [00:41<00:28,  7.14s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9467, 'compress@10': 0.9049, 'time@10': 8.5837}:  70%|███████   | 7/10 [00:41<00:19,  6.56s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0093, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9565, 'compress@10': 0.9047, 'time@10': 8.4273}:  70%|███████   | 7/10 [00:49<00:19,  6.56s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0093, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9565, 'compress@10': 0.9047, 'time@10': 8.4273}:  80%|████████  | 8/10 [00:49<00:13,  6.83s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9662, 'compress@10': 0.9045, 'time@10': 9.0572}:  80%|████████  | 8/10 [00:56<00:13,  6.83s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9662, 'compress@10': 0.9045, 'time@10': 9.0572}:  90%|█████████ | 9/10 [00:56<00:06,  6.91s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9664, 'compress@10': 0.9042, 'time@10': 9.1629}:  90%|█████████ | 9/10 [01:06<00:06,  6.91s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9664, 'compress@10': 0.9042, 'time@10': 9.1629}: 100%|██████████| 10/10 [01:06<00:00,  7.91s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9664, 'compress@10': 0.9042, 'time@10': 9.1629}: 100%|██████████| 10/10 [01:06<00:00,  6.63s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.01093267120482707
Avg hit ratio: 0.896259301724497
Avg ndcg: 0.9663780086125847
Avg compression ratio: 0.9042398883635352
Avg train time: 9.16293020248413
Std train time: 2.8978230403028973
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0071, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9265, 'compress@10': 0.9052, 'time@10': 7.9521}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0071, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9265, 'compress@10': 0.9052, 'time@10': 7.9521}:  10%|█         | 1/10 [00:04<00:36,  4.01s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9471, 'compress@10': 0.9042, 'time@10': 7.3173}:  10%|█         | 1/10 [00:10<00:36,  4.01s/it] {'epoch': 49, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9471, 'compress@10': 0.9042, 'time@10': 7.3173}:  20%|██        | 2/10 [00:10<00:44,  5.61s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9171, 'compress@10': 0.9076, 'time@10': 6.5986}:  20%|██        | 2/10 [00:13<00:44,  5.61s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9171, 'compress@10': 0.9076, 'time@10': 6.5986}:  30%|███       | 3/10 [00:13<00:29,  4.24s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9287, 'compress@10': 0.9066, 'time@10': 6.4921}:  30%|███       | 3/10 [00:19<00:29,  4.24s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9287, 'compress@10': 0.9066, 'time@10': 6.4921}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9356, 'compress@10': 0.9057, 'time@10': 7.8275}:  40%|████      | 4/10 [00:26<00:30,  5.02s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9356, 'compress@10': 0.9057, 'time@10': 7.8275}:  50%|█████     | 5/10 [00:26<00:27,  5.60s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9452, 'compress@10': 0.9051, 'time@10': 8.1554}:  50%|█████     | 5/10 [00:36<00:27,  5.60s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9452, 'compress@10': 0.9051, 'time@10': 8.1554}:  60%|██████    | 6/10 [00:36<00:28,  7.04s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9473, 'compress@10': 0.9049, 'time@10': 8.4794}:  60%|██████    | 6/10 [00:41<00:28,  7.04s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9473, 'compress@10': 0.9049, 'time@10': 8.4794}:  70%|███████   | 7/10 [00:41<00:19,  6.45s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9574, 'compress@10': 0.9047, 'time@10': 8.3311}:  70%|███████   | 7/10 [00:48<00:19,  6.45s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9574, 'compress@10': 0.9047, 'time@10': 8.3311}:  80%|████████  | 8/10 [00:48<00:13,  6.73s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9577, 'compress@10': 0.9045, 'time@10': 8.9467}:  80%|████████  | 8/10 [00:55<00:13,  6.73s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9577, 'compress@10': 0.9045, 'time@10': 8.9467}:  90%|█████████ | 9/10 [00:55<00:06,  6.81s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9606, 'compress@10': 0.9042, 'time@10': 9.0051}:  90%|█████████ | 9/10 [01:05<00:06,  6.81s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9606, 'compress@10': 0.9042, 'time@10': 9.0051}: 100%|██████████| 10/10 [01:05<00:00,  7.66s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9606, 'compress@10': 0.9042, 'time@10': 9.0051}: 100%|██████████| 10/10 [01:05<00:00,  6.51s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.011640375018193596
Avg hit ratio: 0.8945414317808206
Avg ndcg: 0.9606272032773575
Avg compression ratio: 0.904239873946253
Avg train time: 9.005081248283386
Std train time: 2.759771556112374
[0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
