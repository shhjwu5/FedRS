  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1634, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5013, 'compress@10': 0.5263, 'time@10': 9.5547}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1634, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5013, 'compress@10': 0.5263, 'time@10': 9.5547}:  10%|█         | 1/10 [00:04<00:43,  4.82s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1203, 'hit_ratio@10': 0.618, 'ndcg@10': 0.6416, 'compress@10': 0.5212, 'time@10': 8.2729}:  10%|█         | 1/10 [00:11<00:43,  4.82s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.1203, 'hit_ratio@10': 0.618, 'ndcg@10': 0.6416, 'compress@10': 0.5212, 'time@10': 8.2729}:  20%|██        | 2/10 [00:11<00:48,  6.12s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8371, 'hit_ratio@10': 0.412, 'ndcg@10': 0.4277, 'compress@10': 0.538, 'time@10': 6.4497}:  20%|██        | 2/10 [00:13<00:48,  6.12s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.8371, 'hit_ratio@10': 0.412, 'ndcg@10': 0.4277, 'compress@10': 0.538, 'time@10': 6.4497}:  30%|███       | 3/10 [00:13<00:27,  3.98s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.652, 'hit_ratio@10': 0.5054, 'ndcg@10': 0.4812, 'compress@10': 0.5329, 'time@10': 6.5064}:  30%|███       | 3/10 [00:20<00:27,  3.98s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.652, 'hit_ratio@10': 0.5054, 'ndcg@10': 0.4812, 'compress@10': 0.5329, 'time@10': 6.5064}:  40%|████      | 4/10 [00:20<00:30,  5.06s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5402, 'hit_ratio@10': 0.5683, 'ndcg@10': 0.5376, 'compress@10': 0.5283, 'time@10': 9.924}:  40%|████      | 4/10 [00:31<00:30,  5.06s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5402, 'hit_ratio@10': 0.5683, 'ndcg@10': 0.5376, 'compress@10': 0.5283, 'time@10': 9.924}:  50%|█████     | 5/10 [00:31<00:37,  7.51s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4647, 'hit_ratio@10': 0.5921, 'ndcg@10': 0.5811, 'compress@10': 0.5255, 'time@10': 10.0361}:  50%|█████     | 5/10 [00:42<00:37,  7.51s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4647, 'hit_ratio@10': 0.5921, 'ndcg@10': 0.5811, 'compress@10': 0.5255, 'time@10': 10.0361}:  60%|██████    | 6/10 [00:42<00:34,  8.57s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4135, 'hit_ratio@10': 0.6161, 'ndcg@10': 0.5827, 'compress@10': 0.5247, 'time@10': 10.2399}:  60%|██████    | 6/10 [00:48<00:34,  8.57s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4135, 'hit_ratio@10': 0.6161, 'ndcg@10': 0.5827, 'compress@10': 0.5247, 'time@10': 10.2399}:  70%|███████   | 7/10 [00:48<00:22,  7.65s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3681, 'hit_ratio@10': 0.6534, 'ndcg@10': 0.6064, 'compress@10': 0.5234, 'time@10': 9.9818}:  70%|███████   | 7/10 [00:56<00:22,  7.65s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.3681, 'hit_ratio@10': 0.6534, 'ndcg@10': 0.6064, 'compress@10': 0.5234, 'time@10': 9.9818}:  80%|████████  | 8/10 [00:56<00:15,  7.83s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3333, 'hit_ratio@10': 0.6602, 'ndcg@10': 0.6392, 'compress@10': 0.5224, 'time@10': 10.707}:  80%|████████  | 8/10 [01:04<00:15,  7.83s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3333, 'hit_ratio@10': 0.6602, 'ndcg@10': 0.6392, 'compress@10': 0.5224, 'time@10': 10.707}:  90%|█████████ | 9/10 [01:04<00:07,  7.98s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3053, 'hit_ratio@10': 0.6873, 'ndcg@10': 0.6601, 'compress@10': 0.5213, 'time@10': 10.6911}:  90%|█████████ | 9/10 [01:15<00:07,  7.98s/it]  {'epoch': 0, 'num_users': 6.3, 'loss': 0.3053, 'hit_ratio@10': 0.6873, 'ndcg@10': 0.6601, 'compress@10': 0.5213, 'time@10': 10.6911}: 100%|██████████| 10/10 [01:15<00:00,  8.78s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3053, 'hit_ratio@10': 0.6873, 'ndcg@10': 0.6601, 'compress@10': 0.5213, 'time@10': 10.6911}: 100%|██████████| 10/10 [01:15<00:00,  7.53s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.30527714879893886
Avg hit ratio: 0.687320821604353
Avg ndcg: 0.6600525511439876
Avg compression ratio: 0.5212749006657823
Avg train time: 10.691144323348999
Std train time: 5.482709451066018
[0.75, 0.25, 0.75, 0.75, 0.75, 0.25, 0.75, 0.25, 0.25, 0.25]
[10, 11, 12, 11, 6, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0527, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8459, 'compress@10': 0.7632, 'time@10': 9.1663}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0527, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8459, 'compress@10': 0.7632, 'time@10': 9.1663}:  10%|█         | 1/10 [00:04<00:41,  4.63s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0526, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8512, 'compress@10': 0.5187, 'time@10': 8.4959}:  10%|█         | 1/10 [00:12<00:41,  4.63s/it] {'epoch': 1, 'num_users': 7.0, 'loss': 0.0526, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8512, 'compress@10': 0.5187, 'time@10': 8.4959}:  20%|██        | 2/10 [00:12<00:52,  6.53s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0401, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8299, 'compress@10': 0.6077, 'time@10': 6.774}:  20%|██        | 2/10 [00:14<00:52,  6.53s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0401, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8299, 'compress@10': 0.6077, 'time@10': 6.774}:  30%|███       | 3/10 [00:14<00:30,  4.33s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0425, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8331, 'compress@10': 0.6455, 'time@10': 6.7687}:  30%|███       | 3/10 [00:20<00:30,  4.33s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0425, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8331, 'compress@10': 0.6455, 'time@10': 6.7687}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0526, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8167, 'compress@10': 0.6674, 'time@10': 8.2483}:  40%|████      | 4/10 [00:28<00:31,  5.30s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0526, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8167, 'compress@10': 0.6674, 'time@10': 8.2483}:  50%|█████     | 5/10 [00:28<00:29,  5.96s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0567, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8156, 'compress@10': 0.6006, 'time@10': 8.6113}:  50%|█████     | 5/10 [00:38<00:29,  5.96s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0567, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8156, 'compress@10': 0.6006, 'time@10': 8.6113}:  60%|██████    | 6/10 [00:38<00:29,  7.49s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0547, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8226, 'compress@10': 0.6234, 'time@10': 9.0347}:  60%|██████    | 6/10 [00:44<00:29,  7.49s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0547, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8226, 'compress@10': 0.6234, 'time@10': 9.0347}:  70%|███████   | 7/10 [00:44<00:20,  6.94s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0525, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8294, 'compress@10': 0.5794, 'time@10': 8.9858}:  70%|███████   | 7/10 [00:53<00:20,  6.94s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0525, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8294, 'compress@10': 0.5794, 'time@10': 8.9858}:  80%|████████  | 8/10 [00:53<00:14,  7.50s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0507, 'hit_ratio@10': 0.8161, 'ndcg@10': 0.8388, 'compress@10': 0.5452, 'time@10': 9.4112}:  80%|████████  | 8/10 [00:59<00:14,  7.50s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0507, 'hit_ratio@10': 0.8161, 'ndcg@10': 0.8388, 'compress@10': 0.5452, 'time@10': 9.4112}:  90%|█████████ | 9/10 [00:59<00:07,  7.17s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0503, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8398, 'compress@10': 0.5174, 'time@10': 9.4854}:  90%|█████████ | 9/10 [01:09<00:07,  7.17s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0503, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8398, 'compress@10': 0.5174, 'time@10': 9.4854}: 100%|██████████| 10/10 [01:09<00:00,  8.11s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0503, 'hit_ratio@10': 0.8277, 'ndcg@10': 0.8398, 'compress@10': 0.5174, 'time@10': 9.4854}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.050328014762707186
Avg hit ratio: 0.8276791097979552
Avg ndcg: 0.8398196209962657
Avg compression ratio: 0.5173535940323687
Avg train time: 9.48539650440216
Std train time: 2.9600277414417135
[0.8333333333333334, 0.5, 0.5, 0.8333333333333334, 0.8333333333333334, 0.5, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[10, 12, 14, 12, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.8421, 'time@10': 9.2736}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.8421, 'time@10': 9.2736}:  10%|█         | 1/10 [00:04<00:42,  4.67s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8475, 'compress@10': 0.6791, 'time@10': 8.9525}:  10%|█         | 1/10 [00:13<00:42,  4.67s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8475, 'compress@10': 0.6791, 'time@10': 8.9525}:  20%|██        | 2/10 [00:13<00:56,  7.02s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8507, 'compress@10': 0.6432, 'time@10': 7.3328}:  20%|██        | 2/10 [00:15<00:56,  7.02s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8507, 'compress@10': 0.6432, 'time@10': 7.3328}:  30%|███       | 3/10 [00:15<00:33,  4.78s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8466, 'compress@10': 0.6922, 'time@10': 7.3263}:  30%|███       | 3/10 [00:22<00:33,  4.78s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8466, 'compress@10': 0.6922, 'time@10': 7.3263}:  40%|████      | 4/10 [00:22<00:34,  5.79s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0494, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8284, 'compress@10': 0.7211, 'time@10': 8.1184}:  40%|████      | 4/10 [00:28<00:34,  5.79s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0494, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8284, 'compress@10': 0.7211, 'time@10': 8.1184}:  50%|█████     | 5/10 [00:28<00:28,  5.75s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0538, 'hit_ratio@10': 0.784, 'ndcg@10': 0.827, 'compress@10': 0.6861, 'time@10': 8.5607}:  50%|█████     | 5/10 [00:39<00:28,  5.75s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0538, 'hit_ratio@10': 0.784, 'ndcg@10': 0.827, 'compress@10': 0.6861, 'time@10': 8.5607}:  60%|██████    | 6/10 [00:39<00:29,  7.47s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0521, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8316, 'compress@10': 0.6624, 'time@10': 8.9933}:  60%|██████    | 6/10 [00:45<00:29,  7.47s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0521, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8316, 'compress@10': 0.6624, 'time@10': 8.9933}:  70%|███████   | 7/10 [00:45<00:20,  6.94s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0541, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8451, 'compress@10': 0.6034, 'time@10': 9.0458}:  70%|███████   | 7/10 [00:54<00:20,  6.94s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0541, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8451, 'compress@10': 0.6034, 'time@10': 9.0458}:  80%|████████  | 8/10 [00:54<00:15,  7.74s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0523, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8541, 'compress@10': 0.5575, 'time@10': 9.2377}:  80%|████████  | 8/10 [00:59<00:15,  7.74s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0523, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8541, 'compress@10': 0.5575, 'time@10': 9.2377}:  90%|█████████ | 9/10 [00:59<00:07,  7.01s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0516, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.854, 'compress@10': 0.5203, 'time@10': 9.3105}:  90%|█████████ | 9/10 [01:09<00:07,  7.01s/it]    {'epoch': 2, 'num_users': 6.3, 'loss': 0.0516, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.854, 'compress@10': 0.5203, 'time@10': 9.3105}: 100%|██████████| 10/10 [01:09<00:00,  7.94s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0516, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.854, 'compress@10': 0.5203, 'time@10': 9.3105}: 100%|██████████| 10/10 [01:09<00:00,  7.00s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.05163693629914211
Avg hit ratio: 0.8224128527575048
Avg ndcg: 0.8540481119558485
Avg compression ratio: 0.520325870796668
Avg train time: 9.310521006584167
Std train time: 2.133262081126665
[0.625, 0.625, 0.375, 0.875, 0.875, 0.625, 0.375, 0.375, 0.125, 0.125]
[10, 13, 16, 13, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8533, 'compress@10': 0.6447, 'time@10': 9.592}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8533, 'compress@10': 0.6447, 'time@10': 9.592}:  10%|█         | 1/10 [00:04<00:43,  4.83s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8549, 'compress@10': 0.6409, 'time@10': 9.6984}:  10%|█         | 1/10 [00:14<00:43,  4.83s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8549, 'compress@10': 0.6409, 'time@10': 9.6984}:  20%|██        | 2/10 [00:14<01:02,  7.78s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8556, 'compress@10': 0.582, 'time@10': 7.9544}:  20%|██        | 2/10 [00:16<01:02,  7.78s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8556, 'compress@10': 0.582, 'time@10': 7.9544}:  30%|███       | 3/10 [00:16<00:36,  5.27s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.859, 'compress@10': 0.6564, 'time@10': 7.9811}:  30%|███       | 3/10 [00:25<00:36,  5.27s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.859, 'compress@10': 0.6564, 'time@10': 7.9811}:  40%|████      | 4/10 [00:25<00:38,  6.39s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.049, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8399, 'compress@10': 0.7006, 'time@10': 8.57}:  40%|████      | 4/10 [00:30<00:38,  6.39s/it]  {'epoch': 3, 'num_users': 5.8, 'loss': 0.049, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8399, 'compress@10': 0.7006, 'time@10': 8.57}:  50%|█████     | 5/10 [00:30<00:30,  6.07s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0526, 'hit_ratio@10': 0.7817, 'ndcg@10': 0.8375, 'compress@10': 0.6894, 'time@10': 8.9092}:  50%|█████     | 5/10 [00:41<00:30,  6.07s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0526, 'hit_ratio@10': 0.7817, 'ndcg@10': 0.8375, 'compress@10': 0.6894, 'time@10': 8.9092}:  60%|██████    | 6/10 [00:41<00:30,  7.63s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0517, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8411, 'compress@10': 0.6481, 'time@10': 9.2835}:  60%|██████    | 6/10 [00:47<00:30,  7.63s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0517, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8411, 'compress@10': 0.6481, 'time@10': 9.2835}:  70%|███████   | 7/10 [00:47<00:21,  7.04s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0524, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8393, 'compress@10': 0.6162, 'time@10': 9.3422}:  70%|███████   | 7/10 [00:56<00:21,  7.04s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0524, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8393, 'compress@10': 0.6162, 'time@10': 9.3422}:  80%|████████  | 8/10 [00:56<00:15,  7.92s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0516, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.849, 'compress@10': 0.5644, 'time@10': 9.5309}:  80%|████████  | 8/10 [01:02<00:15,  7.92s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0516, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.849, 'compress@10': 0.5644, 'time@10': 9.5309}:  90%|█████████ | 9/10 [01:02<00:07,  7.18s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8483, 'compress@10': 0.5224, 'time@10': 9.5184}:  90%|█████████ | 9/10 [01:11<00:07,  7.18s/it]  {'epoch': 3, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8483, 'compress@10': 0.5224, 'time@10': 9.5184}: 100%|██████████| 10/10 [01:11<00:00,  7.88s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.8483, 'compress@10': 0.5224, 'time@10': 9.5184}: 100%|██████████| 10/10 [01:11<00:00,  7.18s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.05109749342342022
Avg hit ratio: 0.829635074979727
Avg ndcg: 0.8482514012252225
Avg compression ratio: 0.5224132353796532
Avg train time: 9.518366980552674
Std train time: 1.9319395313275916
[0.5, 0.7, 0.3, 0.9, 0.9, 0.7, 0.3, 0.5, 0.1, 0.1]
[10, 13, 18, 14, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.5263, 'time@10': 9.0985}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.5263, 'time@10': 9.0985}:  10%|█         | 1/10 [00:04<00:41,  4.59s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0456, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8614, 'compress@10': 0.618, 'time@10': 9.2673}:  10%|█         | 1/10 [00:14<00:41,  4.59s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0456, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8614, 'compress@10': 0.618, 'time@10': 9.2673}:  20%|██        | 2/10 [00:14<00:59,  7.46s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.86, 'compress@10': 0.5453, 'time@10': 7.855}:  20%|██        | 2/10 [00:16<00:59,  7.46s/it]  {'epoch': 4, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.86, 'compress@10': 0.5453, 'time@10': 7.855}:  30%|███       | 3/10 [00:16<00:36,  5.22s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8667, 'compress@10': 0.6349, 'time@10': 8.0521}:  30%|███       | 3/10 [00:25<00:36,  5.22s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8667, 'compress@10': 0.6349, 'time@10': 8.0521}:  40%|████      | 4/10 [00:25<00:39,  6.59s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.048, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8473, 'compress@10': 0.6883, 'time@10': 8.714}:  40%|████      | 4/10 [00:31<00:39,  6.59s/it] {'epoch': 4, 'num_users': 5.8, 'loss': 0.048, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8473, 'compress@10': 0.6883, 'time@10': 8.714}:  50%|█████     | 5/10 [00:31<00:31,  6.27s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0509, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8434, 'compress@10': 0.6914, 'time@10': 9.0255}:  50%|█████     | 5/10 [00:41<00:31,  6.27s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0509, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8434, 'compress@10': 0.6914, 'time@10': 9.0255}:  60%|██████    | 6/10 [00:41<00:31,  7.75s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0494, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8462, 'compress@10': 0.6395, 'time@10': 9.3958}:  60%|██████    | 6/10 [00:47<00:31,  7.75s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0494, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8462, 'compress@10': 0.6395, 'time@10': 9.3958}:  70%|███████   | 7/10 [00:47<00:21,  7.13s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0486, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8399, 'compress@10': 0.6238, 'time@10': 9.4547}:  70%|███████   | 7/10 [00:57<00:21,  7.13s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0486, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8399, 'compress@10': 0.6238, 'time@10': 9.4547}:  80%|████████  | 8/10 [00:57<00:16,  8.01s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0483, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.851, 'compress@10': 0.5685, 'time@10': 9.6303}:  80%|████████  | 8/10 [01:02<00:16,  8.01s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0483, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.851, 'compress@10': 0.5685, 'time@10': 9.6303}:  90%|█████████ | 9/10 [01:02<00:07,  7.24s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.048, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8515, 'compress@10': 0.5237, 'time@10': 9.5953}:  90%|█████████ | 9/10 [01:12<00:07,  7.24s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.048, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8515, 'compress@10': 0.5237, 'time@10': 9.5953}: 100%|██████████| 10/10 [01:12<00:00,  7.88s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.048, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8515, 'compress@10': 0.5237, 'time@10': 9.5953}: 100%|██████████| 10/10 [01:12<00:00,  7.23s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.048008689096468896
Avg hit ratio: 0.8616545322249907
Avg ndcg: 0.8514902936708152
Avg compression ratio: 0.5236658770189438
Avg train time: 9.59532971382141
Std train time: 1.8013005145045777
[0.5833333333333334, 0.5833333333333333, 0.25, 0.9166666666666667, 0.9166666666666667, 0.75, 0.25, 0.4166666666666667, 0.25, 0.08333333333333334]
[10, 13, 20, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8357, 'compress@10': 0.6053, 'time@10': 8.6781}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8357, 'compress@10': 0.6053, 'time@10': 8.6781}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.798, 'ndcg@10': 0.86, 'compress@10': 0.601, 'time@10': 9.107}:  10%|█         | 1/10 [00:13<00:39,  4.38s/it]     {'epoch': 5, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.798, 'ndcg@10': 0.86, 'compress@10': 0.601, 'time@10': 9.107}:  20%|██        | 2/10 [00:13<00:59,  7.43s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.859, 'compress@10': 0.5197, 'time@10': 7.9231}:  20%|██        | 2/10 [00:16<00:59,  7.43s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.859, 'compress@10': 0.5197, 'time@10': 7.9231}:  30%|███       | 3/10 [00:16<00:37,  5.32s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8599, 'compress@10': 0.6197, 'time@10': 8.3613}:  30%|███       | 3/10 [00:26<00:37,  5.32s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8599, 'compress@10': 0.6197, 'time@10': 8.3613}:  40%|████      | 4/10 [00:26<00:42,  7.06s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0461, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.843, 'compress@10': 0.6794, 'time@10': 8.8921}:  40%|████      | 4/10 [00:32<00:42,  7.06s/it] {'epoch': 5, 'num_users': 5.8, 'loss': 0.0461, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.843, 'compress@10': 0.6794, 'time@10': 8.8921}:  50%|█████     | 5/10 [00:32<00:32,  6.51s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0485, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.8404, 'compress@10': 0.6921, 'time@10': 9.1314}:  50%|█████     | 5/10 [00:42<00:32,  6.51s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0485, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.8404, 'compress@10': 0.6921, 'time@10': 9.1314}:  60%|██████    | 6/10 [00:42<00:31,  7.82s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0476, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8466, 'compress@10': 0.6332, 'time@10': 9.4463}:  60%|██████    | 6/10 [00:48<00:31,  7.82s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0476, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8466, 'compress@10': 0.6332, 'time@10': 9.4463}:  70%|███████   | 7/10 [00:48<00:21,  7.13s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0472, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8537, 'compress@10': 0.6082, 'time@10': 9.4498}:  70%|███████   | 7/10 [00:57<00:21,  7.13s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0472, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8537, 'compress@10': 0.6082, 'time@10': 9.4498}:  80%|████████  | 8/10 [00:57<00:15,  7.89s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0465, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8627, 'compress@10': 0.5708, 'time@10': 9.6407}:  80%|████████  | 8/10 [01:03<00:15,  7.89s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0465, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8627, 'compress@10': 0.5708, 'time@10': 9.6407}:  90%|█████████ | 9/10 [01:03<00:07,  7.18s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.046, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8621, 'compress@10': 0.5242, 'time@10': 9.6357}:  90%|█████████ | 9/10 [01:12<00:07,  7.18s/it]    {'epoch': 5, 'num_users': 6.3, 'loss': 0.046, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8621, 'compress@10': 0.5242, 'time@10': 9.6357}: 100%|██████████| 10/10 [01:12<00:00,  7.94s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.046, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8621, 'compress@10': 0.5242, 'time@10': 9.6357}: 100%|██████████| 10/10 [01:12<00:00,  7.29s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.045995103936366695
Avg hit ratio: 0.8495679986868442
Avg ndcg: 0.8620863453446483
Avg compression ratio: 0.5241596454936007
Avg train time: 9.635695028305054
Std train time: 1.5882615623433363
[0.6428571428571429, 0.49999999999999994, 0.2142857142857143, 0.9285714285714286, 0.9285714285714286, 0.7857142857142857, 0.2142857142857143, 0.5, 0.2142857142857143, 0.07142857142857144]
[11, 13, 21, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.6616, 'time@10': 9.3697}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.6616, 'time@10': 9.3697}:  10%|█         | 1/10 [00:04<00:42,  4.72s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8627, 'compress@10': 0.5889, 'time@10': 9.4553}:  10%|█         | 1/10 [00:14<00:42,  4.72s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8627, 'compress@10': 0.5889, 'time@10': 9.4553}:  20%|██        | 2/10 [00:14<01:00,  7.58s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8608, 'compress@10': 0.5014, 'time@10': 8.1867}:  20%|██        | 2/10 [00:17<01:00,  7.58s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8608, 'compress@10': 0.5014, 'time@10': 8.1867}:  30%|███       | 3/10 [00:17<00:37,  5.42s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0464, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8903, 'compress@10': 0.6089, 'time@10': 8.4919}:  30%|███       | 3/10 [00:26<00:37,  5.42s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0464, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8903, 'compress@10': 0.6089, 'time@10': 8.4919}:  40%|████      | 4/10 [00:26<00:42,  7.01s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0546, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8665, 'compress@10': 0.6731, 'time@10': 9.0581}:  40%|████      | 4/10 [00:32<00:42,  7.01s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0546, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8665, 'compress@10': 0.6731, 'time@10': 9.0581}:  50%|█████     | 5/10 [00:32<00:32,  6.54s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0546, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.8612, 'compress@10': 0.6926, 'time@10': 9.2859}:  50%|█████     | 5/10 [00:42<00:32,  6.54s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0546, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.8612, 'compress@10': 0.6926, 'time@10': 9.2859}:  60%|██████    | 6/10 [00:42<00:31,  7.87s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0536, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.863, 'compress@10': 0.6288, 'time@10': 9.5638}:  60%|██████    | 6/10 [00:48<00:31,  7.87s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.0536, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.863, 'compress@10': 0.6288, 'time@10': 9.5638}:  70%|███████   | 7/10 [00:48<00:21,  7.15s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0549, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.8684, 'compress@10': 0.6145, 'time@10': 9.5739}:  70%|███████   | 7/10 [00:58<00:21,  7.15s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0549, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.8684, 'compress@10': 0.6145, 'time@10': 9.5739}:  80%|████████  | 8/10 [00:58<00:15,  7.95s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0534, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8746, 'compress@10': 0.5725, 'time@10': 9.7721}:  80%|████████  | 8/10 [01:03<00:15,  7.95s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0534, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8746, 'compress@10': 0.5725, 'time@10': 9.7721}:  90%|█████████ | 9/10 [01:03<00:07,  7.25s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0522, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8756, 'compress@10': 0.5245, 'time@10': 9.7238}:  90%|█████████ | 9/10 [01:13<00:07,  7.25s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0522, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8756, 'compress@10': 0.5245, 'time@10': 9.7238}: 100%|██████████| 10/10 [01:13<00:00,  7.90s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0522, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8756, 'compress@10': 0.5245, 'time@10': 9.7238}: 100%|██████████| 10/10 [01:13<00:00,  7.32s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.05223740615043169
Avg hit ratio: 0.8594749483679873
Avg ndcg: 0.8756124832853545
Avg compression ratio: 0.5245140927516465
Avg train time: 9.723843455314636
Std train time: 1.5825944153947502
[0.6875, 0.43749999999999994, 0.1875, 0.9375, 0.9375, 0.8125, 0.1875, 0.5625, 0.1875, 0.06250000000000001]
[11, 13, 22, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8382, 'compress@10': 0.7039, 'time@10': 9.4333}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8382, 'compress@10': 0.7039, 'time@10': 9.4333}:  10%|█         | 1/10 [00:04<00:42,  4.76s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8589, 'compress@10': 0.5798, 'time@10': 9.4115}:  10%|█         | 1/10 [00:14<00:42,  4.76s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8589, 'compress@10': 0.5798, 'time@10': 9.4115}:  20%|██        | 2/10 [00:14<01:00,  7.50s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8583, 'compress@10': 0.4877, 'time@10': 8.3109}:  20%|██        | 2/10 [00:17<01:00,  7.50s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8583, 'compress@10': 0.4877, 'time@10': 8.3109}:  30%|███       | 3/10 [00:17<00:38,  5.49s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8548, 'compress@10': 0.6007, 'time@10': 8.5522}:  30%|███       | 3/10 [00:26<00:38,  5.49s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8548, 'compress@10': 0.6007, 'time@10': 8.5522}:  40%|████      | 4/10 [00:26<00:41,  7.00s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0423, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8388, 'compress@10': 0.6683, 'time@10': 9.1359}:  40%|████      | 4/10 [00:32<00:41,  7.00s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0423, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8388, 'compress@10': 0.6683, 'time@10': 9.1359}:  50%|█████     | 5/10 [00:32<00:32,  6.56s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0436, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8397, 'compress@10': 0.693, 'time@10': 9.3116}:  50%|█████     | 5/10 [00:42<00:32,  6.56s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0436, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8397, 'compress@10': 0.693, 'time@10': 9.3116}:  60%|██████    | 6/10 [00:42<00:31,  7.80s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0438, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8398, 'compress@10': 0.6255, 'time@10': 9.5599}:  60%|██████    | 6/10 [00:48<00:31,  7.80s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0438, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8398, 'compress@10': 0.6255, 'time@10': 9.5599}:  70%|███████   | 7/10 [00:48<00:21,  7.07s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0428, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.8373, 'compress@10': 0.6192, 'time@10': 9.5745}:  70%|███████   | 7/10 [00:57<00:21,  7.07s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0428, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.8373, 'compress@10': 0.6192, 'time@10': 9.5745}:  80%|████████  | 8/10 [00:57<00:15,  7.91s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0429, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8457, 'compress@10': 0.5738, 'time@10': 9.7569}:  80%|████████  | 8/10 [01:03<00:15,  7.91s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0429, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8457, 'compress@10': 0.5738, 'time@10': 9.7569}:  90%|█████████ | 9/10 [01:03<00:07,  7.20s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0425, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.8478, 'compress@10': 0.5248, 'time@10': 9.7077}:  90%|█████████ | 9/10 [01:12<00:07,  7.20s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0425, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.8478, 'compress@10': 0.5248, 'time@10': 9.7077}: 100%|██████████| 10/10 [01:12<00:00,  7.85s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0425, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.8478, 'compress@10': 0.5248, 'time@10': 9.7077}: 100%|██████████| 10/10 [01:12<00:00,  7.28s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04252109397194181
Avg hit ratio: 0.8787497703202287
Avg ndcg: 0.8478215891713816
Avg compression ratio: 0.5247805666841361
Avg train time: 9.707689261436462
Std train time: 1.4463848579914222
[0.7222222222222222, 0.38888888888888884, 0.16666666666666666, 0.8333333333333334, 0.9444444444444444, 0.8333333333333334, 0.2777777777777778, 0.5, 0.2777777777777778, 0.055555555555555566]
[11, 13, 23, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0464, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8736, 'compress@10': 0.7368, 'time@10': 9.2035}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0464, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8736, 'compress@10': 0.7368, 'time@10': 9.2035}:  10%|█         | 1/10 [00:04<00:41,  4.64s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8851, 'compress@10': 0.5727, 'time@10': 9.1509}:  10%|█         | 1/10 [00:13<00:41,  4.64s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8851, 'compress@10': 0.5727, 'time@10': 9.1509}:  20%|██        | 2/10 [00:13<00:58,  7.29s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8758, 'compress@10': 0.4771, 'time@10': 8.1985}:  20%|██        | 2/10 [00:16<00:58,  7.29s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8758, 'compress@10': 0.4771, 'time@10': 8.1985}:  30%|███       | 3/10 [00:16<00:37,  5.42s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8784, 'compress@10': 0.5676, 'time@10': 8.4854}:  30%|███       | 3/10 [00:26<00:37,  5.42s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8784, 'compress@10': 0.5676, 'time@10': 8.4854}:  40%|████      | 4/10 [00:26<00:41,  6.98s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0399, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8601, 'compress@10': 0.6432, 'time@10': 9.033}:  40%|████      | 4/10 [00:32<00:41,  6.98s/it] {'epoch': 8, 'num_users': 5.8, 'loss': 0.0399, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8601, 'compress@10': 0.6432, 'time@10': 9.033}:  50%|█████     | 5/10 [00:32<00:32,  6.50s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0407, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8581, 'compress@10': 0.6755, 'time@10': 9.2357}:  50%|█████     | 5/10 [00:42<00:32,  6.50s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0407, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8581, 'compress@10': 0.6755, 'time@10': 9.2357}:  60%|██████    | 6/10 [00:42<00:31,  7.79s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0404, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8644, 'compress@10': 0.6228, 'time@10': 9.5209}:  60%|██████    | 6/10 [00:47<00:31,  7.79s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0404, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8644, 'compress@10': 0.6228, 'time@10': 9.5209}:  70%|███████   | 7/10 [00:47<00:21,  7.10s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0396, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8682, 'compress@10': 0.6092, 'time@10': 9.5859}:  70%|███████   | 7/10 [00:58<00:21,  7.10s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0396, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8682, 'compress@10': 0.6092, 'time@10': 9.5859}:  80%|████████  | 8/10 [00:58<00:16,  8.04s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0401, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8735, 'compress@10': 0.5747, 'time@10': 9.7213}:  80%|████████  | 8/10 [01:03<00:16,  8.04s/it] {'epoch': 8, 'num_users': 6.3333, 'loss': 0.0401, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8735, 'compress@10': 0.5747, 'time@10': 9.7213}:  90%|█████████ | 9/10 [01:03<00:07,  7.23s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0387, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.876, 'compress@10': 0.5249, 'time@10': 9.6849}:  90%|█████████ | 9/10 [01:12<00:07,  7.23s/it]  {'epoch': 8, 'num_users': 6.3, 'loss': 0.0387, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.876, 'compress@10': 0.5249, 'time@10': 9.6849}: 100%|██████████| 10/10 [01:12<00:00,  7.90s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0387, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.876, 'compress@10': 0.5249, 'time@10': 9.6849}: 100%|██████████| 10/10 [01:12<00:00,  7.29s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.03866305694985688
Avg hit ratio: 0.862720212064864
Avg ndcg: 0.8760328290932421
Avg compression ratio: 0.5249386272193085
Avg train time: 9.684903049468994
Std train time: 1.369579230456178
[0.75, 0.35, 0.15, 0.8500000000000001, 0.95, 0.8500000000000001, 0.25, 0.45, 0.35, 0.05000000000000001]
[11, 13, 24, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8508, 'compress@10': 0.7632, 'time@10': 9.5224}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8508, 'compress@10': 0.7632, 'time@10': 9.5224}:  10%|█         | 1/10 [00:04<00:43,  4.80s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0393, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8767, 'compress@10': 0.5671, 'time@10': 9.4114}:  10%|█         | 1/10 [00:14<00:43,  4.80s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0393, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8767, 'compress@10': 0.5671, 'time@10': 9.4114}:  20%|██        | 2/10 [00:14<00:59,  7.47s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8702, 'compress@10': 0.4685, 'time@10': 8.4371}:  20%|██        | 2/10 [00:17<00:59,  7.47s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8702, 'compress@10': 0.4685, 'time@10': 8.4371}:  30%|███       | 3/10 [00:17<00:38,  5.56s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8908, 'compress@10': 0.5652, 'time@10': 8.6992}:  30%|███       | 3/10 [00:26<00:38,  5.56s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8908, 'compress@10': 0.5652, 'time@10': 8.6992}:  40%|████      | 4/10 [00:26<00:42,  7.12s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0403, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8693, 'compress@10': 0.6424, 'time@10': 9.2466}:  40%|████      | 4/10 [00:32<00:42,  7.12s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0403, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8693, 'compress@10': 0.6424, 'time@10': 9.2466}:  50%|█████     | 5/10 [00:32<00:33,  6.63s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0407, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.8672, 'compress@10': 0.6775, 'time@10': 9.4166}:  50%|█████     | 5/10 [00:42<00:33,  6.63s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0407, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.8672, 'compress@10': 0.6775, 'time@10': 9.4166}:  60%|██████    | 6/10 [00:42<00:31,  7.88s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0406, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8718, 'compress@10': 0.6207, 'time@10': 9.6564}:  60%|██████    | 6/10 [00:48<00:31,  7.88s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0406, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8718, 'compress@10': 0.6207, 'time@10': 9.6564}:  70%|███████   | 7/10 [00:48<00:21,  7.13s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0426, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8845, 'compress@10': 0.6014, 'time@10': 9.6627}:  70%|███████   | 7/10 [00:58<00:21,  7.13s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0426, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8845, 'compress@10': 0.6014, 'time@10': 9.6627}:  80%|████████  | 8/10 [00:58<00:15,  7.96s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0432, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.891, 'compress@10': 0.5755, 'time@10': 9.8527}:  80%|████████  | 8/10 [01:04<00:15,  7.96s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0432, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.891, 'compress@10': 0.5755, 'time@10': 9.8527}:  90%|█████████ | 9/10 [01:04<00:07,  7.26s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0432, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8869, 'compress@10': 0.5251, 'time@10': 9.7959}:  90%|█████████ | 9/10 [01:13<00:07,  7.26s/it]  {'epoch': 9, 'num_users': 6.3, 'loss': 0.0432, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8869, 'compress@10': 0.5251, 'time@10': 9.7959}: 100%|██████████| 10/10 [01:13<00:00,  7.90s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0432, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8869, 'compress@10': 0.5251, 'time@10': 9.7959}: 100%|██████████| 10/10 [01:13<00:00,  7.34s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.043237409153496484
Avg hit ratio: 0.8553875769580352
Avg ndcg: 0.8868822434262542
Avg compression ratio: 0.5251091491439983
Avg train time: 9.795887017250061
Std train time: 1.3678924721336605
[0.7727272727272727, 0.3181818181818182, 0.13636363636363635, 0.7727272727272728, 0.9545454545454545, 0.7727272727272728, 0.22727272727272727, 0.5, 0.40909090909090906, 0.13636363636363638]
[11, 13, 25, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.878, 'compress@10': 0.7847, 'time@10': 9.197}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.878, 'compress@10': 0.7847, 'time@10': 9.197}:  10%|█         | 1/10 [00:04<00:41,  4.63s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.034, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8959, 'compress@10': 0.5624, 'time@10': 9.1679}:  10%|█         | 1/10 [00:13<00:41,  4.63s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.034, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8959, 'compress@10': 0.5624, 'time@10': 9.1679}:  20%|██        | 2/10 [00:13<00:58,  7.31s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.744, 'ndcg@10': 0.883, 'compress@10': 0.4615, 'time@10': 8.4092}:  20%|██        | 2/10 [00:17<00:58,  7.31s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.744, 'ndcg@10': 0.883, 'compress@10': 0.4615, 'time@10': 8.4092}:  30%|███       | 3/10 [00:17<00:38,  5.56s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8938, 'compress@10': 0.5414, 'time@10': 8.6738}:  30%|███       | 3/10 [00:26<00:38,  5.56s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8938, 'compress@10': 0.5414, 'time@10': 8.6738}:  40%|████      | 4/10 [00:26<00:42,  7.12s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0351, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8723, 'compress@10': 0.6242, 'time@10': 9.198}:  40%|████      | 4/10 [00:32<00:42,  7.12s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0351, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8723, 'compress@10': 0.6242, 'time@10': 9.198}:  50%|█████     | 5/10 [00:32<00:33,  6.60s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0368, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8693, 'compress@10': 0.6498, 'time@10': 9.4319}:  50%|█████     | 5/10 [00:43<00:33,  6.60s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0368, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8693, 'compress@10': 0.6498, 'time@10': 9.4319}:  60%|██████    | 6/10 [00:43<00:31,  7.97s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0373, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8694, 'compress@10': 0.5938, 'time@10': 9.7192}:  60%|██████    | 6/10 [00:48<00:31,  7.97s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0373, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8694, 'compress@10': 0.5938, 'time@10': 9.7192}:  70%|███████   | 7/10 [00:48<00:21,  7.25s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0366, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8718, 'compress@10': 0.5839, 'time@10': 9.7008}:  70%|███████   | 7/10 [00:58<00:21,  7.25s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0366, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8718, 'compress@10': 0.5839, 'time@10': 9.7008}:  80%|████████  | 8/10 [00:58<00:16,  8.00s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0378, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8781, 'compress@10': 0.5663, 'time@10': 9.8683}:  80%|████████  | 8/10 [01:04<00:16,  8.00s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0378, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8781, 'compress@10': 0.5663, 'time@10': 9.8683}:  90%|█████████ | 9/10 [01:04<00:07,  7.26s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0363, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8808, 'compress@10': 0.5253, 'time@10': 9.8423}:  90%|█████████ | 9/10 [01:13<00:07,  7.26s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0363, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8808, 'compress@10': 0.5253, 'time@10': 9.8423}: 100%|██████████| 10/10 [01:13<00:00,  8.00s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0363, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8808, 'compress@10': 0.5253, 'time@10': 9.8423}: 100%|██████████| 10/10 [01:13<00:00,  7.38s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.036349183684969984
Avg hit ratio: 0.8568031613736198
Avg ndcg: 0.880806100553164
Avg compression ratio: 0.5253088508418222
Avg train time: 9.842280435562134
Std train time: 1.3038151028741047
[0.7916666666666666, 0.2916666666666667, 0.12499999999999999, 0.7083333333333334, 0.9583333333333333, 0.7916666666666667, 0.29166666666666663, 0.4583333333333333, 0.4583333333333333, 0.12500000000000003]
[11, 13, 26, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8453, 'compress@10': 0.8026, 'time@10': 9.2024}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8453, 'compress@10': 0.8026, 'time@10': 9.2024}:  10%|█         | 1/10 [00:04<00:41,  4.64s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8807, 'compress@10': 0.5586, 'time@10': 9.1992}:  10%|█         | 1/10 [00:13<00:41,  4.64s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8807, 'compress@10': 0.5586, 'time@10': 9.1992}:  20%|██        | 2/10 [00:13<00:58,  7.34s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8729, 'compress@10': 0.4557, 'time@10': 8.3716}:  20%|██        | 2/10 [00:17<00:58,  7.34s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8729, 'compress@10': 0.4557, 'time@10': 8.3716}:  30%|███       | 3/10 [00:17<00:38,  5.54s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8881, 'compress@10': 0.5215, 'time@10': 8.7192}:  30%|███       | 3/10 [00:27<00:38,  5.54s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8881, 'compress@10': 0.5215, 'time@10': 8.7192}:  40%|████      | 4/10 [00:27<00:43,  7.22s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0326, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8678, 'compress@10': 0.609, 'time@10': 9.1977}:  40%|████      | 4/10 [00:32<00:43,  7.22s/it] {'epoch': 11, 'num_users': 5.8, 'loss': 0.0326, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8678, 'compress@10': 0.609, 'time@10': 9.1977}:  50%|█████     | 5/10 [00:32<00:33,  6.63s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0354, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.868, 'compress@10': 0.6402, 'time@10': 9.4292}:  50%|█████     | 5/10 [00:43<00:33,  6.63s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0354, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.868, 'compress@10': 0.6402, 'time@10': 9.4292}:  60%|██████    | 6/10 [00:43<00:31,  7.99s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.875, 'ndcg@10': 0.8711, 'compress@10': 0.5945, 'time@10': 9.6866}:  60%|██████    | 6/10 [00:48<00:31,  7.99s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.875, 'ndcg@10': 0.8711, 'compress@10': 0.5945, 'time@10': 9.6866}:  70%|███████   | 7/10 [00:48<00:21,  7.23s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.034, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.875, 'compress@10': 0.5794, 'time@10': 9.7235}:  70%|███████   | 7/10 [00:58<00:21,  7.23s/it]  {'epoch': 11, 'num_users': 6.125, 'loss': 0.034, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.875, 'compress@10': 0.5794, 'time@10': 9.7235}:  80%|████████  | 8/10 [00:58<00:16,  8.11s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0352, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8812, 'compress@10': 0.5677, 'time@10': 9.9295}:  80%|████████  | 8/10 [01:04<00:16,  8.11s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0352, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8812, 'compress@10': 0.5677, 'time@10': 9.9295}:  90%|█████████ | 9/10 [01:04<00:07,  7.40s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0343, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.8845, 'compress@10': 0.5254, 'time@10': 9.8956}:  90%|█████████ | 9/10 [01:14<00:07,  7.40s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0343, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.8845, 'compress@10': 0.5254, 'time@10': 9.8956}: 100%|██████████| 10/10 [01:14<00:00,  8.09s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0343, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.8845, 'compress@10': 0.5254, 'time@10': 9.8956}: 100%|██████████| 10/10 [01:14<00:00,  7.44s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03432702944251262
Avg hit ratio: 0.8787964779985155
Avg ndcg: 0.8844696299858388
Avg compression ratio: 0.5253814438901879
Avg train time: 9.895604729652405
Std train time: 1.3329166667126786
[0.8076923076923077, 0.2692307692307693, 0.11538461538461538, 0.6538461538461539, 0.9615384615384615, 0.8076923076923077, 0.2692307692307692, 0.5, 0.5, 0.1153846153846154]
[11, 13, 27, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.04, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8856, 'compress@10': 0.8178, 'time@10': 9.1303}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.04, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8856, 'compress@10': 0.8178, 'time@10': 9.1303}:  10%|█         | 1/10 [00:04<00:41,  4.60s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0308, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9029, 'compress@10': 0.5553, 'time@10': 9.065}:  10%|█         | 1/10 [00:13<00:41,  4.60s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0308, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9029, 'compress@10': 0.5553, 'time@10': 9.065}:  20%|██        | 2/10 [00:13<00:57,  7.21s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8876, 'compress@10': 0.4508, 'time@10': 8.4045}:  20%|██        | 2/10 [00:17<00:57,  7.21s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8876, 'compress@10': 0.4508, 'time@10': 8.4045}:  30%|███       | 3/10 [00:17<00:38,  5.55s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8894, 'compress@10': 0.5046, 'time@10': 8.68}:  30%|███       | 3/10 [00:26<00:38,  5.55s/it]    {'epoch': 12, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8894, 'compress@10': 0.5046, 'time@10': 8.68}:  40%|████      | 4/10 [00:26<00:42,  7.13s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8691, 'compress@10': 0.5962, 'time@10': 9.2367}:  40%|████      | 4/10 [00:32<00:42,  7.13s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8691, 'compress@10': 0.5962, 'time@10': 9.2367}:  50%|█████     | 5/10 [00:32<00:33,  6.64s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0381, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8721, 'compress@10': 0.6321, 'time@10': 9.4681}:  50%|█████     | 5/10 [00:43<00:33,  6.64s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0381, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8721, 'compress@10': 0.6321, 'time@10': 9.4681}:  60%|██████    | 6/10 [00:43<00:32,  8.01s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0373, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8754, 'compress@10': 0.5845, 'time@10': 9.6956}:  60%|██████    | 6/10 [00:48<00:32,  8.01s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0373, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8754, 'compress@10': 0.5845, 'time@10': 9.6956}:  70%|███████   | 7/10 [00:48<00:21,  7.21s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.038, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.884, 'compress@10': 0.5757, 'time@10': 9.7316}:  70%|███████   | 7/10 [00:58<00:21,  7.21s/it]   {'epoch': 12, 'num_users': 6.125, 'loss': 0.038, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.884, 'compress@10': 0.5757, 'time@10': 9.7316}:  80%|████████  | 8/10 [00:58<00:16,  8.10s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0386, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8871, 'compress@10': 0.5689, 'time@10': 9.9159}:  80%|████████  | 8/10 [01:04<00:16,  8.10s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0386, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8871, 'compress@10': 0.5689, 'time@10': 9.9159}:  90%|█████████ | 9/10 [01:04<00:07,  7.36s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8869, 'compress@10': 0.5255, 'time@10': 9.8795}:  90%|█████████ | 9/10 [01:14<00:07,  7.36s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8869, 'compress@10': 0.5255, 'time@10': 9.8795}: 100%|██████████| 10/10 [01:14<00:00,  8.05s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8869, 'compress@10': 0.5255, 'time@10': 9.8795}: 100%|██████████| 10/10 [01:14<00:00,  7.41s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03793433203483848
Avg hit ratio: 0.8661971007675591
Avg ndcg: 0.8868787849662338
Avg compression ratio: 0.5255357450506256
Avg train time: 9.879488348960876
Std train time: 1.2709453582515493
[0.8214285714285714, 0.25000000000000006, 0.10714285714285714, 0.6785714285714286, 0.9642857142857142, 0.75, 0.25, 0.5357142857142857, 0.5357142857142857, 0.10714285714285716]
[11, 13, 28, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0383, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8568, 'compress@10': 0.8308, 'time@10': 9.3133}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0383, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8568, 'compress@10': 0.8308, 'time@10': 9.3133}:  10%|█         | 1/10 [00:04<00:42,  4.69s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8956, 'compress@10': 0.5525, 'time@10': 9.1825}:  10%|█         | 1/10 [00:13<00:42,  4.69s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8956, 'compress@10': 0.5525, 'time@10': 9.1825}:  20%|██        | 2/10 [00:13<00:58,  7.28s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8828, 'compress@10': 0.4466, 'time@10': 8.5612}:  20%|██        | 2/10 [00:17<00:58,  7.28s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8828, 'compress@10': 0.4466, 'time@10': 8.5612}:  30%|███       | 3/10 [00:17<00:39,  5.64s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8962, 'compress@10': 0.5074, 'time@10': 8.83}:  30%|███       | 3/10 [00:27<00:39,  5.64s/it]  {'epoch': 13, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8962, 'compress@10': 0.5074, 'time@10': 8.83}:  40%|████      | 4/10 [00:27<00:43,  7.23s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.029, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8756, 'compress@10': 0.5989, 'time@10': 9.3327}:  40%|████      | 4/10 [00:32<00:43,  7.23s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.029, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8756, 'compress@10': 0.5989, 'time@10': 9.3327}:  50%|█████     | 5/10 [00:32<00:33,  6.68s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0291, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8798, 'compress@10': 0.625, 'time@10': 9.5554}:  50%|█████     | 5/10 [00:43<00:33,  6.68s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0291, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8798, 'compress@10': 0.625, 'time@10': 9.5554}:  60%|██████    | 6/10 [00:43<00:32,  8.05s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0308, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8833, 'compress@10': 0.5758, 'time@10': 9.7928}:  60%|██████    | 6/10 [00:49<00:32,  8.05s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0308, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8833, 'compress@10': 0.5758, 'time@10': 9.7928}:  70%|███████   | 7/10 [00:49<00:21,  7.27s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.8857, 'compress@10': 0.5724, 'time@10': 9.798}:  70%|███████   | 7/10 [00:59<00:21,  7.27s/it]  {'epoch': 13, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.8857, 'compress@10': 0.5724, 'time@10': 9.798}:  80%|████████  | 8/10 [00:59<00:16,  8.09s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8884, 'compress@10': 0.5698, 'time@10': 9.9949}:  80%|████████  | 8/10 [01:04<00:16,  8.09s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8884, 'compress@10': 0.5698, 'time@10': 9.9949}:  90%|█████████ | 9/10 [01:04<00:07,  7.38s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0303, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8936, 'compress@10': 0.5256, 'time@10': 9.9112}:  90%|█████████ | 9/10 [01:14<00:07,  7.38s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0303, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8936, 'compress@10': 0.5256, 'time@10': 9.9112}: 100%|██████████| 10/10 [01:14<00:00,  7.94s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0303, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8936, 'compress@10': 0.5256, 'time@10': 9.9112}: 100%|██████████| 10/10 [01:14<00:00,  7.41s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.030334184215421223
Avg hit ratio: 0.8841615573635948
Avg ndcg: 0.8935895566632253
Avg compression ratio: 0.5255679507322255
Avg train time: 9.911190056800843
Std train time: 1.2470758349254687
[0.8333333333333333, 0.2333333333333334, 0.09999999999999999, 0.6333333333333334, 0.9666666666666666, 0.7, 0.3, 0.5666666666666667, 0.5666666666666667, 0.10000000000000002]
[11, 13, 29, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0348, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8804, 'compress@10': 0.8421, 'time@10': 9.1524}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0348, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8804, 'compress@10': 0.8421, 'time@10': 9.1524}:  10%|█         | 1/10 [00:04<00:41,  4.62s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9081, 'compress@10': 0.5501, 'time@10': 9.0002}:  10%|█         | 1/10 [00:13<00:41,  4.62s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9081, 'compress@10': 0.5501, 'time@10': 9.0002}:  20%|██        | 2/10 [00:13<00:57,  7.13s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8911, 'compress@10': 0.4429, 'time@10': 8.5819}:  20%|██        | 2/10 [00:17<00:57,  7.13s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8911, 'compress@10': 0.4429, 'time@10': 8.5819}:  30%|███       | 3/10 [00:17<00:39,  5.66s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.9229, 'compress@10': 0.4938, 'time@10': 8.8725}:  30%|███       | 3/10 [00:27<00:39,  5.66s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.9229, 'compress@10': 0.4938, 'time@10': 8.8725}:  40%|████      | 4/10 [00:27<00:43,  7.29s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0291, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.898, 'compress@10': 0.5885, 'time@10': 9.4289}:  40%|████      | 4/10 [00:33<00:43,  7.29s/it] {'epoch': 14, 'num_users': 5.8, 'loss': 0.0291, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.898, 'compress@10': 0.5885, 'time@10': 9.4289}:  50%|█████     | 5/10 [00:33<00:33,  6.77s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0308, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.9005, 'compress@10': 0.6082, 'time@10': 9.6068}:  50%|█████     | 5/10 [00:43<00:33,  6.77s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0308, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.9005, 'compress@10': 0.6082, 'time@10': 9.6068}:  60%|██████    | 6/10 [00:43<00:32,  8.05s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.898, 'compress@10': 0.5682, 'time@10': 9.8326}:  60%|██████    | 6/10 [00:49<00:32,  8.05s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.898, 'compress@10': 0.5682, 'time@10': 9.8326}:  70%|███████   | 7/10 [00:49<00:21,  7.26s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0304, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9028, 'compress@10': 0.5695, 'time@10': 9.838}:  70%|███████   | 7/10 [00:59<00:21,  7.26s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0304, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9028, 'compress@10': 0.5695, 'time@10': 9.838}:  80%|████████  | 8/10 [00:59<00:16,  8.10s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0317, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9048, 'compress@10': 0.5706, 'time@10': 10.0368}:  80%|████████  | 8/10 [01:04<00:16,  8.10s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0317, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9048, 'compress@10': 0.5706, 'time@10': 10.0368}:  90%|█████████ | 9/10 [01:04<00:07,  7.40s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0315, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9061, 'compress@10': 0.5256, 'time@10': 9.9727}:  90%|█████████ | 9/10 [01:14<00:07,  7.40s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0315, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9061, 'compress@10': 0.5256, 'time@10': 9.9727}: 100%|██████████| 10/10 [01:14<00:00,  8.03s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0315, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9061, 'compress@10': 0.5256, 'time@10': 9.9727}: 100%|██████████| 10/10 [01:14<00:00,  7.44s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.03150533978487742
Avg hit ratio: 0.8753269708974294
Avg ndcg: 0.9060519597795414
Avg compression ratio: 0.5255686617418441
Avg train time: 9.972665905952454
Std train time: 1.2088271861056277
[0.8437499999999999, 0.21875000000000006, 0.09374999999999999, 0.5937500000000001, 0.9687499999999999, 0.71875, 0.34375, 0.53125, 0.59375, 0.09375000000000001]
[11, 14, 30, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8838, 'compress@10': 0.852, 'time@10': 9.0751}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8838, 'compress@10': 0.852, 'time@10': 9.0751}:  10%|█         | 1/10 [00:04<00:41,  4.57s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9155, 'compress@10': 0.548, 'time@10': 9.3822}:  10%|█         | 1/10 [00:14<00:41,  4.57s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9155, 'compress@10': 0.548, 'time@10': 9.3822}:  20%|██        | 2/10 [00:14<01:00,  7.61s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8961, 'compress@10': 0.4397, 'time@10': 9.0401}:  20%|██        | 2/10 [00:18<01:00,  7.61s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8961, 'compress@10': 0.4397, 'time@10': 9.0401}:  30%|███       | 3/10 [00:18<00:42,  6.06s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.929, 'compress@10': 0.4818, 'time@10': 9.2344}:  30%|███       | 3/10 [00:28<00:42,  6.06s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.929, 'compress@10': 0.4818, 'time@10': 9.2344}:  40%|████      | 4/10 [00:28<00:45,  7.57s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0267, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.9037, 'compress@10': 0.5794, 'time@10': 9.6228}:  40%|████      | 4/10 [00:34<00:45,  7.57s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0267, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.9037, 'compress@10': 0.5794, 'time@10': 9.6228}:  50%|█████     | 5/10 [00:34<00:34,  6.87s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.9065, 'compress@10': 0.6036, 'time@10': 9.7556}:  50%|█████     | 5/10 [00:44<00:34,  6.87s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.9065, 'compress@10': 0.6036, 'time@10': 9.7556}:  60%|██████    | 6/10 [00:44<00:32,  8.09s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0281, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9065, 'compress@10': 0.5702, 'time@10': 9.9547}:  60%|██████    | 6/10 [00:50<00:32,  8.09s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0281, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9065, 'compress@10': 0.5702, 'time@10': 9.9547}:  70%|███████   | 7/10 [00:50<00:21,  7.28s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.029, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9139, 'compress@10': 0.567, 'time@10': 9.9516}:  70%|███████   | 7/10 [01:00<00:21,  7.28s/it]   {'epoch': 15, 'num_users': 6.125, 'loss': 0.029, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9139, 'compress@10': 0.567, 'time@10': 9.9516}:  80%|████████  | 8/10 [01:00<00:16,  8.13s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0303, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.915, 'compress@10': 0.5713, 'time@10': 10.1022}:  80%|████████  | 8/10 [01:05<00:16,  8.13s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0303, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.915, 'compress@10': 0.5713, 'time@10': 10.1022}:  90%|█████████ | 9/10 [01:05<00:07,  7.37s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.03, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9143, 'compress@10': 0.5256, 'time@10': 10.0242}:  90%|█████████ | 9/10 [01:15<00:07,  7.37s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 0.03, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9143, 'compress@10': 0.5256, 'time@10': 10.0242}: 100%|██████████| 10/10 [01:15<00:00,  7.98s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.03, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9143, 'compress@10': 0.5256, 'time@10': 10.0242}: 100%|██████████| 10/10 [01:15<00:00,  7.51s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.02996465663359322
Avg hit ratio: 0.8658532866869029
Avg ndcg: 0.9142775409709849
Avg compression ratio: 0.5256086079663773
Avg train time: 10.024152994155884
Std train time: 0.934804200632491
[0.7941176470588234, 0.20588235294117652, 0.08823529411764705, 0.6176470588235295, 0.9705882352941175, 0.7352941176470589, 0.3235294117647059, 0.5588235294117647, 0.6176470588235294, 0.08823529411764708]
[11, 14, 31, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8682, 'compress@10': 0.8049, 'time@10': 9.4475}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8682, 'compress@10': 0.8049, 'time@10': 9.4475}:  10%|█         | 1/10 [00:04<00:43,  4.80s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.905, 'compress@10': 0.5182, 'time@10': 9.5642}:  10%|█         | 1/10 [00:14<00:43,  4.80s/it] {'epoch': 16, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.905, 'compress@10': 0.5182, 'time@10': 9.5642}:  20%|██        | 2/10 [00:14<01:01,  7.69s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.779, 'ndcg@10': 0.889, 'compress@10': 0.4183, 'time@10': 9.0336}:  20%|██        | 2/10 [00:18<01:01,  7.69s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.779, 'ndcg@10': 0.889, 'compress@10': 0.4183, 'time@10': 9.0336}:  30%|███       | 3/10 [00:18<00:42,  6.02s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9154, 'compress@10': 0.4716, 'time@10': 9.1833}:  30%|███       | 3/10 [00:28<00:42,  6.02s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9154, 'compress@10': 0.4716, 'time@10': 9.1833}:  40%|████      | 4/10 [00:28<00:44,  7.46s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0305, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8932, 'compress@10': 0.5715, 'time@10': 9.6009}:  40%|████      | 4/10 [00:33<00:44,  7.46s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0305, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8932, 'compress@10': 0.5715, 'time@10': 9.6009}:  50%|█████     | 5/10 [00:33<00:34,  6.82s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0298, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8974, 'compress@10': 0.5998, 'time@10': 9.76}:  50%|█████     | 5/10 [00:44<00:34,  6.82s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0298, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8974, 'compress@10': 0.5998, 'time@10': 9.76}:  60%|██████    | 6/10 [00:44<00:32,  8.10s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0306, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.8981, 'compress@10': 0.5642, 'time@10': 10.013}:  60%|██████    | 6/10 [00:50<00:32,  8.10s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0306, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.8981, 'compress@10': 0.5642, 'time@10': 10.013}:  70%|███████   | 7/10 [00:50<00:22,  7.35s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0306, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9019, 'compress@10': 0.5651, 'time@10': 9.9782}:  70%|███████   | 7/10 [01:00<00:22,  7.35s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0306, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9019, 'compress@10': 0.5651, 'time@10': 9.9782}:  80%|████████  | 8/10 [01:00<00:16,  8.12s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0316, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9048, 'compress@10': 0.5721, 'time@10': 10.1308}:  80%|████████  | 8/10 [01:05<00:16,  8.12s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0316, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9048, 'compress@10': 0.5721, 'time@10': 10.1308}:  90%|█████████ | 9/10 [01:05<00:07,  7.37s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9086, 'compress@10': 0.5258, 'time@10': 10.0587}:  90%|█████████ | 9/10 [01:15<00:07,  7.37s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9086, 'compress@10': 0.5258, 'time@10': 10.0587}: 100%|██████████| 10/10 [01:15<00:00,  8.01s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9086, 'compress@10': 0.5258, 'time@10': 10.0587}: 100%|██████████| 10/10 [01:15<00:00,  7.52s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.02980079394385935
Avg hit ratio: 0.8678532866869029
Avg ndcg: 0.9085792709472574
Avg compression ratio: 0.5258118193068559
Avg train time: 10.058728098869324
Std train time: 1.0549761777690392
[0.8055555555555554, 0.25000000000000006, 0.08333333333333333, 0.5833333333333335, 0.9722222222222221, 0.6944444444444445, 0.36111111111111116, 0.5277777777777778, 0.638888888888889, 0.08333333333333336]
[11, 14, 32, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8805, 'compress@10': 0.8158, 'time@10': 9.5129}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8805, 'compress@10': 0.8158, 'time@10': 9.5129}:  10%|█         | 1/10 [00:04<00:43,  4.79s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0586, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9311, 'compress@10': 0.545, 'time@10': 9.6201}:  10%|█         | 1/10 [00:14<00:43,  4.79s/it] {'epoch': 17, 'num_users': 7.0, 'loss': 0.0586, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9311, 'compress@10': 0.545, 'time@10': 9.6201}:  20%|██        | 2/10 [00:14<01:01,  7.72s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.039, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9065, 'compress@10': 0.4348, 'time@10': 9.0263}:  20%|██        | 2/10 [00:18<01:01,  7.72s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.039, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9065, 'compress@10': 0.4348, 'time@10': 9.0263}:  30%|███       | 3/10 [00:18<00:42,  6.00s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9417, 'compress@10': 0.4756, 'time@10': 9.2086}:  30%|███       | 3/10 [00:28<00:42,  6.00s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9417, 'compress@10': 0.4756, 'time@10': 9.2086}:  40%|████      | 4/10 [00:28<00:44,  7.50s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9149, 'compress@10': 0.575, 'time@10': 9.6389}:  40%|████      | 4/10 [00:34<00:44,  7.50s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9149, 'compress@10': 0.575, 'time@10': 9.6389}:  50%|█████     | 5/10 [00:34<00:34,  6.86s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0379, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9177, 'compress@10': 0.5961, 'time@10': 9.832}:  50%|█████     | 5/10 [00:44<00:34,  6.86s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0379, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9177, 'compress@10': 0.5961, 'time@10': 9.832}:  60%|██████    | 6/10 [00:44<00:32,  8.21s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0361, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9149, 'compress@10': 0.5662, 'time@10': 10.0563}:  60%|██████    | 6/10 [00:50<00:32,  8.21s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0361, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9149, 'compress@10': 0.5662, 'time@10': 10.0563}:  70%|███████   | 7/10 [00:50<00:22,  7.40s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.035, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9209, 'compress@10': 0.563, 'time@10': 10.0026}:  70%|███████   | 7/10 [01:00<00:22,  7.40s/it]   {'epoch': 17, 'num_users': 6.125, 'loss': 0.035, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9209, 'compress@10': 0.563, 'time@10': 10.0026}:  80%|████████  | 8/10 [01:00<00:16,  8.12s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0354, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9211, 'compress@10': 0.5726, 'time@10': 10.138}:  80%|████████  | 8/10 [01:05<00:16,  8.12s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0354, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9211, 'compress@10': 0.5726, 'time@10': 10.138}:  90%|█████████ | 9/10 [01:05<00:07,  7.35s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0334, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9246, 'compress@10': 0.5258, 'time@10': 10.0547}:  90%|█████████ | 9/10 [01:15<00:07,  7.35s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0334, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9246, 'compress@10': 0.5258, 'time@10': 10.0547}: 100%|██████████| 10/10 [01:15<00:00,  7.96s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0334, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9246, 'compress@10': 0.5258, 'time@10': 10.0547}: 100%|██████████| 10/10 [01:15<00:00,  7.53s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.033407499287120376
Avg hit ratio: 0.8845219745355568
Avg ndcg: 0.9245648089559921
Avg compression ratio: 0.5257776316629488
Avg train time: 10.054651355743408
Std train time: 1.0760221453081635
[0.8157894736842103, 0.2894736842105264, 0.07894736842105263, 0.5526315789473686, 0.9736842105263157, 0.7105263157894738, 0.3421052631578948, 0.5, 0.6578947368421053, 0.07894736842105265]
[11, 14, 33, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8815, 'compress@10': 0.8255, 'time@10': 9.0411}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8815, 'compress@10': 0.8255, 'time@10': 9.0411}:  10%|█         | 1/10 [00:04<00:41,  4.56s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0342, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9302, 'compress@10': 0.5689, 'time@10': 9.4484}:  10%|█         | 1/10 [00:14<00:41,  4.56s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0342, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9302, 'compress@10': 0.5689, 'time@10': 9.4484}:  20%|██        | 2/10 [00:14<01:01,  7.70s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9059, 'compress@10': 0.4495, 'time@10': 8.998}:  20%|██        | 2/10 [00:18<01:01,  7.70s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9059, 'compress@10': 0.4495, 'time@10': 8.998}:  30%|███       | 3/10 [00:18<00:42,  6.05s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9369, 'compress@10': 0.4793, 'time@10': 9.1882}:  30%|███       | 3/10 [00:28<00:42,  6.05s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9369, 'compress@10': 0.4793, 'time@10': 9.1882}:  40%|████      | 4/10 [00:28<00:45,  7.53s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0289, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.913, 'compress@10': 0.5782, 'time@10': 9.6312}:  40%|████      | 4/10 [00:34<00:45,  7.53s/it] {'epoch': 18, 'num_users': 5.8, 'loss': 0.0289, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.913, 'compress@10': 0.5782, 'time@10': 9.6312}:  50%|█████     | 5/10 [00:34<00:34,  6.88s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0298, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9188, 'compress@10': 0.6014, 'time@10': 9.7849}:  50%|█████     | 5/10 [00:44<00:34,  6.88s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0298, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9188, 'compress@10': 0.6014, 'time@10': 9.7849}:  60%|██████    | 6/10 [00:44<00:32,  8.14s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9209, 'compress@10': 0.5681, 'time@10': 9.9936}:  60%|██████    | 6/10 [00:50<00:32,  8.14s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9209, 'compress@10': 0.5681, 'time@10': 9.9936}:  70%|███████   | 7/10 [00:50<00:21,  7.33s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9257, 'compress@10': 0.5614, 'time@10': 9.9864}:  70%|███████   | 7/10 [01:00<00:21,  7.33s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9257, 'compress@10': 0.5614, 'time@10': 9.9864}:  80%|████████  | 8/10 [01:00<00:16,  8.17s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0294, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9251, 'compress@10': 0.5732, 'time@10': 10.1188}:  80%|████████  | 8/10 [01:05<00:16,  8.17s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0294, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9251, 'compress@10': 0.5732, 'time@10': 10.1188}:  90%|█████████ | 9/10 [01:05<00:07,  7.38s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.029, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.924, 'compress@10': 0.5258, 'time@10': 10.0364}:  90%|█████████ | 9/10 [01:15<00:07,  7.38s/it]     {'epoch': 18, 'num_users': 6.3, 'loss': 0.029, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.924, 'compress@10': 0.5258, 'time@10': 10.0364}: 100%|██████████| 10/10 [01:15<00:00,  7.98s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.029, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.924, 'compress@10': 0.5258, 'time@10': 10.0364}: 100%|██████████| 10/10 [01:15<00:00,  7.53s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.02895995445889707
Avg hit ratio: 0.878195809661005
Avg ndcg: 0.9240163539872175
Avg compression ratio: 0.5258412321065215
Avg train time: 10.036413526535034
Std train time: 1.0159202099188027
[0.7749999999999998, 0.32500000000000007, 0.075, 0.5250000000000001, 0.9749999999999999, 0.7250000000000001, 0.32500000000000007, 0.525, 0.675, 0.07500000000000002]
[11, 14, 34, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8879, 'compress@10': 0.7868, 'time@10': 9.5379}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8879, 'compress@10': 0.7868, 'time@10': 9.5379}:  10%|█         | 1/10 [00:04<00:43,  4.80s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9277, 'compress@10': 0.5668, 'time@10': 9.6058}:  10%|█         | 1/10 [00:14<00:43,  4.80s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9277, 'compress@10': 0.5668, 'time@10': 9.6058}:  20%|██        | 2/10 [00:14<01:01,  7.69s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9042, 'compress@10': 0.4469, 'time@10': 9.1985}:  20%|██        | 2/10 [00:18<01:01,  7.69s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9042, 'compress@10': 0.4469, 'time@10': 9.1985}:  30%|███       | 3/10 [00:18<00:42,  6.11s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9202, 'compress@10': 0.4707, 'time@10': 9.2863}:  30%|███       | 3/10 [00:28<00:42,  6.11s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9202, 'compress@10': 0.4707, 'time@10': 9.2863}:  40%|████      | 4/10 [00:28<00:44,  7.48s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0244, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9003, 'compress@10': 0.5716, 'time@10': 9.7043}:  40%|████      | 4/10 [00:34<00:44,  7.48s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0244, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9003, 'compress@10': 0.5716, 'time@10': 9.7043}:  50%|█████     | 5/10 [00:34<00:34,  6.85s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9059, 'compress@10': 0.5982, 'time@10': 9.8635}:  50%|█████     | 5/10 [00:44<00:34,  6.85s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9059, 'compress@10': 0.5982, 'time@10': 9.8635}:  60%|██████    | 6/10 [00:44<00:32,  8.16s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0248, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9077, 'compress@10': 0.563, 'time@10': 10.0644}:  60%|██████    | 6/10 [00:50<00:32,  8.16s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0248, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9077, 'compress@10': 0.563, 'time@10': 10.0644}:  70%|███████   | 7/10 [00:50<00:22,  7.34s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.025, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9121, 'compress@10': 0.56, 'time@10': 10.037}:  70%|███████   | 7/10 [01:00<00:22,  7.34s/it]    {'epoch': 19, 'num_users': 6.125, 'loss': 0.025, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9121, 'compress@10': 0.56, 'time@10': 10.037}:  80%|████████  | 8/10 [01:00<00:16,  8.15s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9133, 'compress@10': 0.5738, 'time@10': 10.1663}:  80%|████████  | 8/10 [01:05<00:16,  8.15s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9133, 'compress@10': 0.5738, 'time@10': 10.1663}:  90%|█████████ | 9/10 [01:05<00:07,  7.37s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9182, 'compress@10': 0.526, 'time@10': 10.0705}:  90%|█████████ | 9/10 [01:15<00:07,  7.37s/it]    {'epoch': 19, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9182, 'compress@10': 0.526, 'time@10': 10.0705}: 100%|██████████| 10/10 [01:15<00:00,  7.95s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9182, 'compress@10': 0.526, 'time@10': 10.0705}: 100%|██████████| 10/10 [01:15<00:00,  7.52s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.024726686213620442
Avg hit ratio: 0.8892557174951063
Avg ndcg: 0.9182219375164786
Avg compression ratio: 0.5260191014612021
Avg train time: 10.070481371879577
Std train time: 0.9549780307197739
[0.7857142857142855, 0.3095238095238096, 0.07142857142857142, 0.5000000000000001, 0.976190476190476, 0.6904761904761906, 0.3571428571428572, 0.5476190476190477, 0.6904761904761905, 0.07142857142857145]
[11, 14, 35, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0328, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8856, 'compress@10': 0.797, 'time@10': 9.3412}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0328, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8856, 'compress@10': 0.797, 'time@10': 9.3412}:  10%|█         | 1/10 [00:04<00:42,  4.71s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9198, 'compress@10': 0.5644, 'time@10': 9.6218}:  10%|█         | 1/10 [00:14<00:42,  4.71s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9198, 'compress@10': 0.5644, 'time@10': 9.6218}:  20%|██        | 2/10 [00:14<01:02,  7.79s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8989, 'compress@10': 0.4443, 'time@10': 9.4227}:  20%|██        | 2/10 [00:19<01:02,  7.79s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8989, 'compress@10': 0.4443, 'time@10': 9.4227}:  30%|███       | 3/10 [00:19<00:44,  6.31s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9305, 'compress@10': 0.4627, 'time@10': 9.4658}:  30%|███       | 3/10 [00:28<00:44,  6.31s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9305, 'compress@10': 0.4627, 'time@10': 9.4658}:  40%|████      | 4/10 [00:28<00:45,  7.62s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0273, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9118, 'compress@10': 0.5655, 'time@10': 9.8221}:  40%|████      | 4/10 [00:34<00:45,  7.62s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0273, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9118, 'compress@10': 0.5655, 'time@10': 9.8221}:  50%|█████     | 5/10 [00:34<00:34,  6.91s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0275, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9165, 'compress@10': 0.5875, 'time@10': 9.907}:  50%|█████     | 5/10 [00:44<00:34,  6.91s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0275, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9165, 'compress@10': 0.5875, 'time@10': 9.907}:  60%|██████    | 6/10 [00:44<00:32,  8.09s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.914, 'compress@10': 0.5582, 'time@10': 10.0999}:  60%|██████    | 6/10 [00:50<00:32,  8.09s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.914, 'compress@10': 0.5582, 'time@10': 10.0999}:  70%|███████   | 7/10 [00:50<00:21,  7.30s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.027, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9188, 'compress@10': 0.5585, 'time@10': 10.0791}:  70%|███████   | 7/10 [01:00<00:21,  7.30s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.027, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9188, 'compress@10': 0.5585, 'time@10': 10.0791}:  80%|████████  | 8/10 [01:00<00:16,  8.15s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9195, 'compress@10': 0.5742, 'time@10': 10.2193}:  80%|████████  | 8/10 [01:06<00:16,  8.15s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9195, 'compress@10': 0.5742, 'time@10': 10.2193}:  90%|█████████ | 9/10 [01:06<00:07,  7.38s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9244, 'compress@10': 0.526, 'time@10': 10.1241}:  90%|█████████ | 9/10 [01:15<00:07,  7.38s/it]    {'epoch': 20, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9244, 'compress@10': 0.526, 'time@10': 10.1241}: 100%|██████████| 10/10 [01:15<00:00,  7.98s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9244, 'compress@10': 0.526, 'time@10': 10.1241}: 100%|██████████| 10/10 [01:15<00:00,  7.55s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.025543617375509624
Avg hit ratio: 0.8900755089091252
Avg ndcg: 0.924393076937178
Avg compression ratio: 0.5259983470178259
Avg train time: 10.124071502685547
Std train time: 0.8360200891409386
[0.7954545454545452, 0.340909090909091, 0.06818181818181818, 0.4772727272727274, 0.9772727272727272, 0.7045454545454546, 0.340909090909091, 0.5227272727272728, 0.7045454545454546, 0.0681818181818182]
[11, 14, 35, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8923, 'compress@10': 0.8062, 'time@10': 9.7143}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8923, 'compress@10': 0.8062, 'time@10': 9.7143}:  10%|█         | 1/10 [00:04<00:44,  4.89s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9569, 'compress@10': 0.5842, 'time@10': 9.9443}:  10%|█         | 1/10 [00:15<00:44,  4.89s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9569, 'compress@10': 0.5842, 'time@10': 9.9443}:  20%|██        | 2/10 [00:15<01:04,  8.02s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9237, 'compress@10': 0.4566, 'time@10': 9.5565}:  20%|██        | 2/10 [00:19<01:04,  8.02s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9237, 'compress@10': 0.4566, 'time@10': 9.5565}:  30%|███       | 3/10 [00:19<00:44,  6.38s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9468, 'compress@10': 0.4664, 'time@10': 9.5431}:  30%|███       | 3/10 [00:29<00:44,  6.38s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9468, 'compress@10': 0.4664, 'time@10': 9.5431}:  40%|████      | 4/10 [00:29<00:45,  7.63s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0247, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9268, 'compress@10': 0.5687, 'time@10': 9.883}:  40%|████      | 4/10 [00:34<00:45,  7.63s/it] {'epoch': 21, 'num_users': 5.8, 'loss': 0.0247, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9268, 'compress@10': 0.5687, 'time@10': 9.883}:  50%|█████     | 5/10 [00:34<00:34,  6.92s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0246, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.931, 'compress@10': 0.5924, 'time@10': 9.9824}:  50%|█████     | 5/10 [00:45<00:34,  6.92s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0246, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.931, 'compress@10': 0.5924, 'time@10': 9.9824}:  60%|██████    | 6/10 [00:45<00:32,  8.14s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.023, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.9326, 'compress@10': 0.5602, 'time@10': 10.1239}:  60%|██████    | 6/10 [00:50<00:32,  8.14s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.023, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.9326, 'compress@10': 0.5602, 'time@10': 10.1239}:  70%|███████   | 7/10 [00:50<00:21,  7.29s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0237, 'hit_ratio@10': 0.9211, 'ndcg@10': 0.9347, 'compress@10': 0.5573, 'time@10': 10.1054}:  70%|███████   | 7/10 [01:00<00:21,  7.29s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0237, 'hit_ratio@10': 0.9211, 'ndcg@10': 0.9347, 'compress@10': 0.5573, 'time@10': 10.1054}:  80%|████████  | 8/10 [01:00<00:16,  8.15s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9338, 'compress@10': 0.5746, 'time@10': 10.2156}:  80%|████████  | 8/10 [01:06<00:16,  8.15s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9338, 'compress@10': 0.5746, 'time@10': 10.2156}:  90%|█████████ | 9/10 [01:06<00:07,  7.35s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9336, 'compress@10': 0.526, 'time@10': 10.103}:  90%|█████████ | 9/10 [01:15<00:07,  7.35s/it]      {'epoch': 21, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9336, 'compress@10': 0.526, 'time@10': 10.103}: 100%|██████████| 10/10 [01:15<00:00,  7.90s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9336, 'compress@10': 0.526, 'time@10': 10.103}: 100%|██████████| 10/10 [01:15<00:00,  7.55s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.024775971506279006
Avg hit ratio: 0.9060299110434933
Avg ndcg: 0.9335619182238017
Avg compression ratio: 0.5260435713606415
Avg train time: 10.102961897850037
Std train time: 0.8056386121391101
[0.8043478260869563, 0.36956521739130443, 0.06521739130434782, 0.4565217391304349, 0.9782608695652173, 0.6739130434782609, 0.3260869565217392, 0.5434782608695653, 0.7173913043478262, 0.06521739130434785]
[11, 14, 36, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8974, 'compress@10': 0.8146, 'time@10': 9.4623}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8974, 'compress@10': 0.8146, 'time@10': 9.4623}:  10%|█         | 1/10 [00:04<00:42,  4.77s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0291, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9268, 'compress@10': 0.6023, 'time@10': 9.8936}:  10%|█         | 1/10 [00:15<00:42,  4.77s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0291, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9268, 'compress@10': 0.6023, 'time@10': 9.8936}:  20%|██        | 2/10 [00:15<01:04,  8.06s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9036, 'compress@10': 0.4678, 'time@10': 9.6284}:  20%|██        | 2/10 [00:19<01:04,  8.06s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9036, 'compress@10': 0.4678, 'time@10': 9.6284}:  30%|███       | 3/10 [00:19<00:45,  6.47s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9223, 'compress@10': 0.4698, 'time@10': 9.64}:  30%|███       | 3/10 [00:29<00:45,  6.47s/it]  {'epoch': 22, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9223, 'compress@10': 0.4698, 'time@10': 9.64}:  40%|████      | 4/10 [00:29<00:46,  7.75s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9085, 'compress@10': 0.5716, 'time@10': 10.0107}:  40%|████      | 4/10 [00:35<00:46,  7.75s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9085, 'compress@10': 0.5716, 'time@10': 10.0107}:  50%|█████     | 5/10 [00:35<00:35,  7.04s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0231, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9141, 'compress@10': 0.5898, 'time@10': 10.0934}:  50%|█████     | 5/10 [00:45<00:35,  7.04s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0231, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9141, 'compress@10': 0.5898, 'time@10': 10.0934}:  60%|██████    | 6/10 [00:45<00:32,  8.23s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0242, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9165, 'compress@10': 0.556, 'time@10': 10.3114}:  60%|██████    | 6/10 [00:51<00:32,  8.23s/it] {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0242, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9165, 'compress@10': 0.556, 'time@10': 10.3114}:  70%|███████   | 7/10 [00:51<00:22,  7.46s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0243, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.922, 'compress@10': 0.5561, 'time@10': 10.2376}:  70%|███████   | 7/10 [01:01<00:22,  7.46s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0243, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.922, 'compress@10': 0.5561, 'time@10': 10.2376}:  80%|████████  | 8/10 [01:01<00:16,  8.20s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0253, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9223, 'compress@10': 0.5749, 'time@10': 10.337}:  80%|████████  | 8/10 [01:07<00:16,  8.20s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0253, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9223, 'compress@10': 0.5749, 'time@10': 10.337}:  90%|█████████ | 9/10 [01:07<00:07,  7.39s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0238, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.927, 'compress@10': 0.5261, 'time@10': 10.233}:  90%|█████████ | 9/10 [01:16<00:07,  7.39s/it]    {'epoch': 22, 'num_users': 6.3, 'loss': 0.0238, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.927, 'compress@10': 0.5261, 'time@10': 10.233}: 100%|██████████| 10/10 [01:16<00:00,  7.99s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0238, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.927, 'compress@10': 0.5261, 'time@10': 10.233}: 100%|██████████| 10/10 [01:16<00:00,  7.63s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.023793809545592116
Avg hit ratio: 0.892932651766268
Avg ndcg: 0.9270397165617978
Avg compression ratio: 0.526056426233747
Avg train time: 10.23298258781433
Std train time: 0.8794591337994727
[0.8124999999999998, 0.3958333333333334, 0.0625, 0.4375000000000001, 0.9791666666666665, 0.6458333333333334, 0.35416666666666674, 0.5208333333333334, 0.7291666666666667, 0.06250000000000003]
[11, 14, 36, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8945, 'compress@10': 0.8224, 'time@10': 9.3528}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8945, 'compress@10': 0.8224, 'time@10': 9.3528}:  10%|█         | 1/10 [00:04<00:44,  4.98s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9488, 'compress@10': 0.6188, 'time@10': 9.8342}:  10%|█         | 1/10 [00:15<00:44,  4.98s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9488, 'compress@10': 0.6188, 'time@10': 9.8342}:  20%|██        | 2/10 [00:15<01:05,  8.14s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9182, 'compress@10': 0.478, 'time@10': 9.7063}:  20%|██        | 2/10 [00:20<01:05,  8.14s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9182, 'compress@10': 0.478, 'time@10': 9.7063}:  30%|███       | 3/10 [00:20<00:46,  6.60s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9508, 'compress@10': 0.4729, 'time@10': 9.6857}:  30%|███       | 3/10 [00:29<00:46,  6.60s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9508, 'compress@10': 0.4729, 'time@10': 9.6857}:  40%|████      | 4/10 [00:29<00:46,  7.81s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0242, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9335, 'compress@10': 0.5743, 'time@10': 9.964}:  40%|████      | 4/10 [00:35<00:46,  7.81s/it] {'epoch': 23, 'num_users': 5.8, 'loss': 0.0242, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9335, 'compress@10': 0.5743, 'time@10': 9.964}:  50%|█████     | 5/10 [00:35<00:35,  7.00s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0246, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9381, 'compress@10': 0.5875, 'time@10': 10.0476}:  50%|█████     | 5/10 [00:45<00:35,  7.00s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0246, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9381, 'compress@10': 0.5875, 'time@10': 10.0476}:  60%|██████    | 6/10 [00:45<00:32,  8.19s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0241, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.936, 'compress@10': 0.5579, 'time@10': 10.2673}:  60%|██████    | 6/10 [00:51<00:32,  8.19s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0241, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.936, 'compress@10': 0.5579, 'time@10': 10.2673}:  70%|███████   | 7/10 [00:51<00:22,  7.42s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0241, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9419, 'compress@10': 0.5549, 'time@10': 10.2078}:  70%|███████   | 7/10 [01:01<00:22,  7.42s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0241, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9419, 'compress@10': 0.5549, 'time@10': 10.2078}:  80%|████████  | 8/10 [01:01<00:16,  8.19s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0252, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9398, 'compress@10': 0.5752, 'time@10': 10.3315}:  80%|████████  | 8/10 [01:07<00:16,  8.19s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0252, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9398, 'compress@10': 0.5752, 'time@10': 10.3315}:  90%|█████████ | 9/10 [01:07<00:07,  7.41s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9429, 'compress@10': 0.526, 'time@10': 10.2145}:  90%|█████████ | 9/10 [01:16<00:07,  7.41s/it]    {'epoch': 23, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9429, 'compress@10': 0.526, 'time@10': 10.2145}: 100%|██████████| 10/10 [01:16<00:00,  7.96s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9429, 'compress@10': 0.526, 'time@10': 10.2145}: 100%|██████████| 10/10 [01:16<00:00,  7.64s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.023721200328204465
Avg hit ratio: 0.8885183903061662
Avg ndcg: 0.9429189487367529
Avg compression ratio: 0.5260181821226882
Avg train time: 10.21445186138153
Std train time: 0.8296875907059484
[0.7799999999999998, 0.4200000000000001, 0.06, 0.46000000000000013, 0.9799999999999999, 0.66, 0.3400000000000001, 0.5, 0.7400000000000001, 0.060000000000000026]
[11, 14, 36, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9005, 'compress@10': 0.7916, 'time@10': 9.165}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9005, 'compress@10': 0.7916, 'time@10': 9.165}:  10%|█         | 1/10 [00:04<00:41,  4.63s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9356, 'compress@10': 0.6151, 'time@10': 9.684}:  10%|█         | 1/10 [00:14<00:41,  4.63s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9356, 'compress@10': 0.6151, 'time@10': 9.684}:  20%|██        | 2/10 [00:14<01:03,  7.93s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9094, 'compress@10': 0.4749, 'time@10': 9.5815}:  20%|██        | 2/10 [00:19<01:03,  7.93s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9094, 'compress@10': 0.4749, 'time@10': 9.5815}:  30%|███       | 3/10 [00:19<00:45,  6.47s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9299, 'compress@10': 0.476, 'time@10': 9.61}:  30%|███       | 3/10 [00:29<00:45,  6.47s/it]   {'epoch': 24, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9299, 'compress@10': 0.476, 'time@10': 9.61}:  40%|████      | 4/10 [00:29<00:46,  7.76s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0227, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.9178, 'compress@10': 0.5768, 'time@10': 9.8932}:  40%|████      | 4/10 [00:34<00:46,  7.76s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0227, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.9178, 'compress@10': 0.5768, 'time@10': 9.8932}:  50%|█████     | 5/10 [00:34<00:34,  6.96s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0219, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9255, 'compress@10': 0.592, 'time@10': 9.9346}:  50%|█████     | 5/10 [00:45<00:34,  6.96s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0219, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9255, 'compress@10': 0.592, 'time@10': 9.9346}:  60%|██████    | 6/10 [00:45<00:32,  8.06s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0202, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9289, 'compress@10': 0.5597, 'time@10': 10.102}:  60%|██████    | 6/10 [00:50<00:32,  8.06s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0202, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9289, 'compress@10': 0.5597, 'time@10': 10.102}:  70%|███████   | 7/10 [00:50<00:21,  7.25s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.021, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9326, 'compress@10': 0.5541, 'time@10': 10.0407}:  70%|███████   | 7/10 [01:00<00:21,  7.25s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.021, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9326, 'compress@10': 0.5541, 'time@10': 10.0407}:  80%|████████  | 8/10 [01:00<00:16,  8.01s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9316, 'compress@10': 0.5755, 'time@10': 10.1758}:  80%|████████  | 8/10 [01:05<00:16,  8.01s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9316, 'compress@10': 0.5755, 'time@10': 10.1758}:  90%|█████████ | 9/10 [01:05<00:07,  7.28s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0239, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9295, 'compress@10': 0.5261, 'time@10': 10.0795}:  90%|█████████ | 9/10 [01:15<00:07,  7.28s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0239, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9295, 'compress@10': 0.5261, 'time@10': 10.0795}: 100%|██████████| 10/10 [01:15<00:00,  7.89s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0239, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9295, 'compress@10': 0.5261, 'time@10': 10.0795}: 100%|██████████| 10/10 [01:15<00:00,  7.52s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.02386604897268353
Avg hit ratio: 0.8871359018269036
Avg ndcg: 0.9295308564049755
Avg compression ratio: 0.526125060815625
Avg train time: 10.079540157318116
Std train time: 0.761593140252438
[0.7499999999999998, 0.4423076923076924, 0.05769230769230769, 0.44230769230769246, 0.9807692307692306, 0.6346153846153847, 0.326923076923077, 0.5192307692307693, 0.7500000000000001, 0.09615384615384617]
[11, 14, 36, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9005, 'compress@10': 0.7632, 'time@10': 9.4034}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9005, 'compress@10': 0.7632, 'time@10': 9.4034}:  10%|█         | 1/10 [00:04<00:42,  4.75s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.954, 'compress@10': 0.6117, 'time@10': 9.799}:  10%|█         | 1/10 [00:14<00:42,  4.75s/it]  {'epoch': 25, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.954, 'compress@10': 0.6117, 'time@10': 9.799}:  20%|██        | 2/10 [00:14<01:03,  7.97s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9217, 'compress@10': 0.4719, 'time@10': 9.5907}:  20%|██        | 2/10 [00:19<01:03,  7.97s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9217, 'compress@10': 0.4719, 'time@10': 9.5907}:  30%|███       | 3/10 [00:19<00:45,  6.44s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9351, 'compress@10': 0.4695, 'time@10': 9.5972}:  30%|███       | 3/10 [00:29<00:45,  6.44s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9351, 'compress@10': 0.4695, 'time@10': 9.5972}:  40%|████      | 4/10 [00:29<00:46,  7.71s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0215, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.9234, 'compress@10': 0.5718, 'time@10': 9.9936}:  40%|████      | 4/10 [00:35<00:46,  7.71s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0215, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.9234, 'compress@10': 0.5718, 'time@10': 9.9936}:  50%|█████     | 5/10 [00:35<00:35,  7.03s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0204, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9282, 'compress@10': 0.5836, 'time@10': 10.0394}:  50%|█████     | 5/10 [00:45<00:35,  7.03s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0204, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9282, 'compress@10': 0.5836, 'time@10': 10.0394}:  60%|██████    | 6/10 [00:45<00:32,  8.14s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0217, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9304, 'compress@10': 0.5508, 'time@10': 10.1976}:  60%|██████    | 6/10 [00:51<00:32,  8.14s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0217, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9304, 'compress@10': 0.5508, 'time@10': 10.1976}:  70%|███████   | 7/10 [00:51<00:21,  7.32s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9361, 'compress@10': 0.5486, 'time@10': 10.121}:  70%|███████   | 7/10 [01:00<00:21,  7.32s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9361, 'compress@10': 0.5486, 'time@10': 10.121}:  80%|████████  | 8/10 [01:00<00:16,  8.05s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9345, 'compress@10': 0.5718, 'time@10': 10.2249}:  80%|████████  | 8/10 [01:06<00:16,  8.05s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9345, 'compress@10': 0.5718, 'time@10': 10.2249}:  90%|█████████ | 9/10 [01:06<00:07,  7.28s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9372, 'compress@10': 0.5263, 'time@10': 10.1746}:  90%|█████████ | 9/10 [01:15<00:07,  7.28s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9372, 'compress@10': 0.5263, 'time@10': 10.1746}: 100%|██████████| 10/10 [01:15<00:00,  8.04s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9372, 'compress@10': 0.5263, 'time@10': 10.1746}: 100%|██████████| 10/10 [01:15<00:00,  7.60s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.02236141816147476
Avg hit ratio: 0.8770898188775949
Avg ndcg: 0.9371842479063581
Avg compression ratio: 0.5262500962215907
Avg train time: 10.1745596408844
Std train time: 0.7851959658730081
[0.7592592592592591, 0.4629629629629631, 0.05555555555555555, 0.42592592592592604, 0.9814814814814813, 0.6111111111111112, 0.3518518518518519, 0.5, 0.7592592592592594, 0.09259259259259262]
[11, 14, 36, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9107, 'compress@10': 0.7719, 'time@10': 9.2566}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9107, 'compress@10': 0.7719, 'time@10': 9.2566}:  10%|█         | 1/10 [00:04<00:41,  4.66s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9591, 'compress@10': 0.6261, 'time@10': 9.8567}:  10%|█         | 1/10 [00:15<00:41,  4.66s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9591, 'compress@10': 0.6261, 'time@10': 9.8567}:  20%|██        | 2/10 [00:15<01:04,  8.09s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9251, 'compress@10': 0.4809, 'time@10': 9.6153}:  20%|██        | 2/10 [00:19<01:04,  8.09s/it]  {'epoch': 26, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9251, 'compress@10': 0.4809, 'time@10': 9.6153}:  30%|███       | 3/10 [00:19<00:45,  6.50s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9594, 'compress@10': 0.4723, 'time@10': 9.6253}:  30%|███       | 3/10 [00:29<00:45,  6.50s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9594, 'compress@10': 0.4723, 'time@10': 9.6253}:  40%|████      | 4/10 [00:29<00:46,  7.76s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9445, 'compress@10': 0.5742, 'time@10': 10.0744}:  40%|████      | 4/10 [00:35<00:46,  7.76s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9445, 'compress@10': 0.5742, 'time@10': 10.0744}:  50%|█████     | 5/10 [00:35<00:35,  7.12s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9532, 'compress@10': 0.5818, 'time@10': 10.1308}:  50%|█████     | 5/10 [00:45<00:35,  7.12s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9532, 'compress@10': 0.5818, 'time@10': 10.1308}:  60%|██████    | 6/10 [00:45<00:32,  8.25s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.023, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9494, 'compress@10': 0.5526, 'time@10': 10.2727}:  60%|██████    | 6/10 [00:51<00:32,  8.25s/it] {'epoch': 26, 'num_users': 6.2857, 'loss': 0.023, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9494, 'compress@10': 0.5526, 'time@10': 10.2727}:  70%|███████   | 7/10 [00:51<00:22,  7.38s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9529, 'compress@10': 0.5478, 'time@10': 10.1728}:  70%|███████   | 7/10 [01:00<00:22,  7.38s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9529, 'compress@10': 0.5478, 'time@10': 10.1728}:  80%|████████  | 8/10 [01:00<00:16,  8.06s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0242, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9495, 'compress@10': 0.5721, 'time@10': 10.2951}:  80%|████████  | 8/10 [01:06<00:16,  8.06s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0242, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9495, 'compress@10': 0.5721, 'time@10': 10.2951}:  90%|█████████ | 9/10 [01:06<00:07,  7.31s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.952, 'compress@10': 0.5262, 'time@10': 10.229}:  90%|█████████ | 9/10 [01:16<00:07,  7.31s/it]    {'epoch': 26, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.952, 'compress@10': 0.5262, 'time@10': 10.229}: 100%|██████████| 10/10 [01:16<00:00,  8.04s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0223, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.952, 'compress@10': 0.5262, 'time@10': 10.229}: 100%|██████████| 10/10 [01:16<00:00,  7.63s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.022347857690689532
Avg hit ratio: 0.9014216161126176
Avg ndcg: 0.9520264522073401
Avg compression ratio: 0.5262109449372538
Avg train time: 10.228990316390991
Std train time: 0.8986419819797902
[0.732142857142857, 0.48214285714285726, 0.05357142857142857, 0.44642857142857156, 0.982142857142857, 0.625, 0.33928571428571436, 0.48214285714285715, 0.767857142857143, 0.0892857142857143]
[11, 14, 36, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 0.7462, 'time@10': 9.4926}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 0.7462, 'time@10': 9.4926}:  10%|█         | 1/10 [00:04<00:43,  4.78s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9652, 'compress@10': 0.6225, 'time@10': 9.9135}:  10%|█         | 1/10 [00:15<00:43,  4.78s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9652, 'compress@10': 0.6225, 'time@10': 9.9135}:  20%|██        | 2/10 [00:15<01:04,  8.07s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9292, 'compress@10': 0.478, 'time@10': 9.5984}:  20%|██        | 2/10 [00:19<01:04,  8.07s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9292, 'compress@10': 0.478, 'time@10': 9.5984}:  30%|███       | 3/10 [00:19<00:45,  6.45s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9399, 'compress@10': 0.475, 'time@10': 9.6423}:  30%|███       | 3/10 [00:29<00:45,  6.45s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9399, 'compress@10': 0.475, 'time@10': 9.6423}:  40%|████      | 4/10 [00:29<00:46,  7.78s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9285, 'compress@10': 0.5765, 'time@10': 9.9075}:  40%|████      | 4/10 [00:35<00:46,  7.78s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9285, 'compress@10': 0.5765, 'time@10': 9.9075}:  50%|█████     | 5/10 [00:35<00:34,  6.96s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0171, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9355, 'compress@10': 0.586, 'time@10': 9.9942}:  50%|█████     | 5/10 [00:45<00:34,  6.96s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0171, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9355, 'compress@10': 0.586, 'time@10': 9.9942}:  60%|██████    | 6/10 [00:45<00:32,  8.15s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9381, 'compress@10': 0.5545, 'time@10': 10.2026}:  60%|██████    | 6/10 [00:51<00:32,  8.15s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9381, 'compress@10': 0.5545, 'time@10': 10.2026}:  70%|███████   | 7/10 [00:51<00:22,  7.37s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9453, 'compress@10': 0.5473, 'time@10': 10.132}:  70%|███████   | 7/10 [01:00<00:22,  7.37s/it]  {'epoch': 27, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9453, 'compress@10': 0.5473, 'time@10': 10.132}:  80%|████████  | 8/10 [01:00<00:16,  8.11s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9431, 'compress@10': 0.5726, 'time@10': 10.2568}:  80%|████████  | 8/10 [01:06<00:16,  8.11s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9431, 'compress@10': 0.5726, 'time@10': 10.2568}:  90%|█████████ | 9/10 [01:06<00:07,  7.35s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9469, 'compress@10': 0.5263, 'time@10': 10.1761}:  90%|█████████ | 9/10 [01:16<00:07,  7.35s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9469, 'compress@10': 0.5263, 'time@10': 10.1761}: 100%|██████████| 10/10 [01:16<00:00,  8.01s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9469, 'compress@10': 0.5263, 'time@10': 10.1761}: 100%|██████████| 10/10 [01:16<00:00,  7.61s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.01779566043745085
Avg hit ratio: 0.8862961680839441
Avg ndcg: 0.9468636826488244
Avg compression ratio: 0.5262987310898238
Avg train time: 10.17614505290985
Std train time: 0.8011638420611048
[0.7413793103448274, 0.5000000000000001, 0.05172413793103448, 0.43103448275862083, 0.982758620689655, 0.603448275862069, 0.32758620689655177, 0.5, 0.7758620689655173, 0.08620689655172416]
[11, 14, 36, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9277, 'compress@10': 0.755, 'time@10': 9.4448}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9277, 'compress@10': 0.755, 'time@10': 9.4448}:  10%|█         | 1/10 [00:04<00:42,  4.76s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9849, 'compress@10': 0.6356, 'time@10': 9.8428}:  10%|█         | 1/10 [00:15<00:42,  4.76s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9849, 'compress@10': 0.6356, 'time@10': 9.8428}:  20%|██        | 2/10 [00:15<01:04,  8.01s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9423, 'compress@10': 0.4861, 'time@10': 9.6054}:  20%|██        | 2/10 [00:19<01:04,  8.01s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9423, 'compress@10': 0.4861, 'time@10': 9.6054}:  30%|███       | 3/10 [00:19<00:45,  6.45s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.962, 'compress@10': 0.4774, 'time@10': 9.5994}:  30%|███       | 3/10 [00:29<00:45,  6.45s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.962, 'compress@10': 0.4774, 'time@10': 9.5994}:  40%|████      | 4/10 [00:29<00:46,  7.70s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9477, 'compress@10': 0.5786, 'time@10': 9.9024}:  40%|████      | 4/10 [00:34<00:46,  7.70s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9477, 'compress@10': 0.5786, 'time@10': 9.9024}:  50%|█████     | 5/10 [00:34<00:34,  6.94s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0211, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9494, 'compress@10': 0.5842, 'time@10': 10.0134}:  50%|█████     | 5/10 [00:45<00:34,  6.94s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0211, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9494, 'compress@10': 0.5842, 'time@10': 10.0134}:  60%|██████    | 6/10 [00:45<00:32,  8.19s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0217, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9495, 'compress@10': 0.5514, 'time@10': 10.2178}:  60%|██████    | 6/10 [00:51<00:32,  8.19s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0217, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9495, 'compress@10': 0.5514, 'time@10': 10.2178}:  70%|███████   | 7/10 [00:51<00:22,  7.40s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9498, 'compress@10': 0.5467, 'time@10': 10.1428}:  70%|███████   | 7/10 [01:00<00:22,  7.40s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9498, 'compress@10': 0.5467, 'time@10': 10.1428}:  80%|████████  | 8/10 [01:00<00:16,  8.12s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0229, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9467, 'compress@10': 0.5729, 'time@10': 10.2443}:  80%|████████  | 8/10 [01:06<00:16,  8.12s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0229, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9467, 'compress@10': 0.5729, 'time@10': 10.2443}:  90%|█████████ | 9/10 [01:06<00:07,  7.32s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9491, 'compress@10': 0.5263, 'time@10': 10.1384}:  90%|█████████ | 9/10 [01:15<00:07,  7.32s/it]  {'epoch': 28, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9491, 'compress@10': 0.5263, 'time@10': 10.1384}: 100%|██████████| 10/10 [01:15<00:00,  7.91s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9491, 'compress@10': 0.5263, 'time@10': 10.1384}: 100%|██████████| 10/10 [01:15<00:00,  7.57s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.021368806970708247
Avg hit ratio: 0.9014216161126176
Avg ndcg: 0.949146672139425
Avg compression ratio: 0.5263022039245634
Avg train time: 10.138442206382752
Std train time: 0.817194712266117
[0.7499999999999998, 0.5166666666666668, 0.05, 0.4500000000000001, 0.9833333333333332, 0.5833333333333334, 0.3166666666666667, 0.48333333333333334, 0.7833333333333334, 0.08333333333333336]
[11, 14, 36, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7632, 'time@10': 9.2036}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7632, 'time@10': 9.2036}:  10%|█         | 1/10 [00:04<00:41,  4.64s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.955, 'compress@10': 0.6477, 'time@10': 9.6579}:  10%|█         | 1/10 [00:14<00:41,  4.64s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.955, 'compress@10': 0.6477, 'time@10': 9.6579}:  20%|██        | 2/10 [00:14<01:03,  7.88s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9224, 'compress@10': 0.4937, 'time@10': 9.449}:  20%|██        | 2/10 [00:19<01:03,  7.88s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9224, 'compress@10': 0.4937, 'time@10': 9.449}:  30%|███       | 3/10 [00:19<00:44,  6.36s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9385, 'compress@10': 0.4877, 'time@10': 9.428}:  30%|███       | 3/10 [00:28<00:44,  6.36s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9385, 'compress@10': 0.4877, 'time@10': 9.428}:  40%|████      | 4/10 [00:28<00:45,  7.56s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9302, 'compress@10': 0.5869, 'time@10': 9.7154}:  40%|████      | 4/10 [00:34<00:45,  7.56s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9302, 'compress@10': 0.5869, 'time@10': 9.7154}:  50%|█████     | 5/10 [00:34<00:34,  6.81s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9441, 'compress@10': 0.5878, 'time@10': 9.8774}:  50%|█████     | 5/10 [00:44<00:34,  6.81s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9441, 'compress@10': 0.5878, 'time@10': 9.8774}:  60%|██████    | 6/10 [00:44<00:32,  8.14s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9426, 'compress@10': 0.553, 'time@10': 10.0811}:  60%|██████    | 6/10 [00:50<00:32,  8.14s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9426, 'compress@10': 0.553, 'time@10': 10.0811}:  70%|███████   | 7/10 [00:50<00:22,  7.34s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0197, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9479, 'compress@10': 0.5461, 'time@10': 10.0367}:  70%|███████   | 7/10 [01:00<00:22,  7.34s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0197, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9479, 'compress@10': 0.5461, 'time@10': 10.0367}:  80%|████████  | 8/10 [01:00<00:16,  8.11s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9458, 'compress@10': 0.5732, 'time@10': 10.1636}:  80%|████████  | 8/10 [01:06<00:16,  8.11s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9458, 'compress@10': 0.5732, 'time@10': 10.1636}:  90%|█████████ | 9/10 [01:06<00:07,  7.33s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9487, 'compress@10': 0.5263, 'time@10': 10.066}:  90%|█████████ | 9/10 [01:15<00:07,  7.33s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9487, 'compress@10': 0.5263, 'time@10': 10.066}: 100%|██████████| 10/10 [01:15<00:00,  7.92s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9487, 'compress@10': 0.5263, 'time@10': 10.066}: 100%|██████████| 10/10 [01:15<00:00,  7.52s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.019868253313478624
Avg hit ratio: 0.8885183903061662
Avg ndcg: 0.9487135198222006
Avg compression ratio: 0.5262792498295197
Avg train time: 10.06604061126709
Std train time: 0.835931261162399
[0.725806451612903, 0.5322580645161292, 0.048387096774193554, 0.43548387096774205, 0.9838709677419353, 0.5967741935483871, 0.30645161290322587, 0.5, 0.7903225806451614, 0.0806451612903226]
[11, 14, 36, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7402, 'time@10': 9.3571}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7402, 'time@10': 9.3571}:  10%|█         | 1/10 [00:04<00:42,  4.72s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9651, 'compress@10': 0.6438, 'time@10': 9.7753}:  10%|█         | 1/10 [00:14<00:42,  4.72s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9651, 'compress@10': 0.6438, 'time@10': 9.7753}:  20%|██        | 2/10 [00:14<01:03,  7.96s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9291, 'compress@10': 0.4906, 'time@10': 9.4088}:  20%|██        | 2/10 [00:19<01:03,  7.96s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9291, 'compress@10': 0.4906, 'time@10': 9.4088}:  30%|███       | 3/10 [00:19<00:44,  6.32s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9379, 'compress@10': 0.4819, 'time@10': 9.4725}:  30%|███       | 3/10 [00:29<00:44,  6.32s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9379, 'compress@10': 0.4819, 'time@10': 9.4725}:  40%|████      | 4/10 [00:29<00:45,  7.66s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9307, 'compress@10': 0.5823, 'time@10': 9.7841}:  40%|████      | 4/10 [00:34<00:45,  7.66s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9307, 'compress@10': 0.5823, 'time@10': 9.7841}:  50%|█████     | 5/10 [00:34<00:34,  6.90s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9376, 'compress@10': 0.5862, 'time@10': 9.9475}:  50%|█████     | 5/10 [00:45<00:34,  6.90s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9376, 'compress@10': 0.5862, 'time@10': 9.9475}:  60%|██████    | 6/10 [00:45<00:32,  8.23s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9399, 'compress@10': 0.5502, 'time@10': 10.1055}:  60%|██████    | 6/10 [00:50<00:32,  8.23s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9399, 'compress@10': 0.5502, 'time@10': 10.1055}:  70%|███████   | 7/10 [00:50<00:22,  7.35s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9468, 'compress@10': 0.5457, 'time@10': 10.0615}:  70%|███████   | 7/10 [01:00<00:22,  7.35s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9468, 'compress@10': 0.5457, 'time@10': 10.0615}:  80%|████████  | 8/10 [01:00<00:16,  8.13s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.945, 'compress@10': 0.5736, 'time@10': 10.1727}:  80%|████████  | 8/10 [01:06<00:16,  8.13s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.945, 'compress@10': 0.5736, 'time@10': 10.1727}:  90%|█████████ | 9/10 [01:06<00:07,  7.33s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9481, 'compress@10': 0.5264, 'time@10': 10.0499}:  90%|█████████ | 9/10 [01:15<00:07,  7.33s/it]  {'epoch': 30, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9481, 'compress@10': 0.5264, 'time@10': 10.0499}: 100%|██████████| 10/10 [01:15<00:00,  7.84s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9481, 'compress@10': 0.5264, 'time@10': 10.0499}: 100%|██████████| 10/10 [01:15<00:00,  7.53s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.015367558512892144
Avg hit ratio: 0.8845450160102113
Avg ndcg: 0.948117808484157
Avg compression ratio: 0.526377588686889
Avg train time: 10.049889421463012
Std train time: 0.857432282735548
[0.7343749999999998, 0.5468750000000002, 0.04687500000000001, 0.4218750000000001, 0.9843749999999998, 0.578125, 0.29687500000000006, 0.515625, 0.7968750000000001, 0.07812500000000003]
[11, 14, 37, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7484, 'time@10': 9.5156}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7484, 'time@10': 9.5156}:  10%|█         | 1/10 [00:04<00:43,  4.79s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.961, 'compress@10': 0.6549, 'time@10': 9.7488}:  10%|█         | 1/10 [00:14<00:43,  4.79s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.961, 'compress@10': 0.6549, 'time@10': 9.7488}:  20%|██        | 2/10 [00:14<01:02,  7.87s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9264, 'compress@10': 0.4976, 'time@10': 9.5076}:  20%|██        | 2/10 [00:19<01:02,  7.87s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9264, 'compress@10': 0.4976, 'time@10': 9.5076}:  30%|███       | 3/10 [00:19<00:44,  6.35s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9688, 'compress@10': 0.4839, 'time@10': 9.5572}:  30%|███       | 3/10 [00:29<00:44,  6.35s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9688, 'compress@10': 0.4839, 'time@10': 9.5572}:  40%|████      | 4/10 [00:29<00:46,  7.69s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9562, 'compress@10': 0.584, 'time@10': 9.7848}:  40%|████      | 4/10 [00:34<00:46,  7.69s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9562, 'compress@10': 0.584, 'time@10': 9.7848}:  50%|█████     | 5/10 [00:34<00:34,  6.86s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9592, 'compress@10': 0.5846, 'time@10': 9.9683}:  50%|█████     | 5/10 [00:45<00:34,  6.86s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9592, 'compress@10': 0.5846, 'time@10': 9.9683}:  60%|██████    | 6/10 [00:45<00:32,  8.24s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9593, 'compress@10': 0.5475, 'time@10': 10.1723}:  60%|██████    | 6/10 [00:51<00:32,  8.24s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9593, 'compress@10': 0.5475, 'time@10': 10.1723}:  70%|███████   | 7/10 [00:51<00:22,  7.42s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9598, 'compress@10': 0.5453, 'time@10': 10.1169}:  70%|███████   | 7/10 [01:00<00:22,  7.42s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9598, 'compress@10': 0.5453, 'time@10': 10.1169}:  80%|████████  | 8/10 [01:00<00:16,  8.17s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9576, 'compress@10': 0.5739, 'time@10': 10.2657}:  80%|████████  | 8/10 [01:06<00:16,  8.17s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9576, 'compress@10': 0.5739, 'time@10': 10.2657}:  90%|█████████ | 9/10 [01:06<00:07,  7.42s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9537, 'compress@10': 0.5264, 'time@10': 10.1484}:  90%|█████████ | 9/10 [01:15<00:07,  7.42s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9537, 'compress@10': 0.5264, 'time@10': 10.1484}: 100%|██████████| 10/10 [01:15<00:00,  7.95s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9537, 'compress@10': 0.5264, 'time@10': 10.1484}: 100%|██████████| 10/10 [01:15<00:00,  7.58s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.023589920250261985
Avg hit ratio: 0.8780934031069855
Avg ndcg: 0.9537436466786577
Avg compression ratio: 0.5263781951518371
Avg train time: 10.148425269126893
Std train time: 0.8534683433577843
[0.7121212121212119, 0.5606060606060608, 0.04545454545454546, 0.4393939393939395, 0.9848484848484846, 0.5606060606060606, 0.28787878787878796, 0.5, 0.8030303030303031, 0.10606060606060609]
[11, 14, 37, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.7273, 'time@10': 9.3495}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.7273, 'time@10': 9.3495}:  10%|█         | 1/10 [00:04<00:42,  4.71s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9741, 'compress@10': 0.651, 'time@10': 9.7707}:  10%|█         | 1/10 [00:14<00:42,  4.71s/it]  {'epoch': 32, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9741, 'compress@10': 0.651, 'time@10': 9.7707}:  20%|██        | 2/10 [00:14<01:03,  7.96s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9351, 'compress@10': 0.4946, 'time@10': 9.5643}:  20%|██        | 2/10 [00:19<01:03,  7.96s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9351, 'compress@10': 0.4946, 'time@10': 9.5643}:  30%|███       | 3/10 [00:19<00:45,  6.43s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9449, 'compress@10': 0.4858, 'time@10': 9.6181}:  30%|███       | 3/10 [00:29<00:45,  6.43s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9449, 'compress@10': 0.4858, 'time@10': 9.6181}:  40%|████      | 4/10 [00:29<00:46,  7.77s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9381, 'compress@10': 0.5857, 'time@10': 9.7957}:  40%|████      | 4/10 [00:34<00:46,  7.77s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9381, 'compress@10': 0.5857, 'time@10': 9.7957}:  50%|█████     | 5/10 [00:34<00:34,  6.87s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9491, 'compress@10': 0.5831, 'time@10': 9.9158}:  50%|█████     | 5/10 [00:45<00:34,  6.87s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9491, 'compress@10': 0.5831, 'time@10': 9.9158}:  60%|██████    | 6/10 [00:45<00:32,  8.13s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9469, 'compress@10': 0.545, 'time@10': 10.0676}:  60%|██████    | 6/10 [00:50<00:32,  8.13s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9469, 'compress@10': 0.545, 'time@10': 10.0676}:  70%|███████   | 7/10 [00:50<00:21,  7.28s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9527, 'compress@10': 0.5412, 'time@10': 10.0251}:  70%|███████   | 7/10 [01:00<00:21,  7.28s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9527, 'compress@10': 0.5412, 'time@10': 10.0251}:  80%|████████  | 8/10 [01:00<00:16,  8.07s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9505, 'compress@10': 0.5709, 'time@10': 10.1538}:  80%|████████  | 8/10 [01:06<00:16,  8.07s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9505, 'compress@10': 0.5709, 'time@10': 10.1538}:  90%|█████████ | 9/10 [01:06<00:07,  7.31s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9529, 'compress@10': 0.5264, 'time@10': 10.1118}:  90%|█████████ | 9/10 [01:15<00:07,  7.31s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9529, 'compress@10': 0.5264, 'time@10': 10.1118}: 100%|██████████| 10/10 [01:15<00:00,  8.07s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9529, 'compress@10': 0.5264, 'time@10': 10.1118}: 100%|██████████| 10/10 [01:15<00:00,  7.59s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.018496662456816856
Avg hit ratio: 0.8867672382324334
Avg ndcg: 0.9528895098874368
Avg compression ratio: 0.5264464587599689
Avg train time: 10.11176323890686
Std train time: 0.642351950414744
[0.6911764705882351, 0.5735294117647061, 0.04411764705882354, 0.4264705882352942, 0.9852941176470587, 0.5735294117647058, 0.2794117647058824, 0.5147058823529411, 0.8088235294117647, 0.10294117647058826]
[11, 14, 37, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.7074, 'time@10': 9.4009}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.7074, 'time@10': 9.4009}:  10%|█         | 1/10 [00:04<00:42,  4.74s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9556, 'compress@10': 0.6474, 'time@10': 9.8033}:  10%|█         | 1/10 [00:14<00:42,  4.74s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9556, 'compress@10': 0.6474, 'time@10': 9.8033}:  20%|██        | 2/10 [00:14<01:03,  7.98s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9228, 'compress@10': 0.4918, 'time@10': 9.7091}:  20%|██        | 2/10 [00:19<01:03,  7.98s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9228, 'compress@10': 0.4918, 'time@10': 9.7091}:  30%|███       | 3/10 [00:19<00:45,  6.53s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9325, 'compress@10': 0.4806, 'time@10': 9.7013}:  30%|███       | 3/10 [00:29<00:45,  6.53s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9325, 'compress@10': 0.4806, 'time@10': 9.7013}:  40%|████      | 4/10 [00:29<00:46,  7.79s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.928, 'compress@10': 0.5816, 'time@10': 9.9111}:  40%|████      | 4/10 [00:34<00:46,  7.79s/it] {'epoch': 33, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.928, 'compress@10': 0.5816, 'time@10': 9.9111}:  50%|█████     | 5/10 [00:34<00:34,  6.93s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9357, 'compress@10': 0.5818, 'time@10': 10.0185}:  50%|█████     | 5/10 [00:45<00:34,  6.93s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9357, 'compress@10': 0.5818, 'time@10': 10.0185}:  60%|██████    | 6/10 [00:45<00:32,  8.18s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9383, 'compress@10': 0.5427, 'time@10': 10.1876}:  60%|██████    | 6/10 [00:51<00:32,  8.18s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9383, 'compress@10': 0.5427, 'time@10': 10.1876}:  70%|███████   | 7/10 [00:51<00:22,  7.35s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9468, 'compress@10': 0.541, 'time@10': 10.1324}:  70%|███████   | 7/10 [01:00<00:22,  7.35s/it]  {'epoch': 33, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9468, 'compress@10': 0.541, 'time@10': 10.1324}:  80%|████████  | 8/10 [01:00<00:16,  8.13s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.946, 'compress@10': 0.5713, 'time@10': 10.2462}:  80%|████████  | 8/10 [01:06<00:16,  8.13s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.946, 'compress@10': 0.5713, 'time@10': 10.2462}:  90%|█████████ | 9/10 [01:06<00:07,  7.34s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9488, 'compress@10': 0.5265, 'time@10': 10.1975}:  90%|█████████ | 9/10 [01:16<00:07,  7.34s/it]  {'epoch': 33, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9488, 'compress@10': 0.5265, 'time@10': 10.1975}: 100%|██████████| 10/10 [01:16<00:00,  8.10s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9488, 'compress@10': 0.5265, 'time@10': 10.1975}: 100%|██████████| 10/10 [01:16<00:00,  7.64s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.014339433456664264
Avg hit ratio: 0.8956049238443127
Avg ndcg: 0.9487667602966783
Avg compression ratio: 0.5265335070598929
Avg train time: 10.19749836921692
Std train time: 0.6420572175805221
[0.6999999999999997, 0.5857142857142859, 0.042857142857142864, 0.41428571428571437, 0.9857142857142855, 0.5571428571428572, 0.27142857142857146, 0.5285714285714285, 0.8142857142857143, 0.10000000000000002]
[11, 14, 37, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7158, 'time@10': 9.4918}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7158, 'time@10': 9.4918}:  10%|█         | 1/10 [00:04<00:43,  4.78s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9727, 'compress@10': 0.6574, 'time@10': 9.8485}:  10%|█         | 1/10 [00:15<00:43,  4.78s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9727, 'compress@10': 0.6574, 'time@10': 9.8485}:  20%|██        | 2/10 [00:15<01:03,  7.99s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9342, 'compress@10': 0.4981, 'time@10': 9.6564}:  20%|██        | 2/10 [00:19<01:03,  7.99s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9342, 'compress@10': 0.4981, 'time@10': 9.6564}:  30%|███       | 3/10 [00:19<00:45,  6.48s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.947, 'compress@10': 0.4824, 'time@10': 9.6761}:  30%|███       | 3/10 [00:29<00:45,  6.48s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.947, 'compress@10': 0.4824, 'time@10': 9.6761}:  40%|████      | 4/10 [00:29<00:46,  7.79s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9408, 'compress@10': 0.5831, 'time@10': 9.9021}:  40%|████      | 4/10 [00:34<00:46,  7.79s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9408, 'compress@10': 0.5831, 'time@10': 9.9021}:  50%|█████     | 5/10 [00:34<00:34,  6.94s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.9467, 'compress@10': 0.5804, 'time@10': 10.0391}:  50%|█████     | 5/10 [00:45<00:34,  6.94s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.9467, 'compress@10': 0.5804, 'time@10': 10.0391}:  60%|██████    | 6/10 [00:45<00:32,  8.24s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9478, 'compress@10': 0.5405, 'time@10': 10.1851}:  60%|██████    | 6/10 [00:51<00:32,  8.24s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9478, 'compress@10': 0.5405, 'time@10': 10.1851}:  70%|███████   | 7/10 [00:51<00:22,  7.37s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.9234, 'ndcg@10': 0.9462, 'compress@10': 0.5407, 'time@10': 10.1292}:  70%|███████   | 7/10 [01:01<00:22,  7.37s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.9234, 'ndcg@10': 0.9462, 'compress@10': 0.5407, 'time@10': 10.1292}:  80%|████████  | 8/10 [01:01<00:16,  8.13s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0184, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9456, 'compress@10': 0.5716, 'time@10': 10.2119}:  80%|████████  | 8/10 [01:06<00:16,  8.13s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0184, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9456, 'compress@10': 0.5716, 'time@10': 10.2119}:  90%|█████████ | 9/10 [01:06<00:07,  7.30s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9435, 'compress@10': 0.5265, 'time@10': 10.1674}:  90%|█████████ | 9/10 [01:16<00:07,  7.30s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9435, 'compress@10': 0.5265, 'time@10': 10.1674}: 100%|██████████| 10/10 [01:16<00:00,  8.08s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9435, 'compress@10': 0.5265, 'time@10': 10.1674}: 100%|██████████| 10/10 [01:16<00:00,  7.63s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.01935780167877645
Avg hit ratio: 0.9107303718729863
Avg ndcg: 0.9434987165346744
Avg compression ratio: 0.5265274152042506
Avg train time: 10.167443919181824
Std train time: 0.6169837138624027
[0.6805555555555552, 0.5972222222222223, 0.04166666666666667, 0.40277777777777785, 0.9861111111111109, 0.5416666666666667, 0.26388888888888895, 0.5416666666666665, 0.8194444444444444, 0.12500000000000003]
[11, 14, 37, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.6974, 'time@10': 9.5344}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.6974, 'time@10': 9.5344}:  10%|█         | 1/10 [00:04<00:43,  4.82s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9617, 'compress@10': 0.6538, 'time@10': 9.8972}:  10%|█         | 1/10 [00:15<00:43,  4.82s/it] {'epoch': 35, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9617, 'compress@10': 0.6538, 'time@10': 9.8972}:  20%|██        | 2/10 [00:15<01:04,  8.04s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9268, 'compress@10': 0.4954, 'time@10': 9.6794}:  20%|██        | 2/10 [00:19<01:04,  8.04s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9268, 'compress@10': 0.4954, 'time@10': 9.6794}:  30%|███       | 3/10 [00:19<00:45,  6.50s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9362, 'compress@10': 0.4776, 'time@10': 9.6784}:  30%|███       | 3/10 [00:29<00:45,  6.50s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9362, 'compress@10': 0.4776, 'time@10': 9.6784}:  40%|████      | 4/10 [00:29<00:46,  7.77s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0133, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9324, 'compress@10': 0.5793, 'time@10': 9.9046}:  40%|████      | 4/10 [00:34<00:46,  7.77s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0133, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9324, 'compress@10': 0.5793, 'time@10': 9.9046}:  50%|█████     | 5/10 [00:34<00:34,  6.93s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.943, 'compress@10': 0.5747, 'time@10': 10.034}:  50%|█████     | 5/10 [00:45<00:34,  6.93s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.943, 'compress@10': 0.5747, 'time@10': 10.034}:  60%|██████    | 6/10 [00:45<00:32,  8.22s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0174, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9421, 'compress@10': 0.5345, 'time@10': 10.2243}:  60%|██████    | 6/10 [00:51<00:32,  8.22s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0174, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9421, 'compress@10': 0.5345, 'time@10': 10.2243}:  70%|███████   | 7/10 [00:51<00:22,  7.40s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9487, 'compress@10': 0.5371, 'time@10': 10.1465}:  70%|███████   | 7/10 [01:01<00:22,  7.40s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9487, 'compress@10': 0.5371, 'time@10': 10.1465}:  80%|████████  | 8/10 [01:01<00:16,  8.11s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9485, 'compress@10': 0.569, 'time@10': 10.2585}:  80%|████████  | 8/10 [01:06<00:16,  8.11s/it]  {'epoch': 35, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9485, 'compress@10': 0.569, 'time@10': 10.2585}:  90%|█████████ | 9/10 [01:06<00:07,  7.33s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9514, 'compress@10': 0.5266, 'time@10': 10.2119}:  90%|█████████ | 9/10 [01:16<00:07,  7.33s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9514, 'compress@10': 0.5266, 'time@10': 10.2119}: 100%|██████████| 10/10 [01:16<00:00,  8.10s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9514, 'compress@10': 0.5266, 'time@10': 10.2119}: 100%|██████████| 10/10 [01:16<00:00,  7.65s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.016813672074010237
Avg hit ratio: 0.8978271460665347
Avg ndcg: 0.9513633122877895
Avg compression ratio: 0.5266045178827125
Avg train time: 10.211930537223816
Std train time: 0.7094592428917353
[0.6621621621621618, 0.6081081081081082, 0.04054054054054054, 0.39189189189189194, 0.9864864864864863, 0.5540540540540542, 0.2837837837837838, 0.5270270270270269, 0.8243243243243243, 0.12162162162162164]
[11, 14, 37, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.6799, 'time@10': 9.8081}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.6799, 'time@10': 9.8081}:  10%|█         | 1/10 [00:04<00:44,  4.96s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9482, 'compress@10': 0.6503, 'time@10': 10.0408}:  10%|█         | 1/10 [00:15<00:44,  4.96s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9482, 'compress@10': 0.6503, 'time@10': 10.0408}:  20%|██        | 2/10 [00:15<01:04,  8.11s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9178, 'compress@10': 0.4928, 'time@10': 9.739}:  20%|██        | 2/10 [00:19<01:04,  8.11s/it]  {'epoch': 36, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9178, 'compress@10': 0.4928, 'time@10': 9.739}:  30%|███       | 3/10 [00:19<00:45,  6.51s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9373, 'compress@10': 0.473, 'time@10': 9.708}:  30%|███       | 3/10 [00:29<00:45,  6.51s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9373, 'compress@10': 0.473, 'time@10': 9.708}:  40%|████      | 4/10 [00:29<00:46,  7.75s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9333, 'compress@10': 0.5757, 'time@10': 9.872}:  40%|████      | 4/10 [00:34<00:46,  7.75s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9333, 'compress@10': 0.5757, 'time@10': 9.872}:  50%|█████     | 5/10 [00:34<00:34,  6.87s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9402, 'compress@10': 0.5738, 'time@10': 10.0004}:  50%|█████     | 5/10 [00:45<00:34,  6.87s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9402, 'compress@10': 0.5738, 'time@10': 10.0004}:  60%|██████    | 6/10 [00:45<00:32,  8.17s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9421, 'compress@10': 0.5364, 'time@10': 10.1873}:  60%|██████    | 6/10 [00:51<00:32,  8.17s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9421, 'compress@10': 0.5364, 'time@10': 10.1873}:  70%|███████   | 7/10 [00:51<00:22,  7.36s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9496, 'compress@10': 0.5369, 'time@10': 10.134}:  70%|███████   | 7/10 [01:01<00:22,  7.36s/it]  {'epoch': 36, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9496, 'compress@10': 0.5369, 'time@10': 10.134}:  80%|████████  | 8/10 [01:01<00:16,  8.13s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9494, 'compress@10': 0.5694, 'time@10': 10.2068}:  80%|████████  | 8/10 [01:06<00:16,  8.13s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9494, 'compress@10': 0.5694, 'time@10': 10.2068}:  90%|█████████ | 9/10 [01:06<00:07,  7.29s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9515, 'compress@10': 0.5267, 'time@10': 10.1835}:  90%|█████████ | 9/10 [01:16<00:07,  7.29s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9515, 'compress@10': 0.5267, 'time@10': 10.1835}: 100%|██████████| 10/10 [01:16<00:00,  8.13s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9515, 'compress@10': 0.5267, 'time@10': 10.1835}: 100%|██████████| 10/10 [01:16<00:00,  7.65s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.014444443531194983
Avg hit ratio: 0.8988307302959255
Avg ndcg: 0.9514924452812638
Avg compression ratio: 0.5266500064052401
Avg train time: 10.183494400978088
Std train time: 0.6127421138352537
[0.671052631578947, 0.5921052631578948, 0.03947368421052632, 0.4078947368421053, 0.9868421052631577, 0.5394736842105264, 0.27631578947368424, 0.5394736842105261, 0.8289473684210527, 0.11842105263157897]
[11, 14, 37, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0191, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9267, 'compress@10': 0.6884, 'time@10': 9.4736}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0191, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9267, 'compress@10': 0.6884, 'time@10': 9.4736}:  10%|█         | 1/10 [00:04<00:42,  4.77s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9623, 'compress@10': 0.6468, 'time@10': 9.7942}:  10%|█         | 1/10 [00:14<00:42,  4.77s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9623, 'compress@10': 0.6468, 'time@10': 9.7942}:  20%|██        | 2/10 [00:14<01:03,  7.94s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9273, 'compress@10': 0.4901, 'time@10': 9.6281}:  20%|██        | 2/10 [00:19<01:03,  7.94s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9273, 'compress@10': 0.4901, 'time@10': 9.6281}:  30%|███       | 3/10 [00:19<00:45,  6.46s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9375, 'compress@10': 0.4748, 'time@10': 9.6368}:  30%|███       | 3/10 [00:29<00:45,  6.46s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9375, 'compress@10': 0.4748, 'time@10': 9.6368}:  40%|████      | 4/10 [00:29<00:46,  7.74s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9355, 'compress@10': 0.5773, 'time@10': 9.8431}:  40%|████      | 4/10 [00:34<00:46,  7.74s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9355, 'compress@10': 0.5773, 'time@10': 9.8431}:  50%|█████     | 5/10 [00:34<00:34,  6.88s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9423, 'compress@10': 0.5727, 'time@10': 9.9955}:  50%|█████     | 5/10 [00:45<00:34,  6.88s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9423, 'compress@10': 0.5727, 'time@10': 9.9955}:  60%|██████    | 6/10 [00:45<00:32,  8.21s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9439, 'compress@10': 0.5345, 'time@10': 10.1702}:  60%|██████    | 6/10 [00:51<00:32,  8.21s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9439, 'compress@10': 0.5345, 'time@10': 10.1702}:  70%|███████   | 7/10 [00:51<00:22,  7.37s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9459, 'compress@10': 0.5368, 'time@10': 10.1152}:  70%|███████   | 7/10 [01:00<00:22,  7.37s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9459, 'compress@10': 0.5368, 'time@10': 10.1152}:  80%|████████  | 8/10 [01:00<00:16,  8.14s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9469, 'compress@10': 0.5698, 'time@10': 10.2144}:  80%|████████  | 8/10 [01:06<00:16,  8.14s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9469, 'compress@10': 0.5698, 'time@10': 10.2144}:  90%|█████████ | 9/10 [01:06<00:07,  7.33s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9475, 'compress@10': 0.5266, 'time@10': 10.1928}:  90%|█████████ | 9/10 [01:16<00:07,  7.33s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9475, 'compress@10': 0.5266, 'time@10': 10.1928}: 100%|██████████| 10/10 [01:16<00:00,  8.16s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9475, 'compress@10': 0.5266, 'time@10': 10.1928}: 100%|██████████| 10/10 [01:16<00:00,  7.65s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.015433144154460496
Avg hit ratio: 0.8952362602498425
Avg ndcg: 0.9474989195433757
Avg compression ratio: 0.5266331971405156
Avg train time: 10.192756509780883
Std train time: 0.6421083730597416
[0.6794871794871792, 0.6025641025641026, 0.038461538461538464, 0.39743589743589747, 0.9615384615384613, 0.5256410256410258, 0.2692307692307693, 0.5512820512820511, 0.8333333333333334, 0.14102564102564105]
[11, 14, 37, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.6963, 'time@10': 9.4422}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.6963, 'time@10': 9.4422}:  10%|█         | 1/10 [00:04<00:42,  4.76s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9797, 'compress@10': 0.6559, 'time@10': 9.8557}:  10%|█         | 1/10 [00:15<00:42,  4.76s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9797, 'compress@10': 0.6559, 'time@10': 9.8557}:  20%|██        | 2/10 [00:15<01:04,  8.02s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.7705, 'ndcg@10': 0.9388, 'compress@10': 0.4959, 'time@10': 9.7384}:  20%|██        | 2/10 [00:19<01:04,  8.02s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.7705, 'ndcg@10': 0.9388, 'compress@10': 0.4959, 'time@10': 9.7384}:  30%|███       | 3/10 [00:19<00:45,  6.55s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.9452, 'compress@10': 0.4766, 'time@10': 9.7077}:  30%|███       | 3/10 [00:29<00:45,  6.55s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.9452, 'compress@10': 0.4766, 'time@10': 9.7077}:  40%|████      | 4/10 [00:29<00:46,  7.78s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.9413, 'compress@10': 0.5738, 'time@10': 9.9017}:  40%|████      | 4/10 [00:34<00:46,  7.78s/it] {'epoch': 38, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.9413, 'compress@10': 0.5738, 'time@10': 9.9017}:  50%|█████     | 5/10 [00:34<00:34,  6.92s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.9541, 'compress@10': 0.5675, 'time@10': 10.0313}:  50%|█████     | 5/10 [00:45<00:34,  6.92s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.9541, 'compress@10': 0.5675, 'time@10': 10.0313}:  60%|██████    | 6/10 [00:45<00:32,  8.21s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9612, 'compress@10': 0.5291, 'time@10': 10.1823}:  60%|██████    | 6/10 [00:51<00:32,  8.21s/it] {'epoch': 38, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9612, 'compress@10': 0.5291, 'time@10': 10.1823}:  70%|███████   | 7/10 [00:51<00:22,  7.35s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9628, 'compress@10': 0.5334, 'time@10': 10.1247}:  70%|███████   | 7/10 [01:00<00:22,  7.35s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9628, 'compress@10': 0.5334, 'time@10': 10.1247}:  80%|████████  | 8/10 [01:00<00:16,  8.12s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9628, 'compress@10': 0.5673, 'time@10': 10.2524}:  80%|████████  | 8/10 [01:06<00:16,  8.12s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9628, 'compress@10': 0.5673, 'time@10': 10.2524}:  90%|█████████ | 9/10 [01:06<00:07,  7.35s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9667, 'compress@10': 0.5266, 'time@10': 10.2158}:  90%|█████████ | 9/10 [01:16<00:07,  7.35s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9667, 'compress@10': 0.5266, 'time@10': 10.2158}: 100%|██████████| 10/10 [01:16<00:00,  8.15s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9667, 'compress@10': 0.5266, 'time@10': 10.2158}: 100%|██████████| 10/10 [01:16<00:00,  7.66s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.02120629096024768
Avg hit ratio: 0.8782188511356592
Avg ndcg: 0.9667126207785011
Avg compression ratio: 0.5266185833049578
Avg train time: 10.215781807899475
Std train time: 0.6426562929884448
[0.6624999999999998, 0.6125, 0.037500000000000006, 0.3875, 0.9374999999999998, 0.5375000000000001, 0.28750000000000003, 0.5374999999999999, 0.8375, 0.16250000000000003]
[11, 14, 37, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.6803, 'time@10': 9.6391}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.6803, 'time@10': 9.6391}:  10%|█         | 1/10 [00:04<00:43,  4.86s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9509, 'compress@10': 0.6526, 'time@10': 9.9217}:  10%|█         | 1/10 [00:15<00:43,  4.86s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9509, 'compress@10': 0.6526, 'time@10': 9.9217}:  20%|██        | 2/10 [00:15<01:04,  8.03s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9196, 'compress@10': 0.4934, 'time@10': 9.6546}:  20%|██        | 2/10 [00:19<01:04,  8.03s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9196, 'compress@10': 0.4934, 'time@10': 9.6546}:  30%|███       | 3/10 [00:19<00:45,  6.46s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9331, 'compress@10': 0.4724, 'time@10': 9.6284}:  30%|███       | 3/10 [00:29<00:45,  6.46s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9331, 'compress@10': 0.4724, 'time@10': 9.6284}:  40%|████      | 4/10 [00:29<00:46,  7.70s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9312, 'compress@10': 0.5657, 'time@10': 9.8003}:  40%|████      | 4/10 [00:34<00:46,  7.70s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9312, 'compress@10': 0.5657, 'time@10': 9.8003}:  50%|█████     | 5/10 [00:34<00:34,  6.82s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9386, 'compress@10': 0.5627, 'time@10': 9.9062}:  50%|█████     | 5/10 [00:45<00:34,  6.82s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.9386, 'compress@10': 0.5627, 'time@10': 9.9062}:  60%|██████    | 6/10 [00:45<00:32,  8.07s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9407, 'compress@10': 0.5275, 'time@10': 10.108}:  60%|██████    | 6/10 [00:50<00:32,  8.07s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9407, 'compress@10': 0.5275, 'time@10': 10.108}:  70%|███████   | 7/10 [00:50<00:21,  7.29s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.949, 'compress@10': 0.5304, 'time@10': 10.0832}:  70%|███████   | 7/10 [01:00<00:21,  7.29s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.949, 'compress@10': 0.5304, 'time@10': 10.0832}:  80%|████████  | 8/10 [01:00<00:16,  8.14s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9491, 'compress@10': 0.565, 'time@10': 10.2446}:  80%|████████  | 8/10 [01:06<00:16,  8.14s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9491, 'compress@10': 0.565, 'time@10': 10.2446}:  90%|█████████ | 9/10 [01:06<00:07,  7.41s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9484, 'compress@10': 0.5267, 'time@10': 10.2285}:  90%|█████████ | 9/10 [01:16<00:07,  7.41s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9484, 'compress@10': 0.5267, 'time@10': 10.2285}: 100%|██████████| 10/10 [01:16<00:00,  8.24s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9484, 'compress@10': 0.5267, 'time@10': 10.2285}: 100%|██████████| 10/10 [01:16<00:00,  7.66s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.013925460609099095
Avg hit ratio: 0.8809505459641283
Avg ndcg: 0.9483710495165811
Avg compression ratio: 0.5266537607422708
Avg train time: 10.228490447998047
Std train time: 0.7187726351089154
[0.6463414634146339, 0.6219512195121951, 0.03658536585365854, 0.4024390243902439, 0.9390243902439023, 0.5243902439024392, 0.2804878048780488, 0.5243902439024389, 0.8414634146341463, 0.1829268292682927]
[11, 14, 37, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.6649, 'time@10': 9.6398}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.6649, 'time@10': 9.6398}:  10%|█         | 1/10 [00:04<00:43,  4.85s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9512, 'compress@10': 0.6495, 'time@10': 9.9153}:  10%|█         | 1/10 [00:15<00:43,  4.85s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9512, 'compress@10': 0.6495, 'time@10': 9.9153}:  20%|██        | 2/10 [00:15<01:04,  8.03s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9199, 'compress@10': 0.4911, 'time@10': 9.7029}:  20%|██        | 2/10 [00:19<01:04,  8.03s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9199, 'compress@10': 0.4911, 'time@10': 9.7029}:  30%|███       | 3/10 [00:19<00:45,  6.50s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.933, 'compress@10': 0.4743, 'time@10': 9.7143}:  30%|███       | 3/10 [00:29<00:45,  6.50s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.933, 'compress@10': 0.4743, 'time@10': 9.7143}:  40%|████      | 4/10 [00:29<00:46,  7.80s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.9316, 'compress@10': 0.5675, 'time@10': 9.9067}:  40%|████      | 4/10 [00:34<00:46,  7.80s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.9316, 'compress@10': 0.5675, 'time@10': 9.9067}:  50%|█████     | 5/10 [00:34<00:34,  6.92s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9391, 'compress@10': 0.562, 'time@10': 10.0175}:  50%|█████     | 5/10 [00:45<00:34,  6.92s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9391, 'compress@10': 0.562, 'time@10': 10.0175}:  60%|██████    | 6/10 [00:45<00:32,  8.18s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9416, 'compress@10': 0.5259, 'time@10': 10.1776}:  60%|██████    | 6/10 [00:51<00:32,  8.18s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9416, 'compress@10': 0.5259, 'time@10': 10.1776}:  70%|███████   | 7/10 [00:51<00:22,  7.34s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9466, 'compress@10': 0.5274, 'time@10': 10.1583}:  70%|███████   | 7/10 [01:01<00:22,  7.34s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9466, 'compress@10': 0.5274, 'time@10': 10.1583}:  80%|████████  | 8/10 [01:01<00:16,  8.21s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9469, 'compress@10': 0.5628, 'time@10': 10.2692}:  80%|████████  | 8/10 [01:06<00:16,  8.21s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9469, 'compress@10': 0.5628, 'time@10': 10.2692}:  90%|█████████ | 9/10 [01:06<00:07,  7.40s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.9499, 'compress@10': 0.5267, 'time@10': 10.2312}:  90%|█████████ | 9/10 [01:16<00:07,  7.40s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.9499, 'compress@10': 0.5267, 'time@10': 10.2312}: 100%|██████████| 10/10 [01:16<00:00,  8.18s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.9499, 'compress@10': 0.5267, 'time@10': 10.2312}: 100%|██████████| 10/10 [01:16<00:00,  7.68s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.012287727192920048
Avg hit ratio: 0.883195809661005
Avg ndcg: 0.9499360543571622
Avg compression ratio: 0.526702115673463
Avg train time: 10.231242918968201
Std train time: 0.6038221139121032
[0.6309523809523807, 0.6309523809523809, 0.03571428571428572, 0.4166666666666667, 0.9404761904761904, 0.5119047619047621, 0.27380952380952384, 0.5357142857142856, 0.8452380952380952, 0.1785714285714286]
[11, 14, 37, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.6504, 'time@10': 9.4152}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.6504, 'time@10': 9.4152}:  10%|█         | 1/10 [00:04<00:42,  4.74s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9754, 'compress@10': 0.6466, 'time@10': 9.8601}:  10%|█         | 1/10 [00:15<00:42,  4.74s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9754, 'compress@10': 0.6466, 'time@10': 9.8601}:  20%|██        | 2/10 [00:15<01:04,  8.04s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.936, 'compress@10': 0.4889, 'time@10': 9.5357}:  20%|██        | 2/10 [00:19<01:04,  8.04s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.936, 'compress@10': 0.4889, 'time@10': 9.5357}:  30%|███       | 3/10 [00:19<00:44,  6.41s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.943, 'compress@10': 0.476, 'time@10': 9.6044}:  30%|███       | 3/10 [00:29<00:44,  6.41s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.943, 'compress@10': 0.476, 'time@10': 9.6044}:  40%|████      | 4/10 [00:29<00:46,  7.77s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.94, 'compress@10': 0.5692, 'time@10': 9.8053}:  40%|████      | 4/10 [00:34<00:46,  7.77s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.94, 'compress@10': 0.5692, 'time@10': 9.8053}:  50%|█████     | 5/10 [00:34<00:34,  6.89s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9478, 'compress@10': 0.5614, 'time@10': 9.9217}:  50%|█████     | 5/10 [00:45<00:34,  6.89s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9478, 'compress@10': 0.5614, 'time@10': 9.9217}:  60%|██████    | 6/10 [00:45<00:32,  8.13s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9506, 'compress@10': 0.5245, 'time@10': 10.1151}:  60%|██████    | 6/10 [00:50<00:32,  8.13s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9506, 'compress@10': 0.5245, 'time@10': 10.1151}:  70%|███████   | 7/10 [00:50<00:21,  7.33s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9526, 'compress@10': 0.5276, 'time@10': 10.0909}:  70%|███████   | 7/10 [01:00<00:21,  7.33s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9526, 'compress@10': 0.5276, 'time@10': 10.0909}:  80%|████████  | 8/10 [01:00<00:16,  8.17s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9534, 'compress@10': 0.5633, 'time@10': 10.2691}:  80%|████████  | 8/10 [01:06<00:16,  8.17s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9534, 'compress@10': 0.5633, 'time@10': 10.2691}:  90%|█████████ | 9/10 [01:06<00:07,  7.45s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9535, 'compress@10': 0.5267, 'time@10': 10.2453}:  90%|█████████ | 9/10 [01:16<00:07,  7.45s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9535, 'compress@10': 0.5267, 'time@10': 10.2453}: 100%|██████████| 10/10 [01:16<00:00,  8.26s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9535, 'compress@10': 0.5267, 'time@10': 10.2453}: 100%|██████████| 10/10 [01:16<00:00,  7.69s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.01737894709281112
Avg hit ratio: 0.8787441967577792
Avg ndcg: 0.953497852065557
Avg compression ratio: 0.5267328668284548
Avg train time: 10.245315551757812
Std train time: 0.7899385991099168
[0.6162790697674416, 0.6395348837209303, 0.034883720930232565, 0.4069767441860465, 0.9186046511627906, 0.5232558139534885, 0.2674418604651163, 0.5465116279069766, 0.8488372093023255, 0.19767441860465118]
[11, 14, 38, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 0.6365, 'time@10': 9.7339}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 0.6365, 'time@10': 9.7339}:  10%|█         | 1/10 [00:04<00:44,  4.90s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9859, 'compress@10': 0.6438, 'time@10': 9.9229}:  10%|█         | 1/10 [00:15<00:44,  4.90s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9859, 'compress@10': 0.6438, 'time@10': 9.9229}:  20%|██        | 2/10 [00:15<01:03,  7.99s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.943, 'compress@10': 0.4868, 'time@10': 9.6665}:  20%|██        | 2/10 [00:19<01:03,  7.99s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.943, 'compress@10': 0.4868, 'time@10': 9.6665}:  30%|███       | 3/10 [00:19<00:45,  6.45s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9679, 'compress@10': 0.4721, 'time@10': 9.6639}:  30%|███       | 3/10 [00:29<00:45,  6.45s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9679, 'compress@10': 0.4721, 'time@10': 9.6639}:  40%|████      | 4/10 [00:29<00:46,  7.73s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9599, 'compress@10': 0.5618, 'time@10': 9.813}:  40%|████      | 4/10 [00:34<00:46,  7.73s/it] {'epoch': 42, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9599, 'compress@10': 0.5618, 'time@10': 9.813}:  50%|█████     | 5/10 [00:34<00:34,  6.83s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9627, 'compress@10': 0.5571, 'time@10': 9.9562}:  50%|█████     | 5/10 [00:45<00:34,  6.83s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9627, 'compress@10': 0.5571, 'time@10': 9.9562}:  60%|██████    | 6/10 [00:45<00:32,  8.15s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9645, 'compress@10': 0.5199, 'time@10': 10.1604}:  60%|██████    | 6/10 [00:51<00:32,  8.15s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9645, 'compress@10': 0.5199, 'time@10': 10.1604}:  70%|███████   | 7/10 [00:51<00:22,  7.36s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.966, 'compress@10': 0.5249, 'time@10': 10.13}:  70%|███████   | 7/10 [01:01<00:22,  7.36s/it]    {'epoch': 42, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.966, 'compress@10': 0.5249, 'time@10': 10.13}:  80%|████████  | 8/10 [01:01<00:16,  8.19s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9646, 'compress@10': 0.5613, 'time@10': 10.2139}:  80%|████████  | 8/10 [01:06<00:16,  8.19s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9646, 'compress@10': 0.5613, 'time@10': 10.2139}:  90%|█████████ | 9/10 [01:06<00:07,  7.34s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9656, 'compress@10': 0.5268, 'time@10': 10.1691}:  90%|█████████ | 9/10 [01:16<00:07,  7.34s/it]  {'epoch': 42, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9656, 'compress@10': 0.5268, 'time@10': 10.1691}: 100%|██████████| 10/10 [01:16<00:00,  8.10s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9656, 'compress@10': 0.5268, 'time@10': 10.1691}: 100%|██████████| 10/10 [01:16<00:00,  7.63s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.015076258870349007
Avg hit ratio: 0.905060120976929
Avg ndcg: 0.9656089968933366
Avg compression ratio: 0.5267878836421878
Avg train time: 10.169067239761352
Std train time: 0.6336748903595025
[0.6022727272727271, 0.6477272727272727, 0.034090909090909095, 0.42045454545454547, 0.9204545454545453, 0.5113636363636365, 0.2840909090909091, 0.534090909090909, 0.8522727272727272, 0.1931818181818182]
[11, 14, 38, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6232, 'time@10': 9.4237}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6232, 'time@10': 9.4237}:  10%|█         | 1/10 [00:04<00:42,  4.75s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9522, 'compress@10': 0.6411, 'time@10': 9.6672}:  10%|█         | 1/10 [00:14<00:42,  4.75s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9522, 'compress@10': 0.6411, 'time@10': 9.6672}:  20%|██        | 2/10 [00:14<01:02,  7.81s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9205, 'compress@10': 0.4848, 'time@10': 9.5602}:  20%|██        | 2/10 [00:19<01:02,  7.81s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9205, 'compress@10': 0.4848, 'time@10': 9.5602}:  30%|███       | 3/10 [00:19<00:44,  6.40s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9314, 'compress@10': 0.4739, 'time@10': 9.5758}:  30%|███       | 3/10 [00:29<00:44,  6.40s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9314, 'compress@10': 0.4739, 'time@10': 9.5758}:  40%|████      | 4/10 [00:29<00:46,  7.69s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9316, 'compress@10': 0.5635, 'time@10': 9.7791}:  40%|████      | 4/10 [00:34<00:46,  7.69s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9316, 'compress@10': 0.5635, 'time@10': 9.7791}:  50%|█████     | 5/10 [00:34<00:34,  6.84s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.939, 'compress@10': 0.5566, 'time@10': 9.9367}:  50%|█████     | 5/10 [00:45<00:34,  6.84s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.939, 'compress@10': 0.5566, 'time@10': 9.9367}:  60%|██████    | 6/10 [00:45<00:32,  8.17s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9413, 'compress@10': 0.5218, 'time@10': 10.1455}:  60%|██████    | 6/10 [00:50<00:32,  8.17s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9413, 'compress@10': 0.5218, 'time@10': 10.1455}:  70%|███████   | 7/10 [00:50<00:22,  7.38s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9542, 'compress@10': 0.525, 'time@10': 10.1171}:  70%|███████   | 7/10 [01:00<00:22,  7.38s/it]  {'epoch': 43, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9542, 'compress@10': 0.525, 'time@10': 10.1171}:  80%|████████  | 8/10 [01:00<00:16,  8.20s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9541, 'compress@10': 0.5618, 'time@10': 10.2225}:  80%|████████  | 8/10 [01:06<00:16,  8.20s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9541, 'compress@10': 0.5618, 'time@10': 10.2225}:  90%|█████████ | 9/10 [01:06<00:07,  7.38s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9564, 'compress@10': 0.5268, 'time@10': 10.219}:  90%|█████████ | 9/10 [01:16<00:07,  7.38s/it]    {'epoch': 43, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9564, 'compress@10': 0.5268, 'time@10': 10.219}: 100%|██████████| 10/10 [01:16<00:00,  8.26s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9564, 'compress@10': 0.5268, 'time@10': 10.219}: 100%|██████████| 10/10 [01:16<00:00,  7.67s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.011880935464698355
Avg hit ratio: 0.8785219745355569
Avg ndcg: 0.9564320031469024
Avg compression ratio: 0.5267901441843161
Avg train time: 10.219015955924988
Std train time: 0.6662705376934314
[0.6111111111111109, 0.6555555555555556, 0.03333333333333334, 0.41111111111111115, 0.922222222222222, 0.5000000000000001, 0.2777777777777778, 0.5444444444444443, 0.8555555555555555, 0.1888888888888889]
[11, 14, 38, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6316, 'time@10': 9.4629}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6316, 'time@10': 9.4629}:  10%|█         | 1/10 [00:04<00:42,  4.77s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9527, 'compress@10': 0.6491, 'time@10': 9.8115}:  10%|█         | 1/10 [00:14<00:42,  4.77s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9527, 'compress@10': 0.6491, 'time@10': 9.8115}:  20%|██        | 2/10 [00:14<01:03,  7.96s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9209, 'compress@10': 0.4899, 'time@10': 9.652}:  20%|██        | 2/10 [00:19<01:03,  7.96s/it]  {'epoch': 44, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9209, 'compress@10': 0.4899, 'time@10': 9.652}:  30%|███       | 3/10 [00:19<00:45,  6.48s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9317, 'compress@10': 0.4755, 'time@10': 9.6624}:  30%|███       | 3/10 [00:29<00:45,  6.48s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9317, 'compress@10': 0.4755, 'time@10': 9.6624}:  40%|████      | 4/10 [00:29<00:46,  7.76s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9319, 'compress@10': 0.5651, 'time@10': 9.875}:  40%|████      | 4/10 [00:34<00:46,  7.76s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9319, 'compress@10': 0.5651, 'time@10': 9.875}:  50%|█████     | 5/10 [00:34<00:34,  6.91s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9401, 'compress@10': 0.5561, 'time@10': 10.0137}:  50%|█████     | 5/10 [00:45<00:34,  6.91s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9401, 'compress@10': 0.5561, 'time@10': 10.0137}:  60%|██████    | 6/10 [00:45<00:32,  8.22s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9425, 'compress@10': 0.5205, 'time@10': 10.2543}:  60%|██████    | 6/10 [00:51<00:32,  8.22s/it] {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9425, 'compress@10': 0.5205, 'time@10': 10.2543}:  70%|███████   | 7/10 [00:51<00:22,  7.45s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9427, 'compress@10': 0.5251, 'time@10': 10.1802}:  70%|███████   | 7/10 [01:01<00:22,  7.45s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9427, 'compress@10': 0.5251, 'time@10': 10.1802}:  80%|████████  | 8/10 [01:01<00:16,  8.17s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9438, 'compress@10': 0.5623, 'time@10': 10.2874}:  80%|████████  | 8/10 [01:06<00:16,  8.17s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9438, 'compress@10': 0.5623, 'time@10': 10.2874}:  90%|█████████ | 9/10 [01:06<00:07,  7.37s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9474, 'compress@10': 0.5268, 'time@10': 10.263}:  90%|█████████ | 9/10 [01:16<00:07,  7.37s/it]    {'epoch': 44, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9474, 'compress@10': 0.5268, 'time@10': 10.263}: 100%|██████████| 10/10 [01:16<00:00,  8.21s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9474, 'compress@10': 0.5268, 'time@10': 10.263}: 100%|██████████| 10/10 [01:16<00:00,  7.68s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.01542566188535589
Avg hit ratio: 0.9111359018269034
Avg ndcg: 0.9473530998048686
Avg compression ratio: 0.526781358706356
Avg train time: 10.263009834289551
Std train time: 0.7415069184680843
[0.6195652173913042, 0.6413043478260869, 0.03260869565217392, 0.40217391304347827, 0.902173913043478, 0.5108695652173915, 0.2717391304347826, 0.5543478260869563, 0.858695652173913, 0.2065217391304348]
[11, 14, 38, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6396, 'time@10': 9.5278}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6396, 'time@10': 9.5278}:  10%|█         | 1/10 [00:04<00:43,  4.80s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0131, 'compress@10': 0.6462, 'time@10': 9.8688}:  10%|█         | 1/10 [00:15<00:43,  4.80s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0131, 'compress@10': 0.6462, 'time@10': 9.8688}:  20%|██        | 2/10 [00:15<01:04,  8.01s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9611, 'compress@10': 0.4878, 'time@10': 9.7737}:  20%|██        | 2/10 [00:19<01:04,  8.01s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9611, 'compress@10': 0.4878, 'time@10': 9.7737}:  30%|███       | 3/10 [00:19<00:45,  6.55s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.967, 'compress@10': 0.4717, 'time@10': 9.7311}:  30%|███       | 3/10 [00:29<00:45,  6.55s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.967, 'compress@10': 0.4717, 'time@10': 9.7311}:  40%|████      | 4/10 [00:29<00:46,  7.77s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9608, 'compress@10': 0.5582, 'time@10': 10.1157}:  40%|████      | 4/10 [00:35<00:46,  7.77s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9608, 'compress@10': 0.5582, 'time@10': 10.1157}:  50%|█████     | 5/10 [00:35<00:35,  7.09s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9631, 'compress@10': 0.5521, 'time@10': 10.2249}:  50%|█████     | 5/10 [00:46<00:35,  7.09s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9631, 'compress@10': 0.5521, 'time@10': 10.2249}:  60%|██████    | 6/10 [00:46<00:33,  8.35s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9637, 'compress@10': 0.5162, 'time@10': 10.3443}:  60%|██████    | 6/10 [00:51<00:33,  8.35s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9637, 'compress@10': 0.5162, 'time@10': 10.3443}:  70%|███████   | 7/10 [00:51<00:22,  7.44s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9646, 'compress@10': 0.5226, 'time@10': 10.2714}:  70%|███████   | 7/10 [01:01<00:22,  7.44s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9646, 'compress@10': 0.5226, 'time@10': 10.2714}:  80%|████████  | 8/10 [01:01<00:16,  8.19s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9641, 'compress@10': 0.5604, 'time@10': 10.3185}:  80%|████████  | 8/10 [01:06<00:16,  8.19s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9641, 'compress@10': 0.5604, 'time@10': 10.3185}:  90%|█████████ | 9/10 [01:06<00:07,  7.31s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9648, 'compress@10': 0.5268, 'time@10': 10.3047}:  90%|█████████ | 9/10 [01:17<00:07,  7.31s/it]    {'epoch': 45, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9648, 'compress@10': 0.5268, 'time@10': 10.3047}: 100%|██████████| 10/10 [01:17<00:00,  8.21s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9648, 'compress@10': 0.5268, 'time@10': 10.3047}: 100%|██████████| 10/10 [01:17<00:00,  7.72s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.014025694283565024
Avg hit ratio: 0.8966684159078048
Avg ndcg: 0.9647600021654631
Avg compression ratio: 0.5267879449731144
Avg train time: 10.304741358757019
Std train time: 0.685464745159253
[0.6063829787234041, 0.648936170212766, 0.03191489361702128, 0.4148936170212766, 0.8829787234042551, 0.521276595744681, 0.28723404255319146, 0.5425531914893615, 0.8617021276595744, 0.2021276595744681]
[11, 14, 38, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6271, 'time@10': 9.7756}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6271, 'time@10': 9.7756}:  10%|█         | 1/10 [00:04<00:44,  4.92s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9751, 'compress@10': 0.6437, 'time@10': 9.8368}:  10%|█         | 1/10 [00:14<00:44,  4.92s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9751, 'compress@10': 0.6437, 'time@10': 9.8368}:  20%|██        | 2/10 [00:14<01:02,  7.87s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7705, 'ndcg@10': 0.9358, 'compress@10': 0.4859, 'time@10': 9.6534}:  20%|██        | 2/10 [00:19<01:02,  7.87s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7705, 'ndcg@10': 0.9358, 'compress@10': 0.4859, 'time@10': 9.6534}:  30%|███       | 3/10 [00:19<00:44,  6.41s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.9429, 'compress@10': 0.4733, 'time@10': 9.6105}:  30%|███       | 3/10 [00:29<00:44,  6.41s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.9429, 'compress@10': 0.4733, 'time@10': 9.6105}:  40%|████      | 4/10 [00:29<00:45,  7.64s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.942, 'compress@10': 0.5557, 'time@10': 9.9134}:  40%|████      | 4/10 [00:34<00:45,  7.64s/it]  {'epoch': 46, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.942, 'compress@10': 0.5557, 'time@10': 9.9134}:  50%|█████     | 5/10 [00:34<00:34,  6.90s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.9478, 'compress@10': 0.5518, 'time@10': 9.9622}:  50%|█████     | 5/10 [00:44<00:34,  6.90s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.9478, 'compress@10': 0.5518, 'time@10': 9.9622}:  60%|██████    | 6/10 [00:44<00:32,  8.04s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9514, 'compress@10': 0.518, 'time@10': 10.0937}:  60%|██████    | 6/10 [00:50<00:32,  8.04s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9514, 'compress@10': 0.518, 'time@10': 10.0937}:  70%|███████   | 7/10 [00:50<00:21,  7.20s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9601, 'compress@10': 0.5227, 'time@10': 9.9941}:  70%|███████   | 7/10 [00:59<00:21,  7.20s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9601, 'compress@10': 0.5227, 'time@10': 9.9941}:  80%|████████  | 8/10 [00:59<00:15,  7.88s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9597, 'compress@10': 0.5608, 'time@10': 10.0214}:  80%|████████  | 8/10 [01:04<00:15,  7.88s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9597, 'compress@10': 0.5608, 'time@10': 10.0214}:  90%|█████████ | 9/10 [01:04<00:07,  7.03s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9611, 'compress@10': 0.5268, 'time@10': 9.9419}:  90%|█████████ | 9/10 [01:14<00:07,  7.03s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9611, 'compress@10': 0.5268, 'time@10': 9.9419}: 100%|██████████| 10/10 [01:14<00:00,  7.72s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9611, 'compress@10': 0.5268, 'time@10': 9.9419}: 100%|██████████| 10/10 [01:14<00:00,  7.41s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.01437302324056845
Avg hit ratio: 0.8771394860562942
Avg ndcg: 0.9610923063222799
Avg compression ratio: 0.5267863734364959
Avg train time: 9.941917228698731
Std train time: 0.6356410355351527
[0.5937499999999998, 0.65625, 0.03125000000000001, 0.40625, 0.8645833333333331, 0.5104166666666669, 0.3020833333333333, 0.5520833333333331, 0.8645833333333333, 0.21875]
[11, 14, 38, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6151, 'time@10': 9.0425}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6151, 'time@10': 9.0425}:  10%|█         | 1/10 [00:04<00:41,  4.56s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9547, 'compress@10': 0.6412, 'time@10': 9.2768}:  10%|█         | 1/10 [00:14<00:41,  4.56s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9547, 'compress@10': 0.6412, 'time@10': 9.2768}:  20%|██        | 2/10 [00:14<00:59,  7.49s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9222, 'compress@10': 0.484, 'time@10': 8.7531}:  20%|██        | 2/10 [00:17<00:59,  7.49s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9222, 'compress@10': 0.484, 'time@10': 8.7531}:  30%|███       | 3/10 [00:17<00:40,  5.85s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9313, 'compress@10': 0.4699, 'time@10': 8.7163}:  30%|███       | 3/10 [00:26<00:40,  5.85s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9313, 'compress@10': 0.4699, 'time@10': 8.7163}:  40%|████      | 4/10 [00:26<00:41,  6.95s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9335, 'compress@10': 0.5494, 'time@10': 9.0234}:  40%|████      | 4/10 [00:31<00:41,  6.95s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9335, 'compress@10': 0.5494, 'time@10': 9.0234}:  50%|█████     | 5/10 [00:31<00:31,  6.31s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0101, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9407, 'compress@10': 0.5447, 'time@10': 9.0821}:  50%|█████     | 5/10 [00:41<00:31,  6.31s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0101, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9407, 'compress@10': 0.5447, 'time@10': 9.0821}:  60%|██████    | 6/10 [00:41<00:29,  7.36s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9427, 'compress@10': 0.514, 'time@10': 9.3366}:  60%|██████    | 6/10 [00:46<00:29,  7.36s/it] {'epoch': 47, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9427, 'compress@10': 0.514, 'time@10': 9.3366}:  70%|███████   | 7/10 [00:46<00:20,  6.74s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9434, 'compress@10': 0.5204, 'time@10': 9.2733}:  70%|███████   | 7/10 [00:55<00:20,  6.74s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9434, 'compress@10': 0.5204, 'time@10': 9.2733}:  80%|████████  | 8/10 [00:55<00:14,  7.42s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.945, 'compress@10': 0.559, 'time@10': 9.3268}:  80%|████████  | 8/10 [01:00<00:14,  7.42s/it]  {'epoch': 47, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.945, 'compress@10': 0.559, 'time@10': 9.3268}:  90%|█████████ | 9/10 [01:00<00:06,  6.64s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9485, 'compress@10': 0.5268, 'time@10': 9.355}:  90%|█████████ | 9/10 [01:10<00:06,  6.64s/it] {'epoch': 47, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9485, 'compress@10': 0.5268, 'time@10': 9.355}: 100%|██████████| 10/10 [01:10<00:00,  7.57s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9485, 'compress@10': 0.5268, 'time@10': 9.355}: 100%|██████████| 10/10 [01:10<00:00,  7.01s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.011906246022644826
Avg hit ratio: 0.8820934031069856
Avg ndcg: 0.948549414147441
Avg compression ratio: 0.5267954927910233
Avg train time: 9.35497784614563
Std train time: 0.8356257679607126
[0.5816326530612242, 0.6632653061224489, 0.03061224489795919, 0.41836734693877553, 0.8673469387755101, 0.5000000000000002, 0.29591836734693877, 0.5612244897959182, 0.8673469387755102, 0.21428571428571427]
[11, 14, 39, 16, 5, 10, 10, 13, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6036, 'time@10': 8.5892}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.6036, 'time@10': 8.5892}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9527, 'compress@10': 0.6389, 'time@10': 9.0525}:  10%|█         | 1/10 [00:13<00:38,  4.33s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9527, 'compress@10': 0.6389, 'time@10': 9.0525}:  20%|██        | 2/10 [00:13<00:59,  7.40s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9209, 'compress@10': 0.4823, 'time@10': 8.9172}:  20%|██        | 2/10 [00:18<00:59,  7.40s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9209, 'compress@10': 0.4823, 'time@10': 8.9172}:  30%|███       | 3/10 [00:18<00:42,  6.01s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9313, 'compress@10': 0.4715, 'time@10': 8.9399}:  30%|███       | 3/10 [00:27<00:42,  6.01s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9313, 'compress@10': 0.4715, 'time@10': 8.9399}:  40%|████      | 4/10 [00:27<00:43,  7.21s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9342, 'compress@10': 0.5512, 'time@10': 9.1675}:  40%|████      | 4/10 [00:32<00:43,  7.21s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9342, 'compress@10': 0.5512, 'time@10': 9.1675}:  50%|█████     | 5/10 [00:32<00:32,  6.44s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9394, 'compress@10': 0.5445, 'time@10': 9.1909}:  50%|█████     | 5/10 [00:41<00:32,  6.44s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9394, 'compress@10': 0.5445, 'time@10': 9.1909}:  60%|██████    | 6/10 [00:41<00:29,  7.43s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9422, 'compress@10': 0.513, 'time@10': 9.3389}:  60%|██████    | 6/10 [00:46<00:29,  7.43s/it]  {'epoch': 48, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9422, 'compress@10': 0.513, 'time@10': 9.3389}:  70%|███████   | 7/10 [00:46<00:20,  6.68s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9436, 'compress@10': 0.5206, 'time@10': 9.4089}:  70%|███████   | 7/10 [00:56<00:20,  6.68s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9436, 'compress@10': 0.5206, 'time@10': 9.4089}:  80%|████████  | 8/10 [00:56<00:15,  7.72s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.945, 'compress@10': 0.5596, 'time@10': 9.4249}:  80%|████████  | 8/10 [01:01<00:15,  7.72s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.945, 'compress@10': 0.5596, 'time@10': 9.4249}:  90%|█████████ | 9/10 [01:01<00:06,  6.81s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9457, 'compress@10': 0.5268, 'time@10': 9.3318}:  90%|█████████ | 9/10 [01:10<00:06,  6.81s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9457, 'compress@10': 0.5268, 'time@10': 9.3318}: 100%|██████████| 10/10 [01:10<00:00,  7.34s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9457, 'compress@10': 0.5268, 'time@10': 9.3318}: 100%|██████████| 10/10 [01:10<00:00,  7.01s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.014320175189266449
Avg hit ratio: 0.9054216161126177
Avg ndcg: 0.9457026401000386
Avg compression ratio: 0.526821243790021
Avg train time: 9.331800174713134
Std train time: 0.5992190500880883
[0.5699999999999997, 0.6499999999999999, 0.030000000000000006, 0.43, 0.8499999999999999, 0.5100000000000002, 0.29, 0.5699999999999998, 0.87, 0.22999999999999998]
[12, 14, 40, 16, 5, 10, 10, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.5926, 'time@10': 9.1765}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.5926, 'time@10': 9.1765}:  10%|█         | 1/10 [00:04<00:41,  4.62s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9931, 'compress@10': 0.627, 'time@10': 8.7715}:  10%|█         | 1/10 [00:13<00:41,  4.62s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9931, 'compress@10': 0.627, 'time@10': 8.7715}:  20%|██        | 2/10 [00:13<00:54,  6.85s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9478, 'compress@10': 0.4742, 'time@10': 8.5823}:  20%|██        | 2/10 [00:17<00:54,  6.85s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9478, 'compress@10': 0.4742, 'time@10': 8.5823}:  30%|███       | 3/10 [00:17<00:39,  5.61s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.9519, 'compress@10': 0.4682, 'time@10': 8.5642}:  30%|███       | 3/10 [00:25<00:39,  5.61s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.9519, 'compress@10': 0.4682, 'time@10': 8.5642}:  40%|████      | 4/10 [00:25<00:40,  6.77s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9509, 'compress@10': 0.5452, 'time@10': 8.9251}:  40%|████      | 4/10 [00:30<00:40,  6.77s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9509, 'compress@10': 0.5452, 'time@10': 8.9251}:  50%|█████     | 5/10 [00:30<00:31,  6.21s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9552, 'compress@10': 0.5411, 'time@10': 9.0153}:  50%|█████     | 5/10 [00:40<00:31,  6.21s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9552, 'compress@10': 0.5411, 'time@10': 9.0153}:  60%|██████    | 6/10 [00:40<00:29,  7.33s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9559, 'compress@10': 0.5093, 'time@10': 9.1316}:  60%|██████    | 6/10 [00:45<00:29,  7.33s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9559, 'compress@10': 0.5093, 'time@10': 9.1316}:  70%|███████   | 7/10 [00:45<00:19,  6.55s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9578, 'compress@10': 0.5184, 'time@10': 9.1132}:  70%|███████   | 7/10 [00:54<00:19,  6.55s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9578, 'compress@10': 0.5184, 'time@10': 9.1132}:  80%|████████  | 8/10 [00:54<00:14,  7.34s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9585, 'compress@10': 0.5579, 'time@10': 9.1291}:  80%|████████  | 8/10 [00:59<00:14,  7.34s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9585, 'compress@10': 0.5579, 'time@10': 9.1291}:  90%|█████████ | 9/10 [00:59<00:06,  6.50s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9603, 'compress@10': 0.5269, 'time@10': 9.1158}:  90%|█████████ | 9/10 [01:08<00:06,  6.50s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9603, 'compress@10': 0.5269, 'time@10': 9.1158}: 100%|██████████| 10/10 [01:08<00:00,  7.28s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9603, 'compress@10': 0.5269, 'time@10': 9.1158}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.008777433795803043
Avg hit ratio: 0.8892362602498427
Avg ndcg: 0.9603454536377353
Avg compression ratio: 0.5268597632039251
Avg train time: 9.115789651870728
Std train time: 0.6337603871422415
[0.5784313725490193, 0.6568627450980391, 0.02941176470588236, 0.4215686274509804, 0.8529411764705881, 0.5000000000000002, 0.30392156862745096, 0.5588235294117645, 0.8725490196078431, 0.22549019607843135]
[12, 15, 41, 17, 5, 10, 10, 13, 7, 11]
