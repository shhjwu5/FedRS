  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1985, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5342, 'compress@10': 0.999, 'time@10': 6.1921}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1985, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5342, 'compress@10': 0.999, 'time@10': 6.1921}:  10%|█         | 1/10 [00:03<00:28,  3.14s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.144, 'hit_ratio@10': 0.5756, 'ndcg@10': 0.6078, 'compress@10': 0.999, 'time@10': 5.1781}:  10%|█         | 1/10 [00:07<00:28,  3.14s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.144, 'hit_ratio@10': 0.5756, 'ndcg@10': 0.6078, 'compress@10': 0.999, 'time@10': 5.1781}:  20%|██        | 2/10 [00:07<00:30,  3.77s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8703, 'hit_ratio@10': 0.4313, 'ndcg@10': 0.4052, 'compress@10': 0.999, 'time@10': 4.0073}:  20%|██        | 2/10 [00:08<00:30,  3.77s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8703, 'hit_ratio@10': 0.4313, 'ndcg@10': 0.4052, 'compress@10': 0.999, 'time@10': 4.0073}:  30%|███       | 3/10 [00:08<00:17,  2.45s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6844, 'hit_ratio@10': 0.511, 'ndcg@10': 0.4479, 'compress@10': 0.999, 'time@10': 3.9361}:  30%|███       | 3/10 [00:11<00:17,  2.45s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.6844, 'hit_ratio@10': 0.511, 'ndcg@10': 0.4479, 'compress@10': 0.999, 'time@10': 3.9361}:  40%|████      | 4/10 [00:11<00:17,  2.97s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5666, 'hit_ratio@10': 0.5728, 'ndcg@10': 0.5039, 'compress@10': 0.999, 'time@10': 5.8879}:  40%|████      | 4/10 [00:18<00:17,  2.97s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5666, 'hit_ratio@10': 0.5728, 'ndcg@10': 0.5039, 'compress@10': 0.999, 'time@10': 5.8879}:  50%|█████     | 5/10 [00:18<00:21,  4.38s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4871, 'hit_ratio@10': 0.5958, 'ndcg@10': 0.5463, 'compress@10': 0.9991, 'time@10': 5.9384}:  50%|█████     | 5/10 [00:25<00:21,  4.38s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4871, 'hit_ratio@10': 0.5958, 'ndcg@10': 0.5463, 'compress@10': 0.9991, 'time@10': 5.9384}:  60%|██████    | 6/10 [00:25<00:20,  5.01s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4366, 'hit_ratio@10': 0.6022, 'ndcg@10': 0.5465, 'compress@10': 0.9991, 'time@10': 6.0529}:  60%|██████    | 6/10 [00:28<00:20,  5.01s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4366, 'hit_ratio@10': 0.6022, 'ndcg@10': 0.5465, 'compress@10': 0.9991, 'time@10': 6.0529}:  70%|███████   | 7/10 [00:28<00:13,  4.49s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3896, 'hit_ratio@10': 0.6376, 'ndcg@10': 0.5732, 'compress@10': 0.9991, 'time@10': 5.8895}:  70%|███████   | 7/10 [00:33<00:13,  4.49s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3896, 'hit_ratio@10': 0.6376, 'ndcg@10': 0.5732, 'compress@10': 0.9991, 'time@10': 5.8895}:  80%|████████  | 8/10 [00:33<00:09,  4.58s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3528, 'hit_ratio@10': 0.6493, 'ndcg@10': 0.6095, 'compress@10': 0.9991, 'time@10': 6.2954}:  80%|████████  | 8/10 [00:38<00:09,  4.58s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3528, 'hit_ratio@10': 0.6493, 'ndcg@10': 0.6095, 'compress@10': 0.9991, 'time@10': 6.2954}:  90%|█████████ | 9/10 [00:38<00:04,  4.65s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.323, 'hit_ratio@10': 0.6775, 'ndcg@10': 0.6313, 'compress@10': 0.9991, 'time@10': 6.2302}:  90%|█████████ | 9/10 [00:43<00:04,  4.65s/it]    {'epoch': 0, 'num_users': 6.3, 'loss': 0.323, 'hit_ratio@10': 0.6775, 'ndcg@10': 0.6313, 'compress@10': 0.9991, 'time@10': 6.2302}: 100%|██████████| 10/10 [00:43<00:00,  4.97s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.323, 'hit_ratio@10': 0.6775, 'ndcg@10': 0.6313, 'compress@10': 0.9991, 'time@10': 6.2302}: 100%|██████████| 10/10 [00:43<00:00,  4.38s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3229851384927267
Avg hit ratio: 0.6775461429722889
Avg ndcg: 0.631251867122035
Avg compression ratio: 0.9991133249540958
Avg train time: 6.230198192596435
Std train time: 3.176588459861405
[0.95, 0.45, 0.95, 0.95, 0.95, 0.45, 0.95, 0.45, 0.45, 0.45]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0561, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8391, 'compress@10': 0.9997, 'time@10': 5.0535}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0561, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8391, 'compress@10': 0.9997, 'time@10': 5.0535}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0548, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8433, 'compress@10': 0.632, 'time@10': 4.6064}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it] {'epoch': 1, 'num_users': 7.0, 'loss': 0.0548, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8433, 'compress@10': 0.632, 'time@10': 4.6064}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0468, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.7904, 'compress@10': 0.7546, 'time@10': 3.666}:  20%|██        | 2/10 [00:07<00:28,  3.53s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0468, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.7904, 'compress@10': 0.7546, 'time@10': 3.666}:  30%|███       | 3/10 [00:07<00:16,  2.34s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0478, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8038, 'compress@10': 0.8159, 'time@10': 3.6854}:  30%|███       | 3/10 [00:11<00:16,  2.34s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0478, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8038, 'compress@10': 0.8159, 'time@10': 3.6854}:  40%|████      | 4/10 [00:11<00:17,  2.91s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0559, 'hit_ratio@10': 0.7901, 'ndcg@10': 0.7997, 'compress@10': 0.8527, 'time@10': 5.377}:  40%|████      | 4/10 [00:17<00:17,  2.91s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.0559, 'hit_ratio@10': 0.7901, 'ndcg@10': 0.7997, 'compress@10': 0.8527, 'time@10': 5.377}:  50%|█████     | 5/10 [00:17<00:20,  4.06s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0595, 'hit_ratio@10': 0.7806, 'ndcg@10': 0.8017, 'compress@10': 0.7551, 'time@10': 5.5022}:  50%|█████     | 5/10 [00:23<00:20,  4.06s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0595, 'hit_ratio@10': 0.7806, 'ndcg@10': 0.8017, 'compress@10': 0.7551, 'time@10': 5.5022}:  60%|██████    | 6/10 [00:23<00:19,  4.78s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0574, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.811, 'compress@10': 0.7901, 'time@10': 5.6602}:  60%|██████    | 6/10 [00:27<00:19,  4.78s/it] {'epoch': 1, 'num_users': 6.2857, 'loss': 0.0574, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.811, 'compress@10': 0.7901, 'time@10': 5.6602}:  70%|███████   | 7/10 [00:27<00:12,  4.31s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0549, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8193, 'compress@10': 0.7153, 'time@10': 5.5338}:  70%|███████   | 7/10 [00:31<00:12,  4.31s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0549, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8193, 'compress@10': 0.7153, 'time@10': 5.5338}:  80%|████████  | 8/10 [00:31<00:08,  4.43s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0528, 'hit_ratio@10': 0.808, 'ndcg@10': 0.8297, 'compress@10': 0.6685, 'time@10': 5.8572}:  80%|████████  | 8/10 [00:36<00:08,  4.43s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0528, 'hit_ratio@10': 0.808, 'ndcg@10': 0.8297, 'compress@10': 0.6685, 'time@10': 5.8572}:  90%|█████████ | 9/10 [00:36<00:04,  4.38s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0521, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8313, 'compress@10': 0.6201, 'time@10': 5.8295}:  90%|█████████ | 9/10 [00:41<00:04,  4.38s/it]  {'epoch': 1, 'num_users': 6.3, 'loss': 0.0521, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8313, 'compress@10': 0.6201, 'time@10': 5.8295}: 100%|██████████| 10/10 [00:41<00:00,  4.77s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0521, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8313, 'compress@10': 0.6201, 'time@10': 5.8295}: 100%|██████████| 10/10 [00:41<00:00,  4.17s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.052131137323984014
Avg hit ratio: 0.8204159519032185
Avg ndcg: 0.8313132789612219
Avg compression ratio: 0.6201018712578482
Avg train time: 5.8295220851898195
Std train time: 2.7011016819946643
[0.9666666666666667, 0.6333333333333333, 0.6333333333333333, 0.9666666666666667, 0.9666666666666667, 0.6333333333333333, 0.6333333333333333, 0.30000000000000004, 0.30000000000000004, 0.30000000000000004]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.9999, 'time@10': 5.2255}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.9999, 'time@10': 5.2255}:  10%|█         | 1/10 [00:02<00:23,  2.65s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8479, 'compress@10': 0.9674, 'time@10': 4.7019}:  10%|█         | 1/10 [00:06<00:23,  2.65s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8479, 'compress@10': 0.9674, 'time@10': 4.7019}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8488, 'compress@10': 0.9531, 'time@10': 3.7856}:  20%|██        | 2/10 [00:07<00:28,  3.57s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8488, 'compress@10': 0.9531, 'time@10': 3.7856}:  30%|███       | 3/10 [00:07<00:16,  2.40s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8474, 'compress@10': 0.9648, 'time@10': 3.7703}:  30%|███       | 3/10 [00:11<00:16,  2.40s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8474, 'compress@10': 0.9648, 'time@10': 3.7703}:  40%|████      | 4/10 [00:11<00:17,  2.94s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0483, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.836, 'compress@10': 0.9718, 'time@10': 5.2245}:  40%|████      | 4/10 [00:17<00:17,  2.94s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.0483, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.836, 'compress@10': 0.9718, 'time@10': 5.2245}:  50%|█████     | 5/10 [00:17<00:19,  3.88s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0528, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8324, 'compress@10': 0.9697, 'time@10': 5.382}:  50%|█████     | 5/10 [00:23<00:19,  3.88s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0528, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8324, 'compress@10': 0.9697, 'time@10': 5.382}:  60%|██████    | 6/10 [00:23<00:18,  4.68s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0512, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8359, 'compress@10': 0.9651, 'time@10': 5.5697}:  60%|██████    | 6/10 [00:26<00:18,  4.68s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0512, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8359, 'compress@10': 0.9651, 'time@10': 5.5697}:  70%|███████   | 7/10 [00:26<00:12,  4.25s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0502, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8418, 'compress@10': 0.8493, 'time@10': 5.466}:  70%|███████   | 7/10 [00:31<00:12,  4.25s/it]  {'epoch': 2, 'num_users': 6.125, 'loss': 0.0502, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8418, 'compress@10': 0.8493, 'time@10': 5.466}:  80%|████████  | 8/10 [00:31<00:08,  4.42s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.849, 'compress@10': 0.7605, 'time@10': 5.8153}:  80%|████████  | 8/10 [00:35<00:08,  4.42s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.849, 'compress@10': 0.7605, 'time@10': 5.8153}:  90%|█████████ | 9/10 [00:35<00:04,  4.40s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0483, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8492, 'compress@10': 0.6883, 'time@10': 5.8028}:  90%|█████████ | 9/10 [00:41<00:04,  4.40s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 0.0483, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8492, 'compress@10': 0.6883, 'time@10': 5.8028}: 100%|██████████| 10/10 [00:41<00:00,  4.81s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0483, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8492, 'compress@10': 0.6883, 'time@10': 5.8028}: 100%|██████████| 10/10 [00:41<00:00,  4.16s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04831664609882399
Avg hit ratio: 0.8279013320201776
Avg ndcg: 0.8492110419675134
Avg compression ratio: 0.6883039712973369
Avg train time: 5.802765822410583
Std train time: 2.439327149502606
[0.975, 0.725, 0.475, 0.975, 0.975, 0.725, 0.475, 0.22500000000000003, 0.22500000000000003, 0.22500000000000003]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.9999, 'time@10': 5.0592}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.9999, 'time@10': 5.0592}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8497, 'compress@10': 0.992, 'time@10': 4.6345}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it]  {'epoch': 3, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8497, 'compress@10': 0.992, 'time@10': 4.6345}:  20%|██        | 2/10 [00:06<00:28,  3.56s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0334, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8522, 'compress@10': 0.8263, 'time@10': 3.8127}:  20%|██        | 2/10 [00:07<00:28,  3.56s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0334, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8522, 'compress@10': 0.8263, 'time@10': 3.8127}:  30%|███       | 3/10 [00:07<00:17,  2.45s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8498, 'compress@10': 0.8697, 'time@10': 3.8048}:  30%|███       | 3/10 [00:11<00:17,  2.45s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8498, 'compress@10': 0.8697, 'time@10': 3.8048}:  40%|████      | 4/10 [00:11<00:17,  2.99s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8377, 'compress@10': 0.8957, 'time@10': 5.0087}:  40%|████      | 4/10 [00:16<00:17,  2.99s/it]   {'epoch': 3, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8377, 'compress@10': 0.8957, 'time@10': 5.0087}:  50%|█████     | 5/10 [00:16<00:18,  3.70s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0512, 'hit_ratio@10': 0.7797, 'ndcg@10': 0.836, 'compress@10': 0.911, 'time@10': 5.2052}:  50%|█████     | 5/10 [00:22<00:18,  3.70s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0512, 'hit_ratio@10': 0.7797, 'ndcg@10': 0.836, 'compress@10': 0.911, 'time@10': 5.2052}:  60%|██████    | 6/10 [00:22<00:18,  4.56s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.8376, 'compress@10': 0.83, 'time@10': 5.4254}:  60%|██████    | 6/10 [00:26<00:18,  4.56s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.8376, 'compress@10': 0.83, 'time@10': 5.4254}:  70%|███████   | 7/10 [00:26<00:12,  4.18s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0508, 'hit_ratio@10': 0.819, 'ndcg@10': 0.8465, 'compress@10': 0.7303, 'time@10': 5.3383}:  70%|███████   | 7/10 [00:31<00:12,  4.18s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0508, 'hit_ratio@10': 0.819, 'ndcg@10': 0.8465, 'compress@10': 0.7303, 'time@10': 5.3383}:  80%|████████  | 8/10 [00:31<00:08,  4.37s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.8106, 'ndcg@10': 0.8542, 'compress@10': 0.653, 'time@10': 5.6945}:  80%|████████  | 8/10 [00:35<00:08,  4.37s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.8106, 'ndcg@10': 0.8542, 'compress@10': 0.653, 'time@10': 5.6945}:  90%|█████████ | 9/10 [00:35<00:04,  4.35s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8546, 'compress@10': 0.5906, 'time@10': 5.6902}:  90%|█████████ | 9/10 [00:41<00:04,  4.35s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8546, 'compress@10': 0.5906, 'time@10': 5.6902}: 100%|██████████| 10/10 [00:41<00:00,  4.77s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8546, 'compress@10': 0.5906, 'time@10': 5.6902}: 100%|██████████| 10/10 [00:41<00:00,  4.11s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04897221662279519
Avg hit ratio: 0.8226949828138285
Avg ndcg: 0.8546031562070754
Avg compression ratio: 0.5906006434772424
Avg train time: 5.690168642997742
Std train time: 2.1484752786936587
[0.78, 0.78, 0.38, 0.98, 0.98, 0.78, 0.38, 0.38, 0.18000000000000002, 0.18000000000000002]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8506, 'compress@10': 0.9956, 'time@10': 5.097}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8506, 'compress@10': 0.9956, 'time@10': 5.097}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8492, 'compress@10': 0.9946, 'time@10': 4.6546}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8492, 'compress@10': 0.9946, 'time@10': 4.6546}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8518, 'compress@10': 0.7284, 'time@10': 3.8726}:  20%|██        | 2/10 [00:08<00:28,  3.57s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8518, 'compress@10': 0.7284, 'time@10': 3.8726}:  30%|███       | 3/10 [00:08<00:17,  2.49s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.85, 'compress@10': 0.7963, 'time@10': 3.8343}:  30%|███       | 3/10 [00:11<00:17,  2.49s/it]  {'epoch': 4, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.85, 'compress@10': 0.7963, 'time@10': 3.8343}:  40%|████      | 4/10 [00:11<00:17,  2.99s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8367, 'compress@10': 0.837, 'time@10': 4.7301}:  40%|████      | 4/10 [00:16<00:17,  2.99s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8367, 'compress@10': 0.837, 'time@10': 4.7301}:  50%|█████     | 5/10 [00:16<00:17,  3.42s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0496, 'hit_ratio@10': 0.7887, 'ndcg@10': 0.8342, 'compress@10': 0.8633, 'time@10': 4.9708}:  50%|█████     | 5/10 [00:22<00:17,  3.42s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0496, 'hit_ratio@10': 0.7887, 'ndcg@10': 0.8342, 'compress@10': 0.8633, 'time@10': 4.9708}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8332, 'compress@10': 0.7549, 'time@10': 5.2119}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8332, 'compress@10': 0.7549, 'time@10': 5.2119}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.05, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8478, 'compress@10': 0.6682, 'time@10': 5.1486}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]   {'epoch': 4, 'num_users': 6.125, 'loss': 0.05, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8478, 'compress@10': 0.6682, 'time@10': 5.1486}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.8553, 'compress@10': 0.5974, 'time@10': 5.5081}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.8553, 'compress@10': 0.5974, 'time@10': 5.5081}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8253, 'ndcg@10': 0.8548, 'compress@10': 0.5402, 'time@10': 5.492}:  90%|█████████ | 9/10 [00:39<00:04,  4.26s/it]    {'epoch': 4, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8253, 'ndcg@10': 0.8548, 'compress@10': 0.5402, 'time@10': 5.492}: 100%|██████████| 10/10 [00:39<00:00,  4.60s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8253, 'ndcg@10': 0.8548, 'compress@10': 0.5402, 'time@10': 5.492}: 100%|██████████| 10/10 [00:39<00:00,  3.99s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04855156556559176
Avg hit ratio: 0.8252858686305207
Avg ndcg: 0.8548075512022015
Avg compression ratio: 0.5402303411688337
Avg train time: 5.491996932029724
Std train time: 1.840145471575209
[0.65, 0.8166666666666667, 0.31666666666666665, 0.8166666666666667, 0.9833333333333333, 0.8166666666666667, 0.48333333333333334, 0.48333333333333334, 0.15000000000000002, 0.15000000000000002]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8536, 'compress@10': 0.9555, 'time@10': 4.9938}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8536, 'compress@10': 0.9555, 'time@10': 4.9938}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8558, 'compress@10': 0.976, 'time@10': 4.5924}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it] {'epoch': 5, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8558, 'compress@10': 0.976, 'time@10': 4.5924}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8562, 'compress@10': 0.7031, 'time@10': 3.9023}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8562, 'compress@10': 0.7031, 'time@10': 3.9023}:  30%|███       | 3/10 [00:08<00:17,  2.51s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8564, 'compress@10': 0.7764, 'time@10': 3.8577}:  30%|███       | 3/10 [00:11<00:17,  2.51s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8564, 'compress@10': 0.7764, 'time@10': 3.8577}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0451, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.842, 'compress@10': 0.8211, 'time@10': 4.7239}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0451, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.842, 'compress@10': 0.8211, 'time@10': 4.7239}:  50%|█████     | 5/10 [00:15<00:17,  3.41s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0483, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8396, 'compress@10': 0.8505, 'time@10': 4.9722}:  50%|█████     | 5/10 [00:22<00:17,  3.41s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0483, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8396, 'compress@10': 0.8505, 'time@10': 4.9722}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0482, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8396, 'compress@10': 0.7824, 'time@10': 5.2298}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0482, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8396, 'compress@10': 0.7824, 'time@10': 5.2298}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0489, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8534, 'compress@10': 0.723, 'time@10': 5.1657}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.0489, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8534, 'compress@10': 0.723, 'time@10': 5.1657}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0482, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8612, 'compress@10': 0.646, 'time@10': 5.5476}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0482, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8612, 'compress@10': 0.646, 'time@10': 5.5476}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0482, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.8625, 'compress@10': 0.5838, 'time@10': 5.5317}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]  {'epoch': 5, 'num_users': 6.3, 'loss': 0.0482, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.8625, 'compress@10': 0.5838, 'time@10': 5.5317}: 100%|██████████| 10/10 [00:40<00:00,  4.65s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0482, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.8625, 'compress@10': 0.5838, 'time@10': 5.5317}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.048186607181615534
Avg hit ratio: 0.8367938051384571
Avg ndcg: 0.8625130401280284
Avg compression ratio: 0.5838436847715103
Avg train time: 5.531721758842468
Std train time: 1.833075973363595
[0.5571428571428572, 0.8428571428571429, 0.2714285714285714, 0.7, 0.9857142857142857, 0.8428571428571429, 0.41428571428571426, 0.5571428571428572, 0.1285714285714286, 0.27142857142857146]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8562, 'compress@10': 0.8191, 'time@10': 5.0088}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8562, 'compress@10': 0.8191, 'time@10': 5.0088}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8539, 'compress@10': 0.9086, 'time@10': 4.6087}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8539, 'compress@10': 0.9086, 'time@10': 4.6087}:  20%|██        | 2/10 [00:06<00:28,  3.55s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.855, 'compress@10': 0.6555, 'time@10': 3.9542}:  20%|██        | 2/10 [00:08<00:28,  3.55s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.855, 'compress@10': 0.6555, 'time@10': 3.9542}:  30%|███       | 3/10 [00:08<00:17,  2.55s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0367, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8521, 'compress@10': 0.7338, 'time@10': 3.8913}:  30%|███       | 3/10 [00:11<00:17,  2.55s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0367, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8521, 'compress@10': 0.7338, 'time@10': 3.8913}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8397, 'compress@10': 0.787, 'time@10': 4.7877}:  40%|████      | 4/10 [00:16<00:18,  3.02s/it] {'epoch': 6, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8397, 'compress@10': 0.787, 'time@10': 4.7877}:  50%|█████     | 5/10 [00:16<00:17,  3.46s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0482, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8383, 'compress@10': 0.8223, 'time@10': 5.0314}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0482, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8383, 'compress@10': 0.8223, 'time@10': 5.0314}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0473, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8387, 'compress@10': 0.7253, 'time@10': 5.2773}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0473, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8387, 'compress@10': 0.7253, 'time@10': 5.2773}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0475, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8493, 'compress@10': 0.7265, 'time@10': 5.2127}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0475, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8493, 'compress@10': 0.7265, 'time@10': 5.2127}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0469, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8578, 'compress@10': 0.6491, 'time@10': 5.577}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0469, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8578, 'compress@10': 0.6491, 'time@10': 5.577}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0461, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8593, 'compress@10': 0.5872, 'time@10': 5.5461}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]  {'epoch': 6, 'num_users': 6.3, 'loss': 0.0461, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8593, 'compress@10': 0.5872, 'time@10': 5.5461}: 100%|██████████| 10/10 [00:40<00:00,  4.62s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0461, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8593, 'compress@10': 0.5872, 'time@10': 5.5461}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.046097803776487686
Avg hit ratio: 0.8665910401614985
Avg ndcg: 0.859287736741473
Avg compression ratio: 0.5872464779928502
Avg train time: 5.546129870414734
Std train time: 1.8222374921691915
[0.48750000000000004, 0.8625, 0.2375, 0.7374999999999999, 0.9874999999999999, 0.8625, 0.3625, 0.6125, 0.11250000000000002, 0.23750000000000004]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.3682, 'time@10': 5.0667}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.3682, 'time@10': 5.0667}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8553, 'compress@10': 0.6835, 'time@10': 4.6573}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8553, 'compress@10': 0.6835, 'time@10': 4.6573}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8559, 'compress@10': 0.5045, 'time@10': 4.0494}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]  {'epoch': 7, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8559, 'compress@10': 0.5045, 'time@10': 4.0494}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0362, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8587, 'compress@10': 0.6245, 'time@10': 3.9733}:  30%|███       | 3/10 [00:12<00:18,  2.61s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0362, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8587, 'compress@10': 0.6245, 'time@10': 3.9733}:  40%|████      | 4/10 [00:12<00:18,  3.07s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0448, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8452, 'compress@10': 0.6996, 'time@10': 4.8443}:  40%|████      | 4/10 [00:16<00:18,  3.07s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0448, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8452, 'compress@10': 0.6996, 'time@10': 4.8443}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0466, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8436, 'compress@10': 0.7495, 'time@10': 5.0787}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0466, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8436, 'compress@10': 0.7495, 'time@10': 5.0787}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0457, 'hit_ratio@10': 0.85, 'ndcg@10': 0.846, 'compress@10': 0.6551, 'time@10': 5.3131}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it]   {'epoch': 7, 'num_users': 6.2857, 'loss': 0.0457, 'hit_ratio@10': 0.85, 'ndcg@10': 0.846, 'compress@10': 0.6551, 'time@10': 5.3131}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0456, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8528, 'compress@10': 0.6825, 'time@10': 5.2512}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0456, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8528, 'compress@10': 0.6825, 'time@10': 5.2512}:  80%|████████  | 8/10 [00:30<00:08,  4.34s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0454, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8593, 'compress@10': 0.6099, 'time@10': 5.5937}:  80%|████████  | 8/10 [00:35<00:08,  4.34s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0454, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8593, 'compress@10': 0.6099, 'time@10': 5.5937}:  90%|█████████ | 9/10 [00:35<00:04,  4.30s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0446, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8596, 'compress@10': 0.5516, 'time@10': 5.569}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]    {'epoch': 7, 'num_users': 6.3, 'loss': 0.0446, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8596, 'compress@10': 0.5516, 'time@10': 5.569}: 100%|██████████| 10/10 [00:40<00:00,  4.63s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0446, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8596, 'compress@10': 0.5516, 'time@10': 5.569}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.044607593973512404
Avg hit ratio: 0.8567497703202287
Avg ndcg: 0.859569417240043
Avg compression ratio: 0.5516223490885824
Avg train time: 5.568976497650146
Std train time: 1.7455961875476607
[0.5444444444444445, 0.7666666666666667, 0.2111111111111111, 0.7666666666666666, 0.9888888888888888, 0.8777777777777778, 0.3222222222222222, 0.6555555555555556, 0.10000000000000002, 0.21111111111111114]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8545, 'compress@10': 0.7316, 'time@10': 5.0305}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8545, 'compress@10': 0.7316, 'time@10': 5.0305}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0437, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.856, 'compress@10': 0.8622, 'time@10': 4.6656}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.0437, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.856, 'compress@10': 0.8622, 'time@10': 4.6656}:  20%|██        | 2/10 [00:06<00:28,  3.61s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8564, 'compress@10': 0.6232, 'time@10': 4.1182}:  20%|██        | 2/10 [00:08<00:28,  3.61s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8564, 'compress@10': 0.6232, 'time@10': 4.1182}:  30%|███       | 3/10 [00:08<00:18,  2.67s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8605, 'compress@10': 0.7152, 'time@10': 4.045}:  30%|███       | 3/10 [00:12<00:18,  2.67s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8605, 'compress@10': 0.7152, 'time@10': 4.045}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0436, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8468, 'compress@10': 0.7722, 'time@10': 4.9436}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0436, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8468, 'compress@10': 0.7722, 'time@10': 4.9436}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0449, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8462, 'compress@10': 0.81, 'time@10': 5.1535}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0449, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8462, 'compress@10': 0.81, 'time@10': 5.1535}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0439, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8494, 'compress@10': 0.7037, 'time@10': 5.3923}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0439, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8494, 'compress@10': 0.7037, 'time@10': 5.3923}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.044, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8575, 'compress@10': 0.7327, 'time@10': 5.3071}:  70%|███████   | 7/10 [00:31<00:12,  4.14s/it]  {'epoch': 8, 'num_users': 6.125, 'loss': 0.044, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8575, 'compress@10': 0.7327, 'time@10': 5.3071}:  80%|████████  | 8/10 [00:31<00:08,  4.34s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0439, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8674, 'compress@10': 0.6545, 'time@10': 5.6309}:  80%|████████  | 8/10 [00:35<00:08,  4.34s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0439, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8674, 'compress@10': 0.6545, 'time@10': 5.6309}:  90%|█████████ | 9/10 [00:35<00:04,  4.28s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0425, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8681, 'compress@10': 0.5916, 'time@10': 5.6144}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0425, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8681, 'compress@10': 0.5916, 'time@10': 5.6144}: 100%|██████████| 10/10 [00:40<00:00,  4.66s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0425, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8681, 'compress@10': 0.5916, 'time@10': 5.6144}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04253175534416103
Avg hit ratio: 0.873653833998486
Avg ndcg: 0.8680554693181378
Avg compression ratio: 0.5916052276211717
Avg train time: 5.614352774620056
Std train time: 1.7312484837708517
[0.5900000000000001, 0.6900000000000001, 0.19, 0.7899999999999999, 0.99, 0.89, 0.29, 0.69, 0.09000000000000002, 0.19000000000000003]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8536, 'compress@10': 0.8752, 'time@10': 5.1428}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8536, 'compress@10': 0.8752, 'time@10': 5.1428}:  10%|█         | 1/10 [00:02<00:23,  2.61s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0423, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8547, 'compress@10': 0.9247, 'time@10': 4.7063}:  10%|█         | 1/10 [00:06<00:23,  2.61s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0423, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8547, 'compress@10': 0.9247, 'time@10': 4.7063}:  20%|██        | 2/10 [00:06<00:28,  3.61s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8555, 'compress@10': 0.6646, 'time@10': 4.2019}:  20%|██        | 2/10 [00:08<00:28,  3.61s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8555, 'compress@10': 0.6646, 'time@10': 4.2019}:  30%|███       | 3/10 [00:08<00:18,  2.71s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8611, 'compress@10': 0.7471, 'time@10': 4.0912}:  30%|███       | 3/10 [00:12<00:18,  2.71s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8611, 'compress@10': 0.7471, 'time@10': 4.0912}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0412, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8474, 'compress@10': 0.7977, 'time@10': 4.9368}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0412, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8474, 'compress@10': 0.7977, 'time@10': 4.9368}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0422, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8486, 'compress@10': 0.8313, 'time@10': 5.159}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0422, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8486, 'compress@10': 0.8313, 'time@10': 5.159}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0413, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8521, 'compress@10': 0.7205, 'time@10': 5.3992}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0413, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8521, 'compress@10': 0.7205, 'time@10': 5.3992}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0414, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8598, 'compress@10': 0.751, 'time@10': 5.3235}:  70%|███████   | 7/10 [00:31<00:12,  4.14s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0414, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8598, 'compress@10': 0.751, 'time@10': 5.3235}:  80%|████████  | 8/10 [00:31<00:08,  4.36s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0419, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8671, 'compress@10': 0.6707, 'time@10': 5.6656}:  80%|████████  | 8/10 [00:35<00:08,  4.36s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0419, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8671, 'compress@10': 0.6707, 'time@10': 5.6656}:  90%|█████████ | 9/10 [00:35<00:04,  4.33s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8692, 'compress@10': 0.6061, 'time@10': 5.6228}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8692, 'compress@10': 0.6061, 'time@10': 5.6228}: 100%|██████████| 10/10 [00:40<00:00,  4.63s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8692, 'compress@10': 0.6061, 'time@10': 5.6228}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.04108212518649853
Avg hit ratio: 0.8644474847921367
Avg ndcg: 0.8692321218332332
Avg compression ratio: 0.6061300440986369
Avg train time: 5.622820568084717
Std train time: 1.707978356179432
[0.6272727272727273, 0.6272727272727273, 0.17272727272727273, 0.809090909090909, 0.9909090909090909, 0.9, 0.2636363636363636, 0.6272727272727272, 0.17272727272727273, 0.17272727272727276]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8534, 'compress@10': 0.9279, 'time@10': 5.3931}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8534, 'compress@10': 0.9279, 'time@10': 5.3931}:  10%|█         | 1/10 [00:02<00:24,  2.74s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8683, 'compress@10': 0.9305, 'time@10': 4.8246}:  10%|█         | 1/10 [00:07<00:24,  2.74s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8683, 'compress@10': 0.9305, 'time@10': 4.8246}:  20%|██        | 2/10 [00:07<00:29,  3.66s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8646, 'compress@10': 0.6683, 'time@10': 4.2534}:  20%|██        | 2/10 [00:08<00:29,  3.66s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8646, 'compress@10': 0.6683, 'time@10': 4.2534}:  30%|███       | 3/10 [00:08<00:19,  2.71s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8687, 'compress@10': 0.7503, 'time@10': 4.136}:  30%|███       | 3/10 [00:12<00:19,  2.71s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8687, 'compress@10': 0.7503, 'time@10': 4.136}:  40%|████      | 4/10 [00:12<00:18,  3.16s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0385, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8543, 'compress@10': 0.8003, 'time@10': 4.9648}:  40%|████      | 4/10 [00:16<00:18,  3.16s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0385, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8543, 'compress@10': 0.8003, 'time@10': 4.9648}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0394, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8549, 'compress@10': 0.8335, 'time@10': 5.1766}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0394, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8549, 'compress@10': 0.8335, 'time@10': 5.1766}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8579, 'compress@10': 0.7216, 'time@10': 5.409}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it] {'epoch': 10, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8579, 'compress@10': 0.7216, 'time@10': 5.409}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0389, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8635, 'compress@10': 0.7427, 'time@10': 5.3107}:  70%|███████   | 7/10 [00:31<00:12,  4.13s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0389, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8635, 'compress@10': 0.7427, 'time@10': 5.3107}:  80%|████████  | 8/10 [00:31<00:08,  4.30s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0387, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8701, 'compress@10': 0.6636, 'time@10': 5.6758}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0387, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8701, 'compress@10': 0.6636, 'time@10': 5.6758}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8712, 'compress@10': 0.5996, 'time@10': 5.6554}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8712, 'compress@10': 0.5996, 'time@10': 5.6554}: 100%|██████████| 10/10 [00:40<00:00,  4.68s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8712, 'compress@10': 0.5996, 'time@10': 5.6554}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.037898100393425276
Avg hit ratio: 0.8664474847921367
Avg ndcg: 0.871173783965099
Avg compression ratio: 0.5996120962442892
Avg train time: 5.655371809005738
Std train time: 1.7407505469408244
[0.6583333333333333, 0.5750000000000001, 0.15833333333333333, 0.8249999999999998, 0.9916666666666666, 0.9083333333333333, 0.24166666666666664, 0.6583333333333332, 0.15833333333333333, 0.15833333333333335]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0413, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.871, 'compress@10': 0.9556, 'time@10': 5.0122}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0413, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.871, 'compress@10': 0.9556, 'time@10': 5.0122}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8777, 'compress@10': 0.9078, 'time@10': 4.6521}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8777, 'compress@10': 0.9078, 'time@10': 4.6521}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8708, 'compress@10': 0.653, 'time@10': 4.1829}:  20%|██        | 2/10 [00:08<00:28,  3.60s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8708, 'compress@10': 0.653, 'time@10': 4.1829}:  30%|███       | 3/10 [00:08<00:19,  2.72s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8729, 'compress@10': 0.7391, 'time@10': 4.0834}:  30%|███       | 3/10 [00:12<00:19,  2.72s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8729, 'compress@10': 0.7391, 'time@10': 4.0834}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.037, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8584, 'compress@10': 0.7913, 'time@10': 4.9429}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.037, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8584, 'compress@10': 0.7913, 'time@10': 4.9429}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0379, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8586, 'compress@10': 0.826, 'time@10': 5.1308}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0379, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8586, 'compress@10': 0.826, 'time@10': 5.1308}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0372, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8632, 'compress@10': 0.7147, 'time@10': 5.3903}:  60%|██████    | 6/10 [00:26<00:17,  4.42s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0372, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8632, 'compress@10': 0.7147, 'time@10': 5.3903}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0374, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8657, 'compress@10': 0.742, 'time@10': 5.3054}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it]  {'epoch': 11, 'num_users': 6.125, 'loss': 0.0374, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8657, 'compress@10': 0.742, 'time@10': 5.3054}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0367, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8727, 'compress@10': 0.6628, 'time@10': 5.6862}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0367, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8727, 'compress@10': 0.6628, 'time@10': 5.6862}:  90%|█████████ | 9/10 [00:35<00:04,  4.35s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8771, 'compress@10': 0.5989, 'time@10': 5.6518}:  90%|█████████ | 9/10 [00:40<00:04,  4.35s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8771, 'compress@10': 0.5989, 'time@10': 5.6518}: 100%|██████████| 10/10 [00:40<00:00,  4.67s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8771, 'compress@10': 0.5989, 'time@10': 5.6518}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03579667789885603
Avg hit ratio: 0.8678630692077212
Avg ndcg: 0.8771174351910972
Avg compression ratio: 0.5989150066104844
Avg train time: 5.651835227012635
Std train time: 1.7693830076946724
[0.6846153846153846, 0.5307692307692309, 0.14615384615384613, 0.8384615384615384, 0.9923076923076922, 0.9153846153846154, 0.22307692307692306, 0.6846153846153845, 0.14615384615384613, 0.14615384615384616]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8399, 'compress@10': 0.9713, 'time@10': 5.1087}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8399, 'compress@10': 0.9713, 'time@10': 5.1087}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8652, 'compress@10': 0.7967, 'time@10': 4.688}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it] {'epoch': 12, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8652, 'compress@10': 0.7967, 'time@10': 4.688}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8625, 'compress@10': 0.5789, 'time@10': 4.2285}:  20%|██        | 2/10 [00:08<00:28,  3.60s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8625, 'compress@10': 0.5789, 'time@10': 4.2285}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8655, 'compress@10': 0.6837, 'time@10': 4.101}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8655, 'compress@10': 0.6837, 'time@10': 4.101}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0378, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8535, 'compress@10': 0.747, 'time@10': 4.9661}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0378, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8535, 'compress@10': 0.747, 'time@10': 4.9661}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.038, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8557, 'compress@10': 0.7891, 'time@10': 5.1643}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.038, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8557, 'compress@10': 0.7891, 'time@10': 5.1643}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0374, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8611, 'compress@10': 0.6828, 'time@10': 5.3849}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0374, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8611, 'compress@10': 0.6828, 'time@10': 5.3849}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0374, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8621, 'compress@10': 0.7171, 'time@10': 5.2833}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0374, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8621, 'compress@10': 0.7171, 'time@10': 5.2833}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0363, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.871, 'compress@10': 0.6407, 'time@10': 5.6492}:  80%|████████  | 8/10 [00:35<00:08,  4.26s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0363, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.871, 'compress@10': 0.6407, 'time@10': 5.6492}:  90%|█████████ | 9/10 [00:35<00:04,  4.28s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0361, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8729, 'compress@10': 0.5789, 'time@10': 5.6359}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.0361, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8729, 'compress@10': 0.5789, 'time@10': 5.6359}: 100%|██████████| 10/10 [00:40<00:00,  4.68s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0361, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8729, 'compress@10': 0.5789, 'time@10': 5.6359}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.036076978194548706
Avg hit ratio: 0.8693614363376673
Avg ndcg: 0.8728996693448974
Avg compression ratio: 0.578933253547401
Avg train time: 5.635850548744202
Std train time: 1.7389905880933776
[0.7071428571428572, 0.49285714285714294, 0.1357142857142857, 0.8499999999999999, 0.9928571428571428, 0.9214285714285714, 0.20714285714285713, 0.7071428571428571, 0.1357142857142857, 0.13571428571428573]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8659, 'compress@10': 0.9802, 'time@10': 4.9536}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8659, 'compress@10': 0.9802, 'time@10': 4.9536}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8777, 'compress@10': 0.6624, 'time@10': 4.5746}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8777, 'compress@10': 0.6624, 'time@10': 4.5746}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8709, 'compress@10': 0.4893, 'time@10': 4.1368}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8709, 'compress@10': 0.4893, 'time@10': 4.1368}:  30%|███       | 3/10 [00:08<00:18,  2.68s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8753, 'compress@10': 0.6167, 'time@10': 4.0436}:  30%|███       | 3/10 [00:12<00:18,  2.68s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8753, 'compress@10': 0.6167, 'time@10': 4.0436}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0341, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8625, 'compress@10': 0.6933, 'time@10': 4.9009}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0341, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8625, 'compress@10': 0.6933, 'time@10': 4.9009}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0349, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8655, 'compress@10': 0.7444, 'time@10': 5.1174}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0349, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8655, 'compress@10': 0.7444, 'time@10': 5.1174}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0344, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8696, 'compress@10': 0.6443, 'time@10': 5.3568}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0344, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8696, 'compress@10': 0.6443, 'time@10': 5.3568}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0342, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8721, 'compress@10': 0.6851, 'time@10': 5.2618}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0342, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8721, 'compress@10': 0.6851, 'time@10': 5.2618}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0346, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8784, 'compress@10': 0.6122, 'time@10': 5.635}:  80%|████████  | 8/10 [00:35<00:08,  4.28s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0346, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8784, 'compress@10': 0.6122, 'time@10': 5.635}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0326, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8835, 'compress@10': 0.5533, 'time@10': 5.5978}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]  {'epoch': 13, 'num_users': 6.3, 'loss': 0.0326, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8835, 'compress@10': 0.5533, 'time@10': 5.5978}: 100%|██████████| 10/10 [00:40<00:00,  4.61s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0326, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8835, 'compress@10': 0.5533, 'time@10': 5.5978}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03257745649716272
Avg hit ratio: 0.8763075136521655
Avg ndcg: 0.8835373932569498
Avg compression ratio: 0.5532842738636952
Avg train time: 5.597769355773925
Std train time: 1.7523839846171836
[0.7266666666666667, 0.4600000000000001, 0.12666666666666665, 0.8599999999999999, 0.9933333333333333, 0.9266666666666666, 0.19333333333333333, 0.6599999999999999, 0.19333333333333333, 0.12666666666666668]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0407, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8615, 'compress@10': 0.9862, 'time@10': 4.8842}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0407, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8615, 'compress@10': 0.9862, 'time@10': 4.8842}:  10%|█         | 1/10 [00:02<00:22,  2.50s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8771, 'compress@10': 0.6252, 'time@10': 4.5545}:  10%|█         | 1/10 [00:06<00:22,  2.50s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8771, 'compress@10': 0.6252, 'time@10': 4.5545}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8705, 'compress@10': 0.4645, 'time@10': 4.1911}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8705, 'compress@10': 0.4645, 'time@10': 4.1911}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8773, 'compress@10': 0.5982, 'time@10': 4.0804}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8773, 'compress@10': 0.5982, 'time@10': 4.0804}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0333, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8641, 'compress@10': 0.6785, 'time@10': 4.9329}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0333, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8641, 'compress@10': 0.6785, 'time@10': 4.9329}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0341, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8672, 'compress@10': 0.7321, 'time@10': 5.1441}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0341, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8672, 'compress@10': 0.7321, 'time@10': 5.1441}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0338, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8719, 'compress@10': 0.6336, 'time@10': 5.3871}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0338, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8719, 'compress@10': 0.6336, 'time@10': 5.3871}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0333, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8737, 'compress@10': 0.6706, 'time@10': 5.2858}:  70%|███████   | 7/10 [00:30<00:12,  4.13s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0333, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8737, 'compress@10': 0.6706, 'time@10': 5.2858}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.033, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8831, 'compress@10': 0.5996, 'time@10': 5.6622}:  80%|████████  | 8/10 [00:35<00:08,  4.28s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.033, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8831, 'compress@10': 0.5996, 'time@10': 5.6622}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0323, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.886, 'compress@10': 0.542, 'time@10': 5.6278}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]    {'epoch': 14, 'num_users': 6.3, 'loss': 0.0323, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.886, 'compress@10': 0.542, 'time@10': 5.6278}: 100%|██████████| 10/10 [00:40<00:00,  4.63s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0323, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.886, 'compress@10': 0.542, 'time@10': 5.6278}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.03228603221041868
Avg hit ratio: 0.8783075136521656
Avg ndcg: 0.8859987947182294
Avg compression ratio: 0.541969127665079
Avg train time: 5.627762222290039
Std train time: 1.7431701913476711
[0.74375, 0.4312500000000001, 0.11874999999999998, 0.8687499999999999, 0.9937499999999999, 0.93125, 0.24375, 0.6187499999999999, 0.18125, 0.11875000000000001]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8615, 'compress@10': 0.9902, 'time@10': 4.9076}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8615, 'compress@10': 0.9902, 'time@10': 4.9076}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0329, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8798, 'compress@10': 0.5987, 'time@10': 4.6004}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0329, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8798, 'compress@10': 0.5987, 'time@10': 4.6004}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8723, 'compress@10': 0.4468, 'time@10': 4.1643}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8723, 'compress@10': 0.4468, 'time@10': 4.1643}:  30%|███       | 3/10 [00:08<00:18,  2.71s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8778, 'compress@10': 0.585, 'time@10': 4.0633}:  30%|███       | 3/10 [00:12<00:18,  2.71s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8778, 'compress@10': 0.585, 'time@10': 4.0633}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0316, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8657, 'compress@10': 0.668, 'time@10': 4.9289}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0316, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8657, 'compress@10': 0.668, 'time@10': 4.9289}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.032, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8713, 'compress@10': 0.7233, 'time@10': 5.1499}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.032, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8713, 'compress@10': 0.7233, 'time@10': 5.1499}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0318, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8745, 'compress@10': 0.6267, 'time@10': 5.385}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0318, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8745, 'compress@10': 0.6267, 'time@10': 5.385}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0306, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8771, 'compress@10': 0.6559, 'time@10': 5.2889}:  70%|███████   | 7/10 [00:30<00:12,  4.14s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0306, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8771, 'compress@10': 0.6559, 'time@10': 5.2889}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8974, 'compress@10': 0.5865, 'time@10': 5.6633}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8974, 'compress@10': 0.5865, 'time@10': 5.6633}:  90%|█████████ | 9/10 [00:35<00:04,  4.32s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.884, 'ndcg@10': 0.8981, 'compress@10': 0.5301, 'time@10': 5.6416}:  90%|█████████ | 9/10 [00:40<00:04,  4.32s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.884, 'ndcg@10': 0.8981, 'compress@10': 0.5301, 'time@10': 5.6416}: 100%|██████████| 10/10 [00:40<00:00,  4.69s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.884, 'ndcg@10': 0.8981, 'compress@10': 0.5301, 'time@10': 5.6416}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.031694692828053525
Avg hit ratio: 0.8840217993664513
Avg ndcg: 0.8981418521348814
Avg compression ratio: 0.5301183905862763
Avg train time: 5.641607618331909
Std train time: 1.7572853788377856
[0.7588235294117647, 0.4058823529411765, 0.11176470588235292, 0.876470588235294, 0.9941176470588234, 0.9352941176470588, 0.22941176470588234, 0.5823529411764705, 0.22941176470588234, 0.11176470588235295]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8615, 'compress@10': 0.993, 'time@10': 4.869}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8615, 'compress@10': 0.993, 'time@10': 4.869}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0312, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8813, 'compress@10': 0.5772, 'time@10': 4.5585}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0312, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8813, 'compress@10': 0.5772, 'time@10': 4.5585}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8732, 'compress@10': 0.4324, 'time@10': 4.1388}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8732, 'compress@10': 0.4324, 'time@10': 4.1388}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8784, 'compress@10': 0.5742, 'time@10': 4.0476}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8784, 'compress@10': 0.5742, 'time@10': 4.0476}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8665, 'compress@10': 0.6594, 'time@10': 4.9325}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8665, 'compress@10': 0.6594, 'time@10': 4.9325}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.03, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8723, 'compress@10': 0.7161, 'time@10': 5.143}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]  {'epoch': 16, 'num_users': 6.1667, 'loss': 0.03, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8723, 'compress@10': 0.7161, 'time@10': 5.143}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0295, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8758, 'compress@10': 0.6203, 'time@10': 5.3858}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0295, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8758, 'compress@10': 0.6203, 'time@10': 5.3858}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8808, 'compress@10': 0.6396, 'time@10': 5.2755}:  70%|███████   | 7/10 [00:30<00:12,  4.14s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8808, 'compress@10': 0.6396, 'time@10': 5.2755}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0301, 'hit_ratio@10': 0.88, 'ndcg@10': 0.9041, 'compress@10': 0.5723, 'time@10': 5.6489}:  80%|████████  | 8/10 [00:35<00:08,  4.27s/it] {'epoch': 16, 'num_users': 6.3333, 'loss': 0.0301, 'hit_ratio@10': 0.88, 'ndcg@10': 0.9041, 'compress@10': 0.5723, 'time@10': 5.6489}:  90%|█████████ | 9/10 [00:35<00:04,  4.30s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9083, 'compress@10': 0.5174, 'time@10': 5.6088}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it] {'epoch': 16, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9083, 'compress@10': 0.5174, 'time@10': 5.6088}: 100%|██████████| 10/10 [00:40<00:00,  4.61s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9083, 'compress@10': 0.5174, 'time@10': 5.6088}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.028569962573650985
Avg hit ratio: 0.889736085080737
Avg ndcg: 0.908309813273515
Avg compression ratio: 0.5173769538010213
Avg train time: 5.608774042129516
Std train time: 1.779922073003444
[0.7722222222222221, 0.3833333333333334, 0.10555555555555554, 0.8833333333333332, 0.9944444444444444, 0.9388888888888889, 0.21666666666666665, 0.5499999999999999, 0.2722222222222222, 0.10555555555555556]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8654, 'compress@10': 0.9949, 'time@10': 4.7667}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8654, 'compress@10': 0.9949, 'time@10': 4.7667}:  10%|█         | 1/10 [00:02<00:21,  2.42s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0308, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8866, 'compress@10': 0.5633, 'time@10': 4.5154}:  10%|█         | 1/10 [00:06<00:21,  2.42s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0308, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8866, 'compress@10': 0.5633, 'time@10': 4.5154}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8768, 'compress@10': 0.4232, 'time@10': 4.1109}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8768, 'compress@10': 0.4232, 'time@10': 4.1109}:  30%|███       | 3/10 [00:08<00:18,  2.70s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8811, 'compress@10': 0.5673, 'time@10': 4.0362}:  30%|███       | 3/10 [00:12<00:18,  2.70s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8811, 'compress@10': 0.5673, 'time@10': 4.0362}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0293, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8691, 'compress@10': 0.6538, 'time@10': 4.9151}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0293, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8691, 'compress@10': 0.6538, 'time@10': 4.9151}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0301, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8754, 'compress@10': 0.7115, 'time@10': 5.126}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0301, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8754, 'compress@10': 0.7115, 'time@10': 5.126}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0298, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8781, 'compress@10': 0.6162, 'time@10': 5.3453}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0298, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8781, 'compress@10': 0.6162, 'time@10': 5.3453}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0283, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.8836, 'compress@10': 0.6093, 'time@10': 5.2519}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0283, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.8836, 'compress@10': 0.6093, 'time@10': 5.2519}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.882, 'ndcg@10': 0.886, 'compress@10': 0.5457, 'time@10': 5.6226}:  80%|████████  | 8/10 [00:35<00:08,  4.27s/it]  {'epoch': 17, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.882, 'ndcg@10': 0.886, 'compress@10': 0.5457, 'time@10': 5.6226}:  90%|█████████ | 9/10 [00:35<00:04,  4.29s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.8864, 'compress@10': 0.4935, 'time@10': 5.5873}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.8864, 'compress@10': 0.4935, 'time@10': 5.5873}: 100%|██████████| 10/10 [00:40<00:00,  4.61s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.8864, 'compress@10': 0.4935, 'time@10': 5.5873}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02926000490481397
Avg hit ratio: 0.8915071794834104
Avg ndcg: 0.8864211672208293
Avg compression ratio: 0.4934692640966253
Avg train time: 5.587324428558349
Std train time: 1.74569492726517
[0.7842105263157894, 0.3631578947368422, 0.09999999999999999, 0.8894736842105262, 0.994736842105263, 0.9421052631578948, 0.20526315789473681, 0.5210526315789473, 0.31052631578947365, 0.1]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8663, 'compress@10': 0.9961, 'time@10': 4.7807}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8663, 'compress@10': 0.9961, 'time@10': 4.7807}:  10%|█         | 1/10 [00:02<00:21,  2.43s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8889, 'compress@10': 0.5518, 'time@10': 4.5471}:  10%|█         | 1/10 [00:06<00:21,  2.43s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8889, 'compress@10': 0.5518, 'time@10': 4.5471}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8783, 'compress@10': 0.4155, 'time@10': 4.1283}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8783, 'compress@10': 0.4155, 'time@10': 4.1283}:  30%|███       | 3/10 [00:08<00:18,  2.71s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8801, 'compress@10': 0.5615, 'time@10': 4.0379}:  30%|███       | 3/10 [00:12<00:18,  2.71s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8801, 'compress@10': 0.5615, 'time@10': 4.0379}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0275, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8689, 'compress@10': 0.6492, 'time@10': 4.9069}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0275, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8689, 'compress@10': 0.6492, 'time@10': 4.9069}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0273, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8771, 'compress@10': 0.7077, 'time@10': 5.1291}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0273, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8771, 'compress@10': 0.7077, 'time@10': 5.1291}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8796, 'compress@10': 0.6127, 'time@10': 5.3546}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8796, 'compress@10': 0.6127, 'time@10': 5.3546}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.026, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.8861, 'compress@10': 0.5704, 'time@10': 5.2607}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.026, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.8861, 'compress@10': 0.5704, 'time@10': 5.2607}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.025, 'hit_ratio@10': 0.882, 'ndcg@10': 0.891, 'compress@10': 0.5131, 'time@10': 5.6384}:  80%|████████  | 8/10 [00:35<00:08,  4.29s/it] {'epoch': 18, 'num_users': 6.3333, 'loss': 0.025, 'hit_ratio@10': 0.882, 'ndcg@10': 0.891, 'compress@10': 0.5131, 'time@10': 5.6384}:  90%|█████████ | 9/10 [00:35<00:04,  4.32s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.8972, 'compress@10': 0.4641, 'time@10': 5.6064}:  90%|█████████ | 9/10 [00:40<00:04,  4.32s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.8972, 'compress@10': 0.4641, 'time@10': 5.6064}: 100%|██████████| 10/10 [00:40<00:00,  4.64s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.8972, 'compress@10': 0.4641, 'time@10': 5.6064}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.023198000781971272
Avg hit ratio: 0.8915071794834104
Avg ndcg: 0.8971712823077669
Avg compression ratio: 0.46409938220384755
Avg train time: 5.606413984298706
Std train time: 1.7561466107008723
[0.7949999999999999, 0.3450000000000001, 0.09499999999999999, 0.8949999999999999, 0.9949999999999999, 0.9450000000000001, 0.24499999999999997, 0.49499999999999994, 0.295, 0.095]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8789, 'compress@10': 0.997, 'time@10': 4.789}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8789, 'compress@10': 0.997, 'time@10': 4.789}:  10%|█         | 1/10 [00:02<00:22,  2.45s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8969, 'compress@10': 0.544, 'time@10': 4.495}:  10%|█         | 1/10 [00:06<00:22,  2.45s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8969, 'compress@10': 0.544, 'time@10': 4.495}:  20%|██        | 2/10 [00:06<00:28,  3.50s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8837, 'compress@10': 0.4103, 'time@10': 4.0803}:  20%|██        | 2/10 [00:08<00:28,  3.50s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8837, 'compress@10': 0.4103, 'time@10': 4.0803}:  30%|███       | 3/10 [00:08<00:18,  2.66s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8894, 'compress@10': 0.5577, 'time@10': 3.9918}:  30%|███       | 3/10 [00:12<00:18,  2.66s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8894, 'compress@10': 0.5577, 'time@10': 3.9918}:  40%|████      | 4/10 [00:12<00:18,  3.10s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0261, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8784, 'compress@10': 0.6461, 'time@10': 4.8787}:  40%|████      | 4/10 [00:16<00:18,  3.10s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0261, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8784, 'compress@10': 0.6461, 'time@10': 4.8787}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0259, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8863, 'compress@10': 0.7051, 'time@10': 5.1045}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0259, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8863, 'compress@10': 0.7051, 'time@10': 5.1045}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8885, 'compress@10': 0.6111, 'time@10': 5.3304}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8885, 'compress@10': 0.6111, 'time@10': 5.3304}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.8924, 'compress@10': 0.5596, 'time@10': 5.2338}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.8924, 'compress@10': 0.5596, 'time@10': 5.2338}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.899, 'compress@10': 0.503, 'time@10': 5.6158}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it] {'epoch': 19, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.899, 'compress@10': 0.503, 'time@10': 5.6158}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.8998, 'compress@10': 0.455, 'time@10': 5.5898}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.8998, 'compress@10': 0.455, 'time@10': 5.5898}: 100%|██████████| 10/10 [00:40<00:00,  4.64s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.8998, 'compress@10': 0.455, 'time@10': 5.5898}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.024654210510997903
Avg hit ratio: 0.8943643223405532
Avg ndcg: 0.8997950345045149
Avg compression ratio: 0.45498796744185405
Avg train time: 5.589828276634217
Std train time: 1.7830138473956978
[0.8047619047619047, 0.3285714285714286, 0.09047619047619046, 0.8999999999999999, 0.9952380952380951, 0.9476190476190477, 0.2333333333333333, 0.47142857142857136, 0.28095238095238095, 0.1380952380952381]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0415, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8718, 'compress@10': 0.9976, 'time@10': 4.5745}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0415, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8718, 'compress@10': 0.9976, 'time@10': 4.5745}:  10%|█         | 1/10 [00:02<00:20,  2.32s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8979, 'compress@10': 0.538, 'time@10': 4.4316}:  10%|█         | 1/10 [00:06<00:20,  2.32s/it] {'epoch': 20, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8979, 'compress@10': 0.538, 'time@10': 4.4316}:  20%|██        | 2/10 [00:06<00:28,  3.50s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8843, 'compress@10': 0.4063, 'time@10': 4.0525}:  20%|██        | 2/10 [00:08<00:28,  3.50s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8843, 'compress@10': 0.4063, 'time@10': 4.0525}:  30%|███       | 3/10 [00:08<00:18,  2.67s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8917, 'compress@10': 0.5546, 'time@10': 3.9849}:  30%|███       | 3/10 [00:12<00:18,  2.67s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8917, 'compress@10': 0.5546, 'time@10': 3.9849}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.027, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8814, 'compress@10': 0.6437, 'time@10': 4.8628}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.027, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8814, 'compress@10': 0.6437, 'time@10': 4.8628}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0277, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8897, 'compress@10': 0.7031, 'time@10': 5.0981}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0277, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8897, 'compress@10': 0.7031, 'time@10': 5.0981}:  60%|██████    | 6/10 [00:22<00:18,  4.54s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0273, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.8914, 'compress@10': 0.6091, 'time@10': 5.3181}:  60%|██████    | 6/10 [00:26<00:18,  4.54s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0273, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.8914, 'compress@10': 0.6091, 'time@10': 5.3181}:  70%|███████   | 7/10 [00:26<00:12,  4.15s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0263, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.8967, 'compress@10': 0.5519, 'time@10': 5.2316}:  70%|███████   | 7/10 [00:30<00:12,  4.15s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0263, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.8967, 'compress@10': 0.5519, 'time@10': 5.2316}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0265, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9097, 'compress@10': 0.4957, 'time@10': 5.5926}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0265, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9097, 'compress@10': 0.4957, 'time@10': 5.5926}:  90%|█████████ | 9/10 [00:35<00:04,  4.30s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.026, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9124, 'compress@10': 0.4484, 'time@10': 5.5482}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]    {'epoch': 20, 'num_users': 6.3, 'loss': 0.026, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9124, 'compress@10': 0.4484, 'time@10': 5.5482}: 100%|██████████| 10/10 [00:40<00:00,  4.58s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.026, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9124, 'compress@10': 0.4484, 'time@10': 5.5482}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.026013194193157015
Avg hit ratio: 0.9053044145064518
Avg ndcg: 0.9124002914561608
Avg compression ratio: 0.44840436249787113
Avg train time: 5.548249006271362
Std train time: 1.7333646459560619
[0.8136363636363636, 0.3136363636363637, 0.08636363636363635, 0.9045454545454544, 0.9954545454545454, 0.9500000000000001, 0.22272727272727272, 0.44999999999999996, 0.31363636363636366, 0.13181818181818183]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0334, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.876, 'compress@10': 0.998, 'time@10': 4.6986}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0334, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.876, 'compress@10': 0.998, 'time@10': 4.6986}:  10%|█         | 1/10 [00:02<00:21,  2.40s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9013, 'compress@10': 0.5318, 'time@10': 4.4465}:  10%|█         | 1/10 [00:06<00:21,  2.40s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9013, 'compress@10': 0.5318, 'time@10': 4.4465}:  20%|██        | 2/10 [00:06<00:27,  3.49s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8866, 'compress@10': 0.4022, 'time@10': 4.0636}:  20%|██        | 2/10 [00:08<00:27,  3.49s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8866, 'compress@10': 0.4022, 'time@10': 4.0636}:  30%|███       | 3/10 [00:08<00:18,  2.67s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8967, 'compress@10': 0.5516, 'time@10': 4.0001}:  30%|███       | 3/10 [00:12<00:18,  2.67s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8967, 'compress@10': 0.5516, 'time@10': 4.0001}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0239, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8865, 'compress@10': 0.6413, 'time@10': 4.8611}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0239, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8865, 'compress@10': 0.6413, 'time@10': 4.8611}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0232, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8949, 'compress@10': 0.701, 'time@10': 5.0909}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0232, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8949, 'compress@10': 0.701, 'time@10': 5.0909}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0235, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.896, 'compress@10': 0.6071, 'time@10': 5.3128}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0235, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.896, 'compress@10': 0.6071, 'time@10': 5.3128}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.8988, 'compress@10': 0.5464, 'time@10': 5.2455}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.8988, 'compress@10': 0.5464, 'time@10': 5.2455}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0246, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9232, 'compress@10': 0.4919, 'time@10': 5.6209}:  80%|████████  | 8/10 [00:35<00:08,  4.33s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0246, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9232, 'compress@10': 0.4919, 'time@10': 5.6209}:  90%|█████████ | 9/10 [00:35<00:04,  4.33s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.927, 'compress@10': 0.445, 'time@10': 5.5999}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]     {'epoch': 21, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.927, 'compress@10': 0.445, 'time@10': 5.5999}: 100%|██████████| 10/10 [00:40<00:00,  4.68s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.927, 'compress@10': 0.445, 'time@10': 5.5999}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.023647299349794038
Avg hit ratio: 0.902447271649309
Avg ndcg: 0.9269853069412447
Avg compression ratio: 0.4450039390615833
Avg train time: 5.599947690963745
Std train time: 1.7312375727391784
[0.8217391304347825, 0.3000000000000001, 0.0826086956521739, 0.9086956521739129, 0.9956521739130434, 0.9086956521739131, 0.2565217391304348, 0.4304347826086956, 0.34347826086956523, 0.12608695652173915]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0299, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.879, 'compress@10': 0.9983, 'time@10': 4.5892}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0299, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.879, 'compress@10': 0.9983, 'time@10': 4.5892}:  10%|█         | 1/10 [00:02<00:21,  2.33s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9041, 'compress@10': 0.5267, 'time@10': 4.4441}:  10%|█         | 1/10 [00:06<00:21,  2.33s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9041, 'compress@10': 0.5267, 'time@10': 4.4441}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8884, 'compress@10': 0.3988, 'time@10': 4.0679}:  20%|██        | 2/10 [00:08<00:28,  3.51s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8884, 'compress@10': 0.3988, 'time@10': 4.0679}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8963, 'compress@10': 0.549, 'time@10': 3.9868}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8963, 'compress@10': 0.549, 'time@10': 3.9868}:  40%|████      | 4/10 [00:12<00:18,  3.12s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0229, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8875, 'compress@10': 0.6392, 'time@10': 4.8687}:  40%|████      | 4/10 [00:16<00:18,  3.12s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0229, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8875, 'compress@10': 0.6392, 'time@10': 4.8687}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0225, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8964, 'compress@10': 0.6993, 'time@10': 5.0899}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0225, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8964, 'compress@10': 0.6993, 'time@10': 5.0899}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0219, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.899, 'compress@10': 0.6062, 'time@10': 5.2977}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it] {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0219, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.899, 'compress@10': 0.6062, 'time@10': 5.2977}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.903, 'compress@10': 0.5424, 'time@10': 5.2292}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.903, 'compress@10': 0.5424, 'time@10': 5.2292}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9193, 'compress@10': 0.4893, 'time@10': 5.6037}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9193, 'compress@10': 0.4893, 'time@10': 5.6037}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.92, 'compress@10': 0.4427, 'time@10': 5.5657}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]     {'epoch': 22, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.92, 'compress@10': 0.4427, 'time@10': 5.5657}: 100%|██████████| 10/10 [00:40<00:00,  4.61s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.92, 'compress@10': 0.4427, 'time@10': 5.5657}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.024413661670574238
Avg hit ratio: 0.8938758430778805
Avg ndcg: 0.92004801239239
Avg compression ratio: 0.4426780484326021
Avg train time: 5.565692663192749
Std train time: 1.740653909261727
[0.8291666666666666, 0.2875000000000001, 0.07916666666666665, 0.9124999999999999, 0.9958333333333332, 0.8708333333333335, 0.24583333333333335, 0.4125, 0.37083333333333335, 0.16250000000000003]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.879, 'compress@10': 0.9985, 'time@10': 4.7625}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.879, 'compress@10': 0.9985, 'time@10': 4.7625}:  10%|█         | 1/10 [00:02<00:21,  2.42s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9024, 'compress@10': 0.523, 'time@10': 4.5081}:  10%|█         | 1/10 [00:06<00:21,  2.42s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9024, 'compress@10': 0.523, 'time@10': 4.5081}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8873, 'compress@10': 0.3963, 'time@10': 4.1255}:  20%|██        | 2/10 [00:08<00:28,  3.52s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8873, 'compress@10': 0.3963, 'time@10': 4.1255}:  30%|███       | 3/10 [00:08<00:18,  2.70s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8961, 'compress@10': 0.5472, 'time@10': 4.0387}:  30%|███       | 3/10 [00:12<00:18,  2.70s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8961, 'compress@10': 0.5472, 'time@10': 4.0387}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.8881, 'compress@10': 0.6377, 'time@10': 4.9124}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.8881, 'compress@10': 0.6377, 'time@10': 4.9124}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0232, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.8962, 'compress@10': 0.6981, 'time@10': 5.1358}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0232, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.8962, 'compress@10': 0.6981, 'time@10': 5.1358}:  60%|██████    | 6/10 [00:22<00:17,  4.48s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0226, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.8993, 'compress@10': 0.6048, 'time@10': 5.3117}:  60%|██████    | 6/10 [00:26<00:17,  4.48s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0226, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.8993, 'compress@10': 0.6048, 'time@10': 5.3117}:  70%|███████   | 7/10 [00:26<00:12,  4.07s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0215, 'hit_ratio@10': 0.9155, 'ndcg@10': 0.9049, 'compress@10': 0.5393, 'time@10': 5.2421}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0215, 'hit_ratio@10': 0.9155, 'ndcg@10': 0.9049, 'compress@10': 0.5393, 'time@10': 5.2421}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9033, 'compress@10': 0.4881, 'time@10': 5.615}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9033, 'compress@10': 0.4881, 'time@10': 5.615}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9099, 'compress@10': 0.4416, 'time@10': 5.594}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9099, 'compress@10': 0.4416, 'time@10': 5.594}: 100%|██████████| 10/10 [00:40<00:00,  4.66s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9099, 'compress@10': 0.4416, 'time@10': 5.594}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.02073293125283885
Avg hit ratio: 0.9044021588673541
Avg ndcg: 0.9098872356633727
Avg compression ratio: 0.44157207469107107
Avg train time: 5.593965363502503
Std train time: 1.7172284099187387
[0.836, 0.2760000000000001, 0.07599999999999998, 0.9159999999999999, 0.9959999999999999, 0.8760000000000001, 0.23600000000000002, 0.39599999999999996, 0.396, 0.15600000000000003]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.879, 'compress@10': 0.9987, 'time@10': 4.9004}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.879, 'compress@10': 0.9987, 'time@10': 4.9004}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9073, 'compress@10': 0.5208, 'time@10': 4.5653}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9073, 'compress@10': 0.5208, 'time@10': 4.5653}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.8906, 'compress@10': 0.3949, 'time@10': 4.14}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.8906, 'compress@10': 0.3949, 'time@10': 4.14}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9, 'compress@10': 0.5461, 'time@10': 4.0486}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9, 'compress@10': 0.5461, 'time@10': 4.0486}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0213, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8929, 'compress@10': 0.6369, 'time@10': 4.9041}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0213, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8929, 'compress@10': 0.6369, 'time@10': 4.9041}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0201, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9025, 'compress@10': 0.6973, 'time@10': 5.123}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0201, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9025, 'compress@10': 0.6973, 'time@10': 5.123}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0206, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9038, 'compress@10': 0.604, 'time@10': 5.318}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it] {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0206, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9038, 'compress@10': 0.604, 'time@10': 5.318}:  70%|███████   | 7/10 [00:26<00:12,  4.07s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.908, 'compress@10': 0.5374, 'time@10': 5.2466}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.908, 'compress@10': 0.5374, 'time@10': 5.2466}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.89, 'ndcg@10': 0.915, 'compress@10': 0.491, 'time@10': 5.6316}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]  {'epoch': 24, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.89, 'ndcg@10': 0.915, 'compress@10': 0.491, 'time@10': 5.6316}:  90%|█████████ | 9/10 [00:35<00:04,  4.33s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0215, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.915, 'compress@10': 0.4442, 'time@10': 5.6005}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0215, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.915, 'compress@10': 0.4442, 'time@10': 5.6005}: 100%|██████████| 10/10 [00:40<00:00,  4.65s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0215, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.915, 'compress@10': 0.4442, 'time@10': 5.6005}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.021498042846996697
Avg hit ratio: 0.8986878731530684
Avg ndcg: 0.915010734229978
Avg compression ratio: 0.44421370648313274
Avg train time: 5.600490307807922
Std train time: 1.7356018157173352
[0.8423076923076923, 0.26538461538461544, 0.07307692307692307, 0.9192307692307692, 0.9961538461538461, 0.8423076923076924, 0.2653846153846154, 0.38076923076923075, 0.3807692307692308, 0.18846153846153849]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.885, 'compress@10': 0.9988, 'time@10': 4.9178}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.885, 'compress@10': 0.9988, 'time@10': 4.9178}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9149, 'compress@10': 0.5194, 'time@10': 4.5592}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9149, 'compress@10': 0.5194, 'time@10': 4.5592}:  20%|██        | 2/10 [00:06<00:28,  3.55s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8957, 'compress@10': 0.3939, 'time@10': 4.1392}:  20%|██        | 2/10 [00:08<00:28,  3.55s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8957, 'compress@10': 0.3939, 'time@10': 4.1392}:  30%|███       | 3/10 [00:08<00:18,  2.70s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9035, 'compress@10': 0.5454, 'time@10': 4.046}:  30%|███       | 3/10 [00:12<00:18,  2.70s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9035, 'compress@10': 0.5454, 'time@10': 4.046}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.8963, 'compress@10': 0.6363, 'time@10': 4.9051}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.8963, 'compress@10': 0.6363, 'time@10': 4.9051}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9047, 'compress@10': 0.6968, 'time@10': 5.1258}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9047, 'compress@10': 0.6968, 'time@10': 5.1258}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0191, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9067, 'compress@10': 0.604, 'time@10': 5.3353}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.0191, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9067, 'compress@10': 0.604, 'time@10': 5.3353}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9103, 'compress@10': 0.5361, 'time@10': 5.2492}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9103, 'compress@10': 0.5361, 'time@10': 5.2492}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9171, 'compress@10': 0.4864, 'time@10': 5.6157}:  80%|████████  | 8/10 [00:35<00:08,  4.28s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9171, 'compress@10': 0.4864, 'time@10': 5.6157}:  90%|█████████ | 9/10 [00:35<00:04,  4.29s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9227, 'compress@10': 0.4401, 'time@10': 5.5825}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9227, 'compress@10': 0.4401, 'time@10': 5.5825}: 100%|██████████| 10/10 [00:40<00:00,  4.62s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9227, 'compress@10': 0.4401, 'time@10': 5.5825}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.017718081358007925
Avg hit ratio: 0.9009100953752904
Avg ndcg: 0.9227135202148334
Avg compression ratio: 0.44008802300868266
Avg train time: 5.582511162757873
Std train time: 1.7224120923213202
[0.8481481481481482, 0.2555555555555556, 0.07037037037037036, 0.9222222222222222, 0.9962962962962962, 0.8111111111111112, 0.29259259259259257, 0.36666666666666664, 0.40370370370370373, 0.1814814814814815]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8864, 'compress@10': 0.9989, 'time@10': 4.7182}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8864, 'compress@10': 0.9989, 'time@10': 4.7182}:  10%|█         | 1/10 [00:02<00:21,  2.40s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9114, 'compress@10': 0.5184, 'time@10': 4.4724}:  10%|█         | 1/10 [00:06<00:21,  2.40s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9114, 'compress@10': 0.5184, 'time@10': 4.4724}:  20%|██        | 2/10 [00:06<00:27,  3.50s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8933, 'compress@10': 0.3932, 'time@10': 4.0961}:  20%|██        | 2/10 [00:08<00:27,  3.50s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8933, 'compress@10': 0.3932, 'time@10': 4.0961}:  30%|███       | 3/10 [00:08<00:18,  2.68s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9049, 'compress@10': 0.5449, 'time@10': 4.0084}:  30%|███       | 3/10 [00:12<00:18,  2.68s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9049, 'compress@10': 0.5449, 'time@10': 4.0084}:  40%|████      | 4/10 [00:12<00:18,  3.12s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8985, 'compress@10': 0.6359, 'time@10': 4.8941}:  40%|████      | 4/10 [00:16<00:18,  3.12s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8985, 'compress@10': 0.6359, 'time@10': 4.8941}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0203, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9081, 'compress@10': 0.6963, 'time@10': 5.1073}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0203, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9081, 'compress@10': 0.6963, 'time@10': 5.1073}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9105, 'compress@10': 0.6042, 'time@10': 5.3017}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9105, 'compress@10': 0.6042, 'time@10': 5.3017}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9161, 'compress@10': 0.5352, 'time@10': 5.2321}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9161, 'compress@10': 0.5352, 'time@10': 5.2321}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9195, 'compress@10': 0.4885, 'time@10': 5.6004}:  80%|████████  | 8/10 [00:35<00:08,  4.29s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9195, 'compress@10': 0.4885, 'time@10': 5.6004}:  90%|█████████ | 9/10 [00:35<00:04,  4.30s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9202, 'compress@10': 0.442, 'time@10': 5.574}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]    {'epoch': 26, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9202, 'compress@10': 0.442, 'time@10': 5.574}: 100%|██████████| 10/10 [00:40<00:00,  4.63s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9202, 'compress@10': 0.442, 'time@10': 5.574}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.01934519422548736
Avg hit ratio: 0.9001958096610048
Avg ndcg: 0.9201604374757097
Avg compression ratio: 0.44197756368817875
Avg train time: 5.573965358734131
Std train time: 1.7264009688153088
[0.8535714285714286, 0.24642857142857147, 0.06785714285714285, 0.9249999999999999, 0.9964285714285713, 0.817857142857143, 0.28214285714285714, 0.35357142857142854, 0.3892857142857143, 0.21071428571428572]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8886, 'compress@10': 0.999, 'time@10': 4.8467}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8886, 'compress@10': 0.999, 'time@10': 4.8467}:  10%|█         | 1/10 [00:02<00:22,  2.46s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9158, 'compress@10': 0.5179, 'time@10': 4.4916}:  10%|█         | 1/10 [00:06<00:22,  2.46s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9158, 'compress@10': 0.5179, 'time@10': 4.4916}:  20%|██        | 2/10 [00:06<00:27,  3.47s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8963, 'compress@10': 0.3929, 'time@10': 4.1241}:  20%|██        | 2/10 [00:08<00:27,  3.47s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8963, 'compress@10': 0.3929, 'time@10': 4.1241}:  30%|███       | 3/10 [00:08<00:18,  2.68s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9079, 'compress@10': 0.5446, 'time@10': 4.0223}:  30%|███       | 3/10 [00:12<00:18,  2.68s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9079, 'compress@10': 0.5446, 'time@10': 4.0223}:  40%|████      | 4/10 [00:12<00:18,  3.10s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9022, 'compress@10': 0.6357, 'time@10': 4.8647}:  40%|████      | 4/10 [00:16<00:18,  3.10s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9022, 'compress@10': 0.6357, 'time@10': 4.8647}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9117, 'compress@10': 0.6961, 'time@10': 5.0851}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9117, 'compress@10': 0.6961, 'time@10': 5.0851}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9137, 'compress@10': 0.6036, 'time@10': 5.2873}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9137, 'compress@10': 0.6036, 'time@10': 5.2873}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9179, 'compress@10': 0.5343, 'time@10': 5.2261}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9179, 'compress@10': 0.5343, 'time@10': 5.2261}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.922, 'compress@10': 0.4881, 'time@10': 5.5972}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.922, 'compress@10': 0.4881, 'time@10': 5.5972}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9263, 'compress@10': 0.4416, 'time@10': 5.5937}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]  {'epoch': 27, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9263, 'compress@10': 0.4416, 'time@10': 5.5937}: 100%|██████████| 10/10 [00:40<00:00,  4.71s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9263, 'compress@10': 0.4416, 'time@10': 5.5937}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.01635474112724795
Avg hit ratio: 0.9085450160102113
Avg ndcg: 0.926349239526097
Avg compression ratio: 0.4416488159260686
Avg train time: 5.593670678138733
Std train time: 1.6933646289789595
[0.8586206896551725, 0.23793103448275865, 0.06551724137931034, 0.9275862068965517, 0.9965517241379309, 0.7896551724137932, 0.30689655172413793, 0.34137931034482755, 0.37586206896551727, 0.23793103448275862]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8949, 'compress@10': 0.9991, 'time@10': 4.751}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8949, 'compress@10': 0.9991, 'time@10': 4.751}:  10%|█         | 1/10 [00:02<00:21,  2.41s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9258, 'compress@10': 0.5177, 'time@10': 4.5141}:  10%|█         | 1/10 [00:06<00:21,  2.41s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9258, 'compress@10': 0.5177, 'time@10': 4.5141}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9029, 'compress@10': 0.3927, 'time@10': 4.133}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9029, 'compress@10': 0.3927, 'time@10': 4.133}:  30%|███       | 3/10 [00:08<00:18,  2.71s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.914, 'compress@10': 0.5445, 'time@10': 4.0474}:  30%|███       | 3/10 [00:12<00:18,  2.71s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.914, 'compress@10': 0.5445, 'time@10': 4.0474}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9088, 'compress@10': 0.6356, 'time@10': 4.9183}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9088, 'compress@10': 0.6356, 'time@10': 4.9183}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9176, 'compress@10': 0.6958, 'time@10': 5.1307}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9176, 'compress@10': 0.6958, 'time@10': 5.1307}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9187, 'compress@10': 0.604, 'time@10': 5.3194}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it] {'epoch': 28, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9187, 'compress@10': 0.604, 'time@10': 5.3194}:  70%|███████   | 7/10 [00:26<00:12,  4.07s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9222, 'compress@10': 0.534, 'time@10': 5.2482}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9222, 'compress@10': 0.534, 'time@10': 5.2482}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.928, 'compress@10': 0.4861, 'time@10': 5.6067}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.928, 'compress@10': 0.4861, 'time@10': 5.6067}:  90%|█████████ | 9/10 [00:35<00:04,  4.29s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9321, 'compress@10': 0.4399, 'time@10': 5.5997}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]  {'epoch': 28, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9321, 'compress@10': 0.4399, 'time@10': 5.5997}: 100%|██████████| 10/10 [00:40<00:00,  4.69s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9321, 'compress@10': 0.4399, 'time@10': 5.5997}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.015477075481692918
Avg hit ratio: 0.902195809661005
Avg ndcg: 0.9321053542879868
Avg compression ratio: 0.43989205235199336
Avg train time: 5.599675965309143
Std train time: 1.6922060683990594
[0.8633333333333334, 0.23000000000000004, 0.06333333333333332, 0.9299999999999999, 0.9966666666666666, 0.7633333333333334, 0.33, 0.32999999999999996, 0.3966666666666667, 0.23]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8923, 'compress@10': 0.9992, 'time@10': 4.8387}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8923, 'compress@10': 0.9992, 'time@10': 4.8387}:  10%|█         | 1/10 [00:02<00:22,  2.46s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9245, 'compress@10': 0.5174, 'time@10': 4.5262}:  10%|█         | 1/10 [00:06<00:22,  2.46s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9245, 'compress@10': 0.5174, 'time@10': 4.5262}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.902, 'compress@10': 0.3926, 'time@10': 4.1159}:  20%|██        | 2/10 [00:08<00:28,  3.51s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.902, 'compress@10': 0.3926, 'time@10': 4.1159}:  30%|███       | 3/10 [00:08<00:18,  2.68s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9133, 'compress@10': 0.5444, 'time@10': 4.026}:  30%|███       | 3/10 [00:12<00:18,  2.68s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9133, 'compress@10': 0.5444, 'time@10': 4.026}:  40%|████      | 4/10 [00:12<00:18,  3.12s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.908, 'compress@10': 0.6355, 'time@10': 4.8778}:  40%|████      | 4/10 [00:16<00:18,  3.12s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.908, 'compress@10': 0.6355, 'time@10': 4.8778}:  50%|█████     | 5/10 [00:16<00:17,  3.50s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9188, 'compress@10': 0.6953, 'time@10': 5.1101}:  50%|█████     | 5/10 [00:22<00:17,  3.50s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9188, 'compress@10': 0.6953, 'time@10': 5.1101}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0167, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9219, 'compress@10': 0.6046, 'time@10': 5.3178}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0167, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9219, 'compress@10': 0.6046, 'time@10': 5.3178}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9263, 'compress@10': 0.5341, 'time@10': 5.2444}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9263, 'compress@10': 0.5341, 'time@10': 5.2444}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9416, 'compress@10': 0.4888, 'time@10': 5.5907}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9416, 'compress@10': 0.4888, 'time@10': 5.5907}:  90%|█████████ | 9/10 [00:35<00:04,  4.28s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9434, 'compress@10': 0.4424, 'time@10': 5.5728}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9434, 'compress@10': 0.4424, 'time@10': 5.5728}: 100%|██████████| 10/10 [00:40<00:00,  4.64s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9434, 'compress@10': 0.4424, 'time@10': 5.5728}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.017028180330788817
Avg hit ratio: 0.8993386668038621
Avg ndcg: 0.9433955925787224
Avg compression ratio: 0.44235143190358217
Avg train time: 5.572848081588745
Std train time: 1.6796104591775929
[0.867741935483871, 0.22258064516129036, 0.06129032258064515, 0.932258064516129, 0.996774193548387, 0.770967741935484, 0.31935483870967746, 0.3193548387096774, 0.4161290322580646, 0.22258064516129034]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.895, 'compress@10': 0.9993, 'time@10': 4.8738}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.895, 'compress@10': 0.9993, 'time@10': 4.8738}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9246, 'compress@10': 0.5173, 'time@10': 4.5208}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9246, 'compress@10': 0.5173, 'time@10': 4.5208}:  20%|██        | 2/10 [00:06<00:28,  3.50s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9021, 'compress@10': 0.3925, 'time@10': 4.1246}:  20%|██        | 2/10 [00:08<00:28,  3.50s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9021, 'compress@10': 0.3925, 'time@10': 4.1246}:  30%|███       | 3/10 [00:08<00:18,  2.68s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.915, 'compress@10': 0.5443, 'time@10': 4.0372}:  30%|███       | 3/10 [00:12<00:18,  2.68s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.915, 'compress@10': 0.5443, 'time@10': 4.0372}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.911, 'compress@10': 0.6355, 'time@10': 4.9078}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.911, 'compress@10': 0.6355, 'time@10': 4.9078}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9196, 'compress@10': 0.6953, 'time@10': 5.1169}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9196, 'compress@10': 0.6953, 'time@10': 5.1169}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9218, 'compress@10': 0.6041, 'time@10': 5.2995}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9218, 'compress@10': 0.6041, 'time@10': 5.2995}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0148, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9265, 'compress@10': 0.5335, 'time@10': 5.2298}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0148, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9265, 'compress@10': 0.5335, 'time@10': 5.2298}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.954, 'compress@10': 0.4899, 'time@10': 5.5905}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.954, 'compress@10': 0.4899, 'time@10': 5.5905}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9563, 'compress@10': 0.4433, 'time@10': 5.5687}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]  {'epoch': 30, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9563, 'compress@10': 0.4433, 'time@10': 5.5687}: 100%|██████████| 10/10 [00:40<00:00,  4.63s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9563, 'compress@10': 0.4433, 'time@10': 5.5687}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.017800421535389334
Avg hit ratio: 0.8885450160102113
Avg ndcg: 0.9562526938899856
Avg compression ratio: 0.4432932727694392
Avg train time: 5.568673300743103
Std train time: 1.6980115285933226
[0.8718750000000001, 0.21562500000000004, 0.05937499999999999, 0.934375, 0.996875, 0.7468750000000002, 0.34062500000000007, 0.30937499999999996, 0.43437500000000007, 0.215625]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.895, 'compress@10': 0.9994, 'time@10': 5.0158}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.895, 'compress@10': 0.9994, 'time@10': 5.0158}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9291, 'compress@10': 0.5173, 'time@10': 4.6376}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9291, 'compress@10': 0.5173, 'time@10': 4.6376}:  20%|██        | 2/10 [00:06<00:28,  3.61s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9051, 'compress@10': 0.3925, 'time@10': 4.1957}:  20%|██        | 2/10 [00:08<00:28,  3.61s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9051, 'compress@10': 0.3925, 'time@10': 4.1957}:  30%|███       | 3/10 [00:08<00:19,  2.74s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9172, 'compress@10': 0.5444, 'time@10': 4.0962}:  30%|███       | 3/10 [00:12<00:19,  2.74s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9172, 'compress@10': 0.5444, 'time@10': 4.0962}:  40%|████      | 4/10 [00:12<00:19,  3.17s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9141, 'compress@10': 0.6355, 'time@10': 4.9354}:  40%|████      | 4/10 [00:16<00:19,  3.17s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9141, 'compress@10': 0.6355, 'time@10': 4.9354}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9222, 'compress@10': 0.6947, 'time@10': 5.1468}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9222, 'compress@10': 0.6947, 'time@10': 5.1468}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9237, 'compress@10': 0.6045, 'time@10': 5.3688}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9237, 'compress@10': 0.6045, 'time@10': 5.3688}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9287, 'compress@10': 0.5337, 'time@10': 5.2902}:  70%|███████   | 7/10 [00:31<00:12,  4.11s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9287, 'compress@10': 0.5337, 'time@10': 5.2902}:  80%|████████  | 8/10 [00:31<00:08,  4.33s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0169, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9241, 'compress@10': 0.4911, 'time@10': 5.614}:  80%|████████  | 8/10 [00:35<00:08,  4.33s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0169, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9241, 'compress@10': 0.4911, 'time@10': 5.614}:  90%|█████████ | 9/10 [00:35<00:04,  4.27s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9268, 'compress@10': 0.4444, 'time@10': 5.5985}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]  {'epoch': 31, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9268, 'compress@10': 0.4444, 'time@10': 5.5985}: 100%|██████████| 10/10 [00:40<00:00,  4.65s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9268, 'compress@10': 0.4444, 'time@10': 5.5985}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.018155674018972886
Avg hit ratio: 0.8792362602498427
Avg ndcg: 0.9267929317060236
Avg compression ratio: 0.4443648499615856
Avg train time: 5.598475337028503
Std train time: 1.6428680660987993
[0.8757575757575758, 0.20909090909090913, 0.057575757575757565, 0.906060606060606, 0.996969696969697, 0.7242424242424245, 0.36060606060606065, 0.29999999999999993, 0.4515151515151516, 0.2393939393939394]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.895, 'compress@10': 0.9995, 'time@10': 4.8778}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.895, 'compress@10': 0.9995, 'time@10': 4.8778}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9265, 'compress@10': 0.5172, 'time@10': 4.5001}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9265, 'compress@10': 0.5172, 'time@10': 4.5001}:  20%|██        | 2/10 [00:06<00:27,  3.47s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9034, 'compress@10': 0.3925, 'time@10': 4.0855}:  20%|██        | 2/10 [00:08<00:27,  3.47s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9034, 'compress@10': 0.3925, 'time@10': 4.0855}:  30%|███       | 3/10 [00:08<00:18,  2.65s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.915, 'compress@10': 0.5443, 'time@10': 4.0078}:  30%|███       | 3/10 [00:12<00:18,  2.65s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.915, 'compress@10': 0.5443, 'time@10': 4.0078}:  40%|████      | 4/10 [00:12<00:18,  3.11s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9138, 'compress@10': 0.6354, 'time@10': 4.8471}:  40%|████      | 4/10 [00:16<00:18,  3.11s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9138, 'compress@10': 0.6354, 'time@10': 4.8471}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0158, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9261, 'compress@10': 0.6935, 'time@10': 5.0746}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0158, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9261, 'compress@10': 0.6935, 'time@10': 5.0746}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9293, 'compress@10': 0.6051, 'time@10': 5.3025}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9293, 'compress@10': 0.6051, 'time@10': 5.3025}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9337, 'compress@10': 0.5339, 'time@10': 5.2371}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9337, 'compress@10': 0.5339, 'time@10': 5.2371}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.937, 'compress@10': 0.5003, 'time@10': 5.5563}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.937, 'compress@10': 0.5003, 'time@10': 5.5563}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.9408, 'compress@10': 0.4528, 'time@10': 5.5695}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.9408, 'compress@10': 0.4528, 'time@10': 5.5695}: 100%|██████████| 10/10 [00:40<00:00,  4.70s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.9408, 'compress@10': 0.4528, 'time@10': 5.5695}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.01227421165260307
Avg hit ratio: 0.9079100953752907
Avg ndcg: 0.9407843764137777
Avg compression ratio: 0.45275565787927724
Avg train time: 5.5694931745529175
Std train time: 1.6370455043796295
[0.8794117647058824, 0.20294117647058826, 0.05588235294117646, 0.9088235294117647, 0.9970588235294118, 0.7323529411764708, 0.35000000000000003, 0.2911764705882352, 0.46764705882352947, 0.2323529411764706]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9098, 'compress@10': 0.9995, 'time@10': 4.8755}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9098, 'compress@10': 0.9995, 'time@10': 4.8755}:  10%|█         | 1/10 [00:02<00:22,  2.47s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9345, 'compress@10': 0.5171, 'time@10': 4.4622}:  10%|█         | 1/10 [00:06<00:22,  2.47s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9345, 'compress@10': 0.5171, 'time@10': 4.4622}:  20%|██        | 2/10 [00:06<00:27,  3.42s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9087, 'compress@10': 0.3924, 'time@10': 4.09}:  20%|██        | 2/10 [00:08<00:27,  3.42s/it]  {'epoch': 33, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9087, 'compress@10': 0.3924, 'time@10': 4.09}:  30%|███       | 3/10 [00:08<00:18,  2.64s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9195, 'compress@10': 0.5442, 'time@10': 4.01}:  30%|███       | 3/10 [00:12<00:18,  2.64s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9195, 'compress@10': 0.5442, 'time@10': 4.01}:  40%|████      | 4/10 [00:12<00:18,  3.10s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9184, 'compress@10': 0.6354, 'time@10': 4.9148}:  40%|████      | 4/10 [00:16<00:18,  3.10s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9184, 'compress@10': 0.6354, 'time@10': 4.9148}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9266, 'compress@10': 0.6939, 'time@10': 5.1105}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9266, 'compress@10': 0.6939, 'time@10': 5.1105}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9292, 'compress@10': 0.6048, 'time@10': 5.3204}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]  {'epoch': 33, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9292, 'compress@10': 0.6048, 'time@10': 5.3204}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9336, 'compress@10': 0.5336, 'time@10': 5.2468}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9336, 'compress@10': 0.5336, 'time@10': 5.2468}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9378, 'compress@10': 0.5038, 'time@10': 5.5744}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it] {'epoch': 33, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9378, 'compress@10': 0.5038, 'time@10': 5.5744}:  90%|█████████ | 9/10 [00:34<00:04,  4.24s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.938, 'compress@10': 0.4559, 'time@10': 5.56}:  90%|█████████ | 9/10 [00:40<00:04,  4.24s/it]    {'epoch': 33, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.938, 'compress@10': 0.4559, 'time@10': 5.56}: 100%|██████████| 10/10 [00:40<00:00,  4.62s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.938, 'compress@10': 0.4559, 'time@10': 5.56}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.01383820435873068
Avg hit ratio: 0.8906274802352903
Avg ndcg: 0.9379556108572528
Avg compression ratio: 0.4558750438931831
Avg train time: 5.5600368022918705
Std train time: 1.6933289092926196
[0.8828571428571429, 0.19714285714285718, 0.05428571428571428, 0.9114285714285714, 0.9971428571428571, 0.7114285714285716, 0.3685714285714286, 0.28285714285714275, 0.45428571428571435, 0.2542857142857143]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9116, 'compress@10': 0.9996, 'time@10': 4.9627}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9116, 'compress@10': 0.9996, 'time@10': 4.9627}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9383, 'compress@10': 0.5171, 'time@10': 4.5289}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9383, 'compress@10': 0.5171, 'time@10': 4.5289}:  20%|██        | 2/10 [00:06<00:27,  3.47s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9112, 'compress@10': 0.3924, 'time@10': 4.1306}:  20%|██        | 2/10 [00:08<00:27,  3.47s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9112, 'compress@10': 0.3924, 'time@10': 4.1306}:  30%|███       | 3/10 [00:08<00:18,  2.67s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9217, 'compress@10': 0.5443, 'time@10': 4.0506}:  30%|███       | 3/10 [00:12<00:18,  2.67s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9217, 'compress@10': 0.5443, 'time@10': 4.0506}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9204, 'compress@10': 0.6354, 'time@10': 4.906}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9204, 'compress@10': 0.6354, 'time@10': 4.906}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9285, 'compress@10': 0.6931, 'time@10': 5.1204}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9285, 'compress@10': 0.6931, 'time@10': 5.1204}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9294, 'compress@10': 0.6053, 'time@10': 5.3489}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9294, 'compress@10': 0.6053, 'time@10': 5.3489}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9339, 'compress@10': 0.5339, 'time@10': 5.2771}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]  {'epoch': 34, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9339, 'compress@10': 0.5339, 'time@10': 5.2771}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9361, 'compress@10': 0.5001, 'time@10': 5.6101}:  80%|████████  | 8/10 [00:35<00:08,  4.33s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9361, 'compress@10': 0.5001, 'time@10': 5.6101}:  90%|█████████ | 9/10 [00:35<00:04,  4.28s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9401, 'compress@10': 0.4526, 'time@10': 5.602}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]    {'epoch': 34, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9401, 'compress@10': 0.4526, 'time@10': 5.602}: 100%|██████████| 10/10 [00:40<00:00,  4.68s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9401, 'compress@10': 0.4526, 'time@10': 5.602}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.012577328939509472
Avg hit ratio: 0.895890638130027
Avg ndcg: 0.9400509168119582
Avg compression ratio: 0.45260976489254645
Avg train time: 5.602018141746521
Std train time: 1.6700181958879374
[0.8861111111111112, 0.21944444444444447, 0.05277777777777777, 0.9138888888888889, 0.9972222222222222, 0.6916666666666669, 0.3861111111111111, 0.2749999999999999, 0.4416666666666667, 0.24722222222222223]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9158, 'compress@10': 0.9996, 'time@10': 4.9916}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9158, 'compress@10': 0.9996, 'time@10': 4.9916}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9442, 'compress@10': 0.5182, 'time@10': 4.5557}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9442, 'compress@10': 0.5182, 'time@10': 4.5557}:  20%|██        | 2/10 [00:06<00:27,  3.49s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9152, 'compress@10': 0.3931, 'time@10': 4.1445}:  20%|██        | 2/10 [00:08<00:27,  3.49s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9152, 'compress@10': 0.3931, 'time@10': 4.1445}:  30%|███       | 3/10 [00:08<00:18,  2.67s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9245, 'compress@10': 0.5448, 'time@10': 4.0465}:  30%|███       | 3/10 [00:12<00:18,  2.67s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9245, 'compress@10': 0.5448, 'time@10': 4.0465}:  40%|████      | 4/10 [00:12<00:18,  3.12s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9234, 'compress@10': 0.6358, 'time@10': 4.8878}:  40%|████      | 4/10 [00:16<00:18,  3.12s/it] {'epoch': 35, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9234, 'compress@10': 0.6358, 'time@10': 4.8878}:  50%|█████     | 5/10 [00:16<00:17,  3.50s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9374, 'compress@10': 0.692, 'time@10': 5.0883}:  50%|█████     | 5/10 [00:22<00:17,  3.50s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9374, 'compress@10': 0.692, 'time@10': 5.0883}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9394, 'compress@10': 0.6068, 'time@10': 5.3094}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9394, 'compress@10': 0.6068, 'time@10': 5.3094}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9427, 'compress@10': 0.5351, 'time@10': 5.2374}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9427, 'compress@10': 0.5351, 'time@10': 5.2374}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9451, 'compress@10': 0.4978, 'time@10': 5.5686}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9451, 'compress@10': 0.4978, 'time@10': 5.5686}:  90%|█████████ | 9/10 [00:34<00:04,  4.24s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.945, 'compress@10': 0.4506, 'time@10': 5.5538}:  90%|█████████ | 9/10 [00:40<00:04,  4.24s/it]    {'epoch': 35, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.945, 'compress@10': 0.4506, 'time@10': 5.5538}: 100%|██████████| 10/10 [00:40<00:00,  4.62s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.945, 'compress@10': 0.4506, 'time@10': 5.5538}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.013818055483204823
Avg hit ratio: 0.9127672382324334
Avg ndcg: 0.9450303586596707
Avg compression ratio: 0.45055801311660826
Avg train time: 5.5538414239883425
Std train time: 1.6471619486318116
[0.8891891891891892, 0.21351351351351353, 0.05135135135135135, 0.9162162162162162, 0.9972972972972973, 0.7000000000000002, 0.37567567567567567, 0.2675675675675675, 0.4297297297297298, 0.26756756756756755]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9191, 'compress@10': 0.9996, 'time@10': 4.934}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9191, 'compress@10': 0.9996, 'time@10': 4.934}:  10%|█         | 1/10 [00:02<00:22,  2.50s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9428, 'compress@10': 0.5175, 'time@10': 4.4893}:  10%|█         | 1/10 [00:06<00:22,  2.50s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9428, 'compress@10': 0.5175, 'time@10': 4.4893}:  20%|██        | 2/10 [00:06<00:27,  3.43s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9142, 'compress@10': 0.3926, 'time@10': 4.0978}:  20%|██        | 2/10 [00:08<00:27,  3.43s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9142, 'compress@10': 0.3926, 'time@10': 4.0978}:  30%|███       | 3/10 [00:08<00:18,  2.64s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9246, 'compress@10': 0.5444, 'time@10': 4.0165}:  30%|███       | 3/10 [00:12<00:18,  2.64s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9246, 'compress@10': 0.5444, 'time@10': 4.0165}:  40%|████      | 4/10 [00:12<00:18,  3.10s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9239, 'compress@10': 0.6355, 'time@10': 4.8996}:  40%|████      | 4/10 [00:16<00:18,  3.10s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9239, 'compress@10': 0.6355, 'time@10': 4.8996}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.9286, 'ndcg@10': 0.9319, 'compress@10': 0.6927, 'time@10': 5.1035}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.9286, 'ndcg@10': 0.9319, 'compress@10': 0.6927, 'time@10': 5.1035}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.9331, 'ndcg@10': 0.9344, 'compress@10': 0.6066, 'time@10': 5.3321}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.9331, 'ndcg@10': 0.9344, 'compress@10': 0.6066, 'time@10': 5.3321}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.9379, 'ndcg@10': 0.9379, 'compress@10': 0.535, 'time@10': 5.2648}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]  {'epoch': 36, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.9379, 'ndcg@10': 0.9379, 'compress@10': 0.535, 'time@10': 5.2648}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9421, 'compress@10': 0.4942, 'time@10': 5.6052}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9421, 'compress@10': 0.4942, 'time@10': 5.6052}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.9223, 'ndcg@10': 0.9456, 'compress@10': 0.4474, 'time@10': 5.5906}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.9223, 'ndcg@10': 0.9456, 'compress@10': 0.4474, 'time@10': 5.5906}: 100%|██████████| 10/10 [00:40<00:00,  4.66s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.9223, 'ndcg@10': 0.9456, 'compress@10': 0.4474, 'time@10': 5.5906}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.009645455096548688
Avg hit ratio: 0.9223422510332526
Avg ndcg: 0.945562725686454
Avg compression ratio: 0.44744665354324004
Avg train time: 5.590617275238037
Std train time: 1.7043779131419168
[0.8921052631578947, 0.20789473684210527, 0.049999999999999996, 0.9184210526315789, 0.9973684210526316, 0.6815789473684212, 0.39210526315789473, 0.2605263157894736, 0.4447368421052632, 0.26052631578947366]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9218, 'compress@10': 0.9997, 'time@10': 4.9871}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9218, 'compress@10': 0.9997, 'time@10': 4.9871}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9435, 'compress@10': 0.5171, 'time@10': 4.5845}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9435, 'compress@10': 0.5171, 'time@10': 4.5845}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9147, 'compress@10': 0.3924, 'time@10': 4.1613}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9147, 'compress@10': 0.3924, 'time@10': 4.1613}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9247, 'compress@10': 0.5443, 'time@10': 4.0518}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9247, 'compress@10': 0.5443, 'time@10': 4.0518}:  40%|████      | 4/10 [00:12<00:18,  3.11s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9243, 'compress@10': 0.6354, 'time@10': 4.9322}:  40%|████      | 4/10 [00:16<00:18,  3.11s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9243, 'compress@10': 0.6354, 'time@10': 4.9322}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.927, 'ndcg@10': 0.9313, 'compress@10': 0.6912, 'time@10': 5.1395}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.927, 'ndcg@10': 0.9313, 'compress@10': 0.6912, 'time@10': 5.1395}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.9317, 'ndcg@10': 0.9351, 'compress@10': 0.6062, 'time@10': 5.3699}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.9317, 'ndcg@10': 0.9351, 'compress@10': 0.6062, 'time@10': 5.3699}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9367, 'ndcg@10': 0.9396, 'compress@10': 0.5345, 'time@10': 5.2907}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9367, 'ndcg@10': 0.9396, 'compress@10': 0.5345, 'time@10': 5.2907}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.9119, 'ndcg@10': 0.9575, 'compress@10': 0.4971, 'time@10': 5.6467}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.9119, 'ndcg@10': 0.9575, 'compress@10': 0.4971, 'time@10': 5.6467}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9566, 'compress@10': 0.45, 'time@10': 5.6341}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]     {'epoch': 37, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9566, 'compress@10': 0.45, 'time@10': 5.6341}: 100%|██████████| 10/10 [00:40<00:00,  4.70s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9566, 'compress@10': 0.45, 'time@10': 5.6341}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.015658659259466867
Avg hit ratio: 0.9184815239467191
Avg ndcg: 0.956569498652299
Avg compression ratio: 0.4500156249118293
Avg train time: 5.634136128425598
Std train time: 1.7335328559976153
[0.8692307692307693, 0.20256410256410257, 0.04871794871794871, 0.9205128205128205, 0.9974358974358974, 0.6641025641025642, 0.4076923076923077, 0.2538461538461538, 0.458974358974359, 0.27948717948717944]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9239, 'compress@10': 0.9994, 'time@10': 4.829}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9239, 'compress@10': 0.9994, 'time@10': 4.829}:  10%|█         | 1/10 [00:02<00:22,  2.45s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9428, 'compress@10': 0.5169, 'time@10': 4.53}:  10%|█         | 1/10 [00:06<00:22,  2.45s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9428, 'compress@10': 0.5169, 'time@10': 4.53}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9142, 'compress@10': 0.3922, 'time@10': 4.1456}:  20%|██        | 2/10 [00:08<00:28,  3.52s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9142, 'compress@10': 0.3922, 'time@10': 4.1456}:  30%|███       | 3/10 [00:08<00:18,  2.70s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9245, 'compress@10': 0.5441, 'time@10': 4.0628}:  30%|███       | 3/10 [00:12<00:18,  2.70s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9245, 'compress@10': 0.5441, 'time@10': 4.0628}:  40%|████      | 4/10 [00:12<00:18,  3.16s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9244, 'compress@10': 0.6353, 'time@10': 4.9083}:  40%|████      | 4/10 [00:16<00:18,  3.16s/it] {'epoch': 38, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9244, 'compress@10': 0.6353, 'time@10': 4.9083}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9377, 'compress@10': 0.6894, 'time@10': 5.1096}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9377, 'compress@10': 0.6894, 'time@10': 5.1096}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9385, 'compress@10': 0.6069, 'time@10': 5.3371}:  60%|██████    | 6/10 [00:26<00:17,  4.42s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9385, 'compress@10': 0.6069, 'time@10': 5.3371}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9426, 'compress@10': 0.5351, 'time@10': 5.2555}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9426, 'compress@10': 0.5351, 'time@10': 5.2555}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9474, 'compress@10': 0.5006, 'time@10': 5.5945}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9474, 'compress@10': 0.5006, 'time@10': 5.5945}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9496, 'compress@10': 0.4534, 'time@10': 5.5779}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9496, 'compress@10': 0.4534, 'time@10': 5.5779}: 100%|██████████| 10/10 [00:40<00:00,  4.64s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9496, 'compress@10': 0.4534, 'time@10': 5.5779}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.017636296062036663
Avg hit ratio: 0.8991164445816396
Avg ndcg: 0.9495881974526668
Avg compression ratio: 0.453385398814944
Avg train time: 5.577884006500244
Std train time: 1.6584027583925258
[0.8475, 0.1975, 0.047499999999999994, 0.9225, 0.9975, 0.6725000000000001, 0.3975, 0.24749999999999994, 0.47250000000000003, 0.29749999999999993]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9239, 'compress@10': 0.999, 'time@10': 5.0436}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9239, 'compress@10': 0.999, 'time@10': 5.0436}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9448, 'compress@10': 0.5165, 'time@10': 4.6171}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9448, 'compress@10': 0.5165, 'time@10': 4.6171}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9156, 'compress@10': 0.392, 'time@10': 4.1872}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9156, 'compress@10': 0.392, 'time@10': 4.1872}:  30%|███       | 3/10 [00:08<00:18,  2.70s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9256, 'compress@10': 0.5439, 'time@10': 4.0839}:  30%|███       | 3/10 [00:12<00:18,  2.70s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9256, 'compress@10': 0.5439, 'time@10': 4.0839}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9265, 'compress@10': 0.6351, 'time@10': 4.9756}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9265, 'compress@10': 0.6351, 'time@10': 4.9756}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0101, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9342, 'compress@10': 0.69, 'time@10': 5.1621}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0101, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9342, 'compress@10': 0.69, 'time@10': 5.1621}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9366, 'compress@10': 0.6052, 'time@10': 5.3837}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9366, 'compress@10': 0.6052, 'time@10': 5.3837}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9408, 'compress@10': 0.5335, 'time@10': 5.3045}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]   {'epoch': 39, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9408, 'compress@10': 0.5335, 'time@10': 5.3045}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9494, 'compress@10': 0.5065, 'time@10': 5.6292}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9494, 'compress@10': 0.5065, 'time@10': 5.6292}:  90%|█████████ | 9/10 [00:35<00:04,  4.27s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9521, 'compress@10': 0.459, 'time@10': 5.6213}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]    {'epoch': 39, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9521, 'compress@10': 0.459, 'time@10': 5.6213}: 100%|██████████| 10/10 [00:40<00:00,  4.67s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9521, 'compress@10': 0.459, 'time@10': 5.6213}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.011766257544765655
Avg hit ratio: 0.9044620667014556
Avg ndcg: 0.952065123738868
Avg compression ratio: 0.4589640059439879
Avg train time: 5.621337795257569
Std train time: 1.6898049677157128
[0.8512195121951219, 0.21707317073170732, 0.04634146341463414, 0.924390243902439, 0.9975609756097561, 0.6560975609756099, 0.3878048780487805, 0.24146341463414628, 0.48536585365853663, 0.2902439024390243]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.9991, 'time@10': 4.8261}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.9991, 'time@10': 4.8261}:  10%|█         | 1/10 [00:02<00:22,  2.45s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9654, 'compress@10': 0.5166, 'time@10': 4.5279}:  10%|█         | 1/10 [00:06<00:22,  2.45s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9654, 'compress@10': 0.5166, 'time@10': 4.5279}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9293, 'compress@10': 0.392, 'time@10': 4.0983}:  20%|██        | 2/10 [00:08<00:28,  3.52s/it]  {'epoch': 40, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9293, 'compress@10': 0.392, 'time@10': 4.0983}:  30%|███       | 3/10 [00:08<00:18,  2.67s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9364, 'compress@10': 0.544, 'time@10': 3.9975}:  30%|███       | 3/10 [00:12<00:18,  2.67s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9364, 'compress@10': 0.544, 'time@10': 3.9975}:  40%|████      | 4/10 [00:12<00:18,  3.09s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9359, 'compress@10': 0.6352, 'time@10': 4.8764}:  40%|████      | 4/10 [00:16<00:18,  3.09s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9359, 'compress@10': 0.6352, 'time@10': 4.8764}:  50%|█████     | 5/10 [00:16<00:17,  3.50s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.9286, 'ndcg@10': 0.9427, 'compress@10': 0.6885, 'time@10': 5.0556}:  50%|█████     | 5/10 [00:22<00:17,  3.50s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.9286, 'ndcg@10': 0.9427, 'compress@10': 0.6885, 'time@10': 5.0556}:  60%|██████    | 6/10 [00:22<00:17,  4.35s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.9331, 'ndcg@10': 0.9436, 'compress@10': 0.6027, 'time@10': 5.3026}:  60%|██████    | 6/10 [00:25<00:17,  4.35s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.9331, 'ndcg@10': 0.9436, 'compress@10': 0.6027, 'time@10': 5.3026}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.9379, 'ndcg@10': 0.9466, 'compress@10': 0.5314, 'time@10': 5.2426}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.9379, 'ndcg@10': 0.9466, 'compress@10': 0.5314, 'time@10': 5.2426}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9502, 'compress@10': 0.5196, 'time@10': 5.5852}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9502, 'compress@10': 0.5196, 'time@10': 5.5852}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9501, 'compress@10': 0.4707, 'time@10': 5.585}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]    {'epoch': 40, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9501, 'compress@10': 0.4707, 'time@10': 5.585}: 100%|██████████| 10/10 [00:40<00:00,  4.69s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9501, 'compress@10': 0.4707, 'time@10': 5.585}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.013472376681999137
Avg hit ratio: 0.9166279653189668
Avg ndcg: 0.950079393023772
Avg compression ratio: 0.47067673647026187
Avg train time: 5.584956884384155
Std train time: 1.7040448518213374
[0.8309523809523809, 0.2357142857142857, 0.04523809523809523, 0.9261904761904761, 0.9976190476190476, 0.6404761904761906, 0.37857142857142856, 0.23571428571428565, 0.4976190476190477, 0.30714285714285705]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.9985, 'time@10': 4.7887}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.9985, 'time@10': 4.7887}:  10%|█         | 1/10 [00:02<00:21,  2.43s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9464, 'compress@10': 0.5168, 'time@10': 4.5564}:  10%|█         | 1/10 [00:06<00:21,  2.43s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9464, 'compress@10': 0.5168, 'time@10': 4.5564}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9166, 'compress@10': 0.3922, 'time@10': 4.1446}:  20%|██        | 2/10 [00:08<00:28,  3.57s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9166, 'compress@10': 0.3922, 'time@10': 4.1446}:  30%|███       | 3/10 [00:08<00:19,  2.72s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9265, 'compress@10': 0.5441, 'time@10': 4.0538}:  30%|███       | 3/10 [00:12<00:19,  2.72s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9265, 'compress@10': 0.5441, 'time@10': 4.0538}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9286, 'compress@10': 0.6353, 'time@10': 4.9058}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9286, 'compress@10': 0.6353, 'time@10': 4.9058}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.927, 'ndcg@10': 0.9373, 'compress@10': 0.6863, 'time@10': 5.1019}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.927, 'ndcg@10': 0.9373, 'compress@10': 0.6863, 'time@10': 5.1019}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9317, 'ndcg@10': 0.939, 'compress@10': 0.5996, 'time@10': 5.356}:  60%|██████    | 6/10 [00:26<00:17,  4.41s/it] {'epoch': 41, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9317, 'ndcg@10': 0.939, 'compress@10': 0.5996, 'time@10': 5.356}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9367, 'ndcg@10': 0.9423, 'compress@10': 0.5285, 'time@10': 5.2832}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9367, 'ndcg@10': 0.9423, 'compress@10': 0.5285, 'time@10': 5.2832}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.9215, 'ndcg@10': 0.9443, 'compress@10': 0.5406, 'time@10': 5.6038}:  80%|████████  | 8/10 [00:35<00:08,  4.33s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.9215, 'ndcg@10': 0.9443, 'compress@10': 0.5406, 'time@10': 5.6038}:  90%|█████████ | 9/10 [00:35<00:04,  4.27s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9271, 'ndcg@10': 0.9475, 'compress@10': 0.49, 'time@10': 5.5976}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]       {'epoch': 41, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9271, 'ndcg@10': 0.9475, 'compress@10': 0.49, 'time@10': 5.5976}: 100%|██████████| 10/10 [00:40<00:00,  4.67s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9271, 'ndcg@10': 0.9475, 'compress@10': 0.49, 'time@10': 5.5976}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.009953697658314487
Avg hit ratio: 0.9270529525181477
Avg ndcg: 0.9474633567837758
Avg compression ratio: 0.4899940877979505
Avg train time: 5.597648191452026
Std train time: 1.6526227393044333
[0.8348837209302324, 0.2302325581395349, 0.0441860465116279, 0.927906976744186, 0.9976744186046512, 0.6488372093023257, 0.3930232558139535, 0.23023255813953483, 0.486046511627907, 0.29999999999999993]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.9987, 'time@10': 4.7905}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.9987, 'time@10': 4.7905}:  10%|█         | 1/10 [00:02<00:21,  2.43s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9463, 'compress@10': 0.5169, 'time@10': 4.4512}:  10%|█         | 1/10 [00:06<00:21,  2.43s/it] {'epoch': 42, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9463, 'compress@10': 0.5169, 'time@10': 4.4512}:  20%|██        | 2/10 [00:06<00:27,  3.44s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9166, 'compress@10': 0.3922, 'time@10': 4.0666}:  20%|██        | 2/10 [00:08<00:27,  3.44s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9166, 'compress@10': 0.3922, 'time@10': 4.0666}:  30%|███       | 3/10 [00:08<00:18,  2.64s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9265, 'compress@10': 0.5441, 'time@10': 3.9951}:  30%|███       | 3/10 [00:12<00:18,  2.64s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9265, 'compress@10': 0.5441, 'time@10': 3.9951}:  40%|████      | 4/10 [00:12<00:18,  3.11s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.929, 'compress@10': 0.6353, 'time@10': 4.8718}:  40%|████      | 4/10 [00:16<00:18,  3.11s/it] {'epoch': 42, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.929, 'compress@10': 0.6353, 'time@10': 4.8718}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9362, 'compress@10': 0.687, 'time@10': 5.0825}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9362, 'compress@10': 0.687, 'time@10': 5.0825}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9389, 'compress@10': 0.6023, 'time@10': 5.3183}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9389, 'compress@10': 0.6023, 'time@10': 5.3183}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9421, 'compress@10': 0.5309, 'time@10': 5.2473}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9421, 'compress@10': 0.5309, 'time@10': 5.2473}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0099, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9447, 'compress@10': 0.5307, 'time@10': 5.5888}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0099, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9447, 'compress@10': 0.5307, 'time@10': 5.5888}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9488, 'compress@10': 0.4811, 'time@10': 5.581}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]     {'epoch': 42, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9488, 'compress@10': 0.4811, 'time@10': 5.581}: 100%|██████████| 10/10 [00:40<00:00,  4.67s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9488, 'compress@10': 0.4811, 'time@10': 5.581}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.011088674586294742
Avg hit ratio: 0.9130334952728839
Avg ndcg: 0.9488385872088012
Avg compression ratio: 0.48111871925803784
Avg train time: 5.581027102470398
Std train time: 1.7000826246969944
[0.8159090909090908, 0.225, 0.043181818181818175, 0.9295454545454545, 0.9977272727272728, 0.656818181818182, 0.3840909090909091, 0.22499999999999995, 0.4977272727272728, 0.31590909090909086]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.9979, 'time@10': 4.9293}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.9979, 'time@10': 4.9293}:  10%|█         | 1/10 [00:02<00:22,  2.50s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9469, 'compress@10': 0.5164, 'time@10': 4.4709}:  10%|█         | 1/10 [00:06<00:22,  2.50s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9469, 'compress@10': 0.5164, 'time@10': 4.4709}:  20%|██        | 2/10 [00:06<00:27,  3.41s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.917, 'compress@10': 0.3919, 'time@10': 4.0954}:  20%|██        | 2/10 [00:08<00:27,  3.41s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.917, 'compress@10': 0.3919, 'time@10': 4.0954}:  30%|███       | 3/10 [00:08<00:18,  2.64s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9271, 'compress@10': 0.5439, 'time@10': 4.0082}:  30%|███       | 3/10 [00:12<00:18,  2.64s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9271, 'compress@10': 0.5439, 'time@10': 4.0082}:  40%|████      | 4/10 [00:12<00:18,  3.09s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9295, 'compress@10': 0.6351, 'time@10': 4.8681}:  40%|████      | 4/10 [00:16<00:18,  3.09s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9295, 'compress@10': 0.6351, 'time@10': 4.8681}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9369, 'compress@10': 0.6889, 'time@10': 5.0523}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9369, 'compress@10': 0.6889, 'time@10': 5.0523}:  60%|██████    | 6/10 [00:22<00:17,  4.35s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9395, 'compress@10': 0.6029, 'time@10': 5.285}:  60%|██████    | 6/10 [00:25<00:17,  4.35s/it] {'epoch': 43, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9395, 'compress@10': 0.6029, 'time@10': 5.285}:  70%|███████   | 7/10 [00:25<00:12,  4.03s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9433, 'compress@10': 0.5313, 'time@10': 5.2122}:  70%|███████   | 7/10 [00:30<00:12,  4.03s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9433, 'compress@10': 0.5313, 'time@10': 5.2122}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0088, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.944, 'compress@10': 0.5424, 'time@10': 5.5585}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0088, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.944, 'compress@10': 0.5424, 'time@10': 5.5585}:  90%|█████████ | 9/10 [00:34<00:04,  4.24s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9464, 'compress@10': 0.4921, 'time@10': 5.5453}:  90%|█████████ | 9/10 [00:40<00:04,  4.24s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9464, 'compress@10': 0.4921, 'time@10': 5.5453}: 100%|██████████| 10/10 [00:40<00:00,  4.62s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9464, 'compress@10': 0.4921, 'time@10': 5.5453}: 100%|██████████| 10/10 [00:40<00:00,  4.01s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.00989217053957844
Avg hit ratio: 0.9130334952728839
Avg ndcg: 0.9464436034465878
Avg compression ratio: 0.4921431364969022
Avg train time: 5.545295977592469
Std train time: 1.6847918957664358
[0.7977777777777777, 0.24222222222222223, 0.04222222222222222, 0.931111111111111, 0.9977777777777779, 0.6422222222222224, 0.37555555555555553, 0.21999999999999995, 0.508888888888889, 0.3311111111111111]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.997, 'time@10': 5.07}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.997, 'time@10': 5.07}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9493, 'compress@10': 0.5166, 'time@10': 4.6184}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9493, 'compress@10': 0.5166, 'time@10': 4.6184}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9186, 'compress@10': 0.392, 'time@10': 4.1909}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9186, 'compress@10': 0.392, 'time@10': 4.1909}:  30%|███       | 3/10 [00:08<00:18,  2.70s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9288, 'compress@10': 0.544, 'time@10': 4.0757}:  30%|███       | 3/10 [00:12<00:18,  2.70s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9288, 'compress@10': 0.544, 'time@10': 4.0757}:  40%|████      | 4/10 [00:12<00:18,  3.12s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9317, 'compress@10': 0.6352, 'time@10': 4.9384}:  40%|████      | 4/10 [00:16<00:18,  3.12s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9317, 'compress@10': 0.6352, 'time@10': 4.9384}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.9323, 'ndcg@10': 0.9436, 'compress@10': 0.6856, 'time@10': 5.1344}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.9323, 'ndcg@10': 0.9436, 'compress@10': 0.6856, 'time@10': 5.1344}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.9363, 'ndcg@10': 0.9451, 'compress@10': 0.5994, 'time@10': 5.3741}:  60%|██████    | 6/10 [00:26<00:17,  4.42s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.9363, 'ndcg@10': 0.9451, 'compress@10': 0.5994, 'time@10': 5.3741}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9407, 'ndcg@10': 0.9482, 'compress@10': 0.5283, 'time@10': 5.2922}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9407, 'ndcg@10': 0.9482, 'compress@10': 0.5283, 'time@10': 5.2922}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.9282, 'ndcg@10': 0.9501, 'compress@10': 0.5483, 'time@10': 5.616}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.9282, 'ndcg@10': 0.9501, 'compress@10': 0.5483, 'time@10': 5.616}:  90%|█████████ | 9/10 [00:35<00:04,  4.26s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9331, 'ndcg@10': 0.9527, 'compress@10': 0.4985, 'time@10': 5.6096}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]  {'epoch': 44, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9331, 'ndcg@10': 0.9527, 'compress@10': 0.4985, 'time@10': 5.6096}: 100%|██████████| 10/10 [00:40<00:00,  4.67s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9331, 'ndcg@10': 0.9527, 'compress@10': 0.4985, 'time@10': 5.6096}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.01068499359967939
Avg hit ratio: 0.9331359018269035
Avg ndcg: 0.9527225093115813
Avg compression ratio: 0.49845868453813347
Avg train time: 5.609554934501648
Std train time: 1.6746664478886923
[0.8021739130434782, 0.23695652173913043, 0.041304347826086954, 0.9326086956521739, 0.9978260869565219, 0.6500000000000001, 0.3673913043478261, 0.21521739130434778, 0.5195652173913045, 0.32391304347826083]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.9977, 'time@10': 5.0144}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.9977, 'time@10': 5.0144}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9493, 'compress@10': 0.5168, 'time@10': 4.4955}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9493, 'compress@10': 0.5168, 'time@10': 4.4955}:  20%|██        | 2/10 [00:06<00:27,  3.41s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9186, 'compress@10': 0.3921, 'time@10': 4.098}:  20%|██        | 2/10 [00:08<00:27,  3.41s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9186, 'compress@10': 0.3921, 'time@10': 4.098}:  30%|███       | 3/10 [00:08<00:18,  2.63s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9288, 'compress@10': 0.5441, 'time@10': 4.0069}:  30%|███       | 3/10 [00:12<00:18,  2.63s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9288, 'compress@10': 0.5441, 'time@10': 4.0069}:  40%|████      | 4/10 [00:12<00:18,  3.08s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9317, 'compress@10': 0.6353, 'time@10': 4.8636}:  40%|████      | 4/10 [00:16<00:18,  3.08s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9317, 'compress@10': 0.6353, 'time@10': 4.8636}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0075, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.9391, 'compress@10': 0.6887, 'time@10': 5.0714}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0075, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.9391, 'compress@10': 0.6887, 'time@10': 5.0714}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9435, 'compress@10': 0.6014, 'time@10': 5.3239}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9435, 'compress@10': 0.6014, 'time@10': 5.3239}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9311, 'ndcg@10': 0.9455, 'compress@10': 0.53, 'time@10': 5.2556}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]   {'epoch': 45, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9311, 'ndcg@10': 0.9455, 'compress@10': 0.53, 'time@10': 5.2556}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9512, 'compress@10': 0.5527, 'time@10': 5.606}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9512, 'compress@10': 0.5527, 'time@10': 5.606}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9543, 'compress@10': 0.502, 'time@10': 5.6072}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9543, 'compress@10': 0.502, 'time@10': 5.6072}: 100%|██████████| 10/10 [00:40<00:00,  4.72s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9543, 'compress@10': 0.502, 'time@10': 5.6072}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.01264259587437481
Avg hit ratio: 0.9140370795022745
Avg ndcg: 0.9543123203206753
Avg compression ratio: 0.5020444699017043
Avg train time: 5.607195043563843
Std train time: 1.712727409845304
[0.7851063829787234, 0.23191489361702128, 0.04042553191489361, 0.9340425531914893, 0.9978723404255321, 0.6361702127659575, 0.38085106382978723, 0.21063829787234037, 0.5297872340425533, 0.3382978723404255]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9286, 'compress@10': 0.9968, 'time@10': 4.938}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9286, 'compress@10': 0.9968, 'time@10': 4.938}:  10%|█         | 1/10 [00:02<00:22,  2.51s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0049, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9482, 'compress@10': 0.5163, 'time@10': 4.5469}:  10%|█         | 1/10 [00:06<00:22,  2.51s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0049, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9482, 'compress@10': 0.5163, 'time@10': 4.5469}:  20%|██        | 2/10 [00:06<00:28,  3.50s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9178, 'compress@10': 0.3919, 'time@10': 4.144}:  20%|██        | 2/10 [00:08<00:28,  3.50s/it]  {'epoch': 46, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9178, 'compress@10': 0.3919, 'time@10': 4.144}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9278, 'compress@10': 0.5439, 'time@10': 4.0429}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9278, 'compress@10': 0.5439, 'time@10': 4.0429}:  40%|████      | 4/10 [00:12<00:18,  3.12s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0077, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.932, 'compress@10': 0.6351, 'time@10': 4.8922}:  40%|████      | 4/10 [00:16<00:18,  3.12s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.0077, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.932, 'compress@10': 0.6351, 'time@10': 4.8922}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9385, 'compress@10': 0.6853, 'time@10': 5.0805}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9385, 'compress@10': 0.6853, 'time@10': 5.0805}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0084, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9404, 'compress@10': 0.6006, 'time@10': 5.3264}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0084, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9404, 'compress@10': 0.6006, 'time@10': 5.3264}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9421, 'compress@10': 0.5293, 'time@10': 5.2576}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9421, 'compress@10': 0.5293, 'time@10': 5.2576}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0097, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9425, 'compress@10': 0.552, 'time@10': 5.6015}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it] {'epoch': 46, 'num_users': 6.3333, 'loss': 0.0097, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9425, 'compress@10': 0.552, 'time@10': 5.6015}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9459, 'compress@10': 0.5025, 'time@10': 5.5928}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it] {'epoch': 46, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9459, 'compress@10': 0.5025, 'time@10': 5.5928}: 100%|██████████| 10/10 [00:40<00:00,  4.68s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9459, 'compress@10': 0.5025, 'time@10': 5.5928}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.009647900919344263
Avg hit ratio: 0.9023422510332526
Avg ndcg: 0.9459385697739231
Avg compression ratio: 0.5024599217946853
Avg train time: 5.592750215530396
Std train time: 1.6798757245751383
[0.7687499999999999, 0.22708333333333333, 0.03958333333333333, 0.9354166666666667, 0.9979166666666668, 0.64375, 0.3729166666666667, 0.20624999999999993, 0.5395833333333335, 0.3520833333333333]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9286, 'compress@10': 0.9954, 'time@10': 4.583}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9286, 'compress@10': 0.9954, 'time@10': 4.583}:  10%|█         | 1/10 [00:02<00:20,  2.33s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0069, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9482, 'compress@10': 0.5157, 'time@10': 4.3502}:  10%|█         | 1/10 [00:06<00:20,  2.33s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0069, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9482, 'compress@10': 0.5157, 'time@10': 4.3502}:  20%|██        | 2/10 [00:06<00:27,  3.40s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9178, 'compress@10': 0.3915, 'time@10': 4.0255}:  20%|██        | 2/10 [00:08<00:27,  3.40s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9178, 'compress@10': 0.3915, 'time@10': 4.0255}:  30%|███       | 3/10 [00:08<00:18,  2.64s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9278, 'compress@10': 0.5436, 'time@10': 3.974}:  30%|███       | 3/10 [00:12<00:18,  2.64s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9278, 'compress@10': 0.5436, 'time@10': 3.974}:  40%|████      | 4/10 [00:12<00:18,  3.12s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0084, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9317, 'compress@10': 0.6348, 'time@10': 4.838}:  40%|████      | 4/10 [00:16<00:18,  3.12s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0084, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9317, 'compress@10': 0.6348, 'time@10': 4.838}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9392, 'compress@10': 0.6873, 'time@10': 5.0375}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9392, 'compress@10': 0.6873, 'time@10': 5.0375}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9415, 'compress@10': 0.6015, 'time@10': 5.2682}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9415, 'compress@10': 0.6015, 'time@10': 5.2682}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0066, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9451, 'compress@10': 0.5301, 'time@10': 5.2117}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]  {'epoch': 47, 'num_users': 6.125, 'loss': 0.0066, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9451, 'compress@10': 0.5301, 'time@10': 5.2117}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0075, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9483, 'compress@10': 0.5598, 'time@10': 5.5588}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0075, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9483, 'compress@10': 0.5598, 'time@10': 5.5588}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0078, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9512, 'compress@10': 0.5102, 'time@10': 5.5558}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0078, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9512, 'compress@10': 0.5102, 'time@10': 5.5558}: 100%|██████████| 10/10 [00:40<00:00,  4.67s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0078, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9512, 'compress@10': 0.5102, 'time@10': 5.5558}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.007830484197032077
Avg hit ratio: 0.9162593017244969
Avg ndcg: 0.9512145854894921
Avg compression ratio: 0.5102354858126074
Avg train time: 5.555841541290283
Std train time: 1.6728436685526726
[0.7530612244897958, 0.24285714285714285, 0.03877551020408163, 0.936734693877551, 0.9979591836734695, 0.6306122448979592, 0.3653061224489796, 0.20204081632653054, 0.5489795918367348, 0.3653061224489796]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.9943, 'time@10': 4.726}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.9943, 'time@10': 4.726}:  10%|█         | 1/10 [00:02<00:21,  2.40s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9517, 'compress@10': 0.5166, 'time@10': 4.4759}:  10%|█         | 1/10 [00:06<00:21,  2.40s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9517, 'compress@10': 0.5166, 'time@10': 4.4759}:  20%|██        | 2/10 [00:06<00:27,  3.50s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9202, 'compress@10': 0.3921, 'time@10': 4.0887}:  20%|██        | 2/10 [00:08<00:27,  3.50s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9202, 'compress@10': 0.3921, 'time@10': 4.0887}:  30%|███       | 3/10 [00:08<00:18,  2.68s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.93, 'compress@10': 0.544, 'time@10': 4.0106}:  30%|███       | 3/10 [00:12<00:18,  2.68s/it]   {'epoch': 48, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.93, 'compress@10': 0.544, 'time@10': 4.0106}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9333, 'compress@10': 0.6352, 'time@10': 4.8646}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9333, 'compress@10': 0.6352, 'time@10': 4.8646}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9457, 'compress@10': 0.683, 'time@10': 5.0643}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9457, 'compress@10': 0.683, 'time@10': 5.0643}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9471, 'compress@10': 0.5967, 'time@10': 5.2906}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9471, 'compress@10': 0.5967, 'time@10': 5.2906}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9103, 'ndcg@10': 0.9475, 'compress@10': 0.5259, 'time@10': 5.2218}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.9103, 'ndcg@10': 0.9475, 'compress@10': 0.5259, 'time@10': 5.2218}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9524, 'compress@10': 0.5574, 'time@10': 5.5747}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9524, 'compress@10': 0.5574, 'time@10': 5.5747}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9532, 'compress@10': 0.5093, 'time@10': 5.5749}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9532, 'compress@10': 0.5093, 'time@10': 5.5749}: 100%|██████████| 10/10 [00:40<00:00,  4.69s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9532, 'compress@10': 0.5093, 'time@10': 5.5749}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.0139674268113991
Avg hit ratio: 0.8973985746379635
Avg ndcg: 0.9532362552925739
Avg compression ratio: 0.5092854420819422
Avg train time: 5.574930500984192
Std train time: 1.6812304964866847
[0.7379999999999999, 0.238, 0.038, 0.9380000000000001, 0.9980000000000001, 0.638, 0.358, 0.19799999999999993, 0.5580000000000002, 0.378]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9193, 'compress@10': 0.9929, 'time@10': 4.6778}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9193, 'compress@10': 0.9929, 'time@10': 4.6778}:  10%|█         | 1/10 [00:02<00:21,  2.38s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9461, 'compress@10': 0.5152, 'time@10': 4.4562}:  10%|█         | 1/10 [00:06<00:21,  2.38s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9461, 'compress@10': 0.5152, 'time@10': 4.4562}:  20%|██        | 2/10 [00:06<00:27,  3.49s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9164, 'compress@10': 0.3911, 'time@10': 4.0786}:  20%|██        | 2/10 [00:08<00:27,  3.49s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9164, 'compress@10': 0.3911, 'time@10': 4.0786}:  30%|███       | 3/10 [00:08<00:18,  2.67s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9271, 'compress@10': 0.5433, 'time@10': 4.0075}:  30%|███       | 3/10 [00:12<00:18,  2.67s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9271, 'compress@10': 0.5433, 'time@10': 4.0075}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9314, 'compress@10': 0.6346, 'time@10': 4.9028}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9314, 'compress@10': 0.6346, 'time@10': 4.9028}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.939, 'compress@10': 0.6888, 'time@10': 5.0617}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.939, 'compress@10': 0.6888, 'time@10': 5.0617}:  60%|██████    | 6/10 [00:22<00:17,  4.35s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9413, 'compress@10': 0.6007, 'time@10': 5.2082}:  60%|██████    | 6/10 [00:25<00:17,  4.35s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9413, 'compress@10': 0.6007, 'time@10': 5.2082}:  70%|███████   | 7/10 [00:25<00:11,  3.94s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9453, 'compress@10': 0.5293, 'time@10': 5.0875}:  70%|███████   | 7/10 [00:29<00:11,  3.94s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9453, 'compress@10': 0.5293, 'time@10': 5.0875}:  80%|████████  | 8/10 [00:29<00:08,  4.05s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0103, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9459, 'compress@10': 0.5624, 'time@10': 5.3554}:  80%|████████  | 8/10 [00:33<00:08,  4.05s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0103, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9459, 'compress@10': 0.5624, 'time@10': 5.3554}:  90%|█████████ | 9/10 [00:33<00:03,  3.97s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9491, 'compress@10': 0.5149, 'time@10': 5.256}:  90%|█████████ | 9/10 [00:37<00:03,  3.97s/it]    {'epoch': 49, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9491, 'compress@10': 0.5149, 'time@10': 5.256}: 100%|██████████| 10/10 [00:37<00:00,  4.10s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9491, 'compress@10': 0.5149, 'time@10': 5.256}: 100%|██████████| 10/10 [00:37<00:00,  3.79s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.009389079471506773
Avg hit ratio: 0.9054656509308462
Avg ndcg: 0.9490602381004403
Avg compression ratio: 0.5148716108693498
Avg train time: 5.255994033813477
Std train time: 1.5992377961096464
[0.7235294117647058, 0.2529411764705882, 0.03725490196078431, 0.9392156862745099, 0.9784313725490197, 0.6254901960784314, 0.3705882352941176, 0.21372549019607837, 0.5666666666666669, 0.37058823529411766]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
