  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1478, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5142, 'compress@10': 0.1474, 'time@10': 8.7316}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1478, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5142, 'compress@10': 0.1474, 'time@10': 8.7316}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1051, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.6759, 'compress@10': 0.1382, 'time@10': 7.5339}:  10%|█         | 1/10 [00:10<00:39,  4.41s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1051, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.6759, 'compress@10': 0.1382, 'time@10': 7.5339}:  20%|██        | 2/10 [00:10<00:44,  5.56s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7449, 'hit_ratio@10': 0.5287, 'ndcg@10': 0.4506, 'compress@10': 0.1683, 'time@10': 5.9245}:  20%|██        | 2/10 [00:12<00:44,  5.56s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7449, 'hit_ratio@10': 0.5287, 'ndcg@10': 0.4506, 'compress@10': 0.1683, 'time@10': 5.9245}:  30%|███       | 3/10 [00:12<00:25,  3.66s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5796, 'hit_ratio@10': 0.6108, 'ndcg@10': 0.5163, 'compress@10': 0.1593, 'time@10': 5.9509}:  30%|███       | 3/10 [00:18<00:25,  3.66s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5796, 'hit_ratio@10': 0.6108, 'ndcg@10': 0.5163, 'compress@10': 0.1593, 'time@10': 5.9509}:  40%|████      | 4/10 [00:18<00:27,  4.61s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4821, 'hit_ratio@10': 0.6527, 'ndcg@10': 0.5687, 'compress@10': 0.151, 'time@10': 9.1901}:  40%|████      | 4/10 [00:29<00:27,  4.61s/it] {'epoch': 0, 'num_users': 5.8, 'loss': 0.4821, 'hit_ratio@10': 0.6527, 'ndcg@10': 0.5687, 'compress@10': 0.151, 'time@10': 9.1901}:  50%|█████     | 5/10 [00:29<00:34,  6.96s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.416, 'hit_ratio@10': 0.6587, 'ndcg@10': 0.6094, 'compress@10': 0.1459, 'time@10': 9.3225}:  50%|█████     | 5/10 [00:39<00:34,  6.96s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.416, 'hit_ratio@10': 0.6587, 'ndcg@10': 0.6094, 'compress@10': 0.1459, 'time@10': 9.3225}:  60%|██████    | 6/10 [00:39<00:31,  8.00s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3695, 'hit_ratio@10': 0.6675, 'ndcg@10': 0.6117, 'compress@10': 0.1445, 'time@10': 9.597}:  60%|██████    | 6/10 [00:45<00:31,  8.00s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3695, 'hit_ratio@10': 0.6675, 'ndcg@10': 0.6117, 'compress@10': 0.1445, 'time@10': 9.597}:  70%|███████   | 7/10 [00:45<00:21,  7.23s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3287, 'hit_ratio@10': 0.6983, 'ndcg@10': 0.6373, 'compress@10': 0.1421, 'time@10': 9.3181}:  70%|███████   | 7/10 [00:52<00:21,  7.23s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3287, 'hit_ratio@10': 0.6983, 'ndcg@10': 0.6373, 'compress@10': 0.1421, 'time@10': 9.3181}:  80%|████████  | 8/10 [00:52<00:14,  7.29s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2968, 'hit_ratio@10': 0.7001, 'ndcg@10': 0.6682, 'compress@10': 0.1403, 'time@10': 9.9411}:  80%|████████  | 8/10 [00:59<00:14,  7.29s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2968, 'hit_ratio@10': 0.7001, 'ndcg@10': 0.6682, 'compress@10': 0.1403, 'time@10': 9.9411}:  90%|█████████ | 9/10 [00:59<00:07,  7.36s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2723, 'hit_ratio@10': 0.7233, 'ndcg@10': 0.6863, 'compress@10': 0.1383, 'time@10': 9.8555}:  90%|█████████ | 9/10 [01:09<00:07,  7.36s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2723, 'hit_ratio@10': 0.7233, 'ndcg@10': 0.6863, 'compress@10': 0.1383, 'time@10': 9.8555}: 100%|██████████| 10/10 [01:09<00:00,  7.90s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2723, 'hit_ratio@10': 0.7233, 'ndcg@10': 0.6863, 'compress@10': 0.1383, 'time@10': 9.8555}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.2722567015562188
Avg hit ratio: 0.7232644979996423
Avg ndcg: 0.686318655541819
Avg compression ratio: 0.1383099039842772
Avg train time: 9.855525970458984
Std train time: 5.146857109093174
[0.55, 0.05, 0.55, 0.05, 0.55, 0.55, 0.55, 0.05, 0.05, 0.05]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8458, 'compress@10': 0.5737, 'time@10': 8.5633}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8458, 'compress@10': 0.5737, 'time@10': 8.5633}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0516, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8509, 'compress@10': 0.3272, 'time@10': 7.6434}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0516, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8509, 'compress@10': 0.3272, 'time@10': 7.6434}:  20%|██        | 2/10 [00:11<00:46,  5.76s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0388, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8402, 'compress@10': 0.4229, 'time@10': 6.1197}:  20%|██        | 2/10 [00:12<00:46,  5.76s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0388, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8402, 'compress@10': 0.4229, 'time@10': 6.1197}:  30%|███       | 3/10 [00:12<00:26,  3.85s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0415, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8419, 'compress@10': 0.3381, 'time@10': 6.2257}:  30%|███       | 3/10 [00:19<00:26,  3.85s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0415, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8419, 'compress@10': 0.3381, 'time@10': 6.2257}:  40%|████      | 4/10 [00:19<00:29,  4.93s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0506, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8303, 'compress@10': 0.3823, 'time@10': 9.1702}:  40%|████      | 4/10 [00:29<00:29,  4.93s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0506, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8303, 'compress@10': 0.3823, 'time@10': 9.1702}:  50%|█████     | 5/10 [00:29<00:34,  6.94s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0552, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8284, 'compress@10': 0.4119, 'time@10': 9.3636}:  50%|█████     | 5/10 [00:40<00:34,  6.94s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0552, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8284, 'compress@10': 0.4119, 'time@10': 9.3636}:  60%|██████    | 6/10 [00:40<00:32,  8.11s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0534, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8326, 'compress@10': 0.4342, 'time@10': 9.6488}:  60%|██████    | 6/10 [00:45<00:32,  8.11s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0534, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8326, 'compress@10': 0.4342, 'time@10': 9.6488}:  70%|███████   | 7/10 [00:45<00:21,  7.33s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0515, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8382, 'compress@10': 0.3896, 'time@10': 9.355}:  70%|███████   | 7/10 [00:53<00:21,  7.33s/it]  {'epoch': 1, 'num_users': 6.125, 'loss': 0.0515, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8382, 'compress@10': 0.3896, 'time@10': 9.355}:  80%|████████  | 8/10 [00:53<00:14,  7.33s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0496, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8465, 'compress@10': 0.3549, 'time@10': 9.8314}:  80%|████████  | 8/10 [01:00<00:14,  7.33s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0496, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8465, 'compress@10': 0.3549, 'time@10': 9.8314}:  90%|█████████ | 9/10 [01:00<00:07,  7.18s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8465, 'compress@10': 0.3265, 'time@10': 9.7821}:  90%|█████████ | 9/10 [01:09<00:07,  7.18s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8465, 'compress@10': 0.3265, 'time@10': 9.7821}: 100%|██████████| 10/10 [01:09<00:00,  7.86s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8465, 'compress@10': 0.3265, 'time@10': 9.7821}: 100%|██████████| 10/10 [01:09<00:00,  6.94s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.049327385750654054
Avg hit ratio: 0.8286755255685646
Avg ndcg: 0.8465330567964271
Avg compression ratio: 0.3265455908736423
Avg train time: 9.782121586799622
Std train time: 4.637739528446333
[0.7000000000000001, 0.36666666666666664, 0.3666666666666667, 0.36666666666666664, 0.7000000000000001, 0.7000000000000001, 0.3666666666666667, 0.03333333333333334, 0.03333333333333334, 0.03333333333333334]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8471, 'compress@10': 0.7158, 'time@10': 8.2849}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8471, 'compress@10': 0.7158, 'time@10': 8.2849}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8466, 'compress@10': 0.5514, 'time@10': 7.6018}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]  {'epoch': 2, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8466, 'compress@10': 0.5514, 'time@10': 7.6018}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8501, 'compress@10': 0.52, 'time@10': 6.1869}:  20%|██        | 2/10 [00:12<00:46,  5.81s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8501, 'compress@10': 0.52, 'time@10': 6.1869}:  30%|███       | 3/10 [00:12<00:27,  3.94s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8482, 'compress@10': 0.4873, 'time@10': 6.1749}:  30%|███       | 3/10 [00:19<00:27,  3.94s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8482, 'compress@10': 0.4873, 'time@10': 6.1749}:  40%|████      | 4/10 [00:19<00:28,  4.82s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8354, 'compress@10': 0.5311, 'time@10': 8.5063}:  40%|████      | 4/10 [00:27<00:28,  4.82s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8354, 'compress@10': 0.5311, 'time@10': 8.5063}:  50%|█████     | 5/10 [00:27<00:31,  6.31s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0519, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8329, 'compress@10': 0.5603, 'time@10': 8.8277}:  50%|█████     | 5/10 [00:38<00:31,  6.31s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0519, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8329, 'compress@10': 0.5603, 'time@10': 8.8277}:  60%|██████    | 6/10 [00:38<00:30,  7.73s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.051, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.834, 'compress@10': 0.5363, 'time@10': 9.1366}:  60%|██████    | 6/10 [00:43<00:30,  7.73s/it]  {'epoch': 2, 'num_users': 6.2857, 'loss': 0.051, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.834, 'compress@10': 0.5363, 'time@10': 9.1366}:  70%|███████   | 7/10 [00:43<00:21,  7.01s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0528, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8385, 'compress@10': 0.4769, 'time@10': 8.8774}:  70%|███████   | 7/10 [00:51<00:21,  7.01s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0528, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8385, 'compress@10': 0.4769, 'time@10': 8.8774}:  80%|████████  | 8/10 [00:51<00:14,  7.04s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0543, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8488, 'compress@10': 0.4307, 'time@10': 9.3702}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0543, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8488, 'compress@10': 0.4307, 'time@10': 9.3702}:  90%|█████████ | 9/10 [00:57<00:06,  6.93s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0537, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8475, 'compress@10': 0.3931, 'time@10': 9.3034}:  90%|█████████ | 9/10 [01:06<00:06,  6.93s/it]    {'epoch': 2, 'num_users': 6.3, 'loss': 0.0537, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8475, 'compress@10': 0.3931, 'time@10': 9.3034}: 100%|██████████| 10/10 [01:06<00:00,  7.49s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0537, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8475, 'compress@10': 0.3931, 'time@10': 9.3034}: 100%|██████████| 10/10 [01:06<00:00,  6.65s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.05369599948052117
Avg hit ratio: 0.8429612398542788
Avg ndcg: 0.8474688269197227
Avg compression ratio: 0.39311989861813584
Avg train time: 9.303393340110778
Std train time: 3.878339660536029
[0.525, 0.5249999999999999, 0.275, 0.27499999999999997, 0.775, 0.775, 0.275, 0.275, 0.275, 0.025000000000000005]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8537, 'compress@10': 0.55, 'time@10': 8.3779}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8537, 'compress@10': 0.55, 'time@10': 8.3779}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8621, 'compress@10': 0.5452, 'time@10': 8.0762}:  10%|█         | 1/10 [00:12<00:38,  4.23s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8621, 'compress@10': 0.5452, 'time@10': 8.0762}:  20%|██        | 2/10 [00:12<00:50,  6.34s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8605, 'compress@10': 0.4896, 'time@10': 6.5759}:  20%|██        | 2/10 [00:13<00:50,  6.34s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8605, 'compress@10': 0.4896, 'time@10': 6.5759}:  30%|███       | 3/10 [00:13<00:29,  4.28s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0374, 'hit_ratio@10': 0.774, 'ndcg@10': 0.8541, 'compress@10': 0.4424, 'time@10': 6.4949}:  30%|███       | 3/10 [00:20<00:29,  4.28s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0374, 'hit_ratio@10': 0.774, 'ndcg@10': 0.8541, 'compress@10': 0.4424, 'time@10': 6.4949}:  40%|████      | 4/10 [00:20<00:30,  5.07s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.7832, 'ndcg@10': 0.8425, 'compress@10': 0.5099, 'time@10': 8.343}:  40%|████      | 4/10 [00:28<00:30,  5.07s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.7832, 'ndcg@10': 0.8425, 'compress@10': 0.5099, 'time@10': 8.343}:  50%|█████     | 5/10 [00:28<00:30,  6.09s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0503, 'hit_ratio@10': 0.7897, 'ndcg@10': 0.8395, 'compress@10': 0.5549, 'time@10': 8.6487}:  50%|█████     | 5/10 [00:38<00:30,  6.09s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0503, 'hit_ratio@10': 0.7897, 'ndcg@10': 0.8395, 'compress@10': 0.5549, 'time@10': 8.6487}:  60%|██████    | 6/10 [00:38<00:29,  7.50s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.814, 'ndcg@10': 0.841, 'compress@10': 0.519, 'time@10': 8.9985}:  60%|██████    | 6/10 [00:43<00:29,  7.50s/it]   {'epoch': 3, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.814, 'ndcg@10': 0.841, 'compress@10': 0.519, 'time@10': 8.9985}:  70%|███████   | 7/10 [00:43<00:20,  6.87s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0513, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8422, 'compress@10': 0.4911, 'time@10': 8.8991}:  70%|███████   | 7/10 [00:52<00:20,  6.87s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0513, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8422, 'compress@10': 0.4911, 'time@10': 8.8991}:  80%|████████  | 8/10 [00:52<00:14,  7.31s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.051, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8497, 'compress@10': 0.4694, 'time@10': 9.5017}:  80%|████████  | 8/10 [00:59<00:14,  7.31s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.051, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8497, 'compress@10': 0.4694, 'time@10': 9.5017}:  90%|█████████ | 9/10 [00:59<00:07,  7.27s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0509, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8496, 'compress@10': 0.4272, 'time@10': 9.4234}:  90%|█████████ | 9/10 [01:08<00:07,  7.27s/it]  {'epoch': 3, 'num_users': 6.3, 'loss': 0.0509, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8496, 'compress@10': 0.4272, 'time@10': 9.4234}: 100%|██████████| 10/10 [01:08<00:00,  7.73s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0509, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8496, 'compress@10': 0.4272, 'time@10': 9.4234}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.05085432154488033
Avg hit ratio: 0.8287108558297014
Avg ndcg: 0.8495614299876788
Avg compression ratio: 0.4271872748246577
Avg train time: 9.423444318771363
Std train time: 3.424444119504565
[0.42000000000000004, 0.6199999999999999, 0.22000000000000003, 0.21999999999999997, 0.8200000000000001, 0.8200000000000001, 0.42000000000000004, 0.42000000000000004, 0.22000000000000003, 0.020000000000000004]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.4505, 'time@10': 8.3534}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.4505, 'time@10': 8.3534}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8548, 'compress@10': 0.5414, 'time@10': 7.6012}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8548, 'compress@10': 0.5414, 'time@10': 7.6012}:  20%|██        | 2/10 [00:11<00:46,  5.79s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8556, 'compress@10': 0.4714, 'time@10': 6.3388}:  20%|██        | 2/10 [00:13<00:46,  5.79s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8556, 'compress@10': 0.4714, 'time@10': 6.3388}:  30%|███       | 3/10 [00:13<00:28,  4.03s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8452, 'compress@10': 0.4155, 'time@10': 6.3254}:  30%|███       | 3/10 [00:19<00:28,  4.03s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8452, 'compress@10': 0.4155, 'time@10': 6.3254}:  40%|████      | 4/10 [00:19<00:29,  4.94s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8328, 'compress@10': 0.4971, 'time@10': 7.8162}:  40%|████      | 4/10 [00:26<00:29,  4.94s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8328, 'compress@10': 0.4971, 'time@10': 7.8162}:  50%|█████     | 5/10 [00:26<00:28,  5.65s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8318, 'compress@10': 0.5516, 'time@10': 8.1784}:  50%|█████     | 5/10 [00:36<00:28,  5.65s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8318, 'compress@10': 0.5516, 'time@10': 8.1784}:  60%|██████    | 6/10 [00:36<00:28,  7.14s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0489, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8372, 'compress@10': 0.5361, 'time@10': 8.6105}:  60%|██████    | 6/10 [00:41<00:28,  7.14s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0489, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8372, 'compress@10': 0.5361, 'time@10': 8.6105}:  70%|███████   | 7/10 [00:41<00:19,  6.65s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.049, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8355, 'compress@10': 0.5237, 'time@10': 8.5215}:  70%|███████   | 7/10 [00:49<00:19,  6.65s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.049, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8355, 'compress@10': 0.5237, 'time@10': 8.5215}:  80%|████████  | 8/10 [00:49<00:14,  7.06s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8596, 'compress@10': 0.4924, 'time@10': 9.126}:  80%|████████  | 8/10 [00:56<00:14,  7.06s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8596, 'compress@10': 0.4924, 'time@10': 9.126}:  90%|█████████ | 9/10 [00:56<00:07,  7.05s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8588, 'compress@10': 0.4474, 'time@10': 9.0913}:  90%|█████████ | 9/10 [01:05<00:07,  7.05s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8588, 'compress@10': 0.4474, 'time@10': 9.0913}: 100%|██████████| 10/10 [01:05<00:00,  7.59s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8588, 'compress@10': 0.4474, 'time@10': 9.0913}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04967010661217487
Avg hit ratio: 0.8477743478931934
Avg ndcg: 0.8587515606134646
Avg compression ratio: 0.44740038511654817
Avg train time: 9.091268301010132
Std train time: 3.062403873077998
[0.5166666666666667, 0.5166666666666666, 0.18333333333333335, 0.35, 0.8500000000000001, 0.8500000000000001, 0.35000000000000003, 0.35000000000000003, 0.35000000000000003, 0.01666666666666667]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8466, 'compress@10': 0.5421, 'time@10': 8.291}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8466, 'compress@10': 0.5421, 'time@10': 8.291}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8478, 'compress@10': 0.5372, 'time@10': 7.7291}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8478, 'compress@10': 0.5372, 'time@10': 7.7291}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8509, 'compress@10': 0.4581, 'time@10': 6.4757}:  20%|██        | 2/10 [00:13<00:47,  5.96s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8509, 'compress@10': 0.4581, 'time@10': 6.4757}:  30%|███       | 3/10 [00:13<00:29,  4.16s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8412, 'compress@10': 0.4369, 'time@10': 6.4384}:  30%|███       | 3/10 [00:19<00:29,  4.16s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8412, 'compress@10': 0.4369, 'time@10': 6.4384}:  40%|████      | 4/10 [00:19<00:30,  5.04s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8303, 'compress@10': 0.5201, 'time@10': 7.8118}:  40%|████      | 4/10 [00:26<00:30,  5.04s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8303, 'compress@10': 0.5201, 'time@10': 7.8118}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0479, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8304, 'compress@10': 0.5756, 'time@10': 8.1386}:  50%|█████     | 5/10 [00:36<00:28,  5.63s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0479, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8304, 'compress@10': 0.5756, 'time@10': 8.1386}:  60%|██████    | 6/10 [00:36<00:28,  7.05s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0471, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8356, 'compress@10': 0.5471, 'time@10': 8.6917}:  60%|██████    | 6/10 [00:42<00:28,  7.05s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0471, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8356, 'compress@10': 0.5471, 'time@10': 8.6917}:  70%|███████   | 7/10 [00:42<00:20,  6.72s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0466, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8359, 'compress@10': 0.5248, 'time@10': 8.5936}:  70%|███████   | 7/10 [00:50<00:20,  6.72s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0466, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8359, 'compress@10': 0.5248, 'time@10': 8.5936}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0468, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8398, 'compress@10': 0.5074, 'time@10': 9.2219}:  80%|████████  | 8/10 [00:57<00:14,  7.11s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0468, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8398, 'compress@10': 0.5074, 'time@10': 9.2219}:  90%|█████████ | 9/10 [00:57<00:07,  7.13s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0465, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8443, 'compress@10': 0.4606, 'time@10': 9.1667}:  90%|█████████ | 9/10 [01:06<00:07,  7.13s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0465, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8443, 'compress@10': 0.4606, 'time@10': 9.1667}: 100%|██████████| 10/10 [01:06<00:00,  7.61s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0465, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8443, 'compress@10': 0.4606, 'time@10': 9.1667}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.046490534177081565
Avg hit ratio: 0.8513688179392764
Avg ndcg: 0.8442732252528623
Avg compression ratio: 0.4606051543642297
Avg train time: 9.166656637191773
Std train time: 3.05111673852983
[0.5857142857142857, 0.44285714285714284, 0.15714285714285717, 0.44285714285714284, 0.8714285714285716, 0.8714285714285716, 0.30000000000000004, 0.30000000000000004, 0.4428571428571429, 0.014285714285714289]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8565, 'compress@10': 0.6075, 'time@10': 8.3097}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8565, 'compress@10': 0.6075, 'time@10': 8.3097}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7657, 'ndcg@10': 0.8546, 'compress@10': 0.5342, 'time@10': 7.6754}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7657, 'ndcg@10': 0.8546, 'compress@10': 0.5342, 'time@10': 7.6754}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.7962, 'ndcg@10': 0.8554, 'compress@10': 0.4486, 'time@10': 6.8889}:  20%|██        | 2/10 [00:13<00:47,  5.89s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.7962, 'ndcg@10': 0.8554, 'compress@10': 0.4486, 'time@10': 6.8889}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8355, 'compress@10': 0.4522, 'time@10': 6.8023}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8355, 'compress@10': 0.4522, 'time@10': 6.8023}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8258, 'compress@10': 0.5365, 'time@10': 8.0888}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8258, 'compress@10': 0.5365, 'time@10': 8.0888}:  50%|█████     | 5/10 [00:27<00:28,  5.78s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0474, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8279, 'compress@10': 0.5928, 'time@10': 8.3236}:  50%|█████     | 5/10 [00:36<00:28,  5.78s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0474, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8279, 'compress@10': 0.5928, 'time@10': 8.3236}:  60%|██████    | 6/10 [00:36<00:28,  7.06s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0459, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8367, 'compress@10': 0.555, 'time@10': 8.7331}:  60%|██████    | 6/10 [00:42<00:28,  7.06s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.0459, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8367, 'compress@10': 0.555, 'time@10': 8.7331}:  70%|███████   | 7/10 [00:42<00:19,  6.59s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0448, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.841, 'compress@10': 0.5256, 'time@10': 8.6343}:  70%|███████   | 7/10 [00:50<00:19,  6.59s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0448, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.841, 'compress@10': 0.5256, 'time@10': 8.6343}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0431, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8498, 'compress@10': 0.5182, 'time@10': 9.2985}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0431, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8498, 'compress@10': 0.5182, 'time@10': 9.2985}:  90%|█████████ | 9/10 [00:57<00:07,  7.15s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0429, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8501, 'compress@10': 0.47, 'time@10': 9.2666}:  90%|█████████ | 9/10 [01:06<00:07,  7.15s/it]     {'epoch': 6, 'num_users': 6.3, 'loss': 0.0429, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8501, 'compress@10': 0.47, 'time@10': 9.2666}: 100%|██████████| 10/10 [01:06<00:00,  7.73s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0429, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8501, 'compress@10': 0.47, 'time@10': 9.2666}: 100%|██████████| 10/10 [01:06<00:00,  6.68s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04290928736105114
Avg hit ratio: 0.8651322587994914
Avg ndcg: 0.850096821953103
Avg compression ratio: 0.47003810884534136
Avg train time: 9.266618084907531
Std train time: 2.8070807533711646
[0.6375000000000001, 0.5125, 0.1375, 0.5125, 0.8875000000000001, 0.8875000000000001, 0.26250000000000007, 0.26250000000000007, 0.3875, 0.012500000000000002]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8408, 'compress@10': 0.6566, 'time@10': 8.255}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8408, 'compress@10': 0.6566, 'time@10': 8.255}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0446, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8512, 'compress@10': 0.5924, 'time@10': 7.6234}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0446, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8512, 'compress@10': 0.5924, 'time@10': 7.6234}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8532, 'compress@10': 0.4818, 'time@10': 6.4921}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8532, 'compress@10': 0.4818, 'time@10': 6.4921}:  30%|███       | 3/10 [00:13<00:29,  4.17s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8393, 'compress@10': 0.4939, 'time@10': 6.4154}:  30%|███       | 3/10 [00:19<00:29,  4.17s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8393, 'compress@10': 0.4939, 'time@10': 6.4154}:  40%|████      | 4/10 [00:19<00:29,  4.98s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0448, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8296, 'compress@10': 0.573, 'time@10': 7.8057}:  40%|████      | 4/10 [00:26<00:29,  4.98s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.0448, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8296, 'compress@10': 0.573, 'time@10': 7.8057}:  50%|█████     | 5/10 [00:26<00:28,  5.61s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0451, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8315, 'compress@10': 0.6259, 'time@10': 8.144}:  50%|█████     | 5/10 [00:36<00:28,  5.61s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0451, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8315, 'compress@10': 0.6259, 'time@10': 8.144}:  60%|██████    | 6/10 [00:36<00:28,  7.06s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0457, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8386, 'compress@10': 0.5782, 'time@10': 8.5773}:  60%|██████    | 6/10 [00:41<00:28,  7.06s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0457, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8386, 'compress@10': 0.5782, 'time@10': 8.5773}:  70%|███████   | 7/10 [00:41<00:19,  6.60s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0444, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8434, 'compress@10': 0.5413, 'time@10': 8.4868}:  70%|███████   | 7/10 [00:49<00:19,  6.60s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0444, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8434, 'compress@10': 0.5413, 'time@10': 8.4868}:  80%|████████  | 8/10 [00:49<00:14,  7.01s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0434, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8543, 'compress@10': 0.5262, 'time@10': 9.1182}:  80%|████████  | 8/10 [00:56<00:14,  7.01s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0434, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8543, 'compress@10': 0.5262, 'time@10': 9.1182}:  90%|█████████ | 9/10 [00:56<00:07,  7.04s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0423, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8587, 'compress@10': 0.4771, 'time@10': 9.0927}:  90%|█████████ | 9/10 [01:05<00:07,  7.04s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0423, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8587, 'compress@10': 0.4771, 'time@10': 9.0927}: 100%|██████████| 10/10 [01:05<00:00,  7.62s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0423, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8587, 'compress@10': 0.4771, 'time@10': 9.0927}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04230624628065291
Avg hit ratio: 0.872415040533886
Avg ndcg: 0.858693838562752
Avg compression ratio: 0.47706814771065426
Avg train time: 9.092740607261657
Std train time: 2.9620215916652723
[0.6777777777777778, 0.4555555555555555, 0.12222222222222223, 0.5666666666666667, 0.9, 0.9, 0.3444444444444445, 0.2333333333333334, 0.34444444444444444, 0.011111111111111113]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.854, 'compress@10': 0.6947, 'time@10': 8.9252}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.854, 'compress@10': 0.6947, 'time@10': 8.9252}:  10%|█         | 1/10 [00:04<00:40,  4.50s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0404, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8567, 'compress@10': 0.5839, 'time@10': 8.0331}:  10%|█         | 1/10 [00:11<00:40,  4.50s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0404, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8567, 'compress@10': 0.5839, 'time@10': 8.0331}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8568, 'compress@10': 0.4718, 'time@10': 6.9115}:  20%|██        | 2/10 [00:14<00:48,  6.08s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8568, 'compress@10': 0.4718, 'time@10': 6.9115}:  30%|███       | 3/10 [00:14<00:30,  4.39s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.846, 'compress@10': 0.4994, 'time@10': 6.703}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it]  {'epoch': 8, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.846, 'compress@10': 0.4994, 'time@10': 6.703}:  40%|████      | 4/10 [00:20<00:30,  5.07s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0412, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8359, 'compress@10': 0.5799, 'time@10': 8.0076}:  40%|████      | 4/10 [00:26<00:30,  5.07s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0412, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8359, 'compress@10': 0.5799, 'time@10': 8.0076}:  50%|█████     | 5/10 [00:26<00:28,  5.66s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0428, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8393, 'compress@10': 0.6336, 'time@10': 8.2857}:  50%|█████     | 5/10 [00:36<00:28,  5.66s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0428, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8393, 'compress@10': 0.6336, 'time@10': 8.2857}:  60%|██████    | 6/10 [00:36<00:28,  7.04s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0433, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8371, 'compress@10': 0.5961, 'time@10': 8.7037}:  60%|██████    | 6/10 [00:42<00:28,  7.04s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0433, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8371, 'compress@10': 0.5961, 'time@10': 8.7037}:  70%|███████   | 7/10 [00:42<00:19,  6.58s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0428, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8423, 'compress@10': 0.5535, 'time@10': 8.6125}:  70%|███████   | 7/10 [00:50<00:19,  6.58s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0428, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8423, 'compress@10': 0.5535, 'time@10': 8.6125}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0426, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8625, 'compress@10': 0.5323, 'time@10': 9.2853}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0426, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8625, 'compress@10': 0.5323, 'time@10': 9.2853}:  90%|█████████ | 9/10 [00:57<00:07,  7.15s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0423, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8623, 'compress@10': 0.4824, 'time@10': 9.2333}:  90%|█████████ | 9/10 [01:06<00:07,  7.15s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0423, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8623, 'compress@10': 0.4824, 'time@10': 9.2333}: 100%|██████████| 10/10 [01:06<00:00,  7.66s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0423, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8623, 'compress@10': 0.4824, 'time@10': 9.2333}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04225891829717132
Avg hit ratio: 0.8661617705064224
Avg ndcg: 0.8623172137224155
Avg compression ratio: 0.48244894534393057
Avg train time: 9.233327913284302
Std train time: 2.9437314471340654
[0.7100000000000001, 0.4099999999999999, 0.11000000000000001, 0.61, 0.91, 0.91, 0.41000000000000003, 0.21000000000000005, 0.31, 0.010000000000000002]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0558, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8353, 'compress@10': 0.7253, 'time@10': 8.3562}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0558, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8353, 'compress@10': 0.7253, 'time@10': 8.3562}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8589, 'compress@10': 0.5771, 'time@10': 7.7402}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8589, 'compress@10': 0.5771, 'time@10': 7.7402}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0307, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8583, 'compress@10': 0.4638, 'time@10': 6.7331}:  20%|██        | 2/10 [00:13<00:47,  5.95s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0307, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8583, 'compress@10': 0.4638, 'time@10': 6.7331}:  30%|███       | 3/10 [00:13<00:30,  4.33s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8574, 'compress@10': 0.5038, 'time@10': 6.6937}:  30%|███       | 3/10 [00:20<00:30,  4.33s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8574, 'compress@10': 0.5038, 'time@10': 6.6937}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0415, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8472, 'compress@10': 0.5854, 'time@10': 7.9233}:  40%|████      | 4/10 [00:26<00:31,  5.23s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0415, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8472, 'compress@10': 0.5854, 'time@10': 7.9233}:  50%|█████     | 5/10 [00:26<00:28,  5.67s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0413, 'hit_ratio@10': 0.847, 'ndcg@10': 0.852, 'compress@10': 0.6399, 'time@10': 8.1901}:  50%|█████     | 5/10 [00:36<00:28,  5.67s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0413, 'hit_ratio@10': 0.847, 'ndcg@10': 0.852, 'compress@10': 0.6399, 'time@10': 8.1901}:  60%|██████    | 6/10 [00:36<00:27,  7.00s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0397, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8576, 'compress@10': 0.6104, 'time@10': 8.658}:  60%|██████    | 6/10 [00:42<00:27,  7.00s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0397, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8576, 'compress@10': 0.6104, 'time@10': 8.658}:  70%|███████   | 7/10 [00:42<00:19,  6.59s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0393, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8592, 'compress@10': 0.5632, 'time@10': 8.5483}:  70%|███████   | 7/10 [00:50<00:19,  6.59s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0393, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8592, 'compress@10': 0.5632, 'time@10': 8.5483}:  80%|████████  | 8/10 [00:50<00:13,  6.98s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0392, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8799, 'compress@10': 0.5372, 'time@10': 9.1794}:  80%|████████  | 8/10 [00:57<00:13,  6.98s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0392, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8799, 'compress@10': 0.5372, 'time@10': 9.1794}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0374, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8828, 'compress@10': 0.4868, 'time@10': 9.1797}:  90%|█████████ | 9/10 [01:06<00:07,  7.04s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0374, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8828, 'compress@10': 0.4868, 'time@10': 9.1797}: 100%|██████████| 10/10 [01:06<00:00,  7.71s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0374, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8828, 'compress@10': 0.4868, 'time@10': 9.1797}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.037361858955853325
Avg hit ratio: 0.8733710057156576
Avg ndcg: 0.8828449227866685
Avg compression ratio: 0.48675427794676385
Avg train time: 9.179744362831116
Std train time: 2.7889145824210693
[0.7363636363636364, 0.3727272727272727, 0.1, 0.6454545454545454, 0.9181818181818182, 0.9181818181818182, 0.37272727272727274, 0.19090909090909094, 0.37272727272727274, 0.009090909090909092]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8496, 'compress@10': 0.7502, 'time@10': 8.2626}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8496, 'compress@10': 0.7502, 'time@10': 8.2626}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8684, 'compress@10': 0.5716, 'time@10': 7.6929}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8684, 'compress@10': 0.5716, 'time@10': 7.6929}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8647, 'compress@10': 0.4573, 'time@10': 6.8167}:  20%|██        | 2/10 [00:13<00:47,  5.94s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8647, 'compress@10': 0.4573, 'time@10': 6.8167}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8648, 'compress@10': 0.5075, 'time@10': 6.6704}:  30%|███       | 3/10 [00:20<00:30,  4.40s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8648, 'compress@10': 0.5075, 'time@10': 6.6704}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8541, 'compress@10': 0.5899, 'time@10': 7.8138}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8541, 'compress@10': 0.5899, 'time@10': 7.8138}:  50%|█████     | 5/10 [00:26<00:27,  5.54s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0375, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8586, 'compress@10': 0.6449, 'time@10': 8.145}:  50%|█████     | 5/10 [00:36<00:27,  5.54s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0375, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8586, 'compress@10': 0.6449, 'time@10': 8.145}:  60%|██████    | 6/10 [00:36<00:28,  7.00s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.039, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.8656, 'compress@10': 0.6096, 'time@10': 8.638}:  60%|██████    | 6/10 [00:42<00:28,  7.00s/it] {'epoch': 10, 'num_users': 6.2857, 'loss': 0.039, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.8656, 'compress@10': 0.6096, 'time@10': 8.638}:  70%|███████   | 7/10 [00:42<00:19,  6.62s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0377, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.8699, 'compress@10': 0.5602, 'time@10': 8.5381}:  70%|███████   | 7/10 [00:49<00:19,  6.62s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0377, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.8699, 'compress@10': 0.5602, 'time@10': 8.5381}:  80%|████████  | 8/10 [00:49<00:14,  7.02s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0385, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.8945, 'compress@10': 0.5414, 'time@10': 9.1776}:  80%|████████  | 8/10 [00:57<00:14,  7.02s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0385, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.8945, 'compress@10': 0.5414, 'time@10': 9.1776}:  90%|█████████ | 9/10 [00:57<00:07,  7.07s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0386, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.8982, 'compress@10': 0.4904, 'time@10': 9.1566}:  90%|█████████ | 9/10 [01:06<00:07,  7.07s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0386, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.8982, 'compress@10': 0.4904, 'time@10': 9.1566}: 100%|██████████| 10/10 [01:06<00:00,  7.68s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0386, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.8982, 'compress@10': 0.4904, 'time@10': 9.1566}: 100%|██████████| 10/10 [01:06<00:00,  6.62s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03858614573909243
Avg hit ratio: 0.8891141514588033
Avg ndcg: 0.8982100834113972
Avg compression ratio: 0.4903783126862634
Avg train time: 9.156640601158141
Std train time: 2.742276657246956
[0.7583333333333334, 0.3416666666666666, 0.09166666666666667, 0.6749999999999999, 0.925, 0.8416666666666667, 0.425, 0.17500000000000004, 0.425, 0.008333333333333335]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8491, 'compress@10': 0.771, 'time@10': 8.4072}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8491, 'compress@10': 0.771, 'time@10': 8.4072}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0364, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8736, 'compress@10': 0.567, 'time@10': 7.7992}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0364, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8736, 'compress@10': 0.567, 'time@10': 7.7992}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8681, 'compress@10': 0.4518, 'time@10': 6.8171}:  20%|██        | 2/10 [00:13<00:47,  6.00s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8681, 'compress@10': 0.4518, 'time@10': 6.8171}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8642, 'compress@10': 0.5105, 'time@10': 6.6658}:  30%|███       | 3/10 [00:20<00:30,  4.38s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8642, 'compress@10': 0.5105, 'time@10': 6.6658}:  40%|████      | 4/10 [00:20<00:30,  5.13s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.035, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8548, 'compress@10': 0.5937, 'time@10': 7.8431}:  40%|████      | 4/10 [00:26<00:30,  5.13s/it] {'epoch': 11, 'num_users': 5.8, 'loss': 0.035, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8548, 'compress@10': 0.5937, 'time@10': 7.8431}:  50%|█████     | 5/10 [00:26<00:27,  5.56s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0364, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8603, 'compress@10': 0.6356, 'time@10': 8.1949}:  50%|█████     | 5/10 [00:36<00:27,  5.56s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0364, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8603, 'compress@10': 0.6356, 'time@10': 8.1949}:  60%|██████    | 6/10 [00:36<00:28,  7.07s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0362, 'hit_ratio@10': 0.895, 'ndcg@10': 0.8604, 'compress@10': 0.6088, 'time@10': 8.6325}:  60%|██████    | 6/10 [00:42<00:28,  7.07s/it] {'epoch': 11, 'num_users': 6.2857, 'loss': 0.0362, 'hit_ratio@10': 0.895, 'ndcg@10': 0.8604, 'compress@10': 0.6088, 'time@10': 8.6325}:  70%|███████   | 7/10 [00:42<00:19,  6.61s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0352, 'hit_ratio@10': 0.901, 'ndcg@10': 0.8656, 'compress@10': 0.5575, 'time@10': 8.5123}:  70%|███████   | 7/10 [00:49<00:19,  6.61s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0352, 'hit_ratio@10': 0.901, 'ndcg@10': 0.8656, 'compress@10': 0.5575, 'time@10': 8.5123}:  80%|████████  | 8/10 [00:49<00:13,  6.96s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0382, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.8951, 'compress@10': 0.5446, 'time@10': 9.1528}:  80%|████████  | 8/10 [00:57<00:13,  6.96s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0382, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.8951, 'compress@10': 0.5446, 'time@10': 9.1528}:  90%|█████████ | 9/10 [00:57<00:07,  7.03s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0375, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.8932, 'compress@10': 0.4933, 'time@10': 9.1466}:  90%|█████████ | 9/10 [01:06<00:07,  7.03s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0375, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.8932, 'compress@10': 0.4933, 'time@10': 9.1466}: 100%|██████████| 10/10 [01:06<00:00,  7.68s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0375, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.8932, 'compress@10': 0.4933, 'time@10': 9.1466}: 100%|██████████| 10/10 [01:06<00:00,  6.62s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03753160235892907
Avg hit ratio: 0.8985297358743878
Avg ndcg: 0.8931762425178043
Avg compression ratio: 0.4932521718806814
Avg train time: 9.146598052978515
Std train time: 2.768128840389006
[0.776923076923077, 0.3153846153846153, 0.08461538461538462, 0.7, 0.9307692307692308, 0.8538461538461538, 0.3923076923076923, 0.16153846153846158, 0.46923076923076923, 0.007692307692307694]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.839, 'compress@10': 0.7887, 'time@10': 8.218}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.839, 'compress@10': 0.7887, 'time@10': 8.218}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8728, 'compress@10': 0.5631, 'time@10': 7.6221}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8728, 'compress@10': 0.5631, 'time@10': 7.6221}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8676, 'compress@10': 0.4472, 'time@10': 6.8834}:  20%|██        | 2/10 [00:13<00:46,  5.87s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8676, 'compress@10': 0.4472, 'time@10': 6.8834}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8599, 'compress@10': 0.5131, 'time@10': 6.7074}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8599, 'compress@10': 0.5131, 'time@10': 6.7074}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.034, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8517, 'compress@10': 0.5969, 'time@10': 7.8688}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it] {'epoch': 12, 'num_users': 5.8, 'loss': 0.034, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8517, 'compress@10': 0.5969, 'time@10': 7.8688}:  50%|█████     | 5/10 [00:26<00:27,  5.56s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0358, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8619, 'compress@10': 0.6402, 'time@10': 8.2501}:  50%|█████     | 5/10 [00:36<00:27,  5.56s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0358, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8619, 'compress@10': 0.6402, 'time@10': 8.2501}:  60%|██████    | 6/10 [00:36<00:28,  7.13s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0348, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8691, 'compress@10': 0.6083, 'time@10': 8.6703}:  60%|██████    | 6/10 [00:42<00:28,  7.13s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0348, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8691, 'compress@10': 0.6083, 'time@10': 8.6703}:  70%|███████   | 7/10 [00:42<00:19,  6.64s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0338, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.8716, 'compress@10': 0.5554, 'time@10': 8.5554}:  70%|███████   | 7/10 [00:50<00:19,  6.64s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0338, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.8716, 'compress@10': 0.5554, 'time@10': 8.5554}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0357, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8843, 'compress@10': 0.5475, 'time@10': 9.1777}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0357, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8843, 'compress@10': 0.5475, 'time@10': 9.1777}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0331, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.8901, 'compress@10': 0.4958, 'time@10': 9.1512}:  90%|█████████ | 9/10 [01:06<00:07,  7.04s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.0331, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.8901, 'compress@10': 0.4958, 'time@10': 9.1512}: 100%|██████████| 10/10 [01:06<00:00,  7.63s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0331, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.8901, 'compress@10': 0.4958, 'time@10': 9.1512}: 100%|██████████| 10/10 [01:06<00:00,  6.62s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03314941547318885
Avg hit ratio: 0.8888722588484897
Avg ndcg: 0.8901264585926267
Avg compression ratio: 0.49582051795188054
Avg train time: 9.151156759262085
Std train time: 2.6794192810519597
[0.7928571428571429, 0.2928571428571428, 0.07857142857142857, 0.7214285714285714, 0.9357142857142857, 0.8642857142857142, 0.36428571428571427, 0.15000000000000002, 0.5071428571428571, 0.007142857142857144]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8417, 'compress@10': 0.8037, 'time@10': 8.4379}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8417, 'compress@10': 0.8037, 'time@10': 8.4379}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8805, 'compress@10': 0.5597, 'time@10': 7.734}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it] {'epoch': 13, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8805, 'compress@10': 0.5597, 'time@10': 7.734}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8727, 'compress@10': 0.4432, 'time@10': 6.9644}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8727, 'compress@10': 0.4432, 'time@10': 6.9644}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8642, 'compress@10': 0.5152, 'time@10': 6.751}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8642, 'compress@10': 0.5152, 'time@10': 6.751}:  40%|████      | 4/10 [00:20<00:30,  5.13s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0313, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8569, 'compress@10': 0.5996, 'time@10': 7.9176}:  40%|████      | 4/10 [00:26<00:30,  5.13s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0313, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8569, 'compress@10': 0.5996, 'time@10': 7.9176}:  50%|█████     | 5/10 [00:26<00:27,  5.56s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0313, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.8673, 'compress@10': 0.6442, 'time@10': 8.2336}:  50%|█████     | 5/10 [00:36<00:27,  5.56s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0313, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.8673, 'compress@10': 0.6442, 'time@10': 8.2336}:  60%|██████    | 6/10 [00:36<00:28,  7.02s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0322, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.8735, 'compress@10': 0.6079, 'time@10': 8.6443}:  60%|██████    | 6/10 [00:42<00:28,  7.02s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0322, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.8735, 'compress@10': 0.6079, 'time@10': 8.6443}:  70%|███████   | 7/10 [00:42<00:19,  6.56s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.8793, 'compress@10': 0.5537, 'time@10': 8.5657}:  70%|███████   | 7/10 [00:50<00:19,  6.56s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.8793, 'compress@10': 0.5537, 'time@10': 8.5657}:  80%|████████  | 8/10 [00:50<00:14,  7.03s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0298, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.8854, 'compress@10': 0.5501, 'time@10': 9.1856}:  80%|████████  | 8/10 [00:57<00:14,  7.03s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0298, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.8854, 'compress@10': 0.5501, 'time@10': 9.1856}:  90%|█████████ | 9/10 [00:57<00:07,  7.06s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0313, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.8905, 'compress@10': 0.498, 'time@10': 9.1525}:  90%|█████████ | 9/10 [01:06<00:07,  7.06s/it]    {'epoch': 13, 'num_users': 6.3, 'loss': 0.0313, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.8905, 'compress@10': 0.498, 'time@10': 9.1525}: 100%|██████████| 10/10 [01:06<00:00,  7.62s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0313, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.8905, 'compress@10': 0.498, 'time@10': 9.1525}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.031349425298712166
Avg hit ratio: 0.8974436874199183
Avg ndcg: 0.8905152970842216
Avg compression ratio: 0.49802165623821654
Avg train time: 9.152549004554748
Std train time: 2.655311813931068
[0.8066666666666668, 0.2733333333333333, 0.07333333333333333, 0.74, 0.9400000000000001, 0.8066666666666666, 0.4066666666666666, 0.14, 0.47333333333333333, 0.07333333333333333]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8558, 'compress@10': 0.8168, 'time@10': 8.3523}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8558, 'compress@10': 0.8168, 'time@10': 8.3523}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8837, 'compress@10': 0.5568, 'time@10': 7.7104}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8837, 'compress@10': 0.5568, 'time@10': 7.7104}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8749, 'compress@10': 0.4398, 'time@10': 6.9271}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8749, 'compress@10': 0.4398, 'time@10': 6.9271}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8669, 'compress@10': 0.5172, 'time@10': 6.8015}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8669, 'compress@10': 0.5172, 'time@10': 6.8015}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8611, 'compress@10': 0.602, 'time@10': 7.949}:  40%|████      | 4/10 [00:26<00:31,  5.25s/it] {'epoch': 14, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8611, 'compress@10': 0.602, 'time@10': 7.949}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0304, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8746, 'compress@10': 0.6368, 'time@10': 8.2744}:  50%|█████     | 5/10 [00:36<00:28,  5.63s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0304, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8746, 'compress@10': 0.6368, 'time@10': 8.2744}:  60%|██████    | 6/10 [00:36<00:28,  7.10s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0301, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8762, 'compress@10': 0.6073, 'time@10': 8.7041}:  60%|██████    | 6/10 [00:42<00:28,  7.10s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0301, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8762, 'compress@10': 0.6073, 'time@10': 8.7041}:  70%|███████   | 7/10 [00:42<00:19,  6.63s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.8804, 'compress@10': 0.552, 'time@10': 8.5778}:  70%|███████   | 7/10 [00:50<00:19,  6.63s/it]  {'epoch': 14, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.8804, 'compress@10': 0.552, 'time@10': 8.5778}:  80%|████████  | 8/10 [00:50<00:13,  6.98s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0279, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.8881, 'compress@10': 0.5449, 'time@10': 9.1997}:  80%|████████  | 8/10 [00:57<00:13,  6.98s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0279, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.8881, 'compress@10': 0.5449, 'time@10': 9.1997}:  90%|█████████ | 9/10 [00:57<00:07,  7.03s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.897, 'ndcg@10': 0.8918, 'compress@10': 0.4999, 'time@10': 9.2702}:  90%|█████████ | 9/10 [01:07<00:07,  7.03s/it]    {'epoch': 14, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.897, 'ndcg@10': 0.8918, 'compress@10': 0.4999, 'time@10': 9.2702}: 100%|██████████| 10/10 [01:07<00:00,  7.93s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.897, 'ndcg@10': 0.8918, 'compress@10': 0.4999, 'time@10': 9.2702}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.027659226937920826
Avg hit ratio: 0.8969925596003694
Avg ndcg: 0.8917638279910362
Avg compression ratio: 0.4998511363971826
Avg train time: 9.270158433914185
Std train time: 2.667288643545089
[0.8187500000000001, 0.25625, 0.06875, 0.75625, 0.9437500000000001, 0.81875, 0.44375, 0.13125, 0.44375, 0.06875]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0341, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8624, 'compress@10': 0.8283, 'time@10': 8.0871}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0341, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8624, 'compress@10': 0.8283, 'time@10': 8.0871}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8841, 'compress@10': 0.5543, 'time@10': 7.5645}:  10%|█         | 1/10 [00:11<00:36,  4.08s/it] {'epoch': 15, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8841, 'compress@10': 0.5543, 'time@10': 7.5645}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8751, 'compress@10': 0.4368, 'time@10': 6.7857}:  20%|██        | 2/10 [00:13<00:46,  5.85s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8751, 'compress@10': 0.4368, 'time@10': 6.7857}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8724, 'compress@10': 0.5188, 'time@10': 6.6023}:  30%|███       | 3/10 [00:19<00:30,  4.39s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8724, 'compress@10': 0.5188, 'time@10': 6.6023}:  40%|████      | 4/10 [00:19<00:30,  5.06s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0281, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8673, 'compress@10': 0.604, 'time@10': 7.7458}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it] {'epoch': 15, 'num_users': 5.8, 'loss': 0.0281, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8673, 'compress@10': 0.604, 'time@10': 7.7458}:  50%|█████     | 5/10 [00:26<00:27,  5.47s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8796, 'compress@10': 0.6405, 'time@10': 8.136}:  50%|█████     | 5/10 [00:36<00:27,  5.47s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8796, 'compress@10': 0.6405, 'time@10': 8.136}:  60%|██████    | 6/10 [00:36<00:28,  7.05s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8851, 'compress@10': 0.6156, 'time@10': 8.5481}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8851, 'compress@10': 0.6156, 'time@10': 8.5481}:  70%|███████   | 7/10 [00:41<00:19,  6.56s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8877, 'compress@10': 0.5581, 'time@10': 8.4273}:  70%|███████   | 7/10 [00:49<00:19,  6.56s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8877, 'compress@10': 0.5581, 'time@10': 8.4273}:  80%|████████  | 8/10 [00:49<00:13,  6.90s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9081, 'compress@10': 0.5472, 'time@10': 9.094}:  80%|████████  | 8/10 [00:56<00:13,  6.90s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9081, 'compress@10': 0.5472, 'time@10': 9.094}:  90%|█████████ | 9/10 [00:56<00:07,  7.01s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9134, 'compress@10': 0.5015, 'time@10': 9.1374}:  90%|█████████ | 9/10 [01:06<00:07,  7.01s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9134, 'compress@10': 0.5015, 'time@10': 9.1374}: 100%|██████████| 10/10 [01:06<00:00,  7.80s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9134, 'compress@10': 0.5015, 'time@10': 9.1374}: 100%|██████████| 10/10 [01:06<00:00,  6.62s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.026839732350295447
Avg hit ratio: 0.8769925596003694
Avg ndcg: 0.9133519435465521
Avg compression ratio: 0.5014530978386544
Avg train time: 9.1373761177063
Std train time: 2.74636646784769
[0.8294117647058824, 0.24117647058823527, 0.06470588235294118, 0.7705882352941176, 0.9470588235294118, 0.8294117647058823, 0.41764705882352937, 0.12352941176470589, 0.4764705882352941, 0.06470588235294118]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0306, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8664, 'compress@10': 0.8384, 'time@10': 8.2355}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0306, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8664, 'compress@10': 0.8384, 'time@10': 8.2355}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8927, 'compress@10': 0.552, 'time@10': 7.7559}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it] {'epoch': 16, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8927, 'compress@10': 0.552, 'time@10': 7.7559}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8808, 'compress@10': 0.4341, 'time@10': 7.0047}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8808, 'compress@10': 0.4341, 'time@10': 7.0047}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8815, 'compress@10': 0.5203, 'time@10': 6.7798}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8815, 'compress@10': 0.5203, 'time@10': 6.7798}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0265, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8752, 'compress@10': 0.6058, 'time@10': 7.8853}:  40%|████      | 4/10 [00:26<00:31,  5.18s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0265, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8752, 'compress@10': 0.6058, 'time@10': 7.8853}:  50%|█████     | 5/10 [00:26<00:27,  5.55s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0272, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8852, 'compress@10': 0.6437, 'time@10': 8.2083}:  50%|█████     | 5/10 [00:36<00:27,  5.55s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0272, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8852, 'compress@10': 0.6437, 'time@10': 8.2083}:  60%|██████    | 6/10 [00:36<00:28,  7.01s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8894, 'compress@10': 0.6148, 'time@10': 8.6501}:  60%|██████    | 6/10 [00:42<00:28,  7.01s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8894, 'compress@10': 0.6148, 'time@10': 8.6501}:  70%|███████   | 7/10 [00:42<00:19,  6.58s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0266, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8938, 'compress@10': 0.5565, 'time@10': 8.522}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it]  {'epoch': 16, 'num_users': 6.125, 'loss': 0.0266, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8938, 'compress@10': 0.5565, 'time@10': 8.522}:  80%|████████  | 8/10 [00:49<00:13,  6.92s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9147, 'compress@10': 0.5493, 'time@10': 9.1901}:  80%|████████  | 8/10 [00:57<00:13,  6.92s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9147, 'compress@10': 0.5493, 'time@10': 9.1901}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0323, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9139, 'compress@10': 0.5029, 'time@10': 9.1682}:  90%|█████████ | 9/10 [01:06<00:07,  7.04s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0323, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9139, 'compress@10': 0.5029, 'time@10': 9.1682}: 100%|██████████| 10/10 [01:06<00:00,  7.66s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0323, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9139, 'compress@10': 0.5029, 'time@10': 9.1682}: 100%|██████████| 10/10 [01:06<00:00,  6.62s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.03225161875873422
Avg hit ratio: 0.8769925596003694
Avg ndcg: 0.913925289481677
Avg compression ratio: 0.5029339199252081
Avg train time: 9.16815779209137
Std train time: 2.7079399529439305
[0.7833333333333334, 0.22777777777777775, 0.061111111111111116, 0.7833333333333332, 0.9500000000000001, 0.7833333333333333, 0.44999999999999996, 0.11666666666666667, 0.5055555555555555, 0.11666666666666667]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.885, 'compress@10': 0.7947, 'time@10': 8.1284}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.885, 'compress@10': 0.7947, 'time@10': 8.1284}:  10%|█         | 1/10 [00:04<00:36,  4.10s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.906, 'compress@10': 0.5237, 'time@10': 7.547}:  10%|█         | 1/10 [00:11<00:36,  4.10s/it] {'epoch': 17, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.906, 'compress@10': 0.5237, 'time@10': 7.547}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8897, 'compress@10': 0.4142, 'time@10': 6.6716}:  20%|██        | 2/10 [00:13<00:46,  5.81s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8897, 'compress@10': 0.4142, 'time@10': 6.6716}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8935, 'compress@10': 0.5084, 'time@10': 6.5075}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8935, 'compress@10': 0.5084, 'time@10': 6.5075}:  40%|████      | 4/10 [00:19<00:29,  5.00s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0242, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8861, 'compress@10': 0.5969, 'time@10': 7.6912}:  40%|████      | 4/10 [00:25<00:29,  5.00s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0242, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8861, 'compress@10': 0.5969, 'time@10': 7.6912}:  50%|█████     | 5/10 [00:25<00:27,  5.46s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0245, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8941, 'compress@10': 0.6288, 'time@10': 8.0786}:  50%|█████     | 5/10 [00:35<00:27,  5.46s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0245, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8941, 'compress@10': 0.6288, 'time@10': 8.0786}:  60%|██████    | 6/10 [00:35<00:28,  7.02s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0242, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8966, 'compress@10': 0.6064, 'time@10': 8.5317}:  60%|██████    | 6/10 [00:41<00:28,  7.02s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0242, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8966, 'compress@10': 0.6064, 'time@10': 8.5317}:  70%|███████   | 7/10 [00:41<00:19,  6.58s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0235, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.8982, 'compress@10': 0.5483, 'time@10': 8.4176}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0235, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.8982, 'compress@10': 0.5483, 'time@10': 8.4176}:  80%|████████  | 8/10 [00:49<00:13,  6.92s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0267, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8989, 'compress@10': 0.5452, 'time@10': 9.1135}:  80%|████████  | 8/10 [00:56<00:13,  6.92s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0267, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8989, 'compress@10': 0.5452, 'time@10': 9.1135}:  90%|█████████ | 9/10 [00:56<00:07,  7.06s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9049, 'compress@10': 0.5043, 'time@10': 9.1771}:  90%|█████████ | 9/10 [01:06<00:07,  7.06s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9049, 'compress@10': 0.5043, 'time@10': 9.1771}: 100%|██████████| 10/10 [01:06<00:00,  7.90s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9049, 'compress@10': 0.5043, 'time@10': 9.1771}: 100%|██████████| 10/10 [01:06<00:00,  6.65s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02549859471753303
Avg hit ratio: 0.8827068453146552
Avg ndcg: 0.9048812276333568
Avg compression ratio: 0.504319135912058
Avg train time: 9.177095913887024
Std train time: 2.875863605762365
[0.7947368421052633, 0.2157894736842105, 0.05789473684210527, 0.7947368421052631, 0.9526315789473685, 0.7947368421052632, 0.42631578947368415, 0.11052631578947368, 0.531578947368421, 0.11052631578947368]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9089, 'compress@10': 0.8055, 'time@10': 8.0633}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9089, 'compress@10': 0.8055, 'time@10': 8.0633}:  10%|█         | 1/10 [00:04<00:36,  4.07s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9204, 'compress@10': 0.5233, 'time@10': 7.442}:  10%|█         | 1/10 [00:10<00:36,  4.07s/it] {'epoch': 18, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9204, 'compress@10': 0.5233, 'time@10': 7.442}:  20%|██        | 2/10 [00:10<00:45,  5.71s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8993, 'compress@10': 0.413, 'time@10': 6.693}:  20%|██        | 2/10 [00:13<00:45,  5.71s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8993, 'compress@10': 0.413, 'time@10': 6.693}:  30%|███       | 3/10 [00:13<00:30,  4.31s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8993, 'compress@10': 0.5103, 'time@10': 6.5438}:  30%|███       | 3/10 [00:19<00:30,  4.31s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8993, 'compress@10': 0.5103, 'time@10': 6.5438}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.892, 'compress@10': 0.5989, 'time@10': 7.6663}:  40%|████      | 4/10 [00:25<00:30,  5.03s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.892, 'compress@10': 0.5989, 'time@10': 7.6663}:  50%|█████     | 5/10 [00:25<00:27,  5.42s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0266, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9033, 'compress@10': 0.6323, 'time@10': 8.0567}:  50%|█████     | 5/10 [00:35<00:27,  5.42s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0266, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9033, 'compress@10': 0.6323, 'time@10': 8.0567}:  60%|██████    | 6/10 [00:35<00:27,  6.99s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0259, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9058, 'compress@10': 0.6062, 'time@10': 8.5863}:  60%|██████    | 6/10 [00:41<00:27,  6.99s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0259, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9058, 'compress@10': 0.6062, 'time@10': 8.5863}:  70%|███████   | 7/10 [00:41<00:19,  6.65s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0252, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9063, 'compress@10': 0.5474, 'time@10': 8.5021}:  70%|███████   | 7/10 [00:49<00:19,  6.65s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0252, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9063, 'compress@10': 0.5474, 'time@10': 8.5021}:  80%|████████  | 8/10 [00:49<00:14,  7.06s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0258, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9182, 'compress@10': 0.5471, 'time@10': 9.1534}:  80%|████████  | 8/10 [00:56<00:14,  7.06s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0258, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9182, 'compress@10': 0.5471, 'time@10': 9.1534}:  90%|█████████ | 9/10 [00:56<00:07,  7.11s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0242, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9245, 'compress@10': 0.5055, 'time@10': 9.201}:  90%|█████████ | 9/10 [01:06<00:07,  7.11s/it]    {'epoch': 18, 'num_users': 6.3, 'loss': 0.0242, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9245, 'compress@10': 0.5055, 'time@10': 9.201}: 100%|██████████| 10/10 [01:06<00:00,  7.90s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0242, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9245, 'compress@10': 0.5055, 'time@10': 9.201}: 100%|██████████| 10/10 [01:06<00:00,  6.66s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.02420327115721578
Avg hit ratio: 0.9018497024575123
Avg ndcg: 0.9244849795365653
Avg compression ratio: 0.5054933925921056
Avg train time: 9.201039290428161
Std train time: 2.7766994100858784
[0.8050000000000002, 0.205, 0.05500000000000001, 0.8049999999999999, 0.9550000000000001, 0.805, 0.4049999999999999, 0.105, 0.5549999999999999, 0.105]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8968, 'compress@10': 0.8153, 'time@10': 8.19}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8968, 'compress@10': 0.8153, 'time@10': 8.19}:  10%|█         | 1/10 [00:04<00:37,  4.13s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9135, 'compress@10': 0.523, 'time@10': 7.5466}:  10%|█         | 1/10 [00:11<00:37,  4.13s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9135, 'compress@10': 0.523, 'time@10': 7.5466}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8947, 'compress@10': 0.412, 'time@10': 6.772}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8947, 'compress@10': 0.412, 'time@10': 6.772}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9011, 'compress@10': 0.512, 'time@10': 6.614}:  30%|███       | 3/10 [00:19<00:30,  4.35s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9011, 'compress@10': 0.512, 'time@10': 6.614}:  40%|████      | 4/10 [00:19<00:30,  5.07s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0204, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.895, 'compress@10': 0.6007, 'time@10': 7.819}:  40%|████      | 4/10 [00:26<00:30,  5.07s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0204, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.895, 'compress@10': 0.6007, 'time@10': 7.819}:  50%|█████     | 5/10 [00:26<00:27,  5.54s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9028, 'compress@10': 0.6355, 'time@10': 8.175}:  50%|█████     | 5/10 [00:36<00:27,  5.54s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9028, 'compress@10': 0.6355, 'time@10': 8.175}:  60%|██████    | 6/10 [00:36<00:28,  7.05s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0221, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9057, 'compress@10': 0.606, 'time@10': 8.5914}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0221, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9057, 'compress@10': 0.606, 'time@10': 8.5914}:  70%|███████   | 7/10 [00:41<00:19,  6.57s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0213, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9096, 'compress@10': 0.5466, 'time@10': 8.4632}:  70%|███████   | 7/10 [00:49<00:19,  6.57s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0213, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9096, 'compress@10': 0.5466, 'time@10': 8.4632}:  80%|████████  | 8/10 [00:49<00:13,  6.90s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9115, 'compress@10': 0.5489, 'time@10': 9.1088}:  80%|████████  | 8/10 [00:56<00:13,  6.90s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9115, 'compress@10': 0.5489, 'time@10': 9.1088}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0226, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9159, 'compress@10': 0.5066, 'time@10': 9.1766}:  90%|█████████ | 9/10 [01:06<00:06,  6.98s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0226, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9159, 'compress@10': 0.5066, 'time@10': 9.1766}: 100%|██████████| 10/10 [01:06<00:00,  7.86s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0226, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9159, 'compress@10': 0.5066, 'time@10': 9.1766}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.0226160957411717
Avg hit ratio: 0.8961354167432265
Avg ndcg: 0.9158554284798314
Avg compression ratio: 0.5065516466474553
Avg train time: 9.176638054847718
Std train time: 2.7603527258653497
[0.7666666666666668, 0.19523809523809524, 0.05238095238095239, 0.8142857142857143, 0.9571428571428572, 0.7666666666666667, 0.43333333333333324, 0.09999999999999999, 0.5761904761904761, 0.14761904761904762]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9046, 'compress@10': 0.7789, 'time@10': 8.0457}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9046, 'compress@10': 0.7789, 'time@10': 8.0457}:  10%|█         | 1/10 [00:04<00:36,  4.06s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9183, 'compress@10': 0.5001, 'time@10': 7.4701}:  10%|█         | 1/10 [00:10<00:36,  4.06s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9183, 'compress@10': 0.5001, 'time@10': 7.4701}:  20%|██        | 2/10 [00:10<00:45,  5.75s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.8979, 'compress@10': 0.396, 'time@10': 6.7067}:  20%|██        | 2/10 [00:13<00:45,  5.75s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.8979, 'compress@10': 0.396, 'time@10': 6.7067}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8012, 'ndcg@10': 0.9038, 'compress@10': 0.5022, 'time@10': 6.5401}:  30%|███       | 3/10 [00:19<00:30,  4.32s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8012, 'ndcg@10': 0.9038, 'compress@10': 0.5022, 'time@10': 6.5401}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.9024, 'compress@10': 0.5934, 'time@10': 7.6699}:  40%|████      | 4/10 [00:25<00:30,  5.02s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.9024, 'compress@10': 0.5934, 'time@10': 7.6699}:  50%|█████     | 5/10 [00:25<00:27,  5.42s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9105, 'compress@10': 0.6231, 'time@10': 8.106}:  50%|█████     | 5/10 [00:36<00:27,  5.42s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.9105, 'compress@10': 0.6231, 'time@10': 8.106}:  60%|██████    | 6/10 [00:36<00:28,  7.09s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0199, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9124, 'compress@10': 0.5992, 'time@10': 8.5589}:  60%|██████    | 6/10 [00:41<00:28,  7.09s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0199, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9124, 'compress@10': 0.5992, 'time@10': 8.5589}:  70%|███████   | 7/10 [00:41<00:19,  6.63s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0201, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9123, 'compress@10': 0.54, 'time@10': 8.4344}:  70%|███████   | 7/10 [00:49<00:19,  6.63s/it]   {'epoch': 20, 'num_users': 6.125, 'loss': 0.0201, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9123, 'compress@10': 0.54, 'time@10': 8.4344}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.917, 'compress@10': 0.5454, 'time@10': 9.0849}:  80%|████████  | 8/10 [00:56<00:13,  6.94s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.917, 'compress@10': 0.5454, 'time@10': 9.0849}:  90%|█████████ | 9/10 [00:56<00:07,  7.01s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9209, 'compress@10': 0.5076, 'time@10': 9.165}:  90%|█████████ | 9/10 [01:06<00:07,  7.01s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9209, 'compress@10': 0.5076, 'time@10': 9.165}: 100%|██████████| 10/10 [01:06<00:00,  7.91s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9209, 'compress@10': 0.5076, 'time@10': 9.165}: 100%|██████████| 10/10 [01:06<00:00,  6.66s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.018506139863147763
Avg hit ratio: 0.8753980895542866
Avg ndcg: 0.9208977720630747
Avg compression ratio: 0.507565368140874
Avg train time: 9.164979505538941
Std train time: 2.761499134986245
[0.7772727272727274, 0.2318181818181818, 0.05000000000000001, 0.8227272727272728, 0.9590909090909091, 0.7318181818181819, 0.4136363636363635, 0.1409090909090909, 0.5499999999999999, 0.1409090909090909]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9126, 'compress@10': 0.789, 'time@10': 8.4383}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9126, 'compress@10': 0.789, 'time@10': 8.4383}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9283, 'compress@10': 0.5228, 'time@10': 7.74}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it] {'epoch': 21, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9283, 'compress@10': 0.5228, 'time@10': 7.74}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9046, 'compress@10': 0.4104, 'time@10': 6.9152}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9046, 'compress@10': 0.4104, 'time@10': 6.9152}:  30%|███       | 3/10 [00:14<00:31,  4.44s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9083, 'compress@10': 0.5151, 'time@10': 6.7157}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9083, 'compress@10': 0.5151, 'time@10': 6.7157}:  40%|████      | 4/10 [00:20<00:30,  5.11s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9077, 'compress@10': 0.604, 'time@10': 7.7827}:  40%|████      | 4/10 [00:26<00:30,  5.11s/it]   {'epoch': 21, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9077, 'compress@10': 0.604, 'time@10': 7.7827}:  50%|█████     | 5/10 [00:26<00:27,  5.46s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9173, 'compress@10': 0.6263, 'time@10': 8.1639}:  50%|█████     | 5/10 [00:36<00:27,  5.46s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9173, 'compress@10': 0.6263, 'time@10': 8.1639}:  60%|██████    | 6/10 [00:36<00:28,  7.04s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0225, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9207, 'compress@10': 0.5993, 'time@10': 8.6014}:  60%|██████    | 6/10 [00:41<00:28,  7.04s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0225, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9207, 'compress@10': 0.5993, 'time@10': 8.6014}:  70%|███████   | 7/10 [00:41<00:19,  6.59s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0227, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9187, 'compress@10': 0.5451, 'time@10': 8.507}:  70%|███████   | 7/10 [00:49<00:19,  6.59s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.0227, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9187, 'compress@10': 0.5451, 'time@10': 8.507}:  80%|████████  | 8/10 [00:49<00:13,  7.00s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0219, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9247, 'compress@10': 0.547, 'time@10': 9.1637}:  80%|████████  | 8/10 [00:57<00:13,  7.00s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0219, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9247, 'compress@10': 0.547, 'time@10': 9.1637}:  90%|█████████ | 9/10 [00:57<00:07,  7.08s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9313, 'compress@10': 0.5084, 'time@10': 9.2149}:  90%|█████████ | 9/10 [01:06<00:07,  7.08s/it]  {'epoch': 21, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9313, 'compress@10': 0.5084, 'time@10': 9.2149}: 100%|██████████| 10/10 [01:06<00:00,  7.89s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9313, 'compress@10': 0.5084, 'time@10': 9.2149}: 100%|██████████| 10/10 [01:06<00:00,  6.68s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.02187476563030003
Avg hit ratio: 0.8900524674344709
Avg ndcg: 0.9313468638552628
Avg compression ratio: 0.5083864053696991
Avg train time: 9.214894366264343
Std train time: 2.6923958495061227
[0.7434782608695654, 0.26521739130434785, 0.04782608695652175, 0.8304347826086956, 0.9608695652173913, 0.7434782608695654, 0.39565217391304336, 0.1782608695652174, 0.5260869565217391, 0.13478260869565217]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9126, 'compress@10': 0.757, 'time@10': 8.1804}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9126, 'compress@10': 0.757, 'time@10': 8.1804}:  10%|█         | 1/10 [00:04<00:37,  4.13s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9518, 'compress@10': 0.5229, 'time@10': 7.5296}:  10%|█         | 1/10 [00:11<00:37,  4.13s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9518, 'compress@10': 0.5229, 'time@10': 7.5296}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9203, 'compress@10': 0.4099, 'time@10': 6.7153}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9203, 'compress@10': 0.4099, 'time@10': 6.7153}:  30%|███       | 3/10 [00:13<00:30,  4.31s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9219, 'compress@10': 0.5166, 'time@10': 6.5453}:  30%|███       | 3/10 [00:19<00:30,  4.31s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9219, 'compress@10': 0.5166, 'time@10': 6.5453}:  40%|████      | 4/10 [00:19<00:30,  5.01s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0204, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.9211, 'compress@10': 0.6056, 'time@10': 7.728}:  40%|████      | 4/10 [00:25<00:30,  5.01s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0204, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.9211, 'compress@10': 0.6056, 'time@10': 7.728}:  50%|█████     | 5/10 [00:25<00:27,  5.46s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0193, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9275, 'compress@10': 0.6295, 'time@10': 8.1068}:  50%|█████     | 5/10 [00:36<00:27,  5.46s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0193, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9275, 'compress@10': 0.6295, 'time@10': 8.1068}:  60%|██████    | 6/10 [00:36<00:28,  7.02s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0221, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9303, 'compress@10': 0.5995, 'time@10': 8.5708}:  60%|██████    | 6/10 [00:41<00:28,  7.02s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0221, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9303, 'compress@10': 0.5995, 'time@10': 8.5708}:  70%|███████   | 7/10 [00:41<00:19,  6.59s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0205, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.933, 'compress@10': 0.5498, 'time@10': 8.4658}:  70%|███████   | 7/10 [00:49<00:19,  6.59s/it]  {'epoch': 22, 'num_users': 6.125, 'loss': 0.0205, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.933, 'compress@10': 0.5498, 'time@10': 8.4658}:  80%|████████  | 8/10 [00:49<00:13,  6.97s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9525, 'compress@10': 0.5487, 'time@10': 9.1385}:  80%|████████  | 8/10 [00:56<00:13,  6.97s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9525, 'compress@10': 0.5487, 'time@10': 9.1385}:  90%|█████████ | 9/10 [00:56<00:07,  7.07s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9505, 'compress@10': 0.5093, 'time@10': 9.2129}:  90%|█████████ | 9/10 [01:06<00:07,  7.07s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9505, 'compress@10': 0.5093, 'time@10': 9.2129}: 100%|██████████| 10/10 [01:06<00:00,  7.95s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9505, 'compress@10': 0.5093, 'time@10': 9.2129}: 100%|██████████| 10/10 [01:06<00:00,  6.67s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.023534396904012194
Avg hit ratio: 0.8903187244749213
Avg ndcg: 0.9504816260878668
Avg compression ratio: 0.5092670773108247
Avg train time: 9.21287281513214
Std train time: 2.8319713489295664
[0.7125000000000001, 0.29583333333333334, 0.045833333333333344, 0.8375, 0.9625, 0.7125000000000001, 0.4208333333333332, 0.17083333333333334, 0.5458333333333333, 0.12916666666666665]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9151, 'compress@10': 0.7276, 'time@10': 8.233}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9151, 'compress@10': 0.7276, 'time@10': 8.233}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9378, 'compress@10': 0.5231, 'time@10': 7.5718}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9378, 'compress@10': 0.5231, 'time@10': 7.5718}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9109, 'compress@10': 0.4094, 'time@10': 6.7992}:  20%|██        | 2/10 [00:13<00:47,  5.88s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9109, 'compress@10': 0.4094, 'time@10': 6.7992}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9164, 'compress@10': 0.5179, 'time@10': 6.6247}:  30%|███       | 3/10 [00:20<00:30,  4.41s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9164, 'compress@10': 0.5179, 'time@10': 6.6247}:  40%|████      | 4/10 [00:20<00:30,  5.09s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9177, 'compress@10': 0.607, 'time@10': 7.7598}:  40%|████      | 4/10 [00:26<00:30,  5.09s/it]  {'epoch': 23, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9177, 'compress@10': 0.607, 'time@10': 7.7598}:  50%|█████     | 5/10 [00:26<00:27,  5.49s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.926, 'compress@10': 0.6256, 'time@10': 8.1425}:  50%|█████     | 5/10 [00:36<00:27,  5.49s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.926, 'compress@10': 0.6256, 'time@10': 8.1425}:  60%|██████    | 6/10 [00:36<00:28,  7.06s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9255, 'compress@10': 0.5997, 'time@10': 8.579}:  60%|██████    | 6/10 [00:42<00:28,  7.06s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9255, 'compress@10': 0.5997, 'time@10': 8.579}:  70%|███████   | 7/10 [00:42<00:19,  6.59s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9236, 'compress@10': 0.549, 'time@10': 8.4555}:  70%|███████   | 7/10 [00:49<00:19,  6.59s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9236, 'compress@10': 0.549, 'time@10': 8.4555}:  80%|████████  | 8/10 [00:49<00:13,  6.92s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.917, 'compress@10': 0.5501, 'time@10': 9.1049}:  80%|████████  | 8/10 [00:56<00:13,  6.92s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.917, 'compress@10': 0.5501, 'time@10': 9.1049}:  90%|█████████ | 9/10 [00:56<00:07,  7.01s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9218, 'compress@10': 0.51, 'time@10': 9.1661}:  90%|█████████ | 9/10 [01:06<00:07,  7.01s/it]    {'epoch': 23, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9218, 'compress@10': 0.51, 'time@10': 9.1661}: 100%|██████████| 10/10 [01:06<00:00,  7.85s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9218, 'compress@10': 0.51, 'time@10': 9.1661}: 100%|██████████| 10/10 [01:06<00:00,  6.66s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.01866580574997593
Avg hit ratio: 0.8957667531487565
Avg ndcg: 0.9217501921528541
Avg compression ratio: 0.5100040716244152
Avg train time: 9.166051697731017
Std train time: 2.730195604073187
[0.7240000000000001, 0.28400000000000003, 0.04400000000000001, 0.844, 0.964, 0.6840000000000002, 0.4039999999999999, 0.20400000000000001, 0.564, 0.12399999999999999]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9065, 'compress@10': 0.7385, 'time@10': 8.2505}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9065, 'compress@10': 0.7385, 'time@10': 8.2505}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9238, 'compress@10': 0.5228, 'time@10': 7.629}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it]  {'epoch': 24, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9238, 'compress@10': 0.5228, 'time@10': 7.629}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9016, 'compress@10': 0.4087, 'time@10': 6.8657}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9016, 'compress@10': 0.4087, 'time@10': 6.8657}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9066, 'compress@10': 0.5189, 'time@10': 6.6557}:  30%|███       | 3/10 [00:19<00:30,  4.42s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9066, 'compress@10': 0.5189, 'time@10': 6.6557}:  40%|████      | 4/10 [00:19<00:30,  5.07s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9103, 'compress@10': 0.6081, 'time@10': 7.7609}:  40%|████      | 4/10 [00:26<00:30,  5.07s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9103, 'compress@10': 0.6081, 'time@10': 7.7609}:  50%|█████     | 5/10 [00:26<00:27,  5.45s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0209, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9278, 'compress@10': 0.6219, 'time@10': 8.1725}:  50%|█████     | 5/10 [00:36<00:27,  5.45s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0209, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9278, 'compress@10': 0.6219, 'time@10': 8.1725}:  60%|██████    | 6/10 [00:36<00:28,  7.09s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0192, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9306, 'compress@10': 0.5942, 'time@10': 8.6024}:  60%|██████    | 6/10 [00:42<00:28,  7.09s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0192, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9306, 'compress@10': 0.5942, 'time@10': 8.6024}:  70%|███████   | 7/10 [00:42<00:19,  6.61s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0223, 'hit_ratio@10': 0.9142, 'ndcg@10': 0.9315, 'compress@10': 0.5483, 'time@10': 8.4947}:  70%|███████   | 7/10 [00:49<00:19,  6.61s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0223, 'hit_ratio@10': 0.9142, 'ndcg@10': 0.9315, 'compress@10': 0.5483, 'time@10': 8.4947}:  80%|████████  | 8/10 [00:49<00:13,  6.98s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9319, 'compress@10': 0.5514, 'time@10': 9.1704}:  80%|████████  | 8/10 [00:57<00:13,  6.98s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9319, 'compress@10': 0.5514, 'time@10': 9.1704}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9376, 'compress@10': 0.5106, 'time@10': 9.211}:  90%|█████████ | 9/10 [01:06<00:07,  7.09s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9376, 'compress@10': 0.5106, 'time@10': 9.211}: 100%|██████████| 10/10 [01:06<00:00,  7.87s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9376, 'compress@10': 0.5106, 'time@10': 9.211}: 100%|██████████| 10/10 [01:06<00:00,  6.67s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.021081774584983625
Avg hit ratio: 0.9005414317808205
Avg ndcg: 0.9375979375445362
Avg compression ratio: 0.5106437415539399
Avg train time: 9.210963797569274
Std train time: 2.752087896795249
[0.6961538461538462, 0.2730769230769231, 0.04230769230769232, 0.85, 0.9653846153846154, 0.6961538461538463, 0.38846153846153836, 0.23461538461538464, 0.5807692307692307, 0.11923076923076922]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0433, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8643, 'compress@10': 0.7121, 'time@10': 8.4931}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0433, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8643, 'compress@10': 0.7121, 'time@10': 8.4931}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0413, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9621, 'compress@10': 0.5043, 'time@10': 7.7801}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it] {'epoch': 25, 'num_users': 7.0, 'loss': 0.0413, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9621, 'compress@10': 0.5043, 'time@10': 7.7801}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9271, 'compress@10': 0.3959, 'time@10': 6.9586}:  20%|██        | 2/10 [00:14<00:47,  5.94s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9271, 'compress@10': 0.3959, 'time@10': 6.9586}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9297, 'compress@10': 0.5108, 'time@10': 6.7146}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9297, 'compress@10': 0.5108, 'time@10': 6.7146}:  40%|████      | 4/10 [00:20<00:30,  5.09s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9294, 'compress@10': 0.6018, 'time@10': 7.8733}:  40%|████      | 4/10 [00:26<00:30,  5.09s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9294, 'compress@10': 0.6018, 'time@10': 7.8733}:  50%|█████     | 5/10 [00:26<00:27,  5.52s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0243, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9343, 'compress@10': 0.6187, 'time@10': 8.2994}:  50%|█████     | 5/10 [00:36<00:27,  5.52s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0243, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9343, 'compress@10': 0.6187, 'time@10': 8.2994}:  60%|██████    | 6/10 [00:36<00:28,  7.20s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0247, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9362, 'compress@10': 0.5893, 'time@10': 8.7063}:  60%|██████    | 6/10 [00:42<00:28,  7.20s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0247, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9362, 'compress@10': 0.5893, 'time@10': 8.7063}:  70%|███████   | 7/10 [00:42<00:20,  6.68s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0228, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9392, 'compress@10': 0.5477, 'time@10': 8.6021}:  70%|███████   | 7/10 [00:50<00:20,  6.68s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0228, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9392, 'compress@10': 0.5477, 'time@10': 8.6021}:  80%|████████  | 8/10 [00:50<00:14,  7.07s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0249, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9578, 'compress@10': 0.5527, 'time@10': 9.2365}:  80%|████████  | 8/10 [00:57<00:14,  7.07s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0249, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9578, 'compress@10': 0.5527, 'time@10': 9.2365}:  90%|█████████ | 9/10 [00:57<00:07,  7.11s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9578, 'compress@10': 0.5114, 'time@10': 9.2743}:  90%|█████████ | 9/10 [01:07<00:07,  7.11s/it]    {'epoch': 25, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9578, 'compress@10': 0.5114, 'time@10': 9.2743}: 100%|██████████| 10/10 [01:07<00:00,  7.90s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9578, 'compress@10': 0.5114, 'time@10': 9.2743}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.024409851905550436
Avg hit ratio: 0.900954130193519
Avg ndcg: 0.9577871306176086
Avg compression ratio: 0.5113502000656727
Avg train time: 9.274306750297546
Std train time: 2.734001119614689
[0.7074074074074075, 0.30000000000000004, 0.04074074074074075, 0.8555555555555555, 0.9296296296296296, 0.6703703703703705, 0.411111111111111, 0.22592592592592595, 0.5962962962962962, 0.11481481481481481]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9052, 'compress@10': 0.7228, 'time@10': 8.3493}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9052, 'compress@10': 0.7228, 'time@10': 8.3493}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9329, 'compress@10': 0.5227, 'time@10': 7.6793}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9329, 'compress@10': 0.5227, 'time@10': 7.6793}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9076, 'compress@10': 0.4077, 'time@10': 6.8608}:  20%|██        | 2/10 [00:13<00:47,  5.88s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9076, 'compress@10': 0.4077, 'time@10': 6.8608}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.917, 'compress@10': 0.521, 'time@10': 6.6342}:  30%|███       | 3/10 [00:19<00:30,  4.40s/it]  {'epoch': 26, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.917, 'compress@10': 0.521, 'time@10': 6.6342}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9203, 'compress@10': 0.603, 'time@10': 7.8197}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9203, 'compress@10': 0.603, 'time@10': 7.8197}:  50%|█████     | 5/10 [00:26<00:27,  5.50s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9283, 'compress@10': 0.6154, 'time@10': 8.2148}:  50%|█████     | 5/10 [00:36<00:27,  5.50s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9283, 'compress@10': 0.6154, 'time@10': 8.2148}:  60%|██████    | 6/10 [00:36<00:28,  7.10s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9285, 'compress@10': 0.5896, 'time@10': 8.6821}:  60%|██████    | 6/10 [00:42<00:28,  7.10s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9285, 'compress@10': 0.5896, 'time@10': 8.6821}:  70%|███████   | 7/10 [00:42<00:20,  6.68s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9299, 'compress@10': 0.5469, 'time@10': 8.5891}:  70%|███████   | 7/10 [00:50<00:20,  6.68s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9299, 'compress@10': 0.5469, 'time@10': 8.5891}:  80%|████████  | 8/10 [00:50<00:14,  7.09s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9271, 'compress@10': 0.5537, 'time@10': 9.2575}:  80%|████████  | 8/10 [00:57<00:14,  7.09s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9271, 'compress@10': 0.5537, 'time@10': 9.2575}:  90%|█████████ | 9/10 [00:57<00:07,  7.17s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9312, 'compress@10': 0.5118, 'time@10': 9.3087}:  90%|█████████ | 9/10 [01:07<00:07,  7.17s/it]  {'epoch': 26, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9312, 'compress@10': 0.5118, 'time@10': 9.3087}: 100%|██████████| 10/10 [01:07<00:00,  7.98s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9312, 'compress@10': 0.5118, 'time@10': 9.3087}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.018333411928755226
Avg hit ratio: 0.9086243810895762
Avg ndcg: 0.9312333138721242
Avg compression ratio: 0.5118058453938961
Avg train time: 9.308716630935669
Std train time: 2.8351529175011465
[0.6821428571428572, 0.2892857142857143, 0.0392857142857143, 0.8607142857142857, 0.932142857142857, 0.6464285714285716, 0.432142857142857, 0.2535714285714286, 0.6107142857142857, 0.11071428571428571]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8971, 'compress@10': 0.6989, 'time@10': 8.3398}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8971, 'compress@10': 0.6989, 'time@10': 8.3398}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9386, 'compress@10': 0.5055, 'time@10': 7.6171}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it]   {'epoch': 27, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9386, 'compress@10': 0.5055, 'time@10': 7.6171}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9115, 'compress@10': 0.3959, 'time@10': 6.8964}:  20%|██        | 2/10 [00:13<00:46,  5.81s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9115, 'compress@10': 0.3959, 'time@10': 6.8964}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9203, 'compress@10': 0.5133, 'time@10': 6.7031}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9203, 'compress@10': 0.5133, 'time@10': 6.7031}:  40%|████      | 4/10 [00:20<00:30,  5.11s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9227, 'compress@10': 0.5974, 'time@10': 7.8886}:  40%|████      | 4/10 [00:26<00:30,  5.11s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9227, 'compress@10': 0.5974, 'time@10': 7.8886}:  50%|█████     | 5/10 [00:26<00:27,  5.56s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.018, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9298, 'compress@10': 0.6068, 'time@10': 8.2843}:  50%|█████     | 5/10 [00:36<00:27,  5.56s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.018, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9298, 'compress@10': 0.6068, 'time@10': 8.2843}:  60%|██████    | 6/10 [00:36<00:28,  7.17s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9324, 'compress@10': 0.5851, 'time@10': 8.6832}:  60%|██████    | 6/10 [00:42<00:28,  7.17s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9324, 'compress@10': 0.5851, 'time@10': 8.6832}:  70%|███████   | 7/10 [00:42<00:19,  6.65s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0165, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9369, 'compress@10': 0.5464, 'time@10': 8.5661}:  70%|███████   | 7/10 [00:50<00:19,  6.65s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0165, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9369, 'compress@10': 0.5464, 'time@10': 8.5661}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9393, 'compress@10': 0.5547, 'time@10': 9.2174}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9393, 'compress@10': 0.5547, 'time@10': 9.2174}:  90%|█████████ | 9/10 [00:57<00:07,  7.08s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9432, 'compress@10': 0.5124, 'time@10': 9.2654}:  90%|█████████ | 9/10 [01:07<00:07,  7.08s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9432, 'compress@10': 0.5124, 'time@10': 9.2654}: 100%|██████████| 10/10 [01:07<00:00,  7.91s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9432, 'compress@10': 0.5124, 'time@10': 9.2654}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.014886693567427214
Avg hit ratio: 0.893970003209392
Avg ndcg: 0.9431784767265945
Avg compression ratio: 0.5123581481779389
Avg train time: 9.265404534339904
Std train time: 2.7497477099524477
[0.6931034482758621, 0.3137931034482759, 0.037931034482758634, 0.8655172413793103, 0.8999999999999999, 0.6586206896551725, 0.41724137931034466, 0.27931034482758627, 0.5896551724137931, 0.10689655172413792]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9047, 'compress@10': 0.7092, 'time@10': 8.3425}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9047, 'compress@10': 0.7092, 'time@10': 8.3425}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9433, 'compress@10': 0.5226, 'time@10': 7.7088}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9433, 'compress@10': 0.5226, 'time@10': 7.7088}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9146, 'compress@10': 0.4069, 'time@10': 6.8584}:  20%|██        | 2/10 [00:13<00:47,  5.92s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9146, 'compress@10': 0.4069, 'time@10': 6.8584}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9236, 'compress@10': 0.5227, 'time@10': 6.5593}:  30%|███       | 3/10 [00:19<00:30,  4.41s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9236, 'compress@10': 0.5227, 'time@10': 6.5593}:  40%|████      | 4/10 [00:19<00:29,  4.92s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9257, 'compress@10': 0.5986, 'time@10': 7.7192}:  40%|████      | 4/10 [00:25<00:29,  4.92s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9257, 'compress@10': 0.5986, 'time@10': 7.7192}:  50%|█████     | 5/10 [00:25<00:26,  5.39s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9329, 'compress@10': 0.6098, 'time@10': 8.1484}:  50%|█████     | 5/10 [00:36<00:26,  5.39s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9329, 'compress@10': 0.6098, 'time@10': 8.1484}:  60%|██████    | 6/10 [00:36<00:28,  7.07s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.94, 'compress@10': 0.5857, 'time@10': 8.5853}:  60%|██████    | 6/10 [00:41<00:28,  7.07s/it]   {'epoch': 28, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.94, 'compress@10': 0.5857, 'time@10': 8.5853}:  70%|███████   | 7/10 [00:41<00:19,  6.61s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9536, 'compress@10': 0.5499, 'time@10': 8.5051}:  70%|███████   | 7/10 [00:49<00:19,  6.61s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9536, 'compress@10': 0.5499, 'time@10': 8.5051}:  80%|████████  | 8/10 [00:49<00:14,  7.04s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0263, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9632, 'compress@10': 0.5557, 'time@10': 9.1929}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0263, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9632, 'compress@10': 0.5557, 'time@10': 9.1929}:  90%|█████████ | 9/10 [00:57<00:07,  7.15s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0252, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9629, 'compress@10': 0.5128, 'time@10': 9.2441}:  90%|█████████ | 9/10 [01:06<00:07,  7.15s/it]    {'epoch': 28, 'num_users': 6.3, 'loss': 0.0252, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9629, 'compress@10': 0.5128, 'time@10': 9.2441}: 100%|██████████| 10/10 [01:06<00:00,  7.95s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0252, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9629, 'compress@10': 0.5128, 'time@10': 9.2441}: 100%|██████████| 10/10 [01:06<00:00,  6.70s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.02524373006347395
Avg hit ratio: 0.8770140380276203
Avg ndcg: 0.9628730039936041
Avg compression ratio: 0.5128076048773098
Avg train time: 9.244111013412475
Std train time: 2.8517268217029628
[0.67, 0.30333333333333334, 0.03666666666666668, 0.87, 0.8699999999999999, 0.67, 0.4366666666666665, 0.3033333333333334, 0.6033333333333333, 0.10333333333333332]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9047, 'compress@10': 0.6874, 'time@10': 8.3152}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9047, 'compress@10': 0.6874, 'time@10': 8.3152}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9338, 'compress@10': 0.5066, 'time@10': 7.7057}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9338, 'compress@10': 0.5066, 'time@10': 7.7057}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9083, 'compress@10': 0.3958, 'time@10': 6.8472}:  20%|██        | 2/10 [00:13<00:47,  5.92s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9083, 'compress@10': 0.3958, 'time@10': 6.8472}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9138, 'compress@10': 0.5155, 'time@10': 6.5525}:  30%|███       | 3/10 [00:19<00:30,  4.41s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9138, 'compress@10': 0.5155, 'time@10': 6.5525}:  40%|████      | 4/10 [00:19<00:29,  4.92s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9198, 'compress@10': 0.5869, 'time@10': 7.7673}:  40%|████      | 4/10 [00:26<00:29,  4.92s/it] {'epoch': 29, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9198, 'compress@10': 0.5869, 'time@10': 7.7673}:  50%|█████     | 5/10 [00:26<00:27,  5.44s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9288, 'compress@10': 0.602, 'time@10': 8.1818}:  50%|█████     | 5/10 [00:36<00:27,  5.44s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9288, 'compress@10': 0.602, 'time@10': 8.1818}:  60%|██████    | 6/10 [00:36<00:28,  7.09s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9301, 'compress@10': 0.5816, 'time@10': 8.6067}:  60%|██████    | 6/10 [00:41<00:28,  7.09s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9301, 'compress@10': 0.5816, 'time@10': 8.6067}:  70%|███████   | 7/10 [00:41<00:19,  6.61s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9257, 'compress@10': 0.5493, 'time@10': 8.5281}:  70%|███████   | 7/10 [00:49<00:19,  6.61s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9257, 'compress@10': 0.5493, 'time@10': 8.5281}:  80%|████████  | 8/10 [00:49<00:14,  7.06s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9326, 'compress@10': 0.5566, 'time@10': 9.1979}:  80%|████████  | 8/10 [00:57<00:14,  7.06s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9326, 'compress@10': 0.5566, 'time@10': 9.1979}:  90%|█████████ | 9/10 [00:57<00:07,  7.14s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9362, 'compress@10': 0.5133, 'time@10': 9.2464}:  90%|█████████ | 9/10 [01:06<00:07,  7.14s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9362, 'compress@10': 0.5133, 'time@10': 9.2464}: 100%|██████████| 10/10 [01:06<00:00,  7.94s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0164, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9362, 'compress@10': 0.5133, 'time@10': 9.2464}: 100%|██████████| 10/10 [01:06<00:00,  6.70s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.01639211897814883
Avg hit ratio: 0.8860334952728841
Avg ndcg: 0.9362231873387185
Avg compression ratio: 0.5132837866263226
Avg train time: 9.246411085128784
Std train time: 2.85164324769826
[0.6483870967741936, 0.2935483870967742, 0.03548387096774195, 0.8741935483870967, 0.8741935483870966, 0.6483870967741936, 0.4548387096774192, 0.3258064516129033, 0.6161290322580645, 0.09999999999999999]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9016, 'compress@10': 0.6669, 'time@10': 8.1617}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9016, 'compress@10': 0.6669, 'time@10': 8.1617}:  10%|█         | 1/10 [00:04<00:37,  4.12s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.893, 'ndcg@10': 0.993, 'compress@10': 0.4916, 'time@10': 7.6871}:  10%|█         | 1/10 [00:11<00:37,  4.12s/it]  {'epoch': 30, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.893, 'ndcg@10': 0.993, 'compress@10': 0.4916, 'time@10': 7.6871}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9477, 'compress@10': 0.3855, 'time@10': 6.8656}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9477, 'compress@10': 0.3855, 'time@10': 6.8656}:  30%|███       | 3/10 [00:14<00:31,  4.45s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9434, 'compress@10': 0.5088, 'time@10': 6.5783}:  30%|███       | 3/10 [00:19<00:31,  4.45s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9434, 'compress@10': 0.5088, 'time@10': 6.5783}:  40%|████      | 4/10 [00:19<00:29,  4.96s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0198, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.944, 'compress@10': 0.5824, 'time@10': 7.81}:  40%|████      | 4/10 [00:26<00:29,  4.96s/it]   {'epoch': 30, 'num_users': 5.8, 'loss': 0.0198, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.944, 'compress@10': 0.5824, 'time@10': 7.81}:  50%|█████     | 5/10 [00:26<00:27,  5.48s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0197, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9538, 'compress@10': 0.5947, 'time@10': 8.2083}:  50%|█████     | 5/10 [00:36<00:27,  5.48s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0197, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9538, 'compress@10': 0.5947, 'time@10': 8.2083}:  60%|██████    | 6/10 [00:36<00:28,  7.10s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9534, 'compress@10': 0.5778, 'time@10': 8.6175}:  60%|██████    | 6/10 [00:41<00:28,  7.10s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9534, 'compress@10': 0.5778, 'time@10': 8.6175}:  70%|███████   | 7/10 [00:41<00:19,  6.60s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0173, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9554, 'compress@10': 0.5487, 'time@10': 8.5298}:  70%|███████   | 7/10 [00:49<00:19,  6.60s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0173, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9554, 'compress@10': 0.5487, 'time@10': 8.5298}:  80%|████████  | 8/10 [00:49<00:14,  7.03s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9731, 'compress@10': 0.5574, 'time@10': 9.1901}:  80%|████████  | 8/10 [00:57<00:14,  7.03s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9731, 'compress@10': 0.5574, 'time@10': 9.1901}:  90%|█████████ | 9/10 [00:57<00:07,  7.11s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9688, 'compress@10': 0.5137, 'time@10': 9.2772}:  90%|█████████ | 9/10 [01:07<00:07,  7.11s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9688, 'compress@10': 0.5137, 'time@10': 9.2772}: 100%|██████████| 10/10 [01:07<00:00,  8.03s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9688, 'compress@10': 0.5137, 'time@10': 9.2772}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.019589562030016845
Avg hit ratio: 0.8903985746379635
Avg ndcg: 0.9687682629263306
Avg compression ratio: 0.5137344278034355
Avg train time: 9.277225565910339
Std train time: 2.830813802328463
[0.628125, 0.31562500000000004, 0.03437500000000002, 0.8781249999999999, 0.8468749999999998, 0.659375, 0.4406249999999998, 0.31562500000000004, 0.6281249999999999, 0.128125]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9166, 'compress@10': 0.6477, 'time@10': 8.2676}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9166, 'compress@10': 0.6477, 'time@10': 8.2676}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9408, 'compress@10': 0.4927, 'time@10': 7.6733}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9408, 'compress@10': 0.4927, 'time@10': 7.6733}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9129, 'compress@10': 0.3859, 'time@10': 6.8468}:  20%|██        | 2/10 [00:13<00:47,  5.90s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9129, 'compress@10': 0.3859, 'time@10': 6.8468}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9181, 'compress@10': 0.51, 'time@10': 6.6511}:  30%|███       | 3/10 [00:20<00:30,  4.41s/it]  {'epoch': 31, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9181, 'compress@10': 0.51, 'time@10': 6.6511}:  40%|████      | 4/10 [00:20<00:30,  5.08s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9237, 'compress@10': 0.578, 'time@10': 7.8976}:  40%|████      | 4/10 [00:26<00:30,  5.08s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9237, 'compress@10': 0.578, 'time@10': 7.8976}:  50%|█████     | 5/10 [00:26<00:27,  5.58s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0156, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9343, 'compress@10': 0.5928, 'time@10': 8.3136}:  50%|█████     | 5/10 [00:36<00:27,  5.58s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0156, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9343, 'compress@10': 0.5928, 'time@10': 8.3136}:  60%|██████    | 6/10 [00:36<00:28,  7.24s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0171, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9402, 'compress@10': 0.5743, 'time@10': 8.7195}:  60%|██████    | 6/10 [00:42<00:28,  7.24s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0171, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9402, 'compress@10': 0.5743, 'time@10': 8.7195}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.965, 'compress@10': 0.5444, 'time@10': 8.6205}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it]  {'epoch': 31, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.965, 'compress@10': 0.5444, 'time@10': 8.6205}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9603, 'compress@10': 0.5549, 'time@10': 9.2432}:  80%|████████  | 8/10 [00:57<00:14,  7.11s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9603, 'compress@10': 0.5549, 'time@10': 9.2432}:  90%|█████████ | 9/10 [00:57<00:07,  7.12s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0229, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9645, 'compress@10': 0.5142, 'time@10': 9.2867}:  90%|█████████ | 9/10 [01:07<00:07,  7.12s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0229, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9645, 'compress@10': 0.5142, 'time@10': 9.2867}: 100%|██████████| 10/10 [01:07<00:00,  7.92s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0229, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9645, 'compress@10': 0.5142, 'time@10': 9.2867}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.022880156751053406
Avg hit ratio: 0.8917708224618242
Avg ndcg: 0.9645448672198411
Avg compression ratio: 0.5141908210521172
Avg train time: 9.286687302589417
Std train time: 2.7763341131946953
[0.6090909090909091, 0.3060606060606061, 0.03333333333333335, 0.8515151515151514, 0.8212121212121211, 0.6696969696969698, 0.4575757575757574, 0.3363636363636364, 0.6393939393939393, 0.15454545454545454]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9038, 'compress@10': 0.6297, 'time@10': 8.8558}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9038, 'compress@10': 0.6297, 'time@10': 8.8558}:  10%|█         | 1/10 [00:04<00:40,  4.46s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9339, 'compress@10': 0.4791, 'time@10': 7.9891}:  10%|█         | 1/10 [00:11<00:40,  4.46s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9339, 'compress@10': 0.4791, 'time@10': 7.9891}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9083, 'compress@10': 0.3765, 'time@10': 7.0347}:  20%|██        | 2/10 [00:14<00:48,  6.05s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9083, 'compress@10': 0.3765, 'time@10': 7.0347}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9174, 'compress@10': 0.4966, 'time@10': 6.7223}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9174, 'compress@10': 0.4966, 'time@10': 6.7223}:  40%|████      | 4/10 [00:20<00:30,  5.01s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9237, 'compress@10': 0.5622, 'time@10': 8.0711}:  40%|████      | 4/10 [00:26<00:30,  5.01s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9237, 'compress@10': 0.5622, 'time@10': 8.0711}:  50%|█████     | 5/10 [00:26<00:28,  5.65s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9323, 'compress@10': 0.5814, 'time@10': 8.4636}:  50%|█████     | 5/10 [00:37<00:28,  5.65s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9323, 'compress@10': 0.5814, 'time@10': 8.4636}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0124, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.933, 'compress@10': 0.5668, 'time@10': 8.8718}:  60%|██████    | 6/10 [00:43<00:29,  7.30s/it] {'epoch': 32, 'num_users': 6.2857, 'loss': 0.0124, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.933, 'compress@10': 0.5668, 'time@10': 8.8718}:  70%|███████   | 7/10 [00:43<00:20,  6.78s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9366, 'compress@10': 0.5403, 'time@10': 8.7616}:  70%|███████   | 7/10 [00:51<00:20,  6.78s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9366, 'compress@10': 0.5403, 'time@10': 8.7616}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9508, 'compress@10': 0.5525, 'time@10': 9.3482}:  80%|████████  | 8/10 [00:58<00:14,  7.18s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9508, 'compress@10': 0.5525, 'time@10': 9.3482}:  90%|█████████ | 9/10 [00:58<00:07,  7.15s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9507, 'compress@10': 0.5146, 'time@10': 9.4051}:  90%|█████████ | 9/10 [01:08<00:07,  7.15s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9507, 'compress@10': 0.5146, 'time@10': 9.4051}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9507, 'compress@10': 0.5146, 'time@10': 9.4051}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.01570282626103263
Avg hit ratio: 0.8903985746379635
Avg ndcg: 0.9506871745574363
Avg compression ratio: 0.5146217994092906
Avg train time: 9.405124092102051
Std train time: 2.861681141216218
[0.5911764705882353, 0.2970588235294118, 0.0323529411764706, 0.8558823529411764, 0.826470588235294, 0.6500000000000001, 0.47352941176470575, 0.3264705882352942, 0.6499999999999999, 0.17941176470588235]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9116, 'compress@10': 0.6127, 'time@10': 8.9809}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9116, 'compress@10': 0.6127, 'time@10': 8.9809}:  10%|█         | 1/10 [00:04<00:40,  4.53s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9383, 'compress@10': 0.4662, 'time@10': 8.0089}:  10%|█         | 1/10 [00:11<00:40,  4.53s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9383, 'compress@10': 0.4662, 'time@10': 8.0089}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9112, 'compress@10': 0.3677, 'time@10': 7.047}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9112, 'compress@10': 0.3677, 'time@10': 7.047}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9169, 'compress@10': 0.491, 'time@10': 6.7383}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9169, 'compress@10': 0.491, 'time@10': 6.7383}:  40%|████      | 4/10 [00:20<00:30,  5.01s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.923, 'compress@10': 0.5588, 'time@10': 7.9911}:  40%|████      | 4/10 [00:26<00:30,  5.01s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0126, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.923, 'compress@10': 0.5588, 'time@10': 7.9911}:  50%|█████     | 5/10 [00:26<00:27,  5.57s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9418, 'compress@10': 0.5753, 'time@10': 8.3693}:  50%|█████     | 5/10 [00:36<00:27,  5.57s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9418, 'compress@10': 0.5753, 'time@10': 8.3693}:  60%|██████    | 6/10 [00:36<00:28,  7.17s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9431, 'compress@10': 0.5638, 'time@10': 8.7714}:  60%|██████    | 6/10 [00:42<00:28,  7.17s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9431, 'compress@10': 0.5638, 'time@10': 8.7714}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9453, 'compress@10': 0.5365, 'time@10': 8.6596}:  70%|███████   | 7/10 [00:50<00:20,  6.67s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9453, 'compress@10': 0.5365, 'time@10': 8.6596}:  80%|████████  | 8/10 [00:50<00:14,  7.06s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9478, 'compress@10': 0.5502, 'time@10': 9.2611}:  80%|████████  | 8/10 [00:57<00:14,  7.06s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9478, 'compress@10': 0.5502, 'time@10': 9.2611}:  90%|█████████ | 9/10 [00:57<00:07,  7.07s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9505, 'compress@10': 0.515, 'time@10': 9.3281}:  90%|█████████ | 9/10 [01:07<00:07,  7.07s/it]    {'epoch': 33, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9505, 'compress@10': 0.515, 'time@10': 9.3281}: 100%|██████████| 10/10 [01:07<00:00,  7.96s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9505, 'compress@10': 0.515, 'time@10': 9.3281}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.01412650101711654
Avg hit ratio: 0.9050299110434933
Avg ndcg: 0.950468398007508
Avg compression ratio: 0.5150111111756412
Avg train time: 9.328070259094238
Std train time: 2.7966840873910783
[0.6028571428571429, 0.28857142857142865, 0.03142857142857144, 0.86, 0.8314285714285713, 0.6600000000000001, 0.45999999999999985, 0.3171428571428572, 0.6599999999999999, 0.1742857142857143]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9161, 'compress@10': 0.6238, 'time@10': 8.3321}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9161, 'compress@10': 0.6238, 'time@10': 8.3321}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9401, 'compress@10': 0.4676, 'time@10': 7.7179}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9401, 'compress@10': 0.4676, 'time@10': 7.7179}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9124, 'compress@10': 0.3684, 'time@10': 6.8539}:  20%|██        | 2/10 [00:13<00:47,  5.93s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9124, 'compress@10': 0.3684, 'time@10': 6.8539}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9178, 'compress@10': 0.4925, 'time@10': 6.6003}:  30%|███       | 3/10 [00:19<00:30,  4.41s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9178, 'compress@10': 0.4925, 'time@10': 6.6003}:  40%|████      | 4/10 [00:19<00:29,  4.99s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.922, 'compress@10': 0.561, 'time@10': 7.9593}:  40%|████      | 4/10 [00:26<00:29,  4.99s/it]  {'epoch': 34, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.922, 'compress@10': 0.561, 'time@10': 7.9593}:  50%|█████     | 5/10 [00:26<00:28,  5.62s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9299, 'compress@10': 0.5787, 'time@10': 8.3134}:  50%|█████     | 5/10 [00:36<00:28,  5.62s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9299, 'compress@10': 0.5787, 'time@10': 8.3134}:  60%|██████    | 6/10 [00:36<00:28,  7.15s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.933, 'compress@10': 0.5649, 'time@10': 8.7297}:  60%|██████    | 6/10 [00:42<00:28,  7.15s/it] {'epoch': 34, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.933, 'compress@10': 0.5649, 'time@10': 8.7297}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9565, 'compress@10': 0.5363, 'time@10': 8.6232}:  70%|███████   | 7/10 [00:50<00:19,  6.66s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9565, 'compress@10': 0.5363, 'time@10': 8.6232}:  80%|████████  | 8/10 [00:50<00:14,  7.06s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.891, 'ndcg@10': 0.971, 'compress@10': 0.5512, 'time@10': 9.2269}:  80%|████████  | 8/10 [00:57<00:14,  7.06s/it]  {'epoch': 34, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.891, 'ndcg@10': 0.971, 'compress@10': 0.5512, 'time@10': 9.2269}:  90%|█████████ | 9/10 [00:57<00:07,  7.06s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9715, 'compress@10': 0.5153, 'time@10': 9.2835}:  90%|█████████ | 9/10 [01:07<00:07,  7.06s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9715, 'compress@10': 0.5153, 'time@10': 9.2835}: 100%|██████████| 10/10 [01:07<00:00,  7.92s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9715, 'compress@10': 0.5153, 'time@10': 9.2835}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.020745371984200442
Avg hit ratio: 0.8996049238443126
Avg ndcg: 0.9715056895297801
Avg compression ratio: 0.515341530106419
Avg train time: 9.283455967903137
Std train time: 2.848694773383063
[0.5861111111111111, 0.2805555555555556, 0.030555555555555565, 0.8638888888888889, 0.836111111111111, 0.6416666666666668, 0.4472222222222221, 0.3361111111111112, 0.6694444444444444, 0.19722222222222224]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9138, 'compress@10': 0.6079, 'time@10': 8.39}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9138, 'compress@10': 0.6079, 'time@10': 8.39}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9317, 'compress@10': 0.4558, 'time@10': 7.7128}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9317, 'compress@10': 0.4558, 'time@10': 7.7128}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9068, 'compress@10': 0.3602, 'time@10': 6.8976}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9068, 'compress@10': 0.3602, 'time@10': 6.8976}:  30%|███       | 3/10 [00:14<00:31,  4.44s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9178, 'compress@10': 0.4874, 'time@10': 6.6064}:  30%|███       | 3/10 [00:19<00:31,  4.44s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9178, 'compress@10': 0.4874, 'time@10': 6.6064}:  40%|████      | 4/10 [00:19<00:29,  4.97s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.923, 'compress@10': 0.5578, 'time@10': 7.9179}:  40%|████      | 4/10 [00:26<00:29,  4.97s/it] {'epoch': 35, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.923, 'compress@10': 0.5578, 'time@10': 7.9179}:  50%|█████     | 5/10 [00:26<00:27,  5.56s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9356, 'compress@10': 0.5731, 'time@10': 8.3082}:  50%|█████     | 5/10 [00:36<00:27,  5.56s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9356, 'compress@10': 0.5731, 'time@10': 8.3082}:  60%|██████    | 6/10 [00:36<00:28,  7.17s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9343, 'compress@10': 0.5583, 'time@10': 8.7361}:  60%|██████    | 6/10 [00:42<00:28,  7.17s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9343, 'compress@10': 0.5583, 'time@10': 8.7361}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0162, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9322, 'compress@10': 0.5329, 'time@10': 8.635}:  70%|███████   | 7/10 [00:50<00:20,  6.69s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0162, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9322, 'compress@10': 0.5329, 'time@10': 8.635}:  80%|████████  | 8/10 [00:50<00:14,  7.09s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9312, 'compress@10': 0.5491, 'time@10': 9.2548}:  80%|████████  | 8/10 [00:57<00:14,  7.09s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9312, 'compress@10': 0.5491, 'time@10': 9.2548}:  90%|█████████ | 9/10 [00:57<00:07,  7.11s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9337, 'compress@10': 0.5157, 'time@10': 9.3172}:  90%|█████████ | 9/10 [01:07<00:07,  7.11s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9337, 'compress@10': 0.5157, 'time@10': 9.3172}: 100%|██████████| 10/10 [01:07<00:00,  7.97s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9337, 'compress@10': 0.5157, 'time@10': 9.3172}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.017058128838250787
Avg hit ratio: 0.8964815239467192
Avg ndcg: 0.9336894041356383
Avg compression ratio: 0.5157212112642325
Avg train time: 9.31723177433014
Std train time: 2.848897912784826
[0.5702702702702703, 0.30000000000000004, 0.02972972972972974, 0.8405405405405406, 0.8135135135135134, 0.6513513513513515, 0.462162162162162, 0.35405405405405416, 0.6783783783783783, 0.1918918918918919]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9164, 'compress@10': 0.5929, 'time@10': 8.6152}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9164, 'compress@10': 0.5929, 'time@10': 8.6152}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.8769, 'ndcg@10': 1.0147, 'compress@10': 0.4577, 'time@10': 7.8486}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.8769, 'ndcg@10': 1.0147, 'compress@10': 0.4577, 'time@10': 7.8486}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0226, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9622, 'compress@10': 0.3613, 'time@10': 6.9527}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0226, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9622, 'compress@10': 0.3613, 'time@10': 6.9527}:  30%|███       | 3/10 [00:14<00:31,  4.44s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9577, 'compress@10': 0.4825, 'time@10': 6.6526}:  30%|███       | 3/10 [00:19<00:31,  4.44s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9577, 'compress@10': 0.4825, 'time@10': 6.6526}:  40%|████      | 4/10 [00:19<00:29,  4.97s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9559, 'compress@10': 0.5495, 'time@10': 8.0826}:  40%|████      | 4/10 [00:26<00:29,  4.97s/it]  {'epoch': 36, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9559, 'compress@10': 0.5495, 'time@10': 8.0826}:  50%|█████     | 5/10 [00:26<00:28,  5.68s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9606, 'compress@10': 0.5677, 'time@10': 8.4801}:  50%|█████     | 5/10 [00:37<00:28,  5.68s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9606, 'compress@10': 0.5677, 'time@10': 8.4801}:  60%|██████    | 6/10 [00:37<00:29,  7.32s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9592, 'compress@10': 0.5557, 'time@10': 8.9238}:  60%|██████    | 6/10 [00:43<00:29,  7.32s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9592, 'compress@10': 0.5557, 'time@10': 8.9238}:  70%|███████   | 7/10 [00:43<00:20,  6.83s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9638, 'compress@10': 0.5328, 'time@10': 8.7857}:  70%|███████   | 7/10 [00:51<00:20,  6.83s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9638, 'compress@10': 0.5328, 'time@10': 8.7857}:  80%|████████  | 8/10 [00:51<00:14,  7.17s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9802, 'compress@10': 0.55, 'time@10': 9.4039}:  80%|████████  | 8/10 [00:58<00:14,  7.17s/it]  {'epoch': 36, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9802, 'compress@10': 0.55, 'time@10': 9.4039}:  90%|█████████ | 9/10 [00:58<00:07,  7.18s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9795, 'compress@10': 0.516, 'time@10': 9.4341}:  90%|█████████ | 9/10 [01:07<00:07,  7.18s/it]  {'epoch': 36, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9795, 'compress@10': 0.516, 'time@10': 9.4341}: 100%|██████████| 10/10 [01:07<00:00,  7.97s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9795, 'compress@10': 0.516, 'time@10': 9.4341}: 100%|██████████| 10/10 [01:07<00:00,  6.80s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.01697071721393097
Avg hit ratio: 0.9014584824720648
Avg ndcg: 0.9795438098428721
Avg compression ratio: 0.516036921666925
Avg train time: 9.434077906608582
Std train time: 2.994184528509276
[0.5552631578947369, 0.318421052631579, 0.02894736842105264, 0.8447368421052632, 0.8184210526315788, 0.6342105263157896, 0.44999999999999984, 0.37105263157894747, 0.6868421052631578, 0.1868421052631579]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9187, 'compress@10': 0.5787, 'time@10': 8.2606}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9187, 'compress@10': 0.5787, 'time@10': 8.2606}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9381, 'compress@10': 0.4595, 'time@10': 7.6079}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9381, 'compress@10': 0.4595, 'time@10': 7.6079}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9111, 'compress@10': 0.3623, 'time@10': 6.7784}:  20%|██        | 2/10 [00:13<00:46,  5.83s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9111, 'compress@10': 0.3623, 'time@10': 6.7784}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9236, 'compress@10': 0.4843, 'time@10': 6.5191}:  30%|███       | 3/10 [00:19<00:30,  4.35s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9236, 'compress@10': 0.4843, 'time@10': 6.5191}:  40%|████      | 4/10 [00:19<00:29,  4.92s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9277, 'compress@10': 0.5518, 'time@10': 7.9196}:  40%|████      | 4/10 [00:26<00:29,  4.92s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9277, 'compress@10': 0.5518, 'time@10': 7.9196}:  50%|█████     | 5/10 [00:26<00:27,  5.59s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9427, 'compress@10': 0.5669, 'time@10': 8.3304}:  50%|█████     | 5/10 [00:36<00:27,  5.59s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9427, 'compress@10': 0.5669, 'time@10': 8.3304}:  60%|██████    | 6/10 [00:36<00:28,  7.24s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9443, 'compress@10': 0.5533, 'time@10': 8.769}:  60%|██████    | 6/10 [00:42<00:28,  7.24s/it] {'epoch': 37, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9443, 'compress@10': 0.5533, 'time@10': 8.769}:  70%|███████   | 7/10 [00:42<00:20,  6.75s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9694, 'compress@10': 0.5328, 'time@10': 8.6643}:  70%|███████   | 7/10 [00:50<00:20,  6.75s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9694, 'compress@10': 0.5328, 'time@10': 8.6643}:  80%|████████  | 8/10 [00:50<00:14,  7.13s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9649, 'compress@10': 0.5509, 'time@10': 9.2808}:  80%|████████  | 8/10 [00:57<00:14,  7.13s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9649, 'compress@10': 0.5509, 'time@10': 9.2808}:  90%|█████████ | 9/10 [00:57<00:07,  7.14s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9667, 'compress@10': 0.5164, 'time@10': 9.3502}:  90%|█████████ | 9/10 [01:07<00:07,  7.14s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9667, 'compress@10': 0.5164, 'time@10': 9.3502}: 100%|██████████| 10/10 [01:07<00:00,  8.02s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9667, 'compress@10': 0.5164, 'time@10': 9.3502}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.022428170027118104
Avg hit ratio: 0.8974851081761098
Avg ndcg: 0.9666909855385718
Avg compression ratio: 0.5163526070955202
Avg train time: 9.350181555747985
Std train time: 2.9422594030921223
[0.5410256410256411, 0.3102564102564103, 0.028205128205128212, 0.8487179487179488, 0.7974358974358973, 0.6435897435897436, 0.4384615384615383, 0.38717948717948725, 0.6948717948717947, 0.20769230769230768]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.915, 'compress@10': 0.5652, 'time@10': 8.4257}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.915, 'compress@10': 0.5652, 'time@10': 8.4257}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9316, 'compress@10': 0.4488, 'time@10': 7.7063}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9316, 'compress@10': 0.4488, 'time@10': 7.7063}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9068, 'compress@10': 0.3549, 'time@10': 6.8437}:  20%|██        | 2/10 [00:13<00:47,  5.88s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9068, 'compress@10': 0.3549, 'time@10': 6.8437}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.917, 'compress@10': 0.4797, 'time@10': 6.5491}:  30%|███       | 3/10 [00:19<00:30,  4.38s/it]  {'epoch': 38, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.917, 'compress@10': 0.4797, 'time@10': 6.5491}:  40%|████      | 4/10 [00:19<00:29,  4.90s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9238, 'compress@10': 0.5441, 'time@10': 7.956}:  40%|████      | 4/10 [00:26<00:29,  4.90s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9238, 'compress@10': 0.5441, 'time@10': 7.956}:  50%|█████     | 5/10 [00:26<00:27,  5.60s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9325, 'compress@10': 0.562, 'time@10': 8.3884}:  50%|█████     | 5/10 [00:36<00:27,  5.60s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9325, 'compress@10': 0.562, 'time@10': 8.3884}:  60%|██████    | 6/10 [00:36<00:29,  7.29s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9338, 'compress@10': 0.5475, 'time@10': 8.8296}:  60%|██████    | 6/10 [00:42<00:29,  7.29s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9338, 'compress@10': 0.5475, 'time@10': 8.8296}:  70%|███████   | 7/10 [00:42<00:20,  6.80s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9366, 'compress@10': 0.5297, 'time@10': 8.7147}:  70%|███████   | 7/10 [00:50<00:20,  6.80s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9366, 'compress@10': 0.5297, 'time@10': 8.7147}:  80%|████████  | 8/10 [00:50<00:14,  7.16s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9537, 'compress@10': 0.549, 'time@10': 9.3332}:  80%|████████  | 8/10 [00:57<00:14,  7.16s/it] {'epoch': 38, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9537, 'compress@10': 0.549, 'time@10': 9.3332}:  90%|█████████ | 9/10 [00:57<00:07,  7.17s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.956, 'compress@10': 0.5167, 'time@10': 9.3913}:  90%|█████████ | 9/10 [01:07<00:07,  7.17s/it]  {'epoch': 38, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.956, 'compress@10': 0.5167, 'time@10': 9.3913}: 100%|██████████| 10/10 [01:07<00:00,  8.03s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.956, 'compress@10': 0.5167, 'time@10': 9.3913}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.01410299276425934
Avg hit ratio: 0.8968501875411892
Avg ndcg: 0.9560121035377886
Avg compression ratio: 0.5166704750168198
Avg train time: 9.391309142112732
Std train time: 2.974914933023491
[0.5275000000000001, 0.32750000000000007, 0.027500000000000007, 0.8525, 0.8024999999999999, 0.6275000000000001, 0.45249999999999985, 0.37750000000000006, 0.7024999999999999, 0.20249999999999999]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.5524, 'time@10': 8.4404}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.5524, 'time@10': 8.4404}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9597, 'compress@10': 0.4508, 'time@10': 7.8203}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9597, 'compress@10': 0.4508, 'time@10': 7.8203}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9255, 'compress@10': 0.356, 'time@10': 6.9597}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9255, 'compress@10': 0.356, 'time@10': 6.9597}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9322, 'compress@10': 0.4814, 'time@10': 6.6779}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9322, 'compress@10': 0.4814, 'time@10': 6.6779}:  40%|████      | 4/10 [00:20<00:30,  5.03s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.936, 'compress@10': 0.5464, 'time@10': 8.0562}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it]  {'epoch': 39, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.936, 'compress@10': 0.5464, 'time@10': 8.0562}:  50%|█████     | 5/10 [00:26<00:28,  5.67s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0161, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9499, 'compress@10': 0.5613, 'time@10': 8.4438}:  50%|█████     | 5/10 [00:37<00:28,  5.67s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0161, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9499, 'compress@10': 0.5613, 'time@10': 8.4438}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9504, 'compress@10': 0.5489, 'time@10': 8.8148}:  60%|██████    | 6/10 [00:42<00:29,  7.29s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9504, 'compress@10': 0.5489, 'time@10': 8.8148}:  70%|███████   | 7/10 [00:42<00:20,  6.72s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9523, 'compress@10': 0.5297, 'time@10': 8.6994}:  70%|███████   | 7/10 [00:50<00:20,  6.72s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9523, 'compress@10': 0.5297, 'time@10': 8.6994}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9506, 'compress@10': 0.5498, 'time@10': 9.3131}:  80%|████████  | 8/10 [00:57<00:14,  7.11s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9506, 'compress@10': 0.5498, 'time@10': 9.3131}:  90%|█████████ | 9/10 [00:57<00:07,  7.12s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9533, 'compress@10': 0.5169, 'time@10': 9.3646}:  90%|█████████ | 9/10 [01:07<00:07,  7.12s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9533, 'compress@10': 0.5169, 'time@10': 9.3646}: 100%|██████████| 10/10 [01:07<00:00,  7.97s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9533, 'compress@10': 0.5169, 'time@10': 9.3646}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.013901392893553206
Avg hit ratio: 0.8827283237419061
Avg ndcg: 0.9532981991356756
Avg compression ratio: 0.5169256468672835
Avg train time: 9.36461296081543
Std train time: 2.873189399641521
[0.5146341463414635, 0.3439024390243903, 0.026829268292682933, 0.8560975609756097, 0.8073170731707315, 0.6365853658536585, 0.4414634146341462, 0.3682926829268293, 0.7097560975609755, 0.19756097560975608]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.5402, 'time@10': 8.4923}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.5402, 'time@10': 8.4923}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9883, 'compress@10': 0.4526, 'time@10': 7.8583}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9883, 'compress@10': 0.4526, 'time@10': 7.8583}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9446, 'compress@10': 0.357, 'time@10': 6.862}:  20%|██        | 2/10 [00:14<00:48,  6.04s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9446, 'compress@10': 0.357, 'time@10': 6.862}:  30%|███       | 3/10 [00:14<00:30,  4.41s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9465, 'compress@10': 0.4831, 'time@10': 6.5472}:  30%|███       | 3/10 [00:19<00:30,  4.41s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9465, 'compress@10': 0.4831, 'time@10': 6.5472}:  40%|████      | 4/10 [00:19<00:29,  4.89s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9463, 'compress@10': 0.5487, 'time@10': 7.9219}:  40%|████      | 4/10 [00:26<00:29,  4.89s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9463, 'compress@10': 0.5487, 'time@10': 7.9219}:  50%|█████     | 5/10 [00:26<00:27,  5.56s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9513, 'compress@10': 0.5647, 'time@10': 8.3245}:  50%|█████     | 5/10 [00:36<00:27,  5.56s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9513, 'compress@10': 0.5647, 'time@10': 8.3245}:  60%|██████    | 6/10 [00:36<00:28,  7.20s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.9516, 'compress@10': 0.5503, 'time@10': 8.7588}:  60%|██████    | 6/10 [00:42<00:28,  7.20s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.9516, 'compress@10': 0.5503, 'time@10': 8.7588}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9301, 'ndcg@10': 0.9703, 'compress@10': 0.5298, 'time@10': 8.6356}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9301, 'ndcg@10': 0.9703, 'compress@10': 0.5298, 'time@10': 8.6356}:  80%|████████  | 8/10 [00:50<00:14,  7.06s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9849, 'compress@10': 0.5507, 'time@10': 9.2366}:  80%|████████  | 8/10 [00:57<00:14,  7.06s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9849, 'compress@10': 0.5507, 'time@10': 9.2366}:  90%|█████████ | 9/10 [00:57<00:07,  7.06s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.919, 'ndcg@10': 0.981, 'compress@10': 0.5172, 'time@10': 9.2655}:  90%|█████████ | 9/10 [01:06<00:07,  7.06s/it]     {'epoch': 40, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.919, 'ndcg@10': 0.981, 'compress@10': 0.5172, 'time@10': 9.2655}: 100%|██████████| 10/10 [01:06<00:00,  7.83s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.919, 'ndcg@10': 0.981, 'compress@10': 0.5172, 'time@10': 9.2655}: 100%|██████████| 10/10 [01:06<00:00,  6.69s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.015863649435420804
Avg hit ratio: 0.918970003209392
Avg ndcg: 0.9810437665938976
Avg compression ratio: 0.5172133951881859
Avg train time: 9.26549427509308
Std train time: 2.923404215696183
[0.5023809523809525, 0.3595238095238096, 0.026190476190476198, 0.8357142857142857, 0.8119047619047617, 0.6214285714285714, 0.4309523809523808, 0.38333333333333336, 0.7166666666666666, 0.21666666666666665]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.5286, 'time@10': 8.3393}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.5286, 'time@10': 8.3393}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9448, 'compress@10': 0.4544, 'time@10': 7.7343}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9448, 'compress@10': 0.4544, 'time@10': 7.7343}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9156, 'compress@10': 0.358, 'time@10': 6.9535}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9156, 'compress@10': 0.358, 'time@10': 6.9535}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9251, 'compress@10': 0.4789, 'time@10': 6.7372}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9251, 'compress@10': 0.4789, 'time@10': 6.7372}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9312, 'compress@10': 0.5463, 'time@10': 8.1246}:  40%|████      | 4/10 [00:27<00:30,  5.14s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9312, 'compress@10': 0.5463, 'time@10': 8.1246}:  50%|█████     | 5/10 [00:27<00:28,  5.76s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9499, 'compress@10': 0.5602, 'time@10': 8.5275}:  50%|█████     | 5/10 [00:37<00:28,  5.76s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9499, 'compress@10': 0.5602, 'time@10': 8.5275}:  60%|██████    | 6/10 [00:37<00:29,  7.40s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9536, 'compress@10': 0.545, 'time@10': 8.9347}:  60%|██████    | 6/10 [00:43<00:29,  7.40s/it] {'epoch': 41, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9536, 'compress@10': 0.545, 'time@10': 8.9347}:  70%|███████   | 7/10 [00:43<00:20,  6.85s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9755, 'compress@10': 0.527, 'time@10': 8.818}:  70%|███████   | 7/10 [00:51<00:20,  6.85s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9755, 'compress@10': 0.527, 'time@10': 8.818}:  80%|████████  | 8/10 [00:51<00:14,  7.23s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9724, 'compress@10': 0.549, 'time@10': 9.4187}:  80%|████████  | 8/10 [00:58<00:14,  7.23s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9724, 'compress@10': 0.549, 'time@10': 9.4187}:  90%|█████████ | 9/10 [00:58<00:07,  7.20s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9729, 'compress@10': 0.5175, 'time@10': 9.4459}:  90%|█████████ | 9/10 [01:08<00:07,  7.20s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9729, 'compress@10': 0.5175, 'time@10': 9.4459}: 100%|██████████| 10/10 [01:08<00:00,  7.99s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9729, 'compress@10': 0.5175, 'time@10': 9.4459}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.014723969718574153
Avg hit ratio: 0.9043156253292077
Avg ndcg: 0.9729304699676327
Avg compression ratio: 0.5175029678241391
Avg train time: 9.445888113975524
Std train time: 2.865245710784288
[0.49069767441860473, 0.3511627906976745, 0.025581395348837216, 0.8162790697674419, 0.8162790697674417, 0.6302325581395349, 0.44418604651162774, 0.3976744186046512, 0.7232558139534883, 0.21162790697674416]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9205, 'compress@10': 0.5175, 'time@10': 8.3957}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9205, 'compress@10': 0.5175, 'time@10': 8.3957}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9441, 'compress@10': 0.4448, 'time@10': 7.6521}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it] {'epoch': 42, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9441, 'compress@10': 0.4448, 'time@10': 7.6521}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9151, 'compress@10': 0.3515, 'time@10': 6.8502}:  20%|██        | 2/10 [00:13<00:46,  5.83s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9151, 'compress@10': 0.3515, 'time@10': 6.8502}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9305, 'compress@10': 0.4693, 'time@10': 6.6665}:  30%|███       | 3/10 [00:19<00:30,  4.38s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9305, 'compress@10': 0.4693, 'time@10': 6.6665}:  40%|████      | 4/10 [00:19<00:30,  5.08s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.9264, 'ndcg@10': 0.9339, 'compress@10': 0.5394, 'time@10': 8.0857}:  40%|████      | 4/10 [00:26<00:30,  5.08s/it] {'epoch': 42, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.9264, 'ndcg@10': 0.9339, 'compress@10': 0.5394, 'time@10': 8.0857}:  50%|█████     | 5/10 [00:26<00:28,  5.74s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.935, 'ndcg@10': 0.9409, 'compress@10': 0.5559, 'time@10': 8.4671}:  50%|█████     | 5/10 [00:37<00:28,  5.74s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.935, 'ndcg@10': 0.9409, 'compress@10': 0.5559, 'time@10': 8.4671}:  60%|██████    | 6/10 [00:37<00:29,  7.33s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.9385, 'ndcg@10': 0.9417, 'compress@10': 0.5431, 'time@10': 8.85}:  60%|██████    | 6/10 [00:42<00:29,  7.33s/it] {'epoch': 42, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.9385, 'ndcg@10': 0.9417, 'compress@10': 0.5431, 'time@10': 8.85}:  70%|███████   | 7/10 [00:42<00:20,  6.77s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9427, 'ndcg@10': 0.943, 'compress@10': 0.5271, 'time@10': 8.7307}:  70%|███████   | 7/10 [00:50<00:20,  6.77s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9427, 'ndcg@10': 0.943, 'compress@10': 0.5271, 'time@10': 8.7307}:  80%|████████  | 8/10 [00:50<00:14,  7.14s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.93, 'ndcg@10': 0.9602, 'compress@10': 0.5498, 'time@10': 9.3473}:  80%|████████  | 8/10 [00:58<00:14,  7.14s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.93, 'ndcg@10': 0.9602, 'compress@10': 0.5498, 'time@10': 9.3473}:  90%|█████████ | 9/10 [00:58<00:07,  7.15s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.9347, 'ndcg@10': 0.9612, 'compress@10': 0.5178, 'time@10': 9.3797}:  90%|█████████ | 9/10 [01:07<00:07,  7.15s/it] {'epoch': 42, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.9347, 'ndcg@10': 0.9612, 'compress@10': 0.5178, 'time@10': 9.3797}: 100%|██████████| 10/10 [01:07<00:00,  7.94s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.9347, 'ndcg@10': 0.9612, 'compress@10': 0.5178, 'time@10': 9.3797}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.014814863919494464
Avg hit ratio: 0.934707330398332
Avg ndcg: 0.9611896079064982
Avg compression ratio: 0.5177616896376407
Avg train time: 9.37968294620514
Std train time: 2.905753839509417
[0.4795454545454546, 0.34318181818181825, 0.025000000000000005, 0.8204545454545455, 0.8204545454545453, 0.615909090909091, 0.4568181818181817, 0.38863636363636367, 0.7295454545454544, 0.22954545454545452]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9244, 'compress@10': 0.5069, 'time@10': 8.4825}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9244, 'compress@10': 0.5069, 'time@10': 8.4825}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9707, 'compress@10': 0.4357, 'time@10': 7.7618}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9707, 'compress@10': 0.4357, 'time@10': 7.7618}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9328, 'compress@10': 0.3452, 'time@10': 6.9561}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9328, 'compress@10': 0.3452, 'time@10': 6.9561}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.937, 'compress@10': 0.4656, 'time@10': 6.7439}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.937, 'compress@10': 0.4656, 'time@10': 6.7439}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0131, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9418, 'compress@10': 0.5373, 'time@10': 8.1105}:  40%|████      | 4/10 [00:27<00:30,  5.12s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0131, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9418, 'compress@10': 0.5373, 'time@10': 8.1105}:  50%|█████     | 5/10 [00:27<00:28,  5.74s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9475, 'compress@10': 0.5518, 'time@10': 8.5043}:  50%|█████     | 5/10 [00:37<00:28,  5.74s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9475, 'compress@10': 0.5518, 'time@10': 8.5043}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9486, 'compress@10': 0.5414, 'time@10': 8.9251}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9486, 'compress@10': 0.5414, 'time@10': 8.9251}:  70%|███████   | 7/10 [00:43<00:20,  6.84s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9569, 'compress@10': 0.5244, 'time@10': 8.7985}:  70%|███████   | 7/10 [00:51<00:20,  6.84s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9569, 'compress@10': 0.5244, 'time@10': 8.7985}:  80%|████████  | 8/10 [00:51<00:14,  7.19s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9532, 'compress@10': 0.5481, 'time@10': 9.4222}:  80%|████████  | 8/10 [00:58<00:14,  7.19s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9532, 'compress@10': 0.5481, 'time@10': 9.4222}:  90%|█████████ | 9/10 [00:58<00:07,  7.21s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9556, 'compress@10': 0.518, 'time@10': 9.4349}:  90%|█████████ | 9/10 [01:08<00:07,  7.21s/it]    {'epoch': 43, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9556, 'compress@10': 0.518, 'time@10': 9.4349}: 100%|██████████| 10/10 [01:08<00:00,  7.94s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9556, 'compress@10': 0.518, 'time@10': 9.4349}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.011219229088069417
Avg hit ratio: 0.9024620667014555
Avg ndcg: 0.9556310438119233
Avg compression ratio: 0.5179893578690462
Avg train time: 9.434927892684936
Std train time: 2.8954592874806835
[0.46888888888888897, 0.35777777777777786, 0.02444444444444445, 0.8244444444444445, 0.8244444444444443, 0.6022222222222223, 0.44666666666666655, 0.40222222222222226, 0.7355555555555554, 0.22444444444444442]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9304, 'compress@10': 0.4968, 'time@10': 8.5208}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9304, 'compress@10': 0.4968, 'time@10': 8.5208}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9713, 'compress@10': 0.4377, 'time@10': 7.7561}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9713, 'compress@10': 0.4377, 'time@10': 7.7561}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9333, 'compress@10': 0.3464, 'time@10': 6.9254}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9333, 'compress@10': 0.3464, 'time@10': 6.9254}:  30%|███       | 3/10 [00:14<00:30,  4.43s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9388, 'compress@10': 0.4675, 'time@10': 6.7249}:  30%|███       | 3/10 [00:20<00:30,  4.43s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9388, 'compress@10': 0.4675, 'time@10': 6.7249}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9417, 'compress@10': 0.5396, 'time@10': 8.1369}:  40%|████      | 4/10 [00:27<00:30,  5.12s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9417, 'compress@10': 0.5396, 'time@10': 8.1369}:  50%|█████     | 5/10 [00:27<00:28,  5.77s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.9236, 'ndcg@10': 0.9521, 'compress@10': 0.5515, 'time@10': 8.5325}:  50%|█████     | 5/10 [00:37<00:28,  5.77s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.9236, 'ndcg@10': 0.9521, 'compress@10': 0.5515, 'time@10': 8.5325}:  60%|██████    | 6/10 [00:37<00:29,  7.40s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9288, 'ndcg@10': 0.9524, 'compress@10': 0.5397, 'time@10': 8.9072}:  60%|██████    | 6/10 [00:43<00:29,  7.40s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9288, 'ndcg@10': 0.9524, 'compress@10': 0.5397, 'time@10': 8.9072}:  70%|███████   | 7/10 [00:43<00:20,  6.81s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.9342, 'ndcg@10': 0.9779, 'compress@10': 0.5246, 'time@10': 8.7876}:  70%|███████   | 7/10 [00:51<00:20,  6.81s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.9342, 'ndcg@10': 0.9779, 'compress@10': 0.5246, 'time@10': 8.7876}:  80%|████████  | 8/10 [00:51<00:14,  7.19s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9909, 'compress@10': 0.5489, 'time@10': 9.3772}:  80%|████████  | 8/10 [00:58<00:14,  7.19s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9909, 'compress@10': 0.5489, 'time@10': 9.3772}:  90%|█████████ | 9/10 [00:58<00:07,  7.15s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.9279, 'ndcg@10': 0.9889, 'compress@10': 0.5182, 'time@10': 9.4174}:  90%|█████████ | 9/10 [01:08<00:07,  7.15s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.9279, 'ndcg@10': 0.9889, 'compress@10': 0.5182, 'time@10': 9.4174}: 100%|██████████| 10/10 [01:08<00:00,  7.98s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.9279, 'ndcg@10': 0.9889, 'compress@10': 0.5182, 'time@10': 9.4174}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.018078381307104964
Avg hit ratio: 0.9279100953752906
Avg ndcg: 0.9888956838898839
Avg compression ratio: 0.5182135493358376
Avg train time: 9.417426490783692
Std train time: 2.8677037524624494
[0.4586956521739131, 0.3717391304347827, 0.023913043478260874, 0.8065217391304349, 0.8065217391304347, 0.6108695652173914, 0.4369565217391303, 0.41521739130434787, 0.7413043478260868, 0.24130434782608692]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.933, 'compress@10': 0.4872, 'time@10': 8.4202}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.933, 'compress@10': 0.4872, 'time@10': 8.4202}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9429, 'compress@10': 0.4396, 'time@10': 7.7862}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9429, 'compress@10': 0.4396, 'time@10': 7.7862}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9143, 'compress@10': 0.3475, 'time@10': 6.9769}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9143, 'compress@10': 0.3475, 'time@10': 6.9769}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.926, 'compress@10': 0.464, 'time@10': 6.7748}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.926, 'compress@10': 0.464, 'time@10': 6.7748}:  40%|████      | 4/10 [00:20<00:30,  5.17s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9325, 'compress@10': 0.5333, 'time@10': 8.1552}:  40%|████      | 4/10 [00:27<00:30,  5.17s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9325, 'compress@10': 0.5333, 'time@10': 8.1552}:  50%|█████     | 5/10 [00:27<00:28,  5.78s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9399, 'compress@10': 0.5476, 'time@10': 8.5055}:  50%|█████     | 5/10 [00:37<00:28,  5.78s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9399, 'compress@10': 0.5476, 'time@10': 8.5055}:  60%|██████    | 6/10 [00:37<00:29,  7.32s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.01, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9469, 'compress@10': 0.535, 'time@10': 8.9186}:  60%|██████    | 6/10 [00:43<00:29,  7.32s/it]   {'epoch': 45, 'num_users': 6.2857, 'loss': 0.01, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9469, 'compress@10': 0.535, 'time@10': 8.9186}:  70%|███████   | 7/10 [00:43<00:20,  6.80s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9515, 'compress@10': 0.5222, 'time@10': 8.7885}:  70%|███████   | 7/10 [00:51<00:20,  6.80s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9515, 'compress@10': 0.5222, 'time@10': 8.7885}:  80%|████████  | 8/10 [00:51<00:14,  7.15s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9515, 'compress@10': 0.5473, 'time@10': 9.3954}:  80%|████████  | 8/10 [00:58<00:14,  7.15s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9515, 'compress@10': 0.5473, 'time@10': 9.3954}:  90%|█████████ | 9/10 [00:58<00:07,  7.17s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9541, 'compress@10': 0.5185, 'time@10': 9.4448}:  90%|█████████ | 9/10 [01:08<00:07,  7.17s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9541, 'compress@10': 0.5185, 'time@10': 9.4448}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9541, 'compress@10': 0.5185, 'time@10': 9.4448}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.010075384680010216
Avg hit ratio: 0.9159930446840464
Avg ndcg: 0.9540840912321602
Avg compression ratio: 0.5184512956714927
Avg train time: 9.444790577888488
Std train time: 2.8613235402667554
[0.44893617021276605, 0.38510638297872346, 0.02340425531914894, 0.7893617021276597, 0.8106382978723403, 0.5978723404255321, 0.44893617021276583, 0.42765957446808517, 0.7468085106382977, 0.23617021276595743]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9304, 'compress@10': 0.4779, 'time@10': 8.4702}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9304, 'compress@10': 0.4779, 'time@10': 8.4702}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9617, 'compress@10': 0.4414, 'time@10': 7.8028}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it] {'epoch': 46, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9617, 'compress@10': 0.4414, 'time@10': 7.8028}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9268, 'compress@10': 0.3486, 'time@10': 7.0266}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9268, 'compress@10': 0.3486, 'time@10': 7.0266}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9375, 'compress@10': 0.4607, 'time@10': 6.8134}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9375, 'compress@10': 0.4607, 'time@10': 6.8134}:  40%|████      | 4/10 [00:20<00:31,  5.19s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9415, 'compress@10': 0.5314, 'time@10': 8.2024}:  40%|████      | 4/10 [00:27<00:31,  5.19s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9415, 'compress@10': 0.5314, 'time@10': 8.2024}:  50%|█████     | 5/10 [00:27<00:29,  5.81s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9468, 'compress@10': 0.544, 'time@10': 8.5551}:  50%|█████     | 5/10 [00:37<00:29,  5.81s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9468, 'compress@10': 0.544, 'time@10': 8.5551}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.948, 'compress@10': 0.5336, 'time@10': 8.9344}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.948, 'compress@10': 0.5336, 'time@10': 8.9344}:  70%|███████   | 7/10 [00:43<00:20,  6.80s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9502, 'compress@10': 0.5224, 'time@10': 8.7937}:  70%|███████   | 7/10 [00:51<00:20,  6.80s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9502, 'compress@10': 0.5224, 'time@10': 8.7937}:  80%|████████  | 8/10 [00:51<00:14,  7.13s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9687, 'compress@10': 0.5481, 'time@10': 9.4351}:  80%|████████  | 8/10 [00:58<00:14,  7.13s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9687, 'compress@10': 0.5481, 'time@10': 9.4351}:  90%|█████████ | 9/10 [00:58<00:07,  7.19s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9659, 'compress@10': 0.5186, 'time@10': 9.4913}:  90%|█████████ | 9/10 [01:08<00:07,  7.19s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9659, 'compress@10': 0.5186, 'time@10': 9.4913}: 100%|██████████| 10/10 [01:08<00:00,  8.07s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9659, 'compress@10': 0.5186, 'time@10': 9.4913}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.014126314703069806
Avg hit ratio: 0.905096987336376
Avg ndcg: 0.9659425496009616
Avg compression ratio: 0.5186450616124718
Avg train time: 9.491341519355775
Std train time: 2.9055312164613403
[0.43958333333333344, 0.3979166666666667, 0.02291666666666667, 0.7937500000000001, 0.7937499999999998, 0.6062500000000002, 0.4395833333333332, 0.41875000000000007, 0.7520833333333331, 0.2520833333333333]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9379, 'compress@10': 0.4691, 'time@10': 8.4257}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9379, 'compress@10': 0.4691, 'time@10': 8.4257}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9757, 'compress@10': 0.4432, 'time@10': 7.7973}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]  {'epoch': 47, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9757, 'compress@10': 0.4432, 'time@10': 7.7973}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9362, 'compress@10': 0.3496, 'time@10': 6.9781}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9362, 'compress@10': 0.3496, 'time@10': 6.9781}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9416, 'compress@10': 0.4625, 'time@10': 6.7837}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9416, 'compress@10': 0.4625, 'time@10': 6.7837}:  40%|████      | 4/10 [00:20<00:31,  5.19s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9454, 'compress@10': 0.5296, 'time@10': 8.1297}:  40%|████      | 4/10 [00:27<00:31,  5.19s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9454, 'compress@10': 0.5296, 'time@10': 8.1297}:  50%|█████     | 5/10 [00:27<00:28,  5.77s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9505, 'compress@10': 0.5438, 'time@10': 8.4984}:  50%|█████     | 5/10 [00:37<00:28,  5.77s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9505, 'compress@10': 0.5438, 'time@10': 8.4984}:  60%|██████    | 6/10 [00:37<00:29,  7.33s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9516, 'compress@10': 0.5321, 'time@10': 8.9026}:  60%|██████    | 6/10 [00:43<00:29,  7.33s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9516, 'compress@10': 0.5321, 'time@10': 8.9026}:  70%|███████   | 7/10 [00:43<00:20,  6.80s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9532, 'compress@10': 0.52, 'time@10': 8.76}:  70%|███████   | 7/10 [00:51<00:20,  6.80s/it]     {'epoch': 47, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9532, 'compress@10': 0.52, 'time@10': 8.76}:  80%|████████  | 8/10 [00:51<00:14,  7.12s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9496, 'compress@10': 0.5466, 'time@10': 9.3525}:  80%|████████  | 8/10 [00:58<00:14,  7.12s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9496, 'compress@10': 0.5466, 'time@10': 9.3525}:  90%|█████████ | 9/10 [00:58<00:07,  7.11s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9527, 'compress@10': 0.5188, 'time@10': 9.3911}:  90%|█████████ | 9/10 [01:07<00:07,  7.11s/it]  {'epoch': 47, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9527, 'compress@10': 0.5188, 'time@10': 9.3911}: 100%|██████████| 10/10 [01:07<00:00,  7.93s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9527, 'compress@10': 0.5188, 'time@10': 9.3911}: 100%|██████████| 10/10 [01:07<00:00,  6.80s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.012889591159985744
Avg hit ratio: 0.9066842889236778
Avg ndcg: 0.9527196278584101
Avg compression ratio: 0.5188472381918408
Avg train time: 9.391078877449036
Std train time: 2.8104230838114352
[0.4306122448979593, 0.4102040816326531, 0.022448979591836737, 0.7979591836734694, 0.7775510204081632, 0.6142857142857144, 0.4306122448979591, 0.41020408163265315, 0.7571428571428569, 0.2673469387755102]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.94, 'compress@10': 0.4606, 'time@10': 8.3817}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.94, 'compress@10': 0.4606, 'time@10': 8.3817}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9539, 'compress@10': 0.4449, 'time@10': 7.5732}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9539, 'compress@10': 0.4449, 'time@10': 7.5732}:  20%|██        | 2/10 [00:11<00:45,  5.75s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0041, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9216, 'compress@10': 0.3506, 'time@10': 6.7223}:  20%|██        | 2/10 [00:13<00:45,  5.75s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0041, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9216, 'compress@10': 0.3506, 'time@10': 6.7223}:  30%|███       | 3/10 [00:13<00:29,  4.28s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.931, 'compress@10': 0.4643, 'time@10': 6.5578}:  30%|███       | 3/10 [00:19<00:29,  4.28s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.931, 'compress@10': 0.4643, 'time@10': 6.5578}:  40%|████      | 4/10 [00:19<00:30,  5.01s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0072, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9375, 'compress@10': 0.5278, 'time@10': 7.8872}:  40%|████      | 4/10 [00:26<00:30,  5.01s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0072, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9375, 'compress@10': 0.5278, 'time@10': 7.8872}:  50%|█████     | 5/10 [00:26<00:27,  5.59s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.944, 'compress@10': 0.5437, 'time@10': 8.285}:  50%|█████     | 5/10 [00:36<00:27,  5.59s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.944, 'compress@10': 0.5437, 'time@10': 8.285}:  60%|██████    | 6/10 [00:36<00:28,  7.20s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9457, 'compress@10': 0.5308, 'time@10': 8.7094}:  60%|██████    | 6/10 [00:42<00:28,  7.20s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9457, 'compress@10': 0.5308, 'time@10': 8.7094}:  70%|███████   | 7/10 [00:42<00:20,  6.70s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9517, 'compress@10': 0.5178, 'time@10': 8.575}:  70%|███████   | 7/10 [00:49<00:20,  6.70s/it]  {'epoch': 48, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9517, 'compress@10': 0.5178, 'time@10': 8.575}:  80%|████████  | 8/10 [00:49<00:14,  7.01s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0102, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9703, 'compress@10': 0.5452, 'time@10': 9.162}:  80%|████████  | 8/10 [00:56<00:14,  7.01s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0102, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9703, 'compress@10': 0.5452, 'time@10': 9.162}:  90%|█████████ | 9/10 [00:56<00:06,  7.00s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9691, 'compress@10': 0.519, 'time@10': 9.2098}:  90%|█████████ | 9/10 [01:06<00:06,  7.00s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9691, 'compress@10': 0.519, 'time@10': 9.2098}: 100%|██████████| 10/10 [01:06<00:00,  7.83s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9691, 'compress@10': 0.519, 'time@10': 9.2098}: 100%|██████████| 10/10 [01:06<00:00,  6.66s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.01183132184098836
Avg hit ratio: 0.9131359018269036
Avg ndcg: 0.9691423743951647
Avg compression ratio: 0.5190432285770291
Avg train time: 9.209768199920655
Std train time: 2.8223700120230237
[0.4220000000000001, 0.402, 0.022000000000000002, 0.802, 0.7819999999999999, 0.6220000000000001, 0.4219999999999999, 0.4020000000000001, 0.7619999999999998, 0.282]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9379, 'compress@10': 0.4524, 'time@10': 8.2345}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9379, 'compress@10': 0.4524, 'time@10': 8.2345}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9528, 'compress@10': 0.4369, 'time@10': 7.5841}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9528, 'compress@10': 0.4369, 'time@10': 7.5841}:  20%|██        | 2/10 [00:11<00:46,  5.82s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9209, 'compress@10': 0.3451, 'time@10': 6.7389}:  20%|██        | 2/10 [00:13<00:46,  5.82s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9209, 'compress@10': 0.3451, 'time@10': 6.7389}:  30%|███       | 3/10 [00:13<00:30,  4.33s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9305, 'compress@10': 0.4611, 'time@10': 6.5611}:  30%|███       | 3/10 [00:19<00:30,  4.33s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9305, 'compress@10': 0.4611, 'time@10': 6.5611}:  40%|████      | 4/10 [00:19<00:30,  5.01s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0083, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9374, 'compress@10': 0.5262, 'time@10': 7.9171}:  40%|████      | 4/10 [00:26<00:30,  5.01s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0083, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9374, 'compress@10': 0.5262, 'time@10': 7.9171}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9455, 'compress@10': 0.5435, 'time@10': 8.3203}:  50%|█████     | 5/10 [00:36<00:28,  5.63s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9455, 'compress@10': 0.5435, 'time@10': 8.3203}:  60%|██████    | 6/10 [00:36<00:28,  7.24s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9469, 'compress@10': 0.5295, 'time@10': 8.7314}:  60%|██████    | 6/10 [00:42<00:28,  7.24s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9469, 'compress@10': 0.5295, 'time@10': 8.7314}:  70%|███████   | 7/10 [00:42<00:20,  6.72s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9289, 'ndcg@10': 0.9454, 'compress@10': 0.5157, 'time@10': 8.6061}:  70%|███████   | 7/10 [00:50<00:20,  6.72s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9289, 'ndcg@10': 0.9454, 'compress@10': 0.5157, 'time@10': 8.6061}:  80%|████████  | 8/10 [00:50<00:14,  7.05s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9447, 'compress@10': 0.5438, 'time@10': 9.1183}:  80%|████████  | 8/10 [00:56<00:14,  7.05s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9447, 'compress@10': 0.5438, 'time@10': 9.1183}:  90%|█████████ | 9/10 [00:56<00:06,  6.92s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.918, 'ndcg@10': 0.948, 'compress@10': 0.5193, 'time@10': 9.1238}:  90%|█████████ | 9/10 [01:06<00:06,  6.92s/it]     {'epoch': 49, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.918, 'ndcg@10': 0.948, 'compress@10': 0.5193, 'time@10': 9.1238}: 100%|██████████| 10/10 [01:06<00:00,  7.63s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.918, 'ndcg@10': 0.948, 'compress@10': 0.5193, 'time@10': 9.1238}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.012182785128688835
Avg hit ratio: 0.9179735874387827
Avg ndcg: 0.947956815357694
Avg compression ratio: 0.5192562327737701
Avg train time: 9.123844170570374
Std train time: 2.7209251189389407
[0.4137254901960785, 0.3941176470588236, 0.021568627450980395, 0.7862745098039217, 0.7862745098039214, 0.6294117647058824, 0.43333333333333324, 0.4137254901960785, 0.7666666666666665, 0.2764705882352941]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
