  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2318, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.471, 'compress@10': 0.0535, 'time@10': 6.1129}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2318, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.471, 'compress@10': 0.0535, 'time@10': 6.1129}:  10%|█         | 1/10 [00:03<00:27,  3.10s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1653, 'hit_ratio@10': 0.5229, 'ndcg@10': 0.5385, 'compress@10': 0.0433, 'time@10': 5.1435}:  10%|█         | 1/10 [00:07<00:27,  3.10s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1653, 'hit_ratio@10': 0.5229, 'ndcg@10': 0.5385, 'compress@10': 0.0433, 'time@10': 5.1435}:  20%|██        | 2/10 [00:07<00:30,  3.76s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9326, 'hit_ratio@10': 0.4439, 'ndcg@10': 0.359, 'compress@10': 0.0767, 'time@10': 3.9732}:  20%|██        | 2/10 [00:08<00:30,  3.76s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.9326, 'hit_ratio@10': 0.4439, 'ndcg@10': 0.359, 'compress@10': 0.0767, 'time@10': 3.9732}:  30%|███       | 3/10 [00:08<00:17,  2.43s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.736, 'hit_ratio@10': 0.5025, 'ndcg@10': 0.4051, 'compress@10': 0.0667, 'time@10': 3.9167}:  30%|███       | 3/10 [00:11<00:17,  2.43s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.736, 'hit_ratio@10': 0.5025, 'ndcg@10': 0.4051, 'compress@10': 0.0667, 'time@10': 3.9167}:  40%|████      | 4/10 [00:11<00:17,  2.97s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.6079, 'hit_ratio@10': 0.566, 'ndcg@10': 0.4722, 'compress@10': 0.0574, 'time@10': 5.8634}:  40%|████      | 4/10 [00:18<00:17,  2.97s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.6079, 'hit_ratio@10': 0.566, 'ndcg@10': 0.4722, 'compress@10': 0.0574, 'time@10': 5.8634}:  50%|█████     | 5/10 [00:18<00:21,  4.38s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5221, 'hit_ratio@10': 0.5902, 'ndcg@10': 0.5177, 'compress@10': 0.0517, 'time@10': 5.9023}:  50%|█████     | 5/10 [00:24<00:21,  4.38s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5221, 'hit_ratio@10': 0.5902, 'ndcg@10': 0.5177, 'compress@10': 0.0517, 'time@10': 5.9023}:  60%|██████    | 6/10 [00:24<00:19,  4.98s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4689, 'hit_ratio@10': 0.5916, 'ndcg@10': 0.5196, 'compress@10': 0.0501, 'time@10': 5.9999}:  60%|██████    | 6/10 [00:28<00:19,  4.98s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4689, 'hit_ratio@10': 0.5916, 'ndcg@10': 0.5196, 'compress@10': 0.0501, 'time@10': 5.9999}:  70%|███████   | 7/10 [00:28<00:13,  4.44s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.4185, 'hit_ratio@10': 0.6319, 'ndcg@10': 0.5398, 'compress@10': 0.0475, 'time@10': 5.8379}:  70%|███████   | 7/10 [00:33<00:13,  4.44s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.4185, 'hit_ratio@10': 0.6319, 'ndcg@10': 0.5398, 'compress@10': 0.0475, 'time@10': 5.8379}:  80%|████████  | 8/10 [00:33<00:09,  4.53s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3803, 'hit_ratio@10': 0.6538, 'ndcg@10': 0.5779, 'compress@10': 0.0455, 'time@10': 6.2367}:  80%|████████  | 8/10 [00:37<00:09,  4.53s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3803, 'hit_ratio@10': 0.6538, 'ndcg@10': 0.5779, 'compress@10': 0.0455, 'time@10': 6.2367}:  90%|█████████ | 9/10 [00:37<00:04,  4.60s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3481, 'hit_ratio@10': 0.6816, 'ndcg@10': 0.5999, 'compress@10': 0.0433, 'time@10': 6.1929}:  90%|█████████ | 9/10 [00:43<00:04,  4.60s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3481, 'hit_ratio@10': 0.6816, 'ndcg@10': 0.5999, 'compress@10': 0.0433, 'time@10': 6.1929}: 100%|██████████| 10/10 [00:43<00:00,  4.99s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3481, 'hit_ratio@10': 0.6816, 'ndcg@10': 0.5999, 'compress@10': 0.0433, 'time@10': 6.1929}: 100%|██████████| 10/10 [00:43<00:00,  4.37s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3480620379900975
Avg hit ratio: 0.6815912557542438
Avg ndcg: 0.5998717193706982
Avg compression ratio: 0.04326776533601146
Avg train time: 6.192893719673156
Std train time: 3.1539752860272903
[0.55, 0.55, 0.55, 0.55, 0.05, 0.05, 0.55, 0.05, 0.05, 0.05]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0599, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.802, 'compress@10': 0.8033, 'time@10': 4.93}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0599, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.802, 'compress@10': 0.8033, 'time@10': 4.93}:  10%|█         | 1/10 [00:02<00:22,  2.50s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.057, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8327, 'compress@10': 0.7881, 'time@10': 4.5421}:  10%|█         | 1/10 [00:06<00:22,  2.50s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.057, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8327, 'compress@10': 0.7881, 'time@10': 4.5421}:  20%|██        | 2/10 [00:06<00:27,  3.50s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0515, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.7922, 'compress@10': 0.7744, 'time@10': 3.6194}:  20%|██        | 2/10 [00:07<00:27,  3.50s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0515, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.7922, 'compress@10': 0.7744, 'time@10': 3.6194}:  30%|███       | 3/10 [00:07<00:16,  2.32s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0513, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8051, 'compress@10': 0.7645, 'time@10': 3.6305}:  30%|███       | 3/10 [00:11<00:16,  2.32s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0513, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8051, 'compress@10': 0.7645, 'time@10': 3.6305}:  40%|████      | 4/10 [00:11<00:17,  2.87s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0585, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8008, 'compress@10': 0.6157, 'time@10': 5.3858}:  40%|████      | 4/10 [00:17<00:17,  2.87s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0585, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8008, 'compress@10': 0.6157, 'time@10': 5.3858}:  50%|█████     | 5/10 [00:17<00:20,  4.09s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0617, 'hit_ratio@10': 0.7786, 'ndcg@10': 0.8028, 'compress@10': 0.5168, 'time@10': 5.5178}:  50%|█████     | 5/10 [00:23<00:20,  4.09s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0617, 'hit_ratio@10': 0.7786, 'ndcg@10': 0.8028, 'compress@10': 0.5168, 'time@10': 5.5178}:  60%|██████    | 6/10 [00:23<00:19,  4.81s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0595, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.8122, 'compress@10': 0.5466, 'time@10': 5.6828}:  60%|██████    | 6/10 [00:27<00:19,  4.81s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0595, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.8122, 'compress@10': 0.5466, 'time@10': 5.6828}:  70%|███████   | 7/10 [00:27<00:13,  4.34s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0567, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.82, 'compress@10': 0.4819, 'time@10': 5.5417}:  70%|███████   | 7/10 [00:31<00:13,  4.34s/it]   {'epoch': 1, 'num_users': 6.125, 'loss': 0.0567, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.82, 'compress@10': 0.4819, 'time@10': 5.5417}:  80%|████████  | 8/10 [00:31<00:08,  4.42s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0544, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8311, 'compress@10': 0.4315, 'time@10': 5.8737}:  80%|████████  | 8/10 [00:36<00:08,  4.42s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0544, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8311, 'compress@10': 0.4315, 'time@10': 5.8737}:  90%|█████████ | 9/10 [00:36<00:04,  4.38s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0537, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8329, 'compress@10': 0.3906, 'time@10': 5.8605}:  90%|█████████ | 9/10 [00:41<00:04,  4.38s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0537, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8329, 'compress@10': 0.3906, 'time@10': 5.8605}: 100%|██████████| 10/10 [00:41<00:00,  4.82s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0537, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8329, 'compress@10': 0.3906, 'time@10': 5.8605}: 100%|██████████| 10/10 [00:41<00:00,  4.18s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05366117779196664
Avg hit ratio: 0.8191901454516056
Avg ndcg: 0.832922098690068
Avg compression ratio: 0.390647347951182
Avg train time: 5.860510849952698
Std train time: 2.7886805048968
[0.7000000000000001, 0.7000000000000001, 0.3666666666666667, 0.7000000000000001, 0.36666666666666664, 0.36666666666666664, 0.3666666666666667, 0.03333333333333334, 0.03333333333333334, 0.03333333333333334]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8427, 'compress@10': 0.9832, 'time@10': 4.8927}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8427, 'compress@10': 0.9832, 'time@10': 4.8927}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8463, 'compress@10': 0.9839, 'time@10': 4.5387}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8463, 'compress@10': 0.9839, 'time@10': 4.5387}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8478, 'compress@10': 0.7187, 'time@10': 3.6924}:  20%|██        | 2/10 [00:07<00:28,  3.51s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8478, 'compress@10': 0.7187, 'time@10': 3.6924}:  30%|███       | 3/10 [00:07<00:16,  2.39s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0393, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8485, 'compress@10': 0.7837, 'time@10': 3.7089}:  30%|███       | 3/10 [00:11<00:16,  2.39s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0393, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8485, 'compress@10': 0.7837, 'time@10': 3.7089}:  40%|████      | 4/10 [00:11<00:17,  2.94s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0489, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8359, 'compress@10': 0.6442, 'time@10': 5.1525}:  40%|████      | 4/10 [00:17<00:17,  2.94s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0489, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8359, 'compress@10': 0.6442, 'time@10': 5.1525}:  50%|█████     | 5/10 [00:17<00:19,  3.87s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0533, 'hit_ratio@10': 0.7907, 'ndcg@10': 0.8326, 'compress@10': 0.5515, 'time@10': 5.3302}:  50%|█████     | 5/10 [00:23<00:19,  3.87s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0533, 'hit_ratio@10': 0.7907, 'ndcg@10': 0.8326, 'compress@10': 0.5515, 'time@10': 5.3302}:  60%|██████    | 6/10 [00:23<00:18,  4.68s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0516, 'hit_ratio@10': 0.8149, 'ndcg@10': 0.8374, 'compress@10': 0.4861, 'time@10': 5.5185}:  60%|██████    | 6/10 [00:26<00:18,  4.68s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0516, 'hit_ratio@10': 0.8149, 'ndcg@10': 0.8374, 'compress@10': 0.4861, 'time@10': 5.5185}:  70%|███████   | 7/10 [00:26<00:12,  4.25s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.837, 'compress@10': 0.4289, 'time@10': 5.4159}:  70%|███████   | 7/10 [00:31<00:12,  4.25s/it]   {'epoch': 2, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.837, 'compress@10': 0.4289, 'time@10': 5.4159}:  80%|████████  | 8/10 [00:31<00:08,  4.40s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8468, 'compress@10': 0.3844, 'time@10': 5.7616}:  80%|████████  | 8/10 [00:35<00:08,  4.40s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8468, 'compress@10': 0.3844, 'time@10': 5.7616}:  90%|█████████ | 9/10 [00:35<00:04,  4.38s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8474, 'compress@10': 0.3483, 'time@10': 5.7517}:  90%|█████████ | 9/10 [00:41<00:04,  4.38s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8474, 'compress@10': 0.3483, 'time@10': 5.7517}: 100%|██████████| 10/10 [00:41<00:00,  4.79s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8474, 'compress@10': 0.3483, 'time@10': 5.7517}: 100%|██████████| 10/10 [00:41<00:00,  4.14s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04891139459258724
Avg hit ratio: 0.8293104462034853
Avg ndcg: 0.8473844705737728
Avg compression ratio: 0.3482828253530627
Avg train time: 5.751686000823975
Std train time: 2.4056966785643104
[0.775, 0.775, 0.275, 0.775, 0.5249999999999999, 0.5249999999999999, 0.275, 0.025000000000000005, 0.025000000000000005, 0.025000000000000005]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.995, 'time@10': 4.9414}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.995, 'time@10': 4.9414}:  10%|█         | 1/10 [00:02<00:22,  2.51s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8463, 'compress@10': 0.9951, 'time@10': 4.5552}:  10%|█         | 1/10 [00:06<00:22,  2.51s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8463, 'compress@10': 0.9951, 'time@10': 4.5552}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8499, 'compress@10': 0.7147, 'time@10': 3.7424}:  20%|██        | 2/10 [00:07<00:28,  3.51s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8499, 'compress@10': 0.7147, 'time@10': 3.7424}:  30%|███       | 3/10 [00:07<00:16,  2.41s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8476, 'compress@10': 0.7845, 'time@10': 3.7387}:  30%|███       | 3/10 [00:11<00:16,  2.41s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8476, 'compress@10': 0.7845, 'time@10': 3.7387}:  40%|████      | 4/10 [00:11<00:17,  2.94s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8365, 'compress@10': 0.7429, 'time@10': 4.8601}:  40%|████      | 4/10 [00:16<00:17,  2.94s/it]   {'epoch': 3, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8365, 'compress@10': 0.7429, 'time@10': 4.8601}:  50%|█████     | 5/10 [00:16<00:17,  3.59s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0511, 'hit_ratio@10': 0.7834, 'ndcg@10': 0.8344, 'compress@10': 0.7417, 'time@10': 5.072}:  50%|█████     | 5/10 [00:22<00:17,  3.59s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0511, 'hit_ratio@10': 0.7834, 'ndcg@10': 0.8344, 'compress@10': 0.7417, 'time@10': 5.072}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.8029, 'ndcg@10': 0.8415, 'compress@10': 0.643, 'time@10': 5.3046}:  60%|██████    | 6/10 [00:25<00:17,  4.47s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.8029, 'ndcg@10': 0.8415, 'compress@10': 0.643, 'time@10': 5.3046}:  70%|███████   | 7/10 [00:25<00:12,  4.12s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0509, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8411, 'compress@10': 0.5662, 'time@10': 5.2265}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0509, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8411, 'compress@10': 0.5662, 'time@10': 5.2265}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0498, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.85, 'compress@10': 0.5065, 'time@10': 5.5844}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it] {'epoch': 3, 'num_users': 6.3333, 'loss': 0.0498, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.85, 'compress@10': 0.5065, 'time@10': 5.5844}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8505, 'compress@10': 0.4581, 'time@10': 5.5859}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it] {'epoch': 3, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8505, 'compress@10': 0.4581, 'time@10': 5.5859}: 100%|██████████| 10/10 [00:40<00:00,  4.71s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8505, 'compress@10': 0.4581, 'time@10': 5.5859}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.0494075451802639
Avg hit ratio: 0.8237743478931934
Avg ndcg: 0.8505216090176895
Avg compression ratio: 0.4581199231977159
Avg train time: 5.585853934288025
Std train time: 2.0638458884764277
[0.62, 0.8200000000000001, 0.22000000000000003, 0.8200000000000001, 0.6199999999999999, 0.6199999999999999, 0.22000000000000003, 0.22, 0.020000000000000004, 0.020000000000000004]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.9242, 'time@10': 4.4726}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.9242, 'time@10': 4.4726}:  10%|█         | 1/10 [00:02<00:20,  2.27s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8612, 'compress@10': 0.9609, 'time@10': 4.3212}:  10%|█         | 1/10 [00:06<00:20,  2.27s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8612, 'compress@10': 0.9609, 'time@10': 4.3212}:  20%|██        | 2/10 [00:06<00:27,  3.41s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8598, 'compress@10': 0.6899, 'time@10': 3.6419}:  20%|██        | 2/10 [00:07<00:27,  3.41s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8598, 'compress@10': 0.6899, 'time@10': 3.6419}:  30%|███       | 3/10 [00:07<00:16,  2.41s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8587, 'compress@10': 0.7666, 'time@10': 3.6674}:  30%|███       | 3/10 [00:11<00:16,  2.41s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8587, 'compress@10': 0.7666, 'time@10': 3.6674}:  40%|████      | 4/10 [00:11<00:17,  2.95s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8438, 'compress@10': 0.7981, 'time@10': 4.5682}:  40%|████      | 4/10 [00:15<00:17,  2.95s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8438, 'compress@10': 0.7981, 'time@10': 4.5682}:  50%|█████     | 5/10 [00:15<00:16,  3.37s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0506, 'hit_ratio@10': 0.7924, 'ndcg@10': 0.8406, 'compress@10': 0.8222, 'time@10': 4.8336}:  50%|█████     | 5/10 [00:21<00:16,  3.37s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0506, 'hit_ratio@10': 0.7924, 'ndcg@10': 0.8406, 'compress@10': 0.8222, 'time@10': 4.8336}:  60%|██████    | 6/10 [00:21<00:17,  4.34s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.842, 'compress@10': 0.7111, 'time@10': 5.0877}:  60%|██████    | 6/10 [00:25<00:17,  4.34s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.842, 'compress@10': 0.7111, 'time@10': 5.0877}:  70%|███████   | 7/10 [00:25<00:12,  4.01s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8385, 'compress@10': 0.6262, 'time@10': 5.036}:  70%|███████   | 7/10 [00:29<00:12,  4.01s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8385, 'compress@10': 0.6262, 'time@10': 5.036}:  80%|████████  | 8/10 [00:29<00:08,  4.24s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0497, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8481, 'compress@10': 0.5598, 'time@10': 5.4483}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0497, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8481, 'compress@10': 0.5598, 'time@10': 5.4483}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.849, 'compress@10': 0.5061, 'time@10': 5.466}:  90%|█████████ | 9/10 [00:39<00:04,  4.29s/it]     {'epoch': 4, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.849, 'compress@10': 0.5061, 'time@10': 5.466}: 100%|██████████| 10/10 [00:39<00:00,  4.71s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.849, 'compress@10': 0.5061, 'time@10': 5.466}: 100%|██████████| 10/10 [00:39<00:00,  3.99s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.049273922154452934
Avg hit ratio: 0.8303652337098857
Avg ndcg: 0.8489719973381451
Avg compression ratio: 0.5061295213729025
Avg train time: 5.465969777107238
Std train time: 1.9050823842329871
[0.5166666666666666, 0.8500000000000001, 0.18333333333333335, 0.8500000000000001, 0.6833333333333332, 0.6833333333333332, 0.18333333333333335, 0.35, 0.01666666666666667, 0.01666666666666667]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.051, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8434, 'compress@10': 0.6443, 'time@10': 4.5828}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.051, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8434, 'compress@10': 0.6443, 'time@10': 4.5828}:  10%|█         | 1/10 [00:02<00:20,  2.33s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8472, 'compress@10': 0.8214, 'time@10': 4.3598}:  10%|█         | 1/10 [00:06<00:20,  2.33s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8472, 'compress@10': 0.8214, 'time@10': 4.3598}:  20%|██        | 2/10 [00:06<00:27,  3.42s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8505, 'compress@10': 0.5961, 'time@10': 3.717}:  20%|██        | 2/10 [00:07<00:27,  3.42s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8505, 'compress@10': 0.5961, 'time@10': 3.717}:  30%|███       | 3/10 [00:07<00:16,  2.43s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.774, 'ndcg@10': 0.8505, 'compress@10': 0.6967, 'time@10': 3.7183}:  30%|███       | 3/10 [00:11<00:16,  2.43s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.774, 'ndcg@10': 0.8505, 'compress@10': 0.6967, 'time@10': 3.7183}:  40%|████      | 4/10 [00:11<00:17,  2.95s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.7872, 'ndcg@10': 0.837, 'compress@10': 0.7517, 'time@10': 4.6035}:  40%|████      | 4/10 [00:15<00:17,  2.95s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.7872, 'ndcg@10': 0.837, 'compress@10': 0.7517, 'time@10': 4.6035}:  50%|█████     | 5/10 [00:15<00:16,  3.37s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0497, 'hit_ratio@10': 0.7893, 'ndcg@10': 0.8369, 'compress@10': 0.7896, 'time@10': 4.862}:  50%|█████     | 5/10 [00:21<00:16,  3.37s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0497, 'hit_ratio@10': 0.7893, 'ndcg@10': 0.8369, 'compress@10': 0.7896, 'time@10': 4.862}:  60%|██████    | 6/10 [00:21<00:17,  4.33s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0498, 'hit_ratio@10': 0.8137, 'ndcg@10': 0.8417, 'compress@10': 0.6829, 'time@10': 5.1112}:  60%|██████    | 6/10 [00:25<00:17,  4.33s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0498, 'hit_ratio@10': 0.8137, 'ndcg@10': 0.8417, 'compress@10': 0.6829, 'time@10': 5.1112}:  70%|███████   | 7/10 [00:25<00:12,  4.01s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0504, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.84, 'compress@10': 0.6053, 'time@10': 5.0568}:  70%|███████   | 7/10 [00:29<00:12,  4.01s/it]   {'epoch': 5, 'num_users': 6.125, 'loss': 0.0504, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.84, 'compress@10': 0.6053, 'time@10': 5.0568}:  80%|████████  | 8/10 [00:29<00:08,  4.23s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0496, 'hit_ratio@10': 0.8234, 'ndcg@10': 0.8492, 'compress@10': 0.5412, 'time@10': 5.4413}:  80%|████████  | 8/10 [00:34<00:08,  4.23s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0496, 'hit_ratio@10': 0.8234, 'ndcg@10': 0.8492, 'compress@10': 0.5412, 'time@10': 5.4413}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8508, 'compress@10': 0.4893, 'time@10': 5.4718}:  90%|█████████ | 9/10 [00:39<00:04,  4.25s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8508, 'compress@10': 0.4893, 'time@10': 5.4718}: 100%|██████████| 10/10 [00:39<00:00,  4.73s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8508, 'compress@10': 0.4893, 'time@10': 5.4718}: 100%|██████████| 10/10 [00:39<00:00,  4.00s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04870851541809918
Avg hit ratio: 0.8342029193217648
Avg ndcg: 0.8508396908530693
Avg compression ratio: 0.48934959031369407
Avg train time: 5.471790599822998
Std train time: 1.8373982270452822
[0.5857142857142856, 0.7285714285714286, 0.15714285714285717, 0.7285714285714286, 0.7285714285714285, 0.7285714285714285, 0.30000000000000004, 0.44285714285714284, 0.014285714285714289, 0.014285714285714289]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8543, 'compress@10': 0.8784, 'time@10': 4.2262}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8543, 'compress@10': 0.8784, 'time@10': 4.2262}:  10%|█         | 1/10 [00:02<00:19,  2.15s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8599, 'compress@10': 0.9337, 'time@10': 4.2125}:  10%|█         | 1/10 [00:06<00:19,  2.15s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8599, 'compress@10': 0.9337, 'time@10': 4.2125}:  20%|██        | 2/10 [00:06<00:27,  3.38s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.859, 'compress@10': 0.6706, 'time@10': 3.6777}:  20%|██        | 2/10 [00:07<00:27,  3.38s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.859, 'compress@10': 0.6706, 'time@10': 3.6777}:  30%|███       | 3/10 [00:07<00:17,  2.45s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.7999, 'ndcg@10': 0.8495, 'compress@10': 0.75, 'time@10': 3.6911}:  30%|███       | 3/10 [00:11<00:17,  2.45s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.7999, 'ndcg@10': 0.8495, 'compress@10': 0.75, 'time@10': 3.6911}:  40%|████      | 4/10 [00:11<00:17,  2.97s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.8079, 'ndcg@10': 0.8372, 'compress@10': 0.7974, 'time@10': 4.5949}:  40%|████      | 4/10 [00:15<00:17,  2.97s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.8079, 'ndcg@10': 0.8372, 'compress@10': 0.7974, 'time@10': 4.5949}:  50%|█████     | 5/10 [00:15<00:16,  3.40s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0474, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8367, 'compress@10': 0.8296, 'time@10': 4.8651}:  50%|█████     | 5/10 [00:21<00:16,  3.40s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0474, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8367, 'compress@10': 0.8296, 'time@10': 4.8651}:  60%|██████    | 6/10 [00:21<00:17,  4.37s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0464, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.838, 'compress@10': 0.719, 'time@10': 5.1405}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]  {'epoch': 6, 'num_users': 6.2857, 'loss': 0.0464, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.838, 'compress@10': 0.719, 'time@10': 5.1405}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0464, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8436, 'compress@10': 0.6495, 'time@10': 5.1014}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0464, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8436, 'compress@10': 0.6495, 'time@10': 5.1014}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0468, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8516, 'compress@10': 0.5805, 'time@10': 5.4897}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0468, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8516, 'compress@10': 0.5805, 'time@10': 5.4897}:  90%|█████████ | 9/10 [00:34<00:04,  4.33s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0459, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8521, 'compress@10': 0.5248, 'time@10': 5.5052}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0459, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8521, 'compress@10': 0.5248, 'time@10': 5.5052}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0459, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8521, 'compress@10': 0.5248, 'time@10': 5.5052}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.045936541338228054
Avg hit ratio: 0.8467938051384571
Avg ndcg: 0.8520600890687667
Avg compression ratio: 0.5247626853664049
Avg train time: 5.505205249786377
Std train time: 1.8546611459780984
[0.6375, 0.6375000000000001, 0.1375, 0.7625000000000001, 0.7625, 0.7625, 0.26250000000000007, 0.38749999999999996, 0.1375, 0.012500000000000002]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.9427, 'time@10': 4.3842}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.9427, 'time@10': 4.3842}:  10%|█         | 1/10 [00:02<00:20,  2.23s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8541, 'compress@10': 0.9466, 'time@10': 4.3016}:  10%|█         | 1/10 [00:06<00:20,  2.23s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8541, 'compress@10': 0.9466, 'time@10': 4.3016}:  20%|██        | 2/10 [00:06<00:27,  3.42s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8551, 'compress@10': 0.679, 'time@10': 3.7983}:  20%|██        | 2/10 [00:07<00:27,  3.42s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8551, 'compress@10': 0.679, 'time@10': 3.7983}:  30%|███       | 3/10 [00:07<00:17,  2.52s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8551, 'compress@10': 0.7577, 'time@10': 3.7755}:  30%|███       | 3/10 [00:11<00:17,  2.52s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8551, 'compress@10': 0.7577, 'time@10': 3.7755}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0431, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8418, 'compress@10': 0.8048, 'time@10': 4.6995}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0431, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8418, 'compress@10': 0.8048, 'time@10': 4.6995}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0448, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8414, 'compress@10': 0.8364, 'time@10': 4.945}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0448, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8414, 'compress@10': 0.8364, 'time@10': 4.945}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.045, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8466, 'compress@10': 0.7239, 'time@10': 5.1977}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.045, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8466, 'compress@10': 0.7239, 'time@10': 5.1977}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0446, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.8519, 'compress@10': 0.6426, 'time@10': 5.1386}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0446, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.8519, 'compress@10': 0.6426, 'time@10': 5.1386}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0435, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8589, 'compress@10': 0.5745, 'time@10': 5.5277}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0435, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8589, 'compress@10': 0.5745, 'time@10': 5.5277}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0426, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8602, 'compress@10': 0.5193, 'time@10': 5.5412}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0426, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8602, 'compress@10': 0.5193, 'time@10': 5.5412}: 100%|██████████| 10/10 [00:40<00:00,  4.74s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0426, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8602, 'compress@10': 0.5193, 'time@10': 5.5412}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.0425589619786127
Avg hit ratio: 0.8757497703202288
Avg ndcg: 0.8601939134318111
Avg compression ratio: 0.5193447959945642
Avg train time: 5.541228175163269
Std train time: 1.849757485312051
[0.6777777777777777, 0.5666666666666668, 0.12222222222222223, 0.788888888888889, 0.7888888888888889, 0.7888888888888889, 0.3444444444444445, 0.3444444444444444, 0.12222222222222223, 0.011111111111111113]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.9701, 'time@10': 4.7203}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.9701, 'time@10': 4.7203}:  10%|█         | 1/10 [00:02<00:21,  2.40s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8577, 'compress@10': 0.9198, 'time@10': 4.4598}:  10%|█         | 1/10 [00:06<00:21,  2.40s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8577, 'compress@10': 0.9198, 'time@10': 4.4598}:  20%|██        | 2/10 [00:06<00:27,  3.48s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8575, 'compress@10': 0.661, 'time@10': 3.9671}:  20%|██        | 2/10 [00:08<00:27,  3.48s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8575, 'compress@10': 0.661, 'time@10': 3.9671}:  30%|███       | 3/10 [00:08<00:18,  2.59s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8602, 'compress@10': 0.7447, 'time@10': 3.9061}:  30%|███       | 3/10 [00:11<00:18,  2.59s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8602, 'compress@10': 0.7447, 'time@10': 3.9061}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0428, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8453, 'compress@10': 0.7949, 'time@10': 4.7639}:  40%|████      | 4/10 [00:16<00:18,  3.05s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0428, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8453, 'compress@10': 0.7949, 'time@10': 4.7639}:  50%|█████     | 5/10 [00:16<00:17,  3.44s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0439, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8458, 'compress@10': 0.8284, 'time@10': 5.0112}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0439, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8458, 'compress@10': 0.8284, 'time@10': 5.0112}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0428, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8476, 'compress@10': 0.7207, 'time@10': 5.2581}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0428, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8476, 'compress@10': 0.7207, 'time@10': 5.2581}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0428, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.8514, 'compress@10': 0.6373, 'time@10': 5.1902}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0428, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.8514, 'compress@10': 0.6373, 'time@10': 5.1902}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0421, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8603, 'compress@10': 0.5698, 'time@10': 5.5683}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0421, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8603, 'compress@10': 0.5698, 'time@10': 5.5683}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0412, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8625, 'compress@10': 0.5151, 'time@10': 5.5703}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0412, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8625, 'compress@10': 0.5151, 'time@10': 5.5703}: 100%|██████████| 10/10 [00:40<00:00,  4.72s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0412, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8625, 'compress@10': 0.5151, 'time@10': 5.5703}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04124158940266329
Avg hit ratio: 0.8835903419349938
Avg ndcg: 0.8624971232336701
Avg compression ratio: 0.5150809245282404
Avg train time: 5.57025101184845
Std train time: 1.7692279570560363
[0.71, 0.5100000000000001, 0.11000000000000001, 0.81, 0.8099999999999999, 0.8099999999999999, 0.31000000000000005, 0.4099999999999999, 0.11000000000000001, 0.010000000000000002]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 0.9826, 'time@10': 4.4692}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 0.9826, 'time@10': 4.4692}:  10%|█         | 1/10 [00:02<00:20,  2.28s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8699, 'compress@10': 0.8609, 'time@10': 4.3428}:  10%|█         | 1/10 [00:06<00:20,  2.28s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8699, 'compress@10': 0.8609, 'time@10': 4.3428}:  20%|██        | 2/10 [00:06<00:27,  3.45s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8656, 'compress@10': 0.6217, 'time@10': 3.9366}:  20%|██        | 2/10 [00:08<00:27,  3.45s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8656, 'compress@10': 0.6217, 'time@10': 3.9366}:  30%|███       | 3/10 [00:08<00:18,  2.60s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8683, 'compress@10': 0.7155, 'time@10': 3.8925}:  30%|███       | 3/10 [00:11<00:18,  2.60s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8683, 'compress@10': 0.7155, 'time@10': 3.8925}:  40%|████      | 4/10 [00:11<00:18,  3.08s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0393, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8536, 'compress@10': 0.7717, 'time@10': 4.7719}:  40%|████      | 4/10 [00:16<00:18,  3.08s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0393, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8536, 'compress@10': 0.7717, 'time@10': 4.7719}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0401, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8529, 'compress@10': 0.8094, 'time@10': 5.0173}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0401, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8529, 'compress@10': 0.8094, 'time@10': 5.0173}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0399, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8592, 'compress@10': 0.7024, 'time@10': 5.2442}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0399, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8592, 'compress@10': 0.7024, 'time@10': 5.2442}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0401, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8599, 'compress@10': 0.6295, 'time@10': 5.1785}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0401, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8599, 'compress@10': 0.6295, 'time@10': 5.1785}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8779, 'compress@10': 0.5628, 'time@10': 5.5348}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0403, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8779, 'compress@10': 0.5628, 'time@10': 5.5348}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0395, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8791, 'compress@10': 0.5088, 'time@10': 5.5731}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0395, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8791, 'compress@10': 0.5088, 'time@10': 5.5731}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0395, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8791, 'compress@10': 0.5088, 'time@10': 5.5731}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03950887127044726
Avg hit ratio: 0.8655903419349938
Avg ndcg: 0.8791304485587748
Avg compression ratio: 0.508785120736471
Avg train time: 5.573094439506531
Std train time: 1.7318575323913021
[0.7363636363636363, 0.46363636363636374, 0.1, 0.8272727272727273, 0.8272727272727273, 0.8272727272727273, 0.28181818181818186, 0.3727272727272727, 0.19090909090909092, 0.009090909090909092]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8393, 'compress@10': 0.9886, 'time@10': 3.8738}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8393, 'compress@10': 0.9886, 'time@10': 3.8738}:  10%|█         | 1/10 [00:01<00:17,  1.98s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0412, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8642, 'compress@10': 0.7048, 'time@10': 3.9381}:  10%|█         | 1/10 [00:06<00:17,  1.98s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0412, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8642, 'compress@10': 0.7048, 'time@10': 3.9381}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8619, 'compress@10': 0.5176, 'time@10': 3.6679}:  20%|██        | 2/10 [00:07<00:25,  3.20s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8619, 'compress@10': 0.5176, 'time@10': 3.6679}:  30%|███       | 3/10 [00:07<00:17,  2.48s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8682, 'compress@10': 0.6377, 'time@10': 3.692}:  30%|███       | 3/10 [00:11<00:17,  2.48s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8682, 'compress@10': 0.6377, 'time@10': 3.692}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8551, 'compress@10': 0.7096, 'time@10': 4.5922}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8551, 'compress@10': 0.7096, 'time@10': 4.5922}:  50%|█████     | 5/10 [00:15<00:17,  3.41s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0382, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.856, 'compress@10': 0.7577, 'time@10': 4.8634}:  50%|█████     | 5/10 [00:21<00:17,  3.41s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0382, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.856, 'compress@10': 0.7577, 'time@10': 4.8634}:  60%|██████    | 6/10 [00:21<00:17,  4.38s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0379, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8548, 'compress@10': 0.6568, 'time@10': 5.125}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0379, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8548, 'compress@10': 0.6568, 'time@10': 5.125}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0378, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8573, 'compress@10': 0.5854, 'time@10': 5.0714}:  70%|███████   | 7/10 [00:29<00:12,  4.06s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0378, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8573, 'compress@10': 0.5854, 'time@10': 5.0714}:  80%|████████  | 8/10 [00:29<00:08,  4.27s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0394, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.871, 'compress@10': 0.5238, 'time@10': 5.4565}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0394, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.871, 'compress@10': 0.5238, 'time@10': 5.4565}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0386, 'hit_ratio@10': 0.876, 'ndcg@10': 0.8737, 'compress@10': 0.4737, 'time@10': 5.4828}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0386, 'hit_ratio@10': 0.876, 'ndcg@10': 0.8737, 'compress@10': 0.4737, 'time@10': 5.4828}: 100%|██████████| 10/10 [00:40<00:00,  4.74s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0386, 'hit_ratio@10': 0.876, 'ndcg@10': 0.8737, 'compress@10': 0.4737, 'time@10': 5.4828}: 100%|██████████| 10/10 [00:40<00:00,  4.00s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03860594940861255
Avg hit ratio: 0.8759833699596008
Avg ndcg: 0.873669740033794
Avg compression ratio: 0.4736803127268721
Avg train time: 5.482838129997253
Std train time: 1.8066815482323961
[0.7583333333333333, 0.4250000000000001, 0.09166666666666667, 0.8416666666666667, 0.8416666666666667, 0.8416666666666667, 0.25833333333333336, 0.3416666666666666, 0.25833333333333336, 0.008333333333333335]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8779, 'compress@10': 0.9926, 'time@10': 4.8175}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8779, 'compress@10': 0.9926, 'time@10': 4.8175}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.883, 'compress@10': 0.5941, 'time@10': 4.2054}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it] {'epoch': 11, 'num_users': 7.0, 'loss': 0.0399, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.883, 'compress@10': 0.5941, 'time@10': 4.2054}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8744, 'compress@10': 0.4438, 'time@10': 3.8451}:  20%|██        | 2/10 [00:07<00:25,  3.20s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8744, 'compress@10': 0.4438, 'time@10': 3.8451}:  30%|███       | 3/10 [00:07<00:17,  2.49s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8771, 'compress@10': 0.5824, 'time@10': 3.8256}:  30%|███       | 3/10 [00:11<00:17,  2.49s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8771, 'compress@10': 0.5824, 'time@10': 3.8256}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.037, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8625, 'compress@10': 0.6656, 'time@10': 4.6989}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it] {'epoch': 11, 'num_users': 5.8, 'loss': 0.037, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8625, 'compress@10': 0.6656, 'time@10': 4.6989}:  50%|█████     | 5/10 [00:15<00:17,  3.41s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0372, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8639, 'compress@10': 0.7211, 'time@10': 4.9357}:  50%|█████     | 5/10 [00:21<00:17,  3.41s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0372, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8639, 'compress@10': 0.7211, 'time@10': 4.9357}:  60%|██████    | 6/10 [00:21<00:17,  4.35s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.037, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8681, 'compress@10': 0.625, 'time@10': 5.1829}:  60%|██████    | 6/10 [00:25<00:17,  4.35s/it]  {'epoch': 11, 'num_users': 6.2857, 'loss': 0.037, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8681, 'compress@10': 0.625, 'time@10': 5.1829}:  70%|███████   | 7/10 [00:25<00:12,  4.03s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.036, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8716, 'compress@10': 0.555, 'time@10': 5.1211}:  70%|███████   | 7/10 [00:30<00:12,  4.03s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.036, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8716, 'compress@10': 0.555, 'time@10': 5.1211}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0363, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8764, 'compress@10': 0.4976, 'time@10': 5.4967}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0363, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8764, 'compress@10': 0.4976, 'time@10': 5.4967}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0354, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8782, 'compress@10': 0.4501, 'time@10': 5.5302}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0354, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8782, 'compress@10': 0.4501, 'time@10': 5.5302}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0354, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8782, 'compress@10': 0.4501, 'time@10': 5.5302}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03542116093639046
Avg hit ratio: 0.8685932279378799
Avg ndcg: 0.8782064006127875
Avg compression ratio: 0.4501086219193281
Avg train time: 5.530170059204101
Std train time: 1.7751180463387464
[0.7769230769230769, 0.3923076923076924, 0.08461538461538462, 0.8538461538461538, 0.8538461538461538, 0.8538461538461538, 0.23846153846153847, 0.3153846153846153, 0.31538461538461543, 0.007692307692307694]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8431, 'compress@10': 0.9944, 'time@10': 4.9984}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8431, 'compress@10': 0.9944, 'time@10': 4.9984}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8684, 'compress@10': 0.5574, 'time@10': 4.3559}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8684, 'compress@10': 0.5574, 'time@10': 4.3559}:  20%|██        | 2/10 [00:06<00:26,  3.25s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8647, 'compress@10': 0.4193, 'time@10': 3.9413}:  20%|██        | 2/10 [00:07<00:26,  3.25s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8647, 'compress@10': 0.4193, 'time@10': 3.9413}:  30%|███       | 3/10 [00:07<00:17,  2.50s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0296, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8685, 'compress@10': 0.5642, 'time@10': 3.8887}:  30%|███       | 3/10 [00:11<00:17,  2.50s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0296, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8685, 'compress@10': 0.5642, 'time@10': 3.8887}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0363, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8562, 'compress@10': 0.6511, 'time@10': 4.7917}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0363, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8562, 'compress@10': 0.6511, 'time@10': 4.7917}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0357, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8587, 'compress@10': 0.7091, 'time@10': 5.0253}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0357, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8587, 'compress@10': 0.7091, 'time@10': 5.0253}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0348, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8618, 'compress@10': 0.6143, 'time@10': 5.2772}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it] {'epoch': 12, 'num_users': 6.2857, 'loss': 0.0348, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8618, 'compress@10': 0.6143, 'time@10': 5.2772}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0338, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8663, 'compress@10': 0.5441, 'time@10': 5.2205}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0338, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8663, 'compress@10': 0.5441, 'time@10': 5.2205}:  80%|████████  | 8/10 [00:30<00:08,  4.34s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0325, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8726, 'compress@10': 0.4902, 'time@10': 5.5869}:  80%|████████  | 8/10 [00:34<00:08,  4.34s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0325, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8726, 'compress@10': 0.4902, 'time@10': 5.5869}:  90%|█████████ | 9/10 [00:34<00:04,  4.33s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0315, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.8777, 'compress@10': 0.4434, 'time@10': 5.6117}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0315, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.8777, 'compress@10': 0.4434, 'time@10': 5.6117}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0315, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.8777, 'compress@10': 0.4434, 'time@10': 5.6117}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03151545889602099
Avg hit ratio: 0.8787135286897596
Avg ndcg: 0.8776540705343031
Avg compression ratio: 0.44344236842105583
Avg train time: 5.61171452999115
Std train time: 1.800075333351938
[0.7928571428571429, 0.43571428571428583, 0.07857142857142857, 0.8642857142857142, 0.8642857142857142, 0.8642857142857142, 0.22142857142857145, 0.2928571428571428, 0.2928571428571429, 0.007142857142857144]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8696, 'compress@10': 0.9964, 'time@10': 4.879}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8696, 'compress@10': 0.9964, 'time@10': 4.879}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8781, 'compress@10': 0.588, 'time@10': 4.2309}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8781, 'compress@10': 0.588, 'time@10': 4.2309}:  20%|██        | 2/10 [00:06<00:25,  3.15s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8711, 'compress@10': 0.4397, 'time@10': 3.8737}:  20%|██        | 2/10 [00:07<00:25,  3.15s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8711, 'compress@10': 0.4397, 'time@10': 3.8737}:  30%|███       | 3/10 [00:07<00:17,  2.45s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8749, 'compress@10': 0.5796, 'time@10': 3.8476}:  30%|███       | 3/10 [00:11<00:17,  2.45s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8749, 'compress@10': 0.5796, 'time@10': 3.8476}:  40%|████      | 4/10 [00:11<00:17,  2.99s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0341, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8611, 'compress@10': 0.6635, 'time@10': 4.7067}:  40%|████      | 4/10 [00:15<00:17,  2.99s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0341, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8611, 'compress@10': 0.6635, 'time@10': 4.7067}:  50%|█████     | 5/10 [00:15<00:16,  3.39s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0339, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8631, 'compress@10': 0.7195, 'time@10': 4.9488}:  50%|█████     | 5/10 [00:21<00:16,  3.39s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0339, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8631, 'compress@10': 0.7195, 'time@10': 4.9488}:  60%|██████    | 6/10 [00:21<00:17,  4.35s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0336, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8688, 'compress@10': 0.6229, 'time@10': 5.2138}:  60%|██████    | 6/10 [00:25<00:17,  4.35s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0336, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8688, 'compress@10': 0.6229, 'time@10': 5.2138}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0327, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.8725, 'compress@10': 0.5508, 'time@10': 5.1515}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0327, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.8725, 'compress@10': 0.5508, 'time@10': 5.1515}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.879, 'compress@10': 0.4948, 'time@10': 5.5156}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.879, 'compress@10': 0.4948, 'time@10': 5.5156}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0319, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8814, 'compress@10': 0.4476, 'time@10': 5.5512}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]  {'epoch': 13, 'num_users': 6.3, 'loss': 0.0319, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8814, 'compress@10': 0.4476, 'time@10': 5.5512}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0319, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8814, 'compress@10': 0.4476, 'time@10': 5.5512}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.031943900497123354
Avg hit ratio: 0.8809357509119818
Avg ndcg: 0.881429063112123
Avg compression ratio: 0.44759637004006525
Avg train time: 5.551247143745423
Std train time: 1.759641837150949
[0.8066666666666668, 0.4066666666666668, 0.07333333333333333, 0.8733333333333333, 0.8733333333333333, 0.8733333333333333, 0.2733333333333334, 0.2733333333333333, 0.2733333333333334, 0.006666666666666668]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.872, 'compress@10': 0.9975, 'time@10': 5.007}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.872, 'compress@10': 0.9975, 'time@10': 5.007}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0318, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8844, 'compress@10': 0.5526, 'time@10': 4.3158}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0318, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8844, 'compress@10': 0.5526, 'time@10': 4.3158}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8753, 'compress@10': 0.4161, 'time@10': 3.9105}:  20%|██        | 2/10 [00:07<00:25,  3.20s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8753, 'compress@10': 0.4161, 'time@10': 3.9105}:  30%|███       | 3/10 [00:07<00:17,  2.47s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8821, 'compress@10': 0.5619, 'time@10': 3.8771}:  30%|███       | 3/10 [00:11<00:17,  2.47s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8821, 'compress@10': 0.5619, 'time@10': 3.8771}:  40%|████      | 4/10 [00:11<00:17,  3.00s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8692, 'compress@10': 0.6494, 'time@10': 4.7618}:  40%|████      | 4/10 [00:15<00:17,  3.00s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8692, 'compress@10': 0.6494, 'time@10': 4.7618}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0323, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.871, 'compress@10': 0.7077, 'time@10': 4.996}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0323, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.871, 'compress@10': 0.7077, 'time@10': 4.996}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0318, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8725, 'compress@10': 0.6137, 'time@10': 5.249}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0318, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8725, 'compress@10': 0.6137, 'time@10': 5.249}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8779, 'compress@10': 0.5421, 'time@10': 5.183}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8779, 'compress@10': 0.5421, 'time@10': 5.183}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0309, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8896, 'compress@10': 0.4866, 'time@10': 5.5536}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0309, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8896, 'compress@10': 0.4866, 'time@10': 5.5536}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0296, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8945, 'compress@10': 0.4402, 'time@10': 5.5945}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]  {'epoch': 14, 'num_users': 6.3, 'loss': 0.0296, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8945, 'compress@10': 0.4402, 'time@10': 5.5945}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0296, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8945, 'compress@10': 0.4402, 'time@10': 5.5945}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.029609302834032663
Avg hit ratio: 0.8834242301746545
Avg ndcg: 0.8945397987258428
Avg compression ratio: 0.4402059135804988
Avg train time: 5.594542551040649
Std train time: 1.7949835807397703
[0.8187500000000001, 0.3812500000000001, 0.06875, 0.88125, 0.88125, 0.88125, 0.25625000000000003, 0.25625, 0.31875000000000003, 0.006250000000000001]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8558, 'compress@10': 0.998, 'time@10': 4.715}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8558, 'compress@10': 0.998, 'time@10': 4.715}:  10%|█         | 1/10 [00:02<00:21,  2.40s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8762, 'compress@10': 0.538, 'time@10': 4.1874}:  10%|█         | 1/10 [00:06<00:21,  2.40s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8762, 'compress@10': 0.538, 'time@10': 4.1874}:  20%|██        | 2/10 [00:06<00:25,  3.16s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8699, 'compress@10': 0.4063, 'time@10': 3.8291}:  20%|██        | 2/10 [00:07<00:25,  3.16s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8699, 'compress@10': 0.4063, 'time@10': 3.8291}:  30%|███       | 3/10 [00:07<00:17,  2.45s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8811, 'compress@10': 0.5546, 'time@10': 3.8104}:  30%|███       | 3/10 [00:11<00:17,  2.45s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8811, 'compress@10': 0.5546, 'time@10': 3.8104}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0316, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8691, 'compress@10': 0.6436, 'time@10': 4.7232}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0316, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8691, 'compress@10': 0.6436, 'time@10': 4.7232}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0315, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8754, 'compress@10': 0.7029, 'time@10': 4.9742}:  50%|█████     | 5/10 [00:21<00:17,  3.44s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0315, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8754, 'compress@10': 0.7029, 'time@10': 4.9742}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8801, 'compress@10': 0.6091, 'time@10': 5.2361}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8801, 'compress@10': 0.6091, 'time@10': 5.2361}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.03, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.8831, 'compress@10': 0.5377, 'time@10': 5.1777}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]   {'epoch': 15, 'num_users': 6.125, 'loss': 0.03, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.8831, 'compress@10': 0.5377, 'time@10': 5.1777}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0309, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9039, 'compress@10': 0.4844, 'time@10': 5.5318}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0309, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9039, 'compress@10': 0.4844, 'time@10': 5.5318}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9052, 'compress@10': 0.4382, 'time@10': 5.5711}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]  {'epoch': 15, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9052, 'compress@10': 0.4382, 'time@10': 5.5711}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9052, 'compress@10': 0.4382, 'time@10': 5.5711}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.030354928938451327
Avg hit ratio: 0.8834242301746545
Avg ndcg: 0.9051528515243128
Avg compression ratio: 0.43824566514376634
Avg train time: 5.571127533912659
Std train time: 1.7921995172757528
[0.8294117647058824, 0.35882352941176476, 0.06470588235294118, 0.888235294117647, 0.888235294117647, 0.888235294117647, 0.24117647058823533, 0.24117647058823527, 0.35882352941176476, 0.005882352941176471]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8782, 'compress@10': 0.9987, 'time@10': 4.8456}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0378, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8782, 'compress@10': 0.9987, 'time@10': 4.8456}:  10%|█         | 1/10 [00:02<00:22,  2.46s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8977, 'compress@10': 0.529, 'time@10': 4.3478}:  10%|█         | 1/10 [00:06<00:22,  2.46s/it] {'epoch': 16, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8977, 'compress@10': 0.529, 'time@10': 4.3478}:  20%|██        | 2/10 [00:06<00:26,  3.30s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8841, 'compress@10': 0.4003, 'time@10': 3.9594}:  20%|██        | 2/10 [00:07<00:26,  3.30s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8841, 'compress@10': 0.4003, 'time@10': 3.9594}:  30%|███       | 3/10 [00:07<00:17,  2.54s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.886, 'compress@10': 0.5502, 'time@10': 3.9084}:  30%|███       | 3/10 [00:11<00:17,  2.54s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.886, 'compress@10': 0.5502, 'time@10': 3.9084}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8754, 'compress@10': 0.64, 'time@10': 4.7848}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it]  {'epoch': 16, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.874, 'ndcg@10': 0.8754, 'compress@10': 0.64, 'time@10': 4.7848}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0278, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.8799, 'compress@10': 0.7, 'time@10': 5.005}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0278, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.8799, 'compress@10': 0.7, 'time@10': 5.005}:  60%|██████    | 6/10 [00:22<00:17,  4.36s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0276, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.8817, 'compress@10': 0.6062, 'time@10': 5.2547}:  60%|██████    | 6/10 [00:25<00:17,  4.36s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0276, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.8817, 'compress@10': 0.6062, 'time@10': 5.2547}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0271, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.8853, 'compress@10': 0.5348, 'time@10': 5.1845}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0271, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.8853, 'compress@10': 0.5348, 'time@10': 5.1845}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.892, 'ndcg@10': 0.901, 'compress@10': 0.4849, 'time@10': 5.5435}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it] {'epoch': 16, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.892, 'ndcg@10': 0.901, 'compress@10': 0.4849, 'time@10': 5.5435}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9054, 'compress@10': 0.4387, 'time@10': 5.5822}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it] {'epoch': 16, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9054, 'compress@10': 0.4387, 'time@10': 5.5822}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9054, 'compress@10': 0.4387, 'time@10': 5.5822}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.026918800506341566
Avg hit ratio: 0.9005670873175118
Avg ndcg: 0.9054102185770144
Avg compression ratio: 0.43870404625671766
Avg train time: 5.582204389572143
Std train time: 1.7481352284375418
[0.8388888888888889, 0.33888888888888896, 0.061111111111111116, 0.8944444444444444, 0.8944444444444444, 0.8388888888888888, 0.2833333333333334, 0.22777777777777775, 0.3944444444444445, 0.005555555555555557]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0424, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8677, 'compress@10': 0.9992, 'time@10': 4.8503}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0424, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8677, 'compress@10': 0.9992, 'time@10': 4.8503}:  10%|█         | 1/10 [00:02<00:22,  2.46s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8935, 'compress@10': 0.5245, 'time@10': 4.2642}:  10%|█         | 1/10 [00:06<00:22,  2.46s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8935, 'compress@10': 0.5245, 'time@10': 4.2642}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8814, 'compress@10': 0.3973, 'time@10': 3.8973}:  20%|██        | 2/10 [00:07<00:25,  3.20s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8814, 'compress@10': 0.3973, 'time@10': 3.8973}:  30%|███       | 3/10 [00:07<00:17,  2.48s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8826, 'compress@10': 0.5479, 'time@10': 3.865}:  30%|███       | 3/10 [00:11<00:17,  2.48s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8826, 'compress@10': 0.5479, 'time@10': 3.865}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0297, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8752, 'compress@10': 0.6382, 'time@10': 4.7551}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0297, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8752, 'compress@10': 0.6382, 'time@10': 4.7551}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0292, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8806, 'compress@10': 0.6984, 'time@10': 4.9917}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0292, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8806, 'compress@10': 0.6984, 'time@10': 4.9917}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0282, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8859, 'compress@10': 0.6053, 'time@10': 5.258}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it] {'epoch': 17, 'num_users': 6.2857, 'loss': 0.0282, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8859, 'compress@10': 0.6053, 'time@10': 5.258}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0274, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8897, 'compress@10': 0.5338, 'time@10': 5.1979}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0274, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8897, 'compress@10': 0.5338, 'time@10': 5.1979}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8949, 'compress@10': 0.4876, 'time@10': 5.576}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it] {'epoch': 17, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8949, 'compress@10': 0.4876, 'time@10': 5.576}:  90%|█████████ | 9/10 [00:34<00:04,  4.33s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8977, 'compress@10': 0.4411, 'time@10': 5.602}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8977, 'compress@10': 0.4411, 'time@10': 5.602}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8977, 'compress@10': 0.4411, 'time@10': 5.602}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.027256862144727168
Avg hit ratio: 0.8834242301746545
Avg ndcg: 0.8976569432899622
Avg compression ratio: 0.4411058576658259
Avg train time: 5.601972842216492
Std train time: 1.8046967420520303
[0.8473684210526315, 0.3210526315789474, 0.05789473684210527, 0.8999999999999999, 0.8999999999999999, 0.8473684210526314, 0.268421052631579, 0.2157894736842105, 0.42631578947368426, 0.005263157894736843]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8804, 'compress@10': 0.9993, 'time@10': 4.9553}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8804, 'compress@10': 0.9993, 'time@10': 4.9553}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0299, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8985, 'compress@10': 0.5212, 'time@10': 4.2806}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0299, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8985, 'compress@10': 0.5212, 'time@10': 4.2806}:  20%|██        | 2/10 [00:06<00:25,  3.18s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8847, 'compress@10': 0.3951, 'time@10': 3.8906}:  20%|██        | 2/10 [00:07<00:25,  3.18s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8847, 'compress@10': 0.3951, 'time@10': 3.8906}:  30%|███       | 3/10 [00:07<00:17,  2.47s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8891, 'compress@10': 0.5463, 'time@10': 3.86}:  30%|███       | 3/10 [00:11<00:17,  2.47s/it]  {'epoch': 18, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8891, 'compress@10': 0.5463, 'time@10': 3.86}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0272, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8824, 'compress@10': 0.6369, 'time@10': 4.7652}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0272, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8824, 'compress@10': 0.6369, 'time@10': 4.7652}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0283, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8895, 'compress@10': 0.6973, 'time@10': 5.0081}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0283, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8895, 'compress@10': 0.6973, 'time@10': 5.0081}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0283, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8909, 'compress@10': 0.6039, 'time@10': 5.2507}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0283, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8909, 'compress@10': 0.6039, 'time@10': 5.2507}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0269, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8966, 'compress@10': 0.5324, 'time@10': 5.1909}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0269, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8966, 'compress@10': 0.5324, 'time@10': 5.1909}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0257, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9024, 'compress@10': 0.4926, 'time@10': 5.5652}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0257, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9024, 'compress@10': 0.4926, 'time@10': 5.5652}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0254, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9067, 'compress@10': 0.4456, 'time@10': 5.5977}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0254, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9067, 'compress@10': 0.4456, 'time@10': 5.5977}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0254, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9067, 'compress@10': 0.4456, 'time@10': 5.5977}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.02538176863150316
Avg hit ratio: 0.8805670873175118
Avg ndcg: 0.9066694322860839
Avg compression ratio: 0.4456214338864041
Avg train time: 5.5977084875106815
Std train time: 1.8124331343560913
[0.855, 0.30500000000000005, 0.05500000000000001, 0.9049999999999999, 0.9049999999999999, 0.8549999999999999, 0.30500000000000005, 0.205, 0.405, 0.005000000000000001]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8787, 'compress@10': 0.9994, 'time@10': 4.453}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8787, 'compress@10': 0.9994, 'time@10': 4.453}:  10%|█         | 1/10 [00:02<00:20,  2.29s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9075, 'compress@10': 0.5187, 'time@10': 4.1059}:  10%|█         | 1/10 [00:06<00:20,  2.29s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9075, 'compress@10': 0.5187, 'time@10': 4.1059}:  20%|██        | 2/10 [00:06<00:25,  3.18s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8907, 'compress@10': 0.3935, 'time@10': 3.749}:  20%|██        | 2/10 [00:07<00:25,  3.18s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8907, 'compress@10': 0.3935, 'time@10': 3.749}:  30%|███       | 3/10 [00:07<00:17,  2.45s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9002, 'compress@10': 0.545, 'time@10': 3.7636}:  30%|███       | 3/10 [00:11<00:17,  2.45s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9002, 'compress@10': 0.545, 'time@10': 3.7636}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8929, 'compress@10': 0.636, 'time@10': 4.691}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]  {'epoch': 19, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8929, 'compress@10': 0.636, 'time@10': 4.691}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0234, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8997, 'compress@10': 0.6965, 'time@10': 4.9421}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0234, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8997, 'compress@10': 0.6965, 'time@10': 4.9421}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0235, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9003, 'compress@10': 0.6037, 'time@10': 5.1974}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0235, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9003, 'compress@10': 0.6037, 'time@10': 5.1974}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9048, 'compress@10': 0.5321, 'time@10': 5.1463}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9048, 'compress@10': 0.5321, 'time@10': 5.1463}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0219, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9096, 'compress@10': 0.4854, 'time@10': 5.4999}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0219, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9096, 'compress@10': 0.4854, 'time@10': 5.4999}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9145, 'compress@10': 0.4392, 'time@10': 5.5357}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9145, 'compress@10': 0.4392, 'time@10': 5.5357}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9145, 'compress@10': 0.4392, 'time@10': 5.5357}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.02088964086433053
Avg hit ratio: 0.8909096102916138
Avg ndcg: 0.9145139926077235
Avg compression ratio: 0.43915343470491186
Avg train time: 5.535716819763183
Std train time: 1.7916572911617537
[0.8619047619047618, 0.3380952380952381, 0.05238095238095239, 0.9095238095238094, 0.9095238095238094, 0.8142857142857142, 0.3380952380952381, 0.19523809523809524, 0.38571428571428573, 0.004761904761904763]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0334, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8816, 'compress@10': 0.9995, 'time@10': 4.5412}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0334, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8816, 'compress@10': 0.9995, 'time@10': 4.5412}:  10%|█         | 1/10 [00:02<00:20,  2.31s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9095, 'compress@10': 0.5207, 'time@10': 4.1337}:  10%|█         | 1/10 [00:06<00:20,  2.31s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9095, 'compress@10': 0.5207, 'time@10': 4.1337}:  20%|██        | 2/10 [00:06<00:25,  3.17s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.892, 'compress@10': 0.3948, 'time@10': 3.7646}:  20%|██        | 2/10 [00:07<00:25,  3.17s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.892, 'compress@10': 0.3948, 'time@10': 3.7646}:  30%|███       | 3/10 [00:07<00:17,  2.43s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.901, 'compress@10': 0.546, 'time@10': 3.7658}:  30%|███       | 3/10 [00:11<00:17,  2.43s/it]  {'epoch': 20, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.901, 'compress@10': 0.546, 'time@10': 3.7658}:  40%|████      | 4/10 [00:11<00:17,  2.97s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.023, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8945, 'compress@10': 0.6368, 'time@10': 4.6646}:  40%|████      | 4/10 [00:15<00:17,  2.97s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.023, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8945, 'compress@10': 0.6368, 'time@10': 4.6646}:  50%|█████     | 5/10 [00:15<00:17,  3.40s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0213, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.903, 'compress@10': 0.697, 'time@10': 4.9197}:  50%|█████     | 5/10 [00:21<00:17,  3.40s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0213, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.903, 'compress@10': 0.697, 'time@10': 4.9197}:  60%|██████    | 6/10 [00:21<00:17,  4.37s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0212, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9054, 'compress@10': 0.6049, 'time@10': 5.1741}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0212, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9054, 'compress@10': 0.6049, 'time@10': 5.1741}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9096, 'compress@10': 0.533, 'time@10': 5.1111}:  70%|███████   | 7/10 [00:29<00:12,  4.05s/it]  {'epoch': 20, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9096, 'compress@10': 0.533, 'time@10': 5.1111}:  80%|████████  | 8/10 [00:29<00:08,  4.26s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9199, 'compress@10': 0.4813, 'time@10': 5.4927}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9199, 'compress@10': 0.4813, 'time@10': 5.4927}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9191, 'compress@10': 0.4354, 'time@10': 5.5415}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9191, 'compress@10': 0.4354, 'time@10': 5.5415}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9191, 'compress@10': 0.4354, 'time@10': 5.5415}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.02219057931394714
Avg hit ratio: 0.9109096102916137
Avg ndcg: 0.9191322726294304
Avg compression ratio: 0.43542633209347226
Avg train time: 5.541539931297303
Std train time: 1.8137361718018306
[0.8681818181818182, 0.32272727272727275, 0.05000000000000001, 0.9136363636363635, 0.9136363636363635, 0.7772727272727271, 0.32272727272727275, 0.18636363636363637, 0.41363636363636364, 0.05]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8888, 'compress@10': 0.9996, 'time@10': 4.9268}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8888, 'compress@10': 0.9996, 'time@10': 4.9268}:  10%|█         | 1/10 [00:02<00:22,  2.50s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.917, 'compress@10': 0.5191, 'time@10': 4.3154}:  10%|█         | 1/10 [00:06<00:22,  2.50s/it]  {'epoch': 21, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.917, 'compress@10': 0.5191, 'time@10': 4.3154}:  20%|██        | 2/10 [00:06<00:25,  3.23s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.897, 'compress@10': 0.3937, 'time@10': 3.9135}:  20%|██        | 2/10 [00:07<00:25,  3.23s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.897, 'compress@10': 0.3937, 'time@10': 3.9135}:  30%|███       | 3/10 [00:07<00:17,  2.48s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9038, 'compress@10': 0.5452, 'time@10': 3.8834}:  30%|███       | 3/10 [00:11<00:17,  2.48s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9038, 'compress@10': 0.5452, 'time@10': 3.8834}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.856, 'ndcg@10': 0.898, 'compress@10': 0.6362, 'time@10': 4.7739}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it]  {'epoch': 21, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.856, 'ndcg@10': 0.898, 'compress@10': 0.6362, 'time@10': 4.7739}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0245, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9062, 'compress@10': 0.6958, 'time@10': 5.0109}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0245, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9062, 'compress@10': 0.6958, 'time@10': 5.0109}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0249, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9047, 'compress@10': 0.6033, 'time@10': 5.2724}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0249, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9047, 'compress@10': 0.6033, 'time@10': 5.2724}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0235, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9091, 'compress@10': 0.5315, 'time@10': 5.2023}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0235, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9091, 'compress@10': 0.5315, 'time@10': 5.2023}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.025, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9317, 'compress@10': 0.4808, 'time@10': 5.5573}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.025, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9317, 'compress@10': 0.4808, 'time@10': 5.5573}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9341, 'compress@10': 0.435, 'time@10': 5.6038}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9341, 'compress@10': 0.435, 'time@10': 5.6038}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9341, 'compress@10': 0.435, 'time@10': 5.6038}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.024123767329904594
Avg hit ratio: 0.8909096102916138
Avg ndcg: 0.9340884776595614
Avg compression ratio: 0.4349828849376299
Avg train time: 5.603800106048584
Std train time: 1.780166366493014
[0.8739130434782608, 0.3086956521739131, 0.04782608695652175, 0.8739130434782607, 0.9173913043478259, 0.7869565217391303, 0.3521739130434783, 0.1782608695652174, 0.4391304347826087, 0.04782608695652174]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 0.9996, 'time@10': 4.5412}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 0.9996, 'time@10': 4.5412}:  10%|█         | 1/10 [00:02<00:20,  2.31s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9219, 'compress@10': 0.5182, 'time@10': 4.1641}:  10%|█         | 1/10 [00:06<00:20,  2.31s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9219, 'compress@10': 0.5182, 'time@10': 4.1641}:  20%|██        | 2/10 [00:06<00:25,  3.22s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9003, 'compress@10': 0.3931, 'time@10': 3.7687}:  20%|██        | 2/10 [00:07<00:25,  3.22s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9003, 'compress@10': 0.3931, 'time@10': 3.7687}:  30%|███       | 3/10 [00:07<00:17,  2.45s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9098, 'compress@10': 0.5447, 'time@10': 3.7628}:  30%|███       | 3/10 [00:11<00:17,  2.45s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9098, 'compress@10': 0.5447, 'time@10': 3.7628}:  40%|████      | 4/10 [00:11<00:17,  2.97s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9031, 'compress@10': 0.6357, 'time@10': 4.6579}:  40%|████      | 4/10 [00:15<00:17,  2.97s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9031, 'compress@10': 0.6357, 'time@10': 4.6579}:  50%|█████     | 5/10 [00:15<00:17,  3.40s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0191, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9103, 'compress@10': 0.6957, 'time@10': 4.9133}:  50%|█████     | 5/10 [00:21<00:17,  3.40s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0191, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9103, 'compress@10': 0.6957, 'time@10': 4.9133}:  60%|██████    | 6/10 [00:21<00:17,  4.37s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9127, 'compress@10': 0.6039, 'time@10': 5.1845}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it] {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9127, 'compress@10': 0.6039, 'time@10': 5.1845}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9151, 'compress@10': 0.5321, 'time@10': 5.129}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9151, 'compress@10': 0.5321, 'time@10': 5.129}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9333, 'compress@10': 0.4865, 'time@10': 5.4899}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9333, 'compress@10': 0.4865, 'time@10': 5.4899}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9358, 'compress@10': 0.4401, 'time@10': 5.5393}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9358, 'compress@10': 0.4401, 'time@10': 5.5393}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9358, 'compress@10': 0.4401, 'time@10': 5.5393}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.021640454357277523
Avg hit ratio: 0.8972588166408201
Avg ndcg: 0.9357627666382132
Avg compression ratio: 0.44012336563016496
Avg train time: 5.539314246177673
Std train time: 1.790547385897327
[0.8791666666666667, 0.2958333333333334, 0.045833333333333344, 0.8791666666666665, 0.9208333333333332, 0.7541666666666665, 0.3791666666666667, 0.17083333333333334, 0.4625, 0.04583333333333334]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 0.9996, 'time@10': 4.6166}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8948, 'compress@10': 0.9996, 'time@10': 4.6166}:  10%|█         | 1/10 [00:02<00:21,  2.34s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9229, 'compress@10': 0.5177, 'time@10': 4.2295}:  10%|█         | 1/10 [00:06<00:21,  2.34s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9229, 'compress@10': 0.5177, 'time@10': 4.2295}:  20%|██        | 2/10 [00:06<00:25,  3.25s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.901, 'compress@10': 0.3928, 'time@10': 3.8412}:  20%|██        | 2/10 [00:07<00:25,  3.25s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.901, 'compress@10': 0.3928, 'time@10': 3.8412}:  30%|███       | 3/10 [00:07<00:17,  2.48s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.836, 'ndcg@10': 0.91, 'compress@10': 0.5445, 'time@10': 3.8221}:  30%|███       | 3/10 [00:11<00:17,  2.48s/it]  {'epoch': 23, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.836, 'ndcg@10': 0.91, 'compress@10': 0.5445, 'time@10': 3.8221}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.9039, 'compress@10': 0.6355, 'time@10': 4.7179}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.9039, 'compress@10': 0.6355, 'time@10': 4.7179}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9128, 'compress@10': 0.6946, 'time@10': 4.9586}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9128, 'compress@10': 0.6946, 'time@10': 4.9586}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0177, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9146, 'compress@10': 0.6047, 'time@10': 5.2126}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0177, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9146, 'compress@10': 0.6047, 'time@10': 5.2126}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9152, 'compress@10': 0.5327, 'time@10': 5.1569}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9152, 'compress@10': 0.5327, 'time@10': 5.1569}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.911, 'compress@10': 0.4898, 'time@10': 5.5112}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.911, 'compress@10': 0.4898, 'time@10': 5.5112}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9116, 'compress@10': 0.4431, 'time@10': 5.5639}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]  {'epoch': 23, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9116, 'compress@10': 0.4431, 'time@10': 5.5639}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9116, 'compress@10': 0.4431, 'time@10': 5.5639}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.020094878022894357
Avg hit ratio: 0.890195324577328
Avg ndcg: 0.9116342523915348
Avg compression ratio: 0.44309616702343463
Avg train time: 5.563861584663391
Std train time: 1.7654582215614647
[0.884, 0.28400000000000003, 0.04400000000000001, 0.8839999999999999, 0.9239999999999998, 0.7239999999999999, 0.36400000000000005, 0.164, 0.48400000000000004, 0.08399999999999999]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9015, 'compress@10': 0.9997, 'time@10': 4.684}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9015, 'compress@10': 0.9997, 'time@10': 4.684}:  10%|█         | 1/10 [00:02<00:21,  2.38s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9204, 'compress@10': 0.5173, 'time@10': 4.3297}:  10%|█         | 1/10 [00:06<00:21,  2.38s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9204, 'compress@10': 0.5173, 'time@10': 4.3297}:  20%|██        | 2/10 [00:06<00:26,  3.34s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8993, 'compress@10': 0.3925, 'time@10': 3.9868}:  20%|██        | 2/10 [00:08<00:26,  3.34s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8993, 'compress@10': 0.3925, 'time@10': 3.9868}:  30%|███       | 3/10 [00:08<00:18,  2.59s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9113, 'compress@10': 0.5443, 'time@10': 3.9162}:  30%|███       | 3/10 [00:11<00:18,  2.59s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9113, 'compress@10': 0.5443, 'time@10': 3.9162}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.9062, 'compress@10': 0.6354, 'time@10': 4.7841}:  40%|████      | 4/10 [00:15<00:18,  3.04s/it] {'epoch': 24, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.9062, 'compress@10': 0.6354, 'time@10': 4.7841}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.022, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9176, 'compress@10': 0.6932, 'time@10': 5.0362}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.022, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9176, 'compress@10': 0.6932, 'time@10': 5.0362}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.022, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9186, 'compress@10': 0.6025, 'time@10': 5.2771}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.022, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9186, 'compress@10': 0.6025, 'time@10': 5.2771}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.021, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9213, 'compress@10': 0.5308, 'time@10': 5.2041}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.021, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9213, 'compress@10': 0.5308, 'time@10': 5.2041}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0214, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9254, 'compress@10': 0.5072, 'time@10': 5.5606}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0214, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9254, 'compress@10': 0.5072, 'time@10': 5.5606}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.93, 'compress@10': 0.4587, 'time@10': 5.5978}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]     {'epoch': 24, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.93, 'compress@10': 0.4587, 'time@10': 5.5978}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.93, 'compress@10': 0.4587, 'time@10': 5.5978}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.020607547069956385
Avg hit ratio: 0.890195324577328
Avg ndcg: 0.9299955813518549
Avg compression ratio: 0.45874127590665115
Avg train time: 5.597774147987366
Std train time: 1.732082764319643
[0.8884615384615384, 0.2730769230769231, 0.04230769230769232, 0.8884615384615384, 0.9269230769230767, 0.7346153846153844, 0.35000000000000003, 0.1576923076923077, 0.5038461538461538, 0.08076923076923076]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9042, 'compress@10': 0.9997, 'time@10': 4.0909}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9042, 'compress@10': 0.9997, 'time@10': 4.0909}:  10%|█         | 1/10 [00:02<00:18,  2.08s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9317, 'compress@10': 0.5171, 'time@10': 3.9619}:  10%|█         | 1/10 [00:05<00:18,  2.08s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9317, 'compress@10': 0.5171, 'time@10': 3.9619}:  20%|██        | 2/10 [00:05<00:25,  3.14s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9069, 'compress@10': 0.3924, 'time@10': 3.8202}:  20%|██        | 2/10 [00:07<00:25,  3.14s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9069, 'compress@10': 0.3924, 'time@10': 3.8202}:  30%|███       | 3/10 [00:07<00:17,  2.53s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.9197, 'compress@10': 0.5442, 'time@10': 3.7711}:  30%|███       | 3/10 [00:11<00:17,  2.53s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.9197, 'compress@10': 0.5442, 'time@10': 3.7711}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.9147, 'compress@10': 0.6353, 'time@10': 4.6759}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it] {'epoch': 25, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.9147, 'compress@10': 0.6353, 'time@10': 4.6759}:  50%|█████     | 5/10 [00:15<00:17,  3.41s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9223, 'compress@10': 0.693, 'time@10': 4.9307}:  50%|█████     | 5/10 [00:21<00:17,  3.41s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.9223, 'compress@10': 0.693, 'time@10': 4.9307}:  60%|██████    | 6/10 [00:21<00:17,  4.38s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0161, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9236, 'compress@10': 0.6017, 'time@10': 5.1905}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0161, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9236, 'compress@10': 0.6017, 'time@10': 5.1905}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9274, 'compress@10': 0.5301, 'time@10': 5.132}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9274, 'compress@10': 0.5301, 'time@10': 5.132}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9298, 'compress@10': 0.5305, 'time@10': 5.493}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9298, 'compress@10': 0.5305, 'time@10': 5.493}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9322, 'compress@10': 0.4797, 'time@10': 5.5498}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9322, 'compress@10': 0.4797, 'time@10': 5.5498}: 100%|██████████| 10/10 [00:40<00:00,  4.84s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9322, 'compress@10': 0.4797, 'time@10': 5.5498}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.017360407311231698
Avg hit ratio: 0.8790330101892071
Avg ndcg: 0.9322304842673095
Avg compression ratio: 0.47974624610220074
Avg train time: 5.549763035774231
Std train time: 1.7665752403658306
[0.8925925925925925, 0.262962962962963, 0.04074074074074075, 0.8555555555555555, 0.9296296296296295, 0.7074074074074073, 0.3740740740740741, 0.15185185185185185, 0.5222222222222223, 0.11481481481481481]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0236, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9063, 'compress@10': 0.9997, 'time@10': 4.5053}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0236, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9063, 'compress@10': 0.9997, 'time@10': 4.5053}:  10%|█         | 1/10 [00:02<00:20,  2.29s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9326, 'compress@10': 0.5169, 'time@10': 4.1522}:  10%|█         | 1/10 [00:06<00:20,  2.29s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9326, 'compress@10': 0.5169, 'time@10': 4.1522}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9074, 'compress@10': 0.3923, 'time@10': 3.9669}:  20%|██        | 2/10 [00:07<00:25,  3.20s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9074, 'compress@10': 0.3923, 'time@10': 3.9669}:  30%|███       | 3/10 [00:07<00:18,  2.58s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9201, 'compress@10': 0.5439, 'time@10': 3.8595}:  30%|███       | 3/10 [00:11<00:18,  2.58s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9201, 'compress@10': 0.5439, 'time@10': 3.8595}:  40%|████      | 4/10 [00:11<00:17,  2.97s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9148, 'compress@10': 0.6351, 'time@10': 4.7448}:  40%|████      | 4/10 [00:15<00:17,  2.97s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9148, 'compress@10': 0.6351, 'time@10': 4.7448}:  50%|█████     | 5/10 [00:15<00:17,  3.41s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9233, 'compress@10': 0.6902, 'time@10': 4.9836}:  50%|█████     | 5/10 [00:21<00:17,  3.41s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9233, 'compress@10': 0.6902, 'time@10': 4.9836}:  60%|██████    | 6/10 [00:21<00:17,  4.36s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9249, 'compress@10': 0.6009, 'time@10': 5.236}:  60%|██████    | 6/10 [00:25<00:17,  4.36s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9249, 'compress@10': 0.6009, 'time@10': 5.236}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0148, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9254, 'compress@10': 0.5294, 'time@10': 5.1768}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0148, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9254, 'compress@10': 0.5294, 'time@10': 5.1768}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9291, 'compress@10': 0.5373, 'time@10': 5.5401}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9291, 'compress@10': 0.5373, 'time@10': 5.5401}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9323, 'compress@10': 0.4859, 'time@10': 5.59}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]     {'epoch': 26, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9323, 'compress@10': 0.4859, 'time@10': 5.59}: 100%|██████████| 10/10 [00:40<00:00,  4.84s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9323, 'compress@10': 0.4859, 'time@10': 5.59}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.014174055945782593
Avg hit ratio: 0.8979096102916136
Avg ndcg: 0.9322590326945237
Avg compression ratio: 0.485881003836554
Avg train time: 5.589998006820679
Std train time: 1.74872565029829
[0.8964285714285714, 0.2535714285714286, 0.0392857142857143, 0.8607142857142857, 0.9321428571428569, 0.682142857142857, 0.39642857142857146, 0.18214285714285713, 0.5035714285714286, 0.11071428571428571]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9063, 'compress@10': 0.9998, 'time@10': 4.5008}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9063, 'compress@10': 0.9998, 'time@10': 4.5008}:  10%|█         | 1/10 [00:02<00:20,  2.29s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9316, 'compress@10': 0.5168, 'time@10': 4.2521}:  10%|█         | 1/10 [00:06<00:20,  2.29s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9316, 'compress@10': 0.5168, 'time@10': 4.2521}:  20%|██        | 2/10 [00:06<00:26,  3.32s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9068, 'compress@10': 0.3922, 'time@10': 4.0094}:  20%|██        | 2/10 [00:08<00:26,  3.32s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9068, 'compress@10': 0.3922, 'time@10': 4.0094}:  30%|███       | 3/10 [00:08<00:18,  2.63s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.9189, 'compress@10': 0.5439, 'time@10': 3.907}:  30%|███       | 3/10 [00:11<00:18,  2.63s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.9189, 'compress@10': 0.5439, 'time@10': 3.907}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.9153, 'compress@10': 0.6351, 'time@10': 4.7778}:  40%|████      | 4/10 [00:15<00:18,  3.04s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.9153, 'compress@10': 0.6351, 'time@10': 4.7778}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9241, 'compress@10': 0.687, 'time@10': 5.0169}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9241, 'compress@10': 0.687, 'time@10': 5.0169}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9257, 'compress@10': 0.6009, 'time@10': 5.262}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it] {'epoch': 27, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9257, 'compress@10': 0.6009, 'time@10': 5.262}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9292, 'compress@10': 0.5294, 'time@10': 5.1982}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9292, 'compress@10': 0.5294, 'time@10': 5.1982}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9323, 'compress@10': 0.5302, 'time@10': 5.5551}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9323, 'compress@10': 0.5302, 'time@10': 5.5551}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9369, 'compress@10': 0.4795, 'time@10': 5.5968}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9369, 'compress@10': 0.4795, 'time@10': 5.5968}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9369, 'compress@10': 0.4795, 'time@10': 5.5968}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.016336388907812027
Avg hit ratio: 0.8889695181257151
Avg ndcg: 0.9369006998405636
Avg compression ratio: 0.47946680236122186
Avg train time: 5.596770715713501
Std train time: 1.7194731000446632
[0.8999999999999999, 0.27931034482758627, 0.037931034482758634, 0.8655172413793103, 0.9344827586206894, 0.693103448275862, 0.3827586206896552, 0.17586206896551723, 0.4862068965517241, 0.10689655172413792]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9112, 'compress@10': 0.9998, 'time@10': 4.4439}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9112, 'compress@10': 0.9998, 'time@10': 4.4439}:  10%|█         | 1/10 [00:02<00:20,  2.26s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9383, 'compress@10': 0.5174, 'time@10': 4.0786}:  10%|█         | 1/10 [00:06<00:20,  2.26s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9383, 'compress@10': 0.5174, 'time@10': 4.0786}:  20%|██        | 2/10 [00:06<00:25,  3.16s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9112, 'compress@10': 0.3925, 'time@10': 3.8791}:  20%|██        | 2/10 [00:07<00:25,  3.16s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9112, 'compress@10': 0.3925, 'time@10': 3.8791}:  30%|███       | 3/10 [00:07<00:17,  2.53s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.923, 'compress@10': 0.5443, 'time@10': 3.783}:  30%|███       | 3/10 [00:11<00:17,  2.53s/it]  {'epoch': 28, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.923, 'compress@10': 0.5443, 'time@10': 3.783}:  40%|████      | 4/10 [00:11<00:17,  2.93s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9191, 'compress@10': 0.6354, 'time@10': 4.6828}:  40%|████      | 4/10 [00:15<00:17,  2.93s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9191, 'compress@10': 0.6354, 'time@10': 4.6828}:  50%|█████     | 5/10 [00:15<00:16,  3.38s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9228, 'compress@10': 0.6877, 'time@10': 4.9315}:  50%|█████     | 5/10 [00:21<00:16,  3.38s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9228, 'compress@10': 0.6877, 'time@10': 4.9315}:  60%|██████    | 6/10 [00:21<00:17,  4.34s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0168, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9235, 'compress@10': 0.6002, 'time@10': 5.1987}:  60%|██████    | 6/10 [00:25<00:17,  4.34s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0168, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9235, 'compress@10': 0.6002, 'time@10': 5.1987}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9283, 'compress@10': 0.5288, 'time@10': 5.1408}:  70%|███████   | 7/10 [00:29<00:12,  4.05s/it]  {'epoch': 28, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9283, 'compress@10': 0.5288, 'time@10': 5.1408}:  80%|████████  | 8/10 [00:29<00:08,  4.28s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9446, 'compress@10': 0.5017, 'time@10': 5.5003}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9446, 'compress@10': 0.5017, 'time@10': 5.5003}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9433, 'compress@10': 0.4538, 'time@10': 5.5531}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]    {'epoch': 28, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9433, 'compress@10': 0.4538, 'time@10': 5.5531}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9433, 'compress@10': 0.4538, 'time@10': 5.5531}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01956249312501347
Avg hit ratio: 0.8920104537982297
Avg ndcg: 0.943334783604816
Avg compression ratio: 0.45382315155470454
Avg train time: 5.553050899505616
Std train time: 1.772209778271239
[0.9033333333333332, 0.2700000000000001, 0.03666666666666668, 0.8366666666666667, 0.9366666666666664, 0.7033333333333333, 0.37000000000000005, 0.16999999999999998, 0.5033333333333333, 0.13666666666666666]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9133, 'compress@10': 0.9998, 'time@10': 4.7391}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9133, 'compress@10': 0.9998, 'time@10': 4.7391}:  10%|█         | 1/10 [00:02<00:21,  2.40s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9376, 'compress@10': 0.5173, 'time@10': 4.2561}:  10%|█         | 1/10 [00:06<00:21,  2.40s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9376, 'compress@10': 0.5173, 'time@10': 4.2561}:  20%|██        | 2/10 [00:06<00:25,  3.23s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9108, 'compress@10': 0.3925, 'time@10': 4.0642}:  20%|██        | 2/10 [00:08<00:25,  3.23s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9108, 'compress@10': 0.3925, 'time@10': 4.0642}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9231, 'compress@10': 0.5441, 'time@10': 3.9042}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9231, 'compress@10': 0.5441, 'time@10': 3.9042}:  40%|████      | 4/10 [00:11<00:17,  2.95s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9212, 'compress@10': 0.6352, 'time@10': 4.8073}:  40%|████      | 4/10 [00:15<00:17,  2.95s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9212, 'compress@10': 0.6352, 'time@10': 4.8073}:  50%|█████     | 5/10 [00:15<00:17,  3.42s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9288, 'compress@10': 0.6904, 'time@10': 5.0362}:  50%|█████     | 5/10 [00:22<00:17,  3.42s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9288, 'compress@10': 0.6904, 'time@10': 5.0362}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9302, 'compress@10': 0.6012, 'time@10': 5.2799}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it] {'epoch': 29, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9302, 'compress@10': 0.6012, 'time@10': 5.2799}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.9335, 'compress@10': 0.5297, 'time@10': 5.2072}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.9335, 'compress@10': 0.5297, 'time@10': 5.2072}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9317, 'compress@10': 0.5318, 'time@10': 5.5624}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9317, 'compress@10': 0.5318, 'time@10': 5.5624}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9355, 'compress@10': 0.4809, 'time@10': 5.6075}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9355, 'compress@10': 0.4809, 'time@10': 5.6075}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9355, 'compress@10': 0.4809, 'time@10': 5.6075}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.01487898718444837
Avg hit ratio: 0.8998271460665347
Avg ndcg: 0.9355391501607822
Avg compression ratio: 0.4809297534479556
Avg train time: 5.607491612434387
Std train time: 1.7587964053112286
[0.9064516129032257, 0.2612903225806452, 0.03548387096774195, 0.8419354838709677, 0.9387096774193546, 0.6806451612903225, 0.3580645161290323, 0.19677419354838707, 0.5193548387096774, 0.13225806451612904]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9129, 'compress@10': 0.9998, 'time@10': 4.8087}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9129, 'compress@10': 0.9998, 'time@10': 4.8087}:  10%|█         | 1/10 [00:02<00:21,  2.44s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9348, 'compress@10': 0.5171, 'time@10': 4.2609}:  10%|█         | 1/10 [00:06<00:21,  2.44s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9348, 'compress@10': 0.5171, 'time@10': 4.2609}:  20%|██        | 2/10 [00:06<00:25,  3.22s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9089, 'compress@10': 0.3924, 'time@10': 4.0759}:  20%|██        | 2/10 [00:08<00:25,  3.22s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9089, 'compress@10': 0.3924, 'time@10': 4.0759}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9212, 'compress@10': 0.5441, 'time@10': 3.9461}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9212, 'compress@10': 0.5441, 'time@10': 3.9461}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9192, 'compress@10': 0.6352, 'time@10': 4.8271}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9192, 'compress@10': 0.6352, 'time@10': 4.8271}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9279, 'compress@10': 0.6869, 'time@10': 5.0615}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9279, 'compress@10': 0.6869, 'time@10': 5.0615}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9309, 'compress@10': 0.5979, 'time@10': 5.296}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9309, 'compress@10': 0.5979, 'time@10': 5.296}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9335, 'compress@10': 0.5268, 'time@10': 5.2217}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9335, 'compress@10': 0.5268, 'time@10': 5.2217}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9333, 'compress@10': 0.5379, 'time@10': 5.6004}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9333, 'compress@10': 0.5379, 'time@10': 5.6004}:  90%|█████████ | 9/10 [00:34<00:04,  4.32s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9375, 'compress@10': 0.4864, 'time@10': 5.6453}:  90%|█████████ | 9/10 [00:40<00:04,  4.32s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9375, 'compress@10': 0.4864, 'time@10': 5.6453}: 100%|██████████| 10/10 [00:40<00:00,  4.88s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9375, 'compress@10': 0.4864, 'time@10': 5.6453}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.015928493124444783
Avg hit ratio: 0.8943791173926998
Avg ndcg: 0.937476405838703
Avg compression ratio: 0.48641294469500007
Avg train time: 5.645288562774658
Std train time: 1.7693514050209374
[0.9093749999999999, 0.25312500000000004, 0.03437500000000002, 0.8468749999999999, 0.9406249999999998, 0.6906249999999999, 0.34687500000000004, 0.190625, 0.5343749999999999, 0.12812500000000002]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9169, 'compress@10': 0.9998, 'time@10': 4.7421}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9169, 'compress@10': 0.9998, 'time@10': 4.7421}:  10%|█         | 1/10 [00:02<00:21,  2.41s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9647, 'compress@10': 0.5169, 'time@10': 4.2482}:  10%|█         | 1/10 [00:06<00:21,  2.41s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9647, 'compress@10': 0.5169, 'time@10': 4.2482}:  20%|██        | 2/10 [00:06<00:25,  3.22s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9289, 'compress@10': 0.3922, 'time@10': 4.0023}:  20%|██        | 2/10 [00:07<00:25,  3.22s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9289, 'compress@10': 0.3922, 'time@10': 4.0023}:  30%|███       | 3/10 [00:07<00:18,  2.57s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9362, 'compress@10': 0.544, 'time@10': 3.8326}:  30%|███       | 3/10 [00:11<00:18,  2.57s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9362, 'compress@10': 0.544, 'time@10': 3.8326}:  40%|████      | 4/10 [00:11<00:17,  2.88s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9317, 'compress@10': 0.6352, 'time@10': 4.7214}:  40%|████      | 4/10 [00:15<00:17,  2.88s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9317, 'compress@10': 0.6352, 'time@10': 4.7214}:  50%|█████     | 5/10 [00:15<00:16,  3.35s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9388, 'compress@10': 0.6898, 'time@10': 4.9602}:  50%|█████     | 5/10 [00:21<00:16,  3.35s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9388, 'compress@10': 0.6898, 'time@10': 4.9602}:  60%|██████    | 6/10 [00:21<00:17,  4.32s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9372, 'compress@10': 0.5998, 'time@10': 5.2093}:  60%|██████    | 6/10 [00:25<00:17,  4.32s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9372, 'compress@10': 0.5998, 'time@10': 5.2093}:  70%|███████   | 7/10 [00:25<00:12,  4.02s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9404, 'compress@10': 0.5285, 'time@10': 5.1442}:  70%|███████   | 7/10 [00:29<00:12,  4.02s/it]  {'epoch': 31, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9404, 'compress@10': 0.5285, 'time@10': 5.1442}:  80%|████████  | 8/10 [00:29<00:08,  4.24s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.894, 'ndcg@10': 0.955, 'compress@10': 0.5461, 'time@10': 5.5333}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.894, 'ndcg@10': 0.955, 'compress@10': 0.5461, 'time@10': 5.5333}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9515, 'compress@10': 0.4938, 'time@10': 5.5884}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it] {'epoch': 31, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9515, 'compress@10': 0.4938, 'time@10': 5.5884}: 100%|██████████| 10/10 [00:40<00:00,  4.85s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9515, 'compress@10': 0.4938, 'time@10': 5.5884}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.017269513982846547
Avg hit ratio: 0.9023156253292077
Avg ndcg: 0.9515054357660653
Avg compression ratio: 0.4938203667149591
Avg train time: 5.588431692123413
Std train time: 1.8090389085248642
[0.9121212121212121, 0.2757575757575758, 0.03333333333333335, 0.8212121212121212, 0.912121212121212, 0.6696969696969697, 0.3666666666666667, 0.18484848484848485, 0.5484848484848485, 0.15454545454545457]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.919, 'compress@10': 0.9998, 'time@10': 5.0984}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.919, 'compress@10': 0.9998, 'time@10': 5.0984}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9399, 'compress@10': 0.5172, 'time@10': 4.4651}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9399, 'compress@10': 0.5172, 'time@10': 4.4651}:  20%|██        | 2/10 [00:06<00:26,  3.34s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9123, 'compress@10': 0.3924, 'time@10': 4.1617}:  20%|██        | 2/10 [00:08<00:26,  3.34s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9123, 'compress@10': 0.3924, 'time@10': 4.1617}:  30%|███       | 3/10 [00:08<00:18,  2.65s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9244, 'compress@10': 0.544, 'time@10': 4.016}:  30%|███       | 3/10 [00:11<00:18,  2.65s/it]  {'epoch': 32, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9244, 'compress@10': 0.544, 'time@10': 4.016}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9237, 'compress@10': 0.6352, 'time@10': 4.8922}:  40%|████      | 4/10 [00:16<00:18,  3.03s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9237, 'compress@10': 0.6352, 'time@10': 4.8922}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9311, 'compress@10': 0.6875, 'time@10': 5.117}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9311, 'compress@10': 0.6875, 'time@10': 5.117}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9332, 'compress@10': 0.599, 'time@10': 5.3427}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9332, 'compress@10': 0.599, 'time@10': 5.3427}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9364, 'compress@10': 0.5278, 'time@10': 5.2629}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9364, 'compress@10': 0.5278, 'time@10': 5.2629}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.93, 'compress@10': 0.5538, 'time@10': 5.6217}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.93, 'compress@10': 0.5538, 'time@10': 5.6217}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9344, 'compress@10': 0.5008, 'time@10': 5.6672}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9344, 'compress@10': 0.5008, 'time@10': 5.6672}: 100%|██████████| 10/10 [00:40<00:00,  4.86s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9344, 'compress@10': 0.5008, 'time@10': 5.6672}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.014144968690723018
Avg hit ratio: 0.8979735874387826
Avg ndcg: 0.9344167284223358
Avg compression ratio: 0.5007543484287409
Avg train time: 5.667196249961853
Std train time: 1.744417206301679
[0.9147058823529411, 0.26764705882352946, 0.0323529411764706, 0.7970588235294117, 0.914705882352941, 0.6794117647058824, 0.3558823529411765, 0.2088235294117647, 0.5617647058823529, 0.15000000000000002]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.914, 'compress@10': 0.9999, 'time@10': 4.7908}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.914, 'compress@10': 0.9999, 'time@10': 4.7908}:  10%|█         | 1/10 [00:02<00:21,  2.44s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9497, 'compress@10': 0.517, 'time@10': 4.2843}:  10%|█         | 1/10 [00:06<00:21,  2.44s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9497, 'compress@10': 0.517, 'time@10': 4.2843}:  20%|██        | 2/10 [00:06<00:25,  3.25s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9188, 'compress@10': 0.3923, 'time@10': 4.0168}:  20%|██        | 2/10 [00:08<00:25,  3.25s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9188, 'compress@10': 0.3923, 'time@10': 4.0168}:  30%|███       | 3/10 [00:08<00:18,  2.58s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.929, 'compress@10': 0.5437, 'time@10': 3.8628}:  30%|███       | 3/10 [00:11<00:18,  2.58s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.929, 'compress@10': 0.5437, 'time@10': 3.8628}:  40%|████      | 4/10 [00:11<00:17,  2.92s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0144, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9277, 'compress@10': 0.6349, 'time@10': 4.7366}:  40%|████      | 4/10 [00:15<00:17,  2.92s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0144, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9277, 'compress@10': 0.6349, 'time@10': 4.7366}:  50%|█████     | 5/10 [00:15<00:16,  3.36s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9354, 'compress@10': 0.6898, 'time@10': 4.9728}:  50%|█████     | 5/10 [00:21<00:16,  3.36s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9354, 'compress@10': 0.6898, 'time@10': 4.9728}:  60%|██████    | 6/10 [00:21<00:17,  4.33s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0123, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9373, 'compress@10': 0.6014, 'time@10': 5.21}:  60%|██████    | 6/10 [00:25<00:17,  4.33s/it]  {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0123, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9373, 'compress@10': 0.6014, 'time@10': 5.21}:  70%|███████   | 7/10 [00:25<00:12,  4.01s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9396, 'compress@10': 0.5299, 'time@10': 5.1479}:  70%|███████   | 7/10 [00:29<00:12,  4.01s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9396, 'compress@10': 0.5299, 'time@10': 5.1479}:  80%|████████  | 8/10 [00:29<00:08,  4.25s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9461, 'compress@10': 0.5632, 'time@10': 5.5246}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9461, 'compress@10': 0.5632, 'time@10': 5.5246}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.949, 'compress@10': 0.5092, 'time@10': 5.5792}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]    {'epoch': 33, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.949, 'compress@10': 0.5092, 'time@10': 5.5792}: 100%|██████████| 10/10 [00:40<00:00,  4.84s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.949, 'compress@10': 0.5092, 'time@10': 5.5792}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.013388337642647612
Avg hit ratio: 0.9033192095585983
Avg ndcg: 0.9489882443431593
Avg compression ratio: 0.5091738926664395
Avg train time: 5.579224061965943
Std train time: 1.76725694642413
[0.9171428571428571, 0.2885714285714286, 0.03142857142857144, 0.8028571428571428, 0.917142857142857, 0.66, 0.34571428571428575, 0.20285714285714287, 0.5742857142857143, 0.14571428571428574]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.915, 'compress@10': 0.9999, 'time@10': 4.723}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.915, 'compress@10': 0.9999, 'time@10': 4.723}:  10%|█         | 1/10 [00:02<00:21,  2.40s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9414, 'compress@10': 0.5174, 'time@10': 4.2721}:  10%|█         | 1/10 [00:06<00:21,  2.40s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9414, 'compress@10': 0.5174, 'time@10': 4.2721}:  20%|██        | 2/10 [00:06<00:26,  3.26s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9133, 'compress@10': 0.3925, 'time@10': 4.0201}:  20%|██        | 2/10 [00:08<00:26,  3.26s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9133, 'compress@10': 0.3925, 'time@10': 4.0201}:  30%|███       | 3/10 [00:08<00:18,  2.59s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9249, 'compress@10': 0.544, 'time@10': 3.8896}:  30%|███       | 3/10 [00:11<00:18,  2.59s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9249, 'compress@10': 0.544, 'time@10': 3.8896}:  40%|████      | 4/10 [00:11<00:17,  2.97s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9243, 'compress@10': 0.6351, 'time@10': 4.7796}:  40%|████      | 4/10 [00:15<00:17,  2.97s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9243, 'compress@10': 0.6351, 'time@10': 4.7796}:  50%|█████     | 5/10 [00:15<00:17,  3.42s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9355, 'compress@10': 0.6871, 'time@10': 5.0217}:  50%|█████     | 5/10 [00:22<00:17,  3.42s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9355, 'compress@10': 0.6871, 'time@10': 5.0217}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9367, 'compress@10': 0.5979, 'time@10': 5.2621}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it] {'epoch': 34, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9367, 'compress@10': 0.5979, 'time@10': 5.2621}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9399, 'compress@10': 0.5268, 'time@10': 5.188}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9399, 'compress@10': 0.5268, 'time@10': 5.188}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9397, 'compress@10': 0.5616, 'time@10': 5.5518}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9397, 'compress@10': 0.5616, 'time@10': 5.5518}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9392, 'compress@10': 0.5078, 'time@10': 5.5981}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]  {'epoch': 34, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9392, 'compress@10': 0.5078, 'time@10': 5.5981}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9392, 'compress@10': 0.5078, 'time@10': 5.5981}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.015904666351079226
Avg hit ratio: 0.9031993938903955
Avg ndcg: 0.9391803911794797
Avg compression ratio: 0.5077594216608091
Avg train time: 5.598103260993957
Std train time: 1.762171295305496
[0.9194444444444444, 0.28055555555555556, 0.030555555555555565, 0.7805555555555556, 0.8916666666666666, 0.6694444444444445, 0.36388888888888893, 0.19722222222222224, 0.5861111111111111, 0.16944444444444448]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.919, 'compress@10': 0.9999, 'time@10': 4.8178}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.919, 'compress@10': 0.9999, 'time@10': 4.8178}:  10%|█         | 1/10 [00:02<00:22,  2.45s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.893, 'ndcg@10': 0.941, 'compress@10': 0.5172, 'time@10': 4.3378}:  10%|█         | 1/10 [00:06<00:22,  2.45s/it] {'epoch': 35, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.893, 'ndcg@10': 0.941, 'compress@10': 0.5172, 'time@10': 4.3378}:  20%|██        | 2/10 [00:06<00:26,  3.30s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.913, 'compress@10': 0.3924, 'time@10': 4.0436}:  20%|██        | 2/10 [00:08<00:26,  3.30s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.913, 'compress@10': 0.3924, 'time@10': 4.0436}:  30%|███       | 3/10 [00:08<00:18,  2.60s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9253, 'compress@10': 0.5435, 'time@10': 3.8708}:  30%|███       | 3/10 [00:11<00:18,  2.60s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9253, 'compress@10': 0.5435, 'time@10': 3.8708}:  40%|████      | 4/10 [00:11<00:17,  2.91s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9258, 'compress@10': 0.6348, 'time@10': 4.7549}:  40%|████      | 4/10 [00:15<00:17,  2.91s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9258, 'compress@10': 0.6348, 'time@10': 4.7549}:  50%|█████     | 5/10 [00:15<00:16,  3.37s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.934, 'compress@10': 0.6899, 'time@10': 4.9987}:  50%|█████     | 5/10 [00:21<00:16,  3.37s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.934, 'compress@10': 0.6899, 'time@10': 4.9987}:  60%|██████    | 6/10 [00:21<00:17,  4.35s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9363, 'compress@10': 0.6016, 'time@10': 5.2348}:  60%|██████    | 6/10 [00:25<00:17,  4.35s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9363, 'compress@10': 0.6016, 'time@10': 5.2348}:  70%|███████   | 7/10 [00:25<00:12,  4.03s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9397, 'compress@10': 0.5301, 'time@10': 5.1749}:  70%|███████   | 7/10 [00:30<00:12,  4.03s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9397, 'compress@10': 0.5301, 'time@10': 5.1749}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9438, 'compress@10': 0.57, 'time@10': 5.561}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]  {'epoch': 35, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9438, 'compress@10': 0.57, 'time@10': 5.561}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0104, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.947, 'compress@10': 0.5153, 'time@10': 5.6107}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it] {'epoch': 35, 'num_users': 6.3, 'loss': 0.0104, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.947, 'compress@10': 0.5153, 'time@10': 5.6107}: 100%|██████████| 10/10 [00:40<00:00,  4.86s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0104, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.947, 'compress@10': 0.5153, 'time@10': 5.6107}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.010382905821008474
Avg hit ratio: 0.8961128603522491
Avg ndcg: 0.9470258424585559
Avg compression ratio: 0.515308600511444
Avg train time: 5.610706639289856
Std train time: 1.7958339338624114
[0.9216216216216215, 0.27297297297297296, 0.02972972972972974, 0.7864864864864864, 0.8945945945945946, 0.6513513513513514, 0.38108108108108113, 0.1918918918918919, 0.5972972972972973, 0.1648648648648649]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.915, 'compress@10': 0.9999, 'time@10': 4.8008}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.915, 'compress@10': 0.9999, 'time@10': 4.8008}:  10%|█         | 1/10 [00:02<00:22,  2.45s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9497, 'compress@10': 0.5171, 'time@10': 4.3288}:  10%|█         | 1/10 [00:06<00:22,  2.45s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9497, 'compress@10': 0.5171, 'time@10': 4.3288}:  20%|██        | 2/10 [00:06<00:26,  3.30s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9188, 'compress@10': 0.3924, 'time@10': 4.0692}:  20%|██        | 2/10 [00:08<00:26,  3.30s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9188, 'compress@10': 0.3924, 'time@10': 4.0692}:  30%|███       | 3/10 [00:08<00:18,  2.63s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9297, 'compress@10': 0.5436, 'time@10': 3.9051}:  30%|███       | 3/10 [00:11<00:18,  2.63s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9297, 'compress@10': 0.5436, 'time@10': 3.9051}:  40%|████      | 4/10 [00:11<00:17,  2.96s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.929, 'compress@10': 0.6348, 'time@10': 4.7719}:  40%|████      | 4/10 [00:15<00:17,  2.96s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.929, 'compress@10': 0.6348, 'time@10': 4.7719}:  50%|█████     | 5/10 [00:15<00:16,  3.39s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9387, 'compress@10': 0.6861, 'time@10': 4.9964}:  50%|█████     | 5/10 [00:21<00:16,  3.39s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9387, 'compress@10': 0.6861, 'time@10': 4.9964}:  60%|██████    | 6/10 [00:21<00:17,  4.33s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9409, 'compress@10': 0.601, 'time@10': 5.2591}:  60%|██████    | 6/10 [00:25<00:17,  4.33s/it] {'epoch': 36, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9409, 'compress@10': 0.601, 'time@10': 5.2591}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9417, 'compress@10': 0.5295, 'time@10': 5.1823}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9417, 'compress@10': 0.5295, 'time@10': 5.1823}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9404, 'compress@10': 0.5696, 'time@10': 5.5595}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9404, 'compress@10': 0.5696, 'time@10': 5.5595}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9437, 'compress@10': 0.515, 'time@10': 5.6022}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9437, 'compress@10': 0.515, 'time@10': 5.6022}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9437, 'compress@10': 0.515, 'time@10': 5.6022}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.015059888910698186
Avg hit ratio: 0.8853192095585983
Avg ndcg: 0.9436660547193529
Avg compression ratio: 0.5150001641991715
Avg train time: 5.602203035354615
Std train time: 1.7706240197553638
[0.9236842105263157, 0.2921052631578947, 0.02894736842105264, 0.7657894736842105, 0.8710526315789473, 0.6605263157894737, 0.3710526315789474, 0.1868421052631579, 0.6078947368421053, 0.18684210526315792]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.9999, 'time@10': 4.9066}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.9999, 'time@10': 4.9066}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9428, 'compress@10': 0.5175, 'time@10': 4.3753}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9428, 'compress@10': 0.5175, 'time@10': 4.3753}:  20%|██        | 2/10 [00:06<00:26,  3.32s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9142, 'compress@10': 0.3926, 'time@10': 4.1338}:  20%|██        | 2/10 [00:08<00:26,  3.32s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9142, 'compress@10': 0.3926, 'time@10': 4.1338}:  30%|███       | 3/10 [00:08<00:18,  2.65s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9262, 'compress@10': 0.5433, 'time@10': 3.9699}:  30%|███       | 3/10 [00:11<00:18,  2.65s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9262, 'compress@10': 0.5433, 'time@10': 3.9699}:  40%|████      | 4/10 [00:11<00:17,  2.99s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.927, 'compress@10': 0.6346, 'time@10': 4.8307}:  40%|████      | 4/10 [00:15<00:17,  2.99s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.927, 'compress@10': 0.6346, 'time@10': 4.8307}:  50%|█████     | 5/10 [00:15<00:17,  3.42s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.935, 'compress@10': 0.689, 'time@10': 5.0586}:  50%|█████     | 5/10 [00:22<00:17,  3.42s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.935, 'compress@10': 0.689, 'time@10': 5.0586}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9365, 'compress@10': 0.6012, 'time@10': 5.2879}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9365, 'compress@10': 0.6012, 'time@10': 5.2879}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9395, 'compress@10': 0.5297, 'time@10': 5.2022}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9395, 'compress@10': 0.5297, 'time@10': 5.2022}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9502, 'compress@10': 0.5733, 'time@10': 5.5791}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9502, 'compress@10': 0.5733, 'time@10': 5.5791}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9504, 'compress@10': 0.5183, 'time@10': 5.621}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]    {'epoch': 37, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9504, 'compress@10': 0.5183, 'time@10': 5.621}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9504, 'compress@10': 0.5183, 'time@10': 5.621}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.012782471112234526
Avg hit ratio: 0.8957441967577792
Avg ndcg: 0.9504123472670758
Avg compression ratio: 0.5182854467798966
Avg train time: 5.621011710166931
Std train time: 1.7499021520747564
[0.9256410256410256, 0.2846153846153846, 0.028205128205128212, 0.7461538461538461, 0.8743589743589743, 0.6435897435897436, 0.38717948717948725, 0.18205128205128204, 0.617948717948718, 0.20769230769230773]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.9999, 'time@10': 4.8168}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.9999, 'time@10': 4.8168}:  10%|█         | 1/10 [00:02<00:22,  2.45s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9428, 'compress@10': 0.5172, 'time@10': 4.2674}:  10%|█         | 1/10 [00:06<00:22,  2.45s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9428, 'compress@10': 0.5172, 'time@10': 4.2674}:  20%|██        | 2/10 [00:06<00:25,  3.22s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9142, 'compress@10': 0.3925, 'time@10': 3.8915}:  20%|██        | 2/10 [00:07<00:25,  3.22s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9142, 'compress@10': 0.3925, 'time@10': 3.8915}:  30%|███       | 3/10 [00:07<00:17,  2.48s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9262, 'compress@10': 0.5422, 'time@10': 3.8126}:  30%|███       | 3/10 [00:11<00:17,  2.48s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9262, 'compress@10': 0.5422, 'time@10': 3.8126}:  40%|████      | 4/10 [00:11<00:17,  2.93s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9284, 'compress@10': 0.6337, 'time@10': 4.6704}:  40%|████      | 4/10 [00:15<00:17,  2.93s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9284, 'compress@10': 0.6337, 'time@10': 4.6704}:  50%|█████     | 5/10 [00:15<00:16,  3.35s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9381, 'compress@10': 0.6856, 'time@10': 4.9269}:  50%|█████     | 5/10 [00:21<00:16,  3.35s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9381, 'compress@10': 0.6856, 'time@10': 4.9269}:  60%|██████    | 6/10 [00:21<00:17,  4.34s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9399, 'compress@10': 0.6008, 'time@10': 5.1748}:  60%|██████    | 6/10 [00:25<00:17,  4.34s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9399, 'compress@10': 0.6008, 'time@10': 5.1748}:  70%|███████   | 7/10 [00:25<00:12,  4.02s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9428, 'compress@10': 0.5294, 'time@10': 5.126}:  70%|███████   | 7/10 [00:30<00:12,  4.02s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9428, 'compress@10': 0.5294, 'time@10': 5.126}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.891, 'ndcg@10': 0.94, 'compress@10': 0.573, 'time@10': 5.5152}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]  {'epoch': 38, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.891, 'ndcg@10': 0.94, 'compress@10': 0.573, 'time@10': 5.5152}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9412, 'compress@10': 0.518, 'time@10': 5.5762}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9412, 'compress@10': 0.518, 'time@10': 5.5762}: 100%|██████████| 10/10 [00:40<00:00,  4.88s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9412, 'compress@10': 0.518, 'time@10': 5.5762}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.01347094806771735
Avg hit ratio: 0.8996049238443126
Avg ndcg: 0.9412066760493355
Avg compression ratio: 0.5180407501196347
Avg train time: 5.576234579086304
Std train time: 1.7936771523432429
[0.9274999999999999, 0.27749999999999997, 0.027500000000000007, 0.7525, 0.8524999999999999, 0.6525000000000001, 0.37750000000000006, 0.1775, 0.6275000000000001, 0.22750000000000004]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.9999, 'time@10': 5.0785}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.9999, 'time@10': 5.0785}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9444, 'compress@10': 0.5171, 'time@10': 4.3979}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it] {'epoch': 39, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9444, 'compress@10': 0.5171, 'time@10': 4.3979}:  20%|██        | 2/10 [00:06<00:26,  3.27s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9153, 'compress@10': 0.3923, 'time@10': 4.0598}:  20%|██        | 2/10 [00:08<00:26,  3.27s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9153, 'compress@10': 0.3923, 'time@10': 4.0598}:  30%|███       | 3/10 [00:08<00:17,  2.57s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9271, 'compress@10': 0.5427, 'time@10': 3.9222}:  30%|███       | 3/10 [00:11<00:17,  2.57s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9271, 'compress@10': 0.5427, 'time@10': 3.9222}:  40%|████      | 4/10 [00:11<00:17,  2.96s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9298, 'compress@10': 0.6341, 'time@10': 4.7637}:  40%|████      | 4/10 [00:15<00:17,  2.96s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9298, 'compress@10': 0.6341, 'time@10': 4.7637}:  50%|█████     | 5/10 [00:15<00:16,  3.37s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9375, 'compress@10': 0.6868, 'time@10': 5.0055}:  50%|█████     | 5/10 [00:21<00:16,  3.37s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9375, 'compress@10': 0.6868, 'time@10': 5.0055}:  60%|██████    | 6/10 [00:21<00:17,  4.35s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.01, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9398, 'compress@10': 0.6009, 'time@10': 5.2345}:  60%|██████    | 6/10 [00:25<00:17,  4.35s/it]  {'epoch': 39, 'num_users': 6.2857, 'loss': 0.01, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9398, 'compress@10': 0.6009, 'time@10': 5.2345}:  70%|███████   | 7/10 [00:25<00:12,  4.02s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9385, 'compress@10': 0.5294, 'time@10': 5.1484}:  70%|███████   | 7/10 [00:29<00:12,  4.02s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9385, 'compress@10': 0.5294, 'time@10': 5.1484}:  80%|████████  | 8/10 [00:29<00:08,  4.20s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.943, 'compress@10': 0.5755, 'time@10': 5.5352}:  80%|████████  | 8/10 [00:34<00:08,  4.20s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.943, 'compress@10': 0.5755, 'time@10': 5.5352}:  90%|█████████ | 9/10 [00:34<00:04,  4.25s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9465, 'compress@10': 0.5203, 'time@10': 5.5805}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]  {'epoch': 39, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9465, 'compress@10': 0.5203, 'time@10': 5.5805}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9465, 'compress@10': 0.5203, 'time@10': 5.5805}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.011275968379051234
Avg hit ratio: 0.9075414317808205
Avg ndcg: 0.9464672865515681
Avg compression ratio: 0.5203157915359812
Avg train time: 5.580534934997559
Std train time: 1.7701994827392022
[0.9048780487804877, 0.2951219512195122, 0.026829268292682933, 0.7585365853658536, 0.8560975609756096, 0.6365853658536587, 0.3682926829268293, 0.19756097560975608, 0.6365853658536585, 0.22195121951219515]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9237, 'compress@10': 0.9998, 'time@10': 5.0144}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9237, 'compress@10': 0.9998, 'time@10': 5.0144}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9986, 'compress@10': 0.5176, 'time@10': 4.4886}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9986, 'compress@10': 0.5176, 'time@10': 4.4886}:  20%|██        | 2/10 [00:06<00:27,  3.40s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9514, 'compress@10': 0.3927, 'time@10': 4.0467}:  20%|██        | 2/10 [00:08<00:27,  3.40s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9514, 'compress@10': 0.3927, 'time@10': 4.0467}:  30%|███       | 3/10 [00:08<00:18,  2.59s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9541, 'compress@10': 0.5433, 'time@10': 3.9176}:  30%|███       | 3/10 [00:11<00:18,  2.59s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9541, 'compress@10': 0.5433, 'time@10': 3.9176}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9516, 'compress@10': 0.6345, 'time@10': 4.781}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it] {'epoch': 40, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9516, 'compress@10': 0.6345, 'time@10': 4.781}:  50%|█████     | 5/10 [00:15<00:17,  3.40s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0161, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9524, 'compress@10': 0.6846, 'time@10': 5.0121}:  50%|█████     | 5/10 [00:22<00:17,  3.40s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0161, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9524, 'compress@10': 0.6846, 'time@10': 5.0121}:  60%|██████    | 6/10 [00:22<00:17,  4.36s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9526, 'compress@10': 0.597, 'time@10': 5.2512}:  60%|██████    | 6/10 [00:25<00:17,  4.36s/it] {'epoch': 40, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9526, 'compress@10': 0.597, 'time@10': 5.2512}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9552, 'compress@10': 0.526, 'time@10': 5.1828}:  70%|███████   | 7/10 [00:30<00:12,  4.04s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9552, 'compress@10': 0.526, 'time@10': 5.1828}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.955, 'compress@10': 0.5723, 'time@10': 5.5585}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.955, 'compress@10': 0.5723, 'time@10': 5.5585}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9537, 'compress@10': 0.5175, 'time@10': 5.6008}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it] {'epoch': 40, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9537, 'compress@10': 0.5175, 'time@10': 5.6008}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9537, 'compress@10': 0.5175, 'time@10': 5.6008}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.017051093623438714
Avg hit ratio: 0.8780934031069855
Avg ndcg: 0.9537435817708607
Avg compression ratio: 0.5174607964490677
Avg train time: 5.600815486907959
Std train time: 1.7727228110020086
[0.907142857142857, 0.3119047619047619, 0.026190476190476198, 0.7404761904761904, 0.8357142857142856, 0.6452380952380954, 0.3595238095238096, 0.19285714285714284, 0.6452380952380953, 0.2404761904761905]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9228, 'compress@10': 0.9998, 'time@10': 4.8078}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9228, 'compress@10': 0.9998, 'time@10': 4.8078}:  10%|█         | 1/10 [00:02<00:22,  2.45s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9404, 'compress@10': 0.518, 'time@10': 4.3071}:  10%|█         | 1/10 [00:06<00:22,  2.45s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9404, 'compress@10': 0.518, 'time@10': 4.3071}:  20%|██        | 2/10 [00:06<00:26,  3.27s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9126, 'compress@10': 0.393, 'time@10': 3.8559}:  20%|██        | 2/10 [00:07<00:26,  3.27s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9126, 'compress@10': 0.393, 'time@10': 3.8559}:  30%|███       | 3/10 [00:07<00:17,  2.47s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.925, 'compress@10': 0.5425, 'time@10': 3.7412}:  30%|███       | 3/10 [00:11<00:17,  2.47s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.925, 'compress@10': 0.5425, 'time@10': 3.7412}:  40%|████      | 4/10 [00:11<00:17,  2.85s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9286, 'compress@10': 0.6339, 'time@10': 4.6193}:  40%|████      | 4/10 [00:15<00:17,  2.85s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9286, 'compress@10': 0.6339, 'time@10': 4.6193}:  50%|█████     | 5/10 [00:15<00:16,  3.30s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9365, 'compress@10': 0.6846, 'time@10': 4.889}:  50%|█████     | 5/10 [00:21<00:16,  3.30s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9365, 'compress@10': 0.6846, 'time@10': 4.889}:  60%|██████    | 6/10 [00:21<00:17,  4.31s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0083, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9388, 'compress@10': 0.5961, 'time@10': 5.1675}:  60%|██████    | 6/10 [00:25<00:17,  4.31s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0083, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9388, 'compress@10': 0.5961, 'time@10': 5.1675}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9434, 'compress@10': 0.5252, 'time@10': 5.1026}:  70%|███████   | 7/10 [00:29<00:12,  4.04s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9434, 'compress@10': 0.5252, 'time@10': 5.1026}:  80%|████████  | 8/10 [00:29<00:08,  4.25s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9466, 'compress@10': 0.5734, 'time@10': 5.4951}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9466, 'compress@10': 0.5734, 'time@10': 5.4951}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9496, 'compress@10': 0.5184, 'time@10': 5.5411}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9496, 'compress@10': 0.5184, 'time@10': 5.5411}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9496, 'compress@10': 0.5184, 'time@10': 5.5411}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.01181623323522764
Avg hit ratio: 0.902195809661005
Avg ndcg: 0.9495778949210054
Avg compression ratio: 0.5184167370289535
Avg train time: 5.5411314249038695
Std train time: 1.8509765311901658
[0.8860465116279068, 0.32790697674418606, 0.025581395348837216, 0.7465116279069767, 0.8395348837209301, 0.630232558139535, 0.3511627906976745, 0.21162790697674416, 0.6534883720930232, 0.2348837209302326]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9237, 'compress@10': 0.9997, 'time@10': 5.0722}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9237, 'compress@10': 0.9997, 'time@10': 5.0722}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9478, 'compress@10': 0.5187, 'time@10': 4.5028}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9478, 'compress@10': 0.5187, 'time@10': 4.5028}:  20%|██        | 2/10 [00:06<00:27,  3.40s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9176, 'compress@10': 0.3934, 'time@10': 4.083}:  20%|██        | 2/10 [00:08<00:27,  3.40s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9176, 'compress@10': 0.3934, 'time@10': 4.083}:  30%|███       | 3/10 [00:08<00:18,  2.60s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9287, 'compress@10': 0.5434, 'time@10': 3.933}:  30%|███       | 3/10 [00:11<00:18,  2.60s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9287, 'compress@10': 0.5434, 'time@10': 3.933}:  40%|████      | 4/10 [00:11<00:17,  2.97s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9331, 'compress@10': 0.6346, 'time@10': 4.7678}:  40%|████      | 4/10 [00:15<00:17,  2.97s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9331, 'compress@10': 0.6346, 'time@10': 4.7678}:  50%|█████     | 5/10 [00:15<00:16,  3.37s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9395, 'compress@10': 0.6834, 'time@10': 5.0055}:  50%|█████     | 5/10 [00:22<00:16,  3.37s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9395, 'compress@10': 0.6834, 'time@10': 5.0055}:  60%|██████    | 6/10 [00:22<00:17,  4.35s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9418, 'compress@10': 0.5946, 'time@10': 5.2575}:  60%|██████    | 6/10 [00:25<00:17,  4.35s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9418, 'compress@10': 0.5946, 'time@10': 5.2575}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9456, 'compress@10': 0.5239, 'time@10': 5.1816}:  70%|███████   | 7/10 [00:30<00:12,  4.04s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9456, 'compress@10': 0.5239, 'time@10': 5.1816}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.945, 'compress@10': 0.5722, 'time@10': 5.5641}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.945, 'compress@10': 0.5722, 'time@10': 5.5641}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9479, 'compress@10': 0.5174, 'time@10': 5.6039}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]  {'epoch': 42, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9479, 'compress@10': 0.5174, 'time@10': 5.6039}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9479, 'compress@10': 0.5174, 'time@10': 5.6039}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.014486307523950814
Avg hit ratio: 0.8885450160102113
Avg ndcg: 0.947926099014462
Avg compression ratio: 0.5173545764357451
Avg train time: 5.603881525993347
Std train time: 1.7685336713891162
[0.8659090909090907, 0.3431818181818182, 0.025000000000000005, 0.7295454545454545, 0.8204545454545453, 0.6386363636363638, 0.34318181818181825, 0.22954545454545452, 0.6613636363636364, 0.2522727272727273]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9128, 'compress@10': 0.9996, 'time@10': 4.9752}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9128, 'compress@10': 0.9996, 'time@10': 4.9752}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9403, 'compress@10': 0.5198, 'time@10': 4.4233}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9403, 'compress@10': 0.5198, 'time@10': 4.4233}:  20%|██        | 2/10 [00:06<00:26,  3.34s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9126, 'compress@10': 0.3942, 'time@10': 4.1307}:  20%|██        | 2/10 [00:08<00:26,  3.34s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9126, 'compress@10': 0.3942, 'time@10': 4.1307}:  30%|███       | 3/10 [00:08<00:18,  2.64s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.925, 'compress@10': 0.5428, 'time@10': 3.9697}:  30%|███       | 3/10 [00:11<00:18,  2.64s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.925, 'compress@10': 0.5428, 'time@10': 3.9697}:  40%|████      | 4/10 [00:11<00:17,  2.99s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9289, 'compress@10': 0.6341, 'time@10': 4.7857}:  40%|████      | 4/10 [00:15<00:17,  2.99s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9289, 'compress@10': 0.6341, 'time@10': 4.7857}:  50%|█████     | 5/10 [00:15<00:16,  3.38s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9367, 'compress@10': 0.6839, 'time@10': 5.0252}:  50%|█████     | 5/10 [00:22<00:16,  3.38s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9367, 'compress@10': 0.6839, 'time@10': 5.0252}:  60%|██████    | 6/10 [00:22<00:17,  4.36s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9392, 'compress@10': 0.5942, 'time@10': 5.2771}:  60%|██████    | 6/10 [00:25<00:17,  4.36s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9392, 'compress@10': 0.5942, 'time@10': 5.2771}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9536, 'compress@10': 0.5237, 'time@10': 5.2038}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9536, 'compress@10': 0.5237, 'time@10': 5.2038}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9547, 'compress@10': 0.5735, 'time@10': 5.5871}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9547, 'compress@10': 0.5735, 'time@10': 5.5871}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9569, 'compress@10': 0.5186, 'time@10': 5.6335}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9569, 'compress@10': 0.5186, 'time@10': 5.6335}: 100%|██████████| 10/10 [00:40<00:00,  4.86s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9569, 'compress@10': 0.5186, 'time@10': 5.6335}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.010942709598033593
Avg hit ratio: 0.8938906381300269
Avg ndcg: 0.9569228976270889
Avg compression ratio: 0.5185849078770686
Avg train time: 5.633523631095886
Std train time: 1.7380675152182314
[0.8466666666666665, 0.33555555555555555, 0.02444444444444445, 0.7355555555555555, 0.8244444444444443, 0.6244444444444446, 0.35777777777777786, 0.24666666666666665, 0.6688888888888889, 0.2466666666666667]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9061, 'compress@10': 0.9996, 'time@10': 4.9247}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9061, 'compress@10': 0.9996, 'time@10': 4.9247}:  10%|█         | 1/10 [00:02<00:22,  2.50s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9363, 'compress@10': 0.5198, 'time@10': 4.4414}:  10%|█         | 1/10 [00:06<00:22,  2.50s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9363, 'compress@10': 0.5198, 'time@10': 4.4414}:  20%|██        | 2/10 [00:06<00:27,  3.38s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9099, 'compress@10': 0.3942, 'time@10': 4.2903}:  20%|██        | 2/10 [00:08<00:27,  3.38s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9099, 'compress@10': 0.3942, 'time@10': 4.2903}:  30%|███       | 3/10 [00:08<00:19,  2.77s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9235, 'compress@10': 0.5432, 'time@10': 4.1173}:  30%|███       | 3/10 [00:12<00:19,  2.77s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9235, 'compress@10': 0.5432, 'time@10': 4.1173}:  40%|████      | 4/10 [00:12<00:18,  3.11s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9288, 'compress@10': 0.6344, 'time@10': 4.9104}:  40%|████      | 4/10 [00:16<00:18,  3.11s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9288, 'compress@10': 0.6344, 'time@10': 4.9104}:  50%|█████     | 5/10 [00:16<00:17,  3.46s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9398, 'compress@10': 0.6809, 'time@10': 5.1206}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9398, 'compress@10': 0.6809, 'time@10': 5.1206}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0123, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.941, 'compress@10': 0.5922, 'time@10': 5.3447}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it] {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0123, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.941, 'compress@10': 0.5922, 'time@10': 5.3447}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9449, 'compress@10': 0.5219, 'time@10': 5.265}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9449, 'compress@10': 0.5219, 'time@10': 5.265}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9434, 'compress@10': 0.5714, 'time@10': 5.6321}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9434, 'compress@10': 0.5714, 'time@10': 5.6321}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9512, 'compress@10': 0.5167, 'time@10': 5.6757}:  90%|█████████ | 9/10 [00:41<00:04,  4.30s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9512, 'compress@10': 0.5167, 'time@10': 5.6757}: 100%|██████████| 10/10 [00:41<00:00,  4.86s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9512, 'compress@10': 0.5167, 'time@10': 5.6757}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.014768161933554697
Avg hit ratio: 0.8917708224618242
Avg ndcg: 0.9511871973812337
Avg compression ratio: 0.5166663559836704
Avg train time: 5.675650143623352
Std train time: 1.6494343501998872
[0.8499999999999998, 0.3282608695652174, 0.023913043478260874, 0.7195652173913043, 0.8065217391304347, 0.632608695652174, 0.3500000000000001, 0.26304347826086955, 0.6760869565217391, 0.2630434782608696]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9204, 'compress@10': 0.9996, 'time@10': 4.848}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9204, 'compress@10': 0.9996, 'time@10': 4.848}:  10%|█         | 1/10 [00:02<00:22,  2.46s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.97, 'compress@10': 0.519, 'time@10': 4.4687}:  10%|█         | 1/10 [00:06<00:22,  2.46s/it]  {'epoch': 45, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.97, 'compress@10': 0.519, 'time@10': 4.4687}:  20%|██        | 2/10 [00:06<00:27,  3.44s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9324, 'compress@10': 0.3937, 'time@10': 4.1055}:  20%|██        | 2/10 [00:08<00:27,  3.44s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9324, 'compress@10': 0.3937, 'time@10': 4.1055}:  30%|███       | 3/10 [00:08<00:18,  2.67s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9404, 'compress@10': 0.5411, 'time@10': 3.9407}:  30%|███       | 3/10 [00:11<00:18,  2.67s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9404, 'compress@10': 0.5411, 'time@10': 3.9407}:  40%|████      | 4/10 [00:11<00:17,  3.00s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9422, 'compress@10': 0.6327, 'time@10': 4.7247}:  40%|████      | 4/10 [00:15<00:17,  3.00s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9422, 'compress@10': 0.6327, 'time@10': 4.7247}:  50%|█████     | 5/10 [00:15<00:16,  3.35s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9479, 'compress@10': 0.6795, 'time@10': 5.0148}:  50%|█████     | 5/10 [00:22<00:16,  3.35s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9479, 'compress@10': 0.6795, 'time@10': 5.0148}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9494, 'compress@10': 0.5905, 'time@10': 5.2495}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9494, 'compress@10': 0.5905, 'time@10': 5.2495}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9523, 'compress@10': 0.5205, 'time@10': 5.1685}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9523, 'compress@10': 0.5205, 'time@10': 5.1685}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9536, 'compress@10': 0.5714, 'time@10': 5.5505}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9536, 'compress@10': 0.5714, 'time@10': 5.5505}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9538, 'compress@10': 0.5168, 'time@10': 5.5966}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9538, 'compress@10': 0.5168, 'time@10': 5.5966}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9538, 'compress@10': 0.5168, 'time@10': 5.5966}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.009629108272143142
Avg hit ratio: 0.8935219745355569
Avg ndcg: 0.9537581731181554
Avg compression ratio: 0.5167603131276535
Avg train time: 5.596577787399292
Std train time: 1.7205200159611125
[0.8319148936170211, 0.3425531914893617, 0.02340425531914894, 0.725531914893617, 0.8106382978723403, 0.6191489361702129, 0.3425531914893618, 0.2787234042553191, 0.6617021276595745, 0.27872340425531916]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9213, 'compress@10': 0.9994, 'time@10': 4.8921}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9213, 'compress@10': 0.9994, 'time@10': 4.8921}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9403, 'compress@10': 0.5203, 'time@10': 4.4492}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9403, 'compress@10': 0.5203, 'time@10': 4.4492}:  20%|██        | 2/10 [00:06<00:27,  3.40s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9126, 'compress@10': 0.3945, 'time@10': 4.0805}:  20%|██        | 2/10 [00:08<00:27,  3.40s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9126, 'compress@10': 0.3945, 'time@10': 4.0805}:  30%|███       | 3/10 [00:08<00:18,  2.63s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9255, 'compress@10': 0.5425, 'time@10': 3.9085}:  30%|███       | 3/10 [00:11<00:18,  2.63s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9255, 'compress@10': 0.5425, 'time@10': 3.9085}:  40%|████      | 4/10 [00:11<00:17,  2.95s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9315, 'compress@10': 0.6339, 'time@10': 4.7443}:  40%|████      | 4/10 [00:15<00:17,  2.95s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9315, 'compress@10': 0.6339, 'time@10': 4.7443}:  50%|█████     | 5/10 [00:15<00:16,  3.36s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9388, 'compress@10': 0.6784, 'time@10': 4.9991}:  50%|█████     | 5/10 [00:22<00:16,  3.36s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9388, 'compress@10': 0.6784, 'time@10': 4.9991}:  60%|██████    | 6/10 [00:22<00:17,  4.36s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9412, 'compress@10': 0.5891, 'time@10': 5.2477}:  60%|██████    | 6/10 [00:25<00:17,  4.36s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9412, 'compress@10': 0.5891, 'time@10': 5.2477}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9487, 'compress@10': 0.5194, 'time@10': 5.1749}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9487, 'compress@10': 0.5194, 'time@10': 5.1749}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9536, 'compress@10': 0.5687, 'time@10': 5.5639}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9536, 'compress@10': 0.5687, 'time@10': 5.5639}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.956, 'compress@10': 0.5144, 'time@10': 5.6084}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.956, 'compress@10': 0.5144, 'time@10': 5.6084}: 100%|██████████| 10/10 [00:40<00:00,  4.84s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.956, 'compress@10': 0.5144, 'time@10': 5.6084}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.011774366397429133
Avg hit ratio: 0.89785377177058
Avg ndcg: 0.9559823406922907
Avg compression ratio: 0.514375466957939
Avg train time: 5.608352875709533
Std train time: 1.7733123022781636
[0.8145833333333331, 0.35625, 0.02291666666666667, 0.7104166666666667, 0.8145833333333332, 0.6270833333333335, 0.33541666666666675, 0.29374999999999996, 0.66875, 0.2729166666666667]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9264, 'compress@10': 0.9992, 'time@10': 5.0454}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9264, 'compress@10': 0.9992, 'time@10': 5.0454}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9513, 'compress@10': 0.5214, 'time@10': 4.5684}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9513, 'compress@10': 0.5214, 'time@10': 4.5684}:  20%|██        | 2/10 [00:06<00:27,  3.48s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9199, 'compress@10': 0.3952, 'time@10': 4.0986}:  20%|██        | 2/10 [00:08<00:27,  3.48s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9199, 'compress@10': 0.3952, 'time@10': 4.0986}:  30%|███       | 3/10 [00:08<00:18,  2.63s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.931, 'compress@10': 0.5408, 'time@10': 3.924}:  30%|███       | 3/10 [00:11<00:18,  2.63s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.931, 'compress@10': 0.5408, 'time@10': 3.924}:  40%|████      | 4/10 [00:11<00:17,  2.95s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9356, 'compress@10': 0.6325, 'time@10': 4.7628}:  40%|████      | 4/10 [00:15<00:17,  2.95s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9356, 'compress@10': 0.6325, 'time@10': 4.7628}:  50%|█████     | 5/10 [00:15<00:16,  3.36s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9423, 'compress@10': 0.6781, 'time@10': 5.0108}:  50%|█████     | 5/10 [00:22<00:16,  3.36s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9423, 'compress@10': 0.6781, 'time@10': 5.0108}:  60%|██████    | 6/10 [00:22<00:17,  4.36s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9434, 'compress@10': 0.5884, 'time@10': 5.2677}:  60%|██████    | 6/10 [00:25<00:17,  4.36s/it] {'epoch': 47, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9434, 'compress@10': 0.5884, 'time@10': 5.2677}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9504, 'compress@10': 0.5189, 'time@10': 5.1839}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9504, 'compress@10': 0.5189, 'time@10': 5.1839}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9475, 'compress@10': 0.5684, 'time@10': 5.5621}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9475, 'compress@10': 0.5684, 'time@10': 5.5621}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9521, 'compress@10': 0.514, 'time@10': 5.6029}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9521, 'compress@10': 0.514, 'time@10': 5.6029}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9521, 'compress@10': 0.514, 'time@10': 5.6029}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.01372041828285842
Avg hit ratio: 0.902564473255475
Avg ndcg: 0.952054269918458
Avg compression ratio: 0.5140496038533128
Avg train time: 5.60288257598877
Std train time: 1.7799701245030932
[0.7979591836734692, 0.3693877551020408, 0.022448979591836737, 0.6959183673469388, 0.7979591836734693, 0.6142857142857145, 0.34897959183673477, 0.3081632653061224, 0.6755102040816326, 0.28775510204081634]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9218, 'compress@10': 0.999, 'time@10': 5.0143}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9218, 'compress@10': 0.999, 'time@10': 5.0143}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9448, 'compress@10': 0.5246, 'time@10': 4.5289}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9448, 'compress@10': 0.5246, 'time@10': 4.5289}:  20%|██        | 2/10 [00:06<00:27,  3.45s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9156, 'compress@10': 0.3973, 'time@10': 4.0651}:  20%|██        | 2/10 [00:08<00:27,  3.45s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9156, 'compress@10': 0.3973, 'time@10': 4.0651}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9277, 'compress@10': 0.5392, 'time@10': 3.8903}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9277, 'compress@10': 0.5392, 'time@10': 3.8903}:  40%|████      | 4/10 [00:11<00:17,  2.92s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9339, 'compress@10': 0.6312, 'time@10': 4.7379}:  40%|████      | 4/10 [00:15<00:17,  2.92s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9339, 'compress@10': 0.6312, 'time@10': 4.7379}:  50%|█████     | 5/10 [00:15<00:16,  3.35s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9409, 'compress@10': 0.6742, 'time@10': 4.988}:  50%|█████     | 5/10 [00:22<00:16,  3.35s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9409, 'compress@10': 0.6742, 'time@10': 4.988}:  60%|██████    | 6/10 [00:22<00:17,  4.35s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9436, 'compress@10': 0.5856, 'time@10': 5.2605}:  60%|██████    | 6/10 [00:25<00:17,  4.35s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9436, 'compress@10': 0.5856, 'time@10': 5.2605}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9489, 'compress@10': 0.5166, 'time@10': 5.1839}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9489, 'compress@10': 0.5166, 'time@10': 5.1839}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.008, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9506, 'compress@10': 0.5675, 'time@10': 5.5884}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it] {'epoch': 48, 'num_users': 6.3333, 'loss': 0.008, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9506, 'compress@10': 0.5675, 'time@10': 5.5884}:  90%|█████████ | 9/10 [00:34<00:04,  4.33s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9522, 'compress@10': 0.5133, 'time@10': 5.6389}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it] {'epoch': 48, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9522, 'compress@10': 0.5133, 'time@10': 5.6389}: 100%|██████████| 10/10 [00:40<00:00,  4.89s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9522, 'compress@10': 0.5133, 'time@10': 5.6389}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.008867301193399235
Avg hit ratio: 0.9103985746379634
Avg ndcg: 0.9522236718493998
Avg compression ratio: 0.51334337979265
Avg train time: 5.638916993141175
Std train time: 1.8394013194359515
[0.8019999999999998, 0.382, 0.022000000000000002, 0.7020000000000001, 0.7819999999999999, 0.6020000000000002, 0.3420000000000001, 0.32199999999999995, 0.662, 0.302]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.999, 'time@10': 4.9032}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.999, 'time@10': 4.9032}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9483, 'compress@10': 0.5298, 'time@10': 4.4954}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9483, 'compress@10': 0.5298, 'time@10': 4.4954}:  20%|██        | 2/10 [00:06<00:27,  3.45s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9179, 'compress@10': 0.4008, 'time@10': 4.0645}:  20%|██        | 2/10 [00:08<00:27,  3.45s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9179, 'compress@10': 0.4008, 'time@10': 4.0645}:  30%|███       | 3/10 [00:08<00:18,  2.62s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9295, 'compress@10': 0.5428, 'time@10': 3.8935}:  30%|███       | 3/10 [00:11<00:18,  2.62s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9295, 'compress@10': 0.5428, 'time@10': 3.8935}:  40%|████      | 4/10 [00:11<00:17,  2.94s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.007, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9344, 'compress@10': 0.6339, 'time@10': 4.7474}:  40%|████      | 4/10 [00:15<00:17,  2.94s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.007, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9344, 'compress@10': 0.6339, 'time@10': 4.7474}:  50%|█████     | 5/10 [00:15<00:16,  3.36s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9403, 'compress@10': 0.6712, 'time@10': 4.99}:  50%|█████     | 5/10 [00:22<00:16,  3.36s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9403, 'compress@10': 0.6712, 'time@10': 4.99}:  60%|██████    | 6/10 [00:22<00:17,  4.34s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9426, 'compress@10': 0.5828, 'time@10': 5.2271}:  60%|██████    | 6/10 [00:25<00:17,  4.34s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9426, 'compress@10': 0.5828, 'time@10': 5.2271}:  70%|███████   | 7/10 [00:25<00:12,  4.02s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9492, 'compress@10': 0.5145, 'time@10': 5.1379}:  70%|███████   | 7/10 [00:29<00:12,  4.02s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9492, 'compress@10': 0.5145, 'time@10': 5.1379}:  80%|████████  | 8/10 [00:29<00:08,  4.20s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9574, 'compress@10': 0.5636, 'time@10': 5.4663}:  80%|████████  | 8/10 [00:34<00:08,  4.20s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9574, 'compress@10': 0.5636, 'time@10': 5.4663}:  90%|█████████ | 9/10 [00:34<00:04,  4.17s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9594, 'compress@10': 0.5099, 'time@10': 5.4851}:  90%|█████████ | 9/10 [00:39<00:04,  4.17s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9594, 'compress@10': 0.5099, 'time@10': 5.4851}: 100%|██████████| 10/10 [00:39<00:00,  4.64s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9594, 'compress@10': 0.5099, 'time@10': 5.4851}: 100%|██████████| 10/10 [00:39<00:00,  3.98s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.01219633204097273
Avg hit ratio: 0.9056878731530684
Avg ndcg: 0.9594314235334878
Avg compression ratio: 0.5099149758636405
Avg train time: 5.485115122795105
Std train time: 1.6954761174767135
[0.7862745098039214, 0.37450980392156863, 0.021568627450980395, 0.707843137254902, 0.7862745098039214, 0.6098039215686276, 0.3352941176470589, 0.3352941176470588, 0.6686274509803922, 0.296078431372549]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
