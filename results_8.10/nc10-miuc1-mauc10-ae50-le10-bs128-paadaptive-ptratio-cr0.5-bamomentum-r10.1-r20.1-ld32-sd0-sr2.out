  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.253, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.4494, 'compress@10': 0.3836, 'time@10': 6.2217}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.253, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.4494, 'compress@10': 0.3836, 'time@10': 6.2217}:  10%|█         | 1/10 [00:03<00:28,  3.15s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1896, 'hit_ratio@10': 0.5272, 'ndcg@10': 0.5036, 'compress@10': 0.4246, 'time@10': 5.1919}:  10%|█         | 1/10 [00:07<00:28,  3.15s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1896, 'hit_ratio@10': 0.5272, 'ndcg@10': 0.5036, 'compress@10': 0.4246, 'time@10': 5.1919}:  20%|██        | 2/10 [00:07<00:30,  3.77s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8711, 'hit_ratio@10': 0.4943, 'ndcg@10': 0.3357, 'compress@10': 0.4685, 'time@10': 4.0112}:  20%|██        | 2/10 [00:08<00:30,  3.77s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8711, 'hit_ratio@10': 0.4943, 'ndcg@10': 0.3357, 'compress@10': 0.4685, 'time@10': 4.0112}:  30%|███       | 3/10 [00:08<00:17,  2.44s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6992, 'hit_ratio@10': 0.5314, 'ndcg@10': 0.3787, 'compress@10': 0.4649, 'time@10': 3.94}:  30%|███       | 3/10 [00:11<00:17,  2.44s/it]  {'epoch': 0, 'num_users': 5.0, 'loss': 0.6992, 'hit_ratio@10': 0.5314, 'ndcg@10': 0.3787, 'compress@10': 0.4649, 'time@10': 3.94}:  40%|████      | 4/10 [00:11<00:17,  2.97s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5803, 'hit_ratio@10': 0.6012, 'ndcg@10': 0.4399, 'compress@10': 0.4642, 'time@10': 5.8888}:  40%|████      | 4/10 [00:18<00:17,  2.97s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5803, 'hit_ratio@10': 0.6012, 'ndcg@10': 0.4399, 'compress@10': 0.4642, 'time@10': 5.8888}:  50%|█████     | 5/10 [00:18<00:21,  4.38s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4993, 'hit_ratio@10': 0.6195, 'ndcg@10': 0.4915, 'compress@10': 0.4779, 'time@10': 5.9334}:  50%|█████     | 5/10 [00:25<00:21,  4.38s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4993, 'hit_ratio@10': 0.6195, 'ndcg@10': 0.4915, 'compress@10': 0.4779, 'time@10': 5.9334}:  60%|██████    | 6/10 [00:25<00:19,  5.00s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4525, 'hit_ratio@10': 0.611, 'ndcg@10': 0.4956, 'compress@10': 0.4865, 'time@10': 6.0324}:  60%|██████    | 6/10 [00:28<00:19,  5.00s/it] {'epoch': 0, 'num_users': 6.2857, 'loss': 0.4525, 'hit_ratio@10': 0.611, 'ndcg@10': 0.4956, 'compress@10': 0.4865, 'time@10': 6.0324}:  70%|███████   | 7/10 [00:28<00:13,  4.46s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.4085, 'hit_ratio@10': 0.6489, 'ndcg@10': 0.5071, 'compress@10': 0.497, 'time@10': 5.8659}:  70%|███████   | 7/10 [00:33<00:13,  4.46s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.4085, 'hit_ratio@10': 0.6489, 'ndcg@10': 0.5071, 'compress@10': 0.497, 'time@10': 5.8659}:  80%|████████  | 8/10 [00:33<00:09,  4.55s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3739, 'hit_ratio@10': 0.6625, 'ndcg@10': 0.5466, 'compress@10': 0.4951, 'time@10': 6.2643}:  80%|████████  | 8/10 [00:37<00:09,  4.55s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3739, 'hit_ratio@10': 0.6625, 'ndcg@10': 0.5466, 'compress@10': 0.4951, 'time@10': 6.2643}:  90%|█████████ | 9/10 [00:37<00:04,  4.62s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3439, 'hit_ratio@10': 0.6872, 'ndcg@10': 0.5601, 'compress@10': 0.5002, 'time@10': 6.2095}:  90%|█████████ | 9/10 [00:43<00:04,  4.62s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3439, 'hit_ratio@10': 0.6872, 'ndcg@10': 0.5601, 'compress@10': 0.5002, 'time@10': 6.2095}: 100%|██████████| 10/10 [00:43<00:00,  4.97s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3439, 'hit_ratio@10': 0.6872, 'ndcg@10': 0.5601, 'compress@10': 0.5002, 'time@10': 6.2095}: 100%|██████████| 10/10 [00:43<00:00,  4.37s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3438861575901643
Avg hit ratio: 0.6871674249161516
Avg ndcg: 0.5600903790499323
Avg compression ratio: 0.500233008961605
Avg train time: 6.209467220306396
Std train time: 3.1658235990287777
[0.75, 0.75, 0.75, 0.75, 0.25, 0.25, 0.75, 0.25, 0.25, 0.25]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0696, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.7546, 'compress@10': 0.9893, 'time@10': 4.9679}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0696, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.7546, 'compress@10': 0.9893, 'time@10': 4.9679}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0624, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8048, 'compress@10': 0.9902, 'time@10': 4.5799}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0624, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8048, 'compress@10': 0.9902, 'time@10': 4.5799}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0606, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.7742, 'compress@10': 0.9907, 'time@10': 3.6476}:  20%|██        | 2/10 [00:07<00:28,  3.52s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0606, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.7742, 'compress@10': 0.9907, 'time@10': 3.6476}:  30%|███       | 3/10 [00:07<00:16,  2.34s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0587, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.7943, 'compress@10': 0.9907, 'time@10': 3.6749}:  30%|███       | 3/10 [00:11<00:16,  2.34s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0587, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.7943, 'compress@10': 0.9907, 'time@10': 3.6749}:  40%|████      | 4/10 [00:11<00:17,  2.91s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0647, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.7899, 'compress@10': 0.799, 'time@10': 5.3991}:  40%|████      | 4/10 [00:17<00:17,  2.91s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.0647, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.7899, 'compress@10': 0.799, 'time@10': 5.3991}:  50%|█████     | 5/10 [00:17<00:20,  4.10s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0669, 'hit_ratio@10': 0.7786, 'ndcg@10': 0.7934, 'compress@10': 0.6711, 'time@10': 5.5097}:  50%|█████     | 5/10 [00:23<00:20,  4.10s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0669, 'hit_ratio@10': 0.7786, 'ndcg@10': 0.7934, 'compress@10': 0.6711, 'time@10': 5.5097}:  60%|██████    | 6/10 [00:23<00:19,  4.78s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0647, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.799, 'compress@10': 0.7167, 'time@10': 5.7071}:  60%|██████    | 6/10 [00:27<00:19,  4.78s/it] {'epoch': 1, 'num_users': 6.2857, 'loss': 0.0647, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.799, 'compress@10': 0.7167, 'time@10': 5.7071}:  70%|███████   | 7/10 [00:27<00:13,  4.35s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0615, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8083, 'compress@10': 0.6315, 'time@10': 5.6102}:  70%|███████   | 7/10 [00:32<00:13,  4.35s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0615, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8083, 'compress@10': 0.6315, 'time@10': 5.6102}:  80%|████████  | 8/10 [00:32<00:09,  4.55s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.059, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8202, 'compress@10': 0.5659, 'time@10': 5.9299}:  80%|████████  | 8/10 [00:36<00:09,  4.55s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.059, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8202, 'compress@10': 0.5659, 'time@10': 5.9299}:  90%|█████████ | 9/10 [00:36<00:04,  4.47s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0578, 'hit_ratio@10': 0.822, 'ndcg@10': 0.823, 'compress@10': 0.5126, 'time@10': 5.9035}:  90%|█████████ | 9/10 [00:42<00:04,  4.47s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.0578, 'hit_ratio@10': 0.822, 'ndcg@10': 0.823, 'compress@10': 0.5126, 'time@10': 5.9035}: 100%|██████████| 10/10 [00:42<00:00,  4.85s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0578, 'hit_ratio@10': 0.822, 'ndcg@10': 0.823, 'compress@10': 0.5126, 'time@10': 5.9035}: 100%|██████████| 10/10 [00:42<00:00,  4.22s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05778025957068487
Avg hit ratio: 0.8220472883087485
Avg ndcg: 0.8230327023238662
Avg compression ratio: 0.5125608972823174
Avg train time: 5.9034782409667965
Std train time: 2.7374275026326695
[0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.5, 0.5, 0.5, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8393, 'compress@10': 0.998, 'time@10': 5.023}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8393, 'compress@10': 0.998, 'time@10': 5.023}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0513, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8443, 'compress@10': 0.998, 'time@10': 4.6315}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0513, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8443, 'compress@10': 0.998, 'time@10': 4.6315}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0381, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.834, 'compress@10': 0.9982, 'time@10': 3.7474}:  20%|██        | 2/10 [00:07<00:28,  3.57s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0381, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.834, 'compress@10': 0.9982, 'time@10': 3.7474}:  30%|███       | 3/10 [00:07<00:16,  2.41s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.041, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8378, 'compress@10': 0.8574, 'time@10': 3.7338}:  30%|███       | 3/10 [00:11<00:16,  2.41s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.041, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8378, 'compress@10': 0.8574, 'time@10': 3.7338}:  40%|████      | 4/10 [00:11<00:17,  2.93s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0501, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8272, 'compress@10': 0.8038, 'time@10': 5.184}:  40%|████      | 4/10 [00:17<00:17,  2.93s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0501, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8272, 'compress@10': 0.8038, 'time@10': 5.184}:  50%|█████     | 5/10 [00:17<00:19,  3.87s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0544, 'hit_ratio@10': 0.7964, 'ndcg@10': 0.8267, 'compress@10': 0.7646, 'time@10': 5.3421}:  50%|█████     | 5/10 [00:23<00:19,  3.87s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0544, 'hit_ratio@10': 0.7964, 'ndcg@10': 0.8267, 'compress@10': 0.7646, 'time@10': 5.3421}:  60%|██████    | 6/10 [00:23<00:18,  4.65s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0528, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8324, 'compress@10': 0.7339, 'time@10': 5.5311}:  60%|██████    | 6/10 [00:26<00:18,  4.65s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0528, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8324, 'compress@10': 0.7339, 'time@10': 5.5311}:  70%|███████   | 7/10 [00:26<00:12,  4.23s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8362, 'compress@10': 0.646, 'time@10': 5.4289}:  70%|███████   | 7/10 [00:31<00:12,  4.23s/it]  {'epoch': 2, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8362, 'compress@10': 0.646, 'time@10': 5.4289}:  80%|████████  | 8/10 [00:31<00:08,  4.40s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8453, 'compress@10': 0.5777, 'time@10': 5.7705}:  80%|████████  | 8/10 [00:35<00:08,  4.40s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8453, 'compress@10': 0.5777, 'time@10': 5.7705}:  90%|█████████ | 9/10 [00:35<00:04,  4.37s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8459, 'compress@10': 0.5225, 'time@10': 5.74}:  90%|█████████ | 9/10 [00:41<00:04,  4.37s/it]     {'epoch': 2, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8459, 'compress@10': 0.5225, 'time@10': 5.74}: 100%|██████████| 10/10 [00:41<00:00,  4.72s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8459, 'compress@10': 0.5225, 'time@10': 5.74}: 100%|██████████| 10/10 [00:41<00:00,  4.12s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.049446122823184634
Avg hit ratio: 0.8327584748773204
Avg ndcg: 0.8458656896742957
Avg compression ratio: 0.5224925071915267
Avg train time: 5.740001320838928
Std train time: 2.4161354990870048
[0.875, 0.875, 0.625, 0.625, 0.625, 0.625, 0.375, 0.125, 0.125, 0.125]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.843, 'compress@10': 0.9991, 'time@10': 5.0863}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.843, 'compress@10': 0.9991, 'time@10': 5.0863}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8435, 'compress@10': 0.9991, 'time@10': 4.6077}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8435, 'compress@10': 0.9991, 'time@10': 4.6077}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8459, 'compress@10': 0.9817, 'time@10': 3.7779}:  20%|██        | 2/10 [00:07<00:28,  3.51s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8459, 'compress@10': 0.9817, 'time@10': 3.7779}:  30%|███       | 3/10 [00:07<00:16,  2.41s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0403, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8478, 'compress@10': 0.9736, 'time@10': 3.7566}:  30%|███       | 3/10 [00:11<00:16,  2.41s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0403, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8478, 'compress@10': 0.9736, 'time@10': 3.7566}:  40%|████      | 4/10 [00:11<00:17,  2.93s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0495, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8366, 'compress@10': 0.9677, 'time@10': 4.9716}:  40%|████      | 4/10 [00:16<00:17,  2.93s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0495, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8366, 'compress@10': 0.9677, 'time@10': 4.9716}:  50%|█████     | 5/10 [00:16<00:18,  3.67s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0532, 'hit_ratio@10': 0.7964, 'ndcg@10': 0.8337, 'compress@10': 0.9618, 'time@10': 5.1803}:  50%|█████     | 5/10 [00:22<00:18,  3.67s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0532, 'hit_ratio@10': 0.7964, 'ndcg@10': 0.8337, 'compress@10': 0.9618, 'time@10': 5.1803}:  60%|██████    | 6/10 [00:22<00:18,  4.55s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0516, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8374, 'compress@10': 0.8382, 'time@10': 5.406}:  60%|██████    | 6/10 [00:26<00:18,  4.55s/it] {'epoch': 3, 'num_users': 6.2857, 'loss': 0.0516, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8374, 'compress@10': 0.8382, 'time@10': 5.406}:  70%|███████   | 7/10 [00:26<00:12,  4.18s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0516, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8329, 'compress@10': 0.7371, 'time@10': 5.3159}:  70%|███████   | 7/10 [00:30<00:12,  4.18s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0516, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8329, 'compress@10': 0.7371, 'time@10': 5.3159}:  80%|████████  | 8/10 [00:30<00:08,  4.35s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0511, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8443, 'compress@10': 0.6585, 'time@10': 5.6861}:  80%|████████  | 8/10 [00:35<00:08,  4.35s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0511, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8443, 'compress@10': 0.6585, 'time@10': 5.6861}:  90%|█████████ | 9/10 [00:35<00:04,  4.36s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0505, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8449, 'compress@10': 0.5951, 'time@10': 5.6709}:  90%|█████████ | 9/10 [00:40<00:04,  4.36s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0505, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8449, 'compress@10': 0.5951, 'time@10': 5.6709}: 100%|██████████| 10/10 [00:40<00:00,  4.73s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0505, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8449, 'compress@10': 0.5951, 'time@10': 5.6709}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.050466677385968585
Avg hit ratio: 0.838472760591606
Avg ndcg: 0.8448657790645516
Avg compression ratio: 0.5950826800686345
Avg train time: 5.6708828687667845
Std train time: 2.1888665390758746
[0.7, 0.9, 0.5, 0.7, 0.7, 0.7, 0.3, 0.3, 0.1, 0.1]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8467, 'compress@10': 0.9797, 'time@10': 4.8802}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8467, 'compress@10': 0.9797, 'time@10': 4.8802}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.854, 'compress@10': 0.9896, 'time@10': 4.5481}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.854, 'compress@10': 0.9896, 'time@10': 4.5481}:  20%|██        | 2/10 [00:06<00:28,  3.52s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8529, 'compress@10': 0.8361, 'time@10': 3.7931}:  20%|██        | 2/10 [00:07<00:28,  3.52s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8529, 'compress@10': 0.8361, 'time@10': 3.7931}:  30%|███       | 3/10 [00:07<00:17,  2.46s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0401, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8496, 'compress@10': 0.8737, 'time@10': 3.7788}:  30%|███       | 3/10 [00:11<00:17,  2.46s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0401, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8496, 'compress@10': 0.8737, 'time@10': 3.7788}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0494, 'hit_ratio@10': 0.7785, 'ndcg@10': 0.8355, 'compress@10': 0.8953, 'time@10': 4.6776}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0494, 'hit_ratio@10': 0.7785, 'ndcg@10': 0.8355, 'compress@10': 0.8953, 'time@10': 4.6776}:  50%|█████     | 5/10 [00:15<00:17,  3.41s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0526, 'hit_ratio@10': 0.7784, 'ndcg@10': 0.8335, 'compress@10': 0.9092, 'time@10': 4.9285}:  50%|█████     | 5/10 [00:22<00:17,  3.41s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0526, 'hit_ratio@10': 0.7784, 'ndcg@10': 0.8335, 'compress@10': 0.9092, 'time@10': 4.9285}:  60%|██████    | 6/10 [00:22<00:17,  4.36s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0514, 'hit_ratio@10': 0.8043, 'ndcg@10': 0.8375, 'compress@10': 0.7874, 'time@10': 5.1869}:  60%|██████    | 6/10 [00:25<00:17,  4.36s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0514, 'hit_ratio@10': 0.8043, 'ndcg@10': 0.8375, 'compress@10': 0.7874, 'time@10': 5.1869}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0514, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8347, 'compress@10': 0.694, 'time@10': 5.1237}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]  {'epoch': 4, 'num_users': 6.125, 'loss': 0.0514, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8347, 'compress@10': 0.694, 'time@10': 5.1237}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0511, 'hit_ratio@10': 0.8161, 'ndcg@10': 0.8409, 'compress@10': 0.6202, 'time@10': 5.5126}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0511, 'hit_ratio@10': 0.8161, 'ndcg@10': 0.8409, 'compress@10': 0.6202, 'time@10': 5.5126}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0503, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.842, 'compress@10': 0.5605, 'time@10': 5.5075}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]    {'epoch': 4, 'num_users': 6.3, 'loss': 0.0503, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.842, 'compress@10': 0.5605, 'time@10': 5.5075}: 100%|██████████| 10/10 [00:40<00:00,  4.66s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0503, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.842, 'compress@10': 0.5605, 'time@10': 5.5075}: 100%|██████████| 10/10 [00:40<00:00,  4.01s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.050312509000929186
Avg hit ratio: 0.827635074979727
Avg ndcg: 0.8419702714158193
Avg compression ratio: 0.5604896651192423
Avg train time: 5.507508325576782
Std train time: 1.88703380285616
[0.5833333333333333, 0.9166666666666667, 0.4166666666666667, 0.75, 0.75, 0.75, 0.25, 0.41666666666666663, 0.08333333333333334, 0.08333333333333334]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8427, 'compress@10': 0.8116, 'time@10': 5.2889}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8427, 'compress@10': 0.8116, 'time@10': 5.2889}:  10%|█         | 1/10 [00:02<00:24,  2.68s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8586, 'compress@10': 0.9056, 'time@10': 4.7343}:  10%|█         | 1/10 [00:06<00:24,  2.68s/it] {'epoch': 5, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8586, 'compress@10': 0.9056, 'time@10': 4.7343}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8581, 'compress@10': 0.6885, 'time@10': 3.9783}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8581, 'compress@10': 0.6885, 'time@10': 3.9783}:  30%|███       | 3/10 [00:08<00:17,  2.53s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0388, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8487, 'compress@10': 0.7648, 'time@10': 3.9166}:  30%|███       | 3/10 [00:11<00:17,  2.53s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0388, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8487, 'compress@10': 0.7648, 'time@10': 3.9166}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.772, 'ndcg@10': 0.8352, 'compress@10': 0.8102, 'time@10': 4.7824}:  40%|████      | 4/10 [00:16<00:18,  3.02s/it] {'epoch': 5, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.772, 'ndcg@10': 0.8352, 'compress@10': 0.8102, 'time@10': 4.7824}:  50%|█████     | 5/10 [00:16<00:17,  3.43s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0506, 'hit_ratio@10': 0.7804, 'ndcg@10': 0.8341, 'compress@10': 0.8403, 'time@10': 5.0185}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0506, 'hit_ratio@10': 0.7804, 'ndcg@10': 0.8341, 'compress@10': 0.8403, 'time@10': 5.0185}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0498, 'hit_ratio@10': 0.8061, 'ndcg@10': 0.8403, 'compress@10': 0.7271, 'time@10': 5.2733}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0498, 'hit_ratio@10': 0.8061, 'ndcg@10': 0.8403, 'compress@10': 0.7271, 'time@10': 5.2733}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.8232, 'ndcg@10': 0.8411, 'compress@10': 0.6493, 'time@10': 5.2004}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.8232, 'ndcg@10': 0.8411, 'compress@10': 0.6493, 'time@10': 5.2004}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.8518, 'compress@10': 0.5804, 'time@10': 5.5883}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it] {'epoch': 5, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8174, 'ndcg@10': 0.8518, 'compress@10': 0.5804, 'time@10': 5.5883}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0492, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8516, 'compress@10': 0.5247, 'time@10': 5.5456}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it] {'epoch': 5, 'num_users': 6.3, 'loss': 0.0492, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8516, 'compress@10': 0.5247, 'time@10': 5.5456}: 100%|██████████| 10/10 [00:40<00:00,  4.59s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0492, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8516, 'compress@10': 0.5247, 'time@10': 5.5456}: 100%|██████████| 10/10 [00:40<00:00,  4.01s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04915771133068191
Avg hit ratio: 0.8288537129725585
Avg ndcg: 0.8516181569409721
Avg compression ratio: 0.5246971479744299
Avg train time: 5.545638537406921
Std train time: 1.86492018407523
[0.49999999999999994, 0.9285714285714286, 0.35714285714285715, 0.7857142857142857, 0.7857142857142857, 0.7857142857142857, 0.2142857142857143, 0.3571428571428571, 0.2142857142857143, 0.07142857142857144]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.3464, 'time@10': 4.9164}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.3464, 'time@10': 4.9164}:  10%|█         | 1/10 [00:02<00:22,  2.50s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8571, 'compress@10': 0.6731, 'time@10': 4.563}:  10%|█         | 1/10 [00:06<00:22,  2.50s/it]  {'epoch': 6, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8571, 'compress@10': 0.6731, 'time@10': 4.563}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8571, 'compress@10': 0.5124, 'time@10': 3.9238}:  20%|██        | 2/10 [00:08<00:28,  3.53s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8571, 'compress@10': 0.5124, 'time@10': 3.9238}:  30%|███       | 3/10 [00:08<00:17,  2.54s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0357, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8495, 'compress@10': 0.6334, 'time@10': 3.8827}:  30%|███       | 3/10 [00:11<00:17,  2.54s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0357, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8495, 'compress@10': 0.6334, 'time@10': 3.8827}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0448, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8361, 'compress@10': 0.7058, 'time@10': 4.7459}:  40%|████      | 4/10 [00:16<00:18,  3.04s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0448, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8361, 'compress@10': 0.7058, 'time@10': 4.7459}:  50%|█████     | 5/10 [00:16<00:17,  3.43s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0474, 'hit_ratio@10': 0.7951, 'ndcg@10': 0.8354, 'compress@10': 0.754, 'time@10': 4.9929}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0474, 'hit_ratio@10': 0.7951, 'ndcg@10': 0.8354, 'compress@10': 0.754, 'time@10': 4.9929}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0462, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8396, 'compress@10': 0.6527, 'time@10': 5.242}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0462, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8396, 'compress@10': 0.6527, 'time@10': 5.242}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0459, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8467, 'compress@10': 0.5783, 'time@10': 5.1713}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0459, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8467, 'compress@10': 0.5783, 'time@10': 5.1713}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0459, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.8524, 'compress@10': 0.5179, 'time@10': 5.5755}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0459, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.8524, 'compress@10': 0.5179, 'time@10': 5.5755}:  90%|█████████ | 9/10 [00:34<00:04,  4.33s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0453, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8525, 'compress@10': 0.4684, 'time@10': 5.5824}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0453, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8525, 'compress@10': 0.4684, 'time@10': 5.5824}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0453, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8525, 'compress@10': 0.4684, 'time@10': 5.5824}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04529085634133092
Avg hit ratio: 0.8376509479956
Avg ndcg: 0.8525276483592495
Avg compression ratio: 0.4684334781351377
Avg train time: 5.58243305683136
Std train time: 1.8467939146466212
[0.5625, 0.8125, 0.3125, 0.8125, 0.8125, 0.8125, 0.1875, 0.31249999999999994, 0.3125, 0.06250000000000001]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8445, 'compress@10': 0.8053, 'time@10': 4.9518}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8445, 'compress@10': 0.8053, 'time@10': 4.9518}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8437, 'compress@10': 0.9011, 'time@10': 4.597}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it]  {'epoch': 7, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8437, 'compress@10': 0.9011, 'time@10': 4.597}:  20%|██        | 2/10 [00:06<00:28,  3.55s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8482, 'compress@10': 0.6563, 'time@10': 4.01}:  20%|██        | 2/10 [00:08<00:28,  3.55s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8482, 'compress@10': 0.6563, 'time@10': 4.01}:  30%|███       | 3/10 [00:08<00:18,  2.60s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8428, 'compress@10': 0.7416, 'time@10': 3.9474}:  30%|███       | 3/10 [00:12<00:18,  2.60s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8428, 'compress@10': 0.7416, 'time@10': 3.9474}:  40%|████      | 4/10 [00:12<00:18,  3.07s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0448, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8307, 'compress@10': 0.7928, 'time@10': 4.8256}:  40%|████      | 4/10 [00:16<00:18,  3.07s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0448, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8307, 'compress@10': 0.7928, 'time@10': 4.8256}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0468, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8314, 'compress@10': 0.8269, 'time@10': 5.0633}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0468, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8314, 'compress@10': 0.8269, 'time@10': 5.0633}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0464, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8368, 'compress@10': 0.7149, 'time@10': 5.3133}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0464, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8368, 'compress@10': 0.7149, 'time@10': 5.3133}:  70%|███████   | 7/10 [00:25<00:12,  4.11s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0453, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.843, 'compress@10': 0.6309, 'time@10': 5.2429}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0453, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.843, 'compress@10': 0.6309, 'time@10': 5.2429}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0475, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8621, 'compress@10': 0.5673, 'time@10': 5.5925}:  80%|████████  | 8/10 [00:35<00:08,  4.33s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0475, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8621, 'compress@10': 0.5673, 'time@10': 5.5925}:  90%|█████████ | 9/10 [00:35<00:04,  4.30s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0465, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8617, 'compress@10': 0.5129, 'time@10': 5.6049}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0465, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8617, 'compress@10': 0.5129, 'time@10': 5.6049}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0465, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8617, 'compress@10': 0.5129, 'time@10': 5.6049}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04646757363284592
Avg hit ratio: 0.8605744689191208
Avg ndcg: 0.8616880622833193
Avg compression ratio: 0.5128538343458866
Avg train time: 5.604855060577393
Std train time: 1.7664316978138719
[0.6111111111111112, 0.7222222222222222, 0.2777777777777778, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.16666666666666666, 0.27777777777777773, 0.3888888888888889, 0.055555555555555566]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.9188, 'time@10': 5.2016}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.9188, 'time@10': 5.2016}:  10%|█         | 1/10 [00:02<00:23,  2.64s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8628, 'compress@10': 0.9525, 'time@10': 4.753}:  10%|█         | 1/10 [00:06<00:23,  2.64s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8628, 'compress@10': 0.9525, 'time@10': 4.753}:  20%|██        | 2/10 [00:06<00:29,  3.64s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8609, 'compress@10': 0.6868, 'time@10': 4.1718}:  20%|██        | 2/10 [00:08<00:29,  3.64s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8609, 'compress@10': 0.6868, 'time@10': 4.1718}:  30%|███       | 3/10 [00:08<00:18,  2.68s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8514, 'compress@10': 0.7647, 'time@10': 4.0484}:  30%|███       | 3/10 [00:12<00:18,  2.68s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8514, 'compress@10': 0.7647, 'time@10': 4.0484}:  40%|████      | 4/10 [00:12<00:18,  3.09s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0423, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8386, 'compress@10': 0.8114, 'time@10': 4.9731}:  40%|████      | 4/10 [00:16<00:18,  3.09s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0423, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8386, 'compress@10': 0.8114, 'time@10': 4.9731}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.044, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8397, 'compress@10': 0.8425, 'time@10': 5.172}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.044, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8397, 'compress@10': 0.8425, 'time@10': 5.172}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0429, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8427, 'compress@10': 0.7282, 'time@10': 5.4035}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0429, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8427, 'compress@10': 0.7282, 'time@10': 5.4035}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0432, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8496, 'compress@10': 0.6419, 'time@10': 5.3253}:  70%|███████   | 7/10 [00:31<00:12,  4.13s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0432, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8496, 'compress@10': 0.6419, 'time@10': 5.3253}:  80%|████████  | 8/10 [00:31<00:08,  4.35s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0442, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8538, 'compress@10': 0.5834, 'time@10': 5.6817}:  80%|████████  | 8/10 [00:35<00:08,  4.35s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0442, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8538, 'compress@10': 0.5834, 'time@10': 5.6817}:  90%|█████████ | 9/10 [00:35<00:04,  4.34s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8559, 'compress@10': 0.5274, 'time@10': 5.653}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]    {'epoch': 8, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8559, 'compress@10': 0.5274, 'time@10': 5.653}: 100%|██████████| 10/10 [00:40<00:00,  4.67s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8559, 'compress@10': 0.5274, 'time@10': 5.653}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04279741414324141
Avg hit ratio: 0.8517367833072417
Avg ndcg: 0.855893592753905
Avg compression ratio: 0.5273661871466679
Avg train time: 5.652951264381409
Std train time: 1.8087043514211596
[0.55, 0.65, 0.25, 0.8500000000000001, 0.8500000000000001, 0.8500000000000001, 0.15, 0.35, 0.45, 0.05000000000000001]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8329, 'compress@10': 0.7885, 'time@10': 5.2254}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8329, 'compress@10': 0.7885, 'time@10': 5.2254}:  10%|█         | 1/10 [00:02<00:23,  2.66s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8477, 'compress@10': 0.8693, 'time@10': 4.7691}:  10%|█         | 1/10 [00:07<00:23,  2.66s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8477, 'compress@10': 0.8693, 'time@10': 4.7691}:  20%|██        | 2/10 [00:07<00:29,  3.65s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8508, 'compress@10': 0.6299, 'time@10': 4.2417}:  20%|██        | 2/10 [00:08<00:29,  3.65s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8508, 'compress@10': 0.6299, 'time@10': 4.2417}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0337, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8446, 'compress@10': 0.7221, 'time@10': 4.1352}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0337, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8446, 'compress@10': 0.7221, 'time@10': 4.1352}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8337, 'compress@10': 0.7774, 'time@10': 4.9882}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8337, 'compress@10': 0.7774, 'time@10': 4.9882}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0427, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8365, 'compress@10': 0.8143, 'time@10': 5.2129}:  50%|█████     | 5/10 [00:23<00:17,  3.56s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0427, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8365, 'compress@10': 0.8143, 'time@10': 5.2129}:  60%|██████    | 6/10 [00:23<00:18,  4.52s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0423, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8424, 'compress@10': 0.7039, 'time@10': 5.4491}:  60%|██████    | 6/10 [00:26<00:18,  4.52s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0423, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8424, 'compress@10': 0.7039, 'time@10': 5.4491}:  70%|███████   | 7/10 [00:26<00:12,  4.18s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0417, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8505, 'compress@10': 0.6235, 'time@10': 5.364}:  70%|███████   | 7/10 [00:31<00:12,  4.18s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0417, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8505, 'compress@10': 0.6235, 'time@10': 5.364}:  80%|████████  | 8/10 [00:31<00:08,  4.38s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0444, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.858, 'compress@10': 0.5801, 'time@10': 5.6966}:  80%|████████  | 8/10 [00:35<00:08,  4.38s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0444, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.858, 'compress@10': 0.5801, 'time@10': 5.6966}:  90%|█████████ | 9/10 [00:35<00:04,  4.33s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.043, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8608, 'compress@10': 0.5244, 'time@10': 5.6604}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.043, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8608, 'compress@10': 0.5244, 'time@10': 5.6604}: 100%|██████████| 10/10 [00:40<00:00,  4.65s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.043, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8608, 'compress@10': 0.5244, 'time@10': 5.6604}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.04297980881576931
Avg hit ratio: 0.8625304341008924
Avg ndcg: 0.8608029803525049
Avg compression ratio: 0.5244031830683149
Avg train time: 5.660420322418213
Std train time: 1.7065186011854314
[0.5909090909090909, 0.5909090909090909, 0.22727272727272727, 0.8636363636363638, 0.8636363636363638, 0.8636363636363638, 0.13636363636363635, 0.3181818181818182, 0.5, 0.04545454545454546]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8595, 'compress@10': 0.8908, 'time@10': 5.029}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8595, 'compress@10': 0.8908, 'time@10': 5.029}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0398, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8716, 'compress@10': 0.8842, 'time@10': 4.6384}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0398, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8716, 'compress@10': 0.8842, 'time@10': 4.6384}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8668, 'compress@10': 0.639, 'time@10': 4.1623}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8668, 'compress@10': 0.639, 'time@10': 4.1623}:  30%|███       | 3/10 [00:08<00:18,  2.70s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8587, 'compress@10': 0.7291, 'time@10': 4.0596}:  30%|███       | 3/10 [00:12<00:18,  2.70s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8587, 'compress@10': 0.7291, 'time@10': 4.0596}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0389, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8451, 'compress@10': 0.783, 'time@10': 4.926}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it]  {'epoch': 10, 'num_users': 5.8, 'loss': 0.0389, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8451, 'compress@10': 0.783, 'time@10': 4.926}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0396, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8468, 'compress@10': 0.8191, 'time@10': 5.1465}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0396, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8468, 'compress@10': 0.8191, 'time@10': 5.1465}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.039, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8482, 'compress@10': 0.7079, 'time@10': 5.3835}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it] {'epoch': 10, 'num_users': 6.2857, 'loss': 0.039, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8482, 'compress@10': 0.7079, 'time@10': 5.3835}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.039, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8547, 'compress@10': 0.6255, 'time@10': 5.2894}:  70%|███████   | 7/10 [00:30<00:12,  4.13s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.039, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8547, 'compress@10': 0.6255, 'time@10': 5.2894}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0391, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8627, 'compress@10': 0.5993, 'time@10': 5.6552}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0391, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8627, 'compress@10': 0.5993, 'time@10': 5.6552}:  90%|█████████ | 9/10 [00:35<00:04,  4.32s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0377, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.866, 'compress@10': 0.5416, 'time@10': 5.6375}:  90%|█████████ | 9/10 [00:40<00:04,  4.32s/it]    {'epoch': 10, 'num_users': 6.3, 'loss': 0.0377, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.866, 'compress@10': 0.5416, 'time@10': 5.6375}: 100%|██████████| 10/10 [00:40<00:00,  4.69s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0377, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.866, 'compress@10': 0.5416, 'time@10': 5.6375}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03774522794213829
Avg hit ratio: 0.855443900562746
Avg ndcg: 0.865995689085841
Avg compression ratio: 0.5416106571197219
Avg train time: 5.637477087974548
Std train time: 1.7544936460491165
[0.625, 0.5416666666666667, 0.20833333333333331, 0.8750000000000001, 0.8750000000000001, 0.8750000000000001, 0.12499999999999999, 0.2916666666666667, 0.5416666666666666, 0.04166666666666667]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8418, 'compress@10': 0.936, 'time@10': 5.2844}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8418, 'compress@10': 0.936, 'time@10': 5.2844}:  10%|█         | 1/10 [00:02<00:24,  2.69s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0398, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8606, 'compress@10': 0.8522, 'time@10': 4.7799}:  10%|█         | 1/10 [00:07<00:24,  2.69s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0398, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8606, 'compress@10': 0.8522, 'time@10': 4.7799}:  20%|██        | 2/10 [00:07<00:29,  3.65s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0265, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8594, 'compress@10': 0.617, 'time@10': 4.2474}:  20%|██        | 2/10 [00:08<00:29,  3.65s/it]  {'epoch': 11, 'num_users': 5.0, 'loss': 0.0265, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8594, 'compress@10': 0.617, 'time@10': 4.2474}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8526, 'compress@10': 0.7126, 'time@10': 4.1359}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8526, 'compress@10': 0.7126, 'time@10': 4.1359}:  40%|████      | 4/10 [00:12<00:19,  3.17s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0385, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8424, 'compress@10': 0.77, 'time@10': 4.9963}:  40%|████      | 4/10 [00:16<00:19,  3.17s/it]  {'epoch': 11, 'num_users': 5.8, 'loss': 0.0385, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.8424, 'compress@10': 0.77, 'time@10': 4.9963}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0385, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8455, 'compress@10': 0.8082, 'time@10': 5.1937}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0385, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8455, 'compress@10': 0.8082, 'time@10': 5.1937}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0382, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8521, 'compress@10': 0.6986, 'time@10': 5.443}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it] {'epoch': 11, 'num_users': 6.2857, 'loss': 0.0382, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8521, 'compress@10': 0.6986, 'time@10': 5.443}:  70%|███████   | 7/10 [00:26<00:12,  4.15s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0381, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.859, 'compress@10': 0.6165, 'time@10': 5.3372}:  70%|███████   | 7/10 [00:31<00:12,  4.15s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0381, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.859, 'compress@10': 0.6165, 'time@10': 5.3372}:  80%|████████  | 8/10 [00:31<00:08,  4.31s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0394, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8694, 'compress@10': 0.6331, 'time@10': 5.6942}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0394, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8694, 'compress@10': 0.6331, 'time@10': 5.6942}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0387, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8727, 'compress@10': 0.5721, 'time@10': 5.6596}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0387, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8727, 'compress@10': 0.5721, 'time@10': 5.6596}: 100%|██████████| 10/10 [00:40<00:00,  4.66s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0387, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8727, 'compress@10': 0.5721, 'time@10': 5.6596}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.038680243526122746
Avg hit ratio: 0.8852979442741752
Avg ndcg: 0.8727011549277028
Avg compression ratio: 0.572060166281286
Avg train time: 5.659560680389404
Std train time: 1.7565140064702158
[0.6538461538461539, 0.5000000000000001, 0.1923076923076923, 0.8846153846153847, 0.8846153846153847, 0.8846153846153847, 0.11538461538461538, 0.2692307692307693, 0.5769230769230769, 0.038461538461538464]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.9597, 'time@10': 5.1058}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.9597, 'time@10': 5.1058}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.869, 'compress@10': 0.7109, 'time@10': 4.6912}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it] {'epoch': 12, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.869, 'compress@10': 0.7109, 'time@10': 4.6912}:  20%|██        | 2/10 [00:06<00:28,  3.61s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.865, 'compress@10': 0.5224, 'time@10': 4.1856}:  20%|██        | 2/10 [00:08<00:28,  3.61s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.865, 'compress@10': 0.5224, 'time@10': 4.1856}:  30%|███       | 3/10 [00:08<00:18,  2.70s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0296, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8592, 'compress@10': 0.6417, 'time@10': 4.0657}:  30%|███       | 3/10 [00:12<00:18,  2.70s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0296, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8592, 'compress@10': 0.6417, 'time@10': 4.0657}:  40%|████      | 4/10 [00:12<00:18,  3.11s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0367, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8489, 'compress@10': 0.7133, 'time@10': 4.9246}:  40%|████      | 4/10 [00:16<00:18,  3.11s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0367, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8489, 'compress@10': 0.7133, 'time@10': 4.9246}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0365, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8533, 'compress@10': 0.761, 'time@10': 5.1398}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0365, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8533, 'compress@10': 0.761, 'time@10': 5.1398}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0361, 'hit_ratio@10': 0.881, 'ndcg@10': 0.8519, 'compress@10': 0.6581, 'time@10': 5.3931}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0361, 'hit_ratio@10': 0.881, 'ndcg@10': 0.8519, 'compress@10': 0.6581, 'time@10': 5.3931}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.036, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.8578, 'compress@10': 0.5805, 'time@10': 5.3038}:  70%|███████   | 7/10 [00:30<00:12,  4.13s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.036, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.8578, 'compress@10': 0.5805, 'time@10': 5.3038}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0355, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8657, 'compress@10': 0.6129, 'time@10': 5.6646}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0355, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8657, 'compress@10': 0.6129, 'time@10': 5.6646}:  90%|█████████ | 9/10 [00:35<00:04,  4.32s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0346, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8694, 'compress@10': 0.5539, 'time@10': 5.6271}:  90%|█████████ | 9/10 [00:40<00:04,  4.32s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0346, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8694, 'compress@10': 0.5539, 'time@10': 5.6271}: 100%|██████████| 10/10 [00:40<00:00,  4.63s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0346, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8694, 'compress@10': 0.5539, 'time@10': 5.6271}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03455876756621152
Avg hit ratio: 0.8773075136521656
Avg ndcg: 0.8694423721761673
Avg compression ratio: 0.5539163536448533
Avg train time: 5.62712709903717
Std train time: 1.7558484449021687
[0.6785714285714286, 0.4642857142857144, 0.17857142857142855, 0.8928571428571429, 0.8928571428571429, 0.8928571428571429, 0.10714285714285714, 0.32142857142857145, 0.5357142857142857, 0.03571428571428572]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.848, 'compress@10': 0.9732, 'time@10': 5.0338}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.848, 'compress@10': 0.9732, 'time@10': 5.0338}:  10%|█         | 1/10 [00:02<00:22,  2.56s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.869, 'compress@10': 0.6, 'time@10': 4.6589}:  10%|█         | 1/10 [00:06<00:22,  2.56s/it]    {'epoch': 13, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.869, 'compress@10': 0.6, 'time@10': 4.6589}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.865, 'compress@10': 0.4482, 'time@10': 4.15}:  20%|██        | 2/10 [00:08<00:28,  3.60s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.865, 'compress@10': 0.4482, 'time@10': 4.15}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8646, 'compress@10': 0.5861, 'time@10': 4.0523}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8646, 'compress@10': 0.5861, 'time@10': 4.0523}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0368, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8534, 'compress@10': 0.6688, 'time@10': 4.9}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it]   {'epoch': 13, 'num_users': 5.8, 'loss': 0.0368, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8534, 'compress@10': 0.6688, 'time@10': 4.9}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0365, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.857, 'compress@10': 0.724, 'time@10': 5.1211}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0365, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.857, 'compress@10': 0.724, 'time@10': 5.1211}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0367, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.8633, 'compress@10': 0.6263, 'time@10': 5.3638}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0367, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.8633, 'compress@10': 0.6263, 'time@10': 5.3638}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0361, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8674, 'compress@10': 0.5545, 'time@10': 5.27}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it]   {'epoch': 13, 'num_users': 6.125, 'loss': 0.0361, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8674, 'compress@10': 0.5545, 'time@10': 5.27}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0371, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.885, 'compress@10': 0.5778, 'time@10': 5.6305}:  80%|████████  | 8/10 [00:35<00:08,  4.29s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0371, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.885, 'compress@10': 0.5778, 'time@10': 5.6305}:  90%|█████████ | 9/10 [00:35<00:04,  4.29s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0362, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8869, 'compress@10': 0.5223, 'time@10': 5.5994}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]  {'epoch': 13, 'num_users': 6.3, 'loss': 0.0362, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8869, 'compress@10': 0.5223, 'time@10': 5.5994}: 100%|██████████| 10/10 [00:40<00:00,  4.62s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0362, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8869, 'compress@10': 0.5223, 'time@10': 5.5994}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.036233162773562616
Avg hit ratio: 0.8772979442741752
Avg ndcg: 0.886948947912277
Avg compression ratio: 0.5222901128373217
Avg train time: 5.59944531917572
Std train time: 1.7377187631176858
[0.7000000000000001, 0.43333333333333346, 0.16666666666666666, 0.9, 0.9, 0.8333333333333334, 0.16666666666666666, 0.30000000000000004, 0.5666666666666667, 0.03333333333333334]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.859, 'compress@10': 0.9818, 'time@10': 4.9078}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.859, 'compress@10': 0.9818, 'time@10': 4.9078}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8797, 'compress@10': 0.5708, 'time@10': 4.5675}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8797, 'compress@10': 0.5708, 'time@10': 4.5675}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8722, 'compress@10': 0.4286, 'time@10': 4.18}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it]   {'epoch': 14, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8722, 'compress@10': 0.4286, 'time@10': 4.18}:  30%|███       | 3/10 [00:08<00:19,  2.72s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8721, 'compress@10': 0.5714, 'time@10': 4.0707}:  30%|███       | 3/10 [00:12<00:19,  2.72s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8721, 'compress@10': 0.5714, 'time@10': 4.0707}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0339, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.86, 'compress@10': 0.6571, 'time@10': 4.921}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]   {'epoch': 14, 'num_users': 5.8, 'loss': 0.0339, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.86, 'compress@10': 0.6571, 'time@10': 4.921}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0344, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8618, 'compress@10': 0.714, 'time@10': 5.1379}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0344, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8618, 'compress@10': 0.714, 'time@10': 5.1379}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0343, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8602, 'compress@10': 0.6179, 'time@10': 5.37}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0343, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8602, 'compress@10': 0.6179, 'time@10': 5.37}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0337, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.867, 'compress@10': 0.5463, 'time@10': 5.2668}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0337, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.867, 'compress@10': 0.5463, 'time@10': 5.2668}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0339, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8739, 'compress@10': 0.5807, 'time@10': 5.6525}:  80%|████████  | 8/10 [00:35<00:08,  4.27s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0339, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8739, 'compress@10': 0.5807, 'time@10': 5.6525}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0327, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.8785, 'compress@10': 0.5249, 'time@10': 5.6394}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0327, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.8785, 'compress@10': 0.5249, 'time@10': 5.6394}: 100%|██████████| 10/10 [00:40<00:00,  4.71s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0327, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.8785, 'compress@10': 0.5249, 'time@10': 5.6394}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.0327447928586992
Avg hit ratio: 0.8736341636103946
Avg ndcg: 0.878541160726456
Avg compression ratio: 0.5248806201115608
Avg train time: 5.639350724220276
Std train time: 1.7530718531223333
[0.7187500000000001, 0.4062500000000001, 0.15625, 0.90625, 0.90625, 0.84375, 0.15625, 0.28125000000000006, 0.59375, 0.03125000000000001]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0479, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8456, 'compress@10': 0.9869, 'time@10': 5.0713}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0479, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8456, 'compress@10': 0.9869, 'time@10': 5.0713}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0368, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8751, 'compress@10': 0.5528, 'time@10': 4.6751}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0368, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8751, 'compress@10': 0.5528, 'time@10': 4.6751}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8691, 'compress@10': 0.4164, 'time@10': 4.1653}:  20%|██        | 2/10 [00:08<00:28,  3.60s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8691, 'compress@10': 0.4164, 'time@10': 4.1653}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8727, 'compress@10': 0.5623, 'time@10': 4.0688}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8727, 'compress@10': 0.5623, 'time@10': 4.0688}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.034, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8614, 'compress@10': 0.6498, 'time@10': 4.952}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]  {'epoch': 15, 'num_users': 5.8, 'loss': 0.034, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8614, 'compress@10': 0.6498, 'time@10': 4.952}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0325, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.868, 'compress@10': 0.708, 'time@10': 5.1676}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0325, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.868, 'compress@10': 0.708, 'time@10': 5.1676}:  60%|██████    | 6/10 [00:22<00:17,  4.48s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0327, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.8723, 'compress@10': 0.6127, 'time@10': 5.3953}:  60%|██████    | 6/10 [00:26<00:17,  4.48s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0327, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.8723, 'compress@10': 0.6127, 'time@10': 5.3953}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0321, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.876, 'compress@10': 0.5412, 'time@10': 5.2984}:  70%|███████   | 7/10 [00:30<00:12,  4.13s/it]  {'epoch': 15, 'num_users': 6.125, 'loss': 0.0321, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.876, 'compress@10': 0.5412, 'time@10': 5.2984}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0337, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8953, 'compress@10': 0.5811, 'time@10': 5.673}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0337, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8953, 'compress@10': 0.5811, 'time@10': 5.673}:  90%|█████████ | 9/10 [00:35<00:04,  4.33s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0323, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8998, 'compress@10': 0.5253, 'time@10': 5.6619}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]  {'epoch': 15, 'num_users': 6.3, 'loss': 0.0323, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8998, 'compress@10': 0.5253, 'time@10': 5.6619}: 100%|██████████| 10/10 [00:40<00:00,  4.72s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0323, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8998, 'compress@10': 0.5253, 'time@10': 5.6619}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.03232290453098797
Avg hit ratio: 0.8824278144040454
Avg ndcg: 0.8997903932093523
Avg compression ratio: 0.5252609019086857
Avg train time: 5.661905980110168
Std train time: 1.7832203617184652
[0.7352941176470589, 0.3823529411764707, 0.14705882352941177, 0.9117647058823529, 0.9117647058823529, 0.7941176470588235, 0.20588235294117646, 0.26470588235294124, 0.6176470588235294, 0.02941176470588236]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0423, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8703, 'compress@10': 0.9903, 'time@10': 4.976}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0423, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8703, 'compress@10': 0.9903, 'time@10': 4.976}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0335, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8896, 'compress@10': 0.5414, 'time@10': 4.639}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0335, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8896, 'compress@10': 0.5414, 'time@10': 4.639}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8788, 'compress@10': 0.4088, 'time@10': 4.1432}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8788, 'compress@10': 0.4088, 'time@10': 4.1432}:  30%|███       | 3/10 [00:08<00:18,  2.69s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8825, 'compress@10': 0.5566, 'time@10': 4.047}:  30%|███       | 3/10 [00:12<00:18,  2.69s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8825, 'compress@10': 0.5566, 'time@10': 4.047}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0313, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8696, 'compress@10': 0.6452, 'time@10': 4.952}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0313, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8696, 'compress@10': 0.6452, 'time@10': 4.952}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0299, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8766, 'compress@10': 0.7038, 'time@10': 5.1859}:  50%|█████     | 5/10 [00:23<00:17,  3.56s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0299, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8766, 'compress@10': 0.7038, 'time@10': 5.1859}:  60%|██████    | 6/10 [00:23<00:18,  4.53s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.03, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8731, 'compress@10': 0.6094, 'time@10': 5.3893}:  60%|██████    | 6/10 [00:26<00:18,  4.53s/it]  {'epoch': 16, 'num_users': 6.2857, 'loss': 0.03, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8731, 'compress@10': 0.6094, 'time@10': 5.3893}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0296, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.877, 'compress@10': 0.538, 'time@10': 5.2962}:  70%|███████   | 7/10 [00:31<00:12,  4.14s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0296, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.877, 'compress@10': 0.538, 'time@10': 5.2962}:  80%|████████  | 8/10 [00:31<00:08,  4.31s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0303, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8827, 'compress@10': 0.5818, 'time@10': 5.6435}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0303, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8827, 'compress@10': 0.5818, 'time@10': 5.6435}:  90%|█████████ | 9/10 [00:35<00:04,  4.29s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8875, 'compress@10': 0.5259, 'time@10': 5.6178}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]  {'epoch': 16, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8875, 'compress@10': 0.5259, 'time@10': 5.6178}: 100%|██████████| 10/10 [00:40<00:00,  4.64s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8875, 'compress@10': 0.5259, 'time@10': 5.6178}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.02940518492379173
Avg hit ratio: 0.878935750911982
Avg ndcg: 0.8874575418072952
Avg compression ratio: 0.5258997751744798
Avg train time: 5.617815065383911
Std train time: 1.7550604921317703
[0.75, 0.3611111111111112, 0.1388888888888889, 0.9166666666666666, 0.9166666666666666, 0.75, 0.25, 0.25000000000000006, 0.638888888888889, 0.027777777777777783]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8725, 'compress@10': 0.9928, 'time@10': 5.0426}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8725, 'compress@10': 0.9928, 'time@10': 5.0426}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8901, 'compress@10': 0.5348, 'time@10': 4.6844}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8901, 'compress@10': 0.5348, 'time@10': 4.6844}:  20%|██        | 2/10 [00:06<00:28,  3.62s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8791, 'compress@10': 0.4043, 'time@10': 4.1764}:  20%|██        | 2/10 [00:08<00:28,  3.62s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8791, 'compress@10': 0.4043, 'time@10': 4.1764}:  30%|███       | 3/10 [00:08<00:18,  2.71s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8851, 'compress@10': 0.5532, 'time@10': 4.0805}:  30%|███       | 3/10 [00:12<00:18,  2.71s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8851, 'compress@10': 0.5532, 'time@10': 4.0805}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0293, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8726, 'compress@10': 0.6425, 'time@10': 4.9578}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0293, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8726, 'compress@10': 0.6425, 'time@10': 4.9578}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8772, 'compress@10': 0.7006, 'time@10': 5.1746}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8772, 'compress@10': 0.7006, 'time@10': 5.1746}:  60%|██████    | 6/10 [00:22<00:17,  4.49s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.029, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.882, 'compress@10': 0.6073, 'time@10': 5.3623}:  60%|██████    | 6/10 [00:26<00:17,  4.49s/it]  {'epoch': 17, 'num_users': 6.2857, 'loss': 0.029, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.882, 'compress@10': 0.6073, 'time@10': 5.3623}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0287, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8844, 'compress@10': 0.5359, 'time@10': 5.2818}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0287, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8844, 'compress@10': 0.5359, 'time@10': 5.2818}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0301, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.901, 'compress@10': 0.5815, 'time@10': 5.6433}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0301, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.901, 'compress@10': 0.5815, 'time@10': 5.6433}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9063, 'compress@10': 0.5257, 'time@10': 5.6261}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9063, 'compress@10': 0.5257, 'time@10': 5.6261}: 100%|██████████| 10/10 [00:40<00:00,  4.69s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9063, 'compress@10': 0.5257, 'time@10': 5.6261}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02864261478077052
Avg hit ratio: 0.8852849572611883
Avg ndcg: 0.9063299253728847
Avg compression ratio: 0.5256691959354388
Avg train time: 5.626096034049988
Std train time: 1.7321146370144416
[0.7631578947368421, 0.34210526315789486, 0.13157894736842105, 0.9210526315789473, 0.9210526315789473, 0.7105263157894737, 0.2894736842105263, 0.23684210526315794, 0.6578947368421053, 0.026315789473684216]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8737, 'compress@10': 0.9944, 'time@10': 5.0188}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8737, 'compress@10': 0.9944, 'time@10': 5.0188}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8969, 'compress@10': 0.5301, 'time@10': 4.6406}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8969, 'compress@10': 0.5301, 'time@10': 4.6406}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8836, 'compress@10': 0.4012, 'time@10': 4.1695}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8836, 'compress@10': 0.4012, 'time@10': 4.1695}:  30%|███       | 3/10 [00:08<00:18,  2.71s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8892, 'compress@10': 0.5508, 'time@10': 4.0638}:  30%|███       | 3/10 [00:12<00:18,  2.71s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8892, 'compress@10': 0.5508, 'time@10': 4.0638}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8768, 'compress@10': 0.6406, 'time@10': 4.9085}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8768, 'compress@10': 0.6406, 'time@10': 4.9085}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0289, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8807, 'compress@10': 0.6975, 'time@10': 5.1308}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0289, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8807, 'compress@10': 0.6975, 'time@10': 5.1308}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0286, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8795, 'compress@10': 0.6059, 'time@10': 5.3191}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0286, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8795, 'compress@10': 0.6059, 'time@10': 5.3191}:  70%|███████   | 7/10 [00:26<00:12,  4.06s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.028, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8827, 'compress@10': 0.5345, 'time@10': 5.2488}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]  {'epoch': 18, 'num_users': 6.125, 'loss': 0.028, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8827, 'compress@10': 0.5345, 'time@10': 5.2488}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0283, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8879, 'compress@10': 0.5821, 'time@10': 5.6161}:  80%|████████  | 8/10 [00:35<00:08,  4.30s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0283, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8879, 'compress@10': 0.5821, 'time@10': 5.6161}:  90%|█████████ | 9/10 [00:35<00:04,  4.30s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8912, 'compress@10': 0.5262, 'time@10': 5.589}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]    {'epoch': 18, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8912, 'compress@10': 0.5262, 'time@10': 5.589}: 100%|██████████| 10/10 [00:40<00:00,  4.64s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8912, 'compress@10': 0.5262, 'time@10': 5.589}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.027964850110188583
Avg hit ratio: 0.8834242301746545
Avg ndcg: 0.8911899530027088
Avg compression ratio: 0.5261760906925419
Avg train time: 5.588952898979187
Std train time: 1.7043973679387128
[0.775, 0.3250000000000001, 0.125, 0.9249999999999999, 0.9249999999999999, 0.725, 0.275, 0.22500000000000003, 0.675, 0.025000000000000005]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8782, 'compress@10': 0.9955, 'time@10': 5.0845}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8782, 'compress@10': 0.9955, 'time@10': 5.0845}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9008, 'compress@10': 0.5267, 'time@10': 4.6531}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9008, 'compress@10': 0.5267, 'time@10': 4.6531}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8863, 'compress@10': 0.3989, 'time@10': 4.1368}:  20%|██        | 2/10 [00:08<00:28,  3.57s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8863, 'compress@10': 0.3989, 'time@10': 4.1368}:  30%|███       | 3/10 [00:08<00:18,  2.67s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8934, 'compress@10': 0.5491, 'time@10': 4.032}:  30%|███       | 3/10 [00:12<00:18,  2.67s/it]  {'epoch': 19, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8934, 'compress@10': 0.5491, 'time@10': 4.032}:  40%|████      | 4/10 [00:12<00:18,  3.10s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0268, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.881, 'compress@10': 0.6393, 'time@10': 4.9013}:  40%|████      | 4/10 [00:16<00:18,  3.10s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0268, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.881, 'compress@10': 0.6393, 'time@10': 4.9013}:  50%|█████     | 5/10 [00:16<00:17,  3.50s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0254, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8885, 'compress@10': 0.6968, 'time@10': 5.1204}:  50%|█████     | 5/10 [00:22<00:17,  3.50s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0254, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8885, 'compress@10': 0.6968, 'time@10': 5.1204}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0257, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8926, 'compress@10': 0.6047, 'time@10': 5.328}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0257, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8926, 'compress@10': 0.6047, 'time@10': 5.328}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.892, 'ndcg@10': 0.8949, 'compress@10': 0.5333, 'time@10': 5.2515}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.892, 'ndcg@10': 0.8949, 'compress@10': 0.5333, 'time@10': 5.2515}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.91, 'compress@10': 0.5814, 'time@10': 5.5746}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.91, 'compress@10': 0.5814, 'time@10': 5.5746}:  90%|█████████ | 9/10 [00:34<00:04,  4.24s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0242, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9153, 'compress@10': 0.5256, 'time@10': 5.5673}:  90%|█████████ | 9/10 [00:40<00:04,  4.24s/it] {'epoch': 19, 'num_users': 6.3, 'loss': 0.0242, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9153, 'compress@10': 0.5256, 'time@10': 5.5673}: 100%|██████████| 10/10 [00:40<00:00,  4.64s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0242, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9153, 'compress@10': 0.5256, 'time@10': 5.5673}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.024159976487025253
Avg hit ratio: 0.8913607381111625
Avg ndcg: 0.9153315213633837
Avg compression ratio: 0.5255617384761785
Avg train time: 5.567331480979919
Std train time: 1.6827178456550902
[0.7857142857142857, 0.30952380952380965, 0.11904761904761904, 0.9285714285714285, 0.9285714285714285, 0.6904761904761905, 0.30952380952380953, 0.21428571428571433, 0.6904761904761905, 0.023809523809523815]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8782, 'compress@10': 0.9962, 'time@10': 5.0428}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8782, 'compress@10': 0.9962, 'time@10': 5.0428}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9005, 'compress@10': 0.5242, 'time@10': 4.6572}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9005, 'compress@10': 0.5242, 'time@10': 4.6572}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.886, 'compress@10': 0.3972, 'time@10': 4.214}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]  {'epoch': 20, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.886, 'compress@10': 0.3972, 'time@10': 4.214}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8935, 'compress@10': 0.5479, 'time@10': 4.1046}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8935, 'compress@10': 0.5479, 'time@10': 4.1046}:  40%|████      | 4/10 [00:12<00:18,  3.16s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8817, 'compress@10': 0.6383, 'time@10': 4.9573}:  40%|████      | 4/10 [00:16<00:18,  3.16s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8817, 'compress@10': 0.6383, 'time@10': 4.9573}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0269, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.891, 'compress@10': 0.6941, 'time@10': 5.1729}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0269, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.891, 'compress@10': 0.6941, 'time@10': 5.1729}:  60%|██████    | 6/10 [00:22<00:17,  4.48s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0267, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8888, 'compress@10': 0.6041, 'time@10': 5.3629}:  60%|██████    | 6/10 [00:26<00:17,  4.48s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0267, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8888, 'compress@10': 0.6041, 'time@10': 5.3629}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0252, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.8939, 'compress@10': 0.5325, 'time@10': 5.2902}:  70%|███████   | 7/10 [00:31<00:12,  4.09s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0252, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.8939, 'compress@10': 0.5325, 'time@10': 5.2902}:  80%|████████  | 8/10 [00:31<00:08,  4.32s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0255, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.898, 'compress@10': 0.5821, 'time@10': 5.6079}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0255, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.898, 'compress@10': 0.5821, 'time@10': 5.6079}:  90%|█████████ | 9/10 [00:35<00:04,  4.26s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9032, 'compress@10': 0.5262, 'time@10': 5.5979}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9032, 'compress@10': 0.5262, 'time@10': 5.5979}: 100%|██████████| 10/10 [00:40<00:00,  4.66s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9032, 'compress@10': 0.5262, 'time@10': 5.5979}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.025516638964784316
Avg hit ratio: 0.8866500366262675
Avg ndcg: 0.9031557409601764
Avg compression ratio: 0.5261642285132988
Avg train time: 5.597928357124329
Std train time: 1.632339497758303
[0.7954545454545454, 0.2954545454545456, 0.11363636363636363, 0.9318181818181818, 0.9318181818181818, 0.7045454545454546, 0.29545454545454547, 0.20454545454545459, 0.7045454545454546, 0.02272727272727273]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8819, 'compress@10': 0.9967, 'time@10': 5.0134}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8819, 'compress@10': 0.9967, 'time@10': 5.0134}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9066, 'compress@10': 0.5223, 'time@10': 4.6811}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9066, 'compress@10': 0.5223, 'time@10': 4.6811}:  20%|██        | 2/10 [00:06<00:29,  3.63s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8901, 'compress@10': 0.3959, 'time@10': 4.2282}:  20%|██        | 2/10 [00:08<00:29,  3.63s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8901, 'compress@10': 0.3959, 'time@10': 4.2282}:  30%|███       | 3/10 [00:08<00:19,  2.75s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.897, 'compress@10': 0.5469, 'time@10': 4.1186}:  30%|███       | 3/10 [00:12<00:19,  2.75s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.897, 'compress@10': 0.5469, 'time@10': 4.1186}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8867, 'compress@10': 0.6375, 'time@10': 4.9414}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8867, 'compress@10': 0.6375, 'time@10': 4.9414}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8946, 'compress@10': 0.6941, 'time@10': 5.1505}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8946, 'compress@10': 0.6941, 'time@10': 5.1505}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8984, 'compress@10': 0.6033, 'time@10': 5.3787}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8984, 'compress@10': 0.6033, 'time@10': 5.3787}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9048, 'compress@10': 0.5318, 'time@10': 5.3019}:  70%|███████   | 7/10 [00:31<00:12,  4.12s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9048, 'compress@10': 0.5318, 'time@10': 5.3019}:  80%|████████  | 8/10 [00:31<00:08,  4.34s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.024, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9202, 'compress@10': 0.5814, 'time@10': 5.6187}:  80%|████████  | 8/10 [00:35<00:08,  4.34s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.024, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9202, 'compress@10': 0.5814, 'time@10': 5.6187}:  90%|█████████ | 9/10 [00:35<00:04,  4.27s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9239, 'compress@10': 0.5255, 'time@10': 5.6031}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]  {'epoch': 21, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9239, 'compress@10': 0.5255, 'time@10': 5.6031}: 100%|██████████| 10/10 [00:40<00:00,  4.65s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0237, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9239, 'compress@10': 0.5255, 'time@10': 5.6031}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.023745377044699943
Avg hit ratio: 0.8974436874199183
Avg ndcg: 0.9239477296241162
Avg compression ratio: 0.5255194206535954
Avg train time: 5.603063440322876
Std train time: 1.6190436986620624
[0.8043478260869564, 0.28260869565217406, 0.10869565217391304, 0.9347826086956521, 0.9347826086956521, 0.6739130434782609, 0.32608695652173914, 0.19565217391304351, 0.7173913043478262, 0.02173913043478261]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.9971, 'time@10': 5.0956}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.9971, 'time@10': 5.0956}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9112, 'compress@10': 0.5207, 'time@10': 4.6976}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9112, 'compress@10': 0.5207, 'time@10': 4.6976}:  20%|██        | 2/10 [00:06<00:28,  3.62s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8932, 'compress@10': 0.3948, 'time@10': 4.2538}:  20%|██        | 2/10 [00:08<00:28,  3.62s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8932, 'compress@10': 0.3948, 'time@10': 4.2538}:  30%|███       | 3/10 [00:08<00:19,  2.75s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9024, 'compress@10': 0.5461, 'time@10': 4.1383}:  30%|███       | 3/10 [00:12<00:19,  2.75s/it]  {'epoch': 22, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9024, 'compress@10': 0.5461, 'time@10': 4.1383}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0231, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.892, 'compress@10': 0.6369, 'time@10': 4.977}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0231, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.892, 'compress@10': 0.6369, 'time@10': 4.977}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9015, 'compress@10': 0.691, 'time@10': 5.1973}:  50%|█████     | 5/10 [00:23<00:17,  3.55s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9015, 'compress@10': 0.691, 'time@10': 5.1973}:  60%|██████    | 6/10 [00:23<00:17,  4.50s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0218, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8991, 'compress@10': 0.6026, 'time@10': 5.387}:  60%|██████    | 6/10 [00:26<00:17,  4.50s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0218, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8991, 'compress@10': 0.6026, 'time@10': 5.387}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9054, 'compress@10': 0.5312, 'time@10': 5.3124}:  70%|███████   | 7/10 [00:31<00:12,  4.11s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9054, 'compress@10': 0.5312, 'time@10': 5.3124}:  80%|████████  | 8/10 [00:31<00:08,  4.34s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9088, 'compress@10': 0.5818, 'time@10': 5.6481}:  80%|████████  | 8/10 [00:35<00:08,  4.34s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9088, 'compress@10': 0.5818, 'time@10': 5.6481}:  90%|█████████ | 9/10 [00:35<00:04,  4.30s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9152, 'compress@10': 0.5259, 'time@10': 5.6391}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]    {'epoch': 22, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9152, 'compress@10': 0.5259, 'time@10': 5.6391}: 100%|██████████| 10/10 [00:40<00:00,  4.70s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9152, 'compress@10': 0.5259, 'time@10': 5.6391}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.020069521304218386
Avg hit ratio: 0.8969925596003694
Avg ndcg: 0.9151612366437613
Avg compression ratio: 0.5258893506244937
Avg train time: 5.639067554473877
Std train time: 1.6471055271406205
[0.8124999999999999, 0.2708333333333335, 0.10416666666666666, 0.9374999999999999, 0.9374999999999999, 0.6458333333333334, 0.3541666666666667, 0.18750000000000003, 0.7291666666666667, 0.020833333333333336]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0327, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9973, 'time@10': 5.5017}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0327, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9973, 'time@10': 5.5017}:  10%|█         | 1/10 [00:02<00:25,  2.79s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9167, 'compress@10': 0.5196, 'time@10': 4.8799}:  10%|█         | 1/10 [00:07<00:25,  2.79s/it] {'epoch': 23, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9167, 'compress@10': 0.5196, 'time@10': 4.8799}:  20%|██        | 2/10 [00:07<00:29,  3.68s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8969, 'compress@10': 0.3941, 'time@10': 4.3686}:  20%|██        | 2/10 [00:08<00:29,  3.68s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8969, 'compress@10': 0.3941, 'time@10': 4.3686}:  30%|███       | 3/10 [00:08<00:19,  2.78s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9031, 'compress@10': 0.5455, 'time@10': 4.2136}:  30%|███       | 3/10 [00:12<00:19,  2.78s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9031, 'compress@10': 0.5455, 'time@10': 4.2136}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8941, 'compress@10': 0.6364, 'time@10': 5.0461}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8941, 'compress@10': 0.6364, 'time@10': 5.0461}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9065, 'compress@10': 0.6876, 'time@10': 5.2468}:  50%|█████     | 5/10 [00:23<00:17,  3.56s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9065, 'compress@10': 0.6876, 'time@10': 5.2468}:  60%|██████    | 6/10 [00:23<00:17,  4.49s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0237, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9106, 'compress@10': 0.6021, 'time@10': 5.4449}:  60%|██████    | 6/10 [00:26<00:17,  4.49s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0237, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9106, 'compress@10': 0.6021, 'time@10': 5.4449}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9174, 'compress@10': 0.5306, 'time@10': 5.3626}:  70%|███████   | 7/10 [00:31<00:12,  4.12s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9174, 'compress@10': 0.5306, 'time@10': 5.3626}:  80%|████████  | 8/10 [00:31<00:08,  4.34s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.923, 'compress@10': 0.5811, 'time@10': 5.6433}:  80%|████████  | 8/10 [00:35<00:08,  4.34s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.923, 'compress@10': 0.5811, 'time@10': 5.6433}:  90%|█████████ | 9/10 [00:35<00:04,  4.23s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9269, 'compress@10': 0.5252, 'time@10': 5.6509}:  90%|█████████ | 9/10 [00:41<00:04,  4.23s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9269, 'compress@10': 0.5252, 'time@10': 5.6509}: 100%|██████████| 10/10 [00:41<00:00,  4.70s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9269, 'compress@10': 0.5252, 'time@10': 5.6509}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.022982013761313695
Avg hit ratio: 0.8998497024575123
Avg ndcg: 0.9268554474898295
Avg compression ratio: 0.5252387370096516
Avg train time: 5.650902009010315
Std train time: 1.594011138575324
[0.8199999999999998, 0.2600000000000001, 0.09999999999999999, 0.94, 0.94, 0.66, 0.34, 0.18000000000000002, 0.7400000000000001, 0.020000000000000004]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0308, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9977, 'time@10': 5.0227}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0308, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9977, 'time@10': 5.0227}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9184, 'compress@10': 0.5187, 'time@10': 4.6324}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9184, 'compress@10': 0.5187, 'time@10': 4.6324}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.898, 'compress@10': 0.3935, 'time@10': 4.2081}:  20%|██        | 2/10 [00:08<00:28,  3.57s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.898, 'compress@10': 0.3935, 'time@10': 4.2081}:  30%|███       | 3/10 [00:08<00:19,  2.72s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9078, 'compress@10': 0.5451, 'time@10': 4.0885}:  30%|███       | 3/10 [00:12<00:19,  2.72s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9078, 'compress@10': 0.5451, 'time@10': 4.0885}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0209, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9013, 'compress@10': 0.6361, 'time@10': 4.9443}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0209, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9013, 'compress@10': 0.6361, 'time@10': 4.9443}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9093, 'compress@10': 0.6894, 'time@10': 5.1601}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9093, 'compress@10': 0.6894, 'time@10': 5.1601}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9082, 'compress@10': 0.6026, 'time@10': 5.3628}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9082, 'compress@10': 0.6026, 'time@10': 5.3628}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0204, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9142, 'compress@10': 0.531, 'time@10': 5.2982}:  70%|███████   | 7/10 [00:31<00:12,  4.09s/it]  {'epoch': 24, 'num_users': 6.125, 'loss': 0.0204, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9142, 'compress@10': 0.531, 'time@10': 5.2982}:  80%|████████  | 8/10 [00:31<00:08,  4.34s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0207, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9164, 'compress@10': 0.5822, 'time@10': 5.6052}:  80%|████████  | 8/10 [00:35<00:08,  4.34s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0207, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9164, 'compress@10': 0.5822, 'time@10': 5.6052}:  90%|█████████ | 9/10 [00:35<00:04,  4.26s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.919, 'compress@10': 0.5262, 'time@10': 5.6332}:  90%|█████████ | 9/10 [00:41<00:04,  4.26s/it]    {'epoch': 24, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.919, 'compress@10': 0.5262, 'time@10': 5.6332}: 100%|██████████| 10/10 [00:41<00:00,  4.77s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.919, 'compress@10': 0.5262, 'time@10': 5.6332}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.0216410275975025
Avg hit ratio: 0.89762748023529
Avg ndcg: 0.919018013634572
Avg compression ratio: 0.5262431292570667
Avg train time: 5.633231544494629
Std train time: 1.6253700328547829
[0.8269230769230768, 0.2500000000000001, 0.09615384615384615, 0.9423076923076923, 0.9423076923076923, 0.6346153846153847, 0.3653846153846154, 0.1730769230769231, 0.7115384615384617, 0.057692307692307696]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8936, 'compress@10': 0.9978, 'time@10': 5.1871}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8936, 'compress@10': 0.9978, 'time@10': 5.1871}:  10%|█         | 1/10 [00:02<00:23,  2.63s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9227, 'compress@10': 0.5182, 'time@10': 4.7237}:  10%|█         | 1/10 [00:06<00:23,  2.63s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9227, 'compress@10': 0.5182, 'time@10': 4.7237}:  20%|██        | 2/10 [00:06<00:28,  3.61s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9009, 'compress@10': 0.3931, 'time@10': 4.285}:  20%|██        | 2/10 [00:08<00:28,  3.61s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9009, 'compress@10': 0.3931, 'time@10': 4.285}:  30%|███       | 3/10 [00:08<00:19,  2.76s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9085, 'compress@10': 0.5448, 'time@10': 4.1624}:  30%|███       | 3/10 [00:12<00:19,  2.76s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9085, 'compress@10': 0.5448, 'time@10': 4.1624}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9029, 'compress@10': 0.6358, 'time@10': 4.9957}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9029, 'compress@10': 0.6358, 'time@10': 4.9957}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9137, 'compress@10': 0.6863, 'time@10': 5.1763}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9137, 'compress@10': 0.6863, 'time@10': 5.1763}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9172, 'compress@10': 0.6024, 'time@10': 5.3879}:  60%|██████    | 6/10 [00:26<00:17,  4.42s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9172, 'compress@10': 0.6024, 'time@10': 5.3879}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9222, 'compress@10': 0.5309, 'time@10': 5.3136}:  70%|███████   | 7/10 [00:31<00:12,  4.09s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9222, 'compress@10': 0.5309, 'time@10': 5.3136}:  80%|████████  | 8/10 [00:31<00:08,  4.32s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9267, 'compress@10': 0.5806, 'time@10': 5.5679}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9267, 'compress@10': 0.5806, 'time@10': 5.5679}:  90%|█████████ | 9/10 [00:34<00:04,  4.17s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9312, 'compress@10': 0.5248, 'time@10': 5.5726}:  90%|█████████ | 9/10 [00:40<00:04,  4.17s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9312, 'compress@10': 0.5248, 'time@10': 5.5726}: 100%|██████████| 10/10 [00:40<00:00,  4.63s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9312, 'compress@10': 0.5248, 'time@10': 5.5726}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.017164956486539682
Avg hit ratio: 0.9027068453146552
Avg ndcg: 0.9312271979837208
Avg compression ratio: 0.5247785935406244
Avg train time: 5.572590279579162
Std train time: 1.5324149682113208
[0.8333333333333331, 0.24074074074074084, 0.09259259259259259, 0.9444444444444444, 0.9444444444444444, 0.6111111111111112, 0.38888888888888895, 0.16666666666666669, 0.7222222222222223, 0.05555555555555556]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.891, 'compress@10': 0.9981, 'time@10': 5.1589}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.891, 'compress@10': 0.9981, 'time@10': 5.1589}:  10%|█         | 1/10 [00:02<00:23,  2.62s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9228, 'compress@10': 0.5178, 'time@10': 4.6995}:  10%|█         | 1/10 [00:06<00:23,  2.62s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9228, 'compress@10': 0.5178, 'time@10': 4.6995}:  20%|██        | 2/10 [00:06<00:28,  3.61s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9009, 'compress@10': 0.3929, 'time@10': 4.2411}:  20%|██        | 2/10 [00:08<00:28,  3.61s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9009, 'compress@10': 0.3929, 'time@10': 4.2411}:  30%|███       | 3/10 [00:08<00:19,  2.74s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9119, 'compress@10': 0.5446, 'time@10': 4.1585}:  30%|███       | 3/10 [00:12<00:19,  2.74s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9119, 'compress@10': 0.5446, 'time@10': 4.1585}:  40%|████      | 4/10 [00:12<00:19,  3.22s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9056, 'compress@10': 0.6357, 'time@10': 4.9815}:  40%|████      | 4/10 [00:16<00:19,  3.22s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9056, 'compress@10': 0.6357, 'time@10': 4.9815}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9157, 'compress@10': 0.6816, 'time@10': 5.1577}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9157, 'compress@10': 0.6816, 'time@10': 5.1577}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9157, 'compress@10': 0.6019, 'time@10': 5.3855}:  60%|██████    | 6/10 [00:26<00:17,  4.42s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9157, 'compress@10': 0.6019, 'time@10': 5.3855}:  70%|███████   | 7/10 [00:26<00:12,  4.09s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0182, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9224, 'compress@10': 0.5304, 'time@10': 5.3037}:  70%|███████   | 7/10 [00:31<00:12,  4.09s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0182, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9224, 'compress@10': 0.5304, 'time@10': 5.3037}:  80%|████████  | 8/10 [00:31<00:08,  4.31s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0179, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9254, 'compress@10': 0.5811, 'time@10': 5.6067}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0179, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9254, 'compress@10': 0.5811, 'time@10': 5.6067}:  90%|█████████ | 9/10 [00:35<00:04,  4.23s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9278, 'compress@10': 0.5253, 'time@10': 5.599}:  90%|█████████ | 9/10 [00:40<00:04,  4.23s/it]     {'epoch': 26, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9278, 'compress@10': 0.5253, 'time@10': 5.599}: 100%|██████████| 10/10 [00:40<00:00,  4.64s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9278, 'compress@10': 0.5253, 'time@10': 5.599}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.018923776132147706
Avg hit ratio: 0.8969925596003694
Avg ndcg: 0.9277962126031438
Avg compression ratio: 0.5252906807117284
Avg train time: 5.599011397361755
Std train time: 1.5941796988903496
[0.8392857142857141, 0.23214285714285723, 0.08928571428571427, 0.9464285714285714, 0.9464285714285714, 0.625, 0.37500000000000006, 0.16071428571428573, 0.6964285714285715, 0.08928571428571429]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0259, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8952, 'compress@10': 0.9984, 'time@10': 5.1661}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0259, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8952, 'compress@10': 0.9984, 'time@10': 5.1661}:  10%|█         | 1/10 [00:02<00:23,  2.62s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9279, 'compress@10': 0.5175, 'time@10': 4.7028}:  10%|█         | 1/10 [00:06<00:23,  2.62s/it] {'epoch': 27, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9279, 'compress@10': 0.5175, 'time@10': 4.7028}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9043, 'compress@10': 0.3927, 'time@10': 4.2346}:  20%|██        | 2/10 [00:08<00:28,  3.60s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9043, 'compress@10': 0.3927, 'time@10': 4.2346}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9128, 'compress@10': 0.5445, 'time@10': 4.101}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9128, 'compress@10': 0.5445, 'time@10': 4.101}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9072, 'compress@10': 0.6356, 'time@10': 4.954}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9072, 'compress@10': 0.6356, 'time@10': 4.954}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9145, 'compress@10': 0.6859, 'time@10': 5.1395}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9145, 'compress@10': 0.6859, 'time@10': 5.1395}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9181, 'compress@10': 0.6035, 'time@10': 5.3747}:  60%|██████    | 6/10 [00:26<00:17,  4.40s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9181, 'compress@10': 0.6035, 'time@10': 5.3747}:  70%|███████   | 7/10 [00:26<00:12,  4.08s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0182, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9238, 'compress@10': 0.5317, 'time@10': 5.3005}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]  {'epoch': 27, 'num_users': 6.125, 'loss': 0.0182, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9238, 'compress@10': 0.5317, 'time@10': 5.3005}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9285, 'compress@10': 0.5808, 'time@10': 5.5758}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9285, 'compress@10': 0.5808, 'time@10': 5.5758}:  90%|█████████ | 9/10 [00:34<00:04,  4.20s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9331, 'compress@10': 0.525, 'time@10': 5.583}:  90%|█████████ | 9/10 [00:40<00:04,  4.20s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9331, 'compress@10': 0.525, 'time@10': 5.583}: 100%|██████████| 10/10 [00:40<00:00,  4.66s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9331, 'compress@10': 0.525, 'time@10': 5.583}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.017192843314087332
Avg hit ratio: 0.8936049238443127
Avg ndcg: 0.9331299131282537
Avg compression ratio: 0.5249721596614195
Avg train time: 5.5830240726470945
Std train time: 1.60105053760344
[0.8448275862068964, 0.22413793103448285, 0.08620689655172413, 0.9482758620689655, 0.9482758620689655, 0.6379310344827587, 0.3965517241379311, 0.15517241379310345, 0.6724137931034484, 0.08620689655172414]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8952, 'compress@10': 0.9987, 'time@10': 5.0464}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8952, 'compress@10': 0.9987, 'time@10': 5.0464}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9248, 'compress@10': 0.5174, 'time@10': 4.6629}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it] {'epoch': 28, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9248, 'compress@10': 0.5174, 'time@10': 4.6629}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9022, 'compress@10': 0.3926, 'time@10': 4.221}:  20%|██        | 2/10 [00:08<00:28,  3.60s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9022, 'compress@10': 0.3926, 'time@10': 4.221}:  30%|███       | 3/10 [00:08<00:19,  2.74s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9155, 'compress@10': 0.5445, 'time@10': 4.1134}:  30%|███       | 3/10 [00:12<00:19,  2.74s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9155, 'compress@10': 0.5445, 'time@10': 4.1134}:  40%|████      | 4/10 [00:12<00:19,  3.17s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9101, 'compress@10': 0.6355, 'time@10': 4.9754}:  40%|████      | 4/10 [00:16<00:19,  3.17s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9101, 'compress@10': 0.6355, 'time@10': 4.9754}:  50%|█████     | 5/10 [00:16<00:17,  3.56s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9205, 'compress@10': 0.6877, 'time@10': 5.1763}:  50%|█████     | 5/10 [00:22<00:17,  3.56s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9205, 'compress@10': 0.6877, 'time@10': 5.1763}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9215, 'compress@10': 0.6085, 'time@10': 5.4167}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9215, 'compress@10': 0.6085, 'time@10': 5.4167}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.927, 'compress@10': 0.5361, 'time@10': 5.3384}:  70%|███████   | 7/10 [00:31<00:12,  4.14s/it]  {'epoch': 28, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.927, 'compress@10': 0.5361, 'time@10': 5.3384}:  80%|████████  | 8/10 [00:31<00:08,  4.36s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.9034, 'ndcg@10': 0.9301, 'compress@10': 0.5834, 'time@10': 5.6279}:  80%|████████  | 8/10 [00:35<00:08,  4.36s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.9034, 'ndcg@10': 0.9301, 'compress@10': 0.5834, 'time@10': 5.6279}:  90%|█████████ | 9/10 [00:35<00:04,  4.25s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.935, 'compress@10': 0.5274, 'time@10': 5.6156}:  90%|█████████ | 9/10 [00:40<00:04,  4.25s/it]    {'epoch': 28, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.935, 'compress@10': 0.5274, 'time@10': 5.6156}: 100%|██████████| 10/10 [00:40<00:00,  4.65s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.935, 'compress@10': 0.5274, 'time@10': 5.6156}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.014698338640036914
Avg hit ratio: 0.9108271460665348
Avg ndcg: 0.9350395074522744
Avg compression ratio: 0.5273594182620094
Avg train time: 5.615557980537415
Std train time: 1.6277588675760999
[0.8499999999999998, 0.21666666666666676, 0.08333333333333333, 0.95, 0.95, 0.6166666666666667, 0.41666666666666674, 0.15, 0.6500000000000001, 0.11666666666666667]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9004, 'compress@10': 0.9988, 'time@10': 5.1303}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9004, 'compress@10': 0.9988, 'time@10': 5.1303}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9322, 'compress@10': 0.5171, 'time@10': 4.6878}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9322, 'compress@10': 0.5171, 'time@10': 4.6878}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9072, 'compress@10': 0.3924, 'time@10': 4.2255}:  20%|██        | 2/10 [00:08<00:28,  3.60s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9072, 'compress@10': 0.3924, 'time@10': 4.2255}:  30%|███       | 3/10 [00:08<00:19,  2.72s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9198, 'compress@10': 0.5443, 'time@10': 4.1126}:  30%|███       | 3/10 [00:12<00:19,  2.72s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9198, 'compress@10': 0.5443, 'time@10': 4.1126}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9137, 'compress@10': 0.6354, 'time@10': 4.971}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it] {'epoch': 29, 'num_users': 5.8, 'loss': 0.0157, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9137, 'compress@10': 0.6354, 'time@10': 4.971}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0171, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9262, 'compress@10': 0.6837, 'time@10': 5.1655}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0171, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9262, 'compress@10': 0.6837, 'time@10': 5.1655}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0173, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.929, 'compress@10': 0.6085, 'time@10': 5.4311}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it] {'epoch': 29, 'num_users': 6.2857, 'loss': 0.0173, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.929, 'compress@10': 0.6085, 'time@10': 5.4311}:  70%|███████   | 7/10 [00:26<00:12,  4.15s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9344, 'compress@10': 0.5361, 'time@10': 5.3454}:  70%|███████   | 7/10 [00:31<00:12,  4.15s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9344, 'compress@10': 0.5361, 'time@10': 5.3454}:  80%|████████  | 8/10 [00:31<00:08,  4.35s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9375, 'compress@10': 0.5822, 'time@10': 5.6229}:  80%|████████  | 8/10 [00:35<00:08,  4.35s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9375, 'compress@10': 0.5822, 'time@10': 5.6229}:  90%|█████████ | 9/10 [00:35<00:04,  4.23s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9413, 'compress@10': 0.5263, 'time@10': 5.6377}:  90%|█████████ | 9/10 [00:40<00:04,  4.23s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9413, 'compress@10': 0.5263, 'time@10': 5.6377}: 100%|██████████| 10/10 [00:40<00:00,  4.72s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9413, 'compress@10': 0.5263, 'time@10': 5.6377}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.014894070596688905
Avg hit ratio: 0.8958271460665349
Avg ndcg: 0.9412961425573287
Avg compression ratio: 0.5262977773461682
Avg train time: 5.637747287750244
Std train time: 1.6320304037619715
[0.8548387096774192, 0.2096774193548388, 0.08064516129032258, 0.9516129032258064, 0.9516129032258064, 0.6290322580645161, 0.435483870967742, 0.14516129032258063, 0.6290322580645162, 0.11290322580645161]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9004, 'compress@10': 0.999, 'time@10': 5.007}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9004, 'compress@10': 0.999, 'time@10': 5.007}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9344, 'compress@10': 0.5171, 'time@10': 4.6228}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9344, 'compress@10': 0.5171, 'time@10': 4.6228}:  20%|██        | 2/10 [00:06<00:28,  3.56s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9086, 'compress@10': 0.3924, 'time@10': 4.1968}:  20%|██        | 2/10 [00:08<00:28,  3.56s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9086, 'compress@10': 0.3924, 'time@10': 4.1968}:  30%|███       | 3/10 [00:08<00:19,  2.72s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9215, 'compress@10': 0.5443, 'time@10': 4.093}:  30%|███       | 3/10 [00:12<00:19,  2.72s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9215, 'compress@10': 0.5443, 'time@10': 4.093}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9167, 'compress@10': 0.6354, 'time@10': 4.9408}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9167, 'compress@10': 0.6354, 'time@10': 4.9408}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9258, 'compress@10': 0.6866, 'time@10': 5.1431}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9258, 'compress@10': 0.6866, 'time@10': 5.1431}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9265, 'compress@10': 0.6155, 'time@10': 5.3738}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9265, 'compress@10': 0.6155, 'time@10': 5.3738}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9327, 'compress@10': 0.5422, 'time@10': 5.2905}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9327, 'compress@10': 0.5422, 'time@10': 5.2905}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9362, 'compress@10': 0.5859, 'time@10': 5.5459}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9362, 'compress@10': 0.5859, 'time@10': 5.5459}:  90%|█████████ | 9/10 [00:34<00:04,  4.16s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9377, 'compress@10': 0.5296, 'time@10': 5.5778}:  90%|█████████ | 9/10 [00:40<00:04,  4.16s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9377, 'compress@10': 0.5296, 'time@10': 5.5778}: 100%|██████████| 10/10 [00:40<00:00,  4.70s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9377, 'compress@10': 0.5296, 'time@10': 5.5778}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.014488088105034477
Avg hit ratio: 0.9013192095585983
Avg ndcg: 0.9377359690397993
Avg compression ratio: 0.5296339093259819
Avg train time: 5.577825379371643
Std train time: 1.5659975933108967
[0.8593749999999998, 0.20312500000000008, 0.078125, 0.9531249999999999, 0.9531249999999999, 0.609375, 0.45312500000000006, 0.14062499999999997, 0.6093750000000001, 0.140625]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9102, 'compress@10': 0.9991, 'time@10': 5.1239}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9102, 'compress@10': 0.9991, 'time@10': 5.1239}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9372, 'compress@10': 0.5169, 'time@10': 4.6721}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9372, 'compress@10': 0.5169, 'time@10': 4.6721}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9105, 'compress@10': 0.3923, 'time@10': 4.2365}:  20%|██        | 2/10 [00:08<00:28,  3.57s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9105, 'compress@10': 0.3923, 'time@10': 4.2365}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9223, 'compress@10': 0.5442, 'time@10': 4.1345}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9223, 'compress@10': 0.5442, 'time@10': 4.1345}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9176, 'compress@10': 0.6353, 'time@10': 4.9605}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9176, 'compress@10': 0.6353, 'time@10': 4.9605}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9268, 'compress@10': 0.6827, 'time@10': 5.1542}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9268, 'compress@10': 0.6827, 'time@10': 5.1542}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9295, 'compress@10': 0.6165, 'time@10': 5.3876}:  60%|██████    | 6/10 [00:26<00:17,  4.43s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9295, 'compress@10': 0.6165, 'time@10': 5.3876}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9352, 'compress@10': 0.5431, 'time@10': 5.3079}:  70%|███████   | 7/10 [00:31<00:12,  4.11s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9352, 'compress@10': 0.5431, 'time@10': 5.3079}:  80%|████████  | 8/10 [00:31<00:08,  4.33s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9388, 'compress@10': 0.5846, 'time@10': 5.5629}:  80%|████████  | 8/10 [00:34<00:08,  4.33s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9388, 'compress@10': 0.5846, 'time@10': 5.5629}:  90%|█████████ | 9/10 [00:34<00:04,  4.17s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9406, 'compress@10': 0.5284, 'time@10': 5.5842}:  90%|█████████ | 9/10 [00:40<00:04,  4.17s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9406, 'compress@10': 0.5284, 'time@10': 5.5842}: 100%|██████████| 10/10 [00:40<00:00,  4.68s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9406, 'compress@10': 0.5284, 'time@10': 5.5842}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.013312710228732403
Avg hit ratio: 0.9031727681863504
Avg ndcg: 0.9406054410302399
Avg compression ratio: 0.5284199219678116
Avg train time: 5.584178471565247
Std train time: 1.54294631927556
[0.8636363636363634, 0.19696969696969704, 0.07575757575757576, 0.9545454545454545, 0.9545454545454545, 0.5909090909090909, 0.4696969696969697, 0.13636363636363633, 0.590909090909091, 0.16666666666666666]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9102, 'compress@10': 0.9992, 'time@10': 5.0633}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9102, 'compress@10': 0.9992, 'time@10': 5.0633}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9377, 'compress@10': 0.5168, 'time@10': 4.6574}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it] {'epoch': 32, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9377, 'compress@10': 0.5168, 'time@10': 4.6574}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9109, 'compress@10': 0.3922, 'time@10': 4.2179}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9109, 'compress@10': 0.3922, 'time@10': 4.2179}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9238, 'compress@10': 0.5441, 'time@10': 4.1008}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9238, 'compress@10': 0.5441, 'time@10': 4.1008}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9208, 'compress@10': 0.6353, 'time@10': 4.9649}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it] {'epoch': 32, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.9208, 'compress@10': 0.6353, 'time@10': 4.9649}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9314, 'compress@10': 0.6779, 'time@10': 5.1753}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9314, 'compress@10': 0.6779, 'time@10': 5.1753}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9318, 'compress@10': 0.6179, 'time@10': 5.4138}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9318, 'compress@10': 0.6179, 'time@10': 5.4138}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.936, 'compress@10': 0.5443, 'time@10': 5.3226}:  70%|███████   | 7/10 [00:31<00:12,  4.14s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.936, 'compress@10': 0.5443, 'time@10': 5.3226}:  80%|████████  | 8/10 [00:31<00:08,  4.33s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9395, 'compress@10': 0.5829, 'time@10': 5.6538}:  80%|████████  | 8/10 [00:35<00:08,  4.33s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9395, 'compress@10': 0.5829, 'time@10': 5.6538}:  90%|█████████ | 9/10 [00:35<00:04,  4.28s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9431, 'compress@10': 0.5269, 'time@10': 5.6801}:  90%|█████████ | 9/10 [00:41<00:04,  4.28s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9431, 'compress@10': 0.5269, 'time@10': 5.6801}: 100%|██████████| 10/10 [00:41<00:00,  4.80s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9431, 'compress@10': 0.5269, 'time@10': 5.6801}: 100%|██████████| 10/10 [00:41<00:00,  4.12s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.013834012091885114
Avg hit ratio: 0.8871128603522491
Avg ndcg: 0.9430871984315159
Avg compression ratio: 0.5269261239236245
Avg train time: 5.6800621271133425
Std train time: 1.6949304805156693
[0.8676470588235292, 0.19117647058823536, 0.07352941176470588, 0.9558823529411764, 0.9558823529411764, 0.6029411764705883, 0.4558823529411765, 0.13235294117647056, 0.6029411764705884, 0.16176470588235292]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9162, 'compress@10': 0.9993, 'time@10': 5.2599}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9162, 'compress@10': 0.9993, 'time@10': 5.2599}:  10%|█         | 1/10 [00:02<00:24,  2.67s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9413, 'compress@10': 0.5167, 'time@10': 4.7478}:  10%|█         | 1/10 [00:06<00:24,  2.67s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9413, 'compress@10': 0.5167, 'time@10': 4.7478}:  20%|██        | 2/10 [00:06<00:28,  3.61s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9133, 'compress@10': 0.3921, 'time@10': 4.2571}:  20%|██        | 2/10 [00:08<00:28,  3.61s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9133, 'compress@10': 0.3921, 'time@10': 4.2571}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9255, 'compress@10': 0.5441, 'time@10': 4.1484}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9255, 'compress@10': 0.5441, 'time@10': 4.1484}:  40%|████      | 4/10 [00:12<00:19,  3.20s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.9229, 'compress@10': 0.6353, 'time@10': 4.9984}:  40%|████      | 4/10 [00:16<00:19,  3.20s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.9229, 'compress@10': 0.6353, 'time@10': 4.9984}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9312, 'compress@10': 0.6801, 'time@10': 5.1767}:  50%|█████     | 5/10 [00:22<00:17,  3.58s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9312, 'compress@10': 0.6801, 'time@10': 5.1767}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9337, 'compress@10': 0.6151, 'time@10': 5.3999}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9337, 'compress@10': 0.6151, 'time@10': 5.3999}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9397, 'compress@10': 0.5419, 'time@10': 5.3007}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9397, 'compress@10': 0.5419, 'time@10': 5.3007}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9533, 'compress@10': 0.5813, 'time@10': 5.5781}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9533, 'compress@10': 0.5813, 'time@10': 5.5781}:  90%|█████████ | 9/10 [00:34<00:04,  4.17s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.955, 'compress@10': 0.5255, 'time@10': 5.5981}:  90%|█████████ | 9/10 [00:40<00:04,  4.17s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.955, 'compress@10': 0.5255, 'time@10': 5.5981}: 100%|██████████| 10/10 [00:40<00:00,  4.68s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.955, 'compress@10': 0.5255, 'time@10': 5.5981}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.013730502963862629
Avg hit ratio: 0.8771128603522491
Avg ndcg: 0.9550355644118518
Avg compression ratio: 0.5254840105279486
Avg train time: 5.598074126243591
Std train time: 1.6041821639367682
[0.8714285714285712, 0.18571428571428578, 0.07142857142857142, 0.9285714285714285, 0.9571428571428571, 0.5857142857142857, 0.4714285714285715, 0.12857142857142856, 0.6142857142857144, 0.1857142857142857]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9162, 'compress@10': 0.9993, 'time@10': 5.0763}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9162, 'compress@10': 0.9993, 'time@10': 5.0763}:  10%|█         | 1/10 [00:02<00:23,  2.58s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9414, 'compress@10': 0.5167, 'time@10': 4.6803}:  10%|█         | 1/10 [00:06<00:23,  2.58s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9414, 'compress@10': 0.5167, 'time@10': 4.6803}:  20%|██        | 2/10 [00:06<00:28,  3.61s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9133, 'compress@10': 0.3921, 'time@10': 4.2334}:  20%|██        | 2/10 [00:08<00:28,  3.61s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9133, 'compress@10': 0.3921, 'time@10': 4.2334}:  30%|███       | 3/10 [00:08<00:19,  2.74s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.925, 'compress@10': 0.5441, 'time@10': 4.1183}:  30%|███       | 3/10 [00:12<00:19,  2.74s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.925, 'compress@10': 0.5441, 'time@10': 4.1183}:  40%|████      | 4/10 [00:12<00:18,  3.16s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.923, 'compress@10': 0.6352, 'time@10': 4.988}:  40%|████      | 4/10 [00:16<00:18,  3.16s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.923, 'compress@10': 0.6352, 'time@10': 4.988}:  50%|█████     | 5/10 [00:16<00:17,  3.57s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9313, 'compress@10': 0.6754, 'time@10': 5.1797}:  50%|█████     | 5/10 [00:22<00:17,  3.57s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9313, 'compress@10': 0.6754, 'time@10': 5.1797}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.932, 'compress@10': 0.6161, 'time@10': 5.4085}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it] {'epoch': 34, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.932, 'compress@10': 0.6161, 'time@10': 5.4085}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9356, 'compress@10': 0.5427, 'time@10': 5.2906}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9356, 'compress@10': 0.5427, 'time@10': 5.2906}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.938, 'compress@10': 0.5841, 'time@10': 5.5927}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.938, 'compress@10': 0.5841, 'time@10': 5.5927}:  90%|█████████ | 9/10 [00:34<00:04,  4.18s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9415, 'compress@10': 0.5282, 'time@10': 5.621}:  90%|█████████ | 9/10 [00:40<00:04,  4.18s/it]    {'epoch': 34, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9415, 'compress@10': 0.5282, 'time@10': 5.621}: 100%|██████████| 10/10 [00:40<00:00,  4.71s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9415, 'compress@10': 0.5282, 'time@10': 5.621}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.013899381828074394
Avg hit ratio: 0.8829505459641283
Avg ndcg: 0.9415366761114102
Avg compression ratio: 0.5281611322625757
Avg train time: 5.621023035049438
Std train time: 1.6589110667776739
[0.8749999999999998, 0.1805555555555556, 0.06944444444444445, 0.9305555555555555, 0.9583333333333333, 0.5694444444444444, 0.48611111111111116, 0.12499999999999999, 0.6250000000000001, 0.18055555555555552]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.9994, 'time@10': 5.1148}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.9994, 'time@10': 5.1148}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9459, 'compress@10': 0.5167, 'time@10': 4.6824}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9459, 'compress@10': 0.5167, 'time@10': 4.6824}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9163, 'compress@10': 0.3921, 'time@10': 4.2329}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9163, 'compress@10': 0.3921, 'time@10': 4.2329}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9278, 'compress@10': 0.544, 'time@10': 4.1058}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]  {'epoch': 35, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9278, 'compress@10': 0.544, 'time@10': 4.1058}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9266, 'compress@10': 0.6352, 'time@10': 4.9541}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9266, 'compress@10': 0.6352, 'time@10': 4.9541}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9347, 'compress@10': 0.6688, 'time@10': 5.1532}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9347, 'compress@10': 0.6688, 'time@10': 5.1532}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.937, 'compress@10': 0.6153, 'time@10': 5.3814}:  60%|██████    | 6/10 [00:26<00:17,  4.43s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.937, 'compress@10': 0.6153, 'time@10': 5.3814}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9406, 'compress@10': 0.542, 'time@10': 5.2798}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9406, 'compress@10': 0.542, 'time@10': 5.2798}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9416, 'compress@10': 0.5863, 'time@10': 5.5491}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9416, 'compress@10': 0.5863, 'time@10': 5.5491}:  90%|█████████ | 9/10 [00:34<00:04,  4.14s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9456, 'compress@10': 0.5301, 'time@10': 5.5735}:  90%|█████████ | 9/10 [00:40<00:04,  4.14s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9456, 'compress@10': 0.5301, 'time@10': 5.5735}: 100%|██████████| 10/10 [00:40<00:00,  4.67s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9456, 'compress@10': 0.5301, 'time@10': 5.5735}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.01131283108097825
Avg hit ratio: 0.8958870539006363
Avg ndcg: 0.9455529256249637
Avg compression ratio: 0.530070752566721
Avg train time: 5.573530387878418
Std train time: 1.593832967295792
[0.8783783783783782, 0.1756756756756757, 0.06756756756756757, 0.9324324324324323, 0.9594594594594594, 0.5540540540540541, 0.5, 0.12162162162162161, 0.6351351351351352, 0.17567567567567566]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.9994, 'time@10': 5.2519}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.9994, 'time@10': 5.2519}:  10%|█         | 1/10 [00:02<00:23,  2.66s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9422, 'compress@10': 0.5167, 'time@10': 4.7706}:  10%|█         | 1/10 [00:07<00:23,  2.66s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9422, 'compress@10': 0.5167, 'time@10': 4.7706}:  20%|██        | 2/10 [00:07<00:29,  3.65s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9138, 'compress@10': 0.3922, 'time@10': 4.2955}:  20%|██        | 2/10 [00:08<00:29,  3.65s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9138, 'compress@10': 0.3922, 'time@10': 4.2955}:  30%|███       | 3/10 [00:08<00:19,  2.77s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9259, 'compress@10': 0.5441, 'time@10': 4.1701}:  30%|███       | 3/10 [00:12<00:19,  2.77s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9259, 'compress@10': 0.5441, 'time@10': 4.1701}:  40%|████      | 4/10 [00:12<00:19,  3.19s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9271, 'compress@10': 0.6353, 'time@10': 5.0321}:  40%|████      | 4/10 [00:16<00:19,  3.19s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9271, 'compress@10': 0.6353, 'time@10': 5.0321}:  50%|█████     | 5/10 [00:16<00:17,  3.58s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9403, 'compress@10': 0.6562, 'time@10': 5.2127}:  50%|█████     | 5/10 [00:22<00:17,  3.58s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9403, 'compress@10': 0.6562, 'time@10': 5.2127}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9412, 'compress@10': 0.6096, 'time@10': 5.4436}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9412, 'compress@10': 0.6096, 'time@10': 5.4436}:  70%|███████   | 7/10 [00:26<00:12,  4.13s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.9443, 'compress@10': 0.5371, 'time@10': 5.3239}:  70%|███████   | 7/10 [00:30<00:12,  4.13s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.9443, 'compress@10': 0.5371, 'time@10': 5.3239}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9645, 'compress@10': 0.5816, 'time@10': 5.6139}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9645, 'compress@10': 0.5816, 'time@10': 5.6139}:  90%|█████████ | 9/10 [00:34<00:04,  4.18s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9638, 'compress@10': 0.5258, 'time@10': 5.6179}:  90%|█████████ | 9/10 [00:40<00:04,  4.18s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9638, 'compress@10': 0.5258, 'time@10': 5.6179}: 100%|██████████| 10/10 [00:40<00:00,  4.64s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9638, 'compress@10': 0.5258, 'time@10': 5.6179}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.016137702282934888
Avg hit ratio: 0.899481523946719
Avg ndcg: 0.9637926515560166
Avg compression ratio: 0.5257885677970378
Avg train time: 5.617899680137635
Std train time: 1.6413611396064018
[0.8815789473684209, 0.1710526315789474, 0.06578947368421054, 0.9078947368421052, 0.9605263157894737, 0.5657894736842105, 0.4868421052631579, 0.11842105263157894, 0.6447368421052633, 0.19736842105263155]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.9995, 'time@10': 5.1063}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.9995, 'time@10': 5.1063}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.944, 'compress@10': 0.5166, 'time@10': 4.6836}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.944, 'compress@10': 0.5166, 'time@10': 4.6836}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.915, 'compress@10': 0.3921, 'time@10': 4.234}:  20%|██        | 2/10 [00:08<00:28,  3.60s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.915, 'compress@10': 0.3921, 'time@10': 4.234}:  30%|███       | 3/10 [00:08<00:19,  2.74s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9268, 'compress@10': 0.544, 'time@10': 4.1038}:  30%|███       | 3/10 [00:12<00:19,  2.74s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9268, 'compress@10': 0.544, 'time@10': 4.1038}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9282, 'compress@10': 0.6352, 'time@10': 4.962}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9282, 'compress@10': 0.6352, 'time@10': 4.962}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.936, 'compress@10': 0.6704, 'time@10': 5.1395}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.936, 'compress@10': 0.6704, 'time@10': 5.1395}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9388, 'compress@10': 0.6169, 'time@10': 5.369}:  60%|██████    | 6/10 [00:26<00:17,  4.40s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9388, 'compress@10': 0.6169, 'time@10': 5.369}:  70%|███████   | 7/10 [00:26<00:12,  4.07s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0088, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9418, 'compress@10': 0.5434, 'time@10': 5.2791}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0088, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9418, 'compress@10': 0.5434, 'time@10': 5.2791}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9471, 'compress@10': 0.5891, 'time@10': 5.5894}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9471, 'compress@10': 0.5891, 'time@10': 5.5894}:  90%|█████████ | 9/10 [00:34<00:04,  4.21s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.95, 'compress@10': 0.533, 'time@10': 5.5969}:  90%|█████████ | 9/10 [00:40<00:04,  4.21s/it]     {'epoch': 37, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.95, 'compress@10': 0.533, 'time@10': 5.5969}: 100%|██████████| 10/10 [00:40<00:00,  4.67s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.95, 'compress@10': 0.533, 'time@10': 5.5969}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.010636860501894652
Avg hit ratio: 0.9014584824720648
Avg ndcg: 0.9499752216691908
Avg compression ratio: 0.5330339092696467
Avg train time: 5.596906542778015
Std train time: 1.6446786713839368
[0.8846153846153845, 0.16666666666666669, 0.06410256410256411, 0.9102564102564102, 0.9615384615384616, 0.5512820512820512, 0.5, 0.11538461538461538, 0.653846153846154, 0.1923076923076923]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.9996, 'time@10': 5.0931}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.9996, 'time@10': 5.0931}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.893, 'ndcg@10': 0.947, 'compress@10': 0.5167, 'time@10': 4.6853}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it]  {'epoch': 38, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.893, 'ndcg@10': 0.947, 'compress@10': 0.5167, 'time@10': 4.6853}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9171, 'compress@10': 0.3921, 'time@10': 4.2306}:  20%|██        | 2/10 [00:08<00:28,  3.60s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9171, 'compress@10': 0.3921, 'time@10': 4.2306}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9284, 'compress@10': 0.544, 'time@10': 4.1299}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9284, 'compress@10': 0.544, 'time@10': 4.1299}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.93, 'compress@10': 0.6352, 'time@10': 5.001}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it]  {'epoch': 38, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.93, 'compress@10': 0.6352, 'time@10': 5.001}:  50%|█████     | 5/10 [00:16<00:17,  3.59s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9375, 'compress@10': 0.6644, 'time@10': 5.1826}:  50%|█████     | 5/10 [00:22<00:17,  3.59s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9375, 'compress@10': 0.6644, 'time@10': 5.1826}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9391, 'compress@10': 0.6173, 'time@10': 5.4088}:  60%|██████    | 6/10 [00:26<00:17,  4.45s/it]  {'epoch': 38, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9391, 'compress@10': 0.6173, 'time@10': 5.4088}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9422, 'compress@10': 0.5438, 'time@10': 5.3036}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9422, 'compress@10': 0.5438, 'time@10': 5.3036}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9448, 'compress@10': 0.5886, 'time@10': 5.5789}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9448, 'compress@10': 0.5886, 'time@10': 5.5789}:  90%|█████████ | 9/10 [00:34<00:04,  4.17s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9474, 'compress@10': 0.5323, 'time@10': 5.591}:  90%|█████████ | 9/10 [00:40<00:04,  4.17s/it]    {'epoch': 38, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9474, 'compress@10': 0.5323, 'time@10': 5.591}: 100%|██████████| 10/10 [00:40<00:00,  4.66s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9474, 'compress@10': 0.5323, 'time@10': 5.591}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.012366283307975451
Avg hit ratio: 0.8866049238443127
Avg ndcg: 0.9474023220269334
Avg compression ratio: 0.5323152362040785
Avg train time: 5.590994095802307
Std train time: 1.6155588019356804
[0.8874999999999998, 0.1625, 0.06250000000000001, 0.8875, 0.9625, 0.5375, 0.5125, 0.11249999999999999, 0.6625000000000001, 0.2125]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.9996, 'time@10': 5.1102}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.9996, 'time@10': 5.1102}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9457, 'compress@10': 0.5166, 'time@10': 4.6654}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9457, 'compress@10': 0.5166, 'time@10': 4.6654}:  20%|██        | 2/10 [00:06<00:28,  3.57s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9162, 'compress@10': 0.3921, 'time@10': 4.2002}:  20%|██        | 2/10 [00:08<00:28,  3.57s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9162, 'compress@10': 0.3921, 'time@10': 4.2002}:  30%|███       | 3/10 [00:08<00:18,  2.71s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9277, 'compress@10': 0.544, 'time@10': 4.0925}:  30%|███       | 3/10 [00:12<00:18,  2.71s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9277, 'compress@10': 0.544, 'time@10': 4.0925}:  40%|████      | 4/10 [00:12<00:18,  3.14s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0084, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9299, 'compress@10': 0.6352, 'time@10': 4.9355}:  40%|████      | 4/10 [00:16<00:18,  3.14s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0084, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9299, 'compress@10': 0.6352, 'time@10': 4.9355}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9376, 'compress@10': 0.6326, 'time@10': 5.145}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9376, 'compress@10': 0.6326, 'time@10': 5.145}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9403, 'compress@10': 0.5959, 'time@10': 5.3816}:  60%|██████    | 6/10 [00:26<00:17,  4.44s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9403, 'compress@10': 0.5959, 'time@10': 5.3816}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9434, 'compress@10': 0.5251, 'time@10': 5.275}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it]  {'epoch': 39, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9434, 'compress@10': 0.5251, 'time@10': 5.275}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0085, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9456, 'compress@10': 0.5735, 'time@10': 5.5466}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0085, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9456, 'compress@10': 0.5735, 'time@10': 5.5466}:  90%|█████████ | 9/10 [00:34<00:04,  4.15s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0079, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9487, 'compress@10': 0.5189, 'time@10': 5.5604}:  90%|█████████ | 9/10 [00:40<00:04,  4.15s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0079, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9487, 'compress@10': 0.5189, 'time@10': 5.5604}: 100%|██████████| 10/10 [00:40<00:00,  4.63s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0079, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9487, 'compress@10': 0.5189, 'time@10': 5.5604}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.007925930468368812
Avg hit ratio: 0.9063386668038621
Avg ndcg: 0.9486956318372227
Avg compression ratio: 0.5189479996750801
Avg train time: 5.560359835624695
Std train time: 1.602496889239553
[0.8902439024390243, 0.15853658536585366, 0.060975609756097573, 0.8902439024390243, 0.9634146341463414, 0.548780487804878, 0.49999999999999994, 0.1097560975609756, 0.6707317073170732, 0.2073170731707317]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.9997, 'time@10': 5.1494}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.9997, 'time@10': 5.1494}:  10%|█         | 1/10 [00:02<00:23,  2.62s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9456, 'compress@10': 0.5165, 'time@10': 4.6445}:  10%|█         | 1/10 [00:06<00:23,  2.62s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9456, 'compress@10': 0.5165, 'time@10': 4.6445}:  20%|██        | 2/10 [00:06<00:28,  3.54s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9161, 'compress@10': 0.392, 'time@10': 4.1778}:  20%|██        | 2/10 [00:08<00:28,  3.54s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9161, 'compress@10': 0.392, 'time@10': 4.1778}:  30%|███       | 3/10 [00:08<00:18,  2.68s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9283, 'compress@10': 0.5439, 'time@10': 4.0687}:  30%|███       | 3/10 [00:12<00:18,  2.68s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9283, 'compress@10': 0.5439, 'time@10': 4.0687}:  40%|████      | 4/10 [00:12<00:18,  3.12s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9306, 'compress@10': 0.6351, 'time@10': 4.9176}:  40%|████      | 4/10 [00:16<00:18,  3.12s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9306, 'compress@10': 0.6351, 'time@10': 4.9176}:  50%|█████     | 5/10 [00:16<00:17,  3.50s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9382, 'compress@10': 0.6634, 'time@10': 5.1177}:  50%|█████     | 5/10 [00:22<00:17,  3.50s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9382, 'compress@10': 0.6634, 'time@10': 5.1177}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9407, 'compress@10': 0.6169, 'time@10': 5.3642}:  60%|██████    | 6/10 [00:26<00:17,  4.41s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9407, 'compress@10': 0.6169, 'time@10': 5.3642}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9429, 'compress@10': 0.5434, 'time@10': 5.2726}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9429, 'compress@10': 0.5434, 'time@10': 5.2726}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9449, 'compress@10': 0.5903, 'time@10': 5.5839}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9449, 'compress@10': 0.5903, 'time@10': 5.5839}:  90%|█████████ | 9/10 [00:34<00:04,  4.22s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0114, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9467, 'compress@10': 0.534, 'time@10': 5.6063}:  90%|█████████ | 9/10 [00:40<00:04,  4.22s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0114, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9467, 'compress@10': 0.534, 'time@10': 5.6063}: 100%|██████████| 10/10 [00:40<00:00,  4.72s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0114, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9467, 'compress@10': 0.534, 'time@10': 5.6063}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.011395431016335207
Avg hit ratio: 0.9005219745355569
Avg ndcg: 0.9467264250993164
Avg compression ratio: 0.5339542911503666
Avg train time: 5.606292033195496
Std train time: 1.6619548291905821
[0.8928571428571428, 0.15476190476190477, 0.059523809523809534, 0.8928571428571428, 0.9642857142857143, 0.5357142857142857, 0.5119047619047619, 0.10714285714285712, 0.6547619047619048, 0.2261904761904762]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.9997, 'time@10': 5.0652}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.9997, 'time@10': 5.0652}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9504, 'compress@10': 0.5165, 'time@10': 4.6545}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9504, 'compress@10': 0.5165, 'time@10': 4.6545}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9193, 'compress@10': 0.392, 'time@10': 4.208}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]  {'epoch': 41, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9193, 'compress@10': 0.392, 'time@10': 4.208}:  30%|███       | 3/10 [00:08<00:19,  2.72s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9301, 'compress@10': 0.544, 'time@10': 4.1025}:  30%|███       | 3/10 [00:12<00:19,  2.72s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9301, 'compress@10': 0.544, 'time@10': 4.1025}:  40%|████      | 4/10 [00:12<00:18,  3.16s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9321, 'compress@10': 0.6351, 'time@10': 4.9174}:  40%|████      | 4/10 [00:16<00:18,  3.16s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9321, 'compress@10': 0.6351, 'time@10': 4.9174}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9399, 'compress@10': 0.6342, 'time@10': 5.1246}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9399, 'compress@10': 0.6342, 'time@10': 5.1246}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9412, 'compress@10': 0.5978, 'time@10': 5.3726}:  60%|██████    | 6/10 [00:26<00:17,  4.42s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9412, 'compress@10': 0.5978, 'time@10': 5.3726}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9438, 'compress@10': 0.5267, 'time@10': 5.2719}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9438, 'compress@10': 0.5267, 'time@10': 5.2719}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9458, 'compress@10': 0.5741, 'time@10': 5.5532}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9458, 'compress@10': 0.5741, 'time@10': 5.5532}:  90%|█████████ | 9/10 [00:34<00:04,  4.17s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9482, 'compress@10': 0.5199, 'time@10': 5.57}:  90%|█████████ | 9/10 [00:40<00:04,  4.17s/it]     {'epoch': 41, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9482, 'compress@10': 0.5199, 'time@10': 5.57}: 100%|██████████| 10/10 [00:40<00:00,  4.66s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9482, 'compress@10': 0.5199, 'time@10': 5.57}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.011060565296138998
Avg hit ratio: 0.9012593017244971
Avg ndcg: 0.9481960125311479
Avg compression ratio: 0.5199325258678917
Avg train time: 5.570021986961365
Std train time: 1.584504027190407
[0.8953488372093023, 0.1744186046511628, 0.05813953488372094, 0.872093023255814, 0.9651162790697675, 0.5232558139534883, 0.5232558139534883, 0.10465116279069765, 0.6395348837209303, 0.2441860465116279]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9302, 'compress@10': 0.9997, 'time@10': 5.0121}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9302, 'compress@10': 0.9997, 'time@10': 5.0121}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.949, 'compress@10': 0.5169, 'time@10': 4.6418}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]  {'epoch': 42, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.949, 'compress@10': 0.5169, 'time@10': 4.6418}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9184, 'compress@10': 0.3922, 'time@10': 4.211}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9184, 'compress@10': 0.3922, 'time@10': 4.211}:  30%|███       | 3/10 [00:08<00:19,  2.74s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9293, 'compress@10': 0.5441, 'time@10': 4.1136}:  30%|███       | 3/10 [00:12<00:19,  2.74s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9293, 'compress@10': 0.5441, 'time@10': 4.1136}:  40%|████      | 4/10 [00:12<00:19,  3.18s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9335, 'compress@10': 0.6353, 'time@10': 4.9553}:  40%|████      | 4/10 [00:16<00:19,  3.18s/it] {'epoch': 42, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9335, 'compress@10': 0.6353, 'time@10': 4.9553}:  50%|█████     | 5/10 [00:16<00:17,  3.55s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9389, 'compress@10': 0.6097, 'time@10': 5.1643}:  50%|█████     | 5/10 [00:22<00:17,  3.55s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9389, 'compress@10': 0.6097, 'time@10': 5.1643}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9417, 'compress@10': 0.5916, 'time@10': 5.4083}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9417, 'compress@10': 0.5916, 'time@10': 5.4083}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0088, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9445, 'compress@10': 0.5212, 'time@10': 5.3114}:  70%|███████   | 7/10 [00:31<00:12,  4.14s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0088, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9445, 'compress@10': 0.5212, 'time@10': 5.3114}:  80%|████████  | 8/10 [00:31<00:08,  4.31s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9485, 'compress@10': 0.5688, 'time@10': 5.5839}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]  {'epoch': 42, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9485, 'compress@10': 0.5688, 'time@10': 5.5839}:  90%|█████████ | 9/10 [00:34<00:04,  4.19s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9513, 'compress@10': 0.5154, 'time@10': 5.5978}:  90%|█████████ | 9/10 [00:40<00:04,  4.19s/it]  {'epoch': 42, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9513, 'compress@10': 0.5154, 'time@10': 5.5978}: 100%|██████████| 10/10 [00:40<00:00,  4.67s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9513, 'compress@10': 0.5154, 'time@10': 5.5978}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.010028946303159642
Avg hit ratio: 0.9185045654213736
Avg ndcg: 0.951250243640591
Avg compression ratio: 0.5154303144908632
Avg train time: 5.59776291847229
Std train time: 1.592736469102298
[0.8977272727272727, 0.17045454545454547, 0.05681818181818183, 0.8522727272727273, 0.9659090909090909, 0.5340909090909091, 0.5113636363636362, 0.10227272727272725, 0.6477272727272727, 0.26136363636363635]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9302, 'compress@10': 0.9997, 'time@10': 5.095}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9302, 'compress@10': 0.9997, 'time@10': 5.095}:  10%|█         | 1/10 [00:02<00:23,  2.59s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9524, 'compress@10': 0.5166, 'time@10': 4.6713}:  10%|█         | 1/10 [00:06<00:23,  2.59s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9524, 'compress@10': 0.5166, 'time@10': 4.6713}:  20%|██        | 2/10 [00:06<00:28,  3.59s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9206, 'compress@10': 0.3921, 'time@10': 4.2138}:  20%|██        | 2/10 [00:08<00:28,  3.59s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9206, 'compress@10': 0.3921, 'time@10': 4.2138}:  30%|███       | 3/10 [00:08<00:19,  2.72s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9315, 'compress@10': 0.5439, 'time@10': 4.1088}:  30%|███       | 3/10 [00:12<00:19,  2.72s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9315, 'compress@10': 0.5439, 'time@10': 4.1088}:  40%|████      | 4/10 [00:12<00:18,  3.16s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9355, 'compress@10': 0.6351, 'time@10': 4.8957}:  40%|████      | 4/10 [00:16<00:18,  3.16s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9355, 'compress@10': 0.6351, 'time@10': 4.8957}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9423, 'compress@10': 0.6464, 'time@10': 5.1195}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9423, 'compress@10': 0.6464, 'time@10': 5.1195}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9443, 'compress@10': 0.6113, 'time@10': 5.357}:  60%|██████    | 6/10 [00:26<00:17,  4.43s/it] {'epoch': 43, 'num_users': 6.2857, 'loss': 0.0091, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9443, 'compress@10': 0.6113, 'time@10': 5.357}:  70%|███████   | 7/10 [00:26<00:12,  4.11s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9456, 'compress@10': 0.5385, 'time@10': 5.2701}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9456, 'compress@10': 0.5385, 'time@10': 5.2701}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9458, 'compress@10': 0.5829, 'time@10': 5.5951}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9458, 'compress@10': 0.5829, 'time@10': 5.5951}:  90%|█████████ | 9/10 [00:34<00:04,  4.24s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9498, 'compress@10': 0.5283, 'time@10': 5.6337}:  90%|█████████ | 9/10 [00:41<00:04,  4.24s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9498, 'compress@10': 0.5283, 'time@10': 5.6337}: 100%|██████████| 10/10 [00:41<00:00,  4.79s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9498, 'compress@10': 0.5283, 'time@10': 5.6337}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.011090252727203882
Avg hit ratio: 0.8958870539006363
Avg ndcg: 0.9498283512029427
Avg compression ratio: 0.5282612871917748
Avg train time: 5.633733820915222
Std train time: 1.6176023651187914
[0.8777777777777778, 0.16666666666666669, 0.055555555555555566, 0.8555555555555556, 0.9666666666666667, 0.5222222222222221, 0.5222222222222221, 0.09999999999999998, 0.6555555555555556, 0.2777777777777778]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.9996, 'time@10': 5.1298}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.9996, 'time@10': 5.1298}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.893, 'ndcg@10': 0.947, 'compress@10': 0.5166, 'time@10': 4.6929}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it]  {'epoch': 44, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.893, 'ndcg@10': 0.947, 'compress@10': 0.5166, 'time@10': 4.6929}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9171, 'compress@10': 0.392, 'time@10': 4.221}:  20%|██        | 2/10 [00:08<00:28,  3.60s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9171, 'compress@10': 0.392, 'time@10': 4.221}:  30%|███       | 3/10 [00:08<00:19,  2.72s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9295, 'compress@10': 0.5439, 'time@10': 4.1338}:  30%|███       | 3/10 [00:12<00:19,  2.72s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9295, 'compress@10': 0.5439, 'time@10': 4.1338}:  40%|████      | 4/10 [00:12<00:19,  3.20s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9341, 'compress@10': 0.6351, 'time@10': 4.946}:  40%|████      | 4/10 [00:16<00:19,  3.20s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9341, 'compress@10': 0.6351, 'time@10': 4.946}:  50%|█████     | 5/10 [00:16<00:17,  3.54s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9408, 'compress@10': 0.6129, 'time@10': 5.1641}:  50%|█████     | 5/10 [00:22<00:17,  3.54s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9408, 'compress@10': 0.6129, 'time@10': 5.1641}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9429, 'compress@10': 0.5966, 'time@10': 5.4015}:  60%|██████    | 6/10 [00:26<00:17,  4.47s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9429, 'compress@10': 0.5966, 'time@10': 5.4015}:  70%|███████   | 7/10 [00:26<00:12,  4.14s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9441, 'compress@10': 0.5256, 'time@10': 5.286}:  70%|███████   | 7/10 [00:30<00:12,  4.14s/it]  {'epoch': 44, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9441, 'compress@10': 0.5256, 'time@10': 5.286}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9463, 'compress@10': 0.5738, 'time@10': 5.5971}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9463, 'compress@10': 0.5738, 'time@10': 5.5971}:  90%|█████████ | 9/10 [00:34<00:04,  4.20s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9493, 'compress@10': 0.5207, 'time@10': 5.6018}:  90%|█████████ | 9/10 [00:40<00:04,  4.20s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9493, 'compress@10': 0.5207, 'time@10': 5.6018}: 100%|██████████| 10/10 [00:40<00:00,  4.66s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9493, 'compress@10': 0.5207, 'time@10': 5.6018}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.01065543074047269
Avg hit ratio: 0.9015255587649476
Avg ndcg: 0.9493329843974049
Avg compression ratio: 0.5206564808730023
Avg train time: 5.601772356033325
Std train time: 1.628297085726997
[0.8586956521739131, 0.1630434782608696, 0.054347826086956534, 0.8586956521739131, 0.967391304347826, 0.5326086956521738, 0.5108695652173912, 0.09782608695652172, 0.6630434782608696, 0.29347826086956524]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.9994, 'time@10': 5.1873}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.9994, 'time@10': 5.1873}:  10%|█         | 1/10 [00:02<00:23,  2.63s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9506, 'compress@10': 0.5163, 'time@10': 4.7179}:  10%|█         | 1/10 [00:06<00:23,  2.63s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9506, 'compress@10': 0.5163, 'time@10': 4.7179}:  20%|██        | 2/10 [00:06<00:28,  3.61s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9195, 'compress@10': 0.3918, 'time@10': 4.2028}:  20%|██        | 2/10 [00:08<00:28,  3.61s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9195, 'compress@10': 0.3918, 'time@10': 4.2028}:  30%|███       | 3/10 [00:08<00:18,  2.70s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9307, 'compress@10': 0.5438, 'time@10': 4.0869}:  30%|███       | 3/10 [00:12<00:18,  2.70s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9307, 'compress@10': 0.5438, 'time@10': 4.0869}:  40%|████      | 4/10 [00:12<00:18,  3.13s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0075, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9355, 'compress@10': 0.635, 'time@10': 4.8912}:  40%|████      | 4/10 [00:16<00:18,  3.13s/it]  {'epoch': 45, 'num_users': 5.8, 'loss': 0.0075, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9355, 'compress@10': 0.635, 'time@10': 4.8912}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9421, 'compress@10': 0.6455, 'time@10': 5.1157}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9421, 'compress@10': 0.6455, 'time@10': 5.1157}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9448, 'compress@10': 0.6133, 'time@10': 5.3519}:  60%|██████    | 6/10 [00:26<00:17,  4.43s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9448, 'compress@10': 0.6133, 'time@10': 5.3519}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0069, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9479, 'compress@10': 0.5403, 'time@10': 5.2555}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0069, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9479, 'compress@10': 0.5403, 'time@10': 5.2555}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0081, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9492, 'compress@10': 0.5861, 'time@10': 5.5394}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0081, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9492, 'compress@10': 0.5861, 'time@10': 5.5394}:  90%|█████████ | 9/10 [00:34<00:04,  4.17s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0091, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9532, 'compress@10': 0.5319, 'time@10': 5.5464}:  90%|█████████ | 9/10 [00:40<00:04,  4.17s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0091, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9532, 'compress@10': 0.5319, 'time@10': 5.5464}: 100%|██████████| 10/10 [00:40<00:00,  4.63s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0091, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9532, 'compress@10': 0.5319, 'time@10': 5.5464}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.009068485374135522
Avg hit ratio: 0.8873422510332528
Avg ndcg: 0.9532349218507845
Avg compression ratio: 0.5319461060324133
Avg train time: 5.546411371231079
Std train time: 1.59098977103301
[0.8617021276595745, 0.15957446808510642, 0.05319148936170214, 0.8617021276595745, 0.9680851063829787, 0.5212765957446808, 0.49999999999999994, 0.0957446808510638, 0.6702127659574468, 0.30851063829787234]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9302, 'compress@10': 0.9995, 'time@10': 5.1455}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9302, 'compress@10': 0.9995, 'time@10': 5.1455}:  10%|█         | 1/10 [00:02<00:23,  2.61s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.949, 'compress@10': 0.5163, 'time@10': 4.6813}:  10%|█         | 1/10 [00:06<00:23,  2.61s/it] {'epoch': 46, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.949, 'compress@10': 0.5163, 'time@10': 4.6813}:  20%|██        | 2/10 [00:06<00:28,  3.58s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9184, 'compress@10': 0.3918, 'time@10': 4.2435}:  20%|██        | 2/10 [00:08<00:28,  3.58s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9184, 'compress@10': 0.3918, 'time@10': 4.2435}:  30%|███       | 3/10 [00:08<00:19,  2.73s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9298, 'compress@10': 0.5438, 'time@10': 4.1184}:  30%|███       | 3/10 [00:12<00:19,  2.73s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9298, 'compress@10': 0.5438, 'time@10': 4.1184}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9357, 'compress@10': 0.635, 'time@10': 4.8942}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9357, 'compress@10': 0.635, 'time@10': 4.8942}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0071, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9426, 'compress@10': 0.617, 'time@10': 5.1183}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0071, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9426, 'compress@10': 0.617, 'time@10': 5.1183}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9445, 'compress@10': 0.5834, 'time@10': 5.3603}:  60%|██████    | 6/10 [00:26<00:17,  4.42s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9445, 'compress@10': 0.5834, 'time@10': 5.3603}:  70%|███████   | 7/10 [00:26<00:12,  4.10s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9414, 'compress@10': 0.5141, 'time@10': 5.2607}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9414, 'compress@10': 0.5141, 'time@10': 5.2607}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.944, 'compress@10': 0.5644, 'time@10': 5.5378}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.944, 'compress@10': 0.5644, 'time@10': 5.5378}:  90%|█████████ | 9/10 [00:34<00:04,  4.15s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0098, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9473, 'compress@10': 0.513, 'time@10': 5.5485}:  90%|█████████ | 9/10 [00:40<00:04,  4.15s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0098, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9473, 'compress@10': 0.513, 'time@10': 5.5485}: 100%|██████████| 10/10 [00:40<00:00,  4.63s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0098, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9473, 'compress@10': 0.513, 'time@10': 5.5485}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.009809592652626375
Avg hit ratio: 0.9007513652165604
Avg ndcg: 0.9472599231037602
Avg compression ratio: 0.5130106689334741
Avg train time: 5.548540139198304
Std train time: 1.5448667256464184
[0.8645833333333334, 0.15625000000000003, 0.05208333333333335, 0.8437500000000001, 0.96875, 0.5104166666666666, 0.5104166666666666, 0.1145833333333333, 0.6770833333333334, 0.3020833333333333]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9313, 'compress@10': 0.9996, 'time@10': 5.1198}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9313, 'compress@10': 0.9996, 'time@10': 5.1198}:  10%|█         | 1/10 [00:02<00:23,  2.60s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9634, 'compress@10': 0.5163, 'time@10': 4.689}:  10%|█         | 1/10 [00:06<00:23,  2.60s/it] {'epoch': 47, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9634, 'compress@10': 0.5163, 'time@10': 4.689}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.928, 'compress@10': 0.3919, 'time@10': 4.2438}:  20%|██        | 2/10 [00:08<00:28,  3.60s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.928, 'compress@10': 0.3919, 'time@10': 4.2438}:  30%|███       | 3/10 [00:08<00:19,  2.74s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9371, 'compress@10': 0.5438, 'time@10': 4.1318}:  30%|███       | 3/10 [00:12<00:19,  2.74s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9371, 'compress@10': 0.5438, 'time@10': 4.1318}:  40%|████      | 4/10 [00:12<00:19,  3.17s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9414, 'compress@10': 0.635, 'time@10': 4.9362}:  40%|████      | 4/10 [00:16<00:19,  3.17s/it] {'epoch': 47, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9414, 'compress@10': 0.635, 'time@10': 4.9362}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9467, 'compress@10': 0.6045, 'time@10': 5.1557}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9467, 'compress@10': 0.6045, 'time@10': 5.1557}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9486, 'compress@10': 0.5766, 'time@10': 5.4111}:  60%|██████    | 6/10 [00:26<00:17,  4.46s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9486, 'compress@10': 0.5766, 'time@10': 5.4111}:  70%|███████   | 7/10 [00:26<00:12,  4.15s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9514, 'compress@10': 0.5082, 'time@10': 5.303}:  70%|███████   | 7/10 [00:30<00:12,  4.15s/it]  {'epoch': 47, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9514, 'compress@10': 0.5082, 'time@10': 5.303}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0119, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9529, 'compress@10': 0.5587, 'time@10': 5.5821}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0119, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9529, 'compress@10': 0.5587, 'time@10': 5.5821}:  90%|█████████ | 9/10 [00:34<00:04,  4.18s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9555, 'compress@10': 0.5077, 'time@10': 5.5959}:  90%|█████████ | 9/10 [00:40<00:04,  4.18s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9555, 'compress@10': 0.5077, 'time@10': 5.5959}: 100%|██████████| 10/10 [00:40<00:00,  4.67s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9555, 'compress@10': 0.5077, 'time@10': 5.5959}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.01244363852025362
Avg hit ratio: 0.9018942223594175
Avg ndcg: 0.9554902287673228
Avg compression ratio: 0.5076824909913078
Avg train time: 5.595932960510254
Std train time: 1.58491413398088
[0.8469387755102041, 0.17346938775510207, 0.05102040816326532, 0.8469387755102042, 0.9489795918367347, 0.520408163265306, 0.49999999999999994, 0.11224489795918365, 0.6836734693877551, 0.31632653061224486]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.928, 'compress@10': 0.9994, 'time@10': 5.0142}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.928, 'compress@10': 0.9994, 'time@10': 5.0142}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9479, 'compress@10': 0.5167, 'time@10': 4.6187}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9479, 'compress@10': 0.5167, 'time@10': 4.6187}:  20%|██        | 2/10 [00:06<00:28,  3.55s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0041, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9176, 'compress@10': 0.3921, 'time@10': 4.2006}:  20%|██        | 2/10 [00:08<00:28,  3.55s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0041, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9176, 'compress@10': 0.3921, 'time@10': 4.2006}:  30%|███       | 3/10 [00:08<00:19,  2.72s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9293, 'compress@10': 0.544, 'time@10': 4.0703}:  30%|███       | 3/10 [00:12<00:19,  2.72s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9293, 'compress@10': 0.544, 'time@10': 4.0703}:  40%|████      | 4/10 [00:12<00:18,  3.11s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0063, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9359, 'compress@10': 0.6352, 'time@10': 4.8596}:  40%|████      | 4/10 [00:16<00:18,  3.11s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0063, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9359, 'compress@10': 0.6352, 'time@10': 4.8596}:  50%|█████     | 5/10 [00:16<00:17,  3.45s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0069, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9426, 'compress@10': 0.6192, 'time@10': 5.0648}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0069, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9426, 'compress@10': 0.6192, 'time@10': 5.0648}:  60%|██████    | 6/10 [00:22<00:17,  4.36s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0066, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9452, 'compress@10': 0.5841, 'time@10': 5.3091}:  60%|██████    | 6/10 [00:25<00:17,  4.36s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0066, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9452, 'compress@10': 0.5841, 'time@10': 5.3091}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9547, 'compress@10': 0.5147, 'time@10': 5.2167}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9547, 'compress@10': 0.5147, 'time@10': 5.2167}:  80%|████████  | 8/10 [00:30<00:08,  4.23s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0107, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.956, 'compress@10': 0.5657, 'time@10': 5.5667}:  80%|████████  | 8/10 [00:34<00:08,  4.23s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0107, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.956, 'compress@10': 0.5657, 'time@10': 5.5667}:  90%|█████████ | 9/10 [00:34<00:04,  4.23s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9579, 'compress@10': 0.5142, 'time@10': 5.5953}:  90%|█████████ | 9/10 [00:40<00:04,  4.23s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9579, 'compress@10': 0.5142, 'time@10': 5.5953}: 100%|██████████| 10/10 [00:40<00:00,  4.74s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9579, 'compress@10': 0.5142, 'time@10': 5.5953}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.01081725902532016
Avg hit ratio: 0.8920529525181478
Avg ndcg: 0.957916520389591
Avg compression ratio: 0.514151265035862
Avg train time: 5.595274567604065
Std train time: 1.6481071459881291
[0.8300000000000001, 0.17, 0.05000000000000002, 0.8300000000000002, 0.9500000000000001, 0.5299999999999999, 0.48999999999999994, 0.12999999999999998, 0.69, 0.32999999999999996]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9359, 'compress@10': 0.9991, 'time@10': 5.0645}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9359, 'compress@10': 0.9991, 'time@10': 5.0645}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9561, 'compress@10': 0.5164, 'time@10': 4.6947}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it] {'epoch': 49, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9561, 'compress@10': 0.5164, 'time@10': 4.6947}:  20%|██        | 2/10 [00:06<00:29,  3.63s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9231, 'compress@10': 0.3919, 'time@10': 4.2368}:  20%|██        | 2/10 [00:08<00:29,  3.63s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9231, 'compress@10': 0.3919, 'time@10': 4.2368}:  30%|███       | 3/10 [00:08<00:19,  2.75s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9334, 'compress@10': 0.5438, 'time@10': 4.1505}:  30%|███       | 3/10 [00:12<00:19,  2.75s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9334, 'compress@10': 0.5438, 'time@10': 4.1505}:  40%|████      | 4/10 [00:12<00:19,  3.21s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.9409, 'compress@10': 0.635, 'time@10': 4.9376}:  40%|████      | 4/10 [00:16<00:19,  3.21s/it]  {'epoch': 49, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.9409, 'compress@10': 0.635, 'time@10': 4.9376}:  50%|█████     | 5/10 [00:16<00:17,  3.53s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.947, 'compress@10': 0.6467, 'time@10': 5.0623}:  50%|█████     | 5/10 [00:22<00:17,  3.53s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.947, 'compress@10': 0.6467, 'time@10': 5.0623}:  60%|██████    | 6/10 [00:22<00:17,  4.27s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9485, 'compress@10': 0.6041, 'time@10': 5.1961}:  60%|██████    | 6/10 [00:25<00:17,  4.27s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9485, 'compress@10': 0.6041, 'time@10': 5.1961}:  70%|███████   | 7/10 [00:25<00:11,  3.87s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9483, 'compress@10': 0.5323, 'time@10': 5.0511}:  70%|███████   | 7/10 [00:29<00:11,  3.87s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9483, 'compress@10': 0.5323, 'time@10': 5.0511}:  80%|████████  | 8/10 [00:29<00:07,  3.93s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.9506, 'compress@10': 0.5811, 'time@10': 5.2213}:  80%|████████  | 8/10 [00:32<00:07,  3.93s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.9506, 'compress@10': 0.5811, 'time@10': 5.2213}:  90%|█████████ | 9/10 [00:32<00:03,  3.76s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9532, 'compress@10': 0.5288, 'time@10': 5.131}:  90%|█████████ | 9/10 [00:37<00:03,  3.76s/it]    {'epoch': 49, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9532, 'compress@10': 0.5288, 'time@10': 5.131}: 100%|██████████| 10/10 [00:37<00:00,  3.94s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9532, 'compress@10': 0.5288, 'time@10': 5.131}: 100%|██████████| 10/10 [00:37<00:00,  3.72s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.011195471116625588
Avg hit ratio: 0.8668112730506617
Avg ndcg: 0.953170270999251
Avg compression ratio: 0.5287974650377099
Avg train time: 5.130997610092163
Std train time: 1.3865501918066916
[0.8333333333333334, 0.18627450980392157, 0.04901960784313727, 0.8137254901960786, 0.9313725490196079, 0.5196078431372548, 0.49999999999999994, 0.14705882352941174, 0.696078431372549, 0.32352941176470584]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
