  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.568, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.1891, 'compress@10': 0.5263, 'time@10': 9.8407}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.568, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.1891, 'compress@10': 0.5263, 'time@10': 9.8407}:  10%|█         | 1/10 [00:04<00:44,  4.96s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.3474, 'hit_ratio@10': 0.4745, 'ndcg@10': 0.3778, 'compress@10': 0.5212, 'time@10': 8.5156}:  10%|█         | 1/10 [00:12<00:44,  4.96s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.3474, 'hit_ratio@10': 0.4745, 'ndcg@10': 0.3778, 'compress@10': 0.5212, 'time@10': 8.5156}:  20%|██        | 2/10 [00:12<00:50,  6.30s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 1.1068, 'hit_ratio@10': 0.3164, 'ndcg@10': 0.2519, 'compress@10': 0.538, 'time@10': 6.6996}:  20%|██        | 2/10 [00:13<00:50,  6.30s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 1.1068, 'hit_ratio@10': 0.3164, 'ndcg@10': 0.2519, 'compress@10': 0.538, 'time@10': 6.6996}:  30%|███       | 3/10 [00:13<00:29,  4.15s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8797, 'hit_ratio@10': 0.3623, 'ndcg@10': 0.3131, 'compress@10': 0.5329, 'time@10': 6.641}:  30%|███       | 3/10 [00:20<00:29,  4.15s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8797, 'hit_ratio@10': 0.3623, 'ndcg@10': 0.3131, 'compress@10': 0.5329, 'time@10': 6.641}:  40%|████      | 4/10 [00:20<00:30,  5.08s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.7249, 'hit_ratio@10': 0.4658, 'ndcg@10': 0.3878, 'compress@10': 0.5283, 'time@10': 10.0999}:  40%|████      | 4/10 [00:32<00:30,  5.08s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.7249, 'hit_ratio@10': 0.4658, 'ndcg@10': 0.3878, 'compress@10': 0.5283, 'time@10': 10.0999}:  50%|█████     | 5/10 [00:32<00:37,  7.58s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.6207, 'hit_ratio@10': 0.503, 'ndcg@10': 0.4426, 'compress@10': 0.5255, 'time@10': 10.2107}:  50%|█████     | 5/10 [00:43<00:37,  7.58s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.6207, 'hit_ratio@10': 0.503, 'ndcg@10': 0.4426, 'compress@10': 0.5255, 'time@10': 10.2107}:  60%|██████    | 6/10 [00:43<00:34,  8.67s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.5577, 'hit_ratio@10': 0.5111, 'ndcg@10': 0.4531, 'compress@10': 0.5247, 'time@10': 10.3791}:  60%|██████    | 6/10 [00:48<00:34,  8.67s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.5577, 'hit_ratio@10': 0.5111, 'ndcg@10': 0.4531, 'compress@10': 0.5247, 'time@10': 10.3791}:  70%|███████   | 7/10 [00:48<00:23,  7.71s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.5017, 'hit_ratio@10': 0.5615, 'ndcg@10': 0.4632, 'compress@10': 0.5234, 'time@10': 10.0854}:  70%|███████   | 7/10 [00:56<00:23,  7.71s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.5017, 'hit_ratio@10': 0.5615, 'ndcg@10': 0.4632, 'compress@10': 0.5234, 'time@10': 10.0854}:  80%|████████  | 8/10 [00:56<00:15,  7.82s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.4578, 'hit_ratio@10': 0.588, 'ndcg@10': 0.4988, 'compress@10': 0.5224, 'time@10': 10.8442}:  80%|████████  | 8/10 [01:05<00:15,  7.82s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.4578, 'hit_ratio@10': 0.588, 'ndcg@10': 0.4988, 'compress@10': 0.5224, 'time@10': 10.8442}:  90%|█████████ | 9/10 [01:05<00:08,  8.03s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.4199, 'hit_ratio@10': 0.6156, 'ndcg@10': 0.5164, 'compress@10': 0.5213, 'time@10': 10.8072}:  90%|█████████ | 9/10 [01:15<00:08,  8.03s/it]  {'epoch': 0, 'num_users': 6.3, 'loss': 0.4199, 'hit_ratio@10': 0.6156, 'ndcg@10': 0.5164, 'compress@10': 0.5213, 'time@10': 10.8072}: 100%|██████████| 10/10 [01:15<00:00,  8.80s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.4199, 'hit_ratio@10': 0.6156, 'ndcg@10': 0.5164, 'compress@10': 0.5213, 'time@10': 10.8072}: 100%|██████████| 10/10 [01:15<00:00,  7.59s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.41993993170130245
Avg hit ratio: 0.6155877180732868
Avg ndcg: 0.5164111490223522
Avg compression ratio: 0.5212749006657823
Avg train time: 10.807222366333008
Std train time: 5.573209868799219
[0.75, 0.75, 0.75, 0.75, 0.25, 0.25, 0.75, 0.25, 0.25, 0.25]
[10, 12, 14, 12, 4, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0687, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.7351, 'compress@10': 0.7632, 'time@10': 8.6272}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0687, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.7351, 'compress@10': 0.7632, 'time@10': 8.6272}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0612, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.7962, 'compress@10': 0.7606, 'time@10': 8.5882}:  10%|█         | 1/10 [00:12<00:39,  4.35s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0612, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.7962, 'compress@10': 0.7606, 'time@10': 8.5882}:  20%|██        | 2/10 [00:12<00:54,  6.84s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0541, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.7665, 'compress@10': 0.769, 'time@10': 7.0767}:  20%|██        | 2/10 [00:14<00:54,  6.84s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.0541, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.7665, 'compress@10': 0.769, 'time@10': 7.0767}:  30%|███       | 3/10 [00:14<00:32,  4.66s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0532, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.786, 'compress@10': 0.7665, 'time@10': 7.2331}:  30%|███       | 3/10 [00:22<00:32,  4.66s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0532, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.786, 'compress@10': 0.7665, 'time@10': 7.2331}:  40%|████      | 4/10 [00:22<00:35,  5.87s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0683, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.7538, 'compress@10': 0.6662, 'time@10': 7.7129}:  40%|████      | 4/10 [00:27<00:35,  5.87s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0683, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.7538, 'compress@10': 0.6662, 'time@10': 7.7129}:  50%|█████     | 5/10 [00:27<00:27,  5.51s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0701, 'hit_ratio@10': 0.7745, 'ndcg@10': 0.7641, 'compress@10': 0.5996, 'time@10': 8.1691}:  50%|█████     | 5/10 [00:38<00:27,  5.51s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0701, 'hit_ratio@10': 0.7745, 'ndcg@10': 0.7641, 'compress@10': 0.5996, 'time@10': 8.1691}:  60%|██████    | 6/10 [00:38<00:28,  7.20s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0676, 'hit_ratio@10': 0.801, 'ndcg@10': 0.7714, 'compress@10': 0.6225, 'time@10': 8.593}:  60%|██████    | 6/10 [00:43<00:28,  7.20s/it]  {'epoch': 1, 'num_users': 6.2857, 'loss': 0.0676, 'hit_ratio@10': 0.801, 'ndcg@10': 0.7714, 'compress@10': 0.6225, 'time@10': 8.593}:  70%|███████   | 7/10 [00:43<00:20,  6.68s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0639, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.7849, 'compress@10': 0.5786, 'time@10': 8.6098}:  70%|███████   | 7/10 [00:52<00:20,  6.68s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0639, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.7849, 'compress@10': 0.5786, 'time@10': 8.6098}:  80%|████████  | 8/10 [00:52<00:14,  7.34s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0622, 'hit_ratio@10': 0.804, 'ndcg@10': 0.7996, 'compress@10': 0.5445, 'time@10': 8.9022}:  80%|████████  | 8/10 [00:58<00:14,  7.34s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0622, 'hit_ratio@10': 0.804, 'ndcg@10': 0.7996, 'compress@10': 0.5445, 'time@10': 8.9022}:  90%|█████████ | 9/10 [00:58<00:06,  6.81s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0607, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8044, 'compress@10': 0.5167, 'time@10': 9.056}:  90%|█████████ | 9/10 [01:08<00:06,  6.81s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0607, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8044, 'compress@10': 0.5167, 'time@10': 9.056}: 100%|██████████| 10/10 [01:08<00:00,  7.95s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0607, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8044, 'compress@10': 0.5167, 'time@10': 9.056}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.06068231075313396
Avg hit ratio: 0.8167457010071612
Avg ndcg: 0.804403095566963
Avg compression ratio: 0.5167406549871376
Avg train time: 9.055999207496644
Std train time: 2.017461481090389
[0.8333333333333334, 0.8333333333333334, 0.5, 0.5, 0.5, 0.5, 0.8333333333333334, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[11, 13, 17, 13, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.8421, 'time@10': 9.8613}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.8421, 'time@10': 9.8613}:  10%|█         | 1/10 [00:04<00:44,  4.97s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8497, 'compress@10': 0.8404, 'time@10': 9.472}:  10%|█         | 1/10 [00:14<00:44,  4.97s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8497, 'compress@10': 0.8404, 'time@10': 9.472}:  20%|██        | 2/10 [00:14<00:59,  7.42s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8522, 'compress@10': 0.7507, 'time@10': 7.8797}:  20%|██        | 2/10 [00:16<00:59,  7.42s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8522, 'compress@10': 0.7507, 'time@10': 7.8797}:  30%|███       | 3/10 [00:16<00:35,  5.12s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.038, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8504, 'compress@10': 0.6925, 'time@10': 7.9968}:  30%|███       | 3/10 [00:24<00:35,  5.12s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.038, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8504, 'compress@10': 0.6925, 'time@10': 7.9968}:  40%|████      | 4/10 [00:24<00:38,  6.41s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0503, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8266, 'compress@10': 0.656, 'time@10': 8.8146}:  40%|████      | 4/10 [00:30<00:38,  6.41s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0503, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8266, 'compress@10': 0.656, 'time@10': 8.8146}:  50%|█████     | 5/10 [00:30<00:31,  6.29s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0544, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8243, 'compress@10': 0.6319, 'time@10': 9.1149}:  50%|█████     | 5/10 [00:41<00:31,  6.29s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0544, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8243, 'compress@10': 0.6319, 'time@10': 9.1149}:  60%|██████    | 6/10 [00:41<00:31,  7.77s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0527, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8292, 'compress@10': 0.6616, 'time@10': 9.4517}:  60%|██████    | 6/10 [00:47<00:31,  7.77s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0527, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8292, 'compress@10': 0.6616, 'time@10': 9.4517}:  70%|███████   | 7/10 [00:47<00:21,  7.12s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8314, 'compress@10': 0.6027, 'time@10': 9.4334}:  70%|███████   | 7/10 [00:56<00:21,  7.12s/it]  {'epoch': 2, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8314, 'compress@10': 0.6027, 'time@10': 9.4334}:  80%|████████  | 8/10 [00:56<00:15,  7.83s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8412, 'compress@10': 0.5569, 'time@10': 9.6563}:  80%|████████  | 8/10 [01:02<00:15,  7.83s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8412, 'compress@10': 0.5569, 'time@10': 9.6563}:  90%|█████████ | 9/10 [01:02<00:07,  7.18s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.842, 'compress@10': 0.5198, 'time@10': 9.6929}:  90%|█████████ | 9/10 [01:12<00:07,  7.18s/it]    {'epoch': 2, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.842, 'compress@10': 0.5198, 'time@10': 9.6929}: 100%|██████████| 10/10 [01:12<00:00,  8.07s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.842, 'compress@10': 0.5198, 'time@10': 9.6929}: 100%|██████████| 10/10 [01:12<00:00,  7.25s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04874040799027164
Avg hit ratio: 0.8382065035511556
Avg ndcg: 0.8420194639726966
Avg compression ratio: 0.519774424236352
Avg train time: 9.69292447566986
Std train time: 2.006074640112894
[0.875, 0.875, 0.375, 0.625, 0.625, 0.625, 0.625, 0.125, 0.125, 0.125]
[11, 14, 20, 14, 4, 10, 10, 13, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.8816, 'time@10': 9.9948}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.8816, 'time@10': 9.9948}:  10%|█         | 1/10 [00:05<00:45,  5.03s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8462, 'compress@10': 0.8803, 'time@10': 9.6775}:  10%|█         | 1/10 [00:14<00:45,  5.03s/it] {'epoch': 3, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8462, 'compress@10': 0.8803, 'time@10': 9.6775}:  20%|██        | 2/10 [00:14<01:00,  7.60s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8499, 'compress@10': 0.7416, 'time@10': 8.3361}:  20%|██        | 2/10 [00:17<01:00,  7.60s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8499, 'compress@10': 0.7416, 'time@10': 8.3361}:  30%|███       | 3/10 [00:17<00:38,  5.44s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0355, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8499, 'compress@10': 0.7158, 'time@10': 8.5612}:  30%|███       | 3/10 [00:26<00:38,  5.44s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0355, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8499, 'compress@10': 0.7158, 'time@10': 8.5612}:  40%|████      | 4/10 [00:26<00:41,  6.95s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0487, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.825, 'compress@10': 0.6992, 'time@10': 8.7661}:  40%|████      | 4/10 [00:31<00:41,  6.95s/it] {'epoch': 3, 'num_users': 5.8, 'loss': 0.0487, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.825, 'compress@10': 0.6992, 'time@10': 8.7661}:  50%|█████     | 5/10 [00:31<00:30,  6.19s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0527, 'hit_ratio@10': 0.7817, 'ndcg@10': 0.8243, 'compress@10': 0.6882, 'time@10': 9.0841}:  50%|█████     | 5/10 [00:42<00:30,  6.19s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0527, 'hit_ratio@10': 0.7817, 'ndcg@10': 0.8243, 'compress@10': 0.6882, 'time@10': 9.0841}:  60%|██████    | 6/10 [00:42<00:30,  7.72s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0511, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8283, 'compress@10': 0.6813, 'time@10': 9.4337}:  60%|██████    | 6/10 [00:47<00:30,  7.72s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0511, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8283, 'compress@10': 0.6813, 'time@10': 9.4337}:  70%|███████   | 7/10 [00:47<00:21,  7.10s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8295, 'compress@10': 0.6149, 'time@10': 9.5077}:  70%|███████   | 7/10 [00:57<00:21,  7.10s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8295, 'compress@10': 0.6149, 'time@10': 9.5077}:  80%|████████  | 8/10 [00:57<00:16,  8.04s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0489, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.839, 'compress@10': 0.5632, 'time@10': 9.6827}:  80%|████████  | 8/10 [01:03<00:16,  8.04s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0489, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.839, 'compress@10': 0.5632, 'time@10': 9.6827}:  90%|█████████ | 9/10 [01:03<00:07,  7.27s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0482, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8402, 'compress@10': 0.5214, 'time@10': 9.6698}:  90%|█████████ | 9/10 [01:13<00:07,  7.27s/it]  {'epoch': 3, 'num_users': 6.3, 'loss': 0.0482, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8402, 'compress@10': 0.5214, 'time@10': 9.6698}: 100%|██████████| 10/10 [01:13<00:00,  7.99s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0482, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8402, 'compress@10': 0.5214, 'time@10': 9.6698}: 100%|██████████| 10/10 [01:13<00:00,  7.31s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.048237160843971706
Avg hit ratio: 0.8210636464082984
Avg ndcg: 0.8402211452919521
Avg compression ratio: 0.5213981746919709
Avg train time: 9.669772219657897
Std train time: 1.5211128542692411
[0.9, 0.9, 0.3, 0.5, 0.7, 0.7, 0.5, 0.3, 0.1, 0.1]
[11, 15, 22, 15, 5, 10, 10, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8508, 'compress@10': 0.9052, 'time@10': 8.8597}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8508, 'compress@10': 0.9052, 'time@10': 8.8597}:  10%|█         | 1/10 [00:04<00:40,  4.46s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.86, 'compress@10': 0.9042, 'time@10': 9.1934}:  10%|█         | 1/10 [00:14<00:40,  4.46s/it]  {'epoch': 4, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.86, 'compress@10': 0.9042, 'time@10': 9.1934}:  20%|██        | 2/10 [00:14<00:59,  7.46s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.744, 'ndcg@10': 0.859, 'compress@10': 0.7362, 'time@10': 8.2247}:  20%|██        | 2/10 [00:17<00:59,  7.46s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.744, 'ndcg@10': 0.859, 'compress@10': 0.7362, 'time@10': 8.2247}:  30%|███       | 3/10 [00:17<00:38,  5.51s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.7901, 'ndcg@10': 0.8571, 'compress@10': 0.6816, 'time@10': 8.6819}:  30%|███       | 3/10 [00:27<00:38,  5.51s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.7901, 'ndcg@10': 0.8571, 'compress@10': 0.6816, 'time@10': 8.6819}:  40%|████      | 4/10 [00:27<00:43,  7.32s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8372, 'compress@10': 0.6865, 'time@10': 9.3432}:  40%|████      | 4/10 [00:33<00:43,  7.32s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8372, 'compress@10': 0.6865, 'time@10': 9.3432}:  50%|█████     | 5/10 [00:33<00:34,  6.85s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0509, 'hit_ratio@10': 0.793, 'ndcg@10': 0.8349, 'compress@10': 0.6898, 'time@10': 9.5625}:  50%|█████     | 5/10 [00:44<00:34,  6.85s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0509, 'hit_ratio@10': 0.793, 'ndcg@10': 0.8349, 'compress@10': 0.6898, 'time@10': 9.5625}:  60%|██████    | 6/10 [00:44<00:32,  8.16s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0499, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8356, 'compress@10': 0.6656, 'time@10': 9.9005}:  60%|██████    | 6/10 [00:50<00:32,  8.16s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0499, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8356, 'compress@10': 0.6656, 'time@10': 9.9005}:  70%|███████   | 7/10 [00:50<00:22,  7.45s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0495, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8348, 'compress@10': 0.6224, 'time@10': 9.9723}:  70%|███████   | 7/10 [01:00<00:22,  7.45s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0495, 'hit_ratio@10': 0.8326, 'ndcg@10': 0.8348, 'compress@10': 0.6224, 'time@10': 9.9723}:  80%|████████  | 8/10 [01:00<00:16,  8.43s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.048, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8434, 'compress@10': 0.5672, 'time@10': 10.0613}:  80%|████████  | 8/10 [01:05<00:16,  8.43s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.048, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8434, 'compress@10': 0.5672, 'time@10': 10.0613}:  90%|█████████ | 9/10 [01:05<00:07,  7.49s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8454, 'compress@10': 0.5225, 'time@10': 10.1506}:  90%|█████████ | 9/10 [01:16<00:07,  7.49s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8454, 'compress@10': 0.5225, 'time@10': 10.1506}: 100%|██████████| 10/10 [01:16<00:00,  8.57s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8454, 'compress@10': 0.5225, 'time@10': 10.1506}: 100%|██████████| 10/10 [01:16<00:00,  7.70s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.047486939586114454
Avg hit ratio: 0.8307180242884827
Avg ndcg: 0.8454487366506365
Avg compression ratio: 0.5225153976883978
Avg train time: 10.15057806968689
Std train time: 1.5788266797690649
[0.9166666666666667, 0.75, 0.25, 0.5833333333333334, 0.75, 0.75, 0.4166666666666667, 0.41666666666666663, 0.08333333333333334, 0.08333333333333334]
[12, 16, 24, 15, 4, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8543, 'compress@10': 0.921, 'time@10': 8.9036}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8543, 'compress@10': 0.921, 'time@10': 8.9036}:  10%|█         | 1/10 [00:04<00:40,  4.49s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8793, 'compress@10': 0.8395, 'time@10': 10.2771}:  10%|█         | 1/10 [00:16<00:40,  4.49s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8793, 'compress@10': 0.8395, 'time@10': 10.2771}:  20%|██        | 2/10 [00:16<01:09,  8.72s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8719, 'compress@10': 0.6787, 'time@10': 9.1563}:  20%|██        | 2/10 [00:19<01:09,  8.72s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8719, 'compress@10': 0.6787, 'time@10': 9.1563}:  30%|███       | 3/10 [00:19<00:44,  6.34s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0399, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8946, 'compress@10': 0.6586, 'time@10': 9.3428}:  30%|███       | 3/10 [00:29<00:44,  6.34s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0399, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8946, 'compress@10': 0.6586, 'time@10': 9.3428}:  40%|████      | 4/10 [00:29<00:46,  7.76s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0513, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8639, 'compress@10': 0.6779, 'time@10': 9.3685}:  40%|████      | 4/10 [00:34<00:46,  7.76s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0513, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8639, 'compress@10': 0.6779, 'time@10': 9.3685}:  50%|█████     | 5/10 [00:34<00:33,  6.68s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0535, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8578, 'compress@10': 0.6908, 'time@10': 9.5619}:  50%|█████     | 5/10 [00:44<00:33,  6.68s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0535, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8578, 'compress@10': 0.6908, 'time@10': 9.5619}:  60%|██████    | 6/10 [00:44<00:32,  8.00s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0522, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8586, 'compress@10': 0.655, 'time@10': 9.6645}:  60%|██████    | 6/10 [00:50<00:32,  8.00s/it] {'epoch': 5, 'num_users': 6.2857, 'loss': 0.0522, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8586, 'compress@10': 0.655, 'time@10': 9.6645}:  70%|███████   | 7/10 [00:50<00:21,  7.08s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8591, 'compress@10': 0.6273, 'time@10': 9.7966}:  70%|███████   | 7/10 [01:00<00:21,  7.08s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8591, 'compress@10': 0.6273, 'time@10': 9.7966}:  80%|████████  | 8/10 [01:00<00:16,  8.25s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8667, 'compress@10': 0.5698, 'time@10': 9.8999}:  80%|████████  | 8/10 [01:06<00:16,  8.25s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8667, 'compress@10': 0.5698, 'time@10': 9.8999}:  90%|█████████ | 9/10 [01:06<00:07,  7.36s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0492, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8667, 'compress@10': 0.5232, 'time@10': 9.9651}:  90%|█████████ | 9/10 [01:16<00:07,  7.36s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0492, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8667, 'compress@10': 0.5232, 'time@10': 9.9651}: 100%|██████████| 10/10 [01:16<00:00,  8.36s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0492, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8667, 'compress@10': 0.5232, 'time@10': 9.9651}: 100%|██████████| 10/10 [01:16<00:00,  7.69s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.0491690002841985
Avg hit ratio: 0.8555744689191208
Avg ndcg: 0.86669578937426
Avg compression ratio: 0.5232037263031293
Avg train time: 9.965080285072327
Std train time: 1.2423116532111043
[0.7857142857142858, 0.7857142857142857, 0.2142857142857143, 0.6428571428571429, 0.7857142857142857, 0.7857142857142857, 0.35714285714285715, 0.5, 0.07142857142857144, 0.07142857142857144]
[13, 16, 26, 15, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8555, 'compress@10': 0.797, 'time@10': 10.9987}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8555, 'compress@10': 0.797, 'time@10': 10.9987}:  10%|█         | 1/10 [00:05<00:49,  5.54s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0553, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8751, 'compress@10': 0.7948, 'time@10': 11.2427}:  10%|█         | 1/10 [00:17<00:49,  5.54s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0553, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8751, 'compress@10': 0.7948, 'time@10': 11.2427}:  20%|██        | 2/10 [00:17<01:12,  9.06s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8691, 'compress@10': 0.6387, 'time@10': 9.9405}:  20%|██        | 2/10 [00:20<01:12,  9.06s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8691, 'compress@10': 0.6387, 'time@10': 9.9405}:  30%|███       | 3/10 [00:20<00:46,  6.61s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0365, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.871, 'compress@10': 0.6429, 'time@10': 9.903}:  30%|███       | 3/10 [00:30<00:46,  6.61s/it]  {'epoch': 6, 'num_users': 5.0, 'loss': 0.0365, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.871, 'compress@10': 0.6429, 'time@10': 9.903}:  40%|████      | 4/10 [00:30<00:47,  7.88s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8501, 'compress@10': 0.6723, 'time@10': 10.269}:  40%|████      | 4/10 [00:36<00:47,  7.88s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8501, 'compress@10': 0.6723, 'time@10': 10.269}:  50%|█████     | 5/10 [00:36<00:35,  7.17s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0498, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.848, 'compress@10': 0.692, 'time@10': 10.2611}:  50%|█████     | 5/10 [00:46<00:35,  7.17s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0498, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.848, 'compress@10': 0.692, 'time@10': 10.2611}:  60%|██████    | 6/10 [00:46<00:32,  8.22s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8493, 'compress@10': 0.6479, 'time@10': 10.3385}:  60%|██████    | 6/10 [00:52<00:32,  8.22s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8493, 'compress@10': 0.6479, 'time@10': 10.3385}:  70%|███████   | 7/10 [00:52<00:21,  7.31s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0488, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8389, 'compress@10': 0.6312, 'time@10': 10.3619}:  70%|███████   | 7/10 [01:02<00:21,  7.31s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0488, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8389, 'compress@10': 0.6312, 'time@10': 10.3619}:  80%|████████  | 8/10 [01:02<00:16,  8.35s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0473, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8485, 'compress@10': 0.5719, 'time@10': 10.401}:  80%|████████  | 8/10 [01:08<00:16,  8.35s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0473, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8485, 'compress@10': 0.5719, 'time@10': 10.401}:  90%|█████████ | 9/10 [01:08<00:07,  7.42s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0463, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8511, 'compress@10': 0.524, 'time@10': 10.4243}:  90%|█████████ | 9/10 [01:18<00:07,  7.42s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0463, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8511, 'compress@10': 0.524, 'time@10': 10.4243}: 100%|██████████| 10/10 [01:18<00:00,  8.43s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0463, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8511, 'compress@10': 0.524, 'time@10': 10.4243}: 100%|██████████| 10/10 [01:18<00:00,  7.88s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.046347668592108246
Avg hit ratio: 0.8493522466968987
Avg ndcg: 0.8511157887064943
Avg compression ratio: 0.5239855991529315
Avg train time: 10.42425994873047
Std train time: 1.1589908835960758
[0.8125000000000001, 0.8125, 0.1875, 0.5625, 0.8125, 0.8125, 0.3125, 0.5625, 0.06250000000000001, 0.06250000000000001]
[13, 16, 28, 15, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0446, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8591, 'compress@10': 0.8224, 'time@10': 11.0958}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0446, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8591, 'compress@10': 0.8224, 'time@10': 11.0958}:  10%|█         | 1/10 [00:05<00:50,  5.59s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0434, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8634, 'compress@10': 0.8205, 'time@10': 11.2189}:  10%|█         | 1/10 [00:16<00:50,  5.59s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0434, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8634, 'compress@10': 0.8205, 'time@10': 11.2189}:  20%|██        | 2/10 [00:16<01:11,  8.99s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0289, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8613, 'compress@10': 0.6482, 'time@10': 10.0799}:  20%|██        | 2/10 [00:20<01:11,  8.99s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0289, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8613, 'compress@10': 0.6482, 'time@10': 10.0799}:  30%|███       | 3/10 [00:20<00:46,  6.69s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8919, 'compress@10': 0.6307, 'time@10': 10.016}:  30%|███       | 3/10 [00:30<00:46,  6.69s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8919, 'compress@10': 0.6307, 'time@10': 10.016}:  40%|████      | 4/10 [00:30<00:47,  7.94s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8677, 'compress@10': 0.6678, 'time@10': 10.3989}:  40%|████      | 4/10 [00:36<00:47,  7.94s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8677, 'compress@10': 0.6678, 'time@10': 10.3989}:  50%|█████     | 5/10 [00:36<00:36,  7.24s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0482, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8631, 'compress@10': 0.6926, 'time@10': 10.3364}:  50%|█████     | 5/10 [00:46<00:36,  7.24s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0482, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8631, 'compress@10': 0.6926, 'time@10': 10.3364}:  60%|██████    | 6/10 [00:46<00:32,  8.20s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0473, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.865, 'compress@10': 0.6422, 'time@10': 10.3788}:  60%|██████    | 6/10 [00:52<00:32,  8.20s/it] {'epoch': 7, 'num_users': 6.2857, 'loss': 0.0473, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.865, 'compress@10': 0.6422, 'time@10': 10.3788}:  70%|███████   | 7/10 [00:52<00:21,  7.27s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0448, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.867, 'compress@10': 0.6338, 'time@10': 10.4369}:  70%|███████   | 7/10 [01:03<00:21,  7.27s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0448, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.867, 'compress@10': 0.6338, 'time@10': 10.4369}:  80%|████████  | 8/10 [01:03<00:16,  8.42s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0439, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8739, 'compress@10': 0.5733, 'time@10': 10.4604}:  80%|████████  | 8/10 [01:08<00:16,  8.42s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0439, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8739, 'compress@10': 0.5733, 'time@10': 10.4604}:  90%|█████████ | 9/10 [01:08<00:07,  7.46s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.8749, 'compress@10': 0.5244, 'time@10': 10.4893}:  90%|█████████ | 9/10 [01:19<00:07,  7.46s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.8749, 'compress@10': 0.5244, 'time@10': 10.4893}: 100%|██████████| 10/10 [01:19<00:00,  8.49s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.8749, 'compress@10': 0.5244, 'time@10': 10.4893}: 100%|██████████| 10/10 [01:19<00:00,  7.92s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04266229170562828
Avg hit ratio: 0.8612288467993052
Avg ndcg: 0.8749414694832571
Avg compression ratio: 0.5243594491448843
Avg train time: 10.48926682472229
Std train time: 1.0626624100881659
[0.8333333333333335, 0.8333333333333334, 0.16666666666666666, 0.6111111111111112, 0.8333333333333334, 0.8333333333333334, 0.2777777777777778, 0.5, 0.055555555555555566, 0.055555555555555566]
[13, 16, 29, 15, 4, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0443, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.8421, 'time@10': 11.1146}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0443, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.8421, 'time@10': 11.1146}:  10%|█         | 1/10 [00:05<00:50,  5.59s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8718, 'compress@10': 0.8404, 'time@10': 11.2252}:  10%|█         | 1/10 [00:16<00:50,  5.59s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8718, 'compress@10': 0.8404, 'time@10': 11.2252}:  20%|██        | 2/10 [00:16<01:11,  8.99s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8669, 'compress@10': 0.6555, 'time@10': 10.0379}:  20%|██        | 2/10 [00:20<01:11,  8.99s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8669, 'compress@10': 0.6555, 'time@10': 10.0379}:  30%|███       | 3/10 [00:20<00:46,  6.65s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8745, 'compress@10': 0.6479, 'time@10': 10.012}:  30%|███       | 3/10 [00:30<00:46,  6.65s/it]  {'epoch': 8, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8745, 'compress@10': 0.6479, 'time@10': 10.012}:  40%|████      | 4/10 [00:30<00:47,  7.96s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.85, 'compress@10': 0.6856, 'time@10': 9.9587}:  40%|████      | 4/10 [00:35<00:47,  7.96s/it] {'epoch': 8, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.85, 'compress@10': 0.6856, 'time@10': 9.9587}:  50%|█████     | 5/10 [00:35<00:34,  6.86s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0434, 'hit_ratio@10': 0.7988, 'ndcg@10': 0.8497, 'compress@10': 0.7109, 'time@10': 9.9669}:  50%|█████     | 5/10 [00:45<00:34,  6.86s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0434, 'hit_ratio@10': 0.7988, 'ndcg@10': 0.8497, 'compress@10': 0.7109, 'time@10': 9.9669}:  60%|██████    | 6/10 [00:45<00:31,  7.94s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0427, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8511, 'compress@10': 0.6531, 'time@10': 10.0216}:  60%|██████    | 6/10 [00:50<00:31,  7.94s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0427, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8511, 'compress@10': 0.6531, 'time@10': 10.0216}:  70%|███████   | 7/10 [00:50<00:21,  7.05s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0432, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8484, 'compress@10': 0.6358, 'time@10': 10.1283}:  70%|███████   | 7/10 [01:01<00:21,  7.05s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0432, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8484, 'compress@10': 0.6358, 'time@10': 10.1283}:  80%|████████  | 8/10 [01:01<00:16,  8.28s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0424, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8576, 'compress@10': 0.5743, 'time@10': 10.1799}:  80%|████████  | 8/10 [01:07<00:16,  8.28s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0424, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8576, 'compress@10': 0.5743, 'time@10': 10.1799}:  90%|█████████ | 9/10 [01:07<00:07,  7.36s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0414, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8608, 'compress@10': 0.5246, 'time@10': 10.1989}:  90%|█████████ | 9/10 [01:17<00:07,  7.36s/it]    {'epoch': 8, 'num_users': 6.3, 'loss': 0.0414, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8608, 'compress@10': 0.5246, 'time@10': 10.1989}: 100%|██████████| 10/10 [01:17<00:00,  8.30s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0414, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8608, 'compress@10': 0.5246, 'time@10': 10.1989}: 100%|██████████| 10/10 [01:17<00:00,  7.76s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04136359996716639
Avg hit ratio: 0.8450030403476922
Avg ndcg: 0.8608124873170319
Avg compression ratio: 0.5245705662284963
Avg train time: 10.198903799057007
Std train time: 0.9766037288804492
[0.8500000000000001, 0.75, 0.15, 0.65, 0.8500000000000001, 0.8500000000000001, 0.25, 0.55, 0.05000000000000001, 0.05000000000000001]
[13, 16, 30, 15, 4, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.8579, 'time@10': 11.2482}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.8579, 'time@10': 11.2482}:  10%|█         | 1/10 [00:05<00:50,  5.66s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8787, 'compress@10': 0.808, 'time@10': 11.4403}:  10%|█         | 1/10 [00:17<00:50,  5.66s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8787, 'compress@10': 0.808, 'time@10': 11.4403}:  20%|██        | 2/10 [00:17<01:13,  9.20s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8715, 'compress@10': 0.6291, 'time@10': 10.3528}:  20%|██        | 2/10 [00:21<01:13,  9.20s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8715, 'compress@10': 0.6291, 'time@10': 10.3528}:  30%|███       | 3/10 [00:21<00:48,  6.88s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8717, 'compress@10': 0.6375, 'time@10': 10.1887}:  30%|███       | 3/10 [00:31<00:48,  6.88s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8717, 'compress@10': 0.6375, 'time@10': 10.1887}:  40%|████      | 4/10 [00:31<00:48,  8.01s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0407, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.848, 'compress@10': 0.6806, 'time@10': 10.0296}:  40%|████      | 4/10 [00:35<00:48,  8.01s/it] {'epoch': 9, 'num_users': 5.8, 'loss': 0.0407, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.848, 'compress@10': 0.6806, 'time@10': 10.0296}:  50%|█████     | 5/10 [00:35<00:34,  6.83s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.042, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8492, 'compress@10': 0.7094, 'time@10': 10.0555}:  50%|█████     | 5/10 [00:46<00:34,  6.83s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.042, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8492, 'compress@10': 0.7094, 'time@10': 10.0555}:  60%|██████    | 6/10 [00:46<00:31,  7.98s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0418, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.8554, 'compress@10': 0.648, 'time@10': 10.1293}:  60%|██████    | 6/10 [00:51<00:31,  7.98s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0418, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.8554, 'compress@10': 0.648, 'time@10': 10.1293}:  70%|███████   | 7/10 [00:51<00:21,  7.11s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.89, 'ndcg@10': 0.849, 'compress@10': 0.6374, 'time@10': 10.1766}:  70%|███████   | 7/10 [01:02<00:21,  7.11s/it]   {'epoch': 9, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.89, 'ndcg@10': 0.849, 'compress@10': 0.6374, 'time@10': 10.1766}:  80%|████████  | 8/10 [01:02<00:16,  8.21s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0407, 'hit_ratio@10': 0.88, 'ndcg@10': 0.8582, 'compress@10': 0.5751, 'time@10': 10.1964}:  80%|████████  | 8/10 [01:07<00:16,  8.21s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0407, 'hit_ratio@10': 0.88, 'ndcg@10': 0.8582, 'compress@10': 0.5751, 'time@10': 10.1964}:  90%|█████████ | 9/10 [01:07<00:07,  7.27s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0396, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.8632, 'compress@10': 0.5248, 'time@10': 10.2575}:  90%|█████████ | 9/10 [01:18<00:07,  7.27s/it] {'epoch': 9, 'num_users': 6.3, 'loss': 0.0396, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.8632, 'compress@10': 0.5248, 'time@10': 10.2575}: 100%|██████████| 10/10 [01:18<00:00,  8.37s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0396, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.8632, 'compress@10': 0.5248, 'time@10': 10.2575}: 100%|██████████| 10/10 [01:18<00:00,  7.81s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03955305232844387
Avg hit ratio: 0.8874510690215274
Avg ndcg: 0.8631684708872329
Avg compression ratio: 0.524777903224335
Avg train time: 10.257453870773315
Std train time: 0.9346796861457835
[0.8636363636363638, 0.6818181818181819, 0.13636363636363635, 0.6818181818181819, 0.8636363636363638, 0.8636363636363638, 0.3181818181818182, 0.5, 0.04545454545454546, 0.04545454545454546]
[13, 16, 31, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.041, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.8708, 'time@10': 10.1947}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.041, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.8708, 'time@10': 10.1947}:  10%|█         | 1/10 [00:05<00:46,  5.13s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8913, 'compress@10': 0.7814, 'time@10': 10.9017}:  10%|█         | 1/10 [00:16<00:46,  5.13s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8913, 'compress@10': 0.7814, 'time@10': 10.9017}:  20%|██        | 2/10 [00:16<01:11,  8.96s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8799, 'compress@10': 0.6075, 'time@10': 10.0608}:  20%|██        | 2/10 [00:21<01:11,  8.96s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8799, 'compress@10': 0.6075, 'time@10': 10.0608}:  30%|███       | 3/10 [00:21<00:47,  6.80s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8788, 'compress@10': 0.6289, 'time@10': 10.0836}:  30%|███       | 3/10 [00:31<00:47,  6.80s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8788, 'compress@10': 0.6289, 'time@10': 10.0836}:  40%|████      | 4/10 [00:31<00:48,  8.14s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0392, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8575, 'compress@10': 0.6764, 'time@10': 10.3177}:  40%|████      | 4/10 [00:36<00:48,  8.14s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0392, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8575, 'compress@10': 0.6764, 'time@10': 10.3177}:  50%|█████     | 5/10 [00:36<00:36,  7.25s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0401, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8576, 'compress@10': 0.7081, 'time@10': 10.2906}:  50%|█████     | 5/10 [00:47<00:36,  7.25s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0401, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8576, 'compress@10': 0.7081, 'time@10': 10.2906}:  60%|██████    | 6/10 [00:47<00:32,  8.25s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0395, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8574, 'compress@10': 0.6563, 'time@10': 10.262}:  60%|██████    | 6/10 [00:52<00:32,  8.25s/it] {'epoch': 10, 'num_users': 6.2857, 'loss': 0.0395, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8574, 'compress@10': 0.6563, 'time@10': 10.262}:  70%|███████   | 7/10 [00:52<00:21,  7.21s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0386, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8626, 'compress@10': 0.6386, 'time@10': 10.2919}:  70%|███████   | 7/10 [01:02<00:21,  7.21s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0386, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8626, 'compress@10': 0.6386, 'time@10': 10.2919}:  80%|████████  | 8/10 [01:02<00:16,  8.27s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0382, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8693, 'compress@10': 0.5757, 'time@10': 10.3015}:  80%|████████  | 8/10 [01:07<00:16,  8.27s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0382, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8693, 'compress@10': 0.5757, 'time@10': 10.3015}:  90%|█████████ | 9/10 [01:07<00:07,  7.32s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8747, 'compress@10': 0.5248, 'time@10': 10.3072}:  90%|█████████ | 9/10 [01:18<00:07,  7.32s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8747, 'compress@10': 0.5248, 'time@10': 10.3072}: 100%|██████████| 10/10 [01:18<00:00,  8.27s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8747, 'compress@10': 0.5248, 'time@10': 10.3072}: 100%|██████████| 10/10 [01:18<00:00,  7.83s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.036941162972360414
Avg hit ratio: 0.8650824054270574
Avg ndcg: 0.874694130896352
Avg compression ratio: 0.5248430405200905
Avg train time: 10.307199907302856
Std train time: 0.8037388131092812
[0.8750000000000001, 0.625, 0.12499999999999999, 0.7083333333333334, 0.8750000000000001, 0.8750000000000001, 0.375, 0.4583333333333333, 0.04166666666666667, 0.04166666666666667]
[13, 16, 32, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8599, 'compress@10': 0.8816, 'time@10': 9.7022}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8599, 'compress@10': 0.8816, 'time@10': 9.7022}:  10%|█         | 1/10 [00:04<00:44,  4.89s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0394, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8789, 'compress@10': 0.7593, 'time@10': 10.6388}:  10%|█         | 1/10 [00:16<00:44,  4.89s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0394, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8789, 'compress@10': 0.7593, 'time@10': 10.6388}:  20%|██        | 2/10 [00:16<01:10,  8.84s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8717, 'compress@10': 0.5896, 'time@10': 10.0594}:  20%|██        | 2/10 [00:20<01:10,  8.84s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8717, 'compress@10': 0.5896, 'time@10': 10.0594}:  30%|███       | 3/10 [00:20<00:47,  6.85s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8837, 'compress@10': 0.6219, 'time@10': 10.15}:  30%|███       | 3/10 [00:31<00:47,  6.85s/it]  {'epoch': 11, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8837, 'compress@10': 0.6219, 'time@10': 10.15}:  40%|████      | 4/10 [00:31<00:49,  8.28s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0384, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8623, 'compress@10': 0.673, 'time@10': 10.2226}:  40%|████      | 4/10 [00:36<00:49,  8.28s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0384, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8623, 'compress@10': 0.673, 'time@10': 10.2226}:  50%|█████     | 5/10 [00:36<00:36,  7.20s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0388, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8631, 'compress@10': 0.7071, 'time@10': 10.2155}:  50%|█████     | 5/10 [00:46<00:36,  7.20s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0388, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8631, 'compress@10': 0.7071, 'time@10': 10.2155}:  60%|██████    | 6/10 [00:46<00:32,  8.23s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8685, 'compress@10': 0.6632, 'time@10': 10.2752}:  60%|██████    | 6/10 [00:52<00:32,  8.23s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8685, 'compress@10': 0.6632, 'time@10': 10.2752}:  70%|███████   | 7/10 [00:52<00:21,  7.29s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0387, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8585, 'compress@10': 0.6396, 'time@10': 10.287}:  70%|███████   | 7/10 [01:02<00:21,  7.29s/it]  {'epoch': 11, 'num_users': 6.125, 'loss': 0.0387, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8585, 'compress@10': 0.6396, 'time@10': 10.287}:  80%|████████  | 8/10 [01:02<00:16,  8.28s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0385, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8653, 'compress@10': 0.5762, 'time@10': 10.3174}:  80%|████████  | 8/10 [01:08<00:16,  8.28s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0385, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8653, 'compress@10': 0.5762, 'time@10': 10.3174}:  90%|█████████ | 9/10 [01:08<00:07,  7.35s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8721, 'compress@10': 0.5249, 'time@10': 10.3384}:  90%|█████████ | 9/10 [01:18<00:07,  7.35s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8721, 'compress@10': 0.5249, 'time@10': 10.3384}: 100%|██████████| 10/10 [01:18<00:00,  8.35s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8721, 'compress@10': 0.5249, 'time@10': 10.3384}: 100%|██████████| 10/10 [01:18<00:00,  7.86s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.036916359617844605
Avg hit ratio: 0.8715268498715018
Avg ndcg: 0.8721272440076986
Avg compression ratio: 0.5248990159114632
Avg train time: 10.338364481925964
Std train time: 0.6509439536634167
[0.8846153846153847, 0.5769230769230769, 0.11538461538461538, 0.6538461538461539, 0.8846153846153847, 0.8846153846153847, 0.4230769230769231, 0.5, 0.038461538461538464, 0.038461538461538464]
[14, 16, 33, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0374, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8674, 'compress@10': 0.8907, 'time@10': 10.2148}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0374, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8674, 'compress@10': 0.8907, 'time@10': 10.2148}:  10%|█         | 1/10 [00:05<00:46,  5.14s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0311, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8932, 'compress@10': 0.7406, 'time@10': 10.9058}:  10%|█         | 1/10 [00:16<00:46,  5.14s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0311, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8932, 'compress@10': 0.7406, 'time@10': 10.9058}:  20%|██        | 2/10 [00:16<01:11,  8.96s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8812, 'compress@10': 0.5743, 'time@10': 10.2333}:  20%|██        | 2/10 [00:21<01:11,  8.96s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8812, 'compress@10': 0.5743, 'time@10': 10.2333}:  30%|███       | 3/10 [00:21<00:48,  6.92s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8957, 'compress@10': 0.5973, 'time@10': 10.2506}:  30%|███       | 3/10 [00:31<00:48,  6.92s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8957, 'compress@10': 0.5973, 'time@10': 10.2506}:  40%|████      | 4/10 [00:31<00:49,  8.27s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0338, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.872, 'compress@10': 0.6552, 'time@10': 10.3062}:  40%|████      | 4/10 [00:36<00:49,  8.27s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0338, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.872, 'compress@10': 0.6552, 'time@10': 10.3062}:  50%|█████     | 5/10 [00:36<00:35,  7.20s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0342, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8722, 'compress@10': 0.6939, 'time@10': 10.2634}:  50%|█████     | 5/10 [00:46<00:35,  7.20s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0342, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8722, 'compress@10': 0.6939, 'time@10': 10.2634}:  60%|██████    | 6/10 [00:46<00:32,  8.18s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0342, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.8718, 'compress@10': 0.6585, 'time@10': 10.3065}:  60%|██████    | 6/10 [00:52<00:32,  8.18s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0342, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.8718, 'compress@10': 0.6585, 'time@10': 10.3065}:  70%|███████   | 7/10 [00:52<00:21,  7.24s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0329, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8765, 'compress@10': 0.6405, 'time@10': 10.3434}:  70%|███████   | 7/10 [01:02<00:21,  7.24s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0329, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8765, 'compress@10': 0.6405, 'time@10': 10.3434}:  80%|████████  | 8/10 [01:02<00:16,  8.33s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0335, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8813, 'compress@10': 0.5766, 'time@10': 10.3406}:  80%|████████  | 8/10 [01:08<00:16,  8.33s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0335, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8813, 'compress@10': 0.5766, 'time@10': 10.3406}:  90%|█████████ | 9/10 [01:08<00:07,  7.35s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8871, 'compress@10': 0.525, 'time@10': 10.3519}:  90%|█████████ | 9/10 [01:18<00:07,  7.35s/it]    {'epoch': 12, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8871, 'compress@10': 0.525, 'time@10': 10.3519}: 100%|██████████| 10/10 [01:18<00:00,  8.32s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8871, 'compress@10': 0.525, 'time@10': 10.3519}: 100%|██████████| 10/10 [01:18<00:00,  7.86s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.0323533500410287
Avg hit ratio: 0.8751213199175847
Avg ndcg: 0.8871330729799031
Avg compression ratio: 0.5249990347253058
Avg train time: 10.351946258544922
Std train time: 0.6289162272688112
[0.8928571428571429, 0.5357142857142857, 0.10714285714285714, 0.6071428571428572, 0.8928571428571429, 0.8928571428571429, 0.4642857142857143, 0.4642857142857143, 0.10714285714285715, 0.03571428571428572]
[14, 16, 34, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8696, 'compress@10': 0.8985, 'time@10': 10.4018}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8696, 'compress@10': 0.8985, 'time@10': 10.4018}:  10%|█         | 1/10 [00:05<00:47,  5.24s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.9384, 'compress@10': 0.7246, 'time@10': 11.0853}:  10%|█         | 1/10 [00:17<00:47,  5.24s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.9384, 'compress@10': 0.7246, 'time@10': 11.0853}:  20%|██        | 2/10 [00:17<01:12,  9.10s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.9113, 'compress@10': 0.5613, 'time@10': 10.4905}:  20%|██        | 2/10 [00:21<01:12,  9.10s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.9113, 'compress@10': 0.5613, 'time@10': 10.4905}:  30%|███       | 3/10 [00:21<00:49,  7.08s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.8106, 'ndcg@10': 0.9184, 'compress@10': 0.5763, 'time@10': 10.4462}:  30%|███       | 3/10 [00:32<00:49,  7.08s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.8106, 'ndcg@10': 0.9184, 'compress@10': 0.5763, 'time@10': 10.4462}:  40%|████      | 4/10 [00:32<00:50,  8.37s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0353, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8911, 'compress@10': 0.64, 'time@10': 10.3653}:  40%|████      | 4/10 [00:37<00:50,  8.37s/it]  {'epoch': 13, 'num_users': 5.8, 'loss': 0.0353, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8911, 'compress@10': 0.64, 'time@10': 10.3653}:  50%|█████     | 5/10 [00:37<00:35,  7.18s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0351, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8872, 'compress@10': 0.6825, 'time@10': 10.299}:  50%|█████     | 5/10 [00:47<00:35,  7.18s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0351, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8872, 'compress@10': 0.6825, 'time@10': 10.299}:  60%|██████    | 6/10 [00:47<00:32,  8.14s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0347, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8903, 'compress@10': 0.6544, 'time@10': 10.374}:  60%|██████    | 6/10 [00:52<00:32,  8.14s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0347, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8903, 'compress@10': 0.6544, 'time@10': 10.374}:  70%|███████   | 7/10 [00:52<00:21,  7.26s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0346, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8834, 'compress@10': 0.6326, 'time@10': 10.3976}:  70%|███████   | 7/10 [01:03<00:21,  7.26s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0346, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8834, 'compress@10': 0.6326, 'time@10': 10.3976}:  80%|████████  | 8/10 [01:03<00:16,  8.32s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0349, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8875, 'compress@10': 0.577, 'time@10': 10.4298}:  80%|████████  | 8/10 [01:08<00:16,  8.32s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0349, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8875, 'compress@10': 0.577, 'time@10': 10.4298}:  90%|█████████ | 9/10 [01:08<00:07,  7.40s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0335, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8929, 'compress@10': 0.5251, 'time@10': 10.4388}:  90%|█████████ | 9/10 [01:19<00:07,  7.40s/it]  {'epoch': 13, 'num_users': 6.3, 'loss': 0.0335, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8929, 'compress@10': 0.5251, 'time@10': 10.4388}: 100%|██████████| 10/10 [01:19<00:00,  8.38s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0335, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8929, 'compress@10': 0.5251, 'time@10': 10.4388}: 100%|██████████| 10/10 [01:19<00:00,  7.91s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03347713081863465
Avg hit ratio: 0.8650752369682759
Avg ndcg: 0.8928972472266506
Avg compression ratio: 0.5250858064028122
Avg train time: 10.438832879066467
Std train time: 0.6077292162787488
[0.9, 0.5666666666666667, 0.09999999999999999, 0.5666666666666668, 0.9, 0.9, 0.43333333333333335, 0.43333333333333335, 0.16666666666666669, 0.03333333333333334]
[14, 16, 35, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8785, 'compress@10': 0.9052, 'time@10': 10.4546}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8785, 'compress@10': 0.9052, 'time@10': 10.4546}:  10%|█         | 1/10 [00:05<00:47,  5.26s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0394, 'hit_ratio@10': 0.798, 'ndcg@10': 0.9492, 'compress@10': 0.7429, 'time@10': 11.0661}:  10%|█         | 1/10 [00:16<00:47,  5.26s/it] {'epoch': 14, 'num_users': 7.0, 'loss': 0.0394, 'hit_ratio@10': 0.798, 'ndcg@10': 0.9492, 'compress@10': 0.7429, 'time@10': 11.0661}:  20%|██        | 2/10 [00:16<01:12,  9.06s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.9185, 'compress@10': 0.5715, 'time@10': 10.6169}:  20%|██        | 2/10 [00:21<01:12,  9.06s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.9185, 'compress@10': 0.5715, 'time@10': 10.6169}:  30%|███       | 3/10 [00:21<00:50,  7.16s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.9383, 'compress@10': 0.5742, 'time@10': 10.5279}:  30%|███       | 3/10 [00:32<00:50,  7.16s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.9383, 'compress@10': 0.5742, 'time@10': 10.5279}:  40%|████      | 4/10 [00:32<00:50,  8.40s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0372, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.9073, 'compress@10': 0.6397, 'time@10': 10.4388}:  40%|████      | 4/10 [00:37<00:50,  8.40s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0372, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.9073, 'compress@10': 0.6397, 'time@10': 10.4388}:  50%|█████     | 5/10 [00:37<00:36,  7.21s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.036, 'hit_ratio@10': 0.838, 'ndcg@10': 0.9038, 'compress@10': 0.6835, 'time@10': 10.397}:  50%|█████     | 5/10 [00:47<00:36,  7.21s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.036, 'hit_ratio@10': 0.838, 'ndcg@10': 0.9038, 'compress@10': 0.6835, 'time@10': 10.397}:  60%|██████    | 6/10 [00:47<00:32,  8.23s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0354, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.9036, 'compress@10': 0.651, 'time@10': 10.4077}:  60%|██████    | 6/10 [00:52<00:32,  8.23s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0354, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.9036, 'compress@10': 0.651, 'time@10': 10.4077}:  70%|███████   | 7/10 [00:52<00:21,  7.27s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0358, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9021, 'compress@10': 0.6258, 'time@10': 10.3908}:  70%|███████   | 7/10 [01:03<00:21,  7.27s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0358, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9021, 'compress@10': 0.6258, 'time@10': 10.3908}:  80%|████████  | 8/10 [01:03<00:16,  8.23s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0357, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9048, 'compress@10': 0.5774, 'time@10': 10.4683}:  80%|████████  | 8/10 [01:08<00:16,  8.23s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0357, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9048, 'compress@10': 0.5774, 'time@10': 10.4683}:  90%|█████████ | 9/10 [01:08<00:07,  7.40s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.034, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9088, 'compress@10': 0.5252, 'time@10': 10.4872}:  90%|█████████ | 9/10 [01:19<00:07,  7.40s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.034, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9088, 'compress@10': 0.5252, 'time@10': 10.4872}: 100%|██████████| 10/10 [01:19<00:00,  8.42s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.034, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9088, 'compress@10': 0.5252, 'time@10': 10.4872}: 100%|██████████| 10/10 [01:19<00:00,  7.94s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.03395884395790019
Avg hit ratio: 0.8707959929148383
Avg ndcg: 0.9087640162166917
Avg compression ratio: 0.5252122670983824
Avg train time: 10.487180233001709
Std train time: 0.5243758800591924
[0.90625, 0.59375, 0.09374999999999999, 0.5312500000000001, 0.90625, 0.84375, 0.40625, 0.46875, 0.21875, 0.03125000000000001]
[14, 16, 36, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0383, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8632, 'compress@10': 0.9112, 'time@10': 10.9197}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0383, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8632, 'compress@10': 0.9112, 'time@10': 10.9197}:  10%|█         | 1/10 [00:05<00:49,  5.50s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8931, 'compress@10': 0.759, 'time@10': 11.4133}:  10%|█         | 1/10 [00:17<00:49,  5.50s/it] {'epoch': 15, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8931, 'compress@10': 0.759, 'time@10': 11.4133}:  20%|██        | 2/10 [00:17<01:14,  9.29s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8811, 'compress@10': 0.5804, 'time@10': 10.8385}:  20%|██        | 2/10 [00:22<01:14,  9.29s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8811, 'compress@10': 0.5804, 'time@10': 10.8385}:  30%|███       | 3/10 [00:22<00:50,  7.28s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0226, 'hit_ratio@10': 0.847, 'ndcg@10': 0.892, 'compress@10': 0.5723, 'time@10': 10.7546}:  30%|███       | 3/10 [00:32<00:50,  7.28s/it]  {'epoch': 15, 'num_users': 5.0, 'loss': 0.0226, 'hit_ratio@10': 0.847, 'ndcg@10': 0.892, 'compress@10': 0.5723, 'time@10': 10.7546}:  40%|████      | 4/10 [00:32<00:51,  8.57s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0331, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8707, 'compress@10': 0.6395, 'time@10': 10.6758}:  40%|████      | 4/10 [00:38<00:51,  8.57s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0331, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8707, 'compress@10': 0.6395, 'time@10': 10.6758}:  50%|█████     | 5/10 [00:38<00:36,  7.36s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0321, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8748, 'compress@10': 0.6741, 'time@10': 10.573}:  50%|█████     | 5/10 [00:48<00:36,  7.36s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0321, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8748, 'compress@10': 0.6741, 'time@10': 10.573}:  60%|██████    | 6/10 [00:48<00:33,  8.29s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0318, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.8781, 'compress@10': 0.6392, 'time@10': 10.5667}:  60%|██████    | 6/10 [00:53<00:33,  8.29s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0318, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.8781, 'compress@10': 0.6392, 'time@10': 10.5667}:  70%|███████   | 7/10 [00:53<00:21,  7.31s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0314, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8758, 'compress@10': 0.6198, 'time@10': 10.5499}:  70%|███████   | 7/10 [01:03<00:21,  7.31s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0314, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8758, 'compress@10': 0.6198, 'time@10': 10.5499}:  80%|████████  | 8/10 [01:03<00:16,  8.32s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.8814, 'compress@10': 0.5777, 'time@10': 10.6627}:  80%|████████  | 8/10 [01:09<00:16,  8.32s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.8814, 'compress@10': 0.5777, 'time@10': 10.6627}:  90%|█████████ | 9/10 [01:09<00:07,  7.54s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0303, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8879, 'compress@10': 0.5253, 'time@10': 10.6488}:  90%|█████████ | 9/10 [01:20<00:07,  7.54s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0303, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8879, 'compress@10': 0.5253, 'time@10': 10.6488}: 100%|██████████| 10/10 [01:20<00:00,  8.48s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0303, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8879, 'compress@10': 0.5253, 'time@10': 10.6488}: 100%|██████████| 10/10 [01:20<00:00,  8.04s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.030312983789983972
Avg hit ratio: 0.8843873638152076
Avg ndcg: 0.8878780680926456
Avg compression ratio: 0.5252830384700699
Avg train time: 10.648810148239136
Std train time: 0.6281435262012021
[0.9117647058823529, 0.5588235294117647, 0.08823529411764705, 0.5588235294117648, 0.9117647058823529, 0.7941176470588235, 0.4411764705882353, 0.4411764705882353, 0.2647058823529412, 0.02941176470588236]
[14, 15, 37, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8957, 'compress@10': 0.9164, 'time@10': 10.503}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8957, 'compress@10': 0.9164, 'time@10': 10.503}:  10%|█         | 1/10 [00:05<00:47,  5.29s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9196, 'compress@10': 0.7447, 'time@10': 10.6953}:  10%|█         | 1/10 [00:16<00:47,  5.29s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9196, 'compress@10': 0.7447, 'time@10': 10.6953}:  20%|██        | 2/10 [00:16<01:08,  8.60s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8988, 'compress@10': 0.5693, 'time@10': 10.5211}:  20%|██        | 2/10 [00:21<01:08,  8.60s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8988, 'compress@10': 0.5693, 'time@10': 10.5211}:  30%|███       | 3/10 [00:21<00:49,  7.01s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9028, 'compress@10': 0.5706, 'time@10': 10.5116}:  30%|███       | 3/10 [00:31<00:49,  7.01s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9028, 'compress@10': 0.5706, 'time@10': 10.5116}:  40%|████      | 4/10 [00:31<00:50,  8.40s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.879, 'compress@10': 0.6392, 'time@10': 10.3959}:  40%|████      | 4/10 [00:36<00:50,  8.40s/it] {'epoch': 16, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.879, 'compress@10': 0.6392, 'time@10': 10.3959}:  50%|█████     | 5/10 [00:36<00:35,  7.17s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8817, 'compress@10': 0.6658, 'time@10': 10.3437}:  50%|█████     | 5/10 [00:46<00:35,  7.17s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8817, 'compress@10': 0.6658, 'time@10': 10.3437}:  60%|██████    | 6/10 [00:46<00:32,  8.18s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8855, 'compress@10': 0.6369, 'time@10': 10.3683}:  60%|██████    | 6/10 [00:52<00:32,  8.18s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8855, 'compress@10': 0.6369, 'time@10': 10.3683}:  70%|███████   | 7/10 [00:52<00:21,  7.23s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8898, 'compress@10': 0.6144, 'time@10': 10.3853}:  70%|███████   | 7/10 [01:02<00:21,  7.23s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8898, 'compress@10': 0.6144, 'time@10': 10.3853}:  80%|████████  | 8/10 [01:02<00:16,  8.29s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8936, 'compress@10': 0.5779, 'time@10': 10.4887}:  80%|████████  | 8/10 [01:08<00:16,  8.29s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8936, 'compress@10': 0.5779, 'time@10': 10.4887}:  90%|█████████ | 9/10 [01:08<00:07,  7.48s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0278, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.8994, 'compress@10': 0.5253, 'time@10': 10.4692}:  90%|█████████ | 9/10 [01:18<00:07,  7.48s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0278, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.8994, 'compress@10': 0.5253, 'time@10': 10.4692}: 100%|██████████| 10/10 [01:18<00:00,  8.36s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0278, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.8994, 'compress@10': 0.5253, 'time@10': 10.4692}: 100%|██████████| 10/10 [01:18<00:00,  7.88s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.027763802817959017
Avg hit ratio: 0.8760591508095752
Avg ndcg: 0.8993863414443336
Avg compression ratio: 0.525257823090933
Avg train time: 10.469229483604432
Std train time: 0.38107602691844383
[0.9166666666666666, 0.5277777777777778, 0.08333333333333333, 0.5277777777777779, 0.9166666666666666, 0.8055555555555555, 0.41666666666666663, 0.4722222222222222, 0.3055555555555556, 0.027777777777777783]
[14, 15, 37, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8716, 'compress@10': 0.921, 'time@10': 10.7681}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8716, 'compress@10': 0.921, 'time@10': 10.7681}:  10%|█         | 1/10 [00:05<00:48,  5.42s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9561, 'compress@10': 0.732, 'time@10': 10.8888}:  10%|█         | 1/10 [00:16<00:48,  5.42s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9561, 'compress@10': 0.732, 'time@10': 10.8888}:  20%|██        | 2/10 [00:16<01:09,  8.73s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9231, 'compress@10': 0.5594, 'time@10': 10.5829}:  20%|██        | 2/10 [00:21<01:09,  8.73s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9231, 'compress@10': 0.5594, 'time@10': 10.5829}:  30%|███       | 3/10 [00:21<00:49,  7.04s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9298, 'compress@10': 0.5557, 'time@10': 10.5261}:  30%|███       | 3/10 [00:31<00:49,  7.04s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9298, 'compress@10': 0.5557, 'time@10': 10.5261}:  40%|████      | 4/10 [00:31<00:50,  8.36s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0287, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.9009, 'compress@10': 0.6283, 'time@10': 10.434}:  40%|████      | 4/10 [00:36<00:50,  8.36s/it] {'epoch': 17, 'num_users': 5.8, 'loss': 0.0287, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.9009, 'compress@10': 0.6283, 'time@10': 10.434}:  50%|█████     | 5/10 [00:36<00:35,  7.17s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0286, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.9024, 'compress@10': 0.6585, 'time@10': 10.4008}:  50%|█████     | 5/10 [00:47<00:35,  7.17s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0286, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.9024, 'compress@10': 0.6585, 'time@10': 10.4008}:  60%|██████    | 6/10 [00:47<00:32,  8.23s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0285, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9045, 'compress@10': 0.6273, 'time@10': 10.4163}:  60%|██████    | 6/10 [00:52<00:32,  8.23s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0285, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9045, 'compress@10': 0.6273, 'time@10': 10.4163}:  70%|███████   | 7/10 [00:52<00:21,  7.27s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.028, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9007, 'compress@10': 0.6098, 'time@10': 10.4103}:  70%|███████   | 7/10 [01:02<00:21,  7.27s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 0.028, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9007, 'compress@10': 0.6098, 'time@10': 10.4103}:  80%|████████  | 8/10 [01:02<00:16,  8.27s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0282, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9038, 'compress@10': 0.5782, 'time@10': 10.5116}:  80%|████████  | 8/10 [01:08<00:16,  8.27s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0282, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9038, 'compress@10': 0.5782, 'time@10': 10.5116}:  90%|█████████ | 9/10 [01:08<00:07,  7.46s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0272, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9088, 'compress@10': 0.5254, 'time@10': 10.5313}:  90%|█████████ | 9/10 [01:19<00:07,  7.46s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0272, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9088, 'compress@10': 0.5254, 'time@10': 10.5313}: 100%|██████████| 10/10 [01:19<00:00,  8.48s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0272, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9088, 'compress@10': 0.5254, 'time@10': 10.5313}: 100%|██████████| 10/10 [01:19<00:00,  7.94s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.027193584566028717
Avg hit ratio: 0.8775706715469026
Avg ndcg: 0.9087702542173195
Avg compression ratio: 0.5253742169649926
Avg train time: 10.531296920776366
Std train time: 0.40227082861369606
[0.9210526315789473, 0.5526315789473685, 0.07894736842105263, 0.5000000000000001, 0.9210526315789473, 0.763157894736842, 0.4473684210526315, 0.4473684210526316, 0.34210526315789475, 0.026315789473684216]
[14, 15, 37, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8838, 'compress@10': 0.9252, 'time@10': 10.7083}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8838, 'compress@10': 0.9252, 'time@10': 10.7083}:  10%|█         | 1/10 [00:05<00:48,  5.39s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.921, 'compress@10': 0.7461, 'time@10': 10.94}:  10%|█         | 1/10 [00:16<00:48,  5.39s/it]   {'epoch': 18, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.921, 'compress@10': 0.7461, 'time@10': 10.94}:  20%|██        | 2/10 [00:16<01:10,  8.81s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8997, 'compress@10': 0.5676, 'time@10': 10.5885}:  20%|██        | 2/10 [00:21<01:10,  8.81s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8997, 'compress@10': 0.5676, 'time@10': 10.5885}:  30%|███       | 3/10 [00:21<00:49,  7.06s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9156, 'compress@10': 0.5552, 'time@10': 10.5477}:  30%|███       | 3/10 [00:32<00:49,  7.06s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9156, 'compress@10': 0.5552, 'time@10': 10.5477}:  40%|████      | 4/10 [00:32<00:50,  8.41s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8918, 'compress@10': 0.6287, 'time@10': 10.4681}:  40%|████      | 4/10 [00:37<00:50,  8.41s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8918, 'compress@10': 0.6287, 'time@10': 10.4681}:  50%|█████     | 5/10 [00:37<00:36,  7.22s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0254, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8969, 'compress@10': 0.6519, 'time@10': 10.4321}:  50%|█████     | 5/10 [00:47<00:36,  7.22s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0254, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8969, 'compress@10': 0.6519, 'time@10': 10.4321}:  60%|██████    | 6/10 [00:47<00:33,  8.26s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9001, 'compress@10': 0.6259, 'time@10': 10.3765}:  60%|██████    | 6/10 [00:52<00:33,  8.26s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9001, 'compress@10': 0.6259, 'time@10': 10.3765}:  70%|███████   | 7/10 [00:52<00:21,  7.21s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.902, 'compress@10': 0.6055, 'time@10': 10.4092}:  70%|███████   | 7/10 [01:03<00:21,  7.21s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.902, 'compress@10': 0.6055, 'time@10': 10.4092}:  80%|████████  | 8/10 [01:03<00:16,  8.32s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0257, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9051, 'compress@10': 0.5784, 'time@10': 10.5553}:  80%|████████  | 8/10 [01:09<00:16,  8.32s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0257, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9051, 'compress@10': 0.5784, 'time@10': 10.5553}:  90%|█████████ | 9/10 [01:09<00:07,  7.56s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9104, 'compress@10': 0.5254, 'time@10': 10.5574}:  90%|█████████ | 9/10 [01:19<00:07,  7.56s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9104, 'compress@10': 0.5254, 'time@10': 10.5574}: 100%|██████████| 10/10 [01:19<00:00,  8.50s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9104, 'compress@10': 0.5254, 'time@10': 10.5574}: 100%|██████████| 10/10 [01:19<00:00,  7.97s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.024762262035703288
Avg hit ratio: 0.8787135286897596
Avg ndcg: 0.9103915882682042
Avg compression ratio: 0.5253655518629574
Avg train time: 10.557439756393432
Std train time: 0.5254660668902446
[0.9249999999999999, 0.525, 0.075, 0.4750000000000001, 0.9249999999999999, 0.7749999999999999, 0.475, 0.425, 0.375, 0.025000000000000005]
[14, 15, 37, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0281, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8831, 'compress@10': 0.9289, 'time@10': 11.0078}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0281, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8831, 'compress@10': 0.9289, 'time@10': 11.0078}:  10%|█         | 1/10 [00:05<00:49,  5.54s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9172, 'compress@10': 0.7346, 'time@10': 10.9426}:  10%|█         | 1/10 [00:16<00:49,  5.54s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9172, 'compress@10': 0.7346, 'time@10': 10.9426}:  20%|██        | 2/10 [00:16<01:09,  8.70s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8972, 'compress@10': 0.5588, 'time@10': 10.5606}:  20%|██        | 2/10 [00:21<01:09,  8.70s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8972, 'compress@10': 0.5588, 'time@10': 10.5606}:  30%|███       | 3/10 [00:21<00:48,  6.98s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.9144, 'compress@10': 0.5425, 'time@10': 10.476}:  30%|███       | 3/10 [00:31<00:48,  6.98s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.9144, 'compress@10': 0.5425, 'time@10': 10.476}:  40%|████      | 4/10 [00:31<00:49,  8.28s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0239, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8906, 'compress@10': 0.6193, 'time@10': 10.4022}:  40%|████      | 4/10 [00:36<00:49,  8.28s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0239, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8906, 'compress@10': 0.6193, 'time@10': 10.4022}:  50%|█████     | 5/10 [00:36<00:35,  7.13s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0231, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8961, 'compress@10': 0.6461, 'time@10': 10.3827}:  50%|█████     | 5/10 [00:47<00:35,  7.13s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0231, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8961, 'compress@10': 0.6461, 'time@10': 10.3827}:  60%|██████    | 6/10 [00:47<00:32,  8.21s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0235, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8989, 'compress@10': 0.6247, 'time@10': 10.3847}:  60%|██████    | 6/10 [00:52<00:32,  8.21s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0235, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8989, 'compress@10': 0.6247, 'time@10': 10.3847}:  70%|███████   | 7/10 [00:52<00:21,  7.24s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0242, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9084, 'compress@10': 0.6018, 'time@10': 10.4289}:  70%|███████   | 7/10 [01:03<00:21,  7.24s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0242, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9084, 'compress@10': 0.6018, 'time@10': 10.4289}:  80%|████████  | 8/10 [01:03<00:16,  8.37s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9108, 'compress@10': 0.5785, 'time@10': 10.5465}:  80%|████████  | 8/10 [01:08<00:16,  8.37s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9108, 'compress@10': 0.5785, 'time@10': 10.5465}:  90%|█████████ | 9/10 [01:08<00:07,  7.56s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9157, 'compress@10': 0.5254, 'time@10': 10.5376}:  90%|█████████ | 9/10 [01:19<00:07,  7.56s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9157, 'compress@10': 0.5254, 'time@10': 10.5376}: 100%|██████████| 10/10 [01:19<00:00,  8.46s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9157, 'compress@10': 0.5254, 'time@10': 10.5376}: 100%|██████████| 10/10 [01:19<00:00,  7.94s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.02406771755329149
Avg hit ratio: 0.8841615573635948
Avg ndcg: 0.9157167410536975
Avg compression ratio: 0.5254073200534818
Avg train time: 10.537597370147704
Std train time: 0.46939905367009593
[0.9285714285714285, 0.5, 0.07142857142857142, 0.45238095238095244, 0.9285714285714285, 0.738095238095238, 0.5, 0.4523809523809524, 0.40476190476190477, 0.023809523809523815]
[14, 15, 37, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8931, 'compress@10': 0.9323, 'time@10': 10.7926}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8931, 'compress@10': 0.9323, 'time@10': 10.7926}:  10%|█         | 1/10 [00:05<00:48,  5.43s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9648, 'compress@10': 0.7242, 'time@10': 10.764}:  10%|█         | 1/10 [00:16<00:48,  5.43s/it] {'epoch': 20, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9648, 'compress@10': 0.7242, 'time@10': 10.764}:  20%|██        | 2/10 [00:16<01:08,  8.57s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9289, 'compress@10': 0.5508, 'time@10': 10.5878}:  20%|██        | 2/10 [00:21<01:08,  8.57s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9289, 'compress@10': 0.5508, 'time@10': 10.5878}:  30%|███       | 3/10 [00:21<00:49,  7.01s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9367, 'compress@10': 0.5311, 'time@10': 10.5194}:  30%|███       | 3/10 [00:31<00:49,  7.01s/it]  {'epoch': 20, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9367, 'compress@10': 0.5311, 'time@10': 10.5194}:  40%|████      | 4/10 [00:31<00:49,  8.33s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0287, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.9086, 'compress@10': 0.6109, 'time@10': 10.4994}:  40%|████      | 4/10 [00:36<00:49,  8.33s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0287, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.9086, 'compress@10': 0.6109, 'time@10': 10.4994}:  50%|█████     | 5/10 [00:36<00:36,  7.23s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0282, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.9115, 'compress@10': 0.6331, 'time@10': 10.5048}:  50%|█████     | 5/10 [00:47<00:36,  7.23s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0282, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.9115, 'compress@10': 0.6331, 'time@10': 10.5048}:  60%|██████    | 6/10 [00:47<00:33,  8.36s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0275, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9124, 'compress@10': 0.6169, 'time@10': 10.5336}:  60%|██████    | 6/10 [00:52<00:33,  8.36s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0275, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9124, 'compress@10': 0.6169, 'time@10': 10.5336}:  70%|███████   | 7/10 [00:52<00:22,  7.39s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.029, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9215, 'compress@10': 0.5983, 'time@10': 10.5315}:  70%|███████   | 7/10 [01:03<00:22,  7.39s/it]  {'epoch': 20, 'num_users': 6.125, 'loss': 0.029, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9215, 'compress@10': 0.5983, 'time@10': 10.5315}:  80%|████████  | 8/10 [01:03<00:16,  8.40s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9228, 'compress@10': 0.5787, 'time@10': 10.6553}:  80%|████████  | 8/10 [01:09<00:16,  8.40s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9228, 'compress@10': 0.5787, 'time@10': 10.6553}:  90%|█████████ | 9/10 [01:09<00:07,  7.61s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9269, 'compress@10': 0.5254, 'time@10': 10.6344}:  90%|█████████ | 9/10 [01:19<00:07,  7.61s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9269, 'compress@10': 0.5254, 'time@10': 10.6344}: 100%|██████████| 10/10 [01:19<00:00,  8.50s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9269, 'compress@10': 0.5254, 'time@10': 10.6344}: 100%|██████████| 10/10 [01:19<00:00,  7.99s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.0274910039079299
Avg hit ratio: 0.8834242301746545
Avg ndcg: 0.9269385661191546
Avg compression ratio: 0.5254164129873197
Avg train time: 10.634357666969299
Std train time: 0.37836953644850396
[0.8863636363636362, 0.5227272727272727, 0.06818181818181818, 0.4318181818181819, 0.9318181818181818, 0.7499999999999999, 0.4772727272727273, 0.4772727272727273, 0.4318181818181818, 0.02272727272727273]
[14, 15, 37, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8871, 'compress@10': 0.8923, 'time@10': 10.8832}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8871, 'compress@10': 0.8923, 'time@10': 10.8832}:  10%|█         | 1/10 [00:05<00:49,  5.48s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9337, 'compress@10': 0.7152, 'time@10': 10.9136}:  10%|█         | 1/10 [00:16<00:49,  5.48s/it] {'epoch': 21, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9337, 'compress@10': 0.7152, 'time@10': 10.9136}:  20%|██        | 2/10 [00:16<01:09,  8.72s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9082, 'compress@10': 0.5439, 'time@10': 10.5147}:  20%|██        | 2/10 [00:21<01:09,  8.72s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9082, 'compress@10': 0.5439, 'time@10': 10.5147}:  30%|███       | 3/10 [00:21<00:48,  6.97s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9664, 'compress@10': 0.521, 'time@10': 10.5386}:  30%|███       | 3/10 [00:32<00:48,  6.97s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9664, 'compress@10': 0.521, 'time@10': 10.5386}:  40%|████      | 4/10 [00:32<00:50,  8.43s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.032, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9323, 'compress@10': 0.6034, 'time@10': 10.5137}:  40%|████      | 4/10 [00:37<00:50,  8.43s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.032, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9323, 'compress@10': 0.6034, 'time@10': 10.5137}:  50%|█████     | 5/10 [00:37<00:36,  7.28s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0311, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9346, 'compress@10': 0.6288, 'time@10': 10.4826}:  50%|█████     | 5/10 [00:47<00:36,  7.28s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0311, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9346, 'compress@10': 0.6288, 'time@10': 10.4826}:  60%|██████    | 6/10 [00:47<00:33,  8.33s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0298, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9328, 'compress@10': 0.6101, 'time@10': 10.4786}:  60%|██████    | 6/10 [00:52<00:33,  8.33s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0298, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9328, 'compress@10': 0.6101, 'time@10': 10.4786}:  70%|███████   | 7/10 [00:52<00:21,  7.33s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0275, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9351, 'compress@10': 0.5954, 'time@10': 10.4744}:  70%|███████   | 7/10 [01:03<00:21,  7.33s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.0275, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9351, 'compress@10': 0.5954, 'time@10': 10.4744}:  80%|████████  | 8/10 [01:03<00:16,  8.33s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0275, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.935, 'compress@10': 0.579, 'time@10': 10.5729}:  80%|████████  | 8/10 [01:09<00:16,  8.33s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0275, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.935, 'compress@10': 0.579, 'time@10': 10.5729}:  90%|█████████ | 9/10 [01:09<00:07,  7.52s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0263, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9382, 'compress@10': 0.5256, 'time@10': 10.5702}:  90%|█████████ | 9/10 [01:19<00:07,  7.52s/it] {'epoch': 21, 'num_users': 6.3, 'loss': 0.0263, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9382, 'compress@10': 0.5256, 'time@10': 10.5702}: 100%|██████████| 10/10 [01:19<00:00,  8.46s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0263, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9382, 'compress@10': 0.5256, 'time@10': 10.5702}: 100%|██████████| 10/10 [01:19<00:00,  7.97s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.026302217909553068
Avg hit ratio: 0.9012624008702106
Avg ndcg: 0.9382185424132059
Avg compression ratio: 0.5255977253254297
Avg train time: 10.570173859596252
Std train time: 0.4129775780853749
[0.8913043478260868, 0.5, 0.06521739130434782, 0.4565217391304348, 0.9347826086956521, 0.7608695652173912, 0.4565217391304348, 0.4565217391304348, 0.4565217391304348, 0.02173913043478261]
[14, 15, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8924, 'compress@10': 0.897, 'time@10': 10.8219}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8924, 'compress@10': 0.897, 'time@10': 10.8219}:  10%|█         | 1/10 [00:05<00:49,  5.45s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9289, 'compress@10': 0.7066, 'time@10': 10.9453}:  10%|█         | 1/10 [00:16<00:49,  5.45s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9289, 'compress@10': 0.7066, 'time@10': 10.9453}:  20%|██        | 2/10 [00:16<01:10,  8.78s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.905, 'compress@10': 0.5373, 'time@10': 10.7566}:  20%|██        | 2/10 [00:21<01:10,  8.78s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.905, 'compress@10': 0.5373, 'time@10': 10.7566}:  30%|███       | 3/10 [00:21<00:50,  7.16s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9183, 'compress@10': 0.522, 'time@10': 10.7203}:  30%|███       | 3/10 [00:32<00:50,  7.16s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9183, 'compress@10': 0.522, 'time@10': 10.7203}:  40%|████      | 4/10 [00:32<00:51,  8.54s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8955, 'compress@10': 0.6048, 'time@10': 10.7881}:  40%|████      | 4/10 [00:38<00:51,  8.54s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8955, 'compress@10': 0.6048, 'time@10': 10.7881}:  50%|█████     | 5/10 [00:38<00:37,  7.47s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9031, 'compress@10': 0.6317, 'time@10': 10.7093}:  50%|█████     | 5/10 [00:48<00:37,  7.47s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9031, 'compress@10': 0.6317, 'time@10': 10.7093}:  60%|██████    | 6/10 [00:48<00:33,  8.45s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9061, 'compress@10': 0.6098, 'time@10': 10.6443}:  60%|██████    | 6/10 [00:53<00:33,  8.45s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9061, 'compress@10': 0.6098, 'time@10': 10.6443}:  70%|███████   | 7/10 [00:53<00:22,  7.37s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0173, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9125, 'compress@10': 0.5925, 'time@10': 10.615}:  70%|███████   | 7/10 [01:03<00:22,  7.37s/it]  {'epoch': 22, 'num_users': 6.125, 'loss': 0.0173, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9125, 'compress@10': 0.5925, 'time@10': 10.615}:  80%|████████  | 8/10 [01:03<00:16,  8.35s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9145, 'compress@10': 0.5792, 'time@10': 10.7455}:  80%|████████  | 8/10 [01:09<00:16,  8.35s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9145, 'compress@10': 0.5792, 'time@10': 10.7455}:  90%|█████████ | 9/10 [01:09<00:07,  7.60s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9198, 'compress@10': 0.5256, 'time@10': 10.731}:  90%|█████████ | 9/10 [01:20<00:07,  7.60s/it]    {'epoch': 22, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9198, 'compress@10': 0.5256, 'time@10': 10.731}: 100%|██████████| 10/10 [01:20<00:00,  8.53s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9198, 'compress@10': 0.5256, 'time@10': 10.731}: 100%|██████████| 10/10 [01:20<00:00,  8.05s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.0176796894252921
Avg hit ratio: 0.892548115155925
Avg ndcg: 0.9197781610320146
Avg compression ratio: 0.5256418096299276
Avg train time: 10.731018686294556
Std train time: 0.4482824902095536
[0.8958333333333331, 0.4791666666666667, 0.0625, 0.4375, 0.9374999999999999, 0.7291666666666666, 0.4791666666666667, 0.4375, 0.4791666666666667, 0.0625]
[14, 15, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8836, 'compress@10': 0.9013, 'time@10': 10.9373}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8836, 'compress@10': 0.9013, 'time@10': 10.9373}:  10%|█         | 1/10 [00:05<00:49,  5.51s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9293, 'compress@10': 0.6986, 'time@10': 11.0046}:  10%|█         | 1/10 [00:16<00:49,  5.51s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9293, 'compress@10': 0.6986, 'time@10': 11.0046}:  20%|██        | 2/10 [00:16<01:10,  8.80s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9052, 'compress@10': 0.5312, 'time@10': 10.8578}:  20%|██        | 2/10 [00:21<01:10,  8.80s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9052, 'compress@10': 0.5312, 'time@10': 10.8578}:  30%|███       | 3/10 [00:21<00:50,  7.21s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9487, 'compress@10': 0.5128, 'time@10': 10.7928}:  30%|███       | 3/10 [00:32<00:50,  7.21s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9487, 'compress@10': 0.5128, 'time@10': 10.7928}:  40%|████      | 4/10 [00:32<00:51,  8.56s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9204, 'compress@10': 0.598, 'time@10': 10.7039}:  40%|████      | 4/10 [00:37<00:51,  8.56s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9204, 'compress@10': 0.598, 'time@10': 10.7039}:  50%|█████     | 5/10 [00:37<00:36,  7.35s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0253, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9224, 'compress@10': 0.6209, 'time@10': 10.6081}:  50%|█████     | 5/10 [00:47<00:36,  7.35s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0253, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9224, 'compress@10': 0.6209, 'time@10': 10.6081}:  60%|██████    | 6/10 [00:47<00:33,  8.31s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0246, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9239, 'compress@10': 0.6036, 'time@10': 10.5968}:  60%|██████    | 6/10 [00:53<00:33,  8.31s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0246, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9239, 'compress@10': 0.6036, 'time@10': 10.5968}:  70%|███████   | 7/10 [00:53<00:21,  7.33s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0242, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9198, 'compress@10': 0.5848, 'time@10': 10.5833}:  70%|███████   | 7/10 [01:03<00:21,  7.33s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0242, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9198, 'compress@10': 0.5848, 'time@10': 10.5833}:  80%|████████  | 8/10 [01:03<00:16,  8.35s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0242, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9212, 'compress@10': 0.5748, 'time@10': 10.7172}:  80%|████████  | 8/10 [01:09<00:16,  8.35s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0242, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9212, 'compress@10': 0.5748, 'time@10': 10.7172}:  90%|█████████ | 9/10 [01:09<00:07,  7.59s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0231, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9271, 'compress@10': 0.5257, 'time@10': 10.7115}:  90%|█████████ | 9/10 [01:20<00:07,  7.59s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0231, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9271, 'compress@10': 0.5257, 'time@10': 10.7115}: 100%|██████████| 10/10 [01:20<00:00,  8.55s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0231, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9271, 'compress@10': 0.5257, 'time@10': 10.7115}: 100%|██████████| 10/10 [01:20<00:00,  8.04s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.023112221331988873
Avg hit ratio: 0.8941354167432266
Avg ndcg: 0.9270775467092852
Avg compression ratio: 0.5256614467579734
Avg train time: 10.711482763290405
Std train time: 0.4394363198457373
[0.8999999999999998, 0.46, 0.06, 0.46, 0.94, 0.74, 0.46, 0.42, 0.5, 0.06]
[14, 15, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8987, 'compress@10': 0.9052, 'time@10': 10.7897}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8987, 'compress@10': 0.9052, 'time@10': 10.7897}:  10%|█         | 1/10 [00:05<00:48,  5.43s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9731, 'compress@10': 0.6913, 'time@10': 10.8442}:  10%|█         | 1/10 [00:16<00:48,  5.43s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9731, 'compress@10': 0.6913, 'time@10': 10.8442}:  20%|██        | 2/10 [00:16<01:09,  8.67s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9345, 'compress@10': 0.5257, 'time@10': 10.6057}:  20%|██        | 2/10 [00:21<01:09,  8.67s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9345, 'compress@10': 0.5257, 'time@10': 10.6057}:  30%|███       | 3/10 [00:21<00:49,  7.04s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9409, 'compress@10': 0.5141, 'time@10': 10.5178}:  30%|███       | 3/10 [00:31<00:49,  7.04s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9409, 'compress@10': 0.5141, 'time@10': 10.5178}:  40%|████      | 4/10 [00:31<00:49,  8.33s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.9146, 'compress@10': 0.5995, 'time@10': 10.5139}:  40%|████      | 4/10 [00:37<00:49,  8.33s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.9146, 'compress@10': 0.5995, 'time@10': 10.5139}:  50%|█████     | 5/10 [00:37<00:36,  7.23s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0211, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.9201, 'compress@10': 0.6239, 'time@10': 10.4266}:  50%|█████     | 5/10 [00:47<00:36,  7.23s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0211, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.9201, 'compress@10': 0.6239, 'time@10': 10.4266}:  60%|██████    | 6/10 [00:47<00:32,  8.18s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9221, 'compress@10': 0.6035, 'time@10': 10.4526}:  60%|██████    | 6/10 [00:52<00:32,  8.18s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9221, 'compress@10': 0.6035, 'time@10': 10.4526}:  70%|███████   | 7/10 [00:52<00:21,  7.25s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0193, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9268, 'compress@10': 0.5827, 'time@10': 10.4552}:  70%|███████   | 7/10 [01:02<00:21,  7.25s/it]  {'epoch': 24, 'num_users': 6.125, 'loss': 0.0193, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9268, 'compress@10': 0.5827, 'time@10': 10.4552}:  80%|████████  | 8/10 [01:02<00:16,  8.29s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9277, 'compress@10': 0.5751, 'time@10': 10.6092}:  80%|████████  | 8/10 [01:08<00:16,  8.29s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9277, 'compress@10': 0.5751, 'time@10': 10.6092}:  90%|█████████ | 9/10 [01:08<00:07,  7.56s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9319, 'compress@10': 0.5257, 'time@10': 10.617}:  90%|█████████ | 9/10 [01:19<00:07,  7.56s/it]    {'epoch': 24, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9319, 'compress@10': 0.5257, 'time@10': 10.617}: 100%|██████████| 10/10 [01:19<00:00,  8.54s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9319, 'compress@10': 0.5257, 'time@10': 10.617}: 100%|██████████| 10/10 [01:19<00:00,  7.96s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.019637329434093572
Avg hit ratio: 0.8776274802352901
Avg ndcg: 0.9319231550238545
Avg compression ratio: 0.5257008643104653
Avg train time: 10.6170490026474
Std train time: 0.49111750829457146
[0.9038461538461536, 0.4807692307692308, 0.05769230769230769, 0.44230769230769235, 0.9423076923076923, 0.7115384615384616, 0.4807692307692308, 0.40384615384615385, 0.5192307692307693, 0.05769230769230769]
[14, 15, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8913, 'compress@10': 0.9089, 'time@10': 11.1473}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8913, 'compress@10': 0.9089, 'time@10': 11.1473}:  10%|█         | 1/10 [00:05<00:50,  5.61s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.893, 'ndcg@10': 0.93, 'compress@10': 0.7032, 'time@10': 11.0261}:  10%|█         | 1/10 [00:16<00:50,  5.61s/it]   {'epoch': 25, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.893, 'ndcg@10': 0.93, 'compress@10': 0.7032, 'time@10': 11.0261}:  20%|██        | 2/10 [00:16<01:09,  8.75s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9057, 'compress@10': 0.5329, 'time@10': 10.7483}:  20%|██        | 2/10 [00:21<01:09,  8.75s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9057, 'compress@10': 0.5329, 'time@10': 10.7483}:  30%|███       | 3/10 [00:21<00:49,  7.10s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9515, 'compress@10': 0.5152, 'time@10': 10.5915}:  30%|███       | 3/10 [00:31<00:49,  7.10s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9515, 'compress@10': 0.5152, 'time@10': 10.5915}:  40%|████      | 4/10 [00:31<00:49,  8.31s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.9239, 'compress@10': 0.6009, 'time@10': 10.5437}:  40%|████      | 4/10 [00:37<00:49,  8.31s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.9239, 'compress@10': 0.6009, 'time@10': 10.5437}:  50%|█████     | 5/10 [00:37<00:35,  7.19s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9299, 'compress@10': 0.6204, 'time@10': 10.5037}:  50%|█████     | 5/10 [00:47<00:35,  7.19s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9299, 'compress@10': 0.6204, 'time@10': 10.5037}:  60%|██████    | 6/10 [00:47<00:33,  8.26s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9308, 'compress@10': 0.6034, 'time@10': 10.4878}:  60%|██████    | 6/10 [00:52<00:33,  8.26s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9308, 'compress@10': 0.6034, 'time@10': 10.4878}:  70%|███████   | 7/10 [00:52<00:21,  7.27s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0217, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.943, 'compress@10': 0.5806, 'time@10': 10.5314}:  70%|███████   | 7/10 [01:03<00:21,  7.27s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.0217, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.943, 'compress@10': 0.5806, 'time@10': 10.5314}:  80%|████████  | 8/10 [01:03<00:16,  8.42s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9419, 'compress@10': 0.5753, 'time@10': 10.6253}:  80%|████████  | 8/10 [01:09<00:16,  8.42s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9419, 'compress@10': 0.5753, 'time@10': 10.6253}:  90%|█████████ | 9/10 [01:09<00:07,  7.58s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9447, 'compress@10': 0.5257, 'time@10': 10.6217}:  90%|█████████ | 9/10 [01:19<00:07,  7.58s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9447, 'compress@10': 0.5257, 'time@10': 10.6217}: 100%|██████████| 10/10 [01:19<00:00,  8.52s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9447, 'compress@10': 0.5257, 'time@10': 10.6217}: 100%|██████████| 10/10 [01:19<00:00,  7.99s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.021735695705248644
Avg hit ratio: 0.887970003209392
Avg ndcg: 0.9447341458672698
Avg compression ratio: 0.5256826329932844
Avg train time: 10.621681547164917
Std train time: 0.4043240207987866
[0.8703703703703701, 0.46296296296296297, 0.05555555555555555, 0.462962962962963, 0.9444444444444444, 0.6851851851851852, 0.5, 0.42592592592592593, 0.5370370370370371, 0.05555555555555555]
[14, 15, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8946, 'compress@10': 0.8772, 'time@10': 10.8948}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8946, 'compress@10': 0.8772, 'time@10': 10.8948}:  10%|█         | 1/10 [00:05<00:49,  5.48s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9579, 'compress@10': 0.6787, 'time@10': 10.8456}:  10%|█         | 1/10 [00:16<00:49,  5.48s/it] {'epoch': 26, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9579, 'compress@10': 0.6787, 'time@10': 10.8456}:  20%|██        | 2/10 [00:16<01:09,  8.63s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9243, 'compress@10': 0.516, 'time@10': 10.5124}:  20%|██        | 2/10 [00:21<01:09,  8.63s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9243, 'compress@10': 0.516, 'time@10': 10.5124}:  30%|███       | 3/10 [00:21<00:48,  6.95s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9333, 'compress@10': 0.5075, 'time@10': 10.4844}:  30%|███       | 3/10 [00:31<00:48,  6.95s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9333, 'compress@10': 0.5075, 'time@10': 10.4844}:  40%|████      | 4/10 [00:31<00:49,  8.33s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.9098, 'compress@10': 0.5951, 'time@10': 10.418}:  40%|████      | 4/10 [00:36<00:49,  8.33s/it]  {'epoch': 26, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.9098, 'compress@10': 0.5951, 'time@10': 10.418}:  50%|█████     | 5/10 [00:36<00:35,  7.17s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.9175, 'compress@10': 0.6113, 'time@10': 10.4558}:  50%|█████     | 5/10 [00:47<00:35,  7.17s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.9175, 'compress@10': 0.6113, 'time@10': 10.4558}:  60%|██████    | 6/10 [00:47<00:33,  8.36s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9202, 'compress@10': 0.5983, 'time@10': 10.4836}:  60%|██████    | 6/10 [00:52<00:33,  8.36s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9202, 'compress@10': 0.5983, 'time@10': 10.4836}:  70%|███████   | 7/10 [00:52<00:22,  7.38s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9286, 'compress@10': 0.5788, 'time@10': 10.4847}:  70%|███████   | 7/10 [01:03<00:22,  7.38s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9286, 'compress@10': 0.5788, 'time@10': 10.4847}:  80%|████████  | 8/10 [01:03<00:16,  8.39s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0214, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9292, 'compress@10': 0.5756, 'time@10': 10.5938}:  80%|████████  | 8/10 [01:09<00:16,  8.39s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0214, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9292, 'compress@10': 0.5756, 'time@10': 10.5938}:  90%|█████████ | 9/10 [01:09<00:07,  7.57s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0205, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9334, 'compress@10': 0.5257, 'time@10': 10.6151}:  90%|█████████ | 9/10 [01:20<00:07,  7.57s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0205, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9334, 'compress@10': 0.5257, 'time@10': 10.6151}: 100%|██████████| 10/10 [01:20<00:00,  8.58s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0205, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9334, 'compress@10': 0.5257, 'time@10': 10.6151}: 100%|██████████| 10/10 [01:20<00:00,  8.00s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.020475652393956163
Avg hit ratio: 0.8808271460665349
Avg ndcg: 0.9333656784901487
Avg compression ratio: 0.5257421013800329
Avg train time: 10.615083789825439
Std train time: 0.41727884256496206
[0.8392857142857141, 0.48214285714285715, 0.05357142857142857, 0.4464285714285715, 0.9464285714285714, 0.6607142857142858, 0.5178571428571429, 0.44642857142857145, 0.5535714285714286, 0.05357142857142857]
[14, 15, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8913, 'compress@10': 0.8477, 'time@10': 11.1368}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8913, 'compress@10': 0.8477, 'time@10': 11.1368}:  10%|█         | 1/10 [00:05<00:50,  5.61s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9357, 'compress@10': 0.6733, 'time@10': 10.9542}:  10%|█         | 1/10 [00:16<00:50,  5.61s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9357, 'compress@10': 0.6733, 'time@10': 10.9542}:  20%|██        | 2/10 [00:16<01:09,  8.67s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9095, 'compress@10': 0.5118, 'time@10': 10.7649}:  20%|██        | 2/10 [00:21<01:09,  8.67s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9095, 'compress@10': 0.5118, 'time@10': 10.7649}:  30%|███       | 3/10 [00:21<00:49,  7.10s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9582, 'compress@10': 0.5004, 'time@10': 10.6513}:  30%|███       | 3/10 [00:31<00:49,  7.10s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9582, 'compress@10': 0.5004, 'time@10': 10.6513}:  40%|████      | 4/10 [00:31<00:50,  8.38s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9307, 'compress@10': 0.5898, 'time@10': 10.6422}:  40%|████      | 4/10 [00:37<00:50,  8.38s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9307, 'compress@10': 0.5898, 'time@10': 10.6422}:  50%|█████     | 5/10 [00:37<00:36,  7.29s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0225, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9356, 'compress@10': 0.6029, 'time@10': 10.6389}:  50%|█████     | 5/10 [00:47<00:36,  7.29s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0225, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9356, 'compress@10': 0.6029, 'time@10': 10.6389}:  60%|██████    | 6/10 [00:47<00:33,  8.43s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0217, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9358, 'compress@10': 0.5935, 'time@10': 10.6237}:  60%|██████    | 6/10 [00:53<00:33,  8.43s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0217, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9358, 'compress@10': 0.5935, 'time@10': 10.6237}:  70%|███████   | 7/10 [00:53<00:22,  7.41s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0196, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9388, 'compress@10': 0.5771, 'time@10': 10.6299}:  70%|███████   | 7/10 [01:04<00:22,  7.41s/it]  {'epoch': 27, 'num_users': 6.125, 'loss': 0.0196, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9388, 'compress@10': 0.5771, 'time@10': 10.6299}:  80%|████████  | 8/10 [01:04<00:16,  8.46s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9384, 'compress@10': 0.5759, 'time@10': 10.7408}:  80%|████████  | 8/10 [01:09<00:16,  8.46s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9384, 'compress@10': 0.5759, 'time@10': 10.7408}:  90%|█████████ | 9/10 [01:09<00:07,  7.64s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9416, 'compress@10': 0.5258, 'time@10': 10.7173}:  90%|█████████ | 9/10 [01:20<00:07,  7.64s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9416, 'compress@10': 0.5258, 'time@10': 10.7173}: 100%|██████████| 10/10 [01:20<00:00,  8.54s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9416, 'compress@10': 0.5258, 'time@10': 10.7173}: 100%|██████████| 10/10 [01:20<00:00,  8.04s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.019640227774079456
Avg hit ratio: 0.8996878731530684
Avg ndcg: 0.9416130479567727
Avg compression ratio: 0.5258084708602502
Avg train time: 10.71725354194641
Std train time: 0.3723359852241713
[0.8103448275862067, 0.5, 0.05172413793103448, 0.46551724137931044, 0.9482758620689655, 0.6724137931034484, 0.5, 0.4310344827586207, 0.5689655172413793, 0.05172413793103448]
[14, 15, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8913, 'compress@10': 0.8203, 'time@10': 10.8045}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8913, 'compress@10': 0.8203, 'time@10': 10.8045}:  10%|█         | 1/10 [00:05<00:48,  5.44s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9383, 'compress@10': 0.6682, 'time@10': 10.8492}:  10%|█         | 1/10 [00:16<00:48,  5.44s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9383, 'compress@10': 0.6682, 'time@10': 10.8492}:  20%|██        | 2/10 [00:16<01:09,  8.67s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9113, 'compress@10': 0.5079, 'time@10': 10.6088}:  20%|██        | 2/10 [00:21<01:09,  8.67s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9113, 'compress@10': 0.5079, 'time@10': 10.6088}:  30%|███       | 3/10 [00:21<00:49,  7.04s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9241, 'compress@10': 0.5021, 'time@10': 10.555}:  30%|███       | 3/10 [00:31<00:49,  7.04s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9241, 'compress@10': 0.5021, 'time@10': 10.555}:  40%|████      | 4/10 [00:31<00:50,  8.38s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0184, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.903, 'compress@10': 0.5915, 'time@10': 10.553}:  40%|████      | 4/10 [00:37<00:50,  8.38s/it] {'epoch': 28, 'num_users': 5.8, 'loss': 0.0184, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.903, 'compress@10': 0.5915, 'time@10': 10.553}:  50%|█████     | 5/10 [00:37<00:36,  7.27s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.913, 'compress@10': 0.6062, 'time@10': 10.5827}:  50%|█████     | 5/10 [00:47<00:36,  7.27s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.913, 'compress@10': 0.6062, 'time@10': 10.5827}:  60%|██████    | 6/10 [00:47<00:33,  8.46s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9167, 'compress@10': 0.5939, 'time@10': 10.5899}:  60%|██████    | 6/10 [00:53<00:33,  8.46s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9167, 'compress@10': 0.5939, 'time@10': 10.5899}:  70%|███████   | 7/10 [00:53<00:22,  7.45s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9223, 'compress@10': 0.5756, 'time@10': 10.5512}:  70%|███████   | 7/10 [01:03<00:22,  7.45s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9223, 'compress@10': 0.5756, 'time@10': 10.5512}:  80%|████████  | 8/10 [01:03<00:16,  8.37s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.9239, 'compress@10': 0.5762, 'time@10': 10.6474}:  80%|████████  | 8/10 [01:09<00:16,  8.37s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.9239, 'compress@10': 0.5762, 'time@10': 10.6474}:  90%|█████████ | 9/10 [01:09<00:07,  7.55s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9286, 'compress@10': 0.5259, 'time@10': 10.6537}:  90%|█████████ | 9/10 [01:20<00:07,  7.55s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9286, 'compress@10': 0.5259, 'time@10': 10.6537}: 100%|██████████| 10/10 [01:20<00:00,  8.54s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9286, 'compress@10': 0.5259, 'time@10': 10.6537}: 100%|██████████| 10/10 [01:20<00:00,  8.02s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.015106949482037016
Avg hit ratio: 0.8854021588673542
Avg ndcg: 0.928588913092111
Avg compression ratio: 0.525907933717423
Avg train time: 10.65368926525116
Std train time: 0.3417409659612818
[0.8166666666666665, 0.5166666666666667, 0.05, 0.45000000000000007, 0.95, 0.6500000000000001, 0.5166666666666667, 0.4166666666666667, 0.5833333333333334, 0.05]
[14, 15, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8913, 'compress@10': 0.8263, 'time@10': 10.6432}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8913, 'compress@10': 0.8263, 'time@10': 10.6432}:  10%|█         | 1/10 [00:05<00:48,  5.36s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.946, 'compress@10': 0.6793, 'time@10': 10.7411}:  10%|█         | 1/10 [00:16<00:48,  5.36s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.946, 'compress@10': 0.6793, 'time@10': 10.7411}:  20%|██        | 2/10 [00:16<01:08,  8.60s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9164, 'compress@10': 0.5148, 'time@10': 10.5424}:  20%|██        | 2/10 [00:21<01:08,  8.60s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9164, 'compress@10': 0.5148, 'time@10': 10.5424}:  30%|███       | 3/10 [00:21<00:49,  7.01s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9439, 'compress@10': 0.5035, 'time@10': 10.4849}:  30%|███       | 3/10 [00:31<00:49,  7.01s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9439, 'compress@10': 0.5035, 'time@10': 10.4849}:  40%|████      | 4/10 [00:31<00:49,  8.33s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.9194, 'compress@10': 0.593, 'time@10': 10.4902}:  40%|████      | 4/10 [00:36<00:49,  8.33s/it] {'epoch': 29, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.9194, 'compress@10': 0.593, 'time@10': 10.4902}:  50%|█████     | 5/10 [00:36<00:36,  7.23s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9273, 'compress@10': 0.6038, 'time@10': 10.4671}:  50%|█████     | 5/10 [00:47<00:36,  7.23s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9273, 'compress@10': 0.6038, 'time@10': 10.4671}:  60%|██████    | 6/10 [00:47<00:33,  8.31s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9291, 'compress@10': 0.5941, 'time@10': 10.4313}:  60%|██████    | 6/10 [00:52<00:33,  8.31s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9291, 'compress@10': 0.5941, 'time@10': 10.4313}:  70%|███████   | 7/10 [00:52<00:21,  7.27s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9316, 'compress@10': 0.574, 'time@10': 10.4297}:  70%|███████   | 7/10 [01:02<00:21,  7.27s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9316, 'compress@10': 0.574, 'time@10': 10.4297}:  80%|████████  | 8/10 [01:02<00:16,  8.29s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9324, 'compress@10': 0.5764, 'time@10': 10.5457}:  80%|████████  | 8/10 [01:08<00:16,  8.29s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9324, 'compress@10': 0.5764, 'time@10': 10.5457}:  90%|█████████ | 9/10 [01:08<00:07,  7.50s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.936, 'compress@10': 0.5259, 'time@10': 10.5814}:  90%|█████████ | 9/10 [01:19<00:07,  7.50s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.936, 'compress@10': 0.5259, 'time@10': 10.5814}: 100%|██████████| 10/10 [01:19<00:00,  8.56s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.936, 'compress@10': 0.5259, 'time@10': 10.5814}: 100%|██████████| 10/10 [01:19<00:00,  7.97s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.01759443322063941
Avg hit ratio: 0.8911958096610049
Avg ndcg: 0.9359882477248347
Avg compression ratio: 0.5258844570046489
Avg train time: 10.581446146965027
Std train time: 0.3808673516285235
[0.8225806451612901, 0.5322580645161291, 0.048387096774193554, 0.46774193548387105, 0.9516129032258064, 0.6290322580645162, 0.5, 0.40322580645161293, 0.5967741935483871, 0.048387096774193554]
[14, 15, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8959, 'compress@10': 0.8319, 'time@10': 10.8936}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8959, 'compress@10': 0.8319, 'time@10': 10.8936}:  10%|█         | 1/10 [00:05<00:49,  5.48s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9406, 'compress@10': 0.6896, 'time@10': 10.7177}:  10%|█         | 1/10 [00:16<00:49,  5.48s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9406, 'compress@10': 0.6896, 'time@10': 10.7177}:  20%|██        | 2/10 [00:16<01:07,  8.48s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9128, 'compress@10': 0.5212, 'time@10': 10.5774}:  20%|██        | 2/10 [00:21<01:07,  8.48s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9128, 'compress@10': 0.5212, 'time@10': 10.5774}:  30%|███       | 3/10 [00:21<00:48,  6.98s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9252, 'compress@10': 0.5126, 'time@10': 10.5166}:  30%|███       | 3/10 [00:31<00:48,  6.98s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9252, 'compress@10': 0.5126, 'time@10': 10.5166}:  40%|████      | 4/10 [00:31<00:49,  8.32s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9055, 'compress@10': 0.6006, 'time@10': 10.5521}:  40%|████      | 4/10 [00:37<00:49,  8.32s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9055, 'compress@10': 0.6006, 'time@10': 10.5521}:  50%|█████     | 5/10 [00:37<00:36,  7.26s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9192, 'compress@10': 0.6067, 'time@10': 10.5282}:  50%|█████     | 5/10 [00:47<00:36,  7.26s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9192, 'compress@10': 0.6067, 'time@10': 10.5282}:  60%|██████    | 6/10 [00:47<00:33,  8.34s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0171, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9225, 'compress@10': 0.5943, 'time@10': 10.5096}:  60%|██████    | 6/10 [00:52<00:33,  8.34s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0171, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9225, 'compress@10': 0.5943, 'time@10': 10.5096}:  70%|███████   | 7/10 [00:52<00:21,  7.33s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9182, 'compress@10': 0.5726, 'time@10': 10.4928}:  70%|███████   | 7/10 [01:03<00:21,  7.33s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9182, 'compress@10': 0.5726, 'time@10': 10.4928}:  80%|████████  | 8/10 [01:03<00:16,  8.31s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9205, 'compress@10': 0.5765, 'time@10': 10.5934}:  80%|████████  | 8/10 [01:08<00:16,  8.31s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9205, 'compress@10': 0.5765, 'time@10': 10.5934}:  90%|█████████ | 9/10 [01:08<00:07,  7.50s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9257, 'compress@10': 0.5259, 'time@10': 10.6005}:  90%|█████████ | 9/10 [01:19<00:07,  7.50s/it]    {'epoch': 30, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9257, 'compress@10': 0.5259, 'time@10': 10.6005}: 100%|██████████| 10/10 [01:19<00:00,  8.49s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9257, 'compress@10': 0.5259, 'time@10': 10.6005}: 100%|██████████| 10/10 [01:19<00:00,  7.95s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.016958104438770327
Avg hit ratio: 0.9051359018269036
Avg ndcg: 0.9257102224598036
Avg compression ratio: 0.5258758933739637
Avg train time: 10.600486969947815
Std train time: 0.32109499587043155
[0.7968749999999998, 0.5468750000000001, 0.04687500000000001, 0.45312500000000006, 0.9531249999999999, 0.6406250000000001, 0.484375, 0.421875, 0.609375, 0.04687500000000001]
[14, 15, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8935, 'compress@10': 0.8076, 'time@10': 10.6819}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8935, 'compress@10': 0.8076, 'time@10': 10.6819}:  10%|█         | 1/10 [00:05<00:48,  5.38s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9357, 'compress@10': 0.6845, 'time@10': 10.8112}:  10%|█         | 1/10 [00:16<00:48,  5.38s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9357, 'compress@10': 0.6845, 'time@10': 10.8112}:  20%|██        | 2/10 [00:16<01:09,  8.67s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9095, 'compress@10': 0.5174, 'time@10': 10.5977}:  20%|██        | 2/10 [00:21<01:09,  8.67s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9095, 'compress@10': 0.5174, 'time@10': 10.5977}:  30%|███       | 3/10 [00:21<00:49,  7.05s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9446, 'compress@10': 0.5062, 'time@10': 10.4954}:  30%|███       | 3/10 [00:31<00:49,  7.05s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9446, 'compress@10': 0.5062, 'time@10': 10.4954}:  40%|████      | 4/10 [00:31<00:49,  8.30s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9227, 'compress@10': 0.5958, 'time@10': 10.5151}:  40%|████      | 4/10 [00:37<00:49,  8.30s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9227, 'compress@10': 0.5958, 'time@10': 10.5151}:  50%|█████     | 5/10 [00:37<00:36,  7.23s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0174, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9304, 'compress@10': 0.6046, 'time@10': 10.4987}:  50%|█████     | 5/10 [00:47<00:36,  7.23s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0174, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9304, 'compress@10': 0.6046, 'time@10': 10.4987}:  60%|██████    | 6/10 [00:47<00:33,  8.33s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0169, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9326, 'compress@10': 0.5903, 'time@10': 10.4928}:  60%|██████    | 6/10 [00:52<00:33,  8.33s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0169, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9326, 'compress@10': 0.5903, 'time@10': 10.4928}:  70%|███████   | 7/10 [00:52<00:21,  7.33s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.9363, 'compress@10': 0.5713, 'time@10': 10.5284}:  70%|███████   | 7/10 [01:03<00:21,  7.33s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.9363, 'compress@10': 0.5713, 'time@10': 10.5284}:  80%|████████  | 8/10 [01:03<00:16,  8.44s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9362, 'compress@10': 0.5768, 'time@10': 10.6427}:  80%|████████  | 8/10 [01:09<00:16,  8.44s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9362, 'compress@10': 0.5768, 'time@10': 10.6427}:  90%|█████████ | 9/10 [01:09<00:07,  7.62s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9399, 'compress@10': 0.526, 'time@10': 10.6677}:  90%|█████████ | 9/10 [01:20<00:07,  7.62s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9399, 'compress@10': 0.526, 'time@10': 10.6677}: 100%|██████████| 10/10 [01:20<00:00,  8.64s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9399, 'compress@10': 0.526, 'time@10': 10.6677}: 100%|██████████| 10/10 [01:20<00:00,  8.03s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.016150712442694032
Avg hit ratio: 0.9057708224618242
Avg ndcg: 0.9399274434998579
Avg compression ratio: 0.5259860441859622
Avg train time: 10.667713308334351
Std train time: 0.3895511080002441
[0.7727272727272725, 0.5606060606060607, 0.04545454545454546, 0.4696969696969697, 0.9545454545454545, 0.6212121212121213, 0.4696969696969697, 0.4090909090909091, 0.6212121212121212, 0.07575757575757576]
[14, 15, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9069, 'compress@10': 0.7847, 'time@10': 12.0226}:   0%|          | 0/10 [00:06<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9069, 'compress@10': 0.7847, 'time@10': 12.0226}:  10%|█         | 1/10 [00:06<00:54,  6.05s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9479, 'compress@10': 0.6797, 'time@10': 11.3841}:  10%|█         | 1/10 [00:16<00:54,  6.05s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9479, 'compress@10': 0.6797, 'time@10': 11.3841}:  20%|██        | 2/10 [00:16<01:10,  8.83s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9177, 'compress@10': 0.5138, 'time@10': 11.0675}:  20%|██        | 2/10 [00:22<01:10,  8.83s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9177, 'compress@10': 0.5138, 'time@10': 11.0675}:  30%|███       | 3/10 [00:22<00:50,  7.20s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9293, 'compress@10': 0.5075, 'time@10': 10.8664}:  30%|███       | 3/10 [00:32<00:50,  7.20s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9293, 'compress@10': 0.5075, 'time@10': 10.8664}:  40%|████      | 4/10 [00:32<00:50,  8.42s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9121, 'compress@10': 0.5971, 'time@10': 10.7867}:  40%|████      | 4/10 [00:37<00:50,  8.42s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9121, 'compress@10': 0.5971, 'time@10': 10.7867}:  50%|█████     | 5/10 [00:37<00:36,  7.29s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9217, 'compress@10': 0.6025, 'time@10': 10.7541}:  50%|█████     | 5/10 [00:48<00:36,  7.29s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9217, 'compress@10': 0.6025, 'time@10': 10.7541}:  60%|██████    | 6/10 [00:48<00:33,  8.42s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9251, 'compress@10': 0.5866, 'time@10': 10.685}:  60%|██████    | 6/10 [00:53<00:33,  8.42s/it] {'epoch': 32, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9251, 'compress@10': 0.5866, 'time@10': 10.685}:  70%|███████   | 7/10 [00:53<00:22,  7.36s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0166, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.9489, 'compress@10': 0.5665, 'time@10': 10.6362}:  70%|███████   | 7/10 [01:03<00:22,  7.36s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0166, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.9489, 'compress@10': 0.5665, 'time@10': 10.6362}:  80%|████████  | 8/10 [01:03<00:16,  8.31s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9481, 'compress@10': 0.5738, 'time@10': 10.7183}:  80%|████████  | 8/10 [01:09<00:16,  8.31s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9481, 'compress@10': 0.5738, 'time@10': 10.7183}:  90%|█████████ | 9/10 [01:09<00:07,  7.50s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9509, 'compress@10': 0.5261, 'time@10': 10.7027}:  90%|█████████ | 9/10 [01:20<00:07,  7.50s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9509, 'compress@10': 0.5261, 'time@10': 10.7027}: 100%|██████████| 10/10 [01:20<00:00,  8.46s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9509, 'compress@10': 0.5261, 'time@10': 10.7027}: 100%|██████████| 10/10 [01:20<00:00,  8.01s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.01583118679391096
Avg hit ratio: 0.9057708224618242
Avg ndcg: 0.9508747983705673
Avg compression ratio: 0.5260676682403634
Avg train time: 10.702652430534362
Std train time: 0.5387179071083221
[0.7499999999999998, 0.573529411764706, 0.04411764705882354, 0.4558823529411765, 0.9558823529411764, 0.6029411764705883, 0.4852941176470589, 0.42647058823529416, 0.6323529411764706, 0.07352941176470588]
[13, 15, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.7632, 'time@10': 10.5302}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.7632, 'time@10': 10.5302}:  10%|█         | 1/10 [00:05<00:47,  5.30s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9486, 'compress@10': 0.6752, 'time@10': 10.641}:  10%|█         | 1/10 [00:16<00:47,  5.30s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9486, 'compress@10': 0.6752, 'time@10': 10.641}:  20%|██        | 2/10 [00:16<01:08,  8.53s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9181, 'compress@10': 0.5104, 'time@10': 10.3343}:  20%|██        | 2/10 [00:20<01:08,  8.53s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9181, 'compress@10': 0.5104, 'time@10': 10.3343}:  30%|███       | 3/10 [00:20<00:48,  6.87s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9442, 'compress@10': 0.5016, 'time@10': 10.2904}:  30%|███       | 3/10 [00:31<00:48,  6.87s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9442, 'compress@10': 0.5016, 'time@10': 10.2904}:  40%|████      | 4/10 [00:31<00:49,  8.18s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.9255, 'compress@10': 0.5926, 'time@10': 10.347}:  40%|████      | 4/10 [00:36<00:49,  8.18s/it] {'epoch': 33, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.9255, 'compress@10': 0.5926, 'time@10': 10.347}:  50%|█████     | 5/10 [00:36<00:35,  7.15s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9328, 'compress@10': 0.5958, 'time@10': 10.3606}:  50%|█████     | 5/10 [00:46<00:35,  7.15s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9328, 'compress@10': 0.5958, 'time@10': 10.3606}:  60%|██████    | 6/10 [00:46<00:33,  8.28s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9344, 'compress@10': 0.583, 'time@10': 10.3561}:  60%|██████    | 6/10 [00:52<00:33,  8.28s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9344, 'compress@10': 0.583, 'time@10': 10.3561}:  70%|███████   | 7/10 [00:52<00:21,  7.28s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9424, 'compress@10': 0.5655, 'time@10': 10.4}:  70%|███████   | 7/10 [01:02<00:21,  7.28s/it]   {'epoch': 33, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9424, 'compress@10': 0.5655, 'time@10': 10.4}:  80%|████████  | 8/10 [01:02<00:16,  8.38s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9424, 'compress@10': 0.5741, 'time@10': 10.501}:  80%|████████  | 8/10 [01:08<00:16,  8.38s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9424, 'compress@10': 0.5741, 'time@10': 10.501}:  90%|█████████ | 9/10 [01:08<00:07,  7.54s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9459, 'compress@10': 0.5261, 'time@10': 10.5152}:  90%|█████████ | 9/10 [01:19<00:07,  7.54s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9459, 'compress@10': 0.5261, 'time@10': 10.5152}: 100%|██████████| 10/10 [01:19<00:00,  8.51s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9459, 'compress@10': 0.5261, 'time@10': 10.5152}: 100%|██████████| 10/10 [01:19<00:00,  7.93s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.01835894531251001
Avg hit ratio: 0.8989735874387828
Avg ndcg: 0.9459494595903184
Avg compression ratio: 0.5261124172149585
Avg train time: 10.515201330184937
Std train time: 0.3928520445033948
[0.7285714285714283, 0.5857142857142857, 0.042857142857142864, 0.4714285714285715, 0.9571428571428571, 0.5857142857142857, 0.4714285714285715, 0.4428571428571429, 0.6428571428571428, 0.07142857142857142]
[13, 15, 39, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9217, 'compress@10': 0.7428, 'time@10': 10.5859}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9217, 'compress@10': 0.7428, 'time@10': 10.5859}:  10%|█         | 1/10 [00:05<00:47,  5.33s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9465, 'compress@10': 0.671, 'time@10': 10.757}:  10%|█         | 1/10 [00:16<00:47,  5.33s/it]  {'epoch': 34, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9465, 'compress@10': 0.671, 'time@10': 10.757}:  20%|██        | 2/10 [00:16<01:09,  8.64s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9167, 'compress@10': 0.5072, 'time@10': 10.6558}:  20%|██        | 2/10 [00:21<01:09,  8.64s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9167, 'compress@10': 0.5072, 'time@10': 10.6558}:  30%|███       | 3/10 [00:21<00:49,  7.10s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9286, 'compress@10': 0.503, 'time@10': 10.6103}:  30%|███       | 3/10 [00:32<00:49,  7.10s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9286, 'compress@10': 0.503, 'time@10': 10.6103}:  40%|████      | 4/10 [00:32<00:50,  8.45s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9135, 'compress@10': 0.594, 'time@10': 10.6233}:  40%|████      | 4/10 [00:37<00:50,  8.45s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9135, 'compress@10': 0.594, 'time@10': 10.6233}:  50%|█████     | 5/10 [00:37<00:36,  7.34s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.923, 'compress@10': 0.5941, 'time@10': 10.6216}:  50%|█████     | 5/10 [00:48<00:36,  7.34s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.923, 'compress@10': 0.5941, 'time@10': 10.6216}:  60%|██████    | 6/10 [00:48<00:33,  8.47s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.9217, 'ndcg@10': 0.9266, 'compress@10': 0.5796, 'time@10': 10.5756}:  60%|██████    | 6/10 [00:53<00:33,  8.47s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.9217, 'ndcg@10': 0.9266, 'compress@10': 0.5796, 'time@10': 10.5756}:  70%|███████   | 7/10 [00:53<00:22,  7.39s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.9279, 'ndcg@10': 0.9313, 'compress@10': 0.5645, 'time@10': 10.5636}:  70%|███████   | 7/10 [01:03<00:22,  7.39s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.9279, 'ndcg@10': 0.9313, 'compress@10': 0.5645, 'time@10': 10.5636}:  80%|████████  | 8/10 [01:03<00:16,  8.39s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.92, 'ndcg@10': 0.9324, 'compress@10': 0.5743, 'time@10': 10.6615}:  80%|████████  | 8/10 [01:09<00:16,  8.39s/it] {'epoch': 34, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.92, 'ndcg@10': 0.9324, 'compress@10': 0.5743, 'time@10': 10.6615}:  90%|█████████ | 9/10 [01:09<00:07,  7.57s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9258, 'ndcg@10': 0.9368, 'compress@10': 0.5262, 'time@10': 10.6637}:  90%|█████████ | 9/10 [01:20<00:07,  7.57s/it] {'epoch': 34, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9258, 'ndcg@10': 0.9368, 'compress@10': 0.5262, 'time@10': 10.6637}: 100%|██████████| 10/10 [01:20<00:00,  8.54s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9258, 'ndcg@10': 0.9368, 'compress@10': 0.5262, 'time@10': 10.6637}: 100%|██████████| 10/10 [01:20<00:00,  8.03s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.011279981697548644
Avg hit ratio: 0.9257708224618242
Avg ndcg: 0.9368253911895028
Avg compression ratio: 0.5261658017859268
Avg train time: 10.663706040382385
Std train time: 0.3058489616679356
[0.708333333333333, 0.5972222222222222, 0.04166666666666667, 0.45833333333333337, 0.9583333333333333, 0.5972222222222222, 0.48611111111111116, 0.4305555555555556, 0.6527777777777777, 0.06944444444444445]
[13, 15, 39, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.937, 'compress@10': 0.7237, 'time@10': 10.5225}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.937, 'compress@10': 0.7237, 'time@10': 10.5225}:  10%|█         | 1/10 [00:05<00:47,  5.31s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9575, 'compress@10': 0.6669, 'time@10': 10.7459}:  10%|█         | 1/10 [00:16<00:47,  5.31s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9575, 'compress@10': 0.6669, 'time@10': 10.7459}:  20%|██        | 2/10 [00:16<01:09,  8.66s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.924, 'compress@10': 0.5042, 'time@10': 10.6095}:  20%|██        | 2/10 [00:21<01:09,  8.66s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.924, 'compress@10': 0.5042, 'time@10': 10.6095}:  30%|███       | 3/10 [00:21<00:49,  7.08s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9621, 'compress@10': 0.4975, 'time@10': 10.5698}:  30%|███       | 3/10 [00:32<00:49,  7.08s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9621, 'compress@10': 0.4975, 'time@10': 10.5698}:  40%|████      | 4/10 [00:32<00:50,  8.43s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.9417, 'compress@10': 0.5899, 'time@10': 10.6501}:  40%|████      | 4/10 [00:37<00:50,  8.43s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.9417, 'compress@10': 0.5899, 'time@10': 10.6501}:  50%|█████     | 5/10 [00:37<00:36,  7.38s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0156, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.947, 'compress@10': 0.5926, 'time@10': 10.6226}:  50%|█████     | 5/10 [00:48<00:36,  7.38s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0156, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.947, 'compress@10': 0.5926, 'time@10': 10.6226}:  60%|██████    | 6/10 [00:48<00:33,  8.45s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9471, 'compress@10': 0.5803, 'time@10': 10.5526}:  60%|██████    | 6/10 [00:53<00:33,  8.45s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9471, 'compress@10': 0.5803, 'time@10': 10.5526}:  70%|███████   | 7/10 [00:53<00:22,  7.36s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.95, 'compress@10': 0.5636, 'time@10': 10.5514}:  70%|███████   | 7/10 [01:03<00:22,  7.36s/it]  {'epoch': 35, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.95, 'compress@10': 0.5636, 'time@10': 10.5514}:  80%|████████  | 8/10 [01:03<00:16,  8.38s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9487, 'compress@10': 0.5746, 'time@10': 10.6536}:  80%|████████  | 8/10 [01:09<00:16,  8.38s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9487, 'compress@10': 0.5746, 'time@10': 10.6536}:  90%|█████████ | 9/10 [01:09<00:07,  7.57s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.953, 'compress@10': 0.5262, 'time@10': 10.6558}:  90%|█████████ | 9/10 [01:20<00:07,  7.57s/it]    {'epoch': 35, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.953, 'compress@10': 0.5262, 'time@10': 10.6558}: 100%|██████████| 10/10 [01:20<00:00,  8.55s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.953, 'compress@10': 0.5262, 'time@10': 10.6558}: 100%|██████████| 10/10 [01:20<00:00,  8.03s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.013906120867844554
Avg hit ratio: 0.9040529525181478
Avg ndcg: 0.9529805703816029
Avg compression ratio: 0.5262245519463822
Avg train time: 10.655798506736755
Std train time: 0.3659828699917825
[0.6891891891891889, 0.6081081081081081, 0.04054054054054054, 0.472972972972973, 0.9594594594594594, 0.581081081081081, 0.472972972972973, 0.41891891891891897, 0.6621621621621621, 0.0945945945945946]
[13, 15, 39, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.937, 'compress@10': 0.7055, 'time@10': 10.5926}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.937, 'compress@10': 0.7055, 'time@10': 10.5926}:  10%|█         | 1/10 [00:05<00:47,  5.33s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9564, 'compress@10': 0.6631, 'time@10': 10.7458}:  10%|█         | 1/10 [00:16<00:47,  5.33s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9564, 'compress@10': 0.6631, 'time@10': 10.7458}:  20%|██        | 2/10 [00:16<01:09,  8.63s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9233, 'compress@10': 0.5013, 'time@10': 10.5824}:  20%|██        | 2/10 [00:21<01:09,  8.63s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9233, 'compress@10': 0.5013, 'time@10': 10.5824}:  30%|███       | 3/10 [00:21<00:49,  7.05s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9335, 'compress@10': 0.4989, 'time@10': 10.6411}:  30%|███       | 3/10 [00:32<00:49,  7.05s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9335, 'compress@10': 0.4989, 'time@10': 10.6411}:  40%|████      | 4/10 [00:32<00:51,  8.55s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9197, 'compress@10': 0.5912, 'time@10': 10.642}:  40%|████      | 4/10 [00:37<00:51,  8.55s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9197, 'compress@10': 0.5912, 'time@10': 10.642}:  50%|█████     | 5/10 [00:37<00:36,  7.40s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9285, 'compress@10': 0.5911, 'time@10': 10.6298}:  50%|█████     | 5/10 [00:48<00:36,  7.40s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9285, 'compress@10': 0.5911, 'time@10': 10.6298}:  60%|██████    | 6/10 [00:48<00:33,  8.49s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9313, 'compress@10': 0.5772, 'time@10': 10.5506}:  60%|██████    | 6/10 [00:53<00:33,  8.49s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9313, 'compress@10': 0.5772, 'time@10': 10.5506}:  70%|███████   | 7/10 [00:53<00:22,  7.37s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9297, 'compress@10': 0.5595, 'time@10': 10.5458}:  70%|███████   | 7/10 [01:03<00:22,  7.37s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9297, 'compress@10': 0.5595, 'time@10': 10.5458}:  80%|████████  | 8/10 [01:03<00:16,  8.39s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9306, 'compress@10': 0.572, 'time@10': 10.6195}:  80%|████████  | 8/10 [01:09<00:16,  8.39s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9306, 'compress@10': 0.572, 'time@10': 10.6195}:  90%|█████████ | 9/10 [01:09<00:07,  7.53s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9351, 'compress@10': 0.5263, 'time@10': 10.6609}:  90%|█████████ | 9/10 [01:20<00:07,  7.53s/it]  {'epoch': 36, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9351, 'compress@10': 0.5263, 'time@10': 10.6609}: 100%|██████████| 10/10 [01:20<00:00,  8.62s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9351, 'compress@10': 0.5263, 'time@10': 10.6609}: 100%|██████████| 10/10 [01:20<00:00,  8.06s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.01209508066227224
Avg hit ratio: 0.9045450160102112
Avg ndcg: 0.9351365676927308
Avg compression ratio: 0.5262888100932452
Avg train time: 10.660949301719665
Std train time: 0.32605139996170945
[0.6710526315789471, 0.618421052631579, 0.03947368421052632, 0.46052631578947373, 0.9605263157894737, 0.5921052631578947, 0.46052631578947373, 0.43421052631578955, 0.6710526315789472, 0.09210526315789475]
[13, 15, 39, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9417, 'compress@10': 0.6884, 'time@10': 11.5446}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9417, 'compress@10': 0.6884, 'time@10': 11.5446}:  10%|█         | 1/10 [00:05<00:52,  5.81s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9456, 'compress@10': 0.6595, 'time@10': 11.2585}:  10%|█         | 1/10 [00:16<00:52,  5.81s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9456, 'compress@10': 0.6595, 'time@10': 11.2585}:  20%|██        | 2/10 [00:16<01:10,  8.87s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9161, 'compress@10': 0.4986, 'time@10': 11.0288}:  20%|██        | 2/10 [00:22<01:10,  8.87s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9161, 'compress@10': 0.4986, 'time@10': 11.0288}:  30%|███       | 3/10 [00:22<00:50,  7.25s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9523, 'compress@10': 0.4939, 'time@10': 10.8708}:  30%|███       | 3/10 [00:32<00:50,  7.25s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9523, 'compress@10': 0.4939, 'time@10': 10.8708}:  40%|████      | 4/10 [00:32<00:51,  8.51s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.9177, 'ndcg@10': 0.9351, 'compress@10': 0.5874, 'time@10': 10.8421}:  40%|████      | 4/10 [00:37<00:51,  8.51s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.9177, 'ndcg@10': 0.9351, 'compress@10': 0.5874, 'time@10': 10.8421}:  50%|█████     | 5/10 [00:37<00:36,  7.39s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.924, 'ndcg@10': 0.942, 'compress@10': 0.5897, 'time@10': 10.7847}:  50%|█████     | 5/10 [00:48<00:36,  7.39s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.924, 'ndcg@10': 0.942, 'compress@10': 0.5897, 'time@10': 10.7847}:  60%|██████    | 6/10 [00:48<00:33,  8.46s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.9292, 'ndcg@10': 0.9433, 'compress@10': 0.5743, 'time@10': 10.7148}:  60%|██████    | 6/10 [00:53<00:33,  8.46s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.9292, 'ndcg@10': 0.9433, 'compress@10': 0.5743, 'time@10': 10.7148}:  70%|███████   | 7/10 [00:53<00:22,  7.39s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9344, 'ndcg@10': 0.9455, 'compress@10': 0.5588, 'time@10': 10.6832}:  70%|███████   | 7/10 [01:04<00:22,  7.39s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9344, 'ndcg@10': 0.9455, 'compress@10': 0.5588, 'time@10': 10.6832}:  80%|████████  | 8/10 [01:04<00:16,  8.38s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.9195, 'ndcg@10': 0.9446, 'compress@10': 0.5723, 'time@10': 10.7454}:  80%|████████  | 8/10 [01:09<00:16,  8.38s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.9195, 'ndcg@10': 0.9446, 'compress@10': 0.5723, 'time@10': 10.7454}:  90%|█████████ | 9/10 [01:09<00:07,  7.53s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.95, 'compress@10': 0.5264, 'time@10': 10.771}:  90%|█████████ | 9/10 [01:20<00:07,  7.53s/it]      {'epoch': 37, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.95, 'compress@10': 0.5264, 'time@10': 10.771}: 100%|██████████| 10/10 [01:20<00:00,  8.61s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.95, 'compress@10': 0.5264, 'time@10': 10.771}: 100%|██████████| 10/10 [01:20<00:00,  8.09s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.015447352435337408
Avg hit ratio: 0.9252823431991514
Avg ndcg: 0.9499669540042406
Avg compression ratio: 0.5263707405369045
Avg train time: 10.771037673950195
Std train time: 0.38655862469379504
[0.6538461538461536, 0.6282051282051282, 0.038461538461538464, 0.4743589743589744, 0.9615384615384616, 0.5769230769230769, 0.4487179487179488, 0.42307692307692313, 0.6794871794871794, 0.11538461538461539]
[13, 15, 39, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9417, 'compress@10': 0.6721, 'time@10': 11.8808}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9417, 'compress@10': 0.6721, 'time@10': 11.8808}:  10%|█         | 1/10 [00:05<00:53,  5.98s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9851, 'compress@10': 0.6561, 'time@10': 11.2487}:  10%|█         | 1/10 [00:16<00:53,  5.98s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9851, 'compress@10': 0.6561, 'time@10': 11.2487}:  20%|██        | 2/10 [00:16<01:09,  8.73s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9425, 'compress@10': 0.496, 'time@10': 10.9545}:  20%|██        | 2/10 [00:21<01:09,  8.73s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9425, 'compress@10': 0.496, 'time@10': 10.9545}:  30%|███       | 3/10 [00:21<00:49,  7.13s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9479, 'compress@10': 0.4953, 'time@10': 10.7568}:  30%|███       | 3/10 [00:32<00:49,  7.13s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9479, 'compress@10': 0.4953, 'time@10': 10.7568}:  40%|████      | 4/10 [00:32<00:50,  8.34s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9322, 'compress@10': 0.5887, 'time@10': 10.7971}:  40%|████      | 4/10 [00:37<00:50,  8.34s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9322, 'compress@10': 0.5887, 'time@10': 10.7971}:  50%|█████     | 5/10 [00:37<00:36,  7.32s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9394, 'compress@10': 0.5883, 'time@10': 10.7798}:  50%|█████     | 5/10 [00:48<00:36,  7.32s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9394, 'compress@10': 0.5883, 'time@10': 10.7798}:  60%|██████    | 6/10 [00:48<00:33,  8.48s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0124, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9409, 'compress@10': 0.5715, 'time@10': 10.6872}:  60%|██████    | 6/10 [00:53<00:33,  8.48s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0124, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9409, 'compress@10': 0.5715, 'time@10': 10.6872}:  70%|███████   | 7/10 [00:53<00:22,  7.38s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9689, 'compress@10': 0.555, 'time@10': 10.6897}:  70%|███████   | 7/10 [01:04<00:22,  7.38s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9689, 'compress@10': 0.555, 'time@10': 10.6897}:  80%|████████  | 8/10 [01:04<00:16,  8.45s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9654, 'compress@10': 0.5699, 'time@10': 10.7571}:  80%|████████  | 8/10 [01:09<00:16,  8.45s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9654, 'compress@10': 0.5699, 'time@10': 10.7571}:  90%|█████████ | 9/10 [01:09<00:07,  7.59s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9665, 'compress@10': 0.5264, 'time@10': 10.7814}:  90%|█████████ | 9/10 [01:20<00:07,  7.59s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9665, 'compress@10': 0.5264, 'time@10': 10.7814}: 100%|██████████| 10/10 [01:20<00:00,  8.66s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9665, 'compress@10': 0.5264, 'time@10': 10.7814}: 100%|██████████| 10/10 [01:20<00:00,  8.09s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.01451606776699497
Avg hit ratio: 0.8970565367475384
Avg ndcg: 0.9664870631485938
Avg compression ratio: 0.5264286174142003
Avg train time: 10.781422567367553
Std train time: 0.5068499350523127
[0.6374999999999998, 0.6375, 0.037500000000000006, 0.4625, 0.9625, 0.5625, 0.4625000000000001, 0.43750000000000006, 0.6874999999999999, 0.1125]
[13, 15, 39, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9444, 'compress@10': 0.6566, 'time@10': 11.2831}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9444, 'compress@10': 0.6566, 'time@10': 11.2831}:  10%|█         | 1/10 [00:05<00:51,  5.69s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9561, 'compress@10': 0.6529, 'time@10': 10.9477}:  10%|█         | 1/10 [00:16<00:51,  5.69s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9561, 'compress@10': 0.6529, 'time@10': 10.9477}:  20%|██        | 2/10 [00:16<01:08,  8.61s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9231, 'compress@10': 0.4936, 'time@10': 10.7094}:  20%|██        | 2/10 [00:21<01:08,  8.61s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9231, 'compress@10': 0.4936, 'time@10': 10.7094}:  30%|███       | 3/10 [00:21<00:49,  7.03s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9593, 'compress@10': 0.4906, 'time@10': 10.6151}:  30%|███       | 3/10 [00:31<00:49,  7.03s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9593, 'compress@10': 0.4906, 'time@10': 10.6151}:  40%|████      | 4/10 [00:31<00:50,  8.35s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.9431, 'compress@10': 0.5851, 'time@10': 10.6189}:  40%|████      | 4/10 [00:37<00:50,  8.35s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.9431, 'compress@10': 0.5851, 'time@10': 10.6189}:  50%|█████     | 5/10 [00:37<00:36,  7.27s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.9214, 'ndcg@10': 0.9489, 'compress@10': 0.583, 'time@10': 10.6151}:  50%|█████     | 5/10 [00:47<00:36,  7.27s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.9214, 'ndcg@10': 0.9489, 'compress@10': 0.583, 'time@10': 10.6151}:  60%|██████    | 6/10 [00:47<00:33,  8.41s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.9269, 'ndcg@10': 0.9491, 'compress@10': 0.5688, 'time@10': 10.581}:  60%|██████    | 6/10 [00:53<00:33,  8.41s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.9269, 'ndcg@10': 0.9491, 'compress@10': 0.5688, 'time@10': 10.581}:  70%|███████   | 7/10 [00:53<00:22,  7.37s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.9325, 'ndcg@10': 0.954, 'compress@10': 0.5544, 'time@10': 10.5526}:  70%|███████   | 7/10 [01:03<00:22,  7.37s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.9325, 'ndcg@10': 0.954, 'compress@10': 0.5544, 'time@10': 10.5526}:  80%|████████  | 8/10 [01:03<00:16,  8.33s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9523, 'compress@10': 0.5702, 'time@10': 10.6468}:  80%|████████  | 8/10 [01:09<00:16,  8.33s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9523, 'compress@10': 0.5702, 'time@10': 10.6468}:  90%|█████████ | 9/10 [01:09<00:07,  7.52s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.9237, 'ndcg@10': 0.9562, 'compress@10': 0.5265, 'time@10': 10.6742}:  90%|█████████ | 9/10 [01:20<00:07,  7.52s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.9237, 'ndcg@10': 0.9562, 'compress@10': 0.5265, 'time@10': 10.6742}: 100%|██████████| 10/10 [01:20<00:00,  8.58s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.9237, 'ndcg@10': 0.9562, 'compress@10': 0.5265, 'time@10': 10.6742}: 100%|██████████| 10/10 [01:20<00:00,  8.02s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.015484678783094685
Avg hit ratio: 0.9237109146277227
Avg ndcg: 0.9562136772061042
Avg compression ratio: 0.5264578944531377
Avg train time: 10.674226975440979
Std train time: 0.3839682756490836
[0.621951219512195, 0.6219512195121951, 0.03658536585365854, 0.475609756097561, 0.9634146341463414, 0.5487804878048781, 0.451219512195122, 0.451219512195122, 0.695121951219512, 0.13414634146341464]
[13, 15, 39, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6418, 'time@10': 11.2174}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6418, 'time@10': 11.2174}:  10%|█         | 1/10 [00:05<00:50,  5.65s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.638, 'time@10': 10.9097}:  10%|█         | 1/10 [00:16<00:50,  5.65s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.638, 'time@10': 10.9097}:  20%|██        | 2/10 [00:16<01:08,  8.58s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.4834, 'time@10': 10.5587}:  20%|██        | 2/10 [00:21<01:08,  8.58s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9241, 'compress@10': 0.4834, 'time@10': 10.5587}:  30%|███       | 3/10 [00:21<00:48,  6.93s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9341, 'compress@10': 0.4861, 'time@10': 10.5313}:  30%|███       | 3/10 [00:31<00:48,  6.93s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9341, 'compress@10': 0.4861, 'time@10': 10.5313}:  40%|████      | 4/10 [00:31<00:50,  8.33s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9231, 'compress@10': 0.5817, 'time@10': 10.6107}:  40%|████      | 4/10 [00:37<00:50,  8.33s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9231, 'compress@10': 0.5817, 'time@10': 10.6107}:  50%|█████     | 5/10 [00:37<00:36,  7.31s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9318, 'compress@10': 0.5779, 'time@10': 10.627}:  50%|█████     | 5/10 [00:47<00:36,  7.31s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9318, 'compress@10': 0.5779, 'time@10': 10.627}:  60%|██████    | 6/10 [00:47<00:33,  8.48s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9348, 'compress@10': 0.563, 'time@10': 10.6204}:  60%|██████    | 6/10 [00:53<00:33,  8.48s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9348, 'compress@10': 0.563, 'time@10': 10.6204}:  70%|███████   | 7/10 [00:53<00:22,  7.45s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9388, 'compress@10': 0.5509, 'time@10': 10.6096}:  70%|███████   | 7/10 [01:03<00:22,  7.45s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9388, 'compress@10': 0.5509, 'time@10': 10.6096}:  80%|████████  | 8/10 [01:03<00:16,  8.44s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9406, 'compress@10': 0.5679, 'time@10': 10.6707}:  80%|████████  | 8/10 [01:09<00:16,  8.44s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9406, 'compress@10': 0.5679, 'time@10': 10.6707}:  90%|█████████ | 9/10 [01:09<00:07,  7.56s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9443, 'compress@10': 0.5265, 'time@10': 10.6925}:  90%|█████████ | 9/10 [01:20<00:07,  7.56s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9443, 'compress@10': 0.5265, 'time@10': 10.6925}: 100%|██████████| 10/10 [01:20<00:00,  8.60s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9443, 'compress@10': 0.5265, 'time@10': 10.6925}: 100%|██████████| 10/10 [01:20<00:00,  8.04s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.009380017876114161
Avg hit ratio: 0.902627965318967
Avg ndcg: 0.9443111044568893
Avg compression ratio: 0.5265207615930283
Avg train time: 10.6924617767334
Std train time: 0.37309588368113794
[0.607142857142857, 0.6309523809523809, 0.03571428571428572, 0.4642857142857143, 0.9642857142857143, 0.5357142857142858, 0.46428571428571436, 0.46428571428571436, 0.7023809523809522, 0.13095238095238096]
[13, 15, 39, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6278, 'time@10': 10.9557}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6278, 'time@10': 10.9557}:  10%|█         | 1/10 [00:05<00:49,  5.52s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9462, 'compress@10': 0.6353, 'time@10': 10.8334}:  10%|█         | 1/10 [00:16<00:49,  5.52s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9462, 'compress@10': 0.6353, 'time@10': 10.8334}:  20%|██        | 2/10 [00:16<01:08,  8.60s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9165, 'compress@10': 0.4814, 'time@10': 10.6504}:  20%|██        | 2/10 [00:21<01:08,  8.60s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9165, 'compress@10': 0.4814, 'time@10': 10.6504}:  30%|███       | 3/10 [00:21<00:49,  7.04s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9526, 'compress@10': 0.4819, 'time@10': 10.5672}:  30%|███       | 3/10 [00:31<00:49,  7.04s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9526, 'compress@10': 0.4819, 'time@10': 10.5672}:  40%|████      | 4/10 [00:31<00:50,  8.35s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9383, 'compress@10': 0.5785, 'time@10': 10.577}:  40%|████      | 4/10 [00:37<00:50,  8.35s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9383, 'compress@10': 0.5785, 'time@10': 10.577}:  50%|█████     | 5/10 [00:37<00:36,  7.26s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9447, 'compress@10': 0.5731, 'time@10': 10.6036}:  50%|█████     | 5/10 [00:47<00:36,  7.26s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9447, 'compress@10': 0.5731, 'time@10': 10.6036}:  60%|██████    | 6/10 [00:47<00:33,  8.46s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9459, 'compress@10': 0.5606, 'time@10': 10.5368}:  60%|██████    | 6/10 [00:53<00:33,  8.46s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9459, 'compress@10': 0.5606, 'time@10': 10.5368}:  70%|███████   | 7/10 [00:53<00:22,  7.36s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9487, 'compress@10': 0.5505, 'time@10': 10.5551}:  70%|███████   | 7/10 [01:03<00:22,  7.36s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9487, 'compress@10': 0.5505, 'time@10': 10.5551}:  80%|████████  | 8/10 [01:03<00:16,  8.43s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9485, 'compress@10': 0.5683, 'time@10': 10.6128}:  80%|████████  | 8/10 [01:09<00:16,  8.43s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9485, 'compress@10': 0.5683, 'time@10': 10.6128}:  90%|█████████ | 9/10 [01:09<00:07,  7.54s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.903, 'ndcg@10': 0.953, 'compress@10': 0.5265, 'time@10': 10.6386}:  90%|█████████ | 9/10 [01:20<00:07,  7.54s/it]     {'epoch': 41, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.903, 'ndcg@10': 0.953, 'compress@10': 0.5265, 'time@10': 10.6386}: 100%|██████████| 10/10 [01:20<00:00,  8.58s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.903, 'ndcg@10': 0.953, 'compress@10': 0.5265, 'time@10': 10.6386}: 100%|██████████| 10/10 [01:20<00:00,  8.02s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.01421141560911995
Avg hit ratio: 0.9029735874387826
Avg ndcg: 0.9529880800755504
Avg compression ratio: 0.5265463117934497
Avg train time: 10.638616490364075
Std train time: 0.2903913432158738
[0.5930232558139533, 0.6395348837209303, 0.034883720930232565, 0.47674418604651164, 0.9651162790697675, 0.5232558139534884, 0.45348837209302334, 0.45348837209302334, 0.7093023255813952, 0.15116279069767444]
[13, 15, 39, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6144, 'time@10': 10.9244}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6144, 'time@10': 10.9244}:  10%|█         | 1/10 [00:05<00:49,  5.50s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9576, 'compress@10': 0.6328, 'time@10': 10.705}:  10%|█         | 1/10 [00:16<00:49,  5.50s/it] {'epoch': 42, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9576, 'compress@10': 0.6328, 'time@10': 10.705}:  20%|██        | 2/10 [00:16<01:07,  8.45s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9241, 'compress@10': 0.4795, 'time@10': 10.5346}:  20%|██        | 2/10 [00:21<01:07,  8.45s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9241, 'compress@10': 0.4795, 'time@10': 10.5346}:  30%|███       | 3/10 [00:21<00:48,  6.94s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0044, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9341, 'compress@10': 0.4834, 'time@10': 10.4885}:  30%|███       | 3/10 [00:31<00:48,  6.94s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0044, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9341, 'compress@10': 0.4834, 'time@10': 10.4885}:  40%|████      | 4/10 [00:31<00:49,  8.30s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.9217, 'ndcg@10': 0.9246, 'compress@10': 0.5799, 'time@10': 10.5545}:  40%|████      | 4/10 [00:36<00:49,  8.30s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.9217, 'ndcg@10': 0.9246, 'compress@10': 0.5799, 'time@10': 10.5545}:  50%|█████     | 5/10 [00:36<00:36,  7.27s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.9311, 'ndcg@10': 0.9379, 'compress@10': 0.5722, 'time@10': 10.5733}:  50%|█████     | 5/10 [00:47<00:36,  7.27s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.9311, 'ndcg@10': 0.9379, 'compress@10': 0.5722, 'time@10': 10.5733}:  60%|██████    | 6/10 [00:47<00:33,  8.44s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9352, 'ndcg@10': 0.9401, 'compress@10': 0.5584, 'time@10': 10.5332}:  60%|██████    | 6/10 [00:52<00:33,  8.44s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9352, 'ndcg@10': 0.9401, 'compress@10': 0.5584, 'time@10': 10.5332}:  70%|███████   | 7/10 [00:52<00:22,  7.37s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.9397, 'ndcg@10': 0.9542, 'compress@10': 0.5472, 'time@10': 10.5215}:  70%|███████   | 7/10 [01:03<00:22,  7.37s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.9397, 'ndcg@10': 0.9542, 'compress@10': 0.5472, 'time@10': 10.5215}:  80%|████████  | 8/10 [01:03<00:16,  8.36s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.9525, 'compress@10': 0.5662, 'time@10': 10.5639}:  80%|████████  | 8/10 [01:08<00:16,  8.36s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.9525, 'compress@10': 0.5662, 'time@10': 10.5639}:  90%|█████████ | 9/10 [01:08<00:07,  7.46s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9295, 'ndcg@10': 0.955, 'compress@10': 0.5266, 'time@10': 10.5975}:  90%|█████████ | 9/10 [01:19<00:07,  7.46s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9295, 'ndcg@10': 0.955, 'compress@10': 0.5266, 'time@10': 10.5975}: 100%|██████████| 10/10 [01:19<00:00,  8.54s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9295, 'ndcg@10': 0.955, 'compress@10': 0.5266, 'time@10': 10.5975}: 100%|██████████| 10/10 [01:19<00:00,  7.98s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.011728381686540803
Avg hit ratio: 0.9295045654213736
Avg ndcg: 0.954967629475562
Avg compression ratio: 0.526593700281904
Avg train time: 10.597543382644654
Std train time: 0.26465850086430975
[0.5795454545454544, 0.625, 0.034090909090909095, 0.46590909090909094, 0.9659090909090909, 0.5340909090909092, 0.465909090909091, 0.465909090909091, 0.7159090909090907, 0.14772727272727273]
[13, 15, 39, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6017, 'time@10': 11.4482}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.6017, 'time@10': 11.4482}:  10%|█         | 1/10 [00:05<00:51,  5.76s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9518, 'compress@10': 0.6194, 'time@10': 11.0379}:  10%|█         | 1/10 [00:16<00:51,  5.76s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9518, 'compress@10': 0.6194, 'time@10': 11.0379}:  20%|██        | 2/10 [00:16<01:09,  8.65s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9203, 'compress@10': 0.4703, 'time@10': 10.7056}:  20%|██        | 2/10 [00:21<01:09,  8.65s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9203, 'compress@10': 0.4703, 'time@10': 10.7056}:  30%|███       | 3/10 [00:21<00:49,  7.01s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9436, 'compress@10': 0.474, 'time@10': 10.6063}:  30%|███       | 3/10 [00:31<00:49,  7.01s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9436, 'compress@10': 0.474, 'time@10': 10.6063}:  40%|████      | 4/10 [00:31<00:49,  8.33s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0131, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9339, 'compress@10': 0.5725, 'time@10': 10.6003}:  40%|████      | 4/10 [00:37<00:49,  8.33s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0131, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9339, 'compress@10': 0.5725, 'time@10': 10.6003}:  50%|█████     | 5/10 [00:37<00:36,  7.25s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.916, 'ndcg@10': 0.941, 'compress@10': 0.5678, 'time@10': 10.5941}:  50%|█████     | 5/10 [00:47<00:36,  7.25s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.916, 'ndcg@10': 0.941, 'compress@10': 0.5678, 'time@10': 10.5941}:  60%|██████    | 6/10 [00:47<00:33,  8.39s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9223, 'ndcg@10': 0.9428, 'compress@10': 0.5563, 'time@10': 10.5476}:  60%|██████    | 6/10 [00:52<00:33,  8.39s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9223, 'ndcg@10': 0.9428, 'compress@10': 0.5563, 'time@10': 10.5476}:  70%|███████   | 7/10 [00:52<00:22,  7.34s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9284, 'ndcg@10': 0.9524, 'compress@10': 0.5469, 'time@10': 10.4887}:  70%|███████   | 7/10 [01:03<00:22,  7.34s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9284, 'ndcg@10': 0.9524, 'compress@10': 0.5469, 'time@10': 10.4887}:  80%|████████  | 8/10 [01:03<00:16,  8.23s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.9515, 'compress@10': 0.5666, 'time@10': 10.5453}:  80%|████████  | 8/10 [01:08<00:16,  8.23s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.9515, 'compress@10': 0.5666, 'time@10': 10.5453}:  90%|█████████ | 9/10 [01:08<00:07,  7.39s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9555, 'compress@10': 0.5266, 'time@10': 10.5846}:  90%|█████████ | 9/10 [01:19<00:07,  7.39s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9555, 'compress@10': 0.5266, 'time@10': 10.5846}: 100%|██████████| 10/10 [01:19<00:00,  8.50s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9555, 'compress@10': 0.5266, 'time@10': 10.5846}: 100%|██████████| 10/10 [01:19<00:00,  7.96s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.01341321172181816
Avg hit ratio: 0.9233422510332527
Avg ndcg: 0.955476383901719
Avg compression ratio: 0.5266403989039715
Avg train time: 10.584589743614197
Std train time: 0.42112696233784447
[0.5666666666666665, 0.6333333333333333, 0.03333333333333334, 0.4777777777777778, 0.9666666666666667, 0.5222222222222223, 0.45555555555555566, 0.47777777777777786, 0.6999999999999998, 0.16666666666666669]
[13, 15, 39, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9433, 'compress@10': 0.5895, 'time@10': 11.0775}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9433, 'compress@10': 0.5895, 'time@10': 11.0775}:  10%|█         | 1/10 [00:05<00:50,  5.58s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9515, 'compress@10': 0.6173, 'time@10': 10.8649}:  10%|█         | 1/10 [00:16<00:50,  5.58s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9515, 'compress@10': 0.6173, 'time@10': 10.8649}:  20%|██        | 2/10 [00:16<01:08,  8.58s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9201, 'compress@10': 0.4687, 'time@10': 10.565}:  20%|██        | 2/10 [00:21<01:08,  8.58s/it]  {'epoch': 44, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9201, 'compress@10': 0.4687, 'time@10': 10.565}:  30%|███       | 3/10 [00:21<00:48,  6.96s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9315, 'compress@10': 0.4756, 'time@10': 10.4152}:  30%|███       | 3/10 [00:31<00:48,  6.96s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9315, 'compress@10': 0.4756, 'time@10': 10.4152}:  40%|████      | 4/10 [00:31<00:48,  8.16s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9245, 'compress@10': 0.574, 'time@10': 10.38}:  40%|████      | 4/10 [00:36<00:48,  8.16s/it]   {'epoch': 44, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9245, 'compress@10': 0.574, 'time@10': 10.38}:  50%|█████     | 5/10 [00:36<00:35,  7.08s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9332, 'compress@10': 0.5671, 'time@10': 10.3778}:  50%|█████     | 5/10 [00:46<00:35,  7.08s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9332, 'compress@10': 0.5671, 'time@10': 10.3778}:  60%|██████    | 6/10 [00:46<00:32,  8.21s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9361, 'compress@10': 0.5543, 'time@10': 10.2817}:  60%|██████    | 6/10 [00:51<00:32,  8.21s/it] {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9361, 'compress@10': 0.5543, 'time@10': 10.2817}:  70%|███████   | 7/10 [00:51<00:21,  7.13s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9405, 'compress@10': 0.5466, 'time@10': 10.1999}:  70%|███████   | 7/10 [01:01<00:21,  7.13s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9405, 'compress@10': 0.5466, 'time@10': 10.1999}:  80%|████████  | 8/10 [01:01<00:15,  7.93s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.942, 'compress@10': 0.5646, 'time@10': 10.1915}:  80%|████████  | 8/10 [01:06<00:15,  7.93s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.942, 'compress@10': 0.5646, 'time@10': 10.1915}:  90%|█████████ | 9/10 [01:06<00:07,  7.05s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.9126, 'ndcg@10': 0.9455, 'compress@10': 0.5267, 'time@10': 10.2409}:  90%|█████████ | 9/10 [01:17<00:07,  7.05s/it]  {'epoch': 44, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.9126, 'ndcg@10': 0.9455, 'compress@10': 0.5267, 'time@10': 10.2409}: 100%|██████████| 10/10 [01:17<00:00,  8.19s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.9126, 'ndcg@10': 0.9455, 'compress@10': 0.5267, 'time@10': 10.2409}: 100%|██████████| 10/10 [01:17<00:00,  7.73s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.009271607504138798
Avg hit ratio: 0.912627965318967
Avg ndcg: 0.9454954301769571
Avg compression ratio: 0.5266843610656672
Avg train time: 10.240892720222472
Std train time: 0.43716007107476795
[0.5543478260869564, 0.6413043478260869, 0.03260869565217392, 0.4891304347826087, 0.967391304347826, 0.5108695652173914, 0.46739130434782616, 0.46739130434782616, 0.7065217391304346, 0.1630434782608696]
[13, 15, 39, 16, 5, 10, 10, 14, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9379, 'compress@10': 0.5778, 'time@10': 9.7961}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9379, 'compress@10': 0.5778, 'time@10': 9.7961}:  10%|█         | 1/10 [00:04<00:44,  4.95s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9526, 'compress@10': 0.6153, 'time@10': 9.6706}:  10%|█         | 1/10 [00:14<00:44,  4.95s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9526, 'compress@10': 0.6153, 'time@10': 9.6706}:  20%|██        | 2/10 [00:14<01:01,  7.68s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9208, 'compress@10': 0.4672, 'time@10': 9.5597}:  20%|██        | 2/10 [00:19<01:01,  7.68s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9208, 'compress@10': 0.4672, 'time@10': 9.5597}:  30%|███       | 3/10 [00:19<00:44,  6.33s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9329, 'compress@10': 0.4772, 'time@10': 9.5396}:  30%|███       | 3/10 [00:28<00:44,  6.33s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9329, 'compress@10': 0.4772, 'time@10': 9.5396}:  40%|████      | 4/10 [00:28<00:45,  7.59s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9272, 'compress@10': 0.5754, 'time@10': 9.5412}:  40%|████      | 4/10 [00:33<00:45,  7.59s/it] {'epoch': 45, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9272, 'compress@10': 0.5754, 'time@10': 9.5412}:  50%|█████     | 5/10 [00:33<00:32,  6.59s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.9197, 'ndcg@10': 0.9355, 'compress@10': 0.5664, 'time@10': 9.5139}:  50%|█████     | 5/10 [00:43<00:32,  6.59s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.9197, 'ndcg@10': 0.9355, 'compress@10': 0.5664, 'time@10': 9.5139}:  60%|██████    | 6/10 [00:43<00:30,  7.55s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.9255, 'ndcg@10': 0.938, 'compress@10': 0.5553, 'time@10': 9.6152}:  60%|██████    | 6/10 [00:48<00:30,  7.55s/it] {'epoch': 45, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.9255, 'ndcg@10': 0.938, 'compress@10': 0.5553, 'time@10': 9.6152}:  70%|███████   | 7/10 [00:48<00:20,  6.76s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9312, 'ndcg@10': 0.9444, 'compress@10': 0.5462, 'time@10': 9.6848}:  70%|███████   | 7/10 [00:58<00:20,  6.76s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9312, 'ndcg@10': 0.9444, 'compress@10': 0.5462, 'time@10': 9.6848}:  80%|████████  | 8/10 [00:58<00:15,  7.86s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0099, 'hit_ratio@10': 0.9198, 'ndcg@10': 0.9454, 'compress@10': 0.565, 'time@10': 9.7823}:  80%|████████  | 8/10 [01:03<00:15,  7.86s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0099, 'hit_ratio@10': 0.9198, 'ndcg@10': 0.9454, 'compress@10': 0.565, 'time@10': 9.7823}:  90%|█████████ | 9/10 [01:03<00:07,  7.07s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9256, 'ndcg@10': 0.95, 'compress@10': 0.5267, 'time@10': 9.8021}:  90%|█████████ | 9/10 [01:13<00:07,  7.07s/it]     {'epoch': 45, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9256, 'ndcg@10': 0.95, 'compress@10': 0.5267, 'time@10': 9.8021}: 100%|██████████| 10/10 [01:13<00:00,  7.98s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9256, 'ndcg@10': 0.95, 'compress@10': 0.5267, 'time@10': 9.8021}: 100%|██████████| 10/10 [01:13<00:00,  7.37s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.010985986200836285
Avg hit ratio: 0.925564473255475
Avg ndcg: 0.9500481520625252
Avg compression ratio: 0.5266894943887463
Avg train time: 9.802134656906128
Std train time: 0.3942761955486223
[0.5425531914893617, 0.648936170212766, 0.03191489361702128, 0.5, 0.9680851063829787, 0.5, 0.45744680851063835, 0.45744680851063835, 0.7127659574468084, 0.18085106382978727]
[13, 16, 40, 17, 6, 11, 10, 14, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0032, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.5666, 'time@10': 9.9727}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0032, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.5666, 'time@10': 9.9727}:  10%|█         | 1/10 [00:05<00:45,  5.02s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9536, 'compress@10': 0.6134, 'time@10': 10.0765}:  10%|█         | 1/10 [00:15<00:45,  5.02s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9536, 'compress@10': 0.6134, 'time@10': 10.0765}:  20%|██        | 2/10 [00:15<01:04,  8.08s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9215, 'compress@10': 0.4657, 'time@10': 9.9963}:  20%|██        | 2/10 [00:20<01:04,  8.08s/it]  {'epoch': 46, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9215, 'compress@10': 0.4657, 'time@10': 9.9963}:  30%|███       | 3/10 [00:20<00:46,  6.65s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9322, 'compress@10': 0.4787, 'time@10': 9.8927}:  30%|███       | 3/10 [00:29<00:46,  6.65s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9322, 'compress@10': 0.4787, 'time@10': 9.8927}:  40%|████      | 4/10 [00:29<00:46,  7.82s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9293, 'compress@10': 0.5767, 'time@10': 10.109}:  40%|████      | 4/10 [00:35<00:46,  7.82s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9293, 'compress@10': 0.5767, 'time@10': 10.109}:  50%|█████     | 5/10 [00:35<00:34,  6.99s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9372, 'compress@10': 0.5658, 'time@10': 10.1619}:  50%|█████     | 5/10 [00:45<00:34,  6.99s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9372, 'compress@10': 0.5658, 'time@10': 10.1619}:  60%|██████    | 6/10 [00:45<00:32,  8.18s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9395, 'compress@10': 0.5534, 'time@10': 10.0989}:  60%|██████    | 6/10 [00:50<00:32,  8.18s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9395, 'compress@10': 0.5534, 'time@10': 10.0989}:  70%|███████   | 7/10 [00:50<00:21,  7.10s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9191, 'ndcg@10': 0.951, 'compress@10': 0.5434, 'time@10': 9.9994}:  70%|███████   | 7/10 [01:00<00:21,  7.10s/it]    {'epoch': 46, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9191, 'ndcg@10': 0.951, 'compress@10': 0.5434, 'time@10': 9.9994}:  80%|████████  | 8/10 [01:00<00:15,  7.82s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.909, 'ndcg@10': 0.9509, 'compress@10': 0.5631, 'time@10': 9.9075}:  80%|████████  | 8/10 [01:04<00:15,  7.82s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.909, 'ndcg@10': 0.9509, 'compress@10': 0.5631, 'time@10': 9.9075}:  90%|█████████ | 9/10 [01:04<00:06,  6.82s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9535, 'compress@10': 0.5267, 'time@10': 9.8633}:  90%|█████████ | 9/10 [01:14<00:06,  6.82s/it]  {'epoch': 46, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9535, 'compress@10': 0.5267, 'time@10': 9.8633}: 100%|██████████| 10/10 [01:14<00:00,  7.65s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9535, 'compress@10': 0.5267, 'time@10': 9.8633}: 100%|██████████| 10/10 [01:14<00:00,  7.42s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.013305173837492973
Avg hit ratio: 0.9158537717705799
Avg ndcg: 0.9535080348492617
Avg compression ratio: 0.5267303775593521
Avg train time: 9.863311600685119
Std train time: 0.5209976983120865
[0.53125, 0.65625, 0.03125000000000001, 0.5104166666666666, 0.96875, 0.4895833333333333, 0.44791666666666674, 0.46875000000000006, 0.7187499999999999, 0.17708333333333337]
[13, 16, 40, 18, 6, 11, 11, 15, 8, 12]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.5559, 'time@10': 9.4922}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.5559, 'time@10': 9.4922}:  10%|█         | 1/10 [00:04<00:43,  4.78s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9588, 'compress@10': 0.6116, 'time@10': 9.4185}:  10%|█         | 1/10 [00:14<00:43,  4.78s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9588, 'compress@10': 0.6116, 'time@10': 9.4185}:  20%|██        | 2/10 [00:14<00:59,  7.49s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9249, 'compress@10': 0.4643, 'time@10': 9.2976}:  20%|██        | 2/10 [00:18<00:59,  7.49s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9249, 'compress@10': 0.4643, 'time@10': 9.2976}:  30%|███       | 3/10 [00:18<00:43,  6.15s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9347, 'compress@10': 0.4802, 'time@10': 9.4306}:  30%|███       | 3/10 [00:28<00:43,  6.15s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9347, 'compress@10': 0.4802, 'time@10': 9.4306}:  40%|████      | 4/10 [00:28<00:45,  7.62s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.009, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9319, 'compress@10': 0.578, 'time@10': 9.6343}:  40%|████      | 4/10 [00:33<00:45,  7.62s/it] {'epoch': 47, 'num_users': 5.8, 'loss': 0.009, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9319, 'compress@10': 0.578, 'time@10': 9.6343}:  50%|█████     | 5/10 [00:33<00:33,  6.77s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.9394, 'compress@10': 0.5652, 'time@10': 9.6561}:  50%|█████     | 5/10 [00:43<00:33,  6.77s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.9394, 'compress@10': 0.5652, 'time@10': 9.6561}:  60%|██████    | 6/10 [00:43<00:31,  7.80s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.941, 'compress@10': 0.5516, 'time@10': 9.7316}:  60%|██████    | 6/10 [00:48<00:31,  7.80s/it] {'epoch': 47, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.941, 'compress@10': 0.5516, 'time@10': 9.7316}:  70%|███████   | 7/10 [00:48<00:20,  6.93s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.9219, 'ndcg@10': 0.9442, 'compress@10': 0.5431, 'time@10': 9.681}:  70%|███████   | 7/10 [00:58<00:20,  6.93s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.9219, 'ndcg@10': 0.9442, 'compress@10': 0.5431, 'time@10': 9.681}:  80%|████████  | 8/10 [00:58<00:15,  7.70s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9468, 'compress@10': 0.5635, 'time@10': 9.6645}:  80%|████████  | 8/10 [01:02<00:15,  7.70s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9468, 'compress@10': 0.5635, 'time@10': 9.6645}:  90%|█████████ | 9/10 [01:02<00:06,  6.79s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9181, 'ndcg@10': 0.9507, 'compress@10': 0.5268, 'time@10': 9.6035}:  90%|█████████ | 9/10 [01:12<00:06,  6.79s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9181, 'ndcg@10': 0.9507, 'compress@10': 0.5268, 'time@10': 9.6035}: 100%|██████████| 10/10 [01:12<00:00,  7.50s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9181, 'ndcg@10': 0.9507, 'compress@10': 0.5268, 'time@10': 9.6035}: 100%|██████████| 10/10 [01:12<00:00,  7.20s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.010269282291154109
Avg hit ratio: 0.9180759939928022
Avg ndcg: 0.9506836456434419
Avg compression ratio: 0.5267580288912439
Avg train time: 9.603460502624511
Std train time: 0.4351890612866643
[0.5204081632653061, 0.6632653061224489, 0.03061224489795919, 0.49999999999999994, 0.9693877551020408, 0.47959183673469385, 0.43877551020408173, 0.4795918367346939, 0.7244897959183673, 0.1938775510204082]
[14, 17, 41, 18, 6, 11, 11, 16, 9, 13]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0033, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.5456, 'time@10': 9.5808}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0033, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 0.5456, 'time@10': 9.5808}:  10%|█         | 1/10 [00:04<00:43,  4.82s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6099, 'time@10': 9.397}:  10%|█         | 1/10 [00:14<00:43,  4.82s/it] {'epoch': 48, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9576, 'compress@10': 0.6099, 'time@10': 9.397}:  20%|██        | 2/10 [00:14<00:59,  7.44s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.7597, 'ndcg@10': 0.9241, 'compress@10': 0.463, 'time@10': 9.1664}:  20%|██        | 2/10 [00:18<00:59,  7.44s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.7597, 'ndcg@10': 0.9241, 'compress@10': 0.463, 'time@10': 9.1664}:  30%|███       | 3/10 [00:18<00:42,  6.04s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.7841, 'ndcg@10': 0.9341, 'compress@10': 0.4767, 'time@10': 9.2207}:  30%|███       | 3/10 [00:27<00:42,  6.04s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.7841, 'ndcg@10': 0.9341, 'compress@10': 0.4767, 'time@10': 9.2207}:  40%|████      | 4/10 [00:27<00:44,  7.37s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0071, 'hit_ratio@10': 0.8153, 'ndcg@10': 0.9334, 'compress@10': 0.5753, 'time@10': 9.2783}:  40%|████      | 4/10 [00:32<00:44,  7.37s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0071, 'hit_ratio@10': 0.8153, 'ndcg@10': 0.9334, 'compress@10': 0.5753, 'time@10': 9.2783}:  50%|█████     | 5/10 [00:32<00:32,  6.44s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.9405, 'compress@10': 0.5613, 'time@10': 9.1868}:  50%|█████     | 5/10 [00:41<00:32,  6.44s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.9405, 'compress@10': 0.5613, 'time@10': 9.1868}:  60%|██████    | 6/10 [00:41<00:28,  7.23s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9423, 'compress@10': 0.547, 'time@10': 9.2186}:  60%|██████    | 6/10 [00:46<00:28,  7.23s/it]   {'epoch': 48, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.856, 'ndcg@10': 0.9423, 'compress@10': 0.547, 'time@10': 9.2186}:  70%|███████   | 7/10 [00:46<00:19,  6.42s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.953, 'compress@10': 0.5404, 'time@10': 9.2595}:  70%|███████   | 7/10 [00:55<00:19,  6.42s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.953, 'compress@10': 0.5404, 'time@10': 9.2595}:  80%|████████  | 8/10 [00:55<00:14,  7.42s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.9541, 'compress@10': 0.5618, 'time@10': 9.3824}:  80%|████████  | 8/10 [01:00<00:14,  7.42s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.9541, 'compress@10': 0.5618, 'time@10': 9.3824}:  90%|█████████ | 9/10 [01:00<00:06,  6.73s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0085, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9564, 'compress@10': 0.5268, 'time@10': 9.4034}:  90%|█████████ | 9/10 [01:10<00:06,  6.73s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0085, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9564, 'compress@10': 0.5268, 'time@10': 9.4034}: 100%|██████████| 10/10 [01:10<00:00,  7.62s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0085, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9564, 'compress@10': 0.5268, 'time@10': 9.4034}: 100%|██████████| 10/10 [01:10<00:00,  7.06s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.00847792584437226
Avg hit ratio: 0.8740565367475384
Avg ndcg: 0.9564459947997687
Avg compression ratio: 0.5268105306932871
Avg train time: 9.40342619419098
Std train time: 0.4475507424832222
[0.51, 0.6699999999999999, 0.030000000000000006, 0.48999999999999994, 0.97, 0.47, 0.4500000000000001, 0.49000000000000005, 0.7299999999999999, 0.19000000000000006]
[15, 18, 42, 19, 7, 12, 12, 17, 9, 14]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9447, 'compress@10': 0.5358, 'time@10': 9.6606}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9447, 'compress@10': 0.5358, 'time@10': 9.6606}:  10%|█         | 1/10 [00:04<00:43,  4.86s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9703, 'compress@10': 0.6082, 'time@10': 9.3253}:  10%|█         | 1/10 [00:13<00:43,  4.86s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9703, 'compress@10': 0.6082, 'time@10': 9.3253}:  20%|██        | 2/10 [00:13<00:58,  7.31s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9326, 'compress@10': 0.4617, 'time@10': 8.8446}:  20%|██        | 2/10 [00:17<00:58,  7.31s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.9326, 'compress@10': 0.4617, 'time@10': 8.8446}:  30%|███       | 3/10 [00:17<00:40,  5.78s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.9405, 'compress@10': 0.4733, 'time@10': 8.8603}:  30%|███       | 3/10 [00:26<00:40,  5.78s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.9405, 'compress@10': 0.4733, 'time@10': 8.8603}:  40%|████      | 4/10 [00:26<00:42,  7.03s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.941, 'compress@10': 0.5728, 'time@10': 9.2796}:  40%|████      | 4/10 [00:32<00:42,  7.03s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.941, 'compress@10': 0.5728, 'time@10': 9.2796}:  50%|█████     | 5/10 [00:32<00:32,  6.48s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9465, 'compress@10': 0.5576, 'time@10': 9.2932}:  50%|█████     | 5/10 [00:41<00:32,  6.48s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9465, 'compress@10': 0.5576, 'time@10': 9.2932}:  60%|██████    | 6/10 [00:41<00:29,  7.47s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9477, 'compress@10': 0.5454, 'time@10': 9.428}:  60%|██████    | 6/10 [00:46<00:29,  7.47s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9477, 'compress@10': 0.5454, 'time@10': 9.428}:  70%|███████   | 7/10 [00:46<00:20,  6.72s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9516, 'compress@10': 0.5403, 'time@10': 9.512}:  70%|███████   | 7/10 [00:56<00:20,  6.72s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9516, 'compress@10': 0.5403, 'time@10': 9.512}:  80%|████████  | 8/10 [00:56<00:15,  7.81s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9532, 'compress@10': 0.5622, 'time@10': 9.6198}:  80%|████████  | 8/10 [01:02<00:15,  7.81s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9532, 'compress@10': 0.5622, 'time@10': 9.6198}:  90%|█████████ | 9/10 [01:02<00:07,  7.01s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9556, 'compress@10': 0.5268, 'time@10': 9.7104}:  90%|█████████ | 9/10 [01:12<00:07,  7.01s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9556, 'compress@10': 0.5268, 'time@10': 9.7104}: 100%|██████████| 10/10 [01:12<00:00,  8.11s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9556, 'compress@10': 0.5268, 'time@10': 9.7104}: 100%|██████████| 10/10 [01:12<00:00,  7.28s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.011952469275379782
Avg hit ratio: 0.8898763281615574
Avg ndcg: 0.9555948526562051
Avg compression ratio: 0.5268264527032478
Avg train time: 9.710381269454956
Std train time: 0.887119237453322
[0.5196078431372549, 0.676470588235294, 0.02941176470588236, 0.48039215686274506, 0.9705882352941176, 0.48039215686274506, 0.4411764705882354, 0.5, 0.7156862745098038, 0.18627450980392163]
[16, 19, 43, 20, 7, 13, 12, 17, 9, 14]
