  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1574, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5075, 'compress@10': 0.0713, 'time@10': 5.7445}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1574, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5075, 'compress@10': 0.0713, 'time@10': 5.7445}:  10%|█         | 1/10 [00:02<00:26,  2.91s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1137, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.6548, 'compress@10': 0.063, 'time@10': 4.9562}:  10%|█         | 1/10 [00:07<00:26,  2.91s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.1137, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.6548, 'compress@10': 0.063, 'time@10': 4.9562}:  20%|██        | 2/10 [00:07<00:29,  3.68s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7173, 'hit_ratio@10': 0.5287, 'ndcg@10': 0.4414, 'compress@10': 0.1016, 'time@10': 3.8454}:  20%|██        | 2/10 [00:07<00:29,  3.68s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7173, 'hit_ratio@10': 0.5287, 'ndcg@10': 0.4414, 'compress@10': 0.1016, 'time@10': 3.8454}:  30%|███       | 3/10 [00:07<00:16,  2.39s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5631, 'hit_ratio@10': 0.6019, 'ndcg@10': 0.493, 'compress@10': 0.0923, 'time@10': 3.8185}:  30%|███       | 3/10 [00:11<00:16,  2.39s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.5631, 'hit_ratio@10': 0.6019, 'ndcg@10': 0.493, 'compress@10': 0.0923, 'time@10': 3.8185}:  40%|████      | 4/10 [00:11<00:17,  2.94s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4691, 'hit_ratio@10': 0.6455, 'ndcg@10': 0.5441, 'compress@10': 0.0825, 'time@10': 5.7807}:  40%|████      | 4/10 [00:18<00:17,  2.94s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4691, 'hit_ratio@10': 0.6455, 'ndcg@10': 0.5441, 'compress@10': 0.0825, 'time@10': 5.7807}:  50%|█████     | 5/10 [00:18<00:21,  4.35s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4051, 'hit_ratio@10': 0.6528, 'ndcg@10': 0.5863, 'compress@10': 0.0758, 'time@10': 5.8348}:  50%|█████     | 5/10 [00:24<00:21,  4.35s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4051, 'hit_ratio@10': 0.6528, 'ndcg@10': 0.5863, 'compress@10': 0.0758, 'time@10': 5.8348}:  60%|██████    | 6/10 [00:24<00:19,  4.96s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3623, 'hit_ratio@10': 0.6738, 'ndcg@10': 0.5889, 'compress@10': 0.0732, 'time@10': 5.9432}:  60%|██████    | 6/10 [00:28<00:19,  4.96s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3623, 'hit_ratio@10': 0.6738, 'ndcg@10': 0.5889, 'compress@10': 0.0732, 'time@10': 5.9432}:  70%|███████   | 7/10 [00:28<00:13,  4.43s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3231, 'hit_ratio@10': 0.7039, 'ndcg@10': 0.6139, 'compress@10': 0.0704, 'time@10': 5.7879}:  70%|███████   | 7/10 [00:32<00:13,  4.43s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3231, 'hit_ratio@10': 0.7039, 'ndcg@10': 0.6139, 'compress@10': 0.0704, 'time@10': 5.7879}:  80%|████████  | 8/10 [00:32<00:09,  4.53s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2925, 'hit_ratio@10': 0.6955, 'ndcg@10': 0.6465, 'compress@10': 0.0684, 'time@10': 6.1962}:  80%|████████  | 8/10 [00:37<00:09,  4.53s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2925, 'hit_ratio@10': 0.6955, 'ndcg@10': 0.6465, 'compress@10': 0.0684, 'time@10': 6.1962}:  90%|█████████ | 9/10 [00:37<00:04,  4.60s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2685, 'hit_ratio@10': 0.7191, 'ndcg@10': 0.6668, 'compress@10': 0.067, 'time@10': 6.1709}:  90%|█████████ | 9/10 [00:43<00:04,  4.60s/it]    {'epoch': 0, 'num_users': 6.3, 'loss': 0.2685, 'hit_ratio@10': 0.7191, 'ndcg@10': 0.6668, 'compress@10': 0.067, 'time@10': 6.1709}: 100%|██████████| 10/10 [00:43<00:00,  5.03s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2685, 'hit_ratio@10': 0.7191, 'ndcg@10': 0.6668, 'compress@10': 0.067, 'time@10': 6.1709}: 100%|██████████| 10/10 [00:43<00:00,  4.36s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.2684832800950074
Avg hit ratio: 0.7191216408567852
Avg ndcg: 0.6668219043734089
Avg compression ratio: 0.06698815444917643
Avg train time: 6.170872402191162
Std train time: 3.156824567611425
[0.6499999999999999, 0.15, 0.6499999999999999, 0.6499999999999999, 0.6499999999999999, 0.15, 0.6499999999999999, 0.15, 0.15, 0.15]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0532, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8379, 'compress@10': 0.9147, 'time@10': 5.2771}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0532, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8379, 'compress@10': 0.9147, 'time@10': 5.2771}:  10%|█         | 1/10 [00:02<00:24,  2.68s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0531, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8461, 'compress@10': 0.4743, 'time@10': 4.7422}:  10%|█         | 1/10 [00:06<00:24,  2.68s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0531, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8461, 'compress@10': 0.4743, 'time@10': 4.7422}:  20%|██        | 2/10 [00:06<00:28,  3.60s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0414, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8218, 'compress@10': 0.6352, 'time@10': 3.757}:  20%|██        | 2/10 [00:07<00:28,  3.60s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.0414, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8218, 'compress@10': 0.6352, 'time@10': 3.757}:  30%|███       | 3/10 [00:07<00:16,  2.38s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0434, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8271, 'compress@10': 0.7191, 'time@10': 3.7517}:  30%|███       | 3/10 [00:11<00:16,  2.38s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0434, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8271, 'compress@10': 0.7191, 'time@10': 3.7517}:  40%|████      | 4/10 [00:11<00:17,  2.93s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0521, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8189, 'compress@10': 0.7665, 'time@10': 5.4443}:  40%|████      | 4/10 [00:17<00:17,  2.93s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0521, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8189, 'compress@10': 0.7665, 'time@10': 5.4443}:  50%|█████     | 5/10 [00:17<00:20,  4.09s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0561, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8177, 'compress@10': 0.6428, 'time@10': 5.5525}:  50%|█████     | 5/10 [00:23<00:20,  4.09s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0561, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8177, 'compress@10': 0.6428, 'time@10': 5.5525}:  60%|██████    | 6/10 [00:23<00:19,  4.78s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0543, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8256, 'compress@10': 0.6881, 'time@10': 5.7251}:  60%|██████    | 6/10 [00:27<00:19,  4.78s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0543, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8256, 'compress@10': 0.6881, 'time@10': 5.7251}:  70%|███████   | 7/10 [00:27<00:13,  4.34s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0522, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8317, 'compress@10': 0.6058, 'time@10': 5.5948}:  70%|███████   | 7/10 [00:32<00:13,  4.34s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0522, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8317, 'compress@10': 0.6058, 'time@10': 5.5948}:  80%|████████  | 8/10 [00:32<00:08,  4.46s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8409, 'compress@10': 0.5419, 'time@10': 5.9162}:  80%|████████  | 8/10 [00:36<00:08,  4.46s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8409, 'compress@10': 0.5419, 'time@10': 5.9162}:  90%|█████████ | 9/10 [00:36<00:04,  4.40s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8417, 'compress@10': 0.4902, 'time@10': 5.9116}:  90%|█████████ | 9/10 [00:42<00:04,  4.40s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8417, 'compress@10': 0.4902, 'time@10': 5.9116}: 100%|██████████| 10/10 [00:42<00:00,  4.87s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8417, 'compress@10': 0.4902, 'time@10': 5.9116}: 100%|██████████| 10/10 [00:42<00:00,  4.22s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.04986814186601359
Avg hit ratio: 0.8238183827114218
Avg ndcg: 0.8416843425748997
Avg compression ratio: 0.49021178147849226
Avg train time: 5.9115955352783205
Std train time: 2.7145549506068885
[0.7666666666666666, 0.43333333333333335, 0.43333333333333324, 0.7666666666666666, 0.7666666666666666, 0.43333333333333335, 0.43333333333333324, 0.1, 0.1, 0.1]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.9952, 'time@10': 4.9002}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.9952, 'time@10': 4.9002}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8482, 'compress@10': 0.6526, 'time@10': 4.5588}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8482, 'compress@10': 0.6526, 'time@10': 4.5588}:  20%|██        | 2/10 [00:06<00:28,  3.53s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8512, 'compress@10': 0.5528, 'time@10': 3.6929}:  20%|██        | 2/10 [00:07<00:28,  3.53s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8512, 'compress@10': 0.5528, 'time@10': 3.6929}:  30%|███       | 3/10 [00:07<00:16,  2.38s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8492, 'compress@10': 0.663, 'time@10': 3.7071}:  30%|███       | 3/10 [00:11<00:16,  2.38s/it]  {'epoch': 2, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8492, 'compress@10': 0.663, 'time@10': 3.7071}:  40%|████      | 4/10 [00:11<00:17,  2.94s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.8372, 'compress@10': 0.7287, 'time@10': 5.1573}:  40%|████      | 4/10 [00:17<00:17,  2.94s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.8372, 'compress@10': 0.7287, 'time@10': 5.1573}:  50%|█████     | 5/10 [00:17<00:19,  3.87s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0516, 'hit_ratio@10': 0.7706, 'ndcg@10': 0.8337, 'compress@10': 0.6427, 'time@10': 5.3277}:  50%|█████     | 5/10 [00:23<00:19,  3.87s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0516, 'hit_ratio@10': 0.7706, 'ndcg@10': 0.8337, 'compress@10': 0.6427, 'time@10': 5.3277}:  60%|██████    | 6/10 [00:23<00:18,  4.67s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.7976, 'ndcg@10': 0.8354, 'compress@10': 0.5907, 'time@10': 5.5228}:  60%|██████    | 6/10 [00:26<00:18,  4.67s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.7976, 'ndcg@10': 0.8354, 'compress@10': 0.5907, 'time@10': 5.5228}:  70%|███████   | 7/10 [00:26<00:12,  4.25s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8418, 'compress@10': 0.5205, 'time@10': 5.4178}:  70%|███████   | 7/10 [00:31<00:12,  4.25s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8418, 'compress@10': 0.5205, 'time@10': 5.4178}:  80%|████████  | 8/10 [00:31<00:08,  4.40s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.8493, 'compress@10': 0.4659, 'time@10': 5.767}:  80%|████████  | 8/10 [00:35<00:08,  4.40s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.8493, 'compress@10': 0.4659, 'time@10': 5.767}:  90%|█████████ | 9/10 [00:35<00:04,  4.37s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8494, 'compress@10': 0.4217, 'time@10': 5.771}:  90%|█████████ | 9/10 [00:41<00:04,  4.37s/it]    {'epoch': 2, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8494, 'compress@10': 0.4217, 'time@10': 5.771}: 100%|██████████| 10/10 [00:41<00:00,  4.83s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8494, 'compress@10': 0.4217, 'time@10': 5.771}: 100%|██████████| 10/10 [00:41<00:00,  4.16s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04855645788998203
Avg hit ratio: 0.8229612398542789
Avg ndcg: 0.8494271676553516
Avg compression ratio: 0.4216908520438176
Avg train time: 5.771034479141235
Std train time: 2.4219884929245477
[0.825, 0.575, 0.32499999999999996, 0.825, 0.825, 0.575, 0.32499999999999996, 0.07500000000000001, 0.07500000000000001, 0.07500000000000001]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8524, 'compress@10': 0.9984, 'time@10': 4.7711}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8524, 'compress@10': 0.9984, 'time@10': 4.7711}:  10%|█         | 1/10 [00:02<00:21,  2.42s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.852, 'compress@10': 0.953, 'time@10': 4.4993}:  10%|█         | 1/10 [00:06<00:21,  2.42s/it]  {'epoch': 3, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.852, 'compress@10': 0.953, 'time@10': 4.4993}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8537, 'compress@10': 0.692, 'time@10': 3.7468}:  20%|██        | 2/10 [00:07<00:28,  3.51s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8537, 'compress@10': 0.692, 'time@10': 3.7468}:  30%|███       | 3/10 [00:07<00:17,  2.45s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0362, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8518, 'compress@10': 0.7684, 'time@10': 3.7647}:  30%|███       | 3/10 [00:11<00:17,  2.45s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0362, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8518, 'compress@10': 0.7684, 'time@10': 3.7647}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8401, 'compress@10': 0.8142, 'time@10': 4.9241}:  40%|████      | 4/10 [00:16<00:18,  3.01s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8401, 'compress@10': 0.8142, 'time@10': 4.9241}:  50%|█████     | 5/10 [00:16<00:18,  3.66s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0495, 'hit_ratio@10': 0.7817, 'ndcg@10': 0.8378, 'compress@10': 0.8256, 'time@10': 5.1206}:  50%|█████     | 5/10 [00:22<00:18,  3.66s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0495, 'hit_ratio@10': 0.7817, 'ndcg@10': 0.8378, 'compress@10': 0.8256, 'time@10': 5.1206}:  60%|██████    | 6/10 [00:22<00:18,  4.51s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8354, 'compress@10': 0.7179, 'time@10': 5.3308}:  60%|██████    | 6/10 [00:26<00:18,  4.51s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8354, 'compress@10': 0.7179, 'time@10': 5.3308}:  70%|███████   | 7/10 [00:26<00:12,  4.12s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0513, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.8497, 'compress@10': 0.6318, 'time@10': 5.252}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it]  {'epoch': 3, 'num_users': 6.125, 'loss': 0.0513, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.8497, 'compress@10': 0.6318, 'time@10': 5.252}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0497, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8584, 'compress@10': 0.5648, 'time@10': 5.6152}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0497, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8584, 'compress@10': 0.5648, 'time@10': 5.6152}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8573, 'compress@10': 0.5106, 'time@10': 5.6286}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8573, 'compress@10': 0.5106, 'time@10': 5.6286}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8573, 'compress@10': 0.5106, 'time@10': 5.6286}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04947528205080373
Avg hit ratio: 0.8210636464082984
Avg ndcg: 0.857337790594735
Avg compression ratio: 0.5106280758734414
Avg train time: 5.6286173343658445
Std train time: 2.0811126182899056
[0.6599999999999999, 0.6599999999999999, 0.25999999999999995, 0.6599999999999999, 0.86, 0.6599999999999999, 0.45999999999999996, 0.26, 0.06000000000000001, 0.06000000000000001]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 0.9694, 'time@10': 4.4454}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 0.9694, 'time@10': 4.4454}:  10%|█         | 1/10 [00:02<00:20,  2.26s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8525, 'compress@10': 0.9709, 'time@10': 4.3036}:  10%|█         | 1/10 [00:06<00:20,  2.26s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8525, 'compress@10': 0.9709, 'time@10': 4.3036}:  20%|██        | 2/10 [00:06<00:27,  3.40s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8541, 'compress@10': 0.6978, 'time@10': 3.6288}:  20%|██        | 2/10 [00:07<00:27,  3.40s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8541, 'compress@10': 0.6978, 'time@10': 3.6288}:  30%|███       | 3/10 [00:07<00:16,  2.39s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8533, 'compress@10': 0.7647, 'time@10': 3.6491}:  30%|███       | 3/10 [00:11<00:16,  2.39s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8533, 'compress@10': 0.7647, 'time@10': 3.6491}:  40%|████      | 4/10 [00:11<00:17,  2.92s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0453, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8398, 'compress@10': 0.8115, 'time@10': 4.5565}:  40%|████      | 4/10 [00:15<00:17,  2.92s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0453, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8398, 'compress@10': 0.8115, 'time@10': 4.5565}:  50%|█████     | 5/10 [00:15<00:16,  3.36s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.838, 'compress@10': 0.8377, 'time@10': 4.8139}:  50%|█████     | 5/10 [00:21<00:16,  3.36s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.838, 'compress@10': 0.8377, 'time@10': 4.8139}:  60%|██████    | 6/10 [00:21<00:17,  4.30s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.838, 'compress@10': 0.7746, 'time@10': 5.082}:  60%|██████    | 6/10 [00:25<00:17,  4.30s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.838, 'compress@10': 0.7746, 'time@10': 5.082}:  70%|███████   | 7/10 [00:25<00:12,  4.00s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0493, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8509, 'compress@10': 0.6824, 'time@10': 5.0337}:  70%|███████   | 7/10 [00:29<00:12,  4.00s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0493, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8509, 'compress@10': 0.6824, 'time@10': 5.0337}:  80%|████████  | 8/10 [00:29<00:08,  4.24s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0503, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8542, 'compress@10': 0.6098, 'time@10': 5.4371}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0503, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8542, 'compress@10': 0.6098, 'time@10': 5.4371}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8543, 'compress@10': 0.5511, 'time@10': 5.4656}:  90%|█████████ | 9/10 [00:39<00:04,  4.28s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8543, 'compress@10': 0.5511, 'time@10': 5.4656}: 100%|██████████| 10/10 [00:39<00:00,  4.74s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8543, 'compress@10': 0.5511, 'time@10': 5.4656}: 100%|██████████| 10/10 [00:39<00:00,  3.99s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.049720319168328905
Avg hit ratio: 0.8403652337098857
Avg ndcg: 0.854269733228454
Avg compression ratio: 0.5510997354556136
Avg train time: 5.465624880790711
Std train time: 1.9019052710622852
[0.5499999999999999, 0.7166666666666666, 0.21666666666666662, 0.5499999999999999, 0.8833333333333333, 0.7166666666666666, 0.3833333333333333, 0.38333333333333336, 0.21666666666666667, 0.05000000000000001]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.8117, 'time@10': 5.0141}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.8117, 'time@10': 5.0141}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8564, 'compress@10': 0.9003, 'time@10': 4.6172}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8564, 'compress@10': 0.9003, 'time@10': 4.6172}:  20%|██        | 2/10 [00:06<00:28,  3.56s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8567, 'compress@10': 0.6492, 'time@10': 3.9036}:  20%|██        | 2/10 [00:08<00:28,  3.56s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8567, 'compress@10': 0.6492, 'time@10': 3.9036}:  30%|███       | 3/10 [00:08<00:17,  2.51s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0346, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8518, 'compress@10': 0.6937, 'time@10': 3.8794}:  30%|███       | 3/10 [00:11<00:17,  2.51s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0346, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8518, 'compress@10': 0.6937, 'time@10': 3.8794}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0439, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8384, 'compress@10': 0.7548, 'time@10': 4.7552}:  40%|████      | 4/10 [00:16<00:18,  3.04s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0439, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8384, 'compress@10': 0.7548, 'time@10': 4.7552}:  50%|█████     | 5/10 [00:16<00:17,  3.45s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0465, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8382, 'compress@10': 0.7937, 'time@10': 4.9849}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0465, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8382, 'compress@10': 0.7937, 'time@10': 4.9849}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.046, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8411, 'compress@10': 0.6999, 'time@10': 5.2169}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it] {'epoch': 5, 'num_users': 6.2857, 'loss': 0.046, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8411, 'compress@10': 0.6999, 'time@10': 5.2169}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0463, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8489, 'compress@10': 0.6244, 'time@10': 5.1524}:  70%|███████   | 7/10 [00:30<00:12,  4.04s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0463, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8489, 'compress@10': 0.6244, 'time@10': 5.1524}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0462, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8562, 'compress@10': 0.5586, 'time@10': 5.5417}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0462, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8562, 'compress@10': 0.5586, 'time@10': 5.5417}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0457, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8559, 'compress@10': 0.5051, 'time@10': 5.5636}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0457, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8559, 'compress@10': 0.5051, 'time@10': 5.5636}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0457, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8559, 'compress@10': 0.5051, 'time@10': 5.5636}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.045718800944260306
Avg hit ratio: 0.8475874559321079
Avg ndcg: 0.8559005630075912
Avg compression ratio: 0.5050717438737503
Avg train time: 5.563601970672607
Std train time: 1.83709697716845
[0.6142857142857142, 0.6142857142857142, 0.18571428571428567, 0.47142857142857136, 0.9, 0.757142857142857, 0.32857142857142857, 0.4714285714285715, 0.32857142857142857, 0.042857142857142864]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.862, 'compress@10': 0.9294, 'time@10': 4.6854}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.862, 'compress@10': 0.9294, 'time@10': 4.6854}:  10%|█         | 1/10 [00:02<00:21,  2.38s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8613, 'compress@10': 0.9343, 'time@10': 4.4461}:  10%|█         | 1/10 [00:06<00:21,  2.38s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8613, 'compress@10': 0.9343, 'time@10': 4.4461}:  20%|██        | 2/10 [00:06<00:27,  3.48s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8599, 'compress@10': 0.6713, 'time@10': 3.8534}:  20%|██        | 2/10 [00:07<00:27,  3.48s/it]  {'epoch': 6, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8599, 'compress@10': 0.6713, 'time@10': 3.8534}:  30%|███       | 3/10 [00:07<00:17,  2.52s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.857, 'compress@10': 0.5957, 'time@10': 3.8156}:  30%|███       | 3/10 [00:11<00:17,  2.52s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.857, 'compress@10': 0.5957, 'time@10': 3.8156}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0451, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8429, 'compress@10': 0.6764, 'time@10': 4.7023}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0451, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8429, 'compress@10': 0.6764, 'time@10': 4.7023}:  50%|█████     | 5/10 [00:15<00:17,  3.42s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0466, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8425, 'compress@10': 0.7295, 'time@10': 4.9505}:  50%|█████     | 5/10 [00:22<00:17,  3.42s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0466, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8425, 'compress@10': 0.7295, 'time@10': 4.9505}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0453, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.8454, 'compress@10': 0.6365, 'time@10': 5.1972}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0453, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.8454, 'compress@10': 0.6365, 'time@10': 5.1972}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0456, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8528, 'compress@10': 0.614, 'time@10': 5.153}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]   {'epoch': 6, 'num_users': 6.125, 'loss': 0.0456, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8528, 'compress@10': 0.614, 'time@10': 5.153}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0454, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8605, 'compress@10': 0.5513, 'time@10': 5.5524}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0454, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8605, 'compress@10': 0.5513, 'time@10': 5.5524}:  90%|█████████ | 9/10 [00:34<00:04,  4.34s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0445, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.8609, 'compress@10': 0.4985, 'time@10': 5.5708}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0445, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.8609, 'compress@10': 0.4985, 'time@10': 5.5708}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0445, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.8609, 'compress@10': 0.4985, 'time@10': 5.5708}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.044521654300868
Avg hit ratio: 0.877746186090838
Avg ndcg: 0.8608522130275686
Avg compression ratio: 0.4984883961906054
Avg train time: 5.570755958557129
Std train time: 1.8437907547977745
[0.6625, 0.5375, 0.16249999999999995, 0.5375, 0.9125, 0.7874999999999999, 0.2875, 0.5375000000000001, 0.2875, 0.037500000000000006]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8429, 'compress@10': 0.9688, 'time@10': 4.5626}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8429, 'compress@10': 0.9688, 'time@10': 4.5626}:  10%|█         | 1/10 [00:02<00:20,  2.32s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8516, 'compress@10': 0.8978, 'time@10': 4.383}:  10%|█         | 1/10 [00:06<00:20,  2.32s/it] {'epoch': 7, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8516, 'compress@10': 0.8978, 'time@10': 4.383}:  20%|██        | 2/10 [00:06<00:27,  3.45s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8535, 'compress@10': 0.6467, 'time@10': 3.8548}:  20%|██        | 2/10 [00:07<00:27,  3.45s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8535, 'compress@10': 0.6467, 'time@10': 3.8548}:  30%|███       | 3/10 [00:07<00:17,  2.53s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8341, 'compress@10': 0.6798, 'time@10': 3.8291}:  30%|███       | 3/10 [00:11<00:17,  2.53s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8341, 'compress@10': 0.6798, 'time@10': 3.8291}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0442, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8253, 'compress@10': 0.7438, 'time@10': 4.7325}:  40%|████      | 4/10 [00:16<00:18,  3.03s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0442, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8253, 'compress@10': 0.7438, 'time@10': 4.7325}:  50%|█████     | 5/10 [00:16<00:17,  3.46s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.045, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8291, 'compress@10': 0.786, 'time@10': 4.9769}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.045, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8291, 'compress@10': 0.786, 'time@10': 4.9769}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0438, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8353, 'compress@10': 0.6823, 'time@10': 5.2248}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0438, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8353, 'compress@10': 0.6823, 'time@10': 5.2248}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0439, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.8434, 'compress@10': 0.6967, 'time@10': 5.1645}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0439, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.8434, 'compress@10': 0.6967, 'time@10': 5.1645}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0457, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.8612, 'compress@10': 0.6235, 'time@10': 5.5362}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0457, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.8612, 'compress@10': 0.6235, 'time@10': 5.5362}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0448, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8623, 'compress@10': 0.5634, 'time@10': 5.5575}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0448, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8623, 'compress@10': 0.5634, 'time@10': 5.5575}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0448, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8623, 'compress@10': 0.5634, 'time@10': 5.5575}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04481068537761283
Avg hit ratio: 0.8776227861932446
Avg ndcg: 0.8622790241247742
Avg compression ratio: 0.5634355803287046
Avg train time: 5.557456541061401
Std train time: 1.8064297452185918
[0.7, 0.47777777777777775, 0.1444444444444444, 0.5888888888888889, 0.9222222222222222, 0.811111111111111, 0.25555555555555554, 0.47777777777777786, 0.36666666666666664, 0.03333333333333334]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.9831, 'time@10': 4.1218}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.9831, 'time@10': 4.1218}:  10%|█         | 1/10 [00:02<00:18,  2.10s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0416, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8599, 'compress@10': 0.8033, 'time@10': 4.1026}:  10%|█         | 1/10 [00:06<00:18,  2.10s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0416, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8599, 'compress@10': 0.8033, 'time@10': 4.1026}:  20%|██        | 2/10 [00:06<00:26,  3.29s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.859, 'compress@10': 0.5836, 'time@10': 3.7199}:  20%|██        | 2/10 [00:07<00:26,  3.29s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.859, 'compress@10': 0.5836, 'time@10': 3.7199}:  30%|███       | 3/10 [00:07<00:17,  2.48s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8525, 'compress@10': 0.6607, 'time@10': 3.727}:  30%|███       | 3/10 [00:11<00:17,  2.48s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8525, 'compress@10': 0.6607, 'time@10': 3.727}:  40%|████      | 4/10 [00:11<00:17,  3.00s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0396, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8402, 'compress@10': 0.7285, 'time@10': 4.64}:  40%|████      | 4/10 [00:15<00:17,  3.00s/it] {'epoch': 8, 'num_users': 5.8, 'loss': 0.0396, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8402, 'compress@10': 0.7285, 'time@10': 4.64}:  50%|█████     | 5/10 [00:15<00:17,  3.42s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8425, 'compress@10': 0.7735, 'time@10': 4.9013}:  50%|█████     | 5/10 [00:21<00:17,  3.42s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8425, 'compress@10': 0.7735, 'time@10': 4.9013}:  60%|██████    | 6/10 [00:21<00:17,  4.39s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0394, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8495, 'compress@10': 0.6704, 'time@10': 5.1659}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0394, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8495, 'compress@10': 0.6704, 'time@10': 5.1659}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0397, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8559, 'compress@10': 0.6527, 'time@10': 5.1119}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0397, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8559, 'compress@10': 0.6527, 'time@10': 5.1119}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0408, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8601, 'compress@10': 0.5876, 'time@10': 5.5015}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0408, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8601, 'compress@10': 0.5876, 'time@10': 5.5015}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0397, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8636, 'compress@10': 0.5311, 'time@10': 5.5296}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]     {'epoch': 8, 'num_users': 6.3, 'loss': 0.0397, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8636, 'compress@10': 0.5311, 'time@10': 5.5296}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0397, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8636, 'compress@10': 0.5311, 'time@10': 5.5296}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.0397033894501911
Avg hit ratio: 0.8600189133635652
Avg ndcg: 0.8635560592433956
Avg compression ratio: 0.531142042461625
Avg train time: 5.529566693305969
Std train time: 1.8357695621779988
[0.73, 0.43, 0.12999999999999995, 0.63, 0.9299999999999999, 0.8299999999999998, 0.22999999999999998, 0.43000000000000005, 0.42999999999999994, 0.030000000000000006]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8453, 'compress@10': 0.9902, 'time@10': 4.0688}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8453, 'compress@10': 0.9902, 'time@10': 4.0688}:  10%|█         | 1/10 [00:02<00:18,  2.08s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.04, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8666, 'compress@10': 0.6039, 'time@10': 4.009}:  10%|█         | 1/10 [00:06<00:18,  2.08s/it]   {'epoch': 9, 'num_users': 7.0, 'loss': 0.04, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8666, 'compress@10': 0.6039, 'time@10': 4.009}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8635, 'compress@10': 0.4505, 'time@10': 3.712}:  20%|██        | 2/10 [00:07<00:25,  3.20s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8635, 'compress@10': 0.4505, 'time@10': 3.712}:  30%|███       | 3/10 [00:07<00:17,  2.47s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8606, 'compress@10': 0.5733, 'time@10': 3.7148}:  30%|███       | 3/10 [00:11<00:17,  2.47s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8606, 'compress@10': 0.5733, 'time@10': 3.7148}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0382, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8489, 'compress@10': 0.6586, 'time@10': 4.6303}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0382, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8489, 'compress@10': 0.6586, 'time@10': 4.6303}:  50%|█████     | 5/10 [00:15<00:17,  3.41s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0389, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8501, 'compress@10': 0.7153, 'time@10': 4.8903}:  50%|█████     | 5/10 [00:21<00:17,  3.41s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0389, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8501, 'compress@10': 0.7153, 'time@10': 4.8903}:  60%|██████    | 6/10 [00:21<00:17,  4.37s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0379, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8563, 'compress@10': 0.6199, 'time@10': 5.1478}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0379, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8563, 'compress@10': 0.6199, 'time@10': 5.1478}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0383, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8582, 'compress@10': 0.5645, 'time@10': 5.098}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0383, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8582, 'compress@10': 0.5645, 'time@10': 5.098}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0374, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8661, 'compress@10': 0.5185, 'time@10': 5.4905}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0374, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8661, 'compress@10': 0.5185, 'time@10': 5.4905}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0368, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8699, 'compress@10': 0.469, 'time@10': 5.5244}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]    {'epoch': 9, 'num_users': 6.3, 'loss': 0.0368, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8699, 'compress@10': 0.469, 'time@10': 5.5244}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0368, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8699, 'compress@10': 0.469, 'time@10': 5.5244}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03681126367784221
Avg hit ratio: 0.8779328649090958
Avg ndcg: 0.8698867779450049
Avg compression ratio: 0.4689677973828711
Avg train time: 5.524437355995178
Std train time: 1.8288962899348398
[0.7545454545454545, 0.3909090909090909, 0.11818181818181814, 0.6636363636363637, 0.9363636363636363, 0.8454545454545453, 0.20909090909090908, 0.48181818181818187, 0.3909090909090909, 0.02727272727272728]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8566, 'compress@10': 0.9935, 'time@10': 4.5534}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8566, 'compress@10': 0.9935, 'time@10': 4.5534}:  10%|█         | 1/10 [00:02<00:21,  2.37s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8738, 'compress@10': 0.566, 'time@10': 4.1858}:  10%|█         | 1/10 [00:06<00:21,  2.37s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8738, 'compress@10': 0.566, 'time@10': 4.1858}:  20%|██        | 2/10 [00:06<00:25,  3.24s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8683, 'compress@10': 0.4251, 'time@10': 3.8173}:  20%|██        | 2/10 [00:07<00:25,  3.24s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8683, 'compress@10': 0.4251, 'time@10': 3.8173}:  30%|███       | 3/10 [00:07<00:17,  2.49s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8684, 'compress@10': 0.5607, 'time@10': 3.799}:  30%|███       | 3/10 [00:11<00:17,  2.49s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8684, 'compress@10': 0.5607, 'time@10': 3.799}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.036, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8566, 'compress@10': 0.6485, 'time@10': 4.7183}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.036, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8566, 'compress@10': 0.6485, 'time@10': 4.7183}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0369, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8567, 'compress@10': 0.707, 'time@10': 4.9763}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0369, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8567, 'compress@10': 0.707, 'time@10': 4.9763}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0365, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8617, 'compress@10': 0.6124, 'time@10': 5.2317}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0365, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8617, 'compress@10': 0.6124, 'time@10': 5.2317}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0367, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8635, 'compress@10': 0.5985, 'time@10': 5.1666}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0367, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8635, 'compress@10': 0.5985, 'time@10': 5.1666}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.037, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8776, 'compress@10': 0.541, 'time@10': 5.5375}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it] {'epoch': 10, 'num_users': 6.3333, 'loss': 0.037, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8776, 'compress@10': 0.541, 'time@10': 5.5375}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.88, 'ndcg@10': 0.8801, 'compress@10': 0.4891, 'time@10': 5.5751}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.88, 'ndcg@10': 0.8801, 'compress@10': 0.4891, 'time@10': 5.5751}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.88, 'ndcg@10': 0.8801, 'compress@10': 0.4891, 'time@10': 5.5751}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03635718852205997
Avg hit ratio: 0.8800217993664512
Avg ndcg: 0.8801491890274266
Avg compression ratio: 0.4891461208889717
Avg train time: 5.575072979927063
Std train time: 1.816523706596019
[0.775, 0.3583333333333333, 0.1083333333333333, 0.6916666666666668, 0.9416666666666667, 0.8583333333333333, 0.19166666666666665, 0.4416666666666667, 0.44166666666666665, 0.025000000000000005]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0433, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8557, 'compress@10': 0.9958, 'time@10': 4.924}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0433, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8557, 'compress@10': 0.9958, 'time@10': 4.924}:  10%|█         | 1/10 [00:02<00:22,  2.51s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8732, 'compress@10': 0.5475, 'time@10': 4.4321}:  10%|█         | 1/10 [00:06<00:22,  2.51s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8732, 'compress@10': 0.5475, 'time@10': 4.4321}:  20%|██        | 2/10 [00:06<00:27,  3.38s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8679, 'compress@10': 0.4127, 'time@10': 4.0236}:  20%|██        | 2/10 [00:08<00:27,  3.38s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8679, 'compress@10': 0.4127, 'time@10': 4.0236}:  30%|███       | 3/10 [00:08<00:18,  2.59s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8712, 'compress@10': 0.5563, 'time@10': 3.962}:  30%|███       | 3/10 [00:11<00:18,  2.59s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8712, 'compress@10': 0.5563, 'time@10': 3.962}:  40%|████      | 4/10 [00:11<00:18,  3.08s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0354, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8588, 'compress@10': 0.6451, 'time@10': 4.8346}:  40%|████      | 4/10 [00:16<00:18,  3.08s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0354, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8588, 'compress@10': 0.6451, 'time@10': 4.8346}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0364, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8614, 'compress@10': 0.7041, 'time@10': 5.0588}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0364, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8614, 'compress@10': 0.7041, 'time@10': 5.0588}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0362, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8632, 'compress@10': 0.6097, 'time@10': 5.2871}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it] {'epoch': 11, 'num_users': 6.2857, 'loss': 0.0362, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8632, 'compress@10': 0.6097, 'time@10': 5.2871}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0361, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8669, 'compress@10': 0.5588, 'time@10': 5.2281}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0361, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8669, 'compress@10': 0.5588, 'time@10': 5.2281}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0364, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.8757, 'compress@10': 0.5168, 'time@10': 5.5825}:  80%|████████  | 8/10 [00:34<00:08,  4.33s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0364, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.8757, 'compress@10': 0.5168, 'time@10': 5.5825}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8773, 'compress@10': 0.4674, 'time@10': 5.6123}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8773, 'compress@10': 0.4674, 'time@10': 5.6123}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8773, 'compress@10': 0.4674, 'time@10': 5.6123}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03581205846222925
Avg hit ratio: 0.8844278144040454
Avg ndcg: 0.8772853394654563
Avg compression ratio: 0.46742322988462687
Avg train time: 5.612300300598145
Std train time: 1.7255859502960311
[0.7923076923076924, 0.3307692307692307, 0.09999999999999996, 0.7153846153846155, 0.9461538461538461, 0.8692307692307691, 0.1769230769230769, 0.40769230769230774, 0.4846153846153846, 0.02307692307692308]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8634, 'compress@10': 0.9971, 'time@10': 4.685}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8634, 'compress@10': 0.9971, 'time@10': 4.685}:  10%|█         | 1/10 [00:02<00:21,  2.38s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8793, 'compress@10': 0.5382, 'time@10': 4.1754}:  10%|█         | 1/10 [00:06<00:21,  2.38s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8793, 'compress@10': 0.5382, 'time@10': 4.1754}:  20%|██        | 2/10 [00:06<00:25,  3.16s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8719, 'compress@10': 0.4065, 'time@10': 3.8868}:  20%|██        | 2/10 [00:07<00:25,  3.16s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8719, 'compress@10': 0.4065, 'time@10': 3.8868}:  30%|███       | 3/10 [00:07<00:17,  2.49s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8733, 'compress@10': 0.5536, 'time@10': 3.8601}:  30%|███       | 3/10 [00:11<00:17,  2.49s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8733, 'compress@10': 0.5536, 'time@10': 3.8601}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0338, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8613, 'compress@10': 0.6429, 'time@10': 4.7606}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0338, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8613, 'compress@10': 0.6429, 'time@10': 4.7606}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0338, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8657, 'compress@10': 0.7023, 'time@10': 5.0016}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0338, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8657, 'compress@10': 0.7023, 'time@10': 5.0016}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0324, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8715, 'compress@10': 0.608, 'time@10': 5.2573}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it] {'epoch': 12, 'num_users': 6.2857, 'loss': 0.0324, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8715, 'compress@10': 0.608, 'time@10': 5.2573}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0321, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8749, 'compress@10': 0.5486, 'time@10': 5.1946}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0321, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8749, 'compress@10': 0.5486, 'time@10': 5.1946}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8816, 'compress@10': 0.5472, 'time@10': 5.5314}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8816, 'compress@10': 0.5472, 'time@10': 5.5314}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8859, 'compress@10': 0.4948, 'time@10': 5.5764}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8859, 'compress@10': 0.4948, 'time@10': 5.5764}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8859, 'compress@10': 0.4948, 'time@10': 5.5764}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.030652741552871055
Avg hit ratio: 0.874630579381004
Avg ndcg: 0.8858650507177777
Avg compression ratio: 0.494766495172504
Avg train time: 5.576422595977784
Std train time: 1.7407537962335506
[0.8071428571428572, 0.3071428571428571, 0.09285714285714282, 0.7357142857142859, 0.95, 0.8785714285714284, 0.16428571428571426, 0.45000000000000007, 0.45, 0.021428571428571432]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8566, 'compress@10': 0.998, 'time@10': 5.0547}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8566, 'compress@10': 0.998, 'time@10': 5.0547}:  10%|█         | 1/10 [00:02<00:23,  2.57s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8791, 'compress@10': 0.5344, 'time@10': 4.3263}:  10%|█         | 1/10 [00:06<00:23,  2.57s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8791, 'compress@10': 0.5344, 'time@10': 4.3263}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8718, 'compress@10': 0.404, 'time@10': 4.0103}:  20%|██        | 2/10 [00:07<00:25,  3.20s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8718, 'compress@10': 0.404, 'time@10': 4.0103}:  30%|███       | 3/10 [00:07<00:17,  2.53s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8725, 'compress@10': 0.5523, 'time@10': 3.9606}:  30%|███       | 3/10 [00:11<00:17,  2.53s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8725, 'compress@10': 0.5523, 'time@10': 3.9606}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0341, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8612, 'compress@10': 0.6418, 'time@10': 4.8453}:  40%|████      | 4/10 [00:16<00:18,  3.05s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0341, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8612, 'compress@10': 0.6418, 'time@10': 4.8453}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0336, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8654, 'compress@10': 0.7014, 'time@10': 5.0659}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0336, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8654, 'compress@10': 0.7014, 'time@10': 5.0659}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.872, 'compress@10': 0.6072, 'time@10': 5.3184}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it] {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.872, 'compress@10': 0.6072, 'time@10': 5.3184}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.032, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.8758, 'compress@10': 0.5591, 'time@10': 5.2476}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.032, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.8758, 'compress@10': 0.5591, 'time@10': 5.2476}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0307, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8821, 'compress@10': 0.5196, 'time@10': 5.5899}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0307, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8821, 'compress@10': 0.5196, 'time@10': 5.5899}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8899, 'compress@10': 0.4699, 'time@10': 5.6242}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8899, 'compress@10': 0.4699, 'time@10': 5.6242}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8899, 'compress@10': 0.4699, 'time@10': 5.6242}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.030663906481503588
Avg hit ratio: 0.8775932279378799
Avg ndcg: 0.8898789100710969
Avg compression ratio: 0.4699071783657317
Avg train time: 5.624189496040344
Std train time: 1.7408881000140082
[0.8200000000000001, 0.2866666666666666, 0.08666666666666663, 0.7533333333333335, 0.9533333333333333, 0.8866666666666666, 0.21999999999999997, 0.42000000000000004, 0.42, 0.020000000000000004]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8732, 'compress@10': 0.9987, 'time@10': 4.708}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8732, 'compress@10': 0.9987, 'time@10': 4.708}:  10%|█         | 1/10 [00:02<00:21,  2.39s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0329, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.888, 'compress@10': 0.5306, 'time@10': 4.2646}:  10%|█         | 1/10 [00:06<00:21,  2.39s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0329, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.888, 'compress@10': 0.5306, 'time@10': 4.2646}:  20%|██        | 2/10 [00:06<00:26,  3.26s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8777, 'compress@10': 0.4014, 'time@10': 3.9439}:  20%|██        | 2/10 [00:07<00:26,  3.26s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8777, 'compress@10': 0.4014, 'time@10': 3.9439}:  30%|███       | 3/10 [00:07<00:17,  2.55s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.88, 'compress@10': 0.5506, 'time@10': 3.904}:  30%|███       | 3/10 [00:11<00:17,  2.55s/it]   {'epoch': 14, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.88, 'compress@10': 0.5506, 'time@10': 3.904}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0311, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8681, 'compress@10': 0.6405, 'time@10': 4.7943}:  40%|████      | 4/10 [00:16<00:18,  3.05s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0311, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8681, 'compress@10': 0.6405, 'time@10': 4.7943}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0325, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8727, 'compress@10': 0.7003, 'time@10': 5.0315}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0325, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8727, 'compress@10': 0.7003, 'time@10': 5.0315}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0334, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8719, 'compress@10': 0.6067, 'time@10': 5.2754}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0334, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8719, 'compress@10': 0.6067, 'time@10': 5.2754}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.882, 'ndcg@10': 0.8778, 'compress@10': 0.5496, 'time@10': 5.2096}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]  {'epoch': 14, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.882, 'ndcg@10': 0.8778, 'compress@10': 0.5496, 'time@10': 5.2096}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8847, 'compress@10': 0.504, 'time@10': 5.5885}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8847, 'compress@10': 0.504, 'time@10': 5.5885}:  90%|█████████ | 9/10 [00:34<00:04,  4.32s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0309, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.8875, 'compress@10': 0.4559, 'time@10': 5.6258}:  90%|█████████ | 9/10 [00:40<00:04,  4.32s/it]  {'epoch': 14, 'num_users': 6.3, 'loss': 0.0309, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.8875, 'compress@10': 0.4559, 'time@10': 5.6258}: 100%|██████████| 10/10 [00:40<00:00,  4.84s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0309, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.8875, 'compress@10': 0.4559, 'time@10': 5.6258}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.030897721698621112
Avg hit ratio: 0.8833075136521655
Avg ndcg: 0.8874753265522898
Avg compression ratio: 0.4559004876407477
Avg train time: 5.6257964134216305
Std train time: 1.7824786717640022
[0.83125, 0.26874999999999993, 0.08124999999999996, 0.7687500000000002, 0.9562499999999999, 0.8937499999999999, 0.26875, 0.39375000000000004, 0.39375, 0.018750000000000003]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.034, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8711, 'compress@10': 0.9991, 'time@10': 4.8355}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.034, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8711, 'compress@10': 0.9991, 'time@10': 4.8355}:  10%|█         | 1/10 [00:02<00:22,  2.46s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8931, 'compress@10': 0.525, 'time@10': 4.3322}:  10%|█         | 1/10 [00:06<00:22,  2.46s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8931, 'compress@10': 0.525, 'time@10': 4.3322}:  20%|██        | 2/10 [00:06<00:26,  3.29s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8811, 'compress@10': 0.3977, 'time@10': 3.9986}:  20%|██        | 2/10 [00:08<00:26,  3.29s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8811, 'compress@10': 0.3977, 'time@10': 3.9986}:  30%|███       | 3/10 [00:08<00:17,  2.57s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8821, 'compress@10': 0.5479, 'time@10': 3.9385}:  30%|███       | 3/10 [00:11<00:17,  2.57s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8821, 'compress@10': 0.5479, 'time@10': 3.9385}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.028, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.872, 'compress@10': 0.6383, 'time@10': 4.8162}:  40%|████      | 4/10 [00:16<00:18,  3.05s/it]  {'epoch': 15, 'num_users': 5.8, 'loss': 0.028, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.872, 'compress@10': 0.6383, 'time@10': 4.8162}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8792, 'compress@10': 0.6986, 'time@10': 5.0468}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8792, 'compress@10': 0.6986, 'time@10': 5.0468}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0272, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8819, 'compress@10': 0.6063, 'time@10': 5.2977}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0272, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8819, 'compress@10': 0.6063, 'time@10': 5.2977}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.026, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.8874, 'compress@10': 0.5422, 'time@10': 5.2303}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]  {'epoch': 15, 'num_users': 6.125, 'loss': 0.026, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.8874, 'compress@10': 0.5422, 'time@10': 5.2303}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0259, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8941, 'compress@10': 0.4942, 'time@10': 5.5912}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0259, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8941, 'compress@10': 0.4942, 'time@10': 5.5912}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8998, 'compress@10': 0.4471, 'time@10': 5.6302}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8998, 'compress@10': 0.4471, 'time@10': 5.6302}: 100%|██████████| 10/10 [00:40<00:00,  4.85s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8998, 'compress@10': 0.4471, 'time@10': 5.6302}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.02480263552738327
Avg hit ratio: 0.8755932279378799
Avg ndcg: 0.8997760626009363
Avg compression ratio: 0.4470531917051249
Avg train time: 5.630187559127807
Std train time: 1.7503314414308
[0.8411764705882353, 0.3117647058823529, 0.07647058823529408, 0.7823529411764707, 0.9588235294117646, 0.8999999999999999, 0.2529411764705882, 0.37058823529411766, 0.37058823529411766, 0.017647058823529415]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8664, 'compress@10': 0.9996, 'time@10': 4.987}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8664, 'compress@10': 0.9996, 'time@10': 4.987}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8951, 'compress@10': 0.5305, 'time@10': 4.3721}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8951, 'compress@10': 0.5305, 'time@10': 4.3721}:  20%|██        | 2/10 [00:06<00:26,  3.28s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8825, 'compress@10': 0.4013, 'time@10': 4.0199}:  20%|██        | 2/10 [00:08<00:26,  3.28s/it]  {'epoch': 16, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8825, 'compress@10': 0.4013, 'time@10': 4.0199}:  30%|███       | 3/10 [00:08<00:17,  2.56s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8856, 'compress@10': 0.5508, 'time@10': 3.9607}:  30%|███       | 3/10 [00:11<00:17,  2.56s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8856, 'compress@10': 0.5508, 'time@10': 3.9607}:  40%|████      | 4/10 [00:11<00:18,  3.06s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0274, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8776, 'compress@10': 0.6406, 'time@10': 4.8263}:  40%|████      | 4/10 [00:16<00:18,  3.06s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0274, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8776, 'compress@10': 0.6406, 'time@10': 4.8263}:  50%|█████     | 5/10 [00:16<00:17,  3.46s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0262, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8866, 'compress@10': 0.7005, 'time@10': 5.0587}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0262, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8866, 'compress@10': 0.7005, 'time@10': 5.0587}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.026, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8917, 'compress@10': 0.6078, 'time@10': 5.3021}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it] {'epoch': 16, 'num_users': 6.2857, 'loss': 0.026, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8917, 'compress@10': 0.6078, 'time@10': 5.3021}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0254, 'hit_ratio@10': 0.882, 'ndcg@10': 0.8945, 'compress@10': 0.5398, 'time@10': 5.2422}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0254, 'hit_ratio@10': 0.882, 'ndcg@10': 0.8945, 'compress@10': 0.5398, 'time@10': 5.2422}:  80%|████████  | 8/10 [00:30<00:08,  4.34s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9101, 'compress@10': 0.4901, 'time@10': 5.6471}:  80%|████████  | 8/10 [00:35<00:08,  4.34s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9101, 'compress@10': 0.4901, 'time@10': 5.6471}:  90%|█████████ | 9/10 [00:35<00:04,  4.38s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0261, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.9093, 'compress@10': 0.4434, 'time@10': 5.6721}:  90%|█████████ | 9/10 [00:41<00:04,  4.38s/it]  {'epoch': 16, 'num_users': 6.3, 'loss': 0.0261, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.9093, 'compress@10': 0.4434, 'time@10': 5.6721}: 100%|██████████| 10/10 [00:41<00:00,  4.86s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0261, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.9093, 'compress@10': 0.4434, 'time@10': 5.6721}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.026142425007884496
Avg hit ratio: 0.8861646565093084
Avg ndcg: 0.9092702511235755
Avg compression ratio: 0.4433978450886532
Avg train time: 5.6720740556716915
Std train time: 1.8082920580256956
[0.85, 0.2944444444444444, 0.07222222222222219, 0.7944444444444445, 0.961111111111111, 0.8499999999999999, 0.23888888888888887, 0.35000000000000003, 0.40555555555555556, 0.07222222222222223]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8373, 'compress@10': 0.9997, 'time@10': 4.7849}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8373, 'compress@10': 0.9997, 'time@10': 4.7849}:  10%|█         | 1/10 [00:02<00:21,  2.43s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8802, 'compress@10': 0.5247, 'time@10': 4.254}:  10%|█         | 1/10 [00:06<00:21,  2.43s/it]  {'epoch': 17, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8802, 'compress@10': 0.5247, 'time@10': 4.254}:  20%|██        | 2/10 [00:06<00:25,  3.21s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8725, 'compress@10': 0.3974, 'time@10': 3.9412}:  20%|██        | 2/10 [00:07<00:25,  3.21s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8725, 'compress@10': 0.3974, 'time@10': 3.9412}:  30%|███       | 3/10 [00:07<00:17,  2.53s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.878, 'compress@10': 0.548, 'time@10': 3.9001}:  30%|███       | 3/10 [00:11<00:17,  2.53s/it]  {'epoch': 17, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.878, 'compress@10': 0.548, 'time@10': 3.9001}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.029, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8721, 'compress@10': 0.6384, 'time@10': 4.7734}:  40%|████      | 4/10 [00:15<00:18,  3.04s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.029, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8721, 'compress@10': 0.6384, 'time@10': 4.7734}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0297, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8835, 'compress@10': 0.6986, 'time@10': 5.0006}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0297, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8835, 'compress@10': 0.6986, 'time@10': 5.0006}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0304, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8855, 'compress@10': 0.6053, 'time@10': 5.2749}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0304, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8855, 'compress@10': 0.6053, 'time@10': 5.2749}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0292, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.8907, 'compress@10': 0.5367, 'time@10': 5.22}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]   {'epoch': 17, 'num_users': 6.125, 'loss': 0.0292, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.8907, 'compress@10': 0.5367, 'time@10': 5.22}:  80%|████████  | 8/10 [00:30<00:08,  4.34s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0306, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9174, 'compress@10': 0.4966, 'time@10': 5.593}:  80%|████████  | 8/10 [00:34<00:08,  4.34s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0306, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.9174, 'compress@10': 0.4966, 'time@10': 5.593}:  90%|█████████ | 9/10 [00:34<00:04,  4.34s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0285, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9212, 'compress@10': 0.4493, 'time@10': 5.6122}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0285, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9212, 'compress@10': 0.4493, 'time@10': 5.6122}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0285, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9212, 'compress@10': 0.4493, 'time@10': 5.6122}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02845372217206455
Avg hit ratio: 0.8788118659307115
Avg ndcg: 0.9212190807127122
Avg compression ratio: 0.4492730857572709
Avg train time: 5.612194561958313
Std train time: 1.7706244579422474
[0.8578947368421053, 0.2789473684210526, 0.06842105263157891, 0.7526315789473685, 0.963157894736842, 0.8578947368421052, 0.2789473684210526, 0.3315789473684211, 0.4368421052631579, 0.06842105263157895]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0341, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8813, 'compress@10': 0.9998, 'time@10': 4.9812}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0341, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8813, 'compress@10': 0.9998, 'time@10': 4.9812}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.798, 'ndcg@10': 0.9036, 'compress@10': 0.522, 'time@10': 4.4351}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]  {'epoch': 18, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.798, 'ndcg@10': 0.9036, 'compress@10': 0.522, 'time@10': 4.4351}:  20%|██        | 2/10 [00:06<00:26,  3.36s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8881, 'compress@10': 0.3956, 'time@10': 4.0736}:  20%|██        | 2/10 [00:08<00:26,  3.36s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8881, 'compress@10': 0.3956, 'time@10': 4.0736}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8957, 'compress@10': 0.5465, 'time@10': 4.0005}:  30%|███       | 3/10 [00:12<00:18,  2.61s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8957, 'compress@10': 0.5465, 'time@10': 4.0005}:  40%|████      | 4/10 [00:12<00:18,  3.09s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.888, 'compress@10': 0.6372, 'time@10': 4.8916}:  40%|████      | 4/10 [00:16<00:18,  3.09s/it] {'epoch': 18, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.888, 'compress@10': 0.6372, 'time@10': 4.8916}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0247, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8958, 'compress@10': 0.6976, 'time@10': 5.1137}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0247, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8958, 'compress@10': 0.6976, 'time@10': 5.1137}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0244, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8961, 'compress@10': 0.6053, 'time@10': 5.3469}:  60%|██████    | 6/10 [00:25<00:17,  4.45s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0244, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8961, 'compress@10': 0.6053, 'time@10': 5.3469}:  70%|███████   | 7/10 [00:25<00:12,  4.11s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8972, 'compress@10': 0.536, 'time@10': 5.2681}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it]  {'epoch': 18, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8972, 'compress@10': 0.536, 'time@10': 5.2681}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.028, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9136, 'compress@10': 0.5107, 'time@10': 5.637}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.028, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9136, 'compress@10': 0.5107, 'time@10': 5.637}:  90%|█████████ | 9/10 [00:35<00:04,  4.32s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.029, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9214, 'compress@10': 0.4619, 'time@10': 5.6521}:  90%|█████████ | 9/10 [00:40<00:04,  4.32s/it]  {'epoch': 18, 'num_users': 6.3, 'loss': 0.029, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9214, 'compress@10': 0.4619, 'time@10': 5.6521}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.029, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9214, 'compress@10': 0.4619, 'time@10': 5.6521}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.028998178121531076
Avg hit ratio: 0.8823039294227749
Avg ndcg: 0.9214443793148666
Avg compression ratio: 0.4618984524576827
Avg train time: 5.652051711082459
Std train time: 1.7678031046749783
[0.865, 0.26499999999999996, 0.06499999999999996, 0.7650000000000001, 0.9649999999999999, 0.815, 0.26499999999999996, 0.31500000000000006, 0.465, 0.115]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0326, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8684, 'compress@10': 0.9998, 'time@10': 4.8045}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0326, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8684, 'compress@10': 0.9998, 'time@10': 4.8045}:  10%|█         | 1/10 [00:02<00:21,  2.44s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8982, 'compress@10': 0.521, 'time@10': 4.3124}:  10%|█         | 1/10 [00:06<00:21,  2.44s/it] {'epoch': 19, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8982, 'compress@10': 0.521, 'time@10': 4.3124}:  20%|██        | 2/10 [00:06<00:26,  3.28s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8845, 'compress@10': 0.395, 'time@10': 3.9701}:  20%|██        | 2/10 [00:07<00:26,  3.28s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8845, 'compress@10': 0.395, 'time@10': 3.9701}:  30%|███       | 3/10 [00:07<00:17,  2.55s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8952, 'compress@10': 0.5461, 'time@10': 3.927}:  30%|███       | 3/10 [00:11<00:17,  2.55s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8952, 'compress@10': 0.5461, 'time@10': 3.927}:  40%|████      | 4/10 [00:11<00:18,  3.06s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0236, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8885, 'compress@10': 0.6369, 'time@10': 4.814}:  40%|████      | 4/10 [00:16<00:18,  3.06s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0236, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8885, 'compress@10': 0.6369, 'time@10': 4.814}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0227, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8976, 'compress@10': 0.6972, 'time@10': 5.0503}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0227, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8976, 'compress@10': 0.6972, 'time@10': 5.0503}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.022, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9029, 'compress@10': 0.6044, 'time@10': 5.3012}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.022, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9029, 'compress@10': 0.6044, 'time@10': 5.3012}:  70%|███████   | 7/10 [00:25<00:12,  4.11s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0215, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9061, 'compress@10': 0.5343, 'time@10': 5.2353}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0215, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9061, 'compress@10': 0.5343, 'time@10': 5.2353}:  80%|████████  | 8/10 [00:30<00:08,  4.34s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.024, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9041, 'compress@10': 0.5314, 'time@10': 5.6101}:  80%|████████  | 8/10 [00:34<00:08,  4.34s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.024, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9041, 'compress@10': 0.5314, 'time@10': 5.6101}:  90%|█████████ | 9/10 [00:34<00:04,  4.34s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9088, 'compress@10': 0.4805, 'time@10': 5.6198}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9088, 'compress@10': 0.4805, 'time@10': 5.6198}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9088, 'compress@10': 0.4805, 'time@10': 5.6198}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.02348305310432649
Avg hit ratio: 0.8827667531487565
Avg ndcg: 0.9088087708439673
Avg compression ratio: 0.4805418074795253
Avg train time: 5.619768047332764
Std train time: 1.7784340166956893
[0.8714285714285714, 0.29999999999999993, 0.061904761904761865, 0.7761904761904763, 0.9666666666666666, 0.7761904761904761, 0.2523809523809523, 0.30000000000000004, 0.4904761904761905, 0.10952380952380952]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8647, 'compress@10': 0.9998, 'time@10': 4.855}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8647, 'compress@10': 0.9998, 'time@10': 4.855}:  10%|█         | 1/10 [00:02<00:22,  2.47s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9051, 'compress@10': 0.5275, 'time@10': 4.2788}:  10%|█         | 1/10 [00:06<00:22,  2.47s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9051, 'compress@10': 0.5275, 'time@10': 4.2788}:  20%|██        | 2/10 [00:06<00:25,  3.22s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8891, 'compress@10': 0.3993, 'time@10': 3.9561}:  20%|██        | 2/10 [00:07<00:25,  3.22s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8891, 'compress@10': 0.3993, 'time@10': 3.9561}:  30%|███       | 3/10 [00:07<00:17,  2.52s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9015, 'compress@10': 0.5494, 'time@10': 3.9117}:  30%|███       | 3/10 [00:11<00:17,  2.52s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9015, 'compress@10': 0.5494, 'time@10': 3.9117}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.023, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8956, 'compress@10': 0.6395, 'time@10': 4.7862}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.023, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8956, 'compress@10': 0.6395, 'time@10': 4.7862}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9064, 'compress@10': 0.699, 'time@10': 5.0305}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0239, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9064, 'compress@10': 0.699, 'time@10': 5.0305}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0248, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.907, 'compress@10': 0.6057, 'time@10': 5.2778}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0248, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.907, 'compress@10': 0.6057, 'time@10': 5.2778}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9095, 'compress@10': 0.5349, 'time@10': 5.2058}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9095, 'compress@10': 0.5349, 'time@10': 5.2058}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0258, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9284, 'compress@10': 0.5611, 'time@10': 5.5837}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0258, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9284, 'compress@10': 0.5611, 'time@10': 5.5837}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0238, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9326, 'compress@10': 0.5073, 'time@10': 5.6166}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0238, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9326, 'compress@10': 0.5073, 'time@10': 5.6166}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0238, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9326, 'compress@10': 0.5073, 'time@10': 5.6166}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.023824923790586473
Avg hit ratio: 0.9051727681863506
Avg ndcg: 0.932567838877754
Avg compression ratio: 0.5072632424339989
Avg train time: 5.616607928276062
Std train time: 1.7785838567471939
[0.8772727272727273, 0.2863636363636363, 0.059090909090909055, 0.7409090909090911, 0.968181818181818, 0.7863636363636363, 0.2863636363636363, 0.28636363636363643, 0.5136363636363637, 0.10454545454545454]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8786, 'compress@10': 0.9999, 'time@10': 4.7224}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8786, 'compress@10': 0.9999, 'time@10': 4.7224}:  10%|█         | 1/10 [00:02<00:21,  2.42s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9157, 'compress@10': 0.5227, 'time@10': 4.247}:  10%|█         | 1/10 [00:06<00:21,  2.42s/it] {'epoch': 21, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9157, 'compress@10': 0.5227, 'time@10': 4.247}:  20%|██        | 2/10 [00:06<00:25,  3.24s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8962, 'compress@10': 0.3961, 'time@10': 3.948}:  20%|██        | 2/10 [00:07<00:25,  3.24s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8962, 'compress@10': 0.3961, 'time@10': 3.948}:  30%|███       | 3/10 [00:07<00:17,  2.54s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9076, 'compress@10': 0.5469, 'time@10': 3.8961}:  30%|███       | 3/10 [00:11<00:17,  2.54s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9076, 'compress@10': 0.5469, 'time@10': 3.8961}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9011, 'compress@10': 0.6375, 'time@10': 4.7768}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9011, 'compress@10': 0.6375, 'time@10': 4.7768}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0193, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9091, 'compress@10': 0.6974, 'time@10': 5.0478}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0193, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9091, 'compress@10': 0.6974, 'time@10': 5.0478}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9102, 'compress@10': 0.6053, 'time@10': 5.2866}:  60%|██████    | 6/10 [00:25<00:17,  4.47s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9102, 'compress@10': 0.6053, 'time@10': 5.2866}:  70%|███████   | 7/10 [00:25<00:12,  4.12s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0194, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9123, 'compress@10': 0.5339, 'time@10': 5.1981}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.0194, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9123, 'compress@10': 0.5339, 'time@10': 5.1981}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9147, 'compress@10': 0.5589, 'time@10': 5.5832}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9147, 'compress@10': 0.5589, 'time@10': 5.5832}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.914, 'compress@10': 0.5053, 'time@10': 5.5867}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]    {'epoch': 21, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.914, 'compress@10': 0.5053, 'time@10': 5.5867}: 100%|██████████| 10/10 [00:40<00:00,  4.73s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.914, 'compress@10': 0.5053, 'time@10': 5.5867}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.02189796695013562
Avg hit ratio: 0.8943791173926998
Avg ndcg: 0.9139688622776501
Avg compression ratio: 0.505284555681264
Avg train time: 5.5866827964782715
Std train time: 1.7958027876010996
[0.8826086956521739, 0.27391304347826084, 0.05652173913043475, 0.7521739130434785, 0.9695652173913042, 0.7521739130434781, 0.27391304347826084, 0.27391304347826095, 0.5347826086956522, 0.14347826086956522]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0298, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8756, 'compress@10': 0.9999, 'time@10': 4.7089}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0298, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8756, 'compress@10': 0.9999, 'time@10': 4.7089}:  10%|█         | 1/10 [00:02<00:21,  2.39s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9125, 'compress@10': 0.5196, 'time@10': 4.2176}:  10%|█         | 1/10 [00:06<00:21,  2.39s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9125, 'compress@10': 0.5196, 'time@10': 4.2176}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.894, 'compress@10': 0.3941, 'time@10': 3.9101}:  20%|██        | 2/10 [00:07<00:25,  3.20s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.894, 'compress@10': 0.3941, 'time@10': 3.9101}:  30%|███       | 3/10 [00:07<00:17,  2.51s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9076, 'compress@10': 0.5454, 'time@10': 3.8665}:  30%|███       | 3/10 [00:11<00:17,  2.51s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9076, 'compress@10': 0.5454, 'time@10': 3.8665}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9017, 'compress@10': 0.6363, 'time@10': 4.7573}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0197, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9017, 'compress@10': 0.6363, 'time@10': 4.7573}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0197, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9096, 'compress@10': 0.696, 'time@10': 5.0157}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0197, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9096, 'compress@10': 0.696, 'time@10': 5.0157}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.915, 'compress@10': 0.6033, 'time@10': 5.2764}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.915, 'compress@10': 0.6033, 'time@10': 5.2764}:  70%|███████   | 7/10 [00:25<00:12,  4.12s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.018, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9178, 'compress@10': 0.5319, 'time@10': 5.1943}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.018, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9178, 'compress@10': 0.5319, 'time@10': 5.1943}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9343, 'compress@10': 0.5714, 'time@10': 5.5853}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it] {'epoch': 22, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9343, 'compress@10': 0.5714, 'time@10': 5.5853}:  90%|█████████ | 9/10 [00:34<00:04,  4.32s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9383, 'compress@10': 0.5166, 'time@10': 5.5929}:  90%|█████████ | 9/10 [00:40<00:04,  4.32s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9383, 'compress@10': 0.5166, 'time@10': 5.5929}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9383, 'compress@10': 0.5166, 'time@10': 5.5929}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.019207359575662976
Avg hit ratio: 0.9023156253292077
Avg ndcg: 0.9382777873094774
Avg compression ratio: 0.5166137260316814
Avg train time: 5.592900371551513
Std train time: 1.8217947787535766
[0.8875, 0.26249999999999996, 0.054166666666666634, 0.7625000000000002, 0.9708333333333332, 0.7624999999999998, 0.26249999999999996, 0.26250000000000007, 0.5541666666666667, 0.1375]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.905, 'compress@10': 0.9999, 'time@10': 4.6078}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.905, 'compress@10': 0.9999, 'time@10': 4.6078}:  10%|█         | 1/10 [00:02<00:21,  2.34s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9316, 'compress@10': 0.5188, 'time@10': 4.1944}:  10%|█         | 1/10 [00:06<00:21,  2.34s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9316, 'compress@10': 0.5188, 'time@10': 4.1944}:  20%|██        | 2/10 [00:06<00:25,  3.21s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9068, 'compress@10': 0.3935, 'time@10': 3.8678}:  20%|██        | 2/10 [00:07<00:25,  3.21s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9068, 'compress@10': 0.3935, 'time@10': 3.8678}:  30%|███       | 3/10 [00:07<00:17,  2.50s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9184, 'compress@10': 0.545, 'time@10': 3.8295}:  30%|███       | 3/10 [00:11<00:17,  2.50s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9184, 'compress@10': 0.545, 'time@10': 3.8295}:  40%|████      | 4/10 [00:11<00:17,  2.99s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.912, 'compress@10': 0.636, 'time@10': 4.7104}:  40%|████      | 4/10 [00:15<00:17,  2.99s/it] {'epoch': 23, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.912, 'compress@10': 0.636, 'time@10': 4.7104}:  50%|█████     | 5/10 [00:15<00:17,  3.41s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0182, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9218, 'compress@10': 0.6959, 'time@10': 4.9504}:  50%|█████     | 5/10 [00:21<00:17,  3.41s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0182, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9218, 'compress@10': 0.6959, 'time@10': 4.9504}:  60%|██████    | 6/10 [00:21<00:17,  4.36s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9202, 'compress@10': 0.6029, 'time@10': 5.2037}:  60%|██████    | 6/10 [00:25<00:17,  4.36s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9202, 'compress@10': 0.6029, 'time@10': 5.2037}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9217, 'compress@10': 0.5315, 'time@10': 5.1233}:  70%|███████   | 7/10 [00:29<00:12,  4.04s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9217, 'compress@10': 0.5315, 'time@10': 5.1233}:  80%|████████  | 8/10 [00:29<00:08,  4.22s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9228, 'compress@10': 0.5718, 'time@10': 5.51}:  80%|████████  | 8/10 [00:34<00:08,  4.22s/it] {'epoch': 23, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9228, 'compress@10': 0.5718, 'time@10': 5.51}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9282, 'compress@10': 0.517, 'time@10': 5.5407}:  90%|█████████ | 9/10 [00:40<00:04,  4.26s/it]  {'epoch': 23, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9282, 'compress@10': 0.517, 'time@10': 5.5407}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9282, 'compress@10': 0.517, 'time@10': 5.5407}: 100%|██████████| 10/10 [00:40<00:00,  4.01s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.02092264903735994
Avg hit ratio: 0.8799096102916136
Avg ndcg: 0.9282132406442862
Avg compression ratio: 0.5169567605748058
Avg train time: 5.540709495544434
Std train time: 1.7930799182807622
[0.852, 0.25199999999999995, 0.05199999999999997, 0.7320000000000002, 0.9719999999999999, 0.7719999999999998, 0.292, 0.25200000000000006, 0.5720000000000001, 0.17200000000000001]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9012, 'compress@10': 0.9998, 'time@10': 4.9332}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9012, 'compress@10': 0.9998, 'time@10': 4.9332}:  10%|█         | 1/10 [00:02<00:22,  2.51s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9276, 'compress@10': 0.5181, 'time@10': 4.3757}:  10%|█         | 1/10 [00:06<00:22,  2.51s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9276, 'compress@10': 0.5181, 'time@10': 4.3757}:  20%|██        | 2/10 [00:06<00:26,  3.30s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9041, 'compress@10': 0.393, 'time@10': 4.0189}:  20%|██        | 2/10 [00:08<00:26,  3.30s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9041, 'compress@10': 0.393, 'time@10': 4.0189}:  30%|███       | 3/10 [00:08<00:17,  2.57s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9166, 'compress@10': 0.5446, 'time@10': 3.9615}:  30%|███       | 3/10 [00:11<00:17,  2.57s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9166, 'compress@10': 0.5446, 'time@10': 3.9615}:  40%|████      | 4/10 [00:11<00:18,  3.08s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9114, 'compress@10': 0.6356, 'time@10': 4.8363}:  40%|████      | 4/10 [00:16<00:18,  3.08s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9114, 'compress@10': 0.6356, 'time@10': 4.8363}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0172, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9199, 'compress@10': 0.696, 'time@10': 5.0693}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0172, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9199, 'compress@10': 0.696, 'time@10': 5.0693}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9197, 'compress@10': 0.6036, 'time@10': 5.308}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9197, 'compress@10': 0.6036, 'time@10': 5.308}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9244, 'compress@10': 0.532, 'time@10': 5.2165}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9244, 'compress@10': 0.532, 'time@10': 5.2165}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9291, 'compress@10': 0.5781, 'time@10': 5.5944}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9291, 'compress@10': 0.5781, 'time@10': 5.5944}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9323, 'compress@10': 0.5227, 'time@10': 5.6204}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9323, 'compress@10': 0.5227, 'time@10': 5.6204}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9323, 'compress@10': 0.5227, 'time@10': 5.6204}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.01829187872996939
Avg hit ratio: 0.8999096102916135
Avg ndcg: 0.9322633230560635
Avg compression ratio: 0.5226681474067469
Avg train time: 5.620443987846374
Std train time: 1.7766891882620777
[0.8576923076923076, 0.24230769230769225, 0.04999999999999997, 0.7423076923076926, 0.973076923076923, 0.7423076923076921, 0.28076923076923077, 0.24230769230769236, 0.5884615384615385, 0.20384615384615384]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9075, 'compress@10': 0.9998, 'time@10': 4.8805}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9075, 'compress@10': 0.9998, 'time@10': 4.8805}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9406, 'compress@10': 0.5178, 'time@10': 4.3335}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9406, 'compress@10': 0.5178, 'time@10': 4.3335}:  20%|██        | 2/10 [00:06<00:26,  3.27s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.842, 'ndcg@10': 0.9127, 'compress@10': 0.3929, 'time@10': 3.993}:  20%|██        | 2/10 [00:08<00:26,  3.27s/it]  {'epoch': 25, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.842, 'ndcg@10': 0.9127, 'compress@10': 0.3929, 'time@10': 3.993}:  30%|███       | 3/10 [00:08<00:17,  2.55s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9234, 'compress@10': 0.5445, 'time@10': 3.9354}:  30%|███       | 3/10 [00:11<00:17,  2.55s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9234, 'compress@10': 0.5445, 'time@10': 3.9354}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9183, 'compress@10': 0.6356, 'time@10': 4.8019}:  40%|████      | 4/10 [00:15<00:18,  3.05s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9183, 'compress@10': 0.6356, 'time@10': 4.8019}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9259, 'compress@10': 0.6957, 'time@10': 5.0472}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9259, 'compress@10': 0.6957, 'time@10': 5.0472}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9297, 'compress@10': 0.603, 'time@10': 5.2812}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9297, 'compress@10': 0.603, 'time@10': 5.2812}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9308, 'compress@10': 0.5314, 'time@10': 5.2014}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9308, 'compress@10': 0.5314, 'time@10': 5.2014}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9337, 'compress@10': 0.5795, 'time@10': 5.5936}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9337, 'compress@10': 0.5795, 'time@10': 5.5936}:  90%|█████████ | 9/10 [00:34<00:04,  4.32s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.938, 'compress@10': 0.524, 'time@10': 5.6199}:  90%|█████████ | 9/10 [00:40<00:04,  4.32s/it]     {'epoch': 25, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.938, 'compress@10': 0.524, 'time@10': 5.6199}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.938, 'compress@10': 0.524, 'time@10': 5.6199}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.016601910703048037
Avg hit ratio: 0.9052552324114294
Avg ndcg: 0.9380212374966824
Avg compression ratio: 0.5239687777428299
Avg train time: 5.619942092895508
Std train time: 1.7874062355579583
[0.8629629629629629, 0.23333333333333328, 0.04814814814814812, 0.7518518518518521, 0.974074074074074, 0.7148148148148147, 0.27037037037037037, 0.2703703703703704, 0.6037037037037037, 0.1962962962962963]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.911, 'compress@10': 0.9998, 'time@10': 4.8635}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.911, 'compress@10': 0.9998, 'time@10': 4.8635}:  10%|█         | 1/10 [00:02<00:22,  2.47s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9392, 'compress@10': 0.5174, 'time@10': 4.4038}:  10%|█         | 1/10 [00:06<00:22,  2.47s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9392, 'compress@10': 0.5174, 'time@10': 4.4038}:  20%|██        | 2/10 [00:06<00:26,  3.36s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9119, 'compress@10': 0.3926, 'time@10': 4.0533}:  20%|██        | 2/10 [00:08<00:26,  3.36s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9119, 'compress@10': 0.3926, 'time@10': 4.0533}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.9222, 'compress@10': 0.5443, 'time@10': 3.9673}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.9222, 'compress@10': 0.5443, 'time@10': 3.9673}:  40%|████      | 4/10 [00:11<00:18,  3.06s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0153, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.9174, 'compress@10': 0.6354, 'time@10': 4.8484}:  40%|████      | 4/10 [00:16<00:18,  3.06s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0153, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.9174, 'compress@10': 0.6354, 'time@10': 4.8484}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9284, 'compress@10': 0.6949, 'time@10': 5.064}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9284, 'compress@10': 0.6949, 'time@10': 5.064}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0173, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.929, 'compress@10': 0.6019, 'time@10': 5.3078}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0173, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.929, 'compress@10': 0.6019, 'time@10': 5.3078}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9335, 'compress@10': 0.5307, 'time@10': 5.2311}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.9335, 'compress@10': 0.5307, 'time@10': 5.2311}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9357, 'compress@10': 0.5794, 'time@10': 5.6135}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9357, 'compress@10': 0.5794, 'time@10': 5.6135}:  90%|█████████ | 9/10 [00:34<00:04,  4.32s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9358, 'compress@10': 0.5238, 'time@10': 5.6232}:  90%|█████████ | 9/10 [00:40<00:04,  4.32s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9358, 'compress@10': 0.5238, 'time@10': 5.6232}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9358, 'compress@10': 0.5238, 'time@10': 5.6232}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.016324401350870002
Avg hit ratio: 0.8958266609828579
Avg ndcg: 0.9357575474384878
Avg compression ratio: 0.5238471043069625
Avg train time: 5.623200702667236
Std train time: 1.7758529719656373
[0.8678571428571429, 0.22499999999999995, 0.0464285714285714, 0.760714285714286, 0.9749999999999999, 0.7249999999999999, 0.26071428571428573, 0.2607142857142858, 0.5821428571428572, 0.225]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.911, 'compress@10': 0.9998, 'time@10': 4.7488}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.911, 'compress@10': 0.9998, 'time@10': 4.7488}:  10%|█         | 1/10 [00:02<00:21,  2.41s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9376, 'compress@10': 0.517, 'time@10': 4.2704}:  10%|█         | 1/10 [00:06<00:21,  2.41s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9376, 'compress@10': 0.517, 'time@10': 4.2704}:  20%|██        | 2/10 [00:06<00:25,  3.25s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9108, 'compress@10': 0.3923, 'time@10': 3.9641}:  20%|██        | 2/10 [00:07<00:25,  3.25s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9108, 'compress@10': 0.3923, 'time@10': 3.9641}:  30%|███       | 3/10 [00:07<00:17,  2.55s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.836, 'ndcg@10': 0.922, 'compress@10': 0.5441, 'time@10': 3.9181}:  30%|███       | 3/10 [00:11<00:17,  2.55s/it]  {'epoch': 27, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.836, 'ndcg@10': 0.922, 'compress@10': 0.5441, 'time@10': 3.9181}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9188, 'compress@10': 0.6353, 'time@10': 4.8193}:  40%|████      | 4/10 [00:16<00:18,  3.05s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9188, 'compress@10': 0.6353, 'time@10': 4.8193}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.928, 'compress@10': 0.6952, 'time@10': 5.0456}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.928, 'compress@10': 0.6952, 'time@10': 5.0456}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.929, 'compress@10': 0.602, 'time@10': 5.2905}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it] {'epoch': 27, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.929, 'compress@10': 0.602, 'time@10': 5.2905}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9288, 'compress@10': 0.5307, 'time@10': 5.207}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9288, 'compress@10': 0.5307, 'time@10': 5.207}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9326, 'compress@10': 0.5778, 'time@10': 5.5875}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9326, 'compress@10': 0.5778, 'time@10': 5.5875}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.896, 'ndcg@10': 0.937, 'compress@10': 0.5224, 'time@10': 5.6129}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]     {'epoch': 27, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.896, 'ndcg@10': 0.937, 'compress@10': 0.5224, 'time@10': 5.6129}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.896, 'ndcg@10': 0.937, 'compress@10': 0.5224, 'time@10': 5.6129}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.012501201866477768
Avg hit ratio: 0.8959731023551057
Avg ndcg: 0.9369902640478406
Avg compression ratio: 0.5224417055307802
Avg train time: 5.612897133827209
Std train time: 1.7949114390189722
[0.8724137931034484, 0.2172413793103448, 0.04482758620689652, 0.7689655172413796, 0.9758620689655171, 0.6999999999999998, 0.28620689655172415, 0.2862068965517242, 0.5620689655172414, 0.21724137931034485]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.917, 'compress@10': 0.9999, 'time@10': 4.6535}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.917, 'compress@10': 0.9999, 'time@10': 4.6535}:  10%|█         | 1/10 [00:02<00:21,  2.36s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9419, 'compress@10': 0.5169, 'time@10': 4.2367}:  10%|█         | 1/10 [00:06<00:21,  2.36s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9419, 'compress@10': 0.5169, 'time@10': 4.2367}:  20%|██        | 2/10 [00:06<00:25,  3.24s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9137, 'compress@10': 0.3922, 'time@10': 3.9619}:  20%|██        | 2/10 [00:07<00:25,  3.24s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9137, 'compress@10': 0.3922, 'time@10': 3.9619}:  30%|███       | 3/10 [00:07<00:17,  2.56s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9241, 'compress@10': 0.5441, 'time@10': 3.913}:  30%|███       | 3/10 [00:11<00:17,  2.56s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9241, 'compress@10': 0.5441, 'time@10': 3.913}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9223, 'compress@10': 0.6352, 'time@10': 4.7814}:  40%|████      | 4/10 [00:15<00:18,  3.05s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9223, 'compress@10': 0.6352, 'time@10': 4.7814}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9277, 'compress@10': 0.6948, 'time@10': 5.0084}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9277, 'compress@10': 0.6948, 'time@10': 5.0084}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9311, 'compress@10': 0.6019, 'time@10': 5.2539}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9311, 'compress@10': 0.6019, 'time@10': 5.2539}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9304, 'compress@10': 0.5309, 'time@10': 5.1753}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9304, 'compress@10': 0.5309, 'time@10': 5.1753}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9359, 'compress@10': 0.5759, 'time@10': 5.5554}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9359, 'compress@10': 0.5759, 'time@10': 5.5554}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9383, 'compress@10': 0.5208, 'time@10': 5.5788}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]      {'epoch': 28, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9383, 'compress@10': 0.5208, 'time@10': 5.5788}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9383, 'compress@10': 0.5208, 'time@10': 5.5788}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01704743414994595
Avg hit ratio: 0.8899925596003694
Avg ndcg: 0.9382596708070701
Avg compression ratio: 0.5207992904471975
Avg train time: 5.57878623008728
Std train time: 1.7544921648334273
[0.8766666666666667, 0.20999999999999996, 0.04333333333333331, 0.7433333333333336, 0.9766666666666665, 0.7099999999999999, 0.27666666666666667, 0.2766666666666667, 0.5766666666666667, 0.24333333333333335]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.917, 'compress@10': 0.9999, 'time@10': 4.8419}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.917, 'compress@10': 0.9999, 'time@10': 4.8419}:  10%|█         | 1/10 [00:02<00:22,  2.46s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9463, 'compress@10': 0.5168, 'time@10': 4.2396}:  10%|█         | 1/10 [00:06<00:22,  2.46s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9463, 'compress@10': 0.5168, 'time@10': 4.2396}:  20%|██        | 2/10 [00:06<00:25,  3.17s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9166, 'compress@10': 0.3922, 'time@10': 3.9336}:  20%|██        | 2/10 [00:07<00:25,  3.17s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9166, 'compress@10': 0.3922, 'time@10': 3.9336}:  30%|███       | 3/10 [00:07<00:17,  2.50s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9263, 'compress@10': 0.544, 'time@10': 3.8925}:  30%|███       | 3/10 [00:11<00:17,  2.50s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9263, 'compress@10': 0.544, 'time@10': 3.8925}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9253, 'compress@10': 0.6352, 'time@10': 4.7739}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9253, 'compress@10': 0.6352, 'time@10': 4.7739}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.9328, 'compress@10': 0.6949, 'time@10': 5.0002}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.9328, 'compress@10': 0.6949, 'time@10': 5.0002}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9347, 'compress@10': 0.602, 'time@10': 5.2417}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9347, 'compress@10': 0.602, 'time@10': 5.2417}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9382, 'compress@10': 0.5308, 'time@10': 5.1544}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9382, 'compress@10': 0.5308, 'time@10': 5.1544}:  80%|████████  | 8/10 [00:30<00:08,  4.22s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9598, 'compress@10': 0.5784, 'time@10': 5.5222}:  80%|████████  | 8/10 [00:34<00:08,  4.22s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9598, 'compress@10': 0.5784, 'time@10': 5.5222}:  90%|█████████ | 9/10 [00:34<00:04,  4.24s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9611, 'compress@10': 0.523, 'time@10': 5.5541}:  90%|█████████ | 9/10 [00:40<00:04,  4.24s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9611, 'compress@10': 0.523, 'time@10': 5.5541}: 100%|██████████| 10/10 [00:40<00:00,  4.74s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9611, 'compress@10': 0.523, 'time@10': 5.5541}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.021055054863413407
Avg hit ratio: 0.885548115155925
Avg ndcg: 0.9611086294989402
Avg compression ratio: 0.5230434252834426
Avg train time: 5.554092288017273
Std train time: 1.7631872081160278
[0.8806451612903227, 0.20322580645161287, 0.04193548387096772, 0.7193548387096776, 0.9774193548387095, 0.7193548387096773, 0.3, 0.26774193548387104, 0.5903225806451613, 0.23548387096774195]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.9999, 'time@10': 4.6679}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.9999, 'time@10': 4.6679}:  10%|█         | 1/10 [00:02<00:21,  2.37s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9589, 'compress@10': 0.5167, 'time@10': 4.2279}:  10%|█         | 1/10 [00:06<00:21,  2.37s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9589, 'compress@10': 0.5167, 'time@10': 4.2279}:  20%|██        | 2/10 [00:06<00:25,  3.23s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.925, 'compress@10': 0.3921, 'time@10': 3.8408}:  20%|██        | 2/10 [00:07<00:25,  3.23s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.925, 'compress@10': 0.3921, 'time@10': 3.8408}:  30%|███       | 3/10 [00:07<00:17,  2.47s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9343, 'compress@10': 0.5439, 'time@10': 3.8121}:  30%|███       | 3/10 [00:11<00:17,  2.47s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9343, 'compress@10': 0.5439, 'time@10': 3.8121}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0131, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9338, 'compress@10': 0.6351, 'time@10': 4.7126}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0131, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9338, 'compress@10': 0.6351, 'time@10': 4.7126}:  50%|█████     | 5/10 [00:15<00:17,  3.42s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9408, 'compress@10': 0.6952, 'time@10': 4.9561}:  50%|█████     | 5/10 [00:21<00:17,  3.42s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9408, 'compress@10': 0.6952, 'time@10': 4.9561}:  60%|██████    | 6/10 [00:21<00:17,  4.37s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9398, 'compress@10': 0.6025, 'time@10': 5.2182}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9398, 'compress@10': 0.6025, 'time@10': 5.2182}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9432, 'compress@10': 0.5312, 'time@10': 5.1527}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9432, 'compress@10': 0.5312, 'time@10': 5.1527}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.942, 'compress@10': 0.5801, 'time@10': 5.5419}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.942, 'compress@10': 0.5801, 'time@10': 5.5419}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9472, 'compress@10': 0.5247, 'time@10': 5.5654}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9472, 'compress@10': 0.5247, 'time@10': 5.5654}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9472, 'compress@10': 0.5247, 'time@10': 5.5654}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.017485787214704583
Avg hit ratio: 0.9009700032093919
Avg ndcg: 0.9472137009841596
Avg compression ratio: 0.5247493902501483
Avg train time: 5.565378022193909
Std train time: 1.8267834824332376
[0.8843750000000001, 0.19687499999999997, 0.040624999999999974, 0.6968750000000002, 0.9781249999999998, 0.6968749999999999, 0.32187499999999997, 0.2593750000000001, 0.603125, 0.259375]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.9999, 'time@10': 4.7593}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.9999, 'time@10': 4.7593}:  10%|█         | 1/10 [00:02<00:21,  2.42s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9413, 'compress@10': 0.5167, 'time@10': 4.3139}:  10%|█         | 1/10 [00:06<00:21,  2.42s/it]   {'epoch': 31, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9413, 'compress@10': 0.5167, 'time@10': 4.3139}:  20%|██        | 2/10 [00:06<00:26,  3.29s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9133, 'compress@10': 0.3921, 'time@10': 3.8722}:  20%|██        | 2/10 [00:07<00:26,  3.29s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9133, 'compress@10': 0.3921, 'time@10': 3.8722}:  30%|███       | 3/10 [00:07<00:17,  2.49s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.924, 'compress@10': 0.5438, 'time@10': 3.8552}:  30%|███       | 3/10 [00:11<00:17,  2.49s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.924, 'compress@10': 0.5438, 'time@10': 3.8552}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9246, 'compress@10': 0.635, 'time@10': 4.747}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9246, 'compress@10': 0.635, 'time@10': 4.747}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9375, 'compress@10': 0.6949, 'time@10': 4.9931}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9375, 'compress@10': 0.6949, 'time@10': 4.9931}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9397, 'compress@10': 0.6032, 'time@10': 5.2428}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9397, 'compress@10': 0.6032, 'time@10': 5.2428}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9374, 'compress@10': 0.5317, 'time@10': 5.1707}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]  {'epoch': 31, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9374, 'compress@10': 0.5317, 'time@10': 5.1707}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9528, 'compress@10': 0.5814, 'time@10': 5.5463}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9528, 'compress@10': 0.5814, 'time@10': 5.5463}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9545, 'compress@10': 0.5264, 'time@10': 5.587}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9545, 'compress@10': 0.5264, 'time@10': 5.587}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9545, 'compress@10': 0.5264, 'time@10': 5.587}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.016053726455678197
Avg hit ratio: 0.8875414317808206
Avg ndcg: 0.9545069011859436
Avg compression ratio: 0.5264453022759077
Avg train time: 5.58701720237732
Std train time: 1.8030811355195038
[0.887878787878788, 0.1909090909090909, 0.03939393939393937, 0.7060606060606063, 0.9484848484848483, 0.7060606060606059, 0.3121212121212121, 0.2515151515151516, 0.6151515151515152, 0.28181818181818186]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9175, 'compress@10': 0.9999, 'time@10': 4.4939}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9175, 'compress@10': 0.9999, 'time@10': 4.4939}:  10%|█         | 1/10 [00:02<00:20,  2.29s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9472, 'compress@10': 0.5167, 'time@10': 4.1967}:  10%|█         | 1/10 [00:06<00:20,  2.29s/it] {'epoch': 32, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9472, 'compress@10': 0.5167, 'time@10': 4.1967}:  20%|██        | 2/10 [00:06<00:26,  3.26s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9172, 'compress@10': 0.3921, 'time@10': 3.7937}:  20%|██        | 2/10 [00:07<00:26,  3.26s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9172, 'compress@10': 0.3921, 'time@10': 3.7937}:  30%|███       | 3/10 [00:07<00:17,  2.47s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9285, 'compress@10': 0.5439, 'time@10': 3.7817}:  30%|███       | 3/10 [00:11<00:17,  2.47s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9285, 'compress@10': 0.5439, 'time@10': 3.7817}:  40%|████      | 4/10 [00:11<00:17,  2.99s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9312, 'compress@10': 0.6351, 'time@10': 4.6998}:  40%|████      | 4/10 [00:15<00:17,  2.99s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9312, 'compress@10': 0.6351, 'time@10': 4.6998}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9385, 'compress@10': 0.6952, 'time@10': 4.944}:  50%|█████     | 5/10 [00:21<00:17,  3.43s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9385, 'compress@10': 0.6952, 'time@10': 4.944}:  60%|██████    | 6/10 [00:21<00:17,  4.38s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9407, 'compress@10': 0.6035, 'time@10': 5.1958}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9407, 'compress@10': 0.6035, 'time@10': 5.1958}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.941, 'compress@10': 0.532, 'time@10': 5.1197}:  70%|███████   | 7/10 [00:29<00:12,  4.06s/it]    {'epoch': 32, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.941, 'compress@10': 0.532, 'time@10': 5.1197}:  80%|████████  | 8/10 [00:29<00:08,  4.24s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.942, 'compress@10': 0.5817, 'time@10': 5.5118}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.942, 'compress@10': 0.5817, 'time@10': 5.5118}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.945, 'compress@10': 0.5269, 'time@10': 5.5461}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.945, 'compress@10': 0.5269, 'time@10': 5.5461}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.945, 'compress@10': 0.5269, 'time@10': 5.5461}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.012635817522082057
Avg hit ratio: 0.9053192095585982
Avg ndcg: 0.9450465431824456
Avg compression ratio: 0.5268522751335324
Avg train time: 5.546065759658814
Std train time: 1.843006133456113
[0.8911764705882355, 0.21470588235294116, 0.038235294117647034, 0.7147058823529414, 0.9205882352941175, 0.6852941176470587, 0.3029411764705882, 0.27352941176470597, 0.6264705882352942, 0.2735294117647059]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.9999, 'time@10': 4.6182}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.9999, 'time@10': 4.6182}:  10%|█         | 1/10 [00:02<00:21,  2.35s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9568, 'compress@10': 0.5175, 'time@10': 4.2396}:  10%|█         | 1/10 [00:06<00:21,  2.35s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9568, 'compress@10': 0.5175, 'time@10': 4.2396}:  20%|██        | 2/10 [00:06<00:26,  3.26s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9236, 'compress@10': 0.3926, 'time@10': 4.0191}:  20%|██        | 2/10 [00:08<00:26,  3.26s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9236, 'compress@10': 0.3926, 'time@10': 4.0191}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9333, 'compress@10': 0.5443, 'time@10': 3.9162}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9333, 'compress@10': 0.5443, 'time@10': 3.9162}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9341, 'compress@10': 0.6354, 'time@10': 4.8202}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9341, 'compress@10': 0.6354, 'time@10': 4.8202}:  50%|█████     | 5/10 [00:15<00:17,  3.47s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9411, 'compress@10': 0.6951, 'time@10': 5.0371}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9411, 'compress@10': 0.6951, 'time@10': 5.0371}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9459, 'compress@10': 0.6033, 'time@10': 5.2949}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9459, 'compress@10': 0.6033, 'time@10': 5.2949}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9491, 'compress@10': 0.5322, 'time@10': 5.2188}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9491, 'compress@10': 0.5322, 'time@10': 5.2188}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9648, 'compress@10': 0.583, 'time@10': 5.5982}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it] {'epoch': 33, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9648, 'compress@10': 0.583, 'time@10': 5.5982}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9628, 'compress@10': 0.5282, 'time@10': 5.6434}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it] {'epoch': 33, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9628, 'compress@10': 0.5282, 'time@10': 5.6434}: 100%|██████████| 10/10 [00:40<00:00,  4.86s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9628, 'compress@10': 0.5282, 'time@10': 5.6434}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.01749082002892959
Avg hit ratio: 0.9082787589697606
Avg ndcg: 0.9627833860559507
Avg compression ratio: 0.5282041449366608
Avg train time: 5.643376183509827
Std train time: 1.792393558413881
[0.8657142857142859, 0.23714285714285713, 0.037142857142857116, 0.7228571428571431, 0.8942857142857141, 0.6657142857142856, 0.32285714285714284, 0.2657142857142858, 0.6371428571428572, 0.2942857142857143]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9218, 'compress@10': 0.9998, 'time@10': 4.6735}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9218, 'compress@10': 0.9998, 'time@10': 4.6735}:  10%|█         | 1/10 [00:02<00:21,  2.38s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9442, 'compress@10': 0.5202, 'time@10': 4.3798}:  10%|█         | 1/10 [00:06<00:21,  2.38s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9442, 'compress@10': 0.5202, 'time@10': 4.3798}:  20%|██        | 2/10 [00:06<00:27,  3.41s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9152, 'compress@10': 0.3944, 'time@10': 4.0143}:  20%|██        | 2/10 [00:08<00:27,  3.41s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9152, 'compress@10': 0.3944, 'time@10': 4.0143}:  30%|███       | 3/10 [00:08<00:18,  2.62s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9274, 'compress@10': 0.5457, 'time@10': 3.9355}:  30%|███       | 3/10 [00:11<00:18,  2.62s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9274, 'compress@10': 0.5457, 'time@10': 3.9355}:  40%|████      | 4/10 [00:11<00:18,  3.06s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9303, 'compress@10': 0.6365, 'time@10': 4.8219}:  40%|████      | 4/10 [00:16<00:18,  3.06s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9303, 'compress@10': 0.6365, 'time@10': 4.8219}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.941, 'compress@10': 0.6958, 'time@10': 5.0568}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.941, 'compress@10': 0.6958, 'time@10': 5.0568}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9418, 'compress@10': 0.6049, 'time@10': 5.2989}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9418, 'compress@10': 0.6049, 'time@10': 5.2989}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9418, 'compress@10': 0.5337, 'time@10': 5.2181}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9418, 'compress@10': 0.5337, 'time@10': 5.2181}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9429, 'compress@10': 0.584, 'time@10': 5.6011}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9429, 'compress@10': 0.584, 'time@10': 5.6011}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9462, 'compress@10': 0.5292, 'time@10': 5.6309}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]  {'epoch': 34, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9462, 'compress@10': 0.5292, 'time@10': 5.6309}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9462, 'compress@10': 0.5292, 'time@10': 5.6309}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.015431844865481204
Avg hit ratio: 0.9089136796046813
Avg ndcg: 0.9462347898565444
Avg compression ratio: 0.529174778754036
Avg train time: 5.630935955047607
Std train time: 1.7856839803228273
[0.8416666666666668, 0.23055555555555554, 0.03611111111111109, 0.7305555555555557, 0.8694444444444442, 0.6749999999999999, 0.3416666666666667, 0.2861111111111112, 0.6472222222222224, 0.28611111111111115]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9218, 'compress@10': 0.9998, 'time@10': 4.477}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9218, 'compress@10': 0.9998, 'time@10': 4.477}:  10%|█         | 1/10 [00:02<00:20,  2.28s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9587, 'compress@10': 0.5192, 'time@10': 4.1849}:  10%|█         | 1/10 [00:06<00:20,  2.28s/it] {'epoch': 35, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9587, 'compress@10': 0.5192, 'time@10': 4.1849}:  20%|██        | 2/10 [00:06<00:26,  3.25s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9249, 'compress@10': 0.3938, 'time@10': 3.8706}:  20%|██        | 2/10 [00:07<00:26,  3.25s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9249, 'compress@10': 0.3938, 'time@10': 3.8706}:  30%|███       | 3/10 [00:07<00:17,  2.52s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9346, 'compress@10': 0.5452, 'time@10': 3.8168}:  30%|███       | 3/10 [00:11<00:17,  2.52s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9346, 'compress@10': 0.5452, 'time@10': 3.8168}:  40%|████      | 4/10 [00:11<00:17,  2.99s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9367, 'compress@10': 0.6361, 'time@10': 4.7438}:  40%|████      | 4/10 [00:15<00:17,  2.99s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9367, 'compress@10': 0.6361, 'time@10': 4.7438}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9412, 'compress@10': 0.6958, 'time@10': 4.9805}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9412, 'compress@10': 0.6958, 'time@10': 4.9805}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0124, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9431, 'compress@10': 0.607, 'time@10': 5.2261}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0124, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9431, 'compress@10': 0.607, 'time@10': 5.2261}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.948, 'compress@10': 0.5358, 'time@10': 5.1689}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]  {'epoch': 35, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.948, 'compress@10': 0.5358, 'time@10': 5.1689}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9635, 'compress@10': 0.5867, 'time@10': 5.5543}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9635, 'compress@10': 0.5867, 'time@10': 5.5543}:  90%|█████████ | 9/10 [00:34<00:04,  4.32s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9624, 'compress@10': 0.5314, 'time@10': 5.5938}:  90%|█████████ | 9/10 [00:40<00:04,  4.32s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9624, 'compress@10': 0.5314, 'time@10': 5.5938}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9624, 'compress@10': 0.5314, 'time@10': 5.5938}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.014406244251574343
Avg hit ratio: 0.9002398444792332
Avg ndcg: 0.9623644596209185
Avg compression ratio: 0.5314199460211044
Avg train time: 5.593791437149048
Std train time: 1.8225229638433809
[0.818918918918919, 0.25135135135135134, 0.03513513513513511, 0.737837837837838, 0.8459459459459457, 0.6837837837837837, 0.3324324324324324, 0.2783783783783785, 0.6567567567567569, 0.30540540540540545]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9243, 'compress@10': 0.9997, 'time@10': 4.4815}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9243, 'compress@10': 0.9997, 'time@10': 4.4815}:  10%|█         | 1/10 [00:02<00:20,  2.28s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.893, 'ndcg@10': 0.951, 'compress@10': 0.5221, 'time@10': 4.2179}:  10%|█         | 1/10 [00:06<00:20,  2.28s/it]  {'epoch': 36, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.893, 'ndcg@10': 0.951, 'compress@10': 0.5221, 'time@10': 4.2179}:  20%|██        | 2/10 [00:06<00:26,  3.29s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9197, 'compress@10': 0.3957, 'time@10': 3.9337}:  20%|██        | 2/10 [00:07<00:26,  3.29s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9197, 'compress@10': 0.3957, 'time@10': 3.9337}:  30%|███       | 3/10 [00:07<00:18,  2.57s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9312, 'compress@10': 0.5466, 'time@10': 3.865}:  30%|███       | 3/10 [00:11<00:18,  2.57s/it]   {'epoch': 36, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9312, 'compress@10': 0.5466, 'time@10': 3.865}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9341, 'compress@10': 0.6372, 'time@10': 4.7281}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9341, 'compress@10': 0.6372, 'time@10': 4.7281}:  50%|█████     | 5/10 [00:15<00:17,  3.42s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9411, 'compress@10': 0.697, 'time@10': 4.9712}:  50%|█████     | 5/10 [00:22<00:17,  3.42s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9411, 'compress@10': 0.697, 'time@10': 4.9712}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9429, 'compress@10': 0.6078, 'time@10': 5.2296}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9429, 'compress@10': 0.6078, 'time@10': 5.2296}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.951, 'compress@10': 0.5362, 'time@10': 5.1553}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]  {'epoch': 36, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.951, 'compress@10': 0.5362, 'time@10': 5.1553}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9487, 'compress@10': 0.587, 'time@10': 5.5486}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9487, 'compress@10': 0.587, 'time@10': 5.5486}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9529, 'compress@10': 0.5326, 'time@10': 5.5898}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]  {'epoch': 36, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9529, 'compress@10': 0.5326, 'time@10': 5.5898}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9529, 'compress@10': 0.5326, 'time@10': 5.5898}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.015636958390972722
Avg hit ratio: 0.9046842889236777
Avg ndcg: 0.9528766902220844
Avg compression ratio: 0.5325560039961903
Avg train time: 5.589847493171692
Std train time: 1.7821509598665286
[0.8236842105263159, 0.24473684210526314, 0.03421052631578945, 0.7447368421052633, 0.8236842105263156, 0.6657894736842104, 0.3236842105263158, 0.29736842105263167, 0.6657894736842107, 0.32368421052631585]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9218, 'compress@10': 0.9998, 'time@10': 4.9627}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9218, 'compress@10': 0.9998, 'time@10': 4.9627}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9429, 'compress@10': 0.5203, 'time@10': 4.4331}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9429, 'compress@10': 0.5203, 'time@10': 4.4331}:  20%|██        | 2/10 [00:06<00:26,  3.36s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0044, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9143, 'compress@10': 0.3945, 'time@10': 4.0965}:  20%|██        | 2/10 [00:08<00:26,  3.36s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0044, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9143, 'compress@10': 0.3945, 'time@10': 4.0965}:  30%|███       | 3/10 [00:08<00:18,  2.62s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9267, 'compress@10': 0.5458, 'time@10': 3.9768}:  30%|███       | 3/10 [00:11<00:18,  2.62s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9267, 'compress@10': 0.5458, 'time@10': 3.9768}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9318, 'compress@10': 0.6365, 'time@10': 4.8766}:  40%|████      | 4/10 [00:16<00:18,  3.03s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9318, 'compress@10': 0.6365, 'time@10': 4.8766}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9481, 'compress@10': 0.6959, 'time@10': 5.0929}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9481, 'compress@10': 0.6959, 'time@10': 5.0929}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0121, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9477, 'compress@10': 0.606, 'time@10': 5.33}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]   {'epoch': 37, 'num_users': 6.2857, 'loss': 0.0121, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9477, 'compress@10': 0.606, 'time@10': 5.33}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9411, 'compress@10': 0.5355, 'time@10': 5.2606}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9411, 'compress@10': 0.5355, 'time@10': 5.2606}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9596, 'compress@10': 0.5866, 'time@10': 5.6454}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9596, 'compress@10': 0.5866, 'time@10': 5.6454}:  90%|█████████ | 9/10 [00:34<00:04,  4.34s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9593, 'compress@10': 0.5329, 'time@10': 5.6694}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9593, 'compress@10': 0.5329, 'time@10': 5.6694}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9593, 'compress@10': 0.5329, 'time@10': 5.6694}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.015210600415306466
Avg hit ratio: 0.9021958096610048
Avg ndcg: 0.9593139793961653
Avg compression ratio: 0.5329485236960553
Avg train time: 5.669408845901489
Std train time: 1.7987494964332493
[0.8025641025641027, 0.23846153846153845, 0.033333333333333305, 0.7512820512820514, 0.8025641025641024, 0.6743589743589742, 0.3153846153846154, 0.3153846153846155, 0.6743589743589745, 0.3410256410256411]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9243, 'compress@10': 0.9997, 'time@10': 4.7441}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9243, 'compress@10': 0.9997, 'time@10': 4.7441}:  10%|█         | 1/10 [00:02<00:21,  2.41s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9621, 'compress@10': 0.5193, 'time@10': 4.2633}:  10%|█         | 1/10 [00:06<00:21,  2.41s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9621, 'compress@10': 0.5193, 'time@10': 4.2633}:  20%|██        | 2/10 [00:06<00:25,  3.24s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9271, 'compress@10': 0.3939, 'time@10': 4.0625}:  20%|██        | 2/10 [00:08<00:25,  3.24s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9271, 'compress@10': 0.3939, 'time@10': 4.0625}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9368, 'compress@10': 0.5453, 'time@10': 3.9688}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9368, 'compress@10': 0.5453, 'time@10': 3.9688}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9389, 'compress@10': 0.6361, 'time@10': 4.8321}:  40%|████      | 4/10 [00:16<00:18,  3.05s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9389, 'compress@10': 0.6361, 'time@10': 4.8321}:  50%|█████     | 5/10 [00:16<00:17,  3.46s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9449, 'compress@10': 0.6959, 'time@10': 5.0523}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9449, 'compress@10': 0.6959, 'time@10': 5.0523}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9465, 'compress@10': 0.6053, 'time@10': 5.2904}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9465, 'compress@10': 0.6053, 'time@10': 5.2904}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9496, 'compress@10': 0.5357, 'time@10': 5.2126}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]    {'epoch': 38, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9496, 'compress@10': 0.5357, 'time@10': 5.2126}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9483, 'compress@10': 0.5868, 'time@10': 5.6002}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9483, 'compress@10': 0.5868, 'time@10': 5.6002}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.9512, 'compress@10': 0.5339, 'time@10': 5.6318}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.9512, 'compress@10': 0.5339, 'time@10': 5.6318}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.9512, 'compress@10': 0.5339, 'time@10': 5.6318}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.011030009552468682
Avg hit ratio: 0.9012362602498426
Avg ndcg: 0.951242205764536
Avg compression ratio: 0.5338726657710529
Avg train time: 5.631765604019165
Std train time: 1.7549406575749185
[0.8075000000000001, 0.2575, 0.03249999999999997, 0.7575000000000001, 0.8074999999999998, 0.6574999999999999, 0.3075, 0.3075000000000001, 0.6825000000000001, 0.3325000000000001]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9252, 'compress@10': 0.9997, 'time@10': 4.7083}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9252, 'compress@10': 0.9997, 'time@10': 4.7083}:  10%|█         | 1/10 [00:02<00:21,  2.39s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9569, 'compress@10': 0.5213, 'time@10': 4.2301}:  10%|█         | 1/10 [00:06<00:21,  2.39s/it] {'epoch': 39, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9569, 'compress@10': 0.5213, 'time@10': 4.2301}:  20%|██        | 2/10 [00:06<00:25,  3.22s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9237, 'compress@10': 0.3952, 'time@10': 4.0068}:  20%|██        | 2/10 [00:08<00:25,  3.22s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9237, 'compress@10': 0.3952, 'time@10': 4.0068}:  30%|███       | 3/10 [00:08<00:18,  2.58s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9336, 'compress@10': 0.5463, 'time@10': 3.9243}:  30%|███       | 3/10 [00:11<00:18,  2.58s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9336, 'compress@10': 0.5463, 'time@10': 3.9243}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9373, 'compress@10': 0.6369, 'time@10': 4.7945}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9373, 'compress@10': 0.6369, 'time@10': 4.7945}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0124, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9437, 'compress@10': 0.6958, 'time@10': 5.0175}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0124, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9437, 'compress@10': 0.6958, 'time@10': 5.0175}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9457, 'compress@10': 0.6047, 'time@10': 5.258}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it] {'epoch': 39, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9457, 'compress@10': 0.6047, 'time@10': 5.258}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9674, 'compress@10': 0.5336, 'time@10': 5.178}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]  {'epoch': 39, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9674, 'compress@10': 0.5336, 'time@10': 5.178}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9846, 'compress@10': 0.5851, 'time@10': 5.5661}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9846, 'compress@10': 0.5851, 'time@10': 5.5661}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9815, 'compress@10': 0.5323, 'time@10': 5.6015}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9815, 'compress@10': 0.5323, 'time@10': 5.6015}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9815, 'compress@10': 0.5323, 'time@10': 5.6015}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.01749585152066567
Avg hit ratio: 0.9016049238443127
Avg ndcg: 0.9814684938662381
Avg compression ratio: 0.5322758373622511
Avg train time: 5.601529335975647
Std train time: 1.7669342109308226
[0.8121951219512196, 0.275609756097561, 0.031707317073170704, 0.7390243902439025, 0.7878048780487803, 0.6414634146341462, 0.3, 0.32439024390243915, 0.6902439024390244, 0.34878048780487814]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9243, 'compress@10': 0.9997, 'time@10': 4.8765}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9243, 'compress@10': 0.9997, 'time@10': 4.8765}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9428, 'compress@10': 0.5238, 'time@10': 4.3346}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9428, 'compress@10': 0.5238, 'time@10': 4.3346}:  20%|██        | 2/10 [00:06<00:26,  3.28s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9143, 'compress@10': 0.3969, 'time@10': 4.0107}:  20%|██        | 2/10 [00:08<00:26,  3.28s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9143, 'compress@10': 0.3969, 'time@10': 4.0107}:  30%|███       | 3/10 [00:08<00:17,  2.56s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9266, 'compress@10': 0.5475, 'time@10': 3.931}:  30%|███       | 3/10 [00:11<00:17,  2.56s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9266, 'compress@10': 0.5475, 'time@10': 3.931}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9316, 'compress@10': 0.6379, 'time@10': 4.8581}:  40%|████      | 4/10 [00:16<00:18,  3.03s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9316, 'compress@10': 0.6379, 'time@10': 4.8581}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9402, 'compress@10': 0.6978, 'time@10': 5.0892}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9402, 'compress@10': 0.6978, 'time@10': 5.0892}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.9496, 'compress@10': 0.6058, 'time@10': 5.3238}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.9496, 'compress@10': 0.6058, 'time@10': 5.3238}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9241, 'ndcg@10': 0.9515, 'compress@10': 0.5357, 'time@10': 5.2647}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9241, 'ndcg@10': 0.9515, 'compress@10': 0.5357, 'time@10': 5.2647}:  80%|████████  | 8/10 [00:30<00:08,  4.35s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9511, 'compress@10': 0.587, 'time@10': 5.6282}:  80%|████████  | 8/10 [00:34<00:08,  4.35s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9511, 'compress@10': 0.587, 'time@10': 5.6282}:  90%|█████████ | 9/10 [00:34<00:04,  4.34s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9141, 'ndcg@10': 0.9537, 'compress@10': 0.5344, 'time@10': 5.6522}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]  {'epoch': 40, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9141, 'ndcg@10': 0.9537, 'compress@10': 0.5344, 'time@10': 5.6522}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9141, 'ndcg@10': 0.9537, 'compress@10': 0.5344, 'time@10': 5.6522}: 100%|██████████| 10/10 [00:40<00:00,  4.09s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.013573702904156238
Avg hit ratio: 0.9141394860562941
Avg ndcg: 0.9537115015598918
Avg compression ratio: 0.5343972673312612
Avg train time: 5.652179169654846
Std train time: 1.7932097632868698
[0.7928571428571429, 0.2690476190476191, 0.030952380952380926, 0.7452380952380954, 0.7928571428571427, 0.6499999999999999, 0.31666666666666665, 0.31666666666666676, 0.6976190476190477, 0.34047619047619054]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9153, 'compress@10': 0.9996, 'time@10': 4.8464}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9153, 'compress@10': 0.9996, 'time@10': 4.8464}:  10%|█         | 1/10 [00:02<00:22,  2.46s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9969, 'compress@10': 0.522, 'time@10': 4.2624}:  10%|█         | 1/10 [00:06<00:22,  2.46s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9969, 'compress@10': 0.522, 'time@10': 4.2624}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9503, 'compress@10': 0.3956, 'time@10': 4.0251}:  20%|██        | 2/10 [00:07<00:25,  3.20s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9503, 'compress@10': 0.3956, 'time@10': 4.0251}:  30%|███       | 3/10 [00:07<00:17,  2.57s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9542, 'compress@10': 0.5466, 'time@10': 3.9375}:  30%|███       | 3/10 [00:11<00:17,  2.57s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9542, 'compress@10': 0.5466, 'time@10': 3.9375}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.955, 'compress@10': 0.6372, 'time@10': 4.8297}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.955, 'compress@10': 0.6372, 'time@10': 4.8297}:  50%|█████     | 5/10 [00:15<00:17,  3.46s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0149, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9585, 'compress@10': 0.6965, 'time@10': 5.0602}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0149, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9585, 'compress@10': 0.6965, 'time@10': 5.0602}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9581, 'compress@10': 0.6056, 'time@10': 5.2961}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9581, 'compress@10': 0.6056, 'time@10': 5.2961}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9594, 'compress@10': 0.5358, 'time@10': 5.2223}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9594, 'compress@10': 0.5358, 'time@10': 5.2223}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9728, 'compress@10': 0.5871, 'time@10': 5.5989}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8704, 'ndcg@10': 0.9728, 'compress@10': 0.5871, 'time@10': 5.5989}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9718, 'compress@10': 0.5346, 'time@10': 5.6245}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9718, 'compress@10': 0.5346, 'time@10': 5.6245}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9718, 'compress@10': 0.5346, 'time@10': 5.6245}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.014658425475315878
Avg hit ratio: 0.8810898188775947
Avg ndcg: 0.97179224791882
Avg compression ratio: 0.5345961102710522
Avg train time: 5.6245486497879025
Std train time: 1.7758799367857387
[0.7976744186046513, 0.286046511627907, 0.03023255813953486, 0.7511627906976746, 0.7744186046511626, 0.6348837209302325, 0.3093023255813953, 0.3093023255813954, 0.7046511627906977, 0.35581395348837214]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9192, 'compress@10': 0.9996, 'time@10': 4.9603}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9192, 'compress@10': 0.9996, 'time@10': 4.9603}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9675, 'compress@10': 0.5252, 'time@10': 4.405}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]  {'epoch': 42, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9675, 'compress@10': 0.5252, 'time@10': 4.405}:  20%|██        | 2/10 [00:06<00:26,  3.33s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9307, 'compress@10': 0.3977, 'time@10': 4.2087}:  20%|██        | 2/10 [00:08<00:26,  3.33s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9307, 'compress@10': 0.3977, 'time@10': 4.2087}:  30%|███       | 3/10 [00:08<00:18,  2.70s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9399, 'compress@10': 0.5482, 'time@10': 4.1073}:  30%|███       | 3/10 [00:12<00:18,  2.70s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9399, 'compress@10': 0.5482, 'time@10': 4.1073}:  40%|████      | 4/10 [00:12<00:18,  3.15s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9442, 'compress@10': 0.6384, 'time@10': 4.9434}:  40%|████      | 4/10 [00:16<00:18,  3.15s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9442, 'compress@10': 0.6384, 'time@10': 4.9434}:  50%|█████     | 5/10 [00:16<00:17,  3.52s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9566, 'compress@10': 0.6978, 'time@10': 5.1463}:  50%|█████     | 5/10 [00:22<00:17,  3.52s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9566, 'compress@10': 0.6978, 'time@10': 5.1463}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9562, 'compress@10': 0.6062, 'time@10': 5.3302}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9562, 'compress@10': 0.6062, 'time@10': 5.3302}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9721, 'compress@10': 0.5354, 'time@10': 5.261}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9721, 'compress@10': 0.5354, 'time@10': 5.261}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9695, 'compress@10': 0.5868, 'time@10': 5.6312}:  80%|████████  | 8/10 [00:35<00:08,  4.29s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9695, 'compress@10': 0.5868, 'time@10': 5.6312}:  90%|█████████ | 9/10 [00:35<00:04,  4.31s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9705, 'compress@10': 0.535, 'time@10': 5.645}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9705, 'compress@10': 0.535, 'time@10': 5.645}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9705, 'compress@10': 0.535, 'time@10': 5.645}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.017218231155343242
Avg hit ratio: 0.8923985746379633
Avg ndcg: 0.9704516920193814
Avg compression ratio: 0.535018440403622
Avg train time: 5.645011162757873
Std train time: 1.6662478681270312
[0.7795454545454547, 0.3022727272727273, 0.02954545454545452, 0.7340909090909092, 0.7568181818181816, 0.6431818181818181, 0.30227272727272725, 0.32500000000000007, 0.7113636363636364, 0.3704545454545455]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9243, 'compress@10': 0.9995, 'time@10': 4.8898}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9243, 'compress@10': 0.9995, 'time@10': 4.8898}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0049, 'hit_ratio@10': 0.893, 'ndcg@10': 0.946, 'compress@10': 0.53, 'time@10': 4.3582}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it]    {'epoch': 43, 'num_users': 7.0, 'loss': 0.0049, 'hit_ratio@10': 0.893, 'ndcg@10': 0.946, 'compress@10': 0.53, 'time@10': 4.3582}:  20%|██        | 2/10 [00:06<00:26,  3.30s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0033, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9164, 'compress@10': 0.401, 'time@10': 4.0685}:  20%|██        | 2/10 [00:08<00:26,  3.30s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0033, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9164, 'compress@10': 0.401, 'time@10': 4.0685}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9284, 'compress@10': 0.5506, 'time@10': 4.0017}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9284, 'compress@10': 0.5506, 'time@10': 4.0017}:  40%|████      | 4/10 [00:11<00:18,  3.09s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0063, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.935, 'compress@10': 0.6403, 'time@10': 4.8583}:  40%|████      | 4/10 [00:16<00:18,  3.09s/it] {'epoch': 43, 'num_users': 5.8, 'loss': 0.0063, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.935, 'compress@10': 0.6403, 'time@10': 4.8583}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0056, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9419, 'compress@10': 0.6994, 'time@10': 5.0809}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0056, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9419, 'compress@10': 0.6994, 'time@10': 5.0809}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0054, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9439, 'compress@10': 0.6073, 'time@10': 5.3232}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it] {'epoch': 43, 'num_users': 6.2857, 'loss': 0.0054, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9439, 'compress@10': 0.6073, 'time@10': 5.3232}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0063, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9456, 'compress@10': 0.5365, 'time@10': 5.251}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0063, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9456, 'compress@10': 0.5365, 'time@10': 5.251}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0086, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9653, 'compress@10': 0.5878, 'time@10': 5.6554}:  80%|████████  | 8/10 [00:35<00:08,  4.32s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0086, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9653, 'compress@10': 0.5878, 'time@10': 5.6554}:  90%|█████████ | 9/10 [00:35<00:04,  4.37s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9665, 'compress@10': 0.5383, 'time@10': 5.6801}:  90%|█████████ | 9/10 [00:41<00:04,  4.37s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9665, 'compress@10': 0.5383, 'time@10': 5.6801}: 100%|██████████| 10/10 [00:41<00:00,  4.86s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9665, 'compress@10': 0.5383, 'time@10': 5.6801}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.008340169248840389
Avg hit ratio: 0.8837477809871699
Avg ndcg: 0.9664720845261859
Avg compression ratio: 0.5383171884569744
Avg train time: 5.68006010055542
Std train time: 1.7851820785504369
[0.7844444444444445, 0.29555555555555557, 0.028888888888888863, 0.7400000000000001, 0.762222222222222, 0.6288888888888888, 0.2955555555555555, 0.3400000000000001, 0.7177777777777778, 0.3622222222222222]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.9996, 'time@10': 4.7768}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.9996, 'time@10': 4.7768}:  10%|█         | 1/10 [00:02<00:21,  2.43s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.945, 'compress@10': 0.5272, 'time@10': 4.3666}:  10%|█         | 1/10 [00:06<00:21,  2.43s/it] {'epoch': 44, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.945, 'compress@10': 0.5272, 'time@10': 4.3666}:  20%|██        | 2/10 [00:06<00:26,  3.35s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9157, 'compress@10': 0.3991, 'time@10': 4.0713}:  20%|██        | 2/10 [00:08<00:26,  3.35s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9157, 'compress@10': 0.3991, 'time@10': 4.0713}:  30%|███       | 3/10 [00:08<00:18,  2.63s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9287, 'compress@10': 0.5492, 'time@10': 3.993}:  30%|███       | 3/10 [00:12<00:18,  2.63s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9287, 'compress@10': 0.5492, 'time@10': 3.993}:  40%|████      | 4/10 [00:12<00:18,  3.09s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9363, 'compress@10': 0.6392, 'time@10': 4.8778}:  40%|████      | 4/10 [00:16<00:18,  3.09s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9363, 'compress@10': 0.6392, 'time@10': 4.8778}:  50%|█████     | 5/10 [00:16<00:17,  3.51s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9424, 'compress@10': 0.6972, 'time@10': 5.0817}:  50%|█████     | 5/10 [00:22<00:17,  3.51s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9424, 'compress@10': 0.6972, 'time@10': 5.0817}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9449, 'compress@10': 0.6051, 'time@10': 5.2784}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it] {'epoch': 44, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9449, 'compress@10': 0.6051, 'time@10': 5.2784}:  70%|███████   | 7/10 [00:25<00:12,  4.03s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.95, 'compress@10': 0.5383, 'time@10': 5.2096}:  70%|███████   | 7/10 [00:30<00:12,  4.03s/it]  {'epoch': 44, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.95, 'compress@10': 0.5383, 'time@10': 5.2096}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9494, 'compress@10': 0.5895, 'time@10': 5.5962}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9494, 'compress@10': 0.5895, 'time@10': 5.5962}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9522, 'compress@10': 0.5391, 'time@10': 5.6308}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9522, 'compress@10': 0.5391, 'time@10': 5.6308}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9522, 'compress@10': 0.5391, 'time@10': 5.6308}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.0103176421429118
Avg hit ratio: 0.8949100953752905
Avg ndcg: 0.9522259280036989
Avg compression ratio: 0.5391227926912959
Avg train time: 5.630840468406677
Std train time: 1.749147905990063
[0.7891304347826088, 0.2891304347826087, 0.028260869565217367, 0.7456521739130436, 0.7456521739130433, 0.6369565217391304, 0.28913043478260864, 0.3543478260869566, 0.7239130434782609, 0.35434782608695653]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9996, 'time@10': 4.8214}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.9996, 'time@10': 4.8214}:  10%|█         | 1/10 [00:02<00:22,  2.46s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0058, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9459, 'compress@10': 0.5262, 'time@10': 4.2944}:  10%|█         | 1/10 [00:06<00:22,  2.46s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0058, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9459, 'compress@10': 0.5262, 'time@10': 4.2944}:  20%|██        | 2/10 [00:06<00:26,  3.25s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0039, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9163, 'compress@10': 0.3984, 'time@10': 4.0075}:  20%|██        | 2/10 [00:08<00:26,  3.25s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0039, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9163, 'compress@10': 0.3984, 'time@10': 4.0075}:  30%|███       | 3/10 [00:08<00:17,  2.57s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9275, 'compress@10': 0.5487, 'time@10': 3.9497}:  30%|███       | 3/10 [00:11<00:17,  2.57s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9275, 'compress@10': 0.5487, 'time@10': 3.9497}:  40%|████      | 4/10 [00:11<00:18,  3.06s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0077, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9341, 'compress@10': 0.6388, 'time@10': 4.8178}:  40%|████      | 4/10 [00:16<00:18,  3.06s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0077, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9341, 'compress@10': 0.6388, 'time@10': 4.8178}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9441, 'compress@10': 0.6972, 'time@10': 5.0669}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9441, 'compress@10': 0.6972, 'time@10': 5.0669}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9432, 'compress@10': 0.6052, 'time@10': 5.2746}:  60%|██████    | 6/10 [00:25<00:17,  4.45s/it] {'epoch': 45, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9432, 'compress@10': 0.6052, 'time@10': 5.2746}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9694, 'compress@10': 0.5367, 'time@10': 5.2061}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9694, 'compress@10': 0.5367, 'time@10': 5.2061}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9804, 'compress@10': 0.5881, 'time@10': 5.5805}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9804, 'compress@10': 0.5881, 'time@10': 5.5805}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9803, 'compress@10': 0.5377, 'time@10': 5.5954}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9803, 'compress@10': 0.5377, 'time@10': 5.5954}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9803, 'compress@10': 0.5377, 'time@10': 5.5954}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.018422260769235525
Avg hit ratio: 0.8872398444792333
Avg ndcg: 0.980342385922787
Avg compression ratio: 0.5377479368907037
Avg train time: 5.595356678962707
Std train time: 1.7380143444989586
[0.772340425531915, 0.28297872340425534, 0.027659574468085084, 0.7297872340425533, 0.729787234042553, 0.6446808510638298, 0.3042553191489361, 0.3680851063829788, 0.7297872340425532, 0.36808510638297876]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9243, 'compress@10': 0.9995, 'time@10': 4.6754}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9243, 'compress@10': 0.9995, 'time@10': 4.6754}:  10%|█         | 1/10 [00:02<00:21,  2.38s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0053, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.946, 'compress@10': 0.5248, 'time@10': 4.2954}:  10%|█         | 1/10 [00:06<00:21,  2.38s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0053, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.946, 'compress@10': 0.5248, 'time@10': 4.2954}:  20%|██        | 2/10 [00:06<00:26,  3.31s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0035, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9164, 'compress@10': 0.3975, 'time@10': 4.0061}:  20%|██        | 2/10 [00:08<00:26,  3.31s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0035, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9164, 'compress@10': 0.3975, 'time@10': 4.0061}:  30%|███       | 3/10 [00:08<00:18,  2.60s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9284, 'compress@10': 0.5479, 'time@10': 3.9488}:  30%|███       | 3/10 [00:11<00:18,  2.60s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9284, 'compress@10': 0.5479, 'time@10': 3.9488}:  40%|████      | 4/10 [00:11<00:18,  3.08s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.006, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.9357, 'compress@10': 0.6381, 'time@10': 4.8293}:  40%|████      | 4/10 [00:16<00:18,  3.08s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.006, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.9357, 'compress@10': 0.6381, 'time@10': 4.8293}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0052, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9426, 'compress@10': 0.698, 'time@10': 5.0628}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0052, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9426, 'compress@10': 0.698, 'time@10': 5.0628}:  60%|██████    | 6/10 [00:22<00:17,  4.44s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0061, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9449, 'compress@10': 0.6067, 'time@10': 5.2903}:  60%|██████    | 6/10 [00:25<00:17,  4.44s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0061, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9449, 'compress@10': 0.6067, 'time@10': 5.2903}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0061, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9482, 'compress@10': 0.5419, 'time@10': 5.2286}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0061, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9482, 'compress@10': 0.5419, 'time@10': 5.2286}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0077, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9487, 'compress@10': 0.5927, 'time@10': 5.6274}:  80%|████████  | 8/10 [00:35<00:08,  4.33s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0077, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9487, 'compress@10': 0.5927, 'time@10': 5.6274}:  90%|█████████ | 9/10 [00:35<00:04,  4.36s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0071, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9516, 'compress@10': 0.5436, 'time@10': 5.6513}:  90%|█████████ | 9/10 [00:40<00:04,  4.36s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0071, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9516, 'compress@10': 0.5436, 'time@10': 5.6513}: 100%|██████████| 10/10 [00:40<00:00,  4.84s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0071, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9516, 'compress@10': 0.5436, 'time@10': 5.6513}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.0070719331175265925
Avg hit ratio: 0.8833791173926997
Avg ndcg: 0.9515584688401871
Avg compression ratio: 0.5436459093434226
Avg train time: 5.65129656791687
Std train time: 1.7849721365252351
[0.7770833333333333, 0.27708333333333335, 0.02708333333333331, 0.7354166666666668, 0.7354166666666665, 0.63125, 0.3187499999999999, 0.3604166666666668, 0.7354166666666667, 0.3604166666666667]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.9995, 'time@10': 4.5218}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.9995, 'time@10': 4.5218}:  10%|█         | 1/10 [00:02<00:20,  2.30s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9456, 'compress@10': 0.5231, 'time@10': 4.1456}:  10%|█         | 1/10 [00:06<00:20,  2.30s/it] {'epoch': 47, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9456, 'compress@10': 0.5231, 'time@10': 4.1456}:  20%|██        | 2/10 [00:06<00:25,  3.19s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9161, 'compress@10': 0.3964, 'time@10': 3.95}:  20%|██        | 2/10 [00:07<00:25,  3.19s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9161, 'compress@10': 0.3964, 'time@10': 3.95}:  30%|███       | 3/10 [00:07<00:17,  2.56s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.928, 'compress@10': 0.5471, 'time@10': 3.9021}:  30%|███       | 3/10 [00:11<00:17,  2.56s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.928, 'compress@10': 0.5471, 'time@10': 3.9021}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9354, 'compress@10': 0.6375, 'time@10': 4.7963}:  40%|████      | 4/10 [00:15<00:18,  3.05s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9354, 'compress@10': 0.6375, 'time@10': 4.7963}:  50%|█████     | 5/10 [00:15<00:17,  3.48s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9419, 'compress@10': 0.6972, 'time@10': 5.028}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9419, 'compress@10': 0.6972, 'time@10': 5.028}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9445, 'compress@10': 0.6068, 'time@10': 5.2568}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9445, 'compress@10': 0.6068, 'time@10': 5.2568}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0073, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9479, 'compress@10': 0.5419, 'time@10': 5.1848}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0073, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9479, 'compress@10': 0.5419, 'time@10': 5.1848}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9575, 'compress@10': 0.5927, 'time@10': 5.5614}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9575, 'compress@10': 0.5927, 'time@10': 5.5614}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.959, 'compress@10': 0.5433, 'time@10': 5.5791}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.959, 'compress@10': 0.5433, 'time@10': 5.5791}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.959, 'compress@10': 0.5433, 'time@10': 5.5791}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.009499765953655828
Avg hit ratio: 0.8866049238443127
Avg ndcg: 0.958966990392643
Avg compression ratio: 0.5432551402579036
Avg train time: 5.579134106636047
Std train time: 1.7570559056566017
[0.7816326530612245, 0.27142857142857146, 0.026530612244897937, 0.7408163265306124, 0.720408163265306, 0.6387755102040816, 0.3122448979591836, 0.35306122448979604, 0.7408163265306122, 0.3734693877551021]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9995, 'time@10': 4.7161}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.9995, 'time@10': 4.7161}:  10%|█         | 1/10 [00:02<00:21,  2.40s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9481, 'compress@10': 0.5204, 'time@10': 4.2982}:  10%|█         | 1/10 [00:06<00:21,  2.40s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9481, 'compress@10': 0.5204, 'time@10': 4.2982}:  20%|██        | 2/10 [00:06<00:26,  3.29s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9178, 'compress@10': 0.3946, 'time@10': 4.0705}:  20%|██        | 2/10 [00:08<00:26,  3.29s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9178, 'compress@10': 0.3946, 'time@10': 4.0705}:  30%|███       | 3/10 [00:08<00:18,  2.63s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9277, 'compress@10': 0.5458, 'time@10': 3.9979}:  30%|███       | 3/10 [00:11<00:18,  2.63s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9277, 'compress@10': 0.5458, 'time@10': 3.9979}:  40%|████      | 4/10 [00:11<00:18,  3.10s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9362, 'compress@10': 0.6364, 'time@10': 4.8633}:  40%|████      | 4/10 [00:16<00:18,  3.10s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9362, 'compress@10': 0.6364, 'time@10': 4.8633}:  50%|█████     | 5/10 [00:16<00:17,  3.50s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.008, 'hit_ratio@10': 0.866, 'ndcg@10': 0.943, 'compress@10': 0.6962, 'time@10': 5.0938}:  50%|█████     | 5/10 [00:22<00:17,  3.50s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.008, 'hit_ratio@10': 0.866, 'ndcg@10': 0.943, 'compress@10': 0.6962, 'time@10': 5.0938}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9453, 'compress@10': 0.6055, 'time@10': 5.313}:  60%|██████    | 6/10 [00:25<00:17,  4.45s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9453, 'compress@10': 0.6055, 'time@10': 5.313}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9497, 'compress@10': 0.5427, 'time@10': 5.2559}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9497, 'compress@10': 0.5427, 'time@10': 5.2559}:  80%|████████  | 8/10 [00:30<00:08,  4.35s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0098, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9483, 'compress@10': 0.5935, 'time@10': 5.6445}:  80%|████████  | 8/10 [00:35<00:08,  4.35s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0098, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9483, 'compress@10': 0.5935, 'time@10': 5.6445}:  90%|█████████ | 9/10 [00:35<00:04,  4.37s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9512, 'compress@10': 0.5453, 'time@10': 5.6792}:  90%|█████████ | 9/10 [00:41<00:04,  4.37s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9512, 'compress@10': 0.5453, 'time@10': 5.6792}: 100%|██████████| 10/10 [00:41<00:00,  4.88s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9512, 'compress@10': 0.5453, 'time@10': 5.6792}: 100%|██████████| 10/10 [00:41<00:00,  4.12s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.00947645694480434
Avg hit ratio: 0.8876085080737033
Avg ndcg: 0.9511977997346864
Avg compression ratio: 0.5452804961525133
Avg train time: 5.679208374023437
Std train time: 1.7458232832681497
[0.786, 0.28600000000000003, 0.025999999999999978, 0.7460000000000001, 0.7259999999999999, 0.626, 0.30599999999999994, 0.34600000000000014, 0.746, 0.36600000000000005]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0049, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 0.9996, 'time@10': 4.5924}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0049, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 0.9996, 'time@10': 4.5924}:  10%|█         | 1/10 [00:02<00:21,  2.34s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9737, 'compress@10': 0.523, 'time@10': 4.1676}:  10%|█         | 1/10 [00:06<00:21,  2.34s/it]  {'epoch': 49, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9737, 'compress@10': 0.523, 'time@10': 4.1676}:  20%|██        | 2/10 [00:06<00:25,  3.19s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9348, 'compress@10': 0.3963, 'time@10': 4.0406}:  20%|██        | 2/10 [00:08<00:25,  3.19s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9348, 'compress@10': 0.3963, 'time@10': 4.0406}:  30%|███       | 3/10 [00:08<00:18,  2.62s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9422, 'compress@10': 0.5471, 'time@10': 3.9754}:  30%|███       | 3/10 [00:11<00:18,  2.62s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9422, 'compress@10': 0.5471, 'time@10': 3.9754}:  40%|████      | 4/10 [00:11<00:18,  3.09s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9477, 'compress@10': 0.6374, 'time@10': 4.847}:  40%|████      | 4/10 [00:16<00:18,  3.09s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9477, 'compress@10': 0.6374, 'time@10': 4.847}:  50%|█████     | 5/10 [00:16<00:17,  3.50s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9619, 'compress@10': 0.6966, 'time@10': 5.0483}:  50%|█████     | 5/10 [00:22<00:17,  3.50s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9619, 'compress@10': 0.6966, 'time@10': 5.0483}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9627, 'compress@10': 0.6055, 'time@10': 5.2197}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it] {'epoch': 49, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9627, 'compress@10': 0.6055, 'time@10': 5.2197}:  70%|███████   | 7/10 [00:25<00:11,  3.99s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9664, 'compress@10': 0.5388, 'time@10': 5.117}:  70%|███████   | 7/10 [00:29<00:11,  3.99s/it]  {'epoch': 49, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9664, 'compress@10': 0.5388, 'time@10': 5.117}:  80%|████████  | 8/10 [00:29<00:08,  4.13s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9815, 'compress@10': 0.5899, 'time@10': 5.4375}:  80%|████████  | 8/10 [00:33<00:08,  4.13s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9815, 'compress@10': 0.5899, 'time@10': 5.4375}:  90%|█████████ | 9/10 [00:33<00:04,  4.10s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9782, 'compress@10': 0.5419, 'time@10': 5.4016}:  90%|█████████ | 9/10 [00:38<00:04,  4.10s/it]  {'epoch': 49, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9782, 'compress@10': 0.5419, 'time@10': 5.4016}: 100%|██████████| 10/10 [00:38<00:00,  4.42s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9782, 'compress@10': 0.5419, 'time@10': 5.4016}: 100%|██████████| 10/10 [00:38<00:00,  3.90s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.017104163574840486
Avg hit ratio: 0.8866049238443127
Avg ndcg: 0.9781995595122656
Avg compression ratio: 0.541872162791815
Avg train time: 5.40162889957428
Std train time: 1.6203019152215405
[0.7705882352941177, 0.30000000000000004, 0.02549019607843135, 0.7313725490196079, 0.7117647058823529, 0.6333333333333333, 0.29999999999999993, 0.3588235294117648, 0.7509803921568627, 0.37843137254901965]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
