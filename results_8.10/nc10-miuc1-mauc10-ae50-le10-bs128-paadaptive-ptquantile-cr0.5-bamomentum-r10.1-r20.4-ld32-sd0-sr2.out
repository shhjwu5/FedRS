  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.149, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5038, 'compress@10': 0.5263, 'time@10': 9.5898}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.149, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5038, 'compress@10': 0.5263, 'time@10': 9.5898}:  10%|█         | 1/10 [00:04<00:43,  4.84s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1086, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.6555, 'compress@10': 0.5212, 'time@10': 8.3809}:  10%|█         | 1/10 [00:12<00:43,  4.84s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1086, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.6555, 'compress@10': 0.5212, 'time@10': 8.3809}:  20%|██        | 2/10 [00:12<00:49,  6.23s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7636, 'hit_ratio@10': 0.5939, 'ndcg@10': 0.437, 'compress@10': 0.538, 'time@10': 6.5203}:  20%|██        | 2/10 [00:13<00:49,  6.23s/it]  {'epoch': 0, 'num_users': 5.0, 'loss': 0.7636, 'hit_ratio@10': 0.5939, 'ndcg@10': 0.437, 'compress@10': 0.538, 'time@10': 6.5203}:  30%|███       | 3/10 [00:13<00:28,  4.04s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5946, 'hit_ratio@10': 0.6419, 'ndcg@10': 0.5011, 'compress@10': 0.5329, 'time@10': 6.471}:  30%|███       | 3/10 [00:19<00:28,  4.04s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5946, 'hit_ratio@10': 0.6419, 'ndcg@10': 0.5011, 'compress@10': 0.5329, 'time@10': 6.471}:  40%|████      | 4/10 [00:19<00:29,  4.96s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4943, 'hit_ratio@10': 0.6775, 'ndcg@10': 0.552, 'compress@10': 0.5283, 'time@10': 9.8431}:  40%|████      | 4/10 [00:31<00:29,  4.96s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4943, 'hit_ratio@10': 0.6775, 'ndcg@10': 0.552, 'compress@10': 0.5283, 'time@10': 9.8431}:  50%|█████     | 5/10 [00:31<00:36,  7.39s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4261, 'hit_ratio@10': 0.6831, 'ndcg@10': 0.5953, 'compress@10': 0.5255, 'time@10': 9.9369}:  50%|█████     | 5/10 [00:41<00:36,  7.39s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4261, 'hit_ratio@10': 0.6831, 'ndcg@10': 0.5953, 'compress@10': 0.5255, 'time@10': 9.9369}:  60%|██████    | 6/10 [00:41<00:33,  8.43s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3791, 'hit_ratio@10': 0.7055, 'ndcg@10': 0.5959, 'compress@10': 0.5247, 'time@10': 10.1321}:  60%|██████    | 6/10 [00:47<00:33,  8.43s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3791, 'hit_ratio@10': 0.7055, 'ndcg@10': 0.5959, 'compress@10': 0.5247, 'time@10': 10.1321}:  70%|███████   | 7/10 [00:47<00:22,  7.53s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3374, 'hit_ratio@10': 0.7316, 'ndcg@10': 0.621, 'compress@10': 0.5234, 'time@10': 9.8679}:  70%|███████   | 7/10 [00:55<00:22,  7.53s/it]   {'epoch': 0, 'num_users': 6.125, 'loss': 0.3374, 'hit_ratio@10': 0.7316, 'ndcg@10': 0.621, 'compress@10': 0.5234, 'time@10': 9.8679}:  80%|████████  | 8/10 [00:55<00:15,  7.70s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3053, 'hit_ratio@10': 0.7233, 'ndcg@10': 0.653, 'compress@10': 0.5224, 'time@10': 10.5547}:  80%|████████  | 8/10 [01:03<00:15,  7.70s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3053, 'hit_ratio@10': 0.7233, 'ndcg@10': 0.653, 'compress@10': 0.5224, 'time@10': 10.5547}:  90%|█████████ | 9/10 [01:03<00:07,  7.81s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.28, 'hit_ratio@10': 0.7442, 'ndcg@10': 0.6728, 'compress@10': 0.5213, 'time@10': 10.5098}:  90%|█████████ | 9/10 [01:13<00:07,  7.81s/it]    {'epoch': 0, 'num_users': 6.3, 'loss': 0.28, 'hit_ratio@10': 0.7442, 'ndcg@10': 0.6728, 'compress@10': 0.5213, 'time@10': 10.5098}: 100%|██████████| 10/10 [01:13<00:00,  8.53s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.28, 'hit_ratio@10': 0.7442, 'ndcg@10': 0.6728, 'compress@10': 0.5213, 'time@10': 10.5098}: 100%|██████████| 10/10 [01:13<00:00,  7.40s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.28004545165859024
Avg hit ratio: 0.7441784495451728
Avg ndcg: 0.6728439520334921
Avg compression ratio: 0.5212749006657823
Avg train time: 10.509847950935363
Std train time: 5.394922896293276
[0.75, 0.25, 0.75, 0.75, 0.75, 0.25, 0.75, 0.25, 0.25, 0.25]
[10, 11, 13, 12, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0516, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.837, 'compress@10': 0.7632, 'time@10': 9.1371}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0516, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.837, 'compress@10': 0.7632, 'time@10': 9.1371}:  10%|█         | 1/10 [00:04<00:41,  4.62s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0519, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.846, 'compress@10': 0.5187, 'time@10': 8.4197}:  10%|█         | 1/10 [00:12<00:41,  4.62s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0519, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.846, 'compress@10': 0.5187, 'time@10': 8.4197}:  20%|██        | 2/10 [00:12<00:51,  6.45s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0371, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8406, 'compress@10': 0.6077, 'time@10': 6.7631}:  20%|██        | 2/10 [00:14<00:51,  6.45s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0371, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8406, 'compress@10': 0.6077, 'time@10': 6.7631}:  30%|███       | 3/10 [00:14<00:30,  4.31s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0399, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8412, 'compress@10': 0.6455, 'time@10': 6.9416}:  30%|███       | 3/10 [00:21<00:30,  4.31s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0399, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8412, 'compress@10': 0.6455, 'time@10': 6.9416}:  40%|████      | 4/10 [00:21<00:34,  5.67s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0514, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8209, 'compress@10': 0.6674, 'time@10': 7.8822}:  40%|████      | 4/10 [00:27<00:34,  5.67s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0514, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8209, 'compress@10': 0.6674, 'time@10': 7.8822}:  50%|█████     | 5/10 [00:27<00:28,  5.74s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0557, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8195, 'compress@10': 0.6006, 'time@10': 8.3039}:  50%|█████     | 5/10 [00:38<00:28,  5.74s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0557, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8195, 'compress@10': 0.6006, 'time@10': 8.3039}:  60%|██████    | 6/10 [00:38<00:29,  7.34s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0539, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8271, 'compress@10': 0.6234, 'time@10': 8.7014}:  60%|██████    | 6/10 [00:43<00:29,  7.34s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0539, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8271, 'compress@10': 0.6234, 'time@10': 8.7014}:  70%|███████   | 7/10 [00:43<00:20,  6.77s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8319, 'compress@10': 0.5794, 'time@10': 8.6976}:  70%|███████   | 7/10 [00:52<00:20,  6.77s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8319, 'compress@10': 0.5794, 'time@10': 8.6976}:  80%|████████  | 8/10 [00:52<00:14,  7.39s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.841, 'compress@10': 0.5452, 'time@10': 9.1384}:  80%|████████  | 8/10 [00:58<00:14,  7.39s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.841, 'compress@10': 0.5452, 'time@10': 9.1384}:  90%|█████████ | 9/10 [00:58<00:07,  7.07s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8418, 'compress@10': 0.5174, 'time@10': 9.2269}:  90%|█████████ | 9/10 [01:08<00:07,  7.07s/it]  {'epoch': 1, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8418, 'compress@10': 0.5174, 'time@10': 9.2269}: 100%|██████████| 10/10 [01:08<00:00,  7.99s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.8418, 'compress@10': 0.5174, 'time@10': 9.2269}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.04952672626982167
Avg hit ratio: 0.8295326684257075
Avg ndcg: 0.8418462654868852
Avg compression ratio: 0.5173535900006263
Avg train time: 9.226887726783753
Std train time: 2.494727555833228
[0.8333333333333334, 0.5, 0.5, 0.8333333333333334, 0.8333333333333334, 0.5, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[11, 12, 16, 13, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.8421, 'time@10': 9.318}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.8421, 'time@10': 9.318}:  10%|█         | 1/10 [00:04<00:42,  4.70s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8486, 'compress@10': 0.6791, 'time@10': 8.8596}:  10%|█         | 1/10 [00:13<00:42,  4.70s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8486, 'compress@10': 0.6791, 'time@10': 8.8596}:  20%|██        | 2/10 [00:13<00:55,  6.90s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8514, 'compress@10': 0.6432, 'time@10': 7.414}:  20%|██        | 2/10 [00:15<00:55,  6.90s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8514, 'compress@10': 0.6432, 'time@10': 7.414}:  30%|███       | 3/10 [00:15<00:33,  4.80s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8497, 'compress@10': 0.6922, 'time@10': 7.6085}:  30%|███       | 3/10 [00:23<00:33,  4.80s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8497, 'compress@10': 0.6922, 'time@10': 7.6085}:  40%|████      | 4/10 [00:23<00:36,  6.15s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.048, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8301, 'compress@10': 0.7211, 'time@10': 8.3459}:  40%|████      | 4/10 [00:29<00:36,  6.15s/it]  {'epoch': 2, 'num_users': 5.8, 'loss': 0.048, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8301, 'compress@10': 0.7211, 'time@10': 8.3459}:  50%|█████     | 5/10 [00:29<00:29,  5.99s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0522, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.8281, 'compress@10': 0.6861, 'time@10': 8.6795}:  50%|█████     | 5/10 [00:39<00:29,  5.99s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0522, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.8281, 'compress@10': 0.6861, 'time@10': 8.6795}:  60%|██████    | 6/10 [00:39<00:29,  7.48s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.051, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.8289, 'compress@10': 0.6624, 'time@10': 9.0685}:  60%|██████    | 6/10 [00:45<00:29,  7.48s/it] {'epoch': 2, 'num_users': 6.2857, 'loss': 0.051, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.8289, 'compress@10': 0.6624, 'time@10': 9.0685}:  70%|███████   | 7/10 [00:45<00:20,  6.91s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0522, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8339, 'compress@10': 0.6034, 'time@10': 9.1094}:  70%|███████   | 7/10 [00:54<00:20,  6.91s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0522, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8339, 'compress@10': 0.6034, 'time@10': 9.1094}:  80%|████████  | 8/10 [00:54<00:15,  7.71s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.8027, 'ndcg@10': 0.8449, 'compress@10': 0.5575, 'time@10': 9.3427}:  80%|████████  | 8/10 [01:00<00:15,  7.71s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.8027, 'ndcg@10': 0.8449, 'compress@10': 0.5575, 'time@10': 9.3427}:  90%|█████████ | 9/10 [01:00<00:07,  7.07s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.05, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.846, 'compress@10': 0.5203, 'time@10': 9.3847}:  90%|█████████ | 9/10 [01:10<00:07,  7.07s/it]      {'epoch': 2, 'num_users': 6.3, 'loss': 0.05, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.846, 'compress@10': 0.5203, 'time@10': 9.3847}: 100%|██████████| 10/10 [01:10<00:00,  7.91s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.05, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.846, 'compress@10': 0.5203, 'time@10': 9.3847}: 100%|██████████| 10/10 [01:10<00:00,  7.04s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04997480849152841
Avg hit ratio: 0.8156156177344632
Avg ndcg: 0.8459640779099598
Avg compression ratio: 0.520325850003162
Avg train time: 9.384668779373168
Std train time: 1.9532775332996068
[0.875, 0.625, 0.375, 0.625, 0.875, 0.625, 0.375, 0.375, 0.125, 0.125]
[11, 13, 18, 14, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.853, 'compress@10': 0.8816, 'time@10': 8.8617}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.853, 'compress@10': 0.8816, 'time@10': 8.8617}:  10%|█         | 1/10 [00:04<00:40,  4.48s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8515, 'compress@10': 0.7593, 'time@10': 9.08}:  10%|█         | 1/10 [00:13<00:40,  4.48s/it] {'epoch': 3, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8515, 'compress@10': 0.7593, 'time@10': 9.08}:  20%|██        | 2/10 [00:13<00:58,  7.34s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8534, 'compress@10': 0.661, 'time@10': 7.7058}:  20%|██        | 2/10 [00:16<00:58,  7.34s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8534, 'compress@10': 0.661, 'time@10': 7.7058}:  30%|███       | 3/10 [00:16<00:35,  5.13s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8558, 'compress@10': 0.6553, 'time@10': 7.9831}:  30%|███       | 3/10 [00:25<00:35,  5.13s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8558, 'compress@10': 0.6553, 'time@10': 7.9831}:  40%|████      | 4/10 [00:25<00:39,  6.60s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8372, 'compress@10': 0.6998, 'time@10': 8.6621}:  40%|████      | 4/10 [00:30<00:39,  6.60s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8372, 'compress@10': 0.6998, 'time@10': 8.6621}:  50%|█████     | 5/10 [00:30<00:31,  6.29s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0506, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8353, 'compress@10': 0.6887, 'time@10': 8.959}:  50%|█████     | 5/10 [00:41<00:31,  6.29s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0506, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8353, 'compress@10': 0.6887, 'time@10': 8.959}:  60%|██████    | 6/10 [00:41<00:30,  7.71s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8336, 'compress@10': 0.6475, 'time@10': 9.3006}:  60%|██████    | 6/10 [00:47<00:30,  7.71s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8336, 'compress@10': 0.6475, 'time@10': 9.3006}:  70%|███████   | 7/10 [00:47<00:21,  7.06s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0515, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.8247, 'compress@10': 0.6156, 'time@10': 9.359}:  70%|███████   | 7/10 [00:56<00:21,  7.06s/it]  {'epoch': 3, 'num_users': 6.125, 'loss': 0.0515, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.8247, 'compress@10': 0.6156, 'time@10': 9.359}:  80%|████████  | 8/10 [00:56<00:15,  7.93s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0501, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8372, 'compress@10': 0.5639, 'time@10': 9.5564}:  80%|████████  | 8/10 [01:02<00:15,  7.93s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0501, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8372, 'compress@10': 0.5639, 'time@10': 9.5564}:  90%|█████████ | 9/10 [01:02<00:07,  7.20s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8381, 'compress@10': 0.522, 'time@10': 9.6184}:  90%|█████████ | 9/10 [01:12<00:07,  7.20s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8381, 'compress@10': 0.522, 'time@10': 9.6184}: 100%|██████████| 10/10 [01:12<00:00,  8.13s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8381, 'compress@10': 0.522, 'time@10': 9.6184}: 100%|██████████| 10/10 [01:12<00:00,  7.27s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.049723038752868355
Avg hit ratio: 0.8647144400590921
Avg ndcg: 0.8381477465066449
Avg compression ratio: 0.5219903145520359
Avg train time: 9.618420076370239
Std train time: 1.8015475807900394
[0.7, 0.5, 0.3, 0.7, 0.9, 0.7, 0.5, 0.5, 0.1, 0.1]
[12, 13, 20, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8452, 'compress@10': 0.7158, 'time@10': 10.9487}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8452, 'compress@10': 0.7158, 'time@10': 10.9487}:  10%|█         | 1/10 [00:05<00:49,  5.51s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.849, 'compress@10': 0.616, 'time@10': 10.1275}:  10%|█         | 1/10 [00:14<00:49,  5.51s/it]  {'epoch': 4, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.849, 'compress@10': 0.616, 'time@10': 10.1275}:  20%|██        | 2/10 [00:14<01:02,  7.77s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8517, 'compress@10': 0.544, 'time@10': 8.5939}:  20%|██        | 2/10 [00:17<01:02,  7.77s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8517, 'compress@10': 0.544, 'time@10': 8.5939}:  30%|███       | 3/10 [00:17<00:38,  5.50s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.877, 'compress@10': 0.5857, 'time@10': 8.845}:  30%|███       | 3/10 [00:27<00:38,  5.50s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.877, 'compress@10': 0.5857, 'time@10': 8.845}:  40%|████      | 4/10 [00:27<00:42,  7.13s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0494, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8552, 'compress@10': 0.6489, 'time@10': 9.3457}:  40%|████      | 4/10 [00:33<00:42,  7.13s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0494, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8552, 'compress@10': 0.6489, 'time@10': 9.3457}:  50%|█████     | 5/10 [00:33<00:33,  6.62s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0517, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8507, 'compress@10': 0.6585, 'time@10': 9.52}:  50%|█████     | 5/10 [00:43<00:33,  6.62s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0517, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8507, 'compress@10': 0.6585, 'time@10': 9.52}:  60%|██████    | 6/10 [00:43<00:31,  7.91s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.051, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8485, 'compress@10': 0.6387, 'time@10': 9.7648}:  60%|██████    | 6/10 [00:49<00:31,  7.91s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.051, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8485, 'compress@10': 0.6387, 'time@10': 9.7648}:  70%|███████   | 7/10 [00:49<00:21,  7.18s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0497, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8523, 'compress@10': 0.6232, 'time@10': 9.7623}:  70%|███████   | 7/10 [00:58<00:21,  7.18s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0497, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8523, 'compress@10': 0.6232, 'time@10': 9.7623}:  80%|████████  | 8/10 [00:58<00:16,  8.01s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8619, 'compress@10': 0.5679, 'time@10': 9.8614}:  80%|████████  | 8/10 [01:04<00:16,  8.01s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8619, 'compress@10': 0.5679, 'time@10': 9.8614}:  90%|█████████ | 9/10 [01:04<00:07,  7.18s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8608, 'compress@10': 0.5232, 'time@10': 9.83}:  90%|█████████ | 9/10 [01:13<00:07,  7.18s/it]     {'epoch': 4, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8608, 'compress@10': 0.5232, 'time@10': 9.83}: 100%|██████████| 10/10 [01:13<00:00,  7.92s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8608, 'compress@10': 0.5232, 'time@10': 9.83}: 100%|██████████| 10/10 [01:13<00:00,  7.38s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.048121163368962654
Avg hit ratio: 0.8573846909551494
Avg ndcg: 0.8607697507213754
Avg compression ratio: 0.5231723111279651
Avg train time: 9.830020260810851
Std train time: 1.595465406549446
[0.75, 0.4166666666666667, 0.25, 0.75, 0.9166666666666667, 0.75, 0.5833333333333334, 0.4166666666666667, 0.08333333333333334, 0.08333333333333334]
[12, 13, 22, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.7632, 'time@10': 9.9305}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.7632, 'time@10': 9.9305}:  10%|█         | 1/10 [00:05<00:45,  5.00s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8695, 'compress@10': 0.5993, 'time@10': 9.5568}:  10%|█         | 1/10 [00:14<00:45,  5.00s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8695, 'compress@10': 0.5993, 'time@10': 9.5568}:  20%|██        | 2/10 [00:14<00:59,  7.48s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8654, 'compress@10': 0.5186, 'time@10': 8.3392}:  20%|██        | 2/10 [00:17<00:59,  7.48s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8654, 'compress@10': 0.5186, 'time@10': 8.3392}:  30%|███       | 3/10 [00:17<00:38,  5.43s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0327, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8736, 'compress@10': 0.5787, 'time@10': 8.6033}:  30%|███       | 3/10 [00:26<00:38,  5.43s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0327, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8736, 'compress@10': 0.5787, 'time@10': 8.6033}:  40%|████      | 4/10 [00:26<00:42,  7.01s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0442, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8536, 'compress@10': 0.6466, 'time@10': 9.1336}:  40%|████      | 4/10 [00:32<00:42,  7.01s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0442, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8536, 'compress@10': 0.6466, 'time@10': 9.1336}:  50%|█████     | 5/10 [00:32<00:32,  6.53s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0465, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8497, 'compress@10': 0.6648, 'time@10': 9.3289}:  50%|█████     | 5/10 [00:42<00:32,  6.53s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0465, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8497, 'compress@10': 0.6648, 'time@10': 9.3289}:  60%|██████    | 6/10 [00:42<00:31,  7.83s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0455, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8512, 'compress@10': 0.6555, 'time@10': 9.6024}:  60%|██████    | 6/10 [00:48<00:31,  7.83s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0455, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8512, 'compress@10': 0.6555, 'time@10': 9.6024}:  70%|███████   | 7/10 [00:48<00:21,  7.12s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.047, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.8467, 'compress@10': 0.6277, 'time@10': 9.634}:  70%|███████   | 7/10 [00:58<00:21,  7.12s/it]   {'epoch': 5, 'num_users': 6.125, 'loss': 0.047, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.8467, 'compress@10': 0.6277, 'time@10': 9.634}:  80%|████████  | 8/10 [00:58<00:16,  8.00s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.046, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8551, 'compress@10': 0.5702, 'time@10': 9.8126}:  80%|████████  | 8/10 [01:03<00:16,  8.00s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.046, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8551, 'compress@10': 0.5702, 'time@10': 9.8126}:  90%|█████████ | 9/10 [01:03<00:07,  7.28s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0454, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8561, 'compress@10': 0.5236, 'time@10': 9.777}:  90%|█████████ | 9/10 [01:13<00:07,  7.28s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0454, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8561, 'compress@10': 0.5236, 'time@10': 9.777}: 100%|██████████| 10/10 [01:13<00:00,  7.96s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0454, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8561, 'compress@10': 0.5236, 'time@10': 9.777}: 100%|██████████| 10/10 [01:13<00:00,  7.34s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04540957889863516
Avg hit ratio: 0.8707209102913687
Avg ndcg: 0.8560936334664622
Avg compression ratio: 0.5235609014486473
Avg train time: 9.77695860862732
Std train time: 1.4962995612508847
[0.7857142857142857, 0.35714285714285715, 0.2142857142857143, 0.7857142857142857, 0.9285714285714286, 0.7857142857142857, 0.5, 0.5, 0.07142857142857144, 0.07142857142857144]
[12, 14, 24, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8403, 'compress@10': 0.797, 'time@10': 10.2282}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8403, 'compress@10': 0.797, 'time@10': 10.2282}:  10%|█         | 1/10 [00:05<00:46,  5.16s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8674, 'compress@10': 0.5874, 'time@10': 10.0795}:  10%|█         | 1/10 [00:15<00:46,  5.16s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8674, 'compress@10': 0.5874, 'time@10': 10.0795}:  20%|██        | 2/10 [00:15<01:03,  7.99s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.74, 'ndcg@10': 0.864, 'compress@10': 0.5005, 'time@10': 8.8964}:  20%|██        | 2/10 [00:18<01:03,  7.99s/it]    {'epoch': 6, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.74, 'ndcg@10': 0.864, 'compress@10': 0.5005, 'time@10': 8.8964}:  30%|███       | 3/10 [00:18<00:40,  5.85s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8693, 'compress@10': 0.5737, 'time@10': 9.0167}:  30%|███       | 3/10 [00:27<00:40,  5.85s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8693, 'compress@10': 0.5737, 'time@10': 9.0167}:  40%|████      | 4/10 [00:27<00:43,  7.26s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0414, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8503, 'compress@10': 0.6449, 'time@10': 9.4844}:  40%|████      | 4/10 [00:33<00:43,  7.26s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0414, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8503, 'compress@10': 0.6449, 'time@10': 9.4844}:  50%|█████     | 5/10 [00:33<00:33,  6.70s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0434, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8481, 'compress@10': 0.6692, 'time@10': 9.6326}:  50%|█████     | 5/10 [00:43<00:33,  6.70s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0434, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8481, 'compress@10': 0.6692, 'time@10': 9.6326}:  60%|██████    | 6/10 [00:43<00:31,  7.96s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0426, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8512, 'compress@10': 0.6479, 'time@10': 9.8821}:  60%|██████    | 6/10 [00:49<00:31,  7.96s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0426, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8512, 'compress@10': 0.6479, 'time@10': 9.8821}:  70%|███████   | 7/10 [00:49<00:21,  7.23s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0422, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8442, 'compress@10': 0.6312, 'time@10': 9.9001}:  70%|███████   | 7/10 [00:59<00:21,  7.23s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0422, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8442, 'compress@10': 0.6312, 'time@10': 9.9001}:  80%|████████  | 8/10 [00:59<00:16,  8.13s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0421, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.8531, 'compress@10': 0.5719, 'time@10': 10.0074}:  80%|████████  | 8/10 [01:05<00:16,  8.13s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0421, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.8531, 'compress@10': 0.5719, 'time@10': 10.0074}:  90%|█████████ | 9/10 [01:05<00:07,  7.30s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0416, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8538, 'compress@10': 0.524, 'time@10': 9.9545}:  90%|█████████ | 9/10 [01:14<00:07,  7.30s/it]     {'epoch': 6, 'num_users': 6.3, 'loss': 0.0416, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8538, 'compress@10': 0.524, 'time@10': 9.9545}: 100%|██████████| 10/10 [01:14<00:00,  7.99s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0416, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8538, 'compress@10': 0.524, 'time@10': 9.9545}: 100%|██████████| 10/10 [01:14<00:00,  7.48s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.041636534836944475
Avg hit ratio: 0.8554184581688826
Avg ndcg: 0.8538492705834105
Avg compression ratio: 0.5240003522174036
Avg train time: 9.954500579833985
Std train time: 1.3177122373606378
[0.8125, 0.3125, 0.1875, 0.6875, 0.9375, 0.8125, 0.4375, 0.5625, 0.1875, 0.06250000000000001]
[12, 14, 26, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8403, 'compress@10': 0.8224, 'time@10': 9.9944}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8403, 'compress@10': 0.8224, 'time@10': 9.9944}:  10%|█         | 1/10 [00:05<00:45,  5.04s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8769, 'compress@10': 0.5785, 'time@10': 9.9237}:  10%|█         | 1/10 [00:14<00:45,  5.04s/it] {'epoch': 7, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8769, 'compress@10': 0.5785, 'time@10': 9.9237}:  20%|██        | 2/10 [00:14<01:03,  7.89s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.74, 'ndcg@10': 0.8703, 'compress@10': 0.4869, 'time@10': 8.9767}:  20%|██        | 2/10 [00:18<01:03,  7.89s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.74, 'ndcg@10': 0.8703, 'compress@10': 0.4869, 'time@10': 8.9767}:  30%|███       | 3/10 [00:18<00:41,  5.92s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.9047, 'compress@10': 0.5398, 'time@10': 9.1094}:  30%|███       | 3/10 [00:28<00:41,  5.92s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.9047, 'compress@10': 0.5398, 'time@10': 9.1094}:  40%|████      | 4/10 [00:28<00:44,  7.35s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.044, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.8785, 'compress@10': 0.6196, 'time@10': 9.5712}:  40%|████      | 4/10 [00:33<00:44,  7.35s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.044, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.8785, 'compress@10': 0.6196, 'time@10': 9.5712}:  50%|█████     | 5/10 [00:33<00:33,  6.77s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0447, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8725, 'compress@10': 0.6524, 'time@10': 9.6823}:  50%|█████     | 5/10 [00:44<00:33,  6.77s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0447, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8725, 'compress@10': 0.6524, 'time@10': 9.6823}:  60%|██████    | 6/10 [00:44<00:31,  7.96s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0433, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8729, 'compress@10': 0.625, 'time@10': 9.9427}:  60%|██████    | 6/10 [00:49<00:31,  7.96s/it] {'epoch': 7, 'num_users': 6.2857, 'loss': 0.0433, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8729, 'compress@10': 0.625, 'time@10': 9.9427}:  70%|███████   | 7/10 [00:49<00:21,  7.25s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0422, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8773, 'compress@10': 0.6187, 'time@10': 9.8906}:  70%|███████   | 7/10 [00:59<00:21,  7.25s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0422, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8773, 'compress@10': 0.6187, 'time@10': 9.8906}:  80%|████████  | 8/10 [00:59<00:15,  7.99s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0423, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8816, 'compress@10': 0.5734, 'time@10': 10.0539}:  80%|████████  | 8/10 [01:05<00:15,  7.99s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0423, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8816, 'compress@10': 0.5734, 'time@10': 10.0539}:  90%|█████████ | 9/10 [01:05<00:07,  7.28s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.8822, 'compress@10': 0.5244, 'time@10': 10.0016}:  90%|█████████ | 9/10 [01:14<00:07,  7.28s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.8822, 'compress@10': 0.5244, 'time@10': 10.0016}: 100%|██████████| 10/10 [01:14<00:00,  7.99s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0411, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.8822, 'compress@10': 0.5244, 'time@10': 10.0016}: 100%|██████████| 10/10 [01:14<00:00,  7.47s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04109327533878079
Avg hit ratio: 0.8590562648066893
Avg ndcg: 0.8822410987798532
Avg compression ratio: 0.5244187781625071
Avg train time: 10.001611232757568
Std train time: 1.241185905703448
[0.8333333333333334, 0.2777777777777778, 0.16666666666666666, 0.7222222222222222, 0.9444444444444444, 0.8333333333333334, 0.3888888888888889, 0.5, 0.2777777777777778, 0.055555555555555566]
[12, 14, 27, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8706, 'compress@10': 0.8421, 'time@10': 10.0541}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8706, 'compress@10': 0.8421, 'time@10': 10.0541}:  10%|█         | 1/10 [00:05<00:45,  5.07s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8966, 'compress@10': 0.5716, 'time@10': 9.9436}:  10%|█         | 1/10 [00:14<00:45,  5.07s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8966, 'compress@10': 0.5716, 'time@10': 9.9436}:  20%|██        | 2/10 [00:14<01:03,  7.89s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8835, 'compress@10': 0.4763, 'time@10': 9.0841}:  20%|██        | 2/10 [00:18<01:03,  7.89s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8835, 'compress@10': 0.4763, 'time@10': 9.0841}:  30%|███       | 3/10 [00:18<00:41,  5.99s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8942, 'compress@10': 0.5403, 'time@10': 9.18}:  30%|███       | 3/10 [00:28<00:41,  5.99s/it]  {'epoch': 8, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8942, 'compress@10': 0.5403, 'time@10': 9.18}:  40%|████      | 4/10 [00:28<00:44,  7.38s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0399, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8714, 'compress@10': 0.6213, 'time@10': 9.6375}:  40%|████      | 4/10 [00:33<00:44,  7.38s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0399, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8714, 'compress@10': 0.6213, 'time@10': 9.6375}:  50%|█████     | 5/10 [00:33<00:33,  6.80s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8679, 'compress@10': 0.6573, 'time@10': 9.7528}:  50%|█████     | 5/10 [00:44<00:33,  6.80s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8679, 'compress@10': 0.6573, 'time@10': 9.7528}:  60%|██████    | 6/10 [00:44<00:32,  8.01s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0399, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8703, 'compress@10': 0.6224, 'time@10': 9.954}:  60%|██████    | 6/10 [00:49<00:32,  8.01s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0399, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8703, 'compress@10': 0.6224, 'time@10': 9.954}:  70%|███████   | 7/10 [00:49<00:21,  7.23s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0422, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8685, 'compress@10': 0.6089, 'time@10': 9.9445}:  70%|███████   | 7/10 [00:59<00:21,  7.23s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0422, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.8685, 'compress@10': 0.6089, 'time@10': 9.9445}:  80%|████████  | 8/10 [00:59<00:16,  8.08s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0428, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.878, 'compress@10': 0.5744, 'time@10': 10.0812}:  80%|████████  | 8/10 [01:05<00:16,  8.08s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0428, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.878, 'compress@10': 0.5744, 'time@10': 10.0812}:  90%|█████████ | 9/10 [01:05<00:07,  7.31s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0423, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.8755, 'compress@10': 0.5247, 'time@10': 10.0165}:  90%|█████████ | 9/10 [01:14<00:07,  7.31s/it]  {'epoch': 8, 'num_users': 6.3, 'loss': 0.0423, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.8755, 'compress@10': 0.5247, 'time@10': 10.0165}: 100%|██████████| 10/10 [01:14<00:00,  7.98s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0423, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.8755, 'compress@10': 0.5247, 'time@10': 10.0165}: 100%|██████████| 10/10 [01:14<00:00,  7.49s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.042278035736109526
Avg hit ratio: 0.8715642013146256
Avg ndcg: 0.8754682946246506
Avg compression ratio: 0.5246649299063628
Avg train time: 10.016532278060913
Std train time: 1.1215309119740944
[0.8500000000000001, 0.25, 0.15, 0.65, 0.95, 0.8500000000000001, 0.35, 0.55, 0.35, 0.05000000000000001]
[12, 14, 28, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8781, 'compress@10': 0.8579, 'time@10': 10.0958}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8781, 'compress@10': 0.8579, 'time@10': 10.0958}:  10%|█         | 1/10 [00:05<00:45,  5.08s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.912, 'compress@10': 0.566, 'time@10': 10.0166}:  10%|█         | 1/10 [00:15<00:45,  5.08s/it]  {'epoch': 9, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.912, 'compress@10': 0.566, 'time@10': 10.0166}:  20%|██        | 2/10 [00:15<01:03,  7.96s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8937, 'compress@10': 0.4678, 'time@10': 9.2235}:  20%|██        | 2/10 [00:18<01:03,  7.96s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8937, 'compress@10': 0.4678, 'time@10': 9.2235}:  30%|███       | 3/10 [00:18<00:42,  6.09s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.8016, 'ndcg@10': 0.8962, 'compress@10': 0.5165, 'time@10': 9.3078}:  30%|███       | 3/10 [00:28<00:42,  6.09s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.8016, 'ndcg@10': 0.8962, 'compress@10': 0.5165, 'time@10': 9.3078}:  40%|████      | 4/10 [00:28<00:44,  7.47s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0384, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8736, 'compress@10': 0.6034, 'time@10': 9.7415}:  40%|████      | 4/10 [00:34<00:44,  7.47s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0384, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8736, 'compress@10': 0.6034, 'time@10': 9.7415}:  50%|█████     | 5/10 [00:34<00:34,  6.86s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0385, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8709, 'compress@10': 0.6451, 'time@10': 9.8227}:  50%|█████     | 5/10 [00:44<00:34,  6.86s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0385, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8709, 'compress@10': 0.6451, 'time@10': 9.8227}:  60%|██████    | 6/10 [00:44<00:32,  8.02s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0385, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8701, 'compress@10': 0.6066, 'time@10': 10.0706}:  60%|██████    | 6/10 [00:50<00:32,  8.02s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0385, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8701, 'compress@10': 0.6066, 'time@10': 10.0706}:  70%|███████   | 7/10 [00:50<00:21,  7.30s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0376, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8671, 'compress@10': 0.6011, 'time@10': 10.0264}:  70%|███████   | 7/10 [01:00<00:21,  7.30s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0376, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8671, 'compress@10': 0.6011, 'time@10': 10.0264}:  80%|████████  | 8/10 [01:00<00:16,  8.08s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0386, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.8773, 'compress@10': 0.5753, 'time@10': 10.144}:  80%|████████  | 8/10 [01:05<00:16,  8.08s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0386, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.8773, 'compress@10': 0.5753, 'time@10': 10.144}:  90%|█████████ | 9/10 [01:05<00:07,  7.30s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8804, 'compress@10': 0.5249, 'time@10': 10.0893}:  90%|█████████ | 9/10 [01:15<00:07,  7.30s/it]  {'epoch': 9, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8804, 'compress@10': 0.5249, 'time@10': 10.0893}: 100%|██████████| 10/10 [01:15<00:00,  8.02s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8804, 'compress@10': 0.5249, 'time@10': 10.0893}: 100%|██████████| 10/10 [01:15<00:00,  7.53s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03666597846239628
Avg hit ratio: 0.8617765356695747
Avg ndcg: 0.8804328481260384
Avg compression ratio: 0.5249334951112579
Avg train time: 10.089258289337158
Std train time: 1.0857100112016262
[0.8636363636363638, 0.3181818181818182, 0.13636363636363635, 0.5909090909090909, 0.9545454545454545, 0.8636363636363638, 0.3181818181818182, 0.5, 0.40909090909090906, 0.04545454545454546]
[12, 14, 29, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.881, 'compress@10': 0.8708, 'time@10': 9.9448}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.881, 'compress@10': 0.8708, 'time@10': 9.9448}:  10%|█         | 1/10 [00:05<00:45,  5.01s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0436, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.9154, 'compress@10': 0.6055, 'time@10': 9.9772}:  10%|█         | 1/10 [00:15<00:45,  5.01s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0436, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.9154, 'compress@10': 0.6055, 'time@10': 9.9772}:  20%|██        | 2/10 [00:15<01:03,  7.97s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8959, 'compress@10': 0.4902, 'time@10': 9.3256}:  20%|██        | 2/10 [00:19<01:03,  7.97s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8959, 'compress@10': 0.4902, 'time@10': 9.3256}:  30%|███       | 3/10 [00:19<00:43,  6.18s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9098, 'compress@10': 0.5191, 'time@10': 9.3191}:  30%|███       | 3/10 [00:28<00:43,  6.18s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9098, 'compress@10': 0.5191, 'time@10': 9.3191}:  40%|████      | 4/10 [00:28<00:44,  7.43s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.043, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8851, 'compress@10': 0.6063, 'time@10': 9.7525}:  40%|████      | 4/10 [00:34<00:44,  7.43s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.043, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8851, 'compress@10': 0.6063, 'time@10': 9.7525}:  50%|█████     | 5/10 [00:34<00:34,  6.83s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0418, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8826, 'compress@10': 0.6497, 'time@10': 9.8046}:  50%|█████     | 5/10 [00:44<00:34,  6.83s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0418, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8826, 'compress@10': 0.6497, 'time@10': 9.8046}:  60%|██████    | 6/10 [00:44<00:31,  7.94s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0401, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8842, 'compress@10': 0.6063, 'time@10': 10.0583}:  60%|██████    | 6/10 [00:50<00:31,  7.94s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0401, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8842, 'compress@10': 0.6063, 'time@10': 10.0583}:  70%|███████   | 7/10 [00:50<00:21,  7.25s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.038, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8881, 'compress@10': 0.5948, 'time@10': 10.0133}:  70%|███████   | 7/10 [00:59<00:21,  7.25s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.038, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8881, 'compress@10': 0.5948, 'time@10': 10.0133}:  80%|████████  | 8/10 [00:59<00:16,  8.04s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0384, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8914, 'compress@10': 0.576, 'time@10': 10.1908}:  80%|████████  | 8/10 [01:05<00:16,  8.04s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0384, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8914, 'compress@10': 0.576, 'time@10': 10.1908}:  90%|█████████ | 9/10 [01:05<00:07,  7.35s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0373, 'hit_ratio@10': 0.876, 'ndcg@10': 0.8926, 'compress@10': 0.5251, 'time@10': 10.1123}:  90%|█████████ | 9/10 [01:15<00:07,  7.35s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0373, 'hit_ratio@10': 0.876, 'ndcg@10': 0.8926, 'compress@10': 0.5251, 'time@10': 10.1123}: 100%|██████████| 10/10 [01:15<00:00,  8.00s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0373, 'hit_ratio@10': 0.876, 'ndcg@10': 0.8926, 'compress@10': 0.5251, 'time@10': 10.1123}: 100%|██████████| 10/10 [01:15<00:00,  7.52s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03729504114210393
Avg hit ratio: 0.8760217993664513
Avg ndcg: 0.8925872321838092
Avg compression ratio: 0.5251207085969998
Avg train time: 10.112343811988831
Std train time: 1.0966440396317334
[0.8750000000000001, 0.375, 0.12499999999999999, 0.625, 0.9583333333333333, 0.7916666666666667, 0.2916666666666667, 0.4583333333333333, 0.4583333333333333, 0.04166666666666667]
[12, 14, 30, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8874, 'compress@10': 0.8816, 'time@10': 10.0275}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8874, 'compress@10': 0.8816, 'time@10': 10.0275}:  10%|█         | 1/10 [00:05<00:45,  5.06s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8693, 'compress@10': 0.6384, 'time@10': 10.1468}:  10%|█         | 1/10 [00:15<00:45,  5.06s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8693, 'compress@10': 0.6384, 'time@10': 10.1468}:  20%|██        | 2/10 [00:15<01:05,  8.14s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8652, 'compress@10': 0.5089, 'time@10': 9.536}:  20%|██        | 2/10 [00:19<01:05,  8.14s/it]  {'epoch': 11, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8652, 'compress@10': 0.5089, 'time@10': 9.536}:  30%|███       | 3/10 [00:19<00:44,  6.34s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0296, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8836, 'compress@10': 0.5413, 'time@10': 9.5061}:  30%|███       | 3/10 [00:29<00:44,  6.34s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0296, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8836, 'compress@10': 0.5413, 'time@10': 9.5061}:  40%|████      | 4/10 [00:29<00:45,  7.57s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0386, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8644, 'compress@10': 0.6249, 'time@10': 9.8953}:  40%|████      | 4/10 [00:34<00:45,  7.57s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0386, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8644, 'compress@10': 0.6249, 'time@10': 9.8953}:  50%|█████     | 5/10 [00:34<00:34,  6.92s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.039, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8652, 'compress@10': 0.6534, 'time@10': 9.9835}:  50%|█████     | 5/10 [00:45<00:34,  6.92s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.039, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8652, 'compress@10': 0.6534, 'time@10': 9.9835}:  60%|██████    | 6/10 [00:45<00:32,  8.12s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8696, 'compress@10': 0.6058, 'time@10': 10.1943}:  60%|██████    | 6/10 [00:51<00:32,  8.12s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8696, 'compress@10': 0.6058, 'time@10': 10.1943}:  70%|███████   | 7/10 [00:51<00:22,  7.35s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0409, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.8754, 'compress@10': 0.5893, 'time@10': 10.135}:  70%|███████   | 7/10 [01:00<00:22,  7.35s/it]  {'epoch': 11, 'num_users': 6.125, 'loss': 0.0409, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.8754, 'compress@10': 0.5893, 'time@10': 10.135}:  80%|████████  | 8/10 [01:00<00:16,  8.13s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0407, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8808, 'compress@10': 0.5765, 'time@10': 10.3169}:  80%|████████  | 8/10 [01:06<00:16,  8.13s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0407, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8808, 'compress@10': 0.5765, 'time@10': 10.3169}:  90%|█████████ | 9/10 [01:06<00:07,  7.44s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0401, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8808, 'compress@10': 0.5252, 'time@10': 10.2053}:  90%|█████████ | 9/10 [01:15<00:07,  7.44s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0401, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8808, 'compress@10': 0.5252, 'time@10': 10.2053}: 100%|██████████| 10/10 [01:15<00:00,  7.99s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0401, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8808, 'compress@10': 0.5252, 'time@10': 10.2053}: 100%|██████████| 10/10 [01:15<00:00,  7.59s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.040131167334331794
Avg hit ratio: 0.8852800500763148
Avg ndcg: 0.8808456519491866
Avg compression ratio: 0.5251634354708002
Avg train time: 10.205265974998474
Std train time: 1.0539250348170706
[0.8846153846153847, 0.4230769230769231, 0.11538461538461538, 0.5769230769230769, 0.9615384615384615, 0.8076923076923077, 0.2692307692307693, 0.5, 0.4230769230769231, 0.038461538461538464]
[12, 14, 31, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0351, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8874, 'compress@10': 0.8907, 'time@10': 9.8052}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0351, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8874, 'compress@10': 0.8907, 'time@10': 9.8052}:  10%|█         | 1/10 [00:04<00:44,  4.94s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.919, 'compress@10': 0.6662, 'time@10': 10.1179}:  10%|█         | 1/10 [00:15<00:44,  4.94s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.919, 'compress@10': 0.6662, 'time@10': 10.1179}:  20%|██        | 2/10 [00:15<01:05,  8.19s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8984, 'compress@10': 0.5247, 'time@10': 9.5588}:  20%|██        | 2/10 [00:19<01:05,  8.19s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8984, 'compress@10': 0.5247, 'time@10': 9.5588}:  30%|███       | 3/10 [00:19<00:44,  6.40s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.8016, 'ndcg@10': 0.9058, 'compress@10': 0.5415, 'time@10': 9.5284}:  30%|███       | 3/10 [00:29<00:44,  6.40s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.8016, 'ndcg@10': 0.9058, 'compress@10': 0.5415, 'time@10': 9.5284}:  40%|████      | 4/10 [00:29<00:45,  7.61s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0328, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8826, 'compress@10': 0.6257, 'time@10': 9.8217}:  40%|████      | 4/10 [00:34<00:45,  7.61s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0328, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8826, 'compress@10': 0.6257, 'time@10': 9.8217}:  50%|█████     | 5/10 [00:34<00:34,  6.87s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0338, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8821, 'compress@10': 0.6567, 'time@10': 9.938}:  50%|█████     | 5/10 [00:45<00:34,  6.87s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0338, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8821, 'compress@10': 0.6567, 'time@10': 9.938}:  60%|██████    | 6/10 [00:45<00:32,  8.12s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0346, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8812, 'compress@10': 0.6056, 'time@10': 10.1199}:  60%|██████    | 6/10 [00:50<00:32,  8.12s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0346, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8812, 'compress@10': 0.6056, 'time@10': 10.1199}:  70%|███████   | 7/10 [00:50<00:21,  7.31s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0333, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8802, 'compress@10': 0.5941, 'time@10': 10.0608}:  70%|███████   | 7/10 [01:00<00:21,  7.31s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0333, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8802, 'compress@10': 0.5941, 'time@10': 10.0608}:  80%|████████  | 8/10 [01:00<00:16,  8.07s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0339, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.885, 'compress@10': 0.577, 'time@10': 10.1752}:  80%|████████  | 8/10 [01:06<00:16,  8.07s/it] {'epoch': 12, 'num_users': 6.3333, 'loss': 0.0339, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.885, 'compress@10': 0.577, 'time@10': 10.1752}:  90%|█████████ | 9/10 [01:06<00:07,  7.30s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8905, 'compress@10': 0.5253, 'time@10': 10.0818}:  90%|█████████ | 9/10 [01:15<00:07,  7.30s/it] {'epoch': 12, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8905, 'compress@10': 0.5253, 'time@10': 10.0818}: 100%|██████████| 10/10 [01:15<00:00,  7.91s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8905, 'compress@10': 0.5253, 'time@10': 10.0818}: 100%|██████████| 10/10 [01:15<00:00,  7.55s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03160977046869475
Avg hit ratio: 0.8702209801140193
Avg ndcg: 0.8905286595211187
Avg compression ratio: 0.5253040169598744
Avg train time: 10.081766247749329
Std train time: 0.8673013748035289
[0.8928571428571429, 0.39285714285714285, 0.10714285714285714, 0.5357142857142857, 0.9642857142857142, 0.8214285714285714, 0.32142857142857145, 0.4642857142857143, 0.4642857142857143, 0.03571428571428572]
[12, 14, 32, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.886, 'compress@10': 0.8985, 'time@10': 10.0306}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.886, 'compress@10': 0.8985, 'time@10': 10.0306}:  10%|█         | 1/10 [00:05<00:45,  5.05s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0298, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8909, 'compress@10': 0.6555, 'time@10': 10.0541}:  10%|█         | 1/10 [00:15<00:45,  5.05s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0298, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8909, 'compress@10': 0.6555, 'time@10': 10.0541}:  20%|██        | 2/10 [00:15<01:04,  8.03s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8797, 'compress@10': 0.5152, 'time@10': 9.5869}:  20%|██        | 2/10 [00:19<01:04,  8.03s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8797, 'compress@10': 0.5152, 'time@10': 9.5869}:  30%|███       | 3/10 [00:19<00:44,  6.36s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9035, 'compress@10': 0.5245, 'time@10': 9.62}:  30%|███       | 3/10 [00:29<00:44,  6.36s/it]  {'epoch': 13, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9035, 'compress@10': 0.5245, 'time@10': 9.62}:  40%|████      | 4/10 [00:29<00:46,  7.70s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8823, 'compress@10': 0.6126, 'time@10': 9.9043}:  40%|████      | 4/10 [00:34<00:46,  7.70s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8823, 'compress@10': 0.6126, 'time@10': 9.9043}:  50%|█████     | 5/10 [00:34<00:34,  6.93s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0309, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.8861, 'compress@10': 0.648, 'time@10': 9.9932}:  50%|█████     | 5/10 [00:45<00:34,  6.93s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0309, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.8861, 'compress@10': 0.648, 'time@10': 9.9932}:  60%|██████    | 6/10 [00:45<00:32,  8.13s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0304, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8873, 'compress@10': 0.6053, 'time@10': 10.1938}:  60%|██████    | 6/10 [00:51<00:32,  8.13s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0304, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8873, 'compress@10': 0.6053, 'time@10': 10.1938}:  70%|███████   | 7/10 [00:51<00:22,  7.35s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.029, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.8922, 'compress@10': 0.5896, 'time@10': 10.1341}:  70%|███████   | 7/10 [01:00<00:22,  7.35s/it]  {'epoch': 13, 'num_users': 6.125, 'loss': 0.029, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.8922, 'compress@10': 0.5896, 'time@10': 10.1341}:  80%|████████  | 8/10 [01:00<00:16,  8.12s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8942, 'compress@10': 0.5773, 'time@10': 10.2785}:  80%|████████  | 8/10 [01:06<00:16,  8.12s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8942, 'compress@10': 0.5773, 'time@10': 10.2785}:  90%|█████████ | 9/10 [01:06<00:07,  7.38s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8965, 'compress@10': 0.5254, 'time@10': 10.1367}:  90%|█████████ | 9/10 [01:15<00:07,  7.38s/it]  {'epoch': 13, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8965, 'compress@10': 0.5254, 'time@10': 10.1367}: 100%|██████████| 10/10 [01:15<00:00,  7.85s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.8965, 'compress@10': 0.5254, 'time@10': 10.1367}: 100%|██████████| 10/10 [01:15<00:00,  7.55s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.0304106951416477
Avg hit ratio: 0.8811971007675592
Avg ndcg: 0.8964605779486797
Avg compression ratio: 0.5253674608340997
Avg train time: 10.136687755584717
Std train time: 0.9152500700412025
[0.9, 0.36666666666666664, 0.09999999999999999, 0.5, 0.9666666666666666, 0.8333333333333333, 0.30000000000000004, 0.43333333333333335, 0.5, 0.1]
[12, 14, 33, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0318, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.886, 'compress@10': 0.9052, 'time@10': 9.7663}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0318, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.886, 'compress@10': 0.9052, 'time@10': 9.7663}:  10%|█         | 1/10 [00:04<00:44,  4.92s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8941, 'compress@10': 0.6462, 'time@10': 9.8719}:  10%|█         | 1/10 [00:14<00:44,  4.92s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8941, 'compress@10': 0.6462, 'time@10': 9.8719}:  20%|██        | 2/10 [00:14<01:03,  7.92s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8818, 'compress@10': 0.507, 'time@10': 9.5771}:  20%|██        | 2/10 [00:19<01:03,  7.92s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8818, 'compress@10': 0.507, 'time@10': 9.5771}:  30%|███       | 3/10 [00:19<00:44,  6.37s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9043, 'compress@10': 0.5097, 'time@10': 9.5732}:  30%|███       | 3/10 [00:29<00:44,  6.37s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9043, 'compress@10': 0.5097, 'time@10': 9.5732}:  40%|████      | 4/10 [00:29<00:45,  7.64s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0326, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8831, 'compress@10': 0.6012, 'time@10': 9.8216}:  40%|████      | 4/10 [00:34<00:45,  7.64s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0326, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8831, 'compress@10': 0.6012, 'time@10': 9.8216}:  50%|█████     | 5/10 [00:34<00:34,  6.85s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0315, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8879, 'compress@10': 0.6405, 'time@10': 9.8927}:  50%|█████     | 5/10 [00:44<00:34,  6.85s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0315, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8879, 'compress@10': 0.6405, 'time@10': 9.8927}:  60%|██████    | 6/10 [00:44<00:32,  8.02s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8905, 'compress@10': 0.5959, 'time@10': 10.1054}:  60%|██████    | 6/10 [00:50<00:32,  8.02s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8905, 'compress@10': 0.5959, 'time@10': 10.1054}:  70%|███████   | 7/10 [00:50<00:21,  7.27s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0335, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9009, 'compress@10': 0.5776, 'time@10': 10.0504}:  70%|███████   | 7/10 [01:00<00:21,  7.27s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0335, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9009, 'compress@10': 0.5776, 'time@10': 10.0504}:  80%|████████  | 8/10 [01:00<00:16,  8.04s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.034, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9016, 'compress@10': 0.5705, 'time@10': 10.1832}:  80%|████████  | 8/10 [01:05<00:16,  8.04s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.034, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9016, 'compress@10': 0.5705, 'time@10': 10.1832}:  90%|█████████ | 9/10 [01:05<00:07,  7.30s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9059, 'compress@10': 0.5255, 'time@10': 10.255}:  90%|█████████ | 9/10 [01:16<00:07,  7.30s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9059, 'compress@10': 0.5255, 'time@10': 10.255}: 100%|██████████| 10/10 [01:16<00:00,  8.42s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9059, 'compress@10': 0.5255, 'time@10': 10.255}: 100%|██████████| 10/10 [01:16<00:00,  7.68s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.03315491899029821
Avg hit ratio: 0.8826126851831436
Avg ndcg: 0.9059096369475175
Avg compression ratio: 0.525539252767159
Avg train time: 10.254998683929443
Std train time: 0.7569964468218404
[0.90625, 0.40625, 0.09374999999999999, 0.46875, 0.9687499999999999, 0.7812499999999999, 0.28125000000000006, 0.46875, 0.53125, 0.09375]
[12, 14, 34, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0324, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.886, 'compress@10': 0.9112, 'time@10': 9.5475}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0324, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.886, 'compress@10': 0.9112, 'time@10': 9.5475}:  10%|█         | 1/10 [00:04<00:43,  4.81s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.9685, 'compress@10': 0.6683, 'time@10': 9.7551}:  10%|█         | 1/10 [00:14<00:43,  4.81s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.9685, 'compress@10': 0.6683, 'time@10': 9.7551}:  20%|██        | 2/10 [00:14<01:02,  7.86s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.9313, 'compress@10': 0.5199, 'time@10': 9.5082}:  20%|██        | 2/10 [00:19<01:02,  7.86s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.9313, 'compress@10': 0.5199, 'time@10': 9.5082}:  30%|███       | 3/10 [00:19<00:44,  6.35s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9511, 'compress@10': 0.5119, 'time@10': 9.5863}:  30%|███       | 3/10 [00:29<00:44,  6.35s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9511, 'compress@10': 0.5119, 'time@10': 9.5863}:  40%|████      | 4/10 [00:29<00:46,  7.73s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.033, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.9212, 'compress@10': 0.6034, 'time@10': 9.8871}:  40%|████      | 4/10 [00:34<00:46,  7.73s/it] {'epoch': 15, 'num_users': 5.8, 'loss': 0.033, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.9212, 'compress@10': 0.6034, 'time@10': 9.8871}:  50%|█████     | 5/10 [00:34<00:34,  6.96s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0333, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9191, 'compress@10': 0.6338, 'time@10': 9.9514}:  50%|█████     | 5/10 [00:45<00:34,  6.96s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0333, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9191, 'compress@10': 0.6338, 'time@10': 9.9514}:  60%|██████    | 6/10 [00:45<00:32,  8.10s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.034, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.915, 'compress@10': 0.5876, 'time@10': 10.1823}:  60%|██████    | 6/10 [00:50<00:32,  8.10s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.034, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.915, 'compress@10': 0.5876, 'time@10': 10.1823}:  70%|███████   | 7/10 [00:50<00:22,  7.35s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0327, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9099, 'compress@10': 0.5746, 'time@10': 10.1124}:  70%|███████   | 7/10 [01:00<00:22,  7.35s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0327, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9099, 'compress@10': 0.5746, 'time@10': 10.1124}:  80%|████████  | 8/10 [01:00<00:16,  8.09s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0332, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9102, 'compress@10': 0.5713, 'time@10': 10.2404}:  80%|████████  | 8/10 [01:06<00:16,  8.09s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0332, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9102, 'compress@10': 0.5713, 'time@10': 10.2404}:  90%|█████████ | 9/10 [01:06<00:07,  7.33s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9148, 'compress@10': 0.5256, 'time@10': 10.274}:  90%|█████████ | 9/10 [01:16<00:07,  7.33s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9148, 'compress@10': 0.5256, 'time@10': 10.274}: 100%|██████████| 10/10 [01:16<00:00,  8.34s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9148, 'compress@10': 0.5256, 'time@10': 10.274}: 100%|██████████| 10/10 [01:16<00:00,  7.69s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.03170101817918571
Avg hit ratio: 0.8813868787315308
Avg ndcg: 0.9147575471138868
Avg compression ratio: 0.5255906089605158
Avg train time: 10.274021339416503
Std train time: 0.7908088349412284
[0.8529411764705882, 0.4411764705882353, 0.08823529411764705, 0.4411764705882353, 0.9705882352941175, 0.7941176470588234, 0.32352941176470595, 0.4411764705882353, 0.5588235294117647, 0.08823529411764706]
[12, 14, 35, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0275, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8824, 'compress@10': 0.8607, 'time@10': 9.6434}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0275, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8824, 'compress@10': 0.8607, 'time@10': 9.6434}:  10%|█         | 1/10 [00:04<00:43,  4.86s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.9135, 'compress@10': 0.6599, 'time@10': 9.9781}:  10%|█         | 1/10 [00:15<00:43,  4.86s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.9135, 'compress@10': 0.6599, 'time@10': 9.9781}:  20%|██        | 2/10 [00:15<01:04,  8.09s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8947, 'compress@10': 0.5128, 'time@10': 9.872}:  20%|██        | 2/10 [00:20<01:04,  8.09s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8947, 'compress@10': 0.5128, 'time@10': 9.872}:  30%|███       | 3/10 [00:20<00:46,  6.62s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9331, 'compress@10': 0.4999, 'time@10': 9.7994}:  30%|███       | 3/10 [00:29<00:46,  6.62s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9331, 'compress@10': 0.4999, 'time@10': 9.7994}:  40%|████      | 4/10 [00:29<00:46,  7.80s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0262, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.9077, 'compress@10': 0.5941, 'time@10': 10.0367}:  40%|████      | 4/10 [00:35<00:46,  7.80s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0262, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.9077, 'compress@10': 0.5941, 'time@10': 10.0367}:  50%|█████     | 5/10 [00:35<00:34,  6.98s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.027, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.912, 'compress@10': 0.6282, 'time@10': 10.0622}:  50%|█████     | 5/10 [00:45<00:34,  6.98s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.027, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.912, 'compress@10': 0.6282, 'time@10': 10.0622}:  60%|██████    | 6/10 [00:45<00:32,  8.09s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0269, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9093, 'compress@10': 0.5886, 'time@10': 10.2346}:  60%|██████    | 6/10 [00:51<00:32,  8.09s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0269, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9093, 'compress@10': 0.5886, 'time@10': 10.2346}:  70%|███████   | 7/10 [00:51<00:21,  7.30s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0259, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9131, 'compress@10': 0.5721, 'time@10': 10.1676}:  70%|███████   | 7/10 [01:00<00:21,  7.30s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0259, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9131, 'compress@10': 0.5721, 'time@10': 10.1676}:  80%|████████  | 8/10 [01:00<00:16,  8.08s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9142, 'compress@10': 0.5721, 'time@10': 10.2931}:  80%|████████  | 8/10 [01:06<00:16,  8.08s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.9142, 'compress@10': 0.5721, 'time@10': 10.2931}:  90%|█████████ | 9/10 [01:06<00:07,  7.33s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.917, 'compress@10': 0.5257, 'time@10': 10.3533}:  90%|█████████ | 9/10 [01:17<00:07,  7.33s/it]     {'epoch': 16, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.917, 'compress@10': 0.5257, 'time@10': 10.3533}: 100%|██████████| 10/10 [01:17<00:00,  8.44s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.917, 'compress@10': 0.5257, 'time@10': 10.3533}: 100%|██████████| 10/10 [01:17<00:00,  7.75s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.026979147193517232
Avg hit ratio: 0.8785297358743879
Avg ndcg: 0.9169938055808793
Avg compression ratio: 0.5257453917951054
Avg train time: 10.353285241127015
Std train time: 0.6679598095000504
[0.8055555555555556, 0.41666666666666663, 0.08333333333333333, 0.4722222222222222, 0.9722222222222221, 0.8055555555555554, 0.30555555555555564, 0.41666666666666663, 0.5833333333333334, 0.1388888888888889]
[12, 14, 35, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8823, 'compress@10': 0.8158, 'time@10': 10.077}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8823, 'compress@10': 0.8158, 'time@10': 10.077}:  10%|█         | 1/10 [00:05<00:45,  5.08s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9864, 'compress@10': 0.6256, 'time@10': 10.1346}:  10%|█         | 1/10 [00:15<00:45,  5.08s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9864, 'compress@10': 0.6256, 'time@10': 10.1346}:  20%|██        | 2/10 [00:15<01:04,  8.11s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9433, 'compress@10': 0.4885, 'time@10': 9.9073}:  20%|██        | 2/10 [00:20<01:04,  8.11s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9433, 'compress@10': 0.4885, 'time@10': 9.9073}:  30%|███       | 3/10 [00:20<00:46,  6.58s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9617, 'compress@10': 0.4892, 'time@10': 9.8205}:  30%|███       | 3/10 [00:29<00:46,  6.58s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9617, 'compress@10': 0.4892, 'time@10': 9.8205}:  40%|████      | 4/10 [00:29<00:46,  7.77s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.9307, 'compress@10': 0.5859, 'time@10': 9.9431}:  40%|████      | 4/10 [00:34<00:46,  7.77s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.9307, 'compress@10': 0.5859, 'time@10': 9.9431}:  50%|█████     | 5/10 [00:34<00:34,  6.86s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0279, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.932, 'compress@10': 0.6232, 'time@10': 9.9734}:  50%|█████     | 5/10 [00:45<00:34,  6.86s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0279, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.932, 'compress@10': 0.6232, 'time@10': 9.9734}:  60%|██████    | 6/10 [00:45<00:31,  7.98s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0265, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9309, 'compress@10': 0.5818, 'time@10': 10.1882}:  60%|██████    | 6/10 [00:50<00:31,  7.98s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0265, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9309, 'compress@10': 0.5818, 'time@10': 10.1882}:  70%|███████   | 7/10 [00:50<00:21,  7.26s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9328, 'compress@10': 0.5632, 'time@10': 10.1001}:  70%|███████   | 7/10 [01:00<00:21,  7.26s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9328, 'compress@10': 0.5632, 'time@10': 10.1001}:  80%|████████  | 8/10 [01:00<00:15,  7.98s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.932, 'compress@10': 0.5668, 'time@10': 10.2145}:  80%|████████  | 8/10 [01:05<00:15,  7.98s/it] {'epoch': 17, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.932, 'compress@10': 0.5668, 'time@10': 10.2145}:  90%|█████████ | 9/10 [01:05<00:07,  7.24s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0271, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.935, 'compress@10': 0.526, 'time@10': 10.2893}:  90%|█████████ | 9/10 [01:16<00:07,  7.24s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0271, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.935, 'compress@10': 0.526, 'time@10': 10.2893}: 100%|██████████| 10/10 [01:16<00:00,  8.40s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0271, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.935, 'compress@10': 0.526, 'time@10': 10.2893}: 100%|██████████| 10/10 [01:16<00:00,  7.70s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02705319100663147
Avg hit ratio: 0.8813417659495759
Avg ndcg: 0.9350028914592302
Avg compression ratio: 0.5259622812344719
Avg train time: 10.289327263832092
Std train time: 0.674714348892112
[0.8157894736842105, 0.4473684210526315, 0.07894736842105263, 0.4473684210526316, 0.9736842105263157, 0.7631578947368419, 0.2894736842105264, 0.4473684210526315, 0.6052631578947368, 0.13157894736842105]
[12, 14, 35, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8854, 'compress@10': 0.8255, 'time@10': 9.88}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8854, 'compress@10': 0.8255, 'time@10': 9.88}:  10%|█         | 1/10 [00:04<00:44,  4.98s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9368, 'compress@10': 0.6453, 'time@10': 9.9694}:  10%|█         | 1/10 [00:15<00:44,  4.98s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9368, 'compress@10': 0.6453, 'time@10': 9.9694}:  20%|██        | 2/10 [00:15<01:03,  7.99s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9102, 'compress@10': 0.5004, 'time@10': 9.687}:  20%|██        | 2/10 [00:19<01:03,  7.99s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9102, 'compress@10': 0.5004, 'time@10': 9.687}:  30%|███       | 3/10 [00:19<00:45,  6.44s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9273, 'compress@10': 0.4921, 'time@10': 9.6876}:  30%|███       | 3/10 [00:29<00:45,  6.44s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9273, 'compress@10': 0.4921, 'time@10': 9.6876}:  40%|████      | 4/10 [00:29<00:46,  7.74s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0247, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9041, 'compress@10': 0.5885, 'time@10': 9.8609}:  40%|████      | 4/10 [00:34<00:46,  7.74s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0247, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9041, 'compress@10': 0.5885, 'time@10': 9.8609}:  50%|█████     | 5/10 [00:34<00:34,  6.86s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0249, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9105, 'compress@10': 0.6185, 'time@10': 9.8773}:  50%|█████     | 5/10 [00:44<00:34,  6.86s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0249, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9105, 'compress@10': 0.6185, 'time@10': 9.8773}:  60%|██████    | 6/10 [00:44<00:31,  7.93s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0262, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9097, 'compress@10': 0.5755, 'time@10': 10.081}:  60%|██████    | 6/10 [00:50<00:31,  7.93s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0262, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9097, 'compress@10': 0.5755, 'time@10': 10.081}:  70%|███████   | 7/10 [00:50<00:21,  7.20s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0259, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9065, 'compress@10': 0.5615, 'time@10': 10.0263}:  70%|███████   | 7/10 [01:00<00:21,  7.20s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0259, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9065, 'compress@10': 0.5615, 'time@10': 10.0263}:  80%|████████  | 8/10 [01:00<00:15,  7.99s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0267, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.9084, 'compress@10': 0.5676, 'time@10': 10.1671}:  80%|████████  | 8/10 [01:05<00:15,  7.99s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0267, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.9084, 'compress@10': 0.5676, 'time@10': 10.1671}:  90%|█████████ | 9/10 [01:05<00:07,  7.27s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0274, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9109, 'compress@10': 0.526, 'time@10': 10.2506}:  90%|█████████ | 9/10 [01:16<00:07,  7.27s/it]    {'epoch': 18, 'num_users': 6.3, 'loss': 0.0274, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9109, 'compress@10': 0.526, 'time@10': 10.2506}: 100%|██████████| 10/10 [01:16<00:00,  8.43s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0274, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9109, 'compress@10': 0.526, 'time@10': 10.2506}: 100%|██████████| 10/10 [01:16<00:00,  7.68s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.027380839149790198
Avg hit ratio: 0.8853791173926998
Avg ndcg: 0.9109320412868346
Avg compression ratio: 0.5259820316266092
Avg train time: 10.25057544708252
Std train time: 0.7117689449377599
[0.825, 0.42499999999999993, 0.075, 0.425, 0.9749999999999999, 0.7249999999999999, 0.32500000000000007, 0.42499999999999993, 0.625, 0.175]
[12, 14, 36, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0253, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.886, 'compress@10': 0.8342, 'time@10': 9.5843}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0253, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.886, 'compress@10': 0.8342, 'time@10': 9.5843}:  10%|█         | 1/10 [00:04<00:43,  4.83s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9193, 'compress@10': 0.6389, 'time@10': 9.8171}:  10%|█         | 1/10 [00:14<00:43,  4.83s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9193, 'compress@10': 0.6389, 'time@10': 9.8171}:  20%|██        | 2/10 [00:14<01:03,  7.92s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8985, 'compress@10': 0.495, 'time@10': 9.879}:  20%|██        | 2/10 [00:19<01:03,  7.92s/it]  {'epoch': 19, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8985, 'compress@10': 0.495, 'time@10': 9.879}:  30%|███       | 3/10 [00:19<00:46,  6.61s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9304, 'compress@10': 0.4826, 'time@10': 9.7811}:  30%|███       | 3/10 [00:29<00:46,  6.61s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9304, 'compress@10': 0.4826, 'time@10': 9.7811}:  40%|████      | 4/10 [00:29<00:46,  7.76s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9072, 'compress@10': 0.5812, 'time@10': 9.9333}:  40%|████      | 4/10 [00:34<00:46,  7.76s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9072, 'compress@10': 0.5812, 'time@10': 9.9333}:  50%|█████     | 5/10 [00:34<00:34,  6.88s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9131, 'compress@10': 0.6062, 'time@10': 9.9375}:  50%|█████     | 5/10 [00:44<00:34,  6.88s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9131, 'compress@10': 0.6062, 'time@10': 9.9375}:  60%|██████    | 6/10 [00:44<00:31,  7.94s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0278, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9128, 'compress@10': 0.5699, 'time@10': 10.143}:  60%|██████    | 6/10 [00:50<00:31,  7.94s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0278, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9128, 'compress@10': 0.5699, 'time@10': 10.143}:  70%|███████   | 7/10 [00:50<00:21,  7.22s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0262, 'hit_ratio@10': 0.9169, 'ndcg@10': 0.9181, 'compress@10': 0.5538, 'time@10': 10.0929}:  70%|███████   | 7/10 [01:00<00:21,  7.22s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0262, 'hit_ratio@10': 0.9169, 'ndcg@10': 0.9181, 'compress@10': 0.5538, 'time@10': 10.0929}:  80%|████████  | 8/10 [01:00<00:16,  8.04s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0269, 'hit_ratio@10': 0.888, 'ndcg@10': 0.919, 'compress@10': 0.5629, 'time@10': 10.2021}:  80%|████████  | 8/10 [01:05<00:16,  8.04s/it] {'epoch': 19, 'num_users': 6.3333, 'loss': 0.0269, 'hit_ratio@10': 0.888, 'ndcg@10': 0.919, 'compress@10': 0.5629, 'time@10': 10.2021}:  90%|█████████ | 9/10 [01:05<00:07,  7.27s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9244, 'compress@10': 0.526, 'time@10': 10.2803}:  90%|█████████ | 9/10 [01:16<00:07,  7.27s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9244, 'compress@10': 0.526, 'time@10': 10.2803}: 100%|██████████| 10/10 [01:16<00:00,  8.43s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0248, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9244, 'compress@10': 0.526, 'time@10': 10.2803}: 100%|██████████| 10/10 [01:16<00:00,  7.69s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.024810441655623384
Avg hit ratio: 0.896933136849945
Avg ndcg: 0.924381264796574
Avg compression ratio: 0.5259912268005531
Avg train time: 10.280283403396606
Std train time: 0.635036672065868
[0.7857142857142857, 0.45238095238095233, 0.07142857142857142, 0.4523809523809524, 0.976190476190476, 0.7380952380952379, 0.3095238095238096, 0.4047619047619047, 0.6428571428571429, 0.16666666666666666]
[12, 14, 36, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9016, 'compress@10': 0.797, 'time@10': 10.288}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9016, 'compress@10': 0.797, 'time@10': 10.288}:  10%|█         | 1/10 [00:05<00:46,  5.18s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9562, 'compress@10': 0.6335, 'time@10': 10.1811}:  10%|█         | 1/10 [00:15<00:46,  5.18s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9562, 'compress@10': 0.6335, 'time@10': 10.1811}:  20%|██        | 2/10 [00:15<01:04,  8.08s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9232, 'compress@10': 0.4904, 'time@10': 9.9939}:  20%|██        | 2/10 [00:20<01:04,  8.08s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9232, 'compress@10': 0.4904, 'time@10': 9.9939}:  30%|███       | 3/10 [00:20<00:46,  6.60s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9398, 'compress@10': 0.4858, 'time@10': 9.8465}:  30%|███       | 3/10 [00:29<00:46,  6.60s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9398, 'compress@10': 0.4858, 'time@10': 9.8465}:  40%|████      | 4/10 [00:29<00:46,  7.72s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.026, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9173, 'compress@10': 0.5839, 'time@10': 9.9674}:  40%|████      | 4/10 [00:34<00:46,  7.72s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.026, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9173, 'compress@10': 0.5839, 'time@10': 9.9674}:  50%|█████     | 5/10 [00:34<00:34,  6.84s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9223, 'compress@10': 0.6106, 'time@10': 9.9937}:  50%|█████     | 5/10 [00:45<00:34,  6.84s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9223, 'compress@10': 0.6106, 'time@10': 9.9937}:  60%|██████    | 6/10 [00:45<00:31,  7.97s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0227, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9251, 'compress@10': 0.5715, 'time@10': 10.206}:  60%|██████    | 6/10 [00:50<00:31,  7.97s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0227, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9251, 'compress@10': 0.5715, 'time@10': 10.206}:  70%|███████   | 7/10 [00:50<00:21,  7.25s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9294, 'compress@10': 0.5528, 'time@10': 10.153}:  70%|███████   | 7/10 [01:00<00:21,  7.25s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9294, 'compress@10': 0.5528, 'time@10': 10.153}:  80%|████████  | 8/10 [01:00<00:16,  8.07s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0256, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9292, 'compress@10': 0.564, 'time@10': 10.2558}:  80%|████████  | 8/10 [01:06<00:16,  8.07s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0256, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9292, 'compress@10': 0.564, 'time@10': 10.2558}:  90%|█████████ | 9/10 [01:06<00:07,  7.29s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9348, 'compress@10': 0.5261, 'time@10': 10.3202}:  90%|█████████ | 9/10 [01:17<00:07,  7.29s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9348, 'compress@10': 0.5261, 'time@10': 10.3202}: 100%|██████████| 10/10 [01:17<00:00,  8.42s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9348, 'compress@10': 0.5261, 'time@10': 10.3202}: 100%|██████████| 10/10 [01:17<00:00,  7.71s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.026199293539472156
Avg hit ratio: 0.8840299110434934
Avg ndcg: 0.9347671971629609
Avg compression ratio: 0.5261200986127823
Avg train time: 10.320231318473816
Std train time: 0.6318984399993227
[0.75, 0.47727272727272724, 0.06818181818181818, 0.4318181818181818, 0.9772727272727272, 0.7045454545454544, 0.2954545454545455, 0.43181818181818177, 0.6590909090909092, 0.20454545454545453]
[12, 14, 36, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8879, 'compress@10': 0.7632, 'time@10': 10.0222}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8879, 'compress@10': 0.7632, 'time@10': 10.0222}:  10%|█         | 1/10 [00:05<00:45,  5.06s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9223, 'compress@10': 0.6286, 'time@10': 10.036}:  10%|█         | 1/10 [00:15<00:45,  5.06s/it]  {'epoch': 21, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9223, 'compress@10': 0.6286, 'time@10': 10.036}:  20%|██        | 2/10 [00:15<01:04,  8.02s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9006, 'compress@10': 0.4862, 'time@10': 9.8401}:  20%|██        | 2/10 [00:19<01:04,  8.02s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9006, 'compress@10': 0.4862, 'time@10': 9.8401}:  30%|███       | 3/10 [00:19<00:45,  6.53s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.916, 'compress@10': 0.4777, 'time@10': 9.7528}:  30%|███       | 3/10 [00:29<00:45,  6.53s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.916, 'compress@10': 0.4777, 'time@10': 9.7528}:  40%|████      | 4/10 [00:29<00:46,  7.72s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8995, 'compress@10': 0.5777, 'time@10': 9.9174}:  40%|████      | 4/10 [00:34<00:46,  7.72s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8995, 'compress@10': 0.5777, 'time@10': 9.9174}:  50%|█████     | 5/10 [00:34<00:34,  6.85s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9087, 'compress@10': 0.5999, 'time@10': 9.9989}:  50%|█████     | 5/10 [00:45<00:34,  6.85s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9087, 'compress@10': 0.5999, 'time@10': 9.9989}:  60%|██████    | 6/10 [00:45<00:32,  8.07s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0194, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9093, 'compress@10': 0.5605, 'time@10': 10.1933}:  60%|██████    | 6/10 [00:50<00:32,  8.07s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0194, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9093, 'compress@10': 0.5605, 'time@10': 10.1933}:  70%|███████   | 7/10 [00:50<00:21,  7.30s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0197, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9096, 'compress@10': 0.5464, 'time@10': 10.1352}:  70%|███████   | 7/10 [01:00<00:21,  7.30s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0197, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9096, 'compress@10': 0.5464, 'time@10': 10.1352}:  80%|████████  | 8/10 [01:00<00:16,  8.09s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9115, 'compress@10': 0.56, 'time@10': 10.2512}:  80%|████████  | 8/10 [01:06<00:16,  8.09s/it] {'epoch': 21, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9115, 'compress@10': 0.56, 'time@10': 10.2512}:  90%|█████████ | 9/10 [01:06<00:07,  7.32s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9173, 'compress@10': 0.5263, 'time@10': 10.3274}:  90%|█████████ | 9/10 [01:17<00:07,  7.32s/it] {'epoch': 21, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9173, 'compress@10': 0.5263, 'time@10': 10.3274}: 100%|██████████| 10/10 [01:17<00:00,  8.47s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9173, 'compress@10': 0.5263, 'time@10': 10.3274}: 100%|██████████| 10/10 [01:17<00:00,  7.74s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.01979528858868928
Avg hit ratio: 0.8904815239467192
Avg ndcg: 0.9173094776211392
Avg compression ratio: 0.5262670247993004
Avg train time: 10.327444934844971
Std train time: 0.6582200956088552
[0.7608695652173914, 0.45652173913043476, 0.06521739130434782, 0.41304347826086957, 0.9782608695652173, 0.6739130434782606, 0.3260869565217392, 0.45652173913043476, 0.673913043478261, 0.19565217391304346]
[12, 14, 36, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9092, 'compress@10': 0.7734, 'time@10': 10.1558}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9092, 'compress@10': 0.7734, 'time@10': 10.1558}:  10%|█         | 1/10 [00:05<00:46,  5.11s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.977, 'compress@10': 0.6237, 'time@10': 10.007}:  10%|█         | 1/10 [00:15<00:46,  5.11s/it]  {'epoch': 22, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.977, 'compress@10': 0.6237, 'time@10': 10.007}:  20%|██        | 2/10 [00:15<01:03,  7.93s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9371, 'compress@10': 0.4821, 'time@10': 9.7196}:  20%|██        | 2/10 [00:19<01:03,  7.93s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9371, 'compress@10': 0.4821, 'time@10': 9.7196}:  30%|███       | 3/10 [00:19<00:44,  6.41s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9654, 'compress@10': 0.4701, 'time@10': 9.6715}:  30%|███       | 3/10 [00:29<00:44,  6.41s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9654, 'compress@10': 0.4701, 'time@10': 9.6715}:  40%|████      | 4/10 [00:29<00:45,  7.66s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0236, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.941, 'compress@10': 0.5718, 'time@10': 9.9025}:  40%|████      | 4/10 [00:34<00:45,  7.66s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0236, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.941, 'compress@10': 0.5718, 'time@10': 9.9025}:  50%|█████     | 5/10 [00:34<00:34,  6.87s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0249, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9426, 'compress@10': 0.59, 'time@10': 9.9755}:  50%|█████     | 5/10 [00:45<00:34,  6.87s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0249, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9426, 'compress@10': 0.59, 'time@10': 9.9755}:  60%|██████    | 6/10 [00:45<00:32,  8.06s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9394, 'compress@10': 0.5562, 'time@10': 10.1793}:  60%|██████    | 6/10 [00:50<00:32,  8.06s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9394, 'compress@10': 0.5562, 'time@10': 10.1793}:  70%|███████   | 7/10 [00:50<00:21,  7.30s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0228, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.9425, 'compress@10': 0.5456, 'time@10': 10.1182}:  70%|███████   | 7/10 [01:00<00:21,  7.30s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0228, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.9425, 'compress@10': 0.5456, 'time@10': 10.1182}:  80%|████████  | 8/10 [01:00<00:16,  8.08s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9412, 'compress@10': 0.5609, 'time@10': 10.2113}:  80%|████████  | 8/10 [01:06<00:16,  8.08s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9412, 'compress@10': 0.5609, 'time@10': 10.2113}:  90%|█████████ | 9/10 [01:06<00:07,  7.28s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0239, 'hit_ratio@10': 0.904, 'ndcg@10': 0.942, 'compress@10': 0.5262, 'time@10': 10.292}:  90%|█████████ | 9/10 [01:17<00:07,  7.28s/it]      {'epoch': 22, 'num_users': 6.3, 'loss': 0.0239, 'hit_ratio@10': 0.904, 'ndcg@10': 0.942, 'compress@10': 0.5262, 'time@10': 10.292}: 100%|██████████| 10/10 [01:17<00:00,  8.44s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0239, 'hit_ratio@10': 0.904, 'ndcg@10': 0.942, 'compress@10': 0.5262, 'time@10': 10.292}: 100%|██████████| 10/10 [01:17<00:00,  7.71s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.023911786192516292
Avg hit ratio: 0.9040299110434933
Avg ndcg: 0.9420325690446669
Avg compression ratio: 0.5262355091351372
Avg train time: 10.292029476165771
Std train time: 0.7041937451262701
[0.7291666666666667, 0.4375, 0.0625, 0.4375, 0.9791666666666665, 0.6874999999999998, 0.31250000000000006, 0.4375, 0.6875000000000001, 0.22916666666666666]
[12, 14, 37, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8888, 'compress@10': 0.7434, 'time@10': 10.2267}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8888, 'compress@10': 0.7434, 'time@10': 10.2267}:  10%|█         | 1/10 [00:05<00:46,  5.16s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9384, 'compress@10': 0.5995, 'time@10': 10.1069}:  10%|█         | 1/10 [00:15<00:46,  5.16s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9384, 'compress@10': 0.5995, 'time@10': 10.1069}:  20%|██        | 2/10 [00:15<01:04,  8.02s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9113, 'compress@10': 0.4652, 'time@10': 10.2789}:  20%|██        | 2/10 [00:20<01:04,  8.02s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9113, 'compress@10': 0.4652, 'time@10': 10.2789}:  30%|███       | 3/10 [00:20<00:47,  6.81s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.924, 'compress@10': 0.4633, 'time@10': 10.0985}:  30%|███       | 3/10 [00:30<00:47,  6.81s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.924, 'compress@10': 0.4633, 'time@10': 10.0985}:  40%|████      | 4/10 [00:30<00:47,  7.91s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0215, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9111, 'compress@10': 0.5665, 'time@10': 10.2093}:  40%|████      | 4/10 [00:35<00:47,  7.91s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0215, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9111, 'compress@10': 0.5665, 'time@10': 10.2093}:  50%|█████     | 5/10 [00:35<00:34,  6.99s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0203, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9191, 'compress@10': 0.5878, 'time@10': 10.2557}:  50%|█████     | 5/10 [00:46<00:34,  6.99s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0203, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9191, 'compress@10': 0.5878, 'time@10': 10.2557}:  60%|██████    | 6/10 [00:46<00:32,  8.19s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.019, 'hit_ratio@10': 0.9105, 'ndcg@10': 0.9224, 'compress@10': 0.5524, 'time@10': 10.4128}:  60%|██████    | 6/10 [00:51<00:32,  8.19s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 0.019, 'hit_ratio@10': 0.9105, 'ndcg@10': 0.9224, 'compress@10': 0.5524, 'time@10': 10.4128}:  70%|███████   | 7/10 [00:51<00:22,  7.38s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0212, 'hit_ratio@10': 0.9181, 'ndcg@10': 0.9337, 'compress@10': 0.5401, 'time@10': 10.3203}:  70%|███████   | 7/10 [01:01<00:22,  7.38s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0212, 'hit_ratio@10': 0.9181, 'ndcg@10': 0.9337, 'compress@10': 0.5401, 'time@10': 10.3203}:  80%|████████  | 8/10 [01:01<00:16,  8.12s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9338, 'compress@10': 0.5575, 'time@10': 10.4094}:  80%|████████  | 8/10 [01:07<00:16,  8.12s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9338, 'compress@10': 0.5575, 'time@10': 10.4094}:  90%|█████████ | 9/10 [01:07<00:07,  7.33s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9373, 'compress@10': 0.5264, 'time@10': 10.4499}:  90%|█████████ | 9/10 [01:17<00:07,  7.33s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9373, 'compress@10': 0.5264, 'time@10': 10.4499}: 100%|██████████| 10/10 [01:17<00:00,  8.42s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9373, 'compress@10': 0.5264, 'time@10': 10.4499}: 100%|██████████| 10/10 [01:17<00:00,  7.79s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.020705278625026538
Avg hit ratio: 0.9036510067936213
Avg ndcg: 0.9372988806036435
Avg compression ratio: 0.5263755732101255
Avg train time: 10.449905586242675
Std train time: 0.5606472047250197
[0.7400000000000001, 0.46, 0.06, 0.42, 0.9799999999999999, 0.6599999999999998, 0.30000000000000004, 0.46, 0.7000000000000001, 0.22]
[12, 14, 37, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7537, 'time@10': 10.0349}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7537, 'time@10': 10.0349}:  10%|█         | 1/10 [00:05<00:45,  5.05s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9667, 'compress@10': 0.6155, 'time@10': 10.0177}:  10%|█         | 1/10 [00:15<00:45,  5.05s/it] {'epoch': 24, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9667, 'compress@10': 0.6155, 'time@10': 10.0177}:  20%|██        | 2/10 [00:15<01:03,  7.99s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9302, 'compress@10': 0.4751, 'time@10': 10.007}:  20%|██        | 2/10 [00:20<01:03,  7.99s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9302, 'compress@10': 0.4751, 'time@10': 10.007}:  30%|███       | 3/10 [00:20<00:46,  6.64s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.937, 'compress@10': 0.4665, 'time@10': 9.9203}:  30%|███       | 3/10 [00:29<00:46,  6.64s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.937, 'compress@10': 0.4665, 'time@10': 9.9203}:  40%|████      | 4/10 [00:29<00:47,  7.85s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9212, 'compress@10': 0.5693, 'time@10': 10.0719}:  40%|████      | 4/10 [00:35<00:47,  7.85s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9212, 'compress@10': 0.5693, 'time@10': 10.0719}:  50%|█████     | 5/10 [00:35<00:34,  6.96s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9284, 'compress@10': 0.5857, 'time@10': 10.1246}:  50%|█████     | 5/10 [00:45<00:34,  6.96s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0198, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9284, 'compress@10': 0.5857, 'time@10': 10.1246}:  60%|██████    | 6/10 [00:45<00:32,  8.14s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0206, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9273, 'compress@10': 0.5489, 'time@10': 10.2892}:  60%|██████    | 6/10 [00:51<00:32,  8.14s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0206, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9273, 'compress@10': 0.5489, 'time@10': 10.2892}:  70%|███████   | 7/10 [00:51<00:21,  7.33s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0207, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9238, 'compress@10': 0.5397, 'time@10': 10.2109}:  70%|███████   | 7/10 [01:01<00:21,  7.33s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0207, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9238, 'compress@10': 0.5397, 'time@10': 10.2109}:  80%|████████  | 8/10 [01:01<00:16,  8.09s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.89, 'ndcg@10': 0.925, 'compress@10': 0.5584, 'time@10': 10.3042}:  80%|████████  | 8/10 [01:06<00:16,  8.09s/it]  {'epoch': 24, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.89, 'ndcg@10': 0.925, 'compress@10': 0.5584, 'time@10': 10.3042}:  90%|█████████ | 9/10 [01:06<00:07,  7.30s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9319, 'compress@10': 0.5264, 'time@10': 10.3592}:  90%|█████████ | 9/10 [01:17<00:07,  7.30s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9319, 'compress@10': 0.5264, 'time@10': 10.3592}: 100%|██████████| 10/10 [01:17<00:00,  8.41s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9319, 'compress@10': 0.5264, 'time@10': 10.3592}: 100%|██████████| 10/10 [01:17<00:00,  7.75s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.02236601960551257
Avg hit ratio: 0.8986842889236778
Avg ndcg: 0.9319144056606781
Avg compression ratio: 0.5263745549028646
Avg train time: 10.35917088985443
Std train time: 0.5490750139670388
[0.7115384615384617, 0.4807692307692308, 0.05769230769230769, 0.40384615384615385, 0.9807692307692306, 0.6346153846153845, 0.326923076923077, 0.44230769230769235, 0.7115384615384616, 0.25]
[12, 14, 37, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9059, 'compress@10': 0.7267, 'time@10': 10.1435}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9059, 'compress@10': 0.7267, 'time@10': 10.1435}:  10%|█         | 1/10 [00:05<00:45,  5.11s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9362, 'compress@10': 0.6121, 'time@10': 10.143}:  10%|█         | 1/10 [00:15<00:45,  5.11s/it]  {'epoch': 25, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9362, 'compress@10': 0.6121, 'time@10': 10.143}:  20%|██        | 2/10 [00:15<01:04,  8.09s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9099, 'compress@10': 0.4722, 'time@10': 10.0652}:  20%|██        | 2/10 [00:20<01:04,  8.09s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9099, 'compress@10': 0.4722, 'time@10': 10.0652}:  30%|███       | 3/10 [00:20<00:46,  6.68s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.928, 'compress@10': 0.4604, 'time@10': 10.0554}:  30%|███       | 3/10 [00:30<00:46,  6.68s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.928, 'compress@10': 0.4604, 'time@10': 10.0554}:  40%|████      | 4/10 [00:30<00:48,  8.01s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0173, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9151, 'compress@10': 0.5646, 'time@10': 10.1222}:  40%|████      | 4/10 [00:35<00:48,  8.01s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0173, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9151, 'compress@10': 0.5646, 'time@10': 10.1222}:  50%|█████     | 5/10 [00:35<00:35,  7.01s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.93, 'compress@10': 0.5776, 'time@10': 10.151}:  50%|█████     | 5/10 [00:45<00:35,  7.01s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.93, 'compress@10': 0.5776, 'time@10': 10.151}:  60%|██████    | 6/10 [00:45<00:32,  8.14s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.02, 'hit_ratio@10': 0.9157, 'ndcg@10': 0.9312, 'compress@10': 0.5456, 'time@10': 10.3163}:  60%|██████    | 6/10 [00:51<00:32,  8.14s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.02, 'hit_ratio@10': 0.9157, 'ndcg@10': 0.9312, 'compress@10': 0.5456, 'time@10': 10.3163}:  70%|███████   | 7/10 [00:51<00:22,  7.34s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.9226, 'ndcg@10': 0.935, 'compress@10': 0.5347, 'time@10': 10.2277}:  70%|███████   | 7/10 [01:01<00:22,  7.34s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.9226, 'ndcg@10': 0.935, 'compress@10': 0.5347, 'time@10': 10.2277}:  80%|████████  | 8/10 [01:01<00:16,  8.07s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0197, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9346, 'compress@10': 0.5553, 'time@10': 10.33}:  80%|████████  | 8/10 [01:06<00:16,  8.07s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0197, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9346, 'compress@10': 0.5553, 'time@10': 10.33}:  90%|█████████ | 9/10 [01:06<00:07,  7.30s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.913, 'ndcg@10': 0.938, 'compress@10': 0.5264, 'time@10': 10.4058}:  90%|█████████ | 9/10 [01:17<00:07,  7.30s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.913, 'ndcg@10': 0.938, 'compress@10': 0.5264, 'time@10': 10.4058}: 100%|██████████| 10/10 [01:17<00:00,  8.48s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.913, 'ndcg@10': 0.938, 'compress@10': 0.5264, 'time@10': 10.4058}: 100%|██████████| 10/10 [01:17<00:00,  7.80s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.019177559189219297
Avg hit ratio: 0.912970003209392
Avg ndcg: 0.9380424116268736
Avg compression ratio: 0.5264445586584132
Avg train time: 10.40575439929962
Std train time: 0.5486559662677262
[0.7222222222222223, 0.46296296296296297, 0.05555555555555555, 0.42592592592592593, 0.9814814814814813, 0.648148148148148, 0.3148148148148149, 0.425925925925926, 0.7222222222222222, 0.24074074074074076]
[12, 14, 37, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.7368, 'time@10': 10.1647}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.7368, 'time@10': 10.1647}:  10%|█         | 1/10 [00:05<00:46,  5.12s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9466, 'compress@10': 0.6086, 'time@10': 10.2143}:  10%|█         | 1/10 [00:15<00:46,  5.12s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9466, 'compress@10': 0.6086, 'time@10': 10.2143}:  20%|██        | 2/10 [00:15<01:05,  8.17s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9168, 'compress@10': 0.4692, 'time@10': 10.2896}:  20%|██        | 2/10 [00:20<01:05,  8.17s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9168, 'compress@10': 0.4692, 'time@10': 10.2896}:  30%|███       | 3/10 [00:20<00:47,  6.84s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9287, 'compress@10': 0.4635, 'time@10': 10.1351}:  30%|███       | 3/10 [00:30<00:47,  6.84s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9287, 'compress@10': 0.4635, 'time@10': 10.1351}:  40%|████      | 4/10 [00:30<00:47,  7.97s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0144, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9167, 'compress@10': 0.5672, 'time@10': 10.22}:  40%|████      | 4/10 [00:35<00:47,  7.97s/it]  {'epoch': 26, 'num_users': 5.8, 'loss': 0.0144, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9167, 'compress@10': 0.5672, 'time@10': 10.22}:  50%|█████     | 5/10 [00:35<00:35,  7.02s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9253, 'compress@10': 0.582, 'time@10': 10.2385}:  50%|█████     | 5/10 [00:46<00:35,  7.02s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9253, 'compress@10': 0.582, 'time@10': 10.2385}:  60%|██████    | 6/10 [00:46<00:32,  8.16s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.9286, 'compress@10': 0.5477, 'time@10': 10.38}:  60%|██████    | 6/10 [00:51<00:32,  8.16s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.9286, 'compress@10': 0.5477, 'time@10': 10.38}:  70%|███████   | 7/10 [00:51<00:22,  7.34s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0154, 'hit_ratio@10': 0.9158, 'ndcg@10': 0.9431, 'compress@10': 0.5345, 'time@10': 10.2986}:  70%|███████   | 7/10 [01:01<00:22,  7.34s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0154, 'hit_ratio@10': 0.9158, 'ndcg@10': 0.9431, 'compress@10': 0.5345, 'time@10': 10.2986}:  80%|████████  | 8/10 [01:01<00:16,  8.11s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9423, 'compress@10': 0.5563, 'time@10': 10.3785}:  80%|████████  | 8/10 [01:07<00:16,  8.11s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9423, 'compress@10': 0.5563, 'time@10': 10.3785}:  90%|█████████ | 9/10 [01:07<00:07,  7.31s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9424, 'compress@10': 0.5265, 'time@10': 10.4629}:  90%|█████████ | 9/10 [01:18<00:07,  7.31s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9424, 'compress@10': 0.5265, 'time@10': 10.4629}: 100%|██████████| 10/10 [01:18<00:00,  8.53s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9424, 'compress@10': 0.5265, 'time@10': 10.4629}: 100%|██████████| 10/10 [01:18<00:00,  7.83s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.01746817596456008
Avg hit ratio: 0.9075219745355568
Avg ndcg: 0.9423996180901473
Avg compression ratio: 0.5264521351328308
Avg train time: 10.462937021255494
Std train time: 0.5283000858411279
[0.7321428571428572, 0.44642857142857145, 0.05357142857142857, 0.4107142857142857, 0.982142857142857, 0.6249999999999999, 0.30357142857142866, 0.4464285714285715, 0.7321428571428571, 0.26785714285714285]
[12, 14, 37, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9014, 'compress@10': 0.7462, 'time@10': 10.255}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9014, 'compress@10': 0.7462, 'time@10': 10.255}:  10%|█         | 1/10 [00:05<00:46,  5.16s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0311, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9548, 'compress@10': 0.6053, 'time@10': 10.2905}:  10%|█         | 1/10 [00:15<00:46,  5.16s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0311, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9548, 'compress@10': 0.6053, 'time@10': 10.2905}:  20%|██        | 2/10 [00:15<01:05,  8.22s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9222, 'compress@10': 0.4664, 'time@10': 10.1686}:  20%|██        | 2/10 [00:20<01:05,  8.22s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9222, 'compress@10': 0.4664, 'time@10': 10.1686}:  30%|███       | 3/10 [00:20<00:47,  6.75s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9346, 'compress@10': 0.4578, 'time@10': 10.0533}:  30%|███       | 3/10 [00:30<00:47,  6.75s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9346, 'compress@10': 0.4578, 'time@10': 10.0533}:  40%|████      | 4/10 [00:30<00:47,  7.93s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0239, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.9231, 'compress@10': 0.5627, 'time@10': 10.1418}:  40%|████      | 4/10 [00:35<00:47,  7.93s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0239, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.9231, 'compress@10': 0.5627, 'time@10': 10.1418}:  50%|█████     | 5/10 [00:35<00:34,  6.98s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.021, 'hit_ratio@10': 0.917, 'ndcg@10': 0.9312, 'compress@10': 0.5745, 'time@10': 10.1926}:  50%|█████     | 5/10 [00:46<00:34,  6.98s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.021, 'hit_ratio@10': 0.917, 'ndcg@10': 0.9312, 'compress@10': 0.5745, 'time@10': 10.1926}:  60%|██████    | 6/10 [00:46<00:32,  8.17s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.021, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9321, 'compress@10': 0.5398, 'time@10': 10.3444}:  60%|██████    | 6/10 [00:51<00:32,  8.17s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.021, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9321, 'compress@10': 0.5398, 'time@10': 10.3444}:  70%|███████   | 7/10 [00:51<00:22,  7.35s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0215, 'hit_ratio@10': 0.9292, 'ndcg@10': 0.929, 'compress@10': 0.5301, 'time@10': 10.2557}:  70%|███████   | 7/10 [01:01<00:22,  7.35s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0215, 'hit_ratio@10': 0.9292, 'ndcg@10': 0.929, 'compress@10': 0.5301, 'time@10': 10.2557}:  80%|████████  | 8/10 [01:01<00:16,  8.09s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9297, 'compress@10': 0.5534, 'time@10': 10.369}:  80%|████████  | 8/10 [01:07<00:16,  8.09s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9297, 'compress@10': 0.5534, 'time@10': 10.369}:  90%|█████████ | 9/10 [01:07<00:07,  7.34s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.9182, 'ndcg@10': 0.9341, 'compress@10': 0.5265, 'time@10': 10.4434}:  90%|█████████ | 9/10 [01:18<00:07,  7.34s/it]  {'epoch': 27, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.9182, 'ndcg@10': 0.9341, 'compress@10': 0.5265, 'time@10': 10.4434}: 100%|██████████| 10/10 [01:18<00:00,  8.52s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.9182, 'ndcg@10': 0.9341, 'compress@10': 0.5265, 'time@10': 10.4434}: 100%|██████████| 10/10 [01:18<00:00,  7.82s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.02031537719549719
Avg hit ratio: 0.9182029781197862
Avg ndcg: 0.934052089593998
Avg compression ratio: 0.5264827926354047
Avg train time: 10.443448638916015
Std train time: 0.5760448236470446
[0.706896551724138, 0.4655172413793104, 0.05172413793103448, 0.43103448275862066, 0.982758620689655, 0.6034482758620688, 0.29310344827586216, 0.46551724137931044, 0.7413793103448275, 0.25862068965517243]
[12, 14, 37, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.7223, 'time@10': 10.2436}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.7223, 'time@10': 10.2436}:  10%|█         | 1/10 [00:05<00:46,  5.16s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9662, 'compress@10': 0.6025, 'time@10': 10.1424}:  10%|█         | 1/10 [00:15<00:46,  5.16s/it] {'epoch': 28, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9662, 'compress@10': 0.6025, 'time@10': 10.1424}:  20%|██        | 2/10 [00:15<01:04,  8.05s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9298, 'compress@10': 0.4641, 'time@10': 10.0655}:  20%|██        | 2/10 [00:20<01:04,  8.05s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9298, 'compress@10': 0.4641, 'time@10': 10.0655}:  30%|███       | 3/10 [00:20<00:46,  6.65s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9391, 'compress@10': 0.4609, 'time@10': 9.964}:  30%|███       | 3/10 [00:29<00:46,  6.65s/it]  {'epoch': 28, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9391, 'compress@10': 0.4609, 'time@10': 9.964}:  40%|████      | 4/10 [00:29<00:47,  7.86s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0189, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9288, 'compress@10': 0.5653, 'time@10': 10.0629}:  40%|████      | 4/10 [00:35<00:47,  7.86s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0189, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9288, 'compress@10': 0.5653, 'time@10': 10.0629}:  50%|█████     | 5/10 [00:35<00:34,  6.92s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0221, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.943, 'compress@10': 0.5732, 'time@10': 10.139}:  50%|█████     | 5/10 [00:45<00:34,  6.92s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0221, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.943, 'compress@10': 0.5732, 'time@10': 10.139}:  60%|██████    | 6/10 [00:45<00:32,  8.16s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9428, 'compress@10': 0.5372, 'time@10': 10.2961}:  60%|██████    | 6/10 [00:51<00:32,  8.16s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9428, 'compress@10': 0.5372, 'time@10': 10.2961}:  70%|███████   | 7/10 [00:51<00:22,  7.34s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0195, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9454, 'compress@10': 0.5301, 'time@10': 10.2343}:  70%|███████   | 7/10 [01:01<00:22,  7.34s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0195, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9454, 'compress@10': 0.5301, 'time@10': 10.2343}:  80%|████████  | 8/10 [01:01<00:16,  8.14s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9442, 'compress@10': 0.5544, 'time@10': 10.3564}:  80%|████████  | 8/10 [01:06<00:16,  8.14s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9442, 'compress@10': 0.5544, 'time@10': 10.3564}:  90%|█████████ | 9/10 [01:06<00:07,  7.38s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9499, 'compress@10': 0.5265, 'time@10': 10.4236}:  90%|█████████ | 9/10 [01:18<00:07,  7.38s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9499, 'compress@10': 0.5265, 'time@10': 10.4236}: 100%|██████████| 10/10 [01:18<00:00,  8.51s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9499, 'compress@10': 0.5265, 'time@10': 10.4236}: 100%|██████████| 10/10 [01:18<00:00,  7.80s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.021570382152254552
Avg hit ratio: 0.8958271460665349
Avg ndcg: 0.9498566201763909
Avg compression ratio: 0.5265372174421074
Avg train time: 10.423590970039367
Std train time: 0.5725472624243003
[0.6833333333333335, 0.4833333333333334, 0.05, 0.41666666666666663, 0.9833333333333332, 0.6166666666666666, 0.28333333333333344, 0.45000000000000007, 0.7499999999999999, 0.2833333333333333]
[12, 14, 37, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9129, 'compress@10': 0.7, 'time@10': 10.3833}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9129, 'compress@10': 0.7, 'time@10': 10.3833}:  10%|█         | 1/10 [00:05<00:47,  5.25s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9403, 'compress@10': 0.6, 'time@10': 10.2485}:  10%|█         | 1/10 [00:15<00:47,  5.25s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9403, 'compress@10': 0.6, 'time@10': 10.2485}:  20%|██        | 2/10 [00:15<01:05,  8.13s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9126, 'compress@10': 0.4619, 'time@10': 10.0805}:  20%|██        | 2/10 [00:20<01:05,  8.13s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9126, 'compress@10': 0.4619, 'time@10': 10.0805}:  30%|███       | 3/10 [00:20<00:46,  6.66s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9255, 'compress@10': 0.4558, 'time@10': 9.9669}:  30%|███       | 3/10 [00:29<00:46,  6.66s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9255, 'compress@10': 0.4558, 'time@10': 9.9669}:  40%|████      | 4/10 [00:29<00:47,  7.85s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.9191, 'compress@10': 0.5614, 'time@10': 10.0528}:  40%|████      | 4/10 [00:35<00:47,  7.85s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.9191, 'compress@10': 0.5614, 'time@10': 10.0528}:  50%|█████     | 5/10 [00:35<00:34,  6.90s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9283, 'compress@10': 0.572, 'time@10': 10.1129}:  50%|█████     | 5/10 [00:45<00:34,  6.90s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9283, 'compress@10': 0.572, 'time@10': 10.1129}:  60%|██████    | 6/10 [00:45<00:32,  8.11s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9312, 'compress@10': 0.5349, 'time@10': 10.2914}:  60%|██████    | 6/10 [00:51<00:32,  8.11s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9312, 'compress@10': 0.5349, 'time@10': 10.2914}:  70%|███████   | 7/10 [00:51<00:21,  7.33s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9388, 'compress@10': 0.5262, 'time@10': 10.2488}:  70%|███████   | 7/10 [01:01<00:21,  7.33s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9388, 'compress@10': 0.5262, 'time@10': 10.2488}:  80%|████████  | 8/10 [01:01<00:16,  8.18s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9384, 'compress@10': 0.5519, 'time@10': 10.3687}:  80%|████████  | 8/10 [01:07<00:16,  8.18s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9384, 'compress@10': 0.5519, 'time@10': 10.3687}:  90%|█████████ | 9/10 [01:07<00:07,  7.40s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9421, 'compress@10': 0.5267, 'time@10': 10.4474}:  90%|█████████ | 9/10 [01:18<00:07,  7.40s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9421, 'compress@10': 0.5267, 'time@10': 10.4474}: 100%|██████████| 10/10 [01:18<00:00,  8.57s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9421, 'compress@10': 0.5267, 'time@10': 10.4474}: 100%|██████████| 10/10 [01:18<00:00,  7.83s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.013115785028693774
Avg hit ratio: 0.885033495272884
Avg ndcg: 0.9420540591985664
Avg compression ratio: 0.5266516537910347
Avg train time: 10.447429299354553
Std train time: 0.6041196149001533
[0.6935483870967744, 0.46774193548387105, 0.048387096774193554, 0.4354838709677419, 0.9838709677419353, 0.596774193548387, 0.27419354838709686, 0.46774193548387105, 0.7580645161290321, 0.27419354838709675]
[12, 14, 37, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.7097, 'time@10': 10.0163}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.7097, 'time@10': 10.0163}:  10%|█         | 1/10 [00:05<00:45,  5.05s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9448, 'compress@10': 0.5973, 'time@10': 10.0728}:  10%|█         | 1/10 [00:15<00:45,  5.05s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9448, 'compress@10': 0.5973, 'time@10': 10.0728}:  20%|██        | 2/10 [00:15<01:04,  8.06s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9156, 'compress@10': 0.4596, 'time@10': 10.0949}:  20%|██        | 2/10 [00:20<01:04,  8.06s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9156, 'compress@10': 0.4596, 'time@10': 10.0949}:  30%|███       | 3/10 [00:20<00:46,  6.71s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9462, 'compress@10': 0.4586, 'time@10': 9.9795}:  30%|███       | 3/10 [00:29<00:46,  6.71s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9462, 'compress@10': 0.4586, 'time@10': 9.9795}:  40%|████      | 4/10 [00:29<00:47,  7.88s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.937, 'compress@10': 0.5637, 'time@10': 10.082}:  40%|████      | 4/10 [00:35<00:47,  7.88s/it] {'epoch': 30, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.937, 'compress@10': 0.5637, 'time@10': 10.082}:  50%|█████     | 5/10 [00:35<00:34,  6.95s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9432, 'compress@10': 0.5707, 'time@10': 10.1658}:  50%|█████     | 5/10 [00:45<00:34,  6.95s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9432, 'compress@10': 0.5707, 'time@10': 10.1658}:  60%|██████    | 6/10 [00:45<00:32,  8.20s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9439, 'compress@10': 0.5325, 'time@10': 10.3464}:  60%|██████    | 6/10 [00:51<00:32,  8.20s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9439, 'compress@10': 0.5325, 'time@10': 10.3464}:  70%|███████   | 7/10 [00:51<00:22,  7.40s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0186, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9459, 'compress@10': 0.5263, 'time@10': 10.2797}:  70%|███████   | 7/10 [01:01<00:22,  7.40s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0186, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9459, 'compress@10': 0.5263, 'time@10': 10.2797}:  80%|████████  | 8/10 [01:01<00:16,  8.18s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9451, 'compress@10': 0.5528, 'time@10': 10.3925}:  80%|████████  | 8/10 [01:07<00:16,  8.18s/it] {'epoch': 30, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9451, 'compress@10': 0.5528, 'time@10': 10.3925}:  90%|█████████ | 9/10 [01:07<00:07,  7.40s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9478, 'compress@10': 0.5266, 'time@10': 10.4465}:  90%|█████████ | 9/10 [01:18<00:07,  7.40s/it] {'epoch': 30, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9478, 'compress@10': 0.5266, 'time@10': 10.4465}: 100%|██████████| 10/10 [01:18<00:00,  8.50s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9478, 'compress@10': 0.5266, 'time@10': 10.4465}: 100%|██████████| 10/10 [01:18<00:00,  7.82s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.019188299088504262
Avg hit ratio: 0.8986842889236778
Avg ndcg: 0.9477819012191452
Avg compression ratio: 0.5266307793014492
Avg train time: 10.446536207199097
Std train time: 0.5820668722400019
[0.6718750000000001, 0.45312500000000006, 0.04687500000000001, 0.45312499999999994, 0.9843749999999998, 0.5781249999999999, 0.2968750000000001, 0.4843750000000001, 0.7656249999999999, 0.265625]
[12, 14, 37, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9129, 'compress@10': 0.6891, 'time@10': 10.2447}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9129, 'compress@10': 0.6891, 'time@10': 10.2447}:  10%|█         | 1/10 [00:05<00:46,  5.17s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.927, 'compress@10': 0.58, 'time@10': 10.0798}:  10%|█         | 1/10 [00:15<00:46,  5.17s/it]   {'epoch': 31, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.927, 'compress@10': 0.58, 'time@10': 10.0798}:  20%|██        | 2/10 [00:15<01:03,  7.98s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9037, 'compress@10': 0.4476, 'time@10': 9.9875}:  20%|██        | 2/10 [00:20<01:03,  7.98s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9037, 'compress@10': 0.4476, 'time@10': 9.9875}:  30%|███       | 3/10 [00:20<00:46,  6.59s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9222, 'compress@10': 0.4539, 'time@10': 9.8785}:  30%|███       | 3/10 [00:29<00:46,  6.59s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9222, 'compress@10': 0.4539, 'time@10': 9.8785}:  40%|████      | 4/10 [00:29<00:46,  7.78s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.843, 'ndcg@10': 0.9167, 'compress@10': 0.5601, 'time@10': 10.0265}:  40%|████      | 4/10 [00:34<00:46,  7.78s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.843, 'ndcg@10': 0.9167, 'compress@10': 0.5601, 'time@10': 10.0265}:  50%|█████     | 5/10 [00:34<00:34,  6.90s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0158, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.9268, 'compress@10': 0.5646, 'time@10': 10.1165}:  50%|█████     | 5/10 [00:45<00:34,  6.90s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0158, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.9268, 'compress@10': 0.5646, 'time@10': 10.1165}:  60%|██████    | 6/10 [00:45<00:32,  8.16s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9297, 'compress@10': 0.5304, 'time@10': 10.3195}:  60%|██████    | 6/10 [00:51<00:32,  8.16s/it] {'epoch': 31, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9297, 'compress@10': 0.5304, 'time@10': 10.3195}:  70%|███████   | 7/10 [00:51<00:22,  7.40s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9341, 'compress@10': 0.5265, 'time@10': 10.2434}:  70%|███████   | 7/10 [01:01<00:22,  7.40s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9341, 'compress@10': 0.5265, 'time@10': 10.2434}:  80%|████████  | 8/10 [01:01<00:16,  8.15s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9347, 'compress@10': 0.5538, 'time@10': 10.3347}:  80%|████████  | 8/10 [01:06<00:16,  8.15s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9347, 'compress@10': 0.5538, 'time@10': 10.3347}:  90%|█████████ | 9/10 [01:06<00:07,  7.34s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.939, 'compress@10': 0.5267, 'time@10': 10.3962}:  90%|█████████ | 9/10 [01:17<00:07,  7.34s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.939, 'compress@10': 0.5267, 'time@10': 10.3962}: 100%|██████████| 10/10 [01:17<00:00,  8.47s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.939, 'compress@10': 0.5267, 'time@10': 10.3962}: 100%|██████████| 10/10 [01:17<00:00,  7.78s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.014795105962803748
Avg hit ratio: 0.8872787589697607
Avg ndcg: 0.938960898511491
Avg compression ratio: 0.526650183318121
Avg train time: 10.396174192428589
Std train time: 0.6263099702417693
[0.6515151515151516, 0.4696969696969697, 0.04545454545454546, 0.4696969696969696, 0.9848484848484846, 0.5606060606060606, 0.3181818181818183, 0.4696969696969698, 0.7727272727272726, 0.25757575757575757]
[12, 14, 37, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9259, 'compress@10': 0.6698, 'time@10': 10.291}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9259, 'compress@10': 0.6698, 'time@10': 10.291}:  10%|█         | 1/10 [00:05<00:46,  5.18s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.003, 'compress@10': 0.5783, 'time@10': 10.1304}:  10%|█         | 1/10 [00:15<00:46,  5.18s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.003, 'compress@10': 0.5783, 'time@10': 10.1304}:  20%|██        | 2/10 [00:15<01:04,  8.03s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9544, 'compress@10': 0.4462, 'time@10': 10.1318}:  20%|██        | 2/10 [00:20<01:04,  8.03s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9544, 'compress@10': 0.4462, 'time@10': 10.1318}:  30%|███       | 3/10 [00:20<00:46,  6.70s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9574, 'compress@10': 0.4568, 'time@10': 10.027}:  30%|███       | 3/10 [00:30<00:46,  6.70s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9574, 'compress@10': 0.4568, 'time@10': 10.027}:  40%|████      | 4/10 [00:30<00:47,  7.90s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.9468, 'compress@10': 0.5625, 'time@10': 10.1365}:  40%|████      | 4/10 [00:35<00:47,  7.90s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.9468, 'compress@10': 0.5625, 'time@10': 10.1365}:  50%|█████     | 5/10 [00:35<00:34,  6.97s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9526, 'compress@10': 0.5638, 'time@10': 10.2141}:  50%|█████     | 5/10 [00:46<00:34,  6.97s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9526, 'compress@10': 0.5638, 'time@10': 10.2141}:  60%|██████    | 6/10 [00:46<00:32,  8.22s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0172, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9528, 'compress@10': 0.5326, 'time@10': 10.4003}:  60%|██████    | 6/10 [00:51<00:32,  8.22s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0172, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9528, 'compress@10': 0.5326, 'time@10': 10.4003}:  70%|███████   | 7/10 [00:51<00:22,  7.43s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9551, 'compress@10': 0.5266, 'time@10': 10.3205}:  70%|███████   | 7/10 [01:01<00:22,  7.43s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9551, 'compress@10': 0.5266, 'time@10': 10.3205}:  80%|████████  | 8/10 [01:01<00:16,  8.18s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9542, 'compress@10': 0.5547, 'time@10': 10.385}:  80%|████████  | 8/10 [01:07<00:16,  8.18s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8777, 'ndcg@10': 0.9542, 'compress@10': 0.5547, 'time@10': 10.385}:  90%|█████████ | 9/10 [01:07<00:07,  7.34s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9594, 'compress@10': 0.5267, 'time@10': 10.4339}:  90%|█████████ | 9/10 [01:18<00:07,  7.34s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9594, 'compress@10': 0.5267, 'time@10': 10.4339}: 100%|██████████| 10/10 [01:18<00:00,  8.44s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9594, 'compress@10': 0.5267, 'time@10': 10.4339}: 100%|██████████| 10/10 [01:18<00:00,  7.80s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.017466179203266968
Avg hit ratio: 0.8876243810895763
Avg ndcg: 0.9594155338943681
Avg compression ratio: 0.5266583045632532
Avg train time: 10.433940291404724
Std train time: 0.5413596642896844
[0.6323529411764707, 0.4852941176470589, 0.04411764705882354, 0.48529411764705876, 0.9852941176470587, 0.5441176470588235, 0.30882352941176483, 0.45588235294117657, 0.7794117647058822, 0.27941176470588236]
[12, 14, 37, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9214, 'compress@10': 0.6517, 'time@10': 10.0663}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9214, 'compress@10': 0.6517, 'time@10': 10.0663}:  10%|█         | 1/10 [00:05<00:45,  5.07s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9446, 'compress@10': 0.5768, 'time@10': 10.0931}:  10%|█         | 1/10 [00:15<00:45,  5.07s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9446, 'compress@10': 0.5768, 'time@10': 10.0931}:  20%|██        | 2/10 [00:15<01:04,  8.06s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9154, 'compress@10': 0.4448, 'time@10': 9.951}:  20%|██        | 2/10 [00:20<01:04,  8.06s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9154, 'compress@10': 0.4448, 'time@10': 9.951}:  30%|███       | 3/10 [00:20<00:46,  6.61s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.93, 'compress@10': 0.4595, 'time@10': 9.9439}:  30%|███       | 3/10 [00:30<00:46,  6.61s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.93, 'compress@10': 0.4595, 'time@10': 9.9439}:  40%|████      | 4/10 [00:30<00:47,  7.93s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9256, 'compress@10': 0.5647, 'time@10': 10.1038}:  40%|████      | 4/10 [00:35<00:47,  7.93s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9256, 'compress@10': 0.5647, 'time@10': 10.1038}:  50%|█████     | 5/10 [00:35<00:35,  7.02s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9339, 'compress@10': 0.563, 'time@10': 10.1749}:  50%|█████     | 5/10 [00:46<00:35,  7.02s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9339, 'compress@10': 0.563, 'time@10': 10.1749}:  60%|██████    | 6/10 [00:46<00:32,  8.23s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.936, 'compress@10': 0.5306, 'time@10': 10.3816}:  60%|██████    | 6/10 [00:51<00:32,  8.23s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.936, 'compress@10': 0.5306, 'time@10': 10.3816}:  70%|███████   | 7/10 [00:51<00:22,  7.45s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9549, 'compress@10': 0.5232, 'time@10': 10.3043}:  70%|███████   | 7/10 [01:01<00:22,  7.45s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9549, 'compress@10': 0.5232, 'time@10': 10.3043}:  80%|████████  | 8/10 [01:01<00:16,  8.20s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0167, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9549, 'compress@10': 0.5524, 'time@10': 10.4073}:  80%|████████  | 8/10 [01:07<00:16,  8.20s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0167, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9549, 'compress@10': 0.5524, 'time@10': 10.4073}:  90%|█████████ | 9/10 [01:07<00:07,  7.40s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9568, 'compress@10': 0.5267, 'time@10': 10.4759}:  90%|█████████ | 9/10 [01:18<00:07,  7.40s/it]    {'epoch': 33, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9568, 'compress@10': 0.5267, 'time@10': 10.4759}: 100%|██████████| 10/10 [01:18<00:00,  8.55s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9568, 'compress@10': 0.5267, 'time@10': 10.4759}: 100%|██████████| 10/10 [01:18<00:00,  7.85s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.015431702138003248
Avg hit ratio: 0.897970003209392
Avg ndcg: 0.9567720478415976
Avg compression ratio: 0.5267158639677134
Avg train time: 10.475899505615235
Std train time: 0.6405678362569228
[0.6142857142857143, 0.4714285714285715, 0.042857142857142864, 0.49999999999999994, 0.9857142857142855, 0.5285714285714286, 0.3285714285714287, 0.47142857142857153, 0.7857142857142856, 0.27142857142857146]
[12, 14, 37, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9308, 'compress@10': 0.6346, 'time@10': 10.3289}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9308, 'compress@10': 0.6346, 'time@10': 10.3289}:  10%|█         | 1/10 [00:05<00:46,  5.20s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9493, 'compress@10': 0.5615, 'time@10': 10.2735}:  10%|█         | 1/10 [00:15<00:46,  5.20s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9493, 'compress@10': 0.5615, 'time@10': 10.2735}:  20%|██        | 2/10 [00:15<01:05,  8.17s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9186, 'compress@10': 0.4342, 'time@10': 9.7255}:  20%|██        | 2/10 [00:19<01:05,  8.17s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9186, 'compress@10': 0.4342, 'time@10': 9.7255}:  30%|███       | 3/10 [00:19<00:45,  6.43s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.9335, 'compress@10': 0.4551, 'time@10': 9.7887}:  30%|███       | 3/10 [00:29<00:45,  6.43s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.9335, 'compress@10': 0.4551, 'time@10': 9.7887}:  40%|████      | 4/10 [00:29<00:47,  7.85s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9297, 'compress@10': 0.5613, 'time@10': 9.8968}:  40%|████      | 4/10 [00:35<00:47,  7.85s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9297, 'compress@10': 0.5613, 'time@10': 9.8968}:  50%|█████     | 5/10 [00:35<00:34,  6.89s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.937, 'compress@10': 0.5576, 'time@10': 10.0123}:  50%|█████     | 5/10 [00:45<00:34,  6.89s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.937, 'compress@10': 0.5576, 'time@10': 10.0123}:  60%|██████    | 6/10 [00:45<00:32,  8.16s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9373, 'compress@10': 0.5287, 'time@10': 10.2156}:  60%|██████    | 6/10 [00:51<00:32,  8.16s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9373, 'compress@10': 0.5287, 'time@10': 10.2156}:  70%|███████   | 7/10 [00:51<00:22,  7.38s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.936, 'compress@10': 0.5234, 'time@10': 10.1477}:  70%|███████   | 7/10 [01:01<00:22,  7.38s/it]  {'epoch': 34, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.936, 'compress@10': 0.5234, 'time@10': 10.1477}:  80%|████████  | 8/10 [01:01<00:16,  8.12s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9382, 'compress@10': 0.5533, 'time@10': 10.2629}:  80%|████████  | 8/10 [01:06<00:16,  8.12s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9382, 'compress@10': 0.5533, 'time@10': 10.2629}:  90%|█████████ | 9/10 [01:06<00:07,  7.34s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9433, 'compress@10': 0.5267, 'time@10': 10.3409}:  90%|█████████ | 9/10 [01:17<00:07,  7.34s/it]  {'epoch': 34, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9433, 'compress@10': 0.5267, 'time@10': 10.3409}: 100%|██████████| 10/10 [01:17<00:00,  8.50s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9433, 'compress@10': 0.5267, 'time@10': 10.3409}: 100%|██████████| 10/10 [01:17<00:00,  7.78s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.013287434886067572
Avg hit ratio: 0.8891993938903955
Avg ndcg: 0.9432917375053791
Avg compression ratio: 0.5267309893893433
Avg train time: 10.340900468826295
Std train time: 0.7736696212088472
[0.5972222222222222, 0.45833333333333337, 0.04166666666666667, 0.5138888888888888, 0.9861111111111109, 0.513888888888889, 0.3472222222222223, 0.4583333333333334, 0.7916666666666665, 0.2916666666666667]
[12, 14, 38, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9214, 'compress@10': 0.6184, 'time@10': 10.4541}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9214, 'compress@10': 0.6184, 'time@10': 10.4541}:  10%|█         | 1/10 [00:05<00:47,  5.26s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9357, 'compress@10': 0.5471, 'time@10': 10.2747}:  10%|█         | 1/10 [00:15<00:47,  5.26s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9357, 'compress@10': 0.5471, 'time@10': 10.2747}:  20%|██        | 2/10 [00:15<01:05,  8.13s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9095, 'compress@10': 0.4243, 'time@10': 9.7961}:  20%|██        | 2/10 [00:19<01:05,  8.13s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9095, 'compress@10': 0.4243, 'time@10': 9.7961}:  30%|███       | 3/10 [00:19<00:45,  6.45s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9298, 'compress@10': 0.451, 'time@10': 9.7167}:  30%|███       | 3/10 [00:29<00:45,  6.45s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9298, 'compress@10': 0.451, 'time@10': 9.7167}:  40%|████      | 4/10 [00:29<00:45,  7.66s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9267, 'compress@10': 0.5581, 'time@10': 9.8915}:  40%|████      | 4/10 [00:34<00:45,  7.66s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9267, 'compress@10': 0.5581, 'time@10': 9.8915}:  50%|█████     | 5/10 [00:34<00:34,  6.82s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9359, 'compress@10': 0.5525, 'time@10': 10.0084}:  50%|█████     | 5/10 [00:45<00:34,  6.82s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.9359, 'compress@10': 0.5525, 'time@10': 10.0084}:  60%|██████    | 6/10 [00:45<00:32,  8.12s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9384, 'compress@10': 0.5269, 'time@10': 10.1841}:  60%|██████    | 6/10 [00:50<00:32,  8.12s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9384, 'compress@10': 0.5269, 'time@10': 10.1841}:  70%|███████   | 7/10 [00:50<00:21,  7.31s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9426, 'compress@10': 0.5203, 'time@10': 10.1245}:  70%|███████   | 7/10 [01:00<00:21,  7.31s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9426, 'compress@10': 0.5203, 'time@10': 10.1245}:  80%|████████  | 8/10 [01:00<00:16,  8.09s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.9068, 'ndcg@10': 0.9441, 'compress@10': 0.5511, 'time@10': 10.2244}:  80%|████████  | 8/10 [01:06<00:16,  8.09s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.9068, 'ndcg@10': 0.9441, 'compress@10': 0.5511, 'time@10': 10.2244}:  90%|█████████ | 9/10 [01:06<00:07,  7.30s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.947, 'compress@10': 0.5268, 'time@10': 10.3222}:  90%|█████████ | 9/10 [01:17<00:07,  7.30s/it]    {'epoch': 35, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.947, 'compress@10': 0.5268, 'time@10': 10.3222}: 100%|██████████| 10/10 [01:17<00:00,  8.52s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.947, 'compress@10': 0.5268, 'time@10': 10.3222}: 100%|██████████| 10/10 [01:17<00:00,  7.75s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.011314654178242392
Avg hit ratio: 0.9138537717705798
Avg ndcg: 0.9470142381089349
Avg compression ratio: 0.526761680146133
Avg train time: 10.322178220748901
Std train time: 0.7488791831353924
[0.6081081081081081, 0.472972972972973, 0.04054054054054054, 0.527027027027027, 0.9864864864864863, 0.5000000000000001, 0.33783783783783794, 0.44594594594594605, 0.7972972972972971, 0.2837837837837838]
[12, 14, 39, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9355, 'compress@10': 0.6287, 'time@10': 10.3374}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9355, 'compress@10': 0.6287, 'time@10': 10.3374}:  10%|█         | 1/10 [00:05<00:46,  5.21s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0284, 'compress@10': 0.5594, 'time@10': 10.3076}:  10%|█         | 1/10 [00:15<00:46,  5.21s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0284, 'compress@10': 0.5594, 'time@10': 10.3076}:  20%|██        | 2/10 [00:15<01:05,  8.21s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9713, 'compress@10': 0.4321, 'time@10': 9.862}:  20%|██        | 2/10 [00:20<01:05,  8.21s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9713, 'compress@10': 0.4321, 'time@10': 9.862}:  30%|███       | 3/10 [00:20<00:45,  6.53s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9745, 'compress@10': 0.4601, 'time@10': 9.8279}:  30%|███       | 3/10 [00:29<00:45,  6.53s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9745, 'compress@10': 0.4601, 'time@10': 9.8279}:  40%|████      | 4/10 [00:29<00:46,  7.81s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9638, 'compress@10': 0.5654, 'time@10': 9.9623}:  40%|████      | 4/10 [00:35<00:46,  7.81s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9638, 'compress@10': 0.5654, 'time@10': 9.9623}:  50%|█████     | 5/10 [00:35<00:34,  6.90s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0225, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9745, 'compress@10': 0.5563, 'time@10': 10.0424}:  50%|█████     | 5/10 [00:45<00:34,  6.90s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0225, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9745, 'compress@10': 0.5563, 'time@10': 10.0424}:  60%|██████    | 6/10 [00:45<00:32,  8.12s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0201, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9715, 'compress@10': 0.5289, 'time@10': 10.2163}:  60%|██████    | 6/10 [00:51<00:32,  8.12s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0201, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9715, 'compress@10': 0.5289, 'time@10': 10.2163}:  70%|███████   | 7/10 [00:51<00:21,  7.31s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.022, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9846, 'compress@10': 0.5205, 'time@10': 10.1579}:  70%|███████   | 7/10 [01:01<00:21,  7.31s/it]  {'epoch': 36, 'num_users': 6.125, 'loss': 0.022, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9846, 'compress@10': 0.5205, 'time@10': 10.1579}:  80%|████████  | 8/10 [01:01<00:16,  8.10s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9814, 'compress@10': 0.5519, 'time@10': 10.2371}:  80%|████████  | 8/10 [01:06<00:16,  8.10s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9814, 'compress@10': 0.5519, 'time@10': 10.2371}:  90%|█████████ | 9/10 [01:06<00:07,  7.28s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9846, 'compress@10': 0.5267, 'time@10': 10.319}:  90%|█████████ | 9/10 [01:17<00:07,  7.28s/it]     {'epoch': 36, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9846, 'compress@10': 0.5267, 'time@10': 10.319}: 100%|██████████| 10/10 [01:17<00:00,  8.46s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9846, 'compress@10': 0.5267, 'time@10': 10.319}: 100%|██████████| 10/10 [01:17<00:00,  7.76s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.02197091936716174
Avg hit ratio: 0.9012557174951062
Avg ndcg: 0.984597974902466
Avg compression ratio: 0.526732716154674
Avg train time: 10.31903874874115
Std train time: 0.654149604379718
[0.5921052631578947, 0.48684210526315796, 0.03947368421052632, 0.513157894736842, 0.9605263157894735, 0.5131578947368423, 0.3289473684210527, 0.4605263157894738, 0.8026315789473683, 0.3026315789473685]
[12, 14, 40, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.6136, 'time@10': 10.2763}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.6136, 'time@10': 10.2763}:  10%|█         | 1/10 [00:05<00:46,  5.19s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0034, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9459, 'compress@10': 0.5585, 'time@10': 10.201}:  10%|█         | 1/10 [00:15<00:46,  5.19s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0034, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9459, 'compress@10': 0.5585, 'time@10': 10.201}:  20%|██        | 2/10 [00:15<01:04,  8.12s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0023, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9163, 'compress@10': 0.4312, 'time@10': 9.8132}:  20%|██        | 2/10 [00:19<01:04,  8.12s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0023, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9163, 'compress@10': 0.4312, 'time@10': 9.8132}:  30%|███       | 3/10 [00:19<00:45,  6.49s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0036, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9283, 'compress@10': 0.4561, 'time@10': 9.7381}:  30%|███       | 3/10 [00:29<00:45,  6.49s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0036, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9283, 'compress@10': 0.4561, 'time@10': 9.7381}:  40%|████      | 4/10 [00:29<00:46,  7.70s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0065, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9266, 'compress@10': 0.5571, 'time@10': 9.8942}:  40%|████      | 4/10 [00:34<00:46,  7.70s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0065, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9266, 'compress@10': 0.5571, 'time@10': 9.8942}:  50%|█████     | 5/10 [00:34<00:34,  6.83s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0057, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.935, 'compress@10': 0.5516, 'time@10': 9.9586}:  50%|█████     | 5/10 [00:45<00:34,  6.83s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0057, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.935, 'compress@10': 0.5516, 'time@10': 9.9586}:  60%|██████    | 6/10 [00:45<00:32,  8.02s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9373, 'compress@10': 0.5236, 'time@10': 10.1551}:  60%|██████    | 6/10 [00:50<00:32,  8.02s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9373, 'compress@10': 0.5236, 'time@10': 10.1551}:  70%|███████   | 7/10 [00:50<00:21,  7.26s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9357, 'compress@10': 0.5177, 'time@10': 10.1081}:  70%|███████   | 7/10 [01:00<00:21,  7.26s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9357, 'compress@10': 0.5177, 'time@10': 10.1081}:  80%|████████  | 8/10 [01:00<00:16,  8.07s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9376, 'compress@10': 0.5499, 'time@10': 10.2263}:  80%|████████  | 8/10 [01:06<00:16,  8.07s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9376, 'compress@10': 0.5499, 'time@10': 10.2263}:  90%|█████████ | 9/10 [01:06<00:07,  7.31s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9415, 'compress@10': 0.5268, 'time@10': 10.3047}:  90%|█████████ | 9/10 [01:17<00:07,  7.31s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9415, 'compress@10': 0.5268, 'time@10': 10.3047}: 100%|██████████| 10/10 [01:17<00:00,  8.46s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9415, 'compress@10': 0.5268, 'time@10': 10.3047}: 100%|██████████| 10/10 [01:17<00:00,  7.73s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.010320407017773968
Avg hit ratio: 0.9116243810895763
Avg ndcg: 0.9415018889278837
Avg compression ratio: 0.5267949603674194
Avg train time: 10.304741024971008
Std train time: 0.6999156520439846
[0.5769230769230769, 0.47435897435897445, 0.038461538461538464, 0.5256410256410255, 0.9615384615384613, 0.5000000000000001, 0.34615384615384626, 0.47435897435897445, 0.8076923076923075, 0.29487179487179493]
[12, 14, 41, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9355, 'compress@10': 0.5992, 'time@10': 10.2996}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9355, 'compress@10': 0.5992, 'time@10': 10.2996}:  10%|█         | 1/10 [00:05<00:46,  5.19s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9516, 'compress@10': 0.5452, 'time@10': 10.0896}:  10%|█         | 1/10 [00:15<00:46,  5.19s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9516, 'compress@10': 0.5452, 'time@10': 10.0896}:  20%|██        | 2/10 [00:15<01:03,  7.97s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9201, 'compress@10': 0.4221, 'time@10': 9.9158}:  20%|██        | 2/10 [00:19<01:03,  7.97s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9201, 'compress@10': 0.4221, 'time@10': 9.9158}:  30%|███       | 3/10 [00:19<00:45,  6.53s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9398, 'compress@10': 0.4522, 'time@10': 9.8401}:  30%|███       | 3/10 [00:29<00:45,  6.53s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.7777, 'ndcg@10': 0.9398, 'compress@10': 0.4522, 'time@10': 9.8401}:  40%|████      | 4/10 [00:29<00:46,  7.77s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.9361, 'compress@10': 0.5542, 'time@10': 9.9677}:  40%|████      | 4/10 [00:34<00:46,  7.77s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.9361, 'compress@10': 0.5542, 'time@10': 9.9677}:  50%|█████     | 5/10 [00:34<00:34,  6.87s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.9469, 'compress@10': 0.5471, 'time@10': 10.0971}:  50%|█████     | 5/10 [00:45<00:34,  6.87s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.9469, 'compress@10': 0.5471, 'time@10': 10.0971}:  60%|██████    | 6/10 [00:45<00:32,  8.20s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9477, 'compress@10': 0.5221, 'time@10': 10.302}:  60%|██████    | 6/10 [00:51<00:32,  8.20s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9477, 'compress@10': 0.5221, 'time@10': 10.302}:  70%|███████   | 7/10 [00:51<00:22,  7.42s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9507, 'compress@10': 0.518, 'time@10': 10.2266}:  70%|███████   | 7/10 [01:01<00:22,  7.42s/it]   {'epoch': 38, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9507, 'compress@10': 0.518, 'time@10': 10.2266}:  80%|████████  | 8/10 [01:01<00:16,  8.16s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.9509, 'compress@10': 0.5508, 'time@10': 10.3186}:  80%|████████  | 8/10 [01:06<00:16,  8.16s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.9509, 'compress@10': 0.5508, 'time@10': 10.3186}:  90%|█████████ | 9/10 [01:06<00:07,  7.35s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9556, 'compress@10': 0.5268, 'time@10': 10.3924}:  90%|█████████ | 9/10 [01:17<00:07,  7.35s/it]    {'epoch': 38, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9556, 'compress@10': 0.5268, 'time@10': 10.3924}: 100%|██████████| 10/10 [01:17<00:00,  8.50s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.014, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9556, 'compress@10': 0.5268, 'time@10': 10.3924}: 100%|██████████| 10/10 [01:17<00:00,  7.79s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.013997738954635519
Avg hit ratio: 0.8766013396149219
Avg ndcg: 0.9555619650975699
Avg compression ratio: 0.5268067983161128
Avg train time: 10.392430686950684
Std train time: 0.6594834270838443
[0.5625, 0.4625000000000001, 0.037500000000000006, 0.5374999999999999, 0.9624999999999998, 0.5125000000000001, 0.3375000000000001, 0.4625000000000001, 0.8124999999999998, 0.31250000000000006]
[12, 14, 41, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.5855, 'time@10': 10.1977}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.5855, 'time@10': 10.1977}:  10%|█         | 1/10 [00:05<00:46,  5.13s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9331, 'compress@10': 0.5327, 'time@10': 10.1348}:  10%|█         | 1/10 [00:15<00:46,  5.13s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9331, 'compress@10': 0.5327, 'time@10': 10.1348}:  20%|██        | 2/10 [00:15<01:04,  8.06s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9078, 'compress@10': 0.4135, 'time@10': 9.9743}:  20%|██        | 2/10 [00:20<01:04,  8.06s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9078, 'compress@10': 0.4135, 'time@10': 9.9743}:  30%|███       | 3/10 [00:20<00:46,  6.60s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9219, 'compress@10': 0.4486, 'time@10': 9.8851}:  30%|███       | 3/10 [00:29<00:46,  6.60s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9219, 'compress@10': 0.4486, 'time@10': 9.8851}:  40%|████      | 4/10 [00:29<00:46,  7.81s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.9237, 'compress@10': 0.5515, 'time@10': 10.0651}:  40%|████      | 4/10 [00:35<00:46,  7.81s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.9237, 'compress@10': 0.5515, 'time@10': 10.0651}:  50%|█████     | 5/10 [00:35<00:34,  6.95s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9325, 'compress@10': 0.5468, 'time@10': 10.1384}:  50%|█████     | 5/10 [00:45<00:34,  6.95s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9325, 'compress@10': 0.5468, 'time@10': 10.1384}:  60%|██████    | 6/10 [00:45<00:32,  8.17s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9356, 'compress@10': 0.5207, 'time@10': 10.3268}:  60%|██████    | 6/10 [00:51<00:32,  8.17s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9356, 'compress@10': 0.5207, 'time@10': 10.3268}:  70%|███████   | 7/10 [00:51<00:22,  7.38s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.94, 'compress@10': 0.5154, 'time@10': 10.2472}:  70%|███████   | 7/10 [01:01<00:22,  7.38s/it]   {'epoch': 39, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.94, 'compress@10': 0.5154, 'time@10': 10.2472}:  80%|████████  | 8/10 [01:01<00:16,  8.13s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9414, 'compress@10': 0.549, 'time@10': 10.3518}:  80%|████████  | 8/10 [01:06<00:16,  8.13s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9414, 'compress@10': 0.549, 'time@10': 10.3518}:  90%|█████████ | 9/10 [01:06<00:07,  7.35s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9448, 'compress@10': 0.5269, 'time@10': 10.4219}:  90%|█████████ | 9/10 [01:17<00:07,  7.35s/it] {'epoch': 39, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9448, 'compress@10': 0.5269, 'time@10': 10.4219}: 100%|██████████| 10/10 [01:17<00:00,  8.50s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9448, 'compress@10': 0.5269, 'time@10': 10.4219}: 100%|██████████| 10/10 [01:17<00:00,  7.79s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.00857957562406737
Avg hit ratio: 0.8915450160102113
Avg ndcg: 0.9448443838575334
Avg compression ratio: 0.5268777498125305
Avg train time: 10.421896982192994
Std train time: 0.6436420532148661
[0.5487804878048781, 0.47560975609756106, 0.03658536585365854, 0.5487804878048779, 0.9634146341463413, 0.5000000000000001, 0.3292682926829269, 0.47560975609756106, 0.8170731707317072, 0.30487804878048785]
[12, 14, 41, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9381, 'compress@10': 0.5725, 'time@10': 10.2749}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9381, 'compress@10': 0.5725, 'time@10': 10.2749}:  10%|█         | 1/10 [00:05<00:46,  5.17s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9991, 'compress@10': 0.5325, 'time@10': 10.1103}:  10%|█         | 1/10 [00:15<00:46,  5.17s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9991, 'compress@10': 0.5325, 'time@10': 10.1103}:  20%|██        | 2/10 [00:15<01:04,  8.00s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9518, 'compress@10': 0.4131, 'time@10': 9.8953}:  20%|██        | 2/10 [00:19<01:04,  8.00s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9518, 'compress@10': 0.4131, 'time@10': 9.8953}:  30%|███       | 3/10 [00:19<00:45,  6.53s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9612, 'compress@10': 0.451, 'time@10': 9.8383}:  30%|███       | 3/10 [00:29<00:45,  6.53s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9612, 'compress@10': 0.451, 'time@10': 9.8383}:  40%|████      | 4/10 [00:29<00:46,  7.78s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9561, 'compress@10': 0.5537, 'time@10': 9.9914}:  40%|████      | 4/10 [00:34<00:46,  7.78s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9561, 'compress@10': 0.5537, 'time@10': 9.9914}:  50%|█████     | 5/10 [00:34<00:34,  6.90s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0216, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9624, 'compress@10': 0.5466, 'time@10': 10.0802}:  50%|█████     | 5/10 [00:45<00:34,  6.90s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0216, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9624, 'compress@10': 0.5466, 'time@10': 10.0802}:  60%|██████    | 6/10 [00:45<00:32,  8.15s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0201, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9612, 'compress@10': 0.5194, 'time@10': 10.2617}:  60%|██████    | 6/10 [00:51<00:32,  8.15s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0201, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9612, 'compress@10': 0.5194, 'time@10': 10.2617}:  70%|███████   | 7/10 [00:51<00:22,  7.36s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0253, 'hit_ratio@10': 0.911, 'ndcg@10': 0.969, 'compress@10': 0.5158, 'time@10': 10.2206}:  70%|███████   | 7/10 [01:01<00:22,  7.36s/it]   {'epoch': 40, 'num_users': 6.125, 'loss': 0.0253, 'hit_ratio@10': 0.911, 'ndcg@10': 0.969, 'compress@10': 0.5158, 'time@10': 10.2206}:  80%|████████  | 8/10 [01:01<00:16,  8.19s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0247, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9672, 'compress@10': 0.5498, 'time@10': 10.2832}:  80%|████████  | 8/10 [01:06<00:16,  8.19s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0247, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9672, 'compress@10': 0.5498, 'time@10': 10.2832}:  90%|█████████ | 9/10 [01:06<00:07,  7.32s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0238, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.968, 'compress@10': 0.5269, 'time@10': 10.3837}:  90%|█████████ | 9/10 [01:17<00:07,  7.32s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0238, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.968, 'compress@10': 0.5269, 'time@10': 10.3837}: 100%|██████████| 10/10 [01:17<00:00,  8.56s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0238, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.968, 'compress@10': 0.5269, 'time@10': 10.3837}: 100%|██████████| 10/10 [01:17<00:00,  7.80s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.02383708586712184
Avg hit ratio: 0.912259301724497
Avg ndcg: 0.96802603839387
Avg compression ratio: 0.526906544715635
Avg train time: 10.383745908737183
Std train time: 0.6120629448555116
[0.5357142857142858, 0.4880952380952382, 0.03571428571428572, 0.5595238095238093, 0.9404761904761904, 0.511904761904762, 0.3214285714285715, 0.4880952380952382, 0.8214285714285713, 0.29761904761904767]
[12, 14, 41, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.5601, 'time@10': 10.0056}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.5601, 'time@10': 10.0056}:  10%|█         | 1/10 [00:05<00:45,  5.04s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0036, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9559, 'compress@10': 0.5324, 'time@10': 9.9872}:  10%|█         | 1/10 [00:15<00:45,  5.04s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0036, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9559, 'compress@10': 0.5324, 'time@10': 9.9872}:  20%|██        | 2/10 [00:15<01:03,  7.97s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0024, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.923, 'compress@10': 0.4127, 'time@10': 9.8599}:  20%|██        | 2/10 [00:19<01:03,  7.97s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0024, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.923, 'compress@10': 0.4127, 'time@10': 9.8599}:  30%|███       | 3/10 [00:19<00:45,  6.54s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.7679, 'ndcg@10': 0.9333, 'compress@10': 0.4534, 'time@10': 9.8228}:  30%|███       | 3/10 [00:29<00:45,  6.54s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.7679, 'ndcg@10': 0.9333, 'compress@10': 0.4534, 'time@10': 9.8228}:  40%|████      | 4/10 [00:29<00:46,  7.81s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0063, 'hit_ratio@10': 0.8024, 'ndcg@10': 0.9334, 'compress@10': 0.551, 'time@10': 9.9684}:  40%|████      | 4/10 [00:34<00:46,  7.81s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.0063, 'hit_ratio@10': 0.8024, 'ndcg@10': 0.9334, 'compress@10': 0.551, 'time@10': 9.9684}:  50%|█████     | 5/10 [00:34<00:34,  6.91s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0068, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.9402, 'compress@10': 0.5463, 'time@10': 10.0782}:  50%|█████     | 5/10 [00:45<00:34,  6.91s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0068, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.9402, 'compress@10': 0.5463, 'time@10': 10.0782}:  60%|██████    | 6/10 [00:45<00:32,  8.18s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0084, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.9428, 'compress@10': 0.5181, 'time@10': 10.2547}:  60%|██████    | 6/10 [00:51<00:32,  8.18s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0084, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.9428, 'compress@10': 0.5181, 'time@10': 10.2547}:  70%|███████   | 7/10 [00:51<00:22,  7.37s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0081, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.9464, 'compress@10': 0.5161, 'time@10': 10.2054}:  70%|███████   | 7/10 [01:01<00:22,  7.37s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0081, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.9464, 'compress@10': 0.5161, 'time@10': 10.2054}:  80%|████████  | 8/10 [01:01<00:16,  8.17s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0093, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9476, 'compress@10': 0.5506, 'time@10': 10.2945}:  80%|████████  | 8/10 [01:06<00:16,  8.17s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0093, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9476, 'compress@10': 0.5506, 'time@10': 10.2945}:  90%|█████████ | 9/10 [01:06<00:07,  7.35s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9504, 'compress@10': 0.5269, 'time@10': 10.3695}:  90%|█████████ | 9/10 [01:17<00:07,  7.35s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9504, 'compress@10': 0.5269, 'time@10': 10.3695}: 100%|██████████| 10/10 [01:17<00:00,  8.50s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9504, 'compress@10': 0.5269, 'time@10': 10.3695}: 100%|██████████| 10/10 [01:17<00:00,  7.78s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.008609203626940596
Avg hit ratio: 0.8710969873363761
Avg ndcg: 0.9504373086281912
Avg compression ratio: 0.5269277090618537
Avg train time: 10.36949450969696
Std train time: 0.5851005033579186
[0.5232558139534884, 0.4767441860465117, 0.034883720930232565, 0.5697674418604649, 0.941860465116279, 0.5232558139534884, 0.3372093023255815, 0.4767441860465117, 0.8255813953488371, 0.2906976744186047]
[12, 14, 41, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9381, 'compress@10': 0.5483, 'time@10': 10.4457}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9381, 'compress@10': 0.5483, 'time@10': 10.4457}:  10%|█         | 1/10 [00:05<00:47,  5.26s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0057, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9529, 'compress@10': 0.521, 'time@10': 10.2087}:  10%|█         | 1/10 [00:15<00:47,  5.26s/it]  {'epoch': 42, 'num_users': 7.0, 'loss': 0.0057, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9529, 'compress@10': 0.521, 'time@10': 10.2087}:  20%|██        | 2/10 [00:15<01:04,  8.05s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.921, 'compress@10': 0.4049, 'time@10': 10.2139}:  20%|██        | 2/10 [00:20<01:04,  8.05s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.921, 'compress@10': 0.4049, 'time@10': 10.2139}:  30%|███       | 3/10 [00:20<00:47,  6.73s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9352, 'compress@10': 0.45, 'time@10': 10.0443}:  30%|███       | 3/10 [00:29<00:47,  6.73s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9352, 'compress@10': 0.45, 'time@10': 10.0443}:  40%|████      | 4/10 [00:29<00:47,  7.85s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.935, 'compress@10': 0.5486, 'time@10': 10.1318}:  40%|████      | 4/10 [00:35<00:47,  7.85s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.935, 'compress@10': 0.5486, 'time@10': 10.1318}:  50%|█████     | 5/10 [00:35<00:34,  6.93s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9418, 'compress@10': 0.5461, 'time@10': 10.2018}:  50%|█████     | 5/10 [00:45<00:34,  6.93s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9418, 'compress@10': 0.5461, 'time@10': 10.2018}:  60%|██████    | 6/10 [00:45<00:32,  8.17s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.944, 'compress@10': 0.5201, 'time@10': 10.3616}:  60%|██████    | 6/10 [00:51<00:32,  8.17s/it] {'epoch': 42, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.944, 'compress@10': 0.5201, 'time@10': 10.3616}:  70%|███████   | 7/10 [00:51<00:22,  7.36s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0071, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9474, 'compress@10': 0.5165, 'time@10': 10.2874}:  70%|███████   | 7/10 [01:01<00:22,  7.36s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0071, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9474, 'compress@10': 0.5165, 'time@10': 10.2874}:  80%|████████  | 8/10 [01:01<00:16,  8.14s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9489, 'compress@10': 0.5514, 'time@10': 10.3463}:  80%|████████  | 8/10 [01:06<00:16,  8.14s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9489, 'compress@10': 0.5514, 'time@10': 10.3463}:  90%|█████████ | 9/10 [01:06<00:07,  7.30s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9511, 'compress@10': 0.527, 'time@10': 10.422}:  90%|█████████ | 9/10 [01:17<00:07,  7.30s/it]      {'epoch': 42, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9511, 'compress@10': 0.527, 'time@10': 10.422}: 100%|██████████| 10/10 [01:17<00:00,  8.48s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9511, 'compress@10': 0.527, 'time@10': 10.422}: 100%|██████████| 10/10 [01:17<00:00,  7.80s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.009006019572153391
Avg hit ratio: 0.8933985746379633
Avg ndcg: 0.9510677087804789
Avg compression ratio: 0.5269512960503674
Avg train time: 10.42197573184967
Std train time: 0.5388027375842726
[0.5340909090909092, 0.465909090909091, 0.034090909090909095, 0.5795454545454544, 0.9431818181818181, 0.5113636363636364, 0.32954545454545464, 0.465909090909091, 0.8295454545454545, 0.3068181818181819]
[12, 14, 41, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9415, 'compress@10': 0.5586, 'time@10': 10.3115}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9415, 'compress@10': 0.5586, 'time@10': 10.3115}:  10%|█         | 1/10 [00:05<00:46,  5.19s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0043, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9546, 'compress@10': 0.5209, 'time@10': 10.266}:  10%|█         | 1/10 [00:15<00:46,  5.19s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0043, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9546, 'compress@10': 0.5209, 'time@10': 10.266}:  20%|██        | 2/10 [00:15<01:05,  8.18s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0029, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9221, 'compress@10': 0.4046, 'time@10': 10.0151}:  20%|██        | 2/10 [00:20<01:05,  8.18s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0029, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9221, 'compress@10': 0.4046, 'time@10': 10.0151}:  30%|███       | 3/10 [00:20<00:46,  6.63s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.9327, 'compress@10': 0.4521, 'time@10': 9.9058}:  30%|███       | 3/10 [00:29<00:46,  6.63s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.9327, 'compress@10': 0.4521, 'time@10': 9.9058}:  40%|████      | 4/10 [00:29<00:46,  7.81s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0071, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.9338, 'compress@10': 0.5505, 'time@10': 10.0086}:  40%|████      | 4/10 [00:35<00:46,  7.81s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0071, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.9338, 'compress@10': 0.5505, 'time@10': 10.0086}:  50%|█████     | 5/10 [00:35<00:34,  6.89s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9448, 'compress@10': 0.5458, 'time@10': 10.103}:  50%|█████     | 5/10 [00:45<00:34,  6.89s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9448, 'compress@10': 0.5458, 'time@10': 10.103}:  60%|██████    | 6/10 [00:45<00:32,  8.16s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9466, 'compress@10': 0.5188, 'time@10': 10.2856}:  60%|██████    | 6/10 [00:51<00:32,  8.16s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9466, 'compress@10': 0.5188, 'time@10': 10.2856}:  70%|███████   | 7/10 [00:51<00:22,  7.36s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.961, 'compress@10': 0.5141, 'time@10': 10.1812}:  70%|███████   | 7/10 [01:00<00:22,  7.36s/it]  {'epoch': 43, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.961, 'compress@10': 0.5141, 'time@10': 10.1812}:  80%|████████  | 8/10 [01:00<00:16,  8.04s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9608, 'compress@10': 0.5496, 'time@10': 10.2988}:  80%|████████  | 8/10 [01:06<00:16,  8.04s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9608, 'compress@10': 0.5496, 'time@10': 10.2988}:  90%|█████████ | 9/10 [01:06<00:07,  7.30s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9624, 'compress@10': 0.5269, 'time@10': 10.3903}:  90%|█████████ | 9/10 [01:17<00:07,  7.30s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9624, 'compress@10': 0.5269, 'time@10': 10.3903}: 100%|██████████| 10/10 [01:17<00:00,  8.52s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9624, 'compress@10': 0.5269, 'time@10': 10.3903}: 100%|██████████| 10/10 [01:17<00:00,  7.79s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.014311148005604115
Avg hit ratio: 0.8982787589697606
Avg ndcg: 0.9624394117606343
Avg compression ratio: 0.5269419057547695
Avg train time: 10.390270113945007
Std train time: 0.6902216024625468
[0.5222222222222223, 0.45555555555555566, 0.03333333333333334, 0.5888888888888887, 0.9444444444444444, 0.5222222222222223, 0.3222222222222223, 0.47777777777777786, 0.8333333333333333, 0.30000000000000004]
[12, 14, 41, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.5474, 'time@10': 10.497}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.5474, 'time@10': 10.497}:  10%|█         | 1/10 [00:05<00:47,  5.28s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0424, 'hit_ratio@10': 0.9576, 'ndcg@10': 1.0406, 'compress@10': 0.5102, 'time@10': 10.2244}:  10%|█         | 1/10 [00:15<00:47,  5.28s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0424, 'hit_ratio@10': 0.9576, 'ndcg@10': 1.0406, 'compress@10': 0.5102, 'time@10': 10.2244}:  20%|██        | 2/10 [00:15<01:04,  8.05s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.9795, 'compress@10': 0.3973, 'time@10': 10.0758}:  20%|██        | 2/10 [00:20<01:04,  8.05s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.9795, 'compress@10': 0.3973, 'time@10': 10.0758}:  30%|███       | 3/10 [00:20<00:46,  6.62s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9757, 'compress@10': 0.4489, 'time@10': 9.9537}:  30%|███       | 3/10 [00:29<00:46,  6.62s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.9757, 'compress@10': 0.4489, 'time@10': 9.9537}:  40%|████      | 4/10 [00:29<00:46,  7.81s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.969, 'compress@10': 0.5482, 'time@10': 10.0836}:  40%|████      | 4/10 [00:35<00:46,  7.81s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.969, 'compress@10': 0.5482, 'time@10': 10.0836}:  50%|█████     | 5/10 [00:35<00:34,  6.92s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0181, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.9703, 'compress@10': 0.5456, 'time@10': 10.1486}:  50%|█████     | 5/10 [00:45<00:34,  6.92s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0181, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.9703, 'compress@10': 0.5456, 'time@10': 10.1486}:  60%|██████    | 6/10 [00:45<00:32,  8.14s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9695, 'compress@10': 0.5176, 'time@10': 10.2478}:  60%|██████    | 6/10 [00:51<00:32,  8.14s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9695, 'compress@10': 0.5176, 'time@10': 10.2478}:  70%|███████   | 7/10 [00:51<00:21,  7.26s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9654, 'compress@10': 0.5145, 'time@10': 10.1244}:  70%|███████   | 7/10 [01:00<00:21,  7.26s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9654, 'compress@10': 0.5145, 'time@10': 10.1244}:  80%|████████  | 8/10 [01:00<00:15,  7.91s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9645, 'compress@10': 0.5504, 'time@10': 10.1848}:  80%|████████  | 8/10 [01:05<00:15,  7.91s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9645, 'compress@10': 0.5504, 'time@10': 10.1848}:  90%|█████████ | 9/10 [01:05<00:07,  7.12s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9658, 'compress@10': 0.527, 'time@10': 10.2194}:  90%|█████████ | 9/10 [01:16<00:07,  7.12s/it]    {'epoch': 44, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9658, 'compress@10': 0.527, 'time@10': 10.2194}: 100%|██████████| 10/10 [01:16<00:00,  8.18s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9658, 'compress@10': 0.527, 'time@10': 10.2194}: 100%|██████████| 10/10 [01:16<00:00,  7.64s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.017074406560774545
Avg hit ratio: 0.9083018004444151
Avg ndcg: 0.9658441649216005
Avg compression ratio: 0.5269881854998888
Avg train time: 10.219423937797547
Std train time: 0.5060201048799782
[0.5108695652173914, 0.46739130434782616, 0.03260869565217392, 0.5760869565217389, 0.9239130434782609, 0.5108695652173914, 0.3369565217391305, 0.48913043478260876, 0.8369565217391304, 0.3152173913043479]
[12, 14, 41, 15, 5, 10, 10, 12, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0055, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.5366, 'time@10': 9.9075}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0055, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.5366, 'time@10': 9.9075}:  10%|█         | 1/10 [00:04<00:44,  4.99s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0051, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9559, 'compress@10': 0.5106, 'time@10': 9.7036}:  10%|█         | 1/10 [00:14<00:44,  4.99s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0051, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9559, 'compress@10': 0.5106, 'time@10': 9.7036}:  20%|██        | 2/10 [00:14<01:01,  7.66s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.855, 'ndcg@10': 0.923, 'compress@10': 0.3973, 'time@10': 9.4702}:  20%|██        | 2/10 [00:19<01:01,  7.66s/it]  {'epoch': 45, 'num_users': 5.0, 'loss': 0.0034, 'hit_ratio@10': 0.855, 'ndcg@10': 0.923, 'compress@10': 0.3973, 'time@10': 9.4702}:  30%|███       | 3/10 [00:19<00:43,  6.24s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9344, 'compress@10': 0.4458, 'time@10': 9.3176}:  30%|███       | 3/10 [00:27<00:43,  6.24s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9344, 'compress@10': 0.4458, 'time@10': 9.3176}:  40%|████      | 4/10 [00:27<00:43,  7.29s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9372, 'compress@10': 0.5417, 'time@10': 9.4168}:  40%|████      | 4/10 [00:32<00:43,  7.29s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9372, 'compress@10': 0.5417, 'time@10': 9.4168}:  50%|█████     | 5/10 [00:32<00:32,  6.44s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9441, 'compress@10': 0.5384, 'time@10': 9.4153}:  50%|█████     | 5/10 [00:42<00:32,  6.44s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9441, 'compress@10': 0.5384, 'time@10': 9.4153}:  60%|██████    | 6/10 [00:42<00:29,  7.46s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9457, 'compress@10': 0.5134, 'time@10': 9.4804}:  60%|██████    | 6/10 [00:47<00:29,  7.46s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9457, 'compress@10': 0.5134, 'time@10': 9.4804}:  70%|███████   | 7/10 [00:47<00:19,  6.65s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9489, 'compress@10': 0.5122, 'time@10': 9.3671}:  70%|███████   | 7/10 [00:55<00:19,  6.65s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9489, 'compress@10': 0.5122, 'time@10': 9.3671}:  80%|████████  | 8/10 [00:55<00:14,  7.27s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9502, 'compress@10': 0.5488, 'time@10': 9.3907}:  80%|████████  | 8/10 [01:00<00:14,  7.27s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9502, 'compress@10': 0.5488, 'time@10': 9.3907}:  90%|█████████ | 9/10 [01:00<00:06,  6.51s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.9529, 'compress@10': 0.527, 'time@10': 9.4225}:  90%|█████████ | 9/10 [01:10<00:06,  6.51s/it]    {'epoch': 45, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.9529, 'compress@10': 0.527, 'time@10': 9.4225}: 100%|██████████| 10/10 [01:10<00:00,  7.51s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.9529, 'compress@10': 0.527, 'time@10': 9.4225}: 100%|██████████| 10/10 [01:10<00:00,  7.05s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.008866669714654447
Avg hit ratio: 0.9139136796046813
Avg ndcg: 0.9528967810109169
Avg compression ratio: 0.5269960494264012
Avg train time: 9.422474765777588
Std train time: 0.43748364579200383
[0.5, 0.45744680851063835, 0.03191489361702128, 0.5851063829787232, 0.925531914893617, 0.5212765957446809, 0.3510638297872341, 0.47872340425531923, 0.8404255319148936, 0.3085106382978724]
[12, 14, 42, 16, 5, 10, 10, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.5263, 'time@10': 9.1489}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.5263, 'time@10': 9.1489}:  10%|█         | 1/10 [00:04<00:41,  4.61s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9626, 'compress@10': 0.5006, 'time@10': 8.9569}:  10%|█         | 1/10 [00:13<00:41,  4.61s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9626, 'compress@10': 0.5006, 'time@10': 8.9569}:  20%|██        | 2/10 [00:13<00:56,  7.08s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9275, 'compress@10': 0.3905, 'time@10': 8.9548}:  20%|██        | 2/10 [00:17<00:56,  7.08s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9275, 'compress@10': 0.3905, 'time@10': 8.9548}:  30%|███       | 3/10 [00:17<00:41,  5.90s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.938, 'compress@10': 0.4429, 'time@10': 8.928}:  30%|███       | 3/10 [00:26<00:41,  5.90s/it]  {'epoch': 46, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.938, 'compress@10': 0.4429, 'time@10': 8.928}:  40%|████      | 4/10 [00:26<00:42,  7.08s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9403, 'compress@10': 0.5397, 'time@10': 8.9596}:  40%|████      | 4/10 [00:31<00:42,  7.08s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9403, 'compress@10': 0.5397, 'time@10': 8.9596}:  50%|█████     | 5/10 [00:31<00:30,  6.18s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9464, 'compress@10': 0.5384, 'time@10': 8.9422}:  50%|█████     | 5/10 [00:40<00:30,  6.18s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.9464, 'compress@10': 0.5384, 'time@10': 8.9422}:  60%|██████    | 6/10 [00:40<00:28,  7.10s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9479, 'compress@10': 0.5153, 'time@10': 9.0377}:  60%|██████    | 6/10 [00:45<00:28,  7.10s/it] {'epoch': 46, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9479, 'compress@10': 0.5153, 'time@10': 9.0377}:  70%|███████   | 7/10 [00:45<00:19,  6.36s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9397, 'compress@10': 0.5126, 'time@10': 9.0032}:  70%|███████   | 7/10 [00:53<00:19,  6.36s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9397, 'compress@10': 0.5126, 'time@10': 9.0032}:  80%|████████  | 8/10 [00:53<00:14,  7.14s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9421, 'compress@10': 0.5495, 'time@10': 9.0247}:  80%|████████  | 8/10 [00:58<00:14,  7.14s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9421, 'compress@10': 0.5495, 'time@10': 9.0247}:  90%|█████████ | 9/10 [00:58<00:06,  6.35s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9457, 'compress@10': 0.527, 'time@10': 9.0563}:  90%|█████████ | 9/10 [01:07<00:06,  6.35s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9457, 'compress@10': 0.527, 'time@10': 9.0563}: 100%|██████████| 10/10 [01:07<00:00,  7.29s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9457, 'compress@10': 0.527, 'time@10': 9.0563}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.012879141352143925
Avg hit ratio: 0.9078076888212712
Avg ndcg: 0.9456926020271302
Avg compression ratio: 0.5270158291898872
Avg train time: 9.056326913833619
Std train time: 0.261614126022256
[0.4895833333333333, 0.46875000000000006, 0.03125000000000001, 0.5937499999999998, 0.9270833333333333, 0.5104166666666667, 0.34375000000000006, 0.4895833333333334, 0.8437499999999999, 0.30208333333333337]
[13, 15, 43, 17, 6, 11, 10, 14, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0054, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.5164, 'time@10': 9.5165}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0054, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.5164, 'time@10': 9.5165}:  10%|█         | 1/10 [00:04<00:43,  4.79s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.0075, 'compress@10': 0.5012, 'time@10': 9.3827}:  10%|█         | 1/10 [00:14<00:43,  4.79s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.0075, 'compress@10': 0.5012, 'time@10': 9.3827}:  20%|██        | 2/10 [00:14<00:59,  7.43s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9574, 'compress@10': 0.3907, 'time@10': 9.1655}:  20%|██        | 2/10 [00:18<00:59,  7.43s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9574, 'compress@10': 0.3907, 'time@10': 9.1655}:  30%|███       | 3/10 [00:18<00:42,  6.05s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9591, 'compress@10': 0.4451, 'time@10': 9.2088}:  30%|███       | 3/10 [00:27<00:42,  6.05s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9591, 'compress@10': 0.4451, 'time@10': 9.2088}:  40%|████      | 4/10 [00:27<00:44,  7.36s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9573, 'compress@10': 0.5418, 'time@10': 9.5509}:  40%|████      | 4/10 [00:33<00:44,  7.36s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9573, 'compress@10': 0.5418, 'time@10': 9.5509}:  50%|█████     | 5/10 [00:33<00:33,  6.69s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9588, 'compress@10': 0.5383, 'time@10': 9.6371}:  50%|█████     | 5/10 [00:43<00:33,  6.69s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9588, 'compress@10': 0.5383, 'time@10': 9.6371}:  60%|██████    | 6/10 [00:43<00:31,  7.85s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.959, 'compress@10': 0.5143, 'time@10': 9.7274}:  60%|██████    | 6/10 [00:48<00:31,  7.85s/it] {'epoch': 47, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.959, 'compress@10': 0.5143, 'time@10': 9.7274}:  70%|███████   | 7/10 [00:48<00:20,  6.97s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9648, 'compress@10': 0.513, 'time@10': 9.6662}:  70%|███████   | 7/10 [00:57<00:20,  6.97s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9648, 'compress@10': 0.513, 'time@10': 9.6662}:  80%|████████  | 8/10 [00:57<00:15,  7.70s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9637, 'compress@10': 0.5503, 'time@10': 9.6058}:  80%|████████  | 8/10 [01:02<00:15,  7.70s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9637, 'compress@10': 0.5503, 'time@10': 9.6058}:  90%|█████████ | 9/10 [01:02<00:06,  6.73s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9651, 'compress@10': 0.527, 'time@10': 9.5641}:  90%|█████████ | 9/10 [01:11<00:06,  6.73s/it]     {'epoch': 47, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9651, 'compress@10': 0.527, 'time@10': 9.5641}: 100%|██████████| 10/10 [01:11<00:00,  7.50s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9651, 'compress@10': 0.527, 'time@10': 9.5641}: 100%|██████████| 10/10 [01:11<00:00,  7.17s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.012292418216037763
Avg hit ratio: 0.9120370795022748
Avg ndcg: 0.9650618552071292
Avg compression ratio: 0.527037044059939
Avg train time: 9.564056777954102
Std train time: 0.622603381364074
[0.47959183673469385, 0.4795918367346939, 0.03061224489795919, 0.5816326530612242, 0.9285714285714285, 0.5204081632653061, 0.33673469387755106, 0.5000000000000001, 0.846938775510204, 0.2959183673469388]
[13, 15, 44, 17, 6, 11, 10, 14, 8, 12]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9415, 'compress@10': 0.507, 'time@10': 9.334}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9415, 'compress@10': 0.507, 'time@10': 9.334}:  10%|█         | 1/10 [00:04<00:42,  4.70s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0055, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9546, 'compress@10': 0.5017, 'time@10': 9.1517}:  10%|█         | 1/10 [00:13<00:42,  4.70s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0055, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9546, 'compress@10': 0.5017, 'time@10': 9.1517}:  20%|██        | 2/10 [00:13<00:57,  7.23s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9221, 'compress@10': 0.3908, 'time@10': 9.1102}:  20%|██        | 2/10 [00:18<00:57,  7.23s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9221, 'compress@10': 0.3908, 'time@10': 9.1102}:  30%|███       | 3/10 [00:18<00:42,  6.01s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9349, 'compress@10': 0.4423, 'time@10': 9.0756}:  30%|███       | 3/10 [00:27<00:42,  6.01s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9349, 'compress@10': 0.4423, 'time@10': 9.0756}:  40%|████      | 4/10 [00:27<00:43,  7.19s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9376, 'compress@10': 0.5398, 'time@10': 9.3582}:  40%|████      | 4/10 [00:32<00:43,  7.19s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9376, 'compress@10': 0.5398, 'time@10': 9.3582}:  50%|█████     | 5/10 [00:32<00:32,  6.50s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9441, 'compress@10': 0.5383, 'time@10': 9.3752}:  50%|█████     | 5/10 [00:42<00:32,  6.50s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9441, 'compress@10': 0.5383, 'time@10': 9.3752}:  60%|██████    | 6/10 [00:42<00:30,  7.52s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9464, 'compress@10': 0.5133, 'time@10': 9.4336}:  60%|██████    | 6/10 [00:46<00:30,  7.52s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9464, 'compress@10': 0.5133, 'time@10': 9.4336}:  70%|███████   | 7/10 [00:46<00:20,  6.67s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9403, 'compress@10': 0.5135, 'time@10': 9.3921}:  70%|███████   | 7/10 [00:56<00:20,  6.67s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9403, 'compress@10': 0.5135, 'time@10': 9.3921}:  80%|████████  | 8/10 [00:56<00:14,  7.46s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.947, 'compress@10': 0.551, 'time@10': 9.4846}:  80%|████████  | 8/10 [01:01<00:14,  7.46s/it] {'epoch': 48, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.947, 'compress@10': 0.551, 'time@10': 9.4846}:  90%|█████████ | 9/10 [01:01<00:06,  6.73s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9499, 'compress@10': 0.5271, 'time@10': 9.5064}:  90%|█████████ | 9/10 [01:10<00:06,  6.73s/it] {'epoch': 48, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9499, 'compress@10': 0.5271, 'time@10': 9.5064}: 100%|██████████| 10/10 [01:10<00:00,  7.66s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9499, 'compress@10': 0.5271, 'time@10': 9.5064}: 100%|██████████| 10/10 [01:10<00:00,  7.10s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.010197895982643253
Avg hit ratio: 0.8874620667014556
Avg ndcg: 0.9499489144788175
Avg compression ratio: 0.5270841247733602
Avg train time: 9.506362771987915
Std train time: 0.5095276424860252
[0.47, 0.47000000000000003, 0.030000000000000006, 0.5899999999999997, 0.9299999999999999, 0.51, 0.35000000000000003, 0.5100000000000001, 0.85, 0.29000000000000004]
[13, 16, 45, 18, 6, 11, 10, 15, 8, 12]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0032, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.4979, 'time@10': 9.0787}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0032, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.944, 'compress@10': 0.4979, 'time@10': 9.0787}:  10%|█         | 1/10 [00:04<00:41,  4.57s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9681, 'compress@10': 0.4925, 'time@10': 9.383}:  10%|█         | 1/10 [00:14<00:41,  4.57s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9681, 'compress@10': 0.4925, 'time@10': 9.383}:  20%|██        | 2/10 [00:14<01:00,  7.60s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9311, 'compress@10': 0.3845, 'time@10': 9.4501}:  20%|██        | 2/10 [00:19<01:00,  7.60s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9311, 'compress@10': 0.3845, 'time@10': 9.4501}:  30%|███       | 3/10 [00:19<00:44,  6.33s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9426, 'compress@10': 0.4396, 'time@10': 9.4177}:  30%|███       | 3/10 [00:28<00:44,  6.33s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9426, 'compress@10': 0.4396, 'time@10': 9.4177}:  40%|████      | 4/10 [00:28<00:45,  7.53s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9429, 'compress@10': 0.5379, 'time@10': 9.614}:  40%|████      | 4/10 [00:33<00:45,  7.53s/it]   {'epoch': 49, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9429, 'compress@10': 0.5379, 'time@10': 9.614}:  50%|█████     | 5/10 [00:33<00:33,  6.70s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9486, 'compress@10': 0.5351, 'time@10': 9.6284}:  50%|█████     | 5/10 [00:43<00:33,  6.70s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9486, 'compress@10': 0.5351, 'time@10': 9.6284}:  60%|██████    | 6/10 [00:43<00:30,  7.73s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9511, 'compress@10': 0.5124, 'time@10': 9.577}:  60%|██████    | 6/10 [00:48<00:30,  7.73s/it] {'epoch': 49, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9511, 'compress@10': 0.5124, 'time@10': 9.577}:  70%|███████   | 7/10 [00:48<00:20,  6.73s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9537, 'compress@10': 0.5138, 'time@10': 9.6668}:  70%|███████   | 7/10 [00:58<00:20,  6.73s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9537, 'compress@10': 0.5138, 'time@10': 9.6668}:  80%|████████  | 8/10 [00:58<00:15,  7.88s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0088, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9547, 'compress@10': 0.5516, 'time@10': 9.7177}:  80%|████████  | 8/10 [01:03<00:15,  7.88s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0088, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9547, 'compress@10': 0.5516, 'time@10': 9.7177}:  90%|█████████ | 9/10 [01:03<00:07,  7.01s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0085, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9569, 'compress@10': 0.5271, 'time@10': 9.7461}:  90%|█████████ | 9/10 [01:13<00:07,  7.01s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0085, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9569, 'compress@10': 0.5271, 'time@10': 9.7461}: 100%|██████████| 10/10 [01:13<00:00,  7.94s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0085, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9569, 'compress@10': 0.5271, 'time@10': 9.7461}: 100%|██████████| 10/10 [01:13<00:00,  7.36s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.008540602223027936
Avg hit ratio: 0.896259301724497
Avg ndcg: 0.9569428047392489
Avg compression ratio: 0.5270883091730029
Avg train time: 9.746054244041442
Std train time: 0.42700851868787687
[0.46078431372549017, 0.4803921568627451, 0.02941176470588236, 0.5980392156862743, 0.9313725490196078, 0.5, 0.36274509803921573, 0.5000000000000001, 0.8529411764705882, 0.2843137254901961]
[14, 16, 45, 18, 6, 11, 10, 15, 8, 12]
