  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2372, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.4836, 'compress@10': 0.3368, 'time@10': 9.5215}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2372, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.4836, 'compress@10': 0.3368, 'time@10': 9.5215}:  10%|█         | 1/10 [00:04<00:43,  4.80s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1683, 'hit_ratio@10': 0.5654, 'ndcg@10': 0.5437, 'compress@10': 0.3297, 'time@10': 8.2596}:  10%|█         | 1/10 [00:11<00:43,  4.80s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1683, 'hit_ratio@10': 0.5654, 'ndcg@10': 0.5437, 'compress@10': 0.3297, 'time@10': 8.2596}:  20%|██        | 2/10 [00:11<00:48,  6.11s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9155, 'hit_ratio@10': 0.4245, 'ndcg@10': 0.3625, 'compress@10': 0.3531, 'time@10': 6.4521}:  20%|██        | 2/10 [00:13<00:48,  6.11s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9155, 'hit_ratio@10': 0.4245, 'ndcg@10': 0.3625, 'compress@10': 0.3531, 'time@10': 6.4521}:  30%|███       | 3/10 [00:13<00:27,  3.99s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7243, 'hit_ratio@10': 0.4791, 'ndcg@10': 0.4084, 'compress@10': 0.3461, 'time@10': 6.414}:  30%|███       | 3/10 [00:19<00:27,  3.99s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.7243, 'hit_ratio@10': 0.4791, 'ndcg@10': 0.4084, 'compress@10': 0.3461, 'time@10': 6.414}:  40%|████      | 4/10 [00:19<00:29,  4.92s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5988, 'hit_ratio@10': 0.5473, 'ndcg@10': 0.4733, 'compress@10': 0.3397, 'time@10': 9.6995}:  40%|████      | 4/10 [00:31<00:29,  4.92s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5988, 'hit_ratio@10': 0.5473, 'ndcg@10': 0.4733, 'compress@10': 0.3397, 'time@10': 9.6995}:  50%|█████     | 5/10 [00:31<00:36,  7.28s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5145, 'hit_ratio@10': 0.5746, 'ndcg@10': 0.5199, 'compress@10': 0.3357, 'time@10': 9.7756}:  50%|█████     | 5/10 [00:41<00:36,  7.28s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5145, 'hit_ratio@10': 0.5746, 'ndcg@10': 0.5199, 'compress@10': 0.3357, 'time@10': 9.7756}:  60%|██████    | 6/10 [00:41<00:33,  8.27s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4621, 'hit_ratio@10': 0.5782, 'ndcg@10': 0.5215, 'compress@10': 0.3346, 'time@10': 10.2148}:  60%|██████    | 6/10 [00:47<00:33,  8.27s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4621, 'hit_ratio@10': 0.5782, 'ndcg@10': 0.5215, 'compress@10': 0.3346, 'time@10': 10.2148}:  70%|███████   | 7/10 [00:47<00:23,  7.68s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.4138, 'hit_ratio@10': 0.6131, 'ndcg@10': 0.5392, 'compress@10': 0.3328, 'time@10': 9.9098}:  70%|███████   | 7/10 [00:55<00:23,  7.68s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.4138, 'hit_ratio@10': 0.6131, 'ndcg@10': 0.5392, 'compress@10': 0.3328, 'time@10': 9.9098}:  80%|████████  | 8/10 [00:55<00:15,  7.72s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3767, 'hit_ratio@10': 0.6307, 'ndcg@10': 0.5771, 'compress@10': 0.3313, 'time@10': 10.5871}:  80%|████████  | 8/10 [01:03<00:15,  7.72s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3767, 'hit_ratio@10': 0.6307, 'ndcg@10': 0.5771, 'compress@10': 0.3313, 'time@10': 10.5871}:  90%|█████████ | 9/10 [01:03<00:07,  7.82s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.345, 'hit_ratio@10': 0.6608, 'ndcg@10': 0.5988, 'compress@10': 0.3298, 'time@10': 10.5166}:  90%|█████████ | 9/10 [01:13<00:07,  7.82s/it]    {'epoch': 0, 'num_users': 6.3, 'loss': 0.345, 'hit_ratio@10': 0.6608, 'ndcg@10': 0.5988, 'compress@10': 0.3298, 'time@10': 10.5166}: 100%|██████████| 10/10 [01:13<00:00,  8.47s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.345, 'hit_ratio@10': 0.6608, 'ndcg@10': 0.5988, 'compress@10': 0.3298, 'time@10': 10.5166}: 100%|██████████| 10/10 [01:13<00:00,  7.35s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3449533221629504
Avg hit ratio: 0.6607945058148792
Avg ndcg: 0.5987919160789892
Avg compression ratio: 0.3297935023664511
Avg train time: 10.516642475128174
Std train time: 5.3446758886436765
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0602, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8089, 'compress@10': 0.3368, 'time@10': 8.1843}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0602, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8089, 'compress@10': 0.3368, 'time@10': 8.1843}:  10%|█         | 1/10 [00:04<00:37,  4.13s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0571, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8288, 'compress@10': 0.3297, 'time@10': 7.4741}:  10%|█         | 1/10 [00:10<00:37,  4.13s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0571, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8288, 'compress@10': 0.3297, 'time@10': 7.4741}:  20%|██        | 2/10 [00:10<00:45,  5.71s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.052, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.7615, 'compress@10': 0.3531, 'time@10': 5.9792}:  20%|██        | 2/10 [00:12<00:45,  5.71s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.052, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.7615, 'compress@10': 0.3531, 'time@10': 5.9792}:  30%|███       | 3/10 [00:12<00:26,  3.80s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0516, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.7815, 'compress@10': 0.3461, 'time@10': 6.1464}:  30%|███       | 3/10 [00:19<00:26,  3.80s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0516, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.7815, 'compress@10': 0.3461, 'time@10': 6.1464}:  40%|████      | 4/10 [00:19<00:29,  4.94s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0589, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.7809, 'compress@10': 0.3397, 'time@10': 8.9918}:  40%|████      | 4/10 [00:29<00:29,  4.94s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0589, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.7809, 'compress@10': 0.3397, 'time@10': 8.9918}:  50%|█████     | 5/10 [00:29<00:34,  6.84s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0622, 'hit_ratio@10': 0.7803, 'ndcg@10': 0.7864, 'compress@10': 0.3357, 'time@10': 9.1913}:  50%|█████     | 5/10 [00:39<00:34,  6.84s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0622, 'hit_ratio@10': 0.7803, 'ndcg@10': 0.7864, 'compress@10': 0.3357, 'time@10': 9.1913}:  60%|██████    | 6/10 [00:39<00:31,  7.99s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0599, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.7967, 'compress@10': 0.3346, 'time@10': 9.4189}:  60%|██████    | 6/10 [00:45<00:31,  7.99s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0599, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.7967, 'compress@10': 0.3346, 'time@10': 9.4189}:  70%|███████   | 7/10 [00:45<00:21,  7.15s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0571, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8066, 'compress@10': 0.3328, 'time@10': 9.2028}:  70%|███████   | 7/10 [00:52<00:21,  7.15s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0571, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8066, 'compress@10': 0.3328, 'time@10': 9.2028}:  80%|████████  | 8/10 [00:52<00:14,  7.34s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0548, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.8188, 'compress@10': 0.3313, 'time@10': 9.8808}:  80%|████████  | 8/10 [01:00<00:14,  7.34s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0548, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.8188, 'compress@10': 0.3313, 'time@10': 9.8808}:  90%|█████████ | 9/10 [01:00<00:07,  7.45s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.054, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8216, 'compress@10': 0.3298, 'time@10': 9.854}:  90%|█████████ | 9/10 [01:10<00:07,  7.45s/it]     {'epoch': 1, 'num_users': 6.3, 'loss': 0.054, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8216, 'compress@10': 0.3298, 'time@10': 9.854}: 100%|██████████| 10/10 [01:10<00:00,  8.13s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.054, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8216, 'compress@10': 0.3298, 'time@10': 9.854}: 100%|██████████| 10/10 [01:10<00:00,  7.01s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05399960128905414
Avg hit ratio: 0.8201937296809962
Avg ndcg: 0.8215668937791415
Avg compression ratio: 0.3297934215192659
Avg train time: 9.853956651687621
Std train time: 4.645745361517122
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8438, 'compress@10': 0.3368, 'time@10': 8.0586}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8438, 'compress@10': 0.3368, 'time@10': 8.0586}:  10%|█         | 1/10 [00:04<00:36,  4.07s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8499, 'compress@10': 0.3297, 'time@10': 7.4389}:  10%|█         | 1/10 [00:10<00:36,  4.07s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8499, 'compress@10': 0.3297, 'time@10': 7.4389}:  20%|██        | 2/10 [00:10<00:45,  5.71s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8502, 'compress@10': 0.3531, 'time@10': 6.0155}:  20%|██        | 2/10 [00:12<00:45,  5.71s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8502, 'compress@10': 0.3531, 'time@10': 6.0155}:  30%|███       | 3/10 [00:12<00:26,  3.85s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0393, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8489, 'compress@10': 0.3461, 'time@10': 6.0388}:  30%|███       | 3/10 [00:18<00:26,  3.85s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0393, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8489, 'compress@10': 0.3461, 'time@10': 6.0388}:  40%|████      | 4/10 [00:18<00:28,  4.75s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0489, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.8364, 'compress@10': 0.3397, 'time@10': 8.3899}:  40%|████      | 4/10 [00:27<00:28,  4.75s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0489, 'hit_ratio@10': 0.8006, 'ndcg@10': 0.8364, 'compress@10': 0.3397, 'time@10': 8.3899}:  50%|█████     | 5/10 [00:27<00:31,  6.27s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0535, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8325, 'compress@10': 0.3357, 'time@10': 8.7326}:  50%|█████     | 5/10 [00:38<00:31,  6.27s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0535, 'hit_ratio@10': 0.7931, 'ndcg@10': 0.8325, 'compress@10': 0.3357, 'time@10': 8.7326}:  60%|██████    | 6/10 [00:38<00:30,  7.70s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0518, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.837, 'compress@10': 0.3346, 'time@10': 9.0349}:  60%|██████    | 6/10 [00:43<00:30,  7.70s/it] {'epoch': 2, 'num_users': 6.2857, 'loss': 0.0518, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.837, 'compress@10': 0.3346, 'time@10': 9.0349}:  70%|███████   | 7/10 [00:43<00:20,  6.97s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0511, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8425, 'compress@10': 0.3328, 'time@10': 8.8868}:  70%|███████   | 7/10 [00:51<00:20,  6.97s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0511, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8425, 'compress@10': 0.3328, 'time@10': 8.8868}:  80%|████████  | 8/10 [00:51<00:14,  7.27s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0497, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8516, 'compress@10': 0.3313, 'time@10': 9.5051}:  80%|████████  | 8/10 [00:58<00:14,  7.27s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0497, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8516, 'compress@10': 0.3313, 'time@10': 9.5051}:  90%|█████████ | 9/10 [00:58<00:07,  7.26s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8513, 'compress@10': 0.3298, 'time@10': 9.5279}:  90%|█████████ | 9/10 [01:08<00:07,  7.26s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8513, 'compress@10': 0.3298, 'time@10': 9.5279}: 100%|██████████| 10/10 [01:08<00:00,  8.04s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8513, 'compress@10': 0.3298, 'time@10': 9.5279}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.049426693798960634
Avg hit ratio: 0.8307584748773204
Avg ndcg: 0.8512561930450078
Avg compression ratio: 0.3297934854072053
Avg train time: 9.527906465530396
Std train time: 3.9955108736159786
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.3368, 'time@10': 8.3892}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.3368, 'time@10': 8.3892}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.798, 'ndcg@10': 0.845, 'compress@10': 0.3297, 'time@10': 7.6053}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]  {'epoch': 3, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.798, 'ndcg@10': 0.845, 'compress@10': 0.3297, 'time@10': 7.6053}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8491, 'compress@10': 0.3531, 'time@10': 6.2473}:  20%|██        | 2/10 [00:12<00:46,  5.78s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8491, 'compress@10': 0.3531, 'time@10': 6.2473}:  30%|███       | 3/10 [00:12<00:27,  3.96s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.7561, 'ndcg@10': 0.8489, 'compress@10': 0.3461, 'time@10': 6.2025}:  30%|███       | 3/10 [00:19<00:27,  3.96s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.7561, 'ndcg@10': 0.8489, 'compress@10': 0.3461, 'time@10': 6.2025}:  40%|████      | 4/10 [00:19<00:28,  4.81s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0473, 'hit_ratio@10': 0.7649, 'ndcg@10': 0.8372, 'compress@10': 0.3397, 'time@10': 8.07}:  40%|████      | 4/10 [00:26<00:28,  4.81s/it]  {'epoch': 3, 'num_users': 5.8, 'loss': 0.0473, 'hit_ratio@10': 0.7649, 'ndcg@10': 0.8372, 'compress@10': 0.3397, 'time@10': 8.07}:  50%|█████     | 5/10 [00:26<00:29,  5.89s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0517, 'hit_ratio@10': 0.767, 'ndcg@10': 0.8352, 'compress@10': 0.3357, 'time@10': 8.394}:  50%|█████     | 5/10 [00:36<00:29,  5.89s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0517, 'hit_ratio@10': 0.767, 'ndcg@10': 0.8352, 'compress@10': 0.3357, 'time@10': 8.394}:  60%|██████    | 6/10 [00:36<00:29,  7.31s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.7946, 'ndcg@10': 0.8353, 'compress@10': 0.3346, 'time@10': 8.8589}:  60%|██████    | 6/10 [00:42<00:29,  7.31s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.7946, 'ndcg@10': 0.8353, 'compress@10': 0.3346, 'time@10': 8.8589}:  70%|███████   | 7/10 [00:42<00:20,  6.84s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0525, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.8366, 'compress@10': 0.3328, 'time@10': 8.7525}:  70%|███████   | 7/10 [00:50<00:20,  6.84s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0525, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.8366, 'compress@10': 0.3328, 'time@10': 8.7525}:  80%|████████  | 8/10 [00:50<00:14,  7.22s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0515, 'hit_ratio@10': 0.8085, 'ndcg@10': 0.8461, 'compress@10': 0.3313, 'time@10': 9.3769}:  80%|████████  | 8/10 [00:58<00:14,  7.22s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0515, 'hit_ratio@10': 0.8085, 'ndcg@10': 0.8461, 'compress@10': 0.3313, 'time@10': 9.3769}:  90%|█████████ | 9/10 [00:58<00:07,  7.22s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.051, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.8464, 'compress@10': 0.3298, 'time@10': 9.4061}:  90%|█████████ | 9/10 [01:07<00:07,  7.22s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.051, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.8464, 'compress@10': 0.3298, 'time@10': 9.4061}: 100%|██████████| 10/10 [01:07<00:00,  7.99s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.051, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.8464, 'compress@10': 0.3298, 'time@10': 9.4061}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.05099363138360017
Avg hit ratio: 0.8208378399566854
Avg ndcg: 0.8463665037804381
Avg compression ratio: 0.3297934805188503
Avg train time: 9.406096720695496
Std train time: 3.5080931049368953
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 14, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.3368, 'time@10': 8.1412}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.3368, 'time@10': 8.1412}:  10%|█         | 1/10 [00:04<00:36,  4.11s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8504, 'compress@10': 0.3297, 'time@10': 7.5238}:  10%|█         | 1/10 [00:11<00:36,  4.11s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8504, 'compress@10': 0.3297, 'time@10': 7.5238}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8526, 'compress@10': 0.3531, 'time@10': 6.2981}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8526, 'compress@10': 0.3531, 'time@10': 6.2981}:  30%|███       | 3/10 [00:13<00:28,  4.04s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8452, 'compress@10': 0.3461, 'time@10': 6.3485}:  30%|███       | 3/10 [00:19<00:28,  4.04s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8452, 'compress@10': 0.3461, 'time@10': 6.3485}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8349, 'compress@10': 0.3397, 'time@10': 8.2752}:  40%|████      | 4/10 [00:27<00:30,  5.02s/it] {'epoch': 4, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8349, 'compress@10': 0.3397, 'time@10': 8.2752}:  50%|█████     | 5/10 [00:27<00:30,  6.11s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0507, 'hit_ratio@10': 0.778, 'ndcg@10': 0.8325, 'compress@10': 0.3357, 'time@10': 8.5758}:  50%|█████     | 5/10 [00:37<00:30,  6.11s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0507, 'hit_ratio@10': 0.778, 'ndcg@10': 0.8325, 'compress@10': 0.3357, 'time@10': 8.5758}:  60%|██████    | 6/10 [00:37<00:29,  7.48s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.804, 'ndcg@10': 0.8329, 'compress@10': 0.3346, 'time@10': 8.9425}:  60%|██████    | 6/10 [00:43<00:29,  7.48s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.804, 'ndcg@10': 0.8329, 'compress@10': 0.3346, 'time@10': 8.9425}:  70%|███████   | 7/10 [00:43<00:20,  6.87s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.839, 'compress@10': 0.3328, 'time@10': 8.8176}:  70%|███████   | 7/10 [00:51<00:20,  6.87s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.839, 'compress@10': 0.3328, 'time@10': 8.8176}:  80%|████████  | 8/10 [00:51<00:14,  7.22s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0512, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.8461, 'compress@10': 0.3313, 'time@10': 9.5275}:  80%|████████  | 8/10 [00:58<00:14,  7.22s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0512, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.8461, 'compress@10': 0.3313, 'time@10': 9.5275}:  90%|█████████ | 9/10 [00:58<00:07,  7.35s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0506, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8458, 'compress@10': 0.3298, 'time@10': 9.5747}:  90%|█████████ | 9/10 [01:09<00:07,  7.35s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0506, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8458, 'compress@10': 0.3298, 'time@10': 9.5747}: 100%|██████████| 10/10 [01:09<00:00,  8.18s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0506, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8458, 'compress@10': 0.3298, 'time@10': 9.5747}: 100%|██████████| 10/10 [01:09<00:00,  6.90s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.05060559604284991
Avg hit ratio: 0.8216985670432191
Avg ndcg: 0.8457514592800564
Avg compression ratio: 0.3297934552743911
Avg train time: 9.574721837043763
Std train time: 3.6024769534243632
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.3368, 'time@10': 8.3614}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.3368, 'time@10': 8.3614}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8662, 'compress@10': 0.3297, 'time@10': 7.6451}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8662, 'compress@10': 0.3297, 'time@10': 7.6451}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8632, 'compress@10': 0.3531, 'time@10': 6.4838}:  20%|██        | 2/10 [00:13<00:46,  5.84s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8632, 'compress@10': 0.3531, 'time@10': 6.4838}:  30%|███       | 3/10 [00:13<00:28,  4.14s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8526, 'compress@10': 0.3461, 'time@10': 6.4194}:  30%|███       | 3/10 [00:19<00:28,  4.14s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8526, 'compress@10': 0.3461, 'time@10': 6.4194}:  40%|████      | 4/10 [00:19<00:29,  4.98s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8388, 'compress@10': 0.3397, 'time@10': 7.9208}:  40%|████      | 4/10 [00:26<00:29,  4.98s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8388, 'compress@10': 0.3397, 'time@10': 7.9208}:  50%|█████     | 5/10 [00:26<00:28,  5.71s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0504, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8369, 'compress@10': 0.3357, 'time@10': 8.3152}:  50%|█████     | 5/10 [00:36<00:28,  5.71s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0504, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8369, 'compress@10': 0.3357, 'time@10': 8.3152}:  60%|██████    | 6/10 [00:36<00:29,  7.28s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.837, 'compress@10': 0.3346, 'time@10': 8.7302}:  60%|██████    | 6/10 [00:42<00:29,  7.28s/it] {'epoch': 5, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.837, 'compress@10': 0.3346, 'time@10': 8.7302}:  70%|███████   | 7/10 [00:42<00:20,  6.74s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.05, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8417, 'compress@10': 0.3328, 'time@10': 8.6299}:  70%|███████   | 7/10 [00:50<00:20,  6.74s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.05, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8417, 'compress@10': 0.3328, 'time@10': 8.6299}:  80%|████████  | 8/10 [00:50<00:14,  7.13s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8519, 'compress@10': 0.3313, 'time@10': 9.2374}:  80%|████████  | 8/10 [00:57<00:14,  7.13s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0487, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8519, 'compress@10': 0.3313, 'time@10': 9.2374}:  90%|█████████ | 9/10 [00:57<00:07,  7.12s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8518, 'compress@10': 0.3298, 'time@10': 9.3261}:  90%|█████████ | 9/10 [01:07<00:07,  7.12s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8518, 'compress@10': 0.3298, 'time@10': 9.3261}: 100%|██████████| 10/10 [01:07<00:00,  8.06s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8518, 'compress@10': 0.3298, 'time@10': 9.3261}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04806201811439049
Avg hit ratio: 0.8484445987892508
Avg ndcg: 0.8517828453580151
Avg compression ratio: 0.3297934208319419
Avg train time: 9.326127052307129
Std train time: 3.0659798179641102
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8543, 'compress@10': 0.3368, 'time@10': 8.2041}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8543, 'compress@10': 0.3368, 'time@10': 8.2041}:  10%|█         | 1/10 [00:04<00:37,  4.14s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8527, 'compress@10': 0.3297, 'time@10': 7.547}:  10%|█         | 1/10 [00:11<00:37,  4.14s/it] {'epoch': 6, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8527, 'compress@10': 0.3297, 'time@10': 7.547}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8542, 'compress@10': 0.3531, 'time@10': 6.5468}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8542, 'compress@10': 0.3531, 'time@10': 6.5468}:  30%|███       | 3/10 [00:13<00:29,  4.20s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.7999, 'ndcg@10': 0.8436, 'compress@10': 0.3461, 'time@10': 6.4658}:  30%|███       | 3/10 [00:19<00:29,  4.20s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0379, 'hit_ratio@10': 0.7999, 'ndcg@10': 0.8436, 'compress@10': 0.3461, 'time@10': 6.4658}:  40%|████      | 4/10 [00:19<00:30,  5.01s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.8039, 'ndcg@10': 0.832, 'compress@10': 0.3397, 'time@10': 7.9399}:  40%|████      | 4/10 [00:26<00:30,  5.01s/it] {'epoch': 6, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.8039, 'ndcg@10': 0.832, 'compress@10': 0.3397, 'time@10': 7.9399}:  50%|█████     | 5/10 [00:26<00:28,  5.71s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0492, 'hit_ratio@10': 0.807, 'ndcg@10': 0.8317, 'compress@10': 0.3357, 'time@10': 8.3396}:  50%|█████     | 5/10 [00:36<00:28,  5.71s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0492, 'hit_ratio@10': 0.807, 'ndcg@10': 0.8317, 'compress@10': 0.3357, 'time@10': 8.3396}:  60%|██████    | 6/10 [00:36<00:29,  7.30s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8344, 'compress@10': 0.3346, 'time@10': 8.8257}:  60%|██████    | 6/10 [00:42<00:29,  7.30s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8344, 'compress@10': 0.3346, 'time@10': 8.8257}:  70%|███████   | 7/10 [00:42<00:20,  6.84s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0479, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8425, 'compress@10': 0.3328, 'time@10': 8.6973}:  70%|███████   | 7/10 [00:50<00:20,  6.84s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0479, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8425, 'compress@10': 0.3328, 'time@10': 8.6973}:  80%|████████  | 8/10 [00:50<00:14,  7.16s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.049, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.849, 'compress@10': 0.3313, 'time@10': 9.2857}:  80%|████████  | 8/10 [00:57<00:14,  7.16s/it] {'epoch': 6, 'num_users': 6.3333, 'loss': 0.049, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.849, 'compress@10': 0.3313, 'time@10': 9.2857}:  90%|█████████ | 9/10 [00:57<00:07,  7.12s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0485, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8496, 'compress@10': 0.3298, 'time@10': 9.3407}:  90%|█████████ | 9/10 [01:07<00:07,  7.12s/it] {'epoch': 6, 'num_users': 6.3, 'loss': 0.0485, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8496, 'compress@10': 0.3298, 'time@10': 9.3407}: 100%|██████████| 10/10 [01:07<00:00,  7.98s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0485, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8496, 'compress@10': 0.3298, 'time@10': 9.3407}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.048491891330107825
Avg hit ratio: 0.8419366622813144
Avg ndcg: 0.849627599779353
Avg compression ratio: 0.3297934802652747
Avg train time: 9.34074833393097
Std train time: 3.020672028491091
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.3368, 'time@10': 8.0763}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.3368, 'time@10': 8.0763}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8562, 'compress@10': 0.3297, 'time@10': 7.5712}:  10%|█         | 1/10 [00:11<00:36,  4.08s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8562, 'compress@10': 0.3297, 'time@10': 7.5712}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8565, 'compress@10': 0.3531, 'time@10': 6.6095}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8565, 'compress@10': 0.3531, 'time@10': 6.6095}:  30%|███       | 3/10 [00:13<00:29,  4.27s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8499, 'compress@10': 0.3461, 'time@10': 6.5638}:  30%|███       | 3/10 [00:20<00:29,  4.27s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0353, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8499, 'compress@10': 0.3461, 'time@10': 6.5638}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8374, 'compress@10': 0.3397, 'time@10': 8.0056}:  40%|████      | 4/10 [00:26<00:30,  5.15s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8374, 'compress@10': 0.3397, 'time@10': 8.0056}:  50%|█████     | 5/10 [00:26<00:28,  5.79s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0464, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.837, 'compress@10': 0.3357, 'time@10': 8.3449}:  50%|█████     | 5/10 [00:37<00:28,  5.79s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0464, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.837, 'compress@10': 0.3357, 'time@10': 8.3449}:  60%|██████    | 6/10 [00:37<00:28,  7.25s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0452, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8405, 'compress@10': 0.3346, 'time@10': 8.7467}:  60%|██████    | 6/10 [00:42<00:28,  7.25s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0452, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8405, 'compress@10': 0.3346, 'time@10': 8.7467}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.045, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8467, 'compress@10': 0.3328, 'time@10': 8.6429}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.045, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8467, 'compress@10': 0.3328, 'time@10': 8.6429}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0455, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8512, 'compress@10': 0.3313, 'time@10': 9.2778}:  80%|████████  | 8/10 [00:57<00:14,  7.11s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0455, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8512, 'compress@10': 0.3313, 'time@10': 9.2778}:  90%|█████████ | 9/10 [00:57<00:07,  7.14s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0443, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8531, 'compress@10': 0.3298, 'time@10': 9.3809}:  90%|█████████ | 9/10 [01:08<00:07,  7.14s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0443, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8531, 'compress@10': 0.3298, 'time@10': 9.3809}: 100%|██████████| 10/10 [01:08<00:00,  8.13s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0443, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8531, 'compress@10': 0.3298, 'time@10': 9.3809}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04431370160827254
Avg hit ratio: 0.859730313074965
Avg ndcg: 0.8530527849067248
Avg compression ratio: 0.329793466553411
Avg train time: 9.380851411819458
Std train time: 2.97446147068574
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8545, 'compress@10': 0.3368, 'time@10': 8.2672}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8545, 'compress@10': 0.3368, 'time@10': 8.2672}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8567, 'compress@10': 0.3297, 'time@10': 7.6333}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8567, 'compress@10': 0.3297, 'time@10': 7.6333}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8569, 'compress@10': 0.3531, 'time@10': 6.7749}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8569, 'compress@10': 0.3531, 'time@10': 6.7749}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8565, 'compress@10': 0.3461, 'time@10': 6.6311}:  30%|███       | 3/10 [00:20<00:30,  4.35s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8565, 'compress@10': 0.3461, 'time@10': 6.6311}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0432, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8432, 'compress@10': 0.3397, 'time@10': 8.065}:  40%|████      | 4/10 [00:26<00:30,  5.10s/it] {'epoch': 8, 'num_users': 5.8, 'loss': 0.0432, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8432, 'compress@10': 0.3397, 'time@10': 8.065}:  50%|█████     | 5/10 [00:26<00:28,  5.78s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0448, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8434, 'compress@10': 0.3357, 'time@10': 8.3692}:  50%|█████     | 5/10 [00:36<00:28,  5.78s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0448, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8434, 'compress@10': 0.3357, 'time@10': 8.3692}:  60%|██████    | 6/10 [00:36<00:28,  7.19s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0441, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8476, 'compress@10': 0.3346, 'time@10': 8.7584}:  60%|██████    | 6/10 [00:42<00:28,  7.19s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0441, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8476, 'compress@10': 0.3346, 'time@10': 8.7584}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0443, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8531, 'compress@10': 0.3328, 'time@10': 8.6671}:  70%|███████   | 7/10 [00:50<00:19,  6.66s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0443, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8531, 'compress@10': 0.3328, 'time@10': 8.6671}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0428, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.86, 'compress@10': 0.3313, 'time@10': 9.2578}:  80%|████████  | 8/10 [00:57<00:14,  7.11s/it] {'epoch': 8, 'num_users': 6.3333, 'loss': 0.0428, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.86, 'compress@10': 0.3313, 'time@10': 9.2578}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0426, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8608, 'compress@10': 0.3298, 'time@10': 9.3369}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it] {'epoch': 8, 'num_users': 6.3, 'loss': 0.0426, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8608, 'compress@10': 0.3298, 'time@10': 9.3369}: 100%|██████████| 10/10 [01:07<00:00,  8.08s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0426, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8608, 'compress@10': 0.3298, 'time@10': 9.3369}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04260400769454607
Avg hit ratio: 0.8668161483866067
Avg ndcg: 0.8608212749736832
Avg compression ratio: 0.3297934943685896
Avg train time: 9.336864614486695
Std train time: 2.8614983049455733
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.3368, 'time@10': 8.5641}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.3368, 'time@10': 8.5641}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0429, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8536, 'compress@10': 0.3297, 'time@10': 7.8861}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0429, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8536, 'compress@10': 0.3297, 'time@10': 7.8861}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8548, 'compress@10': 0.3531, 'time@10': 7.0248}:  20%|██        | 2/10 [00:14<00:48,  6.05s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8548, 'compress@10': 0.3531, 'time@10': 7.0248}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8557, 'compress@10': 0.3461, 'time@10': 6.8499}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8557, 'compress@10': 0.3461, 'time@10': 6.8499}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0424, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8427, 'compress@10': 0.3397, 'time@10': 8.2467}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0424, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8427, 'compress@10': 0.3397, 'time@10': 8.2467}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0435, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8434, 'compress@10': 0.3357, 'time@10': 8.5003}:  50%|█████     | 5/10 [00:37<00:29,  5.86s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0435, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8434, 'compress@10': 0.3357, 'time@10': 8.5003}:  60%|██████    | 6/10 [00:37<00:28,  7.20s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0432, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8426, 'compress@10': 0.3346, 'time@10': 8.8803}:  60%|██████    | 6/10 [00:43<00:28,  7.20s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0432, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8426, 'compress@10': 0.3346, 'time@10': 8.8803}:  70%|███████   | 7/10 [00:43<00:20,  6.68s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0435, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8462, 'compress@10': 0.3328, 'time@10': 8.8}:  70%|███████   | 7/10 [00:51<00:20,  6.68s/it]    {'epoch': 9, 'num_users': 6.125, 'loss': 0.0435, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8462, 'compress@10': 0.3328, 'time@10': 8.8}:  80%|████████  | 8/10 [00:51<00:14,  7.19s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0433, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8597, 'compress@10': 0.3313, 'time@10': 9.371}:  80%|████████  | 8/10 [00:58<00:14,  7.19s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0433, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8597, 'compress@10': 0.3313, 'time@10': 9.371}:  90%|█████████ | 9/10 [00:58<00:07,  7.13s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.042, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8618, 'compress@10': 0.3298, 'time@10': 9.43}:  90%|█████████ | 9/10 [01:08<00:07,  7.13s/it]     {'epoch': 9, 'num_users': 6.3, 'loss': 0.042, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8618, 'compress@10': 0.3298, 'time@10': 9.43}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.042, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8618, 'compress@10': 0.3298, 'time@10': 9.43}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.041998138805734914
Avg hit ratio: 0.8741617705064224
Avg ndcg: 0.8618220057610655
Avg compression ratio: 0.3297934939413819
Avg train time: 9.4299946308136
Std train time: 2.7731794070914013
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.051, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8399, 'compress@10': 0.3368, 'time@10': 8.4204}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.051, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8399, 'compress@10': 0.3368, 'time@10': 8.4204}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8588, 'compress@10': 0.3297, 'time@10': 7.7449}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8588, 'compress@10': 0.3297, 'time@10': 7.7449}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8583, 'compress@10': 0.3531, 'time@10': 6.9038}:  20%|██        | 2/10 [00:14<00:47,  5.94s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8583, 'compress@10': 0.3531, 'time@10': 6.9038}:  30%|███       | 3/10 [00:14<00:31,  4.43s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0349, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8629, 'compress@10': 0.3461, 'time@10': 6.7982}:  30%|███       | 3/10 [00:20<00:31,  4.43s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0349, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8629, 'compress@10': 0.3461, 'time@10': 6.7982}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0422, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8491, 'compress@10': 0.3397, 'time@10': 8.2076}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0422, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8491, 'compress@10': 0.3397, 'time@10': 8.2076}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0426, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8503, 'compress@10': 0.3357, 'time@10': 8.4652}:  50%|█████     | 5/10 [00:37<00:29,  5.87s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0426, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8503, 'compress@10': 0.3357, 'time@10': 8.4652}:  60%|██████    | 6/10 [00:37<00:28,  7.20s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0434, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8555, 'compress@10': 0.3346, 'time@10': 8.8517}:  60%|██████    | 6/10 [00:42<00:28,  7.20s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0434, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8555, 'compress@10': 0.3346, 'time@10': 8.8517}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0436, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8565, 'compress@10': 0.3328, 'time@10': 8.7401}:  70%|███████   | 7/10 [00:50<00:20,  6.69s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0436, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8565, 'compress@10': 0.3328, 'time@10': 8.7401}:  80%|████████  | 8/10 [00:50<00:14,  7.10s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0457, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8816, 'compress@10': 0.3313, 'time@10': 9.3418}:  80%|████████  | 8/10 [00:58<00:14,  7.10s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0457, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8816, 'compress@10': 0.3313, 'time@10': 9.3418}:  90%|█████████ | 9/10 [00:58<00:07,  7.11s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.045, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8812, 'compress@10': 0.3298, 'time@10': 9.4433}:  90%|█████████ | 9/10 [01:08<00:07,  7.11s/it]    {'epoch': 10, 'num_users': 6.3, 'loss': 0.045, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8812, 'compress@10': 0.3298, 'time@10': 9.4433}: 100%|██████████| 10/10 [01:08<00:00,  8.12s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.045, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8812, 'compress@10': 0.3298, 'time@10': 9.4433}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.04500124252073701
Avg hit ratio: 0.8680788211976667
Avg ndcg: 0.8811613071364427
Avg compression ratio: 0.3297934915185542
Avg train time: 9.443340849876403
Std train time: 2.845688531877101
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0412, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8685, 'compress@10': 0.3368, 'time@10': 8.2488}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0412, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8685, 'compress@10': 0.3368, 'time@10': 8.2488}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8749, 'compress@10': 0.3297, 'time@10': 7.6247}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it] {'epoch': 11, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8749, 'compress@10': 0.3297, 'time@10': 7.6247}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8689, 'compress@10': 0.3531, 'time@10': 6.9418}:  20%|██        | 2/10 [00:14<00:46,  5.87s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8689, 'compress@10': 0.3531, 'time@10': 6.9418}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8729, 'compress@10': 0.3461, 'time@10': 6.7604}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8729, 'compress@10': 0.3461, 'time@10': 6.7604}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0378, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8576, 'compress@10': 0.3397, 'time@10': 8.2189}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0378, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8576, 'compress@10': 0.3397, 'time@10': 8.2189}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8578, 'compress@10': 0.3357, 'time@10': 8.5225}:  50%|█████     | 5/10 [00:37<00:29,  5.86s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.8578, 'compress@10': 0.3357, 'time@10': 8.5225}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0387, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8548, 'compress@10': 0.3346, 'time@10': 8.9881}:  60%|██████    | 6/10 [00:43<00:29,  7.29s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0387, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8548, 'compress@10': 0.3346, 'time@10': 8.9881}:  70%|███████   | 7/10 [00:43<00:20,  6.85s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.039, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8555, 'compress@10': 0.3328, 'time@10': 8.841}:  70%|███████   | 7/10 [00:51<00:20,  6.85s/it]   {'epoch': 11, 'num_users': 6.125, 'loss': 0.039, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8555, 'compress@10': 0.3328, 'time@10': 8.841}:  80%|████████  | 8/10 [00:51<00:14,  7.17s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.04, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8578, 'compress@10': 0.3313, 'time@10': 9.4496}:  80%|████████  | 8/10 [00:58<00:14,  7.17s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.04, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8578, 'compress@10': 0.3313, 'time@10': 9.4496}:  90%|█████████ | 9/10 [00:58<00:07,  7.18s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0387, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8615, 'compress@10': 0.3298, 'time@10': 9.5035}:  90%|█████████ | 9/10 [01:08<00:07,  7.18s/it] {'epoch': 11, 'num_users': 6.3, 'loss': 0.0387, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8615, 'compress@10': 0.3298, 'time@10': 9.5035}: 100%|██████████| 10/10 [01:08<00:00,  8.06s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0387, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8615, 'compress@10': 0.3298, 'time@10': 9.5035}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.038721902245069245
Avg hit ratio: 0.8666372627561081
Avg ndcg: 0.861537948520445
Avg compression ratio: 0.32979345521217285
Avg train time: 9.5035409450531
Std train time: 2.941478265996365
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8393, 'compress@10': 0.3368, 'time@10': 8.5396}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8393, 'compress@10': 0.3368, 'time@10': 8.5396}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0406, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.86, 'compress@10': 0.3297, 'time@10': 7.8547}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]  {'epoch': 12, 'num_users': 7.0, 'loss': 0.0406, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.86, 'compress@10': 0.3297, 'time@10': 7.8547}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.859, 'compress@10': 0.3531, 'time@10': 7.0572}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.859, 'compress@10': 0.3531, 'time@10': 7.0572}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8643, 'compress@10': 0.3461, 'time@10': 6.836}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8643, 'compress@10': 0.3461, 'time@10': 6.836}:  40%|████      | 4/10 [00:20<00:31,  5.19s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0376, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8514, 'compress@10': 0.3397, 'time@10': 8.23}:  40%|████      | 4/10 [00:27<00:31,  5.19s/it] {'epoch': 12, 'num_users': 5.8, 'loss': 0.0376, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8514, 'compress@10': 0.3397, 'time@10': 8.23}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0381, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8525, 'compress@10': 0.3357, 'time@10': 8.5196}:  50%|█████     | 5/10 [00:37<00:29,  5.82s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0381, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8525, 'compress@10': 0.3357, 'time@10': 8.5196}:  60%|██████    | 6/10 [00:37<00:28,  7.25s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0378, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8585, 'compress@10': 0.3346, 'time@10': 8.8932}:  60%|██████    | 6/10 [00:43<00:28,  7.25s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0378, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8585, 'compress@10': 0.3346, 'time@10': 8.8932}:  70%|███████   | 7/10 [00:43<00:20,  6.71s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0378, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8598, 'compress@10': 0.3328, 'time@10': 8.7924}:  70%|███████   | 7/10 [00:51<00:20,  6.71s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0378, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8598, 'compress@10': 0.3328, 'time@10': 8.7924}:  80%|████████  | 8/10 [00:51<00:14,  7.16s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0362, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8674, 'compress@10': 0.3313, 'time@10': 9.3953}:  80%|████████  | 8/10 [00:58<00:14,  7.16s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0362, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8674, 'compress@10': 0.3313, 'time@10': 9.3953}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0357, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8707, 'compress@10': 0.3298, 'time@10': 9.4396}:  90%|█████████ | 9/10 [01:08<00:07,  7.16s/it]    {'epoch': 12, 'num_users': 6.3, 'loss': 0.0357, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8707, 'compress@10': 0.3298, 'time@10': 9.4396}: 100%|██████████| 10/10 [01:08<00:00,  8.00s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0357, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8707, 'compress@10': 0.3298, 'time@10': 9.4396}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.035694669960572585
Avg hit ratio: 0.8709927727431971
Avg ndcg: 0.8706593362899302
Avg compression ratio: 0.32979340271481977
Avg train time: 9.439567136764527
Std train time: 2.81950512008909
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8667, 'compress@10': 0.3368, 'time@10': 8.4765}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8667, 'compress@10': 0.3368, 'time@10': 8.4765}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8748, 'compress@10': 0.3297, 'time@10': 7.7572}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8748, 'compress@10': 0.3297, 'time@10': 7.7572}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8689, 'compress@10': 0.3531, 'time@10': 7.0701}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8689, 'compress@10': 0.3531, 'time@10': 7.0701}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8725, 'compress@10': 0.3461, 'time@10': 6.8865}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8725, 'compress@10': 0.3461, 'time@10': 6.8865}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8591, 'compress@10': 0.3397, 'time@10': 8.264}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it] {'epoch': 13, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8591, 'compress@10': 0.3397, 'time@10': 8.264}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0366, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8609, 'compress@10': 0.3357, 'time@10': 8.5472}:  50%|█████     | 5/10 [00:37<00:29,  5.86s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0366, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8609, 'compress@10': 0.3357, 'time@10': 8.5472}:  60%|██████    | 6/10 [00:37<00:29,  7.27s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0357, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.861, 'compress@10': 0.3346, 'time@10': 8.937}:  60%|██████    | 6/10 [00:43<00:29,  7.27s/it]  {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0357, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.861, 'compress@10': 0.3346, 'time@10': 8.937}:  70%|███████   | 7/10 [00:43<00:20,  6.75s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0355, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8633, 'compress@10': 0.3328, 'time@10': 8.8109}:  70%|███████   | 7/10 [00:51<00:20,  6.75s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0355, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8633, 'compress@10': 0.3328, 'time@10': 8.8109}:  80%|████████  | 8/10 [00:51<00:14,  7.14s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0348, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8719, 'compress@10': 0.3313, 'time@10': 9.4052}:  80%|████████  | 8/10 [00:58<00:14,  7.14s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0348, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8719, 'compress@10': 0.3313, 'time@10': 9.4052}:  90%|█████████ | 9/10 [00:58<00:07,  7.13s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0336, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8765, 'compress@10': 0.3298, 'time@10': 9.4785}:  90%|█████████ | 9/10 [01:08<00:07,  7.13s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0336, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8765, 'compress@10': 0.3298, 'time@10': 9.4785}: 100%|██████████| 10/10 [01:08<00:00,  8.07s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0336, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8765, 'compress@10': 0.3298, 'time@10': 9.4785}: 100%|██████████| 10/10 [01:08<00:00,  6.85s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03358845334591403
Avg hit ratio: 0.8722245643434098
Avg ndcg: 0.8765400981725842
Avg compression ratio: 0.32979349853678397
Avg train time: 9.478501439094543
Std train time: 2.7894482155731466
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8667, 'compress@10': 0.3368, 'time@10': 8.4909}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8667, 'compress@10': 0.3368, 'time@10': 8.4909}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8771, 'compress@10': 0.3297, 'time@10': 7.7903}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8771, 'compress@10': 0.3297, 'time@10': 7.7903}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8704, 'compress@10': 0.3531, 'time@10': 6.9896}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8704, 'compress@10': 0.3531, 'time@10': 6.9896}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8744, 'compress@10': 0.3461, 'time@10': 6.8162}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8744, 'compress@10': 0.3461, 'time@10': 6.8162}:  40%|████      | 4/10 [00:20<00:31,  5.22s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0348, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8606, 'compress@10': 0.3397, 'time@10': 8.1768}:  40%|████      | 4/10 [00:27<00:31,  5.22s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0348, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8606, 'compress@10': 0.3397, 'time@10': 8.1768}:  50%|█████     | 5/10 [00:27<00:29,  5.80s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0347, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8642, 'compress@10': 0.3357, 'time@10': 8.542}:  50%|█████     | 5/10 [00:37<00:29,  5.80s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0347, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8642, 'compress@10': 0.3357, 'time@10': 8.542}:  60%|██████    | 6/10 [00:37<00:29,  7.37s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8704, 'compress@10': 0.3346, 'time@10': 8.9267}:  60%|██████    | 6/10 [00:43<00:29,  7.37s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8704, 'compress@10': 0.3346, 'time@10': 8.9267}:  70%|███████   | 7/10 [00:43<00:20,  6.81s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0336, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8727, 'compress@10': 0.3328, 'time@10': 8.7912}:  70%|███████   | 7/10 [00:51<00:20,  6.81s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0336, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8727, 'compress@10': 0.3328, 'time@10': 8.7912}:  80%|████████  | 8/10 [00:51<00:14,  7.15s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0343, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.8914, 'compress@10': 0.3313, 'time@10': 9.3711}:  80%|████████  | 8/10 [00:58<00:14,  7.15s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0343, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.8914, 'compress@10': 0.3313, 'time@10': 9.3711}:  90%|█████████ | 9/10 [00:58<00:07,  7.12s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.034, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.892, 'compress@10': 0.3298, 'time@10': 9.4313}:  90%|█████████ | 9/10 [01:08<00:07,  7.12s/it]     {'epoch': 14, 'num_users': 6.3, 'loss': 0.034, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.892, 'compress@10': 0.3298, 'time@10': 9.4313}: 100%|██████████| 10/10 [01:08<00:00,  8.01s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.034, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.892, 'compress@10': 0.3298, 'time@10': 9.4313}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.03400530989701892
Avg hit ratio: 0.8803448650952896
Avg ndcg: 0.8919831431801711
Avg compression ratio: 0.329793463344071
Avg train time: 9.431312465667725
Std train time: 2.792725344869296
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8608, 'compress@10': 0.3368, 'time@10': 8.6427}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8608, 'compress@10': 0.3368, 'time@10': 8.6427}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8785, 'compress@10': 0.3297, 'time@10': 8.003}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it] {'epoch': 15, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8785, 'compress@10': 0.3297, 'time@10': 8.003}:  20%|██        | 2/10 [00:11<00:49,  6.15s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8714, 'compress@10': 0.3531, 'time@10': 7.2555}:  20%|██        | 2/10 [00:14<00:49,  6.15s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8714, 'compress@10': 0.3531, 'time@10': 7.2555}:  30%|███       | 3/10 [00:14<00:32,  4.67s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8754, 'compress@10': 0.3461, 'time@10': 7.0244}:  30%|███       | 3/10 [00:21<00:32,  4.67s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8754, 'compress@10': 0.3461, 'time@10': 7.0244}:  40%|████      | 4/10 [00:21<00:32,  5.34s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.033, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8615, 'compress@10': 0.3397, 'time@10': 8.3659}:  40%|████      | 4/10 [00:27<00:32,  5.34s/it] {'epoch': 15, 'num_users': 5.8, 'loss': 0.033, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8615, 'compress@10': 0.3397, 'time@10': 8.3659}:  50%|█████     | 5/10 [00:27<00:29,  5.91s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8654, 'compress@10': 0.3357, 'time@10': 8.6394}:  50%|█████     | 5/10 [00:37<00:29,  5.91s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8654, 'compress@10': 0.3357, 'time@10': 8.6394}:  60%|██████    | 6/10 [00:37<00:29,  7.31s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0319, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8679, 'compress@10': 0.3346, 'time@10': 9.0607}:  60%|██████    | 6/10 [00:43<00:29,  7.31s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0319, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8679, 'compress@10': 0.3346, 'time@10': 9.0607}:  70%|███████   | 7/10 [00:43<00:20,  6.83s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0304, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8733, 'compress@10': 0.3328, 'time@10': 8.9125}:  70%|███████   | 7/10 [00:51<00:20,  6.83s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0304, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8733, 'compress@10': 0.3328, 'time@10': 8.9125}:  80%|████████  | 8/10 [00:51<00:14,  7.17s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8815, 'compress@10': 0.3313, 'time@10': 9.4834}:  80%|████████  | 8/10 [00:58<00:14,  7.17s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8815, 'compress@10': 0.3313, 'time@10': 9.4834}:  90%|█████████ | 9/10 [00:58<00:07,  7.14s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.8865, 'compress@10': 0.3298, 'time@10': 9.5318}:  90%|█████████ | 9/10 [01:08<00:07,  7.14s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.8865, 'compress@10': 0.3298, 'time@10': 9.5318}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.8865, 'compress@10': 0.3298, 'time@10': 9.5318}: 100%|██████████| 10/10 [01:08<00:00,  6.88s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.029739968048222775
Avg hit ratio: 0.8860591508095753
Avg ndcg: 0.8864769304507298
Avg compression ratio: 0.32979344201616556
Avg train time: 9.531777906417847
Std train time: 2.745978824669336
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0398, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8767, 'compress@10': 0.3368, 'time@10': 8.3923}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0398, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8767, 'compress@10': 0.3368, 'time@10': 8.3923}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8868, 'compress@10': 0.3297, 'time@10': 7.7227}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8868, 'compress@10': 0.3297, 'time@10': 7.7227}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8769, 'compress@10': 0.3531, 'time@10': 6.9512}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8769, 'compress@10': 0.3531, 'time@10': 6.9512}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8797, 'compress@10': 0.3461, 'time@10': 6.8252}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8797, 'compress@10': 0.3461, 'time@10': 6.8252}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0319, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8672, 'compress@10': 0.3397, 'time@10': 8.3036}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0319, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8672, 'compress@10': 0.3397, 'time@10': 8.3036}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8707, 'compress@10': 0.3357, 'time@10': 8.6078}:  50%|█████     | 5/10 [00:37<00:29,  5.94s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8707, 'compress@10': 0.3357, 'time@10': 8.6078}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.032, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8772, 'compress@10': 0.3346, 'time@10': 8.9681}:  60%|██████    | 6/10 [00:43<00:29,  7.38s/it] {'epoch': 16, 'num_users': 6.2857, 'loss': 0.032, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8772, 'compress@10': 0.3346, 'time@10': 8.9681}:  70%|███████   | 7/10 [00:43<00:20,  6.80s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0303, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.8825, 'compress@10': 0.3328, 'time@10': 8.8353}:  70%|███████   | 7/10 [00:51<00:20,  6.80s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0303, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.8825, 'compress@10': 0.3328, 'time@10': 8.8353}:  80%|████████  | 8/10 [00:51<00:14,  7.16s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0299, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8887, 'compress@10': 0.3313, 'time@10': 9.4321}:  80%|████████  | 8/10 [00:58<00:14,  7.16s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0299, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8887, 'compress@10': 0.3313, 'time@10': 9.4321}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8913, 'compress@10': 0.3298, 'time@10': 9.4805}:  90%|█████████ | 9/10 [01:08<00:07,  7.16s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8913, 'compress@10': 0.3298, 'time@10': 9.4805}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8913, 'compress@10': 0.3298, 'time@10': 9.4805}: 100%|██████████| 10/10 [01:08<00:00,  6.85s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.029749003038975146
Avg hit ratio: 0.8746305793810037
Avg ndcg: 0.8912965090514492
Avg compression ratio: 0.3297934765070233
Avg train time: 9.48048837184906
Std train time: 2.888665098357595
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8715, 'compress@10': 0.3368, 'time@10': 8.3902}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8715, 'compress@10': 0.3368, 'time@10': 8.3902}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0335, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8897, 'compress@10': 0.3297, 'time@10': 7.6905}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0335, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8897, 'compress@10': 0.3297, 'time@10': 7.6905}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8788, 'compress@10': 0.3531, 'time@10': 6.9663}:  20%|██        | 2/10 [00:14<00:47,  5.88s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8788, 'compress@10': 0.3531, 'time@10': 6.9663}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.884, 'compress@10': 0.3461, 'time@10': 6.7936}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.884, 'compress@10': 0.3461, 'time@10': 6.7936}:  40%|████      | 4/10 [00:20<00:31,  5.20s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8728, 'compress@10': 0.3397, 'time@10': 8.1715}:  40%|████      | 4/10 [00:27<00:31,  5.20s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8728, 'compress@10': 0.3397, 'time@10': 8.1715}:  50%|█████     | 5/10 [00:27<00:29,  5.80s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0312, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8796, 'compress@10': 0.3357, 'time@10': 8.5497}:  50%|█████     | 5/10 [00:37<00:29,  5.80s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0312, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8796, 'compress@10': 0.3357, 'time@10': 8.5497}:  60%|██████    | 6/10 [00:37<00:29,  7.39s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8818, 'compress@10': 0.3346, 'time@10': 8.9354}:  60%|██████    | 6/10 [00:43<00:29,  7.39s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8818, 'compress@10': 0.3346, 'time@10': 8.9354}:  70%|███████   | 7/10 [00:43<00:20,  6.83s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0297, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.8866, 'compress@10': 0.3328, 'time@10': 8.8039}:  70%|███████   | 7/10 [00:51<00:20,  6.83s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0297, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.8866, 'compress@10': 0.3328, 'time@10': 8.8039}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0287, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.893, 'compress@10': 0.3313, 'time@10': 9.4003}:  80%|████████  | 8/10 [00:58<00:14,  7.18s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0287, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.893, 'compress@10': 0.3313, 'time@10': 9.4003}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.8981, 'compress@10': 0.3298, 'time@10': 9.454}:  90%|█████████ | 9/10 [01:08<00:07,  7.16s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.8981, 'compress@10': 0.3298, 'time@10': 9.454}: 100%|██████████| 10/10 [01:08<00:00,  8.03s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.8981, 'compress@10': 0.3298, 'time@10': 9.454}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.027470941083741797
Avg hit ratio: 0.879709944460369
Avg ndcg: 0.8981061157221621
Avg compression ratio: 0.3297934658578538
Avg train time: 9.453985357284546
Std train time: 2.8254088533314476
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0368, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8819, 'compress@10': 0.3368, 'time@10': 8.4387}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0368, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8819, 'compress@10': 0.3368, 'time@10': 8.4387}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8963, 'compress@10': 0.3297, 'time@10': 7.7053}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8963, 'compress@10': 0.3297, 'time@10': 7.7053}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8832, 'compress@10': 0.3531, 'time@10': 6.9869}:  20%|██        | 2/10 [00:14<00:47,  5.88s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8832, 'compress@10': 0.3531, 'time@10': 6.9869}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8886, 'compress@10': 0.3461, 'time@10': 6.8128}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8886, 'compress@10': 0.3461, 'time@10': 6.8128}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0286, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8772, 'compress@10': 0.3397, 'time@10': 8.2287}:  40%|████      | 4/10 [00:27<00:31,  5.21s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0286, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8772, 'compress@10': 0.3397, 'time@10': 8.2287}:  50%|█████     | 5/10 [00:27<00:29,  5.85s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0278, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8841, 'compress@10': 0.3357, 'time@10': 8.5745}:  50%|█████     | 5/10 [00:37<00:29,  5.85s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0278, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8841, 'compress@10': 0.3357, 'time@10': 8.5745}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8876, 'compress@10': 0.3346, 'time@10': 8.9481}:  60%|██████    | 6/10 [00:43<00:29,  7.38s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8876, 'compress@10': 0.3346, 'time@10': 8.9481}:  70%|███████   | 7/10 [00:43<00:20,  6.81s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8919, 'compress@10': 0.3328, 'time@10': 8.8018}:  70%|███████   | 7/10 [00:51<00:20,  6.81s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8919, 'compress@10': 0.3328, 'time@10': 8.8018}:  80%|████████  | 8/10 [00:51<00:14,  7.13s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0263, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.898, 'compress@10': 0.3313, 'time@10': 9.4434}:  80%|████████  | 8/10 [00:58<00:14,  7.13s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0263, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.898, 'compress@10': 0.3313, 'time@10': 9.4434}:  90%|█████████ | 9/10 [00:58<00:07,  7.19s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0263, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.902, 'compress@10': 0.3298, 'time@10': 9.5054}:  90%|█████████ | 9/10 [01:08<00:07,  7.19s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0263, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.902, 'compress@10': 0.3298, 'time@10': 9.5054}: 100%|██████████| 10/10 [01:08<00:00,  8.09s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0263, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.902, 'compress@10': 0.3298, 'time@10': 9.5054}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.0262582985554626
Avg hit ratio: 0.8911385158889404
Avg ndcg: 0.9020315624032615
Avg compression ratio: 0.3297934859857724
Avg train time: 9.505414032936097
Std train time: 2.919898445250159
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8819, 'compress@10': 0.3368, 'time@10': 8.4065}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8819, 'compress@10': 0.3368, 'time@10': 8.4065}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9032, 'compress@10': 0.3297, 'time@10': 7.6969}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]  {'epoch': 19, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9032, 'compress@10': 0.3297, 'time@10': 7.6969}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8879, 'compress@10': 0.3531, 'time@10': 6.9756}:  20%|██        | 2/10 [00:14<00:47,  5.88s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8879, 'compress@10': 0.3531, 'time@10': 6.9756}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8921, 'compress@10': 0.3461, 'time@10': 6.8322}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8921, 'compress@10': 0.3461, 'time@10': 6.8322}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0272, 'hit_ratio@10': 0.878, 'ndcg@10': 0.8829, 'compress@10': 0.3397, 'time@10': 8.2852}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it] {'epoch': 19, 'num_users': 5.8, 'loss': 0.0272, 'hit_ratio@10': 0.878, 'ndcg@10': 0.8829, 'compress@10': 0.3397, 'time@10': 8.2852}:  50%|█████     | 5/10 [00:27<00:29,  5.91s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0269, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.8891, 'compress@10': 0.3357, 'time@10': 8.6201}:  50%|█████     | 5/10 [00:37<00:29,  5.91s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0269, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.8891, 'compress@10': 0.3357, 'time@10': 8.6201}:  60%|██████    | 6/10 [00:37<00:29,  7.42s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0273, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.8911, 'compress@10': 0.3346, 'time@10': 9.0143}:  60%|██████    | 6/10 [00:43<00:29,  7.42s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0273, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.8911, 'compress@10': 0.3346, 'time@10': 9.0143}:  70%|███████   | 7/10 [00:43<00:20,  6.86s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0262, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.8968, 'compress@10': 0.3328, 'time@10': 8.8825}:  70%|███████   | 7/10 [00:51<00:20,  6.86s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0262, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.8968, 'compress@10': 0.3328, 'time@10': 8.8825}:  80%|████████  | 8/10 [00:51<00:14,  7.22s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9122, 'compress@10': 0.3313, 'time@10': 9.4601}:  80%|████████  | 8/10 [00:58<00:14,  7.22s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9122, 'compress@10': 0.3313, 'time@10': 9.4601}:  90%|█████████ | 9/10 [00:58<00:07,  7.18s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.916, 'compress@10': 0.3298, 'time@10': 9.5196}:  90%|█████████ | 9/10 [01:08<00:07,  7.18s/it]    {'epoch': 19, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.916, 'compress@10': 0.3298, 'time@10': 9.5196}: 100%|██████████| 10/10 [01:08<00:00,  8.08s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0255, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.916, 'compress@10': 0.3298, 'time@10': 9.5196}: 100%|██████████| 10/10 [01:08<00:00,  6.88s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.02550353547095179
Avg hit ratio: 0.9054242301746547
Avg ndcg: 0.9160068093031152
Avg compression ratio: 0.32979347235142514
Avg train time: 9.519636154174805
Std train time: 2.8601806265353997
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0335, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8819, 'compress@10': 0.3368, 'time@10': 8.1716}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0335, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8819, 'compress@10': 0.3368, 'time@10': 8.1716}:  10%|█         | 1/10 [00:04<00:37,  4.12s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9062, 'compress@10': 0.3297, 'time@10': 7.5889}:  10%|█         | 1/10 [00:11<00:37,  4.12s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9062, 'compress@10': 0.3297, 'time@10': 7.5889}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8898, 'compress@10': 0.3531, 'time@10': 6.8607}:  20%|██        | 2/10 [00:13<00:46,  5.84s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8898, 'compress@10': 0.3531, 'time@10': 6.8607}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8966, 'compress@10': 0.3461, 'time@10': 6.7423}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8966, 'compress@10': 0.3461, 'time@10': 6.7423}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.878, 'ndcg@10': 0.8876, 'compress@10': 0.3397, 'time@10': 8.1653}:  40%|████      | 4/10 [00:27<00:31,  5.21s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.878, 'ndcg@10': 0.8876, 'compress@10': 0.3397, 'time@10': 8.1653}:  50%|█████     | 5/10 [00:27<00:29,  5.85s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0265, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.896, 'compress@10': 0.3357, 'time@10': 8.5244}:  50%|█████     | 5/10 [00:37<00:29,  5.85s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0265, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.896, 'compress@10': 0.3357, 'time@10': 8.5244}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0268, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.8944, 'compress@10': 0.3346, 'time@10': 8.9234}:  60%|██████    | 6/10 [00:43<00:29,  7.38s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0268, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.8944, 'compress@10': 0.3346, 'time@10': 8.9234}:  70%|███████   | 7/10 [00:43<00:20,  6.83s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0264, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.8956, 'compress@10': 0.3328, 'time@10': 8.7997}:  70%|███████   | 7/10 [00:51<00:20,  6.83s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0264, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.8956, 'compress@10': 0.3328, 'time@10': 8.7997}:  80%|████████  | 8/10 [00:51<00:14,  7.20s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0285, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9188, 'compress@10': 0.3313, 'time@10': 9.4147}:  80%|████████  | 8/10 [00:58<00:14,  7.20s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0285, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9188, 'compress@10': 0.3313, 'time@10': 9.4147}:  90%|█████████ | 9/10 [00:58<00:07,  7.20s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9227, 'compress@10': 0.3298, 'time@10': 9.4648}:  90%|█████████ | 9/10 [01:08<00:07,  7.20s/it]    {'epoch': 20, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9227, 'compress@10': 0.3298, 'time@10': 9.4648}: 100%|██████████| 10/10 [01:08<00:00,  8.05s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9227, 'compress@10': 0.3298, 'time@10': 9.4648}: 100%|██████████| 10/10 [01:08<00:00,  6.85s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.028028664337589753
Avg hit ratio: 0.9054242301746547
Avg ndcg: 0.9227253553026253
Avg compression ratio: 0.32979339634925015
Avg train time: 9.464774250984192
Std train time: 2.88801845188901
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8849, 'compress@10': 0.3368, 'time@10': 8.6785}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8849, 'compress@10': 0.3368, 'time@10': 8.6785}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9077, 'compress@10': 0.3297, 'time@10': 7.919}:  10%|█         | 1/10 [00:11<00:39,  4.38s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9077, 'compress@10': 0.3297, 'time@10': 7.919}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8908, 'compress@10': 0.3531, 'time@10': 7.1438}:  20%|██        | 2/10 [00:14<00:48,  6.04s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8908, 'compress@10': 0.3531, 'time@10': 7.1438}:  30%|███       | 3/10 [00:14<00:32,  4.57s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8974, 'compress@10': 0.3461, 'time@10': 6.946}:  30%|███       | 3/10 [00:20<00:32,  4.57s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8974, 'compress@10': 0.3461, 'time@10': 6.946}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8904, 'compress@10': 0.3397, 'time@10': 8.3223}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8904, 'compress@10': 0.3397, 'time@10': 8.3223}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.023, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8977, 'compress@10': 0.3357, 'time@10': 8.6464}:  50%|█████     | 5/10 [00:38<00:29,  5.89s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.023, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8977, 'compress@10': 0.3357, 'time@10': 8.6464}:  60%|██████    | 6/10 [00:38<00:29,  7.39s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0223, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.902, 'compress@10': 0.3346, 'time@10': 9.0337}:  60%|██████    | 6/10 [00:43<00:29,  7.39s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0223, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.902, 'compress@10': 0.3346, 'time@10': 9.0337}:  70%|███████   | 7/10 [00:43<00:20,  6.84s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0222, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9029, 'compress@10': 0.3328, 'time@10': 8.9288}:  70%|███████   | 7/10 [00:52<00:20,  6.84s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0222, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9029, 'compress@10': 0.3328, 'time@10': 8.9288}:  80%|████████  | 8/10 [00:52<00:14,  7.29s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0242, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9042, 'compress@10': 0.3313, 'time@10': 9.5059}:  80%|████████  | 8/10 [00:59<00:14,  7.29s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0242, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9042, 'compress@10': 0.3313, 'time@10': 9.5059}:  90%|█████████ | 9/10 [00:59<00:07,  7.23s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9091, 'compress@10': 0.3298, 'time@10': 9.5502}:  90%|█████████ | 9/10 [01:09<00:07,  7.23s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9091, 'compress@10': 0.3298, 'time@10': 9.5502}: 100%|██████████| 10/10 [01:09<00:00,  8.08s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9091, 'compress@10': 0.3298, 'time@10': 9.5502}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.02348005239092573
Avg hit ratio: 0.8932813730317974
Avg ndcg: 0.9091396081152237
Avg compression ratio: 0.32979345030188256
Avg train time: 9.550195980072022
Std train time: 2.7810246763207225
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8821, 'compress@10': 0.3368, 'time@10': 8.4536}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8821, 'compress@10': 0.3368, 'time@10': 8.4536}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0297, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.907, 'compress@10': 0.3297, 'time@10': 7.7827}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it] {'epoch': 22, 'num_users': 7.0, 'loss': 0.0297, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.907, 'compress@10': 0.3297, 'time@10': 7.7827}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8904, 'compress@10': 0.3531, 'time@10': 7.0203}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8904, 'compress@10': 0.3531, 'time@10': 7.0203}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8936, 'compress@10': 0.3461, 'time@10': 6.8903}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8936, 'compress@10': 0.3461, 'time@10': 6.8903}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0254, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8888, 'compress@10': 0.3397, 'time@10': 8.3259}:  40%|████      | 4/10 [00:27<00:31,  5.31s/it]  {'epoch': 22, 'num_users': 5.8, 'loss': 0.0254, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8888, 'compress@10': 0.3397, 'time@10': 8.3259}:  50%|█████     | 5/10 [00:27<00:29,  5.95s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0246, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.8975, 'compress@10': 0.3357, 'time@10': 8.6388}:  50%|█████     | 5/10 [00:38<00:29,  5.95s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0246, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.8975, 'compress@10': 0.3357, 'time@10': 8.6388}:  60%|██████    | 6/10 [00:38<00:29,  7.41s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0254, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.8987, 'compress@10': 0.3346, 'time@10': 8.9957}:  60%|██████    | 6/10 [00:43<00:29,  7.41s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0254, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.8987, 'compress@10': 0.3346, 'time@10': 8.9957}:  70%|███████   | 7/10 [00:43<00:20,  6.82s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.024, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9047, 'compress@10': 0.3328, 'time@10': 8.8655}:  70%|███████   | 7/10 [00:51<00:20,  6.82s/it]  {'epoch': 22, 'num_users': 6.125, 'loss': 0.024, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9047, 'compress@10': 0.3328, 'time@10': 8.8655}:  80%|████████  | 8/10 [00:51<00:14,  7.19s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.023, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9084, 'compress@10': 0.3313, 'time@10': 9.4515}:  80%|████████  | 8/10 [00:58<00:14,  7.19s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.023, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9084, 'compress@10': 0.3313, 'time@10': 9.4515}:  90%|█████████ | 9/10 [00:58<00:07,  7.17s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9144, 'compress@10': 0.3298, 'time@10': 9.5221}:  90%|█████████ | 9/10 [01:08<00:07,  7.17s/it]  {'epoch': 22, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9144, 'compress@10': 0.3298, 'time@10': 9.5221}: 100%|██████████| 10/10 [01:08<00:00,  8.10s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9144, 'compress@10': 0.3298, 'time@10': 9.5221}: 100%|██████████| 10/10 [01:08<00:00,  6.90s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.02236564072764018
Avg hit ratio: 0.8900524674344709
Avg ndcg: 0.9144127451290546
Avg compression ratio: 0.32979347008124693
Avg train time: 9.522068738937378
Std train time: 2.8323885796933292
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8894, 'compress@10': 0.3368, 'time@10': 8.451}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8894, 'compress@10': 0.3368, 'time@10': 8.451}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9169, 'compress@10': 0.3297, 'time@10': 7.744}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9169, 'compress@10': 0.3297, 'time@10': 7.744}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.897, 'compress@10': 0.3531, 'time@10': 6.952}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.897, 'compress@10': 0.3531, 'time@10': 6.952}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9055, 'compress@10': 0.3461, 'time@10': 6.8044}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9055, 'compress@10': 0.3461, 'time@10': 6.8044}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0213, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8986, 'compress@10': 0.3397, 'time@10': 8.1653}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0213, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8986, 'compress@10': 0.3397, 'time@10': 8.1653}:  50%|█████     | 5/10 [00:27<00:29,  5.81s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0225, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9084, 'compress@10': 0.3357, 'time@10': 8.5704}:  50%|█████     | 5/10 [00:37<00:29,  5.81s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0225, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9084, 'compress@10': 0.3357, 'time@10': 8.5704}:  60%|██████    | 6/10 [00:37<00:29,  7.45s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0228, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9071, 'compress@10': 0.3346, 'time@10': 8.9277}:  60%|██████    | 6/10 [00:43<00:29,  7.45s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0228, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9071, 'compress@10': 0.3346, 'time@10': 8.9277}:  70%|███████   | 7/10 [00:43<00:20,  6.84s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0218, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.912, 'compress@10': 0.3328, 'time@10': 8.8007}:  70%|███████   | 7/10 [00:51<00:20,  6.84s/it]  {'epoch': 23, 'num_users': 6.125, 'loss': 0.0218, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.912, 'compress@10': 0.3328, 'time@10': 8.8007}:  80%|████████  | 8/10 [00:51<00:14,  7.19s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9174, 'compress@10': 0.3313, 'time@10': 9.3765}:  80%|████████  | 8/10 [00:58<00:14,  7.19s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9174, 'compress@10': 0.3313, 'time@10': 9.3765}:  90%|█████████ | 9/10 [00:58<00:07,  7.14s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9192, 'compress@10': 0.3298, 'time@10': 9.4386}:  90%|█████████ | 9/10 [01:08<00:07,  7.14s/it]    {'epoch': 23, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9192, 'compress@10': 0.3298, 'time@10': 9.4386}: 100%|██████████| 10/10 [01:08<00:00,  8.03s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9192, 'compress@10': 0.3298, 'time@10': 9.4386}: 100%|██████████| 10/10 [01:08<00:00,  6.85s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.02202932933774059
Avg hit ratio: 0.8993921044056868
Avg ndcg: 0.9192199697438671
Avg compression ratio: 0.32979346021308975
Avg train time: 9.438571310043335
Std train time: 2.78347988148735
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8894, 'compress@10': 0.3368, 'time@10': 8.9059}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8894, 'compress@10': 0.3368, 'time@10': 8.9059}:  10%|█         | 1/10 [00:04<00:40,  4.49s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.918, 'compress@10': 0.3297, 'time@10': 7.9384}:  10%|█         | 1/10 [00:11<00:40,  4.49s/it] {'epoch': 24, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.918, 'compress@10': 0.3297, 'time@10': 7.9384}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8977, 'compress@10': 0.3531, 'time@10': 7.0861}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8977, 'compress@10': 0.3531, 'time@10': 7.0861}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9063, 'compress@10': 0.3461, 'time@10': 6.8893}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9063, 'compress@10': 0.3461, 'time@10': 6.8893}:  40%|████      | 4/10 [00:20<00:31,  5.22s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0198, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8991, 'compress@10': 0.3397, 'time@10': 8.2634}:  40%|████      | 4/10 [00:27<00:31,  5.22s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0198, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8991, 'compress@10': 0.3397, 'time@10': 8.2634}:  50%|█████     | 5/10 [00:27<00:29,  5.83s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9082, 'compress@10': 0.3357, 'time@10': 8.606}:  50%|█████     | 5/10 [00:37<00:29,  5.83s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9082, 'compress@10': 0.3357, 'time@10': 8.606}:  60%|██████    | 6/10 [00:37<00:29,  7.37s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9131, 'compress@10': 0.3346, 'time@10': 8.9545}:  60%|██████    | 6/10 [00:43<00:29,  7.37s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9131, 'compress@10': 0.3346, 'time@10': 8.9545}:  70%|███████   | 7/10 [00:43<00:20,  6.78s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9138, 'compress@10': 0.3328, 'time@10': 8.822}:  70%|███████   | 7/10 [00:51<00:20,  6.78s/it]  {'epoch': 24, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9138, 'compress@10': 0.3328, 'time@10': 8.822}:  80%|████████  | 8/10 [00:51<00:14,  7.15s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9281, 'compress@10': 0.3313, 'time@10': 9.4204}:  80%|████████  | 8/10 [00:58<00:14,  7.15s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9281, 'compress@10': 0.3313, 'time@10': 9.4204}:  90%|█████████ | 9/10 [00:58<00:07,  7.15s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.901, 'ndcg@10': 0.932, 'compress@10': 0.3298, 'time@10': 9.4756}:  90%|█████████ | 9/10 [01:08<00:07,  7.15s/it]     {'epoch': 24, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.901, 'ndcg@10': 0.932, 'compress@10': 0.3298, 'time@10': 9.4756}: 100%|██████████| 10/10 [01:08<00:00,  8.03s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.901, 'ndcg@10': 0.932, 'compress@10': 0.3298, 'time@10': 9.4756}: 100%|██████████| 10/10 [01:08<00:00,  6.85s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.018508661576149867
Avg hit ratio: 0.9010299110434934
Avg ndcg: 0.9319526594809083
Avg compression ratio: 0.32979345476788474
Avg train time: 9.475572419166564
Std train time: 2.8305506419302895
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0281, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8954, 'compress@10': 0.3368, 'time@10': 8.6993}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0281, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8954, 'compress@10': 0.3368, 'time@10': 8.6993}:  10%|█         | 1/10 [00:04<00:39,  4.39s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9204, 'compress@10': 0.3297, 'time@10': 7.9196}:  10%|█         | 1/10 [00:11<00:39,  4.39s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9204, 'compress@10': 0.3297, 'time@10': 7.9196}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8993, 'compress@10': 0.3531, 'time@10': 7.0828}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8993, 'compress@10': 0.3531, 'time@10': 7.0828}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9092, 'compress@10': 0.3461, 'time@10': 6.8886}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9092, 'compress@10': 0.3461, 'time@10': 6.8886}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9025, 'compress@10': 0.3397, 'time@10': 8.3016}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9025, 'compress@10': 0.3397, 'time@10': 8.3016}:  50%|█████     | 5/10 [00:27<00:29,  5.88s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0189, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9113, 'compress@10': 0.3357, 'time@10': 8.6331}:  50%|█████     | 5/10 [00:37<00:29,  5.88s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0189, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9113, 'compress@10': 0.3357, 'time@10': 8.6331}:  60%|██████    | 6/10 [00:37<00:29,  7.39s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0202, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9095, 'compress@10': 0.3346, 'time@10': 9.006}:  60%|██████    | 6/10 [00:43<00:29,  7.39s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.0202, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9095, 'compress@10': 0.3346, 'time@10': 9.006}:  70%|███████   | 7/10 [00:43<00:20,  6.83s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0201, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.91, 'compress@10': 0.3328, 'time@10': 8.8742}:  70%|███████   | 7/10 [00:51<00:20,  6.83s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.0201, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.91, 'compress@10': 0.3328, 'time@10': 8.8742}:  80%|████████  | 8/10 [00:51<00:14,  7.20s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.918, 'compress@10': 0.3313, 'time@10': 9.4518}:  80%|████████  | 8/10 [00:58<00:14,  7.20s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.918, 'compress@10': 0.3313, 'time@10': 9.4518}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0231, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9201, 'compress@10': 0.3298, 'time@10': 9.5217}:  90%|█████████ | 9/10 [01:08<00:07,  7.16s/it] {'epoch': 25, 'num_users': 6.3, 'loss': 0.0231, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9201, 'compress@10': 0.3298, 'time@10': 9.5217}: 100%|██████████| 10/10 [01:08<00:00,  8.10s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0231, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9201, 'compress@10': 0.3298, 'time@10': 9.5217}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.023121977227334833
Avg hit ratio: 0.891744196757779
Avg ndcg: 0.9200688007129815
Avg compression ratio: 0.3297934345334391
Avg train time: 9.52165629863739
Std train time: 2.8349060631535146
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8993, 'compress@10': 0.3368, 'time@10': 8.4369}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8993, 'compress@10': 0.3368, 'time@10': 8.4369}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9197, 'compress@10': 0.3297, 'time@10': 7.7674}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9197, 'compress@10': 0.3297, 'time@10': 7.7674}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8989, 'compress@10': 0.3531, 'time@10': 6.9896}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8989, 'compress@10': 0.3531, 'time@10': 6.9896}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9095, 'compress@10': 0.3461, 'time@10': 6.8024}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9095, 'compress@10': 0.3461, 'time@10': 6.8024}:  40%|████      | 4/10 [00:20<00:31,  5.20s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9038, 'compress@10': 0.3397, 'time@10': 8.167}:  40%|████      | 4/10 [00:27<00:31,  5.20s/it] {'epoch': 26, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9038, 'compress@10': 0.3397, 'time@10': 8.167}:  50%|█████     | 5/10 [00:27<00:28,  5.79s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0209, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9151, 'compress@10': 0.3357, 'time@10': 8.5521}:  50%|█████     | 5/10 [00:37<00:28,  5.79s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0209, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9151, 'compress@10': 0.3357, 'time@10': 8.5521}:  60%|██████    | 6/10 [00:37<00:29,  7.40s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0202, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9171, 'compress@10': 0.3346, 'time@10': 8.937}:  60%|██████    | 6/10 [00:43<00:29,  7.40s/it] {'epoch': 26, 'num_users': 6.2857, 'loss': 0.0202, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9171, 'compress@10': 0.3346, 'time@10': 8.937}:  70%|███████   | 7/10 [00:43<00:20,  6.83s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9205, 'compress@10': 0.3328, 'time@10': 8.8008}:  70%|███████   | 7/10 [00:51<00:20,  6.83s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9205, 'compress@10': 0.3328, 'time@10': 8.8008}:  80%|████████  | 8/10 [00:51<00:14,  7.17s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0197, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9219, 'compress@10': 0.3313, 'time@10': 9.3673}:  80%|████████  | 8/10 [00:58<00:14,  7.17s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0197, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9219, 'compress@10': 0.3313, 'time@10': 9.3673}:  90%|█████████ | 9/10 [00:58<00:07,  7.11s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9265, 'compress@10': 0.3298, 'time@10': 9.4222}:  90%|█████████ | 9/10 [01:08<00:07,  7.11s/it]    {'epoch': 26, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9265, 'compress@10': 0.3298, 'time@10': 9.4222}: 100%|██████████| 10/10 [01:08<00:00,  7.99s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9265, 'compress@10': 0.3298, 'time@10': 9.4222}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.018923988930435617
Avg hit ratio: 0.9010299110434934
Avg ndcg: 0.9264741148125311
Avg compression ratio: 0.32979344010782785
Avg train time: 9.42218906879425
Std train time: 2.7800099943841285
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8955, 'compress@10': 0.3368, 'time@10': 8.3198}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8955, 'compress@10': 0.3368, 'time@10': 8.3198}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9273, 'compress@10': 0.3297, 'time@10': 7.6981}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9273, 'compress@10': 0.3297, 'time@10': 7.6981}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9039, 'compress@10': 0.3531, 'time@10': 6.941}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9039, 'compress@10': 0.3531, 'time@10': 6.941}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9153, 'compress@10': 0.3461, 'time@10': 6.7571}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9153, 'compress@10': 0.3461, 'time@10': 6.7571}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9108, 'compress@10': 0.3397, 'time@10': 8.1952}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it] {'epoch': 27, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9108, 'compress@10': 0.3397, 'time@10': 8.1952}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9192, 'compress@10': 0.3357, 'time@10': 8.5455}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9192, 'compress@10': 0.3357, 'time@10': 8.5455}:  60%|██████    | 6/10 [00:37<00:29,  7.37s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9231, 'compress@10': 0.3346, 'time@10': 8.91}:  60%|██████    | 6/10 [00:43<00:29,  7.37s/it]  {'epoch': 27, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9231, 'compress@10': 0.3346, 'time@10': 8.91}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9264, 'compress@10': 0.3328, 'time@10': 8.7952}:  70%|███████   | 7/10 [00:51<00:20,  6.79s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9264, 'compress@10': 0.3328, 'time@10': 8.7952}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9313, 'compress@10': 0.3313, 'time@10': 9.3779}:  80%|████████  | 8/10 [00:58<00:14,  7.18s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9313, 'compress@10': 0.3313, 'time@10': 9.3779}:  90%|█████████ | 9/10 [00:58<00:07,  7.14s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9339, 'compress@10': 0.3298, 'time@10': 9.4371}:  90%|█████████ | 9/10 [01:08<00:07,  7.14s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9339, 'compress@10': 0.3298, 'time@10': 9.4371}: 100%|██████████| 10/10 [01:08<00:00,  8.04s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9339, 'compress@10': 0.3298, 'time@10': 9.4371}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.017947233474917796
Avg hit ratio: 0.8988076888212712
Avg ndcg: 0.9338516629982134
Avg compression ratio: 0.3297934058447708
Avg train time: 9.437082624435424
Std train time: 2.841358830263762
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8993, 'compress@10': 0.3368, 'time@10': 8.3855}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8993, 'compress@10': 0.3368, 'time@10': 8.3855}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9268, 'compress@10': 0.3297, 'time@10': 7.7782}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9268, 'compress@10': 0.3297, 'time@10': 7.7782}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9036, 'compress@10': 0.3531, 'time@10': 6.9861}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9036, 'compress@10': 0.3531, 'time@10': 6.9861}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9151, 'compress@10': 0.3461, 'time@10': 6.7819}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9151, 'compress@10': 0.3461, 'time@10': 6.7819}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9115, 'compress@10': 0.3397, 'time@10': 8.2021}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9115, 'compress@10': 0.3397, 'time@10': 8.2021}:  50%|█████     | 5/10 [00:27<00:29,  5.83s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9207, 'compress@10': 0.3357, 'time@10': 8.5257}:  50%|█████     | 5/10 [00:37<00:29,  5.83s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9207, 'compress@10': 0.3357, 'time@10': 8.5257}:  60%|██████    | 6/10 [00:37<00:29,  7.31s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.918, 'compress@10': 0.3346, 'time@10': 8.8782}:  60%|██████    | 6/10 [00:43<00:29,  7.31s/it] {'epoch': 28, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.918, 'compress@10': 0.3346, 'time@10': 8.8782}:  70%|███████   | 7/10 [00:43<00:20,  6.73s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9198, 'compress@10': 0.3328, 'time@10': 8.7433}:  70%|███████   | 7/10 [00:50<00:20,  6.73s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9198, 'compress@10': 0.3328, 'time@10': 8.7433}:  80%|████████  | 8/10 [00:50<00:14,  7.08s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9286, 'compress@10': 0.3313, 'time@10': 9.3192}:  80%|████████  | 8/10 [00:57<00:14,  7.08s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9286, 'compress@10': 0.3313, 'time@10': 9.3192}:  90%|█████████ | 9/10 [00:57<00:07,  7.06s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9329, 'compress@10': 0.3298, 'time@10': 9.3948}:  90%|█████████ | 9/10 [01:08<00:07,  7.06s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9329, 'compress@10': 0.3298, 'time@10': 9.3948}: 100%|██████████| 10/10 [01:08<00:00,  8.00s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9329, 'compress@10': 0.3298, 'time@10': 9.3948}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.017180828040567985
Avg hit ratio: 0.891744196757779
Avg ndcg: 0.9328789324163435
Avg compression ratio: 0.3297934438049329
Avg train time: 9.394841194152832
Std train time: 2.8126984410585654
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9103, 'compress@10': 0.3368, 'time@10': 8.37}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9103, 'compress@10': 0.3368, 'time@10': 8.37}:  10%|█         | 1/10 [00:04<00:38,  4.22s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.929, 'compress@10': 0.3297, 'time@10': 7.6459}:  10%|█         | 1/10 [00:11<00:38,  4.22s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.929, 'compress@10': 0.3297, 'time@10': 7.6459}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9051, 'compress@10': 0.3531, 'time@10': 6.919}:  20%|██        | 2/10 [00:14<00:46,  5.87s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9051, 'compress@10': 0.3531, 'time@10': 6.919}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9158, 'compress@10': 0.3461, 'time@10': 6.7494}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9158, 'compress@10': 0.3461, 'time@10': 6.7494}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0179, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9124, 'compress@10': 0.3397, 'time@10': 8.1631}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0179, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9124, 'compress@10': 0.3397, 'time@10': 8.1631}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0202, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9262, 'compress@10': 0.3357, 'time@10': 8.5812}:  50%|█████     | 5/10 [00:37<00:29,  5.82s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0202, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9262, 'compress@10': 0.3357, 'time@10': 8.5812}:  60%|██████    | 6/10 [00:37<00:29,  7.48s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0196, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9269, 'compress@10': 0.3346, 'time@10': 8.9588}:  60%|██████    | 6/10 [00:43<00:29,  7.48s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0196, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9269, 'compress@10': 0.3346, 'time@10': 8.9588}:  70%|███████   | 7/10 [00:43<00:20,  6.88s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9298, 'compress@10': 0.3328, 'time@10': 8.8031}:  70%|███████   | 7/10 [00:51<00:20,  6.88s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9298, 'compress@10': 0.3328, 'time@10': 8.8031}:  80%|████████  | 8/10 [00:51<00:14,  7.16s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9281, 'compress@10': 0.3313, 'time@10': 9.3931}:  80%|████████  | 8/10 [00:58<00:14,  7.16s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9281, 'compress@10': 0.3313, 'time@10': 9.3931}:  90%|█████████ | 9/10 [00:58<00:07,  7.14s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9335, 'compress@10': 0.3298, 'time@10': 9.4734}:  90%|█████████ | 9/10 [01:08<00:07,  7.14s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9335, 'compress@10': 0.3298, 'time@10': 9.4734}: 100%|██████████| 10/10 [01:08<00:00,  8.09s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9335, 'compress@10': 0.3298, 'time@10': 9.4734}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.019946774673387742
Avg hit ratio: 0.8933755331633091
Avg ndcg: 0.9334984938389743
Avg compression ratio: 0.32979343638920333
Avg train time: 9.473393535614013
Std train time: 2.8769229796752986
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9141, 'compress@10': 0.3368, 'time@10': 8.5999}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9141, 'compress@10': 0.3368, 'time@10': 8.5999}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9456, 'compress@10': 0.3297, 'time@10': 7.8966}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9456, 'compress@10': 0.3297, 'time@10': 7.8966}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9161, 'compress@10': 0.3531, 'time@10': 7.1114}:  20%|██        | 2/10 [00:14<00:48,  6.04s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9161, 'compress@10': 0.3531, 'time@10': 7.1114}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9257, 'compress@10': 0.3461, 'time@10': 6.8702}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9257, 'compress@10': 0.3461, 'time@10': 6.8702}:  40%|████      | 4/10 [00:20<00:31,  5.20s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9219, 'compress@10': 0.3397, 'time@10': 8.2572}:  40%|████      | 4/10 [00:27<00:31,  5.20s/it] {'epoch': 30, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9219, 'compress@10': 0.3397, 'time@10': 8.2572}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9292, 'compress@10': 0.3357, 'time@10': 8.5961}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9292, 'compress@10': 0.3357, 'time@10': 8.5961}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9316, 'compress@10': 0.3346, 'time@10': 8.9609}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it] {'epoch': 30, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9316, 'compress@10': 0.3346, 'time@10': 8.9609}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9332, 'compress@10': 0.3328, 'time@10': 8.828}:  70%|███████   | 7/10 [00:51<00:20,  6.79s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9332, 'compress@10': 0.3328, 'time@10': 8.828}:  80%|████████  | 8/10 [00:51<00:14,  7.16s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9374, 'compress@10': 0.3313, 'time@10': 9.4448}:  80%|████████  | 8/10 [00:58<00:14,  7.16s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9374, 'compress@10': 0.3313, 'time@10': 9.4448}:  90%|█████████ | 9/10 [00:58<00:07,  7.18s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9406, 'compress@10': 0.3298, 'time@10': 9.5081}:  90%|█████████ | 9/10 [01:08<00:07,  7.18s/it]    {'epoch': 30, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9406, 'compress@10': 0.3298, 'time@10': 9.5081}: 100%|██████████| 10/10 [01:08<00:00,  8.08s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9406, 'compress@10': 0.3298, 'time@10': 9.5081}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.015138937123377749
Avg hit ratio: 0.8940104537982296
Avg ndcg: 0.9406243350003377
Avg compression ratio: 0.3297934179071683
Avg train time: 9.508086919784546
Std train time: 2.857323673680737
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.3368, 'time@10': 8.4772}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.3368, 'time@10': 8.4772}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9394, 'compress@10': 0.3297, 'time@10': 7.7844}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9394, 'compress@10': 0.3297, 'time@10': 7.7844}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.912, 'compress@10': 0.3531, 'time@10': 7.0485}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.912, 'compress@10': 0.3531, 'time@10': 7.0485}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.923, 'compress@10': 0.3461, 'time@10': 6.8737}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.923, 'compress@10': 0.3461, 'time@10': 6.8737}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9212, 'compress@10': 0.3397, 'time@10': 8.2122}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9212, 'compress@10': 0.3397, 'time@10': 8.2122}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9296, 'compress@10': 0.3357, 'time@10': 8.5625}:  50%|█████     | 5/10 [00:37<00:29,  5.82s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9296, 'compress@10': 0.3357, 'time@10': 8.5625}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9286, 'compress@10': 0.3346, 'time@10': 8.9271}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9286, 'compress@10': 0.3346, 'time@10': 8.9271}:  70%|███████   | 7/10 [00:43<00:20,  6.78s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9324, 'compress@10': 0.3328, 'time@10': 8.7959}:  70%|███████   | 7/10 [00:51<00:20,  6.78s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9324, 'compress@10': 0.3328, 'time@10': 8.7959}:  80%|████████  | 8/10 [00:51<00:14,  7.14s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9397, 'compress@10': 0.3313, 'time@10': 9.4096}:  80%|████████  | 8/10 [00:58<00:14,  7.14s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9397, 'compress@10': 0.3313, 'time@10': 9.4096}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9433, 'compress@10': 0.3298, 'time@10': 9.4694}:  90%|█████████ | 9/10 [01:08<00:07,  7.16s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9433, 'compress@10': 0.3298, 'time@10': 9.4694}: 100%|██████████| 10/10 [01:08<00:00,  8.06s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9433, 'compress@10': 0.3298, 'time@10': 9.4694}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.015680471042391543
Avg hit ratio: 0.8996842889236776
Avg ndcg: 0.9432687791936617
Avg compression ratio: 0.32979343586177795
Avg train time: 9.469428038597107
Std train time: 2.7942458078501504
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.3368, 'time@10': 8.3836}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.3368, 'time@10': 8.3836}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9421, 'compress@10': 0.3297, 'time@10': 7.6816}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9421, 'compress@10': 0.3297, 'time@10': 7.6816}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9138, 'compress@10': 0.3531, 'time@10': 6.9795}:  20%|██        | 2/10 [00:14<00:47,  5.88s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9138, 'compress@10': 0.3531, 'time@10': 6.9795}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9254, 'compress@10': 0.3461, 'time@10': 6.7818}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9254, 'compress@10': 0.3461, 'time@10': 6.7818}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.9234, 'compress@10': 0.3397, 'time@10': 8.1412}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.9234, 'compress@10': 0.3397, 'time@10': 8.1412}:  50%|█████     | 5/10 [00:27<00:28,  5.77s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0182, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9346, 'compress@10': 0.3357, 'time@10': 8.5215}:  50%|█████     | 5/10 [00:37<00:28,  5.77s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0182, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9346, 'compress@10': 0.3357, 'time@10': 8.5215}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9343, 'compress@10': 0.3346, 'time@10': 8.8813}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it] {'epoch': 32, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9343, 'compress@10': 0.3346, 'time@10': 8.8813}:  70%|███████   | 7/10 [00:43<00:20,  6.80s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9379, 'compress@10': 0.3328, 'time@10': 8.7413}:  70%|███████   | 7/10 [00:51<00:20,  6.80s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9379, 'compress@10': 0.3328, 'time@10': 8.7413}:  80%|████████  | 8/10 [00:51<00:14,  7.12s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9377, 'compress@10': 0.3313, 'time@10': 9.3675}:  80%|████████  | 8/10 [00:58<00:14,  7.12s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9377, 'compress@10': 0.3313, 'time@10': 9.3675}:  90%|█████████ | 9/10 [00:58<00:07,  7.15s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9414, 'compress@10': 0.3298, 'time@10': 9.4258}:  90%|█████████ | 9/10 [01:08<00:07,  7.15s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9414, 'compress@10': 0.3298, 'time@10': 9.4258}: 100%|██████████| 10/10 [01:08<00:00,  8.03s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9414, 'compress@10': 0.3298, 'time@10': 9.4258}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.016712556594390797
Avg hit ratio: 0.8802326760204519
Avg ndcg: 0.9413740595456674
Avg compression ratio: 0.3297934855533592
Avg train time: 9.425835227966308
Std train time: 2.842241374833384
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.3368, 'time@10': 8.4394}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.3368, 'time@10': 8.4394}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9411, 'compress@10': 0.3297, 'time@10': 7.8059}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9411, 'compress@10': 0.3297, 'time@10': 7.8059}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9131, 'compress@10': 0.3531, 'time@10': 7.0482}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9131, 'compress@10': 0.3531, 'time@10': 7.0482}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9241, 'compress@10': 0.3461, 'time@10': 6.8154}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9241, 'compress@10': 0.3461, 'time@10': 6.8154}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9228, 'compress@10': 0.3397, 'time@10': 8.1867}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9228, 'compress@10': 0.3397, 'time@10': 8.1867}:  50%|█████     | 5/10 [00:27<00:28,  5.79s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9307, 'compress@10': 0.3357, 'time@10': 8.5338}:  50%|█████     | 5/10 [00:37<00:28,  5.79s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9307, 'compress@10': 0.3357, 'time@10': 8.5338}:  60%|██████    | 6/10 [00:37<00:29,  7.33s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9329, 'compress@10': 0.3346, 'time@10': 8.9066}:  60%|██████    | 6/10 [00:43<00:29,  7.33s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9329, 'compress@10': 0.3346, 'time@10': 8.9066}:  70%|███████   | 7/10 [00:43<00:20,  6.76s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9339, 'compress@10': 0.3328, 'time@10': 8.7549}:  70%|███████   | 7/10 [00:50<00:20,  6.76s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9339, 'compress@10': 0.3328, 'time@10': 8.7549}:  80%|████████  | 8/10 [00:50<00:14,  7.07s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9379, 'compress@10': 0.3313, 'time@10': 9.3476}:  80%|████████  | 8/10 [00:58<00:14,  7.07s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9379, 'compress@10': 0.3313, 'time@10': 9.3476}:  90%|█████████ | 9/10 [00:58<00:07,  7.07s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9439, 'compress@10': 0.3298, 'time@10': 9.4063}:  90%|█████████ | 9/10 [01:08<00:07,  7.07s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9439, 'compress@10': 0.3298, 'time@10': 9.4063}: 100%|██████████| 10/10 [01:08<00:00,  7.97s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9439, 'compress@10': 0.3298, 'time@10': 9.4063}: 100%|██████████| 10/10 [01:08<00:00,  6.80s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.012239067957767635
Avg hit ratio: 0.8901763524157411
Avg ndcg: 0.9439432208211949
Avg compression ratio: 0.32979344491217083
Avg train time: 9.406339049339294
Std train time: 2.8080018070154233
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.3368, 'time@10': 8.1475}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.3368, 'time@10': 8.1475}:  10%|█         | 1/10 [00:04<00:36,  4.11s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9399, 'compress@10': 0.3297, 'time@10': 7.5358}:  10%|█         | 1/10 [00:11<00:36,  4.11s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9399, 'compress@10': 0.3297, 'time@10': 7.5358}:  20%|██        | 2/10 [00:11<00:46,  5.79s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9123, 'compress@10': 0.3531, 'time@10': 6.8236}:  20%|██        | 2/10 [00:13<00:46,  5.79s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9123, 'compress@10': 0.3531, 'time@10': 6.8236}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9252, 'compress@10': 0.3461, 'time@10': 6.6621}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9252, 'compress@10': 0.3461, 'time@10': 6.6621}:  40%|████      | 4/10 [00:20<00:30,  5.11s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9243, 'compress@10': 0.3397, 'time@10': 8.0782}:  40%|████      | 4/10 [00:26<00:30,  5.11s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9243, 'compress@10': 0.3397, 'time@10': 8.0782}:  50%|█████     | 5/10 [00:26<00:28,  5.76s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9323, 'compress@10': 0.3357, 'time@10': 8.4582}:  50%|█████     | 5/10 [00:37<00:28,  5.76s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9323, 'compress@10': 0.3357, 'time@10': 8.4582}:  60%|██████    | 6/10 [00:37<00:29,  7.34s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.932, 'compress@10': 0.3346, 'time@10': 8.8498}:  60%|██████    | 6/10 [00:42<00:29,  7.34s/it] {'epoch': 34, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.932, 'compress@10': 0.3346, 'time@10': 8.8498}:  70%|███████   | 7/10 [00:42<00:20,  6.78s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9359, 'compress@10': 0.3328, 'time@10': 8.7114}:  70%|███████   | 7/10 [00:50<00:20,  6.78s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9359, 'compress@10': 0.3328, 'time@10': 8.7114}:  80%|████████  | 8/10 [00:50<00:14,  7.10s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9417, 'compress@10': 0.3313, 'time@10': 9.3181}:  80%|████████  | 8/10 [00:57<00:14,  7.10s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.873, 'ndcg@10': 0.9417, 'compress@10': 0.3313, 'time@10': 9.3181}:  90%|█████████ | 9/10 [00:57<00:07,  7.11s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9451, 'compress@10': 0.3298, 'time@10': 9.3607}:  90%|█████████ | 9/10 [01:07<00:07,  7.11s/it]  {'epoch': 34, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9451, 'compress@10': 0.3298, 'time@10': 9.3607}: 100%|██████████| 10/10 [01:07<00:00,  7.93s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9451, 'compress@10': 0.3298, 'time@10': 9.3607}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.014371186503369712
Avg hit ratio: 0.8834584824720648
Avg ndcg: 0.9450786113276681
Avg compression ratio: 0.32979346341642635
Avg train time: 9.360690355300903
Std train time: 2.876073414560533
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.3368, 'time@10': 8.2967}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.3368, 'time@10': 8.2967}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9405, 'compress@10': 0.3297, 'time@10': 7.6343}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9405, 'compress@10': 0.3297, 'time@10': 7.6343}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9127, 'compress@10': 0.3531, 'time@10': 6.9751}:  20%|██        | 2/10 [00:14<00:46,  5.85s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9127, 'compress@10': 0.3531, 'time@10': 6.9751}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9255, 'compress@10': 0.3461, 'time@10': 6.7655}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9255, 'compress@10': 0.3461, 'time@10': 6.7655}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.9252, 'compress@10': 0.3397, 'time@10': 8.128}:  40%|████      | 4/10 [00:27<00:30,  5.15s/it] {'epoch': 35, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.9252, 'compress@10': 0.3397, 'time@10': 8.128}:  50%|█████     | 5/10 [00:27<00:28,  5.75s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9388, 'compress@10': 0.3357, 'time@10': 8.4801}:  50%|█████     | 5/10 [00:37<00:28,  5.75s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9388, 'compress@10': 0.3357, 'time@10': 8.4801}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9387, 'compress@10': 0.3346, 'time@10': 8.8463}:  60%|██████    | 6/10 [00:42<00:29,  7.29s/it] {'epoch': 35, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9387, 'compress@10': 0.3346, 'time@10': 8.8463}:  70%|███████   | 7/10 [00:42<00:20,  6.73s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.015, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9402, 'compress@10': 0.3328, 'time@10': 8.7239}:  70%|███████   | 7/10 [00:50<00:20,  6.73s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.015, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9402, 'compress@10': 0.3328, 'time@10': 8.7239}:  80%|████████  | 8/10 [00:50<00:14,  7.10s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9403, 'compress@10': 0.3313, 'time@10': 9.3349}:  80%|████████  | 8/10 [00:57<00:14,  7.10s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9403, 'compress@10': 0.3313, 'time@10': 9.3349}:  90%|█████████ | 9/10 [00:57<00:07,  7.12s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9434, 'compress@10': 0.3298, 'time@10': 9.385}:  90%|█████████ | 9/10 [01:07<00:07,  7.12s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9434, 'compress@10': 0.3298, 'time@10': 9.385}: 100%|██████████| 10/10 [01:07<00:00,  7.97s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9434, 'compress@10': 0.3298, 'time@10': 9.385}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.015896622904612277
Avg hit ratio: 0.8888041045918804
Avg ndcg: 0.9433905348498485
Avg compression ratio: 0.3297934673886266
Avg train time: 9.385045051574707
Std train time: 2.800706287620802
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9202, 'compress@10': 0.3368, 'time@10': 8.3798}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9202, 'compress@10': 0.3368, 'time@10': 8.3798}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9449, 'compress@10': 0.3297, 'time@10': 7.6551}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9449, 'compress@10': 0.3297, 'time@10': 7.6551}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9156, 'compress@10': 0.3531, 'time@10': 6.9624}:  20%|██        | 2/10 [00:14<00:46,  5.84s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9156, 'compress@10': 0.3531, 'time@10': 6.9624}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9277, 'compress@10': 0.3461, 'time@10': 6.7748}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9277, 'compress@10': 0.3461, 'time@10': 6.7748}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9276, 'compress@10': 0.3397, 'time@10': 8.1353}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9276, 'compress@10': 0.3397, 'time@10': 8.1353}:  50%|█████     | 5/10 [00:27<00:28,  5.77s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9354, 'compress@10': 0.3357, 'time@10': 8.4789}:  50%|█████     | 5/10 [00:37<00:28,  5.77s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9354, 'compress@10': 0.3357, 'time@10': 8.4789}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9374, 'compress@10': 0.3346, 'time@10': 8.839}:  60%|██████    | 6/10 [00:42<00:29,  7.29s/it] {'epoch': 36, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9374, 'compress@10': 0.3346, 'time@10': 8.839}:  70%|███████   | 7/10 [00:42<00:20,  6.72s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9344, 'compress@10': 0.3328, 'time@10': 8.6962}:  70%|███████   | 7/10 [00:50<00:20,  6.72s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9344, 'compress@10': 0.3328, 'time@10': 8.6962}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9363, 'compress@10': 0.3313, 'time@10': 9.3091}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9363, 'compress@10': 0.3313, 'time@10': 9.3091}:  90%|█████████ | 9/10 [00:57<00:07,  7.07s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9391, 'compress@10': 0.3298, 'time@10': 9.3573}:  90%|█████████ | 9/10 [01:07<00:07,  7.07s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9391, 'compress@10': 0.3298, 'time@10': 9.3573}: 100%|██████████| 10/10 [01:07<00:00,  7.92s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9391, 'compress@10': 0.3298, 'time@10': 9.3573}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.011996380181024866
Avg hit ratio: 0.895153310941087
Avg ndcg: 0.9390992129169005
Avg compression ratio: 0.32979347008124693
Avg train time: 9.357278299331664
Std train time: 2.806361943731446
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.3368, 'time@10': 8.1714}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.3368, 'time@10': 8.1714}:  10%|█         | 1/10 [00:04<00:37,  4.12s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.893, 'ndcg@10': 0.941, 'compress@10': 0.3297, 'time@10': 7.5489}:  10%|█         | 1/10 [00:11<00:37,  4.12s/it]   {'epoch': 37, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.893, 'ndcg@10': 0.941, 'compress@10': 0.3297, 'time@10': 7.5489}:  20%|██        | 2/10 [00:11<00:46,  5.79s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9131, 'compress@10': 0.3531, 'time@10': 6.8791}:  20%|██        | 2/10 [00:13<00:46,  5.79s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9131, 'compress@10': 0.3531, 'time@10': 6.8791}:  30%|███       | 3/10 [00:13<00:31,  4.43s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9262, 'compress@10': 0.3461, 'time@10': 6.7071}:  30%|███       | 3/10 [00:20<00:31,  4.43s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9262, 'compress@10': 0.3461, 'time@10': 6.7071}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9275, 'compress@10': 0.3397, 'time@10': 8.0829}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9275, 'compress@10': 0.3397, 'time@10': 8.0829}:  50%|█████     | 5/10 [00:26<00:28,  5.75s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9353, 'compress@10': 0.3357, 'time@10': 8.4424}:  50%|█████     | 5/10 [00:37<00:28,  5.75s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9353, 'compress@10': 0.3357, 'time@10': 8.4424}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9373, 'compress@10': 0.3346, 'time@10': 8.7868}:  60%|██████    | 6/10 [00:42<00:29,  7.29s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9373, 'compress@10': 0.3346, 'time@10': 8.7868}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9397, 'compress@10': 0.3328, 'time@10': 8.6524}:  70%|███████   | 7/10 [00:50<00:20,  6.69s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9397, 'compress@10': 0.3328, 'time@10': 8.6524}:  80%|████████  | 8/10 [00:50<00:14,  7.03s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9433, 'compress@10': 0.3313, 'time@10': 9.255}:  80%|████████  | 8/10 [00:57<00:14,  7.03s/it]   {'epoch': 37, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9433, 'compress@10': 0.3313, 'time@10': 9.255}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9495, 'compress@10': 0.3298, 'time@10': 9.3055}:  90%|█████████ | 9/10 [01:07<00:07,  7.04s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9495, 'compress@10': 0.3298, 'time@10': 9.3055}: 100%|██████████| 10/10 [01:07<00:00,  7.89s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9495, 'compress@10': 0.3298, 'time@10': 9.3055}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.011078417334790851
Avg hit ratio: 0.8923985746379633
Avg ndcg: 0.9495097705894698
Avg compression ratio: 0.3297934594422908
Avg train time: 9.305530333518982
Std train time: 2.791486617324565
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.3368, 'time@10': 8.3383}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.3368, 'time@10': 8.3383}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9428, 'compress@10': 0.3297, 'time@10': 7.5942}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9428, 'compress@10': 0.3297, 'time@10': 7.5942}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9142, 'compress@10': 0.3531, 'time@10': 6.8436}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9142, 'compress@10': 0.3531, 'time@10': 6.8436}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.926, 'compress@10': 0.3461, 'time@10': 6.6851}:  30%|███       | 3/10 [00:20<00:30,  4.38s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.926, 'compress@10': 0.3461, 'time@10': 6.6851}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9279, 'compress@10': 0.3397, 'time@10': 8.0707}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9279, 'compress@10': 0.3397, 'time@10': 8.0707}:  50%|█████     | 5/10 [00:26<00:28,  5.74s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9426, 'compress@10': 0.3357, 'time@10': 8.4381}:  50%|█████     | 5/10 [00:37<00:28,  5.74s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9426, 'compress@10': 0.3357, 'time@10': 8.4381}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9415, 'compress@10': 0.3346, 'time@10': 8.7903}:  60%|██████    | 6/10 [00:42<00:29,  7.29s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9415, 'compress@10': 0.3346, 'time@10': 8.7903}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9442, 'compress@10': 0.3328, 'time@10': 8.6719}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9442, 'compress@10': 0.3328, 'time@10': 8.6719}:  80%|████████  | 8/10 [00:50<00:14,  7.08s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9485, 'compress@10': 0.3313, 'time@10': 9.3051}:  80%|████████  | 8/10 [00:57<00:14,  7.08s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9485, 'compress@10': 0.3313, 'time@10': 9.3051}:  90%|█████████ | 9/10 [00:57<00:07,  7.13s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9493, 'compress@10': 0.3298, 'time@10': 9.3647}:  90%|█████████ | 9/10 [01:07<00:07,  7.13s/it]  {'epoch': 38, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9493, 'compress@10': 0.3298, 'time@10': 9.3647}: 100%|██████████| 10/10 [01:07<00:00,  8.00s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9493, 'compress@10': 0.3298, 'time@10': 9.3647}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.014776207054173818
Avg hit ratio: 0.895153310941087
Avg ndcg: 0.9492989435279429
Avg compression ratio: 0.32979347244367035
Avg train time: 9.364710068702697
Std train time: 2.870889039780555
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9176, 'compress@10': 0.3368, 'time@10': 8.2891}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9176, 'compress@10': 0.3368, 'time@10': 8.2891}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9415, 'compress@10': 0.3297, 'time@10': 7.6211}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it] {'epoch': 39, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9415, 'compress@10': 0.3297, 'time@10': 7.6211}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9134, 'compress@10': 0.3531, 'time@10': 6.8803}:  20%|██        | 2/10 [00:13<00:46,  5.83s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9134, 'compress@10': 0.3531, 'time@10': 6.8803}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9265, 'compress@10': 0.3461, 'time@10': 6.6744}:  30%|███       | 3/10 [00:19<00:30,  4.42s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9265, 'compress@10': 0.3461, 'time@10': 6.6744}:  40%|████      | 4/10 [00:19<00:30,  5.08s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9293, 'compress@10': 0.3397, 'time@10': 8.1062}:  40%|████      | 4/10 [00:26<00:30,  5.08s/it]  {'epoch': 39, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9293, 'compress@10': 0.3397, 'time@10': 8.1062}:  50%|█████     | 5/10 [00:26<00:28,  5.76s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.937, 'compress@10': 0.3357, 'time@10': 8.4691}:  50%|█████     | 5/10 [00:37<00:28,  5.76s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.937, 'compress@10': 0.3357, 'time@10': 8.4691}:  60%|██████    | 6/10 [00:37<00:29,  7.31s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.939, 'compress@10': 0.3346, 'time@10': 8.8823}:  60%|██████    | 6/10 [00:42<00:29,  7.31s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.939, 'compress@10': 0.3346, 'time@10': 8.8823}:  70%|███████   | 7/10 [00:42<00:20,  6.79s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9393, 'compress@10': 0.3328, 'time@10': 8.7391}:  70%|███████   | 7/10 [00:50<00:20,  6.79s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9393, 'compress@10': 0.3328, 'time@10': 8.7391}:  80%|████████  | 8/10 [00:50<00:14,  7.10s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.9122, 'ndcg@10': 0.9526, 'compress@10': 0.3313, 'time@10': 9.329}:  80%|████████  | 8/10 [00:57<00:14,  7.10s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.9122, 'ndcg@10': 0.9526, 'compress@10': 0.3313, 'time@10': 9.329}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9187, 'ndcg@10': 0.9547, 'compress@10': 0.3298, 'time@10': 9.3718}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]  {'epoch': 39, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9187, 'ndcg@10': 0.9547, 'compress@10': 0.3298, 'time@10': 9.3718}: 100%|██████████| 10/10 [01:07<00:00,  7.92s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9187, 'ndcg@10': 0.9547, 'compress@10': 0.3298, 'time@10': 9.3718}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.011128725892349919
Avg hit ratio: 0.9187477809871698
Avg ndcg: 0.9547264734641374
Avg compression ratio: 0.32979345141145117
Avg train time: 9.371789050102233
Std train time: 2.8840923249893176
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9025, 'compress@10': 0.3368, 'time@10': 8.0969}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9025, 'compress@10': 0.3368, 'time@10': 8.0969}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9398, 'compress@10': 0.3297, 'time@10': 7.4651}:  10%|█         | 1/10 [00:10<00:36,  4.08s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9398, 'compress@10': 0.3297, 'time@10': 7.4651}:  20%|██        | 2/10 [00:10<00:45,  5.72s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9122, 'compress@10': 0.3531, 'time@10': 6.7996}:  20%|██        | 2/10 [00:13<00:45,  5.72s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9122, 'compress@10': 0.3531, 'time@10': 6.7996}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9245, 'compress@10': 0.3461, 'time@10': 6.616}:  30%|███       | 3/10 [00:19<00:30,  4.38s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9245, 'compress@10': 0.3461, 'time@10': 6.616}:  40%|████      | 4/10 [00:19<00:30,  5.06s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9275, 'compress@10': 0.3397, 'time@10': 7.9967}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9275, 'compress@10': 0.3397, 'time@10': 7.9967}:  50%|█████     | 5/10 [00:26<00:28,  5.68s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9358, 'compress@10': 0.3357, 'time@10': 8.3737}:  50%|█████     | 5/10 [00:36<00:28,  5.68s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0126, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9358, 'compress@10': 0.3357, 'time@10': 8.3737}:  60%|██████    | 6/10 [00:36<00:29,  7.25s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.938, 'compress@10': 0.3346, 'time@10': 8.7392}:  60%|██████    | 6/10 [00:42<00:29,  7.25s/it] {'epoch': 40, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.938, 'compress@10': 0.3346, 'time@10': 8.7392}:  70%|███████   | 7/10 [00:42<00:20,  6.68s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9345, 'compress@10': 0.3328, 'time@10': 8.5992}:  70%|███████   | 7/10 [00:50<00:20,  6.68s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9345, 'compress@10': 0.3328, 'time@10': 8.5992}:  80%|████████  | 8/10 [00:50<00:13,  6.99s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.89, 'ndcg@10': 0.94, 'compress@10': 0.3313, 'time@10': 9.2362}:  80%|████████  | 8/10 [00:57<00:13,  6.99s/it]  {'epoch': 40, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.89, 'ndcg@10': 0.94, 'compress@10': 0.3313, 'time@10': 9.2362}:  90%|█████████ | 9/10 [00:57<00:07,  7.06s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9436, 'compress@10': 0.3298, 'time@10': 9.2834}:  90%|█████████ | 9/10 [01:07<00:07,  7.06s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9436, 'compress@10': 0.3298, 'time@10': 9.2834}: 100%|██████████| 10/10 [01:07<00:00,  7.89s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9436, 'compress@10': 0.3298, 'time@10': 9.2834}: 100%|██████████| 10/10 [01:07<00:00,  6.70s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.016679365213903178
Avg hit ratio: 0.8987477809871697
Avg ndcg: 0.9436146390734835
Avg compression ratio: 0.3297934737396648
Avg train time: 9.283425617218018
Std train time: 2.8701446974258285
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 0.3368, 'time@10': 8.2952}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 0.3368, 'time@10': 8.2952}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9439, 'compress@10': 0.3297, 'time@10': 7.7296}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9439, 'compress@10': 0.3297, 'time@10': 7.7296}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.915, 'compress@10': 0.3531, 'time@10': 6.9622}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.915, 'compress@10': 0.3531, 'time@10': 6.9622}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9277, 'compress@10': 0.3461, 'time@10': 6.7561}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9277, 'compress@10': 0.3461, 'time@10': 6.7561}:  40%|████      | 4/10 [00:20<00:30,  5.16s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9302, 'compress@10': 0.3397, 'time@10': 8.14}:  40%|████      | 4/10 [00:27<00:30,  5.16s/it]  {'epoch': 41, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9302, 'compress@10': 0.3397, 'time@10': 8.14}:  50%|█████     | 5/10 [00:27<00:28,  5.78s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0104, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9377, 'compress@10': 0.3357, 'time@10': 8.5255}:  50%|█████     | 5/10 [00:37<00:28,  5.78s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0104, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9377, 'compress@10': 0.3357, 'time@10': 8.5255}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9397, 'compress@10': 0.3346, 'time@10': 8.8867}:  60%|██████    | 6/10 [00:43<00:29,  7.38s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9397, 'compress@10': 0.3346, 'time@10': 8.8867}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9422, 'compress@10': 0.3328, 'time@10': 8.74}:  70%|███████   | 7/10 [00:50<00:20,  6.79s/it]     {'epoch': 41, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9422, 'compress@10': 0.3328, 'time@10': 8.74}:  80%|████████  | 8/10 [00:50<00:14,  7.09s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9602, 'compress@10': 0.3313, 'time@10': 9.3463}:  80%|████████  | 8/10 [00:58<00:14,  7.09s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9602, 'compress@10': 0.3313, 'time@10': 9.3463}:  90%|█████████ | 9/10 [00:58<00:07,  7.11s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9639, 'compress@10': 0.3298, 'time@10': 9.4035}:  90%|█████████ | 9/10 [01:08<00:07,  7.11s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9639, 'compress@10': 0.3298, 'time@10': 9.4035}: 100%|██████████| 10/10 [01:08<00:00,  7.99s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9639, 'compress@10': 0.3298, 'time@10': 9.4035}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.015517091049275209
Avg hit ratio: 0.8983791173926996
Avg ndcg: 0.9639489795288654
Avg compression ratio: 0.32979344986893117
Avg train time: 9.403491759300232
Std train time: 2.844225028790708
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9087, 'compress@10': 0.3368, 'time@10': 8.2351}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9087, 'compress@10': 0.3368, 'time@10': 8.2351}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9382, 'compress@10': 0.3297, 'time@10': 7.6291}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9382, 'compress@10': 0.3297, 'time@10': 7.6291}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9112, 'compress@10': 0.3531, 'time@10': 6.8872}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9112, 'compress@10': 0.3531, 'time@10': 6.8872}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9238, 'compress@10': 0.3461, 'time@10': 6.7177}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9238, 'compress@10': 0.3461, 'time@10': 6.7177}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9267, 'compress@10': 0.3397, 'time@10': 8.0604}:  40%|████      | 4/10 [00:26<00:30,  5.15s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9267, 'compress@10': 0.3397, 'time@10': 8.0604}:  50%|█████     | 5/10 [00:26<00:28,  5.73s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9349, 'compress@10': 0.3357, 'time@10': 8.4314}:  50%|█████     | 5/10 [00:37<00:28,  5.73s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9349, 'compress@10': 0.3357, 'time@10': 8.4314}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9367, 'compress@10': 0.3346, 'time@10': 8.805}:  60%|██████    | 6/10 [00:42<00:29,  7.29s/it] {'epoch': 42, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9367, 'compress@10': 0.3346, 'time@10': 8.805}:  70%|███████   | 7/10 [00:42<00:20,  6.73s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9403, 'compress@10': 0.3328, 'time@10': 8.6639}:  70%|███████   | 7/10 [00:50<00:20,  6.73s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9403, 'compress@10': 0.3328, 'time@10': 8.6639}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9414, 'compress@10': 0.3313, 'time@10': 9.332}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it] {'epoch': 42, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9414, 'compress@10': 0.3313, 'time@10': 9.332}:  90%|█████████ | 9/10 [00:57<00:07,  7.14s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9449, 'compress@10': 0.3298, 'time@10': 9.3913}:  90%|█████████ | 9/10 [01:07<00:07,  7.14s/it] {'epoch': 42, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9449, 'compress@10': 0.3298, 'time@10': 9.3913}: 100%|██████████| 10/10 [01:07<00:00,  8.02s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9449, 'compress@10': 0.3298, 'time@10': 9.3913}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.011882623450359665
Avg hit ratio: 0.9131359018269036
Avg ndcg: 0.9448750877974522
Avg compression ratio: 0.32979345756728184
Avg train time: 9.391315174102782
Std train time: 2.898278835067779
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9154, 'compress@10': 0.3368, 'time@10': 8.6935}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9154, 'compress@10': 0.3368, 'time@10': 8.6935}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.941, 'compress@10': 0.3297, 'time@10': 7.882}:  10%|█         | 1/10 [00:11<00:39,  4.38s/it]  {'epoch': 43, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.941, 'compress@10': 0.3297, 'time@10': 7.882}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9131, 'compress@10': 0.3531, 'time@10': 7.064}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9131, 'compress@10': 0.3531, 'time@10': 7.064}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9259, 'compress@10': 0.3461, 'time@10': 6.8406}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9259, 'compress@10': 0.3461, 'time@10': 6.8406}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9289, 'compress@10': 0.3397, 'time@10': 8.2039}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9289, 'compress@10': 0.3397, 'time@10': 8.2039}:  50%|█████     | 5/10 [00:27<00:28,  5.79s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9367, 'compress@10': 0.3357, 'time@10': 8.5382}:  50%|█████     | 5/10 [00:37<00:28,  5.79s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9367, 'compress@10': 0.3357, 'time@10': 8.5382}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9398, 'compress@10': 0.3346, 'time@10': 8.8711}:  60%|██████    | 6/10 [00:43<00:29,  7.30s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9398, 'compress@10': 0.3346, 'time@10': 8.8711}:  70%|███████   | 7/10 [00:43<00:20,  6.70s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.938, 'compress@10': 0.3328, 'time@10': 8.7311}:  70%|███████   | 7/10 [00:50<00:20,  6.70s/it]  {'epoch': 43, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.938, 'compress@10': 0.3328, 'time@10': 8.7311}:  80%|████████  | 8/10 [00:50<00:14,  7.05s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9422, 'compress@10': 0.3313, 'time@10': 9.3426}:  80%|████████  | 8/10 [00:57<00:14,  7.05s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9422, 'compress@10': 0.3313, 'time@10': 9.3426}:  90%|█████████ | 9/10 [00:57<00:07,  7.08s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9456, 'compress@10': 0.3298, 'time@10': 9.3991}:  90%|█████████ | 9/10 [01:07<00:07,  7.08s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9456, 'compress@10': 0.3298, 'time@10': 9.3991}: 100%|██████████| 10/10 [01:07<00:00,  7.96s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9456, 'compress@10': 0.3298, 'time@10': 9.3991}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.01126615591149138
Avg hit ratio: 0.9127672382324334
Avg ndcg: 0.9455502936073421
Avg compression ratio: 0.3297934558602967
Avg train time: 9.399055886268616
Std train time: 2.8180273713491655
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.3368, 'time@10': 8.3325}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.3368, 'time@10': 8.3325}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.0011, 'compress@10': 0.3297, 'time@10': 7.6551}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it] {'epoch': 44, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.0011, 'compress@10': 0.3297, 'time@10': 7.6551}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9531, 'compress@10': 0.3531, 'time@10': 6.8818}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9531, 'compress@10': 0.3531, 'time@10': 6.8818}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9546, 'compress@10': 0.3461, 'time@10': 6.7069}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9546, 'compress@10': 0.3461, 'time@10': 6.7069}:  40%|████      | 4/10 [00:20<00:30,  5.13s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9528, 'compress@10': 0.3397, 'time@10': 8.1357}:  40%|████      | 4/10 [00:27<00:30,  5.13s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9528, 'compress@10': 0.3397, 'time@10': 8.1357}:  50%|█████     | 5/10 [00:27<00:28,  5.79s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9566, 'compress@10': 0.3357, 'time@10': 8.4819}:  50%|█████     | 5/10 [00:37<00:28,  5.79s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9566, 'compress@10': 0.3357, 'time@10': 8.4819}:  60%|██████    | 6/10 [00:37<00:29,  7.31s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9558, 'compress@10': 0.3346, 'time@10': 8.8224}:  60%|██████    | 6/10 [00:42<00:29,  7.31s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9558, 'compress@10': 0.3346, 'time@10': 8.8224}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9575, 'compress@10': 0.3328, 'time@10': 8.6711}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9575, 'compress@10': 0.3328, 'time@10': 8.6711}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9569, 'compress@10': 0.3313, 'time@10': 9.3121}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9569, 'compress@10': 0.3313, 'time@10': 9.3121}:  90%|█████████ | 9/10 [00:57<00:07,  7.08s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9607, 'compress@10': 0.3298, 'time@10': 9.3582}:  90%|█████████ | 9/10 [01:07<00:07,  7.08s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9607, 'compress@10': 0.3298, 'time@10': 9.3582}: 100%|██████████| 10/10 [01:07<00:00,  7.93s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9607, 'compress@10': 0.3298, 'time@10': 9.3582}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.012250246024342114
Avg hit ratio: 0.9099100953752906
Avg ndcg: 0.9607290447867823
Avg compression ratio: 0.32979348118837254
Avg train time: 9.358232879638672
Std train time: 2.9193441422610595
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9211, 'compress@10': 0.3368, 'time@10': 8.1527}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9211, 'compress@10': 0.3368, 'time@10': 8.1527}:  10%|█         | 1/10 [00:04<00:37,  4.11s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9444, 'compress@10': 0.3297, 'time@10': 7.5592}:  10%|█         | 1/10 [00:11<00:37,  4.11s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9444, 'compress@10': 0.3297, 'time@10': 7.5592}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9153, 'compress@10': 0.3531, 'time@10': 6.8676}:  20%|██        | 2/10 [00:13<00:46,  5.81s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9153, 'compress@10': 0.3531, 'time@10': 6.8676}:  30%|███       | 3/10 [00:13<00:30,  4.43s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9276, 'compress@10': 0.3461, 'time@10': 6.7545}:  30%|███       | 3/10 [00:20<00:30,  4.43s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9276, 'compress@10': 0.3461, 'time@10': 6.7545}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9318, 'compress@10': 0.3397, 'time@10': 8.1412}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it] {'epoch': 45, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9318, 'compress@10': 0.3397, 'time@10': 8.1412}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9467, 'compress@10': 0.3357, 'time@10': 8.4756}:  50%|█████     | 5/10 [00:37<00:29,  5.82s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9467, 'compress@10': 0.3357, 'time@10': 8.4756}:  60%|██████    | 6/10 [00:37<00:29,  7.31s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.947, 'compress@10': 0.3346, 'time@10': 8.8443}:  60%|██████    | 6/10 [00:42<00:29,  7.31s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0142, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.947, 'compress@10': 0.3346, 'time@10': 8.8443}:  70%|███████   | 7/10 [00:42<00:20,  6.74s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9494, 'compress@10': 0.3328, 'time@10': 8.7129}:  70%|███████   | 7/10 [00:50<00:20,  6.74s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9494, 'compress@10': 0.3328, 'time@10': 8.7129}:  80%|████████  | 8/10 [00:50<00:14,  7.08s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9555, 'compress@10': 0.3313, 'time@10': 9.3727}:  80%|████████  | 8/10 [00:58<00:14,  7.08s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9555, 'compress@10': 0.3313, 'time@10': 9.3727}:  90%|█████████ | 9/10 [00:58<00:07,  7.17s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9156, 'ndcg@10': 0.9573, 'compress@10': 0.3298, 'time@10': 9.4245}:  90%|█████████ | 9/10 [01:08<00:07,  7.17s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9156, 'ndcg@10': 0.9573, 'compress@10': 0.3298, 'time@10': 9.4245}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9156, 'ndcg@10': 0.9573, 'compress@10': 0.3298, 'time@10': 9.4245}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.013858651904633834
Avg hit ratio: 0.9156474225642308
Avg ndcg: 0.9572693279204163
Avg compression ratio: 0.3297934217840955
Avg train time: 9.424500584602356
Std train time: 2.8948247254561683
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 0.3368, 'time@10': 8.1507}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 0.3368, 'time@10': 8.1507}:  10%|█         | 1/10 [00:04<00:36,  4.11s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9809, 'compress@10': 0.3297, 'time@10': 7.4885}:  10%|█         | 1/10 [00:10<00:36,  4.11s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9809, 'compress@10': 0.3297, 'time@10': 7.4885}:  20%|██        | 2/10 [00:10<00:45,  5.73s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9396, 'compress@10': 0.3531, 'time@10': 6.7537}:  20%|██        | 2/10 [00:13<00:45,  5.73s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9396, 'compress@10': 0.3531, 'time@10': 6.7537}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9451, 'compress@10': 0.3461, 'time@10': 6.7542}:  30%|███       | 3/10 [00:20<00:30,  4.34s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9451, 'compress@10': 0.3461, 'time@10': 6.7542}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9465, 'compress@10': 0.3397, 'time@10': 8.1294}:  40%|████      | 4/10 [00:27<00:31,  5.31s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9465, 'compress@10': 0.3397, 'time@10': 8.1294}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9515, 'compress@10': 0.3357, 'time@10': 8.4801}:  50%|█████     | 5/10 [00:37<00:29,  5.87s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9515, 'compress@10': 0.3357, 'time@10': 8.4801}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9512, 'compress@10': 0.3346, 'time@10': 8.8305}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9512, 'compress@10': 0.3346, 'time@10': 8.8305}:  70%|███████   | 7/10 [00:43<00:20,  6.76s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9511, 'compress@10': 0.3328, 'time@10': 8.7023}:  70%|███████   | 7/10 [00:50<00:20,  6.76s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9224, 'ndcg@10': 0.9511, 'compress@10': 0.3328, 'time@10': 8.7023}:  80%|████████  | 8/10 [00:50<00:14,  7.10s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.948, 'compress@10': 0.3313, 'time@10': 9.2984}:  80%|████████  | 8/10 [00:58<00:14,  7.10s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.948, 'compress@10': 0.3313, 'time@10': 9.2984}:  90%|█████████ | 9/10 [00:58<00:07,  7.09s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.951, 'compress@10': 0.3298, 'time@10': 9.35}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]     {'epoch': 46, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.951, 'compress@10': 0.3298, 'time@10': 9.35}: 100%|██████████| 10/10 [01:07<00:00,  7.94s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.951, 'compress@10': 0.3298, 'time@10': 9.35}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.011289673801093634
Avg hit ratio: 0.9127902797070879
Avg ndcg: 0.951037019599833
Avg compression ratio: 0.3297934777022966
Avg train time: 9.35002043247223
Std train time: 2.784526965738674
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.3368, 'time@10': 8.2146}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.3368, 'time@10': 8.2146}:  10%|█         | 1/10 [00:04<00:37,  4.14s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9465, 'compress@10': 0.3297, 'time@10': 7.4832}:  10%|█         | 1/10 [00:10<00:37,  4.14s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9465, 'compress@10': 0.3297, 'time@10': 7.4832}:  20%|██        | 2/10 [00:10<00:45,  5.70s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9167, 'compress@10': 0.3531, 'time@10': 6.7338}:  20%|██        | 2/10 [00:13<00:45,  5.70s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9167, 'compress@10': 0.3531, 'time@10': 6.7338}:  30%|███       | 3/10 [00:13<00:30,  4.31s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9278, 'compress@10': 0.3461, 'time@10': 6.6142}:  30%|███       | 3/10 [00:19<00:30,  4.31s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9278, 'compress@10': 0.3461, 'time@10': 6.6142}:  40%|████      | 4/10 [00:19<00:30,  5.09s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9325, 'compress@10': 0.3397, 'time@10': 7.9923}:  40%|████      | 4/10 [00:26<00:30,  5.09s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9325, 'compress@10': 0.3397, 'time@10': 7.9923}:  50%|█████     | 5/10 [00:26<00:28,  5.70s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9393, 'compress@10': 0.3357, 'time@10': 8.3454}:  50%|█████     | 5/10 [00:36<00:28,  5.70s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9393, 'compress@10': 0.3357, 'time@10': 8.3454}:  60%|██████    | 6/10 [00:36<00:28,  7.22s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9422, 'compress@10': 0.3346, 'time@10': 8.6487}:  60%|██████    | 6/10 [00:42<00:28,  7.22s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9422, 'compress@10': 0.3346, 'time@10': 8.6487}:  70%|███████   | 7/10 [00:42<00:19,  6.58s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9184, 'ndcg@10': 0.9414, 'compress@10': 0.3328, 'time@10': 8.4948}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9184, 'ndcg@10': 0.9414, 'compress@10': 0.3328, 'time@10': 8.4948}:  80%|████████  | 8/10 [00:49<00:13,  6.86s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9488, 'compress@10': 0.3313, 'time@10': 9.133}:  80%|████████  | 8/10 [00:56<00:13,  6.86s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0114, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9488, 'compress@10': 0.3313, 'time@10': 9.133}:  90%|█████████ | 9/10 [00:56<00:06,  6.95s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9503, 'compress@10': 0.3298, 'time@10': 9.172}:  90%|█████████ | 9/10 [01:06<00:06,  6.95s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9503, 'compress@10': 0.3298, 'time@10': 9.172}: 100%|██████████| 10/10 [01:06<00:00,  7.76s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9503, 'compress@10': 0.3298, 'time@10': 9.172}: 100%|██████████| 10/10 [01:06<00:00,  6.63s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.013105658803286879
Avg hit ratio: 0.9067073303983321
Avg ndcg: 0.9502940589654771
Avg compression ratio: 0.3297933828301553
Avg train time: 9.1719646692276
Std train time: 2.8457710911395364
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9351, 'compress@10': 0.3368, 'time@10': 8.3267}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9351, 'compress@10': 0.3368, 'time@10': 8.3267}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9856, 'compress@10': 0.3297, 'time@10': 7.6079}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9856, 'compress@10': 0.3297, 'time@10': 7.6079}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9428, 'compress@10': 0.3531, 'time@10': 6.9469}:  20%|██        | 2/10 [00:13<00:46,  5.81s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9428, 'compress@10': 0.3531, 'time@10': 6.9469}:  30%|███       | 3/10 [00:13<00:31,  4.46s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9477, 'compress@10': 0.3461, 'time@10': 6.7072}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9477, 'compress@10': 0.3461, 'time@10': 6.7072}:  40%|████      | 4/10 [00:20<00:30,  5.08s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9482, 'compress@10': 0.3397, 'time@10': 8.0106}:  40%|████      | 4/10 [00:26<00:30,  5.08s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9482, 'compress@10': 0.3397, 'time@10': 8.0106}:  50%|█████     | 5/10 [00:26<00:28,  5.64s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9527, 'compress@10': 0.3357, 'time@10': 8.3332}:  50%|█████     | 5/10 [00:36<00:28,  5.64s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9527, 'compress@10': 0.3357, 'time@10': 8.3332}:  60%|██████    | 6/10 [00:36<00:28,  7.12s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9535, 'compress@10': 0.3346, 'time@10': 8.7066}:  60%|██████    | 6/10 [00:42<00:28,  7.12s/it] {'epoch': 48, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9535, 'compress@10': 0.3346, 'time@10': 8.7066}:  70%|███████   | 7/10 [00:42<00:19,  6.59s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.955, 'compress@10': 0.3328, 'time@10': 8.5789}:  70%|███████   | 7/10 [00:49<00:19,  6.59s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.955, 'compress@10': 0.3328, 'time@10': 8.5789}:  80%|████████  | 8/10 [00:49<00:13,  6.95s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9511, 'compress@10': 0.3313, 'time@10': 9.1802}:  80%|████████  | 8/10 [00:56<00:13,  6.95s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9511, 'compress@10': 0.3313, 'time@10': 9.1802}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9538, 'compress@10': 0.3298, 'time@10': 9.2211}:  90%|█████████ | 9/10 [01:06<00:06,  6.98s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9538, 'compress@10': 0.3298, 'time@10': 9.2211}: 100%|██████████| 10/10 [01:06<00:00,  7.80s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9538, 'compress@10': 0.3298, 'time@10': 9.2211}: 100%|██████████| 10/10 [01:06<00:00,  6.65s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.012626327568065168
Avg hit ratio: 0.9012593017244971
Avg ndcg: 0.9538255833900007
Avg compression ratio: 0.32979347133171905
Avg train time: 9.221118497848511
Std train time: 2.727566480693405
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.3368, 'time@10': 7.5581}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.3368, 'time@10': 7.5581}:  10%|█         | 1/10 [00:03<00:34,  3.81s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9433, 'compress@10': 0.3297, 'time@10': 6.9282}:  10%|█         | 1/10 [00:10<00:34,  3.81s/it] {'epoch': 49, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9433, 'compress@10': 0.3297, 'time@10': 6.9282}:  20%|██        | 2/10 [00:10<00:42,  5.30s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9146, 'compress@10': 0.3531, 'time@10': 6.3813}:  20%|██        | 2/10 [00:12<00:42,  5.30s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9146, 'compress@10': 0.3531, 'time@10': 6.3813}:  30%|███       | 3/10 [00:12<00:28,  4.10s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.927, 'compress@10': 0.3461, 'time@10': 6.101}:  30%|███       | 3/10 [00:18<00:28,  4.10s/it]  {'epoch': 49, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.927, 'compress@10': 0.3461, 'time@10': 6.101}:  40%|████      | 4/10 [00:18<00:27,  4.57s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9315, 'compress@10': 0.3397, 'time@10': 7.213}:  40%|████      | 4/10 [00:23<00:27,  4.57s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9315, 'compress@10': 0.3397, 'time@10': 7.213}:  50%|█████     | 5/10 [00:23<00:25,  5.04s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.939, 'compress@10': 0.3357, 'time@10': 7.4276}:  50%|█████     | 5/10 [00:32<00:25,  5.04s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.939, 'compress@10': 0.3357, 'time@10': 7.4276}:  60%|██████    | 6/10 [00:32<00:24,  6.23s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9407, 'compress@10': 0.3346, 'time@10': 7.6718}:  60%|██████    | 6/10 [00:37<00:24,  6.23s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9407, 'compress@10': 0.3346, 'time@10': 7.6718}:  70%|███████   | 7/10 [00:37<00:17,  5.70s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.941, 'compress@10': 0.3328, 'time@10': 7.5027}:  70%|███████   | 7/10 [00:43<00:17,  5.70s/it]  {'epoch': 49, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.941, 'compress@10': 0.3328, 'time@10': 7.5027}:  80%|████████  | 8/10 [00:43<00:11,  5.90s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9565, 'compress@10': 0.3313, 'time@10': 7.9847}:  80%|████████  | 8/10 [00:49<00:11,  5.90s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9565, 'compress@10': 0.3313, 'time@10': 7.9847}:  90%|█████████ | 9/10 [00:49<00:05,  5.92s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9572, 'compress@10': 0.3298, 'time@10': 7.9449}:  90%|█████████ | 9/10 [00:57<00:05,  5.92s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9572, 'compress@10': 0.3298, 'time@10': 7.9449}: 100%|██████████| 10/10 [00:57<00:00,  6.44s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9572, 'compress@10': 0.3298, 'time@10': 7.9449}: 100%|██████████| 10/10 [00:57<00:00,  5.70s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.013611454579228664
Avg hit ratio: 0.9066842889236778
Avg ndcg: 0.9572141241764649
Avg compression ratio: 0.3297934843749238
Avg train time: 7.944943952560425
Std train time: 2.2498242806891864
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
