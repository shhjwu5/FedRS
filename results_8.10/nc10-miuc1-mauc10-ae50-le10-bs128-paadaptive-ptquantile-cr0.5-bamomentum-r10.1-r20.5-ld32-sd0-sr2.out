  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2151, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.521, 'compress@10': 0.5263, 'time@10': 9.5288}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2151, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.521, 'compress@10': 0.5263, 'time@10': 9.5288}:  10%|█         | 1/10 [00:04<00:43,  4.80s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1559, 'hit_ratio@10': 0.5229, 'ndcg@10': 0.5719, 'compress@10': 0.5212, 'time@10': 8.2869}:  10%|█         | 1/10 [00:11<00:43,  4.80s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1559, 'hit_ratio@10': 0.5229, 'ndcg@10': 0.5719, 'compress@10': 0.5212, 'time@10': 8.2869}:  20%|██        | 2/10 [00:11<00:49,  6.14s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8645, 'hit_ratio@10': 0.3962, 'ndcg@10': 0.3812, 'compress@10': 0.538, 'time@10': 6.4656}:  20%|██        | 2/10 [00:13<00:49,  6.14s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.8645, 'hit_ratio@10': 0.3962, 'ndcg@10': 0.3812, 'compress@10': 0.538, 'time@10': 6.4656}:  30%|███       | 3/10 [00:13<00:28,  4.00s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.682, 'hit_ratio@10': 0.4847, 'ndcg@10': 0.4244, 'compress@10': 0.5329, 'time@10': 6.4579}:  30%|███       | 3/10 [00:19<00:28,  4.00s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.682, 'hit_ratio@10': 0.4847, 'ndcg@10': 0.4244, 'compress@10': 0.5329, 'time@10': 6.4579}:  40%|████      | 4/10 [00:19<00:29,  4.98s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.565, 'hit_ratio@10': 0.5517, 'ndcg@10': 0.4861, 'compress@10': 0.5283, 'time@10': 9.8085}:  40%|████      | 4/10 [00:31<00:29,  4.98s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.565, 'hit_ratio@10': 0.5517, 'ndcg@10': 0.4861, 'compress@10': 0.5283, 'time@10': 9.8085}:  50%|█████     | 5/10 [00:31<00:36,  7.38s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4862, 'hit_ratio@10': 0.5746, 'ndcg@10': 0.5304, 'compress@10': 0.5255, 'time@10': 9.8988}:  50%|█████     | 5/10 [00:41<00:36,  7.38s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4862, 'hit_ratio@10': 0.5746, 'ndcg@10': 0.5304, 'compress@10': 0.5255, 'time@10': 9.8988}:  60%|██████    | 6/10 [00:41<00:33,  8.41s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4369, 'hit_ratio@10': 0.5782, 'ndcg@10': 0.5317, 'compress@10': 0.5247, 'time@10': 10.1082}:  60%|██████    | 6/10 [00:47<00:33,  8.41s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4369, 'hit_ratio@10': 0.5782, 'ndcg@10': 0.5317, 'compress@10': 0.5247, 'time@10': 10.1082}:  70%|███████   | 7/10 [00:47<00:22,  7.53s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3898, 'hit_ratio@10': 0.6202, 'ndcg@10': 0.5605, 'compress@10': 0.5234, 'time@10': 9.8342}:  70%|███████   | 7/10 [00:55<00:22,  7.53s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.3898, 'hit_ratio@10': 0.6202, 'ndcg@10': 0.5605, 'compress@10': 0.5234, 'time@10': 9.8342}:  80%|████████  | 8/10 [00:55<00:15,  7.66s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3545, 'hit_ratio@10': 0.6402, 'ndcg@10': 0.5971, 'compress@10': 0.5224, 'time@10': 10.5162}:  80%|████████  | 8/10 [01:03<00:15,  7.66s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3545, 'hit_ratio@10': 0.6402, 'ndcg@10': 0.5971, 'compress@10': 0.5224, 'time@10': 10.5162}:  90%|█████████ | 9/10 [01:03<00:07,  7.78s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.325, 'hit_ratio@10': 0.6694, 'ndcg@10': 0.6164, 'compress@10': 0.5213, 'time@10': 10.4777}:  90%|█████████ | 9/10 [01:13<00:07,  7.78s/it]    {'epoch': 0, 'num_users': 6.3, 'loss': 0.325, 'hit_ratio@10': 0.6694, 'ndcg@10': 0.6164, 'compress@10': 0.5213, 'time@10': 10.4777}: 100%|██████████| 10/10 [01:13<00:00,  8.52s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.325, 'hit_ratio@10': 0.6694, 'ndcg@10': 0.6164, 'compress@10': 0.5213, 'time@10': 10.4777}: 100%|██████████| 10/10 [01:13<00:00,  7.37s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.32501040411837057
Avg hit ratio: 0.6693690335320216
Avg ndcg: 0.616426765511585
Avg compression ratio: 0.5212749006657823
Avg train time: 10.477651214599609
Std train time: 5.361235441915854
[0.75, 0.25, 0.75, 0.75, 0.75, 0.25, 0.75, 0.25, 0.25, 0.25]
[10, 12, 14, 12, 4, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0592, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8276, 'compress@10': 0.7632, 'time@10': 8.7962}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0592, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8276, 'compress@10': 0.7632, 'time@10': 8.7962}:  10%|█         | 1/10 [00:04<00:39,  4.43s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0558, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8418, 'compress@10': 0.5187, 'time@10': 8.6044}:  10%|█         | 1/10 [00:12<00:39,  4.43s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0558, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8418, 'compress@10': 0.5187, 'time@10': 8.6044}:  20%|██        | 2/10 [00:12<00:54,  6.80s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0428, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.8219, 'compress@10': 0.6077, 'time@10': 6.9977}:  20%|██        | 2/10 [00:14<00:54,  6.80s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0428, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.8219, 'compress@10': 0.6077, 'time@10': 6.9977}:  30%|███       | 3/10 [00:14<00:32,  4.57s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0444, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8271, 'compress@10': 0.6455, 'time@10': 7.1101}:  30%|███       | 3/10 [00:22<00:32,  4.57s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0444, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8271, 'compress@10': 0.6455, 'time@10': 7.1101}:  40%|████      | 4/10 [00:22<00:34,  5.72s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0581, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.7985, 'compress@10': 0.6674, 'time@10': 7.5763}:  40%|████      | 4/10 [00:27<00:34,  5.72s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0581, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.7985, 'compress@10': 0.6674, 'time@10': 7.5763}:  50%|█████     | 5/10 [00:27<00:26,  5.37s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0616, 'hit_ratio@10': 0.7803, 'ndcg@10': 0.8015, 'compress@10': 0.6006, 'time@10': 8.041}:  50%|█████     | 5/10 [00:37<00:26,  5.37s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0616, 'hit_ratio@10': 0.7803, 'ndcg@10': 0.8015, 'compress@10': 0.6006, 'time@10': 8.041}:  60%|██████    | 6/10 [00:37<00:28,  7.09s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0593, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8111, 'compress@10': 0.6234, 'time@10': 8.4691}:  60%|██████    | 6/10 [00:43<00:28,  7.09s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0593, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8111, 'compress@10': 0.6234, 'time@10': 8.4691}:  70%|███████   | 7/10 [00:43<00:19,  6.59s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0565, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8189, 'compress@10': 0.5794, 'time@10': 8.5022}:  70%|███████   | 7/10 [00:51<00:19,  6.59s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0565, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8189, 'compress@10': 0.5794, 'time@10': 8.5022}:  80%|████████  | 8/10 [00:51<00:14,  7.28s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.055, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.8292, 'compress@10': 0.5452, 'time@10': 8.8003}:  80%|████████  | 8/10 [00:57<00:14,  7.28s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.055, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.8292, 'compress@10': 0.5452, 'time@10': 8.8003}:  90%|█████████ | 9/10 [00:57<00:06,  6.76s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0542, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8306, 'compress@10': 0.5174, 'time@10': 8.9288}:  90%|█████████ | 9/10 [01:07<00:06,  6.76s/it]  {'epoch': 1, 'num_users': 6.3, 'loss': 0.0542, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8306, 'compress@10': 0.5174, 'time@10': 8.9288}: 100%|██████████| 10/10 [01:07<00:00,  7.80s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0542, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8306, 'compress@10': 0.5174, 'time@10': 8.9288}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05416672398694222
Avg hit ratio: 0.8201937296809962
Avg ndcg: 0.8306401508610552
Avg compression ratio: 0.5173535727809171
Avg train time: 8.928762006759644
Std train time: 2.053782771760424
[0.8333333333333334, 0.5, 0.5, 0.8333333333333334, 0.8333333333333334, 0.5, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[11, 13, 17, 13, 4, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8508, 'compress@10': 0.8421, 'time@10': 9.2467}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8508, 'compress@10': 0.8421, 'time@10': 9.2467}:  10%|█         | 1/10 [00:04<00:41,  4.66s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8512, 'compress@10': 0.6791, 'time@10': 9.2473}:  10%|█         | 1/10 [00:13<00:41,  4.66s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8512, 'compress@10': 0.6791, 'time@10': 9.2473}:  20%|██        | 2/10 [00:13<00:59,  7.38s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8532, 'compress@10': 0.6432, 'time@10': 7.7231}:  20%|██        | 2/10 [00:16<00:59,  7.38s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8532, 'compress@10': 0.6432, 'time@10': 7.7231}:  30%|███       | 3/10 [00:16<00:35,  5.10s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8507, 'compress@10': 0.6922, 'time@10': 7.7559}:  30%|███       | 3/10 [00:24<00:35,  5.10s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8507, 'compress@10': 0.6922, 'time@10': 7.7559}:  40%|████      | 4/10 [00:24<00:37,  6.20s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0502, 'hit_ratio@10': 0.7785, 'ndcg@10': 0.8263, 'compress@10': 0.7211, 'time@10': 7.9834}:  40%|████      | 4/10 [00:28<00:37,  6.20s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0502, 'hit_ratio@10': 0.7785, 'ndcg@10': 0.8263, 'compress@10': 0.7211, 'time@10': 7.9834}:  50%|█████     | 5/10 [00:28<00:27,  5.58s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0543, 'hit_ratio@10': 0.7747, 'ndcg@10': 0.8243, 'compress@10': 0.6861, 'time@10': 8.3968}:  50%|█████     | 5/10 [00:39<00:27,  5.58s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0543, 'hit_ratio@10': 0.7747, 'ndcg@10': 0.8243, 'compress@10': 0.6861, 'time@10': 8.3968}:  60%|██████    | 6/10 [00:39<00:29,  7.25s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0526, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.8291, 'compress@10': 0.6624, 'time@10': 8.7993}:  60%|██████    | 6/10 [00:44<00:29,  7.25s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0526, 'hit_ratio@10': 0.8011, 'ndcg@10': 0.8291, 'compress@10': 0.6624, 'time@10': 8.7993}:  70%|███████   | 7/10 [00:44<00:20,  6.73s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8318, 'compress@10': 0.6034, 'time@10': 8.8573}:  70%|███████   | 7/10 [00:54<00:20,  6.73s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8318, 'compress@10': 0.6034, 'time@10': 8.8573}:  80%|████████  | 8/10 [00:54<00:15,  7.55s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0491, 'hit_ratio@10': 0.8009, 'ndcg@10': 0.841, 'compress@10': 0.5575, 'time@10': 9.0675}:  80%|████████  | 8/10 [00:59<00:15,  7.55s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0491, 'hit_ratio@10': 0.8009, 'ndcg@10': 0.841, 'compress@10': 0.5575, 'time@10': 9.0675}:  90%|█████████ | 9/10 [00:59<00:06,  6.88s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8417, 'compress@10': 0.5203, 'time@10': 9.1846}:  90%|█████████ | 9/10 [01:09<00:06,  6.88s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8417, 'compress@10': 0.5203, 'time@10': 9.1846}: 100%|██████████| 10/10 [01:09<00:00,  7.93s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8417, 'compress@10': 0.5203, 'time@10': 9.1846}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04872197523978821
Avg hit ratio: 0.8139842813289334
Avg ndcg: 0.8416596581361974
Avg compression ratio: 0.5203258461029282
Avg train time: 9.184567260742188
Std train time: 1.7754490225428903
[0.875, 0.625, 0.375, 0.875, 0.875, 0.625, 0.375, 0.125, 0.125, 0.125]
[12, 14, 20, 14, 5, 10, 10, 13, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.8816, 'time@10': 9.6351}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.8816, 'time@10': 9.6351}:  10%|█         | 1/10 [00:04<00:43,  4.85s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8591, 'compress@10': 0.7593, 'time@10': 9.8724}:  10%|█         | 1/10 [00:15<00:43,  4.85s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8591, 'compress@10': 0.7593, 'time@10': 9.8724}:  20%|██        | 2/10 [00:15<01:03,  7.97s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8584, 'compress@10': 0.661, 'time@10': 8.3957}:  20%|██        | 2/10 [00:17<01:03,  7.97s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8584, 'compress@10': 0.661, 'time@10': 8.3957}:  30%|███       | 3/10 [00:17<00:39,  5.59s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8568, 'compress@10': 0.7156, 'time@10': 8.2892}:  30%|███       | 3/10 [00:25<00:39,  5.59s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8568, 'compress@10': 0.7156, 'time@10': 8.2892}:  40%|████      | 4/10 [00:25<00:39,  6.54s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.8071, 'ndcg@10': 0.8361, 'compress@10': 0.748, 'time@10': 8.8671}:  40%|████      | 4/10 [00:31<00:39,  6.54s/it] {'epoch': 3, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.8071, 'ndcg@10': 0.8361, 'compress@10': 0.748, 'time@10': 8.8671}:  50%|█████     | 5/10 [00:31<00:31,  6.21s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0516, 'hit_ratio@10': 0.7985, 'ndcg@10': 0.8333, 'compress@10': 0.7289, 'time@10': 9.1129}:  50%|█████     | 5/10 [00:41<00:31,  6.21s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0516, 'hit_ratio@10': 0.7985, 'ndcg@10': 0.8333, 'compress@10': 0.7289, 'time@10': 9.1129}:  60%|██████    | 6/10 [00:41<00:30,  7.63s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8339, 'compress@10': 0.6819, 'time@10': 9.4144}:  60%|██████    | 6/10 [00:47<00:30,  7.63s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8339, 'compress@10': 0.6819, 'time@10': 9.4144}:  70%|███████   | 7/10 [00:47<00:20,  6.98s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0512, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8234, 'compress@10': 0.6154, 'time@10': 9.4866}:  70%|███████   | 7/10 [00:57<00:20,  6.98s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0512, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8234, 'compress@10': 0.6154, 'time@10': 9.4866}:  80%|████████  | 8/10 [00:57<00:15,  7.95s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8332, 'compress@10': 0.5637, 'time@10': 9.6404}:  80%|████████  | 8/10 [01:02<00:15,  7.95s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8332, 'compress@10': 0.5637, 'time@10': 9.6404}:  90%|█████████ | 9/10 [01:02<00:07,  7.18s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.8354, 'compress@10': 0.5218, 'time@10': 9.675}:  90%|█████████ | 9/10 [01:12<00:07,  7.18s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.8354, 'compress@10': 0.5218, 'time@10': 9.675}: 100%|██████████| 10/10 [01:12<00:00,  8.06s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.8354, 'compress@10': 0.5218, 'time@10': 9.675}: 100%|██████████| 10/10 [01:12<00:00,  7.30s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04906219024458075
Avg hit ratio: 0.8368414241860762
Avg ndcg: 0.8354332280300463
Avg compression ratio: 0.5218117575500678
Avg train time: 9.674974656105041
Std train time: 1.665696860793693
[0.9, 0.7, 0.3, 0.7, 0.9, 0.7, 0.3, 0.3, 0.1, 0.1]
[12, 14, 22, 15, 5, 10, 10, 13, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.856, 'compress@10': 0.9052, 'time@10': 9.8391}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.856, 'compress@10': 0.9052, 'time@10': 9.8391}:  10%|█         | 1/10 [00:04<00:44,  4.97s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8595, 'compress@10': 0.8075, 'time@10': 9.8802}:  10%|█         | 1/10 [00:14<00:44,  4.97s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8595, 'compress@10': 0.8075, 'time@10': 9.8802}:  20%|██        | 2/10 [00:14<01:03,  7.91s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8587, 'compress@10': 0.6716, 'time@10': 8.5602}:  20%|██        | 2/10 [00:17<01:03,  7.91s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8587, 'compress@10': 0.6716, 'time@10': 8.5602}:  30%|███       | 3/10 [00:17<00:39,  5.67s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8567, 'compress@10': 0.6814, 'time@10': 8.7546}:  30%|███       | 3/10 [00:27<00:39,  5.67s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8567, 'compress@10': 0.6814, 'time@10': 8.7546}:  40%|████      | 4/10 [00:27<00:42,  7.13s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0468, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8384, 'compress@10': 0.7255, 'time@10': 9.2464}:  40%|████      | 4/10 [00:32<00:42,  7.13s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0468, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8384, 'compress@10': 0.7255, 'time@10': 9.2464}:  50%|█████     | 5/10 [00:32<00:32,  6.59s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0503, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8363, 'compress@10': 0.7224, 'time@10': 9.3871}:  50%|█████     | 5/10 [00:43<00:32,  6.59s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0503, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8363, 'compress@10': 0.7224, 'time@10': 9.3871}:  60%|██████    | 6/10 [00:43<00:31,  7.80s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.05, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8369, 'compress@10': 0.666, 'time@10': 9.6382}:  60%|██████    | 6/10 [00:48<00:31,  7.80s/it]   {'epoch': 4, 'num_users': 6.2857, 'loss': 0.05, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8369, 'compress@10': 0.666, 'time@10': 9.6382}:  70%|███████   | 7/10 [00:48<00:21,  7.08s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0493, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8404, 'compress@10': 0.6228, 'time@10': 9.7143}:  70%|███████   | 7/10 [00:58<00:21,  7.08s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0493, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8404, 'compress@10': 0.6228, 'time@10': 9.7143}:  80%|████████  | 8/10 [00:58<00:16,  8.10s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0485, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8508, 'compress@10': 0.5676, 'time@10': 9.834}:  80%|████████  | 8/10 [01:04<00:16,  8.10s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0485, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8508, 'compress@10': 0.5676, 'time@10': 9.834}:  90%|█████████ | 9/10 [01:04<00:07,  7.27s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8506, 'compress@10': 0.5228, 'time@10': 9.8272}:  90%|█████████ | 9/10 [01:14<00:07,  7.27s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8506, 'compress@10': 0.5228, 'time@10': 9.8272}: 100%|██████████| 10/10 [01:14<00:00,  8.05s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8506, 'compress@10': 0.5228, 'time@10': 9.8272}: 100%|██████████| 10/10 [01:14<00:00,  7.42s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04813173689298865
Avg hit ratio: 0.8638537129725584
Avg ndcg: 0.8505561058837833
Avg compression ratio: 0.522846282464957
Avg train time: 9.827168607711792
Std train time: 1.4265588583421942
[0.9166666666666667, 0.75, 0.25, 0.5833333333333333, 0.9166666666666667, 0.75, 0.41666666666666663, 0.25, 0.08333333333333334, 0.08333333333333334]
[12, 14, 24, 16, 5, 10, 10, 13, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.921, 'time@10': 9.3652}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.921, 'time@10': 9.3652}:  10%|█         | 1/10 [00:04<00:42,  4.72s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8605, 'compress@10': 0.8395, 'time@10': 9.5557}:  10%|█         | 1/10 [00:14<00:42,  4.72s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8605, 'compress@10': 0.8395, 'time@10': 9.5557}:  20%|██        | 2/10 [00:14<01:01,  7.70s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8594, 'compress@10': 0.6787, 'time@10': 8.5117}:  20%|██        | 2/10 [00:17<01:01,  7.70s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8594, 'compress@10': 0.6787, 'time@10': 8.5117}:  30%|███       | 3/10 [00:17<00:39,  5.67s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0396, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8603, 'compress@10': 0.6586, 'time@10': 8.9373}:  30%|███       | 3/10 [00:28<00:39,  5.67s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0396, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8603, 'compress@10': 0.6586, 'time@10': 8.9373}:  40%|████      | 4/10 [00:28<00:44,  7.48s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0502, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.842, 'compress@10': 0.7106, 'time@10': 9.3669}:  40%|████      | 4/10 [00:33<00:44,  7.48s/it] {'epoch': 5, 'num_users': 5.8, 'loss': 0.0502, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.842, 'compress@10': 0.7106, 'time@10': 9.3669}:  50%|█████     | 5/10 [00:33<00:33,  6.79s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0525, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8397, 'compress@10': 0.7181, 'time@10': 9.4848}:  50%|█████     | 5/10 [00:43<00:33,  6.79s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0525, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8397, 'compress@10': 0.7181, 'time@10': 9.4848}:  60%|██████    | 6/10 [00:43<00:31,  7.92s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0518, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8384, 'compress@10': 0.6783, 'time@10': 9.7372}:  60%|██████    | 6/10 [00:49<00:31,  7.92s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0518, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8384, 'compress@10': 0.6783, 'time@10': 9.7372}:  70%|███████   | 7/10 [00:49<00:21,  7.18s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.054, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8471, 'compress@10': 0.6275, 'time@10': 9.8002}:  70%|███████   | 7/10 [00:59<00:21,  7.18s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.054, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8471, 'compress@10': 0.6275, 'time@10': 9.8002}:  80%|████████  | 8/10 [00:59<00:16,  8.17s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0525, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8575, 'compress@10': 0.5699, 'time@10': 9.9014}:  80%|████████  | 8/10 [01:05<00:16,  8.17s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0525, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8575, 'compress@10': 0.5699, 'time@10': 9.9014}:  90%|█████████ | 9/10 [01:05<00:07,  7.30s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0515, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.857, 'compress@10': 0.5233, 'time@10': 9.8693}:  90%|█████████ | 9/10 [01:14<00:07,  7.30s/it]    {'epoch': 5, 'num_users': 6.3, 'loss': 0.0515, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.857, 'compress@10': 0.5233, 'time@10': 9.8693}: 100%|██████████| 10/10 [01:14<00:00,  8.02s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0515, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.857, 'compress@10': 0.5233, 'time@10': 9.8693}: 100%|██████████| 10/10 [01:14<00:00,  7.47s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.051542767595079905
Avg hit ratio: 0.8505874559321078
Avg ndcg: 0.856988342379433
Avg compression ratio: 0.5233455852644173
Avg train time: 9.869309377670287
Std train time: 1.2892237138217302
[0.7857142857142858, 0.6428571428571429, 0.2142857142857143, 0.6428571428571428, 0.9285714285714286, 0.7857142857142857, 0.5, 0.35714285714285715, 0.07142857142857144, 0.07142857142857144]
[13, 14, 26, 16, 5, 10, 10, 13, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 0.797, 'time@10': 10.2411}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 0.797, 'time@10': 10.2411}:  10%|█         | 1/10 [00:05<00:46,  5.16s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0437, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8572, 'compress@10': 0.7257, 'time@10': 10.0614}:  10%|█         | 1/10 [00:15<00:46,  5.16s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0437, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8572, 'compress@10': 0.7257, 'time@10': 10.0614}:  20%|██        | 2/10 [00:15<01:03,  7.96s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8572, 'compress@10': 0.5926, 'time@10': 9.0824}:  20%|██        | 2/10 [00:18<01:03,  7.96s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8572, 'compress@10': 0.5926, 'time@10': 9.0824}:  30%|███       | 3/10 [00:18<00:41,  5.97s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8661, 'compress@10': 0.6084, 'time@10': 9.3237}:  30%|███       | 3/10 [00:28<00:41,  5.97s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8661, 'compress@10': 0.6084, 'time@10': 9.3237}:  40%|████      | 4/10 [00:28<00:45,  7.59s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0433, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8479, 'compress@10': 0.6727, 'time@10': 9.6677}:  40%|████      | 4/10 [00:34<00:45,  7.59s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0433, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8479, 'compress@10': 0.6727, 'time@10': 9.6677}:  50%|█████     | 5/10 [00:34<00:34,  6.86s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.046, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8453, 'compress@10': 0.6923, 'time@10': 9.7237}:  50%|█████     | 5/10 [00:44<00:34,  6.86s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.046, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8453, 'compress@10': 0.6923, 'time@10': 9.7237}:  60%|██████    | 6/10 [00:44<00:31,  7.94s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0456, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8449, 'compress@10': 0.6677, 'time@10': 9.9627}:  60%|██████    | 6/10 [00:50<00:31,  7.94s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0456, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8449, 'compress@10': 0.6677, 'time@10': 9.9627}:  70%|███████   | 7/10 [00:50<00:21,  7.22s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0453, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8379, 'compress@10': 0.6312, 'time@10': 10.0168}:  70%|███████   | 7/10 [01:00<00:21,  7.22s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0453, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8379, 'compress@10': 0.6312, 'time@10': 10.0168}:  80%|████████  | 8/10 [01:00<00:16,  8.25s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0442, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8493, 'compress@10': 0.5719, 'time@10': 10.1012}:  80%|████████  | 8/10 [01:05<00:16,  8.25s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0442, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8493, 'compress@10': 0.5719, 'time@10': 10.1012}:  90%|█████████ | 9/10 [01:05<00:07,  7.37s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0437, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8503, 'compress@10': 0.524, 'time@10': 10.0357}:  90%|█████████ | 9/10 [01:15<00:07,  7.37s/it]    {'epoch': 6, 'num_users': 6.3, 'loss': 0.0437, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8503, 'compress@10': 0.524, 'time@10': 10.0357}: 100%|██████████| 10/10 [01:15<00:00,  8.02s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0437, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8503, 'compress@10': 0.524, 'time@10': 10.0357}: 100%|██████████| 10/10 [01:15<00:00,  7.55s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04366873208704386
Avg hit ratio: 0.8528731702178222
Avg ndcg: 0.8503357786773215
Avg compression ratio: 0.5239963239610143
Avg train time: 10.03568251132965
Std train time: 1.1151572220234967
[0.8125000000000001, 0.5625, 0.1875, 0.5625, 0.9375, 0.8125, 0.5625, 0.4375, 0.06250000000000001, 0.06250000000000001]
[13, 14, 28, 16, 5, 10, 10, 13, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0452, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8605, 'compress@10': 0.8224, 'time@10': 10.3022}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0452, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8605, 'compress@10': 0.8224, 'time@10': 10.3022}:  10%|█         | 1/10 [00:05<00:46,  5.19s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.853, 'compress@10': 0.6995, 'time@10': 10.1949}:  10%|█         | 1/10 [00:15<00:46,  5.19s/it] {'epoch': 7, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.853, 'compress@10': 0.6995, 'time@10': 10.1949}:  20%|██        | 2/10 [00:15<01:04,  8.09s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8544, 'compress@10': 0.5675, 'time@10': 9.3815}:  20%|██        | 2/10 [00:19<01:04,  8.09s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8544, 'compress@10': 0.5675, 'time@10': 9.3815}:  30%|███       | 3/10 [00:19<00:43,  6.18s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8642, 'compress@10': 0.5702, 'time@10': 9.565}:  30%|███       | 3/10 [00:29<00:43,  6.18s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8642, 'compress@10': 0.5702, 'time@10': 9.565}:  40%|████      | 4/10 [00:29<00:46,  7.75s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0437, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8465, 'compress@10': 0.6439, 'time@10': 9.9018}:  40%|████      | 4/10 [00:35<00:46,  7.75s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0437, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8465, 'compress@10': 0.6439, 'time@10': 9.9018}:  50%|█████     | 5/10 [00:35<00:34,  7.00s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0456, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8457, 'compress@10': 0.6727, 'time@10': 9.934}:  50%|█████     | 5/10 [00:45<00:34,  7.00s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0456, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8457, 'compress@10': 0.6727, 'time@10': 9.934}:  60%|██████    | 6/10 [00:45<00:32,  8.06s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.045, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8455, 'compress@10': 0.6594, 'time@10': 10.1148}:  60%|██████    | 6/10 [00:50<00:32,  8.06s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.045, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8455, 'compress@10': 0.6594, 'time@10': 10.1148}:  70%|███████   | 7/10 [00:50<00:21,  7.27s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0429, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8494, 'compress@10': 0.6337, 'time@10': 10.1336}:  70%|███████   | 7/10 [01:01<00:21,  7.27s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0429, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8494, 'compress@10': 0.6337, 'time@10': 10.1336}:  80%|████████  | 8/10 [01:01<00:16,  8.24s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.042, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8574, 'compress@10': 0.5732, 'time@10': 10.2118}:  80%|████████  | 8/10 [01:06<00:16,  8.24s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.042, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8574, 'compress@10': 0.5732, 'time@10': 10.2118}:  90%|█████████ | 9/10 [01:06<00:07,  7.37s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0418, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8574, 'compress@10': 0.5243, 'time@10': 10.1322}:  90%|█████████ | 9/10 [01:16<00:07,  7.37s/it]    {'epoch': 7, 'num_users': 6.3, 'loss': 0.0418, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8574, 'compress@10': 0.5243, 'time@10': 10.1322}: 100%|██████████| 10/10 [01:16<00:00,  8.01s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0418, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8574, 'compress@10': 0.5243, 'time@10': 10.1322}: 100%|██████████| 10/10 [01:16<00:00,  7.60s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.041834387074042405
Avg hit ratio: 0.8600030403476924
Avg ndcg: 0.8573668570245264
Avg compression ratio: 0.5242730320370409
Avg train time: 10.13219358921051
Std train time: 0.9539124544424853
[0.8333333333333335, 0.6111111111111112, 0.16666666666666666, 0.5, 0.9444444444444444, 0.8333333333333334, 0.6111111111111112, 0.3888888888888889, 0.055555555555555566, 0.055555555555555566]
[13, 14, 29, 16, 5, 10, 10, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.8421, 'time@10': 10.078}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.8421, 'time@10': 10.078}:  10%|█         | 1/10 [00:05<00:45,  5.09s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.798, 'ndcg@10': 0.863, 'compress@10': 0.7329, 'time@10': 10.0158}:  10%|█         | 1/10 [00:15<00:45,  5.09s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.798, 'ndcg@10': 0.863, 'compress@10': 0.7329, 'time@10': 10.0158}:  20%|██        | 2/10 [00:15<01:03,  7.97s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8611, 'compress@10': 0.5838, 'time@10': 9.3084}:  20%|██        | 2/10 [00:19<01:03,  7.97s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0306, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8611, 'compress@10': 0.5838, 'time@10': 9.3084}:  30%|███       | 3/10 [00:19<00:43,  6.15s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8624, 'compress@10': 0.5673, 'time@10': 9.5161}:  30%|███       | 3/10 [00:29<00:43,  6.15s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8624, 'compress@10': 0.5673, 'time@10': 9.5161}:  40%|████      | 4/10 [00:29<00:46,  7.74s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.8455, 'compress@10': 0.643, 'time@10': 9.752}:  40%|████      | 4/10 [00:34<00:46,  7.74s/it]  {'epoch': 8, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8078, 'ndcg@10': 0.8455, 'compress@10': 0.643, 'time@10': 9.752}:  50%|█████     | 5/10 [00:34<00:34,  6.89s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0482, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8454, 'compress@10': 0.6753, 'time@10': 9.785}:  50%|█████     | 5/10 [00:44<00:34,  6.89s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0482, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8454, 'compress@10': 0.6753, 'time@10': 9.785}:  60%|██████    | 6/10 [00:44<00:31,  7.94s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0467, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.847, 'compress@10': 0.6684, 'time@10': 9.9362}:  60%|██████    | 6/10 [00:50<00:31,  7.94s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0467, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.847, 'compress@10': 0.6684, 'time@10': 9.9362}:  70%|███████   | 7/10 [00:50<00:21,  7.13s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0453, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8434, 'compress@10': 0.6356, 'time@10': 10.0023}:  70%|███████   | 7/10 [01:00<00:21,  7.13s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0453, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8434, 'compress@10': 0.6356, 'time@10': 10.0023}:  80%|████████  | 8/10 [01:00<00:16,  8.20s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0444, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8518, 'compress@10': 0.5742, 'time@10': 10.117}:  80%|████████  | 8/10 [01:06<00:16,  8.20s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0444, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8518, 'compress@10': 0.5742, 'time@10': 10.117}:  90%|█████████ | 9/10 [01:06<00:07,  7.38s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0431, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8566, 'compress@10': 0.5244, 'time@10': 10.1743}:  90%|█████████ | 9/10 [01:16<00:07,  7.38s/it]  {'epoch': 8, 'num_users': 6.3, 'loss': 0.0431, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8566, 'compress@10': 0.5244, 'time@10': 10.1743}: 100%|██████████| 10/10 [01:16<00:00,  8.41s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0431, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8566, 'compress@10': 0.5244, 'time@10': 10.1743}: 100%|██████████| 10/10 [01:16<00:00,  7.69s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04312352878992633
Avg hit ratio: 0.8540629481817936
Avg ndcg: 0.8565706613288345
Avg compression ratio: 0.5244473980922215
Avg train time: 10.174297714233399
Std train time: 0.8438061607307139
[0.8500000000000001, 0.65, 0.15, 0.55, 0.95, 0.8500000000000001, 0.55, 0.35, 0.05000000000000001, 0.05000000000000001]
[13, 14, 30, 16, 5, 10, 10, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.8579, 'time@10': 9.7545}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.8579, 'time@10': 9.7545}:  10%|█         | 1/10 [00:04<00:44,  4.91s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0429, 'hit_ratio@10': 0.798, 'ndcg@10': 0.9088, 'compress@10': 0.7596, 'time@10': 9.8112}:  10%|█         | 1/10 [00:14<00:44,  4.91s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0429, 'hit_ratio@10': 0.798, 'ndcg@10': 0.9088, 'compress@10': 0.7596, 'time@10': 9.8112}:  20%|██        | 2/10 [00:14<01:02,  7.86s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8916, 'compress@10': 0.5969, 'time@10': 9.2251}:  20%|██        | 2/10 [00:18<01:02,  7.86s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8916, 'compress@10': 0.5969, 'time@10': 9.2251}:  30%|███       | 3/10 [00:18<00:42,  6.12s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8982, 'compress@10': 0.5892, 'time@10': 9.5087}:  30%|███       | 3/10 [00:29<00:42,  6.12s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8982, 'compress@10': 0.5892, 'time@10': 9.5087}:  40%|████      | 4/10 [00:29<00:46,  7.81s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0404, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8738, 'compress@10': 0.6615, 'time@10': 9.7496}:  40%|████      | 4/10 [00:34<00:46,  7.81s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0404, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8738, 'compress@10': 0.6615, 'time@10': 9.7496}:  50%|█████     | 5/10 [00:34<00:34,  6.94s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0416, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8706, 'compress@10': 0.6935, 'time@10': 9.7448}:  50%|█████     | 5/10 [00:44<00:34,  6.94s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0416, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8706, 'compress@10': 0.6935, 'time@10': 9.7448}:  60%|██████    | 6/10 [00:44<00:31,  7.90s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0409, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.871, 'compress@10': 0.6756, 'time@10': 9.9951}:  60%|██████    | 6/10 [00:50<00:31,  7.90s/it] {'epoch': 9, 'num_users': 6.2857, 'loss': 0.0409, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.871, 'compress@10': 0.6756, 'time@10': 9.9951}:  70%|███████   | 7/10 [00:50<00:21,  7.21s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0393, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8725, 'compress@10': 0.6372, 'time@10': 10.0311}:  70%|███████   | 7/10 [01:00<00:21,  7.21s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0393, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8725, 'compress@10': 0.6372, 'time@10': 10.0311}:  80%|████████  | 8/10 [01:00<00:16,  8.20s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0394, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8782, 'compress@10': 0.575, 'time@10': 10.1249}:  80%|████████  | 8/10 [01:06<00:16,  8.20s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0394, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8782, 'compress@10': 0.575, 'time@10': 10.1249}:  90%|█████████ | 9/10 [01:06<00:07,  7.35s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0389, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.881, 'compress@10': 0.5246, 'time@10': 10.2049}:  90%|█████████ | 9/10 [01:16<00:07,  7.35s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0389, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.881, 'compress@10': 0.5246, 'time@10': 10.2049}: 100%|██████████| 10/10 [01:16<00:00,  8.46s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0389, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.881, 'compress@10': 0.5246, 'time@10': 10.2049}: 100%|██████████| 10/10 [01:16<00:00,  7.70s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03888619173896478
Avg hit ratio: 0.8669359640548094
Avg ndcg: 0.8809695022499271
Avg compression ratio: 0.5246293798446582
Avg train time: 10.204920935630799
Std train time: 0.9004448282030366
[0.8636363636363638, 0.6818181818181819, 0.13636363636363635, 0.5, 0.9545454545454545, 0.8636363636363638, 0.5, 0.3181818181818182, 0.13636363636363638, 0.04545454545454546]
[13, 14, 31, 16, 5, 10, 10, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.045, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8541, 'compress@10': 0.8708, 'time@10': 9.8055}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.045, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8541, 'compress@10': 0.8708, 'time@10': 9.8055}:  10%|█         | 1/10 [00:04<00:44,  4.94s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0346, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8767, 'compress@10': 0.7814, 'time@10': 9.8434}:  10%|█         | 1/10 [00:14<00:44,  4.94s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0346, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8767, 'compress@10': 0.7814, 'time@10': 9.8434}:  20%|██        | 2/10 [00:14<01:02,  7.87s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8702, 'compress@10': 0.6075, 'time@10': 9.4207}:  20%|██        | 2/10 [00:19<01:02,  7.87s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8702, 'compress@10': 0.6075, 'time@10': 9.4207}:  30%|███       | 3/10 [00:19<00:43,  6.25s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8861, 'compress@10': 0.5851, 'time@10': 9.674}:  30%|███       | 3/10 [00:29<00:43,  6.25s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8861, 'compress@10': 0.5851, 'time@10': 9.674}:  40%|████      | 4/10 [00:29<00:47,  7.92s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0354, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8644, 'compress@10': 0.6592, 'time@10': 9.8119}:  40%|████      | 4/10 [00:34<00:47,  7.92s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0354, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8644, 'compress@10': 0.6592, 'time@10': 9.8119}:  50%|█████     | 5/10 [00:34<00:34,  6.95s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0366, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.8641, 'compress@10': 0.6938, 'time@10': 9.8176}:  50%|█████     | 5/10 [00:44<00:34,  6.95s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0366, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.8641, 'compress@10': 0.6938, 'time@10': 9.8176}:  60%|██████    | 6/10 [00:44<00:31,  7.94s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0365, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.862, 'compress@10': 0.6689, 'time@10': 10.0896}:  60%|██████    | 6/10 [00:50<00:31,  7.94s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0365, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.862, 'compress@10': 0.6689, 'time@10': 10.0896}:  70%|███████   | 7/10 [00:50<00:21,  7.28s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0372, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.8558, 'compress@10': 0.6275, 'time@10': 10.1281}:  70%|███████   | 7/10 [01:01<00:21,  7.28s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0372, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.8558, 'compress@10': 0.6275, 'time@10': 10.1281}:  80%|████████  | 8/10 [01:01<00:16,  8.28s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0381, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.8646, 'compress@10': 0.5757, 'time@10': 10.2231}:  80%|████████  | 8/10 [01:06<00:16,  8.28s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0381, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.8646, 'compress@10': 0.5757, 'time@10': 10.2231}:  90%|█████████ | 9/10 [01:06<00:07,  7.42s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.8695, 'compress@10': 0.5248, 'time@10': 10.2708}:  90%|█████████ | 9/10 [01:17<00:07,  7.42s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.8695, 'compress@10': 0.5248, 'time@10': 10.2708}: 100%|██████████| 10/10 [01:17<00:00,  8.45s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.8695, 'compress@10': 0.5248, 'time@10': 10.2708}: 100%|██████████| 10/10 [01:17<00:00,  7.74s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.0367205711767902
Avg hit ratio: 0.8888161483866067
Avg ndcg: 0.8694735895772527
Avg compression ratio: 0.5248434321438941
Avg train time: 10.270843005180359
Std train time: 0.791919686693892
[0.8750000000000001, 0.625, 0.12499999999999999, 0.4583333333333333, 0.9583333333333333, 0.8750000000000001, 0.4583333333333333, 0.375, 0.20833333333333337, 0.04166666666666667]
[13, 14, 32, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.8816, 'time@10': 10.3233}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.8816, 'time@10': 10.3233}:  10%|█         | 1/10 [00:05<00:46,  5.21s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8681, 'compress@10': 0.7593, 'time@10': 10.2881}:  10%|█         | 1/10 [00:15<00:46,  5.21s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8681, 'compress@10': 0.7593, 'time@10': 10.2881}:  20%|██        | 2/10 [00:15<01:05,  8.20s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8644, 'compress@10': 0.5896, 'time@10': 9.7722}:  20%|██        | 2/10 [00:19<01:05,  8.20s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8644, 'compress@10': 0.5896, 'time@10': 9.7722}:  30%|███       | 3/10 [00:19<00:45,  6.47s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8985, 'compress@10': 0.5616, 'time@10': 9.9124}:  30%|███       | 3/10 [00:30<00:45,  6.47s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8985, 'compress@10': 0.5616, 'time@10': 9.9124}:  40%|████      | 4/10 [00:30<00:48,  8.01s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0369, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.875, 'compress@10': 0.6411, 'time@10': 9.9847}:  40%|████      | 4/10 [00:35<00:48,  8.01s/it] {'epoch': 11, 'num_users': 5.8, 'loss': 0.0369, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.875, 'compress@10': 0.6411, 'time@10': 9.9847}:  50%|█████     | 5/10 [00:35<00:34,  6.99s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0371, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8733, 'compress@10': 0.6805, 'time@10': 9.9934}:  50%|█████     | 5/10 [00:45<00:34,  6.99s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0371, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8733, 'compress@10': 0.6805, 'time@10': 9.9934}:  60%|██████    | 6/10 [00:45<00:32,  8.04s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0374, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8776, 'compress@10': 0.6519, 'time@10': 10.008}:  60%|██████    | 6/10 [00:50<00:32,  8.04s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0374, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8776, 'compress@10': 0.6519, 'time@10': 10.008}:  70%|███████   | 7/10 [00:50<00:21,  7.07s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0385, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.881, 'compress@10': 0.6195, 'time@10': 10.0551}:  70%|███████   | 7/10 [01:01<00:21,  7.07s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0385, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.881, 'compress@10': 0.6195, 'time@10': 10.0551}:  80%|████████  | 8/10 [01:01<00:16,  8.14s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0391, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8892, 'compress@10': 0.5763, 'time@10': 10.1553}:  80%|████████  | 8/10 [01:06<00:16,  8.14s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0391, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8892, 'compress@10': 0.5763, 'time@10': 10.1553}:  90%|█████████ | 9/10 [01:06<00:07,  7.32s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0383, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8908, 'compress@10': 0.5251, 'time@10': 10.2}:  90%|█████████ | 9/10 [01:17<00:07,  7.32s/it]      {'epoch': 11, 'num_users': 6.3, 'loss': 0.0383, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8908, 'compress@10': 0.5251, 'time@10': 10.2}: 100%|██████████| 10/10 [01:17<00:00,  8.35s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0383, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8908, 'compress@10': 0.5251, 'time@10': 10.2}: 100%|██████████| 10/10 [01:17<00:00,  7.72s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.038294899310009275
Avg hit ratio: 0.8698955134659718
Avg ndcg: 0.8907611531280437
Avg compression ratio: 0.5250537649561976
Avg train time: 10.19995846748352
Std train time: 0.5456423159737998
[0.8846153846153847, 0.5769230769230769, 0.11538461538461538, 0.4230769230769231, 0.9615384615384615, 0.8076923076923078, 0.5, 0.4230769230769231, 0.2692307692307693, 0.038461538461538464]
[13, 14, 33, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8419, 'compress@10': 0.8907, 'time@10': 9.8651}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8419, 'compress@10': 0.8907, 'time@10': 9.8651}:  10%|█         | 1/10 [00:04<00:44,  4.97s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.051, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8909, 'compress@10': 0.7406, 'time@10': 9.9269}:  10%|█         | 1/10 [00:14<00:44,  4.97s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.051, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8909, 'compress@10': 0.7406, 'time@10': 9.9269}:  20%|██        | 2/10 [00:14<01:03,  7.94s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8796, 'compress@10': 0.5743, 'time@10': 9.6136}:  20%|██        | 2/10 [00:19<01:03,  7.94s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8796, 'compress@10': 0.5743, 'time@10': 9.6136}:  30%|███       | 3/10 [00:19<00:44,  6.39s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8929, 'compress@10': 0.5417, 'time@10': 9.7306}:  30%|███       | 3/10 [00:29<00:44,  6.39s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8929, 'compress@10': 0.5417, 'time@10': 9.7306}:  40%|████      | 4/10 [00:29<00:47,  7.86s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0399, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8707, 'compress@10': 0.6258, 'time@10': 9.8446}:  40%|████      | 4/10 [00:34<00:47,  7.86s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0399, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8707, 'compress@10': 0.6258, 'time@10': 9.8446}:  50%|█████     | 5/10 [00:34<00:34,  6.90s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0394, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8703, 'compress@10': 0.6568, 'time@10': 9.8648}:  50%|█████     | 5/10 [00:44<00:34,  6.90s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0394, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8703, 'compress@10': 0.6568, 'time@10': 9.8648}:  60%|██████    | 6/10 [00:44<00:31,  7.95s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0383, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8743, 'compress@10': 0.6373, 'time@10': 9.9241}:  60%|██████    | 6/10 [00:50<00:31,  7.95s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0383, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8743, 'compress@10': 0.6373, 'time@10': 9.9241}:  70%|███████   | 7/10 [00:50<00:21,  7.04s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0375, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.8785, 'compress@10': 0.6126, 'time@10': 9.9861}:  70%|███████   | 7/10 [01:00<00:21,  7.04s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0375, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.8785, 'compress@10': 0.6126, 'time@10': 9.9861}:  80%|████████  | 8/10 [01:00<00:16,  8.13s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0377, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.8838, 'compress@10': 0.5767, 'time@10': 10.1091}:  80%|████████  | 8/10 [01:06<00:16,  8.13s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0377, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.8838, 'compress@10': 0.5767, 'time@10': 10.1091}:  90%|█████████ | 9/10 [01:06<00:07,  7.33s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0361, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8883, 'compress@10': 0.5251, 'time@10': 10.1589}:  90%|█████████ | 9/10 [01:16<00:07,  7.33s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0361, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8883, 'compress@10': 0.5251, 'time@10': 10.1589}: 100%|██████████| 10/10 [01:16<00:00,  8.36s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0361, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.8883, 'compress@10': 0.5251, 'time@10': 10.1589}: 100%|██████████| 10/10 [01:16<00:00,  7.67s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03609844990142981
Avg hit ratio: 0.8903209857488296
Avg ndcg: 0.8883127930381562
Avg compression ratio: 0.5250924517361754
Avg train time: 10.15893051624298
Std train time: 0.5205053634435496
[0.8928571428571429, 0.6071428571428571, 0.10714285714285714, 0.39285714285714285, 0.9642857142857142, 0.8214285714285715, 0.4642857142857143, 0.39285714285714285, 0.32142857142857145, 0.03571428571428572]
[13, 14, 34, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8714, 'compress@10': 0.8985, 'time@10': 9.5391}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8714, 'compress@10': 0.8985, 'time@10': 9.5391}:  10%|█         | 1/10 [00:04<00:43,  4.81s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8876, 'compress@10': 0.7591, 'time@10': 9.648}:  10%|█         | 1/10 [00:14<00:43,  4.81s/it] {'epoch': 13, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8876, 'compress@10': 0.7591, 'time@10': 9.648}:  20%|██        | 2/10 [00:14<01:01,  7.74s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8774, 'compress@10': 0.5843, 'time@10': 9.3965}:  20%|██        | 2/10 [00:19<01:01,  7.74s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8774, 'compress@10': 0.5843, 'time@10': 9.3965}:  30%|███       | 3/10 [00:19<00:43,  6.25s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0382, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8721, 'compress@10': 0.5419, 'time@10': 9.6783}:  30%|███       | 3/10 [00:29<00:43,  6.25s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0382, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8721, 'compress@10': 0.5419, 'time@10': 9.6783}:  40%|████      | 4/10 [00:29<00:47,  7.95s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8541, 'compress@10': 0.6265, 'time@10': 9.8594}:  40%|████      | 4/10 [00:34<00:47,  7.95s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8541, 'compress@10': 0.6265, 'time@10': 9.8594}:  50%|█████     | 5/10 [00:34<00:35,  7.01s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0442, 'hit_ratio@10': 0.842, 'ndcg@10': 0.859, 'compress@10': 0.6596, 'time@10': 9.8596}:  50%|█████     | 5/10 [00:44<00:35,  7.01s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0442, 'hit_ratio@10': 0.842, 'ndcg@10': 0.859, 'compress@10': 0.6596, 'time@10': 9.8596}:  60%|██████    | 6/10 [00:44<00:31,  7.99s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0422, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8641, 'compress@10': 0.6348, 'time@10': 9.9281}:  60%|██████    | 6/10 [00:50<00:31,  7.99s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0422, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8641, 'compress@10': 0.6348, 'time@10': 9.9281}:  70%|███████   | 7/10 [00:50<00:21,  7.08s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0432, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8747, 'compress@10': 0.6067, 'time@10': 10.0046}:  70%|███████   | 7/10 [01:00<00:21,  7.08s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0432, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8747, 'compress@10': 0.6067, 'time@10': 10.0046}:  80%|████████  | 8/10 [01:00<00:16,  8.19s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0421, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8801, 'compress@10': 0.5772, 'time@10': 10.1586}:  80%|████████  | 8/10 [01:06<00:16,  8.19s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0421, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8801, 'compress@10': 0.5772, 'time@10': 10.1586}:  90%|█████████ | 9/10 [01:06<00:07,  7.42s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0405, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8844, 'compress@10': 0.5252, 'time@10': 10.1993}:  90%|█████████ | 9/10 [01:16<00:07,  7.42s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0405, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8844, 'compress@10': 0.5252, 'time@10': 10.1993}: 100%|██████████| 10/10 [01:16<00:00,  8.41s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0405, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8844, 'compress@10': 0.5252, 'time@10': 10.1993}: 100%|██████████| 10/10 [01:16<00:00,  7.70s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.040504323035969694
Avg hit ratio: 0.8680946942135398
Avg ndcg: 0.8844213933656215
Avg compression ratio: 0.5252275107172275
Avg train time: 10.199331402778625
Std train time: 0.6627906967651487
[0.8333333333333334, 0.6333333333333333, 0.09999999999999999, 0.43333333333333335, 0.9666666666666666, 0.8333333333333334, 0.43333333333333335, 0.43333333333333335, 0.30000000000000004, 0.03333333333333334]
[13, 14, 35, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0374, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8722, 'compress@10': 0.8421, 'time@10': 9.7203}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0374, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8722, 'compress@10': 0.8421, 'time@10': 9.7203}:  10%|█         | 1/10 [00:04<00:44,  4.90s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.798, 'ndcg@10': 0.9018, 'compress@10': 0.7436, 'time@10': 9.9027}:  10%|█         | 1/10 [00:15<00:44,  4.90s/it] {'epoch': 14, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.798, 'ndcg@10': 0.9018, 'compress@10': 0.7436, 'time@10': 9.9027}:  20%|██        | 2/10 [00:15<01:03,  7.97s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8869, 'compress@10': 0.5719, 'time@10': 9.8058}:  20%|██        | 2/10 [00:19<01:03,  7.97s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8869, 'compress@10': 0.5719, 'time@10': 9.8058}:  30%|███       | 3/10 [00:19<00:45,  6.54s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8992, 'compress@10': 0.5424, 'time@10': 9.8726}:  30%|███       | 3/10 [00:29<00:45,  6.54s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8992, 'compress@10': 0.5424, 'time@10': 9.8726}:  40%|████      | 4/10 [00:29<00:47,  7.95s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0303, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8758, 'compress@10': 0.6273, 'time@10': 9.9409}:  40%|████      | 4/10 [00:35<00:47,  7.95s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0303, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8758, 'compress@10': 0.6273, 'time@10': 9.9409}:  50%|█████     | 5/10 [00:35<00:34,  6.94s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0305, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8791, 'compress@10': 0.6623, 'time@10': 9.9286}:  50%|█████     | 5/10 [00:45<00:34,  6.94s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0305, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8791, 'compress@10': 0.6623, 'time@10': 9.9286}:  60%|██████    | 6/10 [00:45<00:31,  7.95s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0302, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8822, 'compress@10': 0.6328, 'time@10': 9.9876}:  60%|██████    | 6/10 [00:50<00:31,  7.95s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0302, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8822, 'compress@10': 0.6328, 'time@10': 9.9876}:  70%|███████   | 7/10 [00:50<00:21,  7.05s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8863, 'compress@10': 0.6099, 'time@10': 10.0646}:  70%|███████   | 7/10 [01:00<00:21,  7.05s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8863, 'compress@10': 0.6099, 'time@10': 10.0646}:  80%|████████  | 8/10 [01:00<00:16,  8.19s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8902, 'compress@10': 0.5777, 'time@10': 10.18}:  80%|████████  | 8/10 [01:06<00:16,  8.19s/it]  {'epoch': 14, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8902, 'compress@10': 0.5777, 'time@10': 10.18}:  90%|█████████ | 9/10 [01:06<00:07,  7.38s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8947, 'compress@10': 0.5255, 'time@10': 10.2314}:  90%|█████████ | 9/10 [01:17<00:07,  7.38s/it] {'epoch': 14, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8947, 'compress@10': 0.5255, 'time@10': 10.2314}: 100%|██████████| 10/10 [01:17<00:00,  8.41s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8947, 'compress@10': 0.5255, 'time@10': 10.2314}: 100%|██████████| 10/10 [01:17<00:00,  7.72s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.027957390132408055
Avg hit ratio: 0.8680946942135398
Avg ndcg: 0.8947303655251095
Avg compression ratio: 0.5254580044961201
Avg train time: 10.2313791513443
Std train time: 0.4414718395759931
[0.84375, 0.59375, 0.09374999999999999, 0.40625, 0.9687499999999999, 0.84375, 0.46875, 0.40625, 0.34375000000000006, 0.03125000000000001]
[13, 14, 35, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8849, 'compress@10': 0.852, 'time@10': 10.0135}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8849, 'compress@10': 0.852, 'time@10': 10.0135}:  10%|█         | 1/10 [00:05<00:45,  5.04s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.9136, 'compress@10': 0.7294, 'time@10': 10.0963}:  10%|█         | 1/10 [00:15<00:45,  5.04s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.9136, 'compress@10': 0.7294, 'time@10': 10.0963}:  20%|██        | 2/10 [00:15<01:04,  8.09s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8948, 'compress@10': 0.5607, 'time@10': 9.7637}:  20%|██        | 2/10 [00:19<01:04,  8.09s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8948, 'compress@10': 0.5607, 'time@10': 9.7637}:  30%|███       | 3/10 [00:19<00:45,  6.49s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8978, 'compress@10': 0.5274, 'time@10': 9.8736}:  30%|███       | 3/10 [00:30<00:45,  6.49s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8978, 'compress@10': 0.5274, 'time@10': 9.8736}:  40%|████      | 4/10 [00:30<00:47,  7.97s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0307, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8748, 'compress@10': 0.6158, 'time@10': 9.9506}:  40%|████      | 4/10 [00:35<00:47,  7.97s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0307, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8748, 'compress@10': 0.6158, 'time@10': 9.9506}:  50%|█████     | 5/10 [00:35<00:34,  6.96s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0301, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8787, 'compress@10': 0.6543, 'time@10': 9.9476}:  50%|█████     | 5/10 [00:45<00:34,  6.96s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0301, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8787, 'compress@10': 0.6543, 'time@10': 9.9476}:  60%|██████    | 6/10 [00:45<00:31,  7.98s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0299, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8828, 'compress@10': 0.6309, 'time@10': 10.0197}:  60%|██████    | 6/10 [00:50<00:31,  7.98s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0299, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8828, 'compress@10': 0.6309, 'time@10': 10.0197}:  70%|███████   | 7/10 [00:50<00:21,  7.09s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0293, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.883, 'compress@10': 0.6049, 'time@10': 10.0734}:  70%|███████   | 7/10 [01:00<00:21,  7.09s/it]  {'epoch': 15, 'num_users': 6.125, 'loss': 0.0293, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.883, 'compress@10': 0.6049, 'time@10': 10.0734}:  80%|████████  | 8/10 [01:00<00:16,  8.17s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0294, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8879, 'compress@10': 0.578, 'time@10': 10.2132}:  80%|████████  | 8/10 [01:06<00:16,  8.17s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0294, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8879, 'compress@10': 0.578, 'time@10': 10.2132}:  90%|█████████ | 9/10 [01:06<00:07,  7.42s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0289, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8932, 'compress@10': 0.5255, 'time@10': 10.2435}:  90%|█████████ | 9/10 [01:17<00:07,  7.42s/it]  {'epoch': 15, 'num_users': 6.3, 'loss': 0.0289, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8932, 'compress@10': 0.5255, 'time@10': 10.2435}: 100%|██████████| 10/10 [01:17<00:00,  8.39s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0289, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8932, 'compress@10': 0.5255, 'time@10': 10.2435}: 100%|██████████| 10/10 [01:17<00:00,  7.73s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.028852226692520626
Avg hit ratio: 0.8723075136521656
Avg ndcg: 0.8932097085542058
Avg compression ratio: 0.5255053899301501
Avg train time: 10.243537831306458
Std train time: 0.5302323373247735
[0.8529411764705882, 0.5588235294117647, 0.08823529411764705, 0.4411764705882353, 0.9705882352941175, 0.7941176470588235, 0.5, 0.38235294117647056, 0.3823529411764707, 0.02941176470588236]
[13, 14, 36, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0329, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8819, 'compress@10': 0.8607, 'time@10': 9.9694}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0329, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8819, 'compress@10': 0.8607, 'time@10': 9.9694}:  10%|█         | 1/10 [00:05<00:45,  5.02s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.9126, 'compress@10': 0.7169, 'time@10': 10.0171}:  10%|█         | 1/10 [00:15<00:45,  5.02s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.9126, 'compress@10': 0.7169, 'time@10': 10.0171}:  20%|██        | 2/10 [00:15<01:04,  8.01s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8941, 'compress@10': 0.5507, 'time@10': 9.8966}:  20%|██        | 2/10 [00:19<01:04,  8.01s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8941, 'compress@10': 0.5507, 'time@10': 9.8966}:  30%|███       | 3/10 [00:19<00:46,  6.58s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9118, 'compress@10': 0.5283, 'time@10': 10.0083}:  30%|███       | 3/10 [00:30<00:46,  6.58s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9118, 'compress@10': 0.5283, 'time@10': 10.0083}:  40%|████      | 4/10 [00:30<00:48,  8.08s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0267, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8866, 'compress@10': 0.6169, 'time@10': 10.0221}:  40%|████      | 4/10 [00:35<00:48,  8.08s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0267, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8866, 'compress@10': 0.6169, 'time@10': 10.0221}:  50%|█████     | 5/10 [00:35<00:34,  7.00s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0274, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.888, 'compress@10': 0.6472, 'time@10': 10.0133}:  50%|█████     | 5/10 [00:45<00:34,  7.00s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0274, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.888, 'compress@10': 0.6472, 'time@10': 10.0133}:  60%|██████    | 6/10 [00:45<00:32,  8.02s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0277, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.891, 'compress@10': 0.629, 'time@10': 10.0433}:  60%|██████    | 6/10 [00:50<00:32,  8.02s/it] {'epoch': 16, 'num_users': 6.2857, 'loss': 0.0277, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.891, 'compress@10': 0.629, 'time@10': 10.0433}:  70%|███████   | 7/10 [00:50<00:21,  7.08s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0273, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.898, 'compress@10': 0.6004, 'time@10': 10.108}:  70%|███████   | 7/10 [01:01<00:21,  7.08s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0273, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.898, 'compress@10': 0.6004, 'time@10': 10.108}:  80%|████████  | 8/10 [01:01<00:16,  8.20s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.028, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.9011, 'compress@10': 0.5781, 'time@10': 10.2446}:  80%|████████  | 8/10 [01:06<00:16,  8.20s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.028, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.9011, 'compress@10': 0.5781, 'time@10': 10.2446}:  90%|█████████ | 9/10 [01:06<00:07,  7.42s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9057, 'compress@10': 0.5255, 'time@10': 10.2689}:  90%|█████████ | 9/10 [01:17<00:07,  7.42s/it]  {'epoch': 16, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9057, 'compress@10': 0.5255, 'time@10': 10.2689}: 100%|██████████| 10/10 [01:17<00:00,  8.38s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9057, 'compress@10': 0.5255, 'time@10': 10.2689}: 100%|██████████| 10/10 [01:17<00:00,  7.74s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.026937364215680777
Avg hit ratio: 0.8743075136521655
Avg ndcg: 0.9056521698484581
Avg compression ratio: 0.5254661682964461
Avg train time: 10.268882942199706
Std train time: 0.43767754100336165
[0.861111111111111, 0.5277777777777778, 0.08333333333333333, 0.41666666666666663, 0.9722222222222221, 0.8055555555555555, 0.5277777777777778, 0.3611111111111111, 0.41666666666666674, 0.027777777777777783]
[13, 14, 36, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8849, 'compress@10': 0.8684, 'time@10': 9.8068}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8849, 'compress@10': 0.8684, 'time@10': 9.8068}:  10%|█         | 1/10 [00:04<00:44,  4.94s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9113, 'compress@10': 0.7057, 'time@10': 9.9425}:  10%|█         | 1/10 [00:15<00:44,  4.94s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9113, 'compress@10': 0.7057, 'time@10': 9.9425}:  20%|██        | 2/10 [00:15<01:03,  7.98s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8933, 'compress@10': 0.5419, 'time@10': 9.7854}:  20%|██        | 2/10 [00:19<01:03,  7.98s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8933, 'compress@10': 0.5419, 'time@10': 9.7854}:  30%|███       | 3/10 [00:19<00:45,  6.52s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.911, 'compress@10': 0.5158, 'time@10': 9.9242}:  30%|███       | 3/10 [00:30<00:45,  6.52s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.911, 'compress@10': 0.5158, 'time@10': 9.9242}:  40%|████      | 4/10 [00:30<00:48,  8.04s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0261, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8865, 'compress@10': 0.6072, 'time@10': 10.0161}:  40%|████      | 4/10 [00:35<00:48,  8.04s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0261, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8865, 'compress@10': 0.6072, 'time@10': 10.0161}:  50%|█████     | 5/10 [00:35<00:35,  7.03s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0275, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8928, 'compress@10': 0.641, 'time@10': 10.0214}:  50%|█████     | 5/10 [00:45<00:35,  7.03s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0275, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8928, 'compress@10': 0.641, 'time@10': 10.0214}:  60%|██████    | 6/10 [00:45<00:32,  8.07s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0275, 'hit_ratio@10': 0.881, 'ndcg@10': 0.8956, 'compress@10': 0.6275, 'time@10': 10.0441}:  60%|██████    | 6/10 [00:50<00:32,  8.07s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0275, 'hit_ratio@10': 0.881, 'ndcg@10': 0.8956, 'compress@10': 0.6275, 'time@10': 10.0441}:  70%|███████   | 7/10 [00:50<00:21,  7.11s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0305, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9005, 'compress@10': 0.5965, 'time@10': 10.1131}:  70%|███████   | 7/10 [01:01<00:21,  7.11s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0305, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9005, 'compress@10': 0.5965, 'time@10': 10.1131}:  80%|████████  | 8/10 [01:01<00:16,  8.23s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0308, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9039, 'compress@10': 0.5784, 'time@10': 10.2395}:  80%|████████  | 8/10 [01:06<00:16,  8.23s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0308, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9039, 'compress@10': 0.5784, 'time@10': 10.2395}:  90%|█████████ | 9/10 [01:06<00:07,  7.43s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9088, 'compress@10': 0.5255, 'time@10': 10.2747}:  90%|█████████ | 9/10 [01:17<00:07,  7.43s/it]    {'epoch': 17, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9088, 'compress@10': 0.5255, 'time@10': 10.2747}: 100%|██████████| 10/10 [01:17<00:00,  8.42s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9088, 'compress@10': 0.5255, 'time@10': 10.2747}: 100%|██████████| 10/10 [01:17<00:00,  7.76s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02977136820914348
Avg hit ratio: 0.8830187002207376
Avg ndcg: 0.9087761145515987
Avg compression ratio: 0.5255076338204623
Avg train time: 10.274739241600036
Std train time: 0.4621807970701113
[0.8684210526315789, 0.5, 0.07894736842105263, 0.3947368421052631, 0.9736842105263157, 0.8157894736842104, 0.5, 0.39473684210526316, 0.44736842105263164, 0.026315789473684216]
[13, 14, 36, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0275, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8849, 'compress@10': 0.8753, 'time@10': 9.6235}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0275, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8849, 'compress@10': 0.8753, 'time@10': 9.6235}:  10%|█         | 1/10 [00:04<00:43,  4.85s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0428, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9418, 'compress@10': 0.6957, 'time@10': 9.9624}:  10%|█         | 1/10 [00:15<00:43,  4.85s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0428, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9418, 'compress@10': 0.6957, 'time@10': 9.9624}:  20%|██        | 2/10 [00:15<01:04,  8.08s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.9136, 'compress@10': 0.534, 'time@10': 9.7339}:  20%|██        | 2/10 [00:19<01:04,  8.08s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.9136, 'compress@10': 0.534, 'time@10': 9.7339}:  30%|███       | 3/10 [00:19<00:45,  6.53s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.847, 'ndcg@10': 0.945, 'compress@10': 0.5046, 'time@10': 9.8692}:  30%|███       | 3/10 [00:30<00:45,  6.53s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.847, 'ndcg@10': 0.945, 'compress@10': 0.5046, 'time@10': 9.8692}:  40%|████      | 4/10 [00:30<00:48,  8.02s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0362, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.9137, 'compress@10': 0.5985, 'time@10': 9.9255}:  40%|████      | 4/10 [00:35<00:48,  8.02s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0362, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.9137, 'compress@10': 0.5985, 'time@10': 9.9255}:  50%|█████     | 5/10 [00:35<00:34,  6.97s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0334, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9154, 'compress@10': 0.6354, 'time@10': 9.9069}:  50%|█████     | 5/10 [00:45<00:34,  6.97s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0334, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9154, 'compress@10': 0.6354, 'time@10': 9.9069}:  60%|██████    | 6/10 [00:45<00:31,  7.95s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0321, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9155, 'compress@10': 0.6189, 'time@10': 9.9658}:  60%|██████    | 6/10 [00:50<00:31,  7.95s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0321, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9155, 'compress@10': 0.6189, 'time@10': 9.9658}:  70%|███████   | 7/10 [00:50<00:21,  7.05s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0295, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9199, 'compress@10': 0.5931, 'time@10': 10.036}:  70%|███████   | 7/10 [01:00<00:21,  7.05s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0295, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9199, 'compress@10': 0.5931, 'time@10': 10.036}:  80%|████████  | 8/10 [01:00<00:16,  8.17s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0298, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9212, 'compress@10': 0.5786, 'time@10': 10.1708}:  80%|████████  | 8/10 [01:06<00:16,  8.17s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0298, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9212, 'compress@10': 0.5786, 'time@10': 10.1708}:  90%|█████████ | 9/10 [01:06<00:07,  7.39s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0284, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9248, 'compress@10': 0.5256, 'time@10': 10.1867}:  90%|█████████ | 9/10 [01:16<00:07,  7.39s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0284, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9248, 'compress@10': 0.5256, 'time@10': 10.1867}: 100%|██████████| 10/10 [01:16<00:00,  8.31s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0284, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9248, 'compress@10': 0.5256, 'time@10': 10.1867}: 100%|██████████| 10/10 [01:16<00:00,  7.69s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.028396183962804755
Avg hit ratio: 0.8873079987358425
Avg ndcg: 0.9248494856912919
Avg compression ratio: 0.5256045531107834
Avg train time: 10.186732053756714
Std train time: 0.5088673532111258
[0.8749999999999999, 0.525, 0.075, 0.42499999999999993, 0.9749999999999999, 0.7749999999999999, 0.475, 0.375, 0.47500000000000003, 0.025000000000000005]
[13, 14, 37, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8951, 'compress@10': 0.8816, 'time@10': 9.8039}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8951, 'compress@10': 0.8816, 'time@10': 9.8039}:  10%|█         | 1/10 [00:04<00:44,  4.94s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8783, 'compress@10': 0.7109, 'time@10': 9.91}:  10%|█         | 1/10 [00:14<00:44,  4.94s/it] {'epoch': 19, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8783, 'compress@10': 0.7109, 'time@10': 9.91}:  20%|██        | 2/10 [00:14<01:03,  7.95s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8713, 'compress@10': 0.543, 'time@10': 9.8937}:  20%|██        | 2/10 [00:19<01:03,  7.95s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8713, 'compress@10': 0.543, 'time@10': 9.8937}:  30%|███       | 3/10 [00:19<00:46,  6.59s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.8851, 'compress@10': 0.5186, 'time@10': 9.9738}:  30%|███       | 3/10 [00:30<00:46,  6.59s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.8851, 'compress@10': 0.5186, 'time@10': 9.9738}:  40%|████      | 4/10 [00:30<00:48,  8.03s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0286, 'hit_ratio@10': 0.887, 'ndcg@10': 0.8668, 'compress@10': 0.61, 'time@10': 9.9793}:  40%|████      | 4/10 [00:35<00:48,  8.03s/it] {'epoch': 19, 'num_users': 5.8, 'loss': 0.0286, 'hit_ratio@10': 0.887, 'ndcg@10': 0.8668, 'compress@10': 0.61, 'time@10': 9.9793}:  50%|█████     | 5/10 [00:35<00:34,  6.95s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0269, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8782, 'compress@10': 0.6383, 'time@10': 9.9875}:  50%|█████     | 5/10 [00:45<00:34,  6.95s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0269, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8782, 'compress@10': 0.6383, 'time@10': 9.9875}:  60%|██████    | 6/10 [00:45<00:32,  8.01s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0264, 'hit_ratio@10': 0.904, 'ndcg@10': 0.8844, 'compress@10': 0.618, 'time@10': 10.0517}:  60%|██████    | 6/10 [00:50<00:32,  8.01s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0264, 'hit_ratio@10': 0.904, 'ndcg@10': 0.8844, 'compress@10': 0.618, 'time@10': 10.0517}:  70%|███████   | 7/10 [00:50<00:21,  7.11s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0255, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.8894, 'compress@10': 0.5899, 'time@10': 10.1113}:  70%|███████   | 7/10 [01:01<00:21,  7.11s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0255, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.8894, 'compress@10': 0.5899, 'time@10': 10.1113}:  80%|████████  | 8/10 [01:01<00:16,  8.21s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8943, 'compress@10': 0.5788, 'time@10': 10.2348}:  80%|████████  | 8/10 [01:06<00:16,  8.21s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8943, 'compress@10': 0.5788, 'time@10': 10.2348}:  90%|█████████ | 9/10 [01:06<00:07,  7.41s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0252, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9006, 'compress@10': 0.5256, 'time@10': 10.2625}:  90%|█████████ | 9/10 [01:17<00:07,  7.41s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 0.0252, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9006, 'compress@10': 0.5256, 'time@10': 10.2625}: 100%|██████████| 10/10 [01:17<00:00,  8.38s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0252, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9006, 'compress@10': 0.5256, 'time@10': 10.2625}: 100%|██████████| 10/10 [01:17<00:00,  7.73s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.025232248125583077
Avg hit ratio: 0.9048338294416393
Avg ndcg: 0.9005784232074895
Avg compression ratio: 0.5256072508148347
Avg train time: 10.262507581710816
Std train time: 0.40534195619673413
[0.8809523809523808, 0.5476190476190477, 0.07142857142857142, 0.4047619047619047, 0.976190476190476, 0.738095238095238, 0.5, 0.35714285714285715, 0.5, 0.023809523809523815]
[13, 14, 37, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8951, 'compress@10': 0.8872, 'time@10': 9.753}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8951, 'compress@10': 0.8872, 'time@10': 9.753}:  10%|█         | 1/10 [00:04<00:44,  4.93s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9229, 'compress@10': 0.7247, 'time@10': 9.8104}:  10%|█         | 1/10 [00:14<00:44,  4.93s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9229, 'compress@10': 0.7247, 'time@10': 9.8104}:  20%|██        | 2/10 [00:14<01:02,  7.86s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.842, 'ndcg@10': 0.901, 'compress@10': 0.5512, 'time@10': 9.7487}:  20%|██        | 2/10 [00:19<01:02,  7.86s/it]  {'epoch': 20, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.842, 'ndcg@10': 0.901, 'compress@10': 0.5512, 'time@10': 9.7487}:  30%|███       | 3/10 [00:19<00:45,  6.48s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9149, 'compress@10': 0.5199, 'time@10': 9.849}:  30%|███       | 3/10 [00:29<00:45,  6.48s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9149, 'compress@10': 0.5199, 'time@10': 9.849}:  40%|████      | 4/10 [00:29<00:47,  7.95s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.8898, 'compress@10': 0.6112, 'time@10': 9.9169}:  40%|████      | 4/10 [00:35<00:47,  7.95s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.8898, 'compress@10': 0.6112, 'time@10': 9.9169}:  50%|█████     | 5/10 [00:35<00:34,  6.93s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0251, 'hit_ratio@10': 0.891, 'ndcg@10': 0.8976, 'compress@10': 0.6333, 'time@10': 9.9571}:  50%|█████     | 5/10 [00:45<00:34,  6.93s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0251, 'hit_ratio@10': 0.891, 'ndcg@10': 0.8976, 'compress@10': 0.6333, 'time@10': 9.9571}:  60%|██████    | 6/10 [00:45<00:32,  8.04s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0246, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9024, 'compress@10': 0.6172, 'time@10': 10.0253}:  60%|██████    | 6/10 [00:50<00:32,  8.04s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0246, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9024, 'compress@10': 0.6172, 'time@10': 10.0253}:  70%|███████   | 7/10 [00:50<00:21,  7.13s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9094, 'compress@10': 0.5869, 'time@10': 10.0692}:  70%|███████   | 7/10 [01:00<00:21,  7.13s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.9094, 'compress@10': 0.5869, 'time@10': 10.0692}:  80%|████████  | 8/10 [01:00<00:16,  8.18s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9121, 'compress@10': 0.5789, 'time@10': 10.2074}:  80%|████████  | 8/10 [01:06<00:16,  8.18s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9121, 'compress@10': 0.5789, 'time@10': 10.2074}:  90%|█████████ | 9/10 [01:06<00:07,  7.40s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9172, 'compress@10': 0.5256, 'time@10': 10.2244}:  90%|█████████ | 9/10 [01:16<00:07,  7.40s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9172, 'compress@10': 0.5256, 'time@10': 10.2244}: 100%|██████████| 10/10 [01:16<00:00,  8.33s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9172, 'compress@10': 0.5256, 'time@10': 10.2244}: 100%|██████████| 10/10 [01:16<00:00,  7.70s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.02278348548717365
Avg hit ratio: 0.9026044387606357
Avg ndcg: 0.9171685751209955
Avg compression ratio: 0.5255888308221282
Avg train time: 10.224398851394653
Std train time: 0.4465502603076287
[0.8863636363636362, 0.5227272727272728, 0.06818181818181818, 0.3863636363636363, 0.9772727272727272, 0.7499999999999999, 0.5227272727272727, 0.34090909090909094, 0.5227272727272727, 0.02272727272727273]
[13, 14, 37, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8978, 'compress@10': 0.8923, 'time@10': 9.8773}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8978, 'compress@10': 0.8923, 'time@10': 9.8773}:  10%|█         | 1/10 [00:04<00:44,  4.98s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9247, 'compress@10': 0.7152, 'time@10': 9.903}:  10%|█         | 1/10 [00:14<00:44,  4.98s/it] {'epoch': 21, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9247, 'compress@10': 0.7152, 'time@10': 9.903}:  20%|██        | 2/10 [00:14<01:03,  7.91s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9022, 'compress@10': 0.5439, 'time@10': 9.9624}:  20%|██        | 2/10 [00:20<01:03,  7.91s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9022, 'compress@10': 0.5439, 'time@10': 9.9624}:  30%|███       | 3/10 [00:20<00:46,  6.62s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9204, 'compress@10': 0.51, 'time@10': 10.0002}:  30%|███       | 3/10 [00:30<00:46,  6.62s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9204, 'compress@10': 0.51, 'time@10': 10.0002}:  40%|████      | 4/10 [00:30<00:48,  8.02s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8948, 'compress@10': 0.6035, 'time@10': 10.0594}:  40%|████      | 4/10 [00:35<00:48,  8.02s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.8948, 'compress@10': 0.6035, 'time@10': 10.0594}:  50%|█████     | 5/10 [00:35<00:34,  7.00s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0228, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9025, 'compress@10': 0.6289, 'time@10': 10.074}:  50%|█████     | 5/10 [00:45<00:34,  7.00s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0228, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9025, 'compress@10': 0.6289, 'time@10': 10.074}:  60%|██████    | 6/10 [00:45<00:32,  8.08s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0229, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9073, 'compress@10': 0.6164, 'time@10': 10.1418}:  60%|██████    | 6/10 [00:50<00:32,  8.08s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0229, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9073, 'compress@10': 0.6164, 'time@10': 10.1418}:  70%|███████   | 7/10 [00:50<00:21,  7.17s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0259, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.8963, 'compress@10': 0.5844, 'time@10': 10.1912}:  70%|███████   | 7/10 [01:01<00:21,  7.17s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0259, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.8963, 'compress@10': 0.5844, 'time@10': 10.1912}:  80%|████████  | 8/10 [01:01<00:16,  8.26s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0261, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9004, 'compress@10': 0.579, 'time@10': 10.3043}:  80%|████████  | 8/10 [01:07<00:16,  8.26s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0261, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9004, 'compress@10': 0.579, 'time@10': 10.3043}:  90%|█████████ | 9/10 [01:07<00:07,  7.44s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.025, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9071, 'compress@10': 0.5256, 'time@10': 10.3056}:  90%|█████████ | 9/10 [01:17<00:07,  7.44s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.025, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9071, 'compress@10': 0.5256, 'time@10': 10.3056}: 100%|██████████| 10/10 [01:17<00:00,  8.34s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.025, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9071, 'compress@10': 0.5256, 'time@10': 10.3056}: 100%|██████████| 10/10 [01:17<00:00,  7.74s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.025039658625471035
Avg hit ratio: 0.9068942223594174
Avg ndcg: 0.9071146943042289
Avg compression ratio: 0.5256163176513707
Avg train time: 10.305622816085815
Std train time: 0.3698618071749256
[0.8913043478260868, 0.5000000000000001, 0.06521739130434782, 0.36956521739130427, 0.9782608695652173, 0.7173913043478259, 0.5434782608695652, 0.3695652173913044, 0.5434782608695652, 0.02173913043478261]
[13, 14, 37, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8952, 'compress@10': 0.897, 'time@10': 9.448}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8952, 'compress@10': 0.897, 'time@10': 9.448}:  10%|█         | 1/10 [00:04<00:42,  4.76s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9329, 'compress@10': 0.7066, 'time@10': 9.7457}:  10%|█         | 1/10 [00:14<00:42,  4.76s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9329, 'compress@10': 0.7066, 'time@10': 9.7457}:  20%|██        | 2/10 [00:14<01:03,  7.89s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9076, 'compress@10': 0.5373, 'time@10': 9.7479}:  20%|██        | 2/10 [00:19<01:03,  7.89s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9076, 'compress@10': 0.5373, 'time@10': 9.7479}:  30%|███       | 3/10 [00:19<00:45,  6.53s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.819, 'ndcg@10': 0.9263, 'compress@10': 0.501, 'time@10': 9.8447}:  30%|███       | 3/10 [00:29<00:45,  6.53s/it]  {'epoch': 22, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.819, 'ndcg@10': 0.9263, 'compress@10': 0.501, 'time@10': 9.8447}:  40%|████      | 4/10 [00:29<00:47,  7.97s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.9004, 'compress@10': 0.5965, 'time@10': 9.9815}:  40%|████      | 4/10 [00:35<00:47,  7.97s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.9004, 'compress@10': 0.5965, 'time@10': 9.9815}:  50%|█████     | 5/10 [00:35<00:35,  7.01s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.9084, 'compress@10': 0.6177, 'time@10': 9.9876}:  50%|█████     | 5/10 [00:45<00:35,  7.01s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.9084, 'compress@10': 0.6177, 'time@10': 9.9876}:  60%|██████    | 6/10 [00:45<00:32,  8.04s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0207, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9117, 'compress@10': 0.6097, 'time@10': 10.0298}:  60%|██████    | 6/10 [00:50<00:32,  8.04s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0207, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9117, 'compress@10': 0.6097, 'time@10': 10.0298}:  70%|███████   | 7/10 [00:50<00:21,  7.11s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9174, 'compress@10': 0.582, 'time@10': 10.0703}:  70%|███████   | 7/10 [01:00<00:21,  7.11s/it]  {'epoch': 22, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9174, 'compress@10': 0.582, 'time@10': 10.0703}:  80%|████████  | 8/10 [01:00<00:16,  8.15s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9192, 'compress@10': 0.5791, 'time@10': 10.1964}:  80%|████████  | 8/10 [01:06<00:16,  8.15s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9192, 'compress@10': 0.5791, 'time@10': 10.1964}:  90%|█████████ | 9/10 [01:06<00:07,  7.37s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9243, 'compress@10': 0.5256, 'time@10': 10.2181}:  90%|█████████ | 9/10 [01:16<00:07,  7.37s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9243, 'compress@10': 0.5256, 'time@10': 10.2181}: 100%|██████████| 10/10 [01:16<00:00,  8.32s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9243, 'compress@10': 0.5256, 'time@10': 10.2181}: 100%|██████████| 10/10 [01:16<00:00,  7.70s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.018916594429372536
Avg hit ratio: 0.8811758673320643
Avg ndcg: 0.9242618223611426
Avg compression ratio: 0.5256148630564241
Avg train time: 10.218074417114257
Std train time: 0.44937297210190014
[0.8958333333333331, 0.4791666666666668, 0.0625, 0.39583333333333326, 0.9791666666666665, 0.6874999999999999, 0.5625, 0.3541666666666667, 0.5625, 0.020833333333333336]
[13, 14, 37, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8975, 'compress@10': 0.9013, 'time@10': 9.6284}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8975, 'compress@10': 0.9013, 'time@10': 9.6284}:  10%|█         | 1/10 [00:04<00:43,  4.85s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9342, 'compress@10': 0.6986, 'time@10': 9.8703}:  10%|█         | 1/10 [00:15<00:43,  4.85s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9342, 'compress@10': 0.6986, 'time@10': 9.8703}:  20%|██        | 2/10 [00:15<01:03,  7.97s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9085, 'compress@10': 0.5312, 'time@10': 9.6885}:  20%|██        | 2/10 [00:19<01:03,  7.97s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9085, 'compress@10': 0.5312, 'time@10': 9.6885}:  30%|███       | 3/10 [00:19<00:45,  6.47s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9238, 'compress@10': 0.5028, 'time@10': 9.8597}:  30%|███       | 3/10 [00:30<00:45,  6.47s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9238, 'compress@10': 0.5028, 'time@10': 9.8597}:  40%|████      | 4/10 [00:30<00:48,  8.03s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0255, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8994, 'compress@10': 0.5981, 'time@10': 9.9651}:  40%|████      | 4/10 [00:35<00:48,  8.03s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0255, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8994, 'compress@10': 0.5981, 'time@10': 9.9651}:  50%|█████     | 5/10 [00:35<00:35,  7.02s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0259, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9072, 'compress@10': 0.6142, 'time@10': 10.0175}:  50%|█████     | 5/10 [00:45<00:35,  7.02s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0259, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9072, 'compress@10': 0.6142, 'time@10': 10.0175}:  60%|██████    | 6/10 [00:45<00:32,  8.15s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.025, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9111, 'compress@10': 0.6093, 'time@10': 10.0785}:  60%|██████    | 6/10 [00:50<00:32,  8.15s/it]  {'epoch': 23, 'num_users': 6.2857, 'loss': 0.025, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9111, 'compress@10': 0.6093, 'time@10': 10.0785}:  70%|███████   | 7/10 [00:50<00:21,  7.20s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0246, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9056, 'compress@10': 0.5797, 'time@10': 10.1294}:  70%|███████   | 7/10 [01:01<00:21,  7.20s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0246, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9056, 'compress@10': 0.5797, 'time@10': 10.1294}:  80%|████████  | 8/10 [01:01<00:16,  8.26s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0247, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9089, 'compress@10': 0.5792, 'time@10': 10.2515}:  80%|████████  | 8/10 [01:07<00:16,  8.26s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0247, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9089, 'compress@10': 0.5792, 'time@10': 10.2515}:  90%|█████████ | 9/10 [01:07<00:07,  7.45s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0239, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9151, 'compress@10': 0.5256, 'time@10': 10.2474}:  90%|█████████ | 9/10 [01:17<00:07,  7.45s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0239, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9151, 'compress@10': 0.5256, 'time@10': 10.2474}: 100%|██████████| 10/10 [01:17<00:00,  8.31s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0239, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9151, 'compress@10': 0.5256, 'time@10': 10.2474}: 100%|██████████| 10/10 [01:17<00:00,  7.74s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.023853780339865037
Avg hit ratio: 0.8894851081761098
Avg ndcg: 0.9151292544618979
Avg compression ratio: 0.5255819410603336
Avg train time: 10.2474214553833
Std train time: 0.48452478372858965
[0.8599999999999999, 0.5000000000000001, 0.06, 0.37999999999999995, 0.9799999999999999, 0.6999999999999998, 0.54, 0.38, 0.58, 0.020000000000000004]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9, 'compress@10': 0.8674, 'time@10': 10.0173}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9, 'compress@10': 0.8674, 'time@10': 10.0173}:  10%|█         | 1/10 [00:05<00:45,  5.05s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9142, 'compress@10': 0.6917, 'time@10': 10.0101}:  10%|█         | 1/10 [00:15<00:45,  5.05s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9142, 'compress@10': 0.6917, 'time@10': 10.0101}:  20%|██        | 2/10 [00:15<01:03,  7.98s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8952, 'compress@10': 0.5259, 'time@10': 9.9662}:  20%|██        | 2/10 [00:20<01:03,  7.98s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8952, 'compress@10': 0.5259, 'time@10': 9.9662}:  30%|███       | 3/10 [00:20<00:46,  6.61s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9452, 'compress@10': 0.495, 'time@10': 10.0337}:  30%|███       | 3/10 [00:30<00:46,  6.61s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9452, 'compress@10': 0.495, 'time@10': 10.0337}:  40%|████      | 4/10 [00:30<00:48,  8.06s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0264, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9179, 'compress@10': 0.5921, 'time@10': 10.0348}:  40%|████      | 4/10 [00:35<00:48,  8.06s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0264, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9179, 'compress@10': 0.5921, 'time@10': 10.0348}:  50%|█████     | 5/10 [00:35<00:34,  6.98s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0253, 'hit_ratio@10': 0.877, 'ndcg@10': 0.923, 'compress@10': 0.6112, 'time@10': 10.0469}:  50%|█████     | 5/10 [00:45<00:34,  6.98s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0253, 'hit_ratio@10': 0.877, 'ndcg@10': 0.923, 'compress@10': 0.6112, 'time@10': 10.0469}:  60%|██████    | 6/10 [00:45<00:32,  8.05s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9254, 'compress@10': 0.6036, 'time@10': 10.0485}:  60%|██████    | 6/10 [00:50<00:32,  8.05s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9254, 'compress@10': 0.6036, 'time@10': 10.0485}:  70%|███████   | 7/10 [00:50<00:21,  7.08s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9297, 'compress@10': 0.5779, 'time@10': 10.0826}:  70%|███████   | 7/10 [01:00<00:21,  7.08s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9297, 'compress@10': 0.5779, 'time@10': 10.0826}:  80%|████████  | 8/10 [01:00<00:16,  8.12s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0228, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9305, 'compress@10': 0.5795, 'time@10': 10.2111}:  80%|████████  | 8/10 [01:06<00:16,  8.12s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0228, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9305, 'compress@10': 0.5795, 'time@10': 10.2111}:  90%|█████████ | 9/10 [01:06<00:07,  7.35s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0215, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9345, 'compress@10': 0.5257, 'time@10': 10.2349}:  90%|█████████ | 9/10 [01:17<00:07,  7.35s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0215, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9345, 'compress@10': 0.5257, 'time@10': 10.2349}: 100%|██████████| 10/10 [01:17<00:00,  8.32s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0215, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9345, 'compress@10': 0.5257, 'time@10': 10.2349}: 100%|██████████| 10/10 [01:17<00:00,  7.71s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.021532857572290016
Avg hit ratio: 0.8970969873363762
Avg ndcg: 0.9345077785830785
Avg compression ratio: 0.5257342624494352
Avg train time: 10.234895157814027
Std train time: 0.3709193629653595
[0.8269230769230768, 0.5192307692307694, 0.05769230769230769, 0.4038461538461538, 0.9807692307692306, 0.7115384615384613, 0.5192307692307693, 0.36538461538461536, 0.5961538461538461, 0.019230769230769235]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9018, 'compress@10': 0.836, 'time@10': 9.8306}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9018, 'compress@10': 0.836, 'time@10': 9.8306}:  10%|█         | 1/10 [00:04<00:44,  4.95s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9339, 'compress@10': 0.6854, 'time@10': 9.8909}:  10%|█         | 1/10 [00:14<00:44,  4.95s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9339, 'compress@10': 0.6854, 'time@10': 9.8909}:  20%|██        | 2/10 [00:14<01:03,  7.92s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9083, 'compress@10': 0.521, 'time@10': 9.9512}:  20%|██        | 2/10 [00:20<01:03,  7.92s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9083, 'compress@10': 0.521, 'time@10': 9.9512}:  30%|███       | 3/10 [00:20<00:46,  6.62s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9259, 'compress@10': 0.4971, 'time@10': 10.0258}:  30%|███       | 3/10 [00:30<00:46,  6.62s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9259, 'compress@10': 0.4971, 'time@10': 10.0258}:  40%|████      | 4/10 [00:30<00:48,  8.07s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.904, 'compress@10': 0.5939, 'time@10': 10.0412}:  40%|████      | 4/10 [00:35<00:48,  8.07s/it] {'epoch': 25, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.904, 'compress@10': 0.5939, 'time@10': 10.0412}:  50%|█████     | 5/10 [00:35<00:34,  6.99s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9127, 'compress@10': 0.6145, 'time@10': 10.025}:  50%|█████     | 5/10 [00:45<00:34,  6.99s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9127, 'compress@10': 0.6145, 'time@10': 10.025}:  60%|██████    | 6/10 [00:45<00:32,  8.01s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9171, 'compress@10': 0.6037, 'time@10': 10.0433}:  60%|██████    | 6/10 [00:50<00:32,  8.01s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0176, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9171, 'compress@10': 0.6037, 'time@10': 10.0433}:  70%|███████   | 7/10 [00:50<00:21,  7.06s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.924, 'compress@10': 0.5762, 'time@10': 10.1022}:  70%|███████   | 7/10 [01:01<00:21,  7.06s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.924, 'compress@10': 0.5762, 'time@10': 10.1022}:  80%|████████  | 8/10 [01:01<00:16,  8.17s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9252, 'compress@10': 0.5797, 'time@10': 10.2332}:  80%|████████  | 8/10 [01:06<00:16,  8.17s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9252, 'compress@10': 0.5797, 'time@10': 10.2332}:  90%|█████████ | 9/10 [01:06<00:07,  7.39s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9297, 'compress@10': 0.5258, 'time@10': 10.239}:  90%|█████████ | 9/10 [01:17<00:07,  7.39s/it]     {'epoch': 25, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9297, 'compress@10': 0.5258, 'time@10': 10.239}: 100%|██████████| 10/10 [01:17<00:00,  8.30s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9297, 'compress@10': 0.5258, 'time@10': 10.239}: 100%|██████████| 10/10 [01:17<00:00,  7.70s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.01904957391805421
Avg hit ratio: 0.9015414317808206
Avg ndcg: 0.9297083712238606
Avg compression ratio: 0.5258480512838267
Avg train time: 10.238980531692505
Std train time: 0.3943182912661904
[0.8333333333333331, 0.5000000000000001, 0.05555555555555555, 0.38888888888888884, 0.9814814814814813, 0.685185185185185, 0.5, 0.38888888888888884, 0.611111111111111, 0.05555555555555555]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9018, 'compress@10': 0.8421, 'time@10': 9.6968}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9018, 'compress@10': 0.8421, 'time@10': 9.6968}:  10%|█         | 1/10 [00:04<00:43,  4.89s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9223, 'compress@10': 0.6791, 'time@10': 9.9529}:  10%|█         | 1/10 [00:15<00:43,  4.89s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9223, 'compress@10': 0.6791, 'time@10': 9.9529}:  20%|██        | 2/10 [00:15<01:04,  8.04s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9006, 'compress@10': 0.5162, 'time@10': 9.8811}:  20%|██        | 2/10 [00:20<01:04,  8.04s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9006, 'compress@10': 0.5162, 'time@10': 9.8811}:  30%|███       | 3/10 [00:20<00:46,  6.61s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9144, 'compress@10': 0.4899, 'time@10': 9.942}:  30%|███       | 3/10 [00:30<00:46,  6.61s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9144, 'compress@10': 0.4899, 'time@10': 9.942}:  40%|████      | 4/10 [00:30<00:48,  8.01s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0189, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8961, 'compress@10': 0.5883, 'time@10': 9.9698}:  40%|████      | 4/10 [00:35<00:48,  8.01s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0189, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8961, 'compress@10': 0.5883, 'time@10': 9.9698}:  50%|█████     | 5/10 [00:35<00:34,  6.95s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0196, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9047, 'compress@10': 0.6056, 'time@10': 9.9858}:  50%|█████     | 5/10 [00:45<00:34,  6.95s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0196, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9047, 'compress@10': 0.6056, 'time@10': 9.9858}:  60%|██████    | 6/10 [00:45<00:32,  8.02s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0193, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9103, 'compress@10': 0.5933, 'time@10': 10.0486}:  60%|██████    | 6/10 [00:50<00:32,  8.02s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0193, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9103, 'compress@10': 0.5933, 'time@10': 10.0486}:  70%|███████   | 7/10 [00:50<00:21,  7.12s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9122, 'compress@10': 0.57, 'time@10': 10.0845}:  70%|███████   | 7/10 [01:01<00:21,  7.12s/it]   {'epoch': 26, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9122, 'compress@10': 0.57, 'time@10': 10.0845}:  80%|████████  | 8/10 [01:01<00:16,  8.15s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0233, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9148, 'compress@10': 0.5758, 'time@10': 10.1998}:  80%|████████  | 8/10 [01:06<00:16,  8.15s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0233, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9148, 'compress@10': 0.5758, 'time@10': 10.1998}:  90%|█████████ | 9/10 [01:06<00:07,  7.36s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9205, 'compress@10': 0.5259, 'time@10': 10.204}:  90%|█████████ | 9/10 [01:16<00:07,  7.36s/it]    {'epoch': 26, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9205, 'compress@10': 0.5259, 'time@10': 10.204}: 100%|██████████| 10/10 [01:16<00:00,  8.26s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0217, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9205, 'compress@10': 0.5259, 'time@10': 10.204}: 100%|██████████| 10/10 [01:16<00:00,  7.69s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.021681478414188562
Avg hit ratio: 0.9039100953752905
Avg ndcg: 0.9205243450782017
Avg compression ratio: 0.5259025493161533
Avg train time: 10.203978371620178
Std train time: 0.3776751706936959
[0.8035714285714284, 0.517857142857143, 0.05357142857142857, 0.37499999999999994, 0.982142857142857, 0.6964285714285713, 0.48214285714285715, 0.41071428571428564, 0.6249999999999999, 0.05357142857142857]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9078, 'compress@10': 0.8139, 'time@10': 9.5579}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9078, 'compress@10': 0.8139, 'time@10': 9.5579}:  10%|█         | 1/10 [00:04<00:43,  4.81s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9541, 'compress@10': 0.6737, 'time@10': 9.7779}:  10%|█         | 1/10 [00:14<00:43,  4.81s/it] {'epoch': 27, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9541, 'compress@10': 0.6737, 'time@10': 9.7779}:  20%|██        | 2/10 [00:14<01:03,  7.89s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9218, 'compress@10': 0.512, 'time@10': 9.8203}:  20%|██        | 2/10 [00:19<01:03,  7.89s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9218, 'compress@10': 0.512, 'time@10': 9.8203}:  30%|███       | 3/10 [00:19<00:45,  6.56s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9372, 'compress@10': 0.4834, 'time@10': 9.9}:  30%|███       | 3/10 [00:30<00:45,  6.56s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9372, 'compress@10': 0.4834, 'time@10': 9.9}:  40%|████      | 4/10 [00:30<00:47,  7.99s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.916, 'compress@10': 0.5832, 'time@10': 9.9313}:  40%|████      | 4/10 [00:35<00:47,  7.99s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.916, 'compress@10': 0.5832, 'time@10': 9.9313}:  50%|█████     | 5/10 [00:35<00:34,  6.94s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9233, 'compress@10': 0.6032, 'time@10': 9.9419}:  50%|█████     | 5/10 [00:45<00:34,  6.94s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9233, 'compress@10': 0.6032, 'time@10': 9.9419}:  60%|██████    | 6/10 [00:45<00:31,  7.99s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9263, 'compress@10': 0.5888, 'time@10': 9.9603}:  60%|██████    | 6/10 [00:50<00:31,  7.99s/it] {'epoch': 27, 'num_users': 6.2857, 'loss': 0.0204, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9263, 'compress@10': 0.5888, 'time@10': 9.9603}:  70%|███████   | 7/10 [00:50<00:21,  7.04s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.909, 'ndcg@10': 0.931, 'compress@10': 0.5687, 'time@10': 10.0295}:  70%|███████   | 7/10 [01:00<00:21,  7.04s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.909, 'ndcg@10': 0.931, 'compress@10': 0.5687, 'time@10': 10.0295}:  80%|████████  | 8/10 [01:00<00:16,  8.16s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9316, 'compress@10': 0.5761, 'time@10': 10.187}:  80%|████████  | 8/10 [01:06<00:16,  8.16s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9316, 'compress@10': 0.5761, 'time@10': 10.187}:  90%|█████████ | 9/10 [01:06<00:07,  7.41s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9356, 'compress@10': 0.526, 'time@10': 10.2056}:  90%|█████████ | 9/10 [01:16<00:07,  7.41s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9356, 'compress@10': 0.526, 'time@10': 10.2056}: 100%|██████████| 10/10 [01:16<00:00,  8.34s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9356, 'compress@10': 0.526, 'time@10': 10.2056}: 100%|██████████| 10/10 [01:16<00:00,  7.69s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.01881868364186299
Avg hit ratio: 0.902033495272884
Avg ndcg: 0.9356334671727625
Avg compression ratio: 0.5260255745906994
Avg train time: 10.205613231658935
Std train time: 0.48008969024235454
[0.775862068965517, 0.5344827586206898, 0.05172413793103448, 0.396551724137931, 0.982758620689655, 0.6724137931034482, 0.46551724137931033, 0.39655172413793094, 0.6379310344827586, 0.08620689655172414]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9078, 'compress@10': 0.7876, 'time@10': 10.8074}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9078, 'compress@10': 0.7876, 'time@10': 10.8074}:  10%|█         | 1/10 [00:05<00:48,  5.44s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9392, 'compress@10': 0.6686, 'time@10': 10.4524}:  10%|█         | 1/10 [00:15<00:48,  5.44s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9392, 'compress@10': 0.6686, 'time@10': 10.4524}:  20%|██        | 2/10 [00:15<01:05,  8.20s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9119, 'compress@10': 0.5081, 'time@10': 10.1919}:  20%|██        | 2/10 [00:20<01:05,  8.20s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9119, 'compress@10': 0.5081, 'time@10': 10.1919}:  30%|███       | 3/10 [00:20<00:46,  6.68s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.924, 'compress@10': 0.4856, 'time@10': 10.2303}:  30%|███       | 3/10 [00:30<00:46,  6.68s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.924, 'compress@10': 0.4856, 'time@10': 10.2303}:  40%|████      | 4/10 [00:30<00:48,  8.14s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9068, 'compress@10': 0.5851, 'time@10': 10.2111}:  40%|████      | 4/10 [00:35<00:48,  8.14s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9068, 'compress@10': 0.5851, 'time@10': 10.2111}:  50%|█████     | 5/10 [00:35<00:35,  7.05s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.916, 'compress@10': 0.6009, 'time@10': 10.1983}:  50%|█████     | 5/10 [00:46<00:35,  7.05s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.916, 'compress@10': 0.6009, 'time@10': 10.1983}:  60%|██████    | 6/10 [00:46<00:32,  8.11s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.92, 'compress@10': 0.5846, 'time@10': 10.2554}:  60%|██████    | 6/10 [00:51<00:32,  8.11s/it]  {'epoch': 28, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.92, 'compress@10': 0.5846, 'time@10': 10.2554}:  70%|███████   | 7/10 [00:51<00:21,  7.20s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9247, 'compress@10': 0.5632, 'time@10': 10.3126}:  70%|███████   | 7/10 [01:02<00:21,  7.20s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9247, 'compress@10': 0.5632, 'time@10': 10.3126}:  80%|████████  | 8/10 [01:02<00:16,  8.33s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9262, 'compress@10': 0.5727, 'time@10': 10.4404}:  80%|████████  | 8/10 [01:07<00:16,  8.33s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9262, 'compress@10': 0.5727, 'time@10': 10.4404}:  90%|█████████ | 9/10 [01:07<00:07,  7.53s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.931, 'compress@10': 0.5261, 'time@10': 10.4104}:  90%|█████████ | 9/10 [01:18<00:07,  7.53s/it]    {'epoch': 28, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.931, 'compress@10': 0.5261, 'time@10': 10.4104}: 100%|██████████| 10/10 [01:18<00:00,  8.35s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.931, 'compress@10': 0.5261, 'time@10': 10.4104}: 100%|██████████| 10/10 [01:18<00:00,  7.81s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.014636873061523253
Avg hit ratio: 0.8916243810895763
Avg ndcg: 0.9309659581798153
Avg compression ratio: 0.5261157032439966
Avg train time: 10.410392832756042
Std train time: 0.47614604152491435
[0.7833333333333331, 0.5500000000000002, 0.05, 0.3833333333333333, 0.9833333333333332, 0.6499999999999999, 0.48333333333333334, 0.38333333333333325, 0.6499999999999999, 0.08333333333333334]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.912, 'compress@10': 0.7947, 'time@10': 10.7688}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.912, 'compress@10': 0.7947, 'time@10': 10.7688}:  10%|█         | 1/10 [00:05<00:48,  5.42s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9393, 'compress@10': 0.6796, 'time@10': 10.3632}:  10%|█         | 1/10 [00:15<00:48,  5.42s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9393, 'compress@10': 0.6796, 'time@10': 10.3632}:  20%|██        | 2/10 [00:15<01:04,  8.11s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9119, 'compress@10': 0.515, 'time@10': 10.2451}:  20%|██        | 2/10 [00:20<01:04,  8.11s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9119, 'compress@10': 0.515, 'time@10': 10.2451}:  30%|███       | 3/10 [00:20<00:46,  6.71s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9287, 'compress@10': 0.4876, 'time@10': 10.2085}:  30%|███       | 3/10 [00:30<00:46,  6.71s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.9287, 'compress@10': 0.4876, 'time@10': 10.2085}:  40%|████      | 4/10 [00:30<00:48,  8.06s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9117, 'compress@10': 0.5868, 'time@10': 10.1988}:  40%|████      | 4/10 [00:35<00:48,  8.06s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9117, 'compress@10': 0.5868, 'time@10': 10.1988}:  50%|█████     | 5/10 [00:35<00:34,  7.00s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9213, 'compress@10': 0.5986, 'time@10': 10.1968}:  50%|█████     | 5/10 [00:45<00:34,  7.00s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9213, 'compress@10': 0.5986, 'time@10': 10.1968}:  60%|██████    | 6/10 [00:45<00:32,  8.10s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9249, 'compress@10': 0.5851, 'time@10': 10.2283}:  60%|██████    | 6/10 [00:51<00:32,  8.10s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9249, 'compress@10': 0.5851, 'time@10': 10.2283}:  70%|███████   | 7/10 [00:51<00:21,  7.17s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9342, 'compress@10': 0.5621, 'time@10': 10.2494}:  70%|███████   | 7/10 [01:01<00:21,  7.17s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9342, 'compress@10': 0.5621, 'time@10': 10.2494}:  80%|████████  | 8/10 [01:01<00:16,  8.21s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0167, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9348, 'compress@10': 0.573, 'time@10': 10.3335}:  80%|████████  | 8/10 [01:07<00:16,  8.21s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0167, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9348, 'compress@10': 0.573, 'time@10': 10.3335}:  90%|█████████ | 9/10 [01:07<00:07,  7.37s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.939, 'compress@10': 0.5261, 'time@10': 10.3305}:  90%|█████████ | 9/10 [01:17<00:07,  7.37s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.939, 'compress@10': 0.5261, 'time@10': 10.3305}: 100%|██████████| 10/10 [01:17<00:00,  8.29s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.939, 'compress@10': 0.5261, 'time@10': 10.3305}: 100%|██████████| 10/10 [01:17<00:00,  7.75s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.016603520726621274
Avg hit ratio: 0.9012787589697606
Avg ndcg: 0.9389726372937492
Avg compression ratio: 0.5260862416044202
Avg train time: 10.330542182922363
Std train time: 0.3174474860249788
[0.758064516129032, 0.5322580645161292, 0.048387096774193554, 0.4032258064516129, 0.9838709677419353, 0.6612903225806451, 0.467741935483871, 0.4032258064516128, 0.6612903225806451, 0.08064516129032259]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9186, 'compress@10': 0.7708, 'time@10': 11.0008}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9186, 'compress@10': 0.7708, 'time@10': 11.0008}:  10%|█         | 1/10 [00:05<00:49,  5.55s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9426, 'compress@10': 0.6591, 'time@10': 10.5291}:  10%|█         | 1/10 [00:15<00:49,  5.55s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9426, 'compress@10': 0.6591, 'time@10': 10.5291}:  20%|██        | 2/10 [00:15<01:05,  8.22s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9141, 'compress@10': 0.5008, 'time@10': 10.3399}:  20%|██        | 2/10 [00:20<01:05,  8.22s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9141, 'compress@10': 0.5008, 'time@10': 10.3399}:  30%|███       | 3/10 [00:20<00:47,  6.77s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9257, 'compress@10': 0.4818, 'time@10': 10.3047}:  30%|███       | 3/10 [00:30<00:47,  6.77s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9257, 'compress@10': 0.4818, 'time@10': 10.3047}:  40%|████      | 4/10 [00:30<00:48,  8.14s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9106, 'compress@10': 0.5822, 'time@10': 10.3385}:  40%|████      | 4/10 [00:36<00:48,  8.14s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9106, 'compress@10': 0.5822, 'time@10': 10.3385}:  50%|█████     | 5/10 [00:36<00:35,  7.11s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9192, 'compress@10': 0.5967, 'time@10': 10.3383}:  50%|█████     | 5/10 [00:46<00:35,  7.11s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9192, 'compress@10': 0.5967, 'time@10': 10.3383}:  60%|██████    | 6/10 [00:46<00:32,  8.22s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9231, 'compress@10': 0.5813, 'time@10': 10.3311}:  60%|██████    | 6/10 [00:51<00:32,  8.22s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9231, 'compress@10': 0.5813, 'time@10': 10.3311}:  70%|███████   | 7/10 [00:51<00:21,  7.23s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.9155, 'ndcg@10': 0.9328, 'compress@10': 0.5612, 'time@10': 10.343}:  70%|███████   | 7/10 [01:02<00:21,  7.23s/it]  {'epoch': 30, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.9155, 'ndcg@10': 0.9328, 'compress@10': 0.5612, 'time@10': 10.343}:  80%|████████  | 8/10 [01:02<00:16,  8.26s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9344, 'compress@10': 0.5734, 'time@10': 10.4309}:  80%|████████  | 8/10 [01:07<00:16,  8.26s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9344, 'compress@10': 0.5734, 'time@10': 10.4309}:  90%|█████████ | 9/10 [01:07<00:07,  7.43s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.9386, 'compress@10': 0.5262, 'time@10': 10.4129}:  90%|█████████ | 9/10 [01:18<00:07,  7.43s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.9386, 'compress@10': 0.5262, 'time@10': 10.4129}: 100%|██████████| 10/10 [01:18<00:00,  8.31s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9101, 'ndcg@10': 0.9386, 'compress@10': 0.5262, 'time@10': 10.4129}: 100%|██████████| 10/10 [01:18<00:00,  7.81s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.01568479477191507
Avg hit ratio: 0.9101164445816398
Avg ndcg: 0.9385574961466974
Avg compression ratio: 0.5261802851412598
Avg train time: 10.412926888465881
Std train time: 0.3596034420768454
[0.7343749999999998, 0.5156250000000002, 0.04687500000000001, 0.390625, 0.9843749999999998, 0.671875, 0.484375, 0.42187499999999994, 0.671875, 0.07812500000000001]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9207, 'compress@10': 0.7484, 'time@10': 10.9046}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9207, 'compress@10': 0.7484, 'time@10': 10.9046}:  10%|█         | 1/10 [00:05<00:49,  5.50s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9404, 'compress@10': 0.6398, 'time@10': 10.4541}:  10%|█         | 1/10 [00:15<00:49,  5.50s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9404, 'compress@10': 0.6398, 'time@10': 10.4541}:  20%|██        | 2/10 [00:15<01:05,  8.17s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9126, 'compress@10': 0.4875, 'time@10': 10.3475}:  20%|██        | 2/10 [00:20<01:05,  8.17s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9126, 'compress@10': 0.4875, 'time@10': 10.3475}:  30%|███       | 3/10 [00:20<00:47,  6.77s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9309, 'compress@10': 0.4688, 'time@10': 10.2998}:  30%|███       | 3/10 [00:30<00:47,  6.77s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9309, 'compress@10': 0.4688, 'time@10': 10.2998}:  40%|████      | 4/10 [00:30<00:48,  8.12s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9163, 'compress@10': 0.5719, 'time@10': 10.3119}:  40%|████      | 4/10 [00:36<00:48,  8.12s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9163, 'compress@10': 0.5719, 'time@10': 10.3119}:  50%|█████     | 5/10 [00:36<00:35,  7.07s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.9263, 'ndcg@10': 0.925, 'compress@10': 0.5898, 'time@10': 10.304}:  50%|█████     | 5/10 [00:46<00:35,  7.07s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.9263, 'ndcg@10': 0.925, 'compress@10': 0.5898, 'time@10': 10.304}:  60%|██████    | 6/10 [00:46<00:32,  8.17s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.9311, 'ndcg@10': 0.928, 'compress@10': 0.5777, 'time@10': 10.2918}:  60%|██████    | 6/10 [00:51<00:32,  8.17s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.9311, 'ndcg@10': 0.928, 'compress@10': 0.5777, 'time@10': 10.2918}:  70%|███████   | 7/10 [00:51<00:21,  7.18s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.9361, 'ndcg@10': 0.9332, 'compress@10': 0.5603, 'time@10': 10.2989}:  70%|███████   | 7/10 [01:01<00:21,  7.18s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.9361, 'ndcg@10': 0.9332, 'compress@10': 0.5603, 'time@10': 10.2989}:  80%|████████  | 8/10 [01:01<00:16,  8.20s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.9348, 'compress@10': 0.5737, 'time@10': 10.3864}:  80%|████████  | 8/10 [01:07<00:16,  8.20s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.9348, 'compress@10': 0.5737, 'time@10': 10.3864}:  90%|█████████ | 9/10 [01:07<00:07,  7.38s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.9295, 'ndcg@10': 0.9396, 'compress@10': 0.5263, 'time@10': 10.4137}:  90%|█████████ | 9/10 [01:18<00:07,  7.38s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.9295, 'ndcg@10': 0.9396, 'compress@10': 0.5263, 'time@10': 10.4137}: 100%|██████████| 10/10 [01:18<00:00,  8.41s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.9295, 'ndcg@10': 0.9396, 'compress@10': 0.5263, 'time@10': 10.4137}: 100%|██████████| 10/10 [01:18<00:00,  7.82s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.013203005409904559
Avg hit ratio: 0.9294815239467192
Avg ndcg: 0.9396065111390032
Avg compression ratio: 0.5262579990960389
Avg train time: 10.413671112060547
Std train time: 0.33668866709916423
[0.7424242424242422, 0.5000000000000002, 0.04545454545454546, 0.4090909090909091, 0.9848484848484846, 0.6515151515151515, 0.4696969696969697, 0.40909090909090906, 0.6818181818181818, 0.10606060606060608]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9258, 'compress@10': 0.756, 'time@10': 10.7067}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9258, 'compress@10': 0.756, 'time@10': 10.7067}:  10%|█         | 1/10 [00:05<00:48,  5.39s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.049, 'compress@10': 0.636, 'time@10': 10.4581}:  10%|█         | 1/10 [00:15<00:48,  5.39s/it] {'epoch': 32, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.049, 'compress@10': 0.636, 'time@10': 10.4581}:  20%|██        | 2/10 [00:15<01:05,  8.25s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.985, 'compress@10': 0.4846, 'time@10': 10.4088}:  20%|██        | 2/10 [00:20<01:05,  8.25s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.985, 'compress@10': 0.4846, 'time@10': 10.4088}:  30%|███       | 3/10 [00:20<00:47,  6.85s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9789, 'compress@10': 0.471, 'time@10': 10.4077}:  30%|███       | 3/10 [00:31<00:47,  6.85s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9789, 'compress@10': 0.471, 'time@10': 10.4077}:  40%|████      | 4/10 [00:31<00:49,  8.27s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9547, 'compress@10': 0.5739, 'time@10': 10.3214}:  40%|████      | 4/10 [00:36<00:49,  8.27s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9547, 'compress@10': 0.5739, 'time@10': 10.3214}:  50%|█████     | 5/10 [00:36<00:35,  7.10s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0227, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.958, 'compress@10': 0.5881, 'time@10': 10.3012}:  50%|█████     | 5/10 [00:46<00:35,  7.10s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0227, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.958, 'compress@10': 0.5881, 'time@10': 10.3012}:  60%|██████    | 6/10 [00:46<00:32,  8.17s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0213, 'hit_ratio@10': 0.926, 'ndcg@10': 0.9563, 'compress@10': 0.5742, 'time@10': 10.302}:  60%|██████    | 6/10 [00:51<00:32,  8.17s/it] {'epoch': 32, 'num_users': 6.2857, 'loss': 0.0213, 'hit_ratio@10': 0.926, 'ndcg@10': 0.9563, 'compress@10': 0.5742, 'time@10': 10.302}:  70%|███████   | 7/10 [00:51<00:21,  7.19s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.9317, 'ndcg@10': 0.9573, 'compress@10': 0.5557, 'time@10': 10.339}:  70%|███████   | 7/10 [01:02<00:21,  7.19s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.9317, 'ndcg@10': 0.9573, 'compress@10': 0.5557, 'time@10': 10.339}:  80%|████████  | 8/10 [01:02<00:16,  8.29s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.9202, 'ndcg@10': 0.957, 'compress@10': 0.5707, 'time@10': 10.4285}:  80%|████████  | 8/10 [01:07<00:16,  8.29s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.9202, 'ndcg@10': 0.957, 'compress@10': 0.5707, 'time@10': 10.4285}:  90%|█████████ | 9/10 [01:07<00:07,  7.45s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.9259, 'ndcg@10': 0.9589, 'compress@10': 0.5263, 'time@10': 10.4492}:  90%|█████████ | 9/10 [01:18<00:07,  7.45s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.9259, 'ndcg@10': 0.9589, 'compress@10': 0.5263, 'time@10': 10.4492}: 100%|██████████| 10/10 [01:18<00:00,  8.45s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.9259, 'ndcg@10': 0.9589, 'compress@10': 0.5263, 'time@10': 10.4492}: 100%|██████████| 10/10 [01:18<00:00,  7.86s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.01756667670172994
Avg hit ratio: 0.9259100953752906
Avg ndcg: 0.9588993242264705
Avg compression ratio: 0.5262676001276647
Avg train time: 10.44915292263031
Std train time: 0.3148645141333345
[0.7205882352941174, 0.5147058823529413, 0.04411764705882354, 0.3970588235294118, 0.9852941176470587, 0.6617647058823529, 0.4852941176470589, 0.39705882352941174, 0.6911764705882353, 0.10294117647058826]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9258, 'compress@10': 0.7353, 'time@10': 11.0828}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9258, 'compress@10': 0.7353, 'time@10': 11.0828}:  10%|█         | 1/10 [00:05<00:50,  5.58s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9462, 'compress@10': 0.6328, 'time@10': 10.6008}:  10%|█         | 1/10 [00:15<00:50,  5.58s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9462, 'compress@10': 0.6328, 'time@10': 10.6008}:  20%|██        | 2/10 [00:15<01:06,  8.27s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9165, 'compress@10': 0.4821, 'time@10': 10.432}:  20%|██        | 2/10 [00:20<01:06,  8.27s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9165, 'compress@10': 0.4821, 'time@10': 10.432}:  30%|███       | 3/10 [00:20<00:47,  6.82s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9314, 'compress@10': 0.4662, 'time@10': 10.4144}:  30%|███       | 3/10 [00:31<00:47,  6.82s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9314, 'compress@10': 0.4662, 'time@10': 10.4144}:  40%|████      | 4/10 [00:31<00:49,  8.23s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.9217, 'ndcg@10': 0.918, 'compress@10': 0.5701, 'time@10': 10.357}:  40%|████      | 4/10 [00:36<00:49,  8.23s/it]  {'epoch': 33, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.9217, 'ndcg@10': 0.918, 'compress@10': 0.5701, 'time@10': 10.357}:  50%|█████     | 5/10 [00:36<00:35,  7.10s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0124, 'hit_ratio@10': 0.9274, 'ndcg@10': 0.9271, 'compress@10': 0.5866, 'time@10': 10.3015}:  50%|█████     | 5/10 [00:46<00:35,  7.10s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0124, 'hit_ratio@10': 0.9274, 'ndcg@10': 0.9271, 'compress@10': 0.5866, 'time@10': 10.3015}:  60%|██████    | 6/10 [00:46<00:32,  8.11s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.932, 'ndcg@10': 0.9298, 'compress@10': 0.5751, 'time@10': 10.3256}:  60%|██████    | 6/10 [00:51<00:32,  8.11s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.932, 'ndcg@10': 0.9298, 'compress@10': 0.5751, 'time@10': 10.3256}:  70%|███████   | 7/10 [00:51<00:21,  7.18s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9369, 'ndcg@10': 0.9352, 'compress@10': 0.555, 'time@10': 10.3282}:  70%|███████   | 7/10 [01:02<00:21,  7.18s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9369, 'ndcg@10': 0.9352, 'compress@10': 0.555, 'time@10': 10.3282}:  80%|████████  | 8/10 [01:02<00:16,  8.20s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9217, 'ndcg@10': 0.9377, 'compress@10': 0.5711, 'time@10': 10.3984}:  80%|████████  | 8/10 [01:07<00:16,  8.20s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9217, 'ndcg@10': 0.9377, 'compress@10': 0.5711, 'time@10': 10.3984}:  90%|█████████ | 9/10 [01:07<00:07,  7.36s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.9273, 'ndcg@10': 0.9417, 'compress@10': 0.5263, 'time@10': 10.3965}:  90%|█████████ | 9/10 [01:17<00:07,  7.36s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.9273, 'ndcg@10': 0.9417, 'compress@10': 0.5263, 'time@10': 10.3965}: 100%|██████████| 10/10 [01:17<00:00,  8.31s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.9273, 'ndcg@10': 0.9417, 'compress@10': 0.5263, 'time@10': 10.3965}: 100%|██████████| 10/10 [01:17<00:00,  7.80s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.013454951371279746
Avg hit ratio: 0.9272823431991514
Avg ndcg: 0.9416778120243675
Avg compression ratio: 0.5263256145096059
Avg train time: 10.396543669700623
Std train time: 0.3430267779045601
[0.6999999999999997, 0.5000000000000001, 0.042857142857142864, 0.4142857142857143, 0.9857142857142855, 0.6428571428571428, 0.4714285714285715, 0.41428571428571426, 0.7, 0.1285714285714286]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.7158, 'time@10': 11.1953}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.7158, 'time@10': 11.1953}:  10%|█         | 1/10 [00:05<00:50,  5.64s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9499, 'compress@10': 0.616, 'time@10': 10.6354}:  10%|█         | 1/10 [00:15<00:50,  5.64s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9499, 'compress@10': 0.616, 'time@10': 10.6354}:  20%|██        | 2/10 [00:15<01:06,  8.27s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.919, 'compress@10': 0.4705, 'time@10': 10.3352}:  20%|██        | 2/10 [00:20<01:06,  8.27s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.919, 'compress@10': 0.4705, 'time@10': 10.3352}:  30%|███       | 3/10 [00:20<00:47,  6.74s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9298, 'compress@10': 0.4617, 'time@10': 10.2874}:  30%|███       | 3/10 [00:30<00:47,  6.74s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9298, 'compress@10': 0.4617, 'time@10': 10.2874}:  40%|████      | 4/10 [00:30<00:48,  8.10s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9183, 'compress@10': 0.5665, 'time@10': 10.2754}:  40%|████      | 4/10 [00:35<00:48,  8.10s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9183, 'compress@10': 0.5665, 'time@10': 10.2754}:  50%|█████     | 5/10 [00:35<00:35,  7.04s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9275, 'compress@10': 0.5806, 'time@10': 10.2673}:  50%|█████     | 5/10 [00:46<00:35,  7.04s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9275, 'compress@10': 0.5806, 'time@10': 10.2673}:  60%|██████    | 6/10 [00:46<00:32,  8.13s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9301, 'compress@10': 0.568, 'time@10': 10.2685}:  60%|██████    | 6/10 [00:51<00:32,  8.13s/it] {'epoch': 34, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9301, 'compress@10': 0.568, 'time@10': 10.2685}:  70%|███████   | 7/10 [00:51<00:21,  7.17s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9281, 'compress@10': 0.5509, 'time@10': 10.2776}:  70%|███████   | 7/10 [01:01<00:21,  7.17s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9281, 'compress@10': 0.5509, 'time@10': 10.2776}:  80%|████████  | 8/10 [01:01<00:16,  8.19s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9316, 'compress@10': 0.5684, 'time@10': 10.3681}:  80%|████████  | 8/10 [01:07<00:16,  8.19s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9316, 'compress@10': 0.5684, 'time@10': 10.3681}:  90%|█████████ | 9/10 [01:07<00:07,  7.38s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9361, 'compress@10': 0.5264, 'time@10': 10.4025}:  90%|█████████ | 9/10 [01:18<00:07,  7.38s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9361, 'compress@10': 0.5264, 'time@10': 10.4025}: 100%|██████████| 10/10 [01:18<00:00,  8.42s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9361, 'compress@10': 0.5264, 'time@10': 10.4025}: 100%|██████████| 10/10 [01:18<00:00,  7.82s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.014364179384483037
Avg hit ratio: 0.9118112730506619
Avg ndcg: 0.9361127180165211
Avg compression ratio: 0.5264017457764589
Avg train time: 10.402525448799134
Std train time: 0.43604813271688436
[0.6805555555555552, 0.513888888888889, 0.04166666666666667, 0.4027777777777778, 0.9861111111111109, 0.6249999999999999, 0.48611111111111116, 0.4305555555555555, 0.7083333333333333, 0.12500000000000003]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9278, 'compress@10': 0.6974, 'time@10': 11.1536}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9278, 'compress@10': 0.6974, 'time@10': 11.1536}:  10%|█         | 1/10 [00:05<00:50,  5.61s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9862, 'compress@10': 0.6135, 'time@10': 10.6762}:  10%|█         | 1/10 [00:15<00:50,  5.61s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9862, 'compress@10': 0.6135, 'time@10': 10.6762}:  20%|██        | 2/10 [00:15<01:06,  8.33s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9432, 'compress@10': 0.4685, 'time@10': 10.4111}:  20%|██        | 2/10 [00:20<01:06,  8.33s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9432, 'compress@10': 0.4685, 'time@10': 10.4111}:  30%|███       | 3/10 [00:20<00:47,  6.80s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9548, 'compress@10': 0.4574, 'time@10': 10.3119}:  30%|███       | 3/10 [00:30<00:47,  6.80s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9548, 'compress@10': 0.4574, 'time@10': 10.3119}:  40%|████      | 4/10 [00:30<00:48,  8.08s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.903, 'ndcg@10': 0.939, 'compress@10': 0.5632, 'time@10': 10.2825}:  40%|████      | 4/10 [00:35<00:48,  8.08s/it]   {'epoch': 35, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.903, 'ndcg@10': 0.939, 'compress@10': 0.5632, 'time@10': 10.2825}:  50%|█████     | 5/10 [00:35<00:35,  7.01s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.9155, 'ndcg@10': 0.944, 'compress@10': 0.5749, 'time@10': 10.2891}:  50%|█████     | 5/10 [00:46<00:35,  7.01s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.9155, 'ndcg@10': 0.944, 'compress@10': 0.5749, 'time@10': 10.2891}:  60%|██████    | 6/10 [00:46<00:32,  8.15s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.9219, 'ndcg@10': 0.9446, 'compress@10': 0.5651, 'time@10': 10.2658}:  60%|██████    | 6/10 [00:51<00:32,  8.15s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.9219, 'ndcg@10': 0.9446, 'compress@10': 0.5651, 'time@10': 10.2658}:  70%|███████   | 7/10 [00:51<00:21,  7.15s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9281, 'ndcg@10': 0.948, 'compress@10': 0.5504, 'time@10': 10.2997}:  70%|███████   | 7/10 [01:02<00:21,  7.15s/it]  {'epoch': 35, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9281, 'ndcg@10': 0.948, 'compress@10': 0.5504, 'time@10': 10.2997}:  80%|████████  | 8/10 [01:02<00:16,  8.24s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.917, 'ndcg@10': 0.9493, 'compress@10': 0.5688, 'time@10': 10.3859}:  80%|████████  | 8/10 [01:07<00:16,  8.24s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.917, 'ndcg@10': 0.9493, 'compress@10': 0.5688, 'time@10': 10.3859}:  90%|█████████ | 9/10 [01:07<00:07,  7.41s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.923, 'ndcg@10': 0.9524, 'compress@10': 0.5264, 'time@10': 10.4036}:  90%|█████████ | 9/10 [01:18<00:07,  7.41s/it]  {'epoch': 35, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.923, 'ndcg@10': 0.9524, 'compress@10': 0.5264, 'time@10': 10.4036}: 100%|██████████| 10/10 [01:18<00:00,  8.39s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.923, 'ndcg@10': 0.9524, 'compress@10': 0.5264, 'time@10': 10.4036}: 100%|██████████| 10/10 [01:18<00:00,  7.82s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.01416506404555486
Avg hit ratio: 0.9230299110434934
Avg ndcg: 0.9524404517512883
Avg compression ratio: 0.526435158612313
Avg train time: 10.40364329814911
Std train time: 0.4079462483259447
[0.6621621621621618, 0.5270270270270271, 0.04054054054054054, 0.4189189189189189, 0.9864864864864863, 0.635135135135135, 0.472972972972973, 0.4189189189189189, 0.7162162162162161, 0.12162162162162164]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9154, 'compress@10': 0.6799, 'time@10': 11.3426}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9154, 'compress@10': 0.6799, 'time@10': 11.3426}:  10%|█         | 1/10 [00:05<00:51,  5.71s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9421, 'compress@10': 0.6111, 'time@10': 10.679}:  10%|█         | 1/10 [00:15<00:51,  5.71s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9421, 'compress@10': 0.6111, 'time@10': 10.679}:  20%|██        | 2/10 [00:15<01:06,  8.26s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9138, 'compress@10': 0.4666, 'time@10': 10.4724}:  20%|██        | 2/10 [00:20<01:06,  8.26s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9138, 'compress@10': 0.4666, 'time@10': 10.4724}:  30%|███       | 3/10 [00:20<00:47,  6.80s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9264, 'compress@10': 0.4599, 'time@10': 10.419}:  30%|███       | 3/10 [00:31<00:47,  6.80s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9264, 'compress@10': 0.4599, 'time@10': 10.419}:  40%|████      | 4/10 [00:31<00:49,  8.19s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.9171, 'compress@10': 0.5652, 'time@10': 10.3457}:  40%|████      | 4/10 [00:36<00:49,  8.19s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.9171, 'compress@10': 0.5652, 'time@10': 10.3457}:  50%|█████     | 5/10 [00:36<00:35,  7.06s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9272, 'compress@10': 0.5782, 'time@10': 10.3659}:  50%|█████     | 5/10 [00:46<00:35,  7.06s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9272, 'compress@10': 0.5782, 'time@10': 10.3659}:  60%|██████    | 6/10 [00:46<00:32,  8.23s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9302, 'compress@10': 0.5662, 'time@10': 10.3932}:  60%|██████    | 6/10 [00:52<00:32,  8.23s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9302, 'compress@10': 0.5662, 'time@10': 10.3932}:  70%|███████   | 7/10 [00:52<00:21,  7.28s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.9344, 'compress@10': 0.5499, 'time@10': 10.4026}:  70%|███████   | 7/10 [01:02<00:21,  7.28s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.9344, 'compress@10': 0.5499, 'time@10': 10.4026}:  80%|████████  | 8/10 [01:02<00:16,  8.31s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.89, 'ndcg@10': 0.937, 'compress@10': 0.5693, 'time@10': 10.4828}:  80%|████████  | 8/10 [01:08<00:16,  8.31s/it]  {'epoch': 36, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.89, 'ndcg@10': 0.937, 'compress@10': 0.5693, 'time@10': 10.4828}:  90%|█████████ | 9/10 [01:08<00:07,  7.46s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.941, 'compress@10': 0.5265, 'time@10': 10.5175}:  90%|█████████ | 9/10 [01:18<00:07,  7.46s/it] {'epoch': 36, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.941, 'compress@10': 0.5265, 'time@10': 10.5175}: 100%|██████████| 10/10 [01:18<00:00,  8.51s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.941, 'compress@10': 0.5265, 'time@10': 10.5175}: 100%|██████████| 10/10 [01:18<00:00,  7.90s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.011858252961446613
Avg hit ratio: 0.8987109146277227
Avg ndcg: 0.9409580844432976
Avg compression ratio: 0.5264956172466392
Avg train time: 10.517480540275574
Std train time: 0.4357787119350599
[0.671052631578947, 0.5131578947368421, 0.03947368421052632, 0.40789473684210525, 0.9868421052631577, 0.644736842105263, 0.48684210526315796, 0.40789473684210525, 0.7236842105263157, 0.11842105263157897]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9176, 'compress@10': 0.6884, 'time@10': 11.2186}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9176, 'compress@10': 0.6884, 'time@10': 11.2186}:  10%|█         | 1/10 [00:05<00:50,  5.65s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9745, 'compress@10': 0.6086, 'time@10': 10.5365}:  10%|█         | 1/10 [00:15<00:50,  5.65s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9745, 'compress@10': 0.6086, 'time@10': 10.5365}:  20%|██        | 2/10 [00:15<01:05,  8.15s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9354, 'compress@10': 0.4646, 'time@10': 10.3746}:  20%|██        | 2/10 [00:20<01:05,  8.15s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9354, 'compress@10': 0.4646, 'time@10': 10.3746}:  30%|███       | 3/10 [00:20<00:47,  6.74s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9619, 'compress@10': 0.4557, 'time@10': 10.3595}:  30%|███       | 3/10 [00:30<00:47,  6.74s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9619, 'compress@10': 0.4557, 'time@10': 10.3595}:  40%|████      | 4/10 [00:30<00:49,  8.17s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9457, 'compress@10': 0.562, 'time@10': 10.3405}:  40%|████      | 4/10 [00:36<00:49,  8.17s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9457, 'compress@10': 0.562, 'time@10': 10.3405}:  50%|█████     | 5/10 [00:36<00:35,  7.09s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0182, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9503, 'compress@10': 0.5771, 'time@10': 10.317}:  50%|█████     | 5/10 [00:46<00:35,  7.09s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0182, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9503, 'compress@10': 0.5771, 'time@10': 10.317}:  60%|██████    | 6/10 [00:46<00:32,  8.16s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0177, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9495, 'compress@10': 0.5671, 'time@10': 10.3083}:  60%|██████    | 6/10 [00:51<00:32,  8.16s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0177, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9495, 'compress@10': 0.5671, 'time@10': 10.3083}:  70%|███████   | 7/10 [00:51<00:21,  7.18s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.968, 'compress@10': 0.5494, 'time@10': 10.3313}:  70%|███████   | 7/10 [01:02<00:21,  7.18s/it]  {'epoch': 37, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.968, 'compress@10': 0.5494, 'time@10': 10.3313}:  80%|████████  | 8/10 [01:02<00:16,  8.25s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0184, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9671, 'compress@10': 0.5696, 'time@10': 10.3888}:  80%|████████  | 8/10 [01:07<00:16,  8.25s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0184, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9671, 'compress@10': 0.5696, 'time@10': 10.3888}:  90%|█████████ | 9/10 [01:07<00:07,  7.38s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9677, 'compress@10': 0.5265, 'time@10': 10.4124}:  90%|█████████ | 9/10 [01:18<00:07,  7.38s/it]    {'epoch': 37, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9677, 'compress@10': 0.5265, 'time@10': 10.4124}: 100%|██████████| 10/10 [01:18<00:00,  8.39s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9677, 'compress@10': 0.5265, 'time@10': 10.4124}: 100%|██████████| 10/10 [01:18<00:00,  7.82s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.0179584541099544
Avg hit ratio: 0.9010969873363761
Avg ndcg: 0.9677427029336589
Avg compression ratio: 0.5264885769038894
Avg train time: 10.412437629699706
Std train time: 0.37890263173710625
[0.6538461538461535, 0.5256410256410257, 0.038461538461538464, 0.4230769230769231, 0.987179487179487, 0.6282051282051281, 0.47435897435897445, 0.4230769230769231, 0.7307692307692307, 0.1153846153846154]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9273, 'compress@10': 0.6721, 'time@10': 11.3402}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9273, 'compress@10': 0.6721, 'time@10': 11.3402}:  10%|█         | 1/10 [00:05<00:51,  5.71s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9475, 'compress@10': 0.6065, 'time@10': 10.6375}:  10%|█         | 1/10 [00:15<00:51,  5.71s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9475, 'compress@10': 0.6065, 'time@10': 10.6375}:  20%|██        | 2/10 [00:15<01:05,  8.22s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9174, 'compress@10': 0.4629, 'time@10': 10.3338}:  20%|██        | 2/10 [00:20<01:05,  8.22s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9174, 'compress@10': 0.4629, 'time@10': 10.3338}:  30%|███       | 3/10 [00:20<00:46,  6.71s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9286, 'compress@10': 0.4581, 'time@10': 10.3031}:  30%|███       | 3/10 [00:30<00:46,  6.71s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9286, 'compress@10': 0.4581, 'time@10': 10.3031}:  40%|████      | 4/10 [00:30<00:48,  8.11s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9195, 'compress@10': 0.564, 'time@10': 10.3233}:  40%|████      | 4/10 [00:36<00:48,  8.11s/it] {'epoch': 38, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9195, 'compress@10': 0.564, 'time@10': 10.3233}:  50%|█████     | 5/10 [00:36<00:35,  7.07s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9285, 'compress@10': 0.5761, 'time@10': 10.3088}:  50%|█████     | 5/10 [00:46<00:35,  7.07s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9285, 'compress@10': 0.5761, 'time@10': 10.3088}:  60%|██████    | 6/10 [00:46<00:32,  8.16s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9311, 'compress@10': 0.5645, 'time@10': 10.3525}:  60%|██████    | 6/10 [00:51<00:32,  8.16s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9311, 'compress@10': 0.5645, 'time@10': 10.3525}:  70%|███████   | 7/10 [00:51<00:21,  7.24s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9415, 'compress@10': 0.5489, 'time@10': 10.3616}:  70%|███████   | 7/10 [01:02<00:21,  7.24s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9415, 'compress@10': 0.5489, 'time@10': 10.3616}:  80%|████████  | 8/10 [01:02<00:16,  8.27s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9436, 'compress@10': 0.57, 'time@10': 10.4051}:  80%|████████  | 8/10 [01:07<00:16,  8.27s/it] {'epoch': 38, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9436, 'compress@10': 0.57, 'time@10': 10.4051}:  90%|█████████ | 9/10 [01:07<00:07,  7.38s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9468, 'compress@10': 0.5265, 'time@10': 10.4229}:  90%|█████████ | 9/10 [01:18<00:07,  7.38s/it] {'epoch': 38, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9468, 'compress@10': 0.5265, 'time@10': 10.4229}: 100%|██████████| 10/10 [01:18<00:00,  8.38s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9468, 'compress@10': 0.5265, 'time@10': 10.4229}: 100%|██████████| 10/10 [01:18<00:00,  7.82s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.011816711249931932
Avg hit ratio: 0.8842362602498426
Avg ndcg: 0.9468407474338765
Avg compression ratio: 0.526528698727928
Avg train time: 10.422906255722046
Std train time: 0.4261527895159996
[0.6374999999999997, 0.5375, 0.037500000000000006, 0.4125, 0.9874999999999998, 0.6124999999999999, 0.4875000000000001, 0.4375, 0.7374999999999999, 0.11250000000000002]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9198, 'compress@10': 0.6566, 'time@10': 11.2081}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9198, 'compress@10': 0.6566, 'time@10': 11.2081}:  10%|█         | 1/10 [00:05<00:50,  5.64s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9438, 'compress@10': 0.6045, 'time@10': 10.4971}:  10%|█         | 1/10 [00:15<00:50,  5.64s/it] {'epoch': 39, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9438, 'compress@10': 0.6045, 'time@10': 10.4971}:  20%|██        | 2/10 [00:15<01:04,  8.10s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9149, 'compress@10': 0.4613, 'time@10': 10.3433}:  20%|██        | 2/10 [00:20<01:04,  8.10s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9149, 'compress@10': 0.4613, 'time@10': 10.3433}:  30%|███       | 3/10 [00:20<00:46,  6.71s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9437, 'compress@10': 0.4544, 'time@10': 10.3086}:  30%|███       | 3/10 [00:30<00:46,  6.71s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9437, 'compress@10': 0.4544, 'time@10': 10.3086}:  40%|████      | 4/10 [00:30<00:48,  8.10s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9332, 'compress@10': 0.561, 'time@10': 10.3105}:  40%|████      | 4/10 [00:35<00:48,  8.10s/it] {'epoch': 39, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9332, 'compress@10': 0.561, 'time@10': 10.3105}:  50%|█████     | 5/10 [00:35<00:35,  7.06s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9399, 'compress@10': 0.5711, 'time@10': 10.3399}:  50%|█████     | 5/10 [00:46<00:35,  7.06s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9399, 'compress@10': 0.5711, 'time@10': 10.3399}:  60%|██████    | 6/10 [00:46<00:32,  8.23s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9414, 'compress@10': 0.562, 'time@10': 10.2888}:  60%|██████    | 6/10 [00:51<00:32,  8.23s/it] {'epoch': 39, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9414, 'compress@10': 0.562, 'time@10': 10.2888}:  70%|███████   | 7/10 [00:51<00:21,  7.19s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9452, 'compress@10': 0.5485, 'time@10': 10.2892}:  70%|███████   | 7/10 [01:01<00:21,  7.19s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9452, 'compress@10': 0.5485, 'time@10': 10.2892}:  80%|████████  | 8/10 [01:01<00:16,  8.19s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9476, 'compress@10': 0.5703, 'time@10': 10.3438}:  80%|████████  | 8/10 [01:07<00:16,  8.19s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9476, 'compress@10': 0.5703, 'time@10': 10.3438}:  90%|█████████ | 9/10 [01:07<00:07,  7.32s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.95, 'compress@10': 0.5266, 'time@10': 10.3546}:  90%|█████████ | 9/10 [01:17<00:07,  7.32s/it]     {'epoch': 39, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.95, 'compress@10': 0.5266, 'time@10': 10.3546}: 100%|██████████| 10/10 [01:17<00:00,  8.30s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.95, 'compress@10': 0.5266, 'time@10': 10.3546}: 100%|██████████| 10/10 [01:17<00:00,  7.78s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.010864525463865207
Avg hit ratio: 0.9053192095585982
Avg ndcg: 0.9499854838720347
Avg compression ratio: 0.5265541391658649
Avg train time: 10.354560375213623
Std train time: 0.39093856190432286
[0.6463414634146338, 0.524390243902439, 0.03658536585365854, 0.4268292682926829, 0.9878048780487804, 0.5975609756097561, 0.47560975609756106, 0.4268292682926829, 0.7439024390243901, 0.13414634146341464]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9248, 'compress@10': 0.6649, 'time@10': 10.9937}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9248, 'compress@10': 0.6649, 'time@10': 10.9937}:  10%|█         | 1/10 [00:05<00:49,  5.53s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9462, 'compress@10': 0.6023, 'time@10': 10.5845}:  10%|█         | 1/10 [00:15<00:49,  5.53s/it]  {'epoch': 40, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9462, 'compress@10': 0.6023, 'time@10': 10.5845}:  20%|██        | 2/10 [00:15<01:06,  8.29s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9165, 'compress@10': 0.4596, 'time@10': 10.3648}:  20%|██        | 2/10 [00:20<01:06,  8.29s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0047, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9165, 'compress@10': 0.4596, 'time@10': 10.3648}:  30%|███       | 3/10 [00:20<00:47,  6.79s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.931, 'compress@10': 0.4566, 'time@10': 10.3329}:  30%|███       | 3/10 [00:31<00:47,  6.79s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.931, 'compress@10': 0.4566, 'time@10': 10.3329}:  40%|████      | 4/10 [00:31<00:48,  8.16s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9241, 'compress@10': 0.5628, 'time@10': 10.3267}:  40%|████      | 4/10 [00:36<00:48,  8.16s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9241, 'compress@10': 0.5628, 'time@10': 10.3267}:  50%|█████     | 5/10 [00:36<00:35,  7.09s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.933, 'compress@10': 0.5701, 'time@10': 10.3006}:  50%|█████     | 5/10 [00:46<00:35,  7.09s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.933, 'compress@10': 0.5701, 'time@10': 10.3006}:  60%|██████    | 6/10 [00:46<00:32,  8.15s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9355, 'compress@10': 0.5596, 'time@10': 10.278}:  60%|██████    | 6/10 [00:51<00:32,  8.15s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9355, 'compress@10': 0.5596, 'time@10': 10.278}:  70%|███████   | 7/10 [00:51<00:21,  7.16s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.94, 'compress@10': 0.5451, 'time@10': 10.2876}:  70%|███████   | 7/10 [01:01<00:21,  7.16s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.94, 'compress@10': 0.5451, 'time@10': 10.2876}:  80%|████████  | 8/10 [01:01<00:16,  8.19s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9429, 'compress@10': 0.568, 'time@10': 10.3104}:  80%|████████  | 8/10 [01:07<00:16,  8.19s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9429, 'compress@10': 0.568, 'time@10': 10.3104}:  90%|█████████ | 9/10 [01:07<00:07,  7.28s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9463, 'compress@10': 0.5266, 'time@10': 10.3499}:  90%|█████████ | 9/10 [01:17<00:07,  7.28s/it] {'epoch': 40, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9463, 'compress@10': 0.5266, 'time@10': 10.3499}: 100%|██████████| 10/10 [01:17<00:00,  8.35s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9463, 'compress@10': 0.5266, 'time@10': 10.3499}: 100%|██████████| 10/10 [01:17<00:00,  7.79s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.010277208176899975
Avg hit ratio: 0.9075414317808205
Avg ndcg: 0.946261772303747
Avg compression ratio: 0.5265571576408707
Avg train time: 10.34987690448761
Std train time: 0.2936448714110596
[0.6309523809523806, 0.511904761904762, 0.03571428571428572, 0.44047619047619047, 0.988095238095238, 0.6071428571428571, 0.4880952380952382, 0.41666666666666663, 0.7499999999999999, 0.13095238095238096]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.927, 'compress@10': 0.6504, 'time@10': 11.0216}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.927, 'compress@10': 0.6504, 'time@10': 11.0216}:  10%|█         | 1/10 [00:05<00:49,  5.55s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9316, 'compress@10': 0.589, 'time@10': 10.5848}:  10%|█         | 1/10 [00:15<00:49,  5.55s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9316, 'compress@10': 0.589, 'time@10': 10.5848}:  20%|██        | 2/10 [00:15<01:06,  8.28s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9068, 'compress@10': 0.4505, 'time@10': 10.3277}:  20%|██        | 2/10 [00:20<01:06,  8.28s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9068, 'compress@10': 0.4505, 'time@10': 10.3277}:  30%|███       | 3/10 [00:20<00:47,  6.75s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9315, 'compress@10': 0.453, 'time@10': 10.3755}:  30%|███       | 3/10 [00:31<00:47,  6.75s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9315, 'compress@10': 0.453, 'time@10': 10.3755}:  40%|████      | 4/10 [00:31<00:49,  8.26s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9242, 'compress@10': 0.5601, 'time@10': 10.3207}:  40%|████      | 4/10 [00:36<00:49,  8.26s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9242, 'compress@10': 0.5601, 'time@10': 10.3207}:  50%|█████     | 5/10 [00:36<00:35,  7.11s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9313, 'compress@10': 0.5694, 'time@10': 10.3445}:  50%|█████     | 5/10 [00:46<00:35,  7.11s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9313, 'compress@10': 0.5694, 'time@10': 10.3445}:  60%|██████    | 6/10 [00:46<00:33,  8.26s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.934, 'compress@10': 0.5607, 'time@10': 10.3476}:  60%|██████    | 6/10 [00:52<00:33,  8.26s/it] {'epoch': 41, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.934, 'compress@10': 0.5607, 'time@10': 10.3476}:  70%|███████   | 7/10 [00:52<00:21,  7.27s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9393, 'compress@10': 0.5448, 'time@10': 10.3876}:  70%|███████   | 7/10 [01:02<00:21,  7.27s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9393, 'compress@10': 0.5448, 'time@10': 10.3876}:  80%|████████  | 8/10 [01:02<00:16,  8.36s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9424, 'compress@10': 0.5684, 'time@10': 10.4116}:  80%|████████  | 8/10 [01:08<00:16,  8.36s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9424, 'compress@10': 0.5684, 'time@10': 10.4116}:  90%|█████████ | 9/10 [01:08<00:07,  7.42s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9458, 'compress@10': 0.5266, 'time@10': 10.446}:  90%|█████████ | 9/10 [01:18<00:07,  7.42s/it]    {'epoch': 41, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9458, 'compress@10': 0.5266, 'time@10': 10.446}: 100%|██████████| 10/10 [01:18<00:00,  8.46s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9458, 'compress@10': 0.5266, 'time@10': 10.446}: 100%|██████████| 10/10 [01:18<00:00,  7.89s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.014114643470462877
Avg hit ratio: 0.9085450160102113
Avg ndcg: 0.9458177124124159
Avg compression ratio: 0.5265889146069711
Avg train time: 10.44602267742157
Std train time: 0.3347136385923902
[0.6162790697674415, 0.5232558139534884, 0.034883720930232565, 0.45348837209302323, 0.9883720930232558, 0.6162790697674418, 0.4767441860465117, 0.40697674418604646, 0.755813953488372, 0.12790697674418605]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9318, 'compress@10': 0.6365, 'time@10': 11.1495}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9318, 'compress@10': 0.6365, 'time@10': 11.1495}:  10%|█         | 1/10 [00:05<00:50,  5.61s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.0424, 'compress@10': 0.5875, 'time@10': 10.5434}:  10%|█         | 1/10 [00:15<00:50,  5.61s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.0424, 'compress@10': 0.5875, 'time@10': 10.5434}:  20%|██        | 2/10 [00:15<01:05,  8.18s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9806, 'compress@10': 0.4493, 'time@10': 10.2682}:  20%|██        | 2/10 [00:20<01:05,  8.18s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9806, 'compress@10': 0.4493, 'time@10': 10.2682}:  30%|███       | 3/10 [00:20<00:46,  6.68s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9765, 'compress@10': 0.4552, 'time@10': 10.2081}:  30%|███       | 3/10 [00:30<00:46,  6.68s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9765, 'compress@10': 0.4552, 'time@10': 10.2081}:  40%|████      | 4/10 [00:30<00:48,  8.02s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9603, 'compress@10': 0.5619, 'time@10': 10.1867}:  40%|████      | 4/10 [00:35<00:48,  8.02s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9603, 'compress@10': 0.5619, 'time@10': 10.1867}:  50%|█████     | 5/10 [00:35<00:34,  6.96s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9628, 'compress@10': 0.5724, 'time@10': 10.204}:  50%|█████     | 5/10 [00:45<00:34,  6.96s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9628, 'compress@10': 0.5724, 'time@10': 10.204}:  60%|██████    | 6/10 [00:45<00:32,  8.11s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.961, 'compress@10': 0.5617, 'time@10': 10.2345}:  60%|██████    | 6/10 [00:51<00:32,  8.11s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.961, 'compress@10': 0.5617, 'time@10': 10.2345}:  70%|███████   | 7/10 [00:51<00:21,  7.17s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9467, 'compress@10': 0.5445, 'time@10': 10.2401}:  70%|███████   | 7/10 [01:01<00:21,  7.17s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9467, 'compress@10': 0.5445, 'time@10': 10.2401}:  80%|████████  | 8/10 [01:01<00:16,  8.17s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.949, 'compress@10': 0.5687, 'time@10': 10.2718}:  80%|████████  | 8/10 [01:06<00:16,  8.17s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.949, 'compress@10': 0.5687, 'time@10': 10.2718}:  90%|█████████ | 9/10 [01:06<00:07,  7.28s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.9518, 'compress@10': 0.5266, 'time@10': 10.2931}:  90%|█████████ | 9/10 [01:17<00:07,  7.28s/it] {'epoch': 42, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.9518, 'compress@10': 0.5266, 'time@10': 10.2931}: 100%|██████████| 10/10 [01:17<00:00,  8.28s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.9518, 'compress@10': 0.5266, 'time@10': 10.2931}: 100%|██████████| 10/10 [01:17<00:00,  7.74s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.015536398226568294
Avg hit ratio: 0.9121164445816398
Avg ndcg: 0.9517684939408178
Avg compression ratio: 0.5266363302132483
Avg train time: 10.293064260482788
Std train time: 0.3748049666762134
[0.602272727272727, 0.5340909090909092, 0.034090909090909095, 0.4659090909090909, 0.9886363636363636, 0.6022727272727273, 0.465909090909091, 0.4204545454545454, 0.7613636363636362, 0.125]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9344, 'compress@10': 0.6232, 'time@10': 11.0336}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9344, 'compress@10': 0.6232, 'time@10': 11.0336}:  10%|█         | 1/10 [00:05<00:49,  5.55s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.004, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9511, 'compress@10': 0.5862, 'time@10': 10.5003}:  10%|█         | 1/10 [00:15<00:49,  5.55s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.004, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9511, 'compress@10': 0.5862, 'time@10': 10.5003}:  20%|██        | 2/10 [00:15<01:05,  8.17s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0027, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9198, 'compress@10': 0.4481, 'time@10': 10.2964}:  20%|██        | 2/10 [00:20<01:05,  8.17s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0027, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9198, 'compress@10': 0.4481, 'time@10': 10.2964}:  30%|███       | 3/10 [00:20<00:47,  6.72s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0032, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9309, 'compress@10': 0.4573, 'time@10': 10.2987}:  30%|███       | 3/10 [00:30<00:47,  6.72s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0032, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9309, 'compress@10': 0.4573, 'time@10': 10.2987}:  40%|████      | 4/10 [00:30<00:48,  8.15s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0062, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9255, 'compress@10': 0.5636, 'time@10': 10.3002}:  40%|████      | 4/10 [00:36<00:48,  8.15s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0062, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9255, 'compress@10': 0.5636, 'time@10': 10.3002}:  50%|█████     | 5/10 [00:36<00:35,  7.08s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0065, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9339, 'compress@10': 0.5716, 'time@10': 10.2803}:  50%|█████     | 5/10 [00:46<00:35,  7.08s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0065, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9339, 'compress@10': 0.5716, 'time@10': 10.2803}:  60%|██████    | 6/10 [00:46<00:32,  8.15s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.9206, 'ndcg@10': 0.9367, 'compress@10': 0.5595, 'time@10': 10.2373}:  60%|██████    | 6/10 [00:51<00:32,  8.15s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.9206, 'ndcg@10': 0.9367, 'compress@10': 0.5595, 'time@10': 10.2373}:  70%|███████   | 7/10 [00:51<00:21,  7.13s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.006, 'hit_ratio@10': 0.9269, 'ndcg@10': 0.941, 'compress@10': 0.5442, 'time@10': 10.2438}:  70%|███████   | 7/10 [01:01<00:21,  7.13s/it]   {'epoch': 43, 'num_users': 6.125, 'loss': 0.006, 'hit_ratio@10': 0.9269, 'ndcg@10': 0.941, 'compress@10': 0.5442, 'time@10': 10.2438}:  80%|████████  | 8/10 [01:01<00:16,  8.15s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0071, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9438, 'compress@10': 0.5691, 'time@10': 10.2762}:  80%|████████  | 8/10 [01:06<00:16,  8.15s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0071, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9438, 'compress@10': 0.5691, 'time@10': 10.2762}:  90%|█████████ | 9/10 [01:06<00:07,  7.26s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0076, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9471, 'compress@10': 0.5267, 'time@10': 10.3182}:  90%|█████████ | 9/10 [01:17<00:07,  7.26s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0076, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9471, 'compress@10': 0.5267, 'time@10': 10.3182}: 100%|██████████| 10/10 [01:17<00:00,  8.33s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0076, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9471, 'compress@10': 0.5267, 'time@10': 10.3182}: 100%|██████████| 10/10 [01:17<00:00,  7.77s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.007649061266323325
Avg hit ratio: 0.919259301724497
Avg ndcg: 0.9471196072464861
Avg compression ratio: 0.5266680086658934
Avg train time: 10.318182277679444
Std train time: 0.33828558294826017
[0.5888888888888886, 0.5222222222222223, 0.03333333333333334, 0.45555555555555555, 0.9888888888888889, 0.6111111111111112, 0.47777777777777786, 0.4111111111111111, 0.7666666666666665, 0.14444444444444443]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9318, 'compress@10': 0.6105, 'time@10': 10.8817}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9318, 'compress@10': 0.6105, 'time@10': 10.8817}:  10%|█         | 1/10 [00:05<00:49,  5.48s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9498, 'compress@10': 0.5741, 'time@10': 10.4206}:  10%|█         | 1/10 [00:15<00:49,  5.48s/it] {'epoch': 44, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9498, 'compress@10': 0.5741, 'time@10': 10.4206}:  20%|██        | 2/10 [00:15<01:05,  8.14s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9189, 'compress@10': 0.4399, 'time@10': 10.1215}:  20%|██        | 2/10 [00:20<01:05,  8.14s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9189, 'compress@10': 0.4399, 'time@10': 10.1215}:  30%|███       | 3/10 [00:20<00:46,  6.61s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9543, 'compress@10': 0.4486, 'time@10': 10.1122}:  30%|███       | 3/10 [00:30<00:46,  6.61s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9543, 'compress@10': 0.4486, 'time@10': 10.1122}:  40%|████      | 4/10 [00:30<00:47,  8.00s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9457, 'compress@10': 0.5567, 'time@10': 10.0388}:  40%|████      | 4/10 [00:35<00:47,  8.00s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9457, 'compress@10': 0.5567, 'time@10': 10.0388}:  50%|█████     | 5/10 [00:35<00:34,  6.88s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.9129, 'ndcg@10': 0.9517, 'compress@10': 0.5672, 'time@10': 10.0282}:  50%|█████     | 5/10 [00:45<00:34,  6.88s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.9129, 'ndcg@10': 0.9517, 'compress@10': 0.5672, 'time@10': 10.0282}:  60%|██████    | 6/10 [00:45<00:31,  7.95s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.9519, 'compress@10': 0.5574, 'time@10': 10.0272}:  60%|██████    | 6/10 [00:50<00:31,  7.95s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.9196, 'ndcg@10': 0.9519, 'compress@10': 0.5574, 'time@10': 10.0272}:  70%|███████   | 7/10 [00:50<00:20,  7.00s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9261, 'ndcg@10': 0.9544, 'compress@10': 0.5413, 'time@10': 10.0261}:  70%|███████   | 7/10 [01:00<00:20,  7.00s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9261, 'ndcg@10': 0.9544, 'compress@10': 0.5413, 'time@10': 10.0261}:  80%|████████  | 8/10 [01:00<00:15,  7.97s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.956, 'compress@10': 0.567, 'time@10': 10.0259}:  80%|████████  | 8/10 [01:05<00:15,  7.97s/it] {'epoch': 44, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.956, 'compress@10': 0.567, 'time@10': 10.0259}:  90%|█████████ | 9/10 [01:05<00:07,  7.06s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.958, 'compress@10': 0.5267, 'time@10': 10.048}:  90%|█████████ | 9/10 [01:15<00:07,  7.06s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.958, 'compress@10': 0.5267, 'time@10': 10.048}: 100%|██████████| 10/10 [01:15<00:00,  8.05s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.958, 'compress@10': 0.5267, 'time@10': 10.048}: 100%|██████████| 10/10 [01:15<00:00,  7.58s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.010519612384202359
Avg hit ratio: 0.918601339614922
Avg ndcg: 0.9580304104442998
Avg compression ratio: 0.5267253517556876
Avg train time: 10.047986698150634
Std train time: 0.3343896758160998
[0.5978260869565214, 0.5108695652173914, 0.03260869565217392, 0.46739130434782605, 0.9891304347826088, 0.6195652173913044, 0.46739130434782616, 0.40217391304347827, 0.7717391304347825, 0.14130434782608695]
[13, 14, 38, 16, 5, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9408, 'compress@10': 0.619, 'time@10': 10.1892}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9408, 'compress@10': 0.619, 'time@10': 10.1892}:  10%|█         | 1/10 [00:05<00:46,  5.13s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9558, 'compress@10': 0.5728, 'time@10': 9.6702}:  10%|█         | 1/10 [00:14<00:46,  5.13s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9558, 'compress@10': 0.5728, 'time@10': 9.6702}:  20%|██        | 2/10 [00:14<01:00,  7.52s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9229, 'compress@10': 0.4388, 'time@10': 9.2768}:  20%|██        | 2/10 [00:18<01:00,  7.52s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9229, 'compress@10': 0.4388, 'time@10': 9.2768}:  30%|███       | 3/10 [00:18<00:42,  6.04s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9333, 'compress@10': 0.4507, 'time@10': 9.2432}:  30%|███       | 3/10 [00:27<00:42,  6.04s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9333, 'compress@10': 0.4507, 'time@10': 9.2432}:  40%|████      | 4/10 [00:27<00:43,  7.28s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.9298, 'compress@10': 0.5584, 'time@10': 9.2064}:  40%|████      | 4/10 [00:32<00:43,  7.28s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.9298, 'compress@10': 0.5584, 'time@10': 9.2064}:  50%|█████     | 5/10 [00:32<00:31,  6.30s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.9247, 'ndcg@10': 0.9369, 'compress@10': 0.57, 'time@10': 9.1994}:  50%|█████     | 5/10 [00:41<00:31,  6.30s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.9247, 'ndcg@10': 0.9369, 'compress@10': 0.57, 'time@10': 9.1994}:  60%|██████    | 6/10 [00:41<00:29,  7.29s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9397, 'compress@10': 0.5584, 'time@10': 9.1776}:  60%|██████    | 6/10 [00:46<00:29,  7.29s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0126, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9397, 'compress@10': 0.5584, 'time@10': 9.1776}:  70%|███████   | 7/10 [00:46<00:19,  6.40s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.935, 'ndcg@10': 0.9437, 'compress@10': 0.541, 'time@10': 9.2087}:  70%|███████   | 7/10 [00:55<00:19,  6.40s/it]   {'epoch': 45, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.935, 'ndcg@10': 0.9437, 'compress@10': 0.541, 'time@10': 9.2087}:  80%|████████  | 8/10 [00:55<00:14,  7.38s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.9263, 'ndcg@10': 0.9468, 'compress@10': 0.5674, 'time@10': 9.2271}:  80%|████████  | 8/10 [01:00<00:14,  7.38s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.9263, 'ndcg@10': 0.9468, 'compress@10': 0.5674, 'time@10': 9.2271}:  90%|█████████ | 9/10 [01:00<00:06,  6.55s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9314, 'ndcg@10': 0.9497, 'compress@10': 0.5267, 'time@10': 9.2456}:  90%|█████████ | 9/10 [01:09<00:06,  6.55s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9314, 'ndcg@10': 0.9497, 'compress@10': 0.5267, 'time@10': 9.2456}: 100%|██████████| 10/10 [01:09<00:00,  7.45s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9314, 'ndcg@10': 0.9497, 'compress@10': 0.5267, 'time@10': 9.2456}: 100%|██████████| 10/10 [01:09<00:00,  6.98s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.01173769445333642
Avg hit ratio: 0.9314252003420085
Avg ndcg: 0.9497463153017757
Avg compression ratio: 0.526723110617931
Avg train time: 9.245607328414916
Std train time: 0.40479351598878444
[0.5851063829787231, 0.5212765957446809, 0.03191489361702128, 0.4787234042553191, 0.9893617021276596, 0.6063829787234043, 0.45744680851063835, 0.39361702127659576, 0.7765957446808509, 0.15957446808510636]
[13, 15, 39, 17, 6, 11, 10, 14, 8, 12]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0069, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.937, 'compress@10': 0.6069, 'time@10': 9.3916}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0069, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.937, 'compress@10': 0.6069, 'time@10': 9.3916}:  10%|█         | 1/10 [00:04<00:42,  4.73s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9585, 'compress@10': 0.5718, 'time@10': 9.2911}:  10%|█         | 1/10 [00:13<00:42,  4.73s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9585, 'compress@10': 0.5718, 'time@10': 9.2911}:  20%|██        | 2/10 [00:13<00:59,  7.39s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9247, 'compress@10': 0.438, 'time@10': 9.166}:  20%|██        | 2/10 [00:18<00:59,  7.39s/it]  {'epoch': 46, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9247, 'compress@10': 0.438, 'time@10': 9.166}:  30%|███       | 3/10 [00:18<00:42,  6.07s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9449, 'compress@10': 0.4528, 'time@10': 9.1905}:  30%|███       | 3/10 [00:27<00:42,  6.07s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9449, 'compress@10': 0.4528, 'time@10': 9.1905}:  40%|████      | 4/10 [00:27<00:44,  7.34s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0133, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9412, 'compress@10': 0.5602, 'time@10': 9.3964}:  40%|████      | 4/10 [00:32<00:44,  7.34s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0133, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9412, 'compress@10': 0.5602, 'time@10': 9.3964}:  50%|█████     | 5/10 [00:32<00:32,  6.55s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.929, 'ndcg@10': 0.9486, 'compress@10': 0.5693, 'time@10': 9.4158}:  50%|█████     | 5/10 [00:42<00:32,  6.55s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.929, 'ndcg@10': 0.9486, 'compress@10': 0.5693, 'time@10': 9.4158}:  60%|██████    | 6/10 [00:42<00:30,  7.57s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.9334, 'ndcg@10': 0.9496, 'compress@10': 0.5564, 'time@10': 9.4368}:  60%|██████    | 6/10 [00:47<00:30,  7.57s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.9334, 'ndcg@10': 0.9496, 'compress@10': 0.5564, 'time@10': 9.4368}:  70%|███████   | 7/10 [00:47<00:20,  6.67s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.9382, 'ndcg@10': 0.9478, 'compress@10': 0.5382, 'time@10': 9.4272}:  70%|███████   | 7/10 [00:56<00:20,  6.67s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.9382, 'ndcg@10': 0.9478, 'compress@10': 0.5382, 'time@10': 9.4272}:  80%|████████  | 8/10 [00:56<00:15,  7.54s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.926, 'ndcg@10': 0.9503, 'compress@10': 0.5654, 'time@10': 9.5343}:  80%|████████  | 8/10 [01:01<00:15,  7.54s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.926, 'ndcg@10': 0.9503, 'compress@10': 0.5654, 'time@10': 9.5343}:  90%|█████████ | 9/10 [01:01<00:06,  6.82s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.9311, 'ndcg@10': 0.9529, 'compress@10': 0.5268, 'time@10': 9.5827}:  90%|█████████ | 9/10 [01:11<00:06,  6.82s/it]  {'epoch': 46, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.9311, 'ndcg@10': 0.9529, 'compress@10': 0.5268, 'time@10': 9.5827}: 100%|██████████| 10/10 [01:11<00:00,  7.82s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.9311, 'ndcg@10': 0.9529, 'compress@10': 0.5268, 'time@10': 9.5827}: 100%|██████████| 10/10 [01:11<00:00,  7.20s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.018289351074689077
Avg hit ratio: 0.9311359018269035
Avg ndcg: 0.95291578947783
Avg compression ratio: 0.5267634580022531
Avg train time: 9.582699847221374
Std train time: 0.4516112484031267
[0.5729166666666663, 0.53125, 0.03125000000000001, 0.4895833333333333, 0.96875, 0.6145833333333334, 0.44791666666666674, 0.40625, 0.7812499999999999, 0.15624999999999997]
[14, 16, 40, 18, 6, 11, 10, 15, 8, 12]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0045, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9418, 'compress@10': 0.5954, 'time@10': 10.1856}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0045, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9418, 'compress@10': 0.5954, 'time@10': 10.1856}:  10%|█         | 1/10 [00:05<00:46,  5.13s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0047, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9548, 'compress@10': 0.5709, 'time@10': 9.9065}:  10%|█         | 1/10 [00:14<00:46,  5.13s/it]  {'epoch': 47, 'num_users': 7.0, 'loss': 0.0047, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9548, 'compress@10': 0.5709, 'time@10': 9.9065}:  20%|██        | 2/10 [00:14<01:02,  7.80s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0031, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9222, 'compress@10': 0.4371, 'time@10': 9.5282}:  20%|██        | 2/10 [00:19<01:02,  7.80s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0031, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9222, 'compress@10': 0.4371, 'time@10': 9.5282}:  30%|███       | 3/10 [00:19<00:43,  6.25s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0036, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9327, 'compress@10': 0.4548, 'time@10': 9.6374}:  30%|███       | 3/10 [00:29<00:43,  6.25s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0036, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9327, 'compress@10': 0.4548, 'time@10': 9.6374}:  40%|████      | 4/10 [00:29<00:46,  7.73s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.006, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9308, 'compress@10': 0.5577, 'time@10': 9.7886}:  40%|████      | 4/10 [00:34<00:46,  7.73s/it] {'epoch': 47, 'num_users': 5.8, 'loss': 0.006, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9308, 'compress@10': 0.5577, 'time@10': 9.7886}:  50%|█████     | 5/10 [00:34<00:34,  6.83s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0062, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9382, 'compress@10': 0.5686, 'time@10': 9.7189}:  50%|█████     | 5/10 [00:43<00:34,  6.83s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0062, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.9382, 'compress@10': 0.5686, 'time@10': 9.7189}:  60%|██████    | 6/10 [00:43<00:30,  7.71s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.006, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9409, 'compress@10': 0.5545, 'time@10': 9.6724}:  60%|██████    | 6/10 [00:48<00:30,  7.71s/it] {'epoch': 47, 'num_users': 6.2857, 'loss': 0.006, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9409, 'compress@10': 0.5545, 'time@10': 9.6724}:  70%|███████   | 7/10 [00:48<00:20,  6.74s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0054, 'hit_ratio@10': 0.9246, 'ndcg@10': 0.9447, 'compress@10': 0.5381, 'time@10': 9.7188}:  70%|███████   | 7/10 [00:58<00:20,  6.74s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0054, 'hit_ratio@10': 0.9246, 'ndcg@10': 0.9447, 'compress@10': 0.5381, 'time@10': 9.7188}:  80%|████████  | 8/10 [00:58<00:15,  7.80s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0054, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.947, 'compress@10': 0.5658, 'time@10': 9.7681}:  80%|████████  | 8/10 [01:03<00:15,  7.80s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0054, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.947, 'compress@10': 0.5658, 'time@10': 9.7681}:  90%|█████████ | 9/10 [01:03<00:06,  6.96s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0068, 'hit_ratio@10': 0.9202, 'ndcg@10': 0.9491, 'compress@10': 0.5268, 'time@10': 9.7658}:  90%|█████████ | 9/10 [01:13<00:06,  6.96s/it]  {'epoch': 47, 'num_users': 6.3, 'loss': 0.0068, 'hit_ratio@10': 0.9202, 'ndcg@10': 0.9491, 'compress@10': 0.5268, 'time@10': 9.7658}: 100%|██████████| 10/10 [01:13<00:00,  7.83s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0068, 'hit_ratio@10': 0.9202, 'ndcg@10': 0.9491, 'compress@10': 0.5268, 'time@10': 9.7658}: 100%|██████████| 10/10 [01:13<00:00,  7.36s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.006844466555775096
Avg hit ratio: 0.9202398444792333
Avg ndcg: 0.9491465380819539
Avg compression ratio: 0.526786111931776
Avg train time: 9.765789127349853
Std train time: 0.46352219413120327
[0.561224489795918, 0.5204081632653061, 0.03061224489795919, 0.47959183673469385, 0.9693877551020408, 0.6224489795918368, 0.4591836734693878, 0.3979591836734694, 0.7857142857142856, 0.173469387755102]
[14, 16, 41, 18, 6, 12, 11, 15, 8, 12]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9418, 'compress@10': 0.5843, 'time@10': 10.0077}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9418, 'compress@10': 0.5843, 'time@10': 10.0077}:  10%|█         | 1/10 [00:05<00:45,  5.04s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9524, 'compress@10': 0.5601, 'time@10': 9.6502}:  10%|█         | 1/10 [00:14<00:45,  5.04s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9524, 'compress@10': 0.5601, 'time@10': 9.6502}:  20%|██        | 2/10 [00:14<01:00,  7.56s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9206, 'compress@10': 0.4298, 'time@10': 9.2961}:  20%|██        | 2/10 [00:18<01:00,  7.56s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.9206, 'compress@10': 0.4298, 'time@10': 9.2961}:  30%|███       | 3/10 [00:18<00:42,  6.08s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9411, 'compress@10': 0.4469, 'time@10': 9.2827}:  30%|███       | 3/10 [00:27<00:42,  6.08s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9411, 'compress@10': 0.4469, 'time@10': 9.2827}:  40%|████      | 4/10 [00:27<00:44,  7.35s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.9257, 'ndcg@10': 0.9389, 'compress@10': 0.5515, 'time@10': 9.7164}:  40%|████      | 4/10 [00:33<00:44,  7.35s/it] {'epoch': 48, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.9257, 'ndcg@10': 0.9389, 'compress@10': 0.5515, 'time@10': 9.7164}:  50%|█████     | 5/10 [00:33<00:33,  6.77s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.9307, 'ndcg@10': 0.9448, 'compress@10': 0.5647, 'time@10': 9.8025}:  50%|█████     | 5/10 [00:44<00:33,  6.77s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.9307, 'ndcg@10': 0.9448, 'compress@10': 0.5647, 'time@10': 9.8025}:  60%|██████    | 6/10 [00:44<00:31,  7.97s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.9349, 'ndcg@10': 0.9466, 'compress@10': 0.5527, 'time@10': 9.8671}:  60%|██████    | 6/10 [00:49<00:31,  7.97s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.9349, 'ndcg@10': 0.9466, 'compress@10': 0.5527, 'time@10': 9.8671}:  70%|███████   | 7/10 [00:49<00:21,  7.05s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0119, 'hit_ratio@10': 0.9394, 'ndcg@10': 0.9497, 'compress@10': 0.5355, 'time@10': 9.873}:  70%|███████   | 7/10 [00:59<00:21,  7.05s/it]  {'epoch': 48, 'num_users': 6.125, 'loss': 0.0119, 'hit_ratio@10': 0.9394, 'ndcg@10': 0.9497, 'compress@10': 0.5355, 'time@10': 9.873}:  80%|████████  | 8/10 [00:59<00:15,  7.98s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.9271, 'ndcg@10': 0.951, 'compress@10': 0.564, 'time@10': 9.8624}:  80%|████████  | 8/10 [01:04<00:15,  7.98s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.9271, 'ndcg@10': 0.951, 'compress@10': 0.564, 'time@10': 9.8624}:  90%|█████████ | 9/10 [01:04<00:07,  7.02s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.9321, 'ndcg@10': 0.9532, 'compress@10': 0.5268, 'time@10': 9.8615}:  90%|█████████ | 9/10 [01:13<00:07,  7.02s/it] {'epoch': 48, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.9321, 'ndcg@10': 0.9532, 'compress@10': 0.5268, 'time@10': 9.8615}: 100%|██████████| 10/10 [01:13<00:00,  7.91s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.9321, 'ndcg@10': 0.9532, 'compress@10': 0.5268, 'time@10': 9.8615}: 100%|██████████| 10/10 [01:13<00:00,  7.40s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.011624690339056125
Avg hit ratio: 0.9321394860562942
Avg ndcg: 0.9532064989232808
Avg compression ratio: 0.5268342982299601
Avg train time: 9.861487412452698
Std train time: 0.7197345395957123
[0.5499999999999996, 0.53, 0.030000000000000006, 0.49, 0.97, 0.63, 0.45000000000000007, 0.39, 0.7699999999999999, 0.18999999999999997]
[14, 17, 42, 19, 6, 12, 11, 15, 8, 12]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0043, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9418, 'compress@10': 0.5737, 'time@10': 10.6766}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0043, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9418, 'compress@10': 0.5737, 'time@10': 10.6766}:  10%|█         | 1/10 [00:05<00:48,  5.40s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9548, 'compress@10': 0.5594, 'time@10': 10.4706}:  10%|█         | 1/10 [00:15<00:48,  5.40s/it] {'epoch': 49, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9548, 'compress@10': 0.5594, 'time@10': 10.4706}:  20%|██        | 2/10 [00:15<01:06,  8.28s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9222, 'compress@10': 0.4291, 'time@10': 10.104}:  20%|██        | 2/10 [00:20<01:06,  8.28s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9222, 'compress@10': 0.4291, 'time@10': 10.104}:  30%|███       | 3/10 [00:20<00:46,  6.65s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9327, 'compress@10': 0.4489, 'time@10': 10.1593}:  30%|███       | 3/10 [00:30<00:46,  6.65s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9327, 'compress@10': 0.4489, 'time@10': 10.1593}:  40%|████      | 4/10 [00:30<00:48,  8.12s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9327, 'compress@10': 0.5532, 'time@10': 10.2519}:  40%|████      | 4/10 [00:36<00:48,  8.12s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9327, 'compress@10': 0.5532, 'time@10': 10.2519}:  50%|█████     | 5/10 [00:36<00:35,  7.12s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9402, 'compress@10': 0.5674, 'time@10': 10.4019}:  50%|█████     | 5/10 [00:47<00:35,  7.12s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9402, 'compress@10': 0.5674, 'time@10': 10.4019}:  60%|██████    | 6/10 [00:47<00:34,  8.50s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.9401, 'compress@10': 0.5538, 'time@10': 10.404}:  60%|██████    | 6/10 [00:52<00:34,  8.50s/it] {'epoch': 49, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.9242, 'ndcg@10': 0.9401, 'compress@10': 0.5538, 'time@10': 10.404}:  70%|███████   | 7/10 [00:52<00:22,  7.44s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9301, 'ndcg@10': 0.9565, 'compress@10': 0.5355, 'time@10': 10.2654}:  70%|███████   | 7/10 [01:01<00:22,  7.44s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9301, 'ndcg@10': 0.9565, 'compress@10': 0.5355, 'time@10': 10.2654}:  80%|████████  | 8/10 [01:01<00:16,  8.04s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9157, 'ndcg@10': 0.9576, 'compress@10': 0.5623, 'time@10': 10.1811}:  80%|████████  | 8/10 [01:06<00:16,  8.04s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9157, 'ndcg@10': 0.9576, 'compress@10': 0.5623, 'time@10': 10.1811}:  90%|█████████ | 9/10 [01:06<00:07,  7.02s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9218, 'ndcg@10': 0.9594, 'compress@10': 0.5269, 'time@10': 10.135}:  90%|█████████ | 9/10 [01:16<00:07,  7.02s/it]    {'epoch': 49, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9218, 'ndcg@10': 0.9594, 'compress@10': 0.5269, 'time@10': 10.135}: 100%|██████████| 10/10 [01:16<00:00,  7.87s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9218, 'ndcg@10': 0.9594, 'compress@10': 0.5269, 'time@10': 10.135}: 100%|██████████| 10/10 [01:16<00:00,  7.64s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.01329608288837474
Avg hit ratio: 0.9218271460665349
Avg ndcg: 0.9594071686309078
Avg compression ratio: 0.526882361386413
Avg train time: 10.135037064552307
Std train time: 0.5960425542663176
[0.5392156862745094, 0.5392156862745098, 0.02941176470588236, 0.4803921568627451, 0.9705882352941176, 0.6176470588235294, 0.4607843137254903, 0.4019607843137255, 0.7745098039215685, 0.18627450980392155]
[14, 17, 43, 19, 6, 12, 11, 16, 8, 12]
