  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1701, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5117, 'compress@10': 0.9052, 'time@10': 9.6876}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1701, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5117, 'compress@10': 0.9052, 'time@10': 9.6876}:  10%|█         | 1/10 [00:04<00:43,  4.88s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1238, 'hit_ratio@10': 0.6239, 'ndcg@10': 0.6433, 'compress@10': 0.9042, 'time@10': 8.3343}:  10%|█         | 1/10 [00:11<00:43,  4.88s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1238, 'hit_ratio@10': 0.6239, 'ndcg@10': 0.6433, 'compress@10': 0.9042, 'time@10': 8.3343}:  20%|██        | 2/10 [00:11<00:49,  6.14s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7265, 'hit_ratio@10': 0.5112, 'ndcg@10': 0.4308, 'compress@10': 0.9076, 'time@10': 6.4679}:  20%|██        | 2/10 [00:13<00:49,  6.14s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7265, 'hit_ratio@10': 0.5112, 'ndcg@10': 0.4308, 'compress@10': 0.9076, 'time@10': 6.4679}:  30%|███       | 3/10 [00:13<00:27,  3.98s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5722, 'hit_ratio@10': 0.5798, 'ndcg@10': 0.4765, 'compress@10': 0.9066, 'time@10': 6.3932}:  30%|███       | 3/10 [00:19<00:27,  3.98s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5722, 'hit_ratio@10': 0.5798, 'ndcg@10': 0.4765, 'compress@10': 0.9066, 'time@10': 6.3932}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4764, 'hit_ratio@10': 0.6279, 'ndcg@10': 0.532, 'compress@10': 0.9057, 'time@10': 9.5896}:  40%|████      | 4/10 [00:30<00:29,  4.86s/it] {'epoch': 0, 'num_users': 5.8, 'loss': 0.4764, 'hit_ratio@10': 0.6279, 'ndcg@10': 0.532, 'compress@10': 0.9057, 'time@10': 9.5896}:  50%|█████     | 5/10 [00:30<00:35,  7.16s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4113, 'hit_ratio@10': 0.638, 'ndcg@10': 0.5756, 'compress@10': 0.9051, 'time@10': 9.6855}:  50%|█████     | 5/10 [00:40<00:35,  7.16s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4113, 'hit_ratio@10': 0.638, 'ndcg@10': 0.5756, 'compress@10': 0.9051, 'time@10': 9.6855}:  60%|██████    | 6/10 [00:40<00:32,  8.19s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.369, 'hit_ratio@10': 0.6555, 'ndcg@10': 0.5756, 'compress@10': 0.9049, 'time@10': 9.9887}:  60%|██████    | 6/10 [00:46<00:32,  8.19s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.369, 'hit_ratio@10': 0.6555, 'ndcg@10': 0.5756, 'compress@10': 0.9049, 'time@10': 9.9887}:  70%|███████   | 7/10 [00:46<00:22,  7.46s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3294, 'hit_ratio@10': 0.6878, 'ndcg@10': 0.6007, 'compress@10': 0.9047, 'time@10': 9.7079}:  70%|███████   | 7/10 [00:54<00:22,  7.46s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3294, 'hit_ratio@10': 0.6878, 'ndcg@10': 0.6007, 'compress@10': 0.9047, 'time@10': 9.7079}:  80%|████████  | 8/10 [00:54<00:15,  7.56s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2991, 'hit_ratio@10': 0.6971, 'ndcg@10': 0.6342, 'compress@10': 0.9045, 'time@10': 10.3342}:  80%|████████  | 8/10 [01:02<00:15,  7.56s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2991, 'hit_ratio@10': 0.6971, 'ndcg@10': 0.6342, 'compress@10': 0.9045, 'time@10': 10.3342}:  90%|█████████ | 9/10 [01:02<00:07,  7.61s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2746, 'hit_ratio@10': 0.7206, 'ndcg@10': 0.6556, 'compress@10': 0.9042, 'time@10': 10.2443}:  90%|█████████ | 9/10 [01:11<00:07,  7.61s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2746, 'hit_ratio@10': 0.7206, 'ndcg@10': 0.6556, 'compress@10': 0.9042, 'time@10': 10.2443}: 100%|██████████| 10/10 [01:11<00:00,  8.18s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2746, 'hit_ratio@10': 0.7206, 'ndcg@10': 0.6556, 'compress@10': 0.9042, 'time@10': 10.2443}: 100%|██████████| 10/10 [01:11<00:00,  7.19s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.2745755642440402
Avg hit ratio: 0.720572768676334
Avg ndcg: 0.6556054387935528
Avg compression ratio: 0.9042398727588988
Avg train time: 10.244341588020324
Std train time: 5.162451659184975
[0.95, 0.45, 0.95, 0.95, 0.95, 0.45, 0.95, 0.45, 0.45, 0.45]
[10, 10, 11, 10, 9, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0532, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8452, 'compress@10': 0.9526, 'time@10': 8.4514}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0532, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8452, 'compress@10': 0.9526, 'time@10': 8.4514}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0532, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8497, 'compress@10': 0.7102, 'time@10': 7.745}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]  {'epoch': 1, 'num_users': 7.0, 'loss': 0.0532, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8497, 'compress@10': 0.7102, 'time@10': 7.745}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.042, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8227, 'compress@10': 0.7925, 'time@10': 6.1584}:  20%|██        | 2/10 [00:12<00:47,  5.92s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.042, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8227, 'compress@10': 0.7925, 'time@10': 6.1584}:  30%|███       | 3/10 [00:12<00:27,  3.91s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0439, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8277, 'compress@10': 0.8323, 'time@10': 6.3056}:  30%|███       | 3/10 [00:19<00:27,  3.91s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0439, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8277, 'compress@10': 0.8323, 'time@10': 6.3056}:  40%|████      | 4/10 [00:19<00:30,  5.05s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0525, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8201, 'compress@10': 0.856, 'time@10': 9.0028}:  40%|████      | 4/10 [00:29<00:30,  5.05s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.0525, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8201, 'compress@10': 0.856, 'time@10': 9.0028}:  50%|█████     | 5/10 [00:29<00:34,  6.81s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0565, 'hit_ratio@10': 0.7964, 'ndcg@10': 0.8188, 'compress@10': 0.7904, 'time@10': 9.2168}:  50%|█████     | 5/10 [00:39<00:34,  6.81s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0565, 'hit_ratio@10': 0.7964, 'ndcg@10': 0.8188, 'compress@10': 0.7904, 'time@10': 9.2168}:  60%|██████    | 6/10 [00:39<00:32,  8.00s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0546, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8268, 'compress@10': 0.8135, 'time@10': 9.5028}:  60%|██████    | 6/10 [00:45<00:32,  8.00s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0546, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8268, 'compress@10': 0.8135, 'time@10': 9.5028}:  70%|███████   | 7/10 [00:45<00:21,  7.23s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0524, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8323, 'compress@10': 0.77, 'time@10': 9.3101}:  70%|███████   | 7/10 [00:53<00:21,  7.23s/it]   {'epoch': 1, 'num_users': 6.125, 'loss': 0.0524, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8323, 'compress@10': 0.77, 'time@10': 9.3101}:  80%|████████  | 8/10 [00:53<00:14,  7.48s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8416, 'compress@10': 0.7362, 'time@10': 10.1985}:  80%|████████  | 8/10 [01:02<00:14,  7.48s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8416, 'compress@10': 0.7362, 'time@10': 10.1985}:  90%|█████████ | 9/10 [01:02<00:07,  7.86s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.842, 'compress@10': 0.7088, 'time@10': 10.1703}:  90%|█████████ | 9/10 [01:12<00:07,  7.86s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.842, 'compress@10': 0.7088, 'time@10': 10.1703}: 100%|██████████| 10/10 [01:12<00:00,  8.50s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.842, 'compress@10': 0.7088, 'time@10': 10.1703}: 100%|██████████| 10/10 [01:12<00:00,  7.22s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.04994888688140486
Avg hit ratio: 0.8241870463058918
Avg ndcg: 0.842004235238907
Avg compression ratio: 0.7088359774371817
Avg train time: 10.170305013656616
Std train time: 4.750176158796961
[0.9666666666666667, 0.6333333333333333, 0.6333333333333333, 0.9666666666666667, 0.9666666666666667, 0.6333333333333333, 0.6333333333333333, 0.30000000000000004, 0.30000000000000004, 0.30000000000000004]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8456, 'compress@10': 0.9684, 'time@10': 8.3943}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8456, 'compress@10': 0.9684, 'time@10': 8.3943}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.798, 'ndcg@10': 0.842, 'compress@10': 0.8068, 'time@10': 7.7441}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]    {'epoch': 2, 'num_users': 7.0, 'loss': 0.05, 'hit_ratio@10': 0.798, 'ndcg@10': 0.842, 'compress@10': 0.8068, 'time@10': 7.7441}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8471, 'compress@10': 0.7664, 'time@10': 6.2844}:  20%|██        | 2/10 [00:13<00:47,  5.94s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8471, 'compress@10': 0.7664, 'time@10': 6.2844}:  30%|███       | 3/10 [00:13<00:28,  4.01s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0382, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8466, 'compress@10': 0.8168, 'time@10': 6.2897}:  30%|███       | 3/10 [00:19<00:28,  4.01s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0382, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8466, 'compress@10': 0.8168, 'time@10': 6.2897}:  40%|████      | 4/10 [00:19<00:29,  4.93s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.78, 'ndcg@10': 0.834, 'compress@10': 0.8469, 'time@10': 8.5768}:  40%|████      | 4/10 [00:28<00:29,  4.93s/it]   {'epoch': 2, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.78, 'ndcg@10': 0.834, 'compress@10': 0.8469, 'time@10': 8.5768}:  50%|█████     | 5/10 [00:28<00:31,  6.37s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0522, 'hit_ratio@10': 0.7723, 'ndcg@10': 0.8323, 'compress@10': 0.8126, 'time@10': 8.8728}:  50%|█████     | 5/10 [00:38<00:31,  6.37s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0522, 'hit_ratio@10': 0.7723, 'ndcg@10': 0.8323, 'compress@10': 0.8126, 'time@10': 8.8728}:  60%|██████    | 6/10 [00:38<00:30,  7.73s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.7991, 'ndcg@10': 0.8337, 'compress@10': 0.7891, 'time@10': 9.2465}:  60%|██████    | 6/10 [00:44<00:30,  7.73s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.7991, 'ndcg@10': 0.8337, 'compress@10': 0.7891, 'time@10': 9.2465}:  70%|███████   | 7/10 [00:44<00:21,  7.10s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.8348, 'compress@10': 0.7305, 'time@10': 9.088}:  70%|███████   | 7/10 [00:52<00:21,  7.10s/it]  {'epoch': 2, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8171, 'ndcg@10': 0.8348, 'compress@10': 0.7305, 'time@10': 9.088}:  80%|████████  | 8/10 [00:52<00:14,  7.39s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8457, 'compress@10': 0.6849, 'time@10': 9.665}:  80%|████████  | 8/10 [00:59<00:14,  7.39s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8457, 'compress@10': 0.6849, 'time@10': 9.665}:  90%|█████████ | 9/10 [00:59<00:07,  7.32s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8463, 'compress@10': 0.648, 'time@10': 9.7178}:  90%|█████████ | 9/10 [01:09<00:07,  7.32s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8463, 'compress@10': 0.648, 'time@10': 9.7178}: 100%|██████████| 10/10 [01:09<00:00,  8.22s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8463, 'compress@10': 0.648, 'time@10': 9.7178}: 100%|██████████| 10/10 [01:09<00:00,  6.99s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04907440325973859
Avg hit ratio: 0.8211076812265269
Avg ndcg: 0.8462865833113808
Avg compression ratio: 0.6479807772392869
Avg train time: 9.717818689346313
Std train time: 3.903483301973293
[0.725, 0.725, 0.475, 0.975, 0.975, 0.725, 0.475, 0.47500000000000003, 0.22500000000000003, 0.22500000000000003]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8598, 'compress@10': 0.7395, 'time@10': 8.5678}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8598, 'compress@10': 0.7395, 'time@10': 8.5678}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8525, 'compress@10': 0.7367, 'time@10': 7.7634}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it] {'epoch': 3, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8525, 'compress@10': 0.7367, 'time@10': 7.7634}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.854, 'compress@10': 0.6744, 'time@10': 6.3792}:  20%|██        | 2/10 [00:13<00:47,  5.90s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.854, 'compress@10': 0.6744, 'time@10': 6.3792}:  30%|███       | 3/10 [00:13<00:28,  4.05s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0385, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8483, 'compress@10': 0.7498, 'time@10': 6.3072}:  30%|███       | 3/10 [00:19<00:28,  4.05s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0385, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8483, 'compress@10': 0.7498, 'time@10': 6.3072}:  40%|████      | 4/10 [00:19<00:29,  4.87s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8378, 'compress@10': 0.7949, 'time@10': 8.0784}:  40%|████      | 4/10 [00:26<00:29,  4.87s/it] {'epoch': 3, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8378, 'compress@10': 0.7949, 'time@10': 8.0784}:  50%|█████     | 5/10 [00:26<00:29,  5.86s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0511, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8354, 'compress@10': 0.7843, 'time@10': 8.4155}:  50%|█████     | 5/10 [00:37<00:29,  5.86s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0511, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8354, 'compress@10': 0.7843, 'time@10': 8.4155}:  60%|██████    | 6/10 [00:37<00:29,  7.32s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0514, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.8421, 'compress@10': 0.7431, 'time@10': 8.9239}:  60%|██████    | 6/10 [00:43<00:29,  7.32s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0514, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.8421, 'compress@10': 0.7431, 'time@10': 8.9239}:  70%|███████   | 7/10 [00:43<00:20,  6.90s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0519, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.846, 'compress@10': 0.7115, 'time@10': 8.8173}:  70%|███████   | 7/10 [00:51<00:20,  6.90s/it]  {'epoch': 3, 'num_users': 6.125, 'loss': 0.0519, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.846, 'compress@10': 0.7115, 'time@10': 8.8173}:  80%|████████  | 8/10 [00:51<00:14,  7.28s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0516, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8517, 'compress@10': 0.6599, 'time@10': 9.3987}:  80%|████████  | 8/10 [00:58<00:14,  7.28s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0516, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8517, 'compress@10': 0.6599, 'time@10': 9.3987}:  90%|█████████ | 9/10 [00:58<00:07,  7.22s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8508, 'compress@10': 0.6182, 'time@10': 9.4844}:  90%|█████████ | 9/10 [01:08<00:07,  7.22s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8508, 'compress@10': 0.6182, 'time@10': 9.4844}: 100%|██████████| 10/10 [01:08<00:00,  8.18s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8508, 'compress@10': 0.6182, 'time@10': 9.4844}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.05105382645804969
Avg hit ratio: 0.8314886336074793
Avg ndcg: 0.85079667614563
Avg compression ratio: 0.6181548757535259
Avg train time: 9.48435926437378
Std train time: 3.39848278462203
[0.58, 0.58, 0.38, 0.98, 0.98, 0.78, 0.58, 0.5800000000000001, 0.18000000000000002, 0.18000000000000002]
[10, 10, 14, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0499, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.6021, 'time@10': 8.3681}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0499, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.6021, 'time@10': 8.3681}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8565, 'compress@10': 0.5978, 'time@10': 7.8718}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8565, 'compress@10': 0.5978, 'time@10': 7.8718}:  20%|██        | 2/10 [00:11<00:48,  6.11s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0327, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8567, 'compress@10': 0.5547, 'time@10': 6.786}:  20%|██        | 2/10 [00:13<00:48,  6.11s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0327, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8567, 'compress@10': 0.5547, 'time@10': 6.786}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0388, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8481, 'compress@10': 0.6612, 'time@10': 6.6454}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0388, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8481, 'compress@10': 0.6612, 'time@10': 6.6454}:  40%|████      | 4/10 [00:20<00:30,  5.13s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8379, 'compress@10': 0.7251, 'time@10': 8.3261}:  40%|████      | 4/10 [00:27<00:30,  5.13s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8379, 'compress@10': 0.7251, 'time@10': 8.3261}:  50%|█████     | 5/10 [00:27<00:30,  6.01s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0501, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.8361, 'compress@10': 0.735, 'time@10': 8.5676}:  50%|█████     | 5/10 [00:37<00:30,  6.01s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0501, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.8361, 'compress@10': 0.735, 'time@10': 8.5676}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0501, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8359, 'compress@10': 0.7153, 'time@10': 8.9451}:  60%|██████    | 6/10 [00:43<00:29,  7.30s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0501, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8359, 'compress@10': 0.7153, 'time@10': 8.9451}:  70%|███████   | 7/10 [00:43<00:20,  6.76s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8475, 'compress@10': 0.6999, 'time@10': 8.8362}:  70%|███████   | 7/10 [00:51<00:20,  6.76s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8475, 'compress@10': 0.6999, 'time@10': 8.8362}:  80%|████████  | 8/10 [00:51<00:14,  7.19s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8542, 'compress@10': 0.6447, 'time@10': 9.4974}:  80%|████████  | 8/10 [00:58<00:14,  7.19s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8542, 'compress@10': 0.6447, 'time@10': 9.4974}:  90%|█████████ | 9/10 [00:58<00:07,  7.26s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8544, 'compress@10': 0.6001, 'time@10': 9.5606}:  90%|█████████ | 9/10 [01:08<00:07,  7.26s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8544, 'compress@10': 0.6001, 'time@10': 9.5606}: 100%|██████████| 10/10 [01:08<00:00,  8.16s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8544, 'compress@10': 0.6001, 'time@10': 9.5606}: 100%|██████████| 10/10 [01:08<00:00,  6.90s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.048799136214893825
Avg hit ratio: 0.8540795194241714
Avg ndcg: 0.8544352819202372
Avg compression ratio: 0.6001024612724692
Avg train time: 9.56061680316925
Std train time: 3.2331779848008915
[0.4833333333333333, 0.4833333333333333, 0.31666666666666665, 0.9833333333333333, 0.9833333333333333, 0.8166666666666667, 0.6499999999999999, 0.65, 0.15000000000000002, 0.15000000000000002]
[10, 10, 15, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.5105, 'time@10': 8.3048}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.5105, 'time@10': 8.3048}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8541, 'compress@10': 0.5053, 'time@10': 7.6812}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it] {'epoch': 5, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8541, 'compress@10': 0.5053, 'time@10': 7.6812}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8551, 'compress@10': 0.4749, 'time@10': 6.5422}:  20%|██        | 2/10 [00:13<00:47,  5.90s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8551, 'compress@10': 0.4749, 'time@10': 6.5422}:  30%|███       | 3/10 [00:13<00:29,  4.20s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8505, 'compress@10': 0.6022, 'time@10': 6.4005}:  30%|███       | 3/10 [00:19<00:29,  4.20s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8505, 'compress@10': 0.6022, 'time@10': 6.4005}:  40%|████      | 4/10 [00:19<00:29,  4.91s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0446, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8401, 'compress@10': 0.6785, 'time@10': 8.2886}:  40%|████      | 4/10 [00:27<00:29,  4.91s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0446, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8401, 'compress@10': 0.6785, 'time@10': 8.2886}:  50%|█████     | 5/10 [00:27<00:30,  6.01s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0471, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8386, 'compress@10': 0.7022, 'time@10': 8.4987}:  50%|█████     | 5/10 [00:37<00:30,  6.01s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0471, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8386, 'compress@10': 0.7022, 'time@10': 8.4987}:  60%|██████    | 6/10 [00:37<00:28,  7.23s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0464, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.839, 'compress@10': 0.6967, 'time@10': 8.9144}:  60%|██████    | 6/10 [00:42<00:28,  7.23s/it] {'epoch': 5, 'num_users': 6.2857, 'loss': 0.0464, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.839, 'compress@10': 0.6967, 'time@10': 8.9144}:  70%|███████   | 7/10 [00:42<00:20,  6.74s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0469, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8461, 'compress@10': 0.6921, 'time@10': 8.8062}:  70%|███████   | 7/10 [00:50<00:20,  6.74s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0469, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8461, 'compress@10': 0.6921, 'time@10': 8.8062}:  80%|████████  | 8/10 [00:50<00:14,  7.17s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0513, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8609, 'compress@10': 0.6346, 'time@10': 9.3909}:  80%|████████  | 8/10 [00:57<00:14,  7.17s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0513, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8609, 'compress@10': 0.6346, 'time@10': 9.3909}:  90%|█████████ | 9/10 [00:57<00:07,  7.14s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8605, 'compress@10': 0.5881, 'time@10': 9.4772}:  90%|█████████ | 9/10 [01:08<00:07,  7.14s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8605, 'compress@10': 0.5881, 'time@10': 9.4772}: 100%|██████████| 10/10 [01:08<00:00,  8.12s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8605, 'compress@10': 0.5881, 'time@10': 9.4772}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.050103131403425503
Avg hit ratio: 0.8579172050360506
Avg ndcg: 0.8605419305065969
Avg compression ratio: 0.588070335230805
Avg train time: 9.477206230163574
Std train time: 3.3856162095445317
[0.41428571428571426, 0.41428571428571426, 0.2714285714285714, 0.9857142857142857, 0.9857142857142857, 0.8428571428571429, 0.557142857142857, 0.7000000000000001, 0.27142857142857146, 0.1285714285714286]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8756, 'compress@10': 0.4451, 'time@10': 8.5667}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8756, 'compress@10': 0.4451, 'time@10': 8.5667}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.872, 'compress@10': 0.4392, 'time@10': 7.8382}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it] {'epoch': 6, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.872, 'compress@10': 0.4392, 'time@10': 7.8382}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.867, 'compress@10': 0.4179, 'time@10': 6.7385}:  20%|██        | 2/10 [00:13<00:47,  5.99s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.867, 'compress@10': 0.4179, 'time@10': 6.7385}:  30%|███       | 3/10 [00:13<00:30,  4.31s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8638, 'compress@10': 0.56, 'time@10': 6.5718}:  30%|███       | 3/10 [00:19<00:30,  4.31s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8638, 'compress@10': 0.56, 'time@10': 6.5718}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0429, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8484, 'compress@10': 0.6452, 'time@10': 7.8196}:  40%|████      | 4/10 [00:26<00:30,  5.02s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0429, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8484, 'compress@10': 0.6452, 'time@10': 7.8196}:  50%|█████     | 5/10 [00:26<00:27,  5.53s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.045, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8466, 'compress@10': 0.6787, 'time@10': 8.0687}:  50%|█████     | 5/10 [00:35<00:27,  5.53s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.045, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8466, 'compress@10': 0.6787, 'time@10': 8.0687}:  60%|██████    | 6/10 [00:35<00:27,  6.83s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.044, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8496, 'compress@10': 0.6639, 'time@10': 8.5519}:  60%|██████    | 6/10 [00:41<00:27,  6.83s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.044, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8496, 'compress@10': 0.6639, 'time@10': 8.5519}:  70%|███████   | 7/10 [00:41<00:19,  6.50s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0442, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8536, 'compress@10': 0.6695, 'time@10': 8.5508}:  70%|███████   | 7/10 [00:50<00:19,  6.50s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0442, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8536, 'compress@10': 0.6695, 'time@10': 8.5508}:  80%|████████  | 8/10 [00:50<00:14,  7.16s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0464, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8707, 'compress@10': 0.6276, 'time@10': 9.1415}:  80%|████████  | 8/10 [00:57<00:14,  7.16s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0464, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8707, 'compress@10': 0.6276, 'time@10': 9.1415}:  90%|█████████ | 9/10 [00:57<00:07,  7.10s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0451, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8715, 'compress@10': 0.5796, 'time@10': 9.2324}:  90%|█████████ | 9/10 [01:07<00:07,  7.10s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0451, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8715, 'compress@10': 0.5796, 'time@10': 9.2324}: 100%|██████████| 10/10 [01:07<00:00,  8.02s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0451, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8715, 'compress@10': 0.5796, 'time@10': 9.2324}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04507885460336346
Avg hit ratio: 0.8524510690215275
Avg ndcg: 0.8714731312483771
Avg compression ratio: 0.5796396698668626
Avg train time: 9.232388615608215
Std train time: 2.780731179752942
[0.4875, 0.3625, 0.2375, 0.9874999999999999, 0.9874999999999999, 0.8625, 0.48749999999999993, 0.6125, 0.36250000000000004, 0.11250000000000002]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8423, 'compress@10': 0.5145, 'time@10': 8.3139}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8423, 'compress@10': 0.5145, 'time@10': 8.3139}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0437, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.852, 'compress@10': 0.4488, 'time@10': 7.7764}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it] {'epoch': 7, 'num_users': 7.0, 'loss': 0.0437, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.852, 'compress@10': 0.4488, 'time@10': 7.7764}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8537, 'compress@10': 0.4147, 'time@10': 6.7927}:  20%|██        | 2/10 [00:13<00:48,  6.01s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8537, 'compress@10': 0.4147, 'time@10': 6.7927}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0349, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8563, 'compress@10': 0.558, 'time@10': 6.6686}:  30%|███       | 3/10 [00:20<00:30,  4.38s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0349, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8563, 'compress@10': 0.558, 'time@10': 6.6686}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0427, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8439, 'compress@10': 0.6439, 'time@10': 7.9588}:  40%|████      | 4/10 [00:26<00:30,  5.15s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0427, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8439, 'compress@10': 0.6439, 'time@10': 7.9588}:  50%|█████     | 5/10 [00:26<00:28,  5.67s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0439, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8436, 'compress@10': 0.6809, 'time@10': 8.2209}:  50%|█████     | 5/10 [00:36<00:28,  5.67s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0439, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8436, 'compress@10': 0.6809, 'time@10': 8.2209}:  60%|██████    | 6/10 [00:36<00:27,  7.00s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0425, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8476, 'compress@10': 0.6562, 'time@10': 8.642}:  60%|██████    | 6/10 [00:42<00:27,  7.00s/it] {'epoch': 7, 'num_users': 6.2857, 'loss': 0.0425, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8476, 'compress@10': 0.6562, 'time@10': 8.642}:  70%|███████   | 7/10 [00:42<00:19,  6.55s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0426, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8523, 'compress@10': 0.6521, 'time@10': 8.5474}:  70%|███████   | 7/10 [00:49<00:19,  6.55s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0426, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8523, 'compress@10': 0.6521, 'time@10': 8.5474}:  80%|████████  | 8/10 [00:49<00:13,  6.99s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0445, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8523, 'compress@10': 0.6219, 'time@10': 9.1626}:  80%|████████  | 8/10 [00:57<00:13,  6.99s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0445, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8523, 'compress@10': 0.6219, 'time@10': 9.1626}:  90%|█████████ | 9/10 [00:57<00:07,  7.02s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0439, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8541, 'compress@10': 0.573, 'time@10': 9.2914}:  90%|█████████ | 9/10 [01:07<00:07,  7.02s/it]    {'epoch': 7, 'num_users': 6.3, 'loss': 0.0439, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8541, 'compress@10': 0.573, 'time@10': 9.2914}: 100%|██████████| 10/10 [01:07<00:00,  8.09s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0439, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8541, 'compress@10': 0.573, 'time@10': 9.2914}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04391074332975125
Avg hit ratio: 0.8634604718051238
Avg ndcg: 0.8541351490144683
Avg compression ratio: 0.5730133075325405
Avg train time: 9.29136836528778
Std train time: 2.8039366874378406
[0.5444444444444444, 0.3222222222222222, 0.2111111111111111, 0.9888888888888888, 0.9888888888888888, 0.8777777777777778, 0.4333333333333333, 0.5444444444444445, 0.43333333333333335, 0.10000000000000002]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.878, 'compress@10': 0.5684, 'time@10': 8.2947}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.878, 'compress@10': 0.5684, 'time@10': 8.2947}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8778, 'compress@10': 0.4563, 'time@10': 7.6946}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8778, 'compress@10': 0.4563, 'time@10': 7.6946}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8709, 'compress@10': 0.4121, 'time@10': 6.8646}:  20%|██        | 2/10 [00:13<00:47,  5.92s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8709, 'compress@10': 0.4121, 'time@10': 6.8646}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8718, 'compress@10': 0.5564, 'time@10': 6.6941}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8718, 'compress@10': 0.5564, 'time@10': 6.6941}:  40%|████      | 4/10 [00:20<00:30,  5.13s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0406, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8567, 'compress@10': 0.6429, 'time@10': 8.0778}:  40%|████      | 4/10 [00:27<00:30,  5.13s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0406, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8567, 'compress@10': 0.6429, 'time@10': 8.0778}:  50%|█████     | 5/10 [00:27<00:28,  5.76s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0415, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8556, 'compress@10': 0.6825, 'time@10': 8.3295}:  50%|█████     | 5/10 [00:36<00:28,  5.76s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0415, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8556, 'compress@10': 0.6825, 'time@10': 8.3295}:  60%|██████    | 6/10 [00:36<00:28,  7.08s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0403, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.8606, 'compress@10': 0.6502, 'time@10': 8.7297}:  60%|██████    | 6/10 [00:42<00:28,  7.08s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0403, 'hit_ratio@10': 0.8622, 'ndcg@10': 0.8606, 'compress@10': 0.6502, 'time@10': 8.7297}:  70%|███████   | 7/10 [00:42<00:19,  6.59s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0404, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8624, 'compress@10': 0.6386, 'time@10': 8.6172}:  70%|███████   | 7/10 [00:50<00:19,  6.59s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0404, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8624, 'compress@10': 0.6386, 'time@10': 8.6172}:  80%|████████  | 8/10 [00:50<00:13,  7.00s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0392, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8689, 'compress@10': 0.6176, 'time@10': 9.2303}:  80%|████████  | 8/10 [00:57<00:13,  7.00s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0392, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8689, 'compress@10': 0.6176, 'time@10': 9.2303}:  90%|█████████ | 9/10 [00:57<00:07,  7.03s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0383, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8701, 'compress@10': 0.5679, 'time@10': 9.3099}:  90%|█████████ | 9/10 [01:07<00:07,  7.03s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0383, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8701, 'compress@10': 0.5679, 'time@10': 9.3099}: 100%|██████████| 10/10 [01:07<00:00,  7.97s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0383, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8701, 'compress@10': 0.5679, 'time@10': 9.3099}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.0383049014827356
Avg hit ratio: 0.8733046276492795
Avg ndcg: 0.8701011098199298
Avg compression ratio: 0.5678612289195368
Avg train time: 9.309915161132812
Std train time: 2.8367333434169826
[0.59, 0.29, 0.19, 0.99, 0.99, 0.89, 0.38999999999999996, 0.5900000000000001, 0.39, 0.09000000000000002]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8486, 'compress@10': 0.6116, 'time@10': 8.4568}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8486, 'compress@10': 0.6116, 'time@10': 8.4568}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8659, 'compress@10': 0.4622, 'time@10': 7.8526}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8659, 'compress@10': 0.4622, 'time@10': 7.8526}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8629, 'compress@10': 0.4101, 'time@10': 6.949}:  20%|██        | 2/10 [00:14<00:48,  6.05s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8629, 'compress@10': 0.4101, 'time@10': 6.949}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0307, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8675, 'compress@10': 0.5551, 'time@10': 6.7141}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0307, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8675, 'compress@10': 0.5551, 'time@10': 6.7141}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0381, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8535, 'compress@10': 0.6421, 'time@10': 7.9495}:  40%|████      | 4/10 [00:26<00:30,  5.10s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0381, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8535, 'compress@10': 0.6421, 'time@10': 7.9495}:  50%|█████     | 5/10 [00:26<00:27,  5.60s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8547, 'compress@10': 0.6839, 'time@10': 8.2009}:  50%|█████     | 5/10 [00:36<00:27,  5.60s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8547, 'compress@10': 0.6839, 'time@10': 8.2009}:  60%|██████    | 6/10 [00:36<00:27,  6.92s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0378, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8552, 'compress@10': 0.6454, 'time@10': 8.6989}:  60%|██████    | 6/10 [00:42<00:27,  6.92s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0378, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8552, 'compress@10': 0.6454, 'time@10': 8.6989}:  70%|███████   | 7/10 [00:42<00:19,  6.58s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0376, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8604, 'compress@10': 0.6399, 'time@10': 8.6509}:  70%|███████   | 7/10 [00:50<00:19,  6.58s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0376, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8604, 'compress@10': 0.6399, 'time@10': 8.6509}:  80%|████████  | 8/10 [00:50<00:14,  7.15s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0383, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8713, 'compress@10': 0.6141, 'time@10': 9.2877}:  80%|████████  | 8/10 [00:57<00:14,  7.15s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0383, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8713, 'compress@10': 0.6141, 'time@10': 9.2877}:  90%|█████████ | 9/10 [00:57<00:07,  7.17s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0378, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.8747, 'compress@10': 0.5637, 'time@10': 9.3732}:  90%|█████████ | 9/10 [01:07<00:07,  7.17s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0378, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.8747, 'compress@10': 0.5637, 'time@10': 9.3732}: 100%|██████████| 10/10 [01:07<00:00,  8.10s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0378, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.8747, 'compress@10': 0.5637, 'time@10': 9.3732}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.037776893953846355
Avg hit ratio: 0.8828405128167438
Avg ndcg: 0.8746848114531967
Avg compression ratio: 0.5637371815930237
Avg train time: 9.373239874839783
Std train time: 2.81272906808067
[0.6272727272727272, 0.2636363636363636, 0.17272727272727273, 0.9909090909090909, 0.9909090909090909, 0.9, 0.3545454545454545, 0.5363636363636365, 0.44545454545454544, 0.08181818181818185]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8701, 'compress@10': 0.6469, 'time@10': 8.1433}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8701, 'compress@10': 0.6469, 'time@10': 8.1433}:  10%|█         | 1/10 [00:04<00:37,  4.11s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.872, 'compress@10': 0.4671, 'time@10': 7.685}:  10%|█         | 1/10 [00:11<00:37,  4.11s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.872, 'compress@10': 0.4671, 'time@10': 7.685}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.867, 'compress@10': 0.4084, 'time@10': 6.821}:  20%|██        | 2/10 [00:13<00:47,  5.97s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.867, 'compress@10': 0.4084, 'time@10': 6.821}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8725, 'compress@10': 0.5541, 'time@10': 6.6733}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8725, 'compress@10': 0.5541, 'time@10': 6.6733}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0356, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8584, 'compress@10': 0.6415, 'time@10': 7.9905}:  40%|████      | 4/10 [00:26<00:30,  5.15s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0356, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8584, 'compress@10': 0.6415, 'time@10': 7.9905}:  50%|█████     | 5/10 [00:26<00:28,  5.70s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0358, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8606, 'compress@10': 0.6849, 'time@10': 8.2394}:  50%|█████     | 5/10 [00:36<00:28,  5.70s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0358, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8606, 'compress@10': 0.6849, 'time@10': 8.2394}:  60%|██████    | 6/10 [00:36<00:28,  7.00s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0354, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8668, 'compress@10': 0.6414, 'time@10': 8.6989}:  60%|██████    | 6/10 [00:42<00:28,  7.00s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0354, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8668, 'compress@10': 0.6414, 'time@10': 8.6989}:  70%|███████   | 7/10 [00:42<00:19,  6.60s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.035, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8705, 'compress@10': 0.63, 'time@10': 8.5911}:  70%|███████   | 7/10 [00:50<00:19,  6.60s/it]    {'epoch': 10, 'num_users': 6.125, 'loss': 0.035, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8705, 'compress@10': 0.63, 'time@10': 8.5911}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.035, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8758, 'compress@10': 0.6112, 'time@10': 9.2335}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.035, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8758, 'compress@10': 0.6112, 'time@10': 9.2335}:  90%|█████████ | 9/10 [00:57<00:07,  7.08s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0346, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8774, 'compress@10': 0.5604, 'time@10': 9.3528}:  90%|█████████ | 9/10 [01:07<00:07,  7.08s/it]  {'epoch': 10, 'num_users': 6.3, 'loss': 0.0346, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8774, 'compress@10': 0.5604, 'time@10': 9.3528}: 100%|██████████| 10/10 [01:07<00:00,  8.15s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0346, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8774, 'compress@10': 0.5604, 'time@10': 9.3528}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03460484589739103
Avg hit ratio: 0.8713614363376673
Avg ndcg: 0.8774418884295747
Avg compression ratio: 0.5603652535273244
Avg train time: 9.352824330329895
Std train time: 2.867670177192909
[0.6583333333333332, 0.24166666666666664, 0.15833333333333333, 0.9916666666666666, 0.9916666666666666, 0.9083333333333333, 0.32499999999999996, 0.4916666666666668, 0.49166666666666664, 0.07500000000000002]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8584, 'compress@10': 0.6763, 'time@10': 8.2587}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8584, 'compress@10': 0.6763, 'time@10': 8.2587}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8713, 'compress@10': 0.4712, 'time@10': 7.6917}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8713, 'compress@10': 0.4712, 'time@10': 7.6917}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8666, 'compress@10': 0.407, 'time@10': 6.9425}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]  {'epoch': 11, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8666, 'compress@10': 0.407, 'time@10': 6.9425}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8706, 'compress@10': 0.5532, 'time@10': 6.684}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8706, 'compress@10': 0.5532, 'time@10': 6.684}:  40%|████      | 4/10 [00:20<00:30,  5.06s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0354, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8578, 'compress@10': 0.641, 'time@10': 7.9262}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0354, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8578, 'compress@10': 0.641, 'time@10': 7.9262}:  50%|█████     | 5/10 [00:26<00:27,  5.57s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0353, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.86, 'compress@10': 0.6859, 'time@10': 8.2363}:  50%|█████     | 5/10 [00:36<00:27,  5.57s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0353, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.86, 'compress@10': 0.6859, 'time@10': 8.2363}:  60%|██████    | 6/10 [00:36<00:28,  7.02s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.035, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8606, 'compress@10': 0.6382, 'time@10': 8.6723}:  60%|██████    | 6/10 [00:42<00:28,  7.02s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.035, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8606, 'compress@10': 0.6382, 'time@10': 8.6723}:  70%|███████   | 7/10 [00:42<00:19,  6.58s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0338, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.865, 'compress@10': 0.6217, 'time@10': 8.5869}:  70%|███████   | 7/10 [00:50<00:19,  6.58s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0338, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.865, 'compress@10': 0.6217, 'time@10': 8.5869}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0346, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.878, 'compress@10': 0.6088, 'time@10': 9.2061}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0346, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.878, 'compress@10': 0.6088, 'time@10': 9.2061}:  90%|█████████ | 9/10 [00:57<00:07,  7.07s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0333, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.8829, 'compress@10': 0.5576, 'time@10': 9.2871}:  90%|█████████ | 9/10 [01:07<00:07,  7.07s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.0333, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.8829, 'compress@10': 0.5576, 'time@10': 9.2871}: 100%|██████████| 10/10 [01:07<00:00,  7.99s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0333, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.8829, 'compress@10': 0.5576, 'time@10': 9.2871}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03329536818960319
Avg hit ratio: 0.8850627350389659
Avg ndcg: 0.8829126491209729
Avg compression ratio: 0.5575551397237859
Avg train time: 9.287052011489868
Std train time: 2.741279307720932
[0.6846153846153845, 0.22307692307692306, 0.14615384615384613, 0.9923076923076922, 0.9923076923076922, 0.9153846153846154, 0.29999999999999993, 0.45384615384615395, 0.5307692307692308, 0.06923076923076925]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8748, 'compress@10': 0.7012, 'time@10': 8.4531}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8748, 'compress@10': 0.7012, 'time@10': 8.4531}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8847, 'compress@10': 0.4747, 'time@10': 7.922}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]  {'epoch': 12, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8847, 'compress@10': 0.4747, 'time@10': 7.922}:  20%|██        | 2/10 [00:11<00:49,  6.13s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8755, 'compress@10': 0.4058, 'time@10': 7.1035}:  20%|██        | 2/10 [00:14<00:49,  6.13s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8755, 'compress@10': 0.4058, 'time@10': 7.1035}:  30%|███       | 3/10 [00:14<00:32,  4.60s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0273, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8784, 'compress@10': 0.5525, 'time@10': 6.7874}:  30%|███       | 3/10 [00:20<00:32,  4.60s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0273, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8784, 'compress@10': 0.5525, 'time@10': 6.7874}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0334, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8645, 'compress@10': 0.6405, 'time@10': 8.0028}:  40%|████      | 4/10 [00:26<00:30,  5.10s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0334, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8645, 'compress@10': 0.6405, 'time@10': 8.0028}:  50%|█████     | 5/10 [00:26<00:27,  5.59s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0346, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.865, 'compress@10': 0.6866, 'time@10': 8.227}:  50%|█████     | 5/10 [00:36<00:27,  5.59s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0346, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.865, 'compress@10': 0.6866, 'time@10': 8.227}:  60%|██████    | 6/10 [00:36<00:27,  6.89s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0334, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8712, 'compress@10': 0.6354, 'time@10': 8.6941}:  60%|██████    | 6/10 [00:42<00:27,  6.89s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0334, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8712, 'compress@10': 0.6354, 'time@10': 8.6941}:  70%|███████   | 7/10 [00:42<00:19,  6.53s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8767, 'compress@10': 0.6147, 'time@10': 8.6132}:  70%|███████   | 7/10 [00:50<00:19,  6.53s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8767, 'compress@10': 0.6147, 'time@10': 8.6132}:  80%|████████  | 8/10 [00:50<00:14,  7.02s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0313, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8803, 'compress@10': 0.6068, 'time@10': 9.253}:  80%|████████  | 8/10 [00:57<00:14,  7.02s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0313, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8803, 'compress@10': 0.6068, 'time@10': 9.253}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0314, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.8807, 'compress@10': 0.5552, 'time@10': 9.3432}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.0314, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.8807, 'compress@10': 0.5552, 'time@10': 9.3432}: 100%|██████████| 10/10 [01:07<00:00,  8.05s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0314, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.8807, 'compress@10': 0.5552, 'time@10': 9.3432}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03140944467646283
Avg hit ratio: 0.8705932279378799
Avg ndcg: 0.8806877009516241
Avg compression ratio: 0.5551770904098725
Avg train time: 9.343249988555907
Std train time: 2.7672364890996337
[0.7071428571428571, 0.20714285714285713, 0.1357142857142857, 0.9928571428571428, 0.9928571428571428, 0.9214285714285714, 0.2785714285714285, 0.42142857142857154, 0.4928571428571429, 0.13571428571428573]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.871, 'compress@10': 0.7225, 'time@10': 8.2848}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0355, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.871, 'compress@10': 0.7225, 'time@10': 8.2848}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0326, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8823, 'compress@10': 0.4776, 'time@10': 7.8101}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0326, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8823, 'compress@10': 0.4776, 'time@10': 7.8101}:  20%|██        | 2/10 [00:11<00:48,  6.06s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8739, 'compress@10': 0.4048, 'time@10': 6.9595}:  20%|██        | 2/10 [00:14<00:48,  6.06s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8739, 'compress@10': 0.4048, 'time@10': 6.9595}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8774, 'compress@10': 0.5519, 'time@10': 6.7148}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8774, 'compress@10': 0.5519, 'time@10': 6.7148}:  40%|████      | 4/10 [00:20<00:30,  5.11s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0309, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.866, 'compress@10': 0.6401, 'time@10': 8.0355}:  40%|████      | 4/10 [00:26<00:30,  5.11s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0309, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.866, 'compress@10': 0.6401, 'time@10': 8.0355}:  50%|█████     | 5/10 [00:26<00:28,  5.68s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0325, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8744, 'compress@10': 0.6873, 'time@10': 8.3144}:  50%|█████     | 5/10 [00:36<00:28,  5.68s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0325, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8744, 'compress@10': 0.6873, 'time@10': 8.3144}:  60%|██████    | 6/10 [00:36<00:28,  7.06s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0327, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8779, 'compress@10': 0.633, 'time@10': 8.7496}:  60%|██████    | 6/10 [00:42<00:28,  7.06s/it]  {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0327, 'hit_ratio@10': 0.885, 'ndcg@10': 0.8779, 'compress@10': 0.633, 'time@10': 8.7496}:  70%|███████   | 7/10 [00:42<00:19,  6.62s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0317, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.8815, 'compress@10': 0.6086, 'time@10': 8.6547}:  70%|███████   | 7/10 [00:50<00:19,  6.62s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0317, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.8815, 'compress@10': 0.6086, 'time@10': 8.6547}:  80%|████████  | 8/10 [00:50<00:14,  7.07s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0308, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.8865, 'compress@10': 0.5974, 'time@10': 9.248}:  80%|████████  | 8/10 [00:57<00:14,  7.07s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0308, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.8865, 'compress@10': 0.5974, 'time@10': 9.248}:  90%|█████████ | 9/10 [00:57<00:07,  7.06s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0289, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.8917, 'compress@10': 0.5532, 'time@10': 9.3698}:  90%|█████████ | 9/10 [01:07<00:07,  7.06s/it]  {'epoch': 13, 'num_users': 6.3, 'loss': 0.0289, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.8917, 'compress@10': 0.5532, 'time@10': 9.3698}: 100%|██████████| 10/10 [01:07<00:00,  8.12s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0289, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.8917, 'compress@10': 0.5532, 'time@10': 9.3698}: 100%|██████████| 10/10 [01:07<00:00,  6.80s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.02893748780092631
Avg hit ratio: 0.8886500366262675
Avg ndcg: 0.8916825485642871
Avg compression ratio: 0.5531797908265927
Avg train time: 9.369756579399109
Std train time: 2.7905014899802123
[0.7266666666666666, 0.19333333333333333, 0.12666666666666665, 0.9933333333333333, 0.9933333333333333, 0.9266666666666666, 0.3266666666666666, 0.3933333333333334, 0.46, 0.12666666666666668]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.741, 'time@10': 8.356}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.741, 'time@10': 8.356}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8823, 'compress@10': 0.4802, 'time@10': 7.8869}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8823, 'compress@10': 0.4802, 'time@10': 7.8869}:  20%|██        | 2/10 [00:11<00:48,  6.12s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8739, 'compress@10': 0.4039, 'time@10': 6.9973}:  20%|██        | 2/10 [00:14<00:48,  6.12s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8739, 'compress@10': 0.4039, 'time@10': 6.9973}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8774, 'compress@10': 0.5513, 'time@10': 6.7391}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8774, 'compress@10': 0.5513, 'time@10': 6.7391}:  40%|████      | 4/10 [00:20<00:30,  5.11s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0316, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8667, 'compress@10': 0.6398, 'time@10': 7.9062}:  40%|████      | 4/10 [00:26<00:30,  5.11s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0316, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8667, 'compress@10': 0.6398, 'time@10': 7.9062}:  50%|█████     | 5/10 [00:26<00:27,  5.55s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0306, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.8731, 'compress@10': 0.6879, 'time@10': 8.2475}:  50%|█████     | 5/10 [00:36<00:27,  5.55s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0306, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.8731, 'compress@10': 0.6879, 'time@10': 8.2475}:  60%|██████    | 6/10 [00:36<00:28,  7.06s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0308, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8727, 'compress@10': 0.6401, 'time@10': 8.7293}:  60%|██████    | 6/10 [00:42<00:28,  7.06s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0308, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8727, 'compress@10': 0.6401, 'time@10': 8.7293}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0292, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.8801, 'compress@10': 0.6114, 'time@10': 8.6496}:  70%|███████   | 7/10 [00:50<00:19,  6.66s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0292, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.8801, 'compress@10': 0.6114, 'time@10': 8.6496}:  80%|████████  | 8/10 [00:50<00:14,  7.13s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8872, 'compress@10': 0.5963, 'time@10': 9.2704}:  80%|████████  | 8/10 [00:57<00:14,  7.13s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8872, 'compress@10': 0.5963, 'time@10': 9.2704}:  90%|█████████ | 9/10 [00:57<00:07,  7.14s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.8866, 'compress@10': 0.5513, 'time@10': 9.3713}:  90%|█████████ | 9/10 [01:08<00:07,  7.14s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.8866, 'compress@10': 0.5513, 'time@10': 9.3713}: 100%|██████████| 10/10 [01:08<00:00,  8.12s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.8866, 'compress@10': 0.5513, 'time@10': 9.3713}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.029431845181479743
Avg hit ratio: 0.8923269708974292
Avg ndcg: 0.8866186266333175
Avg compression ratio: 0.5513320825828788
Avg train time: 9.371281671524049
Std train time: 2.7477136810394898
[0.7437499999999999, 0.18125, 0.11874999999999998, 0.9937499999999999, 0.9937499999999999, 0.86875, 0.3687499999999999, 0.3687500000000001, 0.43125, 0.18125000000000002]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8761, 'compress@10': 0.7572, 'time@10': 8.2748}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8761, 'compress@10': 0.7572, 'time@10': 8.2748}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8947, 'compress@10': 0.4825, 'time@10': 7.7563}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8947, 'compress@10': 0.4825, 'time@10': 7.7563}:  20%|██        | 2/10 [00:11<00:48,  6.00s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8822, 'compress@10': 0.4032, 'time@10': 6.9338}:  20%|██        | 2/10 [00:14<00:48,  6.00s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8822, 'compress@10': 0.4032, 'time@10': 6.9338}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8843, 'compress@10': 0.5509, 'time@10': 6.6853}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8843, 'compress@10': 0.5509, 'time@10': 6.6853}:  40%|████      | 4/10 [00:20<00:30,  5.08s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0291, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8738, 'compress@10': 0.6395, 'time@10': 7.8806}:  40%|████      | 4/10 [00:26<00:30,  5.08s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0291, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8738, 'compress@10': 0.6395, 'time@10': 7.8806}:  50%|█████     | 5/10 [00:26<00:27,  5.54s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0285, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8798, 'compress@10': 0.6782, 'time@10': 8.1794}:  50%|█████     | 5/10 [00:36<00:27,  5.54s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0285, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8798, 'compress@10': 0.6782, 'time@10': 8.1794}:  60%|██████    | 6/10 [00:36<00:27,  6.96s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0278, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.886, 'compress@10': 0.6376, 'time@10': 8.6454}:  60%|██████    | 6/10 [00:41<00:27,  6.96s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0278, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.886, 'compress@10': 0.6376, 'time@10': 8.6454}:  70%|███████   | 7/10 [00:41<00:19,  6.57s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0269, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.8904, 'compress@10': 0.6062, 'time@10': 8.5709}:  70%|███████   | 7/10 [00:50<00:19,  6.57s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0269, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.8904, 'compress@10': 0.6062, 'time@10': 8.5709}:  80%|████████  | 8/10 [00:50<00:14,  7.05s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8969, 'compress@10': 0.5886, 'time@10': 9.307}:  80%|████████  | 8/10 [00:57<00:14,  7.05s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8969, 'compress@10': 0.5886, 'time@10': 9.307}:  90%|█████████ | 9/10 [00:57<00:07,  7.23s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9008, 'compress@10': 0.5497, 'time@10': 9.4038}:  90%|█████████ | 9/10 [01:07<00:07,  7.23s/it]  {'epoch': 15, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9008, 'compress@10': 0.5497, 'time@10': 9.4038}: 100%|██████████| 10/10 [01:07<00:00,  8.18s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9008, 'compress@10': 0.5497, 'time@10': 9.4038}: 100%|██████████| 10/10 [01:07<00:00,  6.80s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.025735273320954443
Avg hit ratio: 0.8918758430778805
Avg ndcg: 0.9007779787055885
Avg compression ratio: 0.5497166575118817
Avg train time: 9.403807735443115
Std train time: 2.9305098408956076
[0.7588235294117647, 0.22941176470588234, 0.11176470588235292, 0.9941176470588234, 0.9941176470588234, 0.8176470588235294, 0.3470588235294117, 0.34705882352941186, 0.4647058823529412, 0.17058823529411768]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8761, 'compress@10': 0.7715, 'time@10': 8.1042}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8761, 'compress@10': 0.7715, 'time@10': 8.1042}:  10%|█         | 1/10 [00:04<00:36,  4.09s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8985, 'compress@10': 0.5129, 'time@10': 7.6597}:  10%|█         | 1/10 [00:11<00:36,  4.09s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8985, 'compress@10': 0.5129, 'time@10': 7.6597}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8847, 'compress@10': 0.4215, 'time@10': 6.9297}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8847, 'compress@10': 0.4215, 'time@10': 6.9297}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8884, 'compress@10': 0.5647, 'time@10': 6.6272}:  30%|███       | 3/10 [00:19<00:31,  4.50s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8884, 'compress@10': 0.5647, 'time@10': 6.6272}:  40%|████      | 4/10 [00:19<00:29,  5.00s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0285, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8788, 'compress@10': 0.6506, 'time@10': 7.8185}:  40%|████      | 4/10 [00:26<00:29,  5.00s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0285, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8788, 'compress@10': 0.6506, 'time@10': 7.8185}:  50%|█████     | 5/10 [00:26<00:27,  5.48s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0299, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8838, 'compress@10': 0.6791, 'time@10': 8.1372}:  50%|█████     | 5/10 [00:35<00:27,  5.48s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0299, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.8838, 'compress@10': 0.6791, 'time@10': 8.1372}:  60%|██████    | 6/10 [00:35<00:27,  6.94s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0305, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8839, 'compress@10': 0.6354, 'time@10': 8.5677}:  60%|██████    | 6/10 [00:41<00:27,  6.94s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0305, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8839, 'compress@10': 0.6354, 'time@10': 8.5677}:  70%|███████   | 7/10 [00:41<00:19,  6.50s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0293, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.8881, 'compress@10': 0.6017, 'time@10': 8.4917}:  70%|███████   | 7/10 [00:49<00:19,  6.50s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0293, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.8881, 'compress@10': 0.6017, 'time@10': 8.4917}:  80%|████████  | 8/10 [00:49<00:13,  6.98s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8955, 'compress@10': 0.5882, 'time@10': 9.1505}:  80%|████████  | 8/10 [00:56<00:13,  6.98s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8955, 'compress@10': 0.5882, 'time@10': 9.1505}:  90%|█████████ | 9/10 [00:56<00:07,  7.06s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.8998, 'compress@10': 0.5483, 'time@10': 9.2918}:  90%|█████████ | 9/10 [01:07<00:07,  7.06s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.8998, 'compress@10': 0.5483, 'time@10': 9.2918}: 100%|██████████| 10/10 [01:07<00:00,  8.16s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.8998, 'compress@10': 0.5483, 'time@10': 9.2918}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.02825362800598199
Avg hit ratio: 0.8945481151559249
Avg ndcg: 0.8998488948796514
Avg compression ratio: 0.5482994625816431
Avg train time: 9.291812586784364
Std train time: 2.7797291770093633
[0.7722222222222221, 0.21666666666666665, 0.10555555555555554, 0.9944444444444444, 0.9944444444444444, 0.8277777777777777, 0.3833333333333333, 0.3277777777777779, 0.4388888888888889, 0.16111111111111115]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.032, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.7842, 'time@10': 8.7744}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.032, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.7842, 'time@10': 8.7744}:  10%|█         | 1/10 [00:04<00:39,  4.42s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9067, 'compress@10': 0.5131, 'time@10': 8.0538}:  10%|█         | 1/10 [00:11<00:39,  4.42s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9067, 'compress@10': 0.5131, 'time@10': 8.0538}:  20%|██        | 2/10 [00:11<00:49,  6.16s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8902, 'compress@10': 0.4198, 'time@10': 7.1471}:  20%|██        | 2/10 [00:14<00:49,  6.16s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8902, 'compress@10': 0.4198, 'time@10': 7.1471}:  30%|███       | 3/10 [00:14<00:32,  4.59s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8954, 'compress@10': 0.5635, 'time@10': 6.8}:  30%|███       | 3/10 [00:20<00:32,  4.59s/it]    {'epoch': 17, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8954, 'compress@10': 0.5635, 'time@10': 6.8}:  40%|████      | 4/10 [00:20<00:30,  5.06s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8867, 'compress@10': 0.6497, 'time@10': 7.9674}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8867, 'compress@10': 0.6497, 'time@10': 7.9674}:  50%|█████     | 5/10 [00:26<00:27,  5.53s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0255, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8918, 'compress@10': 0.68, 'time@10': 8.2464}:  50%|█████     | 5/10 [00:36<00:27,  5.53s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0255, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8918, 'compress@10': 0.68, 'time@10': 8.2464}:  60%|██████    | 6/10 [00:36<00:27,  6.94s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.025, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.8923, 'compress@10': 0.6412, 'time@10': 8.7793}:  60%|██████    | 6/10 [00:42<00:27,  6.94s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.025, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.8923, 'compress@10': 0.6412, 'time@10': 8.7793}:  70%|███████   | 7/10 [00:42<00:19,  6.64s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0245, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.8953, 'compress@10': 0.6044, 'time@10': 8.6824}:  70%|███████   | 7/10 [00:50<00:19,  6.64s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0245, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.8953, 'compress@10': 0.6044, 'time@10': 8.6824}:  80%|████████  | 8/10 [00:50<00:14,  7.09s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0251, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9054, 'compress@10': 0.5878, 'time@10': 9.3155}:  80%|████████  | 8/10 [00:57<00:14,  7.09s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0251, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9054, 'compress@10': 0.5878, 'time@10': 9.3155}:  90%|█████████ | 9/10 [00:57<00:07,  7.13s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9061, 'compress@10': 0.547, 'time@10': 9.4132}:  90%|█████████ | 9/10 [01:07<00:07,  7.13s/it]    {'epoch': 17, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9061, 'compress@10': 0.547, 'time@10': 9.4132}: 100%|██████████| 10/10 [01:07<00:00,  8.12s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9061, 'compress@10': 0.547, 'time@10': 9.4132}: 100%|██████████| 10/10 [01:07<00:00,  6.80s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02514026331991408
Avg hit ratio: 0.8926873880693915
Avg ndcg: 0.9061034534834713
Avg compression ratio: 0.547030638601609
Avg train time: 9.413162922859192
Std train time: 2.813883015381825
[0.7842105263157894, 0.20526315789473681, 0.09999999999999999, 0.994736842105263, 0.994736842105263, 0.8368421052631578, 0.36315789473684207, 0.31052631578947376, 0.46842105263157896, 0.15263157894736845]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.7956, 'time@10': 8.0592}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.7956, 'time@10': 8.0592}:  10%|█         | 1/10 [00:04<00:36,  4.07s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0275, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.908, 'compress@10': 0.5132, 'time@10': 7.6241}:  10%|█         | 1/10 [00:11<00:36,  4.07s/it] {'epoch': 18, 'num_users': 7.0, 'loss': 0.0275, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.908, 'compress@10': 0.5132, 'time@10': 7.6241}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.891, 'compress@10': 0.4183, 'time@10': 6.9828}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.891, 'compress@10': 0.4183, 'time@10': 6.9828}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8972, 'compress@10': 0.5625, 'time@10': 6.7039}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8972, 'compress@10': 0.5625, 'time@10': 6.7039}:  40%|████      | 4/10 [00:20<00:30,  5.08s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8884, 'compress@10': 0.649, 'time@10': 7.8384}:  40%|████      | 4/10 [00:26<00:30,  5.08s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8884, 'compress@10': 0.649, 'time@10': 7.8384}:  50%|█████     | 5/10 [00:26<00:27,  5.49s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0233, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.8961, 'compress@10': 0.6809, 'time@10': 8.1355}:  50%|█████     | 5/10 [00:35<00:27,  5.49s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0233, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.8961, 'compress@10': 0.6809, 'time@10': 8.1355}:  60%|██████    | 6/10 [00:35<00:27,  6.91s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0233, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9004, 'compress@10': 0.6391, 'time@10': 8.6224}:  60%|██████    | 6/10 [00:41<00:27,  6.91s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0233, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9004, 'compress@10': 0.6391, 'time@10': 8.6224}:  70%|███████   | 7/10 [00:41<00:19,  6.55s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0224, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9049, 'compress@10': 0.6005, 'time@10': 8.5424}:  70%|███████   | 7/10 [00:49<00:19,  6.55s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0224, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9049, 'compress@10': 0.6005, 'time@10': 8.5424}:  80%|████████  | 8/10 [00:49<00:14,  7.02s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0243, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9229, 'compress@10': 0.5875, 'time@10': 9.2761}:  80%|████████  | 8/10 [00:57<00:14,  7.02s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0243, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9229, 'compress@10': 0.5875, 'time@10': 9.2761}:  90%|█████████ | 9/10 [00:57<00:07,  7.20s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9278, 'compress@10': 0.546, 'time@10': 9.3847}:  90%|█████████ | 9/10 [01:07<00:07,  7.20s/it]    {'epoch': 18, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9278, 'compress@10': 0.546, 'time@10': 9.3847}: 100%|██████████| 10/10 [01:07<00:00,  8.19s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9278, 'compress@10': 0.546, 'time@10': 9.3847}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.022465731581947153
Avg hit ratio: 0.9070755089091251
Avg ndcg: 0.9278127743323233
Avg compression ratio: 0.5459586062819446
Avg train time: 9.384674048423767
Std train time: 2.8689113596768228
[0.7949999999999999, 0.19499999999999998, 0.09499999999999999, 0.9949999999999999, 0.9949999999999999, 0.7949999999999999, 0.39499999999999996, 0.2950000000000001, 0.495, 0.14500000000000002]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0308, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.8058, 'time@10': 8.0809}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0308, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.8058, 'time@10': 8.0809}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9121, 'compress@10': 0.5134, 'time@10': 7.71}:  10%|█         | 1/10 [00:11<00:36,  4.08s/it]  {'epoch': 19, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9121, 'compress@10': 0.5134, 'time@10': 7.71}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8938, 'compress@10': 0.417, 'time@10': 6.9083}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8938, 'compress@10': 0.417, 'time@10': 6.9083}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9018, 'compress@10': 0.5616, 'time@10': 6.6265}:  30%|███       | 3/10 [00:19<00:31,  4.50s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9018, 'compress@10': 0.5616, 'time@10': 6.6265}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0233, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8926, 'compress@10': 0.6483, 'time@10': 7.7764}:  40%|████      | 4/10 [00:26<00:30,  5.02s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0233, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8926, 'compress@10': 0.6483, 'time@10': 7.7764}:  50%|█████     | 5/10 [00:26<00:27,  5.45s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0243, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9005, 'compress@10': 0.6735, 'time@10': 8.1619}:  50%|█████     | 5/10 [00:36<00:27,  5.45s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0243, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9005, 'compress@10': 0.6735, 'time@10': 8.1619}:  60%|██████    | 6/10 [00:36<00:28,  7.04s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0252, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.8957, 'compress@10': 0.6371, 'time@10': 8.5928}:  60%|██████    | 6/10 [00:41<00:28,  7.04s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0252, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.8957, 'compress@10': 0.6371, 'time@10': 8.5928}:  70%|███████   | 7/10 [00:41<00:19,  6.58s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9016, 'compress@10': 0.5969, 'time@10': 8.5429}:  70%|███████   | 7/10 [00:50<00:19,  6.58s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9016, 'compress@10': 0.5969, 'time@10': 8.5429}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0251, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9074, 'compress@10': 0.5872, 'time@10': 9.1998}:  80%|████████  | 8/10 [00:57<00:14,  7.11s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0251, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9074, 'compress@10': 0.5872, 'time@10': 9.1998}:  90%|█████████ | 9/10 [00:57<00:07,  7.16s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0261, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9093, 'compress@10': 0.5449, 'time@10': 9.305}:  90%|█████████ | 9/10 [01:07<00:07,  7.16s/it]    {'epoch': 19, 'num_users': 6.3, 'loss': 0.0261, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9093, 'compress@10': 0.5449, 'time@10': 9.305}: 100%|██████████| 10/10 [01:07<00:00,  8.12s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0261, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9093, 'compress@10': 0.5449, 'time@10': 9.305}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.026125431342301397
Avg hit ratio: 0.9042183660519824
Avg ndcg: 0.9092537476083977
Avg compression ratio: 0.5449039964135189
Avg train time: 9.305014371871948
Std train time: 2.756579719793169
[0.8047619047619047, 0.1857142857142857, 0.09047619047619046, 0.9476190476190475, 0.9952380952380951, 0.7571428571428571, 0.42380952380952375, 0.28095238095238106, 0.5190476190476191, 0.18571428571428572]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8887, 'compress@10': 0.815, 'time@10': 8.2887}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8887, 'compress@10': 0.815, 'time@10': 8.2887}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9217, 'compress@10': 0.5135, 'time@10': 7.7416}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9217, 'compress@10': 0.5135, 'time@10': 7.7416}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9002, 'compress@10': 0.4158, 'time@10': 6.9288}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9002, 'compress@10': 0.4158, 'time@10': 6.9288}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.907, 'compress@10': 0.5492, 'time@10': 6.6509}:  30%|███       | 3/10 [00:19<00:31,  4.48s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.907, 'compress@10': 0.5492, 'time@10': 6.6509}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0213, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8976, 'compress@10': 0.6384, 'time@10': 7.8243}:  40%|████      | 4/10 [00:26<00:30,  5.02s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0213, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8976, 'compress@10': 0.6384, 'time@10': 7.8243}:  50%|█████     | 5/10 [00:26<00:27,  5.49s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0218, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9041, 'compress@10': 0.6591, 'time@10': 8.15}:  50%|█████     | 5/10 [00:36<00:27,  5.49s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0218, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9041, 'compress@10': 0.6591, 'time@10': 8.15}:  60%|██████    | 6/10 [00:36<00:27,  6.96s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0208, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.908, 'compress@10': 0.6288, 'time@10': 8.6099}:  60%|██████    | 6/10 [00:41<00:27,  6.96s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0208, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.908, 'compress@10': 0.6288, 'time@10': 8.6099}:  70%|███████   | 7/10 [00:41<00:19,  6.56s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0208, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9068, 'compress@10': 0.5879, 'time@10': 8.5796}:  70%|███████   | 7/10 [00:50<00:19,  6.56s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0208, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9068, 'compress@10': 0.5879, 'time@10': 8.5796}:  80%|████████  | 8/10 [00:50<00:14,  7.14s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9113, 'compress@10': 0.5818, 'time@10': 9.2234}:  80%|████████  | 8/10 [00:57<00:14,  7.14s/it] {'epoch': 20, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9113, 'compress@10': 0.5818, 'time@10': 9.2234}:  90%|█████████ | 9/10 [00:57<00:07,  7.17s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9163, 'compress@10': 0.544, 'time@10': 9.3239}:  90%|█████████ | 9/10 [01:07<00:07,  7.17s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9163, 'compress@10': 0.544, 'time@10': 9.3239}: 100%|██████████| 10/10 [01:07<00:00,  8.13s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9163, 'compress@10': 0.544, 'time@10': 9.3239}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.019523994301006046
Avg hit ratio: 0.8917068453146552
Avg ndcg: 0.9162955795332103
Avg compression ratio: 0.5440114496813021
Avg train time: 9.323934173583984
Std train time: 2.7549364429611907
[0.8136363636363636, 0.17727272727272725, 0.08636363636363635, 0.9499999999999998, 0.9954545454545454, 0.7681818181818182, 0.4045454545454545, 0.3136363636363637, 0.4954545454545455, 0.17727272727272728]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8902, 'compress@10': 0.8234, 'time@10': 8.2025}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8902, 'compress@10': 0.8234, 'time@10': 8.2025}:  10%|█         | 1/10 [00:04<00:37,  4.14s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9198, 'compress@10': 0.5136, 'time@10': 7.6089}:  10%|█         | 1/10 [00:11<00:37,  4.14s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9198, 'compress@10': 0.5136, 'time@10': 7.6089}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8989, 'compress@10': 0.4147, 'time@10': 6.8317}:  20%|██        | 2/10 [00:13<00:46,  5.85s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8989, 'compress@10': 0.4147, 'time@10': 6.8317}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9078, 'compress@10': 0.549, 'time@10': 6.6035}:  30%|███       | 3/10 [00:19<00:30,  4.40s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9078, 'compress@10': 0.549, 'time@10': 6.6035}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9003, 'compress@10': 0.6383, 'time@10': 7.8136}:  40%|████      | 4/10 [00:26<00:30,  5.02s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9003, 'compress@10': 0.6383, 'time@10': 7.8136}:  50%|█████     | 5/10 [00:26<00:27,  5.50s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0195, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9079, 'compress@10': 0.6608, 'time@10': 8.1081}:  50%|█████     | 5/10 [00:35<00:27,  5.50s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0195, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9079, 'compress@10': 0.6608, 'time@10': 8.1081}:  60%|██████    | 6/10 [00:35<00:27,  6.90s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0206, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9074, 'compress@10': 0.6276, 'time@10': 8.561}:  60%|██████    | 6/10 [00:41<00:27,  6.90s/it] {'epoch': 21, 'num_users': 6.2857, 'loss': 0.0206, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9074, 'compress@10': 0.6276, 'time@10': 8.561}:  70%|███████   | 7/10 [00:41<00:19,  6.50s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0196, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9122, 'compress@10': 0.5908, 'time@10': 8.4987}:  70%|███████   | 7/10 [00:49<00:19,  6.50s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0196, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9122, 'compress@10': 0.5908, 'time@10': 8.4987}:  80%|████████  | 8/10 [00:49<00:14,  7.02s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9165, 'compress@10': 0.5818, 'time@10': 9.1737}:  80%|████████  | 8/10 [00:56<00:14,  7.02s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9165, 'compress@10': 0.5818, 'time@10': 9.1737}:  90%|█████████ | 9/10 [00:56<00:07,  7.11s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9219, 'compress@10': 0.5432, 'time@10': 9.3118}:  90%|█████████ | 9/10 [01:07<00:07,  7.11s/it]  {'epoch': 21, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9219, 'compress@10': 0.5432, 'time@10': 9.3118}: 100%|██████████| 10/10 [01:07<00:00,  8.19s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9219, 'compress@10': 0.5432, 'time@10': 9.3118}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.01837620861150532
Avg hit ratio: 0.9070755089091251
Avg ndcg: 0.9219215278937993
Avg compression ratio: 0.5432229434310376
Avg train time: 9.311846923828124
Std train time: 2.831971738039959
[0.8217391304347825, 0.1695652173913043, 0.0826086956521739, 0.9521739130434781, 0.9956521739130434, 0.7782608695652175, 0.4304347826086956, 0.3000000000000001, 0.4739130434782609, 0.16956521739130434]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8918, 'compress@10': 0.8311, 'time@10': 8.3998}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8918, 'compress@10': 0.8311, 'time@10': 8.3998}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9211, 'compress@10': 0.5137, 'time@10': 7.7498}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9211, 'compress@10': 0.5137, 'time@10': 7.7498}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8998, 'compress@10': 0.4137, 'time@10': 6.9925}:  20%|██        | 2/10 [00:14<00:47,  5.94s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8998, 'compress@10': 0.4137, 'time@10': 6.9925}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9097, 'compress@10': 0.5488, 'time@10': 6.6986}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9097, 'compress@10': 0.5488, 'time@10': 6.6986}:  40%|████      | 4/10 [00:20<00:30,  5.03s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.9048, 'compress@10': 0.6381, 'time@10': 7.829}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it]  {'epoch': 22, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.9048, 'compress@10': 0.6381, 'time@10': 7.829}:  50%|█████     | 5/10 [00:26<00:27,  5.46s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0196, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9122, 'compress@10': 0.6623, 'time@10': 8.1708}:  50%|█████     | 5/10 [00:36<00:27,  5.46s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0196, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9122, 'compress@10': 0.6623, 'time@10': 8.1708}:  60%|██████    | 6/10 [00:36<00:27,  6.98s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0196, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9123, 'compress@10': 0.6324, 'time@10': 8.6299}:  60%|██████    | 6/10 [00:41<00:27,  6.98s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0196, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9123, 'compress@10': 0.6324, 'time@10': 8.6299}:  70%|███████   | 7/10 [00:41<00:19,  6.57s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0194, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9143, 'compress@10': 0.5934, 'time@10': 8.5643}:  70%|███████   | 7/10 [00:50<00:19,  6.57s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0194, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9143, 'compress@10': 0.5934, 'time@10': 8.5643}:  80%|████████  | 8/10 [00:50<00:14,  7.07s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9216, 'compress@10': 0.5818, 'time@10': 9.2323}:  80%|████████  | 8/10 [00:57<00:14,  7.07s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9216, 'compress@10': 0.5818, 'time@10': 9.2323}:  90%|█████████ | 9/10 [00:57<00:07,  7.15s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9258, 'compress@10': 0.5425, 'time@10': 9.3146}:  90%|█████████ | 9/10 [01:07<00:07,  7.15s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9258, 'compress@10': 0.5425, 'time@10': 9.3146}: 100%|██████████| 10/10 [01:07<00:00,  8.06s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9258, 'compress@10': 0.5425, 'time@10': 9.3146}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.020314402192066684
Avg hit ratio: 0.8895639881717979
Avg ndcg: 0.9257528284664616
Avg compression ratio: 0.542451785983604
Avg train time: 9.31462652683258
Std train time: 2.7607294876635278
[0.8291666666666666, 0.16249999999999998, 0.07916666666666665, 0.9541666666666665, 0.9958333333333332, 0.7875000000000001, 0.4125, 0.2875000000000001, 0.49583333333333335, 0.1625]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8966, 'compress@10': 0.8381, 'time@10': 8.2597}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8966, 'compress@10': 0.8381, 'time@10': 8.2597}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9326, 'compress@10': 0.5138, 'time@10': 7.7664}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9326, 'compress@10': 0.5138, 'time@10': 7.7664}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9074, 'compress@10': 0.4128, 'time@10': 6.9767}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9074, 'compress@10': 0.4128, 'time@10': 6.9767}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9151, 'compress@10': 0.5485, 'time@10': 6.6958}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9151, 'compress@10': 0.5485, 'time@10': 6.6958}:  40%|████      | 4/10 [00:20<00:30,  5.06s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9099, 'compress@10': 0.638, 'time@10': 7.8781}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it] {'epoch': 23, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9099, 'compress@10': 0.638, 'time@10': 7.8781}:  50%|█████     | 5/10 [00:26<00:27,  5.52s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.917, 'compress@10': 0.6637, 'time@10': 8.1603}:  50%|█████     | 5/10 [00:36<00:27,  5.52s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.917, 'compress@10': 0.6637, 'time@10': 8.1603}:  60%|██████    | 6/10 [00:36<00:27,  6.91s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0182, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9203, 'compress@10': 0.6312, 'time@10': 8.5854}:  60%|██████    | 6/10 [00:41<00:27,  6.91s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0182, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9203, 'compress@10': 0.6312, 'time@10': 8.5854}:  70%|███████   | 7/10 [00:41<00:19,  6.50s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9232, 'compress@10': 0.5908, 'time@10': 8.5592}:  70%|███████   | 7/10 [00:50<00:19,  6.50s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9232, 'compress@10': 0.5908, 'time@10': 8.5592}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0224, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9417, 'compress@10': 0.5818, 'time@10': 9.222}:  80%|████████  | 8/10 [00:57<00:14,  7.11s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0224, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9417, 'compress@10': 0.5818, 'time@10': 9.222}:  90%|█████████ | 9/10 [00:57<00:07,  7.17s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9429, 'compress@10': 0.5418, 'time@10': 9.3323}:  90%|█████████ | 9/10 [01:07<00:07,  7.17s/it]  {'epoch': 23, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9429, 'compress@10': 0.5418, 'time@10': 9.3323}: 100%|██████████| 10/10 [01:07<00:00,  8.15s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9429, 'compress@10': 0.5418, 'time@10': 9.3323}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.022425142784184976
Avg hit ratio: 0.9013612231948394
Avg ndcg: 0.9428833750079125
Avg compression ratio: 0.5417930245204654
Avg train time: 9.332302927970886
Std train time: 2.75453875135214
[0.836, 0.15599999999999997, 0.07599999999999998, 0.9159999999999998, 0.9959999999999999, 0.796, 0.39599999999999996, 0.2760000000000001, 0.516, 0.196]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0237, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9093, 'compress@10': 0.8446, 'time@10': 8.2334}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0237, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9093, 'compress@10': 0.8446, 'time@10': 8.2334}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.936, 'compress@10': 0.5139, 'time@10': 7.6128}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it] {'epoch': 24, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.936, 'compress@10': 0.5139, 'time@10': 7.6128}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9097, 'compress@10': 0.412, 'time@10': 6.8021}:  20%|██        | 2/10 [00:13<00:46,  5.85s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9097, 'compress@10': 0.412, 'time@10': 6.8021}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9168, 'compress@10': 0.5387, 'time@10': 6.6131}:  30%|███       | 3/10 [00:19<00:30,  4.38s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9168, 'compress@10': 0.5387, 'time@10': 6.6131}:  40%|████      | 4/10 [00:19<00:30,  5.05s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.912, 'compress@10': 0.6302, 'time@10': 7.8778}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it] {'epoch': 24, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.912, 'compress@10': 0.6302, 'time@10': 7.8778}:  50%|█████     | 5/10 [00:26<00:27,  5.57s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9197, 'compress@10': 0.6586, 'time@10': 8.1707}:  50%|█████     | 5/10 [00:36<00:27,  5.57s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9197, 'compress@10': 0.6586, 'time@10': 8.1707}:  60%|██████    | 6/10 [00:36<00:27,  6.97s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0167, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9168, 'compress@10': 0.6245, 'time@10': 8.5936}:  60%|██████    | 6/10 [00:41<00:27,  6.97s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0167, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9168, 'compress@10': 0.6245, 'time@10': 8.5936}:  70%|███████   | 7/10 [00:41<00:19,  6.52s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0162, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9218, 'compress@10': 0.5835, 'time@10': 8.5295}:  70%|███████   | 7/10 [00:49<00:19,  6.52s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0162, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9218, 'compress@10': 0.5835, 'time@10': 8.5295}:  80%|████████  | 8/10 [00:49<00:14,  7.03s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0204, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9226, 'compress@10': 0.5776, 'time@10': 9.1842}:  80%|████████  | 8/10 [00:57<00:14,  7.03s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0204, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9226, 'compress@10': 0.5776, 'time@10': 9.1842}:  90%|█████████ | 9/10 [00:57<00:07,  7.10s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9274, 'compress@10': 0.5412, 'time@10': 9.2919}:  90%|█████████ | 9/10 [01:07<00:07,  7.10s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9274, 'compress@10': 0.5412, 'time@10': 9.2919}: 100%|██████████| 10/10 [01:07<00:00,  8.09s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9274, 'compress@10': 0.5412, 'time@10': 9.2919}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.01910905107970056
Avg hit ratio: 0.9013612231948394
Avg ndcg: 0.9274347547363284
Avg compression ratio: 0.5412373390654835
Avg train time: 9.291947889328004
Std train time: 2.81697800582865
[0.8423076923076923, 0.14999999999999997, 0.07307692307692307, 0.9192307692307691, 0.9961538461538461, 0.7653846153846154, 0.4192307692307692, 0.26538461538461544, 0.5346153846153846, 0.18846153846153846]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9152, 'compress@10': 0.8506, 'time@10': 8.0867}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9152, 'compress@10': 0.8506, 'time@10': 8.0867}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9399, 'compress@10': 0.514, 'time@10': 7.5767}:  10%|█         | 1/10 [00:11<00:36,  4.08s/it] {'epoch': 25, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9399, 'compress@10': 0.514, 'time@10': 7.5767}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9123, 'compress@10': 0.4112, 'time@10': 6.8558}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9123, 'compress@10': 0.4112, 'time@10': 6.8558}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9221, 'compress@10': 0.5389, 'time@10': 6.629}:  30%|███       | 3/10 [00:19<00:31,  4.44s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9221, 'compress@10': 0.5389, 'time@10': 6.629}:  40%|████      | 4/10 [00:19<00:30,  5.05s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.918, 'compress@10': 0.6304, 'time@10': 7.8464}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.918, 'compress@10': 0.6304, 'time@10': 7.8464}:  50%|█████     | 5/10 [00:26<00:27,  5.53s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9265, 'compress@10': 0.6537, 'time@10': 8.2056}:  50%|█████     | 5/10 [00:36<00:27,  5.53s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9265, 'compress@10': 0.6537, 'time@10': 8.2056}:  60%|██████    | 6/10 [00:36<00:28,  7.07s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0167, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9291, 'compress@10': 0.6236, 'time@10': 8.6506}:  60%|██████    | 6/10 [00:42<00:28,  7.07s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0167, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9291, 'compress@10': 0.6236, 'time@10': 8.6506}:  70%|███████   | 7/10 [00:42<00:19,  6.62s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9296, 'compress@10': 0.5814, 'time@10': 8.5776}:  70%|███████   | 7/10 [00:50<00:19,  6.62s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9296, 'compress@10': 0.5814, 'time@10': 8.5776}:  80%|████████  | 8/10 [00:50<00:14,  7.09s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9461, 'compress@10': 0.5777, 'time@10': 9.2334}:  80%|████████  | 8/10 [00:57<00:14,  7.09s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9461, 'compress@10': 0.5777, 'time@10': 9.2334}:  90%|█████████ | 9/10 [00:57<00:07,  7.15s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9496, 'compress@10': 0.5406, 'time@10': 9.34}:  90%|█████████ | 9/10 [01:07<00:07,  7.15s/it]    {'epoch': 25, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9496, 'compress@10': 0.5406, 'time@10': 9.34}: 100%|██████████| 10/10 [01:07<00:00,  8.13s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9496, 'compress@10': 0.5406, 'time@10': 9.34}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.01893493550369818
Avg hit ratio: 0.9035414317808206
Avg ndcg: 0.9495908019360535
Avg compression ratio: 0.540608951721486
Avg train time: 9.339975142478943
Std train time: 2.7994587150614394
[0.8481481481481482, 0.1444444444444444, 0.07037037037037036, 0.922222222222222, 0.9962962962962962, 0.7740740740740741, 0.4037037037037037, 0.2555555555555556, 0.5518518518518518, 0.18148148148148147]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9152, 'compress@10': 0.8561, 'time@10': 8.2688}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9152, 'compress@10': 0.8561, 'time@10': 8.2688}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9365, 'compress@10': 0.5141, 'time@10': 7.7749}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9365, 'compress@10': 0.5141, 'time@10': 7.7749}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9101, 'compress@10': 0.4105, 'time@10': 6.9414}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9101, 'compress@10': 0.4105, 'time@10': 6.9414}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9191, 'compress@10': 0.5391, 'time@10': 6.7126}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9191, 'compress@10': 0.5391, 'time@10': 6.7126}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0179, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9161, 'compress@10': 0.6305, 'time@10': 7.883}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it] {'epoch': 26, 'num_users': 5.8, 'loss': 0.0179, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9161, 'compress@10': 0.6305, 'time@10': 7.883}:  50%|█████     | 5/10 [00:26<00:27,  5.55s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9229, 'compress@10': 0.6553, 'time@10': 8.1842}:  50%|█████     | 5/10 [00:36<00:27,  5.55s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9229, 'compress@10': 0.6553, 'time@10': 8.1842}:  60%|██████    | 6/10 [00:36<00:27,  6.97s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9266, 'compress@10': 0.6228, 'time@10': 8.5995}:  60%|██████    | 6/10 [00:41<00:27,  6.97s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9266, 'compress@10': 0.6228, 'time@10': 8.5995}:  70%|███████   | 7/10 [00:41<00:19,  6.52s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.9155, 'ndcg@10': 0.9306, 'compress@10': 0.5795, 'time@10': 8.5421}:  70%|███████   | 7/10 [00:50<00:19,  6.52s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.9155, 'ndcg@10': 0.9306, 'compress@10': 0.5795, 'time@10': 8.5421}:  80%|████████  | 8/10 [00:50<00:14,  7.05s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9318, 'compress@10': 0.5779, 'time@10': 9.2235}:  80%|████████  | 8/10 [00:57<00:14,  7.05s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9318, 'compress@10': 0.5779, 'time@10': 9.2235}:  90%|█████████ | 9/10 [00:57<00:07,  7.15s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9335, 'compress@10': 0.5401, 'time@10': 9.3175}:  90%|█████████ | 9/10 [01:07<00:07,  7.15s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9335, 'compress@10': 0.5401, 'time@10': 9.3175}: 100%|██████████| 10/10 [01:07<00:00,  8.09s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9335, 'compress@10': 0.5401, 'time@10': 9.3175}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.017059075158340955
Avg hit ratio: 0.9015450160102111
Avg ndcg: 0.9335172630038052
Avg compression ratio: 0.5400909116107135
Avg train time: 9.317499613761902
Std train time: 2.7757959531410967
[0.8535714285714286, 0.17499999999999996, 0.06785714285714285, 0.8892857142857141, 0.9964285714285713, 0.7464285714285714, 0.38928571428571423, 0.24642857142857147, 0.5678571428571428, 0.2107142857142857]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.917, 'compress@10': 0.8613, 'time@10': 8.3509}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.917, 'compress@10': 0.8613, 'time@10': 8.3509}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9512, 'compress@10': 0.5314, 'time@10': 7.7563}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9512, 'compress@10': 0.5314, 'time@10': 7.7563}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9199, 'compress@10': 0.4213, 'time@10': 6.9122}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9199, 'compress@10': 0.4213, 'time@10': 6.9122}:  30%|███       | 3/10 [00:14<00:31,  4.45s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9295, 'compress@10': 0.5393, 'time@10': 6.7283}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9295, 'compress@10': 0.5393, 'time@10': 6.7283}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0153, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9251, 'compress@10': 0.6307, 'time@10': 7.9415}:  40%|████      | 4/10 [00:26<00:30,  5.15s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0153, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9251, 'compress@10': 0.6307, 'time@10': 7.9415}:  50%|█████     | 5/10 [00:26<00:28,  5.62s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9324, 'compress@10': 0.6509, 'time@10': 8.3044}:  50%|█████     | 5/10 [00:36<00:28,  5.62s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9324, 'compress@10': 0.6509, 'time@10': 8.3044}:  60%|██████    | 6/10 [00:36<00:28,  7.16s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9315, 'compress@10': 0.6171, 'time@10': 8.7049}:  60%|██████    | 6/10 [00:42<00:28,  7.16s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9315, 'compress@10': 0.6171, 'time@10': 8.7049}:  70%|███████   | 7/10 [00:42<00:19,  6.65s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9328, 'compress@10': 0.5734, 'time@10': 8.6151}:  70%|███████   | 7/10 [00:50<00:19,  6.65s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9328, 'compress@10': 0.5734, 'time@10': 8.6151}:  80%|████████  | 8/10 [00:50<00:14,  7.09s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9467, 'compress@10': 0.5742, 'time@10': 9.266}:  80%|████████  | 8/10 [00:57<00:14,  7.09s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9467, 'compress@10': 0.5742, 'time@10': 9.266}:  90%|█████████ | 9/10 [00:57<00:07,  7.15s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9496, 'compress@10': 0.5396, 'time@10': 9.3867}:  90%|█████████ | 9/10 [01:08<00:07,  7.15s/it]  {'epoch': 27, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9496, 'compress@10': 0.5396, 'time@10': 9.3867}: 100%|██████████| 10/10 [01:08<00:00,  8.19s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9496, 'compress@10': 0.5396, 'time@10': 9.3867}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.016583890786045132
Avg hit ratio: 0.8974211310289408
Avg ndcg: 0.9496487559563518
Avg compression ratio: 0.5396209873781271
Avg train time: 9.386741375923156
Std train time: 2.788826576984744
[0.8586206896551725, 0.20344827586206893, 0.06551724137931034, 0.8586206896551722, 0.9965517241379309, 0.7206896551724138, 0.41034482758620683, 0.23793103448275865, 0.5827586206896551, 0.20344827586206893]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 0.866, 'time@10': 8.3598}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 0.866, 'time@10': 8.3598}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9399, 'compress@10': 0.5476, 'time@10': 7.7531}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9399, 'compress@10': 0.5476, 'time@10': 7.7531}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9123, 'compress@10': 0.4314, 'time@10': 6.843}:  20%|██        | 2/10 [00:13<00:47,  5.98s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9123, 'compress@10': 0.4314, 'time@10': 6.843}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9224, 'compress@10': 0.5395, 'time@10': 6.6322}:  30%|███       | 3/10 [00:20<00:30,  4.41s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9224, 'compress@10': 0.5395, 'time@10': 6.6322}:  40%|████      | 4/10 [00:20<00:30,  5.05s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9193, 'compress@10': 0.6309, 'time@10': 7.8397}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9193, 'compress@10': 0.6309, 'time@10': 7.8397}:  50%|█████     | 5/10 [00:26<00:27,  5.53s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9289, 'compress@10': 0.6469, 'time@10': 8.2132}:  50%|█████     | 5/10 [00:36<00:27,  5.53s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9289, 'compress@10': 0.6469, 'time@10': 8.2132}:  60%|██████    | 6/10 [00:36<00:28,  7.09s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9294, 'compress@10': 0.6165, 'time@10': 8.6759}:  60%|██████    | 6/10 [00:42<00:28,  7.09s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9294, 'compress@10': 0.6165, 'time@10': 8.6759}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9319, 'compress@10': 0.5719, 'time@10': 8.5872}:  70%|███████   | 7/10 [00:50<00:19,  6.66s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9319, 'compress@10': 0.5719, 'time@10': 8.5872}:  80%|████████  | 8/10 [00:50<00:14,  7.09s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9328, 'compress@10': 0.5744, 'time@10': 9.2163}:  80%|████████  | 8/10 [00:57<00:14,  7.09s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9328, 'compress@10': 0.5744, 'time@10': 9.2163}:  90%|█████████ | 9/10 [00:57<00:07,  7.11s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9366, 'compress@10': 0.5391, 'time@10': 9.3156}:  90%|█████████ | 9/10 [01:07<00:07,  7.11s/it]    {'epoch': 28, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9366, 'compress@10': 0.5391, 'time@10': 9.3156}: 100%|██████████| 10/10 [01:07<00:00,  8.08s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9366, 'compress@10': 0.5391, 'time@10': 9.3156}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01648024967508444
Avg hit ratio: 0.8989700032093919
Avg ndcg: 0.936597032867615
Avg compression ratio: 0.5391228274843537
Avg train time: 9.315589046478271
Std train time: 2.799973046442954
[0.8300000000000001, 0.19666666666666663, 0.06333333333333332, 0.8633333333333332, 0.9966666666666666, 0.73, 0.3966666666666666, 0.23000000000000004, 0.5966666666666666, 0.22999999999999995]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 0.8389, 'time@10': 8.3268}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 0.8389, 'time@10': 8.3268}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9485, 'compress@10': 0.5308, 'time@10': 7.7535}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9485, 'compress@10': 0.5308, 'time@10': 7.7535}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.918, 'compress@10': 0.4196, 'time@10': 7.0562}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.918, 'compress@10': 0.4196, 'time@10': 7.0562}:  30%|███       | 3/10 [00:14<00:32,  4.57s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9258, 'compress@10': 0.5317, 'time@10': 6.8315}:  30%|███       | 3/10 [00:20<00:32,  4.57s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9258, 'compress@10': 0.5317, 'time@10': 6.8315}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.923, 'compress@10': 0.6247, 'time@10': 8.034}:  40%|████      | 4/10 [00:26<00:31,  5.21s/it]   {'epoch': 29, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.923, 'compress@10': 0.6247, 'time@10': 8.034}:  50%|█████     | 5/10 [00:26<00:28,  5.66s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9309, 'compress@10': 0.6433, 'time@10': 8.3753}:  50%|█████     | 5/10 [00:37<00:28,  5.66s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9309, 'compress@10': 0.6433, 'time@10': 8.3753}:  60%|██████    | 6/10 [00:37<00:28,  7.18s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9338, 'compress@10': 0.6115, 'time@10': 8.7788}:  60%|██████    | 6/10 [00:42<00:28,  7.18s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9338, 'compress@10': 0.6115, 'time@10': 8.7788}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9373, 'compress@10': 0.5665, 'time@10': 8.6922}:  70%|███████   | 7/10 [00:50<00:20,  6.67s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9373, 'compress@10': 0.5665, 'time@10': 8.6922}:  80%|████████  | 8/10 [00:50<00:14,  7.14s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9502, 'compress@10': 0.5712, 'time@10': 9.3406}:  80%|████████  | 8/10 [00:58<00:14,  7.14s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9502, 'compress@10': 0.5712, 'time@10': 9.3406}:  90%|█████████ | 9/10 [00:58<00:07,  7.19s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9527, 'compress@10': 0.5388, 'time@10': 9.4272}:  90%|█████████ | 9/10 [01:08<00:07,  7.19s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9527, 'compress@10': 0.5388, 'time@10': 9.4272}: 100%|██████████| 10/10 [01:08<00:00,  8.13s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9527, 'compress@10': 0.5388, 'time@10': 9.4272}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.013440135741093142
Avg hit ratio: 0.8948271460665348
Avg ndcg: 0.9527400064814613
Avg compression ratio: 0.5388066981426702
Avg train time: 9.427208995819091
Std train time: 2.7348908625242068
[0.835483870967742, 0.22258064516129028, 0.06129032258064515, 0.8677419354838708, 0.996774193548387, 0.7064516129032258, 0.3838709677419354, 0.22258064516129036, 0.6096774193548387, 0.22258064516129028]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 0.8441, 'time@10': 8.2911}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 0.8441, 'time@10': 8.2911}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9424, 'compress@10': 0.5459, 'time@10': 7.6696}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9424, 'compress@10': 0.5459, 'time@10': 7.6696}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9139, 'compress@10': 0.4291, 'time@10': 6.8579}:  20%|██        | 2/10 [00:13<00:47,  5.89s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9139, 'compress@10': 0.4291, 'time@10': 6.8579}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9251, 'compress@10': 0.5399, 'time@10': 6.6604}:  30%|███       | 3/10 [00:20<00:30,  4.41s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9251, 'compress@10': 0.5399, 'time@10': 6.6604}:  40%|████      | 4/10 [00:20<00:30,  5.08s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9237, 'compress@10': 0.6313, 'time@10': 7.9722}:  40%|████      | 4/10 [00:26<00:30,  5.08s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9237, 'compress@10': 0.6313, 'time@10': 7.9722}:  50%|█████     | 5/10 [00:26<00:28,  5.65s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9315, 'compress@10': 0.6449, 'time@10': 8.3594}:  50%|█████     | 5/10 [00:37<00:28,  5.65s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9315, 'compress@10': 0.6449, 'time@10': 8.3594}:  60%|██████    | 6/10 [00:37<00:28,  7.24s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9331, 'compress@10': 0.6111, 'time@10': 8.803}:  60%|██████    | 6/10 [00:42<00:28,  7.24s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9331, 'compress@10': 0.6111, 'time@10': 8.803}:  70%|███████   | 7/10 [00:42<00:20,  6.76s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.936, 'compress@10': 0.5653, 'time@10': 8.6924}:  70%|███████   | 7/10 [00:50<00:20,  6.76s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.936, 'compress@10': 0.5653, 'time@10': 8.6924}:  80%|████████  | 8/10 [00:50<00:14,  7.14s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9367, 'compress@10': 0.5715, 'time@10': 9.3132}:  80%|████████  | 8/10 [00:57<00:14,  7.14s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9367, 'compress@10': 0.5715, 'time@10': 9.3132}:  90%|█████████ | 9/10 [00:57<00:07,  7.15s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9388, 'compress@10': 0.5384, 'time@10': 9.4147}:  90%|█████████ | 9/10 [01:08<00:07,  7.15s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9388, 'compress@10': 0.5384, 'time@10': 9.4147}: 100%|██████████| 10/10 [01:08<00:00,  8.14s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9388, 'compress@10': 0.5384, 'time@10': 9.4147}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.014810415318926537
Avg hit ratio: 0.8922593017244969
Avg ndcg: 0.9388116913221374
Avg compression ratio: 0.5383821532424466
Avg train time: 9.414697647094727
Std train time: 2.8588424383444213
[0.8406250000000001, 0.21562499999999996, 0.05937499999999999, 0.8406249999999998, 0.996875, 0.684375, 0.40312499999999996, 0.21562500000000004, 0.621875, 0.24687499999999996]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 0.849, 'time@10': 8.2341}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 0.849, 'time@10': 8.2341}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.893, 'ndcg@10': 0.943, 'compress@10': 0.545, 'time@10': 7.6233}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it] {'epoch': 31, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.893, 'ndcg@10': 0.943, 'compress@10': 0.545, 'time@10': 7.6233}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9144, 'compress@10': 0.4279, 'time@10': 6.9002}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9144, 'compress@10': 0.4279, 'time@10': 6.9002}:  30%|███       | 3/10 [00:13<00:31,  4.45s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9236, 'compress@10': 0.5325, 'time@10': 6.7024}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9236, 'compress@10': 0.5325, 'time@10': 6.7024}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9239, 'compress@10': 0.6254, 'time@10': 7.9646}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9239, 'compress@10': 0.6254, 'time@10': 7.9646}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9321, 'compress@10': 0.6364, 'time@10': 8.3592}:  50%|█████     | 5/10 [00:37<00:28,  5.63s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9321, 'compress@10': 0.6364, 'time@10': 8.3592}:  60%|██████    | 6/10 [00:37<00:28,  7.24s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9349, 'compress@10': 0.6065, 'time@10': 8.8008}:  60%|██████    | 6/10 [00:42<00:28,  7.24s/it] {'epoch': 31, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9349, 'compress@10': 0.6065, 'time@10': 8.8008}:  70%|███████   | 7/10 [00:42<00:20,  6.76s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9382, 'compress@10': 0.5604, 'time@10': 8.6774}:  70%|███████   | 7/10 [00:50<00:20,  6.76s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9382, 'compress@10': 0.5604, 'time@10': 8.6774}:  80%|████████  | 8/10 [00:50<00:14,  7.10s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9552, 'compress@10': 0.5684, 'time@10': 9.2824}:  80%|████████  | 8/10 [00:57<00:14,  7.10s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9552, 'compress@10': 0.5684, 'time@10': 9.2824}:  90%|█████████ | 9/10 [00:57<00:07,  7.10s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9571, 'compress@10': 0.538, 'time@10': 9.3535}:  90%|█████████ | 9/10 [01:07<00:07,  7.10s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9571, 'compress@10': 0.538, 'time@10': 9.3535}: 100%|██████████| 10/10 [01:07<00:00,  8.01s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9571, 'compress@10': 0.538, 'time@10': 9.3535}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.01225490272351055
Avg hit ratio: 0.8912557174951063
Avg ndcg: 0.957082554585061
Avg compression ratio: 0.5380001250769992
Avg train time: 9.353513431549072
Std train time: 2.7702411219230263
[0.8454545454545456, 0.20909090909090905, 0.057575757575757565, 0.8454545454545453, 0.996969696969697, 0.6939393939393939, 0.3909090909090909, 0.20909090909090913, 0.6333333333333333, 0.23939393939393935]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.8536, 'time@10': 8.082}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.8536, 'time@10': 8.082}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9506, 'compress@10': 0.5441, 'time@10': 7.508}:  10%|█         | 1/10 [00:11<00:36,  4.08s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9506, 'compress@10': 0.5441, 'time@10': 7.508}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9195, 'compress@10': 0.4268, 'time@10': 6.7987}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9195, 'compress@10': 0.4268, 'time@10': 6.7987}:  30%|███       | 3/10 [00:13<00:30,  4.43s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.929, 'compress@10': 0.5328, 'time@10': 6.6345}:  30%|███       | 3/10 [00:20<00:30,  4.43s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.929, 'compress@10': 0.5328, 'time@10': 6.6345}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.9281, 'compress@10': 0.6257, 'time@10': 7.9598}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.9281, 'compress@10': 0.6257, 'time@10': 7.9598}:  50%|█████     | 5/10 [00:26<00:28,  5.68s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9366, 'compress@10': 0.6382, 'time@10': 8.4025}:  50%|█████     | 5/10 [00:37<00:28,  5.68s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9366, 'compress@10': 0.6382, 'time@10': 8.4025}:  60%|██████    | 6/10 [00:37<00:29,  7.37s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.939, 'compress@10': 0.6063, 'time@10': 8.8761}:  60%|██████    | 6/10 [00:43<00:29,  7.37s/it] {'epoch': 32, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.939, 'compress@10': 0.6063, 'time@10': 8.8761}:  70%|███████   | 7/10 [00:43<00:20,  6.89s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9418, 'compress@10': 0.5595, 'time@10': 8.7408}:  70%|███████   | 7/10 [00:51<00:20,  6.89s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9418, 'compress@10': 0.5595, 'time@10': 8.7408}:  80%|████████  | 8/10 [00:51<00:14,  7.19s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9417, 'compress@10': 0.5689, 'time@10': 9.3441}:  80%|████████  | 8/10 [00:58<00:14,  7.19s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9417, 'compress@10': 0.5689, 'time@10': 9.3441}:  90%|█████████ | 9/10 [00:58<00:07,  7.17s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9445, 'compress@10': 0.5377, 'time@10': 9.4186}:  90%|█████████ | 9/10 [01:08<00:07,  7.17s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9445, 'compress@10': 0.5377, 'time@10': 9.4186}: 100%|██████████| 10/10 [01:08<00:00,  8.08s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9445, 'compress@10': 0.5377, 'time@10': 9.4186}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.016480426959738538
Avg hit ratio: 0.8768271460665348
Avg ndcg: 0.9444812558928393
Avg compression ratio: 0.537656068671456
Avg train time: 9.418644881248474
Std train time: 2.866367691163665
[0.8500000000000001, 0.2029411764705882, 0.05588235294117646, 0.8205882352941175, 0.9970588235294118, 0.7029411764705882, 0.37941176470588234, 0.20294117647058826, 0.6441176470588235, 0.2617647058823529]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.8579, 'time@10': 8.2191}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.8579, 'time@10': 8.2191}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9448, 'compress@10': 0.5433, 'time@10': 7.596}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9448, 'compress@10': 0.5433, 'time@10': 7.596}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9156, 'compress@10': 0.4258, 'time@10': 6.8652}:  20%|██        | 2/10 [00:13<00:46,  5.83s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9156, 'compress@10': 0.4258, 'time@10': 6.8652}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9272, 'compress@10': 0.5261, 'time@10': 6.6688}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9272, 'compress@10': 0.5261, 'time@10': 6.6688}:  40%|████      | 4/10 [00:20<00:30,  5.09s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9275, 'compress@10': 0.6203, 'time@10': 8.0171}:  40%|████      | 4/10 [00:26<00:30,  5.09s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9275, 'compress@10': 0.6203, 'time@10': 8.0171}:  50%|█████     | 5/10 [00:26<00:28,  5.69s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9353, 'compress@10': 0.6352, 'time@10': 8.4071}:  50%|█████     | 5/10 [00:37<00:28,  5.69s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9353, 'compress@10': 0.6352, 'time@10': 8.4071}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9396, 'compress@10': 0.6022, 'time@10': 8.7725}:  60%|██████    | 6/10 [00:42<00:29,  7.29s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9396, 'compress@10': 0.6022, 'time@10': 8.7725}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.942, 'compress@10': 0.5551, 'time@10': 8.6371}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it]  {'epoch': 33, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.942, 'compress@10': 0.5551, 'time@10': 8.6371}:  80%|████████  | 8/10 [00:50<00:14,  7.03s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9559, 'compress@10': 0.5661, 'time@10': 9.2533}:  80%|████████  | 8/10 [00:57<00:14,  7.03s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9559, 'compress@10': 0.5661, 'time@10': 9.2533}:  90%|█████████ | 9/10 [00:57<00:07,  7.07s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9578, 'compress@10': 0.5374, 'time@10': 9.376}:  90%|█████████ | 9/10 [01:08<00:07,  7.07s/it]    {'epoch': 33, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9578, 'compress@10': 0.5374, 'time@10': 9.376}: 100%|██████████| 10/10 [01:08<00:00,  8.14s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9578, 'compress@10': 0.5374, 'time@10': 9.376}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.01284084108136474
Avg hit ratio: 0.8901763524157411
Avg ndcg: 0.9577675390979111
Avg compression ratio: 0.5373689180696732
Avg train time: 9.375981783866882
Std train time: 2.8407153767668643
[0.8542857142857144, 0.19714285714285712, 0.05428571428571428, 0.8257142857142856, 0.9971428571428571, 0.6828571428571428, 0.39714285714285713, 0.19714285714285718, 0.6542857142857142, 0.2542857142857142]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.8619, 'time@10': 8.0046}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.8619, 'time@10': 8.0046}:  10%|█         | 1/10 [00:04<00:36,  4.04s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9459, 'compress@10': 0.5425, 'time@10': 7.4396}:  10%|█         | 1/10 [00:10<00:36,  4.04s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9459, 'compress@10': 0.5425, 'time@10': 7.4396}:  20%|██        | 2/10 [00:10<00:45,  5.73s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9163, 'compress@10': 0.4248, 'time@10': 6.7147}:  20%|██        | 2/10 [00:13<00:45,  5.73s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9163, 'compress@10': 0.4248, 'time@10': 6.7147}:  30%|███       | 3/10 [00:13<00:30,  4.33s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.926, 'compress@10': 0.5266, 'time@10': 6.5776}:  30%|███       | 3/10 [00:19<00:30,  4.33s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.926, 'compress@10': 0.5266, 'time@10': 6.5776}:  40%|████      | 4/10 [00:19<00:30,  5.07s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9264, 'compress@10': 0.6207, 'time@10': 7.8774}:  40%|████      | 4/10 [00:26<00:30,  5.07s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9264, 'compress@10': 0.6207, 'time@10': 7.8774}:  50%|█████     | 5/10 [00:26<00:28,  5.61s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9341, 'compress@10': 0.6322, 'time@10': 8.2849}:  50%|█████     | 5/10 [00:36<00:28,  5.61s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9341, 'compress@10': 0.6322, 'time@10': 8.2849}:  60%|██████    | 6/10 [00:36<00:28,  7.23s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9364, 'compress@10': 0.6021, 'time@10': 8.7049}:  60%|██████    | 6/10 [00:42<00:28,  7.23s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9364, 'compress@10': 0.6021, 'time@10': 8.7049}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9396, 'compress@10': 0.5543, 'time@10': 8.5739}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9396, 'compress@10': 0.5543, 'time@10': 8.5739}:  80%|████████  | 8/10 [00:50<00:14,  7.02s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9407, 'compress@10': 0.5665, 'time@10': 9.2052}:  80%|████████  | 8/10 [00:57<00:14,  7.02s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9407, 'compress@10': 0.5665, 'time@10': 9.2052}:  90%|█████████ | 9/10 [00:57<00:07,  7.07s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9442, 'compress@10': 0.537, 'time@10': 9.2853}:  90%|█████████ | 9/10 [01:07<00:07,  7.07s/it]    {'epoch': 34, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9442, 'compress@10': 0.537, 'time@10': 9.2853}: 100%|██████████| 10/10 [01:07<00:00,  7.99s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9442, 'compress@10': 0.537, 'time@10': 9.2853}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.011732271196580515
Avg hit ratio: 0.8901763524157411
Avg ndcg: 0.9442282779491317
Avg compression ratio: 0.5370120477449556
Avg train time: 9.285268807411194
Std train time: 2.8361400705294413
[0.8583333333333335, 0.19166666666666665, 0.05277777777777777, 0.8305555555555555, 0.9972222222222222, 0.6638888888888889, 0.41388888888888886, 0.1916666666666667, 0.6638888888888889, 0.24722222222222218]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.8658, 'time@10': 8.0996}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.8658, 'time@10': 8.0996}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.893, 'ndcg@10': 0.948, 'compress@10': 0.5418, 'time@10': 7.5029}:  10%|█         | 1/10 [00:11<00:36,  4.08s/it] {'epoch': 35, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.893, 'ndcg@10': 0.948, 'compress@10': 0.5418, 'time@10': 7.5029}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9177, 'compress@10': 0.4239, 'time@10': 6.7421}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9177, 'compress@10': 0.4239, 'time@10': 6.7421}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9281, 'compress@10': 0.5271, 'time@10': 6.5896}:  30%|███       | 3/10 [00:19<00:30,  4.34s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9281, 'compress@10': 0.5271, 'time@10': 6.5896}:  40%|████      | 4/10 [00:19<00:30,  5.06s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.929, 'compress@10': 0.6211, 'time@10': 7.9312}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it] {'epoch': 35, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.929, 'compress@10': 0.6211, 'time@10': 7.9312}:  50%|█████     | 5/10 [00:26<00:28,  5.65s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9366, 'compress@10': 0.6295, 'time@10': 8.3562}:  50%|█████     | 5/10 [00:37<00:28,  5.65s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9366, 'compress@10': 0.6295, 'time@10': 8.3562}:  60%|██████    | 6/10 [00:37<00:29,  7.31s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.939, 'compress@10': 0.602, 'time@10': 8.7842}:  60%|██████    | 6/10 [00:42<00:29,  7.31s/it] {'epoch': 35, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.939, 'compress@10': 0.602, 'time@10': 8.7842}:  70%|███████   | 7/10 [00:42<00:20,  6.78s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9418, 'compress@10': 0.5536, 'time@10': 8.6097}:  70%|███████   | 7/10 [00:50<00:20,  6.78s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9418, 'compress@10': 0.5536, 'time@10': 8.6097}:  80%|████████  | 8/10 [00:50<00:13,  6.99s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.951, 'compress@10': 0.5669, 'time@10': 9.2104}:  80%|████████  | 8/10 [00:57<00:13,  6.99s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.951, 'compress@10': 0.5669, 'time@10': 9.2104}:  90%|█████████ | 9/10 [00:57<00:07,  7.01s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9534, 'compress@10': 0.5367, 'time@10': 9.2693}:  90%|█████████ | 9/10 [01:07<00:07,  7.01s/it]  {'epoch': 35, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9534, 'compress@10': 0.5367, 'time@10': 9.2693}: 100%|██████████| 10/10 [01:07<00:00,  7.88s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9534, 'compress@10': 0.5367, 'time@10': 9.2693}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.011931361754944714
Avg hit ratio: 0.8895414317808206
Avg ndcg: 0.9533590289787505
Avg compression ratio: 0.5366742560377601
Avg train time: 9.26930766105652
Std train time: 2.8561181854283655
[0.8621621621621623, 0.2135135135135135, 0.05135135135135135, 0.835135135135135, 0.9972972972972973, 0.6459459459459459, 0.4027027027027027, 0.18648648648648652, 0.672972972972973, 0.2405405405405405]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.8694, 'time@10': 8.6302}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.8694, 'time@10': 8.6302}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9448, 'compress@10': 0.5541, 'time@10': 7.9642}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9448, 'compress@10': 0.5541, 'time@10': 7.9642}:  20%|██        | 2/10 [00:11<00:48,  6.11s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9156, 'compress@10': 0.4317, 'time@10': 7.0203}:  20%|██        | 2/10 [00:14<00:48,  6.11s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.749, 'ndcg@10': 0.9156, 'compress@10': 0.4317, 'time@10': 7.0203}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9272, 'compress@10': 0.534, 'time@10': 6.8039}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9272, 'compress@10': 0.534, 'time@10': 6.8039}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.929, 'compress@10': 0.6267, 'time@10': 8.073}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.929, 'compress@10': 0.6267, 'time@10': 8.073}:  50%|█████     | 5/10 [00:27<00:28,  5.69s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.936, 'compress@10': 0.6312, 'time@10': 8.4416}:  50%|█████     | 5/10 [00:37<00:28,  5.69s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.936, 'compress@10': 0.6312, 'time@10': 8.4416}:  60%|██████    | 6/10 [00:37<00:29,  7.26s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.938, 'compress@10': 0.602, 'time@10': 8.8317}:  60%|██████    | 6/10 [00:43<00:29,  7.26s/it] {'epoch': 36, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.938, 'compress@10': 0.602, 'time@10': 8.8317}:  70%|███████   | 7/10 [00:43<00:20,  6.73s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9411, 'compress@10': 0.553, 'time@10': 8.6651}:  70%|███████   | 7/10 [00:50<00:20,  6.73s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9411, 'compress@10': 0.553, 'time@10': 8.6651}:  80%|████████  | 8/10 [00:50<00:13,  6.98s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9422, 'compress@10': 0.5673, 'time@10': 9.3095}:  80%|████████  | 8/10 [00:57<00:13,  6.98s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9422, 'compress@10': 0.5673, 'time@10': 9.3095}:  90%|█████████ | 9/10 [00:57<00:07,  7.07s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.945, 'compress@10': 0.5364, 'time@10': 9.3788}:  90%|█████████ | 9/10 [01:07<00:07,  7.07s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.945, 'compress@10': 0.5364, 'time@10': 9.3788}: 100%|██████████| 10/10 [01:07<00:00,  7.99s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.945, 'compress@10': 0.5364, 'time@10': 9.3788}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.012556555872490077
Avg hit ratio: 0.87911644458164
Avg ndcg: 0.945023464943789
Avg compression ratio: 0.5363780226201783
Avg train time: 9.378754997253418
Std train time: 2.8523309279425004
[0.8657894736842107, 0.20789473684210524, 0.049999999999999996, 0.8394736842105263, 0.9973684210526316, 0.6552631578947368, 0.39210526315789473, 0.1815789473684211, 0.6815789473684211, 0.23421052631578942]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9244, 'compress@10': 0.8728, 'time@10': 8.0544}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9244, 'compress@10': 0.8728, 'time@10': 8.0544}:  10%|█         | 1/10 [00:04<00:36,  4.06s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9461, 'compress@10': 0.5531, 'time@10': 7.4347}:  10%|█         | 1/10 [00:10<00:36,  4.06s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9461, 'compress@10': 0.5531, 'time@10': 7.4347}:  20%|██        | 2/10 [00:10<00:45,  5.70s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9164, 'compress@10': 0.4307, 'time@10': 6.6456}:  20%|██        | 2/10 [00:13<00:45,  5.70s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9164, 'compress@10': 0.4307, 'time@10': 6.6456}:  30%|███       | 3/10 [00:13<00:29,  4.28s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9279, 'compress@10': 0.5343, 'time@10': 6.5308}:  30%|███       | 3/10 [00:19<00:29,  4.28s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9279, 'compress@10': 0.5343, 'time@10': 6.5308}:  40%|████      | 4/10 [00:19<00:30,  5.05s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9303, 'compress@10': 0.6269, 'time@10': 7.8306}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9303, 'compress@10': 0.6269, 'time@10': 7.8306}:  50%|█████     | 5/10 [00:26<00:27,  5.59s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9379, 'compress@10': 0.6329, 'time@10': 8.2392}:  50%|█████     | 5/10 [00:36<00:27,  5.59s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9379, 'compress@10': 0.6329, 'time@10': 8.2392}:  60%|██████    | 6/10 [00:36<00:28,  7.20s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9399, 'compress@10': 0.602, 'time@10': 8.7124}:  60%|██████    | 6/10 [00:42<00:28,  7.20s/it] {'epoch': 37, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9399, 'compress@10': 0.602, 'time@10': 8.7124}:  70%|███████   | 7/10 [00:42<00:20,  6.74s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9434, 'compress@10': 0.5524, 'time@10': 8.5665}:  70%|███████   | 7/10 [00:49<00:20,  6.74s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9434, 'compress@10': 0.5524, 'time@10': 8.5665}:  80%|████████  | 8/10 [00:49<00:14,  7.02s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9606, 'compress@10': 0.5677, 'time@10': 9.1869}:  80%|████████  | 8/10 [00:57<00:14,  7.02s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9606, 'compress@10': 0.5677, 'time@10': 9.1869}:  90%|█████████ | 9/10 [00:57<00:07,  7.05s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9623, 'compress@10': 0.5361, 'time@10': 9.2487}:  90%|█████████ | 9/10 [01:06<00:07,  7.05s/it]    {'epoch': 37, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9623, 'compress@10': 0.5361, 'time@10': 9.2487}: 100%|██████████| 10/10 [01:06<00:00,  7.91s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9623, 'compress@10': 0.5361, 'time@10': 9.2487}: 100%|██████████| 10/10 [01:06<00:00,  6.69s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.010345104944189647
Avg hit ratio: 0.893033495272884
Avg ndcg: 0.9622940271095549
Avg compression ratio: 0.5361199927483775
Avg train time: 9.248706245422364
Std train time: 2.865534308373089
[0.8692307692307694, 0.20256410256410254, 0.04871794871794871, 0.8435897435897436, 0.9974358974358974, 0.6641025641025641, 0.382051282051282, 0.17692307692307696, 0.6897435897435897, 0.22820512820512817]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9244, 'compress@10': 0.8761, 'time@10': 8.4901}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9244, 'compress@10': 0.8761, 'time@10': 8.4901}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9473, 'compress@10': 0.5522, 'time@10': 7.7244}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]   {'epoch': 38, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9473, 'compress@10': 0.5522, 'time@10': 7.7244}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9173, 'compress@10': 0.4297, 'time@10': 6.9882}:  20%|██        | 2/10 [00:14<00:47,  5.88s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9173, 'compress@10': 0.4297, 'time@10': 6.9882}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9261, 'compress@10': 0.5345, 'time@10': 6.762}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9261, 'compress@10': 0.5345, 'time@10': 6.762}:  40%|████      | 4/10 [00:20<00:30,  5.13s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9296, 'compress@10': 0.6271, 'time@10': 8.0526}:  40%|████      | 4/10 [00:26<00:30,  5.13s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9296, 'compress@10': 0.6271, 'time@10': 8.0526}:  50%|█████     | 5/10 [00:26<00:28,  5.68s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.937, 'compress@10': 0.6345, 'time@10': 8.4116}:  50%|█████     | 5/10 [00:37<00:28,  5.68s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.937, 'compress@10': 0.6345, 'time@10': 8.4116}:  60%|██████    | 6/10 [00:37<00:28,  7.23s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9396, 'compress@10': 0.602, 'time@10': 8.7884}:  60%|██████    | 6/10 [00:42<00:28,  7.23s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9396, 'compress@10': 0.602, 'time@10': 8.7884}:  70%|███████   | 7/10 [00:42<00:20,  6.68s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9416, 'compress@10': 0.5518, 'time@10': 8.6165}:  70%|███████   | 7/10 [00:50<00:20,  6.68s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9416, 'compress@10': 0.5518, 'time@10': 8.6165}:  80%|████████  | 8/10 [00:50<00:13,  6.93s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0103, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9402, 'compress@10': 0.5681, 'time@10': 9.2787}:  80%|████████  | 8/10 [00:57<00:13,  6.93s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0103, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9402, 'compress@10': 0.5681, 'time@10': 9.2787}:  90%|█████████ | 9/10 [00:57<00:07,  7.05s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9421, 'compress@10': 0.5359, 'time@10': 9.382}:  90%|█████████ | 9/10 [01:07<00:07,  7.05s/it]    {'epoch': 38, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9421, 'compress@10': 0.5359, 'time@10': 9.382}: 100%|██████████| 10/10 [01:07<00:00,  8.07s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9045, 'ndcg@10': 0.9421, 'compress@10': 0.5359, 'time@10': 9.382}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.011141918520175417
Avg hit ratio: 0.9044620667014556
Avg ndcg: 0.9420874826939322
Avg compression ratio: 0.535877895401303
Avg train time: 9.38200330734253
Std train time: 2.8699953496873567
[0.8725000000000002, 0.19749999999999998, 0.047499999999999994, 0.8475, 0.9975, 0.6475, 0.3725, 0.17250000000000004, 0.6975, 0.24749999999999997]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9291, 'compress@10': 0.8792, 'time@10': 8.1805}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9291, 'compress@10': 0.8792, 'time@10': 8.1805}:  10%|█         | 1/10 [00:04<00:37,  4.13s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9528, 'compress@10': 0.5513, 'time@10': 7.571}:  10%|█         | 1/10 [00:11<00:37,  4.13s/it]  {'epoch': 39, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9528, 'compress@10': 0.5513, 'time@10': 7.571}:  20%|██        | 2/10 [00:11<00:46,  5.82s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9209, 'compress@10': 0.4287, 'time@10': 6.9136}:  20%|██        | 2/10 [00:13<00:46,  5.82s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9209, 'compress@10': 0.4287, 'time@10': 6.9136}:  30%|███       | 3/10 [00:13<00:31,  4.45s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9305, 'compress@10': 0.5348, 'time@10': 6.7301}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9305, 'compress@10': 0.5348, 'time@10': 6.7301}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9338, 'compress@10': 0.6273, 'time@10': 8.052}:  40%|████      | 4/10 [00:26<00:30,  5.15s/it] {'epoch': 39, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9338, 'compress@10': 0.6273, 'time@10': 8.052}:  50%|█████     | 5/10 [00:26<00:28,  5.71s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9388, 'compress@10': 0.632, 'time@10': 8.4815}:  50%|█████     | 5/10 [00:37<00:28,  5.71s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9388, 'compress@10': 0.632, 'time@10': 8.4815}:  60%|██████    | 6/10 [00:37<00:29,  7.40s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.941, 'compress@10': 0.5985, 'time@10': 8.9981}:  60%|██████    | 6/10 [00:43<00:29,  7.40s/it] {'epoch': 39, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.941, 'compress@10': 0.5985, 'time@10': 8.9981}:  70%|███████   | 7/10 [00:43<00:20,  6.97s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.943, 'compress@10': 0.5482, 'time@10': 8.8747}:  70%|███████   | 7/10 [00:51<00:20,  6.97s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.943, 'compress@10': 0.5482, 'time@10': 8.8747}:  80%|████████  | 8/10 [00:51<00:14,  7.31s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.96, 'compress@10': 0.5658, 'time@10': 9.5177}:  80%|████████  | 8/10 [00:59<00:14,  7.31s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.96, 'compress@10': 0.5658, 'time@10': 9.5177}:  90%|█████████ | 9/10 [00:59<00:07,  7.33s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9618, 'compress@10': 0.5356, 'time@10': 9.5883}:  90%|█████████ | 9/10 [01:09<00:07,  7.33s/it] {'epoch': 39, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9618, 'compress@10': 0.5356, 'time@10': 9.5883}: 100%|██████████| 10/10 [01:09<00:00,  8.23s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9618, 'compress@10': 0.5356, 'time@10': 9.5883}: 100%|██████████| 10/10 [01:09<00:00,  6.93s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.013552559332337977
Avg hit ratio: 0.9075414317808205
Avg ndcg: 0.9618155459088659
Avg compression ratio: 0.5356442338107656
Avg train time: 9.588252639770507
Std train time: 2.9411346708917607
[0.8756097560975611, 0.2170731707317073, 0.04634146341463414, 0.8512195121951219, 0.9731707317073172, 0.6560975609756097, 0.36341463414634145, 0.1682926829268293, 0.7048780487804878, 0.2414634146341463]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9291, 'compress@10': 0.8821, 'time@10': 8.5782}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9291, 'compress@10': 0.8821, 'time@10': 8.5782}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9638, 'compress@10': 0.5622, 'time@10': 7.9693}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9638, 'compress@10': 0.5622, 'time@10': 7.9693}:  20%|██        | 2/10 [00:11<00:49,  6.13s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9282, 'compress@10': 0.4357, 'time@10': 7.2126}:  20%|██        | 2/10 [00:14<00:49,  6.13s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9282, 'compress@10': 0.4357, 'time@10': 7.2126}:  30%|███       | 3/10 [00:14<00:32,  4.65s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9367, 'compress@10': 0.5409, 'time@10': 6.9858}:  30%|███       | 3/10 [00:20<00:32,  4.65s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9367, 'compress@10': 0.5409, 'time@10': 6.9858}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9389, 'compress@10': 0.6275, 'time@10': 8.2787}:  40%|████      | 4/10 [00:27<00:31,  5.32s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9389, 'compress@10': 0.6275, 'time@10': 8.2787}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0121, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.941, 'compress@10': 0.6335, 'time@10': 8.615}:  50%|█████     | 5/10 [00:38<00:29,  5.84s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0121, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.941, 'compress@10': 0.6335, 'time@10': 8.615}:  60%|██████    | 6/10 [00:38<00:29,  7.37s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0148, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9428, 'compress@10': 0.5986, 'time@10': 8.946}:  60%|██████    | 6/10 [00:43<00:29,  7.37s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0148, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9428, 'compress@10': 0.5986, 'time@10': 8.946}:  70%|███████   | 7/10 [00:43<00:20,  6.76s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.908, 'ndcg@10': 0.946, 'compress@10': 0.5477, 'time@10': 8.7589}:  70%|███████   | 7/10 [00:51<00:20,  6.76s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.908, 'ndcg@10': 0.946, 'compress@10': 0.5477, 'time@10': 8.7589}:  80%|████████  | 8/10 [00:51<00:13,  6.99s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9462, 'compress@10': 0.5661, 'time@10': 9.415}:  80%|████████  | 8/10 [00:58<00:13,  6.99s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9462, 'compress@10': 0.5661, 'time@10': 9.415}:  90%|█████████ | 9/10 [00:58<00:07,  7.11s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.9437, 'compress@10': 0.5354, 'time@10': 9.4569}:  90%|█████████ | 9/10 [01:08<00:07,  7.11s/it]  {'epoch': 40, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.9437, 'compress@10': 0.5354, 'time@10': 9.4569}: 100%|██████████| 10/10 [01:08<00:00,  7.96s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.9437, 'compress@10': 0.5354, 'time@10': 9.4569}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.015739551564108653
Avg hit ratio: 0.9012362602498426
Avg ndcg: 0.9436528341206483
Avg compression ratio: 0.5353962377736832
Avg train time: 9.456871557235718
Std train time: 2.8164841322759644
[0.8547619047619048, 0.23571428571428568, 0.04523809523809523, 0.8309523809523809, 0.9500000000000001, 0.6642857142857143, 0.37857142857142856, 0.1642857142857143, 0.7119047619047618, 0.2595238095238095]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9291, 'compress@10': 0.8624, 'time@10': 8.1892}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9291, 'compress@10': 0.8624, 'time@10': 8.1892}:  10%|█         | 1/10 [00:04<00:37,  4.13s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0056, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9484, 'compress@10': 0.5614, 'time@10': 7.5483}:  10%|█         | 1/10 [00:11<00:37,  4.13s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0056, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9484, 'compress@10': 0.5614, 'time@10': 7.5483}:  20%|██        | 2/10 [00:11<00:46,  5.79s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.918, 'compress@10': 0.4348, 'time@10': 6.9336}:  20%|██        | 2/10 [00:13<00:46,  5.79s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.918, 'compress@10': 0.4348, 'time@10': 6.9336}:  30%|███       | 3/10 [00:13<00:31,  4.46s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9289, 'compress@10': 0.5353, 'time@10': 6.7364}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9289, 'compress@10': 0.5353, 'time@10': 6.7364}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0071, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9341, 'compress@10': 0.6185, 'time@10': 8.0287}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0071, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9341, 'compress@10': 0.6185, 'time@10': 8.0287}:  50%|█████     | 5/10 [00:26<00:28,  5.68s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0062, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9412, 'compress@10': 0.6274, 'time@10': 8.4273}:  50%|█████     | 5/10 [00:37<00:28,  5.68s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0062, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9412, 'compress@10': 0.6274, 'time@10': 8.4273}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0065, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.9434, 'compress@10': 0.5954, 'time@10': 8.8264}:  60%|██████    | 6/10 [00:42<00:29,  7.30s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0065, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.9434, 'compress@10': 0.5954, 'time@10': 8.8264}:  70%|███████   | 7/10 [00:42<00:20,  6.76s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.9241, 'ndcg@10': 0.9426, 'compress@10': 0.5445, 'time@10': 8.6588}:  70%|███████   | 7/10 [00:50<00:20,  6.76s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.9241, 'ndcg@10': 0.9426, 'compress@10': 0.5445, 'time@10': 8.6588}:  80%|████████  | 8/10 [00:50<00:14,  7.00s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0098, 'hit_ratio@10': 0.904, 'ndcg@10': 0.9493, 'compress@10': 0.564, 'time@10': 9.2605}:  80%|████████  | 8/10 [00:57<00:14,  7.00s/it] {'epoch': 41, 'num_users': 6.3333, 'loss': 0.0098, 'hit_ratio@10': 0.904, 'ndcg@10': 0.9493, 'compress@10': 0.564, 'time@10': 9.2605}:  90%|█████████ | 9/10 [00:57<00:07,  7.03s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9521, 'compress@10': 0.5352, 'time@10': 9.3206}:  90%|█████████ | 9/10 [01:07<00:07,  7.03s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9521, 'compress@10': 0.5352, 'time@10': 9.3206}: 100%|██████████| 10/10 [01:07<00:00,  7.91s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9521, 'compress@10': 0.5352, 'time@10': 9.3206}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.009043463867586355
Avg hit ratio: 0.9112823431991511
Avg ndcg: 0.952079531826851
Avg compression ratio: 0.5352176713374883
Avg train time: 9.320627880096435
Std train time: 2.7635556709334694
[0.858139534883721, 0.23023255813953486, 0.0441860465116279, 0.8348837209302324, 0.9511627906976745, 0.6488372093023256, 0.3697674418604651, 0.18372093023255817, 0.7186046511627906, 0.2534883720930232]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9312, 'compress@10': 0.8656, 'time@10': 8.0553}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9312, 'compress@10': 0.8656, 'time@10': 8.0553}:  10%|█         | 1/10 [00:04<00:36,  4.06s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9899, 'compress@10': 0.5603, 'time@10': 7.4352}:  10%|█         | 1/10 [00:10<00:36,  4.06s/it] {'epoch': 42, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9899, 'compress@10': 0.5603, 'time@10': 7.4352}:  20%|██        | 2/10 [00:10<00:45,  5.70s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9457, 'compress@10': 0.4338, 'time@10': 6.8163}:  20%|██        | 2/10 [00:13<00:45,  5.70s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9457, 'compress@10': 0.4338, 'time@10': 6.8163}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9479, 'compress@10': 0.5355, 'time@10': 6.685}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it]  {'epoch': 42, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9479, 'compress@10': 0.5355, 'time@10': 6.685}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9497, 'compress@10': 0.6189, 'time@10': 8.007}:  40%|████      | 4/10 [00:26<00:30,  5.15s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9497, 'compress@10': 0.6189, 'time@10': 8.007}:  50%|█████     | 5/10 [00:26<00:28,  5.71s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9542, 'compress@10': 0.6252, 'time@10': 8.4378}:  50%|█████     | 5/10 [00:37<00:28,  5.71s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9542, 'compress@10': 0.6252, 'time@10': 8.4378}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9542, 'compress@10': 0.5923, 'time@10': 8.8157}:  60%|██████    | 6/10 [00:42<00:29,  7.38s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9542, 'compress@10': 0.5923, 'time@10': 8.8157}:  70%|███████   | 7/10 [00:42<00:20,  6.79s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9563, 'compress@10': 0.5441, 'time@10': 8.6618}:  70%|███████   | 7/10 [00:50<00:20,  6.79s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9563, 'compress@10': 0.5441, 'time@10': 8.6618}:  80%|████████  | 8/10 [00:50<00:14,  7.06s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9569, 'compress@10': 0.5644, 'time@10': 9.2744}:  80%|████████  | 8/10 [00:57<00:14,  7.06s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9569, 'compress@10': 0.5644, 'time@10': 9.2744}:  90%|█████████ | 9/10 [00:57<00:07,  7.08s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9572, 'compress@10': 0.535, 'time@10': 9.3559}:  90%|█████████ | 9/10 [01:07<00:07,  7.08s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9572, 'compress@10': 0.535, 'time@10': 9.3559}: 100%|██████████| 10/10 [01:07<00:00,  8.02s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.9572, 'compress@10': 0.535, 'time@10': 9.3559}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.012812314614597161
Avg hit ratio: 0.8952557174951062
Avg ndcg: 0.9571536733441741
Avg compression ratio: 0.5350038620970301
Avg train time: 9.355914616584778
Std train time: 2.806099752418393
[0.8386363636363636, 0.2477272727272727, 0.043181818181818175, 0.8386363636363635, 0.9295454545454547, 0.6568181818181819, 0.3613636363636364, 0.17954545454545456, 0.7249999999999999, 0.2704545454545454]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9291, 'compress@10': 0.8471, 'time@10': 8.0985}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9291, 'compress@10': 0.8471, 'time@10': 8.0985}:  10%|█         | 1/10 [00:04<00:36,  4.09s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9418, 'compress@10': 0.5596, 'time@10': 7.5168}:  10%|█         | 1/10 [00:11<00:36,  4.09s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9418, 'compress@10': 0.5596, 'time@10': 7.5168}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9136, 'compress@10': 0.433, 'time@10': 6.8668}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9136, 'compress@10': 0.433, 'time@10': 6.8668}:  30%|███       | 3/10 [00:13<00:31,  4.43s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9257, 'compress@10': 0.5358, 'time@10': 6.6847}:  30%|███       | 3/10 [00:20<00:31,  4.43s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9257, 'compress@10': 0.5358, 'time@10': 6.6847}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9309, 'compress@10': 0.6149, 'time@10': 8.0359}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9309, 'compress@10': 0.6149, 'time@10': 8.0359}:  50%|█████     | 5/10 [00:26<00:28,  5.71s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9383, 'compress@10': 0.6231, 'time@10': 8.4199}:  50%|█████     | 5/10 [00:37<00:28,  5.71s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9383, 'compress@10': 0.6231, 'time@10': 8.4199}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.941, 'compress@10': 0.5894, 'time@10': 8.8112}:  60%|██████    | 6/10 [00:42<00:29,  7.30s/it]  {'epoch': 43, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.941, 'compress@10': 0.5894, 'time@10': 8.8112}:  70%|███████   | 7/10 [00:42<00:20,  6.75s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9502, 'compress@10': 0.5411, 'time@10': 8.6479}:  70%|███████   | 7/10 [00:50<00:20,  6.75s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9502, 'compress@10': 0.5411, 'time@10': 8.6479}:  80%|████████  | 8/10 [00:50<00:13,  7.00s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9613, 'compress@10': 0.5624, 'time@10': 9.2847}:  80%|████████  | 8/10 [00:57<00:13,  7.00s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9613, 'compress@10': 0.5624, 'time@10': 9.2847}:  90%|█████████ | 9/10 [00:57<00:07,  7.07s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.897, 'ndcg@10': 0.963, 'compress@10': 0.5349, 'time@10': 9.3389}:  90%|█████████ | 9/10 [01:07<00:07,  7.07s/it]     {'epoch': 43, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.897, 'ndcg@10': 0.963, 'compress@10': 0.5349, 'time@10': 9.3389}: 100%|██████████| 10/10 [01:07<00:00,  7.93s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.897, 'ndcg@10': 0.963, 'compress@10': 0.5349, 'time@10': 9.3389}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.014412559454286872
Avg hit ratio: 0.8969966289134371
Avg ndcg: 0.9630214594104943
Avg compression ratio: 0.5348533699729969
Avg train time: 9.338925099372863
Std train time: 2.862521776023097
[0.82, 0.2644444444444444, 0.04222222222222222, 0.8199999999999998, 0.9311111111111112, 0.6644444444444445, 0.35333333333333333, 0.1977777777777778, 0.7311111111111109, 0.26444444444444437]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0058, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.8295, 'time@10': 8.1576}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0058, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.934, 'compress@10': 0.8295, 'time@10': 8.1576}:  10%|█         | 1/10 [00:04<00:37,  4.12s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9735, 'compress@10': 0.5588, 'time@10': 7.5478}:  10%|█         | 1/10 [00:11<00:37,  4.12s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9735, 'compress@10': 0.5588, 'time@10': 7.5478}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9347, 'compress@10': 0.4322, 'time@10': 6.9281}:  20%|██        | 2/10 [00:13<00:46,  5.80s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9347, 'compress@10': 0.4322, 'time@10': 6.9281}:  30%|███       | 3/10 [00:13<00:31,  4.47s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9414, 'compress@10': 0.5308, 'time@10': 6.7205}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9414, 'compress@10': 0.5308, 'time@10': 6.7205}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9455, 'compress@10': 0.6111, 'time@10': 7.9939}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9455, 'compress@10': 0.6111, 'time@10': 7.9939}:  50%|█████     | 5/10 [00:26<00:28,  5.65s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9507, 'compress@10': 0.6212, 'time@10': 8.4073}:  50%|█████     | 5/10 [00:37<00:28,  5.65s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9507, 'compress@10': 0.6212, 'time@10': 8.4073}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9514, 'compress@10': 0.5867, 'time@10': 8.7823}:  60%|██████    | 6/10 [00:42<00:29,  7.30s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9514, 'compress@10': 0.5867, 'time@10': 8.7823}:  70%|███████   | 7/10 [00:42<00:20,  6.73s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9482, 'compress@10': 0.5409, 'time@10': 8.6328}:  70%|███████   | 7/10 [00:50<00:20,  6.73s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9482, 'compress@10': 0.5409, 'time@10': 8.6328}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9481, 'compress@10': 0.5629, 'time@10': 9.2591}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9481, 'compress@10': 0.5629, 'time@10': 9.2591}:  90%|█████████ | 9/10 [00:57<00:07,  7.06s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.892, 'ndcg@10': 0.951, 'compress@10': 0.5347, 'time@10': 9.3296}:  90%|█████████ | 9/10 [01:07<00:07,  7.06s/it]     {'epoch': 44, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.892, 'ndcg@10': 0.951, 'compress@10': 0.5347, 'time@10': 9.3296}: 100%|██████████| 10/10 [01:07<00:00,  7.97s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.892, 'ndcg@10': 0.951, 'compress@10': 0.5347, 'time@10': 9.3296}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.011331768168223984
Avg hit ratio: 0.8920299110434934
Avg ndcg: 0.9509912139500065
Avg compression ratio: 0.5347328895157055
Avg train time: 9.329638934135437
Std train time: 2.774480159534107
[0.8021739130434782, 0.28043478260869564, 0.041304347826086954, 0.8239130434782607, 0.932608695652174, 0.65, 0.3456521739130435, 0.21521739130434786, 0.7369565217391303, 0.258695652173913]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9414, 'compress@10': 0.8126, 'time@10': 8.0963}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9414, 'compress@10': 0.8126, 'time@10': 8.0963}:  10%|█         | 1/10 [00:04<00:36,  4.10s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9546, 'compress@10': 0.5581, 'time@10': 7.4734}:  10%|█         | 1/10 [00:10<00:36,  4.10s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9546, 'compress@10': 0.5581, 'time@10': 7.4734}:  20%|██        | 2/10 [00:10<00:45,  5.74s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9221, 'compress@10': 0.4315, 'time@10': 6.856}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9221, 'compress@10': 0.4315, 'time@10': 6.856}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9311, 'compress@10': 0.5312, 'time@10': 6.7351}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9311, 'compress@10': 0.5312, 'time@10': 6.7351}:  40%|████      | 4/10 [00:20<00:31,  5.20s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9374, 'compress@10': 0.6117, 'time@10': 8.1861}:  40%|████      | 4/10 [00:27<00:31,  5.20s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9374, 'compress@10': 0.6117, 'time@10': 8.1861}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.951, 'compress@10': 0.6194, 'time@10': 8.5521}:  50%|█████     | 5/10 [00:37<00:29,  5.86s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.951, 'compress@10': 0.6194, 'time@10': 8.5521}:  60%|██████    | 6/10 [00:37<00:29,  7.41s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9517, 'compress@10': 0.584, 'time@10': 8.8736}:  60%|██████    | 6/10 [00:43<00:29,  7.41s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9517, 'compress@10': 0.584, 'time@10': 8.8736}:  70%|███████   | 7/10 [00:43<00:20,  6.77s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.954, 'compress@10': 0.5407, 'time@10': 8.6958}:  70%|███████   | 7/10 [00:50<00:20,  6.77s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.954, 'compress@10': 0.5407, 'time@10': 8.6958}:  80%|████████  | 8/10 [00:50<00:13,  7.00s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9634, 'compress@10': 0.5634, 'time@10': 9.3141}:  80%|████████  | 8/10 [00:57<00:13,  7.00s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9634, 'compress@10': 0.5634, 'time@10': 9.3141}:  90%|█████████ | 9/10 [00:57<00:07,  7.05s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9626, 'compress@10': 0.5346, 'time@10': 9.4301}:  90%|█████████ | 9/10 [01:08<00:07,  7.05s/it]  {'epoch': 45, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9626, 'compress@10': 0.5346, 'time@10': 9.4301}: 100%|██████████| 10/10 [01:08<00:00,  8.12s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9626, 'compress@10': 0.5346, 'time@10': 9.4301}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.013300609268934468
Avg hit ratio: 0.8873192095585983
Avg ndcg: 0.9625937746901986
Avg compression ratio: 0.534588044950046
Avg train time: 9.430089378356934
Std train time: 2.9019804217103444
[0.7851063829787234, 0.2957446808510638, 0.04042553191489361, 0.8276595744680849, 0.9127659574468086, 0.6574468085106383, 0.3382978723404255, 0.21063829787234045, 0.7425531914893616, 0.27446808510638293]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.943, 'compress@10': 0.7964, 'time@10': 8.1849}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.943, 'compress@10': 0.7964, 'time@10': 8.1849}:  10%|█         | 1/10 [00:04<00:37,  4.13s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9554, 'compress@10': 0.5574, 'time@10': 7.5312}:  10%|█         | 1/10 [00:11<00:37,  4.13s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9554, 'compress@10': 0.5574, 'time@10': 7.5312}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0045, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9226, 'compress@10': 0.4308, 'time@10': 6.9181}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0045, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9226, 'compress@10': 0.4308, 'time@10': 6.9181}:  30%|███       | 3/10 [00:13<00:31,  4.45s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.933, 'compress@10': 0.5315, 'time@10': 6.6544}:  30%|███       | 3/10 [00:19<00:31,  4.45s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.933, 'compress@10': 0.5315, 'time@10': 6.6544}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0068, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9392, 'compress@10': 0.6081, 'time@10': 7.9962}:  40%|████      | 4/10 [00:26<00:30,  5.02s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0068, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9392, 'compress@10': 0.6081, 'time@10': 7.9962}:  50%|█████     | 5/10 [00:26<00:28,  5.63s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9455, 'compress@10': 0.6176, 'time@10': 8.4234}:  50%|█████     | 5/10 [00:37<00:28,  5.63s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9455, 'compress@10': 0.6176, 'time@10': 8.4234}:  60%|██████    | 6/10 [00:37<00:29,  7.32s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9476, 'compress@10': 0.5815, 'time@10': 8.7814}:  60%|██████    | 6/10 [00:42<00:29,  7.32s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9476, 'compress@10': 0.5815, 'time@10': 8.7814}:  70%|███████   | 7/10 [00:42<00:20,  6.73s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9517, 'compress@10': 0.538, 'time@10': 8.6483}:  70%|███████   | 7/10 [00:50<00:20,  6.73s/it]  {'epoch': 46, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9517, 'compress@10': 0.538, 'time@10': 8.6483}:  80%|████████  | 8/10 [00:50<00:14,  7.05s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9527, 'compress@10': 0.5615, 'time@10': 9.2447}:  80%|████████  | 8/10 [00:57<00:14,  7.05s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9527, 'compress@10': 0.5615, 'time@10': 9.2447}:  90%|█████████ | 9/10 [00:57<00:07,  7.05s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0075, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9551, 'compress@10': 0.5345, 'time@10': 9.3109}:  90%|█████████ | 9/10 [01:07<00:07,  7.05s/it]    {'epoch': 46, 'num_users': 6.3, 'loss': 0.0075, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9551, 'compress@10': 0.5345, 'time@10': 9.3109}: 100%|██████████| 10/10 [01:07<00:00,  7.94s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0075, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9551, 'compress@10': 0.5345, 'time@10': 9.3109}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.007496229172555373
Avg hit ratio: 0.893033495272884
Avg ndcg: 0.955117089292278
Avg compression ratio: 0.534457655994813
Avg train time: 9.31086483001709
Std train time: 2.789405455379886
[0.7895833333333333, 0.2895833333333333, 0.03958333333333333, 0.8312499999999998, 0.9145833333333334, 0.64375, 0.3520833333333333, 0.20625000000000002, 0.7479166666666666, 0.26874999999999993]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9463, 'compress@10': 0.8006, 'time@10': 7.9209}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9463, 'compress@10': 0.8006, 'time@10': 7.9209}:  10%|█         | 1/10 [00:04<00:36,  4.01s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0056, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.957, 'compress@10': 0.5566, 'time@10': 7.4633}:  10%|█         | 1/10 [00:11<00:36,  4.01s/it] {'epoch': 47, 'num_users': 7.0, 'loss': 0.0056, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.957, 'compress@10': 0.5566, 'time@10': 7.4633}:  20%|██        | 2/10 [00:11<00:46,  5.79s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9237, 'compress@10': 0.43, 'time@10': 6.8882}:  20%|██        | 2/10 [00:13<00:46,  5.79s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9237, 'compress@10': 0.43, 'time@10': 6.8882}:  30%|███       | 3/10 [00:13<00:31,  4.47s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9339, 'compress@10': 0.5318, 'time@10': 6.678}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9339, 'compress@10': 0.5318, 'time@10': 6.678}:  40%|████      | 4/10 [00:20<00:30,  5.11s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0061, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9397, 'compress@10': 0.6087, 'time@10': 7.9086}:  40%|████      | 4/10 [00:26<00:30,  5.11s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0061, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9397, 'compress@10': 0.6087, 'time@10': 7.9086}:  50%|█████     | 5/10 [00:26<00:27,  5.59s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0067, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9459, 'compress@10': 0.6159, 'time@10': 8.226}:  50%|█████     | 5/10 [00:36<00:27,  5.59s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0067, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9459, 'compress@10': 0.6159, 'time@10': 8.226}:  60%|██████    | 6/10 [00:36<00:28,  7.04s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9471, 'compress@10': 0.5819, 'time@10': 8.5569}:  60%|██████    | 6/10 [00:41<00:28,  7.04s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9471, 'compress@10': 0.5819, 'time@10': 8.5569}:  70%|███████   | 7/10 [00:41<00:19,  6.47s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0084, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9496, 'compress@10': 0.5378, 'time@10': 8.3975}:  70%|███████   | 7/10 [00:48<00:19,  6.47s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0084, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9496, 'compress@10': 0.5378, 'time@10': 8.3975}:  80%|████████  | 8/10 [00:48<00:13,  6.74s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9638, 'compress@10': 0.5619, 'time@10': 8.9548}:  80%|████████  | 8/10 [00:55<00:13,  6.74s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9638, 'compress@10': 0.5619, 'time@10': 8.9548}:  90%|█████████ | 9/10 [00:55<00:06,  6.75s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0114, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.962, 'compress@10': 0.5343, 'time@10': 9.0128}:  90%|█████████ | 9/10 [01:05<00:06,  6.75s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 0.0114, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.962, 'compress@10': 0.5343, 'time@10': 9.0128}: 100%|██████████| 10/10 [01:05<00:00,  7.62s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0114, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.962, 'compress@10': 0.5343, 'time@10': 9.0128}: 100%|██████████| 10/10 [01:05<00:00,  6.53s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.011391047371820296
Avg hit ratio: 0.8941394860562942
Avg ndcg: 0.9620491691573939
Avg compression ratio: 0.5342558444807399
Avg train time: 9.012769865989686
Std train time: 2.5480751540491777
[0.773469387755102, 0.28367346938775506, 0.03877551020408163, 0.8142857142857141, 0.916326530612245, 0.6510204081632653, 0.34489795918367344, 0.22244897959183674, 0.7530612244897958, 0.28367346938775506]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0057, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.943, 'compress@10': 0.7854, 'time@10': 7.9729}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0057, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.943, 'compress@10': 0.7854, 'time@10': 7.9729}:  10%|█         | 1/10 [00:04<00:36,  4.02s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9704, 'compress@10': 0.5461, 'time@10': 7.3175}:  10%|█         | 1/10 [00:10<00:36,  4.02s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9704, 'compress@10': 0.5461, 'time@10': 7.3175}:  20%|██        | 2/10 [00:10<00:44,  5.60s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9327, 'compress@10': 0.4228, 'time@10': 6.6517}:  20%|██        | 2/10 [00:13<00:44,  5.60s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9327, 'compress@10': 0.4228, 'time@10': 6.6517}:  30%|███       | 3/10 [00:13<00:29,  4.27s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9381, 'compress@10': 0.5223, 'time@10': 6.4232}:  30%|███       | 3/10 [00:19<00:29,  4.27s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9381, 'compress@10': 0.5223, 'time@10': 6.4232}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.9429, 'compress@10': 0.6014, 'time@10': 7.6331}:  40%|████      | 4/10 [00:25<00:29,  4.86s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.9429, 'compress@10': 0.6014, 'time@10': 7.6331}:  50%|█████     | 5/10 [00:25<00:26,  5.37s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9485, 'compress@10': 0.611, 'time@10': 8.0105}:  50%|█████     | 5/10 [00:35<00:26,  5.37s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9485, 'compress@10': 0.611, 'time@10': 8.0105}:  60%|██████    | 6/10 [00:35<00:27,  6.92s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9502, 'compress@10': 0.5767, 'time@10': 8.3587}:  60%|██████    | 6/10 [00:40<00:27,  6.92s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9502, 'compress@10': 0.5767, 'time@10': 8.3587}:  70%|███████   | 7/10 [00:40<00:19,  6.38s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9514, 'compress@10': 0.5352, 'time@10': 8.2413}:  70%|███████   | 7/10 [00:48<00:19,  6.38s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9514, 'compress@10': 0.5352, 'time@10': 8.2413}:  80%|████████  | 8/10 [00:48<00:13,  6.72s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9507, 'compress@10': 0.5602, 'time@10': 8.7917}:  80%|████████  | 8/10 [00:54<00:13,  6.72s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9507, 'compress@10': 0.5602, 'time@10': 8.7917}:  90%|█████████ | 9/10 [00:54<00:06,  6.69s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0098, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.9533, 'compress@10': 0.5342, 'time@10': 8.8856}:  90%|█████████ | 9/10 [01:04<00:06,  6.69s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0098, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.9533, 'compress@10': 0.5342, 'time@10': 8.8856}: 100%|██████████| 10/10 [01:04<00:00,  7.64s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0098, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.9533, 'compress@10': 0.5342, 'time@10': 8.8856}: 100%|██████████| 10/10 [01:04<00:00,  6.45s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.009758312318317829
Avg hit ratio: 0.8862362602498426
Avg ndcg: 0.9533287498431001
Avg compression ratio: 0.5341760344916268
Avg train time: 8.885608124732972
Std train time: 2.572366252787035
[0.7579999999999999, 0.298, 0.038, 0.8179999999999997, 0.9180000000000001, 0.638, 0.33799999999999997, 0.238, 0.7579999999999999, 0.27799999999999997]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9414, 'compress@10': 0.7707, 'time@10': 9.1336}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9414, 'compress@10': 0.7707, 'time@10': 9.1336}:  10%|█         | 1/10 [00:04<00:41,  4.60s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9545, 'compress@10': 0.5457, 'time@10': 7.9106}:  10%|█         | 1/10 [00:11<00:41,  4.60s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9545, 'compress@10': 0.5457, 'time@10': 7.9106}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.922, 'compress@10': 0.4223, 'time@10': 7.0032}:  20%|██        | 2/10 [00:13<00:46,  5.85s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.922, 'compress@10': 0.4223, 'time@10': 7.0032}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9313, 'compress@10': 0.5228, 'time@10': 6.6369}:  30%|███       | 3/10 [00:19<00:30,  4.38s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9313, 'compress@10': 0.5228, 'time@10': 6.6369}:  40%|████      | 4/10 [00:19<00:29,  4.85s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9376, 'compress@10': 0.6022, 'time@10': 7.693}:  40%|████      | 4/10 [00:25<00:29,  4.85s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9376, 'compress@10': 0.6022, 'time@10': 7.693}:  50%|█████     | 5/10 [00:25<00:26,  5.26s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9444, 'compress@10': 0.6095, 'time@10': 7.9619}:  50%|█████     | 5/10 [00:34<00:26,  5.26s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9444, 'compress@10': 0.6095, 'time@10': 7.9619}:  60%|██████    | 6/10 [00:34<00:26,  6.65s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9457, 'compress@10': 0.5745, 'time@10': 8.1652}:  60%|██████    | 6/10 [00:39<00:26,  6.65s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9457, 'compress@10': 0.5745, 'time@10': 8.1652}:  70%|███████   | 7/10 [00:39<00:18,  6.02s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9489, 'compress@10': 0.5352, 'time@10': 8.0596}:  70%|███████   | 7/10 [00:46<00:18,  6.02s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9489, 'compress@10': 0.5352, 'time@10': 8.0596}:  80%|████████  | 8/10 [00:46<00:12,  6.46s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9586, 'compress@10': 0.5607, 'time@10': 8.6009}:  80%|████████  | 8/10 [00:53<00:12,  6.46s/it] {'epoch': 49, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9586, 'compress@10': 0.5607, 'time@10': 8.6009}:  90%|█████████ | 9/10 [00:53<00:06,  6.47s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9576, 'compress@10': 0.5341, 'time@10': 8.6454}:  90%|█████████ | 9/10 [01:02<00:06,  6.47s/it] {'epoch': 49, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9576, 'compress@10': 0.5341, 'time@10': 8.6454}: 100%|██████████| 10/10 [01:02<00:00,  7.28s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9576, 'compress@10': 0.5341, 'time@10': 8.6454}: 100%|██████████| 10/10 [01:02<00:00,  6.26s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.011110791387989944
Avg hit ratio: 0.8841164445816398
Avg ndcg: 0.9576444231660345
Avg compression ratio: 0.534053657295089
Avg train time: 8.645399332046509
Std train time: 2.400990201211045
[0.7431372549019607, 0.31176470588235294, 0.03725490196078431, 0.8215686274509801, 0.9196078431372551, 0.6254901960784314, 0.33137254901960783, 0.23333333333333334, 0.7627450980392155, 0.292156862745098]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
