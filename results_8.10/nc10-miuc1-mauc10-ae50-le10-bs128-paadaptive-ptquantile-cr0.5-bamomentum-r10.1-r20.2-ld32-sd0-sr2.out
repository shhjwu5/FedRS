  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1752, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5112, 'compress@10': 0.5263, 'time@10': 9.7117}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1752, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5112, 'compress@10': 0.5263, 'time@10': 9.7117}:  10%|█         | 1/10 [00:04<00:44,  4.90s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1279, 'hit_ratio@10': 0.6341, 'ndcg@10': 0.6329, 'compress@10': 0.5212, 'time@10': 8.4634}:  10%|█         | 1/10 [00:12<00:44,  4.90s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1279, 'hit_ratio@10': 0.6341, 'ndcg@10': 0.6329, 'compress@10': 0.5212, 'time@10': 8.4634}:  20%|██        | 2/10 [00:12<00:50,  6.28s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.847, 'hit_ratio@10': 0.6608, 'ndcg@10': 0.422, 'compress@10': 0.538, 'time@10': 6.5869}:  20%|██        | 2/10 [00:13<00:50,  6.28s/it]   {'epoch': 0, 'num_users': 5.0, 'loss': 0.847, 'hit_ratio@10': 0.6608, 'ndcg@10': 0.422, 'compress@10': 0.538, 'time@10': 6.5869}:  30%|███       | 3/10 [00:13<00:28,  4.08s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6619, 'hit_ratio@10': 0.701, 'ndcg@10': 0.4686, 'compress@10': 0.5329, 'time@10': 6.5727}:  30%|███       | 3/10 [00:20<00:28,  4.08s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6619, 'hit_ratio@10': 0.701, 'ndcg@10': 0.4686, 'compress@10': 0.5329, 'time@10': 6.5727}:  40%|████      | 4/10 [00:20<00:30,  5.06s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5483, 'hit_ratio@10': 0.7248, 'ndcg@10': 0.5227, 'compress@10': 0.5283, 'time@10': 10.013}:  40%|████      | 4/10 [00:32<00:30,  5.06s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5483, 'hit_ratio@10': 0.7248, 'ndcg@10': 0.5227, 'compress@10': 0.5283, 'time@10': 10.013}:  50%|█████     | 5/10 [00:32<00:37,  7.54s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4714, 'hit_ratio@10': 0.7188, 'ndcg@10': 0.5646, 'compress@10': 0.5255, 'time@10': 10.1485}:  50%|█████     | 5/10 [00:42<00:37,  7.54s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4714, 'hit_ratio@10': 0.7188, 'ndcg@10': 0.5646, 'compress@10': 0.5255, 'time@10': 10.1485}:  60%|██████    | 6/10 [00:42<00:34,  8.67s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4207, 'hit_ratio@10': 0.719, 'ndcg@10': 0.5665, 'compress@10': 0.5247, 'time@10': 10.3464}:  60%|██████    | 6/10 [00:48<00:34,  8.67s/it] {'epoch': 0, 'num_users': 6.2857, 'loss': 0.4207, 'hit_ratio@10': 0.719, 'ndcg@10': 0.5665, 'compress@10': 0.5247, 'time@10': 10.3464}:  70%|███████   | 7/10 [00:48<00:23,  7.73s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3744, 'hit_ratio@10': 0.7434, 'ndcg@10': 0.5941, 'compress@10': 0.5234, 'time@10': 10.0658}:  70%|███████   | 7/10 [00:56<00:23,  7.73s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3744, 'hit_ratio@10': 0.7434, 'ndcg@10': 0.5941, 'compress@10': 0.5234, 'time@10': 10.0658}:  80%|████████  | 8/10 [00:56<00:15,  7.86s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.339, 'hit_ratio@10': 0.7529, 'ndcg@10': 0.6282, 'compress@10': 0.5224, 'time@10': 10.7623}:  80%|████████  | 8/10 [01:05<00:15,  7.86s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.339, 'hit_ratio@10': 0.7529, 'ndcg@10': 0.6282, 'compress@10': 0.5224, 'time@10': 10.7623}:  90%|█████████ | 9/10 [01:05<00:07,  7.97s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3104, 'hit_ratio@10': 0.7708, 'ndcg@10': 0.6497, 'compress@10': 0.5213, 'time@10': 10.729}:  90%|█████████ | 9/10 [01:15<00:07,  7.97s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3104, 'hit_ratio@10': 0.7708, 'ndcg@10': 0.6497, 'compress@10': 0.5213, 'time@10': 10.729}: 100%|██████████| 10/10 [01:15<00:00,  8.74s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3104, 'hit_ratio@10': 0.7708, 'ndcg@10': 0.6497, 'compress@10': 0.5213, 'time@10': 10.729}: 100%|██████████| 10/10 [01:15<00:00,  7.56s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.31042035606059565
Avg hit ratio: 0.7707529772623152
Avg ndcg: 0.649660087497602
Avg compression ratio: 0.5212749006657823
Avg train time: 10.729042482376098
Std train time: 5.5007917975529725
[0.75, 0.25, 0.75, 0.75, 0.75, 0.25, 0.75, 0.25, 0.25, 0.25]
[10, 11, 11, 11, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.056, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8368, 'compress@10': 0.7632, 'time@10': 8.9056}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.056, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8368, 'compress@10': 0.7632, 'time@10': 8.9056}:  10%|█         | 1/10 [00:04<00:40,  4.49s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0542, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8461, 'compress@10': 0.5187, 'time@10': 8.3364}:  10%|█         | 1/10 [00:12<00:40,  4.49s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0542, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8461, 'compress@10': 0.5187, 'time@10': 8.3364}:  20%|██        | 2/10 [00:12<00:51,  6.44s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.044, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.8153, 'compress@10': 0.6077, 'time@10': 6.5596}:  20%|██        | 2/10 [00:13<00:51,  6.44s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.044, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.8153, 'compress@10': 0.6077, 'time@10': 6.5596}:  30%|███       | 3/10 [00:13<00:29,  4.20s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0454, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8222, 'compress@10': 0.6455, 'time@10': 6.6613}:  30%|███       | 3/10 [00:20<00:29,  4.20s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0454, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8222, 'compress@10': 0.6455, 'time@10': 6.6613}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0541, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8142, 'compress@10': 0.6674, 'time@10': 9.0628}:  40%|████      | 4/10 [00:30<00:31,  5.31s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0541, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8142, 'compress@10': 0.6674, 'time@10': 9.0628}:  50%|█████     | 5/10 [00:30<00:34,  6.84s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0578, 'hit_ratio@10': 0.7877, 'ndcg@10': 0.814, 'compress@10': 0.6006, 'time@10': 9.3091}:  50%|█████     | 5/10 [00:40<00:34,  6.84s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0578, 'hit_ratio@10': 0.7877, 'ndcg@10': 0.814, 'compress@10': 0.6006, 'time@10': 9.3091}:  60%|██████    | 6/10 [00:40<00:32,  8.11s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0558, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8226, 'compress@10': 0.6234, 'time@10': 9.5968}:  60%|██████    | 6/10 [00:46<00:32,  8.11s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0558, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8226, 'compress@10': 0.6234, 'time@10': 9.5968}:  70%|███████   | 7/10 [00:46<00:21,  7.32s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0535, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8288, 'compress@10': 0.5794, 'time@10': 9.3976}:  70%|███████   | 7/10 [00:54<00:21,  7.32s/it]  {'epoch': 1, 'num_users': 6.125, 'loss': 0.0535, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8288, 'compress@10': 0.5794, 'time@10': 9.3976}:  80%|████████  | 8/10 [00:54<00:15,  7.55s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0516, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8383, 'compress@10': 0.5452, 'time@10': 9.9846}:  80%|████████  | 8/10 [01:02<00:15,  7.55s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0516, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8383, 'compress@10': 0.5452, 'time@10': 9.9846}:  90%|█████████ | 9/10 [01:02<00:07,  7.50s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.051, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8391, 'compress@10': 0.5174, 'time@10': 10.0148}:  90%|█████████ | 9/10 [01:12<00:07,  7.50s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.051, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8391, 'compress@10': 0.5174, 'time@10': 10.0148}: 100%|██████████| 10/10 [01:12<00:00,  8.37s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.051, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8391, 'compress@10': 0.5174, 'time@10': 10.0148}: 100%|██████████| 10/10 [01:12<00:00,  7.24s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.0509746303975893
Avg hit ratio: 0.8246381741254407
Avg ndcg: 0.8390909105918489
Avg compression ratio: 0.5173536057362524
Avg train time: 10.014823317527771
Std train time: 4.0923276044101105
[0.8333333333333334, 0.5, 0.5, 0.8333333333333334, 0.8333333333333334, 0.5, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[10, 12, 12, 12, 7, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.8421, 'time@10': 8.7255}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.8421, 'time@10': 8.7255}:  10%|█         | 1/10 [00:04<00:39,  4.40s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8472, 'compress@10': 0.6791, 'time@10': 8.6881}:  10%|█         | 1/10 [00:13<00:39,  4.40s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8472, 'compress@10': 0.6791, 'time@10': 8.6881}:  20%|██        | 2/10 [00:13<00:55,  6.92s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8483, 'compress@10': 0.6432, 'time@10': 6.9407}:  20%|██        | 2/10 [00:14<00:55,  6.92s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8483, 'compress@10': 0.6432, 'time@10': 6.9407}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8482, 'compress@10': 0.6922, 'time@10': 7.0574}:  30%|███       | 3/10 [00:22<00:31,  4.57s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0372, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8482, 'compress@10': 0.6922, 'time@10': 7.0574}:  40%|████      | 4/10 [00:22<00:34,  5.71s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8354, 'compress@10': 0.7211, 'time@10': 8.8637}:  40%|████      | 4/10 [00:30<00:34,  5.71s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8354, 'compress@10': 0.7211, 'time@10': 8.8637}:  50%|█████     | 5/10 [00:30<00:32,  6.56s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0519, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.8327, 'compress@10': 0.6861, 'time@10': 9.1519}:  50%|█████     | 5/10 [00:41<00:32,  6.56s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0519, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.8327, 'compress@10': 0.6861, 'time@10': 9.1519}:  60%|██████    | 6/10 [00:41<00:31,  7.95s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.8362, 'compress@10': 0.6624, 'time@10': 9.5166}:  60%|██████    | 6/10 [00:46<00:31,  7.95s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.8362, 'compress@10': 0.6624, 'time@10': 9.5166}:  70%|███████   | 7/10 [00:46<00:21,  7.27s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0493, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8395, 'compress@10': 0.6034, 'time@10': 9.4296}:  70%|███████   | 7/10 [00:55<00:21,  7.27s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0493, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8395, 'compress@10': 0.6034, 'time@10': 9.4296}:  80%|████████  | 8/10 [00:55<00:15,  7.78s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0479, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8492, 'compress@10': 0.5575, 'time@10': 9.7926}:  80%|████████  | 8/10 [01:02<00:15,  7.78s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0479, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8492, 'compress@10': 0.5575, 'time@10': 9.7926}:  90%|█████████ | 9/10 [01:02<00:07,  7.35s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8494, 'compress@10': 0.5203, 'time@10': 9.8244}:  90%|█████████ | 9/10 [01:12<00:07,  7.35s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8494, 'compress@10': 0.5203, 'time@10': 9.8244}: 100%|██████████| 10/10 [01:12<00:00,  8.21s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8494, 'compress@10': 0.5203, 'time@10': 9.8244}: 100%|██████████| 10/10 [01:12<00:00,  7.23s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.047450767637244394
Avg hit ratio: 0.8241870463058918
Avg ndcg: 0.8493812498057602
Avg compression ratio: 0.5203258619914365
Avg train time: 9.824378061294556
Std train time: 3.1907780532782692
[0.875, 0.625, 0.375, 0.875, 0.875, 0.625, 0.375, 0.125, 0.125, 0.125]
[10, 12, 13, 13, 6, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.8816, 'time@10': 8.3649}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.8816, 'time@10': 8.3649}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8489, 'compress@10': 0.7593, 'time@10': 8.6038}:  10%|█         | 1/10 [00:13<00:37,  4.22s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8489, 'compress@10': 0.7593, 'time@10': 8.6038}:  20%|██        | 2/10 [00:13<00:55,  6.96s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8517, 'compress@10': 0.661, 'time@10': 6.9586}:  20%|██        | 2/10 [00:14<00:55,  6.96s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8517, 'compress@10': 0.661, 'time@10': 6.9586}:  30%|███       | 3/10 [00:14<00:32,  4.64s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8508, 'compress@10': 0.7156, 'time@10': 7.2322}:  30%|███       | 3/10 [00:23<00:32,  4.64s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8508, 'compress@10': 0.7156, 'time@10': 7.2322}:  40%|████      | 4/10 [00:23<00:36,  6.00s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8374, 'compress@10': 0.748, 'time@10': 8.51}:  40%|████      | 4/10 [00:29<00:36,  6.00s/it]   {'epoch': 3, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8374, 'compress@10': 0.748, 'time@10': 8.51}:  50%|█████     | 5/10 [00:29<00:31,  6.31s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0498, 'hit_ratio@10': 0.7969, 'ndcg@10': 0.8352, 'compress@10': 0.7289, 'time@10': 8.8763}:  50%|█████     | 5/10 [00:40<00:31,  6.31s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0498, 'hit_ratio@10': 0.7969, 'ndcg@10': 0.8352, 'compress@10': 0.7289, 'time@10': 8.8763}:  60%|██████    | 6/10 [00:40<00:31,  7.82s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0494, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8365, 'compress@10': 0.6819, 'time@10': 9.2672}:  60%|██████    | 6/10 [00:46<00:31,  7.82s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0494, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8365, 'compress@10': 0.6819, 'time@10': 9.2672}:  70%|███████   | 7/10 [00:46<00:21,  7.17s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8422, 'compress@10': 0.6154, 'time@10': 9.2097}:  70%|███████   | 7/10 [00:55<00:21,  7.17s/it]   {'epoch': 3, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8422, 'compress@10': 0.6154, 'time@10': 9.2097}:  80%|████████  | 8/10 [00:55<00:15,  7.70s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0501, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8517, 'compress@10': 0.5637, 'time@10': 9.5882}:  80%|████████  | 8/10 [01:01<00:15,  7.70s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0501, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8517, 'compress@10': 0.5637, 'time@10': 9.5882}:  90%|█████████ | 9/10 [01:01<00:07,  7.28s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8516, 'compress@10': 0.5218, 'time@10': 9.5891}:  90%|█████████ | 9/10 [01:11<00:07,  7.28s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8516, 'compress@10': 0.5218, 'time@10': 9.5891}: 100%|██████████| 10/10 [01:11<00:00,  8.01s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8516, 'compress@10': 0.5218, 'time@10': 9.5891}: 100%|██████████| 10/10 [01:11<00:00,  7.13s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04954459610058843
Avg hit ratio: 0.8416350749797269
Avg ndcg: 0.8515708034607353
Avg compression ratio: 0.5218117100145918
Avg train time: 9.58910083770752
Std train time: 2.6618788462608967
[0.7, 0.7, 0.3, 0.7, 0.9, 0.7, 0.5, 0.3, 0.1, 0.1]
[10, 12, 14, 13, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 0.7158, 'time@10': 8.7797}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 0.7158, 'time@10': 8.7797}:  10%|█         | 1/10 [00:04<00:39,  4.43s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.854, 'compress@10': 0.7127, 'time@10': 8.6604}:  10%|█         | 1/10 [00:13<00:39,  4.43s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.854, 'compress@10': 0.7127, 'time@10': 8.6604}:  20%|██        | 2/10 [00:13<00:54,  6.87s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8551, 'compress@10': 0.6085, 'time@10': 7.1334}:  20%|██        | 2/10 [00:15<00:54,  6.87s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8551, 'compress@10': 0.6085, 'time@10': 7.1334}:  30%|███       | 3/10 [00:15<00:32,  4.68s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8495, 'compress@10': 0.634, 'time@10': 7.4379}:  30%|███       | 3/10 [00:23<00:32,  4.68s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8495, 'compress@10': 0.634, 'time@10': 7.4379}:  40%|████      | 4/10 [00:23<00:36,  6.14s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8347, 'compress@10': 0.6876, 'time@10': 8.1952}:  40%|████      | 4/10 [00:29<00:36,  6.14s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8347, 'compress@10': 0.6876, 'time@10': 8.1952}:  50%|█████     | 5/10 [00:29<00:29,  5.96s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0506, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8332, 'compress@10': 0.6908, 'time@10': 8.6314}:  50%|█████     | 5/10 [00:39<00:29,  5.96s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0506, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8332, 'compress@10': 0.6908, 'time@10': 8.6314}:  60%|██████    | 6/10 [00:39<00:30,  7.63s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8328, 'compress@10': 0.6664, 'time@10': 9.109}:  60%|██████    | 6/10 [00:45<00:30,  7.63s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8328, 'compress@10': 0.6664, 'time@10': 9.109}:  70%|███████   | 7/10 [00:45<00:21,  7.10s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8382, 'compress@10': 0.6231, 'time@10': 9.0907}:  70%|███████   | 7/10 [00:54<00:21,  7.10s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8382, 'compress@10': 0.6231, 'time@10': 9.0907}:  80%|████████  | 8/10 [00:54<00:15,  7.71s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.847, 'compress@10': 0.5678, 'time@10': 9.4446}:  80%|████████  | 8/10 [01:01<00:15,  7.71s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.847, 'compress@10': 0.5678, 'time@10': 9.4446}:  90%|█████████ | 9/10 [01:01<00:07,  7.23s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8472, 'compress@10': 0.5231, 'time@10': 9.4576}:  90%|█████████ | 9/10 [01:10<00:07,  7.23s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8472, 'compress@10': 0.5231, 'time@10': 9.4576}: 100%|██████████| 10/10 [01:10<00:00,  7.96s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.049, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8472, 'compress@10': 0.5231, 'time@10': 9.4576}: 100%|██████████| 10/10 [01:10<00:00,  7.08s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.049031142383066675
Avg hit ratio: 0.8515910401614987
Avg ndcg: 0.8471887497231272
Avg compression ratio: 0.5230983367592061
Avg train time: 9.457620978355408
Std train time: 2.2569929182515946
[0.5833333333333333, 0.5833333333333333, 0.25, 0.75, 0.9166666666666667, 0.75, 0.5833333333333334, 0.41666666666666663, 0.08333333333333334, 0.08333333333333334]
[10, 12, 15, 13, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8533, 'compress@10': 0.6053, 'time@10': 9.0447}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8533, 'compress@10': 0.6053, 'time@10': 9.0447}:  10%|█         | 1/10 [00:04<00:41,  4.56s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0443, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8635, 'compress@10': 0.601, 'time@10': 8.8622}:  10%|█         | 1/10 [00:13<00:41,  4.56s/it] {'epoch': 5, 'num_users': 7.0, 'loss': 0.0443, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8635, 'compress@10': 0.601, 'time@10': 8.8622}:  20%|██        | 2/10 [00:13<00:56,  7.01s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8614, 'compress@10': 0.5197, 'time@10': 7.2678}:  20%|██        | 2/10 [00:15<00:56,  7.01s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8614, 'compress@10': 0.5197, 'time@10': 7.2678}:  30%|███       | 3/10 [00:15<00:33,  4.75s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8437, 'compress@10': 0.5795, 'time@10': 7.455}:  30%|███       | 3/10 [00:23<00:33,  4.75s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0368, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8437, 'compress@10': 0.5795, 'time@10': 7.455}:  40%|████      | 4/10 [00:23<00:36,  6.06s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0467, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8302, 'compress@10': 0.6473, 'time@10': 8.2052}:  40%|████      | 4/10 [00:29<00:36,  6.06s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0467, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8302, 'compress@10': 0.6473, 'time@10': 8.2052}:  50%|█████     | 5/10 [00:29<00:29,  5.91s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.049, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8304, 'compress@10': 0.6653, 'time@10': 8.5989}:  50%|█████     | 5/10 [00:39<00:29,  5.91s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.049, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8304, 'compress@10': 0.6653, 'time@10': 8.5989}:  60%|██████    | 6/10 [00:39<00:30,  7.50s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8317, 'compress@10': 0.656, 'time@10': 9.0149}:  60%|██████    | 6/10 [00:45<00:30,  7.50s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8317, 'compress@10': 0.656, 'time@10': 9.0149}:  70%|███████   | 7/10 [00:45<00:20,  6.94s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0476, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8291, 'compress@10': 0.6282, 'time@10': 9.0068}:  70%|███████   | 7/10 [00:54<00:20,  6.94s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0476, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8291, 'compress@10': 0.6282, 'time@10': 9.0068}:  80%|████████  | 8/10 [00:54<00:15,  7.59s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0463, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.8415, 'compress@10': 0.5705, 'time@10': 9.3247}:  80%|████████  | 8/10 [01:00<00:15,  7.59s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0463, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.8415, 'compress@10': 0.5705, 'time@10': 9.3247}:  90%|█████████ | 9/10 [01:00<00:07,  7.09s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0455, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8425, 'compress@10': 0.5239, 'time@10': 9.3956}:  90%|█████████ | 9/10 [01:10<00:07,  7.09s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0455, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8425, 'compress@10': 0.5239, 'time@10': 9.3956}: 100%|██████████| 10/10 [01:10<00:00,  8.01s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0455, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8425, 'compress@10': 0.5239, 'time@10': 9.3956}: 100%|██████████| 10/10 [01:10<00:00,  7.05s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.045485597399235425
Avg hit ratio: 0.8543053258757842
Avg ndcg: 0.8425128517416658
Avg compression ratio: 0.5238999204097793
Avg train time: 9.395553255081177
Std train time: 2.1597824562096197
[0.6428571428571428, 0.49999999999999994, 0.2142857142857143, 0.7857142857142857, 0.9285714285714286, 0.7857142857142857, 0.6428571428571429, 0.3571428571428571, 0.07142857142857144, 0.07142857142857144]
[10, 12, 16, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8543, 'compress@10': 0.6616, 'time@10': 9.0757}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8543, 'compress@10': 0.6616, 'time@10': 9.0757}:  10%|█         | 1/10 [00:04<00:41,  4.57s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0428, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8695, 'compress@10': 0.5889, 'time@10': 8.879}:  10%|█         | 1/10 [00:13<00:41,  4.57s/it] {'epoch': 6, 'num_users': 7.0, 'loss': 0.0428, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8695, 'compress@10': 0.5889, 'time@10': 8.879}:  20%|██        | 2/10 [00:13<00:56,  7.01s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8654, 'compress@10': 0.5014, 'time@10': 7.371}:  20%|██        | 2/10 [00:15<00:56,  7.01s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8654, 'compress@10': 0.5014, 'time@10': 7.371}:  30%|███       | 3/10 [00:15<00:33,  4.82s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.866, 'compress@10': 0.5744, 'time@10': 7.7233}:  30%|███       | 3/10 [00:24<00:33,  4.82s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.866, 'compress@10': 0.5744, 'time@10': 7.7233}:  40%|████      | 4/10 [00:24<00:38,  6.40s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0443, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8482, 'compress@10': 0.6455, 'time@10': 8.4073}:  40%|████      | 4/10 [00:29<00:38,  6.40s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0443, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8482, 'compress@10': 0.6455, 'time@10': 8.4073}:  50%|█████     | 5/10 [00:29<00:30,  6.11s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0463, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8457, 'compress@10': 0.6697, 'time@10': 8.7848}:  50%|█████     | 5/10 [00:40<00:30,  6.11s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0463, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8457, 'compress@10': 0.6697, 'time@10': 8.7848}:  60%|██████    | 6/10 [00:40<00:30,  7.68s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0455, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8466, 'compress@10': 0.6679, 'time@10': 9.1604}:  60%|██████    | 6/10 [00:46<00:30,  7.68s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0455, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8466, 'compress@10': 0.6679, 'time@10': 9.1604}:  70%|███████   | 7/10 [00:46<00:21,  7.05s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0443, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.8501, 'compress@10': 0.6313, 'time@10': 9.1194}:  70%|███████   | 7/10 [00:55<00:21,  7.05s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0443, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.8501, 'compress@10': 0.6313, 'time@10': 9.1194}:  80%|████████  | 8/10 [00:55<00:15,  7.63s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0442, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8569, 'compress@10': 0.5721, 'time@10': 9.407}:  80%|████████  | 8/10 [01:01<00:15,  7.63s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0442, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8569, 'compress@10': 0.5721, 'time@10': 9.407}:  90%|█████████ | 9/10 [01:01<00:07,  7.08s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0437, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8572, 'compress@10': 0.5241, 'time@10': 9.439}:  90%|█████████ | 9/10 [01:10<00:07,  7.08s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0437, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8572, 'compress@10': 0.5241, 'time@10': 9.439}: 100%|██████████| 10/10 [01:10<00:00,  7.92s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0437, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8572, 'compress@10': 0.5241, 'time@10': 9.439}: 100%|██████████| 10/10 [01:10<00:00,  7.09s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04368036981183365
Avg hit ratio: 0.8683082118786702
Avg ndcg: 0.8572352743999891
Avg compression ratio: 0.5241271266381131
Avg train time: 9.439007902145386
Std train time: 2.022663516193782
[0.6875, 0.43749999999999994, 0.1875, 0.8125, 0.9375, 0.8125, 0.5625, 0.31249999999999994, 0.1875, 0.06250000000000001]
[10, 12, 17, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.7039, 'time@10': 8.6485}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.7039, 'time@10': 8.6485}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0413, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8741, 'compress@10': 0.5798, 'time@10': 8.8228}:  10%|█         | 1/10 [00:13<00:39,  4.36s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0413, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8741, 'compress@10': 0.5798, 'time@10': 8.8228}:  20%|██        | 2/10 [00:13<00:56,  7.11s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8684, 'compress@10': 0.4877, 'time@10': 7.3718}:  20%|██        | 2/10 [00:15<00:56,  7.11s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8684, 'compress@10': 0.4877, 'time@10': 7.3718}:  30%|███       | 3/10 [00:15<00:34,  4.90s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8807, 'compress@10': 0.5706, 'time@10': 7.7249}:  30%|███       | 3/10 [00:24<00:34,  4.90s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8807, 'compress@10': 0.5706, 'time@10': 7.7249}:  40%|████      | 4/10 [00:24<00:38,  6.45s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0423, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8606, 'compress@10': 0.6442, 'time@10': 8.423}:  40%|████      | 4/10 [00:30<00:38,  6.45s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.0423, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8606, 'compress@10': 0.6442, 'time@10': 8.423}:  50%|█████     | 5/10 [00:30<00:30,  6.16s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0439, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8574, 'compress@10': 0.673, 'time@10': 8.747}:  50%|█████     | 5/10 [00:40<00:30,  6.16s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0439, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8574, 'compress@10': 0.673, 'time@10': 8.747}:  60%|██████    | 6/10 [00:40<00:30,  7.60s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0429, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8578, 'compress@10': 0.6597, 'time@10': 9.1234}:  60%|██████    | 6/10 [00:46<00:30,  7.60s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0429, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8578, 'compress@10': 0.6597, 'time@10': 9.1234}:  70%|███████   | 7/10 [00:46<00:20,  6.99s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0443, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8637, 'compress@10': 0.6187, 'time@10': 9.0965}:  70%|███████   | 7/10 [00:55<00:20,  6.99s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0443, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8637, 'compress@10': 0.6187, 'time@10': 9.0965}:  80%|████████  | 8/10 [00:55<00:15,  7.61s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0439, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8707, 'compress@10': 0.5734, 'time@10': 9.4518}:  80%|████████  | 8/10 [01:01<00:15,  7.61s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0439, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8707, 'compress@10': 0.5734, 'time@10': 9.4518}:  90%|█████████ | 9/10 [01:01<00:07,  7.17s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0429, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.8708, 'compress@10': 0.5244, 'time@10': 9.484}:  90%|█████████ | 9/10 [01:11<00:07,  7.17s/it]    {'epoch': 7, 'num_users': 6.3, 'loss': 0.0429, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.8708, 'compress@10': 0.5244, 'time@10': 9.484}: 100%|██████████| 10/10 [01:11<00:00,  7.98s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0429, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.8708, 'compress@10': 0.5244, 'time@10': 9.484}: 100%|██████████| 10/10 [01:11<00:00,  7.12s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.0428879246429959
Avg hit ratio: 0.864491519610365
Avg ndcg: 0.8707965987602171
Avg compression ratio: 0.5244412897657929
Avg train time: 9.48403570652008
Std train time: 2.055621439296529
[0.7222222222222222, 0.38888888888888884, 0.16666666666666666, 0.8333333333333334, 0.9444444444444444, 0.8333333333333334, 0.5, 0.38888888888888884, 0.16666666666666666, 0.055555555555555566]
[10, 12, 18, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.7368, 'time@10': 8.5207}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.7368, 'time@10': 8.5207}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8744, 'compress@10': 0.5727, 'time@10': 8.5551}:  10%|█         | 1/10 [00:12<00:38,  4.30s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0387, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8744, 'compress@10': 0.5727, 'time@10': 8.5551}:  20%|██        | 2/10 [00:12<00:54,  6.85s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8686, 'compress@10': 0.4771, 'time@10': 7.3587}:  20%|██        | 2/10 [00:15<00:54,  6.85s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8686, 'compress@10': 0.4771, 'time@10': 7.3587}:  30%|███       | 3/10 [00:15<00:34,  4.87s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.877, 'compress@10': 0.5676, 'time@10': 7.7355}:  30%|███       | 3/10 [00:24<00:34,  4.87s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.877, 'compress@10': 0.5676, 'time@10': 7.7355}:  40%|████      | 4/10 [00:24<00:38,  6.46s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0393, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8582, 'compress@10': 0.6432, 'time@10': 8.4584}:  40%|████      | 4/10 [00:30<00:38,  6.46s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0393, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8582, 'compress@10': 0.6432, 'time@10': 8.4584}:  50%|█████     | 5/10 [00:30<00:30,  6.20s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0406, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.858, 'compress@10': 0.6755, 'time@10': 8.784}:  50%|█████     | 5/10 [00:40<00:30,  6.20s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0406, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.858, 'compress@10': 0.6755, 'time@10': 8.784}:  60%|██████    | 6/10 [00:40<00:30,  7.64s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0401, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8594, 'compress@10': 0.6533, 'time@10': 9.1699}:  60%|██████    | 6/10 [00:46<00:30,  7.64s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0401, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8594, 'compress@10': 0.6533, 'time@10': 9.1699}:  70%|███████   | 7/10 [00:46<00:21,  7.03s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0403, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8613, 'compress@10': 0.6224, 'time@10': 9.1547}:  70%|███████   | 7/10 [00:55<00:21,  7.03s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0403, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8613, 'compress@10': 0.6224, 'time@10': 9.1547}:  80%|████████  | 8/10 [00:55<00:15,  7.69s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0405, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.869, 'compress@10': 0.5744, 'time@10': 9.5007}:  80%|████████  | 8/10 [01:01<00:15,  7.69s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0405, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.869, 'compress@10': 0.5744, 'time@10': 9.5007}:  90%|█████████ | 9/10 [01:01<00:07,  7.21s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0403, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8693, 'compress@10': 0.5247, 'time@10': 9.5132}:  90%|█████████ | 9/10 [01:11<00:07,  7.21s/it]  {'epoch': 8, 'num_users': 6.3, 'loss': 0.0403, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8693, 'compress@10': 0.5247, 'time@10': 9.5132}: 100%|██████████| 10/10 [01:11<00:00,  7.97s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0403, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8693, 'compress@10': 0.5247, 'time@10': 9.5132}: 100%|██████████| 10/10 [01:11<00:00,  7.12s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04033375671830059
Avg hit ratio: 0.8673046276492796
Avg ndcg: 0.8693087770256946
Avg compression ratio: 0.5246853611345466
Avg train time: 9.513179683685303
Std train time: 1.9705244758680465
[0.75, 0.35, 0.15, 0.75, 0.95, 0.8500000000000001, 0.45, 0.44999999999999996, 0.25, 0.05000000000000001]
[10, 12, 19, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8545, 'compress@10': 0.7632, 'time@10': 8.6401}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8545, 'compress@10': 0.7632, 'time@10': 8.6401}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0382, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8746, 'compress@10': 0.5671, 'time@10': 8.6485}:  10%|█         | 1/10 [00:13<00:39,  4.36s/it] {'epoch': 9, 'num_users': 7.0, 'loss': 0.0382, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8746, 'compress@10': 0.5671, 'time@10': 8.6485}:  20%|██        | 2/10 [00:13<00:55,  6.91s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8688, 'compress@10': 0.4685, 'time@10': 7.4939}:  20%|██        | 2/10 [00:15<00:55,  6.91s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8688, 'compress@10': 0.4685, 'time@10': 7.4939}:  30%|███       | 3/10 [00:15<00:34,  4.96s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.877, 'compress@10': 0.5411, 'time@10': 7.8428}:  30%|███       | 3/10 [00:24<00:34,  4.96s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.877, 'compress@10': 0.5411, 'time@10': 7.8428}:  40%|████      | 4/10 [00:24<00:39,  6.53s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0393, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8583, 'compress@10': 0.6231, 'time@10': 8.4313}:  40%|████      | 4/10 [00:30<00:39,  6.53s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0393, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8583, 'compress@10': 0.6231, 'time@10': 8.4313}:  50%|█████     | 5/10 [00:30<00:30,  6.13s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0398, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8588, 'compress@10': 0.6615, 'time@10': 8.7746}:  50%|█████     | 5/10 [00:40<00:30,  6.13s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0398, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8588, 'compress@10': 0.6615, 'time@10': 8.7746}:  60%|██████    | 6/10 [00:40<00:30,  7.63s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0389, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8607, 'compress@10': 0.6344, 'time@10': 9.2179}:  60%|██████    | 6/10 [00:46<00:30,  7.63s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0389, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8607, 'compress@10': 0.6344, 'time@10': 9.2179}:  70%|███████   | 7/10 [00:46<00:21,  7.09s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0385, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.8668, 'compress@10': 0.6133, 'time@10': 9.2048}:  70%|███████   | 7/10 [00:55<00:21,  7.09s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0385, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.8668, 'compress@10': 0.6133, 'time@10': 9.2048}:  80%|████████  | 8/10 [00:55<00:15,  7.75s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0387, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.8733, 'compress@10': 0.5753, 'time@10': 9.6222}:  80%|████████  | 8/10 [01:02<00:15,  7.75s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0387, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.8733, 'compress@10': 0.5753, 'time@10': 9.6222}:  90%|█████████ | 9/10 [01:02<00:07,  7.36s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0382, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8743, 'compress@10': 0.525, 'time@10': 9.6155}:  90%|█████████ | 9/10 [01:11<00:07,  7.36s/it]    {'epoch': 9, 'num_users': 6.3, 'loss': 0.0382, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8743, 'compress@10': 0.525, 'time@10': 9.6155}: 100%|██████████| 10/10 [01:11<00:00,  8.05s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0382, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8743, 'compress@10': 0.525, 'time@10': 9.6155}: 100%|██████████| 10/10 [01:11<00:00,  7.18s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.038165752738192546
Avg hit ratio: 0.8775073926262381
Avg ndcg: 0.8743089857462053
Avg compression ratio: 0.5249529325987501
Avg train time: 9.61551547050476
Std train time: 2.018126006645229
[0.7727272727272727, 0.3181818181818182, 0.13636363636363635, 0.7727272727272727, 0.9545454545454545, 0.8636363636363638, 0.4090909090909091, 0.40909090909090906, 0.3181818181818182, 0.04545454545454546]
[10, 12, 20, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8518, 'compress@10': 0.7847, 'time@10': 8.8217}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8518, 'compress@10': 0.7847, 'time@10': 8.8217}:  10%|█         | 1/10 [00:04<00:40,  4.47s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8756, 'compress@10': 0.5624, 'time@10': 8.7516}:  10%|█         | 1/10 [00:13<00:40,  4.47s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8756, 'compress@10': 0.5624, 'time@10': 8.7516}:  20%|██        | 2/10 [00:13<00:55,  6.97s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8694, 'compress@10': 0.4615, 'time@10': 7.5954}:  20%|██        | 2/10 [00:15<00:55,  6.97s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8694, 'compress@10': 0.4615, 'time@10': 7.5954}:  30%|███       | 3/10 [00:15<00:35,  5.01s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8969, 'compress@10': 0.5414, 'time@10': 7.9144}:  30%|███       | 3/10 [00:24<00:35,  5.01s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8969, 'compress@10': 0.5414, 'time@10': 7.9144}:  40%|████      | 4/10 [00:24<00:39,  6.55s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8745, 'compress@10': 0.6242, 'time@10': 8.4493}:  40%|████      | 4/10 [00:30<00:39,  6.55s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8745, 'compress@10': 0.6242, 'time@10': 8.4493}:  50%|█████     | 5/10 [00:30<00:30,  6.11s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.038, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8723, 'compress@10': 0.6646, 'time@10': 8.7819}:  50%|█████     | 5/10 [00:40<00:30,  6.11s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.038, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8723, 'compress@10': 0.6646, 'time@10': 8.7819}:  60%|██████    | 6/10 [00:40<00:30,  7.60s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0374, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8757, 'compress@10': 0.6315, 'time@10': 9.1949}:  60%|██████    | 6/10 [00:46<00:30,  7.60s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0374, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8757, 'compress@10': 0.6315, 'time@10': 9.1949}:  70%|███████   | 7/10 [00:46<00:21,  7.03s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0376, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8847, 'compress@10': 0.6058, 'time@10': 9.1784}:  70%|███████   | 7/10 [00:55<00:21,  7.03s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0376, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8847, 'compress@10': 0.6058, 'time@10': 9.1784}:  80%|████████  | 8/10 [00:55<00:15,  7.69s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0376, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8889, 'compress@10': 0.576, 'time@10': 9.576}:  80%|████████  | 8/10 [01:01<00:15,  7.69s/it] {'epoch': 10, 'num_users': 6.3333, 'loss': 0.0376, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8889, 'compress@10': 0.576, 'time@10': 9.576}:  90%|█████████ | 9/10 [01:01<00:07,  7.29s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.89, 'compress@10': 0.5251, 'time@10': 9.5769}:  90%|█████████ | 9/10 [01:11<00:07,  7.29s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.89, 'compress@10': 0.5251, 'time@10': 9.5769}: 100%|██████████| 10/10 [01:11<00:00,  8.01s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.89, 'compress@10': 0.5251, 'time@10': 9.5769}: 100%|██████████| 10/10 [01:11<00:00,  7.16s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03674471567135927
Avg hit ratio: 0.8656661227849682
Avg ndcg: 0.8900402058686522
Avg compression ratio: 0.5251052890135777
Avg train time: 9.576875281333923
Std train time: 1.919807085760806
[0.7916666666666666, 0.2916666666666667, 0.12499999999999999, 0.7916666666666666, 0.9583333333333333, 0.8750000000000001, 0.375, 0.4583333333333333, 0.2916666666666667, 0.04166666666666667]
[10, 12, 21, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8503, 'compress@10': 0.8026, 'time@10': 8.5684}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8503, 'compress@10': 0.8026, 'time@10': 8.5684}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0351, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8776, 'compress@10': 0.5586, 'time@10': 8.4149}:  10%|█         | 1/10 [00:12<00:38,  4.32s/it] {'epoch': 11, 'num_users': 7.0, 'loss': 0.0351, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8776, 'compress@10': 0.5586, 'time@10': 8.4149}:  20%|██        | 2/10 [00:12<00:53,  6.66s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8708, 'compress@10': 0.4557, 'time@10': 7.666}:  20%|██        | 2/10 [00:15<00:53,  6.66s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8708, 'compress@10': 0.4557, 'time@10': 7.666}:  30%|███       | 3/10 [00:15<00:35,  5.04s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7829, 'ndcg@10': 0.8818, 'compress@10': 0.5416, 'time@10': 7.9628}:  30%|███       | 3/10 [00:24<00:35,  5.04s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7829, 'ndcg@10': 0.8818, 'compress@10': 0.5416, 'time@10': 7.9628}:  40%|████      | 4/10 [00:24<00:39,  6.56s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0352, 'hit_ratio@10': 0.7943, 'ndcg@10': 0.8639, 'compress@10': 0.6251, 'time@10': 8.5451}:  40%|████      | 4/10 [00:30<00:39,  6.56s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0352, 'hit_ratio@10': 0.7943, 'ndcg@10': 0.8639, 'compress@10': 0.6251, 'time@10': 8.5451}:  50%|█████     | 5/10 [00:30<00:30,  6.17s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0351, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8652, 'compress@10': 0.6672, 'time@10': 8.8417}:  50%|█████     | 5/10 [00:40<00:30,  6.17s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0351, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8652, 'compress@10': 0.6672, 'time@10': 8.8417}:  60%|██████    | 6/10 [00:40<00:30,  7.60s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0355, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.8644, 'compress@10': 0.629, 'time@10': 9.2761}:  60%|██████    | 6/10 [00:46<00:30,  7.60s/it] {'epoch': 11, 'num_users': 6.2857, 'loss': 0.0355, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.8644, 'compress@10': 0.629, 'time@10': 9.2761}:  70%|███████   | 7/10 [00:46<00:21,  7.07s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0356, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8717, 'compress@10': 0.6096, 'time@10': 9.2804}:  70%|███████   | 7/10 [00:55<00:21,  7.07s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0356, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8717, 'compress@10': 0.6096, 'time@10': 9.2804}:  80%|████████  | 8/10 [00:55<00:15,  7.79s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.036, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8795, 'compress@10': 0.5765, 'time@10': 9.6695}:  80%|████████  | 8/10 [01:02<00:15,  7.79s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.036, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8795, 'compress@10': 0.5765, 'time@10': 9.6695}:  90%|█████████ | 9/10 [01:02<00:07,  7.37s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0352, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8823, 'compress@10': 0.5252, 'time@10': 9.6925}:  90%|█████████ | 9/10 [01:12<00:07,  7.37s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.0352, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8823, 'compress@10': 0.5252, 'time@10': 9.6925}: 100%|██████████| 10/10 [01:12<00:00,  8.16s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0352, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.8823, 'compress@10': 0.5252, 'time@10': 9.6925}: 100%|██████████| 10/10 [01:12<00:00,  7.22s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03518249320971035
Avg hit ratio: 0.8533804084992539
Avg ndcg: 0.8823307162934617
Avg compression ratio: 0.5252332030148865
Avg train time: 9.692451906204223
Std train time: 1.8101628700133077
[0.8076923076923077, 0.2692307692307693, 0.11538461538461538, 0.7307692307692307, 0.9615384615384615, 0.8076923076923078, 0.4230769230769231, 0.5, 0.34615384615384615, 0.038461538461538464]
[10, 12, 22, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0398, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8595, 'compress@10': 0.8178, 'time@10': 8.8236}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0398, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8595, 'compress@10': 0.8178, 'time@10': 8.8236}:  10%|█         | 1/10 [00:04<00:40,  4.45s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.032, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8886, 'compress@10': 0.5553, 'time@10': 8.7886}:  10%|█         | 1/10 [00:13<00:40,  4.45s/it]  {'epoch': 12, 'num_users': 7.0, 'loss': 0.032, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8886, 'compress@10': 0.5553, 'time@10': 8.7886}:  20%|██        | 2/10 [00:13<00:56,  7.00s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8781, 'compress@10': 0.4508, 'time@10': 7.8967}:  20%|██        | 2/10 [00:16<00:56,  7.00s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8781, 'compress@10': 0.4508, 'time@10': 7.8967}:  30%|███       | 3/10 [00:16<00:36,  5.22s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8874, 'compress@10': 0.5232, 'time@10': 8.2113}:  30%|███       | 3/10 [00:25<00:36,  5.22s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8874, 'compress@10': 0.5232, 'time@10': 8.2113}:  40%|████      | 4/10 [00:25<00:40,  6.79s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0332, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8687, 'compress@10': 0.611, 'time@10': 8.6366}:  40%|████      | 4/10 [00:30<00:40,  6.79s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0332, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8687, 'compress@10': 0.611, 'time@10': 8.6366}:  50%|█████     | 5/10 [00:30<00:31,  6.22s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0336, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8692, 'compress@10': 0.6445, 'time@10': 8.9593}:  50%|█████     | 5/10 [00:41<00:31,  6.22s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0336, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8692, 'compress@10': 0.6445, 'time@10': 8.9593}:  60%|██████    | 6/10 [00:41<00:30,  7.71s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0327, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8745, 'compress@10': 0.6162, 'time@10': 9.3028}:  60%|██████    | 6/10 [00:47<00:30,  7.71s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0327, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8745, 'compress@10': 0.6162, 'time@10': 9.3028}:  70%|███████   | 7/10 [00:47<00:21,  7.06s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0324, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8824, 'compress@10': 0.6034, 'time@10': 9.2514}:  70%|███████   | 7/10 [00:56<00:21,  7.06s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0324, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8824, 'compress@10': 0.6034, 'time@10': 9.2514}:  80%|████████  | 8/10 [00:56<00:15,  7.66s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0335, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8944, 'compress@10': 0.5769, 'time@10': 9.6687}:  80%|████████  | 8/10 [01:02<00:15,  7.66s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0335, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8944, 'compress@10': 0.5769, 'time@10': 9.6687}:  90%|█████████ | 9/10 [01:02<00:07,  7.31s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.8972, 'compress@10': 0.5253, 'time@10': 9.6653}:  90%|█████████ | 9/10 [01:12<00:07,  7.31s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.8972, 'compress@10': 0.5253, 'time@10': 9.6653}: 100%|██████████| 10/10 [01:12<00:00,  8.04s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.8972, 'compress@10': 0.5253, 'time@10': 9.6653}: 100%|██████████| 10/10 [01:12<00:00,  7.22s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03247787495139369
Avg hit ratio: 0.8767454878643333
Avg ndcg: 0.8972010393669235
Avg compression ratio: 0.5252597588052296
Avg train time: 9.665261936187743
Std train time: 1.7421010398480588
[0.8214285714285714, 0.25000000000000006, 0.10714285714285714, 0.75, 0.9642857142857142, 0.8214285714285715, 0.39285714285714285, 0.4642857142857143, 0.39285714285714285, 0.03571428571428572]
[10, 12, 23, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8402, 'compress@10': 0.8308, 'time@10': 8.5295}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8402, 'compress@10': 0.8308, 'time@10': 8.5295}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8837, 'compress@10': 0.5525, 'time@10': 8.5}:  10%|█         | 1/10 [00:12<00:38,  4.30s/it]   {'epoch': 13, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8837, 'compress@10': 0.5525, 'time@10': 8.5}:  20%|██        | 2/10 [00:12<00:54,  6.78s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.74, 'ndcg@10': 0.8748, 'compress@10': 0.4466, 'time@10': 7.7903}:  20%|██        | 2/10 [00:16<00:54,  6.78s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.74, 'ndcg@10': 0.8748, 'compress@10': 0.4466, 'time@10': 7.7903}:  30%|███       | 3/10 [00:16<00:36,  5.15s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8947, 'compress@10': 0.5247, 'time@10': 8.1114}:  30%|███       | 3/10 [00:25<00:36,  5.15s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8947, 'compress@10': 0.5247, 'time@10': 8.1114}:  40%|████      | 4/10 [00:25<00:40,  6.72s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0336, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.8747, 'compress@10': 0.6127, 'time@10': 8.6602}:  40%|████      | 4/10 [00:30<00:40,  6.72s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0336, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.8747, 'compress@10': 0.6127, 'time@10': 8.6602}:  50%|█████     | 5/10 [00:30<00:31,  6.27s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0351, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8784, 'compress@10': 0.6482, 'time@10': 8.9642}:  50%|█████     | 5/10 [00:41<00:31,  6.27s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0351, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8784, 'compress@10': 0.6482, 'time@10': 8.9642}:  60%|██████    | 6/10 [00:41<00:30,  7.71s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0355, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8792, 'compress@10': 0.6152, 'time@10': 9.3066}:  60%|██████    | 6/10 [00:46<00:30,  7.71s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0355, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8792, 'compress@10': 0.6152, 'time@10': 9.3066}:  70%|███████   | 7/10 [00:46<00:21,  7.06s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0348, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.8865, 'compress@10': 0.5982, 'time@10': 9.2827}:  70%|███████   | 7/10 [00:56<00:21,  7.06s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0348, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.8865, 'compress@10': 0.5982, 'time@10': 9.2827}:  80%|████████  | 8/10 [00:56<00:15,  7.73s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0356, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9002, 'compress@10': 0.5773, 'time@10': 9.6898}:  80%|████████  | 8/10 [01:02<00:15,  7.73s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0356, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9002, 'compress@10': 0.5773, 'time@10': 9.6898}:  90%|█████████ | 9/10 [01:02<00:07,  7.35s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0351, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8997, 'compress@10': 0.5254, 'time@10': 9.6909}:  90%|█████████ | 9/10 [01:12<00:07,  7.35s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0351, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8997, 'compress@10': 0.5254, 'time@10': 9.6909}: 100%|██████████| 10/10 [01:12<00:00,  8.09s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0351, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8997, 'compress@10': 0.5254, 'time@10': 9.6909}: 100%|██████████| 10/10 [01:12<00:00,  7.23s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.035081815699100474
Avg hit ratio: 0.8626435663939909
Avg ndcg: 0.8997033684561389
Avg compression ratio: 0.5253574588813796
Avg train time: 9.69094922542572
Std train time: 1.7304988307266145
[0.8333333333333333, 0.2333333333333334, 0.09999999999999999, 0.7, 0.9666666666666666, 0.8333333333333334, 0.43333333333333335, 0.43333333333333335, 0.43333333333333335, 0.03333333333333334]
[10, 12, 24, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8626, 'compress@10': 0.8421, 'time@10': 8.5533}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8626, 'compress@10': 0.8421, 'time@10': 8.5533}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.898, 'compress@10': 0.5501, 'time@10': 8.5191}:  10%|█         | 1/10 [00:12<00:38,  4.32s/it] {'epoch': 14, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.898, 'compress@10': 0.5501, 'time@10': 8.5191}:  20%|██        | 2/10 [00:12<00:54,  6.79s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.74, 'ndcg@10': 0.8844, 'compress@10': 0.4429, 'time@10': 7.909}:  20%|██        | 2/10 [00:16<00:54,  6.79s/it]   {'epoch': 14, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.74, 'ndcg@10': 0.8844, 'compress@10': 0.4429, 'time@10': 7.909}:  30%|███       | 3/10 [00:16<00:36,  5.24s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8973, 'compress@10': 0.5099, 'time@10': 8.2296}:  30%|███       | 3/10 [00:25<00:36,  5.24s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8973, 'compress@10': 0.5099, 'time@10': 8.2296}:  40%|████      | 4/10 [00:25<00:40,  6.81s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0296, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.8775, 'compress@10': 0.6014, 'time@10': 8.7053}:  40%|████      | 4/10 [00:30<00:40,  6.81s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0296, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.8775, 'compress@10': 0.6014, 'time@10': 8.7053}:  50%|█████     | 5/10 [00:30<00:31,  6.29s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0299, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8829, 'compress@10': 0.6406, 'time@10': 9.0203}:  50%|█████     | 5/10 [00:41<00:31,  6.29s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0299, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8829, 'compress@10': 0.6406, 'time@10': 9.0203}:  60%|██████    | 6/10 [00:41<00:31,  7.77s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0305, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.878, 'compress@10': 0.6143, 'time@10': 9.3809}:  60%|██████    | 6/10 [00:47<00:31,  7.77s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0305, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.878, 'compress@10': 0.6143, 'time@10': 9.3809}:  70%|███████   | 7/10 [00:47<00:21,  7.13s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0306, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8881, 'compress@10': 0.5937, 'time@10': 9.3358}:  70%|███████   | 7/10 [00:56<00:21,  7.13s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0306, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8881, 'compress@10': 0.5937, 'time@10': 9.3358}:  80%|████████  | 8/10 [00:56<00:15,  7.74s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0311, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8954, 'compress@10': 0.5776, 'time@10': 9.7439}:  80%|████████  | 8/10 [01:02<00:15,  7.74s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0311, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8954, 'compress@10': 0.5776, 'time@10': 9.7439}:  90%|█████████ | 9/10 [01:02<00:07,  7.37s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8999, 'compress@10': 0.5254, 'time@10': 9.7664}:  90%|█████████ | 9/10 [01:12<00:07,  7.37s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8999, 'compress@10': 0.5254, 'time@10': 9.7664}: 100%|██████████| 10/10 [01:12<00:00,  8.18s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8999, 'compress@10': 0.5254, 'time@10': 9.7664}: 100%|██████████| 10/10 [01:12<00:00,  7.29s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.029194890083075648
Avg hit ratio: 0.8651385158889404
Avg ndcg: 0.8998893378066685
Avg compression ratio: 0.5254146547047506
Avg train time: 9.766414713859557
Std train time: 1.6906558055767584
[0.8437499999999999, 0.21875000000000006, 0.09374999999999999, 0.65625, 0.9687499999999999, 0.84375, 0.46875, 0.40625, 0.46875, 0.03125000000000001]
[10, 12, 25, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8474, 'compress@10': 0.852, 'time@10': 8.5338}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8474, 'compress@10': 0.852, 'time@10': 8.5338}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0305, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8947, 'compress@10': 0.548, 'time@10': 8.5219}:  10%|█         | 1/10 [00:12<00:38,  4.31s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0305, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8947, 'compress@10': 0.548, 'time@10': 8.5219}:  20%|██        | 2/10 [00:12<00:54,  6.80s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8822, 'compress@10': 0.4397, 'time@10': 7.9528}:  20%|██        | 2/10 [00:16<00:54,  6.80s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8822, 'compress@10': 0.4397, 'time@10': 7.9528}:  30%|███       | 3/10 [00:16<00:36,  5.27s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8924, 'compress@10': 0.4969, 'time@10': 8.251}:  30%|███       | 3/10 [00:25<00:36,  5.27s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8924, 'compress@10': 0.4969, 'time@10': 8.251}:  40%|████      | 4/10 [00:25<00:40,  6.81s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0297, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8746, 'compress@10': 0.5914, 'time@10': 8.8053}:  40%|████      | 4/10 [00:31<00:40,  6.81s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0297, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8746, 'compress@10': 0.5914, 'time@10': 8.8053}:  50%|█████     | 5/10 [00:31<00:31,  6.36s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0285, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8804, 'compress@10': 0.634, 'time@10': 9.0794}:  50%|█████     | 5/10 [00:41<00:31,  6.36s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0285, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8804, 'compress@10': 0.634, 'time@10': 9.0794}:  60%|██████    | 6/10 [00:41<00:31,  7.76s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0284, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8861, 'compress@10': 0.6135, 'time@10': 9.4147}:  60%|██████    | 6/10 [00:47<00:31,  7.76s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0284, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8861, 'compress@10': 0.6135, 'time@10': 9.4147}:  70%|███████   | 7/10 [00:47<00:21,  7.10s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0284, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.8935, 'compress@10': 0.5897, 'time@10': 9.3528}:  70%|███████   | 7/10 [00:56<00:21,  7.10s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0284, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.8935, 'compress@10': 0.5897, 'time@10': 9.3528}:  80%|████████  | 8/10 [00:56<00:15,  7.69s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8997, 'compress@10': 0.5779, 'time@10': 9.7798}:  80%|████████  | 8/10 [01:02<00:15,  7.69s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.8997, 'compress@10': 0.5779, 'time@10': 9.7798}:  90%|█████████ | 9/10 [01:02<00:07,  7.36s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.8977, 'compress@10': 0.5255, 'time@10': 9.7969}:  90%|█████████ | 9/10 [01:12<00:07,  7.36s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.8977, 'compress@10': 0.5255, 'time@10': 9.7969}: 100%|██████████| 10/10 [01:12<00:00,  8.18s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0286, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.8977, 'compress@10': 0.5255, 'time@10': 9.7969}: 100%|██████████| 10/10 [01:12<00:00,  7.29s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.02857099876477771
Avg hit ratio: 0.8795201664963974
Avg ndcg: 0.8977196941709156
Avg compression ratio: 0.5254650605965911
Avg train time: 9.796875405311585
Std train time: 1.7176982447669316
[0.8529411764705881, 0.20588235294117652, 0.08823529411764705, 0.6176470588235294, 0.9705882352941175, 0.7941176470588235, 0.5, 0.4411764705882353, 0.4411764705882353, 0.08823529411764706]
[10, 12, 26, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8685, 'compress@10': 0.8607, 'time@10': 8.663}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8685, 'compress@10': 0.8607, 'time@10': 8.663}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9073, 'compress@10': 0.5461, 'time@10': 8.6131}:  10%|█         | 1/10 [00:12<00:39,  4.37s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0256, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9073, 'compress@10': 0.5461, 'time@10': 8.6131}:  20%|██        | 2/10 [00:12<00:54,  6.86s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8906, 'compress@10': 0.4369, 'time@10': 8.1466}:  20%|██        | 2/10 [00:16<00:54,  6.86s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8906, 'compress@10': 0.4369, 'time@10': 8.1466}:  30%|███       | 3/10 [00:16<00:37,  5.39s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9008, 'compress@10': 0.4855, 'time@10': 8.4382}:  30%|███       | 3/10 [00:25<00:37,  5.39s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9008, 'compress@10': 0.4855, 'time@10': 8.4382}:  40%|████      | 4/10 [00:25<00:41,  6.95s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0271, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8821, 'compress@10': 0.5826, 'time@10': 8.886}:  40%|████      | 4/10 [00:31<00:41,  6.95s/it] {'epoch': 16, 'num_users': 5.8, 'loss': 0.0271, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8821, 'compress@10': 0.5826, 'time@10': 8.886}:  50%|█████     | 5/10 [00:31<00:31,  6.39s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0285, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8873, 'compress@10': 0.6186, 'time@10': 9.1449}:  50%|█████     | 5/10 [00:41<00:31,  6.39s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0285, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8873, 'compress@10': 0.6186, 'time@10': 9.1449}:  60%|██████    | 6/10 [00:41<00:31,  7.78s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0288, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8861, 'compress@10': 0.6045, 'time@10': 9.4937}:  60%|██████    | 6/10 [00:47<00:31,  7.78s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0288, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8861, 'compress@10': 0.6045, 'time@10': 9.4937}:  70%|███████   | 7/10 [00:47<00:21,  7.14s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.893, 'compress@10': 0.5861, 'time@10': 9.4329}:  70%|███████   | 7/10 [00:56<00:21,  7.14s/it]  {'epoch': 16, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.893, 'compress@10': 0.5861, 'time@10': 9.4329}:  80%|████████  | 8/10 [00:56<00:15,  7.75s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.869, 'ndcg@10': 0.8978, 'compress@10': 0.5718, 'time@10': 9.8637}:  80%|████████  | 8/10 [01:03<00:15,  7.75s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.869, 'ndcg@10': 0.8978, 'compress@10': 0.5718, 'time@10': 9.8637}:  90%|█████████ | 9/10 [01:03<00:07,  7.42s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0266, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9028, 'compress@10': 0.5255, 'time@10': 9.8761}:  90%|█████████ | 9/10 [01:13<00:07,  7.42s/it]  {'epoch': 16, 'num_users': 6.3, 'loss': 0.0266, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9028, 'compress@10': 0.5255, 'time@10': 9.8761}: 100%|██████████| 10/10 [01:13<00:00,  8.22s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0266, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9028, 'compress@10': 0.5255, 'time@10': 9.8761}: 100%|██████████| 10/10 [01:13<00:00,  7.34s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.026649021495029967
Avg hit ratio: 0.8797928937691248
Avg ndcg: 0.9028196377052324
Avg compression ratio: 0.5255046849312739
Avg train time: 9.876082062721252
Std train time: 1.6445763914939053
[0.8611111111111109, 0.19444444444444448, 0.08333333333333333, 0.5833333333333334, 0.9722222222222221, 0.8055555555555555, 0.5277777777777778, 0.4722222222222222, 0.41666666666666663, 0.08333333333333334]
[10, 12, 27, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8703, 'compress@10': 0.8684, 'time@10': 8.4098}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0359, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8703, 'compress@10': 0.8684, 'time@10': 8.4098}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9087, 'compress@10': 0.5444, 'time@10': 8.5222}:  10%|█         | 1/10 [00:12<00:38,  4.24s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9087, 'compress@10': 0.5444, 'time@10': 8.5222}:  20%|██        | 2/10 [00:12<00:54,  6.85s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8915, 'compress@10': 0.4344, 'time@10': 8.1816}:  20%|██        | 2/10 [00:16<00:54,  6.85s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8915, 'compress@10': 0.4344, 'time@10': 8.1816}:  30%|███       | 3/10 [00:16<00:38,  5.45s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9044, 'compress@10': 0.4753, 'time@10': 8.4694}:  30%|███       | 3/10 [00:26<00:38,  5.45s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9044, 'compress@10': 0.4753, 'time@10': 8.4694}:  40%|████      | 4/10 [00:26<00:41,  7.00s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0262, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8857, 'compress@10': 0.5748, 'time@10': 8.9572}:  40%|████      | 4/10 [00:31<00:41,  7.00s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0262, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8857, 'compress@10': 0.5748, 'time@10': 8.9572}:  50%|█████     | 5/10 [00:31<00:32,  6.46s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0265, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8927, 'compress@10': 0.614, 'time@10': 9.2059}:  50%|█████     | 5/10 [00:42<00:32,  6.46s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0265, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8927, 'compress@10': 0.614, 'time@10': 9.2059}:  60%|██████    | 6/10 [00:42<00:31,  7.83s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0257, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8942, 'compress@10': 0.6044, 'time@10': 9.532}:  60%|██████    | 6/10 [00:47<00:31,  7.83s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0257, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8942, 'compress@10': 0.6044, 'time@10': 9.532}:  70%|███████   | 7/10 [00:47<00:21,  7.16s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0258, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9022, 'compress@10': 0.5897, 'time@10': 9.4624}:  70%|███████   | 7/10 [00:56<00:21,  7.16s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0258, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9022, 'compress@10': 0.5897, 'time@10': 9.4624}:  80%|████████  | 8/10 [00:56<00:15,  7.75s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9056, 'compress@10': 0.5724, 'time@10': 9.8709}:  80%|████████  | 8/10 [01:03<00:15,  7.75s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9056, 'compress@10': 0.5724, 'time@10': 9.8709}:  90%|█████████ | 9/10 [01:03<00:07,  7.39s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9085, 'compress@10': 0.5255, 'time@10': 9.8944}:  90%|█████████ | 9/10 [01:13<00:07,  7.39s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9085, 'compress@10': 0.5255, 'time@10': 9.8944}: 100%|██████████| 10/10 [01:13<00:00,  8.24s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9085, 'compress@10': 0.5255, 'time@10': 9.8944}: 100%|██████████| 10/10 [01:13<00:00,  7.36s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.026398353182308605
Avg hit ratio: 0.8895071794834104
Avg ndcg: 0.9085237136954282
Avg compression ratio: 0.5255447304520441
Avg train time: 9.894363832473754
Std train time: 1.5854485222771924
[0.8684210526315788, 0.1842105263157895, 0.07894736842105263, 0.5526315789473685, 0.9736842105263157, 0.8157894736842104, 0.5, 0.4473684210526316, 0.4473684210526315, 0.13157894736842107]
[10, 12, 28, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0351, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8752, 'compress@10': 0.8753, 'time@10': 8.4326}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0351, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8752, 'compress@10': 0.8753, 'time@10': 8.4326}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9137, 'compress@10': 0.5429, 'time@10': 8.4714}:  10%|█         | 1/10 [00:12<00:38,  4.25s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9137, 'compress@10': 0.5429, 'time@10': 8.4714}:  20%|██        | 2/10 [00:12<00:54,  6.78s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8948, 'compress@10': 0.4321, 'time@10': 8.2405}:  20%|██        | 2/10 [00:16<00:54,  6.78s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8948, 'compress@10': 0.4321, 'time@10': 8.2405}:  30%|███       | 3/10 [00:16<00:38,  5.49s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9045, 'compress@10': 0.4663, 'time@10': 8.4587}:  30%|███       | 3/10 [00:25<00:38,  5.49s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9045, 'compress@10': 0.4663, 'time@10': 8.4587}:  40%|████      | 4/10 [00:25<00:41,  6.93s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0256, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8876, 'compress@10': 0.5678, 'time@10': 8.9545}:  40%|████      | 4/10 [00:31<00:41,  6.93s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0256, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8876, 'compress@10': 0.5678, 'time@10': 8.9545}:  50%|█████     | 5/10 [00:31<00:32,  6.42s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0238, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8966, 'compress@10': 0.6098, 'time@10': 9.1836}:  50%|█████     | 5/10 [00:41<00:32,  6.42s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0238, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8966, 'compress@10': 0.6098, 'time@10': 9.1836}:  60%|██████    | 6/10 [00:41<00:31,  7.76s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0241, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.8984, 'compress@10': 0.597, 'time@10': 9.5018}:  60%|██████    | 6/10 [00:47<00:31,  7.76s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.0241, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.8984, 'compress@10': 0.597, 'time@10': 9.5018}:  70%|███████   | 7/10 [00:47<00:21,  7.10s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0243, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9067, 'compress@10': 0.5803, 'time@10': 9.4451}:  70%|███████   | 7/10 [00:56<00:21,  7.10s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0243, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9067, 'compress@10': 0.5803, 'time@10': 9.4451}:  80%|████████  | 8/10 [00:56<00:15,  7.73s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0249, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9104, 'compress@10': 0.5673, 'time@10': 9.8473}:  80%|████████  | 8/10 [01:03<00:15,  7.73s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0249, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9104, 'compress@10': 0.5673, 'time@10': 9.8473}:  90%|█████████ | 9/10 [01:03<00:07,  7.37s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9149, 'compress@10': 0.5257, 'time@10': 9.8576}:  90%|█████████ | 9/10 [01:13<00:07,  7.37s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9149, 'compress@10': 0.5257, 'time@10': 9.8576}: 100%|██████████| 10/10 [01:13<00:00,  8.18s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9149, 'compress@10': 0.5257, 'time@10': 9.8576}: 100%|██████████| 10/10 [01:13<00:00,  7.32s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.024120350083422698
Avg hit ratio: 0.8903791173926997
Avg ndcg: 0.9148690568824029
Avg compression ratio: 0.5256701336288094
Avg train time: 9.85759768486023
Std train time: 1.5321821072738504
[0.8749999999999998, 0.17500000000000002, 0.075, 0.525, 0.9749999999999999, 0.7749999999999999, 0.525, 0.475, 0.475, 0.12500000000000003]
[10, 12, 29, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8667, 'compress@10': 0.8816, 'time@10': 8.4312}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8667, 'compress@10': 0.8816, 'time@10': 8.4312}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9118, 'compress@10': 0.5416, 'time@10': 8.5254}:  10%|█         | 1/10 [00:12<00:38,  4.25s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9118, 'compress@10': 0.5416, 'time@10': 8.5254}:  20%|██        | 2/10 [00:12<00:54,  6.84s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8936, 'compress@10': 0.4301, 'time@10': 8.3361}:  20%|██        | 2/10 [00:16<00:54,  6.84s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8936, 'compress@10': 0.4301, 'time@10': 8.3361}:  30%|███       | 3/10 [00:16<00:38,  5.55s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9058, 'compress@10': 0.4581, 'time@10': 8.509}:  30%|███       | 3/10 [00:25<00:38,  5.55s/it]  {'epoch': 19, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9058, 'compress@10': 0.4581, 'time@10': 8.509}:  40%|████      | 4/10 [00:25<00:41,  6.94s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8899, 'compress@10': 0.5616, 'time@10': 9.0314}:  40%|████      | 4/10 [00:31<00:41,  6.94s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8899, 'compress@10': 0.5616, 'time@10': 9.0314}:  50%|█████     | 5/10 [00:31<00:32,  6.46s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0259, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.8977, 'compress@10': 0.598, 'time@10': 9.2532}:  50%|█████     | 5/10 [00:41<00:32,  6.46s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0259, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.8977, 'compress@10': 0.598, 'time@10': 9.2532}:  60%|██████    | 6/10 [00:41<00:31,  7.80s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0261, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.896, 'compress@10': 0.5903, 'time@10': 9.527}:  60%|██████    | 6/10 [00:47<00:31,  7.80s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0261, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.896, 'compress@10': 0.5903, 'time@10': 9.527}:  70%|███████   | 7/10 [00:47<00:21,  7.09s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.026, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9053, 'compress@10': 0.5777, 'time@10': 9.4527}:  70%|███████   | 7/10 [00:56<00:21,  7.09s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.026, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9053, 'compress@10': 0.5777, 'time@10': 9.4527}:  80%|████████  | 8/10 [00:56<00:15,  7.69s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9124, 'compress@10': 0.568, 'time@10': 9.8487}:  80%|████████  | 8/10 [01:03<00:15,  7.69s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9124, 'compress@10': 0.568, 'time@10': 9.8487}:  90%|█████████ | 9/10 [01:03<00:07,  7.33s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9156, 'compress@10': 0.5257, 'time@10': 9.8665}:  90%|█████████ | 9/10 [01:13<00:07,  7.33s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9156, 'compress@10': 0.5257, 'time@10': 9.8665}: 100%|██████████| 10/10 [01:13<00:00,  8.17s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9156, 'compress@10': 0.5257, 'time@10': 9.8665}: 100%|██████████| 10/10 [01:13<00:00,  7.32s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.025857391561750702
Avg hit ratio: 0.8939131945210044
Avg ndcg: 0.9156156447198933
Avg compression ratio: 0.5256661425502879
Avg train time: 9.866503834724426
Std train time: 1.4933099135077528
[0.8809523809523807, 0.16666666666666669, 0.07142857142857142, 0.5, 0.976190476190476, 0.7857142857142856, 0.5476190476190477, 0.4523809523809524, 0.5, 0.11904761904761907]
[10, 12, 30, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0308, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8812, 'compress@10': 0.8872, 'time@10': 8.4131}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0308, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8812, 'compress@10': 0.8872, 'time@10': 8.4131}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9215, 'compress@10': 0.5404, 'time@10': 8.5267}:  10%|█         | 1/10 [00:12<00:38,  4.24s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9215, 'compress@10': 0.5404, 'time@10': 8.5267}:  20%|██        | 2/10 [00:12<00:54,  6.85s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9, 'compress@10': 0.4283, 'time@10': 8.4248}:  20%|██        | 2/10 [00:17<00:54,  6.85s/it]    {'epoch': 20, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9, 'compress@10': 0.4283, 'time@10': 8.4248}:  30%|███       | 3/10 [00:17<00:39,  5.62s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9119, 'compress@10': 0.4507, 'time@10': 8.5994}:  30%|███       | 3/10 [00:26<00:39,  5.62s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9119, 'compress@10': 0.4507, 'time@10': 8.5994}:  40%|████      | 4/10 [00:26<00:42,  7.02s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8963, 'compress@10': 0.5559, 'time@10': 8.9826}:  40%|████      | 4/10 [00:31<00:42,  7.02s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0226, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8963, 'compress@10': 0.5559, 'time@10': 8.9826}:  50%|█████     | 5/10 [00:31<00:31,  6.40s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0231, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9051, 'compress@10': 0.595, 'time@10': 9.2318}:  50%|█████     | 5/10 [00:42<00:31,  6.40s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0231, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9051, 'compress@10': 0.595, 'time@10': 9.2318}:  60%|██████    | 6/10 [00:42<00:31,  7.80s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0221, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9075, 'compress@10': 0.5908, 'time@10': 9.5548}:  60%|██████    | 6/10 [00:47<00:31,  7.80s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0221, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9075, 'compress@10': 0.5908, 'time@10': 9.5548}:  70%|███████   | 7/10 [00:47<00:21,  7.14s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0224, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9155, 'compress@10': 0.5754, 'time@10': 9.4811}:  70%|███████   | 7/10 [00:56<00:21,  7.14s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0224, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9155, 'compress@10': 0.5754, 'time@10': 9.4811}:  80%|████████  | 8/10 [00:56<00:15,  7.73s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9202, 'compress@10': 0.5686, 'time@10': 9.884}:  80%|████████  | 8/10 [01:03<00:15,  7.73s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9202, 'compress@10': 0.5686, 'time@10': 9.884}:  90%|█████████ | 9/10 [01:03<00:07,  7.38s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9217, 'compress@10': 0.5257, 'time@10': 9.9068}:  90%|█████████ | 9/10 [01:13<00:07,  7.38s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9217, 'compress@10': 0.5257, 'time@10': 9.9068}: 100%|██████████| 10/10 [01:13<00:00,  8.23s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9217, 'compress@10': 0.5257, 'time@10': 9.9068}: 100%|██████████| 10/10 [01:13<00:00,  7.36s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.0229668746098431
Avg hit ratio: 0.8910560516638615
Avg ndcg: 0.9216822858072643
Avg compression ratio: 0.5256919426975112
Avg train time: 9.906760239601136
Std train time: 1.4722961429453696
[0.8863636363636361, 0.15909090909090912, 0.06818181818181818, 0.4772727272727273, 0.9772727272727272, 0.7954545454545453, 0.5227272727272728, 0.4772727272727273, 0.5227272727272727, 0.11363636363636366]
[10, 12, 30, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8834, 'compress@10': 0.8923, 'time@10': 8.4118}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8834, 'compress@10': 0.8923, 'time@10': 8.4118}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9226, 'compress@10': 0.5393, 'time@10': 8.502}:  10%|█         | 1/10 [00:12<00:38,  4.24s/it] {'epoch': 21, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9226, 'compress@10': 0.5393, 'time@10': 8.502}:  20%|██        | 2/10 [00:12<00:54,  6.82s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9008, 'compress@10': 0.4266, 'time@10': 8.5789}:  20%|██        | 2/10 [00:17<00:54,  6.82s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9008, 'compress@10': 0.4266, 'time@10': 8.5789}:  30%|███       | 3/10 [00:17<00:40,  5.72s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9132, 'compress@10': 0.444, 'time@10': 8.6561}:  30%|███       | 3/10 [00:26<00:40,  5.72s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9132, 'compress@10': 0.444, 'time@10': 8.6561}:  40%|████      | 4/10 [00:26<00:41,  6.98s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0215, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.8984, 'compress@10': 0.5507, 'time@10': 9.1202}:  40%|████      | 4/10 [00:31<00:41,  6.98s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0215, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.8984, 'compress@10': 0.5507, 'time@10': 9.1202}:  50%|█████     | 5/10 [00:31<00:32,  6.46s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0195, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.908, 'compress@10': 0.5923, 'time@10': 9.3518}:  50%|█████     | 5/10 [00:42<00:32,  6.46s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0195, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.908, 'compress@10': 0.5923, 'time@10': 9.3518}:  60%|██████    | 6/10 [00:42<00:31,  7.85s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0205, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9081, 'compress@10': 0.585, 'time@10': 9.6251}:  60%|██████    | 6/10 [00:47<00:31,  7.85s/it] {'epoch': 21, 'num_users': 6.2857, 'loss': 0.0205, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9081, 'compress@10': 0.585, 'time@10': 9.6251}:  70%|███████   | 7/10 [00:47<00:21,  7.14s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0209, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9161, 'compress@10': 0.5734, 'time@10': 9.5402}:  70%|███████   | 7/10 [00:56<00:21,  7.14s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0209, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9161, 'compress@10': 0.5734, 'time@10': 9.5402}:  80%|████████  | 8/10 [00:56<00:15,  7.72s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9208, 'compress@10': 0.5693, 'time@10': 9.9419}:  80%|████████  | 8/10 [01:03<00:15,  7.72s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0211, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9208, 'compress@10': 0.5693, 'time@10': 9.9419}:  90%|█████████ | 9/10 [01:03<00:07,  7.38s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.9068, 'ndcg@10': 0.9257, 'compress@10': 0.5258, 'time@10': 9.9688}:  90%|█████████ | 9/10 [01:13<00:07,  7.38s/it]  {'epoch': 21, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.9068, 'ndcg@10': 0.9257, 'compress@10': 0.5258, 'time@10': 9.9688}: 100%|██████████| 10/10 [01:13<00:00,  8.26s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.9068, 'ndcg@10': 0.9257, 'compress@10': 0.5258, 'time@10': 9.9688}: 100%|██████████| 10/10 [01:13<00:00,  7.38s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.01969628712560284
Avg hit ratio: 0.9068497024575123
Avg ndcg: 0.9256956489304112
Avg compression ratio: 0.5257677968492488
Avg train time: 9.968818092346192
Std train time: 1.4581680757350475
[0.8913043478260867, 0.1521739130434783, 0.06521739130434782, 0.4565217391304348, 0.9782608695652173, 0.7608695652173911, 0.5434782608695653, 0.5, 0.5434782608695652, 0.10869565217391307]
[10, 12, 30, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.897, 'time@10': 8.4677}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.897, 'time@10': 8.4677}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9256, 'compress@10': 0.5383, 'time@10': 8.5621}:  10%|█         | 1/10 [00:12<00:38,  4.27s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9256, 'compress@10': 0.5383, 'time@10': 8.5621}:  20%|██        | 2/10 [00:12<00:55,  6.89s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9028, 'compress@10': 0.4251, 'time@10': 8.4435}:  20%|██        | 2/10 [00:17<00:55,  6.89s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9028, 'compress@10': 0.4251, 'time@10': 8.4435}:  30%|███       | 3/10 [00:17<00:39,  5.64s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9151, 'compress@10': 0.4378, 'time@10': 8.5225}:  30%|███       | 3/10 [00:25<00:39,  5.64s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9151, 'compress@10': 0.4378, 'time@10': 8.5225}:  40%|████      | 4/10 [00:25<00:41,  6.88s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0208, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.902, 'compress@10': 0.546, 'time@10': 8.9985}:  40%|████      | 4/10 [00:31<00:41,  6.88s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0208, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.902, 'compress@10': 0.546, 'time@10': 8.9985}:  50%|█████     | 5/10 [00:31<00:31,  6.38s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9109, 'compress@10': 0.5827, 'time@10': 9.235}:  50%|█████     | 5/10 [00:41<00:31,  6.38s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0215, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9109, 'compress@10': 0.5827, 'time@10': 9.235}:  60%|██████    | 6/10 [00:41<00:31,  7.77s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9102, 'compress@10': 0.5797, 'time@10': 9.5612}:  60%|██████    | 6/10 [00:47<00:31,  7.77s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9102, 'compress@10': 0.5797, 'time@10': 9.5612}:  70%|███████   | 7/10 [00:47<00:21,  7.12s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9188, 'compress@10': 0.5715, 'time@10': 9.4876}:  70%|███████   | 7/10 [00:56<00:21,  7.12s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9188, 'compress@10': 0.5715, 'time@10': 9.4876}:  80%|████████  | 8/10 [00:56<00:15,  7.72s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0217, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9234, 'compress@10': 0.5698, 'time@10': 9.891}:  80%|████████  | 8/10 [01:03<00:15,  7.72s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0217, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9234, 'compress@10': 0.5698, 'time@10': 9.891}:  90%|█████████ | 9/10 [01:03<00:07,  7.37s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0226, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9276, 'compress@10': 0.5258, 'time@10': 9.9174}:  90%|█████████ | 9/10 [01:13<00:07,  7.37s/it]  {'epoch': 22, 'num_users': 6.3, 'loss': 0.0226, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9276, 'compress@10': 0.5258, 'time@10': 9.9174}: 100%|██████████| 10/10 [01:13<00:00,  8.24s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0226, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9276, 'compress@10': 0.5258, 'time@10': 9.9174}: 100%|██████████| 10/10 [01:13<00:00,  7.35s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.02264600115392993
Avg hit ratio: 0.8893381817201851
Avg ndcg: 0.9275872891807241
Avg compression ratio: 0.5257585604393029
Avg train time: 9.9173828125
Std train time: 1.514538871437885
[0.895833333333333, 0.14583333333333337, 0.0625, 0.4375, 0.9791666666666665, 0.7708333333333331, 0.5208333333333334, 0.5208333333333334, 0.5208333333333333, 0.14583333333333337]
[10, 12, 30, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9013, 'time@10': 8.5811}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9013, 'time@10': 8.5811}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.924, 'compress@10': 0.5373, 'time@10': 8.6033}:  10%|█         | 1/10 [00:12<00:38,  4.33s/it] {'epoch': 23, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.924, 'compress@10': 0.5373, 'time@10': 8.6033}:  20%|██        | 2/10 [00:12<00:55,  6.88s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9017, 'compress@10': 0.4237, 'time@10': 8.4963}:  20%|██        | 2/10 [00:17<00:55,  6.88s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9017, 'compress@10': 0.4237, 'time@10': 8.4963}:  30%|███       | 3/10 [00:17<00:39,  5.65s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9141, 'compress@10': 0.4322, 'time@10': 8.6209}:  30%|███       | 3/10 [00:26<00:39,  5.65s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9141, 'compress@10': 0.4322, 'time@10': 8.6209}:  40%|████      | 4/10 [00:26<00:41,  6.99s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9011, 'compress@10': 0.5417, 'time@10': 9.1258}:  40%|████      | 4/10 [00:31<00:41,  6.99s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9011, 'compress@10': 0.5417, 'time@10': 9.1258}:  50%|█████     | 5/10 [00:31<00:32,  6.50s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.911, 'compress@10': 0.5807, 'time@10': 9.3146}:  50%|█████     | 5/10 [00:42<00:32,  6.50s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.911, 'compress@10': 0.5807, 'time@10': 9.3146}:  60%|██████    | 6/10 [00:42<00:31,  7.79s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9159, 'compress@10': 0.5749, 'time@10': 9.612}:  60%|██████    | 6/10 [00:47<00:31,  7.79s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9159, 'compress@10': 0.5749, 'time@10': 9.612}:  70%|███████   | 7/10 [00:47<00:21,  7.12s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9242, 'compress@10': 0.5698, 'time@10': 9.5088}:  70%|███████   | 7/10 [00:56<00:21,  7.12s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9242, 'compress@10': 0.5698, 'time@10': 9.5088}:  80%|████████  | 8/10 [00:56<00:15,  7.66s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9285, 'compress@10': 0.5659, 'time@10': 9.9006}:  80%|████████  | 8/10 [01:03<00:15,  7.66s/it] {'epoch': 23, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9285, 'compress@10': 0.5659, 'time@10': 9.9006}:  90%|█████████ | 9/10 [01:03<00:07,  7.31s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9303, 'compress@10': 0.5258, 'time@10': 9.9244}:  90%|█████████ | 9/10 [01:13<00:07,  7.31s/it] {'epoch': 23, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9303, 'compress@10': 0.5258, 'time@10': 9.9244}: 100%|██████████| 10/10 [01:13<00:00,  8.20s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9303, 'compress@10': 0.5258, 'time@10': 9.9244}: 100%|██████████| 10/10 [01:13<00:00,  7.34s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.020092312377414774
Avg hit ratio: 0.892195324577328
Avg ndcg: 0.9303360330972537
Avg compression ratio: 0.5258484825615056
Avg train time: 9.92441017627716
Std train time: 1.477755120523635
[0.8999999999999997, 0.14000000000000004, 0.06, 0.42, 0.9799999999999999, 0.7799999999999998, 0.5, 0.54, 0.49999999999999994, 0.18000000000000005]
[10, 12, 30, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9052, 'time@10': 8.6865}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.9052, 'time@10': 8.6865}:  10%|█         | 1/10 [00:04<00:39,  4.39s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9323, 'compress@10': 0.5365, 'time@10': 8.6756}:  10%|█         | 1/10 [00:13<00:39,  4.39s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9323, 'compress@10': 0.5365, 'time@10': 8.6756}:  20%|██        | 2/10 [00:13<00:55,  6.93s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9072, 'compress@10': 0.4224, 'time@10': 8.6216}:  20%|██        | 2/10 [00:17<00:55,  6.93s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9072, 'compress@10': 0.4224, 'time@10': 8.6216}:  30%|███       | 3/10 [00:17<00:40,  5.72s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7922, 'ndcg@10': 0.9183, 'compress@10': 0.427, 'time@10': 8.7327}:  30%|███       | 3/10 [00:26<00:40,  5.72s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7922, 'ndcg@10': 0.9183, 'compress@10': 0.427, 'time@10': 8.7327}:  40%|████      | 4/10 [00:26<00:42,  7.06s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0185, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.9055, 'compress@10': 0.5377, 'time@10': 9.141}:  40%|████      | 4/10 [00:31<00:42,  7.06s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0185, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.9055, 'compress@10': 0.5377, 'time@10': 9.141}:  50%|█████     | 5/10 [00:31<00:32,  6.47s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0164, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.9153, 'compress@10': 0.5789, 'time@10': 9.3495}:  50%|█████     | 5/10 [00:42<00:32,  6.47s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0164, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.9153, 'compress@10': 0.5789, 'time@10': 9.3495}:  60%|██████    | 6/10 [00:42<00:31,  7.82s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9155, 'compress@10': 0.5705, 'time@10': 9.6549}:  60%|██████    | 6/10 [00:48<00:31,  7.82s/it] {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9155, 'compress@10': 0.5705, 'time@10': 9.6549}:  70%|███████   | 7/10 [00:48<00:21,  7.15s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9244, 'compress@10': 0.5683, 'time@10': 9.5703}:  70%|███████   | 7/10 [00:57<00:21,  7.15s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9244, 'compress@10': 0.5683, 'time@10': 9.5703}:  80%|████████  | 8/10 [00:57<00:15,  7.74s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9287, 'compress@10': 0.5623, 'time@10': 9.9697}:  80%|████████  | 8/10 [01:03<00:15,  7.74s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9287, 'compress@10': 0.5623, 'time@10': 9.9697}:  90%|█████████ | 9/10 [01:03<00:07,  7.39s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9332, 'compress@10': 0.5259, 'time@10': 9.9931}:  90%|█████████ | 9/10 [01:14<00:07,  7.39s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9332, 'compress@10': 0.5259, 'time@10': 9.9931}: 100%|██████████| 10/10 [01:14<00:00,  8.28s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9332, 'compress@10': 0.5259, 'time@10': 9.9931}: 100%|██████████| 10/10 [01:14<00:00,  7.40s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.01790213000419954
Avg hit ratio: 0.8746838038400007
Avg ndcg: 0.9331510680813926
Avg compression ratio: 0.5259325090696063
Avg train time: 9.993091654777526
Std train time: 1.4372328443719082
[0.9038461538461535, 0.13461538461538466, 0.05769230769230769, 0.40384615384615385, 0.9807692307692306, 0.7499999999999998, 0.5192307692307693, 0.5576923076923077, 0.5192307692307692, 0.17307692307692313]
[10, 12, 30, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8963, 'compress@10': 0.9089, 'time@10': 8.5146}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8963, 'compress@10': 0.9089, 'time@10': 8.5146}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9296, 'compress@10': 0.5357, 'time@10': 8.4783}:  10%|█         | 1/10 [00:12<00:38,  4.29s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9296, 'compress@10': 0.5357, 'time@10': 8.4783}:  20%|██        | 2/10 [00:12<00:54,  6.76s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9055, 'compress@10': 0.4212, 'time@10': 8.4405}:  20%|██        | 2/10 [00:17<00:54,  6.76s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9055, 'compress@10': 0.4212, 'time@10': 8.4405}:  30%|███       | 3/10 [00:17<00:39,  5.60s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9202, 'compress@10': 0.4222, 'time@10': 8.5406}:  30%|███       | 3/10 [00:25<00:39,  5.60s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9202, 'compress@10': 0.4222, 'time@10': 8.5406}:  40%|████      | 4/10 [00:25<00:41,  6.90s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.9079, 'compress@10': 0.534, 'time@10': 9.0789}:  40%|████      | 4/10 [00:31<00:41,  6.90s/it] {'epoch': 25, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.9079, 'compress@10': 0.534, 'time@10': 9.0789}:  50%|█████     | 5/10 [00:31<00:32,  6.45s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9189, 'compress@10': 0.5709, 'time@10': 9.3279}:  50%|█████     | 5/10 [00:42<00:32,  6.45s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9189, 'compress@10': 0.5709, 'time@10': 9.3279}:  60%|██████    | 6/10 [00:42<00:31,  7.86s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9188, 'compress@10': 0.5663, 'time@10': 9.6528}:  60%|██████    | 6/10 [00:47<00:31,  7.86s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9188, 'compress@10': 0.5663, 'time@10': 9.6528}:  70%|███████   | 7/10 [00:47<00:21,  7.20s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0195, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9291, 'compress@10': 0.5668, 'time@10': 9.5764}:  70%|███████   | 7/10 [00:57<00:21,  7.20s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0195, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9291, 'compress@10': 0.5668, 'time@10': 9.5764}:  80%|████████  | 8/10 [00:57<00:15,  7.80s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0199, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9332, 'compress@10': 0.563, 'time@10': 9.9523}:  80%|████████  | 8/10 [01:03<00:15,  7.80s/it]  {'epoch': 25, 'num_users': 6.3333, 'loss': 0.0199, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9332, 'compress@10': 0.563, 'time@10': 9.9523}:  90%|█████████ | 9/10 [01:03<00:07,  7.40s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.02, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9344, 'compress@10': 0.5259, 'time@10': 9.976}:  90%|█████████ | 9/10 [01:13<00:07,  7.40s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.02, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9344, 'compress@10': 0.5259, 'time@10': 9.976}: 100%|██████████| 10/10 [01:13<00:00,  8.27s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.02, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9344, 'compress@10': 0.5259, 'time@10': 9.976}: 100%|██████████| 10/10 [01:13<00:00,  7.38s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.020001844096519672
Avg hit ratio: 0.8807667531487565
Avg ndcg: 0.9344478475316965
Avg compression ratio: 0.5259197895386685
Avg train time: 9.975952291488648
Std train time: 1.5089717788569266
[0.9074074074074071, 0.12962962962962968, 0.05555555555555555, 0.3888888888888889, 0.9814814814814813, 0.7592592592592591, 0.5, 0.5740740740740741, 0.537037037037037, 0.1666666666666667]
[10, 12, 30, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8997, 'compress@10': 0.9123, 'time@10': 8.2592}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8997, 'compress@10': 0.9123, 'time@10': 8.2592}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.929, 'compress@10': 0.535, 'time@10': 8.4318}:  10%|█         | 1/10 [00:12<00:37,  4.17s/it]   {'epoch': 26, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.929, 'compress@10': 0.535, 'time@10': 8.4318}:  20%|██        | 2/10 [00:12<00:54,  6.80s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.905, 'compress@10': 0.4202, 'time@10': 8.3382}:  20%|██        | 2/10 [00:16<00:54,  6.80s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.905, 'compress@10': 0.4202, 'time@10': 8.3382}:  30%|███       | 3/10 [00:16<00:39,  5.58s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9187, 'compress@10': 0.4178, 'time@10': 8.4718}:  30%|███       | 3/10 [00:25<00:39,  5.58s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9187, 'compress@10': 0.4178, 'time@10': 8.4718}:  40%|████      | 4/10 [00:25<00:41,  6.89s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.9069, 'compress@10': 0.5306, 'time@10': 8.9692}:  40%|████      | 4/10 [00:31<00:41,  6.89s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.9069, 'compress@10': 0.5306, 'time@10': 8.9692}:  50%|█████     | 5/10 [00:31<00:31,  6.40s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.9137, 'compress@10': 0.5696, 'time@10': 9.208}:  50%|█████     | 5/10 [00:41<00:31,  6.40s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.9137, 'compress@10': 0.5696, 'time@10': 9.208}:  60%|██████    | 6/10 [00:41<00:31,  7.77s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0172, 'hit_ratio@10': 0.867, 'ndcg@10': 0.918, 'compress@10': 0.5625, 'time@10': 9.5472}:  60%|██████    | 6/10 [00:47<00:31,  7.77s/it] {'epoch': 26, 'num_users': 6.2857, 'loss': 0.0172, 'hit_ratio@10': 0.867, 'ndcg@10': 0.918, 'compress@10': 0.5625, 'time@10': 9.5472}:  70%|███████   | 7/10 [00:47<00:21,  7.14s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.927, 'compress@10': 0.5655, 'time@10': 9.4658}:  70%|███████   | 7/10 [00:56<00:21,  7.14s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.927, 'compress@10': 0.5655, 'time@10': 9.4658}:  80%|████████  | 8/10 [00:56<00:15,  7.71s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9317, 'compress@10': 0.5638, 'time@10': 9.8785}:  80%|████████  | 8/10 [01:03<00:15,  7.71s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9317, 'compress@10': 0.5638, 'time@10': 9.8785}:  90%|█████████ | 9/10 [01:03<00:07,  7.38s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9328, 'compress@10': 0.526, 'time@10': 9.8948}:  90%|█████████ | 9/10 [01:13<00:07,  7.38s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9328, 'compress@10': 0.526, 'time@10': 9.8948}: 100%|██████████| 10/10 [01:13<00:00,  8.22s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9328, 'compress@10': 0.526, 'time@10': 9.8948}: 100%|██████████| 10/10 [01:13<00:00,  7.33s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.018428188836617315
Avg hit ratio: 0.8731989088067186
Avg ndcg: 0.9328487421099945
Avg compression ratio: 0.5259725397180106
Avg train time: 9.894771957397461
Std train time: 1.5643579670935261
[0.9107142857142855, 0.12500000000000006, 0.05357142857142857, 0.375, 0.982142857142857, 0.7678571428571427, 0.48214285714285715, 0.5892857142857143, 0.5178571428571428, 0.19642857142857148]
[10, 12, 30, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9074, 'compress@10': 0.9154, 'time@10': 8.4009}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9074, 'compress@10': 0.9154, 'time@10': 8.4009}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9515, 'compress@10': 0.5343, 'time@10': 8.404}:  10%|█         | 1/10 [00:12<00:38,  4.24s/it] {'epoch': 27, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9515, 'compress@10': 0.5343, 'time@10': 8.404}:  20%|██        | 2/10 [00:12<00:53,  6.71s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9201, 'compress@10': 0.4191, 'time@10': 8.3146}:  20%|██        | 2/10 [00:16<00:53,  6.71s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9201, 'compress@10': 0.4191, 'time@10': 8.3146}:  30%|███       | 3/10 [00:16<00:38,  5.52s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9287, 'compress@10': 0.4137, 'time@10': 8.5007}:  30%|███       | 3/10 [00:25<00:38,  5.52s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9287, 'compress@10': 0.4137, 'time@10': 8.5007}:  40%|████      | 4/10 [00:25<00:41,  6.93s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.9149, 'compress@10': 0.5274, 'time@10': 9.0215}:  40%|████      | 4/10 [00:31<00:41,  6.93s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.9149, 'compress@10': 0.5274, 'time@10': 9.0215}:  50%|█████     | 5/10 [00:31<00:32,  6.45s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.924, 'compress@10': 0.5684, 'time@10': 9.2973}:  50%|█████     | 5/10 [00:42<00:32,  6.45s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.924, 'compress@10': 0.5684, 'time@10': 9.2973}:  60%|██████    | 6/10 [00:42<00:31,  7.90s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9254, 'compress@10': 0.559, 'time@10': 9.5861}:  60%|██████    | 6/10 [00:47<00:31,  7.90s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9254, 'compress@10': 0.559, 'time@10': 9.5861}:  70%|███████   | 7/10 [00:47<00:21,  7.18s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9339, 'compress@10': 0.5643, 'time@10': 9.5009}:  70%|███████   | 7/10 [00:56<00:21,  7.18s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9339, 'compress@10': 0.5643, 'time@10': 9.5009}:  80%|████████  | 8/10 [00:56<00:15,  7.74s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9375, 'compress@10': 0.5606, 'time@10': 9.9222}:  80%|████████  | 8/10 [01:03<00:15,  7.74s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9375, 'compress@10': 0.5606, 'time@10': 9.9222}:  90%|█████████ | 9/10 [01:03<00:07,  7.41s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9412, 'compress@10': 0.526, 'time@10': 9.9603}:  90%|█████████ | 9/10 [01:13<00:07,  7.41s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9412, 'compress@10': 0.526, 'time@10': 9.9603}: 100%|██████████| 10/10 [01:13<00:00,  8.32s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9412, 'compress@10': 0.526, 'time@10': 9.9603}: 100%|██████████| 10/10 [01:13<00:00,  7.39s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.015677088672440217
Avg hit ratio: 0.8828041045918805
Avg ndcg: 0.9411560035349316
Avg compression ratio: 0.5260409929671267
Avg train time: 9.960309290885926
Std train time: 1.5806677335164456
[0.9137931034482756, 0.12068965517241384, 0.05172413793103448, 0.3620689655172414, 0.982758620689655, 0.7413793103448274, 0.5, 0.603448275862069, 0.5344827586206896, 0.18965517241379315]
[10, 12, 30, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9134, 'compress@10': 0.9183, 'time@10': 8.3638}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9134, 'compress@10': 0.9183, 'time@10': 8.3638}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9406, 'compress@10': 0.5337, 'time@10': 8.3968}:  10%|█         | 1/10 [00:12<00:37,  4.22s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9406, 'compress@10': 0.5337, 'time@10': 8.3968}:  20%|██        | 2/10 [00:12<00:53,  6.72s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9128, 'compress@10': 0.4182, 'time@10': 8.3583}:  20%|██        | 2/10 [00:16<00:53,  6.72s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9128, 'compress@10': 0.4182, 'time@10': 8.3583}:  30%|███       | 3/10 [00:16<00:38,  5.56s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9272, 'compress@10': 0.4099, 'time@10': 8.5318}:  30%|███       | 3/10 [00:25<00:38,  5.56s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9272, 'compress@10': 0.4099, 'time@10': 8.5318}:  40%|████      | 4/10 [00:25<00:41,  6.95s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9173, 'compress@10': 0.5245, 'time@10': 9.0569}:  40%|████      | 4/10 [00:31<00:41,  6.95s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9173, 'compress@10': 0.5245, 'time@10': 9.0569}:  50%|█████     | 5/10 [00:31<00:32,  6.47s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0159, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9286, 'compress@10': 0.5616, 'time@10': 9.2855}:  50%|█████     | 5/10 [00:42<00:32,  6.47s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0159, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9286, 'compress@10': 0.5616, 'time@10': 9.2855}:  60%|██████    | 6/10 [00:42<00:31,  7.83s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0161, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9296, 'compress@10': 0.5557, 'time@10': 9.5767}:  60%|██████    | 6/10 [00:47<00:31,  7.83s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0161, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9296, 'compress@10': 0.5557, 'time@10': 9.5767}:  70%|███████   | 7/10 [00:47<00:21,  7.13s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0165, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9356, 'compress@10': 0.563, 'time@10': 9.481}:  70%|███████   | 7/10 [00:56<00:21,  7.13s/it]   {'epoch': 28, 'num_users': 6.125, 'loss': 0.0165, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9356, 'compress@10': 0.563, 'time@10': 9.481}:  80%|████████  | 8/10 [00:56<00:15,  7.68s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0169, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9389, 'compress@10': 0.5614, 'time@10': 9.9012}:  80%|████████  | 8/10 [01:03<00:15,  7.68s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0169, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9389, 'compress@10': 0.5614, 'time@10': 9.9012}:  90%|█████████ | 9/10 [01:03<00:07,  7.36s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.942, 'compress@10': 0.526, 'time@10': 9.9249}:  90%|█████████ | 9/10 [01:13<00:07,  7.36s/it]     {'epoch': 28, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.942, 'compress@10': 0.526, 'time@10': 9.9249}: 100%|██████████| 10/10 [01:13<00:00,  8.23s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.942, 'compress@10': 0.526, 'time@10': 9.9249}: 100%|██████████| 10/10 [01:13<00:00,  7.34s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.017679417074643853
Avg hit ratio: 0.8952362602498425
Avg ndcg: 0.9420172578851413
Avg compression ratio: 0.5260256038818748
Avg train time: 9.92485568523407
Std train time: 1.558662924061577
[0.9166666666666664, 0.11666666666666671, 0.05, 0.35, 0.9833333333333332, 0.7499999999999998, 0.48333333333333334, 0.5833333333333334, 0.5499999999999999, 0.2166666666666667]
[10, 12, 30, 14, 5, 10, 10, 11, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9159, 'compress@10': 0.921, 'time@10': 8.273}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9159, 'compress@10': 0.921, 'time@10': 8.273}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9469, 'compress@10': 0.5331, 'time@10': 8.3948}:  10%|█         | 1/10 [00:12<00:37,  4.20s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9469, 'compress@10': 0.5331, 'time@10': 8.3948}:  20%|██        | 2/10 [00:12<00:54,  6.76s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.917, 'compress@10': 0.4173, 'time@10': 8.3268}:  20%|██        | 2/10 [00:16<00:54,  6.76s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.917, 'compress@10': 0.4173, 'time@10': 8.3268}:  30%|███       | 3/10 [00:16<00:38,  5.56s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9277, 'compress@10': 0.4063, 'time@10': 8.4961}:  30%|███       | 3/10 [00:25<00:38,  5.56s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9277, 'compress@10': 0.4063, 'time@10': 8.4961}:  40%|████      | 4/10 [00:25<00:41,  6.94s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9188, 'compress@10': 0.5218, 'time@10': 9.0473}:  40%|████      | 4/10 [00:31<00:41,  6.94s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9188, 'compress@10': 0.5218, 'time@10': 9.0473}:  50%|█████     | 5/10 [00:31<00:32,  6.48s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9275, 'compress@10': 0.5607, 'time@10': 9.2781}:  50%|█████     | 5/10 [00:42<00:32,  6.48s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9275, 'compress@10': 0.5607, 'time@10': 9.2781}:  60%|██████    | 6/10 [00:42<00:31,  7.84s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9309, 'compress@10': 0.5526, 'time@10': 9.5948}:  60%|██████    | 6/10 [00:47<00:31,  7.84s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9309, 'compress@10': 0.5526, 'time@10': 9.5948}:  70%|███████   | 7/10 [00:47<00:21,  7.17s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9358, 'compress@10': 0.5579, 'time@10': 9.508}:  70%|███████   | 7/10 [00:56<00:21,  7.17s/it]  {'epoch': 29, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9358, 'compress@10': 0.5579, 'time@10': 9.508}:  80%|████████  | 8/10 [00:56<00:15,  7.73s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9394, 'compress@10': 0.5585, 'time@10': 9.9471}:  80%|████████  | 8/10 [01:03<00:15,  7.73s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9394, 'compress@10': 0.5585, 'time@10': 9.9471}:  90%|█████████ | 9/10 [01:03<00:07,  7.43s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9427, 'compress@10': 0.5261, 'time@10': 9.9487}:  90%|█████████ | 9/10 [01:13<00:07,  7.43s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9427, 'compress@10': 0.5261, 'time@10': 9.9487}: 100%|██████████| 10/10 [01:13<00:00,  8.22s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9427, 'compress@10': 0.5261, 'time@10': 9.9487}: 100%|██████████| 10/10 [01:13<00:00,  7.36s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.014554008172025087
Avg hit ratio: 0.9009505459641283
Avg ndcg: 0.9426955332408052
Avg compression ratio: 0.5260907510212744
Avg train time: 9.948686885833741
Std train time: 1.6307215028244
[0.9193548387096772, 0.14516129032258068, 0.048387096774193554, 0.3387096774193548, 0.9838709677419353, 0.725806451612903, 0.467741935483871, 0.5967741935483871, 0.564516129032258, 0.20967741935483875]
[10, 12, 30, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.9236, 'time@10': 8.7252}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.918, 'compress@10': 0.9236, 'time@10': 8.7252}:  10%|█         | 1/10 [00:04<00:39,  4.40s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9823, 'compress@10': 0.5482, 'time@10': 8.5994}:  10%|█         | 1/10 [00:12<00:39,  4.40s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9823, 'compress@10': 0.5482, 'time@10': 8.5994}:  20%|██        | 2/10 [00:12<00:54,  6.82s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9406, 'compress@10': 0.4269, 'time@10': 8.4421}:  20%|██        | 2/10 [00:17<00:54,  6.82s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9406, 'compress@10': 0.4269, 'time@10': 8.4421}:  30%|███       | 3/10 [00:17<00:39,  5.58s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.945, 'compress@10': 0.4108, 'time@10': 8.5619}:  30%|███       | 3/10 [00:26<00:39,  5.58s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.945, 'compress@10': 0.4108, 'time@10': 8.5619}:  40%|████      | 4/10 [00:26<00:41,  6.92s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9318, 'compress@10': 0.5254, 'time@10': 9.1202}:  40%|████      | 4/10 [00:31<00:41,  6.92s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9318, 'compress@10': 0.5254, 'time@10': 9.1202}:  50%|█████     | 5/10 [00:31<00:32,  6.49s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9393, 'compress@10': 0.5598, 'time@10': 9.3105}:  50%|█████     | 5/10 [00:42<00:32,  6.49s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9393, 'compress@10': 0.5598, 'time@10': 9.3105}:  60%|██████    | 6/10 [00:42<00:31,  7.78s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0174, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9402, 'compress@10': 0.5497, 'time@10': 9.6196}:  60%|██████    | 6/10 [00:47<00:31,  7.78s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0174, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9402, 'compress@10': 0.5497, 'time@10': 9.6196}:  70%|███████   | 7/10 [00:47<00:21,  7.13s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0181, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9478, 'compress@10': 0.557, 'time@10': 9.5395}:  70%|███████   | 7/10 [00:56<00:21,  7.13s/it]  {'epoch': 30, 'num_users': 6.125, 'loss': 0.0181, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9478, 'compress@10': 0.557, 'time@10': 9.5395}:  80%|████████  | 8/10 [00:56<00:15,  7.73s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9495, 'compress@10': 0.5593, 'time@10': 9.7304}:  80%|████████  | 8/10 [01:02<00:15,  7.73s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9495, 'compress@10': 0.5593, 'time@10': 9.7304}:  90%|█████████ | 9/10 [01:02<00:07,  7.08s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.901, 'ndcg@10': 0.952, 'compress@10': 0.5261, 'time@10': 9.7629}:  90%|█████████ | 9/10 [01:12<00:07,  7.08s/it]     {'epoch': 30, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.901, 'ndcg@10': 0.952, 'compress@10': 0.5261, 'time@10': 9.7629}: 100%|██████████| 10/10 [01:12<00:00,  8.01s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.901, 'ndcg@10': 0.952, 'compress@10': 0.5261, 'time@10': 9.7629}: 100%|██████████| 10/10 [01:12<00:00,  7.26s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.01747476816306575
Avg hit ratio: 0.9009505459641283
Avg ndcg: 0.9520415110115324
Avg compression ratio: 0.5260987996250917
Avg train time: 9.762858772277832
Std train time: 1.215056029744991
[0.9218749999999998, 0.17187500000000003, 0.04687500000000001, 0.328125, 0.9843749999999998, 0.7031249999999998, 0.484375, 0.609375, 0.546875, 0.20312500000000003]
[10, 12, 30, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.926, 'time@10': 8.3783}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.926, 'time@10': 8.3783}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9906, 'compress@10': 0.5623, 'time@10': 8.4536}:  10%|█         | 1/10 [00:12<00:38,  4.23s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9906, 'compress@10': 0.5623, 'time@10': 8.4536}:  20%|██        | 2/10 [00:12<00:54,  6.78s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9461, 'compress@10': 0.4359, 'time@10': 8.4164}:  20%|██        | 2/10 [00:17<00:54,  6.78s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9461, 'compress@10': 0.4359, 'time@10': 8.4164}:  30%|███       | 3/10 [00:17<00:39,  5.61s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9512, 'compress@10': 0.4149, 'time@10': 8.5234}:  30%|███       | 3/10 [00:25<00:39,  5.61s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9512, 'compress@10': 0.4149, 'time@10': 8.5234}:  40%|████      | 4/10 [00:25<00:41,  6.90s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.939, 'compress@10': 0.5289, 'time@10': 8.9825}:  40%|████      | 4/10 [00:31<00:41,  6.90s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.939, 'compress@10': 0.5289, 'time@10': 8.9825}:  50%|█████     | 5/10 [00:31<00:31,  6.38s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9526, 'compress@10': 0.559, 'time@10': 9.2267}:  50%|█████     | 5/10 [00:41<00:31,  6.38s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9526, 'compress@10': 0.559, 'time@10': 9.2267}:  60%|██████    | 6/10 [00:41<00:31,  7.77s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.95, 'compress@10': 0.5513, 'time@10': 9.546}:  60%|██████    | 6/10 [00:47<00:31,  7.77s/it]  {'epoch': 31, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.95, 'compress@10': 0.5513, 'time@10': 9.546}:  70%|███████   | 7/10 [00:47<00:21,  7.12s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0186, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9541, 'compress@10': 0.56, 'time@10': 9.4557}:  70%|███████   | 7/10 [00:56<00:21,  7.12s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0186, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9541, 'compress@10': 0.56, 'time@10': 9.4557}:  80%|████████  | 8/10 [00:56<00:15,  7.68s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9554, 'compress@10': 0.5599, 'time@10': 9.6724}:  80%|████████  | 8/10 [01:02<00:15,  7.68s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9554, 'compress@10': 0.5599, 'time@10': 9.6724}:  90%|█████████ | 9/10 [01:02<00:07,  7.07s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9547, 'compress@10': 0.5261, 'time@10': 9.7243}:  90%|█████████ | 9/10 [01:12<00:07,  7.07s/it]  {'epoch': 31, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9547, 'compress@10': 0.5261, 'time@10': 9.7243}: 100%|██████████| 10/10 [01:12<00:00,  8.05s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0186, 'hit_ratio@10': 0.9023, 'ndcg@10': 0.9547, 'compress@10': 0.5261, 'time@10': 9.7243}: 100%|██████████| 10/10 [01:12<00:00,  7.24s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.018639196007022886
Avg hit ratio: 0.9023156253292077
Avg ndcg: 0.9546762944146915
Avg compression ratio: 0.5260706057318842
Avg train time: 9.724327492713929
Std train time: 1.2052375326245328
[0.8939393939393937, 0.196969696969697, 0.04545454545454546, 0.3181818181818182, 0.9848484848484846, 0.7121212121212119, 0.4696969696969697, 0.6212121212121212, 0.5303030303030303, 0.2272727272727273]
[10, 12, 30, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8995, 'time@10': 8.4425}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8995, 'time@10': 8.4425}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9418, 'compress@10': 0.5612, 'time@10': 8.4993}:  10%|█         | 1/10 [00:12<00:38,  4.27s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9418, 'compress@10': 0.5612, 'time@10': 8.4993}:  20%|██        | 2/10 [00:12<00:54,  6.82s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9136, 'compress@10': 0.4347, 'time@10': 8.4529}:  20%|██        | 2/10 [00:17<00:54,  6.82s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9136, 'compress@10': 0.4347, 'time@10': 8.4529}:  30%|███       | 3/10 [00:17<00:39,  5.63s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9263, 'compress@10': 0.4117, 'time@10': 8.573}:  30%|███       | 3/10 [00:26<00:39,  5.63s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9263, 'compress@10': 0.4117, 'time@10': 8.573}:  40%|████      | 4/10 [00:26<00:41,  6.95s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9197, 'compress@10': 0.5264, 'time@10': 9.0584}:  40%|████      | 4/10 [00:31<00:41,  6.95s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9197, 'compress@10': 0.5264, 'time@10': 9.0584}:  50%|█████     | 5/10 [00:31<00:32,  6.44s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9285, 'compress@10': 0.5584, 'time@10': 9.2874}:  50%|█████     | 5/10 [00:42<00:32,  6.44s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9285, 'compress@10': 0.5584, 'time@10': 9.2874}:  60%|██████    | 6/10 [00:42<00:31,  7.81s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0109, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9321, 'compress@10': 0.5488, 'time@10': 9.6151}:  60%|██████    | 6/10 [00:47<00:31,  7.81s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0109, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9321, 'compress@10': 0.5488, 'time@10': 9.6151}:  70%|███████   | 7/10 [00:47<00:21,  7.16s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9368, 'compress@10': 0.5592, 'time@10': 9.5376}:  70%|███████   | 7/10 [00:56<00:21,  7.16s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9368, 'compress@10': 0.5592, 'time@10': 9.5376}:  80%|████████  | 8/10 [00:56<00:15,  7.76s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.94, 'compress@10': 0.5574, 'time@10': 9.749}:  80%|████████  | 8/10 [01:02<00:15,  7.76s/it]  {'epoch': 32, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.9079, 'ndcg@10': 0.94, 'compress@10': 0.5574, 'time@10': 9.749}:  90%|█████████ | 9/10 [01:02<00:07,  7.13s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9149, 'ndcg@10': 0.9436, 'compress@10': 0.5262, 'time@10': 9.779}:  90%|█████████ | 9/10 [01:12<00:07,  7.13s/it] {'epoch': 32, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9149, 'ndcg@10': 0.9436, 'compress@10': 0.5262, 'time@10': 9.779}: 100%|██████████| 10/10 [01:12<00:00,  8.04s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9149, 'ndcg@10': 0.9436, 'compress@10': 0.5262, 'time@10': 9.779}: 100%|██████████| 10/10 [01:12<00:00,  7.28s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.012376622247227829
Avg hit ratio: 0.9148501875411892
Avg ndcg: 0.9435998179465797
Avg compression ratio: 0.5261885134064637
Avg train time: 9.778974914550782
Std train time: 1.2093888647321172
[0.8970588235294116, 0.1911764705882353, 0.04411764705882354, 0.3382352941176471, 0.9852941176470587, 0.6911764705882351, 0.4558823529411765, 0.6323529411764706, 0.5441176470588235, 0.22058823529411767]
[10, 12, 30, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.9025, 'time@10': 8.5913}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.9025, 'time@10': 8.5913}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0392, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9538, 'compress@10': 0.5599, 'time@10': 8.4736}:  10%|█         | 1/10 [00:12<00:38,  4.33s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0392, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9538, 'compress@10': 0.5599, 'time@10': 8.4736}:  20%|██        | 2/10 [00:12<00:53,  6.72s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9216, 'compress@10': 0.4335, 'time@10': 8.2918}:  20%|██        | 2/10 [00:16<00:53,  6.72s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9216, 'compress@10': 0.4335, 'time@10': 8.2918}:  30%|███       | 3/10 [00:16<00:38,  5.48s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9352, 'compress@10': 0.4156, 'time@10': 8.4285}:  30%|███       | 3/10 [00:25<00:38,  5.48s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0243, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9352, 'compress@10': 0.4156, 'time@10': 8.4285}:  40%|████      | 4/10 [00:25<00:40,  6.82s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9283, 'compress@10': 0.5296, 'time@10': 8.94}:  40%|████      | 4/10 [00:31<00:40,  6.82s/it]   {'epoch': 33, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9283, 'compress@10': 0.5296, 'time@10': 8.94}:  50%|█████     | 5/10 [00:31<00:31,  6.36s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0217, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9361, 'compress@10': 0.5576, 'time@10': 9.1609}:  50%|█████     | 5/10 [00:41<00:31,  6.36s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0217, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9361, 'compress@10': 0.5576, 'time@10': 9.1609}:  60%|██████    | 6/10 [00:41<00:30,  7.70s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9381, 'compress@10': 0.5462, 'time@10': 9.4592}:  60%|██████    | 6/10 [00:47<00:30,  7.70s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9381, 'compress@10': 0.5462, 'time@10': 9.4592}:  70%|███████   | 7/10 [00:47<00:21,  7.03s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0202, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9445, 'compress@10': 0.5583, 'time@10': 9.369}:  70%|███████   | 7/10 [00:55<00:21,  7.03s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.0202, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9445, 'compress@10': 0.5583, 'time@10': 9.369}:  80%|████████  | 8/10 [00:55<00:15,  7.59s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9507, 'compress@10': 0.5582, 'time@10': 9.6206}:  80%|████████  | 8/10 [01:01<00:15,  7.59s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9507, 'compress@10': 0.5582, 'time@10': 9.6206}:  90%|█████████ | 9/10 [01:01<00:07,  7.05s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.9126, 'ndcg@10': 0.9542, 'compress@10': 0.5262, 'time@10': 9.6624}:  90%|█████████ | 9/10 [01:11<00:07,  7.05s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.9126, 'ndcg@10': 0.9542, 'compress@10': 0.5262, 'time@10': 9.6624}: 100%|██████████| 10/10 [01:11<00:00,  7.98s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.9126, 'ndcg@10': 0.9542, 'compress@10': 0.5262, 'time@10': 9.6624}: 100%|██████████| 10/10 [01:11<00:00,  7.18s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.02009817719821348
Avg hit ratio: 0.912627965318967
Avg ndcg: 0.9541773692960701
Avg compression ratio: 0.5261825017418079
Avg train time: 9.662449836730957
Std train time: 1.2670305074931807
[0.8714285714285712, 0.2142857142857143, 0.042857142857142864, 0.35714285714285715, 0.9857142857142855, 0.6714285714285712, 0.4428571428571429, 0.6428571428571428, 0.557142857142857, 0.2142857142857143]
[10, 12, 31, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8782, 'time@10': 8.4005}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8782, 'time@10': 8.4005}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9561, 'compress@10': 0.5589, 'time@10': 8.4111}:  10%|█         | 1/10 [00:12<00:38,  4.24s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9561, 'compress@10': 0.5589, 'time@10': 8.4111}:  20%|██        | 2/10 [00:12<00:53,  6.73s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9231, 'compress@10': 0.4325, 'time@10': 8.3765}:  20%|██        | 2/10 [00:16<00:53,  6.73s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9231, 'compress@10': 0.4325, 'time@10': 8.3765}:  30%|███       | 3/10 [00:16<00:39,  5.57s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9328, 'compress@10': 0.4194, 'time@10': 8.4991}:  30%|███       | 3/10 [00:25<00:39,  5.57s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9328, 'compress@10': 0.4194, 'time@10': 8.4991}:  40%|████      | 4/10 [00:25<00:41,  6.89s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9275, 'compress@10': 0.5327, 'time@10': 9.0216}:  40%|████      | 4/10 [00:31<00:41,  6.89s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9275, 'compress@10': 0.5327, 'time@10': 9.0216}:  50%|█████     | 5/10 [00:31<00:32,  6.43s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.9149, 'ndcg@10': 0.9405, 'compress@10': 0.557, 'time@10': 9.2779}:  50%|█████     | 5/10 [00:42<00:32,  6.43s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.9149, 'ndcg@10': 0.9405, 'compress@10': 0.557, 'time@10': 9.2779}:  60%|██████    | 6/10 [00:42<00:31,  7.84s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.9214, 'ndcg@10': 0.9416, 'compress@10': 0.5439, 'time@10': 9.5979}:  60%|██████    | 6/10 [00:47<00:31,  7.84s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.9214, 'ndcg@10': 0.9416, 'compress@10': 0.5439, 'time@10': 9.5979}:  70%|███████   | 7/10 [00:47<00:21,  7.18s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.9276, 'ndcg@10': 0.9487, 'compress@10': 0.5576, 'time@10': 9.4968}:  70%|███████   | 7/10 [00:56<00:21,  7.18s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.9276, 'ndcg@10': 0.9487, 'compress@10': 0.5576, 'time@10': 9.4968}:  80%|████████  | 8/10 [00:56<00:15,  7.70s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9538, 'compress@10': 0.5589, 'time@10': 9.7694}:  80%|████████  | 8/10 [01:02<00:15,  7.70s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9538, 'compress@10': 0.5589, 'time@10': 9.7694}:  90%|█████████ | 9/10 [01:02<00:07,  7.18s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9227, 'ndcg@10': 0.9535, 'compress@10': 0.5262, 'time@10': 9.7894}:  90%|█████████ | 9/10 [01:12<00:07,  7.18s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9227, 'ndcg@10': 0.9535, 'compress@10': 0.5262, 'time@10': 9.7894}: 100%|██████████| 10/10 [01:12<00:00,  8.05s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9227, 'ndcg@10': 0.9535, 'compress@10': 0.5262, 'time@10': 9.7894}: 100%|██████████| 10/10 [01:12<00:00,  7.27s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.01718262037060366
Avg hit ratio: 0.9226842889236776
Avg ndcg: 0.9534865691189204
Avg compression ratio: 0.5262358653696853
Avg train time: 9.789434266090392
Std train time: 1.3371444649623323
[0.847222222222222, 0.20833333333333334, 0.04166666666666667, 0.3472222222222222, 0.9861111111111109, 0.6805555555555552, 0.4305555555555556, 0.6527777777777777, 0.5694444444444443, 0.23611111111111113]
[10, 12, 31, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.8552, 'time@10': 8.5606}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.8552, 'time@10': 8.5606}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9464, 'compress@10': 0.5446, 'time@10': 8.5632}:  10%|█         | 1/10 [00:12<00:38,  4.32s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9464, 'compress@10': 0.5446, 'time@10': 8.5632}:  20%|██        | 2/10 [00:12<00:54,  6.84s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9166, 'compress@10': 0.4226, 'time@10': 8.5781}:  20%|██        | 2/10 [00:17<00:54,  6.84s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9166, 'compress@10': 0.4226, 'time@10': 8.5781}:  30%|███       | 3/10 [00:17<00:39,  5.70s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9286, 'compress@10': 0.4096, 'time@10': 8.7213}:  30%|███       | 3/10 [00:26<00:39,  5.70s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9286, 'compress@10': 0.4096, 'time@10': 8.7213}:  40%|████      | 4/10 [00:26<00:42,  7.08s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9249, 'compress@10': 0.5249, 'time@10': 9.21}:  40%|████      | 4/10 [00:32<00:42,  7.08s/it] {'epoch': 35, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9249, 'compress@10': 0.5249, 'time@10': 9.21}:  50%|█████     | 5/10 [00:32<00:32,  6.55s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9334, 'compress@10': 0.552, 'time@10': 9.4459}:  50%|█████     | 5/10 [00:42<00:32,  6.55s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9334, 'compress@10': 0.552, 'time@10': 9.4459}:  60%|██████    | 6/10 [00:42<00:31,  7.95s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0083, 'hit_ratio@10': 0.9136, 'ndcg@10': 0.9366, 'compress@10': 0.5379, 'time@10': 9.7368}:  60%|██████    | 6/10 [00:48<00:31,  7.95s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0083, 'hit_ratio@10': 0.9136, 'ndcg@10': 0.9366, 'compress@10': 0.5379, 'time@10': 9.7368}:  70%|███████   | 7/10 [00:48<00:21,  7.24s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9414, 'compress@10': 0.5535, 'time@10': 9.6294}:  70%|███████   | 7/10 [00:57<00:21,  7.24s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9414, 'compress@10': 0.5535, 'time@10': 9.6294}:  80%|████████  | 8/10 [00:57<00:15,  7.77s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0103, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9445, 'compress@10': 0.5567, 'time@10': 9.8258}:  80%|████████  | 8/10 [01:03<00:15,  7.77s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0103, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9445, 'compress@10': 0.5567, 'time@10': 9.8258}:  90%|█████████ | 9/10 [01:03<00:07,  7.14s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0097, 'hit_ratio@10': 0.9144, 'ndcg@10': 0.9477, 'compress@10': 0.5264, 'time@10': 9.8476}:  90%|█████████ | 9/10 [01:13<00:07,  7.14s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0097, 'hit_ratio@10': 0.9144, 'ndcg@10': 0.9477, 'compress@10': 0.5264, 'time@10': 9.8476}: 100%|██████████| 10/10 [01:13<00:00,  8.05s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0097, 'hit_ratio@10': 0.9144, 'ndcg@10': 0.9477, 'compress@10': 0.5264, 'time@10': 9.8476}: 100%|██████████| 10/10 [01:13<00:00,  7.32s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.009745248688884491
Avg hit ratio: 0.9143791173926997
Avg ndcg: 0.9476540817279657
Avg compression ratio: 0.5263504463003459
Avg train time: 9.84764792919159
Std train time: 1.171053740507099
[0.8513513513513511, 0.20270270270270271, 0.04054054054054054, 0.36486486486486486, 0.9864864864864863, 0.6621621621621618, 0.41891891891891897, 0.6621621621621621, 0.5810810810810809, 0.22972972972972974]
[10, 12, 31, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.8592, 'time@10': 8.5461}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.8592, 'time@10': 8.5461}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9442, 'compress@10': 0.5438, 'time@10': 8.4789}:  10%|█         | 1/10 [00:12<00:38,  4.31s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9442, 'compress@10': 0.5438, 'time@10': 8.4789}:  20%|██        | 2/10 [00:12<00:53,  6.75s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9152, 'compress@10': 0.4217, 'time@10': 8.4714}:  20%|██        | 2/10 [00:17<00:53,  6.75s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9152, 'compress@10': 0.4217, 'time@10': 8.4714}:  30%|███       | 3/10 [00:17<00:39,  5.61s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9292, 'compress@10': 0.4132, 'time@10': 8.5966}:  30%|███       | 3/10 [00:26<00:39,  5.61s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9292, 'compress@10': 0.4132, 'time@10': 8.5966}:  40%|████      | 4/10 [00:26<00:41,  6.96s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0133, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9257, 'compress@10': 0.5279, 'time@10': 9.015}:  40%|████      | 4/10 [00:31<00:41,  6.96s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.0133, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9257, 'compress@10': 0.5279, 'time@10': 9.015}:  50%|█████     | 5/10 [00:31<00:31,  6.39s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9338, 'compress@10': 0.5515, 'time@10': 9.2824}:  50%|█████     | 5/10 [00:42<00:31,  6.39s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9338, 'compress@10': 0.5515, 'time@10': 9.2824}:  60%|██████    | 6/10 [00:42<00:31,  7.84s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9366, 'compress@10': 0.5359, 'time@10': 9.5496}:  60%|██████    | 6/10 [00:47<00:31,  7.84s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9366, 'compress@10': 0.5359, 'time@10': 9.5496}:  70%|███████   | 7/10 [00:47<00:21,  7.11s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9433, 'compress@10': 0.5529, 'time@10': 9.4447}:  70%|███████   | 7/10 [00:56<00:21,  7.11s/it]  {'epoch': 36, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9433, 'compress@10': 0.5529, 'time@10': 9.4447}:  80%|████████  | 8/10 [00:56<00:15,  7.63s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.946, 'compress@10': 0.5574, 'time@10': 9.6559}:  80%|████████  | 8/10 [01:02<00:15,  7.63s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.946, 'compress@10': 0.5574, 'time@10': 9.6559}:  90%|█████████ | 9/10 [01:02<00:07,  7.03s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9488, 'compress@10': 0.5263, 'time@10': 9.7072}:  90%|█████████ | 9/10 [01:12<00:07,  7.03s/it]  {'epoch': 36, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9488, 'compress@10': 0.5263, 'time@10': 9.7072}: 100%|██████████| 10/10 [01:12<00:00,  8.01s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9488, 'compress@10': 0.5263, 'time@10': 9.7072}: 100%|██████████| 10/10 [01:12<00:00,  7.24s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.01450320972457132
Avg hit ratio: 0.9000759939928022
Avg ndcg: 0.9488431849988048
Avg compression ratio: 0.5263403612432105
Avg train time: 9.707247495651245
Std train time: 1.1361560740506536
[0.8552631578947366, 0.19736842105263158, 0.03947368421052632, 0.381578947368421, 0.9868421052631577, 0.6447368421052628, 0.4078947368421053, 0.6710526315789472, 0.5657894736842104, 0.25]
[10, 12, 31, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.8629, 'time@10': 8.505}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.8629, 'time@10': 8.505}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9788, 'compress@10': 0.5431, 'time@10': 8.4995}:  10%|█         | 1/10 [00:12<00:38,  4.29s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9788, 'compress@10': 0.5431, 'time@10': 8.4995}:  20%|██        | 2/10 [00:12<00:54,  6.79s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9382, 'compress@10': 0.4209, 'time@10': 8.4309}:  20%|██        | 2/10 [00:17<00:54,  6.79s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9382, 'compress@10': 0.4209, 'time@10': 8.4309}:  30%|███       | 3/10 [00:17<00:39,  5.61s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9448, 'compress@10': 0.4166, 'time@10': 8.5974}:  30%|███       | 3/10 [00:26<00:39,  5.61s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9448, 'compress@10': 0.4166, 'time@10': 8.5974}:  40%|████      | 4/10 [00:26<00:41,  7.00s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9404, 'compress@10': 0.5307, 'time@10': 9.12}:  40%|████      | 4/10 [00:31<00:41,  7.00s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9404, 'compress@10': 0.5307, 'time@10': 9.12}:  50%|█████     | 5/10 [00:31<00:32,  6.51s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9479, 'compress@10': 0.551, 'time@10': 9.3656}:  50%|█████     | 5/10 [00:42<00:32,  6.51s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9479, 'compress@10': 0.551, 'time@10': 9.3656}:  60%|██████    | 6/10 [00:42<00:31,  7.91s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9469, 'compress@10': 0.534, 'time@10': 9.7017}:  60%|██████    | 6/10 [00:48<00:31,  7.91s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9469, 'compress@10': 0.534, 'time@10': 9.7017}:  70%|███████   | 7/10 [00:48<00:21,  7.25s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0189, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9539, 'compress@10': 0.5523, 'time@10': 9.5899}:  70%|███████   | 7/10 [00:57<00:21,  7.25s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0189, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9539, 'compress@10': 0.5523, 'time@10': 9.5899}:  80%|████████  | 8/10 [00:57<00:15,  7.76s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9552, 'compress@10': 0.5552, 'time@10': 9.7752}:  80%|████████  | 8/10 [01:02<00:15,  7.76s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9552, 'compress@10': 0.5552, 'time@10': 9.7752}:  90%|█████████ | 9/10 [01:02<00:07,  7.11s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9573, 'compress@10': 0.5263, 'time@10': 9.8206}:  90%|█████████ | 9/10 [01:13<00:07,  7.11s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9573, 'compress@10': 0.5263, 'time@10': 9.8206}: 100%|██████████| 10/10 [01:13<00:00,  8.08s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0174, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9573, 'compress@10': 0.5263, 'time@10': 9.8206}: 100%|██████████| 10/10 [01:13<00:00,  7.31s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.01738839769572685
Avg hit ratio: 0.902933136849945
Avg ndcg: 0.9572844476001849
Avg compression ratio: 0.5263476716395704
Avg train time: 9.820582008361816
Std train time: 1.2544654185923905
[0.8333333333333331, 0.21794871794871795, 0.038461538461538464, 0.37179487179487175, 0.987179487179487, 0.6538461538461535, 0.42307692307692313, 0.6794871794871794, 0.5512820512820512, 0.24358974358974358]
[10, 12, 31, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.8421, 'time@10': 8.1892}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.8421, 'time@10': 8.1892}:  10%|█         | 1/10 [00:04<00:37,  4.14s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9485, 'compress@10': 0.5426, 'time@10': 8.4621}:  10%|█         | 1/10 [00:12<00:37,  4.14s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9485, 'compress@10': 0.5426, 'time@10': 8.4621}:  20%|██        | 2/10 [00:12<00:54,  6.87s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9181, 'compress@10': 0.4204, 'time@10': 8.4282}:  20%|██        | 2/10 [00:17<00:54,  6.87s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9181, 'compress@10': 0.4204, 'time@10': 8.4282}:  30%|███       | 3/10 [00:17<00:39,  5.66s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9304, 'compress@10': 0.4138, 'time@10': 8.6328}:  30%|███       | 3/10 [00:26<00:39,  5.66s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9304, 'compress@10': 0.4138, 'time@10': 8.6328}:  40%|████      | 4/10 [00:26<00:42,  7.10s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9293, 'compress@10': 0.5286, 'time@10': 9.1095}:  40%|████      | 4/10 [00:31<00:42,  7.10s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9293, 'compress@10': 0.5286, 'time@10': 9.1095}:  50%|█████     | 5/10 [00:31<00:32,  6.54s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9372, 'compress@10': 0.5507, 'time@10': 9.3556}:  50%|█████     | 5/10 [00:42<00:32,  6.54s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9372, 'compress@10': 0.5507, 'time@10': 9.3556}:  60%|██████    | 6/10 [00:42<00:31,  7.93s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9395, 'compress@10': 0.5358, 'time@10': 9.6782}:  60%|██████    | 6/10 [00:48<00:31,  7.93s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9395, 'compress@10': 0.5358, 'time@10': 9.6782}:  70%|███████   | 7/10 [00:48<00:21,  7.25s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9444, 'compress@10': 0.5549, 'time@10': 9.554}:  70%|███████   | 7/10 [00:57<00:21,  7.25s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9444, 'compress@10': 0.5549, 'time@10': 9.554}:  80%|████████  | 8/10 [00:57<00:15,  7.72s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9468, 'compress@10': 0.5559, 'time@10': 9.7539}:  80%|████████  | 8/10 [01:02<00:15,  7.72s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9468, 'compress@10': 0.5559, 'time@10': 9.7539}:  90%|█████████ | 9/10 [01:02<00:07,  7.09s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9497, 'compress@10': 0.5264, 'time@10': 9.7959}:  90%|█████████ | 9/10 [01:13<00:07,  7.09s/it]    {'epoch': 38, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9497, 'compress@10': 0.5264, 'time@10': 9.7959}: 100%|██████████| 10/10 [01:13<00:00,  8.06s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9497, 'compress@10': 0.5264, 'time@10': 9.7959}: 100%|██████████| 10/10 [01:13<00:00,  7.31s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.010581493528473854
Avg hit ratio: 0.891033495272884
Avg ndcg: 0.9497041680455496
Avg compression ratio: 0.5263965957653224
Avg train time: 9.795930218696594
Std train time: 1.2367087075897478
[0.8124999999999998, 0.2375, 0.037500000000000006, 0.38749999999999996, 0.9874999999999998, 0.6374999999999997, 0.41250000000000003, 0.6874999999999999, 0.5624999999999999, 0.2375]
[10, 12, 31, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.8224, 'time@10': 8.6946}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.8224, 'time@10': 8.6946}:  10%|█         | 1/10 [00:04<00:39,  4.40s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9464, 'compress@10': 0.5422, 'time@10': 8.5982}:  10%|█         | 1/10 [00:12<00:39,  4.40s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9464, 'compress@10': 0.5422, 'time@10': 8.5982}:  20%|██        | 2/10 [00:12<00:54,  6.83s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9166, 'compress@10': 0.4198, 'time@10': 8.4878}:  20%|██        | 2/10 [00:17<00:54,  6.83s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9166, 'compress@10': 0.4198, 'time@10': 8.4878}:  30%|███       | 3/10 [00:17<00:39,  5.62s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9321, 'compress@10': 0.4172, 'time@10': 8.6413}:  30%|███       | 3/10 [00:26<00:39,  5.62s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9321, 'compress@10': 0.4172, 'time@10': 8.6413}:  40%|████      | 4/10 [00:26<00:42,  7.01s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9316, 'compress@10': 0.5313, 'time@10': 9.1037}:  40%|████      | 4/10 [00:31<00:42,  7.01s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9316, 'compress@10': 0.5313, 'time@10': 9.1037}:  50%|█████     | 5/10 [00:31<00:32,  6.47s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9391, 'compress@10': 0.5504, 'time@10': 9.3965}:  50%|█████     | 5/10 [00:42<00:32,  6.47s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9391, 'compress@10': 0.5504, 'time@10': 9.3965}:  60%|██████    | 6/10 [00:42<00:31,  7.97s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9419, 'compress@10': 0.534, 'time@10': 9.7137}:  60%|██████    | 6/10 [00:48<00:31,  7.97s/it] {'epoch': 39, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9419, 'compress@10': 0.534, 'time@10': 9.7137}:  70%|███████   | 7/10 [00:48<00:21,  7.28s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.9216, 'ndcg@10': 0.9491, 'compress@10': 0.5543, 'time@10': 9.5977}:  70%|███████   | 7/10 [00:57<00:21,  7.28s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.9216, 'ndcg@10': 0.9491, 'compress@10': 0.5543, 'time@10': 9.5977}:  80%|████████  | 8/10 [00:57<00:15,  7.77s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.951, 'compress@10': 0.5566, 'time@10': 9.8327}:  80%|████████  | 8/10 [01:03<00:15,  7.77s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.951, 'compress@10': 0.5566, 'time@10': 9.8327}:  90%|█████████ | 9/10 [01:03<00:07,  7.19s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.95, 'compress@10': 0.5264, 'time@10': 9.8655}:  90%|█████████ | 9/10 [01:13<00:07,  7.19s/it]    {'epoch': 39, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.95, 'compress@10': 0.5264, 'time@10': 9.8655}: 100%|██████████| 10/10 [01:13<00:00,  8.12s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.95, 'compress@10': 0.5264, 'time@10': 9.8655}: 100%|██████████| 10/10 [01:13<00:00,  7.35s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.012161243578405685
Avg hit ratio: 0.9178537717705799
Avg ndcg: 0.9500340181963244
Avg compression ratio: 0.5264385180097804
Avg train time: 9.86548101902008
Std train time: 1.2757464545076822
[0.8170731707317072, 0.23170731707317072, 0.03658536585365854, 0.40243902439024387, 0.9878048780487804, 0.6219512195121949, 0.4024390243902439, 0.695121951219512, 0.548780487804878, 0.25609756097560976]
[10, 12, 31, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.8267, 'time@10': 8.4909}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.8267, 'time@10': 8.4909}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9407, 'compress@10': 0.5416, 'time@10': 8.5588}:  10%|█         | 1/10 [00:12<00:38,  4.28s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9407, 'compress@10': 0.5416, 'time@10': 8.5588}:  20%|██        | 2/10 [00:12<00:54,  6.86s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9129, 'compress@10': 0.4191, 'time@10': 8.5231}:  20%|██        | 2/10 [00:17<00:54,  6.86s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9129, 'compress@10': 0.4191, 'time@10': 8.5231}:  30%|███       | 3/10 [00:17<00:39,  5.68s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9257, 'compress@10': 0.4203, 'time@10': 8.6587}:  30%|███       | 3/10 [00:26<00:39,  5.68s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9257, 'compress@10': 0.4203, 'time@10': 8.6587}:  40%|████      | 4/10 [00:26<00:42,  7.03s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9267, 'compress@10': 0.5338, 'time@10': 9.1247}:  40%|████      | 4/10 [00:31<00:42,  7.03s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9267, 'compress@10': 0.5338, 'time@10': 9.1247}:  50%|█████     | 5/10 [00:31<00:32,  6.49s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9351, 'compress@10': 0.5499, 'time@10': 9.3549}:  50%|█████     | 5/10 [00:42<00:32,  6.49s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9351, 'compress@10': 0.5499, 'time@10': 9.3549}:  60%|██████    | 6/10 [00:42<00:31,  7.87s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.01, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.938, 'compress@10': 0.5323, 'time@10': 9.6453}:  60%|██████    | 6/10 [00:48<00:31,  7.87s/it]   {'epoch': 40, 'num_users': 6.2857, 'loss': 0.01, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.938, 'compress@10': 0.5323, 'time@10': 9.6453}:  70%|███████   | 7/10 [00:48<00:21,  7.17s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9467, 'compress@10': 0.5537, 'time@10': 9.5204}:  70%|███████   | 7/10 [00:56<00:21,  7.17s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9467, 'compress@10': 0.5537, 'time@10': 9.5204}:  80%|████████  | 8/10 [00:56<00:15,  7.65s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9488, 'compress@10': 0.5546, 'time@10': 9.743}:  80%|████████  | 8/10 [01:02<00:15,  7.65s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9488, 'compress@10': 0.5546, 'time@10': 9.743}:  90%|█████████ | 9/10 [01:02<00:07,  7.07s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9502, 'compress@10': 0.5264, 'time@10': 9.812}:  90%|█████████ | 9/10 [01:13<00:07,  7.07s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9502, 'compress@10': 0.5264, 'time@10': 9.812}: 100%|██████████| 10/10 [01:13<00:00,  8.12s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9502, 'compress@10': 0.5264, 'time@10': 9.812}: 100%|██████████| 10/10 [01:13<00:00,  7.31s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.01237326646769028
Avg hit ratio: 0.9035680574848657
Avg ndcg: 0.9502375332743458
Avg compression ratio: 0.5264416697595101
Avg train time: 9.811980128288269
Std train time: 1.2076105771539258
[0.7976190476190474, 0.24999999999999997, 0.03571428571428572, 0.39285714285714285, 0.988095238095238, 0.6071428571428569, 0.3928571428571429, 0.7023809523809522, 0.5595238095238094, 0.27380952380952384]
[10, 12, 31, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.8083, 'time@10': 8.2121}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.8083, 'time@10': 8.2121}:  10%|█         | 1/10 [00:04<00:37,  4.14s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.9253, 'ndcg@10': 1.01, 'compress@10': 0.5412, 'time@10': 8.5507}:  10%|█         | 1/10 [00:13<00:37,  4.14s/it]  {'epoch': 41, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.9253, 'ndcg@10': 1.01, 'compress@10': 0.5412, 'time@10': 8.5507}:  20%|██        | 2/10 [00:13<00:55,  6.96s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.855, 'ndcg@10': 0.959, 'compress@10': 0.4186, 'time@10': 8.56}:  20%|██        | 2/10 [00:17<00:55,  6.96s/it]  {'epoch': 41, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.855, 'ndcg@10': 0.959, 'compress@10': 0.4186, 'time@10': 8.56}:  30%|███       | 3/10 [00:17<00:40,  5.76s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.96, 'compress@10': 0.4176, 'time@10': 8.7144}:  30%|███       | 3/10 [00:26<00:40,  5.76s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.96, 'compress@10': 0.4176, 'time@10': 8.7144}:  40%|████      | 4/10 [00:26<00:42,  7.13s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9564, 'compress@10': 0.5318, 'time@10': 9.1511}:  40%|████      | 4/10 [00:32<00:42,  7.13s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9564, 'compress@10': 0.5318, 'time@10': 9.1511}:  50%|█████     | 5/10 [00:32<00:32,  6.54s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9657, 'compress@10': 0.5458, 'time@10': 9.4003}:  50%|█████     | 5/10 [00:42<00:32,  6.54s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9657, 'compress@10': 0.5458, 'time@10': 9.4003}:  60%|██████    | 6/10 [00:42<00:31,  7.95s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9643, 'compress@10': 0.5274, 'time@10': 9.7439}:  60%|██████    | 6/10 [00:48<00:31,  7.95s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9643, 'compress@10': 0.5274, 'time@10': 9.7439}:  70%|███████   | 7/10 [00:48<00:21,  7.30s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.968, 'compress@10': 0.5503, 'time@10': 9.6079}:  70%|███████   | 7/10 [00:57<00:21,  7.30s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.968, 'compress@10': 0.5503, 'time@10': 9.6079}:  80%|████████  | 8/10 [00:57<00:15,  7.74s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.968, 'compress@10': 0.5528, 'time@10': 9.8113}:  80%|████████  | 8/10 [01:03<00:15,  7.74s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.968, 'compress@10': 0.5528, 'time@10': 9.8113}:  90%|█████████ | 9/10 [01:03<00:07,  7.12s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.9189, 'ndcg@10': 0.9688, 'compress@10': 0.5265, 'time@10': 9.8591}:  90%|█████████ | 9/10 [01:13<00:07,  7.12s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.9189, 'ndcg@10': 0.9688, 'compress@10': 0.5265, 'time@10': 9.8591}: 100%|██████████| 10/10 [01:13<00:00,  8.11s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.9189, 'ndcg@10': 0.9688, 'compress@10': 0.5265, 'time@10': 9.8591}: 100%|██████████| 10/10 [01:13<00:00,  7.35s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.014913864139047068
Avg hit ratio: 0.9188501875411893
Avg ndcg: 0.9688425563119496
Avg compression ratio: 0.5265100037222656
Avg train time: 9.859106874465942
Std train time: 1.2399853905619134
[0.7790697674418603, 0.26744186046511625, 0.034883720930232565, 0.4069767441860465, 0.9651162790697674, 0.6162790697674416, 0.3837209302325582, 0.7093023255813952, 0.569767441860465, 0.2674418604651163]
[10, 12, 31, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.7907, 'time@10': 8.4559}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.7907, 'time@10': 8.4559}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9488, 'compress@10': 0.5409, 'time@10': 8.5886}:  10%|█         | 1/10 [00:13<00:38,  4.26s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9488, 'compress@10': 0.5409, 'time@10': 8.5886}:  20%|██        | 2/10 [00:13<00:55,  6.91s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9183, 'compress@10': 0.4182, 'time@10': 8.5341}:  20%|██        | 2/10 [00:17<00:55,  6.91s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9183, 'compress@10': 0.4182, 'time@10': 8.5341}:  30%|███       | 3/10 [00:17<00:39,  5.70s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9313, 'compress@10': 0.4207, 'time@10': 8.6714}:  30%|███       | 3/10 [00:26<00:39,  5.70s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9313, 'compress@10': 0.4207, 'time@10': 8.6714}:  40%|████      | 4/10 [00:26<00:42,  7.05s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9337, 'compress@10': 0.5297, 'time@10': 9.1063}:  40%|████      | 4/10 [00:31<00:42,  7.05s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9337, 'compress@10': 0.5297, 'time@10': 9.1063}:  50%|█████     | 5/10 [00:31<00:32,  6.48s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9409, 'compress@10': 0.5455, 'time@10': 9.381}:  50%|█████     | 5/10 [00:42<00:32,  6.48s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9409, 'compress@10': 0.5455, 'time@10': 9.381}:  60%|██████    | 6/10 [00:42<00:31,  7.94s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.943, 'compress@10': 0.526, 'time@10': 9.6918}:  60%|██████    | 6/10 [00:48<00:31,  7.94s/it]  {'epoch': 42, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.943, 'compress@10': 0.526, 'time@10': 9.6918}:  70%|███████   | 7/10 [00:48<00:21,  7.25s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.908, 'ndcg@10': 0.947, 'compress@10': 0.5499, 'time@10': 9.5622}:  70%|███████   | 7/10 [00:57<00:21,  7.25s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.908, 'ndcg@10': 0.947, 'compress@10': 0.5499, 'time@10': 9.5622}:  80%|████████  | 8/10 [00:57<00:15,  7.71s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9491, 'compress@10': 0.5535, 'time@10': 9.778}:  80%|████████  | 8/10 [01:02<00:15,  7.71s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9491, 'compress@10': 0.5535, 'time@10': 9.778}:  90%|█████████ | 9/10 [01:02<00:07,  7.11s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9495, 'compress@10': 0.5265, 'time@10': 9.8233}:  90%|█████████ | 9/10 [01:13<00:07,  7.11s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9495, 'compress@10': 0.5265, 'time@10': 9.8233}: 100%|██████████| 10/10 [01:13<00:00,  8.09s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9495, 'compress@10': 0.5265, 'time@10': 9.8233}: 100%|██████████| 10/10 [01:13<00:00,  7.32s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.010964320375578934
Avg hit ratio: 0.9069505459641283
Avg ndcg: 0.9494958316263793
Avg compression ratio: 0.5265406669835087
Avg train time: 9.823253512382507
Std train time: 1.219091765241424
[0.7613636363636362, 0.26136363636363635, 0.034090909090909095, 0.42045454545454547, 0.9659090909090908, 0.6022727272727271, 0.37500000000000006, 0.7159090909090907, 0.5795454545454545, 0.2840909090909091]
[10, 12, 31, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.7739, 'time@10': 8.2966}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.7739, 'time@10': 8.2966}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0063, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9501, 'compress@10': 0.5296, 'time@10': 8.526}:  10%|█         | 1/10 [00:12<00:37,  4.19s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.0063, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9501, 'compress@10': 0.5296, 'time@10': 8.526}:  20%|██        | 2/10 [00:12<00:55,  6.90s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9191, 'compress@10': 0.4104, 'time@10': 8.5813}:  20%|██        | 2/10 [00:17<00:55,  6.90s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9191, 'compress@10': 0.4104, 'time@10': 8.5813}:  30%|███       | 3/10 [00:17<00:40,  5.75s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9304, 'compress@10': 0.4181, 'time@10': 8.7031}:  30%|███       | 3/10 [00:26<00:40,  5.75s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9304, 'compress@10': 0.4181, 'time@10': 8.7031}:  40%|████      | 4/10 [00:26<00:42,  7.07s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0075, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9329, 'compress@10': 0.5278, 'time@10': 9.1886}:  40%|████      | 4/10 [00:32<00:42,  7.07s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0075, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9329, 'compress@10': 0.5278, 'time@10': 9.1886}:  50%|█████     | 5/10 [00:32<00:32,  6.54s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9402, 'compress@10': 0.5417, 'time@10': 9.4176}:  50%|█████     | 5/10 [00:42<00:32,  6.54s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9402, 'compress@10': 0.5417, 'time@10': 9.4176}:  60%|██████    | 6/10 [00:42<00:31,  7.92s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9429, 'compress@10': 0.5214, 'time@10': 9.7034}:  60%|██████    | 6/10 [00:48<00:31,  7.92s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9429, 'compress@10': 0.5214, 'time@10': 9.7034}:  70%|███████   | 7/10 [00:48<00:21,  7.21s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.951, 'compress@10': 0.5468, 'time@10': 9.564}:  70%|███████   | 7/10 [00:57<00:21,  7.21s/it]   {'epoch': 43, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.951, 'compress@10': 0.5468, 'time@10': 9.564}:  80%|████████  | 8/10 [00:57<00:15,  7.66s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9526, 'compress@10': 0.5517, 'time@10': 9.7959}:  80%|████████  | 8/10 [01:02<00:15,  7.66s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9526, 'compress@10': 0.5517, 'time@10': 9.7959}:  90%|█████████ | 9/10 [01:02<00:07,  7.10s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9545, 'compress@10': 0.5266, 'time@10': 9.8412}:  90%|█████████ | 9/10 [01:13<00:07,  7.10s/it] {'epoch': 43, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9545, 'compress@10': 0.5266, 'time@10': 9.8412}: 100%|██████████| 10/10 [01:13<00:00,  8.09s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9545, 'compress@10': 0.5266, 'time@10': 9.8412}: 100%|██████████| 10/10 [01:13<00:00,  7.32s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.010451861329480588
Avg hit ratio: 0.8994851081761098
Avg ndcg: 0.9545395409231843
Avg compression ratio: 0.5265960565075409
Avg train time: 9.841194367408752
Std train time: 1.2314141344610998
[0.7444444444444444, 0.25555555555555554, 0.03333333333333334, 0.41111111111111115, 0.9666666666666666, 0.5888888888888887, 0.38888888888888895, 0.722222222222222, 0.5888888888888888, 0.30000000000000004]
[10, 12, 31, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.7579, 'time@10': 8.4608}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.7579, 'time@10': 8.4608}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9429, 'compress@10': 0.5187, 'time@10': 8.5475}:  10%|█         | 1/10 [00:12<00:38,  4.27s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9429, 'compress@10': 0.5187, 'time@10': 8.5475}:  20%|██        | 2/10 [00:12<00:54,  6.86s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.9143, 'compress@10': 0.403, 'time@10': 8.4077}:  20%|██        | 2/10 [00:17<00:54,  6.86s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.9143, 'compress@10': 0.403, 'time@10': 8.4077}:  30%|███       | 3/10 [00:17<00:39,  5.60s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9265, 'compress@10': 0.4103, 'time@10': 8.5345}:  30%|███       | 3/10 [00:25<00:39,  5.60s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9265, 'compress@10': 0.4103, 'time@10': 8.5345}:  40%|████      | 4/10 [00:25<00:41,  6.92s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9301, 'compress@10': 0.5217, 'time@10': 8.9889}:  40%|████      | 4/10 [00:31<00:41,  6.92s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9301, 'compress@10': 0.5217, 'time@10': 8.9889}:  50%|█████     | 5/10 [00:31<00:31,  6.39s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9379, 'compress@10': 0.5344, 'time@10': 9.2214}:  50%|█████     | 5/10 [00:41<00:31,  6.39s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9379, 'compress@10': 0.5344, 'time@10': 9.2214}:  60%|██████    | 6/10 [00:41<00:31,  7.76s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.939, 'compress@10': 0.5171, 'time@10': 9.5723}:  60%|██████    | 6/10 [00:47<00:31,  7.76s/it] {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.939, 'compress@10': 0.5171, 'time@10': 9.5723}:  70%|███████   | 7/10 [00:47<00:21,  7.15s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9475, 'compress@10': 0.5437, 'time@10': 9.4761}:  70%|███████   | 7/10 [00:56<00:21,  7.15s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9475, 'compress@10': 0.5437, 'time@10': 9.4761}:  80%|████████  | 8/10 [00:56<00:15,  7.69s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9496, 'compress@10': 0.5501, 'time@10': 9.7001}:  80%|████████  | 8/10 [01:02<00:15,  7.69s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9496, 'compress@10': 0.5501, 'time@10': 9.7001}:  90%|█████████ | 9/10 [01:02<00:07,  7.09s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9516, 'compress@10': 0.5266, 'time@10': 9.7384}:  90%|█████████ | 9/10 [01:12<00:07,  7.09s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9516, 'compress@10': 0.5266, 'time@10': 9.7384}: 100%|██████████| 10/10 [01:12<00:00,  8.03s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9516, 'compress@10': 0.5266, 'time@10': 9.7384}: 100%|██████████| 10/10 [01:12<00:00,  7.25s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.01271993349792654
Avg hit ratio: 0.9110160861587007
Avg ndcg: 0.9516144319187934
Avg compression ratio: 0.5266396034695375
Avg train time: 9.738387846946717
Std train time: 1.2454350412762434
[0.7282608695652173, 0.2717391304347826, 0.03260869565217392, 0.4239130434782609, 0.9673913043478259, 0.5760869565217389, 0.4021739130434783, 0.7282608695652172, 0.576086956521739, 0.29347826086956524]
[10, 12, 31, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 0.7425, 'time@10': 8.1036}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 0.7425, 'time@10': 8.1036}:  10%|█         | 1/10 [00:04<00:36,  4.09s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.9414, 'ndcg@10': 1.019, 'compress@10': 0.5189, 'time@10': 8.4237}:  10%|█         | 1/10 [00:12<00:36,  4.09s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.9414, 'ndcg@10': 1.019, 'compress@10': 0.5189, 'time@10': 8.4237}:  20%|██        | 2/10 [00:12<00:54,  6.85s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9651, 'compress@10': 0.4029, 'time@10': 8.368}:  20%|██        | 2/10 [00:17<00:54,  6.85s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9651, 'compress@10': 0.4029, 'time@10': 8.368}:  30%|███       | 3/10 [00:17<00:39,  5.63s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9643, 'compress@10': 0.4133, 'time@10': 8.5538}:  30%|███       | 3/10 [00:26<00:39,  5.63s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9643, 'compress@10': 0.4133, 'time@10': 8.5538}:  40%|████      | 4/10 [00:26<00:42,  7.02s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0144, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9615, 'compress@10': 0.5242, 'time@10': 9.0011}:  40%|████      | 4/10 [00:31<00:42,  7.02s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0144, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9615, 'compress@10': 0.5242, 'time@10': 9.0011}:  50%|█████     | 5/10 [00:31<00:32,  6.45s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9664, 'compress@10': 0.5344, 'time@10': 9.257}:  50%|█████     | 5/10 [00:42<00:32,  6.45s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9664, 'compress@10': 0.5344, 'time@10': 9.257}:  60%|██████    | 6/10 [00:42<00:31,  7.85s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9653, 'compress@10': 0.519, 'time@10': 9.5985}:  60%|██████    | 6/10 [00:48<00:31,  7.85s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9653, 'compress@10': 0.519, 'time@10': 9.5985}:  70%|███████   | 7/10 [00:48<00:21,  7.20s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9684, 'compress@10': 0.5461, 'time@10': 9.4929}:  70%|███████   | 7/10 [00:56<00:21,  7.20s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9684, 'compress@10': 0.5461, 'time@10': 9.4929}:  80%|████████  | 8/10 [00:56<00:15,  7.71s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9681, 'compress@10': 0.5508, 'time@10': 9.684}:  80%|████████  | 8/10 [01:02<00:15,  7.71s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9681, 'compress@10': 0.5508, 'time@10': 9.684}:  90%|█████████ | 9/10 [01:02<00:07,  7.06s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9681, 'compress@10': 0.5266, 'time@10': 9.741}:  90%|█████████ | 9/10 [01:12<00:07,  7.06s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9681, 'compress@10': 0.5266, 'time@10': 9.741}: 100%|██████████| 10/10 [01:12<00:00,  8.06s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9681, 'compress@10': 0.5266, 'time@10': 9.741}: 100%|██████████| 10/10 [01:12<00:00,  7.28s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.014101378569345176
Avg hit ratio: 0.9027109146277228
Avg ndcg: 0.9681278177557211
Avg compression ratio: 0.5266457092278106
Avg train time: 9.740954852104187
Std train time: 1.2266698166517314
[0.7127659574468084, 0.28723404255319146, 0.03191489361702128, 0.4361702127659575, 0.9468085106382977, 0.5851063829787232, 0.3936170212765958, 0.7340425531914891, 0.5638297872340424, 0.30851063829787234]
[10, 12, 31, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9351, 'compress@10': 0.7279, 'time@10': 8.3501}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9351, 'compress@10': 0.7279, 'time@10': 8.3501}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9514, 'compress@10': 0.5191, 'time@10': 8.58}:  10%|█         | 1/10 [00:13<00:37,  4.21s/it]  {'epoch': 46, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9514, 'compress@10': 0.5191, 'time@10': 8.58}:  20%|██        | 2/10 [00:13<00:55,  6.94s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.92, 'compress@10': 0.4028, 'time@10': 8.3551}:  20%|██        | 2/10 [00:17<00:55,  6.94s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.92, 'compress@10': 0.4028, 'time@10': 8.3551}:  30%|███       | 3/10 [00:17<00:39,  5.59s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9311, 'compress@10': 0.4162, 'time@10': 8.5138}:  30%|███       | 3/10 [00:26<00:39,  5.59s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9311, 'compress@10': 0.4162, 'time@10': 8.5138}:  40%|████      | 4/10 [00:26<00:41,  6.95s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.935, 'compress@10': 0.5225, 'time@10': 9.0007}:  40%|████      | 4/10 [00:31<00:41,  6.95s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.935, 'compress@10': 0.5225, 'time@10': 9.0007}:  50%|█████     | 5/10 [00:31<00:32,  6.43s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0067, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.942, 'compress@10': 0.5345, 'time@10': 9.2548}:  50%|█████     | 5/10 [00:42<00:32,  6.43s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0067, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.942, 'compress@10': 0.5345, 'time@10': 9.2548}:  60%|██████    | 6/10 [00:42<00:31,  7.84s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0066, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9444, 'compress@10': 0.5178, 'time@10': 9.5558}:  60%|██████    | 6/10 [00:47<00:31,  7.84s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0066, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9444, 'compress@10': 0.5178, 'time@10': 9.5558}:  70%|███████   | 7/10 [00:47<00:21,  7.15s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.9105, 'ndcg@10': 0.9486, 'compress@10': 0.5458, 'time@10': 9.4032}:  70%|███████   | 7/10 [00:56<00:21,  7.15s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.9105, 'ndcg@10': 0.9486, 'compress@10': 0.5458, 'time@10': 9.4032}:  80%|████████  | 8/10 [00:56<00:15,  7.54s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0083, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9509, 'compress@10': 0.5492, 'time@10': 9.5746}:  80%|████████  | 8/10 [01:01<00:15,  7.54s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0083, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9509, 'compress@10': 0.5492, 'time@10': 9.5746}:  90%|█████████ | 9/10 [01:01<00:06,  6.91s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9534, 'compress@10': 0.5267, 'time@10': 9.5838}:  90%|█████████ | 9/10 [01:11<00:06,  6.91s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9534, 'compress@10': 0.5267, 'time@10': 9.5838}: 100%|██████████| 10/10 [01:11<00:00,  7.77s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9534, 'compress@10': 0.5267, 'time@10': 9.5838}: 100%|██████████| 10/10 [01:11<00:00,  7.15s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.008753191309499603
Avg hit ratio: 0.9061005715657668
Avg ndcg: 0.9533705053666137
Avg compression ratio: 0.5266839719594281
Avg train time: 9.583798837661742
Std train time: 1.2092887698108417
[0.6979166666666665, 0.28124999999999994, 0.03125000000000001, 0.44791666666666674, 0.9479166666666665, 0.5729166666666664, 0.38541666666666674, 0.7395833333333331, 0.5729166666666665, 0.3229166666666667]
[10, 12, 32, 14, 5, 10, 10, 11, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 0.7138, 'time@10': 8.0659}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 0.7138, 'time@10': 8.0659}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9531, 'compress@10': 0.5091, 'time@10': 8.1793}:  10%|█         | 1/10 [00:12<00:36,  4.08s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9531, 'compress@10': 0.5091, 'time@10': 8.1793}:  20%|██        | 2/10 [00:12<00:52,  6.58s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0041, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9211, 'compress@10': 0.396, 'time@10': 8.1863}:  20%|██        | 2/10 [00:16<00:52,  6.58s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0041, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9211, 'compress@10': 0.396, 'time@10': 8.1863}:  30%|███       | 3/10 [00:16<00:38,  5.46s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9339, 'compress@10': 0.4139, 'time@10': 8.2992}:  30%|███       | 3/10 [00:25<00:38,  5.46s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9339, 'compress@10': 0.4139, 'time@10': 8.2992}:  40%|████      | 4/10 [00:25<00:40,  6.73s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9372, 'compress@10': 0.5209, 'time@10': 8.6653}:  40%|████      | 4/10 [00:30<00:40,  6.73s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9372, 'compress@10': 0.5209, 'time@10': 8.6653}:  50%|█████     | 5/10 [00:30<00:30,  6.14s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9438, 'compress@10': 0.5311, 'time@10': 8.8655}:  50%|█████     | 5/10 [00:40<00:30,  6.14s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9438, 'compress@10': 0.5311, 'time@10': 8.8655}:  60%|██████    | 6/10 [00:40<00:29,  7.42s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9461, 'compress@10': 0.5138, 'time@10': 9.1235}:  60%|██████    | 6/10 [00:45<00:29,  7.42s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9461, 'compress@10': 0.5138, 'time@10': 9.1235}:  70%|███████   | 7/10 [00:45<00:20,  6.75s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9533, 'compress@10': 0.543, 'time@10': 8.9817}:  70%|███████   | 7/10 [00:53<00:20,  6.75s/it]  {'epoch': 47, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9533, 'compress@10': 0.543, 'time@10': 8.9817}:  80%|████████  | 8/10 [00:53<00:14,  7.16s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.955, 'compress@10': 0.5477, 'time@10': 9.1206}:  80%|████████  | 8/10 [00:58<00:14,  7.16s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.955, 'compress@10': 0.5477, 'time@10': 9.1206}:  90%|█████████ | 9/10 [00:58<00:06,  6.53s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9572, 'compress@10': 0.5267, 'time@10': 9.0775}:  90%|█████████ | 9/10 [01:07<00:06,  6.53s/it]  {'epoch': 47, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9572, 'compress@10': 0.5267, 'time@10': 9.0775}: 100%|██████████| 10/10 [01:07<00:00,  7.21s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9572, 'compress@10': 0.5267, 'time@10': 9.0775}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.010679753865676715
Avg hit ratio: 0.9027109146277228
Avg ndcg: 0.957243319201473
Avg compression ratio: 0.5267292748995762
Avg train time: 9.077492833137512
Std train time: 0.9768919051470674
[0.683673469387755, 0.2755102040816326, 0.03061224489795919, 0.4591836734693878, 0.9489795918367345, 0.5612244897959181, 0.39795918367346944, 0.7448979591836733, 0.5816326530612244, 0.3163265306122449]
[10, 12, 32, 14, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 0.7003, 'time@10': 7.1449}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 0.7003, 'time@10': 7.1449}:  10%|█         | 1/10 [00:03<00:32,  3.61s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9456, 'compress@10': 0.4996, 'time@10': 7.2095}:  10%|█         | 1/10 [00:10<00:32,  3.61s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9456, 'compress@10': 0.4996, 'time@10': 7.2095}:  20%|██        | 2/10 [00:10<00:46,  5.79s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9161, 'compress@10': 0.3894, 'time@10': 7.2224}:  20%|██        | 2/10 [00:14<00:46,  5.79s/it]  {'epoch': 48, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9161, 'compress@10': 0.3894, 'time@10': 7.2224}:  30%|███       | 3/10 [00:14<00:33,  4.82s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9282, 'compress@10': 0.4117, 'time@10': 7.3892}:  30%|███       | 3/10 [00:22<00:33,  4.82s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9282, 'compress@10': 0.4117, 'time@10': 7.3892}:  40%|████      | 4/10 [00:22<00:36,  6.04s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9331, 'compress@10': 0.5194, 'time@10': 7.7768}:  40%|████      | 4/10 [00:27<00:36,  6.04s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9331, 'compress@10': 0.5194, 'time@10': 7.7768}:  50%|█████     | 5/10 [00:27<00:27,  5.56s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.9404, 'compress@10': 0.528, 'time@10': 8.0138}:  50%|█████     | 5/10 [00:36<00:27,  5.56s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.9404, 'compress@10': 0.528, 'time@10': 8.0138}:  60%|██████    | 6/10 [00:36<00:27,  6.81s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.9205, 'ndcg@10': 0.943, 'compress@10': 0.5128, 'time@10': 8.2565}:  60%|██████    | 6/10 [00:41<00:27,  6.81s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.9205, 'ndcg@10': 0.943, 'compress@10': 0.5128, 'time@10': 8.2565}:  70%|███████   | 7/10 [00:41<00:18,  6.18s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9269, 'ndcg@10': 0.9413, 'compress@10': 0.5427, 'time@10': 8.2588}:  70%|███████   | 7/10 [00:49<00:18,  6.18s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9269, 'ndcg@10': 0.9413, 'compress@10': 0.5427, 'time@10': 8.2588}:  80%|████████  | 8/10 [00:49<00:13,  6.86s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0102, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9443, 'compress@10': 0.5484, 'time@10': 8.3988}:  80%|████████  | 8/10 [00:54<00:13,  6.86s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0102, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9443, 'compress@10': 0.5484, 'time@10': 8.3988}:  90%|█████████ | 9/10 [00:54<00:06,  6.21s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9221, 'ndcg@10': 0.9439, 'compress@10': 0.5267, 'time@10': 8.4533}:  90%|█████████ | 9/10 [01:03<00:06,  6.21s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9221, 'ndcg@10': 0.9439, 'compress@10': 0.5267, 'time@10': 8.4533}: 100%|██████████| 10/10 [01:03<00:00,  7.07s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.9221, 'ndcg@10': 0.9439, 'compress@10': 0.5267, 'time@10': 8.4533}: 100%|██████████| 10/10 [01:03<00:00,  6.34s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.011810691407582142
Avg hit ratio: 0.922075993992802
Avg ndcg: 0.9439438492567787
Avg compression ratio: 0.5267403380878027
Avg train time: 8.453340458869935
Std train time: 0.9584051939981709
[0.6699999999999999, 0.29, 0.030000000000000006, 0.45000000000000007, 0.9499999999999998, 0.5499999999999997, 0.39000000000000007, 0.7499999999999998, 0.5899999999999999, 0.33]
[11, 13, 33, 15, 5, 10, 10, 12, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.6874, 'time@10': 7.751}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.6874, 'time@10': 7.751}:  10%|█         | 1/10 [00:03<00:35,  3.91s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9905, 'compress@10': 0.5001, 'time@10': 7.8014}:  10%|█         | 1/10 [00:11<00:35,  3.91s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9905, 'compress@10': 0.5001, 'time@10': 7.8014}:  20%|██        | 2/10 [00:11<00:50,  6.25s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9461, 'compress@10': 0.3896, 'time@10': 7.6192}:  20%|██        | 2/10 [00:15<00:50,  6.25s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9461, 'compress@10': 0.3896, 'time@10': 7.6192}:  30%|███       | 3/10 [00:15<00:35,  5.07s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9506, 'compress@10': 0.4096, 'time@10': 7.8983}:  30%|███       | 3/10 [00:24<00:35,  5.07s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9506, 'compress@10': 0.4096, 'time@10': 7.8983}:  40%|████      | 4/10 [00:24<00:39,  6.54s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9515, 'compress@10': 0.5179, 'time@10': 8.2769}:  40%|████      | 4/10 [00:29<00:39,  6.54s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.9515, 'compress@10': 0.5179, 'time@10': 8.2769}:  50%|█████     | 5/10 [00:29<00:29,  5.96s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.96, 'compress@10': 0.5249, 'time@10': 8.4187}:  50%|█████     | 5/10 [00:38<00:29,  5.96s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.96, 'compress@10': 0.5249, 'time@10': 8.4187}:  60%|██████    | 6/10 [00:38<00:28,  7.05s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9598, 'compress@10': 0.5091, 'time@10': 8.6534}:  60%|██████    | 6/10 [00:43<00:28,  7.05s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9598, 'compress@10': 0.5091, 'time@10': 8.6534}:  70%|███████   | 7/10 [00:43<00:19,  6.41s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9613, 'compress@10': 0.5401, 'time@10': 8.6803}:  70%|███████   | 7/10 [00:52<00:19,  6.41s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9613, 'compress@10': 0.5401, 'time@10': 8.6803}:  80%|████████  | 8/10 [00:52<00:14,  7.20s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9621, 'compress@10': 0.547, 'time@10': 8.8115}:  80%|████████  | 8/10 [00:57<00:14,  7.20s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9621, 'compress@10': 0.547, 'time@10': 8.8115}:  90%|█████████ | 9/10 [00:57<00:06,  6.50s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9636, 'compress@10': 0.5268, 'time@10': 8.8037}:  90%|█████████ | 9/10 [01:06<00:06,  6.50s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9636, 'compress@10': 0.5268, 'time@10': 8.8037}: 100%|██████████| 10/10 [01:06<00:00,  7.20s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9636, 'compress@10': 0.5268, 'time@10': 8.8037}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.011257161440948061
Avg hit ratio: 0.8920299110434934
Avg ndcg: 0.9636399963360189
Avg compression ratio: 0.5267942098429704
Avg train time: 8.803682422637939
Std train time: 0.9060433008521339
[0.676470588235294, 0.30392156862745096, 0.02941176470588236, 0.4607843137254903, 0.9313725490196076, 0.5588235294117644, 0.3823529411764707, 0.7352941176470587, 0.5980392156862744, 0.3235294117647059]
[12, 14, 34, 15, 5, 10, 10, 12, 7, 10]
