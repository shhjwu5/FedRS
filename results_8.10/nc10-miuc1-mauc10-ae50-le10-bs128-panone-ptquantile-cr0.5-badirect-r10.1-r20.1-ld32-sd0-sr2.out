  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.154, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5039, 'compress@10': 0.5263, 'time@10': 9.7869}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.154, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5039, 'compress@10': 0.5263, 'time@10': 9.7869}:  10%|█         | 1/10 [00:04<00:44,  4.93s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1119, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.6512, 'compress@10': 0.5212, 'time@10': 8.5046}:  10%|█         | 1/10 [00:12<00:44,  4.93s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1119, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.6512, 'compress@10': 0.5212, 'time@10': 8.5046}:  20%|██        | 2/10 [00:12<00:50,  6.30s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8011, 'hit_ratio@10': 0.5939, 'ndcg@10': 0.4341, 'compress@10': 0.538, 'time@10': 6.626}:  20%|██        | 2/10 [00:13<00:50,  6.30s/it]  {'epoch': 0, 'num_users': 5.0, 'loss': 0.8011, 'hit_ratio@10': 0.5939, 'ndcg@10': 0.4341, 'compress@10': 0.538, 'time@10': 6.626}:  30%|███       | 3/10 [00:13<00:28,  4.10s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6245, 'hit_ratio@10': 0.6419, 'ndcg@10': 0.4938, 'compress@10': 0.5329, 'time@10': 6.57}:  30%|███       | 3/10 [00:20<00:28,  4.10s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6245, 'hit_ratio@10': 0.6419, 'ndcg@10': 0.4938, 'compress@10': 0.5329, 'time@10': 6.57}:  40%|████      | 4/10 [00:20<00:30,  5.02s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5182, 'hit_ratio@10': 0.6775, 'ndcg@10': 0.5474, 'compress@10': 0.5283, 'time@10': 10.0076}:  40%|████      | 4/10 [00:32<00:30,  5.02s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5182, 'hit_ratio@10': 0.6775, 'ndcg@10': 0.5474, 'compress@10': 0.5283, 'time@10': 10.0076}:  50%|█████     | 5/10 [00:32<00:37,  7.52s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.446, 'hit_ratio@10': 0.6831, 'ndcg@10': 0.5899, 'compress@10': 0.5255, 'time@10': 10.0943}:  50%|█████     | 5/10 [00:42<00:37,  7.52s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.446, 'hit_ratio@10': 0.6831, 'ndcg@10': 0.5899, 'compress@10': 0.5255, 'time@10': 10.0943}:  60%|██████    | 6/10 [00:42<00:34,  8.55s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3968, 'hit_ratio@10': 0.7055, 'ndcg@10': 0.5916, 'compress@10': 0.5247, 'time@10': 10.2834}:  60%|██████    | 6/10 [00:48<00:34,  8.55s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3968, 'hit_ratio@10': 0.7055, 'ndcg@10': 0.5916, 'compress@10': 0.5247, 'time@10': 10.2834}:  70%|███████   | 7/10 [00:48<00:22,  7.63s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3532, 'hit_ratio@10': 0.7316, 'ndcg@10': 0.6164, 'compress@10': 0.5234, 'time@10': 10.0106}:  70%|███████   | 7/10 [00:56<00:22,  7.63s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3532, 'hit_ratio@10': 0.7316, 'ndcg@10': 0.6164, 'compress@10': 0.5234, 'time@10': 10.0106}:  80%|████████  | 8/10 [00:56<00:15,  7.79s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3192, 'hit_ratio@10': 0.7297, 'ndcg@10': 0.6495, 'compress@10': 0.5224, 'time@10': 10.6726}:  80%|████████  | 8/10 [01:04<00:15,  7.79s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3192, 'hit_ratio@10': 0.7297, 'ndcg@10': 0.6495, 'compress@10': 0.5224, 'time@10': 10.6726}:  90%|█████████ | 9/10 [01:04<00:07,  7.86s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2924, 'hit_ratio@10': 0.7499, 'ndcg@10': 0.6694, 'compress@10': 0.5213, 'time@10': 10.6557}:  90%|█████████ | 9/10 [01:15<00:07,  7.86s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2924, 'hit_ratio@10': 0.7499, 'ndcg@10': 0.6694, 'compress@10': 0.5213, 'time@10': 10.6557}: 100%|██████████| 10/10 [01:15<00:00,  8.70s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2924, 'hit_ratio@10': 0.7499, 'ndcg@10': 0.6694, 'compress@10': 0.5213, 'time@10': 10.6557}: 100%|██████████| 10/10 [01:15<00:00,  7.51s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.2924434496464544
Avg hit ratio: 0.7498927352594584
Avg ndcg: 0.6693651145373233
Avg compression ratio: 0.5212749006657823
Avg train time: 10.65574598312378
Std train time: 5.461768647435085
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[9, 7, 3, 6, 22, 10, 11, 8, 15, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0567, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8284, 'compress@10': 0.5263, 'time@10': 8.0866}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0567, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8284, 'compress@10': 0.5263, 'time@10': 8.0866}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0568, 'hit_ratio@10': 0.7394, 'ndcg@10': 0.8417, 'compress@10': 0.5212, 'time@10': 6.541}:  10%|█         | 1/10 [00:09<00:36,  4.08s/it] {'epoch': 1, 'num_users': 7.0, 'loss': 0.0568, 'hit_ratio@10': 0.7394, 'ndcg@10': 0.8417, 'compress@10': 0.5212, 'time@10': 6.541}:  20%|██        | 2/10 [00:09<00:37,  4.64s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.121, 'hit_ratio@10': 0.6834, 'ndcg@10': 0.6618, 'compress@10': 0.538, 'time@10': 4.6734}:  20%|██        | 2/10 [00:09<00:37,  4.64s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.121, 'hit_ratio@10': 0.6834, 'ndcg@10': 0.6618, 'compress@10': 0.538, 'time@10': 4.6734}:  30%|███       | 3/10 [00:09<00:19,  2.75s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.106, 'hit_ratio@10': 0.709, 'ndcg@10': 0.7053, 'compress@10': 0.5329, 'time@10': 4.4544}:  30%|███       | 3/10 [00:13<00:19,  2.75s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.106, 'hit_ratio@10': 0.709, 'ndcg@10': 0.7053, 'compress@10': 0.5329, 'time@10': 4.4544}:  40%|████      | 4/10 [00:13<00:19,  3.18s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0973, 'hit_ratio@10': 0.7392, 'ndcg@10': 0.7259, 'compress@10': 0.5283, 'time@10': 14.0171}:  40%|████      | 4/10 [00:39<00:19,  3.18s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0973, 'hit_ratio@10': 0.7392, 'ndcg@10': 0.7259, 'compress@10': 0.5283, 'time@10': 14.0171}:  50%|█████     | 5/10 [00:39<00:57, 11.47s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0941, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.74, 'compress@10': 0.5255, 'time@10': 13.4348}:  50%|█████     | 5/10 [00:50<00:57, 11.47s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0941, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.74, 'compress@10': 0.5255, 'time@10': 13.4348}:  60%|██████    | 6/10 [00:50<00:44, 11.16s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0867, 'hit_ratio@10': 0.7699, 'ndcg@10': 0.7575, 'compress@10': 0.5247, 'time@10': 13.3076}:  60%|██████    | 6/10 [00:56<00:44, 11.16s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0867, 'hit_ratio@10': 0.7699, 'ndcg@10': 0.7575, 'compress@10': 0.5247, 'time@10': 13.3076}:  70%|███████   | 7/10 [00:56<00:28,  9.57s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0808, 'hit_ratio@10': 0.7879, 'ndcg@10': 0.7724, 'compress@10': 0.5234, 'time@10': 12.4366}:  70%|███████   | 7/10 [01:02<00:28,  9.57s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0808, 'hit_ratio@10': 0.7879, 'ndcg@10': 0.7724, 'compress@10': 0.5234, 'time@10': 12.4366}:  80%|████████  | 8/10 [01:02<00:17,  8.56s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0754, 'hit_ratio@10': 0.7798, 'ndcg@10': 0.7883, 'compress@10': 0.5224, 'time@10': 13.8481}:  80%|████████  | 8/10 [01:15<00:17,  8.56s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0754, 'hit_ratio@10': 0.7798, 'ndcg@10': 0.7883, 'compress@10': 0.5224, 'time@10': 13.8481}:  90%|█████████ | 9/10 [01:15<00:09,  9.82s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0725, 'hit_ratio@10': 0.795, 'ndcg@10': 0.7941, 'compress@10': 0.5213, 'time@10': 13.4638}:  90%|█████████ | 9/10 [01:25<00:09,  9.82s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.0725, 'hit_ratio@10': 0.795, 'ndcg@10': 0.7941, 'compress@10': 0.5213, 'time@10': 13.4638}: 100%|██████████| 10/10 [01:25<00:00,  9.89s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0725, 'hit_ratio@10': 0.795, 'ndcg@10': 0.7941, 'compress@10': 0.5213, 'time@10': 13.4638}: 100%|██████████| 10/10 [01:25<00:00,  8.55s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.0725083932793509
Avg hit ratio: 0.7949643389999926
Avg ndcg: 0.7940552180784752
Avg compression ratio: 0.5212749006657823
Avg train time: 13.463844084739685
Std train time: 14.370958453058877
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[7, 2, 1, 1, 61, 10, 13, 4, 29, 9]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0527, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8373, 'compress@10': 0.5263, 'time@10': 6.1705}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0527, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8373, 'compress@10': 0.5263, 'time@10': 6.1705}:  10%|█         | 1/10 [00:03<00:28,  3.12s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0813, 'hit_ratio@10': 0.7334, 'ndcg@10': 0.7558, 'compress@10': 0.5212, 'time@10': 3.8224}:  10%|█         | 1/10 [00:04<00:28,  3.12s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0813, 'hit_ratio@10': 0.7334, 'ndcg@10': 0.7558, 'compress@10': 0.5212, 'time@10': 3.8224}:  20%|██        | 2/10 [00:04<00:17,  2.18s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.1268, 'hit_ratio@10': 0.6318, 'ndcg@10': 0.6397, 'compress@10': 0.538, 'time@10': 2.653}:  20%|██        | 2/10 [00:04<00:17,  2.18s/it]  {'epoch': 2, 'num_users': 5.0, 'loss': 0.1268, 'hit_ratio@10': 0.6318, 'ndcg@10': 0.6397, 'compress@10': 0.538, 'time@10': 2.653}:  30%|███       | 3/10 [00:04<00:08,  1.27s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.1462, 'hit_ratio@10': 0.5942, 'ndcg@10': 0.6144, 'compress@10': 0.5331, 'time@10': 2.1579}:  30%|███       | 3/10 [00:05<00:08,  1.27s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.1462, 'hit_ratio@10': 0.5942, 'ndcg@10': 0.6144, 'compress@10': 0.5331, 'time@10': 2.1579}:  40%|████      | 4/10 [00:05<00:06,  1.05s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.1199, 'hit_ratio@10': 0.6674, 'ndcg@10': 0.6791, 'compress@10': 0.5285, 'time@10': 30.3611}:  40%|████      | 4/10 [01:17<00:06,  1.05s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.1199, 'hit_ratio@10': 0.6674, 'ndcg@10': 0.6791, 'compress@10': 0.5285, 'time@10': 30.3611}:  50%|█████     | 5/10 [01:17<02:12, 26.50s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.1126, 'hit_ratio@10': 0.6821, 'ndcg@10': 0.7032, 'compress@10': 0.5256, 'time@10': 27.0473}:  50%|█████     | 5/10 [01:27<02:12, 26.50s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.1126, 'hit_ratio@10': 0.6821, 'ndcg@10': 0.7032, 'compress@10': 0.5256, 'time@10': 27.0473}:  60%|██████    | 6/10 [01:27<01:24, 21.06s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.1023, 'hit_ratio@10': 0.7218, 'ndcg@10': 0.7263, 'compress@10': 0.5248, 'time@10': 25.3408}:  60%|██████    | 6/10 [01:35<01:24, 21.06s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.1023, 'hit_ratio@10': 0.7218, 'ndcg@10': 0.7263, 'compress@10': 0.5248, 'time@10': 25.3408}:  70%|███████   | 7/10 [01:35<00:49, 16.66s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0958, 'hit_ratio@10': 0.7458, 'ndcg@10': 0.7363, 'compress@10': 0.5235, 'time@10': 22.5739}:  70%|███████   | 7/10 [01:38<00:49, 16.66s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0958, 'hit_ratio@10': 0.7458, 'ndcg@10': 0.7363, 'compress@10': 0.5235, 'time@10': 22.5739}:  80%|████████  | 8/10 [01:38<00:24, 12.39s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0878, 'hit_ratio@10': 0.7487, 'ndcg@10': 0.7561, 'compress@10': 0.5224, 'time@10': 25.3123}:  80%|████████  | 8/10 [02:02<00:24, 12.39s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0878, 'hit_ratio@10': 0.7487, 'ndcg@10': 0.7561, 'compress@10': 0.5224, 'time@10': 25.3123}:  90%|█████████ | 9/10 [02:02<00:15, 15.91s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0837, 'hit_ratio@10': 0.767, 'ndcg@10': 0.7649, 'compress@10': 0.5213, 'time@10': 23.7063}:  90%|█████████ | 9/10 [02:11<00:15, 15.91s/it]    {'epoch': 2, 'num_users': 6.3, 'loss': 0.0837, 'hit_ratio@10': 0.767, 'ndcg@10': 0.7649, 'compress@10': 0.5213, 'time@10': 23.7063}: 100%|██████████| 10/10 [02:11<00:00, 13.86s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0837, 'hit_ratio@10': 0.767, 'ndcg@10': 0.7649, 'compress@10': 0.5213, 'time@10': 23.7063}: 100%|██████████| 10/10 [02:11<00:00, 13.14s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.0836635633318899
Avg hit ratio: 0.7670033972190169
Avg ndcg: 0.7649041808228124
Avg compression ratio: 0.5213410386143043
Avg train time: 23.706295752525328
Std train time: 41.932218140221025
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[3, 1, 1, 1, 185, 10, 17, 1, 63, 8]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0922, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.6956, 'compress@10': 0.5263, 'time@10': 2.5973}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0922, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.6956, 'compress@10': 0.5263, 'time@10': 2.5973}:  10%|█         | 1/10 [00:01<00:12,  1.33s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.1246, 'hit_ratio@10': 0.6647, 'ndcg@10': 0.6632, 'compress@10': 0.5212, 'time@10': 1.6727}:  10%|█         | 1/10 [00:02<00:12,  1.33s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.1246, 'hit_ratio@10': 0.6647, 'ndcg@10': 0.6632, 'compress@10': 0.5212, 'time@10': 1.6727}:  20%|██        | 2/10 [00:02<00:08,  1.01s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.1455, 'hit_ratio@10': 0.586, 'ndcg@10': 0.5963, 'compress@10': 0.538, 'time@10': 1.2221}:  20%|██        | 2/10 [00:02<00:08,  1.01s/it]  {'epoch': 3, 'num_users': 5.0, 'loss': 0.1455, 'hit_ratio@10': 0.586, 'ndcg@10': 0.5963, 'compress@10': 0.538, 'time@10': 1.2221}:  30%|███       | 3/10 [00:02<00:04,  1.52it/s]{'epoch': 3, 'num_users': 5.0, 'loss': 0.1545, 'hit_ratio@10': 0.5691, 'ndcg@10': 0.588, 'compress@10': 0.5331, 'time@10': 1.074}:  30%|███       | 3/10 [00:03<00:04,  1.52it/s]{'epoch': 3, 'num_users': 5.0, 'loss': 0.1545, 'hit_ratio@10': 0.5691, 'ndcg@10': 0.588, 'compress@10': 0.5331, 'time@10': 1.074}:  40%|████      | 4/10 [00:03<00:03,  1.51it/s]{'epoch': 3, 'num_users': 5.8, 'loss': 0.125, 'hit_ratio@10': 0.6473, 'ndcg@10': 0.6638, 'compress@10': 0.5285, 'time@10': 88.2017}:  40%|████      | 4/10 [03:41<00:03,  1.51it/s]{'epoch': 3, 'num_users': 5.8, 'loss': 0.125, 'hit_ratio@10': 0.6473, 'ndcg@10': 0.6638, 'compress@10': 0.5285, 'time@10': 88.2017}:  50%|█████     | 5/10 [03:41<06:35, 79.18s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.1161, 'hit_ratio@10': 0.6653, 'ndcg@10': 0.6899, 'compress@10': 0.5256, 'time@10': 75.2645}:  50%|█████     | 5/10 [03:52<06:35, 79.18s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.1161, 'hit_ratio@10': 0.6653, 'ndcg@10': 0.6899, 'compress@10': 0.5256, 'time@10': 75.2645}:  60%|██████    | 6/10 [03:52<03:43, 55.87s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.1057, 'hit_ratio@10': 0.7074, 'ndcg@10': 0.7123, 'compress@10': 0.5248, 'time@10': 67.2801}:  60%|██████    | 6/10 [04:01<03:43, 55.87s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.1057, 'hit_ratio@10': 0.7074, 'ndcg@10': 0.7123, 'compress@10': 0.5248, 'time@10': 67.2801}:  70%|███████   | 7/10 [04:01<02:02, 40.78s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.1115, 'hit_ratio@10': 0.6999, 'ndcg@10': 0.6896, 'compress@10': 0.5235, 'time@10': 58.9701}:  70%|███████   | 7/10 [04:02<02:02, 40.78s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.1115, 'hit_ratio@10': 0.6999, 'ndcg@10': 0.6896, 'compress@10': 0.5235, 'time@10': 58.9701}:  80%|████████  | 8/10 [04:02<00:56, 28.06s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.1004, 'hit_ratio@10': 0.711, 'ndcg@10': 0.7187, 'compress@10': 0.5225, 'time@10': 63.8916}:  80%|████████  | 8/10 [04:54<00:56, 28.06s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.1004, 'hit_ratio@10': 0.711, 'ndcg@10': 0.7187, 'compress@10': 0.5225, 'time@10': 63.8916}:  90%|█████████ | 9/10 [04:54<00:35, 35.44s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0952, 'hit_ratio@10': 0.7331, 'ndcg@10': 0.7325, 'compress@10': 0.5214, 'time@10': 58.3285}:  90%|█████████ | 9/10 [05:02<00:35, 35.44s/it]  {'epoch': 3, 'num_users': 6.3, 'loss': 0.0952, 'hit_ratio@10': 0.7331, 'ndcg@10': 0.7325, 'compress@10': 0.5214, 'time@10': 58.3285}: 100%|██████████| 10/10 [05:02<00:00, 27.06s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0952, 'hit_ratio@10': 0.7331, 'ndcg@10': 0.7325, 'compress@10': 0.5214, 'time@10': 58.3285}: 100%|██████████| 10/10 [05:02<00:00, 30.26s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.09522535455810306
Avg hit ratio: 0.7330894324631466
Avg ndcg: 0.7324528200135357
Avg compression ratio: 0.5213830556639534
Avg train time: 58.328540205955505
Std train time: 129.58505366332352
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[1, 1, 1, 1, 585, 10, 25, 1, 150, 6]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1927, 'hit_ratio@10': 0.5, 'ndcg@10': 0.5982, 'compress@10': 0.5278, 'time@10': 0.8957}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1927, 'hit_ratio@10': 0.5, 'ndcg@10': 0.5982, 'compress@10': 0.5278, 'time@10': 0.8957}:  10%|█         | 1/10 [00:00<00:04,  2.07it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1752, 'hit_ratio@10': 0.5403, 'ndcg@10': 0.6178, 'compress@10': 0.522, 'time@10': 0.8056}:  10%|█         | 1/10 [00:01<00:04,  2.07it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1752, 'hit_ratio@10': 0.5403, 'ndcg@10': 0.6178, 'compress@10': 0.522, 'time@10': 0.8056}:  20%|██        | 2/10 [00:01<00:05,  1.56it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.1789, 'hit_ratio@10': 0.5031, 'ndcg@10': 0.5824, 'compress@10': 0.5384, 'time@10': 0.6461}:  20%|██        | 2/10 [00:01<00:05,  1.56it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.1789, 'hit_ratio@10': 0.5031, 'ndcg@10': 0.5824, 'compress@10': 0.5384, 'time@10': 0.6461}:  30%|███       | 3/10 [00:01<00:03,  2.28it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.1815, 'hit_ratio@10': 0.4977, 'ndcg@10': 0.5789, 'compress@10': 0.5335, 'time@10': 0.6505}:  30%|███       | 3/10 [00:02<00:03,  2.28it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.1815, 'hit_ratio@10': 0.4977, 'ndcg@10': 0.5789, 'compress@10': 0.5335, 'time@10': 0.6505}:  40%|████      | 4/10 [00:02<00:03,  1.85it/s]{'epoch': 4, 'num_users': 5.8, 'loss': 0.1454, 'hit_ratio@10': 0.5941, 'ndcg@10': 0.6591, 'compress@10': 0.5288, 'time@10': 277.1522}:  40%|████      | 4/10 [11:33<00:03,  1.85it/s]{'epoch': 4, 'num_users': 5.8, 'loss': 0.1454, 'hit_ratio@10': 0.5941, 'ndcg@10': 0.6591, 'compress@10': 0.5288, 'time@10': 277.1522}:  50%|█████     | 5/10 [11:33<20:48, 249.75s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.1324, 'hit_ratio@10': 0.6284, 'ndcg@10': 0.6865, 'compress@10': 0.5258, 'time@10': 232.7654}:  50%|█████     | 5/10 [11:44<20:48, 249.75s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.1324, 'hit_ratio@10': 0.6284, 'ndcg@10': 0.6865, 'compress@10': 0.5258, 'time@10': 232.7654}:  60%|██████    | 6/10 [11:44<11:14, 168.53s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.1184, 'hit_ratio@10': 0.6758, 'ndcg@10': 0.717, 'compress@10': 0.525, 'time@10': 203.6069}:  60%|██████    | 6/10 [11:58<11:14, 168.53s/it]  {'epoch': 4, 'num_users': 6.2857, 'loss': 0.1184, 'hit_ratio@10': 0.6758, 'ndcg@10': 0.717, 'compress@10': 0.525, 'time@10': 203.6069}:  70%|███████   | 7/10 [11:58<05:54, 118.13s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.1221, 'hit_ratio@10': 0.6722, 'ndcg@10': 0.6979, 'compress@10': 0.5237, 'time@10': 178.2674}:  70%|███████   | 7/10 [11:59<05:54, 118.13s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.1221, 'hit_ratio@10': 0.6722, 'ndcg@10': 0.6979, 'compress@10': 0.5237, 'time@10': 178.2674}:  80%|████████  | 8/10 [11:59<02:41, 80.82s/it] {'epoch': 4, 'num_users': 6.3333, 'loss': 0.1091, 'hit_ratio@10': 0.6769, 'ndcg@10': 0.7283, 'compress@10': 0.5227, 'time@10': 185.6493}:  80%|████████  | 8/10 [14:02<02:41, 80.82s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.1091, 'hit_ratio@10': 0.6769, 'ndcg@10': 0.7283, 'compress@10': 0.5227, 'time@10': 185.6493}:  90%|█████████ | 9/10 [14:02<01:33, 93.81s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.1024, 'hit_ratio@10': 0.7024, 'ndcg@10': 0.7407, 'compress@10': 0.5215, 'time@10': 167.6891}:  90%|█████████ | 9/10 [14:08<01:33, 93.81s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.1024, 'hit_ratio@10': 0.7024, 'ndcg@10': 0.7407, 'compress@10': 0.5215, 'time@10': 167.6891}: 100%|██████████| 10/10 [14:08<00:00, 66.73s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.1024, 'hit_ratio@10': 0.7024, 'ndcg@10': 0.7407, 'compress@10': 0.5215, 'time@10': 167.6891}: 100%|██████████| 10/10 [14:08<00:00, 84.84s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.10243578449458197
Avg hit ratio: 0.702386079097654
Avg ndcg: 0.7407360032455276
Avg compression ratio: 0.5215292553483474
Avg train time: 167.6891479253769
Std train time: 411.43532836294344
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[1, 1, 1, 1, 1873, 10, 42, 1, 370, 2]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.2026, 'hit_ratio@10': 0.5, 'ndcg@10': 0.5494, 'compress@10': 0.5278, 'time@10': 0.879}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.2026, 'hit_ratio@10': 0.5, 'ndcg@10': 0.5494, 'compress@10': 0.5278, 'time@10': 0.879}:  10%|█         | 1/10 [00:00<00:04,  2.10it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.1889, 'hit_ratio@10': 0.4597, 'ndcg@10': 0.5779, 'compress@10': 0.522, 'time@10': 0.8039}:  10%|█         | 1/10 [00:01<00:04,  2.10it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.1889, 'hit_ratio@10': 0.4597, 'ndcg@10': 0.5779, 'compress@10': 0.522, 'time@10': 0.8039}:  20%|██        | 2/10 [00:01<00:05,  1.55it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.1958, 'hit_ratio@10': 0.4493, 'ndcg@10': 0.5349, 'compress@10': 0.5384, 'time@10': 0.6451}:  20%|██        | 2/10 [00:01<00:05,  1.55it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.1958, 'hit_ratio@10': 0.4493, 'ndcg@10': 0.5349, 'compress@10': 0.5384, 'time@10': 0.6451}:  30%|███       | 3/10 [00:01<00:03,  2.26it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.2001, 'hit_ratio@10': 0.4574, 'ndcg@10': 0.5359, 'compress@10': 0.5335, 'time@10': 0.6458}:  30%|███       | 3/10 [00:02<00:03,  2.26it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.2001, 'hit_ratio@10': 0.4574, 'ndcg@10': 0.5359, 'compress@10': 0.5335, 'time@10': 0.6458}:  40%|████      | 4/10 [00:02<00:03,  1.84it/s]{'epoch': 5, 'num_users': 5.8, 'loss': 0.1601, 'hit_ratio@10': 0.5619, 'ndcg@10': 0.6247, 'compress@10': 0.5288, 'time@10': 880.8682}:  40%|████      | 4/10 [36:43<00:03,  1.84it/s]{'epoch': 5, 'num_users': 5.8, 'loss': 0.1601, 'hit_ratio@10': 0.5619, 'ndcg@10': 0.6247, 'compress@10': 0.5288, 'time@10': 880.8682}:  50%|█████     | 5/10 [36:43<1:06:10, 794.01s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.1436, 'hit_ratio@10': 0.6016, 'ndcg@10': 0.6592, 'compress@10': 0.5258, 'time@10': 735.6257}:  50%|█████     | 5/10 [36:52<1:06:10, 794.01s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.1436, 'hit_ratio@10': 0.6016, 'ndcg@10': 0.6592, 'compress@10': 0.5258, 'time@10': 735.6257}:  60%|██████    | 6/10 [36:52<35:09, 527.26s/it]  {'epoch': 5, 'num_users': 6.2857, 'loss': 0.1273, 'hit_ratio@10': 0.6528, 'ndcg@10': 0.6908, 'compress@10': 0.525, 'time@10': 636.5654}:  60%|██████    | 6/10 [37:13<35:09, 527.26s/it] {'epoch': 5, 'num_users': 6.2857, 'loss': 0.1273, 'hit_ratio@10': 0.6528, 'ndcg@10': 0.6908, 'compress@10': 0.525, 'time@10': 636.5654}:  70%|███████   | 7/10 [37:13<18:05, 361.80s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.1327, 'hit_ratio@10': 0.6557, 'ndcg@10': 0.668, 'compress@10': 0.5237, 'time@10': 557.0883}:  70%|███████   | 7/10 [37:14<18:05, 361.80s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.1327, 'hit_ratio@10': 0.6557, 'ndcg@10': 0.668, 'compress@10': 0.5237, 'time@10': 557.0883}:  80%|████████  | 8/10 [37:14<08:13, 246.87s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.1181, 'hit_ratio@10': 0.6622, 'ndcg@10': 0.7017, 'compress@10': 0.5227, 'time@10': 550.7281}:  80%|████████  | 8/10 [41:24<08:13, 246.87s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.1181, 'hit_ratio@10': 0.6622, 'ndcg@10': 0.7017, 'compress@10': 0.5227, 'time@10': 550.7281}:  90%|█████████ | 9/10 [41:24<04:07, 247.83s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.1147, 'hit_ratio@10': 0.6778, 'ndcg@10': 0.7049, 'compress@10': 0.5215, 'time@10': 495.8099}:  90%|█████████ | 9/10 [41:25<04:07, 247.83s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.1147, 'hit_ratio@10': 0.6778, 'ndcg@10': 0.7049, 'compress@10': 0.5215, 'time@10': 495.8099}: 100%|██████████| 10/10 [41:25<00:00, 171.81s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.1147, 'hit_ratio@10': 0.6778, 'ndcg@10': 0.7049, 'compress@10': 0.5215, 'time@10': 495.8099}: 100%|██████████| 10/10 [41:25<00:00, 248.60s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.1146922602955979
Avg hit ratio: 0.6778345869465414
Avg ndcg: 0.704873496290877
Avg compression ratio: 0.5215292553483474
Avg train time: 495.80993990898133
Std train time: 1310.3021043405236
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[1, 1, 1, 1, 5994, 9, 72, 1, 829, 1]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2169, 'hit_ratio@10': 0.5, 'ndcg@10': 0.4651, 'compress@10': 0.5278, 'time@10': 0.6582}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2169, 'hit_ratio@10': 0.5, 'ndcg@10': 0.4651, 'compress@10': 0.5278, 'time@10': 0.6582}:  10%|█         | 1/10 [00:00<00:03,  2.78it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2038, 'hit_ratio@10': 0.4758, 'ndcg@10': 0.4968, 'compress@10': 0.522, 'time@10': 0.6121}:  10%|█         | 1/10 [00:00<00:03,  2.78it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2038, 'hit_ratio@10': 0.4758, 'ndcg@10': 0.4968, 'compress@10': 0.522, 'time@10': 0.6121}:  20%|██        | 2/10 [00:00<00:04,  1.97it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.2073, 'hit_ratio@10': 0.4601, 'ndcg@10': 0.4706, 'compress@10': 0.5384, 'time@10': 0.5353}:  20%|██        | 2/10 [00:01<00:04,  1.97it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.2073, 'hit_ratio@10': 0.4601, 'ndcg@10': 0.4706, 'compress@10': 0.5384, 'time@10': 0.5353}:  30%|███       | 3/10 [00:01<00:02,  2.66it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.2146, 'hit_ratio@10': 0.4747, 'ndcg@10': 0.4727, 'compress@10': 0.5335, 'time@10': 0.5233}:  30%|███       | 3/10 [00:01<00:02,  2.66it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.2146, 'hit_ratio@10': 0.4747, 'ndcg@10': 0.4727, 'compress@10': 0.5335, 'time@10': 0.5233}:  40%|████      | 4/10 [00:01<00:02,  2.31it/s]{'epoch': 6, 'num_users': 5.8, 'loss': 0.1717, 'hit_ratio@10': 0.5717, 'ndcg@10': 0.5741, 'compress@10': 0.5288, 'time@10': 2040.5784}:  40%|████      | 4/10 [1:25:02<00:02,  2.31it/s]{'epoch': 6, 'num_users': 5.8, 'loss': 0.1717, 'hit_ratio@10': 0.5717, 'ndcg@10': 0.5741, 'compress@10': 0.5288, 'time@10': 2040.5784}:  50%|█████     | 5/10 [1:25:02<2:33:17, 1839.53s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.1527, 'hit_ratio@10': 0.6135, 'ndcg@10': 0.617, 'compress@10': 0.5258, 'time@10': 1701.6105}:  50%|█████     | 5/10 [1:25:08<2:33:17, 1839.53s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.1527, 'hit_ratio@10': 0.6135, 'ndcg@10': 0.617, 'compress@10': 0.5258, 'time@10': 1701.6105}:  60%|██████    | 6/10 [1:25:08<1:21:05, 1216.40s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.1315, 'hit_ratio@10': 0.663, 'ndcg@10': 0.665, 'compress@10': 0.525, 'time@10': 1467.0376}:  60%|██████    | 6/10 [1:25:38<1:21:05, 1216.40s/it]  {'epoch': 6, 'num_users': 6.2857, 'loss': 0.1315, 'hit_ratio@10': 0.663, 'ndcg@10': 0.665, 'compress@10': 0.525, 'time@10': 1467.0376}:  70%|███████   | 7/10 [1:25:38<41:25, 828.48s/it]   {'epoch': 6, 'num_users': 6.125, 'loss': 0.1378, 'hit_ratio@10': 0.6573, 'ndcg@10': 0.6393, 'compress@10': 0.5237, 'time@10': 1283.7311}:  70%|███████   | 7/10 [1:25:39<41:25, 828.48s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.1378, 'hit_ratio@10': 0.6573, 'ndcg@10': 0.6393, 'compress@10': 0.5237, 'time@10': 1283.7311}:  80%|████████  | 8/10 [1:25:39<18:49, 564.93s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.1225, 'hit_ratio@10': 0.6573, 'ndcg@10': 0.6762, 'compress@10': 0.5227, 'time@10': 1249.6459}:  80%|████████  | 8/10 [1:33:47<18:49, 564.93s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.1225, 'hit_ratio@10': 0.6573, 'ndcg@10': 0.6762, 'compress@10': 0.5227, 'time@10': 1249.6459}:  90%|█████████ | 9/10 [1:33:47<09:01, 541.04s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.1256, 'hit_ratio@10': 0.6567, 'ndcg@10': 0.6698, 'compress@10': 0.5216, 'time@10': 1124.7555}:  90%|█████████ | 9/10 [1:33:48<09:01, 541.04s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.1256, 'hit_ratio@10': 0.6567, 'ndcg@10': 0.6698, 'compress@10': 0.5216, 'time@10': 1124.7555}: 100%|██████████| 10/10 [1:33:48<00:00, 374.25s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.1256, 'hit_ratio@10': 0.6567, 'ndcg@10': 0.6698, 'compress@10': 0.5216, 'time@10': 1124.7555}: 100%|██████████| 10/10 [1:33:48<00:00, 562.87s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.1256013888480285
Avg hit ratio: 0.6566877779202038
Avg ndcg: 0.669832756589282
Avg compression ratio: 0.5215556825608749
Avg train time: 1124.7555173635483
Std train time: 3039.138123322658
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[1, 1, 1, 1, 15557, 5, 118, 1, 1736, 1]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.3323, 'hit_ratio@10': 0.6111, 'ndcg@10': 0.2909, 'compress@10': 0.5278, 'time@10': 0.6331}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.3323, 'hit_ratio@10': 0.6111, 'ndcg@10': 0.2909, 'compress@10': 0.5278, 'time@10': 0.6331}:  10%|█         | 1/10 [00:00<00:03,  2.89it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.3055, 'hit_ratio@10': 0.5152, 'ndcg@10': 0.3495, 'compress@10': 0.522, 'time@10': 0.5908}:  10%|█         | 1/10 [00:00<00:03,  2.89it/s] {'epoch': 7, 'num_users': 7.0, 'loss': 0.3055, 'hit_ratio@10': 0.5152, 'ndcg@10': 0.3495, 'compress@10': 0.522, 'time@10': 0.5908}:  20%|██        | 2/10 [00:00<00:03,  2.07it/s]{'epoch': 7, 'num_users': 5.0, 'loss': 0.3096, 'hit_ratio@10': 0.4863, 'ndcg@10': 0.3206, 'compress@10': 0.5384, 'time@10': 0.4719}:  20%|██        | 2/10 [00:01<00:03,  2.07it/s]{'epoch': 7, 'num_users': 5.0, 'loss': 0.3096, 'hit_ratio@10': 0.4863, 'ndcg@10': 0.3206, 'compress@10': 0.5384, 'time@10': 0.4719}:  30%|███       | 3/10 [00:01<00:02,  3.04it/s]{'epoch': 7, 'num_users': 5.0, 'loss': 0.3177, 'hit_ratio@10': 0.4851, 'ndcg@10': 0.3254, 'compress@10': 0.5335, 'time@10': 0.4721}:  30%|███       | 3/10 [00:01<00:02,  3.04it/s]{'epoch': 7, 'num_users': 5.0, 'loss': 0.3177, 'hit_ratio@10': 0.4851, 'ndcg@10': 0.3254, 'compress@10': 0.5335, 'time@10': 0.4721}:  40%|████      | 4/10 [00:01<00:02,  2.51it/s]