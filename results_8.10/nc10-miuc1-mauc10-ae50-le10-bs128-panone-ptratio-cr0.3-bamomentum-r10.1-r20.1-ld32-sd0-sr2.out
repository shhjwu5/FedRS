  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2146, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.5179, 'compress@10': 0.0773, 'time@10': 5.791}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2146, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.5179, 'compress@10': 0.0773, 'time@10': 5.791}:  10%|█         | 1/10 [00:02<00:26,  2.94s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.155, 'hit_ratio@10': 0.5229, 'ndcg@10': 0.5756, 'compress@10': 0.0693, 'time@10': 4.9662}:  10%|█         | 1/10 [00:07<00:26,  2.94s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.155, 'hit_ratio@10': 0.5229, 'ndcg@10': 0.5756, 'compress@10': 0.0693, 'time@10': 4.9662}:  20%|██        | 2/10 [00:07<00:29,  3.67s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8399, 'hit_ratio@10': 0.4915, 'ndcg@10': 0.3837, 'compress@10': 0.1004, 'time@10': 3.862}:  20%|██        | 2/10 [00:07<00:29,  3.67s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8399, 'hit_ratio@10': 0.4915, 'ndcg@10': 0.3837, 'compress@10': 0.1004, 'time@10': 3.862}:  30%|███       | 3/10 [00:07<00:16,  2.39s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6611, 'hit_ratio@10': 0.5472, 'ndcg@10': 0.4343, 'compress@10': 0.0887, 'time@10': 3.8306}:  30%|███       | 3/10 [00:11<00:16,  2.39s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6611, 'hit_ratio@10': 0.5472, 'ndcg@10': 0.4343, 'compress@10': 0.0887, 'time@10': 3.8306}:  40%|████      | 4/10 [00:11<00:17,  2.94s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5482, 'hit_ratio@10': 0.6017, 'ndcg@10': 0.4928, 'compress@10': 0.0795, 'time@10': 5.8031}:  40%|████      | 4/10 [00:18<00:17,  2.94s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5482, 'hit_ratio@10': 0.6017, 'ndcg@10': 0.4928, 'compress@10': 0.0795, 'time@10': 5.8031}:  50%|█████     | 5/10 [00:18<00:21,  4.37s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4717, 'hit_ratio@10': 0.6163, 'ndcg@10': 0.5376, 'compress@10': 0.0739, 'time@10': 5.8611}:  50%|█████     | 5/10 [00:24<00:21,  4.37s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4717, 'hit_ratio@10': 0.6163, 'ndcg@10': 0.5376, 'compress@10': 0.0739, 'time@10': 5.8611}:  60%|██████    | 6/10 [00:24<00:19,  4.99s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4243, 'hit_ratio@10': 0.6197, 'ndcg@10': 0.5372, 'compress@10': 0.0717, 'time@10': 5.9958}:  60%|██████    | 6/10 [00:28<00:19,  4.99s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4243, 'hit_ratio@10': 0.6197, 'ndcg@10': 0.5372, 'compress@10': 0.0717, 'time@10': 5.9958}:  70%|███████   | 7/10 [00:28<00:13,  4.48s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3789, 'hit_ratio@10': 0.6565, 'ndcg@10': 0.564, 'compress@10': 0.07, 'time@10': 5.8359}:  70%|███████   | 7/10 [00:33<00:13,  4.48s/it]    {'epoch': 0, 'num_users': 6.125, 'loss': 0.3789, 'hit_ratio@10': 0.6565, 'ndcg@10': 0.564, 'compress@10': 0.07, 'time@10': 5.8359}:  80%|████████  | 8/10 [00:33<00:09,  4.57s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3447, 'hit_ratio@10': 0.6724, 'ndcg@10': 0.6, 'compress@10': 0.0682, 'time@10': 6.2504}:  80%|████████  | 8/10 [00:37<00:09,  4.57s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3447, 'hit_ratio@10': 0.6724, 'ndcg@10': 0.6, 'compress@10': 0.0682, 'time@10': 6.2504}:  90%|█████████ | 9/10 [00:37<00:04,  4.65s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3159, 'hit_ratio@10': 0.6984, 'ndcg@10': 0.6226, 'compress@10': 0.0664, 'time@10': 6.2261}:  90%|█████████ | 9/10 [00:43<00:04,  4.65s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3159, 'hit_ratio@10': 0.6984, 'ndcg@10': 0.6226, 'compress@10': 0.0664, 'time@10': 6.2261}: 100%|██████████| 10/10 [00:43<00:00,  5.08s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3159, 'hit_ratio@10': 0.6984, 'ndcg@10': 0.6226, 'compress@10': 0.0664, 'time@10': 6.2261}: 100%|██████████| 10/10 [00:43<00:00,  4.39s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3158553144544588
Avg hit ratio: 0.6983690335320216
Avg ndcg: 0.6226336026181316
Avg compression ratio: 0.06636820704214244
Avg train time: 6.226122736930847
Std train time: 3.1814600152392796
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0572, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8293, 'compress@10': 0.0657, 'time@10': 4.8905}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0572, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8293, 'compress@10': 0.0657, 'time@10': 4.8905}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0556, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8458, 'compress@10': 0.0558, 'time@10': 4.5249}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0556, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8458, 'compress@10': 0.0558, 'time@10': 4.5249}:  20%|██        | 2/10 [00:06<00:27,  3.49s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0479, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.805, 'compress@10': 0.088, 'time@10': 3.6255}:  20%|██        | 2/10 [00:07<00:27,  3.49s/it]  {'epoch': 1, 'num_users': 5.0, 'loss': 0.0479, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.805, 'compress@10': 0.088, 'time@10': 3.6255}:  30%|███       | 3/10 [00:07<00:16,  2.33s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0485, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8145, 'compress@10': 0.0797, 'time@10': 3.6548}:  30%|███       | 3/10 [00:11<00:16,  2.33s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0485, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8145, 'compress@10': 0.0797, 'time@10': 3.6548}:  40%|████      | 4/10 [00:11<00:17,  2.91s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0563, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8079, 'compress@10': 0.071, 'time@10': 5.424}:  40%|████      | 4/10 [00:17<00:17,  2.91s/it]  {'epoch': 1, 'num_users': 5.8, 'loss': 0.0563, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8079, 'compress@10': 0.071, 'time@10': 5.424}:  50%|█████     | 5/10 [00:17<00:20,  4.13s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0599, 'hit_ratio@10': 0.7823, 'ndcg@10': 0.8086, 'compress@10': 0.0663, 'time@10': 5.572}:  50%|█████     | 5/10 [00:24<00:20,  4.13s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0599, 'hit_ratio@10': 0.7823, 'ndcg@10': 0.8086, 'compress@10': 0.0663, 'time@10': 5.572}:  60%|██████    | 6/10 [00:24<00:19,  4.89s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0578, 'hit_ratio@10': 0.8077, 'ndcg@10': 0.8169, 'compress@10': 0.0648, 'time@10': 5.7577}:  60%|██████    | 6/10 [00:27<00:19,  4.89s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0578, 'hit_ratio@10': 0.8077, 'ndcg@10': 0.8169, 'compress@10': 0.0648, 'time@10': 5.7577}:  70%|███████   | 7/10 [00:27<00:13,  4.42s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0553, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8241, 'compress@10': 0.0621, 'time@10': 5.664}:  70%|███████   | 7/10 [00:32<00:13,  4.42s/it]   {'epoch': 1, 'num_users': 6.125, 'loss': 0.0553, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8241, 'compress@10': 0.0621, 'time@10': 5.664}:  80%|████████  | 8/10 [00:32<00:09,  4.62s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0532, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8343, 'compress@10': 0.0607, 'time@10': 5.9828}:  80%|████████  | 8/10 [00:36<00:09,  4.62s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0532, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8343, 'compress@10': 0.0607, 'time@10': 5.9828}:  90%|█████████ | 9/10 [00:36<00:04,  4.52s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0526, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8356, 'compress@10': 0.0592, 'time@10': 5.9569}:  90%|█████████ | 9/10 [00:42<00:04,  4.52s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0526, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8356, 'compress@10': 0.0592, 'time@10': 5.9569}: 100%|██████████| 10/10 [00:42<00:00,  4.91s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0526, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8356, 'compress@10': 0.0592, 'time@10': 5.9569}: 100%|██████████| 10/10 [00:42<00:00,  4.27s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05257578576156905
Avg hit ratio: 0.8214123676738279
Avg ndcg: 0.8355726991908312
Avg compression ratio: 0.05918039635128729
Avg train time: 5.956856846809387
Std train time: 2.7874880698099562
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8456, 'compress@10': 0.0659, 'time@10': 4.791}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8456, 'compress@10': 0.0659, 'time@10': 4.791}:  10%|█         | 1/10 [00:02<00:21,  2.44s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8477, 'compress@10': 0.0558, 'time@10': 4.5036}:  10%|█         | 1/10 [00:06<00:21,  2.44s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8477, 'compress@10': 0.0558, 'time@10': 4.5036}:  20%|██        | 2/10 [00:06<00:28,  3.51s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0355, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8487, 'compress@10': 0.0903, 'time@10': 3.6608}:  20%|██        | 2/10 [00:07<00:28,  3.51s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0355, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8487, 'compress@10': 0.0903, 'time@10': 3.6608}:  30%|███       | 3/10 [00:07<00:16,  2.37s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.039, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8479, 'compress@10': 0.0808, 'time@10': 3.6736}:  30%|███       | 3/10 [00:11<00:16,  2.37s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.039, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8479, 'compress@10': 0.0808, 'time@10': 3.6736}:  40%|████      | 4/10 [00:11<00:17,  2.92s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0485, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8349, 'compress@10': 0.0715, 'time@10': 5.1532}:  40%|████      | 4/10 [00:17<00:17,  2.92s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0485, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8349, 'compress@10': 0.0715, 'time@10': 5.1532}:  50%|█████     | 5/10 [00:17<00:19,  3.88s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0532, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8331, 'compress@10': 0.0669, 'time@10': 5.324}:  50%|█████     | 5/10 [00:23<00:19,  3.88s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0532, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8331, 'compress@10': 0.0669, 'time@10': 5.324}:  60%|██████    | 6/10 [00:23<00:18,  4.67s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0516, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8368, 'compress@10': 0.0653, 'time@10': 5.5214}:  60%|██████    | 6/10 [00:26<00:18,  4.67s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0516, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8368, 'compress@10': 0.0653, 'time@10': 5.5214}:  70%|███████   | 7/10 [00:26<00:12,  4.25s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8419, 'compress@10': 0.0624, 'time@10': 5.4201}:  70%|███████   | 7/10 [00:31<00:12,  4.25s/it]  {'epoch': 2, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8419, 'compress@10': 0.0624, 'time@10': 5.4201}:  80%|████████  | 8/10 [00:31<00:08,  4.41s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0497, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8521, 'compress@10': 0.061, 'time@10': 5.7589}:  80%|████████  | 8/10 [00:35<00:08,  4.41s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0497, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8521, 'compress@10': 0.061, 'time@10': 5.7589}:  90%|█████████ | 9/10 [00:35<00:04,  4.37s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.852, 'compress@10': 0.0598, 'time@10': 5.7502}:  90%|█████████ | 9/10 [00:41<00:04,  4.37s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.852, 'compress@10': 0.0598, 'time@10': 5.7502}: 100%|██████████| 10/10 [00:41<00:00,  4.78s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.852, 'compress@10': 0.0598, 'time@10': 5.7502}: 100%|██████████| 10/10 [00:41<00:00,  4.14s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.0493545307406526
Avg hit ratio: 0.8315326684257075
Avg ndcg: 0.8519989397752097
Avg compression ratio: 0.05978326591242987
Avg train time: 5.750162816047668
Std train time: 2.4408026635711884
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8504, 'compress@10': 0.0666, 'time@10': 4.9484}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8504, 'compress@10': 0.0666, 'time@10': 4.9484}:  10%|█         | 1/10 [00:02<00:22,  2.51s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8524, 'compress@10': 0.0577, 'time@10': 4.6008}:  10%|█         | 1/10 [00:06<00:22,  2.51s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8524, 'compress@10': 0.0577, 'time@10': 4.6008}:  20%|██        | 2/10 [00:06<00:28,  3.56s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0337, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.854, 'compress@10': 0.091, 'time@10': 3.7615}:  20%|██        | 2/10 [00:07<00:28,  3.56s/it]  {'epoch': 3, 'num_users': 5.0, 'loss': 0.0337, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.854, 'compress@10': 0.091, 'time@10': 3.7615}:  30%|███       | 3/10 [00:07<00:16,  2.43s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8502, 'compress@10': 0.0814, 'time@10': 3.7416}:  30%|███       | 3/10 [00:11<00:16,  2.43s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8502, 'compress@10': 0.0814, 'time@10': 3.7416}:  40%|████      | 4/10 [00:11<00:17,  2.94s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8386, 'compress@10': 0.0715, 'time@10': 4.9336}:  40%|████      | 4/10 [00:16<00:17,  2.94s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8386, 'compress@10': 0.0715, 'time@10': 4.9336}:  50%|█████     | 5/10 [00:16<00:18,  3.64s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0512, 'hit_ratio@10': 0.7813, 'ndcg@10': 0.8357, 'compress@10': 0.067, 'time@10': 5.13}:  50%|█████     | 5/10 [00:22<00:18,  3.64s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0512, 'hit_ratio@10': 0.7813, 'ndcg@10': 0.8357, 'compress@10': 0.067, 'time@10': 5.13}:  60%|██████    | 6/10 [00:22<00:17,  4.50s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8349, 'compress@10': 0.0653, 'time@10': 5.3376}:  60%|██████    | 6/10 [00:25<00:17,  4.50s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8349, 'compress@10': 0.0653, 'time@10': 5.3376}:  70%|███████   | 7/10 [00:25<00:12,  4.12s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0518, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8431, 'compress@10': 0.0623, 'time@10': 5.2547}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0518, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8431, 'compress@10': 0.0623, 'time@10': 5.2547}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.051, 'hit_ratio@10': 0.818, 'ndcg@10': 0.8509, 'compress@10': 0.0606, 'time@10': 5.6099}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it] {'epoch': 3, 'num_users': 6.3333, 'loss': 0.051, 'hit_ratio@10': 0.818, 'ndcg@10': 0.8509, 'compress@10': 0.0606, 'time@10': 5.6099}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8508, 'compress@10': 0.0593, 'time@10': 5.614}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]  {'epoch': 3, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8508, 'compress@10': 0.0593, 'time@10': 5.614}: 100%|██████████| 10/10 [00:40<00:00,  4.72s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8508, 'compress@10': 0.0593, 'time@10': 5.614}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.0504204894825737
Avg hit ratio: 0.8294128527575048
Avg ndcg: 0.8508061850533943
Avg compression ratio: 0.05933106210915494
Avg train time: 5.614014220237732
Std train time: 2.1290451589128185
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.0659, 'time@10': 4.366}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.0659, 'time@10': 4.366}:  10%|█         | 1/10 [00:02<00:20,  2.22s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8604, 'compress@10': 0.0578, 'time@10': 4.2676}:  10%|█         | 1/10 [00:06<00:20,  2.22s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8604, 'compress@10': 0.0578, 'time@10': 4.2676}:  20%|██        | 2/10 [00:06<00:27,  3.40s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8593, 'compress@10': 0.0902, 'time@10': 3.6188}:  20%|██        | 2/10 [00:07<00:27,  3.40s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8593, 'compress@10': 0.0902, 'time@10': 3.6188}:  30%|███       | 3/10 [00:07<00:16,  2.39s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.774, 'ndcg@10': 0.849, 'compress@10': 0.0806, 'time@10': 3.6457}:  30%|███       | 3/10 [00:11<00:16,  2.39s/it]  {'epoch': 4, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.774, 'ndcg@10': 0.849, 'compress@10': 0.0806, 'time@10': 3.6457}:  40%|████      | 4/10 [00:11<00:17,  2.94s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0479, 'hit_ratio@10': 0.7872, 'ndcg@10': 0.8355, 'compress@10': 0.0707, 'time@10': 4.5613}:  40%|████      | 4/10 [00:15<00:17,  2.94s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0479, 'hit_ratio@10': 0.7872, 'ndcg@10': 0.8355, 'compress@10': 0.0707, 'time@10': 4.5613}:  50%|█████     | 5/10 [00:15<00:16,  3.38s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0512, 'hit_ratio@10': 0.793, 'ndcg@10': 0.8333, 'compress@10': 0.0664, 'time@10': 4.8218}:  50%|█████     | 5/10 [00:21<00:16,  3.38s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0512, 'hit_ratio@10': 0.793, 'ndcg@10': 0.8333, 'compress@10': 0.0664, 'time@10': 4.8218}:  60%|██████    | 6/10 [00:21<00:17,  4.33s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0506, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8344, 'compress@10': 0.0645, 'time@10': 5.075}:  60%|██████    | 6/10 [00:25<00:17,  4.33s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0506, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8344, 'compress@10': 0.0645, 'time@10': 5.075}:  70%|███████   | 7/10 [00:25<00:12,  4.00s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0515, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8453, 'compress@10': 0.0616, 'time@10': 5.0251}:  70%|███████   | 7/10 [00:29<00:12,  4.00s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0515, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8453, 'compress@10': 0.0616, 'time@10': 5.0251}:  80%|████████  | 8/10 [00:29<00:08,  4.23s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8521, 'compress@10': 0.0596, 'time@10': 5.4391}:  80%|████████  | 8/10 [00:34<00:08,  4.23s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8521, 'compress@10': 0.0596, 'time@10': 5.4391}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8515, 'compress@10': 0.0581, 'time@10': 5.4579}:  90%|█████████ | 9/10 [00:39<00:04,  4.29s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8515, 'compress@10': 0.0581, 'time@10': 5.4579}: 100%|██████████| 10/10 [00:39<00:00,  4.71s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8515, 'compress@10': 0.0581, 'time@10': 5.4579}: 100%|██████████| 10/10 [00:39<00:00,  3.99s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.049544319531010975
Avg hit ratio: 0.8278537129725585
Avg ndcg: 0.8514776795652177
Avg compression ratio: 0.05806086403882227
Avg train time: 5.457884407043457
Std train time: 1.912019896666892
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.0649, 'time@10': 4.4041}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.0649, 'time@10': 4.4041}:  10%|█         | 1/10 [00:02<00:20,  2.24s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8577, 'compress@10': 0.0564, 'time@10': 4.336}:  10%|█         | 1/10 [00:06<00:20,  2.24s/it] {'epoch': 5, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8577, 'compress@10': 0.0564, 'time@10': 4.336}:  20%|██        | 2/10 [00:06<00:27,  3.46s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0327, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8575, 'compress@10': 0.0891, 'time@10': 3.7165}:  20%|██        | 2/10 [00:07<00:27,  3.46s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0327, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8575, 'compress@10': 0.0891, 'time@10': 3.7165}:  30%|███       | 3/10 [00:07<00:17,  2.47s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8475, 'compress@10': 0.0797, 'time@10': 3.7114}:  30%|███       | 3/10 [00:11<00:17,  2.47s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8475, 'compress@10': 0.0797, 'time@10': 3.7114}:  40%|████      | 4/10 [00:11<00:17,  2.97s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8344, 'compress@10': 0.07, 'time@10': 4.6322}:  40%|████      | 4/10 [00:15<00:17,  2.97s/it]  {'epoch': 5, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8344, 'compress@10': 0.07, 'time@10': 4.6322}:  50%|█████     | 5/10 [00:15<00:17,  3.41s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8333, 'compress@10': 0.0657, 'time@10': 4.8863}:  50%|█████     | 5/10 [00:21<00:17,  3.41s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8333, 'compress@10': 0.0657, 'time@10': 4.8863}:  60%|██████    | 6/10 [00:21<00:17,  4.36s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0495, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8355, 'compress@10': 0.0638, 'time@10': 5.1317}:  60%|██████    | 6/10 [00:25<00:17,  4.36s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0495, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8355, 'compress@10': 0.0638, 'time@10': 5.1317}:  70%|███████   | 7/10 [00:25<00:12,  4.02s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0496, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8455, 'compress@10': 0.061, 'time@10': 5.0722}:  70%|███████   | 7/10 [00:29<00:12,  4.02s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.0496, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8455, 'compress@10': 0.061, 'time@10': 5.0722}:  80%|████████  | 8/10 [00:29<00:08,  4.24s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.855, 'compress@10': 0.0589, 'time@10': 5.4572}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.855, 'compress@10': 0.0589, 'time@10': 5.4572}:  90%|█████████ | 9/10 [00:34<00:04,  4.26s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0479, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8554, 'compress@10': 0.0572, 'time@10': 5.473}:  90%|█████████ | 9/10 [00:39<00:04,  4.26s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0479, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8554, 'compress@10': 0.0572, 'time@10': 5.473}: 100%|██████████| 10/10 [00:39<00:00,  4.69s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0479, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8554, 'compress@10': 0.0572, 'time@10': 5.473}: 100%|██████████| 10/10 [00:39<00:00,  4.00s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04789717110179755
Avg hit ratio: 0.8453652337098857
Avg ndcg: 0.8554036095750434
Avg compression ratio: 0.057160019672142334
Avg train time: 5.47300763130188
Std train time: 1.8608977131701858
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.0644, 'time@10': 4.4396}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.0644, 'time@10': 4.4396}:  10%|█         | 1/10 [00:02<00:20,  2.26s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.855, 'compress@10': 0.0557, 'time@10': 4.3186}:  10%|█         | 1/10 [00:06<00:20,  2.26s/it] {'epoch': 6, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.855, 'compress@10': 0.0557, 'time@10': 4.3186}:  20%|██        | 2/10 [00:06<00:27,  3.42s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8557, 'compress@10': 0.0885, 'time@10': 3.7643}:  20%|██        | 2/10 [00:07<00:27,  3.42s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8557, 'compress@10': 0.0885, 'time@10': 3.7643}:  30%|███       | 3/10 [00:07<00:17,  2.48s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.7999, 'ndcg@10': 0.848, 'compress@10': 0.0791, 'time@10': 3.7468}:  30%|███       | 3/10 [00:11<00:17,  2.48s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.7999, 'ndcg@10': 0.848, 'compress@10': 0.0791, 'time@10': 3.7468}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0456, 'hit_ratio@10': 0.8079, 'ndcg@10': 0.835, 'compress@10': 0.0697, 'time@10': 4.6554}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0456, 'hit_ratio@10': 0.8079, 'ndcg@10': 0.835, 'compress@10': 0.0697, 'time@10': 4.6554}:  50%|█████     | 5/10 [00:15<00:17,  3.41s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.048, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8352, 'compress@10': 0.0653, 'time@10': 4.9151}:  50%|█████     | 5/10 [00:22<00:17,  3.41s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.048, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8352, 'compress@10': 0.0653, 'time@10': 4.9151}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.047, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8381, 'compress@10': 0.0634, 'time@10': 5.1724}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.047, 'hit_ratio@10': 0.838, 'ndcg@10': 0.8381, 'compress@10': 0.0634, 'time@10': 5.1724}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0465, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8448, 'compress@10': 0.0606, 'time@10': 5.1349}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0465, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8448, 'compress@10': 0.0606, 'time@10': 5.1349}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0469, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8523, 'compress@10': 0.0585, 'time@10': 5.5244}:  80%|████████  | 8/10 [00:34<00:08,  4.33s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0469, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8523, 'compress@10': 0.0585, 'time@10': 5.5244}:  90%|█████████ | 9/10 [00:34<00:04,  4.34s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0463, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8526, 'compress@10': 0.0567, 'time@10': 5.537}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]    {'epoch': 6, 'num_users': 6.3, 'loss': 0.0463, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8526, 'compress@10': 0.0567, 'time@10': 5.537}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0463, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8526, 'compress@10': 0.0567, 'time@10': 5.537}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04630720779557834
Avg hit ratio: 0.8483811067257587
Avg ndcg: 0.8526213913159815
Avg compression ratio: 0.056694822027577293
Avg train time: 5.536966609954834
Std train time: 1.849477192006924
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8424, 'compress@10': 0.0645, 'time@10': 4.2812}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8424, 'compress@10': 0.0645, 'time@10': 4.2812}:  10%|█         | 1/10 [00:02<00:19,  2.18s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8451, 'compress@10': 0.0555, 'time@10': 4.2491}:  10%|█         | 1/10 [00:06<00:19,  2.18s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8451, 'compress@10': 0.0555, 'time@10': 4.2491}:  20%|██        | 2/10 [00:06<00:27,  3.40s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8491, 'compress@10': 0.0883, 'time@10': 3.773}:  20%|██        | 2/10 [00:07<00:27,  3.40s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8491, 'compress@10': 0.0883, 'time@10': 3.773}:  30%|███       | 3/10 [00:07<00:17,  2.53s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8484, 'compress@10': 0.079, 'time@10': 3.7688}:  30%|███       | 3/10 [00:11<00:17,  2.53s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8484, 'compress@10': 0.079, 'time@10': 3.7688}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0437, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8366, 'compress@10': 0.0695, 'time@10': 4.681}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0437, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8366, 'compress@10': 0.0695, 'time@10': 4.681}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0456, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.8372, 'compress@10': 0.0651, 'time@10': 4.9282}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0456, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.8372, 'compress@10': 0.0651, 'time@10': 4.9282}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0448, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8407, 'compress@10': 0.0633, 'time@10': 5.1802}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it] {'epoch': 7, 'num_users': 6.2857, 'loss': 0.0448, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8407, 'compress@10': 0.0633, 'time@10': 5.1802}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0444, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8473, 'compress@10': 0.0604, 'time@10': 5.121}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0444, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8473, 'compress@10': 0.0604, 'time@10': 5.121}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.044, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8543, 'compress@10': 0.0583, 'time@10': 5.5032}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.044, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8543, 'compress@10': 0.0583, 'time@10': 5.5032}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0441, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8576, 'compress@10': 0.0565, 'time@10': 5.5296}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]  {'epoch': 7, 'num_users': 6.3, 'loss': 0.0441, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8576, 'compress@10': 0.0565, 'time@10': 5.5296}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0441, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8576, 'compress@10': 0.0565, 'time@10': 5.5296}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04413231309264
Avg hit ratio: 0.8645939261643845
Avg ndcg: 0.8575613107136011
Avg compression ratio: 0.05650362403665686
Avg train time: 5.529568862915039
Std train time: 1.8242623855437965
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.865, 'compress@10': 0.0647, 'time@10': 4.2732}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.865, 'compress@10': 0.0647, 'time@10': 4.2732}:  10%|█         | 1/10 [00:02<00:19,  2.17s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8701, 'compress@10': 0.0554, 'time@10': 4.2366}:  10%|█         | 1/10 [00:06<00:19,  2.17s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8701, 'compress@10': 0.0554, 'time@10': 4.2366}:  20%|██        | 2/10 [00:06<00:27,  3.39s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8658, 'compress@10': 0.0882, 'time@10': 3.813}:  20%|██        | 2/10 [00:07<00:27,  3.39s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8658, 'compress@10': 0.0882, 'time@10': 3.813}:  30%|███       | 3/10 [00:07<00:17,  2.54s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8628, 'compress@10': 0.0791, 'time@10': 3.7885}:  30%|███       | 3/10 [00:11<00:17,  2.54s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8628, 'compress@10': 0.0791, 'time@10': 3.7885}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0422, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8472, 'compress@10': 0.0696, 'time@10': 4.6998}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0422, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8472, 'compress@10': 0.0696, 'time@10': 4.6998}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0436, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8472, 'compress@10': 0.0652, 'time@10': 4.9414}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0436, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8472, 'compress@10': 0.0652, 'time@10': 4.9414}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0429, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.852, 'compress@10': 0.0634, 'time@10': 5.1895}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it] {'epoch': 8, 'num_users': 6.2857, 'loss': 0.0429, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.852, 'compress@10': 0.0634, 'time@10': 5.1895}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0429, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.8593, 'compress@10': 0.0603, 'time@10': 5.1321}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0429, 'hit_ratio@10': 0.8676, 'ndcg@10': 0.8593, 'compress@10': 0.0603, 'time@10': 5.1321}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0414, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8666, 'compress@10': 0.0582, 'time@10': 5.5229}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0414, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8666, 'compress@10': 0.0582, 'time@10': 5.5229}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0404, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.8685, 'compress@10': 0.0564, 'time@10': 5.5522}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0404, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.8685, 'compress@10': 0.0564, 'time@10': 5.5522}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0404, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.8685, 'compress@10': 0.0564, 'time@10': 5.5522}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04040348503648343
Avg hit ratio: 0.8660852914299433
Avg ndcg: 0.8685496676898319
Avg compression ratio: 0.05638597669576388
Avg train time: 5.552166295051575
Std train time: 1.8244639128376015
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.837, 'compress@10': 0.0649, 'time@10': 4.6422}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.837, 'compress@10': 0.0649, 'time@10': 4.6422}:  10%|█         | 1/10 [00:02<00:21,  2.43s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8569, 'compress@10': 0.0552, 'time@10': 4.424}:  10%|█         | 1/10 [00:06<00:21,  2.43s/it] {'epoch': 9, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8569, 'compress@10': 0.0552, 'time@10': 4.424}:  20%|██        | 2/10 [00:06<00:27,  3.50s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.028, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.857, 'compress@10': 0.088, 'time@10': 3.9972}:  20%|██        | 2/10 [00:08<00:27,  3.50s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.028, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.857, 'compress@10': 0.088, 'time@10': 3.9972}:  30%|███       | 3/10 [00:08<00:18,  2.64s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8585, 'compress@10': 0.0791, 'time@10': 3.9348}:  30%|███       | 3/10 [00:12<00:18,  2.64s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8585, 'compress@10': 0.0791, 'time@10': 3.9348}:  40%|████      | 4/10 [00:12<00:18,  3.10s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0405, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.844, 'compress@10': 0.0695, 'time@10': 4.8065}:  40%|████      | 4/10 [00:16<00:18,  3.10s/it] {'epoch': 9, 'num_users': 5.8, 'loss': 0.0405, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.844, 'compress@10': 0.0695, 'time@10': 4.8065}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0414, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8453, 'compress@10': 0.065, 'time@10': 5.032}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0414, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8453, 'compress@10': 0.065, 'time@10': 5.032}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0409, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8439, 'compress@10': 0.0633, 'time@10': 5.2677}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0409, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8439, 'compress@10': 0.0633, 'time@10': 5.2677}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0408, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8494, 'compress@10': 0.0603, 'time@10': 5.1901}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0408, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8494, 'compress@10': 0.0603, 'time@10': 5.1901}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0395, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8576, 'compress@10': 0.0582, 'time@10': 5.5592}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0395, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8576, 'compress@10': 0.0582, 'time@10': 5.5592}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0389, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8601, 'compress@10': 0.0563, 'time@10': 5.5821}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0389, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8601, 'compress@10': 0.0563, 'time@10': 5.5821}: 100%|██████████| 10/10 [00:40<00:00,  4.76s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0389, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8601, 'compress@10': 0.0563, 'time@10': 5.5821}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.038865204095998605
Avg hit ratio: 0.8714379154141463
Avg ndcg: 0.860078697591234
Avg compression ratio: 0.056315520858901257
Avg train time: 5.582096338272095
Std train time: 1.7459319185467927
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.844, 'compress@10': 0.0643, 'time@10': 4.1299}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.844, 'compress@10': 0.0643, 'time@10': 4.1299}:  10%|█         | 1/10 [00:02<00:19,  2.20s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8642, 'compress@10': 0.0547, 'time@10': 4.1179}:  10%|█         | 1/10 [00:06<00:19,  2.20s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8642, 'compress@10': 0.0547, 'time@10': 4.1179}:  20%|██        | 2/10 [00:06<00:26,  3.36s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8619, 'compress@10': 0.0876, 'time@10': 3.7972}:  20%|██        | 2/10 [00:07<00:26,  3.36s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8619, 'compress@10': 0.0876, 'time@10': 3.7972}:  30%|███       | 3/10 [00:07<00:17,  2.56s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8645, 'compress@10': 0.0787, 'time@10': 3.7882}:  30%|███       | 3/10 [00:11<00:17,  2.56s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8645, 'compress@10': 0.0787, 'time@10': 3.7882}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0382, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8493, 'compress@10': 0.0692, 'time@10': 4.6897}:  40%|████      | 4/10 [00:16<00:18,  3.05s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0382, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8493, 'compress@10': 0.0692, 'time@10': 4.6897}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0388, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8514, 'compress@10': 0.0647, 'time@10': 4.9415}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0388, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8514, 'compress@10': 0.0647, 'time@10': 4.9415}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0389, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8579, 'compress@10': 0.0631, 'time@10': 5.1924}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0389, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8579, 'compress@10': 0.0631, 'time@10': 5.1924}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0388, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8618, 'compress@10': 0.0603, 'time@10': 5.1305}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0388, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8618, 'compress@10': 0.0603, 'time@10': 5.1305}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0392, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8724, 'compress@10': 0.0581, 'time@10': 5.5028}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0392, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8724, 'compress@10': 0.0581, 'time@10': 5.5028}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0378, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8752, 'compress@10': 0.0562, 'time@10': 5.5318}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0378, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8752, 'compress@10': 0.0562, 'time@10': 5.5318}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0378, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8752, 'compress@10': 0.0562, 'time@10': 5.5318}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03775620184839003
Avg hit ratio: 0.8816976556738865
Avg ndcg: 0.8752207577051825
Avg compression ratio: 0.05619568417651277
Avg train time: 5.53175048828125
Std train time: 1.780133759795067
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8567, 'compress@10': 0.0642, 'time@10': 5.0371}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8567, 'compress@10': 0.0642, 'time@10': 5.0371}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8744, 'compress@10': 0.0544, 'time@10': 4.3801}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8744, 'compress@10': 0.0544, 'time@10': 4.3801}:  20%|██        | 2/10 [00:06<00:26,  3.26s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8687, 'compress@10': 0.0873, 'time@10': 3.9396}:  20%|██        | 2/10 [00:07<00:26,  3.26s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8687, 'compress@10': 0.0873, 'time@10': 3.9396}:  30%|███       | 3/10 [00:07<00:17,  2.50s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8708, 'compress@10': 0.0785, 'time@10': 3.8891}:  30%|███       | 3/10 [00:11<00:17,  2.50s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8708, 'compress@10': 0.0785, 'time@10': 3.8891}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0367, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8559, 'compress@10': 0.0688, 'time@10': 4.8108}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0367, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8559, 'compress@10': 0.0688, 'time@10': 4.8108}:  50%|█████     | 5/10 [00:15<00:17,  3.47s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0369, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8586, 'compress@10': 0.0644, 'time@10': 5.0547}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0369, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8586, 'compress@10': 0.0644, 'time@10': 5.0547}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0367, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.8561, 'compress@10': 0.0627, 'time@10': 5.3009}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0367, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.8561, 'compress@10': 0.0627, 'time@10': 5.3009}:  70%|███████   | 7/10 [00:25<00:12,  4.11s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0366, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.862, 'compress@10': 0.0602, 'time@10': 5.2273}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it]  {'epoch': 11, 'num_users': 6.125, 'loss': 0.0366, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.862, 'compress@10': 0.0602, 'time@10': 5.2273}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.037, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8842, 'compress@10': 0.0581, 'time@10': 5.5883}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.037, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8842, 'compress@10': 0.0581, 'time@10': 5.5883}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0362, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8862, 'compress@10': 0.0562, 'time@10': 5.6108}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.0362, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8862, 'compress@10': 0.0562, 'time@10': 5.6108}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0362, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.8862, 'compress@10': 0.0562, 'time@10': 5.6108}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03615714340934276
Avg hit ratio: 0.8852849572611883
Avg ndcg: 0.8861707577509854
Avg compression ratio: 0.05621820913669027
Avg train time: 5.610819029808044
Std train time: 1.8196244930500554
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8614, 'compress@10': 0.064, 'time@10': 4.9537}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8614, 'compress@10': 0.064, 'time@10': 4.9537}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0383, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8752, 'compress@10': 0.0542, 'time@10': 4.3833}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0383, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8752, 'compress@10': 0.0542, 'time@10': 4.3833}:  20%|██        | 2/10 [00:06<00:26,  3.30s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8692, 'compress@10': 0.087, 'time@10': 4.0177}:  20%|██        | 2/10 [00:08<00:26,  3.30s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8692, 'compress@10': 0.087, 'time@10': 4.0177}:  30%|███       | 3/10 [00:08<00:17,  2.56s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8695, 'compress@10': 0.0781, 'time@10': 3.9472}:  30%|███       | 3/10 [00:11<00:17,  2.56s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8695, 'compress@10': 0.0781, 'time@10': 3.9472}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8561, 'compress@10': 0.0685, 'time@10': 4.823}:  40%|████      | 4/10 [00:16<00:18,  3.04s/it] {'epoch': 12, 'num_users': 5.8, 'loss': 0.0361, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8561, 'compress@10': 0.0685, 'time@10': 4.823}:  50%|█████     | 5/10 [00:16<00:17,  3.46s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.036, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.859, 'compress@10': 0.064, 'time@10': 5.0473}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.036, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.859, 'compress@10': 0.064, 'time@10': 5.0473}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0357, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8653, 'compress@10': 0.0624, 'time@10': 5.2902}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0357, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8653, 'compress@10': 0.0624, 'time@10': 5.2902}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0353, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8694, 'compress@10': 0.0601, 'time@10': 5.2245}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0353, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8694, 'compress@10': 0.0601, 'time@10': 5.2245}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0361, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8852, 'compress@10': 0.058, 'time@10': 5.5728}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0361, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8852, 'compress@10': 0.058, 'time@10': 5.5728}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0357, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8853, 'compress@10': 0.0561, 'time@10': 5.5986}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.0357, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8853, 'compress@10': 0.0561, 'time@10': 5.5986}: 100%|██████████| 10/10 [00:40<00:00,  4.77s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0357, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8853, 'compress@10': 0.0561, 'time@10': 5.5986}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03567966716752395
Avg hit ratio: 0.8802055921818231
Avg ndcg: 0.8853370060915967
Avg compression ratio: 0.05614253944734645
Avg train time: 5.598613286018372
Std train time: 1.7284930320977525
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.862, 'compress@10': 0.064, 'time@10': 4.9304}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.862, 'compress@10': 0.064, 'time@10': 4.9304}:  10%|█         | 1/10 [00:02<00:22,  2.50s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8787, 'compress@10': 0.0542, 'time@10': 4.418}:  10%|█         | 1/10 [00:06<00:22,  2.50s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8787, 'compress@10': 0.0542, 'time@10': 4.418}:  20%|██        | 2/10 [00:06<00:26,  3.35s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8715, 'compress@10': 0.087, 'time@10': 4.044}:  20%|██        | 2/10 [00:08<00:26,  3.35s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8715, 'compress@10': 0.087, 'time@10': 4.044}:  30%|███       | 3/10 [00:08<00:18,  2.59s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8737, 'compress@10': 0.078, 'time@10': 3.9754}:  30%|███       | 3/10 [00:11<00:18,  2.59s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8737, 'compress@10': 0.078, 'time@10': 3.9754}:  40%|████      | 4/10 [00:11<00:18,  3.07s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0337, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8604, 'compress@10': 0.0684, 'time@10': 4.8435}:  40%|████      | 4/10 [00:16<00:18,  3.07s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0337, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8604, 'compress@10': 0.0684, 'time@10': 4.8435}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0342, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8626, 'compress@10': 0.0637, 'time@10': 5.0759}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0342, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8626, 'compress@10': 0.0637, 'time@10': 5.0759}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0338, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8657, 'compress@10': 0.062, 'time@10': 5.3124}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it] {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0338, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8657, 'compress@10': 0.062, 'time@10': 5.3124}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0332, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8702, 'compress@10': 0.0601, 'time@10': 5.2438}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0332, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8702, 'compress@10': 0.0601, 'time@10': 5.2438}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0332, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8771, 'compress@10': 0.0579, 'time@10': 5.6}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]  {'epoch': 13, 'num_users': 6.3333, 'loss': 0.0332, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8771, 'compress@10': 0.0579, 'time@10': 5.6}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8834, 'compress@10': 0.056, 'time@10': 5.6215}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it] {'epoch': 13, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8834, 'compress@10': 0.056, 'time@10': 5.6215}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8834, 'compress@10': 0.056, 'time@10': 5.6215}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03123326800401994
Avg hit ratio: 0.8802055921818231
Avg ndcg: 0.8834088513230647
Avg compression ratio: 0.0560271351129239
Avg train time: 5.6214968919754025
Std train time: 1.7292507514240807
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8422, 'compress@10': 0.0643, 'time@10': 4.8905}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8422, 'compress@10': 0.0643, 'time@10': 4.8905}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8667, 'compress@10': 0.0545, 'time@10': 4.2478}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8667, 'compress@10': 0.0545, 'time@10': 4.2478}:  20%|██        | 2/10 [00:06<00:25,  3.17s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8635, 'compress@10': 0.0871, 'time@10': 3.9308}:  20%|██        | 2/10 [00:07<00:25,  3.17s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8635, 'compress@10': 0.0871, 'time@10': 3.9308}:  30%|███       | 3/10 [00:07<00:17,  2.49s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8674, 'compress@10': 0.0781, 'time@10': 3.8889}:  30%|███       | 3/10 [00:11<00:17,  2.49s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8674, 'compress@10': 0.0781, 'time@10': 3.8889}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0342, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.856, 'compress@10': 0.0684, 'time@10': 4.7837}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it] {'epoch': 14, 'num_users': 5.8, 'loss': 0.0342, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.856, 'compress@10': 0.0684, 'time@10': 4.7837}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0341, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8598, 'compress@10': 0.0635, 'time@10': 5.0502}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0341, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8598, 'compress@10': 0.0635, 'time@10': 5.0502}:  60%|██████    | 6/10 [00:22<00:17,  4.46s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.033, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8663, 'compress@10': 0.0619, 'time@10': 5.2918}:  60%|██████    | 6/10 [00:25<00:17,  4.46s/it]  {'epoch': 14, 'num_users': 6.2857, 'loss': 0.033, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8663, 'compress@10': 0.0619, 'time@10': 5.2918}:  70%|███████   | 7/10 [00:25<00:12,  4.12s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0319, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8713, 'compress@10': 0.0602, 'time@10': 5.2206}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0319, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8713, 'compress@10': 0.0602, 'time@10': 5.2206}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0308, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8785, 'compress@10': 0.0579, 'time@10': 5.5998}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0308, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8785, 'compress@10': 0.0579, 'time@10': 5.5998}:  90%|█████████ | 9/10 [00:34<00:04,  4.33s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8783, 'compress@10': 0.0562, 'time@10': 5.6237}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]    {'epoch': 14, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8783, 'compress@10': 0.0562, 'time@10': 5.6237}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8783, 'compress@10': 0.0562, 'time@10': 5.6237}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.030993862548265444
Avg hit ratio: 0.8815706715469025
Avg ndcg: 0.8782879406699078
Avg compression ratio: 0.056167899613506565
Avg train time: 5.623719954490662
Std train time: 1.8093087728177049
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0406, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8635, 'compress@10': 0.0649, 'time@10': 4.8823}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0406, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8635, 'compress@10': 0.0649, 'time@10': 4.8823}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0324, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8808, 'compress@10': 0.0554, 'time@10': 4.336}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it] {'epoch': 15, 'num_users': 7.0, 'loss': 0.0324, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8808, 'compress@10': 0.0554, 'time@10': 4.336}:  20%|██        | 2/10 [00:06<00:26,  3.27s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8729, 'compress@10': 0.0877, 'time@10': 3.9901}:  20%|██        | 2/10 [00:08<00:26,  3.27s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8729, 'compress@10': 0.0877, 'time@10': 3.9901}:  30%|███       | 3/10 [00:08<00:17,  2.55s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8757, 'compress@10': 0.0786, 'time@10': 3.9374}:  30%|███       | 3/10 [00:11<00:17,  2.55s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8757, 'compress@10': 0.0786, 'time@10': 3.9374}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8642, 'compress@10': 0.0687, 'time@10': 4.8007}:  40%|████      | 4/10 [00:15<00:18,  3.05s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8642, 'compress@10': 0.0687, 'time@10': 4.8007}:  50%|█████     | 5/10 [00:15<00:17,  3.46s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0313, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8689, 'compress@10': 0.0636, 'time@10': 5.0335}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0313, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8689, 'compress@10': 0.0636, 'time@10': 5.0335}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0313, 'hit_ratio@10': 0.885, 'ndcg@10': 0.873, 'compress@10': 0.062, 'time@10': 5.2701}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]   {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0313, 'hit_ratio@10': 0.885, 'ndcg@10': 0.873, 'compress@10': 0.062, 'time@10': 5.2701}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.03, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.8782, 'compress@10': 0.0604, 'time@10': 5.2018}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.03, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.8782, 'compress@10': 0.0604, 'time@10': 5.2018}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0287, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8853, 'compress@10': 0.0581, 'time@10': 5.5626}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0287, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8853, 'compress@10': 0.0581, 'time@10': 5.5626}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.8916, 'compress@10': 0.0562, 'time@10': 5.5838}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.8916, 'compress@10': 0.0562, 'time@10': 5.5838}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.8916, 'compress@10': 0.0562, 'time@10': 5.5838}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.02685182673664463
Avg hit ratio: 0.8857928937691246
Avg ndcg: 0.891609782854798
Avg compression ratio: 0.056171558404470724
Avg train time: 5.583780360221863
Std train time: 1.7292607146204952
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0389, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.863, 'compress@10': 0.0653, 'time@10': 4.9451}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0389, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.863, 'compress@10': 0.0653, 'time@10': 4.9451}:  10%|█         | 1/10 [00:02<00:22,  2.51s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8799, 'compress@10': 0.0563, 'time@10': 4.3468}:  10%|█         | 1/10 [00:06<00:22,  2.51s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8799, 'compress@10': 0.0563, 'time@10': 4.3468}:  20%|██        | 2/10 [00:06<00:26,  3.26s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8723, 'compress@10': 0.0884, 'time@10': 4.011}:  20%|██        | 2/10 [00:08<00:26,  3.26s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8723, 'compress@10': 0.0884, 'time@10': 4.011}:  30%|███       | 3/10 [00:08<00:17,  2.55s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8765, 'compress@10': 0.0791, 'time@10': 3.9568}:  30%|███       | 3/10 [00:11<00:17,  2.55s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8765, 'compress@10': 0.0791, 'time@10': 3.9568}:  40%|████      | 4/10 [00:11<00:18,  3.06s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0289, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.866, 'compress@10': 0.0692, 'time@10': 4.8288}:  40%|████      | 4/10 [00:16<00:18,  3.06s/it] {'epoch': 16, 'num_users': 5.8, 'loss': 0.0289, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.866, 'compress@10': 0.0692, 'time@10': 4.8288}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8746, 'compress@10': 0.0639, 'time@10': 5.0487}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8746, 'compress@10': 0.0639, 'time@10': 5.0487}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.876, 'compress@10': 0.0623, 'time@10': 5.2826}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.876, 'compress@10': 0.0623, 'time@10': 5.2826}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.028, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8821, 'compress@10': 0.0607, 'time@10': 5.2193}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.028, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8821, 'compress@10': 0.0607, 'time@10': 5.2193}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.8893, 'compress@10': 0.0585, 'time@10': 5.602}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.8893, 'compress@10': 0.0585, 'time@10': 5.602}:  90%|█████████ | 9/10 [00:34<00:04,  4.33s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.8902, 'compress@10': 0.0567, 'time@10': 5.6251}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]  {'epoch': 16, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.8902, 'compress@10': 0.0567, 'time@10': 5.6251}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.8902, 'compress@10': 0.0567, 'time@10': 5.6251}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.02825057173670219
Avg hit ratio: 0.8975901287921662
Avg ndcg: 0.8901874498486876
Avg compression ratio: 0.056731297133437386
Avg train time: 5.625061273574829
Std train time: 1.7662890743423767
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8659, 'compress@10': 0.0661, 'time@10': 4.8587}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8659, 'compress@10': 0.0661, 'time@10': 4.8587}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.882, 'compress@10': 0.0572, 'time@10': 4.2545}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it] {'epoch': 17, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.882, 'compress@10': 0.0572, 'time@10': 4.2545}:  20%|██        | 2/10 [00:06<00:25,  3.19s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8737, 'compress@10': 0.0891, 'time@10': 3.9333}:  20%|██        | 2/10 [00:07<00:25,  3.19s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8737, 'compress@10': 0.0891, 'time@10': 3.9333}:  30%|███       | 3/10 [00:07<00:17,  2.50s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8779, 'compress@10': 0.0797, 'time@10': 3.8941}:  30%|███       | 3/10 [00:11<00:17,  2.50s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8779, 'compress@10': 0.0797, 'time@10': 3.8941}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.027, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8687, 'compress@10': 0.0697, 'time@10': 4.7639}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it] {'epoch': 17, 'num_users': 5.8, 'loss': 0.027, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8687, 'compress@10': 0.0697, 'time@10': 4.7639}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0268, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8752, 'compress@10': 0.0642, 'time@10': 5.0078}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0268, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8752, 'compress@10': 0.0642, 'time@10': 5.0078}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0262, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.8799, 'compress@10': 0.0626, 'time@10': 5.2478}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0262, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.8799, 'compress@10': 0.0626, 'time@10': 5.2478}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0253, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.885, 'compress@10': 0.0609, 'time@10': 5.1964}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 0.0253, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.885, 'compress@10': 0.0609, 'time@10': 5.1964}:  80%|████████  | 8/10 [00:30<00:08,  4.32s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0255, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.8986, 'compress@10': 0.0589, 'time@10': 5.5502}:  80%|████████  | 8/10 [00:34<00:08,  4.32s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0255, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.8986, 'compress@10': 0.0589, 'time@10': 5.5502}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0245, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.903, 'compress@10': 0.057, 'time@10': 5.5872}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]     {'epoch': 17, 'num_users': 6.3, 'loss': 0.0245, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.903, 'compress@10': 0.057, 'time@10': 5.5872}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0245, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.903, 'compress@10': 0.057, 'time@10': 5.5872}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02450764946262823
Avg hit ratio: 0.8965865445627754
Avg ndcg: 0.9029969367679971
Avg compression ratio: 0.056997504078618436
Avg train time: 5.587234663963318
Std train time: 1.731753167213304
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8657, 'compress@10': 0.0664, 'time@10': 4.9661}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8657, 'compress@10': 0.0664, 'time@10': 4.9661}:  10%|█         | 1/10 [00:02<00:22,  2.52s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0291, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8875, 'compress@10': 0.0573, 'time@10': 4.2959}:  10%|█         | 1/10 [00:06<00:22,  2.52s/it] {'epoch': 18, 'num_users': 7.0, 'loss': 0.0291, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8875, 'compress@10': 0.0573, 'time@10': 4.2959}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8774, 'compress@10': 0.0893, 'time@10': 3.9745}:  20%|██        | 2/10 [00:07<00:25,  3.20s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8774, 'compress@10': 0.0893, 'time@10': 3.9745}:  30%|███       | 3/10 [00:07<00:17,  2.52s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8838, 'compress@10': 0.0799, 'time@10': 3.9202}:  30%|███       | 3/10 [00:11<00:17,  2.52s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8838, 'compress@10': 0.0799, 'time@10': 3.9202}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8746, 'compress@10': 0.0699, 'time@10': 4.7994}:  40%|████      | 4/10 [00:15<00:18,  3.04s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8746, 'compress@10': 0.0699, 'time@10': 4.7994}:  50%|█████     | 5/10 [00:15<00:17,  3.46s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0265, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.8807, 'compress@10': 0.0644, 'time@10': 5.032}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0265, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.8807, 'compress@10': 0.0644, 'time@10': 5.032}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0273, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.8835, 'compress@10': 0.0628, 'time@10': 5.2689}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0273, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.8835, 'compress@10': 0.0628, 'time@10': 5.2689}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0262, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.8898, 'compress@10': 0.0611, 'time@10': 5.1997}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0262, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.8898, 'compress@10': 0.0611, 'time@10': 5.1997}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9129, 'compress@10': 0.0592, 'time@10': 5.5637}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9129, 'compress@10': 0.0592, 'time@10': 5.5637}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0266, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9158, 'compress@10': 0.0573, 'time@10': 5.5831}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0266, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9158, 'compress@10': 0.0573, 'time@10': 5.5831}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0266, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9158, 'compress@10': 0.0573, 'time@10': 5.5831}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.026605219576148337
Avg hit ratio: 0.9042557174951062
Avg ndcg: 0.9157794355476883
Avg compression ratio: 0.05732233084308003
Avg train time: 5.583056640625
Std train time: 1.7560718760613594
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8725, 'compress@10': 0.0671, 'time@10': 4.9811}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8725, 'compress@10': 0.0671, 'time@10': 4.9811}:  10%|█         | 1/10 [00:02<00:22,  2.53s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.8939, 'compress@10': 0.0582, 'time@10': 4.3188}:  10%|█         | 1/10 [00:06<00:22,  2.53s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.8939, 'compress@10': 0.0582, 'time@10': 4.3188}:  20%|██        | 2/10 [00:06<00:25,  3.22s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.749, 'ndcg@10': 0.8816, 'compress@10': 0.09, 'time@10': 3.988}:  20%|██        | 2/10 [00:07<00:25,  3.22s/it]    {'epoch': 19, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.749, 'ndcg@10': 0.8816, 'compress@10': 0.09, 'time@10': 3.988}:  30%|███       | 3/10 [00:07<00:17,  2.53s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8028, 'ndcg@10': 0.889, 'compress@10': 0.0806, 'time@10': 3.9365}:  30%|███       | 3/10 [00:11<00:17,  2.53s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8028, 'ndcg@10': 0.889, 'compress@10': 0.0806, 'time@10': 3.9365}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8807, 'compress@10': 0.0705, 'time@10': 4.8389}:  40%|████      | 4/10 [00:16<00:18,  3.04s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.8807, 'compress@10': 0.0705, 'time@10': 4.8389}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.026, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8894, 'compress@10': 0.065, 'time@10': 5.0602}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.026, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8894, 'compress@10': 0.065, 'time@10': 5.0602}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.026, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8892, 'compress@10': 0.0635, 'time@10': 5.3034}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.026, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8892, 'compress@10': 0.0635, 'time@10': 5.3034}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0258, 'hit_ratio@10': 0.88, 'ndcg@10': 0.8891, 'compress@10': 0.0618, 'time@10': 5.2419}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0258, 'hit_ratio@10': 0.88, 'ndcg@10': 0.8891, 'compress@10': 0.0618, 'time@10': 5.2419}:  80%|████████  | 8/10 [00:30<00:08,  4.33s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9082, 'compress@10': 0.06, 'time@10': 5.5993}:  80%|████████  | 8/10 [00:34<00:08,  4.33s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9082, 'compress@10': 0.06, 'time@10': 5.5993}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0288, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9092, 'compress@10': 0.0582, 'time@10': 5.6064}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0288, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9092, 'compress@10': 0.0582, 'time@10': 5.6064}: 100%|██████████| 10/10 [00:40<00:00,  4.74s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0288, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9092, 'compress@10': 0.0582, 'time@10': 5.6064}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.028761953275438235
Avg hit ratio: 0.8760529525181477
Avg ndcg: 0.9092366604823123
Avg compression ratio: 0.05818264479772898
Avg train time: 5.6063941478729244
Std train time: 1.76683142539422
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8814, 'compress@10': 0.0675, 'time@10': 4.8258}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8814, 'compress@10': 0.0675, 'time@10': 4.8258}:  10%|█         | 1/10 [00:02<00:22,  2.45s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9057, 'compress@10': 0.0585, 'time@10': 4.1867}:  10%|█         | 1/10 [00:06<00:22,  2.45s/it] {'epoch': 20, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9057, 'compress@10': 0.0585, 'time@10': 4.1867}:  20%|██        | 2/10 [00:06<00:24,  3.12s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8895, 'compress@10': 0.0904, 'time@10': 3.9115}:  20%|██        | 2/10 [00:07<00:24,  3.12s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8895, 'compress@10': 0.0904, 'time@10': 3.9115}:  30%|███       | 3/10 [00:07<00:17,  2.48s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8955, 'compress@10': 0.081, 'time@10': 3.8697}:  30%|███       | 3/10 [00:11<00:17,  2.48s/it]  {'epoch': 20, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8955, 'compress@10': 0.081, 'time@10': 3.8697}:  40%|████      | 4/10 [00:11<00:17,  2.99s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8875, 'compress@10': 0.0709, 'time@10': 4.761}:  40%|████      | 4/10 [00:15<00:17,  2.99s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8875, 'compress@10': 0.0709, 'time@10': 4.761}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.8958, 'compress@10': 0.0654, 'time@10': 5.0007}:  50%|█████     | 5/10 [00:21<00:17,  3.43s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.8958, 'compress@10': 0.0654, 'time@10': 5.0007}:  60%|██████    | 6/10 [00:21<00:17,  4.39s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0218, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9004, 'compress@10': 0.0638, 'time@10': 5.2478}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0218, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9004, 'compress@10': 0.0638, 'time@10': 5.2478}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0216, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9024, 'compress@10': 0.0619, 'time@10': 5.1727}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0216, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9024, 'compress@10': 0.0619, 'time@10': 5.1727}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9032, 'compress@10': 0.0601, 'time@10': 5.5452}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9032, 'compress@10': 0.0601, 'time@10': 5.5452}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9093, 'compress@10': 0.058, 'time@10': 5.5682}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]     {'epoch': 20, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9093, 'compress@10': 0.058, 'time@10': 5.5682}: 100%|██████████| 10/10 [00:40<00:00,  4.75s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9093, 'compress@10': 0.058, 'time@10': 5.5682}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.021846345099038055
Avg hit ratio: 0.894970003209392
Avg ndcg: 0.9093311472551475
Avg compression ratio: 0.05797762055312152
Avg train time: 5.568242716789245
Std train time: 1.783889661560723
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8794, 'compress@10': 0.067, 'time@10': 4.8041}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8794, 'compress@10': 0.067, 'time@10': 4.8041}:  10%|█         | 1/10 [00:02<00:21,  2.44s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9084, 'compress@10': 0.0586, 'time@10': 4.1966}:  10%|█         | 1/10 [00:06<00:21,  2.44s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9084, 'compress@10': 0.0586, 'time@10': 4.1966}:  20%|██        | 2/10 [00:06<00:25,  3.14s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8913, 'compress@10': 0.0904, 'time@10': 3.8828}:  20%|██        | 2/10 [00:07<00:25,  3.14s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8913, 'compress@10': 0.0904, 'time@10': 3.8828}:  30%|███       | 3/10 [00:07<00:17,  2.47s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8996, 'compress@10': 0.0809, 'time@10': 3.8586}:  30%|███       | 3/10 [00:11<00:17,  2.47s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8996, 'compress@10': 0.0809, 'time@10': 3.8586}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8918, 'compress@10': 0.0708, 'time@10': 4.7642}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]   {'epoch': 21, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8918, 'compress@10': 0.0708, 'time@10': 4.7642}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0217, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.8996, 'compress@10': 0.0654, 'time@10': 5.0068}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0217, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.8996, 'compress@10': 0.0654, 'time@10': 5.0068}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.8977, 'compress@10': 0.0638, 'time@10': 5.268}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it] {'epoch': 21, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.8977, 'compress@10': 0.0638, 'time@10': 5.268}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0217, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.903, 'compress@10': 0.0619, 'time@10': 5.2005}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0217, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.903, 'compress@10': 0.0619, 'time@10': 5.2005}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0239, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9229, 'compress@10': 0.06, 'time@10': 5.5573}:  80%|████████  | 8/10 [00:34<00:08,  4.31s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0239, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9229, 'compress@10': 0.06, 'time@10': 5.5573}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9229, 'compress@10': 0.058, 'time@10': 5.5859}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]  {'epoch': 21, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9229, 'compress@10': 0.058, 'time@10': 5.5859}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9229, 'compress@10': 0.058, 'time@10': 5.5859}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.02435252488755222
Avg hit ratio: 0.8957667531487565
Avg ndcg: 0.9229237603054031
Avg compression ratio: 0.058012239770928356
Avg train time: 5.5858855724334715
Std train time: 1.7851913232786594
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.884, 'compress@10': 0.0677, 'time@10': 4.9213}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.884, 'compress@10': 0.0677, 'time@10': 4.9213}:  10%|█         | 1/10 [00:02<00:22,  2.50s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9109, 'compress@10': 0.059, 'time@10': 4.2505}:  10%|█         | 1/10 [00:06<00:22,  2.50s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9109, 'compress@10': 0.059, 'time@10': 4.2505}:  20%|██        | 2/10 [00:06<00:25,  3.16s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.893, 'compress@10': 0.091, 'time@10': 3.8905}:  20%|██        | 2/10 [00:07<00:25,  3.16s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.893, 'compress@10': 0.091, 'time@10': 3.8905}:  30%|███       | 3/10 [00:07<00:17,  2.46s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9052, 'compress@10': 0.0815, 'time@10': 3.8522}:  30%|███       | 3/10 [00:11<00:17,  2.46s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9052, 'compress@10': 0.0815, 'time@10': 3.8522}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8988, 'compress@10': 0.0714, 'time@10': 4.7242}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8988, 'compress@10': 0.0714, 'time@10': 4.7242}:  50%|█████     | 5/10 [00:15<00:17,  3.41s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9067, 'compress@10': 0.0657, 'time@10': 4.9753}:  50%|█████     | 5/10 [00:21<00:17,  3.41s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0206, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9067, 'compress@10': 0.0657, 'time@10': 4.9753}:  60%|██████    | 6/10 [00:21<00:17,  4.38s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9057, 'compress@10': 0.0642, 'time@10': 5.2459}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9057, 'compress@10': 0.0642, 'time@10': 5.2459}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.9158, 'ndcg@10': 0.9076, 'compress@10': 0.0625, 'time@10': 5.1771}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.9158, 'ndcg@10': 0.9076, 'compress@10': 0.0625, 'time@10': 5.1771}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0219, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9104, 'compress@10': 0.0607, 'time@10': 5.5554}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0219, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9104, 'compress@10': 0.0607, 'time@10': 5.5554}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9155, 'compress@10': 0.0587, 'time@10': 5.589}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]    {'epoch': 22, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9155, 'compress@10': 0.0587, 'time@10': 5.589}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9155, 'compress@10': 0.0587, 'time@10': 5.589}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.021338534068190113
Avg hit ratio: 0.9074815239467192
Avg ndcg: 0.9154567783738177
Avg compression ratio: 0.05870323201654121
Avg train time: 5.5890404224395756
Std train time: 1.8037841173380504
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.891, 'compress@10': 0.0678, 'time@10': 4.8239}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0272, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.891, 'compress@10': 0.0678, 'time@10': 4.8239}:  10%|█         | 1/10 [00:02<00:22,  2.46s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9127, 'compress@10': 0.0592, 'time@10': 4.2562}:  10%|█         | 1/10 [00:06<00:22,  2.46s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9127, 'compress@10': 0.0592, 'time@10': 4.2562}:  20%|██        | 2/10 [00:06<00:25,  3.21s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8942, 'compress@10': 0.0912, 'time@10': 3.8802}:  20%|██        | 2/10 [00:07<00:25,  3.21s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8942, 'compress@10': 0.0912, 'time@10': 3.8802}:  30%|███       | 3/10 [00:07<00:17,  2.48s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9061, 'compress@10': 0.0817, 'time@10': 3.8716}:  30%|███       | 3/10 [00:11<00:17,  2.48s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9061, 'compress@10': 0.0817, 'time@10': 3.8716}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9016, 'compress@10': 0.0717, 'time@10': 4.7489}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9016, 'compress@10': 0.0717, 'time@10': 4.7489}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.019, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.91, 'compress@10': 0.0659, 'time@10': 4.995}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it] {'epoch': 23, 'num_users': 6.1667, 'loss': 0.019, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.91, 'compress@10': 0.0659, 'time@10': 4.995}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9144, 'compress@10': 0.0644, 'time@10': 5.2432}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9144, 'compress@10': 0.0644, 'time@10': 5.2432}:  70%|███████   | 7/10 [00:25<00:12,  4.08s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9178, 'compress@10': 0.0624, 'time@10': 5.1706}:  70%|███████   | 7/10 [00:30<00:12,  4.08s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9178, 'compress@10': 0.0624, 'time@10': 5.1706}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9295, 'compress@10': 0.0606, 'time@10': 5.5633}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9295, 'compress@10': 0.0606, 'time@10': 5.5633}:  90%|█████████ | 9/10 [00:34<00:04,  4.32s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9337, 'compress@10': 0.0585, 'time@10': 5.5999}:  90%|█████████ | 9/10 [00:40<00:04,  4.32s/it]     {'epoch': 23, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9337, 'compress@10': 0.0585, 'time@10': 5.5999}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9337, 'compress@10': 0.0585, 'time@10': 5.5999}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.01795531385151924
Avg hit ratio: 0.8789925596003695
Avg ndcg: 0.9337459547738376
Avg compression ratio: 0.05850335726820506
Avg train time: 5.599943065643311
Std train time: 1.8113369612114611
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.899, 'compress@10': 0.0684, 'time@10': 4.8392}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.899, 'compress@10': 0.0684, 'time@10': 4.8392}:  10%|█         | 1/10 [00:02<00:22,  2.46s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9262, 'compress@10': 0.0597, 'time@10': 4.2822}:  10%|█         | 1/10 [00:06<00:22,  2.46s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9262, 'compress@10': 0.0597, 'time@10': 4.2822}:  20%|██        | 2/10 [00:06<00:25,  3.23s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9032, 'compress@10': 0.0918, 'time@10': 3.864}:  20%|██        | 2/10 [00:07<00:25,  3.23s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9032, 'compress@10': 0.0918, 'time@10': 3.864}:  30%|███       | 3/10 [00:07<00:17,  2.47s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9143, 'compress@10': 0.082, 'time@10': 3.841}:  30%|███       | 3/10 [00:11<00:17,  2.47s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9143, 'compress@10': 0.082, 'time@10': 3.841}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.9089, 'compress@10': 0.0722, 'time@10': 4.7219}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.9089, 'compress@10': 0.0722, 'time@10': 4.7219}:  50%|█████     | 5/10 [00:15<00:17,  3.42s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9165, 'compress@10': 0.0663, 'time@10': 4.969}:  50%|█████     | 5/10 [00:22<00:17,  3.42s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9165, 'compress@10': 0.0663, 'time@10': 4.969}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0194, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9129, 'compress@10': 0.0649, 'time@10': 5.2221}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0194, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9129, 'compress@10': 0.0649, 'time@10': 5.2221}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9135, 'compress@10': 0.063, 'time@10': 5.1457}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]  {'epoch': 24, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9135, 'compress@10': 0.063, 'time@10': 5.1457}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9161, 'compress@10': 0.0613, 'time@10': 5.5283}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9161, 'compress@10': 0.0613, 'time@10': 5.5283}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9184, 'compress@10': 0.0595, 'time@10': 5.5618}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9184, 'compress@10': 0.0595, 'time@10': 5.5618}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9184, 'compress@10': 0.0595, 'time@10': 5.5618}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.01975201905281683
Avg hit ratio: 0.8781354167432266
Avg ndcg: 0.9183894452690617
Avg compression ratio: 0.059510485707478064
Avg train time: 5.56181914806366
Std train time: 1.8077454294267745
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9038, 'compress@10': 0.0688, 'time@10': 4.8378}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9038, 'compress@10': 0.0688, 'time@10': 4.8378}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9308, 'compress@10': 0.06, 'time@10': 4.3402}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it] {'epoch': 25, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9308, 'compress@10': 0.06, 'time@10': 4.3402}:  20%|██        | 2/10 [00:06<00:26,  3.31s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9062, 'compress@10': 0.0922, 'time@10': 3.9555}:  20%|██        | 2/10 [00:07<00:26,  3.31s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9062, 'compress@10': 0.0922, 'time@10': 3.9555}:  30%|███       | 3/10 [00:07<00:17,  2.54s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9165, 'compress@10': 0.0822, 'time@10': 3.9116}:  30%|███       | 3/10 [00:11<00:17,  2.54s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9165, 'compress@10': 0.0822, 'time@10': 3.9116}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0161, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9112, 'compress@10': 0.0724, 'time@10': 4.8082}:  40%|████      | 4/10 [00:16<00:18,  3.05s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0161, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9112, 'compress@10': 0.0724, 'time@10': 4.8082}:  50%|█████     | 5/10 [00:16<00:17,  3.48s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9201, 'compress@10': 0.0665, 'time@10': 5.0331}:  50%|█████     | 5/10 [00:22<00:17,  3.48s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9201, 'compress@10': 0.0665, 'time@10': 5.0331}:  60%|██████    | 6/10 [00:22<00:17,  4.40s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0174, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9203, 'compress@10': 0.0651, 'time@10': 5.2659}:  60%|██████    | 6/10 [00:25<00:17,  4.40s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0174, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9203, 'compress@10': 0.0651, 'time@10': 5.2659}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9229, 'compress@10': 0.0631, 'time@10': 5.1969}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.017, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9229, 'compress@10': 0.0631, 'time@10': 5.1969}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.935, 'compress@10': 0.0614, 'time@10': 5.5981}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0185, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.935, 'compress@10': 0.0614, 'time@10': 5.5981}:  90%|█████████ | 9/10 [00:34<00:04,  4.33s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9391, 'compress@10': 0.0594, 'time@10': 5.6266}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9391, 'compress@10': 0.0594, 'time@10': 5.6266}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9391, 'compress@10': 0.0594, 'time@10': 5.6266}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.017166814453102645
Avg hit ratio: 0.8887672382324334
Avg ndcg: 0.9391094423123066
Avg compression ratio: 0.059418132496101096
Avg train time: 5.6266018629074095
Std train time: 1.822068187757767
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9038, 'compress@10': 0.0695, 'time@10': 4.8916}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9038, 'compress@10': 0.0695, 'time@10': 4.8916}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9296, 'compress@10': 0.0605, 'time@10': 4.3656}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9296, 'compress@10': 0.0605, 'time@10': 4.3656}:  20%|██        | 2/10 [00:06<00:26,  3.31s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9055, 'compress@10': 0.0927, 'time@10': 3.8622}:  20%|██        | 2/10 [00:07<00:26,  3.31s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9055, 'compress@10': 0.0927, 'time@10': 3.8622}:  30%|███       | 3/10 [00:07<00:17,  2.47s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9167, 'compress@10': 0.0822, 'time@10': 3.8254}:  30%|███       | 3/10 [00:11<00:17,  2.47s/it]  {'epoch': 26, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9167, 'compress@10': 0.0822, 'time@10': 3.8254}:  40%|████      | 4/10 [00:11<00:17,  2.97s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9118, 'compress@10': 0.0726, 'time@10': 4.7268}:  40%|████      | 4/10 [00:15<00:17,  2.97s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9118, 'compress@10': 0.0726, 'time@10': 4.7268}:  50%|█████     | 5/10 [00:15<00:17,  3.42s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9183, 'compress@10': 0.0663, 'time@10': 4.9736}:  50%|█████     | 5/10 [00:22<00:17,  3.42s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0168, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9183, 'compress@10': 0.0663, 'time@10': 4.9736}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.922, 'compress@10': 0.065, 'time@10': 5.2317}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]  {'epoch': 26, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.922, 'compress@10': 0.065, 'time@10': 5.2317}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9247, 'compress@10': 0.0631, 'time@10': 5.1559}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9247, 'compress@10': 0.0631, 'time@10': 5.1559}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9268, 'compress@10': 0.0614, 'time@10': 5.5384}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9268, 'compress@10': 0.0614, 'time@10': 5.5384}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9292, 'compress@10': 0.0596, 'time@10': 5.5811}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9292, 'compress@10': 0.0596, 'time@10': 5.5811}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9292, 'compress@10': 0.0596, 'time@10': 5.5811}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.01724339469429966
Avg hit ratio: 0.88625881664082
Avg ndcg: 0.9291975372179937
Avg compression ratio: 0.059587181021026114
Avg train time: 5.58113317489624
Std train time: 1.843558495757737
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9038, 'compress@10': 0.0695, 'time@10': 4.8803}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9038, 'compress@10': 0.0695, 'time@10': 4.8803}:  10%|█         | 1/10 [00:02<00:22,  2.49s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9261, 'compress@10': 0.0606, 'time@10': 4.3517}:  10%|█         | 1/10 [00:06<00:22,  2.49s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9261, 'compress@10': 0.0606, 'time@10': 4.3517}:  20%|██        | 2/10 [00:06<00:26,  3.30s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9031, 'compress@10': 0.0928, 'time@10': 3.926}:  20%|██        | 2/10 [00:07<00:26,  3.30s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9031, 'compress@10': 0.0928, 'time@10': 3.926}:  30%|███       | 3/10 [00:07<00:17,  2.51s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9149, 'compress@10': 0.0822, 'time@10': 3.8788}:  30%|███       | 3/10 [00:11<00:17,  2.51s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9149, 'compress@10': 0.0822, 'time@10': 3.8788}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9107, 'compress@10': 0.0727, 'time@10': 4.7647}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9107, 'compress@10': 0.0727, 'time@10': 4.7647}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0149, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9191, 'compress@10': 0.0661, 'time@10': 5.0042}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0149, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9191, 'compress@10': 0.0661, 'time@10': 5.0042}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9182, 'compress@10': 0.0649, 'time@10': 5.25}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it] {'epoch': 27, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9182, 'compress@10': 0.0649, 'time@10': 5.25}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0166, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9175, 'compress@10': 0.0631, 'time@10': 5.1792}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0166, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9175, 'compress@10': 0.0631, 'time@10': 5.1792}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.923, 'compress@10': 0.0612, 'time@10': 5.5566}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.923, 'compress@10': 0.0612, 'time@10': 5.5566}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9281, 'compress@10': 0.0593, 'time@10': 5.5963}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]  {'epoch': 27, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9281, 'compress@10': 0.0593, 'time@10': 5.5963}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9281, 'compress@10': 0.0593, 'time@10': 5.5963}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.015725778626934393
Avg hit ratio: 0.8972362602498427
Avg ndcg: 0.9281171066741406
Avg compression ratio: 0.059286648310486634
Avg train time: 5.59634919166565
Std train time: 1.797440540514964
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9115, 'compress@10': 0.0698, 'time@10': 4.2306}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9115, 'compress@10': 0.0698, 'time@10': 4.2306}:  10%|█         | 1/10 [00:02<00:19,  2.16s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9357, 'compress@10': 0.0605, 'time@10': 4.096}:  10%|█         | 1/10 [00:06<00:19,  2.16s/it] {'epoch': 28, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9357, 'compress@10': 0.0605, 'time@10': 4.096}:  20%|██        | 2/10 [00:06<00:25,  3.24s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9095, 'compress@10': 0.0929, 'time@10': 3.7565}:  20%|██        | 2/10 [00:07<00:25,  3.24s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9095, 'compress@10': 0.0929, 'time@10': 3.7565}:  30%|███       | 3/10 [00:07<00:17,  2.48s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9211, 'compress@10': 0.082, 'time@10': 3.7571}:  30%|███       | 3/10 [00:11<00:17,  2.48s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9211, 'compress@10': 0.082, 'time@10': 3.7571}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9177, 'compress@10': 0.0726, 'time@10': 4.6746}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9177, 'compress@10': 0.0726, 'time@10': 4.6746}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9262, 'compress@10': 0.066, 'time@10': 4.9159}:  50%|█████     | 5/10 [00:21<00:17,  3.44s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9262, 'compress@10': 0.066, 'time@10': 4.9159}:  60%|██████    | 6/10 [00:21<00:17,  4.37s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0172, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.926, 'compress@10': 0.0649, 'time@10': 5.1942}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0172, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.926, 'compress@10': 0.0649, 'time@10': 5.1942}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9303, 'compress@10': 0.0629, 'time@10': 5.117}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]  {'epoch': 28, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9303, 'compress@10': 0.0629, 'time@10': 5.117}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.934, 'compress@10': 0.0611, 'time@10': 5.5037}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.934, 'compress@10': 0.0611, 'time@10': 5.5037}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9348, 'compress@10': 0.0593, 'time@10': 5.5455}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]  {'epoch': 28, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9348, 'compress@10': 0.0593, 'time@10': 5.5455}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9348, 'compress@10': 0.0593, 'time@10': 5.5455}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.017834553320871575
Avg hit ratio: 0.894563988171798
Avg ndcg: 0.9347796908536816
Avg compression ratio: 0.05932078013336398
Avg train time: 5.545520639419555
Std train time: 1.8390630119642914
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9152, 'compress@10': 0.0708, 'time@10': 5.0417}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9152, 'compress@10': 0.0708, 'time@10': 5.0417}:  10%|█         | 1/10 [00:02<00:23,  2.56s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9395, 'compress@10': 0.0612, 'time@10': 4.47}:  10%|█         | 1/10 [00:06<00:23,  2.56s/it]    {'epoch': 29, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9395, 'compress@10': 0.0612, 'time@10': 4.47}:  20%|██        | 2/10 [00:06<00:26,  3.37s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.912, 'compress@10': 0.0937, 'time@10': 4.0608}:  20%|██        | 2/10 [00:08<00:26,  3.37s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.912, 'compress@10': 0.0937, 'time@10': 4.0608}:  30%|███       | 3/10 [00:08<00:18,  2.59s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9236, 'compress@10': 0.0827, 'time@10': 3.9792}:  30%|███       | 3/10 [00:11<00:18,  2.59s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9236, 'compress@10': 0.0827, 'time@10': 3.9792}:  40%|████      | 4/10 [00:11<00:18,  3.06s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9197, 'compress@10': 0.0732, 'time@10': 4.8522}:  40%|████      | 4/10 [00:16<00:18,  3.06s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9197, 'compress@10': 0.0732, 'time@10': 4.8522}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9265, 'compress@10': 0.0665, 'time@10': 5.0701}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9265, 'compress@10': 0.0665, 'time@10': 5.0701}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9286, 'compress@10': 0.0655, 'time@10': 5.3138}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9286, 'compress@10': 0.0655, 'time@10': 5.3138}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9261, 'compress@10': 0.0631, 'time@10': 5.2325}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]  {'epoch': 29, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.907, 'ndcg@10': 0.9261, 'compress@10': 0.0631, 'time@10': 5.2325}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9296, 'compress@10': 0.0608, 'time@10': 5.6}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it] {'epoch': 29, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9296, 'compress@10': 0.0608, 'time@10': 5.6}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9342, 'compress@10': 0.0591, 'time@10': 5.6335}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9342, 'compress@10': 0.0591, 'time@10': 5.6335}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9342, 'compress@10': 0.0591, 'time@10': 5.6335}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.012118221205322811
Avg hit ratio: 0.8947477809871698
Avg ndcg: 0.9342073607145421
Avg compression ratio: 0.05907027435619842
Avg train time: 5.633496952056885
Std train time: 1.763440595168333
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9152, 'compress@10': 0.0705, 'time@10': 4.2943}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9152, 'compress@10': 0.0705, 'time@10': 4.2943}:  10%|█         | 1/10 [00:02<00:19,  2.19s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9398, 'compress@10': 0.0597, 'time@10': 4.0676}:  10%|█         | 1/10 [00:06<00:19,  2.19s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9398, 'compress@10': 0.0597, 'time@10': 4.0676}:  20%|██        | 2/10 [00:06<00:25,  3.18s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9123, 'compress@10': 0.0926, 'time@10': 3.9129}:  20%|██        | 2/10 [00:07<00:25,  3.18s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9123, 'compress@10': 0.0926, 'time@10': 3.9129}:  30%|███       | 3/10 [00:07<00:18,  2.58s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9226, 'compress@10': 0.0819, 'time@10': 3.8411}:  30%|███       | 3/10 [00:11<00:18,  2.58s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9226, 'compress@10': 0.0819, 'time@10': 3.8411}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9186, 'compress@10': 0.0726, 'time@10': 4.7356}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9186, 'compress@10': 0.0726, 'time@10': 4.7356}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9273, 'compress@10': 0.0658, 'time@10': 4.9665}:  50%|█████     | 5/10 [00:21<00:17,  3.44s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9273, 'compress@10': 0.0658, 'time@10': 4.9665}:  60%|██████    | 6/10 [00:21<00:17,  4.36s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9284, 'compress@10': 0.0648, 'time@10': 5.2198}:  60%|██████    | 6/10 [00:25<00:17,  4.36s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9284, 'compress@10': 0.0648, 'time@10': 5.2198}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9321, 'compress@10': 0.062, 'time@10': 5.1395}:  70%|███████   | 7/10 [00:29<00:12,  4.05s/it]  {'epoch': 30, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9321, 'compress@10': 0.062, 'time@10': 5.1395}:  80%|████████  | 8/10 [00:29<00:08,  4.23s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9356, 'compress@10': 0.06, 'time@10': 5.5268}:  80%|████████  | 8/10 [00:34<00:08,  4.23s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9356, 'compress@10': 0.06, 'time@10': 5.5268}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9367, 'compress@10': 0.0583, 'time@10': 5.5751}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it] {'epoch': 30, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9367, 'compress@10': 0.0583, 'time@10': 5.5751}: 100%|██████████| 10/10 [00:40<00:00,  4.83s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9367, 'compress@10': 0.0583, 'time@10': 5.5751}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.015188950741984678
Avg hit ratio: 0.9028307302959255
Avg ndcg: 0.9366661531401037
Avg compression ratio: 0.058251958065855244
Avg train time: 5.575079441070557
Std train time: 1.7880386572178117
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9152, 'compress@10': 0.0706, 'time@10': 4.4686}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9152, 'compress@10': 0.0706, 'time@10': 4.4686}:  10%|█         | 1/10 [00:02<00:20,  2.27s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9394, 'compress@10': 0.0591, 'time@10': 4.1222}:  10%|█         | 1/10 [00:06<00:20,  2.27s/it] {'epoch': 31, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9394, 'compress@10': 0.0591, 'time@10': 4.1222}:  20%|██        | 2/10 [00:06<00:25,  3.18s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.912, 'compress@10': 0.0922, 'time@10': 4.0067}:  20%|██        | 2/10 [00:08<00:25,  3.18s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.912, 'compress@10': 0.0922, 'time@10': 4.0067}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9224, 'compress@10': 0.0817, 'time@10': 3.913}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9224, 'compress@10': 0.0817, 'time@10': 3.913}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9208, 'compress@10': 0.0724, 'time@10': 4.7858}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9208, 'compress@10': 0.0724, 'time@10': 4.7858}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0164, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9345, 'compress@10': 0.0656, 'time@10': 5.0084}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0164, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9345, 'compress@10': 0.0656, 'time@10': 5.0084}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9338, 'compress@10': 0.0647, 'time@10': 5.2509}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9338, 'compress@10': 0.0647, 'time@10': 5.2509}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9372, 'compress@10': 0.0617, 'time@10': 5.1774}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]  {'epoch': 31, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9372, 'compress@10': 0.0617, 'time@10': 5.1774}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.942, 'compress@10': 0.0598, 'time@10': 5.554}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.942, 'compress@10': 0.0598, 'time@10': 5.554}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9454, 'compress@10': 0.0581, 'time@10': 5.5876}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it] {'epoch': 31, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9454, 'compress@10': 0.0581, 'time@10': 5.5876}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9454, 'compress@10': 0.0581, 'time@10': 5.5876}: 100%|██████████| 10/10 [00:40<00:00,  4.04s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.015843921670009628
Avg hit ratio: 0.9046842889236777
Avg ndcg: 0.9454133819204357
Avg compression ratio: 0.05813886938325857
Avg train time: 5.5875856399536135
Std train time: 1.7388000993860804
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9136, 'compress@10': 0.071, 'time@10': 4.6801}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9136, 'compress@10': 0.071, 'time@10': 4.6801}:  10%|█         | 1/10 [00:02<00:21,  2.38s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9395, 'compress@10': 0.0604, 'time@10': 4.21}:  10%|█         | 1/10 [00:06<00:21,  2.38s/it] {'epoch': 32, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9395, 'compress@10': 0.0604, 'time@10': 4.21}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.912, 'compress@10': 0.0932, 'time@10': 4.0831}:  20%|██        | 2/10 [00:08<00:25,  3.20s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.912, 'compress@10': 0.0932, 'time@10': 4.0831}:  30%|███       | 3/10 [00:08<00:18,  2.63s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9236, 'compress@10': 0.0825, 'time@10': 3.9405}:  30%|███       | 3/10 [00:11<00:18,  2.63s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9236, 'compress@10': 0.0825, 'time@10': 3.9405}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9215, 'compress@10': 0.0732, 'time@10': 4.8245}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9215, 'compress@10': 0.0732, 'time@10': 4.8245}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9292, 'compress@10': 0.0664, 'time@10': 5.0677}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9292, 'compress@10': 0.0664, 'time@10': 5.0677}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9321, 'compress@10': 0.0654, 'time@10': 5.3017}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9321, 'compress@10': 0.0654, 'time@10': 5.3017}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9344, 'compress@10': 0.0622, 'time@10': 5.2148}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9344, 'compress@10': 0.0622, 'time@10': 5.2148}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.956, 'compress@10': 0.0601, 'time@10': 5.5851}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.956, 'compress@10': 0.0601, 'time@10': 5.5851}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.9105, 'ndcg@10': 0.9543, 'compress@10': 0.0585, 'time@10': 5.6247}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.9105, 'ndcg@10': 0.9543, 'compress@10': 0.0585, 'time@10': 5.6247}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0175, 'hit_ratio@10': 0.9105, 'ndcg@10': 0.9543, 'compress@10': 0.0585, 'time@10': 5.6247}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.017463742547687084
Avg hit ratio: 0.9105450160102112
Avg ndcg: 0.9542974045582406
Avg compression ratio: 0.05852950959412452
Avg train time: 5.624724984169006
Std train time: 1.758653154047506
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9136, 'compress@10': 0.0705, 'time@10': 4.8866}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9136, 'compress@10': 0.0705, 'time@10': 4.8866}:  10%|█         | 1/10 [00:02<00:22,  2.48s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9389, 'compress@10': 0.0597, 'time@10': 4.3154}:  10%|█         | 1/10 [00:06<00:22,  2.48s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9389, 'compress@10': 0.0597, 'time@10': 4.3154}:  20%|██        | 2/10 [00:06<00:25,  3.25s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9117, 'compress@10': 0.0931, 'time@10': 4.1897}:  20%|██        | 2/10 [00:08<00:25,  3.25s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9117, 'compress@10': 0.0931, 'time@10': 4.1897}:  30%|███       | 3/10 [00:08<00:18,  2.68s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.923, 'compress@10': 0.0826, 'time@10': 4.0272}:  30%|███       | 3/10 [00:11<00:18,  2.68s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.923, 'compress@10': 0.0826, 'time@10': 4.0272}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9215, 'compress@10': 0.0733, 'time@10': 4.8844}:  40%|████      | 4/10 [00:16<00:18,  3.04s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9215, 'compress@10': 0.0733, 'time@10': 4.8844}:  50%|█████     | 5/10 [00:16<00:17,  3.45s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9302, 'compress@10': 0.0665, 'time@10': 5.0923}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9302, 'compress@10': 0.0665, 'time@10': 5.0923}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.931, 'compress@10': 0.0656, 'time@10': 5.3229}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.931, 'compress@10': 0.0656, 'time@10': 5.3229}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9348, 'compress@10': 0.0622, 'time@10': 5.2278}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9348, 'compress@10': 0.0622, 'time@10': 5.2278}:  80%|████████  | 8/10 [00:30<00:08,  4.23s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9413, 'compress@10': 0.06, 'time@10': 5.6093}:  80%|████████  | 8/10 [00:34<00:08,  4.23s/it] {'epoch': 33, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9413, 'compress@10': 0.06, 'time@10': 5.6093}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9448, 'compress@10': 0.0581, 'time@10': 5.6432}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it] {'epoch': 33, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9448, 'compress@10': 0.0581, 'time@10': 5.6432}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9448, 'compress@10': 0.0581, 'time@10': 5.6432}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.015307187238399083
Avg hit ratio: 0.898112860352249
Avg ndcg: 0.9447595744846524
Avg compression ratio: 0.058108579901819515
Avg train time: 5.64321448802948
Std train time: 1.7430261847118205
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.0687, 'time@10': 4.7125}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.0687, 'time@10': 4.7125}:  10%|█         | 1/10 [00:02<00:21,  2.40s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9462, 'compress@10': 0.0578, 'time@10': 4.2203}:  10%|█         | 1/10 [00:06<00:21,  2.40s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9462, 'compress@10': 0.0578, 'time@10': 4.2203}:  20%|██        | 2/10 [00:06<00:25,  3.20s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9165, 'compress@10': 0.0909, 'time@10': 4.1067}:  20%|██        | 2/10 [00:08<00:25,  3.20s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9165, 'compress@10': 0.0909, 'time@10': 4.1067}:  30%|███       | 3/10 [00:08<00:18,  2.64s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.927, 'compress@10': 0.081, 'time@10': 3.9579}:  30%|███       | 3/10 [00:11<00:18,  2.64s/it]  {'epoch': 34, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.927, 'compress@10': 0.081, 'time@10': 3.9579}:  40%|████      | 4/10 [00:11<00:18,  3.00s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9257, 'compress@10': 0.0721, 'time@10': 4.8314}:  40%|████      | 4/10 [00:15<00:18,  3.00s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9257, 'compress@10': 0.0721, 'time@10': 4.8314}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0174, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9407, 'compress@10': 0.0654, 'time@10': 5.0508}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0174, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9407, 'compress@10': 0.0654, 'time@10': 5.0508}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0171, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9402, 'compress@10': 0.0648, 'time@10': 5.3037}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0171, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9402, 'compress@10': 0.0648, 'time@10': 5.3037}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9422, 'compress@10': 0.0614, 'time@10': 5.2166}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9422, 'compress@10': 0.0614, 'time@10': 5.2166}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9471, 'compress@10': 0.0592, 'time@10': 5.5929}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9471, 'compress@10': 0.0592, 'time@10': 5.5929}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9469, 'compress@10': 0.0576, 'time@10': 5.6306}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]    {'epoch': 34, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9469, 'compress@10': 0.0576, 'time@10': 5.6306}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9469, 'compress@10': 0.0576, 'time@10': 5.6306}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.01898770061967387
Avg hit ratio: 0.8927672382324335
Avg ndcg: 0.9468754330881015
Avg compression ratio: 0.05760860993326862
Avg train time: 5.630623722076416
Std train time: 1.7598814115305954
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9136, 'compress@10': 0.0655, 'time@10': 4.711}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9136, 'compress@10': 0.0655, 'time@10': 4.711}:  10%|█         | 1/10 [00:02<00:21,  2.40s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9387, 'compress@10': 0.0562, 'time@10': 4.2618}:  10%|█         | 1/10 [00:06<00:21,  2.40s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9387, 'compress@10': 0.0562, 'time@10': 4.2618}:  20%|██        | 2/10 [00:06<00:26,  3.25s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9115, 'compress@10': 0.0893, 'time@10': 4.1366}:  20%|██        | 2/10 [00:08<00:26,  3.25s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9115, 'compress@10': 0.0893, 'time@10': 4.1366}:  30%|███       | 3/10 [00:08<00:18,  2.67s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9233, 'compress@10': 0.0798, 'time@10': 3.9495}:  30%|███       | 3/10 [00:11<00:18,  2.67s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9233, 'compress@10': 0.0798, 'time@10': 3.9495}:  40%|████      | 4/10 [00:11<00:17,  2.97s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9235, 'compress@10': 0.0709, 'time@10': 4.8393}:  40%|████      | 4/10 [00:15<00:17,  2.97s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9235, 'compress@10': 0.0709, 'time@10': 4.8393}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9321, 'compress@10': 0.0646, 'time@10': 5.0886}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9321, 'compress@10': 0.0646, 'time@10': 5.0886}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9349, 'compress@10': 0.0643, 'time@10': 5.328}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it] {'epoch': 35, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9349, 'compress@10': 0.0643, 'time@10': 5.328}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9387, 'compress@10': 0.0609, 'time@10': 5.2382}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.9228, 'ndcg@10': 0.9387, 'compress@10': 0.0609, 'time@10': 5.2382}:  80%|████████  | 8/10 [00:30<00:08,  4.28s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0093, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9407, 'compress@10': 0.0588, 'time@10': 5.6119}:  80%|████████  | 8/10 [00:34<00:08,  4.28s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0093, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9407, 'compress@10': 0.0588, 'time@10': 5.6119}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0085, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9442, 'compress@10': 0.0568, 'time@10': 5.6439}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]  {'epoch': 35, 'num_users': 6.3, 'loss': 0.0085, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9442, 'compress@10': 0.0568, 'time@10': 5.6439}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0085, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9442, 'compress@10': 0.0568, 'time@10': 5.6439}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.008515475622487112
Avg hit ratio: 0.9131359018269036
Avg ndcg: 0.9442295164097976
Avg compression ratio: 0.056827875471642295
Avg train time: 5.643926358222961
Std train time: 1.7783664654568372
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.0647, 'time@10': 5.0229}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.0647, 'time@10': 5.0229}:  10%|█         | 1/10 [00:02<00:22,  2.55s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9433, 'compress@10': 0.0548, 'time@10': 4.3969}:  10%|█         | 1/10 [00:06<00:22,  2.55s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9433, 'compress@10': 0.0548, 'time@10': 4.3969}:  20%|██        | 2/10 [00:06<00:26,  3.29s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9146, 'compress@10': 0.0877, 'time@10': 4.2491}:  20%|██        | 2/10 [00:08<00:26,  3.29s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9146, 'compress@10': 0.0877, 'time@10': 4.2491}:  30%|███       | 3/10 [00:08<00:18,  2.71s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9256, 'compress@10': 0.0787, 'time@10': 4.0577}:  30%|███       | 3/10 [00:11<00:18,  2.71s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9256, 'compress@10': 0.0787, 'time@10': 4.0577}:  40%|████      | 4/10 [00:11<00:18,  3.04s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9258, 'compress@10': 0.0697, 'time@10': 4.8846}:  40%|████      | 4/10 [00:16<00:18,  3.04s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9258, 'compress@10': 0.0697, 'time@10': 4.8846}:  50%|█████     | 5/10 [00:16<00:17,  3.43s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9331, 'compress@10': 0.0635, 'time@10': 5.1014}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9331, 'compress@10': 0.0635, 'time@10': 5.1014}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9344, 'compress@10': 0.0633, 'time@10': 5.3343}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9344, 'compress@10': 0.0633, 'time@10': 5.3343}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9373, 'compress@10': 0.06, 'time@10': 5.2439}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it]   {'epoch': 36, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9373, 'compress@10': 0.06, 'time@10': 5.2439}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9407, 'compress@10': 0.058, 'time@10': 5.6121}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9407, 'compress@10': 0.058, 'time@10': 5.6121}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9412, 'compress@10': 0.056, 'time@10': 5.6467}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9412, 'compress@10': 0.056, 'time@10': 5.6467}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9412, 'compress@10': 0.056, 'time@10': 5.6467}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.014682775862549954
Avg hit ratio: 0.9080565367475384
Avg ndcg: 0.941249159167671
Avg compression ratio: 0.05598628652532288
Avg train time: 5.646680068969727
Std train time: 1.7042630782855996
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9158, 'compress@10': 0.0628, 'time@10': 4.8481}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9158, 'compress@10': 0.0628, 'time@10': 4.8481}:  10%|█         | 1/10 [00:02<00:22,  2.46s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9448, 'compress@10': 0.053, 'time@10': 4.2974}:  10%|█         | 1/10 [00:06<00:22,  2.46s/it]  {'epoch': 37, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9448, 'compress@10': 0.053, 'time@10': 4.2974}:  20%|██        | 2/10 [00:06<00:25,  3.25s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9156, 'compress@10': 0.0863, 'time@10': 4.1209}:  20%|██        | 2/10 [00:08<00:25,  3.25s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9156, 'compress@10': 0.0863, 'time@10': 4.1209}:  30%|███       | 3/10 [00:08<00:18,  2.64s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9252, 'compress@10': 0.078, 'time@10': 3.9999}:  30%|███       | 3/10 [00:11<00:18,  2.64s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9252, 'compress@10': 0.078, 'time@10': 3.9999}:  40%|████      | 4/10 [00:11<00:18,  3.05s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9256, 'compress@10': 0.0688, 'time@10': 4.8672}:  40%|████      | 4/10 [00:16<00:18,  3.05s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9256, 'compress@10': 0.0688, 'time@10': 4.8672}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9338, 'compress@10': 0.0629, 'time@10': 5.0919}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9338, 'compress@10': 0.0629, 'time@10': 5.0919}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.935, 'compress@10': 0.0625, 'time@10': 5.3298}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it] {'epoch': 37, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.935, 'compress@10': 0.0625, 'time@10': 5.3298}:  70%|███████   | 7/10 [00:25<00:12,  4.10s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9348, 'compress@10': 0.0593, 'time@10': 5.2391}:  70%|███████   | 7/10 [00:30<00:12,  4.10s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9348, 'compress@10': 0.0593, 'time@10': 5.2391}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9373, 'compress@10': 0.0572, 'time@10': 5.6158}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9373, 'compress@10': 0.0572, 'time@10': 5.6158}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9413, 'compress@10': 0.0547, 'time@10': 5.6449}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9413, 'compress@10': 0.0547, 'time@10': 5.6449}: 100%|██████████| 10/10 [00:40<00:00,  4.81s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9413, 'compress@10': 0.0547, 'time@10': 5.6449}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.012132761451438817
Avg hit ratio: 0.9070529525181478
Avg ndcg: 0.9412803384649967
Avg compression ratio: 0.05472973824362147
Avg train time: 5.644878888130188
Std train time: 1.7510318577671193
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9277, 'compress@10': 0.0627, 'time@10': 4.6402}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9277, 'compress@10': 0.0627, 'time@10': 4.6402}:  10%|█         | 1/10 [00:02<00:21,  2.37s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9702, 'compress@10': 0.0538, 'time@10': 4.1682}:  10%|█         | 1/10 [00:06<00:21,  2.37s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9702, 'compress@10': 0.0538, 'time@10': 4.1682}:  20%|██        | 2/10 [00:06<00:25,  3.17s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9325, 'compress@10': 0.0863, 'time@10': 4.0214}:  20%|██        | 2/10 [00:08<00:25,  3.17s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9325, 'compress@10': 0.0863, 'time@10': 4.0214}:  30%|███       | 3/10 [00:08<00:18,  2.59s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9401, 'compress@10': 0.0777, 'time@10': 3.9134}:  30%|███       | 3/10 [00:11<00:18,  2.59s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9401, 'compress@10': 0.0777, 'time@10': 3.9134}:  40%|████      | 4/10 [00:11<00:18,  3.01s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9377, 'compress@10': 0.0684, 'time@10': 4.7776}:  40%|████      | 4/10 [00:15<00:18,  3.01s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9377, 'compress@10': 0.0684, 'time@10': 4.7776}:  50%|█████     | 5/10 [00:15<00:17,  3.43s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0158, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9463, 'compress@10': 0.0625, 'time@10': 5.0117}:  50%|█████     | 5/10 [00:22<00:17,  3.43s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0158, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9463, 'compress@10': 0.0625, 'time@10': 5.0117}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9471, 'compress@10': 0.062, 'time@10': 5.259}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]  {'epoch': 38, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9471, 'compress@10': 0.062, 'time@10': 5.259}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9497, 'compress@10': 0.0588, 'time@10': 5.1842}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9497, 'compress@10': 0.0588, 'time@10': 5.1842}:  80%|████████  | 8/10 [00:30<00:08,  4.26s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9657, 'compress@10': 0.0567, 'time@10': 5.5796}:  80%|████████  | 8/10 [00:34<00:08,  4.26s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9657, 'compress@10': 0.0567, 'time@10': 5.5796}:  90%|█████████ | 9/10 [00:34<00:04,  4.31s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9646, 'compress@10': 0.0543, 'time@10': 5.6268}:  90%|█████████ | 9/10 [00:40<00:04,  4.31s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9646, 'compress@10': 0.0543, 'time@10': 5.6268}: 100%|██████████| 10/10 [00:40<00:00,  4.86s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9646, 'compress@10': 0.0543, 'time@10': 5.6268}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.016697818610737613
Avg hit ratio: 0.9041958096610048
Avg ndcg: 0.9645532681799937
Avg compression ratio: 0.054305589315576705
Avg train time: 5.626832985877991
Std train time: 1.7788315288618188
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9205, 'compress@10': 0.0619, 'time@10': 4.6756}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9205, 'compress@10': 0.0619, 'time@10': 4.6756}:  10%|█         | 1/10 [00:02<00:21,  2.38s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9412, 'compress@10': 0.0517, 'time@10': 4.2124}:  10%|█         | 1/10 [00:06<00:21,  2.38s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9412, 'compress@10': 0.0517, 'time@10': 4.2124}:  20%|██        | 2/10 [00:06<00:25,  3.21s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9132, 'compress@10': 0.0847, 'time@10': 4.0321}:  20%|██        | 2/10 [00:08<00:25,  3.21s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9132, 'compress@10': 0.0847, 'time@10': 4.0321}:  30%|███       | 3/10 [00:08<00:18,  2.60s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9254, 'compress@10': 0.0766, 'time@10': 3.9073}:  30%|███       | 3/10 [00:11<00:18,  2.60s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9254, 'compress@10': 0.0766, 'time@10': 3.9073}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9261, 'compress@10': 0.0674, 'time@10': 4.8062}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9261, 'compress@10': 0.0674, 'time@10': 4.8062}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9341, 'compress@10': 0.0619, 'time@10': 5.029}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9341, 'compress@10': 0.0619, 'time@10': 5.029}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9352, 'compress@10': 0.0614, 'time@10': 5.2731}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9352, 'compress@10': 0.0614, 'time@10': 5.2731}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9325, 'compress@10': 0.0583, 'time@10': 5.1982}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9325, 'compress@10': 0.0583, 'time@10': 5.1982}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9392, 'compress@10': 0.0561, 'time@10': 5.5829}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9392, 'compress@10': 0.0561, 'time@10': 5.5829}:  90%|█████████ | 9/10 [00:34<00:04,  4.30s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.943, 'compress@10': 0.0536, 'time@10': 5.6271}:  90%|█████████ | 9/10 [00:40<00:04,  4.30s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.943, 'compress@10': 0.0536, 'time@10': 5.6271}: 100%|██████████| 10/10 [00:40<00:00,  4.84s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.943, 'compress@10': 0.0536, 'time@10': 5.6271}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.013664102914267295
Avg hit ratio: 0.9109136796046814
Avg ndcg: 0.942989903814761
Avg compression ratio: 0.053645787293185386
Avg train time: 5.627068066596985
Std train time: 1.7918355700907593
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9031, 'compress@10': 0.0611, 'time@10': 4.6319}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9031, 'compress@10': 0.0611, 'time@10': 4.6319}:  10%|█         | 1/10 [00:02<00:21,  2.36s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9872, 'compress@10': 0.0519, 'time@10': 4.1741}:  10%|█         | 1/10 [00:06<00:21,  2.36s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9872, 'compress@10': 0.0519, 'time@10': 4.1741}:  20%|██        | 2/10 [00:06<00:25,  3.18s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9439, 'compress@10': 0.0846, 'time@10': 3.9956}:  20%|██        | 2/10 [00:07<00:25,  3.18s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9439, 'compress@10': 0.0846, 'time@10': 3.9956}:  30%|███       | 3/10 [00:07<00:18,  2.58s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9475, 'compress@10': 0.0765, 'time@10': 3.8754}:  30%|███       | 3/10 [00:11<00:18,  2.58s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9475, 'compress@10': 0.0765, 'time@10': 3.8754}:  40%|████      | 4/10 [00:11<00:17,  2.96s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9449, 'compress@10': 0.0674, 'time@10': 4.8051}:  40%|████      | 4/10 [00:15<00:17,  2.96s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9449, 'compress@10': 0.0674, 'time@10': 4.8051}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9499, 'compress@10': 0.0619, 'time@10': 5.0631}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9499, 'compress@10': 0.0619, 'time@10': 5.0631}:  60%|██████    | 6/10 [00:22<00:17,  4.45s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9501, 'compress@10': 0.0613, 'time@10': 5.3265}:  60%|██████    | 6/10 [00:25<00:17,  4.45s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9501, 'compress@10': 0.0613, 'time@10': 5.3265}:  70%|███████   | 7/10 [00:25<00:12,  4.14s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9523, 'compress@10': 0.0582, 'time@10': 5.2375}:  70%|███████   | 7/10 [00:30<00:12,  4.14s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9523, 'compress@10': 0.0582, 'time@10': 5.2375}:  80%|████████  | 8/10 [00:30<00:08,  4.30s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9613, 'compress@10': 0.0559, 'time@10': 5.6195}:  80%|████████  | 8/10 [00:34<00:08,  4.30s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9613, 'compress@10': 0.0559, 'time@10': 5.6195}:  90%|█████████ | 9/10 [00:34<00:04,  4.33s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9586, 'compress@10': 0.0534, 'time@10': 5.651}:  90%|█████████ | 9/10 [00:40<00:04,  4.33s/it]     {'epoch': 40, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9586, 'compress@10': 0.0534, 'time@10': 5.651}: 100%|██████████| 10/10 [00:40<00:00,  4.84s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9586, 'compress@10': 0.0534, 'time@10': 5.651}: 100%|██████████| 10/10 [00:40<00:00,  4.07s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.01604553787377038
Avg hit ratio: 0.9066842889236778
Avg ndcg: 0.9585889714854687
Avg compression ratio: 0.053438214025612274
Avg train time: 5.651049375534058
Std train time: 1.844503897865343
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9135, 'compress@10': 0.0609, 'time@10': 4.8121}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9135, 'compress@10': 0.0609, 'time@10': 4.8121}:  10%|█         | 1/10 [00:02<00:22,  2.45s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9412, 'compress@10': 0.0513, 'time@10': 4.2733}:  10%|█         | 1/10 [00:06<00:22,  2.45s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9412, 'compress@10': 0.0513, 'time@10': 4.2733}:  20%|██        | 2/10 [00:06<00:25,  3.23s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9132, 'compress@10': 0.084, 'time@10': 4.0178}:  20%|██        | 2/10 [00:08<00:25,  3.23s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9132, 'compress@10': 0.084, 'time@10': 4.0178}:  30%|███       | 3/10 [00:08<00:18,  2.57s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9236, 'compress@10': 0.0758, 'time@10': 3.9012}:  30%|███       | 3/10 [00:11<00:18,  2.57s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9236, 'compress@10': 0.0758, 'time@10': 3.9012}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9261, 'compress@10': 0.0668, 'time@10': 4.7786}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9261, 'compress@10': 0.0668, 'time@10': 4.7786}:  50%|█████     | 5/10 [00:15<00:17,  3.41s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9463, 'compress@10': 0.061, 'time@10': 5.0122}:  50%|█████     | 5/10 [00:22<00:17,  3.41s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9463, 'compress@10': 0.061, 'time@10': 5.0122}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9474, 'compress@10': 0.0604, 'time@10': 5.259}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9474, 'compress@10': 0.0604, 'time@10': 5.259}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9553, 'compress@10': 0.0574, 'time@10': 5.1802}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9553, 'compress@10': 0.0574, 'time@10': 5.1802}:  80%|████████  | 8/10 [00:30<00:08,  4.25s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9554, 'compress@10': 0.0551, 'time@10': 5.5571}:  80%|████████  | 8/10 [00:34<00:08,  4.25s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9554, 'compress@10': 0.0551, 'time@10': 5.5571}:  90%|█████████ | 9/10 [00:34<00:04,  4.28s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9576, 'compress@10': 0.0527, 'time@10': 5.5895}:  90%|█████████ | 9/10 [00:40<00:04,  4.28s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9576, 'compress@10': 0.0527, 'time@10': 5.5895}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9576, 'compress@10': 0.0527, 'time@10': 5.5895}: 100%|██████████| 10/10 [00:40<00:00,  4.03s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.014899434090439725
Avg hit ratio: 0.8984815239467192
Avg ndcg: 0.9575955104327688
Avg compression ratio: 0.05268732104563597
Avg train time: 5.589527440071106
Std train time: 1.77178587020051
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9135, 'compress@10': 0.0609, 'time@10': 4.6252}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9135, 'compress@10': 0.0609, 'time@10': 4.6252}:  10%|█         | 1/10 [00:02<00:21,  2.35s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0071, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.94, 'compress@10': 0.0511, 'time@10': 4.3633}:  10%|█         | 1/10 [00:06<00:21,  2.35s/it]  {'epoch': 42, 'num_users': 7.0, 'loss': 0.0071, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.94, 'compress@10': 0.0511, 'time@10': 4.3633}:  20%|██        | 2/10 [00:06<00:27,  3.41s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9124, 'compress@10': 0.0838, 'time@10': 4.1202}:  20%|██        | 2/10 [00:08<00:27,  3.41s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9124, 'compress@10': 0.0838, 'time@10': 4.1202}:  30%|███       | 3/10 [00:08<00:18,  2.70s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9254, 'compress@10': 0.0749, 'time@10': 4.0193}:  30%|███       | 3/10 [00:12<00:18,  2.70s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9254, 'compress@10': 0.0749, 'time@10': 4.0193}:  40%|████      | 4/10 [00:12<00:18,  3.12s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0071, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9298, 'compress@10': 0.0661, 'time@10': 4.8686}:  40%|████      | 4/10 [00:16<00:18,  3.12s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0071, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9298, 'compress@10': 0.0661, 'time@10': 4.8686}:  50%|█████     | 5/10 [00:16<00:17,  3.50s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9375, 'compress@10': 0.0608, 'time@10': 5.089}:  50%|█████     | 5/10 [00:22<00:17,  3.50s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9375, 'compress@10': 0.0608, 'time@10': 5.089}:  60%|██████    | 6/10 [00:22<00:17,  4.43s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9408, 'compress@10': 0.0596, 'time@10': 5.3257}:  60%|██████    | 6/10 [00:25<00:17,  4.43s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9408, 'compress@10': 0.0596, 'time@10': 5.3257}:  70%|███████   | 7/10 [00:25<00:12,  4.09s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9395, 'compress@10': 0.0567, 'time@10': 5.2426}:  70%|███████   | 7/10 [00:30<00:12,  4.09s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9395, 'compress@10': 0.0567, 'time@10': 5.2426}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0107, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9436, 'compress@10': 0.0545, 'time@10': 5.6081}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0107, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9436, 'compress@10': 0.0545, 'time@10': 5.6081}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.896, 'ndcg@10': 0.946, 'compress@10': 0.0521, 'time@10': 5.6318}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]     {'epoch': 42, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.896, 'ndcg@10': 0.946, 'compress@10': 0.0521, 'time@10': 5.6318}: 100%|██████████| 10/10 [00:40<00:00,  4.78s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.896, 'ndcg@10': 0.946, 'compress@10': 0.0521, 'time@10': 5.6318}: 100%|██████████| 10/10 [00:40<00:00,  4.08s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.011003215802845329
Avg hit ratio: 0.8959930446840463
Avg ndcg: 0.94595144421798
Avg compression ratio: 0.05211064910922664
Avg train time: 5.631804490089417
Std train time: 1.7003371778642926
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9135, 'compress@10': 0.0606, 'time@10': 4.9987}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9135, 'compress@10': 0.0606, 'time@10': 4.9987}:  10%|█         | 1/10 [00:02<00:22,  2.54s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9484, 'compress@10': 0.0508, 'time@10': 4.4117}:  10%|█         | 1/10 [00:06<00:22,  2.54s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9484, 'compress@10': 0.0508, 'time@10': 4.4117}:  20%|██        | 2/10 [00:06<00:26,  3.32s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.749, 'ndcg@10': 0.918, 'compress@10': 0.0834, 'time@10': 4.1439}:  20%|██        | 2/10 [00:08<00:26,  3.32s/it]  {'epoch': 43, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.749, 'ndcg@10': 0.918, 'compress@10': 0.0834, 'time@10': 4.1439}:  30%|███       | 3/10 [00:08<00:18,  2.65s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9281, 'compress@10': 0.0749, 'time@10': 4.0042}:  30%|███       | 3/10 [00:11<00:18,  2.65s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.7939, 'ndcg@10': 0.9281, 'compress@10': 0.0749, 'time@10': 4.0042}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.9321, 'compress@10': 0.066, 'time@10': 4.887}:  40%|████      | 4/10 [00:16<00:18,  3.03s/it]    {'epoch': 43, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.9321, 'compress@10': 0.066, 'time@10': 4.887}:  50%|█████     | 5/10 [00:16<00:17,  3.47s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9394, 'compress@10': 0.0605, 'time@10': 5.1086}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9394, 'compress@10': 0.0605, 'time@10': 5.1086}:  60%|██████    | 6/10 [00:22<00:17,  4.42s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9413, 'compress@10': 0.0597, 'time@10': 5.3632}:  60%|██████    | 6/10 [00:25<00:17,  4.42s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9413, 'compress@10': 0.0597, 'time@10': 5.3632}:  70%|███████   | 7/10 [00:25<00:12,  4.12s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9449, 'compress@10': 0.0568, 'time@10': 5.2776}:  70%|███████   | 7/10 [00:30<00:12,  4.12s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9449, 'compress@10': 0.0568, 'time@10': 5.2776}:  80%|████████  | 8/10 [00:30<00:08,  4.31s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9463, 'compress@10': 0.0545, 'time@10': 5.662}:  80%|████████  | 8/10 [00:35<00:08,  4.31s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9463, 'compress@10': 0.0545, 'time@10': 5.662}:  90%|█████████ | 9/10 [00:35<00:04,  4.34s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9494, 'compress@10': 0.0521, 'time@10': 5.6902}:  90%|█████████ | 9/10 [00:40<00:04,  4.34s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9494, 'compress@10': 0.0521, 'time@10': 5.6902}: 100%|██████████| 10/10 [00:40<00:00,  4.85s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9494, 'compress@10': 0.0521, 'time@10': 5.6902}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.01029492367561623
Avg hit ratio: 0.87911644458164
Avg ndcg: 0.9494416901505665
Avg compression ratio: 0.052051425508995997
Avg train time: 5.690213227272034
Std train time: 1.7960810050686251
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9135, 'compress@10': 0.06, 'time@10': 4.4682}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9135, 'compress@10': 0.06, 'time@10': 4.4682}:  10%|█         | 1/10 [00:02<00:20,  2.28s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.94, 'compress@10': 0.0502, 'time@10': 4.2336}:  10%|█         | 1/10 [00:06<00:20,  2.28s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.94, 'compress@10': 0.0502, 'time@10': 4.2336}:  20%|██        | 2/10 [00:06<00:26,  3.31s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9124, 'compress@10': 0.0829, 'time@10': 4.0096}:  20%|██        | 2/10 [00:08<00:26,  3.31s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9124, 'compress@10': 0.0829, 'time@10': 4.0096}:  30%|███       | 3/10 [00:08<00:18,  2.63s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9239, 'compress@10': 0.0744, 'time@10': 3.9074}:  30%|███       | 3/10 [00:11<00:18,  2.63s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9239, 'compress@10': 0.0744, 'time@10': 3.9074}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.929, 'compress@10': 0.0655, 'time@10': 4.7969}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.929, 'compress@10': 0.0655, 'time@10': 4.7969}:  50%|█████     | 5/10 [00:15<00:17,  3.46s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.937, 'compress@10': 0.0601, 'time@10': 5.0159}:  50%|█████     | 5/10 [00:22<00:17,  3.46s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.937, 'compress@10': 0.0601, 'time@10': 5.0159}:  60%|██████    | 6/10 [00:22<00:17,  4.37s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9401, 'compress@10': 0.059, 'time@10': 5.2567}:  60%|██████    | 6/10 [00:25<00:17,  4.37s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9401, 'compress@10': 0.059, 'time@10': 5.2567}:  70%|███████   | 7/10 [00:25<00:12,  4.05s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9469, 'compress@10': 0.0561, 'time@10': 5.1753}:  70%|███████   | 7/10 [00:30<00:12,  4.05s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9469, 'compress@10': 0.0561, 'time@10': 5.1753}:  80%|████████  | 8/10 [00:30<00:08,  4.24s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0103, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9612, 'compress@10': 0.0538, 'time@10': 5.5519}:  80%|████████  | 8/10 [00:34<00:08,  4.24s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0103, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9612, 'compress@10': 0.0538, 'time@10': 5.5519}:  90%|█████████ | 9/10 [00:34<00:04,  4.27s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.961, 'compress@10': 0.0514, 'time@10': 5.5894}:  90%|█████████ | 9/10 [00:40<00:04,  4.27s/it]    {'epoch': 44, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.961, 'compress@10': 0.0514, 'time@10': 5.5894}: 100%|██████████| 10/10 [00:40<00:00,  4.79s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.961, 'compress@10': 0.0514, 'time@10': 5.5894}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.011513546140479534
Avg hit ratio: 0.8899100953752906
Avg ndcg: 0.9609574883508472
Avg compression ratio: 0.051436569265454646
Avg train time: 5.5893858671188354
Std train time: 1.7591249140830878
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9194, 'compress@10': 0.0598, 'time@10': 4.6232}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9194, 'compress@10': 0.0598, 'time@10': 4.6232}:  10%|█         | 1/10 [00:02<00:21,  2.35s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9436, 'compress@10': 0.0499, 'time@10': 4.2503}:  10%|█         | 1/10 [00:06<00:21,  2.35s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9436, 'compress@10': 0.0499, 'time@10': 4.2503}:  20%|██        | 2/10 [00:06<00:26,  3.27s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.9148, 'compress@10': 0.0826, 'time@10': 4.0105}:  20%|██        | 2/10 [00:08<00:26,  3.27s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.9148, 'compress@10': 0.0826, 'time@10': 4.0105}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9279, 'compress@10': 0.0734, 'time@10': 3.906}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9279, 'compress@10': 0.0734, 'time@10': 3.906}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9329, 'compress@10': 0.0646, 'time@10': 4.8115}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9329, 'compress@10': 0.0646, 'time@10': 4.8115}:  50%|█████     | 5/10 [00:15<00:17,  3.47s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9493, 'compress@10': 0.0591, 'time@10': 5.071}:  50%|█████     | 5/10 [00:22<00:17,  3.47s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9493, 'compress@10': 0.0591, 'time@10': 5.071}:  60%|██████    | 6/10 [00:22<00:17,  4.47s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9527, 'compress@10': 0.0577, 'time@10': 5.3001}:  60%|██████    | 6/10 [00:25<00:17,  4.47s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9527, 'compress@10': 0.0577, 'time@10': 5.3001}:  70%|███████   | 7/10 [00:25<00:12,  4.11s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9573, 'compress@10': 0.055, 'time@10': 5.2166}:  70%|███████   | 7/10 [00:30<00:12,  4.11s/it]  {'epoch': 45, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9573, 'compress@10': 0.055, 'time@10': 5.2166}:  80%|████████  | 8/10 [00:30<00:08,  4.29s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9568, 'compress@10': 0.0529, 'time@10': 5.5997}:  80%|████████  | 8/10 [00:34<00:08,  4.29s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9568, 'compress@10': 0.0529, 'time@10': 5.5997}:  90%|█████████ | 9/10 [00:34<00:04,  4.32s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9588, 'compress@10': 0.0505, 'time@10': 5.6515}:  90%|█████████ | 9/10 [00:41<00:04,  4.32s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9588, 'compress@10': 0.0505, 'time@10': 5.6515}: 100%|██████████| 10/10 [00:41<00:00,  4.89s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9588, 'compress@10': 0.0505, 'time@10': 5.6515}: 100%|██████████| 10/10 [00:41<00:00,  4.10s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.014318863052602984
Avg hit ratio: 0.8945081496507642
Avg ndcg: 0.958811914696043
Avg compression ratio: 0.050547668955653394
Avg train time: 5.651536083221435
Std train time: 1.805020479432626
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9194, 'compress@10': 0.0597, 'time@10': 4.7656}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9194, 'compress@10': 0.0597, 'time@10': 4.7656}:  10%|█         | 1/10 [00:02<00:21,  2.43s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9436, 'compress@10': 0.0496, 'time@10': 4.2209}:  10%|█         | 1/10 [00:06<00:21,  2.43s/it] {'epoch': 46, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9436, 'compress@10': 0.0496, 'time@10': 4.2209}:  20%|██        | 2/10 [00:06<00:25,  3.19s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9148, 'compress@10': 0.0823, 'time@10': 4.015}:  20%|██        | 2/10 [00:07<00:25,  3.19s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0043, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9148, 'compress@10': 0.0823, 'time@10': 4.015}:  30%|███       | 3/10 [00:07<00:17,  2.57s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9272, 'compress@10': 0.073, 'time@10': 3.9012}:  30%|███       | 3/10 [00:11<00:17,  2.57s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9272, 'compress@10': 0.073, 'time@10': 3.9012}:  40%|████      | 4/10 [00:11<00:17,  2.98s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0066, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9318, 'compress@10': 0.0641, 'time@10': 4.7719}:  40%|████      | 4/10 [00:15<00:17,  2.98s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0066, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9318, 'compress@10': 0.0641, 'time@10': 4.7719}:  50%|█████     | 5/10 [00:15<00:17,  3.41s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0058, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9393, 'compress@10': 0.0587, 'time@10': 5.0178}:  50%|█████     | 5/10 [00:22<00:17,  3.41s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0058, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9393, 'compress@10': 0.0587, 'time@10': 5.0178}:  60%|██████    | 6/10 [00:22<00:17,  4.39s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0067, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9412, 'compress@10': 0.0576, 'time@10': 5.2624}:  60%|██████    | 6/10 [00:25<00:17,  4.39s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0067, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9412, 'compress@10': 0.0576, 'time@10': 5.2624}:  70%|███████   | 7/10 [00:25<00:12,  4.07s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0077, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9432, 'compress@10': 0.0549, 'time@10': 5.1871}:  70%|███████   | 7/10 [00:30<00:12,  4.07s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0077, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9432, 'compress@10': 0.0549, 'time@10': 5.1871}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9503, 'compress@10': 0.0527, 'time@10': 5.5835}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9503, 'compress@10': 0.0527, 'time@10': 5.5835}:  90%|█████████ | 9/10 [00:34<00:04,  4.32s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9519, 'compress@10': 0.0503, 'time@10': 5.6235}:  90%|█████████ | 9/10 [00:40<00:04,  4.32s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9519, 'compress@10': 0.0503, 'time@10': 5.6235}: 100%|██████████| 10/10 [00:40<00:00,  4.84s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9519, 'compress@10': 0.0503, 'time@10': 5.6235}: 100%|██████████| 10/10 [00:40<00:00,  4.06s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.011625854766650397
Avg hit ratio: 0.8866842889236777
Avg ndcg: 0.9519459736093182
Avg compression ratio: 0.05034341305589547
Avg train time: 5.623532485961914
Std train time: 1.7964060615250794
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.0595, 'time@10': 5.2009}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.0595, 'time@10': 5.2009}:  10%|█         | 1/10 [00:02<00:23,  2.67s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9482, 'compress@10': 0.0491, 'time@10': 4.5476}:  10%|█         | 1/10 [00:06<00:23,  2.67s/it]  {'epoch': 47, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9482, 'compress@10': 0.0491, 'time@10': 4.5476}:  20%|██        | 2/10 [00:06<00:27,  3.41s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9178, 'compress@10': 0.0819, 'time@10': 4.2895}:  20%|██        | 2/10 [00:08<00:27,  3.41s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9178, 'compress@10': 0.0819, 'time@10': 4.2895}:  30%|███       | 3/10 [00:08<00:19,  2.74s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9279, 'compress@10': 0.0725, 'time@10': 4.1244}:  30%|███       | 3/10 [00:12<00:19,  2.74s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9279, 'compress@10': 0.0725, 'time@10': 4.1244}:  40%|████      | 4/10 [00:12<00:18,  3.10s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9338, 'compress@10': 0.0636, 'time@10': 4.9535}:  40%|████      | 4/10 [00:16<00:18,  3.10s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9338, 'compress@10': 0.0636, 'time@10': 4.9535}:  50%|█████     | 5/10 [00:16<00:17,  3.49s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.868, 'ndcg@10': 0.942, 'compress@10': 0.0582, 'time@10': 5.1553}:  50%|█████     | 5/10 [00:22<00:17,  3.49s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.868, 'ndcg@10': 0.942, 'compress@10': 0.0582, 'time@10': 5.1553}:  60%|██████    | 6/10 [00:22<00:17,  4.41s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9446, 'compress@10': 0.057, 'time@10': 5.3607}:  60%|██████    | 6/10 [00:25<00:17,  4.41s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9446, 'compress@10': 0.057, 'time@10': 5.3607}:  70%|███████   | 7/10 [00:25<00:12,  4.06s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9485, 'compress@10': 0.0543, 'time@10': 5.274}:  70%|███████   | 7/10 [00:30<00:12,  4.06s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9485, 'compress@10': 0.0543, 'time@10': 5.274}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.951, 'compress@10': 0.0522, 'time@10': 5.6432}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.951, 'compress@10': 0.0522, 'time@10': 5.6432}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9537, 'compress@10': 0.0499, 'time@10': 5.6752}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]     {'epoch': 47, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9537, 'compress@10': 0.0499, 'time@10': 5.6752}: 100%|██████████| 10/10 [00:40<00:00,  4.82s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9537, 'compress@10': 0.0499, 'time@10': 5.6752}: 100%|██████████| 10/10 [00:40<00:00,  4.10s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.010000057834065209
Avg hit ratio: 0.885970003209392
Avg ndcg: 0.9536608216738717
Avg compression ratio: 0.04988281813706745
Avg train time: 5.675217914581299
Std train time: 1.6926795913707717
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.059, 'time@10': 4.6628}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.059, 'time@10': 4.6628}:  10%|█         | 1/10 [00:02<00:21,  2.38s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9469, 'compress@10': 0.049, 'time@10': 4.2409}:  10%|█         | 1/10 [00:06<00:21,  2.38s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9469, 'compress@10': 0.049, 'time@10': 4.2409}:  20%|██        | 2/10 [00:06<00:25,  3.25s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.917, 'compress@10': 0.0818, 'time@10': 4.0269}:  20%|██        | 2/10 [00:08<00:25,  3.25s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.917, 'compress@10': 0.0818, 'time@10': 4.0269}:  30%|███       | 3/10 [00:08<00:18,  2.61s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9296, 'compress@10': 0.0722, 'time@10': 3.9258}:  30%|███       | 3/10 [00:11<00:18,  2.61s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9296, 'compress@10': 0.0722, 'time@10': 3.9258}:  40%|████      | 4/10 [00:11<00:18,  3.03s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9342, 'compress@10': 0.0633, 'time@10': 4.8051}:  40%|████      | 4/10 [00:15<00:18,  3.03s/it] {'epoch': 48, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9342, 'compress@10': 0.0633, 'time@10': 4.8051}:  50%|█████     | 5/10 [00:15<00:17,  3.45s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.008, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9413, 'compress@10': 0.058, 'time@10': 5.0273}:  50%|█████     | 5/10 [00:22<00:17,  3.45s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.008, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9413, 'compress@10': 0.058, 'time@10': 5.0273}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9428, 'compress@10': 0.0566, 'time@10': 5.2436}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9428, 'compress@10': 0.0566, 'time@10': 5.2436}:  70%|███████   | 7/10 [00:25<00:12,  4.03s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9647, 'compress@10': 0.054, 'time@10': 5.1805}:  70%|███████   | 7/10 [00:30<00:12,  4.03s/it]  {'epoch': 48, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9647, 'compress@10': 0.054, 'time@10': 5.1805}:  80%|████████  | 8/10 [00:30<00:08,  4.27s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9646, 'compress@10': 0.0518, 'time@10': 5.5583}:  80%|████████  | 8/10 [00:34<00:08,  4.27s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9646, 'compress@10': 0.0518, 'time@10': 5.5583}:  90%|█████████ | 9/10 [00:34<00:04,  4.29s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9636, 'compress@10': 0.0496, 'time@10': 5.5922}:  90%|█████████ | 9/10 [00:40<00:04,  4.29s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9636, 'compress@10': 0.0496, 'time@10': 5.5922}: 100%|██████████| 10/10 [00:40<00:00,  4.80s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9636, 'compress@10': 0.0496, 'time@10': 5.5922}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.011990380565641171
Avg hit ratio: 0.8844851081761099
Avg ndcg: 0.9635671241096648
Avg compression ratio: 0.04955851261546423
Avg train time: 5.5921910285949705
Std train time: 1.7397559066935426
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.059, 'time@10': 4.7959}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.059, 'time@10': 4.7959}:  10%|█         | 1/10 [00:02<00:21,  2.44s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.945, 'compress@10': 0.0489, 'time@10': 4.2757}:  10%|█         | 1/10 [00:06<00:21,  2.44s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.945, 'compress@10': 0.0489, 'time@10': 4.2757}:  20%|██        | 2/10 [00:06<00:25,  3.24s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0035, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9157, 'compress@10': 0.0817, 'time@10': 4.0509}:  20%|██        | 2/10 [00:08<00:25,  3.24s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0035, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9157, 'compress@10': 0.0817, 'time@10': 4.0509}:  30%|███       | 3/10 [00:08<00:18,  2.60s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9278, 'compress@10': 0.072, 'time@10': 3.9469}:  30%|███       | 3/10 [00:11<00:18,  2.60s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9278, 'compress@10': 0.072, 'time@10': 3.9469}:  40%|████      | 4/10 [00:11<00:18,  3.02s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0057, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.9334, 'compress@10': 0.063, 'time@10': 4.8085}:  40%|████      | 4/10 [00:15<00:18,  3.02s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0057, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.9334, 'compress@10': 0.063, 'time@10': 4.8085}:  50%|█████     | 5/10 [00:15<00:17,  3.44s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0053, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9406, 'compress@10': 0.0578, 'time@10': 5.033}:  50%|█████     | 5/10 [00:22<00:17,  3.44s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0053, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9406, 'compress@10': 0.0578, 'time@10': 5.033}:  60%|██████    | 6/10 [00:22<00:17,  4.38s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0061, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9427, 'compress@10': 0.0564, 'time@10': 5.2613}:  60%|██████    | 6/10 [00:25<00:17,  4.38s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0061, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9427, 'compress@10': 0.0564, 'time@10': 5.2613}:  70%|███████   | 7/10 [00:25<00:12,  4.04s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0066, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9452, 'compress@10': 0.0538, 'time@10': 5.154}:  70%|███████   | 7/10 [00:29<00:12,  4.04s/it]  {'epoch': 49, 'num_users': 6.125, 'loss': 0.0066, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9452, 'compress@10': 0.0538, 'time@10': 5.154}:  80%|████████  | 8/10 [00:29<00:08,  4.17s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0068, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9473, 'compress@10': 0.0517, 'time@10': 5.4681}:  80%|████████  | 8/10 [00:33<00:08,  4.17s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0068, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9473, 'compress@10': 0.0517, 'time@10': 5.4681}:  90%|█████████ | 9/10 [00:33<00:04,  4.13s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0062, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9503, 'compress@10': 0.0494, 'time@10': 5.4587}:  90%|█████████ | 9/10 [00:39<00:04,  4.13s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0062, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9503, 'compress@10': 0.0494, 'time@10': 5.4587}: 100%|██████████| 10/10 [00:39<00:00,  4.53s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0062, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9503, 'compress@10': 0.0494, 'time@10': 5.4587}: 100%|██████████| 10/10 [00:39<00:00,  3.94s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.006237778866392872
Avg hit ratio: 0.8962823431991513
Avg ndcg: 0.9502799062691943
Avg compression ratio: 0.04940624454659444
Avg train time: 5.458732628822327
Std train time: 1.6516041514777366
[0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3, 0.3]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
