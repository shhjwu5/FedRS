  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.8923, 'hit_ratio@10': 0.2632, 'ndcg@10': 0.1232, 'compress@10': 0.3368, 'time@10': 9.555}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.8923, 'hit_ratio@10': 0.2632, 'ndcg@10': 0.1232, 'compress@10': 0.3368, 'time@10': 9.555}:  10%|█         | 1/10 [00:04<00:43,  4.82s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.513, 'hit_ratio@10': 0.3896, 'ndcg@10': 0.3295, 'compress@10': 0.3297, 'time@10': 8.254}:  10%|█         | 1/10 [00:11<00:43,  4.82s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.513, 'hit_ratio@10': 0.3896, 'ndcg@10': 0.3295, 'compress@10': 0.3297, 'time@10': 8.254}:  20%|██        | 2/10 [00:11<00:48,  6.10s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 1.149, 'hit_ratio@10': 0.3074, 'ndcg@10': 0.2197, 'compress@10': 0.3531, 'time@10': 6.4179}:  20%|██        | 2/10 [00:13<00:48,  6.10s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 1.149, 'hit_ratio@10': 0.3074, 'ndcg@10': 0.2197, 'compress@10': 0.3531, 'time@10': 6.4179}:  30%|███       | 3/10 [00:13<00:27,  3.96s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9116, 'hit_ratio@10': 0.3734, 'ndcg@10': 0.2891, 'compress@10': 0.3461, 'time@10': 6.3945}:  30%|███       | 3/10 [00:19<00:27,  3.96s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9116, 'hit_ratio@10': 0.3734, 'ndcg@10': 0.2891, 'compress@10': 0.3461, 'time@10': 6.3945}:  40%|████      | 4/10 [00:19<00:29,  4.91s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.751, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.367, 'compress@10': 0.3397, 'time@10': 9.7474}:  40%|████      | 4/10 [00:31<00:29,  4.91s/it]  {'epoch': 0, 'num_users': 5.8, 'loss': 0.751, 'hit_ratio@10': 0.4667, 'ndcg@10': 0.367, 'compress@10': 0.3397, 'time@10': 9.7474}:  50%|█████     | 5/10 [00:31<00:36,  7.33s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.6442, 'hit_ratio@10': 0.5074, 'ndcg@10': 0.4187, 'compress@10': 0.3357, 'time@10': 9.8698}:  50%|█████     | 5/10 [00:41<00:36,  7.33s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.6442, 'hit_ratio@10': 0.5074, 'ndcg@10': 0.4187, 'compress@10': 0.3357, 'time@10': 9.8698}:  60%|██████    | 6/10 [00:41<00:33,  8.42s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.5802, 'hit_ratio@10': 0.5092, 'ndcg@10': 0.4322, 'compress@10': 0.3346, 'time@10': 10.2751}:  60%|██████    | 6/10 [00:48<00:33,  8.42s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.5802, 'hit_ratio@10': 0.5092, 'ndcg@10': 0.4322, 'compress@10': 0.3346, 'time@10': 10.2751}:  70%|███████   | 7/10 [00:48<00:23,  7.76s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.521, 'hit_ratio@10': 0.5527, 'ndcg@10': 0.4473, 'compress@10': 0.3328, 'time@10': 9.9666}:  70%|███████   | 7/10 [00:55<00:23,  7.76s/it]   {'epoch': 0, 'num_users': 6.125, 'loss': 0.521, 'hit_ratio@10': 0.5527, 'ndcg@10': 0.4473, 'compress@10': 0.3328, 'time@10': 9.9666}:  80%|████████  | 8/10 [00:55<00:15,  7.79s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.4762, 'hit_ratio@10': 0.5675, 'ndcg@10': 0.4768, 'compress@10': 0.3313, 'time@10': 10.6233}:  80%|████████  | 8/10 [01:03<00:15,  7.79s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.4762, 'hit_ratio@10': 0.5675, 'ndcg@10': 0.4768, 'compress@10': 0.3313, 'time@10': 10.6233}:  90%|█████████ | 9/10 [01:03<00:07,  7.85s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.4364, 'hit_ratio@10': 0.5971, 'ndcg@10': 0.4956, 'compress@10': 0.3298, 'time@10': 10.5448}:  90%|█████████ | 9/10 [01:13<00:07,  7.85s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.4364, 'hit_ratio@10': 0.5971, 'ndcg@10': 0.4956, 'compress@10': 0.3298, 'time@10': 10.5448}: 100%|██████████| 10/10 [01:13<00:00,  8.47s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.4364, 'hit_ratio@10': 0.5971, 'ndcg@10': 0.4956, 'compress@10': 0.3298, 'time@10': 10.5448}: 100%|██████████| 10/10 [01:13<00:00,  7.38s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.4363921855880458
Avg hit ratio: 0.5971177258885239
Avg ndcg: 0.49561702810560887
Avg compression ratio: 0.32979346300216533
Avg train time: 10.544766831398011
Std train time: 5.4105994900671766
[0.6499999999999999, 0.6499999999999999, 0.6499999999999999, 0.6499999999999999, 0.15, 0.15, 0.6499999999999999, 0.15, 0.15, 0.15]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0695, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.739, 'compress@10': 0.6684, 'time@10': 8.6153}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0695, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.739, 'compress@10': 0.6684, 'time@10': 8.6153}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0634, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.7998, 'compress@10': 0.6648, 'time@10': 7.8832}:  10%|█         | 1/10 [00:11<00:39,  4.38s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0634, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.7998, 'compress@10': 0.6648, 'time@10': 7.8832}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0667, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.7372, 'compress@10': 0.6766, 'time@10': 6.3405}:  20%|██        | 2/10 [00:13<00:48,  6.03s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0667, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.7372, 'compress@10': 0.6766, 'time@10': 6.3405}:  30%|███       | 3/10 [00:13<00:28,  4.04s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.064, 'hit_ratio@10': 0.7706, 'ndcg@10': 0.7657, 'compress@10': 0.673, 'time@10': 6.4465}:  30%|███       | 3/10 [00:20<00:28,  4.04s/it]  {'epoch': 1, 'num_users': 5.0, 'loss': 0.064, 'hit_ratio@10': 0.7706, 'ndcg@10': 0.7657, 'compress@10': 0.673, 'time@10': 6.4465}:  40%|████      | 4/10 [00:20<00:30,  5.13s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0691, 'hit_ratio@10': 0.7805, 'ndcg@10': 0.7658, 'compress@10': 0.5718, 'time@10': 9.2757}:  40%|████      | 4/10 [00:30<00:30,  5.13s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0691, 'hit_ratio@10': 0.7805, 'ndcg@10': 0.7658, 'compress@10': 0.5718, 'time@10': 9.2757}:  50%|█████     | 5/10 [00:30<00:35,  7.01s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0708, 'hit_ratio@10': 0.7652, 'ndcg@10': 0.7739, 'compress@10': 0.5047, 'time@10': 9.4149}:  50%|█████     | 5/10 [00:40<00:35,  7.01s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0708, 'hit_ratio@10': 0.7652, 'ndcg@10': 0.7739, 'compress@10': 0.5047, 'time@10': 9.4149}:  60%|██████    | 6/10 [00:40<00:32,  8.08s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0684, 'hit_ratio@10': 0.7873, 'ndcg@10': 0.778, 'compress@10': 0.5274, 'time@10': 9.7206}:  60%|██████    | 6/10 [00:46<00:32,  8.08s/it] {'epoch': 1, 'num_users': 6.2857, 'loss': 0.0684, 'hit_ratio@10': 0.7873, 'ndcg@10': 0.778, 'compress@10': 0.5274, 'time@10': 9.7206}:  70%|███████   | 7/10 [00:46<00:22,  7.34s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0649, 'hit_ratio@10': 0.8032, 'ndcg@10': 0.7876, 'compress@10': 0.4833, 'time@10': 9.4522}:  70%|███████   | 7/10 [00:53<00:22,  7.34s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0649, 'hit_ratio@10': 0.8032, 'ndcg@10': 0.7876, 'compress@10': 0.4833, 'time@10': 9.4522}:  80%|████████  | 8/10 [00:53<00:14,  7.42s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0624, 'hit_ratio@10': 0.7933, 'ndcg@10': 0.8018, 'compress@10': 0.449, 'time@10': 10.1084}:  80%|████████  | 8/10 [01:01<00:14,  7.42s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0624, 'hit_ratio@10': 0.7933, 'ndcg@10': 0.8018, 'compress@10': 0.449, 'time@10': 10.1084}:  90%|█████████ | 9/10 [01:01<00:07,  7.51s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.061, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8063, 'compress@10': 0.421, 'time@10': 10.0875}:  90%|█████████ | 9/10 [01:11<00:07,  7.51s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.061, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8063, 'compress@10': 0.421, 'time@10': 10.0875}: 100%|██████████| 10/10 [01:11<00:00,  8.26s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.061, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.8063, 'compress@10': 0.421, 'time@10': 10.0875}: 100%|██████████| 10/10 [01:11<00:00,  7.16s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.06095114917694335
Avg hit ratio: 0.8071742724357325
Avg ndcg: 0.8063241424499129
Avg compression ratio: 0.42099968022426976
Avg train time: 10.087524938583375
Std train time: 4.6385320611725085
[0.7666666666666666, 0.7666666666666666, 0.7666666666666666, 0.43333333333333324, 0.43333333333333335, 0.43333333333333335, 0.43333333333333324, 0.1, 0.1, 0.1]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0529, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8411, 'compress@10': 0.7789, 'time@10': 8.497}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0529, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8411, 'compress@10': 0.7789, 'time@10': 8.497}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0529, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8477, 'compress@10': 0.7766, 'time@10': 7.7477}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0529, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8477, 'compress@10': 0.7766, 'time@10': 7.7477}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.041, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.832, 'compress@10': 0.7844, 'time@10': 6.2532}:  20%|██        | 2/10 [00:12<00:47,  5.90s/it]  {'epoch': 2, 'num_users': 5.0, 'loss': 0.041, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.832, 'compress@10': 0.7844, 'time@10': 6.2532}:  30%|███       | 3/10 [00:12<00:27,  3.97s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0432, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8347, 'compress@10': 0.7017, 'time@10': 6.2903}:  30%|███       | 3/10 [00:19<00:27,  3.97s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0432, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8347, 'compress@10': 0.7017, 'time@10': 6.2903}:  40%|████      | 4/10 [00:19<00:29,  4.94s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.052, 'hit_ratio@10': 0.7901, 'ndcg@10': 0.8229, 'compress@10': 0.6503, 'time@10': 8.9893}:  40%|████      | 4/10 [00:29<00:29,  4.94s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.052, 'hit_ratio@10': 0.7901, 'ndcg@10': 0.8229, 'compress@10': 0.6503, 'time@10': 8.9893}:  50%|█████     | 5/10 [00:29<00:33,  6.74s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0565, 'hit_ratio@10': 0.7806, 'ndcg@10': 0.822, 'compress@10': 0.6162, 'time@10': 9.2334}:  50%|█████     | 5/10 [00:39<00:33,  6.74s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0565, 'hit_ratio@10': 0.7806, 'ndcg@10': 0.822, 'compress@10': 0.6162, 'time@10': 9.2334}:  60%|██████    | 6/10 [00:39<00:32,  8.02s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0546, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.827, 'compress@10': 0.5933, 'time@10': 9.5766}:  60%|██████    | 6/10 [00:45<00:32,  8.02s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0546, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.827, 'compress@10': 0.5933, 'time@10': 9.5766}:  70%|███████   | 7/10 [00:45<00:21,  7.31s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0525, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8333, 'compress@10': 0.5349, 'time@10': 9.3147}:  70%|███████   | 7/10 [00:53<00:21,  7.31s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0525, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8333, 'compress@10': 0.5349, 'time@10': 9.3147}:  80%|████████  | 8/10 [00:53<00:14,  7.38s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8422, 'compress@10': 0.4894, 'time@10': 9.8261}:  80%|████████  | 8/10 [01:00<00:14,  7.38s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8422, 'compress@10': 0.4894, 'time@10': 9.8261}:  90%|█████████ | 9/10 [01:00<00:07,  7.26s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0502, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8425, 'compress@10': 0.4525, 'time@10': 9.8534}:  90%|█████████ | 9/10 [01:10<00:07,  7.26s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0502, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8425, 'compress@10': 0.4525, 'time@10': 9.8534}: 100%|██████████| 10/10 [01:10<00:00,  8.15s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0502, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8425, 'compress@10': 0.4525, 'time@10': 9.8534}: 100%|██████████| 10/10 [01:10<00:00,  7.04s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.050226003853351464
Avg hit ratio: 0.8175588090460757
Avg ndcg: 0.8424620379926415
Avg compression ratio: 0.4525189603286817
Avg train time: 9.853433513641358
Std train time: 4.355563581295681
[0.825, 0.825, 0.575, 0.575, 0.575, 0.575, 0.32499999999999996, 0.07500000000000001, 0.07500000000000001, 0.07500000000000001]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8438, 'compress@10': 0.8342, 'time@10': 8.3655}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8438, 'compress@10': 0.8342, 'time@10': 8.3655}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8475, 'compress@10': 0.8324, 'time@10': 7.6794}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0503, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8475, 'compress@10': 0.8324, 'time@10': 7.6794}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0355, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8485, 'compress@10': 0.7668, 'time@10': 6.3407}:  20%|██        | 2/10 [00:13<00:46,  5.87s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0355, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8485, 'compress@10': 0.7668, 'time@10': 6.3407}:  30%|███       | 3/10 [00:13<00:28,  4.04s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0389, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8507, 'compress@10': 0.7227, 'time@10': 6.3181}:  30%|███       | 3/10 [00:19<00:28,  4.04s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0389, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8507, 'compress@10': 0.7227, 'time@10': 6.3181}:  40%|████      | 4/10 [00:19<00:29,  4.93s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0485, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8361, 'compress@10': 0.6948, 'time@10': 8.2721}:  40%|████      | 4/10 [00:27<00:29,  4.93s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0485, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8361, 'compress@10': 0.6948, 'time@10': 8.2721}:  50%|█████     | 5/10 [00:27<00:30,  6.07s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0524, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8329, 'compress@10': 0.6764, 'time@10': 8.6864}:  50%|█████     | 5/10 [00:38<00:30,  6.07s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0524, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8329, 'compress@10': 0.6764, 'time@10': 8.6864}:  60%|██████    | 6/10 [00:38<00:30,  7.67s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0509, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.835, 'compress@10': 0.6301, 'time@10': 9.1003}:  60%|██████    | 6/10 [00:44<00:30,  7.67s/it] {'epoch': 3, 'num_users': 6.2857, 'loss': 0.0509, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.835, 'compress@10': 0.6301, 'time@10': 9.1003}:  70%|███████   | 7/10 [00:44<00:21,  7.07s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0494, 'hit_ratio@10': 0.842, 'ndcg@10': 0.838, 'compress@10': 0.564, 'time@10': 8.8474}:  70%|███████   | 7/10 [00:51<00:21,  7.07s/it]   {'epoch': 3, 'num_users': 6.125, 'loss': 0.0494, 'hit_ratio@10': 0.842, 'ndcg@10': 0.838, 'compress@10': 0.564, 'time@10': 8.8474}:  80%|████████  | 8/10 [00:51<00:14,  7.09s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0478, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8461, 'compress@10': 0.5126, 'time@10': 9.3731}:  80%|████████  | 8/10 [00:58<00:14,  7.09s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0478, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8461, 'compress@10': 0.5126, 'time@10': 9.3731}:  90%|█████████ | 9/10 [00:58<00:07,  7.00s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0473, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8468, 'compress@10': 0.471, 'time@10': 9.4127}:  90%|█████████ | 9/10 [01:07<00:07,  7.00s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.0473, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8468, 'compress@10': 0.471, 'time@10': 9.4127}: 100%|██████████| 10/10 [01:07<00:00,  7.87s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0473, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8468, 'compress@10': 0.471, 'time@10': 9.4127}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04726514241377368
Avg hit ratio: 0.8382065035511556
Avg ndcg: 0.8467524927033969
Avg compression ratio: 0.4709561243837741
Avg train time: 9.412657332420348
Std train time: 3.521734350990783
[0.86, 0.86, 0.45999999999999996, 0.6599999999999999, 0.6599999999999999, 0.6599999999999999, 0.25999999999999995, 0.06000000000000001, 0.06000000000000001, 0.06000000000000001]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8532, 'compress@10': 0.8674, 'time@10': 8.3517}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8532, 'compress@10': 0.8674, 'time@10': 8.3517}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8464, 'compress@10': 0.8659, 'time@10': 7.7682}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8464, 'compress@10': 0.8659, 'time@10': 7.7682}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8478, 'compress@10': 0.7563, 'time@10': 6.6769}:  20%|██        | 2/10 [00:13<00:47,  5.98s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8478, 'compress@10': 0.7563, 'time@10': 6.6769}:  30%|███       | 3/10 [00:13<00:30,  4.29s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8452, 'compress@10': 0.7353, 'time@10': 6.5416}:  30%|███       | 3/10 [00:19<00:30,  4.29s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8452, 'compress@10': 0.7353, 'time@10': 6.5416}:  40%|████      | 4/10 [00:19<00:30,  5.04s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0473, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8312, 'compress@10': 0.7216, 'time@10': 7.9821}:  40%|████      | 4/10 [00:26<00:30,  5.04s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0473, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8312, 'compress@10': 0.7216, 'time@10': 7.9821}:  50%|█████     | 5/10 [00:26<00:28,  5.71s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0508, 'hit_ratio@10': 0.8001, 'ndcg@10': 0.829, 'compress@10': 0.7126, 'time@10': 8.4068}:  50%|█████     | 5/10 [00:37<00:28,  5.71s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0508, 'hit_ratio@10': 0.8001, 'ndcg@10': 0.829, 'compress@10': 0.7126, 'time@10': 8.4068}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0495, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8331, 'compress@10': 0.6522, 'time@10': 8.8192}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0495, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8331, 'compress@10': 0.6522, 'time@10': 8.8192}:  70%|███████   | 7/10 [00:43<00:20,  6.81s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0498, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.838, 'compress@10': 0.5815, 'time@10': 8.6291}:  70%|███████   | 7/10 [00:50<00:20,  6.81s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0498, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.838, 'compress@10': 0.5815, 'time@10': 8.6291}:  80%|████████  | 8/10 [00:50<00:13,  6.98s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8486, 'compress@10': 0.5265, 'time@10': 9.2838}:  80%|████████  | 8/10 [00:57<00:13,  6.98s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8486, 'compress@10': 0.5265, 'time@10': 9.2838}:  90%|█████████ | 9/10 [00:57<00:07,  7.08s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8494, 'compress@10': 0.482, 'time@10': 9.3174}:  90%|█████████ | 9/10 [01:07<00:07,  7.08s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8494, 'compress@10': 0.482, 'time@10': 9.3174}: 100%|██████████| 10/10 [01:07<00:00,  7.88s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8494, 'compress@10': 0.482, 'time@10': 9.3174}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04860454670540316
Avg hit ratio: 0.8321235542423997
Avg ndcg: 0.8493941129078776
Avg compression ratio: 0.48201718150780015
Avg train time: 9.31738348007202
Std train time: 3.0836489530627658
[0.8833333333333333, 0.8833333333333333, 0.3833333333333333, 0.5499999999999999, 0.7166666666666666, 0.7166666666666666, 0.21666666666666662, 0.21666666666666667, 0.05000000000000001, 0.05000000000000001]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8515, 'compress@10': 0.8895, 'time@10': 8.4568}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8515, 'compress@10': 0.8895, 'time@10': 8.4568}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0499, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8495, 'compress@10': 0.8883, 'time@10': 7.6965}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0499, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8495, 'compress@10': 0.8883, 'time@10': 7.6965}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8499, 'compress@10': 0.7493, 'time@10': 6.534}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8499, 'compress@10': 0.7493, 'time@10': 6.534}:  30%|███       | 3/10 [00:13<00:29,  4.16s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8491, 'compress@10': 0.7035, 'time@10': 6.4884}:  30%|███       | 3/10 [00:19<00:29,  4.16s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8491, 'compress@10': 0.7035, 'time@10': 6.4884}:  40%|████      | 4/10 [00:19<00:30,  5.04s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8352, 'compress@10': 0.7073, 'time@10': 7.9809}:  40%|████      | 4/10 [00:26<00:30,  5.04s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8352, 'compress@10': 0.7073, 'time@10': 7.9809}:  50%|█████     | 5/10 [00:26<00:28,  5.75s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0508, 'hit_ratio@10': 0.7854, 'ndcg@10': 0.8331, 'compress@10': 0.7099, 'time@10': 8.4347}:  50%|█████     | 5/10 [00:37<00:28,  5.75s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0508, 'hit_ratio@10': 0.7854, 'ndcg@10': 0.8331, 'compress@10': 0.7099, 'time@10': 8.4347}:  60%|██████    | 6/10 [00:37<00:29,  7.45s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8382, 'compress@10': 0.6439, 'time@10': 8.7951}:  60%|██████    | 6/10 [00:43<00:29,  7.45s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8382, 'compress@10': 0.6439, 'time@10': 8.7951}:  70%|███████   | 7/10 [00:43<00:20,  6.82s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0495, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.846, 'compress@10': 0.5933, 'time@10': 8.6695}:  70%|███████   | 7/10 [00:50<00:20,  6.82s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.0495, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.846, 'compress@10': 0.5933, 'time@10': 8.6695}:  80%|████████  | 8/10 [00:50<00:14,  7.15s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0496, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8502, 'compress@10': 0.5359, 'time@10': 9.2407}:  80%|████████  | 8/10 [00:57<00:14,  7.15s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0496, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8502, 'compress@10': 0.5359, 'time@10': 9.2407}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8516, 'compress@10': 0.4895, 'time@10': 9.2589}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8516, 'compress@10': 0.4895, 'time@10': 9.2589}: 100%|██████████| 10/10 [01:07<00:00,  7.82s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8516, 'compress@10': 0.4895, 'time@10': 9.2589}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04861100151580481
Avg hit ratio: 0.8261430114876636
Avg ndcg: 0.851649877477672
Avg compression ratio: 0.4895136250915784
Avg train time: 9.258871674537659
Std train time: 2.9980567408555028
[0.7571428571428571, 0.9, 0.32857142857142857, 0.6142857142857142, 0.757142857142857, 0.757142857142857, 0.18571428571428567, 0.18571428571428572, 0.18571428571428572, 0.042857142857142864]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8373, 'compress@10': 0.7699, 'time@10': 9.3004}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8373, 'compress@10': 0.7699, 'time@10': 9.3004}:  10%|█         | 1/10 [00:04<00:42,  4.69s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8506, 'compress@10': 0.8366, 'time@10': 8.1084}:  10%|█         | 1/10 [00:11<00:42,  4.69s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8506, 'compress@10': 0.8366, 'time@10': 8.1084}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8528, 'compress@10': 0.6992, 'time@10': 6.9369}:  20%|██        | 2/10 [00:13<00:48,  6.02s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8528, 'compress@10': 0.6992, 'time@10': 6.9369}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8463, 'compress@10': 0.6814, 'time@10': 6.7526}:  30%|███       | 3/10 [00:20<00:30,  4.34s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8463, 'compress@10': 0.6814, 'time@10': 6.7526}:  40%|████      | 4/10 [00:20<00:30,  5.09s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0458, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8342, 'compress@10': 0.6975, 'time@10': 8.1683}:  40%|████      | 4/10 [00:27<00:30,  5.09s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0458, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8342, 'compress@10': 0.6975, 'time@10': 8.1683}:  50%|█████     | 5/10 [00:27<00:28,  5.76s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0482, 'hit_ratio@10': 0.7988, 'ndcg@10': 0.8342, 'compress@10': 0.7084, 'time@10': 8.5421}:  50%|█████     | 5/10 [00:37<00:28,  5.76s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0482, 'hit_ratio@10': 0.7988, 'ndcg@10': 0.8342, 'compress@10': 0.7084, 'time@10': 8.5421}:  60%|██████    | 6/10 [00:37<00:29,  7.35s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.047, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8373, 'compress@10': 0.6384, 'time@10': 8.8361}:  60%|██████    | 6/10 [00:42<00:29,  7.35s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.047, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8373, 'compress@10': 0.6384, 'time@10': 8.8361}:  70%|███████   | 7/10 [00:42<00:20,  6.70s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0469, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8459, 'compress@10': 0.5847, 'time@10': 8.7202}:  70%|███████   | 7/10 [00:50<00:20,  6.70s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0469, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8459, 'compress@10': 0.5847, 'time@10': 8.7202}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0469, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8566, 'compress@10': 0.5429, 'time@10': 9.3465}:  80%|████████  | 8/10 [00:58<00:14,  7.11s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0469, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8566, 'compress@10': 0.5429, 'time@10': 9.3465}:  90%|█████████ | 9/10 [00:58<00:07,  7.14s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.046, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8572, 'compress@10': 0.4951, 'time@10': 9.3259}:  90%|█████████ | 9/10 [01:07<00:07,  7.14s/it]    {'epoch': 6, 'num_users': 6.3, 'loss': 0.046, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8572, 'compress@10': 0.4951, 'time@10': 9.3259}: 100%|██████████| 10/10 [01:07<00:00,  7.77s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.046, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8572, 'compress@10': 0.4951, 'time@10': 9.3259}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04604942931690464
Avg hit ratio: 0.8341588845035364
Avg ndcg: 0.8572433969054817
Avg compression ratio: 0.4951055534927661
Avg train time: 9.325921988487243
Std train time: 2.973636932920256
[0.7875, 0.9125, 0.2875, 0.6625, 0.7874999999999999, 0.7874999999999999, 0.16249999999999995, 0.1625, 0.1625, 0.037500000000000006]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8508, 'compress@10': 0.7987, 'time@10': 8.373}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8508, 'compress@10': 0.7987, 'time@10': 8.373}:  10%|█         | 1/10 [00:04<00:38,  4.22s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.859, 'compress@10': 0.857, 'time@10': 7.6624}:  10%|█         | 1/10 [00:11<00:38,  4.22s/it] {'epoch': 7, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.859, 'compress@10': 0.857, 'time@10': 7.6624}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0307, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8584, 'compress@10': 0.7011, 'time@10': 6.7124}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0307, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8584, 'compress@10': 0.7011, 'time@10': 6.7124}:  30%|███       | 3/10 [00:13<00:30,  4.31s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8578, 'compress@10': 0.6945, 'time@10': 6.6624}:  30%|███       | 3/10 [00:20<00:30,  4.31s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8578, 'compress@10': 0.6945, 'time@10': 6.6624}:  40%|████      | 4/10 [00:20<00:31,  5.19s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0435, 'hit_ratio@10': 0.7968, 'ndcg@10': 0.8437, 'compress@10': 0.7139, 'time@10': 8.0697}:  40%|████      | 4/10 [00:27<00:31,  5.19s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0435, 'hit_ratio@10': 0.7968, 'ndcg@10': 0.8437, 'compress@10': 0.7139, 'time@10': 8.0697}:  50%|█████     | 5/10 [00:27<00:29,  5.80s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0457, 'hit_ratio@10': 0.801, 'ndcg@10': 0.843, 'compress@10': 0.727, 'time@10': 8.4473}:  50%|█████     | 5/10 [00:37<00:29,  5.80s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0457, 'hit_ratio@10': 0.801, 'ndcg@10': 0.843, 'compress@10': 0.727, 'time@10': 8.4473}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0449, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8449, 'compress@10': 0.6511, 'time@10': 8.7527}:  60%|██████    | 6/10 [00:42<00:29,  7.36s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0449, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8449, 'compress@10': 0.6511, 'time@10': 8.7527}:  70%|███████   | 7/10 [00:42<00:20,  6.70s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0446, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8499, 'compress@10': 0.593, 'time@10': 8.6091}:  70%|███████   | 7/10 [00:50<00:20,  6.70s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.0446, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8499, 'compress@10': 0.593, 'time@10': 8.6091}:  80%|████████  | 8/10 [00:50<00:14,  7.00s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.046, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8622, 'compress@10': 0.5479, 'time@10': 9.2122}:  80%|████████  | 8/10 [00:57<00:14,  7.00s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.046, 'hit_ratio@10': 0.8248, 'ndcg@10': 0.8622, 'compress@10': 0.5479, 'time@10': 9.2122}:  90%|█████████ | 9/10 [00:57<00:07,  7.02s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.045, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.8625, 'compress@10': 0.499, 'time@10': 9.2223}:  90%|█████████ | 9/10 [01:06<00:07,  7.02s/it]    {'epoch': 7, 'num_users': 6.3, 'loss': 0.045, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.8625, 'compress@10': 0.499, 'time@10': 9.2223}: 100%|██████████| 10/10 [01:06<00:00,  7.74s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.045, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.8625, 'compress@10': 0.499, 'time@10': 9.2223}: 100%|██████████| 10/10 [01:06<00:00,  6.69s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04502784718013899
Avg hit ratio: 0.8355080908527428
Avg ndcg: 0.8624564112368596
Avg compression ratio: 0.49900408248431843
Avg train time: 9.222286748886109
Std train time: 2.8569048022964956
[0.7, 0.9222222222222222, 0.25555555555555554, 0.7, 0.811111111111111, 0.811111111111111, 0.1444444444444444, 0.14444444444444446, 0.25555555555555554, 0.03333333333333334]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8543, 'compress@10': 0.7158, 'time@10': 8.3071}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8543, 'compress@10': 0.7158, 'time@10': 8.3071}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8634, 'compress@10': 0.8202, 'time@10': 7.5711}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8634, 'compress@10': 0.8202, 'time@10': 7.5711}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8613, 'compress@10': 0.6675, 'time@10': 6.7343}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8613, 'compress@10': 0.6675, 'time@10': 6.7343}:  30%|███       | 3/10 [00:13<00:30,  4.31s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8622, 'compress@10': 0.6783, 'time@10': 6.6331}:  30%|███       | 3/10 [00:19<00:30,  4.31s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8622, 'compress@10': 0.6783, 'time@10': 6.6331}:  40%|████      | 4/10 [00:19<00:30,  5.12s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0425, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8483, 'compress@10': 0.7056, 'time@10': 8.0538}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0425, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8483, 'compress@10': 0.7056, 'time@10': 8.0538}:  50%|█████     | 5/10 [00:26<00:28,  5.77s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0442, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8477, 'compress@10': 0.7239, 'time@10': 8.4638}:  50%|█████     | 5/10 [00:37<00:28,  5.77s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0442, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8477, 'compress@10': 0.7239, 'time@10': 8.4638}:  60%|██████    | 6/10 [00:37<00:29,  7.39s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0435, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8464, 'compress@10': 0.646, 'time@10': 8.834}:  60%|██████    | 6/10 [00:43<00:29,  7.39s/it]  {'epoch': 8, 'num_users': 6.2857, 'loss': 0.0435, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8464, 'compress@10': 0.646, 'time@10': 8.834}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0432, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8508, 'compress@10': 0.5864, 'time@10': 8.7074}:  70%|███████   | 7/10 [00:50<00:20,  6.79s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0432, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8508, 'compress@10': 0.5864, 'time@10': 8.7074}:  80%|████████  | 8/10 [00:50<00:14,  7.13s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0455, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8512, 'compress@10': 0.552, 'time@10': 9.3154}:  80%|████████  | 8/10 [00:58<00:14,  7.13s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0455, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8512, 'compress@10': 0.552, 'time@10': 9.3154}:  90%|█████████ | 9/10 [00:58<00:07,  7.13s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.044, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8537, 'compress@10': 0.5023, 'time@10': 9.2839}:  90%|█████████ | 9/10 [01:07<00:07,  7.13s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.044, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8537, 'compress@10': 0.5023, 'time@10': 9.2839}: 100%|██████████| 10/10 [01:07<00:00,  7.72s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.044, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8537, 'compress@10': 0.5023, 'time@10': 9.2839}: 100%|██████████| 10/10 [01:07<00:00,  6.70s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.044016630870260844
Avg hit ratio: 0.8491458974905495
Avg ndcg: 0.8537152703656556
Avg compression ratio: 0.5023004688109046
Avg train time: 9.283896350860596
Std train time: 2.9014097998406068
[0.73, 0.83, 0.22999999999999998, 0.73, 0.8299999999999998, 0.8299999999999998, 0.12999999999999995, 0.13, 0.32999999999999996, 0.030000000000000006]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8584, 'compress@10': 0.7442, 'time@10': 8.3663}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8584, 'compress@10': 0.7442, 'time@10': 8.3663}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8734, 'compress@10': 0.7898, 'time@10': 7.7768}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8734, 'compress@10': 0.7898, 'time@10': 7.7768}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.868, 'compress@10': 0.6399, 'time@10': 6.9386}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.868, 'compress@10': 0.6399, 'time@10': 6.9386}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8673, 'compress@10': 0.6648, 'time@10': 6.7956}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8673, 'compress@10': 0.6648, 'time@10': 6.7956}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0417, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8541, 'compress@10': 0.6985, 'time@10': 8.1803}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0417, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8541, 'compress@10': 0.6985, 'time@10': 8.1803}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0428, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8546, 'compress@10': 0.7211, 'time@10': 8.5083}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0428, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8546, 'compress@10': 0.7211, 'time@10': 8.5083}:  60%|██████    | 6/10 [00:37<00:29,  7.31s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0426, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8528, 'compress@10': 0.6416, 'time@10': 8.8782}:  60%|██████    | 6/10 [00:43<00:29,  7.31s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0426, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8528, 'compress@10': 0.6416, 'time@10': 8.8782}:  70%|███████   | 7/10 [00:43<00:20,  6.75s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0418, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8562, 'compress@10': 0.5808, 'time@10': 8.715}:  70%|███████   | 7/10 [00:50<00:20,  6.75s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0418, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8562, 'compress@10': 0.5808, 'time@10': 8.715}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0414, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8638, 'compress@10': 0.555, 'time@10': 9.4098}:  80%|████████  | 8/10 [00:58<00:14,  7.04s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0414, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8638, 'compress@10': 0.555, 'time@10': 9.4098}:  90%|█████████ | 9/10 [00:58<00:07,  7.19s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8655, 'compress@10': 0.5047, 'time@10': 9.3529}:  90%|█████████ | 9/10 [01:07<00:07,  7.19s/it]  {'epoch': 9, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8655, 'compress@10': 0.5047, 'time@10': 9.3529}: 100%|██████████| 10/10 [01:07<00:00,  7.71s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8655, 'compress@10': 0.5047, 'time@10': 9.3529}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.04067534974826272
Avg hit ratio: 0.8673046276492796
Avg ndcg: 0.8655140438466828
Avg compression ratio: 0.5047340210531057
Avg train time: 9.352920889854431
Std train time: 2.9835372597330987
[0.7545454545454545, 0.8454545454545455, 0.20909090909090908, 0.7545454545454545, 0.8454545454545453, 0.8454545454545453, 0.11818181818181814, 0.1181818181818182, 0.3, 0.02727272727272728]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.7675, 'time@10': 8.3588}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.7675, 'time@10': 8.3588}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8624, 'compress@10': 0.8089, 'time@10': 7.6896}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8624, 'compress@10': 0.8089, 'time@10': 7.6896}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8607, 'compress@10': 0.6467, 'time@10': 6.9557}:  20%|██        | 2/10 [00:14<00:47,  5.89s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8607, 'compress@10': 0.6467, 'time@10': 6.9557}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8669, 'compress@10': 0.6758, 'time@10': 6.7858}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8669, 'compress@10': 0.6758, 'time@10': 6.7858}:  40%|████      | 4/10 [00:20<00:31,  5.20s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.04, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8541, 'compress@10': 0.7104, 'time@10': 8.1718}:  40%|████      | 4/10 [00:27<00:31,  5.20s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.04, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8541, 'compress@10': 0.7104, 'time@10': 8.1718}:  50%|█████     | 5/10 [00:27<00:29,  5.81s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0407, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.8547, 'compress@10': 0.7334, 'time@10': 8.4218}:  50%|█████     | 5/10 [00:36<00:29,  5.81s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0407, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.8547, 'compress@10': 0.7334, 'time@10': 8.4218}:  60%|██████    | 6/10 [00:36<00:28,  7.14s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0402, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8535, 'compress@10': 0.6506, 'time@10': 8.8274}:  60%|██████    | 6/10 [00:42<00:28,  7.14s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0402, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8535, 'compress@10': 0.6506, 'time@10': 8.8274}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0396, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.857, 'compress@10': 0.5872, 'time@10': 8.6596}:  70%|███████   | 7/10 [00:50<00:19,  6.66s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.0396, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.857, 'compress@10': 0.5872, 'time@10': 8.6596}:  80%|████████  | 8/10 [00:50<00:13,  6.93s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0405, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8594, 'compress@10': 0.5575, 'time@10': 9.2942}:  80%|████████  | 8/10 [00:57<00:13,  6.93s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0405, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8594, 'compress@10': 0.5575, 'time@10': 9.2942}:  90%|█████████ | 9/10 [00:57<00:07,  7.02s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0395, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8622, 'compress@10': 0.5067, 'time@10': 9.285}:  90%|█████████ | 9/10 [01:06<00:07,  7.02s/it]    {'epoch': 10, 'num_users': 6.3, 'loss': 0.0395, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8622, 'compress@10': 0.5067, 'time@10': 9.285}: 100%|██████████| 10/10 [01:06<00:00,  7.71s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0395, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8622, 'compress@10': 0.5067, 'time@10': 9.285}: 100%|██████████| 10/10 [01:06<00:00,  6.67s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03952920425200958
Avg hit ratio: 0.8663010434198888
Avg ndcg: 0.862159119412968
Avg compression ratio: 0.5066924794442607
Avg train time: 9.2850332736969
Std train time: 2.867934001968789
[0.775, 0.775, 0.19166666666666665, 0.775, 0.8583333333333333, 0.8583333333333333, 0.1083333333333333, 0.10833333333333334, 0.35833333333333334, 0.025000000000000005]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8548, 'compress@10': 0.7868, 'time@10': 8.338}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8548, 'compress@10': 0.7868, 'time@10': 8.338}:  10%|█         | 1/10 [00:04<00:39,  4.40s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0402, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8636, 'compress@10': 0.7845, 'time@10': 7.6441}:  10%|█         | 1/10 [00:11<00:39,  4.40s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0402, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8636, 'compress@10': 0.7845, 'time@10': 7.6441}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8614, 'compress@10': 0.6254, 'time@10': 7.0053}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8614, 'compress@10': 0.6254, 'time@10': 7.0053}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8642, 'compress@10': 0.6648, 'time@10': 6.8043}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]  {'epoch': 11, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8642, 'compress@10': 0.6648, 'time@10': 6.8043}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0378, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8514, 'compress@10': 0.7041, 'time@10': 8.1903}:  40%|████      | 4/10 [00:27<00:31,  5.21s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0378, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8514, 'compress@10': 0.7041, 'time@10': 8.1903}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8535, 'compress@10': 0.7303, 'time@10': 8.4507}:  50%|█████     | 5/10 [00:37<00:29,  5.82s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8535, 'compress@10': 0.7303, 'time@10': 8.4507}:  60%|██████    | 6/10 [00:37<00:28,  7.17s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0379, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8541, 'compress@10': 0.6466, 'time@10': 8.8867}:  60%|██████    | 6/10 [00:43<00:28,  7.17s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0379, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.8541, 'compress@10': 0.6466, 'time@10': 8.8867}:  70%|███████   | 7/10 [00:43<00:20,  6.72s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0375, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.8585, 'compress@10': 0.5825, 'time@10': 8.6919}:  70%|███████   | 7/10 [00:50<00:20,  6.72s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0375, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.8585, 'compress@10': 0.5825, 'time@10': 8.6919}:  80%|████████  | 8/10 [00:50<00:13,  6.92s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0364, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8655, 'compress@10': 0.5596, 'time@10': 9.3317}:  80%|████████  | 8/10 [00:57<00:13,  6.92s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0364, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8655, 'compress@10': 0.5596, 'time@10': 9.3317}:  90%|█████████ | 9/10 [00:57<00:07,  7.03s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0355, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8691, 'compress@10': 0.5084, 'time@10': 9.277}:  90%|█████████ | 9/10 [01:06<00:07,  7.03s/it]    {'epoch': 11, 'num_users': 6.3, 'loss': 0.0355, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8691, 'compress@10': 0.5084, 'time@10': 9.277}: 100%|██████████| 10/10 [01:06<00:00,  7.58s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0355, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8691, 'compress@10': 0.5084, 'time@10': 9.277}: 100%|██████████| 10/10 [01:06<00:00,  6.65s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03547351804348294
Avg hit ratio: 0.880733199077851
Avg ndcg: 0.8690834562894129
Avg compression ratio: 0.5083545641218759
Avg train time: 9.277048826217651
Std train time: 2.9018567923268885
[0.7923076923076924, 0.7923076923076924, 0.1769230769230769, 0.7923076923076924, 0.8692307692307691, 0.8692307692307691, 0.09999999999999996, 0.1, 0.33076923076923076, 0.02307692307692308]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.045, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8507, 'compress@10': 0.8032, 'time@10': 8.4805}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.045, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8507, 'compress@10': 0.8032, 'time@10': 8.4805}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.04, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8666, 'compress@10': 0.8011, 'time@10': 7.7589}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it] {'epoch': 12, 'num_users': 7.0, 'loss': 0.04, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8666, 'compress@10': 0.8011, 'time@10': 7.7589}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8634, 'compress@10': 0.6322, 'time@10': 7.0393}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8634, 'compress@10': 0.6322, 'time@10': 7.0393}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8713, 'compress@10': 0.6741, 'time@10': 6.8841}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8713, 'compress@10': 0.6741, 'time@10': 6.8841}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8573, 'compress@10': 0.7137, 'time@10': 8.2947}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8573, 'compress@10': 0.7137, 'time@10': 8.2947}:  50%|█████     | 5/10 [00:27<00:29,  5.91s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0379, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.8589, 'compress@10': 0.7401, 'time@10': 8.5421}:  50%|█████     | 5/10 [00:37<00:29,  5.91s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0379, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.8589, 'compress@10': 0.7401, 'time@10': 8.5421}:  60%|██████    | 6/10 [00:37<00:28,  7.24s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0371, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.8638, 'compress@10': 0.6538, 'time@10': 8.9033}:  60%|██████    | 6/10 [00:43<00:28,  7.24s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0371, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.8638, 'compress@10': 0.6538, 'time@10': 8.9033}:  70%|███████   | 7/10 [00:43<00:20,  6.69s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0367, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.868, 'compress@10': 0.5878, 'time@10': 8.7356}:  70%|███████   | 7/10 [00:50<00:20,  6.69s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.0367, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.868, 'compress@10': 0.5878, 'time@10': 8.7356}:  80%|████████  | 8/10 [00:50<00:13,  6.98s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0373, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.8744, 'compress@10': 0.5613, 'time@10': 9.4052}:  80%|████████  | 8/10 [00:58<00:13,  6.98s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0373, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.8744, 'compress@10': 0.5613, 'time@10': 9.4052}:  90%|█████████ | 9/10 [00:58<00:07,  7.13s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0365, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.8774, 'compress@10': 0.5097, 'time@10': 9.3522}:  90%|█████████ | 9/10 [01:07<00:07,  7.13s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0365, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.8774, 'compress@10': 0.5097, 'time@10': 9.3522}: 100%|██████████| 10/10 [01:07<00:00,  7.68s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0365, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.8774, 'compress@10': 0.5097, 'time@10': 9.3522}: 100%|██████████| 10/10 [01:07<00:00,  6.70s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.036541982818686744
Avg hit ratio: 0.8938955134659718
Avg ndcg: 0.8773772330870127
Avg compression ratio: 0.5097307811106179
Avg train time: 9.352183175086974
Std train time: 2.926780184462309
[0.8071428571428572, 0.7357142857142858, 0.16428571428571426, 0.8071428571428572, 0.8785714285714284, 0.8785714285714284, 0.09285714285714282, 0.09285714285714286, 0.37857142857142856, 0.021428571428571432]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8548, 'compress@10': 0.8173, 'time@10': 8.3523}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8548, 'compress@10': 0.8173, 'time@10': 8.3523}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8724, 'compress@10': 0.7808, 'time@10': 7.7504}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it] {'epoch': 13, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8724, 'compress@10': 0.7808, 'time@10': 7.7504}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8673, 'compress@10': 0.6151, 'time@10': 6.9758}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8673, 'compress@10': 0.6151, 'time@10': 6.9758}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0265, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8767, 'compress@10': 0.6648, 'time@10': 6.7969}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0265, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8767, 'compress@10': 0.6648, 'time@10': 6.7969}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.034, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8617, 'compress@10': 0.708, 'time@10': 8.2903}:  40%|████      | 4/10 [00:27<00:31,  5.21s/it]  {'epoch': 13, 'num_users': 5.8, 'loss': 0.034, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8617, 'compress@10': 0.708, 'time@10': 8.2903}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.034, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8637, 'compress@10': 0.7369, 'time@10': 8.5437}:  50%|█████     | 5/10 [00:37<00:29,  5.92s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.034, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8637, 'compress@10': 0.7369, 'time@10': 8.5437}:  60%|██████    | 6/10 [00:37<00:29,  7.25s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0337, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.865, 'compress@10': 0.6501, 'time@10': 8.894}:  60%|██████    | 6/10 [00:42<00:29,  7.25s/it] {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0337, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.865, 'compress@10': 0.6501, 'time@10': 8.894}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0333, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.87, 'compress@10': 0.5837, 'time@10': 8.6981}:  70%|███████   | 7/10 [00:50<00:20,  6.69s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0333, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.87, 'compress@10': 0.5837, 'time@10': 8.6981}:  80%|████████  | 8/10 [00:50<00:13,  6.91s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0333, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8771, 'compress@10': 0.5629, 'time@10': 9.3588}:  80%|████████  | 8/10 [00:57<00:13,  6.91s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0333, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8771, 'compress@10': 0.5629, 'time@10': 9.3588}:  90%|█████████ | 9/10 [00:57<00:07,  7.05s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8819, 'compress@10': 0.5109, 'time@10': 9.3278}:  90%|█████████ | 9/10 [01:06<00:07,  7.05s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8819, 'compress@10': 0.5109, 'time@10': 9.3278}: 100%|██████████| 10/10 [01:06<00:00,  7.68s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8819, 'compress@10': 0.5109, 'time@10': 9.3278}: 100%|██████████| 10/10 [01:06<00:00,  6.68s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03179938318764723
Avg hit ratio: 0.8706697070143589
Avg ndcg: 0.8819072995048074
Avg compression ratio: 0.5109401468687977
Avg train time: 9.32781970500946
Std train time: 3.0010251244163304
[0.8200000000000001, 0.6866666666666668, 0.1533333333333333, 0.8200000000000001, 0.8866666666666666, 0.8866666666666666, 0.08666666666666663, 0.08666666666666667, 0.42, 0.020000000000000004]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.045, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8447, 'compress@10': 0.8295, 'time@10': 8.8128}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.045, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8447, 'compress@10': 0.8295, 'time@10': 8.8128}:  10%|█         | 1/10 [00:04<00:39,  4.44s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8672, 'compress@10': 0.7631, 'time@10': 7.9148}:  10%|█         | 1/10 [00:11<00:39,  4.44s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8672, 'compress@10': 0.7631, 'time@10': 7.9148}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8638, 'compress@10': 0.6002, 'time@10': 7.1661}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8638, 'compress@10': 0.6002, 'time@10': 7.1661}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8697, 'compress@10': 0.6567, 'time@10': 6.9564}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8697, 'compress@10': 0.6567, 'time@10': 6.9564}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0344, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8565, 'compress@10': 0.7032, 'time@10': 8.2968}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0344, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8565, 'compress@10': 0.7032, 'time@10': 8.2968}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0346, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.8609, 'compress@10': 0.7342, 'time@10': 8.5246}:  50%|█████     | 5/10 [00:37<00:29,  5.86s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0346, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.8609, 'compress@10': 0.7342, 'time@10': 8.5246}:  60%|██████    | 6/10 [00:37<00:28,  7.16s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0351, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8642, 'compress@10': 0.6469, 'time@10': 8.9272}:  60%|██████    | 6/10 [00:43<00:28,  7.16s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0351, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8642, 'compress@10': 0.6469, 'time@10': 8.9272}:  70%|███████   | 7/10 [00:43<00:20,  6.69s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0344, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.8697, 'compress@10': 0.5801, 'time@10': 8.7291}:  70%|███████   | 7/10 [00:50<00:20,  6.69s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0344, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.8697, 'compress@10': 0.5801, 'time@10': 8.7291}:  80%|████████  | 8/10 [00:50<00:13,  6.91s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0361, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.8841, 'compress@10': 0.5642, 'time@10': 9.3687}:  80%|████████  | 8/10 [00:57<00:13,  6.91s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0361, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.8841, 'compress@10': 0.5642, 'time@10': 9.3687}:  90%|█████████ | 9/10 [00:57<00:07,  7.02s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0352, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.8874, 'compress@10': 0.512, 'time@10': 9.3226}:  90%|█████████ | 9/10 [01:06<00:07,  7.02s/it]    {'epoch': 14, 'num_users': 6.3, 'loss': 0.0352, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.8874, 'compress@10': 0.512, 'time@10': 9.3226}: 100%|██████████| 10/10 [01:06<00:00,  7.62s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0352, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.8874, 'compress@10': 0.512, 'time@10': 9.3226}: 100%|██████████| 10/10 [01:06<00:00,  6.66s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.03516456694676888
Avg hit ratio: 0.9017490720937241
Avg ndcg: 0.8873827562374117
Avg compression ratio: 0.511986603589427
Avg train time: 9.322574257850647
Std train time: 2.857338937479268
[0.83125, 0.64375, 0.14374999999999996, 0.76875, 0.8937499999999999, 0.8937499999999999, 0.14374999999999996, 0.08125, 0.45625, 0.018750000000000003]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8675, 'compress@10': 0.8401, 'time@10': 8.4609}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8675, 'compress@10': 0.8401, 'time@10': 8.4609}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0338, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8822, 'compress@10': 0.7477, 'time@10': 7.7455}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0338, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8822, 'compress@10': 0.7477, 'time@10': 7.7455}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0226, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8738, 'compress@10': 0.5871, 'time@10': 6.9706}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0226, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8738, 'compress@10': 0.5871, 'time@10': 6.9706}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8833, 'compress@10': 0.6346, 'time@10': 6.8931}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8833, 'compress@10': 0.6346, 'time@10': 6.8931}:  40%|████      | 4/10 [00:20<00:32,  5.35s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.032, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8677, 'compress@10': 0.6869, 'time@10': 8.239}:  40%|████      | 4/10 [00:27<00:32,  5.35s/it]  {'epoch': 15, 'num_users': 5.8, 'loss': 0.032, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8677, 'compress@10': 0.6869, 'time@10': 8.239}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0317, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8727, 'compress@10': 0.7217, 'time@10': 8.5017}:  50%|█████     | 5/10 [00:37<00:29,  5.89s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0317, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8727, 'compress@10': 0.7217, 'time@10': 8.5017}:  60%|██████    | 6/10 [00:37<00:28,  7.24s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0315, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8735, 'compress@10': 0.6441, 'time@10': 8.9362}:  60%|██████    | 6/10 [00:43<00:28,  7.24s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0315, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8735, 'compress@10': 0.6441, 'time@10': 8.9362}:  70%|███████   | 7/10 [00:43<00:20,  6.77s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.031, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8776, 'compress@10': 0.577, 'time@10': 8.7065}:  70%|███████   | 7/10 [00:50<00:20,  6.77s/it]   {'epoch': 15, 'num_users': 6.125, 'loss': 0.031, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8776, 'compress@10': 0.577, 'time@10': 8.7065}:  80%|████████  | 8/10 [00:50<00:13,  6.89s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0339, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8902, 'compress@10': 0.5653, 'time@10': 9.3637}:  80%|████████  | 8/10 [00:57<00:13,  6.89s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0339, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8902, 'compress@10': 0.5653, 'time@10': 9.3637}:  90%|█████████ | 9/10 [00:57<00:07,  7.03s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0333, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8933, 'compress@10': 0.5129, 'time@10': 9.3511}:  90%|█████████ | 9/10 [01:07<00:07,  7.03s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0333, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8933, 'compress@10': 0.5129, 'time@10': 9.3511}: 100%|██████████| 10/10 [01:07<00:00,  7.72s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0333, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8933, 'compress@10': 0.5129, 'time@10': 9.3511}: 100%|██████████| 10/10 [01:07<00:00,  6.70s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.033293597996182436
Avg hit ratio: 0.8731776435222954
Avg ndcg: 0.8933244400902873
Avg compression ratio: 0.5128755042736228
Avg train time: 9.351119041442871
Std train time: 2.9153221668059808
[0.8411764705882353, 0.6058823529411765, 0.1352941176470588, 0.7823529411764706, 0.8999999999999999, 0.8411764705882352, 0.1941176470588235, 0.07647058823529412, 0.48823529411764705, 0.017647058823529415]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8505, 'compress@10': 0.8495, 'time@10': 8.5178}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8505, 'compress@10': 0.8495, 'time@10': 8.5178}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.033, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8762, 'compress@10': 0.7341, 'time@10': 7.7575}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]  {'epoch': 16, 'num_users': 7.0, 'loss': 0.033, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8762, 'compress@10': 0.7341, 'time@10': 7.7575}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8699, 'compress@10': 0.5756, 'time@10': 6.965}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8699, 'compress@10': 0.5756, 'time@10': 6.965}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8766, 'compress@10': 0.6293, 'time@10': 6.8129}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8766, 'compress@10': 0.6293, 'time@10': 6.8129}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0296, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8626, 'compress@10': 0.6838, 'time@10': 8.1231}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0296, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8626, 'compress@10': 0.6838, 'time@10': 8.1231}:  50%|█████     | 5/10 [00:27<00:28,  5.77s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8702, 'compress@10': 0.7106, 'time@10': 8.4532}:  50%|█████     | 5/10 [00:37<00:28,  5.77s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8702, 'compress@10': 0.7106, 'time@10': 8.4532}:  60%|██████    | 6/10 [00:37<00:29,  7.26s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8734, 'compress@10': 0.6414, 'time@10': 8.8599}:  60%|██████    | 6/10 [00:43<00:29,  7.26s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8734, 'compress@10': 0.6414, 'time@10': 8.8599}:  70%|███████   | 7/10 [00:43<00:20,  6.74s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.029, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8778, 'compress@10': 0.5741, 'time@10': 8.6406}:  70%|███████   | 7/10 [00:50<00:20,  6.74s/it]  {'epoch': 16, 'num_users': 6.125, 'loss': 0.029, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8778, 'compress@10': 0.5741, 'time@10': 8.6406}:  80%|████████  | 8/10 [00:50<00:13,  6.87s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0324, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8707, 'compress@10': 0.5662, 'time@10': 9.285}:  80%|████████  | 8/10 [00:57<00:13,  6.87s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0324, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8707, 'compress@10': 0.5662, 'time@10': 9.285}:  90%|█████████ | 9/10 [00:57<00:06,  6.99s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8767, 'compress@10': 0.5136, 'time@10': 9.2359}:  90%|█████████ | 9/10 [01:06<00:06,  6.99s/it]  {'epoch': 16, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8767, 'compress@10': 0.5136, 'time@10': 9.2359}: 100%|██████████| 10/10 [01:06<00:00,  7.56s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.8767, 'compress@10': 0.5136, 'time@10': 9.2359}: 100%|██████████| 10/10 [01:06<00:00,  6.63s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.03157498778454584
Avg hit ratio: 0.8756661227849684
Avg ndcg: 0.876739049650163
Avg compression ratio: 0.5135810159334138
Avg train time: 9.235903453826904
Std train time: 2.8733786608868015
[0.85, 0.5722222222222223, 0.12777777777777774, 0.7388888888888889, 0.9055555555555554, 0.8499999999999999, 0.23888888888888887, 0.07222222222222223, 0.5166666666666666, 0.01666666666666667]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8675, 'compress@10': 0.8579, 'time@10': 8.3648}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8675, 'compress@10': 0.8579, 'time@10': 8.3648}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0312, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8834, 'compress@10': 0.7219, 'time@10': 7.9096}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0312, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8834, 'compress@10': 0.7219, 'time@10': 7.9096}:  20%|██        | 2/10 [00:11<00:49,  6.14s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8746, 'compress@10': 0.5654, 'time@10': 7.2286}:  20%|██        | 2/10 [00:14<00:49,  6.14s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8746, 'compress@10': 0.5654, 'time@10': 7.2286}:  30%|███       | 3/10 [00:14<00:32,  4.70s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8838, 'compress@10': 0.6111, 'time@10': 7.038}:  30%|███       | 3/10 [00:21<00:32,  4.70s/it]  {'epoch': 17, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8838, 'compress@10': 0.6111, 'time@10': 7.038}:  40%|████      | 4/10 [00:21<00:32,  5.41s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0291, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8691, 'compress@10': 0.6704, 'time@10': 8.3819}:  40%|████      | 4/10 [00:28<00:32,  5.41s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0291, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8691, 'compress@10': 0.6704, 'time@10': 8.3819}:  50%|█████     | 5/10 [00:28<00:29,  5.95s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.8764, 'compress@10': 0.7009, 'time@10': 8.6312}:  50%|█████     | 5/10 [00:38<00:29,  5.95s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.8764, 'compress@10': 0.7009, 'time@10': 8.6312}:  60%|██████    | 6/10 [00:38<00:29,  7.31s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8823, 'compress@10': 0.6392, 'time@10': 8.9897}:  60%|██████    | 6/10 [00:43<00:29,  7.31s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8823, 'compress@10': 0.6392, 'time@10': 8.9897}:  70%|███████   | 7/10 [00:43<00:20,  6.75s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0268, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.8868, 'compress@10': 0.5717, 'time@10': 8.7651}:  70%|███████   | 7/10 [00:50<00:20,  6.75s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0268, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.8868, 'compress@10': 0.5717, 'time@10': 8.7651}:  80%|████████  | 8/10 [00:50<00:13,  6.90s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.894, 'compress@10': 0.5671, 'time@10': 9.4278}:  80%|████████  | 8/10 [00:58<00:13,  6.90s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.894, 'compress@10': 0.5671, 'time@10': 9.4278}:  90%|█████████ | 9/10 [00:58<00:07,  7.06s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.8996, 'compress@10': 0.5143, 'time@10': 9.3649}:  90%|█████████ | 9/10 [01:07<00:07,  7.06s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.8996, 'compress@10': 0.5143, 'time@10': 9.3649}: 100%|██████████| 10/10 [01:07<00:00,  7.61s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.8996, 'compress@10': 0.5143, 'time@10': 9.3649}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02525352995320162
Avg hit ratio: 0.9011646565093084
Avg ndcg: 0.8996474232743035
Avg compression ratio: 0.5142822787669149
Avg train time: 9.364899349212646
Std train time: 2.8604224050606573
[0.8578947368421053, 0.5947368421052632, 0.12105263157894733, 0.7526315789473684, 0.9105263157894736, 0.8052631578947367, 0.2263157894736842, 0.06842105263157895, 0.5421052631578946, 0.01578947368421053]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0406, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8476, 'compress@10': 0.8654, 'time@10': 8.4162}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0406, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8476, 'compress@10': 0.8654, 'time@10': 8.4162}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8804, 'compress@10': 0.7366, 'time@10': 7.8087}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8804, 'compress@10': 0.7366, 'time@10': 7.8087}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8727, 'compress@10': 0.5733, 'time@10': 7.0623}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8727, 'compress@10': 0.5733, 'time@10': 7.0623}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8819, 'compress@10': 0.6203, 'time@10': 6.8744}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8819, 'compress@10': 0.6203, 'time@10': 6.8744}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8685, 'compress@10': 0.6787, 'time@10': 8.2183}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8685, 'compress@10': 0.6787, 'time@10': 8.2183}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0285, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.8775, 'compress@10': 0.7005, 'time@10': 8.5269}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0285, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.8775, 'compress@10': 0.7005, 'time@10': 8.5269}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0282, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.8815, 'compress@10': 0.6372, 'time@10': 8.933}:  60%|██████    | 6/10 [00:43<00:29,  7.29s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.0282, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.8815, 'compress@10': 0.6372, 'time@10': 8.933}:  70%|███████   | 7/10 [00:43<00:20,  6.78s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.8858, 'compress@10': 0.5694, 'time@10': 8.7061}:  70%|███████   | 7/10 [00:50<00:20,  6.78s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.8858, 'compress@10': 0.5694, 'time@10': 8.7061}:  80%|████████  | 8/10 [00:50<00:13,  6.90s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0271, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.8897, 'compress@10': 0.5678, 'time@10': 9.3124}:  80%|████████  | 8/10 [00:57<00:13,  6.90s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0271, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.8897, 'compress@10': 0.5678, 'time@10': 9.3124}:  90%|█████████ | 9/10 [00:57<00:06,  6.97s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.8943, 'compress@10': 0.5149, 'time@10': 9.2773}:  90%|█████████ | 9/10 [01:06<00:06,  6.97s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.8943, 'compress@10': 0.5149, 'time@10': 9.2773}: 100%|██████████| 10/10 [01:06<00:00,  7.59s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.8943, 'compress@10': 0.5149, 'time@10': 9.2773}: 100%|██████████| 10/10 [01:06<00:00,  6.67s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.02637642087007839
Avg hit ratio: 0.9007135286897595
Avg ndcg: 0.8943283984564369
Avg compression ratio: 0.514879889021053
Avg train time: 9.277321982383729
Std train time: 2.8263242976751197
[0.865, 0.5650000000000001, 0.11499999999999996, 0.765, 0.9149999999999999, 0.7649999999999999, 0.26499999999999996, 0.115, 0.5149999999999999, 0.015000000000000003]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.034, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8663, 'compress@10': 0.8721, 'time@10': 8.494}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.034, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8663, 'compress@10': 0.8721, 'time@10': 8.494}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.898, 'compress@10': 0.7256, 'time@10': 7.8536}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.898, 'compress@10': 0.7256, 'time@10': 7.8536}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8844, 'compress@10': 0.5642, 'time@10': 7.071}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8844, 'compress@10': 0.5642, 'time@10': 7.071}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8933, 'compress@10': 0.6165, 'time@10': 6.8809}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8933, 'compress@10': 0.6165, 'time@10': 6.8809}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8781, 'compress@10': 0.6765, 'time@10': 8.2369}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8781, 'compress@10': 0.6765, 'time@10': 8.2369}:  50%|█████     | 5/10 [00:27<00:29,  5.85s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8862, 'compress@10': 0.6921, 'time@10': 8.5283}:  50%|█████     | 5/10 [00:37<00:29,  5.85s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8862, 'compress@10': 0.6921, 'time@10': 8.5283}:  60%|██████    | 6/10 [00:37<00:29,  7.27s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0248, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.8868, 'compress@10': 0.6353, 'time@10': 8.9565}:  60%|██████    | 6/10 [00:43<00:29,  7.27s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0248, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.8868, 'compress@10': 0.6353, 'time@10': 8.9565}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0246, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8908, 'compress@10': 0.5734, 'time@10': 8.7886}:  70%|███████   | 7/10 [00:51<00:20,  6.79s/it]  {'epoch': 19, 'num_users': 6.125, 'loss': 0.0246, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8908, 'compress@10': 0.5734, 'time@10': 8.7886}:  80%|████████  | 8/10 [00:51<00:14,  7.06s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0253, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.8957, 'compress@10': 0.5685, 'time@10': 9.3929}:  80%|████████  | 8/10 [00:58<00:14,  7.06s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0253, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.8957, 'compress@10': 0.5685, 'time@10': 9.3929}:  90%|█████████ | 9/10 [00:58<00:07,  7.10s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0254, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9, 'compress@10': 0.5154, 'time@10': 9.326}:  90%|█████████ | 9/10 [01:06<00:07,  7.10s/it]       {'epoch': 19, 'num_users': 6.3, 'loss': 0.0254, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9, 'compress@10': 0.5154, 'time@10': 9.326}: 100%|██████████| 10/10 [01:06<00:00,  7.61s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0254, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9, 'compress@10': 0.5154, 'time@10': 9.326}: 100%|██████████| 10/10 [01:06<00:00,  6.70s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.025402139267583834
Avg hit ratio: 0.8892849572611882
Avg ndcg: 0.8999609569004597
Avg compression ratio: 0.5153776224154037
Avg train time: 9.325989961624146
Std train time: 2.8325853408080137
[0.8714285714285714, 0.5380952380952382, 0.1095238095238095, 0.7761904761904762, 0.919047619047619, 0.7285714285714284, 0.2523809523809523, 0.10952380952380952, 0.538095238095238, 0.06190476190476191]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.033, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8691, 'compress@10': 0.8782, 'time@10': 8.5043}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.033, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8691, 'compress@10': 0.8782, 'time@10': 8.5043}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0257, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9013, 'compress@10': 0.7156, 'time@10': 7.768}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0257, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9013, 'compress@10': 0.7156, 'time@10': 7.768}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8866, 'compress@10': 0.556, 'time@10': 6.9871}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8866, 'compress@10': 0.556, 'time@10': 6.9871}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8966, 'compress@10': 0.613, 'time@10': 6.846}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8966, 'compress@10': 0.613, 'time@10': 6.846}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0241, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8827, 'compress@10': 0.6745, 'time@10': 8.2679}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0241, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8827, 'compress@10': 0.6745, 'time@10': 8.2679}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0233, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8908, 'compress@10': 0.6846, 'time@10': 8.5755}:  50%|█████     | 5/10 [00:37<00:29,  5.89s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0233, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.8908, 'compress@10': 0.6846, 'time@10': 8.5755}:  60%|██████    | 6/10 [00:37<00:29,  7.34s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0237, 'hit_ratio@10': 0.885, 'ndcg@10': 0.894, 'compress@10': 0.6271, 'time@10': 8.9472}:  60%|██████    | 6/10 [00:43<00:29,  7.34s/it]  {'epoch': 20, 'num_users': 6.2857, 'loss': 0.0237, 'hit_ratio@10': 0.885, 'ndcg@10': 0.894, 'compress@10': 0.6271, 'time@10': 8.9472}:  70%|███████   | 7/10 [00:43<00:20,  6.78s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0234, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.8992, 'compress@10': 0.5656, 'time@10': 8.7599}:  70%|███████   | 7/10 [00:50<00:20,  6.78s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0234, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.8992, 'compress@10': 0.5656, 'time@10': 8.7599}:  80%|████████  | 8/10 [00:50<00:14,  7.00s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0236, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9028, 'compress@10': 0.564, 'time@10': 9.4199}:  80%|████████  | 8/10 [00:58<00:14,  7.00s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0236, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9028, 'compress@10': 0.564, 'time@10': 9.4199}:  90%|█████████ | 9/10 [00:58<00:07,  7.12s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.908, 'compress@10': 0.5159, 'time@10': 9.3664}:  90%|█████████ | 9/10 [01:07<00:07,  7.12s/it]    {'epoch': 20, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.908, 'compress@10': 0.5159, 'time@10': 9.3664}: 100%|██████████| 10/10 [01:07<00:00,  7.68s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.908, 'compress@10': 0.5159, 'time@10': 9.3664}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.02203125249486119
Avg hit ratio: 0.8886500366262675
Avg ndcg: 0.9080160209169337
Avg compression ratio: 0.5159085521431783
Avg train time: 9.366354823112488
Std train time: 2.960348638160728
[0.8772727272727273, 0.5136363636363637, 0.10454545454545452, 0.7863636363636364, 0.9227272727272727, 0.6954545454545453, 0.2863636363636363, 0.10454545454545454, 0.559090909090909, 0.05909090909090909]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.861, 'compress@10': 0.8837, 'time@10': 8.3372}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.861, 'compress@10': 0.8837, 'time@10': 8.3372}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.898, 'compress@10': 0.7065, 'time@10': 7.746}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it] {'epoch': 21, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.898, 'compress@10': 0.7065, 'time@10': 7.746}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8844, 'compress@10': 0.5485, 'time@10': 6.9708}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8844, 'compress@10': 0.5485, 'time@10': 6.9708}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8952, 'compress@10': 0.6099, 'time@10': 6.7971}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8952, 'compress@10': 0.6099, 'time@10': 6.7971}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8826, 'compress@10': 0.6728, 'time@10': 8.1226}:  40%|████      | 4/10 [00:27<00:31,  5.21s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0246, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8826, 'compress@10': 0.6728, 'time@10': 8.1226}:  50%|█████     | 5/10 [00:27<00:28,  5.77s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0238, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8923, 'compress@10': 0.6777, 'time@10': 8.4616}:  50%|█████     | 5/10 [00:37<00:28,  5.77s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0238, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8923, 'compress@10': 0.6777, 'time@10': 8.4616}:  60%|██████    | 6/10 [00:37<00:29,  7.27s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.893, 'compress@10': 0.6258, 'time@10': 8.8591}:  60%|██████    | 6/10 [00:43<00:29,  7.27s/it] {'epoch': 21, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.893, 'compress@10': 0.6258, 'time@10': 8.8591}:  70%|███████   | 7/10 [00:43<00:20,  6.74s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0235, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.8983, 'compress@10': 0.5639, 'time@10': 8.6751}:  70%|███████   | 7/10 [00:50<00:20,  6.74s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0235, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.8983, 'compress@10': 0.5639, 'time@10': 8.6751}:  80%|████████  | 8/10 [00:50<00:13,  6.96s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0249, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9105, 'compress@10': 0.5647, 'time@10': 9.2782}:  80%|████████  | 8/10 [00:57<00:13,  6.96s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0249, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9105, 'compress@10': 0.5647, 'time@10': 9.2782}:  90%|█████████ | 9/10 [00:57<00:07,  7.00s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9137, 'compress@10': 0.5163, 'time@10': 9.2188}:  90%|█████████ | 9/10 [01:06<00:07,  7.00s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9137, 'compress@10': 0.5163, 'time@10': 9.2188}: 100%|██████████| 10/10 [01:06<00:00,  7.53s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9137, 'compress@10': 0.5163, 'time@10': 9.2188}: 100%|██████████| 10/10 [01:06<00:00,  6.63s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.02473971985477972
Avg hit ratio: 0.9057928937691246
Avg ndcg: 0.9136995856681329
Avg compression ratio: 0.5163195672928002
Avg train time: 9.218794703483582
Std train time: 2.7980333731637645
[0.8826086956521739, 0.491304347826087, 0.09999999999999998, 0.7956521739130434, 0.9260869565217391, 0.6652173913043476, 0.27391304347826084, 0.14347826086956522, 0.5782608695652173, 0.05652173913043478]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8735, 'compress@10': 0.8888, 'time@10': 8.3738}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8735, 'compress@10': 0.8888, 'time@10': 8.3738}:  10%|█         | 1/10 [00:04<00:38,  4.22s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9063, 'compress@10': 0.6982, 'time@10': 7.7582}:  10%|█         | 1/10 [00:11<00:38,  4.22s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9063, 'compress@10': 0.6982, 'time@10': 7.7582}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8899, 'compress@10': 0.5417, 'time@10': 6.9785}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8899, 'compress@10': 0.5417, 'time@10': 6.9785}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9013, 'compress@10': 0.607, 'time@10': 6.8088}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9013, 'compress@10': 0.607, 'time@10': 6.8088}:  40%|████      | 4/10 [00:20<00:31,  5.22s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8902, 'compress@10': 0.6711, 'time@10': 8.1968}:  40%|████      | 4/10 [00:27<00:31,  5.22s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8902, 'compress@10': 0.6711, 'time@10': 8.1968}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8997, 'compress@10': 0.6714, 'time@10': 8.511}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8997, 'compress@10': 0.6714, 'time@10': 8.511}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0199, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9032, 'compress@10': 0.6187, 'time@10': 8.9168}:  60%|██████    | 6/10 [00:43<00:29,  7.29s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0199, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9032, 'compress@10': 0.6187, 'time@10': 8.9168}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.02, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.9078, 'compress@10': 0.5624, 'time@10': 8.7635}:  70%|███████   | 7/10 [00:51<00:20,  6.79s/it]   {'epoch': 22, 'num_users': 6.125, 'loss': 0.02, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.9078, 'compress@10': 0.5624, 'time@10': 8.7635}:  80%|████████  | 8/10 [00:51<00:14,  7.09s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9106, 'compress@10': 0.5655, 'time@10': 9.3845}:  80%|████████  | 8/10 [00:58<00:14,  7.09s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9106, 'compress@10': 0.5655, 'time@10': 9.3845}:  90%|█████████ | 9/10 [00:58<00:07,  7.13s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9157, 'compress@10': 0.5167, 'time@10': 9.3198}:  90%|█████████ | 9/10 [01:07<00:07,  7.13s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9157, 'compress@10': 0.5167, 'time@10': 9.3198}: 100%|██████████| 10/10 [01:07<00:00,  7.64s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0197, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9157, 'compress@10': 0.5167, 'time@10': 9.3198}: 100%|██████████| 10/10 [01:07<00:00,  6.70s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.01974149011611535
Avg hit ratio: 0.9057928937691246
Avg ndcg: 0.9156941292969224
Avg compression ratio: 0.5167387430732906
Avg train time: 9.31978235244751
Std train time: 2.8744996201097712
[0.8875, 0.4708333333333334, 0.09583333333333331, 0.7625, 0.9291666666666667, 0.6374999999999998, 0.30416666666666664, 0.17916666666666667, 0.5958333333333332, 0.05416666666666667]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8638, 'compress@10': 0.8934, 'time@10': 8.4219}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8638, 'compress@10': 0.8934, 'time@10': 8.4219}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9022, 'compress@10': 0.6907, 'time@10': 7.8167}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9022, 'compress@10': 0.6907, 'time@10': 7.8167}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8872, 'compress@10': 0.5354, 'time@10': 6.9998}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8872, 'compress@10': 0.5354, 'time@10': 6.9998}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9006, 'compress@10': 0.5943, 'time@10': 6.8911}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9006, 'compress@10': 0.5943, 'time@10': 6.8911}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8923, 'compress@10': 0.6616, 'time@10': 8.2273}:  40%|████      | 4/10 [00:27<00:32,  5.34s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0225, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8923, 'compress@10': 0.6616, 'time@10': 8.2273}:  50%|█████     | 5/10 [00:27<00:29,  5.88s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9015, 'compress@10': 0.6589, 'time@10': 8.5605}:  50%|█████     | 5/10 [00:37<00:29,  5.88s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9015, 'compress@10': 0.6589, 'time@10': 8.5605}:  60%|██████    | 6/10 [00:37<00:29,  7.37s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0214, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9054, 'compress@10': 0.6122, 'time@10': 8.9133}:  60%|██████    | 6/10 [00:43<00:29,  7.37s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0214, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9054, 'compress@10': 0.6122, 'time@10': 8.9133}:  70%|███████   | 7/10 [00:43<00:20,  6.77s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.021, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.9104, 'compress@10': 0.561, 'time@10': 8.7572}:  70%|███████   | 7/10 [00:51<00:20,  6.77s/it]   {'epoch': 23, 'num_users': 6.125, 'loss': 0.021, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.9104, 'compress@10': 0.561, 'time@10': 8.7572}:  80%|████████  | 8/10 [00:51<00:14,  7.07s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.917, 'compress@10': 0.5662, 'time@10': 9.3355}:  80%|████████  | 8/10 [00:58<00:14,  7.07s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.917, 'compress@10': 0.5662, 'time@10': 9.3355}:  90%|█████████ | 9/10 [00:58<00:07,  7.06s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9212, 'compress@10': 0.5171, 'time@10': 9.2853}:  90%|█████████ | 9/10 [01:07<00:07,  7.06s/it]  {'epoch': 23, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9212, 'compress@10': 0.5171, 'time@10': 9.2853}: 100%|██████████| 10/10 [01:07<00:00,  7.62s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0216, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9212, 'compress@10': 0.5171, 'time@10': 9.2853}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.021633016322851275
Avg hit ratio: 0.9000786080548389
Avg ndcg: 0.9212155795556802
Avg compression ratio: 0.5171075591656866
Avg train time: 9.285250997543335
Std train time: 2.735162014918486
[0.8919999999999999, 0.45200000000000007, 0.09199999999999998, 0.7719999999999999, 0.932, 0.6519999999999998, 0.292, 0.17200000000000001, 0.6119999999999999, 0.052000000000000005]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.88, 'compress@10': 0.8977, 'time@10': 8.4418}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.88, 'compress@10': 0.8977, 'time@10': 8.4418}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9103, 'compress@10': 0.6837, 'time@10': 7.7694}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9103, 'compress@10': 0.6837, 'time@10': 7.7694}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8926, 'compress@10': 0.5297, 'time@10': 7.0123}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8926, 'compress@10': 0.5297, 'time@10': 7.0123}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9038, 'compress@10': 0.5923, 'time@10': 6.8058}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9038, 'compress@10': 0.5923, 'time@10': 6.8058}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8958, 'compress@10': 0.6605, 'time@10': 8.1027}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8958, 'compress@10': 0.6605, 'time@10': 8.1027}:  50%|█████     | 5/10 [00:27<00:28,  5.72s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9056, 'compress@10': 0.6604, 'time@10': 8.4877}:  50%|█████     | 5/10 [00:37<00:28,  5.72s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9056, 'compress@10': 0.6604, 'time@10': 8.4877}:  60%|██████    | 6/10 [00:37<00:29,  7.33s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9088, 'compress@10': 0.6118, 'time@10': 8.89}:  60%|██████    | 6/10 [00:43<00:29,  7.33s/it]   {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9088, 'compress@10': 0.6118, 'time@10': 8.89}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9141, 'compress@10': 0.5598, 'time@10': 8.7296}:  70%|███████   | 7/10 [00:50<00:20,  6.79s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9141, 'compress@10': 0.5598, 'time@10': 8.7296}:  80%|████████  | 8/10 [00:50<00:14,  7.07s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9184, 'compress@10': 0.5668, 'time@10': 9.3344}:  80%|████████  | 8/10 [00:57<00:14,  7.07s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9184, 'compress@10': 0.5668, 'time@10': 9.3344}:  90%|█████████ | 9/10 [00:57<00:07,  7.08s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9235, 'compress@10': 0.5175, 'time@10': 9.2624}:  90%|█████████ | 9/10 [01:06<00:07,  7.08s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9235, 'compress@10': 0.5175, 'time@10': 9.2624}: 100%|██████████| 10/10 [01:06<00:00,  7.57s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9235, 'compress@10': 0.5175, 'time@10': 9.2624}: 100%|██████████| 10/10 [01:06<00:00,  6.66s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.01765198334764104
Avg hit ratio: 0.8943643223405532
Avg ndcg: 0.9234663499762469
Avg compression ratio: 0.5174885068176904
Avg train time: 9.262363982200622
Std train time: 2.792626455785715
[0.8961538461538461, 0.4346153846153847, 0.08846153846153845, 0.7807692307692307, 0.9346153846153846, 0.6269230769230767, 0.3192307692307692, 0.20384615384615384, 0.5884615384615384, 0.05]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8728, 'compress@10': 0.9016, 'time@10': 8.2195}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8728, 'compress@10': 0.9016, 'time@10': 8.2195}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9067, 'compress@10': 0.6772, 'time@10': 7.6488}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9067, 'compress@10': 0.6772, 'time@10': 7.6488}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8902, 'compress@10': 0.5244, 'time@10': 6.9103}:  20%|██        | 2/10 [00:14<00:47,  5.89s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8902, 'compress@10': 0.5244, 'time@10': 6.9103}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9033, 'compress@10': 0.5904, 'time@10': 6.7743}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9033, 'compress@10': 0.5904, 'time@10': 6.7743}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.898, 'compress@10': 0.6595, 'time@10': 8.1259}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it] {'epoch': 25, 'num_users': 5.8, 'loss': 0.0205, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.898, 'compress@10': 0.6595, 'time@10': 8.1259}:  50%|█████     | 5/10 [00:27<00:28,  5.79s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0197, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9069, 'compress@10': 0.6555, 'time@10': 8.4726}:  50%|█████     | 5/10 [00:37<00:28,  5.79s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0197, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9069, 'compress@10': 0.6555, 'time@10': 8.4726}:  60%|██████    | 6/10 [00:37<00:29,  7.31s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0196, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9085, 'compress@10': 0.6113, 'time@10': 8.8635}:  60%|██████    | 6/10 [00:43<00:29,  7.31s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.0196, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9085, 'compress@10': 0.6113, 'time@10': 8.8635}:  70%|███████   | 7/10 [00:43<00:20,  6.76s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.914, 'compress@10': 0.5632, 'time@10': 8.7069}:  70%|███████   | 7/10 [00:50<00:20,  6.76s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.914, 'compress@10': 0.5632, 'time@10': 8.7069}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9172, 'compress@10': 0.5673, 'time@10': 9.344}:  80%|████████  | 8/10 [00:58<00:14,  7.04s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9172, 'compress@10': 0.5673, 'time@10': 9.344}:  90%|█████████ | 9/10 [00:58<00:07,  7.11s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.919, 'compress@10': 0.5178, 'time@10': 9.2779}:  90%|█████████ | 9/10 [01:06<00:07,  7.11s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.919, 'compress@10': 0.5178, 'time@10': 9.2779}: 100%|██████████| 10/10 [01:06<00:00,  7.61s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.919, 'compress@10': 0.5178, 'time@10': 9.2779}: 100%|██████████| 10/10 [01:06<00:00,  6.67s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.02069442257493127
Avg hit ratio: 0.8829357509119818
Avg ndcg: 0.919016506487379
Avg compression ratio: 0.5177737223465664
Avg train time: 9.277903819084168
Std train time: 2.8582622025078557
[0.8999999999999999, 0.41851851851851857, 0.08518518518518518, 0.7518518518518518, 0.937037037037037, 0.6037037037037035, 0.3074074074074074, 0.23333333333333334, 0.6037037037037036, 0.08518518518518518]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0259, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8824, 'compress@10': 0.9052, 'time@10': 8.5083}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0259, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8824, 'compress@10': 0.9052, 'time@10': 8.5083}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9122, 'compress@10': 0.6713, 'time@10': 7.7718}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it] {'epoch': 26, 'num_users': 7.0, 'loss': 0.019, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9122, 'compress@10': 0.6713, 'time@10': 7.7718}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8938, 'compress@10': 0.5195, 'time@10': 6.9717}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8938, 'compress@10': 0.5195, 'time@10': 6.9717}:  30%|███       | 3/10 [00:14<00:31,  4.46s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.9085, 'compress@10': 0.5798, 'time@10': 6.7846}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.9085, 'compress@10': 0.5798, 'time@10': 6.7846}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.9034, 'compress@10': 0.6515, 'time@10': 8.1839}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.8487, 'ndcg@10': 0.9034, 'compress@10': 0.6515, 'time@10': 8.1839}:  50%|█████     | 5/10 [00:27<00:29,  5.81s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9146, 'compress@10': 0.645, 'time@10': 8.5258}:  50%|█████     | 5/10 [00:37<00:29,  5.81s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9146, 'compress@10': 0.645, 'time@10': 8.5258}:  60%|██████    | 6/10 [00:37<00:29,  7.32s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9175, 'compress@10': 0.6007, 'time@10': 8.8578}:  60%|██████    | 6/10 [00:43<00:29,  7.32s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9175, 'compress@10': 0.6007, 'time@10': 8.8578}:  70%|███████   | 7/10 [00:43<00:20,  6.72s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.922, 'compress@10': 0.5575, 'time@10': 8.7097}:  70%|███████   | 7/10 [00:50<00:20,  6.72s/it]  {'epoch': 26, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.922, 'compress@10': 0.5575, 'time@10': 8.7097}:  80%|████████  | 8/10 [00:50<00:14,  7.03s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9251, 'compress@10': 0.5639, 'time@10': 9.3369}:  80%|████████  | 8/10 [00:57<00:14,  7.03s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0172, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9251, 'compress@10': 0.5639, 'time@10': 9.3369}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9296, 'compress@10': 0.5181, 'time@10': 9.3412}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]  {'epoch': 26, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9296, 'compress@10': 0.5181, 'time@10': 9.3412}: 100%|██████████| 10/10 [01:07<00:00,  7.81s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9296, 'compress@10': 0.5181, 'time@10': 9.3412}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.015797988108918325
Avg hit ratio: 0.8879357509119818
Avg ndcg: 0.9295577520149868
Avg compression ratio: 0.5181265584659878
Avg train time: 9.341246414184571
Std train time: 2.867073697707871
[0.9035714285714285, 0.40357142857142864, 0.08214285714285714, 0.7249999999999999, 0.9392857142857143, 0.6178571428571427, 0.33214285714285713, 0.26071428571428573, 0.5821428571428571, 0.08214285714285714]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8749, 'compress@10': 0.9086, 'time@10': 8.7468}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8749, 'compress@10': 0.9086, 'time@10': 8.7468}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9106, 'compress@10': 0.6657, 'time@10': 7.962}:  10%|█         | 1/10 [00:11<00:39,  4.41s/it] {'epoch': 27, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9106, 'compress@10': 0.6657, 'time@10': 7.962}:  20%|██        | 2/10 [00:11<00:48,  6.06s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8927, 'compress@10': 0.5149, 'time@10': 7.0555}:  20%|██        | 2/10 [00:14<00:48,  6.06s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8927, 'compress@10': 0.5149, 'time@10': 7.0555}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9067, 'compress@10': 0.5699, 'time@10': 6.8743}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9067, 'compress@10': 0.5699, 'time@10': 6.8743}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.9026, 'compress@10': 0.644, 'time@10': 8.2333}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it] {'epoch': 27, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.9026, 'compress@10': 0.644, 'time@10': 8.2333}:  50%|█████     | 5/10 [00:27<00:29,  5.83s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9122, 'compress@10': 0.6411, 'time@10': 8.5444}:  50%|█████     | 5/10 [00:37<00:29,  5.83s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9122, 'compress@10': 0.6411, 'time@10': 8.5444}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9148, 'compress@10': 0.6007, 'time@10': 8.929}:  60%|██████    | 6/10 [00:43<00:29,  7.29s/it] {'epoch': 27, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9148, 'compress@10': 0.6007, 'time@10': 8.929}:  70%|███████   | 7/10 [00:43<00:20,  6.77s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9197, 'compress@10': 0.5609, 'time@10': 8.7976}:  70%|███████   | 7/10 [00:51<00:20,  6.77s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9197, 'compress@10': 0.5609, 'time@10': 8.7976}:  80%|████████  | 8/10 [00:51<00:14,  7.14s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9241, 'compress@10': 0.5646, 'time@10': 9.3911}:  80%|████████  | 8/10 [00:58<00:14,  7.14s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9241, 'compress@10': 0.5646, 'time@10': 9.3911}:  90%|█████████ | 9/10 [00:58<00:07,  7.13s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9285, 'compress@10': 0.5184, 'time@10': 9.4253}:  90%|█████████ | 9/10 [01:08<00:07,  7.13s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9285, 'compress@10': 0.5184, 'time@10': 9.4253}: 100%|██████████| 10/10 [01:08<00:00,  7.94s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9285, 'compress@10': 0.5184, 'time@10': 9.4253}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.01615314043702567
Avg hit ratio: 0.8829357509119818
Avg ndcg: 0.9285258316281224
Avg compression ratio: 0.5184146810030581
Avg train time: 9.42530653476715
Std train time: 2.811477995210949
[0.9068965517241379, 0.38965517241379316, 0.07931034482758621, 0.7344827586206896, 0.9413793103448276, 0.5965517241379309, 0.32068965517241377, 0.28620689655172415, 0.596551724137931, 0.07931034482758621]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8845, 'compress@10': 0.9118, 'time@10': 8.321}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8845, 'compress@10': 0.9118, 'time@10': 8.321}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9168, 'compress@10': 0.6606, 'time@10': 7.6526}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9168, 'compress@10': 0.6606, 'time@10': 7.6526}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8969, 'compress@10': 0.5107, 'time@10': 6.9574}:  20%|██        | 2/10 [00:14<00:46,  5.86s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8969, 'compress@10': 0.5107, 'time@10': 6.9574}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9098, 'compress@10': 0.569, 'time@10': 6.8319}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9098, 'compress@10': 0.569, 'time@10': 6.8319}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9062, 'compress@10': 0.6437, 'time@10': 8.1794}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9062, 'compress@10': 0.6437, 'time@10': 8.1794}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9161, 'compress@10': 0.6373, 'time@10': 8.5173}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9161, 'compress@10': 0.6373, 'time@10': 8.5173}:  60%|██████    | 6/10 [00:37<00:29,  7.34s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0148, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.919, 'compress@10': 0.596, 'time@10': 8.8362}:  60%|██████    | 6/10 [00:43<00:29,  7.34s/it]  {'epoch': 28, 'num_users': 6.2857, 'loss': 0.0148, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.919, 'compress@10': 0.596, 'time@10': 8.8362}:  70%|███████   | 7/10 [00:43<00:20,  6.71s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0154, 'hit_ratio@10': 0.9205, 'ndcg@10': 0.9235, 'compress@10': 0.5598, 'time@10': 8.7027}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0154, 'hit_ratio@10': 0.9205, 'ndcg@10': 0.9235, 'compress@10': 0.5598, 'time@10': 8.7027}:  80%|████████  | 8/10 [00:50<00:14,  7.07s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9268, 'compress@10': 0.5652, 'time@10': 9.3876}:  80%|████████  | 8/10 [00:58<00:14,  7.07s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9268, 'compress@10': 0.5652, 'time@10': 9.3876}:  90%|█████████ | 9/10 [00:58<00:07,  7.19s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9306, 'compress@10': 0.5187, 'time@10': 9.4199}:  90%|█████████ | 9/10 [01:08<00:07,  7.19s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9306, 'compress@10': 0.5187, 'time@10': 9.4199}: 100%|██████████| 10/10 [01:08<00:00,  7.98s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9306, 'compress@10': 0.5187, 'time@10': 9.4199}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.015382896755849617
Avg hit ratio: 0.908383779585817
Avg ndcg: 0.930610418954888
Avg compression ratio: 0.5186774629784738
Avg train time: 9.41994776725769
Std train time: 2.8785000342186473
[0.9099999999999999, 0.3766666666666667, 0.07666666666666667, 0.71, 0.9433333333333334, 0.5766666666666665, 0.3433333333333333, 0.31, 0.5766666666666667, 0.11]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8771, 'compress@10': 0.9147, 'time@10': 8.2754}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8771, 'compress@10': 0.9147, 'time@10': 8.2754}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9142, 'compress@10': 0.6557, 'time@10': 7.6419}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9142, 'compress@10': 0.6557, 'time@10': 7.6419}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8952, 'compress@10': 0.5067, 'time@10': 6.8757}:  20%|██        | 2/10 [00:13<00:46,  5.87s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8952, 'compress@10': 0.5067, 'time@10': 6.8757}:  30%|███       | 3/10 [00:13<00:30,  4.43s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9104, 'compress@10': 0.5601, 'time@10': 6.7226}:  30%|███       | 3/10 [00:20<00:30,  4.43s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9104, 'compress@10': 0.5601, 'time@10': 6.7226}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9077, 'compress@10': 0.637, 'time@10': 8.098}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it]  {'epoch': 29, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9077, 'compress@10': 0.637, 'time@10': 8.098}:  50%|█████     | 5/10 [00:27<00:28,  5.77s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0158, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9171, 'compress@10': 0.6285, 'time@10': 8.4872}:  50%|█████     | 5/10 [00:37<00:28,  5.77s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0158, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9171, 'compress@10': 0.6285, 'time@10': 8.4872}:  60%|██████    | 6/10 [00:37<00:29,  7.37s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.919, 'compress@10': 0.5915, 'time@10': 8.8261}:  60%|██████    | 6/10 [00:43<00:29,  7.37s/it] {'epoch': 29, 'num_users': 6.2857, 'loss': 0.0156, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.919, 'compress@10': 0.5915, 'time@10': 8.8261}:  70%|███████   | 7/10 [00:43<00:20,  6.75s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.923, 'ndcg@10': 0.9235, 'compress@10': 0.5588, 'time@10': 8.693}:  70%|███████   | 7/10 [00:50<00:20,  6.75s/it]   {'epoch': 29, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.923, 'ndcg@10': 0.9235, 'compress@10': 0.5588, 'time@10': 8.693}:  80%|████████  | 8/10 [00:50<00:14,  7.08s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.927, 'compress@10': 0.5621, 'time@10': 9.2962}:  80%|████████  | 8/10 [00:57<00:14,  7.08s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.927, 'compress@10': 0.5621, 'time@10': 9.2962}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.9313, 'compress@10': 0.5189, 'time@10': 9.318}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.9313, 'compress@10': 0.5189, 'time@10': 9.318}: 100%|██████████| 10/10 [01:07<00:00,  7.85s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.9313, 'compress@10': 0.5189, 'time@10': 9.318}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.015070148919484336
Avg hit ratio: 0.9161354167432266
Avg ndcg: 0.9312743374707214
Avg compression ratio: 0.5189257567675372
Avg train time: 9.318014669418336
Std train time: 2.8113785357544625
[0.9129032258064516, 0.3645161290322581, 0.07419354838709678, 0.6870967741935483, 0.9451612903225807, 0.5903225806451612, 0.36451612903225805, 0.33225806451612905, 0.5580645161290323, 0.1064516129032258]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8867, 'compress@10': 0.9175, 'time@10': 8.3573}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8867, 'compress@10': 0.9175, 'time@10': 8.3573}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9196, 'compress@10': 0.6512, 'time@10': 7.7519}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9196, 'compress@10': 0.6512, 'time@10': 7.7519}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8988, 'compress@10': 0.503, 'time@10': 6.971}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]   {'epoch': 30, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8988, 'compress@10': 0.503, 'time@10': 6.971}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9122, 'compress@10': 0.5518, 'time@10': 6.8253}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9122, 'compress@10': 0.5518, 'time@10': 6.8253}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9097, 'compress@10': 0.6307, 'time@10': 8.1497}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9097, 'compress@10': 0.6307, 'time@10': 8.1497}:  50%|█████     | 5/10 [00:27<00:28,  5.80s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.92, 'compress@10': 0.6255, 'time@10': 8.4744}:  50%|█████     | 5/10 [00:37<00:28,  5.80s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.92, 'compress@10': 0.6255, 'time@10': 8.4744}:  60%|██████    | 6/10 [00:37<00:29,  7.27s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9223, 'compress@10': 0.5918, 'time@10': 8.8457}:  60%|██████    | 6/10 [00:43<00:29,  7.27s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9223, 'compress@10': 0.5918, 'time@10': 8.8457}:  70%|███████   | 7/10 [00:43<00:20,  6.72s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0165, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9264, 'compress@10': 0.5618, 'time@10': 8.7561}:  70%|███████   | 7/10 [00:51<00:20,  6.72s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0165, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9264, 'compress@10': 0.5618, 'time@10': 8.7561}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9317, 'compress@10': 0.5628, 'time@10': 9.3845}:  80%|████████  | 8/10 [00:58<00:14,  7.18s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.017, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9317, 'compress@10': 0.5628, 'time@10': 9.3845}:  90%|█████████ | 9/10 [00:58<00:07,  7.20s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9358, 'compress@10': 0.5192, 'time@10': 9.4256}:  90%|█████████ | 9/10 [01:08<00:07,  7.20s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9358, 'compress@10': 0.5192, 'time@10': 9.4256}: 100%|██████████| 10/10 [01:08<00:00,  8.01s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9358, 'compress@10': 0.5192, 'time@10': 9.4256}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.01577844969575965
Avg hit ratio: 0.8859766865844965
Avg ndcg: 0.9358356844553543
Avg compression ratio: 0.5191598472795333
Avg train time: 9.425636768341064
Std train time: 2.7875984034026664
[0.9156249999999999, 0.353125, 0.07187500000000001, 0.6656249999999999, 0.946875, 0.6031249999999999, 0.35312499999999997, 0.353125, 0.571875, 0.103125]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8771, 'compress@10': 0.9201, 'time@10': 8.1919}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8771, 'compress@10': 0.9201, 'time@10': 8.1919}:  10%|█         | 1/10 [00:04<00:37,  4.13s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9169, 'compress@10': 0.647, 'time@10': 7.5876}:  10%|█         | 1/10 [00:11<00:37,  4.13s/it] {'epoch': 31, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9169, 'compress@10': 0.647, 'time@10': 7.5876}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.897, 'compress@10': 0.4995, 'time@10': 6.8696}:  20%|██        | 2/10 [00:13<00:46,  5.83s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.897, 'compress@10': 0.4995, 'time@10': 6.8696}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9122, 'compress@10': 0.544, 'time@10': 6.7583}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9122, 'compress@10': 0.544, 'time@10': 6.7583}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9117, 'compress@10': 0.6248, 'time@10': 8.0865}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9117, 'compress@10': 0.6248, 'time@10': 8.0865}:  50%|█████     | 5/10 [00:27<00:28,  5.77s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0124, 'hit_ratio@10': 0.885, 'ndcg@10': 0.921, 'compress@10': 0.6227, 'time@10': 8.4644}:  50%|█████     | 5/10 [00:37<00:28,  5.77s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0124, 'hit_ratio@10': 0.885, 'ndcg@10': 0.921, 'compress@10': 0.6227, 'time@10': 8.4644}:  60%|██████    | 6/10 [00:37<00:29,  7.34s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.923, 'compress@10': 0.5878, 'time@10': 8.8616}:  60%|██████    | 6/10 [00:43<00:29,  7.34s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.923, 'compress@10': 0.5878, 'time@10': 8.8616}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.927, 'compress@10': 0.5608, 'time@10': 8.7816}:  70%|███████   | 7/10 [00:51<00:20,  6.79s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.927, 'compress@10': 0.5608, 'time@10': 8.7816}:  80%|████████  | 8/10 [00:51<00:14,  7.26s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9339, 'compress@10': 0.5634, 'time@10': 9.4377}:  80%|████████  | 8/10 [00:58<00:14,  7.26s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9339, 'compress@10': 0.5634, 'time@10': 9.4377}:  90%|█████████ | 9/10 [00:58<00:07,  7.31s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.935, 'compress@10': 0.5194, 'time@10': 9.4581}:  90%|█████████ | 9/10 [01:08<00:07,  7.31s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.935, 'compress@10': 0.5194, 'time@10': 9.4581}: 100%|██████████| 10/10 [01:08<00:00,  8.04s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.935, 'compress@10': 0.5194, 'time@10': 9.4581}: 100%|██████████| 10/10 [01:08<00:00,  6.85s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.015457031477451996
Avg hit ratio: 0.8932782738860837
Avg ndcg: 0.934966507125775
Avg compression ratio: 0.5194165500732973
Avg train time: 9.45811049938202
Std train time: 2.8556676871097726
[0.9181818181818181, 0.34242424242424246, 0.0696969696969697, 0.6454545454545454, 0.9484848484848485, 0.5848484848484847, 0.3424242424242424, 0.37272727272727274, 0.5848484848484848, 0.1303030303030303]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8835, 'compress@10': 0.9225, 'time@10': 8.4793}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8835, 'compress@10': 0.9225, 'time@10': 8.4793}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9188, 'compress@10': 0.6431, 'time@10': 7.6544}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9188, 'compress@10': 0.6431, 'time@10': 7.6544}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8983, 'compress@10': 0.4962, 'time@10': 6.8645}:  20%|██        | 2/10 [00:13<00:46,  5.80s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8983, 'compress@10': 0.4962, 'time@10': 6.8645}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9137, 'compress@10': 0.5367, 'time@10': 6.7228}:  30%|███       | 3/10 [00:20<00:30,  4.38s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9137, 'compress@10': 0.5367, 'time@10': 6.7228}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.9126, 'compress@10': 0.6193, 'time@10': 8.0973}:  40%|████      | 4/10 [00:26<00:30,  5.15s/it] {'epoch': 32, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.9126, 'compress@10': 0.6193, 'time@10': 8.0973}:  50%|█████     | 5/10 [00:26<00:28,  5.76s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0124, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9218, 'compress@10': 0.6151, 'time@10': 8.4732}:  50%|█████     | 5/10 [00:37<00:28,  5.76s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0124, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9218, 'compress@10': 0.6151, 'time@10': 8.4732}:  60%|██████    | 6/10 [00:37<00:29,  7.33s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9246, 'compress@10': 0.5799, 'time@10': 8.8403}:  60%|██████    | 6/10 [00:42<00:29,  7.33s/it] {'epoch': 32, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9246, 'compress@10': 0.5799, 'time@10': 8.8403}:  70%|███████   | 7/10 [00:42<00:20,  6.76s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9295, 'compress@10': 0.5562, 'time@10': 8.7539}:  70%|███████   | 7/10 [00:51<00:20,  6.76s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9295, 'compress@10': 0.5562, 'time@10': 8.7539}:  80%|████████  | 8/10 [00:51<00:14,  7.21s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9307, 'compress@10': 0.5607, 'time@10': 9.362}:  80%|████████  | 8/10 [00:58<00:14,  7.21s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9307, 'compress@10': 0.5607, 'time@10': 9.362}:  90%|█████████ | 9/10 [00:58<00:07,  7.19s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.935, 'compress@10': 0.5197, 'time@10': 9.3734}:  90%|█████████ | 9/10 [01:07<00:07,  7.19s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.935, 'compress@10': 0.5197, 'time@10': 9.3734}: 100%|██████████| 10/10 [01:07<00:00,  7.91s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.935, 'compress@10': 0.5197, 'time@10': 9.3734}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.012612918973284346
Avg hit ratio: 0.8787703373781472
Avg ndcg: 0.9349882695147695
Avg compression ratio: 0.519654202778798
Avg train time: 9.37342290878296
Std train time: 2.830026837067977
[0.9205882352941176, 0.33235294117647063, 0.06764705882352942, 0.6264705882352941, 0.95, 0.5676470588235293, 0.36176470588235293, 0.3911764705882353, 0.5970588235294118, 0.1264705882352941]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8781, 'compress@10': 0.9247, 'time@10': 8.0861}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8781, 'compress@10': 0.9247, 'time@10': 8.0861}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9161, 'compress@10': 0.6393, 'time@10': 7.4162}:  10%|█         | 1/10 [00:10<00:36,  4.08s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9161, 'compress@10': 0.6393, 'time@10': 7.4162}:  20%|██        | 2/10 [00:10<00:45,  5.67s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8965, 'compress@10': 0.4932, 'time@10': 6.7433}:  20%|██        | 2/10 [00:13<00:45,  5.67s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8965, 'compress@10': 0.4932, 'time@10': 6.7433}:  30%|███       | 3/10 [00:13<00:30,  4.33s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9103, 'compress@10': 0.5298, 'time@10': 6.6367}:  30%|███       | 3/10 [00:19<00:30,  4.33s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9103, 'compress@10': 0.5298, 'time@10': 6.6367}:  40%|████      | 4/10 [00:19<00:30,  5.13s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9113, 'compress@10': 0.6141, 'time@10': 7.997}:  40%|████      | 4/10 [00:26<00:30,  5.13s/it]  {'epoch': 33, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9113, 'compress@10': 0.6141, 'time@10': 7.997}:  50%|█████     | 5/10 [00:26<00:28,  5.71s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.9209, 'compress@10': 0.6079, 'time@10': 8.3819}:  50%|█████     | 5/10 [00:37<00:28,  5.71s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.9209, 'compress@10': 0.6079, 'time@10': 8.3819}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.919, 'ndcg@10': 0.9236, 'compress@10': 0.5764, 'time@10': 8.7497}:  60%|██████    | 6/10 [00:42<00:29,  7.29s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.919, 'ndcg@10': 0.9236, 'compress@10': 0.5764, 'time@10': 8.7497}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.9255, 'ndcg@10': 0.9286, 'compress@10': 0.5554, 'time@10': 8.6861}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0139, 'hit_ratio@10': 0.9255, 'ndcg@10': 0.9286, 'compress@10': 0.5554, 'time@10': 8.6861}:  80%|████████  | 8/10 [00:50<00:14,  7.21s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9325, 'compress@10': 0.5613, 'time@10': 9.3518}:  80%|████████  | 8/10 [00:58<00:14,  7.21s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9325, 'compress@10': 0.5613, 'time@10': 9.3518}:  90%|█████████ | 9/10 [00:58<00:07,  7.26s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9181, 'ndcg@10': 0.9367, 'compress@10': 0.5198, 'time@10': 9.3789}:  90%|█████████ | 9/10 [01:07<00:07,  7.26s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9181, 'ndcg@10': 0.9367, 'compress@10': 0.5198, 'time@10': 9.3789}: 100%|██████████| 10/10 [01:07<00:00,  8.00s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.9181, 'ndcg@10': 0.9367, 'compress@10': 0.5198, 'time@10': 9.3789}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.013258542440425616
Avg hit ratio: 0.9181354167432266
Avg ndcg: 0.9367302827791345
Avg compression ratio: 0.5198290820150933
Avg train time: 9.378872060775757
Std train time: 2.8824954910337484
[0.9228571428571428, 0.3228571428571429, 0.06571428571428573, 0.6371428571428571, 0.9514285714285714, 0.5799999999999998, 0.3514285714285714, 0.4085714285714286, 0.58, 0.12285714285714286]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8867, 'compress@10': 0.9269, 'time@10': 8.1712}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8867, 'compress@10': 0.9269, 'time@10': 8.1712}:  10%|█         | 1/10 [00:04<00:37,  4.12s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9269, 'compress@10': 0.6358, 'time@10': 7.5017}:  10%|█         | 1/10 [00:10<00:37,  4.12s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9269, 'compress@10': 0.6358, 'time@10': 7.5017}:  20%|██        | 2/10 [00:10<00:45,  5.74s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9036, 'compress@10': 0.4903, 'time@10': 6.9466}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9036, 'compress@10': 0.4903, 'time@10': 6.9466}:  30%|███       | 3/10 [00:13<00:31,  4.47s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9166, 'compress@10': 0.5302, 'time@10': 6.8041}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9166, 'compress@10': 0.5302, 'time@10': 6.8041}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9172, 'compress@10': 0.6147, 'time@10': 8.1589}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9172, 'compress@10': 0.6147, 'time@10': 8.1589}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9256, 'compress@10': 0.6104, 'time@10': 8.5138}:  50%|█████     | 5/10 [00:37<00:29,  5.82s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9256, 'compress@10': 0.6104, 'time@10': 8.5138}:  60%|██████    | 6/10 [00:37<00:29,  7.35s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9285, 'compress@10': 0.5771, 'time@10': 8.9158}:  60%|██████    | 6/10 [00:43<00:29,  7.35s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9285, 'compress@10': 0.5771, 'time@10': 8.9158}:  70%|███████   | 7/10 [00:43<00:20,  6.81s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9331, 'compress@10': 0.5582, 'time@10': 8.8129}:  70%|███████   | 7/10 [00:51<00:20,  6.81s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9331, 'compress@10': 0.5582, 'time@10': 8.8129}:  80%|████████  | 8/10 [00:51<00:14,  7.23s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9359, 'compress@10': 0.5619, 'time@10': 9.4834}:  80%|████████  | 8/10 [00:58<00:14,  7.23s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9359, 'compress@10': 0.5619, 'time@10': 9.4834}:  90%|█████████ | 9/10 [00:58<00:07,  7.30s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9407, 'compress@10': 0.52, 'time@10': 9.5592}:  90%|█████████ | 9/10 [01:09<00:07,  7.30s/it]     {'epoch': 34, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9407, 'compress@10': 0.52, 'time@10': 9.5592}: 100%|██████████| 10/10 [01:09<00:00,  8.22s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9407, 'compress@10': 0.52, 'time@10': 9.5592}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.015149753208575858
Avg hit ratio: 0.889195324577328
Avg ndcg: 0.9406526019561425
Avg compression ratio: 0.5200238995434721
Avg train time: 9.559173631668092
Std train time: 2.893874152952714
[0.9249999999999999, 0.31388888888888894, 0.0638888888888889, 0.6194444444444445, 0.9527777777777777, 0.5916666666666666, 0.3416666666666667, 0.425, 0.5638888888888889, 0.14722222222222223]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8835, 'compress@10': 0.9289, 'time@10': 8.1848}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8835, 'compress@10': 0.9289, 'time@10': 8.1848}:  10%|█         | 1/10 [00:04<00:37,  4.13s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9256, 'compress@10': 0.6325, 'time@10': 7.4926}:  10%|█         | 1/10 [00:10<00:37,  4.13s/it]  {'epoch': 35, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9256, 'compress@10': 0.6325, 'time@10': 7.4926}:  20%|██        | 2/10 [00:10<00:45,  5.72s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9028, 'compress@10': 0.4875, 'time@10': 6.9741}:  20%|██        | 2/10 [00:13<00:45,  5.72s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9028, 'compress@10': 0.4875, 'time@10': 6.9741}:  30%|███       | 3/10 [00:13<00:31,  4.48s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9171, 'compress@10': 0.5239, 'time@10': 6.8434}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9171, 'compress@10': 0.5239, 'time@10': 6.8434}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9187, 'compress@10': 0.6099, 'time@10': 8.1913}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9187, 'compress@10': 0.6099, 'time@10': 8.1913}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.927, 'compress@10': 0.6083, 'time@10': 8.5946}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.927, 'compress@10': 0.6083, 'time@10': 8.5946}:  60%|██████    | 6/10 [00:37<00:29,  7.47s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9289, 'compress@10': 0.574, 'time@10': 8.9433}:  60%|██████    | 6/10 [00:43<00:29,  7.47s/it] {'epoch': 35, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9289, 'compress@10': 0.574, 'time@10': 8.9433}:  70%|███████   | 7/10 [00:43<00:20,  6.85s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9332, 'compress@10': 0.5574, 'time@10': 8.8674}:  70%|███████   | 7/10 [00:51<00:20,  6.85s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9332, 'compress@10': 0.5574, 'time@10': 8.8674}:  80%|████████  | 8/10 [00:51<00:14,  7.33s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9374, 'compress@10': 0.5595, 'time@10': 9.5848}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9374, 'compress@10': 0.5595, 'time@10': 9.5848}:  90%|█████████ | 9/10 [00:59<00:07,  7.45s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0114, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9412, 'compress@10': 0.5202, 'time@10': 9.6221}:  90%|█████████ | 9/10 [01:09<00:07,  7.45s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0114, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9412, 'compress@10': 0.5202, 'time@10': 9.6221}: 100%|██████████| 10/10 [01:09<00:00,  8.23s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0114, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9412, 'compress@10': 0.5202, 'time@10': 9.6221}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.01135330660693393
Avg hit ratio: 0.8967477809871698
Avg ndcg: 0.9411613539953423
Avg compression ratio: 0.5202446101396399
Avg train time: 9.622130274772644
Std train time: 2.942906790683602
[0.927027027027027, 0.30540540540540545, 0.06216216216216217, 0.6027027027027028, 0.954054054054054, 0.5756756756756756, 0.35945945945945945, 0.44054054054054054, 0.5756756756756757, 0.14324324324324325]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8835, 'compress@10': 0.9309, 'time@10': 8.4398}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8835, 'compress@10': 0.9309, 'time@10': 8.4398}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9213, 'compress@10': 0.6293, 'time@10': 7.8863}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9213, 'compress@10': 0.6293, 'time@10': 7.8863}:  20%|██        | 2/10 [00:11<00:48,  6.09s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8999, 'compress@10': 0.4849, 'time@10': 7.2782}:  20%|██        | 2/10 [00:14<00:48,  6.09s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8999, 'compress@10': 0.4849, 'time@10': 7.2782}:  30%|███       | 3/10 [00:14<00:32,  4.71s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9135, 'compress@10': 0.5179, 'time@10': 7.0178}:  30%|███       | 3/10 [00:20<00:32,  4.71s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9135, 'compress@10': 0.5179, 'time@10': 7.0178}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9157, 'compress@10': 0.6053, 'time@10': 8.3452}:  40%|████      | 4/10 [00:27<00:31,  5.33s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9157, 'compress@10': 0.6053, 'time@10': 8.3452}:  50%|█████     | 5/10 [00:27<00:29,  5.88s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.925, 'compress@10': 0.602, 'time@10': 8.6468}:  50%|█████     | 5/10 [00:38<00:29,  5.88s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.925, 'compress@10': 0.602, 'time@10': 8.6468}:  60%|██████    | 6/10 [00:38<00:29,  7.35s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9279, 'compress@10': 0.571, 'time@10': 9.0141}:  60%|██████    | 6/10 [00:43<00:29,  7.35s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9279, 'compress@10': 0.571, 'time@10': 9.0141}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9326, 'compress@10': 0.5567, 'time@10': 8.908}:  70%|███████   | 7/10 [00:51<00:20,  6.79s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9326, 'compress@10': 0.5567, 'time@10': 8.908}:  80%|████████  | 8/10 [00:51<00:14,  7.24s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9354, 'compress@10': 0.5601, 'time@10': 9.5049}:  80%|████████  | 8/10 [00:59<00:14,  7.24s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9354, 'compress@10': 0.5601, 'time@10': 9.5049}:  90%|█████████ | 9/10 [00:59<00:07,  7.22s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9394, 'compress@10': 0.5204, 'time@10': 9.5255}:  90%|█████████ | 9/10 [01:08<00:07,  7.22s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9394, 'compress@10': 0.5204, 'time@10': 9.5255}: 100%|██████████| 10/10 [01:08<00:00,  8.00s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9394, 'compress@10': 0.5204, 'time@10': 9.5255}: 100%|██████████| 10/10 [01:08<00:00,  6.88s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.011969239471188556
Avg hit ratio: 0.9018271460665348
Avg ndcg: 0.9393634172215487
Avg compression ratio: 0.5203883220638971
Avg train time: 9.525469493865966
Std train time: 2.712937616602151
[0.9289473684210526, 0.2973684210526316, 0.06052631578947369, 0.6131578947368421, 0.9552631578947368, 0.5605263157894735, 0.3763157894736842, 0.4552631578947368, 0.5605263157894737, 0.13947368421052633]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.891, 'compress@10': 0.9327, 'time@10': 7.9959}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.891, 'compress@10': 0.9327, 'time@10': 7.9959}:  10%|█         | 1/10 [00:04<00:36,  4.03s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9285, 'compress@10': 0.6264, 'time@10': 7.367}:  10%|█         | 1/10 [00:10<00:36,  4.03s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9285, 'compress@10': 0.6264, 'time@10': 7.367}:  20%|██        | 2/10 [00:10<00:45,  5.65s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9047, 'compress@10': 0.4825, 'time@10': 6.7427}:  20%|██        | 2/10 [00:13<00:45,  5.65s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9047, 'compress@10': 0.4825, 'time@10': 6.7427}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9198, 'compress@10': 0.5186, 'time@10': 6.6483}:  30%|███       | 3/10 [00:19<00:30,  4.34s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9198, 'compress@10': 0.5186, 'time@10': 6.6483}:  40%|████      | 4/10 [00:19<00:30,  5.15s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9215, 'compress@10': 0.6061, 'time@10': 8.013}:  40%|████      | 4/10 [00:26<00:30,  5.15s/it]  {'epoch': 37, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9215, 'compress@10': 0.6061, 'time@10': 8.013}:  50%|█████     | 5/10 [00:26<00:28,  5.74s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9277, 'compress@10': 0.6001, 'time@10': 8.4305}:  50%|█████     | 5/10 [00:37<00:28,  5.74s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9277, 'compress@10': 0.6001, 'time@10': 8.4305}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9306, 'compress@10': 0.5717, 'time@10': 8.816}:  60%|██████    | 6/10 [00:42<00:29,  7.38s/it] {'epoch': 37, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9306, 'compress@10': 0.5717, 'time@10': 8.816}:  70%|███████   | 7/10 [00:42<00:20,  6.80s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.935, 'compress@10': 0.5591, 'time@10': 8.7343}:  70%|███████   | 7/10 [00:51<00:20,  6.80s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.935, 'compress@10': 0.5591, 'time@10': 8.7343}:  80%|████████  | 8/10 [00:51<00:14,  7.24s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.938, 'compress@10': 0.5607, 'time@10': 9.3883}:  80%|████████  | 8/10 [00:58<00:14,  7.24s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.938, 'compress@10': 0.5607, 'time@10': 9.3883}:  90%|█████████ | 9/10 [00:58<00:07,  7.28s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9394, 'compress@10': 0.5205, 'time@10': 9.4248}:  90%|█████████ | 9/10 [01:08<00:07,  7.28s/it]     {'epoch': 37, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9394, 'compress@10': 0.5205, 'time@10': 9.4248}: 100%|██████████| 10/10 [01:08<00:00,  8.05s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9394, 'compress@10': 0.5205, 'time@10': 9.4248}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.014641539552361235
Avg hit ratio: 0.8999505459641283
Avg ndcg: 0.9394203443696785
Avg compression ratio: 0.5205060010123251
Avg train time: 9.424846363067626
Std train time: 2.8852272313386833
[0.9307692307692308, 0.28974358974358977, 0.05897435897435898, 0.5974358974358974, 0.9564102564102563, 0.5717948717948717, 0.3666666666666667, 0.46923076923076923, 0.5461538461538461, 0.16153846153846155]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8885, 'compress@10': 0.9344, 'time@10': 8.1891}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8885, 'compress@10': 0.9344, 'time@10': 8.1891}:  10%|█         | 1/10 [00:04<00:37,  4.13s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9281, 'compress@10': 0.6235, 'time@10': 7.5691}:  10%|█         | 1/10 [00:11<00:37,  4.13s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9281, 'compress@10': 0.6235, 'time@10': 7.5691}:  20%|██        | 2/10 [00:11<00:46,  5.82s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9045, 'compress@10': 0.4802, 'time@10': 6.9174}:  20%|██        | 2/10 [00:13<00:46,  5.82s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9045, 'compress@10': 0.4802, 'time@10': 6.9174}:  30%|███       | 3/10 [00:13<00:31,  4.46s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9184, 'compress@10': 0.5131, 'time@10': 6.7532}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9184, 'compress@10': 0.5131, 'time@10': 6.7532}:  40%|████      | 4/10 [00:20<00:31,  5.19s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9212, 'compress@10': 0.6019, 'time@10': 8.0908}:  40%|████      | 4/10 [00:27<00:31,  5.19s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9212, 'compress@10': 0.6019, 'time@10': 8.0908}:  50%|█████     | 5/10 [00:27<00:28,  5.75s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9302, 'compress@10': 0.5985, 'time@10': 8.4912}:  50%|█████     | 5/10 [00:37<00:28,  5.75s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9302, 'compress@10': 0.5985, 'time@10': 8.4912}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9324, 'compress@10': 0.569, 'time@10': 8.8874}:  60%|██████    | 6/10 [00:43<00:29,  7.38s/it] {'epoch': 38, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9324, 'compress@10': 0.569, 'time@10': 8.8874}:  70%|███████   | 7/10 [00:43<00:20,  6.82s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9365, 'compress@10': 0.5584, 'time@10': 8.7769}:  70%|███████   | 7/10 [00:51<00:20,  6.82s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9365, 'compress@10': 0.5584, 'time@10': 8.7769}:  80%|████████  | 8/10 [00:51<00:14,  7.21s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9406, 'compress@10': 0.5585, 'time@10': 9.4017}:  80%|████████  | 8/10 [00:58<00:14,  7.21s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9406, 'compress@10': 0.5585, 'time@10': 9.4017}:  90%|█████████ | 9/10 [00:58<00:07,  7.22s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0097, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9441, 'compress@10': 0.5207, 'time@10': 9.4387}:  90%|█████████ | 9/10 [01:08<00:07,  7.22s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0097, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9441, 'compress@10': 0.5207, 'time@10': 9.4387}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0097, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9441, 'compress@10': 0.5207, 'time@10': 9.4387}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.009700800829803213
Avg hit ratio: 0.9018271460665348
Avg ndcg: 0.9441397068795887
Avg compression ratio: 0.5206962054341189
Avg train time: 9.438664150238036
Std train time: 2.8238586165157793
[0.9325, 0.28250000000000003, 0.0575, 0.5825, 0.9574999999999999, 0.5574999999999999, 0.3825, 0.4825, 0.5575, 0.1575]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8853, 'compress@10': 0.936, 'time@10': 7.9987}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8853, 'compress@10': 0.936, 'time@10': 7.9987}:  10%|█         | 1/10 [00:04<00:36,  4.03s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9265, 'compress@10': 0.6208, 'time@10': 7.451}:  10%|█         | 1/10 [00:10<00:36,  4.03s/it] {'epoch': 39, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9265, 'compress@10': 0.6208, 'time@10': 7.451}:  20%|██        | 2/10 [00:10<00:45,  5.74s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9034, 'compress@10': 0.4779, 'time@10': 6.7462}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9034, 'compress@10': 0.4779, 'time@10': 6.7462}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9176, 'compress@10': 0.5078, 'time@10': 6.6447}:  30%|███       | 3/10 [00:20<00:30,  4.35s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9176, 'compress@10': 0.5078, 'time@10': 6.6447}:  40%|████      | 4/10 [00:20<00:30,  5.15s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.9205, 'compress@10': 0.5979, 'time@10': 8.0083}:  40%|████      | 4/10 [00:26<00:30,  5.15s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.9205, 'compress@10': 0.5979, 'time@10': 8.0083}:  50%|█████     | 5/10 [00:26<00:28,  5.73s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.9238, 'ndcg@10': 0.9296, 'compress@10': 0.5928, 'time@10': 8.4188}:  50%|█████     | 5/10 [00:37<00:28,  5.73s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.9238, 'ndcg@10': 0.9296, 'compress@10': 0.5928, 'time@10': 8.4188}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.929, 'ndcg@10': 0.9323, 'compress@10': 0.5663, 'time@10': 8.8292}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it] {'epoch': 39, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.929, 'ndcg@10': 0.9323, 'compress@10': 0.5663, 'time@10': 8.8292}:  70%|███████   | 7/10 [00:43<00:20,  6.81s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.9343, 'ndcg@10': 0.9365, 'compress@10': 0.5577, 'time@10': 8.7599}:  70%|███████   | 7/10 [00:51<00:20,  6.81s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.9343, 'ndcg@10': 0.9365, 'compress@10': 0.5577, 'time@10': 8.7599}:  80%|████████  | 8/10 [00:51<00:14,  7.29s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9394, 'compress@10': 0.5591, 'time@10': 9.3786}:  80%|████████  | 8/10 [00:58<00:14,  7.29s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9394, 'compress@10': 0.5591, 'time@10': 9.3786}:  90%|█████████ | 9/10 [00:58<00:07,  7.26s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9195, 'ndcg@10': 0.9423, 'compress@10': 0.5208, 'time@10': 9.4077}:  90%|█████████ | 9/10 [01:08<00:07,  7.26s/it]  {'epoch': 39, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9195, 'ndcg@10': 0.9423, 'compress@10': 0.5208, 'time@10': 9.4077}: 100%|██████████| 10/10 [01:08<00:00,  8.01s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9195, 'ndcg@10': 0.9423, 'compress@10': 0.5208, 'time@10': 9.4077}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.011107660789919805
Avg hit ratio: 0.9194620667014555
Avg ndcg: 0.9423309409364288
Avg compression ratio: 0.5208172922945107
Avg train time: 9.407728242874146
Std train time: 2.8447475517898657
[0.9341463414634146, 0.275609756097561, 0.05609756097560976, 0.5926829268292683, 0.9585365853658536, 0.5439024390243902, 0.37317073170731707, 0.4951219512195122, 0.5439024390243903, 0.17804878048780487]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8975, 'compress@10': 0.9376, 'time@10': 8.135}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0165, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8975, 'compress@10': 0.9376, 'time@10': 8.135}:  10%|█         | 1/10 [00:04<00:36,  4.10s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9321, 'compress@10': 0.6183, 'time@10': 7.4571}:  10%|█         | 1/10 [00:10<00:36,  4.10s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9321, 'compress@10': 0.6183, 'time@10': 7.4571}:  20%|██        | 2/10 [00:10<00:45,  5.70s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9071, 'compress@10': 0.4758, 'time@10': 6.9076}:  20%|██        | 2/10 [00:13<00:45,  5.70s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9071, 'compress@10': 0.4758, 'time@10': 6.9076}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9198, 'compress@10': 0.5087, 'time@10': 6.7706}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9198, 'compress@10': 0.5087, 'time@10': 6.7706}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9231, 'compress@10': 0.5988, 'time@10': 8.086}:  40%|████      | 4/10 [00:26<00:31,  5.21s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9231, 'compress@10': 0.5988, 'time@10': 8.086}:  50%|█████     | 5/10 [00:26<00:28,  5.76s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0121, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9341, 'compress@10': 0.5914, 'time@10': 8.4796}:  50%|█████     | 5/10 [00:37<00:28,  5.76s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0121, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9341, 'compress@10': 0.5914, 'time@10': 8.4796}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0121, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9362, 'compress@10': 0.5638, 'time@10': 8.8853}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0121, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9362, 'compress@10': 0.5638, 'time@10': 8.8853}:  70%|███████   | 7/10 [00:43<00:20,  6.82s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9205, 'ndcg@10': 0.9399, 'compress@10': 0.557, 'time@10': 8.7953}:  70%|███████   | 7/10 [00:51<00:20,  6.82s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9205, 'ndcg@10': 0.9399, 'compress@10': 0.557, 'time@10': 8.7953}:  80%|████████  | 8/10 [00:51<00:14,  7.26s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9481, 'compress@10': 0.557, 'time@10': 9.3913}:  80%|████████  | 8/10 [00:58<00:14,  7.26s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9481, 'compress@10': 0.557, 'time@10': 9.3913}:  90%|█████████ | 9/10 [00:58<00:07,  7.22s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9519, 'compress@10': 0.521, 'time@10': 9.4245}:  90%|█████████ | 9/10 [01:08<00:07,  7.22s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9519, 'compress@10': 0.521, 'time@10': 9.4245}: 100%|██████████| 10/10 [01:08<00:00,  8.00s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9519, 'compress@10': 0.521, 'time@10': 9.4245}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.013860473196101055
Avg hit ratio: 0.911259301724497
Avg ndcg: 0.9519347081773677
Avg compression ratio: 0.5209586256965123
Avg train time: 9.424491381645202
Std train time: 2.7432626479414557
[0.9357142857142856, 0.2690476190476191, 0.05476190476190476, 0.5785714285714285, 0.9357142857142857, 0.5547619047619047, 0.36428571428571427, 0.5071428571428571, 0.5547619047619048, 0.1976190476190476]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9045, 'compress@10': 0.9391, 'time@10': 8.2433}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9045, 'compress@10': 0.9391, 'time@10': 8.2433}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9383, 'compress@10': 0.6159, 'time@10': 7.5132}:  10%|█         | 1/10 [00:10<00:37,  4.16s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9383, 'compress@10': 0.6159, 'time@10': 7.5132}:  20%|██        | 2/10 [00:10<00:45,  5.72s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9112, 'compress@10': 0.4738, 'time@10': 6.838}:  20%|██        | 2/10 [00:13<00:45,  5.72s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9112, 'compress@10': 0.4738, 'time@10': 6.838}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9234, 'compress@10': 0.5038, 'time@10': 6.7101}:  30%|███       | 3/10 [00:20<00:30,  4.38s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9234, 'compress@10': 0.5038, 'time@10': 6.7101}:  40%|████      | 4/10 [00:20<00:30,  5.16s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9264, 'compress@10': 0.5904, 'time@10': 8.0576}:  40%|████      | 4/10 [00:26<00:30,  5.16s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9264, 'compress@10': 0.5904, 'time@10': 8.0576}:  50%|█████     | 5/10 [00:26<00:28,  5.74s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9345, 'compress@10': 0.5861, 'time@10': 8.4721}:  50%|█████     | 5/10 [00:37<00:28,  5.74s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9345, 'compress@10': 0.5861, 'time@10': 8.4721}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9365, 'compress@10': 0.5581, 'time@10': 8.884}:  60%|██████    | 6/10 [00:43<00:29,  7.38s/it] {'epoch': 41, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9365, 'compress@10': 0.5581, 'time@10': 8.884}:  70%|███████   | 7/10 [00:43<00:20,  6.84s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9401, 'compress@10': 0.5535, 'time@10': 8.7744}:  70%|███████   | 7/10 [00:51<00:20,  6.84s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9401, 'compress@10': 0.5535, 'time@10': 8.7744}:  80%|████████  | 8/10 [00:51<00:14,  7.22s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9527, 'compress@10': 0.555, 'time@10': 9.3796}:  80%|████████  | 8/10 [00:58<00:14,  7.22s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9527, 'compress@10': 0.555, 'time@10': 9.3796}:  90%|█████████ | 9/10 [00:58<00:07,  7.20s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9551, 'compress@10': 0.5211, 'time@10': 9.415}:  90%|█████████ | 9/10 [01:08<00:07,  7.20s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9551, 'compress@10': 0.5211, 'time@10': 9.415}: 100%|██████████| 10/10 [01:08<00:00,  7.99s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9551, 'compress@10': 0.5211, 'time@10': 9.415}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.012183023333221524
Avg hit ratio: 0.9025414317808205
Avg ndcg: 0.9551365954880154
Avg compression ratio: 0.5211048432959509
Avg train time: 9.415020322799682
Std train time: 2.823871628506329
[0.9372093023255813, 0.26279069767441865, 0.053488372093023255, 0.5883720930232558, 0.9372093023255814, 0.5418604651162789, 0.3558139534883721, 0.5186046511627906, 0.5651162790697675, 0.1930232558139535]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9017, 'compress@10': 0.9405, 'time@10': 8.5893}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9017, 'compress@10': 0.9405, 'time@10': 8.5893}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9347, 'compress@10': 0.6135, 'time@10': 7.9037}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it] {'epoch': 42, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9347, 'compress@10': 0.6135, 'time@10': 7.9037}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9089, 'compress@10': 0.4719, 'time@10': 7.1257}:  20%|██        | 2/10 [00:14<00:48,  6.05s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9089, 'compress@10': 0.4719, 'time@10': 7.1257}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9222, 'compress@10': 0.5047, 'time@10': 6.9588}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9222, 'compress@10': 0.5047, 'time@10': 6.9588}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9254, 'compress@10': 0.5915, 'time@10': 8.2483}:  40%|████      | 4/10 [00:27<00:31,  5.33s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9254, 'compress@10': 0.5915, 'time@10': 8.2483}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9332, 'compress@10': 0.5849, 'time@10': 8.6066}:  50%|█████     | 5/10 [00:38<00:29,  5.84s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9332, 'compress@10': 0.5849, 'time@10': 8.6066}:  60%|██████    | 6/10 [00:38<00:29,  7.40s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9354, 'compress@10': 0.5558, 'time@10': 8.9376}:  60%|██████    | 6/10 [00:43<00:29,  7.40s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9354, 'compress@10': 0.5558, 'time@10': 8.9376}:  70%|███████   | 7/10 [00:43<00:20,  6.78s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9192, 'ndcg@10': 0.9392, 'compress@10': 0.5529, 'time@10': 8.8214}:  70%|███████   | 7/10 [00:51<00:20,  6.78s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9192, 'ndcg@10': 0.9392, 'compress@10': 0.5529, 'time@10': 8.8214}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9584, 'compress@10': 0.5556, 'time@10': 9.4486}:  80%|████████  | 8/10 [00:58<00:14,  7.18s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9584, 'compress@10': 0.5556, 'time@10': 9.4486}:  90%|█████████ | 9/10 [00:58<00:07,  7.21s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9607, 'compress@10': 0.5212, 'time@10': 9.4753}:  90%|█████████ | 9/10 [01:08<00:07,  7.21s/it]  {'epoch': 42, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9607, 'compress@10': 0.5212, 'time@10': 9.4753}: 100%|██████████| 10/10 [01:08<00:00,  7.99s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.9131, 'ndcg@10': 0.9607, 'compress@10': 0.5212, 'time@10': 9.4753}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.014238154753125482
Avg hit ratio: 0.9131128603522491
Avg ndcg: 0.9607411020326884
Avg compression ratio: 0.5212190088962197
Avg train time: 9.475269222259522
Std train time: 2.752452060927692
[0.9386363636363636, 0.25681818181818183, 0.05227272727272727, 0.575, 0.9386363636363637, 0.5295454545454544, 0.3477272727272727, 0.5295454545454545, 0.5750000000000001, 0.21136363636363636]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9045, 'compress@10': 0.9419, 'time@10': 8.2725}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9045, 'compress@10': 0.9419, 'time@10': 8.2725}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9361, 'compress@10': 0.6113, 'time@10': 7.4814}:  10%|█         | 1/10 [00:10<00:37,  4.17s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9361, 'compress@10': 0.6113, 'time@10': 7.4814}:  20%|██        | 2/10 [00:10<00:45,  5.67s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9098, 'compress@10': 0.4701, 'time@10': 6.9202}:  20%|██        | 2/10 [00:13<00:45,  5.67s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9098, 'compress@10': 0.4701, 'time@10': 6.9202}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9229, 'compress@10': 0.5001, 'time@10': 6.8428}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9229, 'compress@10': 0.5001, 'time@10': 6.8428}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9261, 'compress@10': 0.5881, 'time@10': 8.2057}:  40%|████      | 4/10 [00:27<00:31,  5.30s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9261, 'compress@10': 0.5881, 'time@10': 8.2057}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9349, 'compress@10': 0.5801, 'time@10': 8.5893}:  50%|█████     | 5/10 [00:37<00:29,  5.87s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9349, 'compress@10': 0.5801, 'time@10': 8.5893}:  60%|██████    | 6/10 [00:37<00:29,  7.46s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9371, 'compress@10': 0.5506, 'time@10': 8.932}:  60%|██████    | 6/10 [00:43<00:29,  7.46s/it] {'epoch': 43, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9371, 'compress@10': 0.5506, 'time@10': 8.932}:  70%|███████   | 7/10 [00:43<00:20,  6.83s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0097, 'hit_ratio@10': 0.9245, 'ndcg@10': 0.9406, 'compress@10': 0.5496, 'time@10': 8.833}:  70%|███████   | 7/10 [00:51<00:20,  6.83s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0097, 'hit_ratio@10': 0.9245, 'ndcg@10': 0.9406, 'compress@10': 0.5496, 'time@10': 8.833}:  80%|████████  | 8/10 [00:51<00:14,  7.26s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9421, 'compress@10': 0.5538, 'time@10': 9.4969}:  80%|████████  | 8/10 [00:59<00:14,  7.26s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9421, 'compress@10': 0.5538, 'time@10': 9.4969}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9441, 'compress@10': 0.5214, 'time@10': 9.5148}:  90%|█████████ | 9/10 [01:08<00:07,  7.31s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9441, 'compress@10': 0.5214, 'time@10': 9.5148}: 100%|██████████| 10/10 [01:08<00:00,  8.05s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9441, 'compress@10': 0.5214, 'time@10': 9.5148}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.011233419586343009
Avg hit ratio: 0.9116279653189668
Avg ndcg: 0.9441016856821495
Avg compression ratio: 0.5213574915427797
Avg train time: 9.514830780029296
Std train time: 2.863955880174331
[0.94, 0.2511111111111111, 0.05111111111111111, 0.5622222222222222, 0.9177777777777778, 0.5399999999999999, 0.33999999999999997, 0.54, 0.5844444444444445, 0.2288888888888889]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9045, 'compress@10': 0.9431, 'time@10': 8.3154}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9045, 'compress@10': 0.9431, 'time@10': 8.3154}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9361, 'compress@10': 0.6092, 'time@10': 7.6008}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it] {'epoch': 44, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9361, 'compress@10': 0.6092, 'time@10': 7.6008}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9098, 'compress@10': 0.4684, 'time@10': 6.8989}:  20%|██        | 2/10 [00:13<00:46,  5.80s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9098, 'compress@10': 0.4684, 'time@10': 6.8989}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9229, 'compress@10': 0.4957, 'time@10': 6.7465}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9229, 'compress@10': 0.4957, 'time@10': 6.7465}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9264, 'compress@10': 0.5805, 'time@10': 8.173}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9264, 'compress@10': 0.5805, 'time@10': 8.173}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9357, 'compress@10': 0.5754, 'time@10': 8.5845}:  50%|█████     | 5/10 [00:37<00:29,  5.82s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9357, 'compress@10': 0.5754, 'time@10': 8.5845}:  60%|██████    | 6/10 [00:37<00:29,  7.47s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9379, 'compress@10': 0.5456, 'time@10': 8.9435}:  60%|██████    | 6/10 [00:43<00:29,  7.47s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9379, 'compress@10': 0.5456, 'time@10': 8.9435}:  70%|███████   | 7/10 [00:43<00:20,  6.86s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9416, 'compress@10': 0.5465, 'time@10': 8.834}:  70%|███████   | 7/10 [00:51<00:20,  6.86s/it]     {'epoch': 44, 'num_users': 6.125, 'loss': 0.01, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9416, 'compress@10': 0.5465, 'time@10': 8.834}:  80%|████████  | 8/10 [00:51<00:14,  7.25s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9435, 'compress@10': 0.552, 'time@10': 9.4283}:  80%|████████  | 8/10 [00:58<00:14,  7.25s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9435, 'compress@10': 0.552, 'time@10': 9.4283}:  90%|█████████ | 9/10 [00:58<00:07,  7.21s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9469, 'compress@10': 0.5215, 'time@10': 9.4735}:  90%|█████████ | 9/10 [01:08<00:07,  7.21s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9469, 'compress@10': 0.5215, 'time@10': 9.4735}: 100%|██████████| 10/10 [01:08<00:00,  8.05s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9469, 'compress@10': 0.5215, 'time@10': 9.4735}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.009171315992477658
Avg hit ratio: 0.9016049238443127
Avg ndcg: 0.9468861343453904
Avg compression ratio: 0.5214845878733887
Avg train time: 9.473504853248595
Std train time: 2.8589010884573036
[0.9413043478260869, 0.24565217391304348, 0.049999999999999996, 0.5717391304347825, 0.9195652173913044, 0.5499999999999999, 0.3326086956521739, 0.55, 0.5717391304347827, 0.22391304347826088]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9066, 'compress@10': 0.9444, 'time@10': 8.2681}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9066, 'compress@10': 0.9444, 'time@10': 8.2681}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.938, 'compress@10': 0.6072, 'time@10': 7.5416}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.938, 'compress@10': 0.6072, 'time@10': 7.5416}:  20%|██        | 2/10 [00:11<00:46,  5.76s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9111, 'compress@10': 0.4667, 'time@10': 6.8589}:  20%|██        | 2/10 [00:13<00:46,  5.76s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9111, 'compress@10': 0.4667, 'time@10': 6.8589}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9239, 'compress@10': 0.4968, 'time@10': 6.7154}:  30%|███       | 3/10 [00:20<00:30,  4.40s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9239, 'compress@10': 0.4968, 'time@10': 6.7154}:  40%|████      | 4/10 [00:20<00:30,  5.16s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9282, 'compress@10': 0.5817, 'time@10': 8.1422}:  40%|████      | 4/10 [00:27<00:30,  5.16s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9282, 'compress@10': 0.5817, 'time@10': 8.1422}:  50%|█████     | 5/10 [00:27<00:29,  5.81s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9361, 'compress@10': 0.578, 'time@10': 8.5078}:  50%|█████     | 5/10 [00:37<00:29,  5.81s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9361, 'compress@10': 0.578, 'time@10': 8.5078}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9387, 'compress@10': 0.5468, 'time@10': 8.8496}:  60%|██████    | 6/10 [00:42<00:29,  7.36s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.9132, 'ndcg@10': 0.9387, 'compress@10': 0.5468, 'time@10': 8.8496}:  70%|███████   | 7/10 [00:42<00:20,  6.75s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0097, 'hit_ratio@10': 0.9205, 'ndcg@10': 0.9423, 'compress@10': 0.5488, 'time@10': 8.7426}:  70%|███████   | 7/10 [00:50<00:20,  6.75s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0097, 'hit_ratio@10': 0.9205, 'ndcg@10': 0.9423, 'compress@10': 0.5488, 'time@10': 8.7426}:  80%|████████  | 8/10 [00:50<00:14,  7.16s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9449, 'compress@10': 0.5527, 'time@10': 9.4271}:  80%|████████  | 8/10 [00:58<00:14,  7.16s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9449, 'compress@10': 0.5527, 'time@10': 9.4271}:  90%|█████████ | 9/10 [00:58<00:07,  7.26s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9466, 'compress@10': 0.5216, 'time@10': 9.4754}:  90%|█████████ | 9/10 [01:08<00:07,  7.26s/it]    {'epoch': 45, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9466, 'compress@10': 0.5216, 'time@10': 9.4754}: 100%|██████████| 10/10 [01:08<00:00,  8.09s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9466, 'compress@10': 0.5216, 'time@10': 9.4754}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.00997701698660874
Avg hit ratio: 0.911259301724497
Avg ndcg: 0.9465610419595425
Avg compression ratio: 0.5215970584402423
Avg train time: 9.475446152687073
Std train time: 2.971898137550969
[0.9425531914893616, 0.2404255319148936, 0.04893617021276595, 0.5808510638297871, 0.9212765957446809, 0.5382978723404255, 0.325531914893617, 0.5595744680851065, 0.5595744680851065, 0.24042553191489363]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9066, 'compress@10': 0.9456, 'time@10': 7.9402}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9066, 'compress@10': 0.9456, 'time@10': 7.9402}:  10%|█         | 1/10 [00:04<00:36,  4.00s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9393, 'compress@10': 0.6053, 'time@10': 7.3788}:  10%|█         | 1/10 [00:10<00:36,  4.00s/it]  {'epoch': 46, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9393, 'compress@10': 0.6053, 'time@10': 7.3788}:  20%|██        | 2/10 [00:10<00:45,  5.68s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9119, 'compress@10': 0.4651, 'time@10': 6.5621}:  20%|██        | 2/10 [00:13<00:45,  5.68s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9119, 'compress@10': 0.4651, 'time@10': 6.5621}:  30%|███       | 3/10 [00:13<00:29,  4.23s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.925, 'compress@10': 0.4978, 'time@10': 6.503}:  30%|███       | 3/10 [00:19<00:29,  4.23s/it]  {'epoch': 46, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.925, 'compress@10': 0.4978, 'time@10': 6.503}:  40%|████      | 4/10 [00:19<00:30,  5.07s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0084, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9297, 'compress@10': 0.5828, 'time@10': 8.0102}:  40%|████      | 4/10 [00:26<00:30,  5.07s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0084, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.9297, 'compress@10': 0.5828, 'time@10': 8.0102}:  50%|█████     | 5/10 [00:26<00:28,  5.79s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9373, 'compress@10': 0.5771, 'time@10': 8.3968}:  50%|█████     | 5/10 [00:37<00:28,  5.79s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9373, 'compress@10': 0.5771, 'time@10': 8.3968}:  60%|██████    | 6/10 [00:37<00:29,  7.34s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9396, 'compress@10': 0.545, 'time@10': 8.7973}:  60%|██████    | 6/10 [00:42<00:29,  7.34s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9396, 'compress@10': 0.545, 'time@10': 8.7973}:  70%|███████   | 7/10 [00:42<00:20,  6.79s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9431, 'compress@10': 0.5484, 'time@10': 8.7084}:  70%|███████   | 7/10 [00:50<00:20,  6.79s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.9165, 'ndcg@10': 0.9431, 'compress@10': 0.5484, 'time@10': 8.7084}:  80%|████████  | 8/10 [00:50<00:14,  7.21s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0085, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9456, 'compress@10': 0.551, 'time@10': 9.317}:  80%|████████  | 8/10 [00:58<00:14,  7.21s/it] {'epoch': 46, 'num_users': 6.3333, 'loss': 0.0085, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9456, 'compress@10': 0.551, 'time@10': 9.317}:  90%|█████████ | 9/10 [00:58<00:07,  7.18s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9488, 'compress@10': 0.5217, 'time@10': 9.3417}:  90%|█████████ | 9/10 [01:07<00:07,  7.18s/it] {'epoch': 46, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9488, 'compress@10': 0.5217, 'time@10': 9.3417}: 100%|██████████| 10/10 [01:07<00:00,  7.93s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9488, 'compress@10': 0.5217, 'time@10': 9.3417}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.008267485619975989
Avg hit ratio: 0.9051763524157412
Avg ndcg: 0.9487819899734843
Avg compression ratio: 0.5217035685916278
Avg train time: 9.341707801818847
Std train time: 2.9748104233511516
[0.9437499999999999, 0.23541666666666666, 0.04791666666666666, 0.5895833333333332, 0.9229166666666667, 0.5270833333333332, 0.3395833333333333, 0.5687500000000001, 0.5479166666666667, 0.2354166666666667]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9066, 'compress@10': 0.9467, 'time@10': 8.2208}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9066, 'compress@10': 0.9467, 'time@10': 8.2208}:  10%|█         | 1/10 [00:04<00:37,  4.14s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9372, 'compress@10': 0.6034, 'time@10': 7.5136}:  10%|█         | 1/10 [00:11<00:37,  4.14s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9372, 'compress@10': 0.6034, 'time@10': 7.5136}:  20%|██        | 2/10 [00:11<00:45,  5.74s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9105, 'compress@10': 0.4636, 'time@10': 6.9478}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9105, 'compress@10': 0.4636, 'time@10': 6.9478}:  30%|███       | 3/10 [00:13<00:31,  4.46s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.918, 'ndcg@10': 0.924, 'compress@10': 0.4987, 'time@10': 6.7682}:  30%|███       | 3/10 [00:20<00:31,  4.46s/it]  {'epoch': 47, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.918, 'ndcg@10': 0.924, 'compress@10': 0.4987, 'time@10': 6.7682}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0072, 'hit_ratio@10': 0.9304, 'ndcg@10': 0.9288, 'compress@10': 0.5839, 'time@10': 8.1435}:  40%|████      | 4/10 [00:27<00:31,  5.18s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0072, 'hit_ratio@10': 0.9304, 'ndcg@10': 0.9288, 'compress@10': 0.5839, 'time@10': 8.1435}:  50%|█████     | 5/10 [00:27<00:28,  5.78s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.9346, 'ndcg@10': 0.94, 'compress@10': 0.5762, 'time@10': 8.4426}:  50%|█████     | 5/10 [00:37<00:28,  5.78s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.9346, 'ndcg@10': 0.94, 'compress@10': 0.5762, 'time@10': 8.4426}:  60%|██████    | 6/10 [00:37<00:28,  7.21s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.9382, 'ndcg@10': 0.942, 'compress@10': 0.5461, 'time@10': 8.7329}:  60%|██████    | 6/10 [00:42<00:28,  7.21s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.9382, 'ndcg@10': 0.942, 'compress@10': 0.5461, 'time@10': 8.7329}:  70%|███████   | 7/10 [00:42<00:19,  6.57s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.9424, 'ndcg@10': 0.9451, 'compress@10': 0.5505, 'time@10': 8.6216}:  70%|███████   | 7/10 [00:50<00:19,  6.57s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.9424, 'ndcg@10': 0.9451, 'compress@10': 0.5505, 'time@10': 8.6216}:  80%|████████  | 8/10 [00:50<00:13,  6.99s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0091, 'hit_ratio@10': 0.917, 'ndcg@10': 0.9475, 'compress@10': 0.5517, 'time@10': 9.1914}:  80%|████████  | 8/10 [00:57<00:13,  6.99s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0091, 'hit_ratio@10': 0.917, 'ndcg@10': 0.9475, 'compress@10': 0.5517, 'time@10': 9.1914}:  90%|█████████ | 9/10 [00:57<00:06,  6.96s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0085, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9505, 'compress@10': 0.5218, 'time@10': 9.195}:  90%|█████████ | 9/10 [01:06<00:06,  6.96s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0085, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9505, 'compress@10': 0.5218, 'time@10': 9.195}: 100%|██████████| 10/10 [01:06<00:00,  7.67s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0085, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9505, 'compress@10': 0.5218, 'time@10': 9.195}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.008530388605210708
Avg hit ratio: 0.9230565367475384
Avg ndcg: 0.9504550310492617
Avg compression ratio: 0.5217680029740726
Avg train time: 9.194993472099304
Std train time: 2.672587935882381
[0.9448979591836734, 0.23061224489795917, 0.046938775510204075, 0.5979591836734693, 0.9244897959183674, 0.5367346938775509, 0.33265306122448973, 0.5775510204081633, 0.536734693877551, 0.2306122448979592]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9084, 'compress@10': 0.9478, 'time@10': 7.9123}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9084, 'compress@10': 0.9478, 'time@10': 7.9123}:  10%|█         | 1/10 [00:03<00:35,  3.99s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9381, 'compress@10': 0.6016, 'time@10': 7.1366}:  10%|█         | 1/10 [00:10<00:35,  3.99s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9381, 'compress@10': 0.6016, 'time@10': 7.1366}:  20%|██        | 2/10 [00:10<00:43,  5.41s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9111, 'compress@10': 0.4621, 'time@10': 6.4876}:  20%|██        | 2/10 [00:13<00:43,  5.41s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9111, 'compress@10': 0.4621, 'time@10': 6.4876}:  30%|███       | 3/10 [00:13<00:28,  4.14s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9244, 'compress@10': 0.4997, 'time@10': 6.3794}:  30%|███       | 3/10 [00:19<00:28,  4.14s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9244, 'compress@10': 0.4997, 'time@10': 6.3794}:  40%|████      | 4/10 [00:19<00:29,  4.91s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.007, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9297, 'compress@10': 0.5849, 'time@10': 7.6719}:  40%|████      | 4/10 [00:25<00:29,  4.91s/it]  {'epoch': 48, 'num_users': 5.8, 'loss': 0.007, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9297, 'compress@10': 0.5849, 'time@10': 7.6719}:  50%|█████     | 5/10 [00:25<00:27,  5.47s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.006, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9373, 'compress@10': 0.5786, 'time@10': 8.0192}:  50%|█████     | 5/10 [00:35<00:27,  5.47s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.006, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9373, 'compress@10': 0.5786, 'time@10': 8.0192}:  60%|██████    | 6/10 [00:35<00:27,  6.94s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0067, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9396, 'compress@10': 0.5473, 'time@10': 8.4188}:  60%|██████    | 6/10 [00:40<00:27,  6.94s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0067, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9396, 'compress@10': 0.5473, 'time@10': 8.4188}:  70%|███████   | 7/10 [00:40<00:19,  6.45s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.9303, 'ndcg@10': 0.9431, 'compress@10': 0.5526, 'time@10': 8.3024}:  70%|███████   | 7/10 [00:48<00:19,  6.45s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.9303, 'ndcg@10': 0.9431, 'compress@10': 0.5526, 'time@10': 8.3024}:  80%|████████  | 8/10 [00:48<00:13,  6.79s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0074, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.946, 'compress@10': 0.5523, 'time@10': 8.876}:  80%|████████  | 8/10 [00:55<00:13,  6.79s/it] {'epoch': 48, 'num_users': 6.3333, 'loss': 0.0074, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.946, 'compress@10': 0.5523, 'time@10': 8.876}:  90%|█████████ | 9/10 [00:55<00:06,  6.78s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9473, 'compress@10': 0.5219, 'time@10': 8.8951}:  90%|█████████ | 9/10 [01:04<00:06,  6.78s/it] {'epoch': 48, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9473, 'compress@10': 0.5219, 'time@10': 8.8951}: 100%|██████████| 10/10 [01:04<00:00,  7.50s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9473, 'compress@10': 0.5219, 'time@10': 8.8951}: 100%|██████████| 10/10 [01:04<00:00,  6.42s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.009558922419970976
Avg hit ratio: 0.9162362602498426
Avg ndcg: 0.9472507182708305
Avg compression ratio: 0.5218677347767844
Avg train time: 8.895068979263305
Std train time: 2.684874771019677
[0.946, 0.22599999999999998, 0.04599999999999999, 0.586, 0.926, 0.5259999999999999, 0.3459999999999999, 0.5860000000000001, 0.526, 0.24600000000000002]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9109, 'compress@10': 0.9488, 'time@10': 7.677}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9109, 'compress@10': 0.9488, 'time@10': 7.677}:  10%|█         | 1/10 [00:03<00:34,  3.87s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9393, 'compress@10': 0.5999, 'time@10': 7.1008}:  10%|█         | 1/10 [00:10<00:34,  3.87s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9393, 'compress@10': 0.5999, 'time@10': 7.1008}:  20%|██        | 2/10 [00:10<00:43,  5.45s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9119, 'compress@10': 0.4607, 'time@10': 6.3878}:  20%|██        | 2/10 [00:12<00:43,  5.45s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9119, 'compress@10': 0.4607, 'time@10': 6.3878}:  30%|███       | 3/10 [00:12<00:28,  4.11s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.925, 'compress@10': 0.4957, 'time@10': 6.2778}:  30%|███       | 3/10 [00:18<00:28,  4.11s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.925, 'compress@10': 0.4957, 'time@10': 6.2778}:  40%|████      | 4/10 [00:18<00:29,  4.85s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0071, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.9313, 'compress@10': 0.5821, 'time@10': 7.5695}:  40%|████      | 4/10 [00:25<00:29,  4.85s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0071, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.9313, 'compress@10': 0.5821, 'time@10': 7.5695}:  50%|█████     | 5/10 [00:25<00:27,  5.41s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.9238, 'ndcg@10': 0.9389, 'compress@10': 0.5745, 'time@10': 7.8947}:  50%|█████     | 5/10 [00:34<00:27,  5.41s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.9238, 'ndcg@10': 0.9389, 'compress@10': 0.5745, 'time@10': 7.8947}:  60%|██████    | 6/10 [00:34<00:27,  6.82s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.929, 'ndcg@10': 0.941, 'compress@10': 0.5456, 'time@10': 8.2506}:  60%|██████    | 6/10 [00:40<00:27,  6.82s/it]  {'epoch': 49, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.929, 'ndcg@10': 0.941, 'compress@10': 0.5456, 'time@10': 8.2506}:  70%|███████   | 7/10 [00:40<00:18,  6.30s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.9343, 'ndcg@10': 0.9443, 'compress@10': 0.5521, 'time@10': 8.1611}:  70%|███████   | 7/10 [00:47<00:18,  6.30s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.9343, 'ndcg@10': 0.9443, 'compress@10': 0.5521, 'time@10': 8.1611}:  80%|████████  | 8/10 [00:47<00:13,  6.70s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0088, 'hit_ratio@10': 0.9194, 'ndcg@10': 0.9475, 'compress@10': 0.5507, 'time@10': 8.7472}:  80%|████████  | 8/10 [00:54<00:13,  6.70s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0088, 'hit_ratio@10': 0.9194, 'ndcg@10': 0.9475, 'compress@10': 0.5507, 'time@10': 8.7472}:  90%|█████████ | 9/10 [00:54<00:06,  6.72s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.008, 'hit_ratio@10': 0.9252, 'ndcg@10': 0.9504, 'compress@10': 0.522, 'time@10': 8.7329}:  90%|█████████ | 9/10 [01:03<00:06,  6.72s/it]     {'epoch': 49, 'num_users': 6.3, 'loss': 0.008, 'hit_ratio@10': 0.9252, 'ndcg@10': 0.9504, 'compress@10': 0.522, 'time@10': 8.7329}: 100%|██████████| 10/10 [01:03<00:00,  7.31s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.008, 'hit_ratio@10': 0.9252, 'ndcg@10': 0.9504, 'compress@10': 0.522, 'time@10': 8.7329}: 100%|██████████| 10/10 [01:03<00:00,  6.31s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.00799343083970797
Avg hit ratio: 0.9251763524157413
Avg ndcg: 0.9504447340769149
Avg compression ratio: 0.5219521196843687
Avg train time: 8.732898664474487
Std train time: 2.6630150080627155
[0.9470588235294117, 0.22156862745098038, 0.04509803921568627, 0.5941176470588235, 0.907843137254902, 0.5352941176470587, 0.3392156862745097, 0.5941176470588236, 0.5352941176470588, 0.24117647058823533]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
