  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.155, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5063, 'compress@10': 0.7158, 'time@10': 9.6718}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.155, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5063, 'compress@10': 0.7158, 'time@10': 9.6718}:  10%|█         | 1/10 [00:04<00:43,  4.88s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1143, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.6444, 'compress@10': 0.7127, 'time@10': 8.2749}:  10%|█         | 1/10 [00:11<00:43,  4.88s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1143, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.6444, 'compress@10': 0.7127, 'time@10': 8.2749}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7934, 'hit_ratio@10': 0.5463, 'ndcg@10': 0.4296, 'compress@10': 0.7228, 'time@10': 6.4348}:  20%|██        | 2/10 [00:13<00:48,  6.08s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7934, 'hit_ratio@10': 0.5463, 'ndcg@10': 0.4296, 'compress@10': 0.7228, 'time@10': 6.4348}:  30%|███       | 3/10 [00:13<00:27,  3.95s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6196, 'hit_ratio@10': 0.6151, 'ndcg@10': 0.485, 'compress@10': 0.7197, 'time@10': 6.3802}:  30%|███       | 3/10 [00:19<00:27,  3.95s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.6196, 'hit_ratio@10': 0.6151, 'ndcg@10': 0.485, 'compress@10': 0.7197, 'time@10': 6.3802}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5143, 'hit_ratio@10': 0.6561, 'ndcg@10': 0.5383, 'compress@10': 0.717, 'time@10': 9.7157}:  40%|████      | 4/10 [00:31<00:29,  4.86s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5143, 'hit_ratio@10': 0.6561, 'ndcg@10': 0.5383, 'compress@10': 0.717, 'time@10': 9.7157}:  50%|█████     | 5/10 [00:31<00:36,  7.28s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.443, 'hit_ratio@10': 0.6689, 'ndcg@10': 0.5794, 'compress@10': 0.7153, 'time@10': 9.8244}:  50%|█████     | 5/10 [00:41<00:36,  7.28s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.443, 'hit_ratio@10': 0.6689, 'ndcg@10': 0.5794, 'compress@10': 0.7153, 'time@10': 9.8244}:  60%|██████    | 6/10 [00:41<00:33,  8.34s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.395, 'hit_ratio@10': 0.6934, 'ndcg@10': 0.5813, 'compress@10': 0.7148, 'time@10': 10.1492}:  60%|██████    | 6/10 [00:47<00:33,  8.34s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.395, 'hit_ratio@10': 0.6934, 'ndcg@10': 0.5813, 'compress@10': 0.7148, 'time@10': 10.1492}:  70%|███████   | 7/10 [00:47<00:22,  7.61s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3517, 'hit_ratio@10': 0.721, 'ndcg@10': 0.6077, 'compress@10': 0.714, 'time@10': 9.8524}:  70%|███████   | 7/10 [00:55<00:22,  7.61s/it]   {'epoch': 0, 'num_users': 6.125, 'loss': 0.3517, 'hit_ratio@10': 0.721, 'ndcg@10': 0.6077, 'compress@10': 0.714, 'time@10': 9.8524}:  80%|████████  | 8/10 [00:55<00:15,  7.67s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.318, 'hit_ratio@10': 0.7234, 'ndcg@10': 0.641, 'compress@10': 0.7134, 'time@10': 10.5686}:  80%|████████  | 8/10 [01:03<00:15,  7.67s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.318, 'hit_ratio@10': 0.7234, 'ndcg@10': 0.641, 'compress@10': 0.7134, 'time@10': 10.5686}:  90%|█████████ | 9/10 [01:03<00:07,  7.83s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2916, 'hit_ratio@10': 0.7443, 'ndcg@10': 0.661, 'compress@10': 0.7128, 'time@10': 10.491}:  90%|█████████ | 9/10 [01:13<00:07,  7.83s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2916, 'hit_ratio@10': 0.7443, 'ndcg@10': 0.661, 'compress@10': 0.7128, 'time@10': 10.491}: 100%|██████████| 10/10 [01:13<00:00,  8.45s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2916, 'hit_ratio@10': 0.7443, 'ndcg@10': 0.661, 'compress@10': 0.7128, 'time@10': 10.491}: 100%|██████████| 10/10 [01:13<00:00,  7.34s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.29156993719664903
Avg hit ratio: 0.7442578146245379
Avg ndcg: 0.6610402427306195
Avg compression ratio: 0.7127562825218969
Avg train time: 10.490973639488221
Std train time: 5.421734960548317
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0527, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8324, 'compress@10': 0.7158, 'time@10': 8.4534}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0527, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8324, 'compress@10': 0.7158, 'time@10': 8.4534}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0529, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8434, 'compress@10': 0.7127, 'time@10': 7.7848}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0529, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8434, 'compress@10': 0.7127, 'time@10': 7.7848}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0415, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.82, 'compress@10': 0.7228, 'time@10': 6.3221}:  20%|██        | 2/10 [00:13<00:47,  5.96s/it]  {'epoch': 1, 'num_users': 5.0, 'loss': 0.0415, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.82, 'compress@10': 0.7228, 'time@10': 6.3221}:  30%|███       | 3/10 [00:13<00:28,  4.03s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0435, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8257, 'compress@10': 0.7197, 'time@10': 6.3892}:  30%|███       | 3/10 [00:19<00:28,  4.03s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0435, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8257, 'compress@10': 0.7197, 'time@10': 6.3892}:  40%|████      | 4/10 [00:19<00:30,  5.06s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0523, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8172, 'compress@10': 0.717, 'time@10': 9.2423}:  40%|████      | 4/10 [00:30<00:30,  5.06s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.0523, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8172, 'compress@10': 0.717, 'time@10': 9.2423}:  50%|█████     | 5/10 [00:30<00:34,  6.97s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0565, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8158, 'compress@10': 0.7153, 'time@10': 9.4412}:  50%|█████     | 5/10 [00:40<00:34,  6.97s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0565, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8158, 'compress@10': 0.7153, 'time@10': 9.4412}:  60%|██████    | 6/10 [00:40<00:32,  8.16s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0546, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.823, 'compress@10': 0.7148, 'time@10': 9.6818}:  60%|██████    | 6/10 [00:46<00:32,  8.16s/it] {'epoch': 1, 'num_users': 6.2857, 'loss': 0.0546, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.823, 'compress@10': 0.7148, 'time@10': 9.6818}:  70%|███████   | 7/10 [00:46<00:21,  7.33s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0524, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8289, 'compress@10': 0.714, 'time@10': 9.4541}:  70%|███████   | 7/10 [00:54<00:21,  7.33s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0524, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8289, 'compress@10': 0.714, 'time@10': 9.4541}:  80%|████████  | 8/10 [00:54<00:15,  7.51s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0506, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8383, 'compress@10': 0.7134, 'time@10': 10.1537}:  80%|████████  | 8/10 [01:02<00:15,  7.51s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0506, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8383, 'compress@10': 0.7134, 'time@10': 10.1537}:  90%|█████████ | 9/10 [01:02<00:07,  7.64s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0502, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8391, 'compress@10': 0.7128, 'time@10': 10.1163}:  90%|█████████ | 9/10 [01:11<00:07,  7.64s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0502, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8391, 'compress@10': 0.7128, 'time@10': 10.1163}: 100%|██████████| 10/10 [01:11<00:00,  8.31s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0502, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8391, 'compress@10': 0.7128, 'time@10': 10.1163}: 100%|██████████| 10/10 [01:11<00:00,  7.19s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05017534426082835
Avg hit ratio: 0.8286755255685646
Avg ndcg: 0.839097518209688
Avg compression ratio: 0.7127562746540839
Avg train time: 10.116271734237671
Std train time: 4.6741837064797815
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 12, 10, 8, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.7158, 'time@10': 8.1647}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.7158, 'time@10': 8.1647}:  10%|█         | 1/10 [00:04<00:37,  4.12s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8497, 'compress@10': 0.7127, 'time@10': 7.636}:  10%|█         | 1/10 [00:11<00:37,  4.12s/it]  {'epoch': 2, 'num_users': 7.0, 'loss': 0.0497, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8497, 'compress@10': 0.7127, 'time@10': 7.636}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8522, 'compress@10': 0.7228, 'time@10': 6.1679}:  20%|██        | 2/10 [00:12<00:47,  5.90s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8522, 'compress@10': 0.7228, 'time@10': 6.1679}:  30%|███       | 3/10 [00:12<00:27,  3.96s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8516, 'compress@10': 0.7197, 'time@10': 6.1416}:  30%|███       | 3/10 [00:19<00:27,  3.96s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8516, 'compress@10': 0.7197, 'time@10': 6.1416}:  40%|████      | 4/10 [00:19<00:28,  4.81s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.772, 'ndcg@10': 0.8391, 'compress@10': 0.717, 'time@10': 8.6918}:  40%|████      | 4/10 [00:28<00:28,  4.81s/it]  {'epoch': 2, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.772, 'ndcg@10': 0.8391, 'compress@10': 0.717, 'time@10': 8.6918}:  50%|█████     | 5/10 [00:28<00:32,  6.49s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.052, 'hit_ratio@10': 0.7693, 'ndcg@10': 0.8355, 'compress@10': 0.7153, 'time@10': 9.0137}:  50%|█████     | 5/10 [00:39<00:32,  6.49s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.052, 'hit_ratio@10': 0.7693, 'ndcg@10': 0.8355, 'compress@10': 0.7153, 'time@10': 9.0137}:  60%|██████    | 6/10 [00:39<00:31,  7.91s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0506, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.8374, 'compress@10': 0.7148, 'time@10': 9.2882}:  60%|██████    | 6/10 [00:44<00:31,  7.91s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0506, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.8374, 'compress@10': 0.7148, 'time@10': 9.2882}:  70%|███████   | 7/10 [00:44<00:21,  7.13s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0497, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8429, 'compress@10': 0.714, 'time@10': 9.1293}:  70%|███████   | 7/10 [00:52<00:21,  7.13s/it]  {'epoch': 2, 'num_users': 6.125, 'loss': 0.0497, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8429, 'compress@10': 0.714, 'time@10': 9.1293}:  80%|████████  | 8/10 [00:52<00:14,  7.42s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.8531, 'compress@10': 0.7134, 'time@10': 9.5472}:  80%|████████  | 8/10 [00:59<00:14,  7.42s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.8531, 'compress@10': 0.7134, 'time@10': 9.5472}:  90%|█████████ | 9/10 [00:59<00:07,  7.13s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8136, 'ndcg@10': 0.8526, 'compress@10': 0.7128, 'time@10': 9.6213}:  90%|█████████ | 9/10 [01:09<00:07,  7.13s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8136, 'ndcg@10': 0.8526, 'compress@10': 0.7128, 'time@10': 9.6213}: 100%|██████████| 10/10 [01:09<00:00,  8.12s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0481, 'hit_ratio@10': 0.8136, 'ndcg@10': 0.8526, 'compress@10': 0.7128, 'time@10': 9.6213}: 100%|██████████| 10/10 [01:09<00:00,  6.95s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04813194779947293
Avg hit ratio: 0.8136156177344633
Avg ndcg: 0.8526439106430475
Avg compression ratio: 0.7127562770723295
Avg train time: 9.621286249160766
Std train time: 4.053661004964784
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 13, 10, 7, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.7158, 'time@10': 8.5777}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.7158, 'time@10': 8.5777}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.798, 'ndcg@10': 0.851, 'compress@10': 0.7127, 'time@10': 7.8896}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it] {'epoch': 3, 'num_users': 7.0, 'loss': 0.0485, 'hit_ratio@10': 0.798, 'ndcg@10': 0.851, 'compress@10': 0.7127, 'time@10': 7.8896}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8531, 'compress@10': 0.7228, 'time@10': 6.4672}:  20%|██        | 2/10 [00:13<00:48,  6.04s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8531, 'compress@10': 0.7228, 'time@10': 6.4672}:  30%|███       | 3/10 [00:13<00:28,  4.13s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8517, 'compress@10': 0.7197, 'time@10': 6.4242}:  30%|███       | 3/10 [00:19<00:28,  4.13s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8517, 'compress@10': 0.7197, 'time@10': 6.4242}:  40%|████      | 4/10 [00:19<00:29,  5.00s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0461, 'hit_ratio@10': 0.772, 'ndcg@10': 0.8387, 'compress@10': 0.717, 'time@10': 8.4281}:  40%|████      | 4/10 [00:28<00:29,  5.00s/it]  {'epoch': 3, 'num_users': 5.8, 'loss': 0.0461, 'hit_ratio@10': 0.772, 'ndcg@10': 0.8387, 'compress@10': 0.717, 'time@10': 8.4281}:  50%|█████     | 5/10 [00:28<00:30,  6.17s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0503, 'hit_ratio@10': 0.7693, 'ndcg@10': 0.8364, 'compress@10': 0.7153, 'time@10': 8.8615}:  50%|█████     | 5/10 [00:39<00:30,  6.17s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0503, 'hit_ratio@10': 0.7693, 'ndcg@10': 0.8364, 'compress@10': 0.7153, 'time@10': 8.8615}:  60%|██████    | 6/10 [00:39<00:31,  7.84s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.8375, 'compress@10': 0.7148, 'time@10': 9.2404}:  60%|██████    | 6/10 [00:44<00:31,  7.84s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.8375, 'compress@10': 0.7148, 'time@10': 9.2404}:  70%|███████   | 7/10 [00:44<00:21,  7.17s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8458, 'compress@10': 0.714, 'time@10': 9.0857}:  70%|███████   | 7/10 [00:52<00:21,  7.17s/it]  {'epoch': 3, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8458, 'compress@10': 0.714, 'time@10': 9.0857}:  80%|████████  | 8/10 [00:52<00:14,  7.45s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.8068, 'ndcg@10': 0.8533, 'compress@10': 0.7134, 'time@10': 9.4959}:  80%|████████  | 8/10 [00:59<00:14,  7.45s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.8068, 'ndcg@10': 0.8533, 'compress@10': 0.7134, 'time@10': 9.4959}:  90%|█████████ | 9/10 [00:59<00:07,  7.13s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8523, 'compress@10': 0.7128, 'time@10': 9.5454}:  90%|█████████ | 9/10 [01:09<00:07,  7.13s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8523, 'compress@10': 0.7128, 'time@10': 9.5454}: 100%|██████████| 10/10 [01:09<00:00,  8.02s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8523, 'compress@10': 0.7128, 'time@10': 9.5454}: 100%|██████████| 10/10 [01:09<00:00,  6.94s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.049352409535417495
Avg hit ratio: 0.819329903448749
Avg ndcg: 0.8523113755766459
Avg compression ratio: 0.7127562589780622
Avg train time: 9.54537410736084
Std train time: 3.4462743994924883
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 14, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0464, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.7158, 'time@10': 8.4938}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0464, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.7158, 'time@10': 8.4938}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8565, 'compress@10': 0.7127, 'time@10': 8.0436}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8565, 'compress@10': 0.7127, 'time@10': 8.0436}:  20%|██        | 2/10 [00:11<00:50,  6.25s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8567, 'compress@10': 0.7228, 'time@10': 6.6438}:  20%|██        | 2/10 [00:13<00:50,  6.25s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8567, 'compress@10': 0.7228, 'time@10': 6.6438}:  30%|███       | 3/10 [00:13<00:30,  4.29s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8545, 'compress@10': 0.7197, 'time@10': 6.5686}:  30%|███       | 3/10 [00:20<00:30,  4.29s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8545, 'compress@10': 0.7197, 'time@10': 6.5686}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.045, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8404, 'compress@10': 0.717, 'time@10': 8.0846}:  40%|████      | 4/10 [00:27<00:30,  5.12s/it]  {'epoch': 4, 'num_users': 5.8, 'loss': 0.045, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8404, 'compress@10': 0.717, 'time@10': 8.0846}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0488, 'hit_ratio@10': 0.7924, 'ndcg@10': 0.8379, 'compress@10': 0.7153, 'time@10': 8.4698}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0488, 'hit_ratio@10': 0.7924, 'ndcg@10': 0.8379, 'compress@10': 0.7153, 'time@10': 8.4698}:  60%|██████    | 6/10 [00:37<00:29,  7.40s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0492, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8347, 'compress@10': 0.7148, 'time@10': 8.9027}:  60%|██████    | 6/10 [00:43<00:29,  7.40s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0492, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8347, 'compress@10': 0.7148, 'time@10': 8.9027}:  70%|███████   | 7/10 [00:43<00:20,  6.88s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8503, 'compress@10': 0.714, 'time@10': 8.8008}:  70%|███████   | 7/10 [00:51<00:20,  6.88s/it]   {'epoch': 4, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8503, 'compress@10': 0.714, 'time@10': 8.8008}:  80%|████████  | 8/10 [00:51<00:14,  7.28s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0497, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8594, 'compress@10': 0.7134, 'time@10': 9.3131}:  80%|████████  | 8/10 [00:58<00:14,  7.28s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0497, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8594, 'compress@10': 0.7134, 'time@10': 9.3131}:  90%|█████████ | 9/10 [00:58<00:07,  7.11s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8579, 'compress@10': 0.7128, 'time@10': 9.3962}:  90%|█████████ | 9/10 [01:08<00:07,  7.11s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8579, 'compress@10': 0.7128, 'time@10': 9.3962}: 100%|██████████| 10/10 [01:08<00:00,  8.06s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8579, 'compress@10': 0.7128, 'time@10': 9.3962}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04945636719753854
Avg hit ratio: 0.8360795194241714
Avg ndcg: 0.8579218505635741
Avg compression ratio: 0.7127562657900217
Avg train time: 9.396247339248657
Std train time: 3.0102615255044967
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 15, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.7158, 'time@10': 8.6878}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 0.7158, 'time@10': 8.6878}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8627, 'compress@10': 0.7127, 'time@10': 7.9155}:  10%|█         | 1/10 [00:11<00:39,  4.38s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8627, 'compress@10': 0.7127, 'time@10': 7.9155}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8609, 'compress@10': 0.7228, 'time@10': 6.6892}:  20%|██        | 2/10 [00:13<00:48,  6.03s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8609, 'compress@10': 0.7228, 'time@10': 6.6892}:  30%|███       | 3/10 [00:13<00:29,  4.26s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.858, 'compress@10': 0.7197, 'time@10': 6.6114}:  30%|███       | 3/10 [00:20<00:29,  4.26s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.858, 'compress@10': 0.7197, 'time@10': 6.6114}:  40%|████      | 4/10 [00:20<00:30,  5.11s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0445, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8433, 'compress@10': 0.717, 'time@10': 8.2592}:  40%|████      | 4/10 [00:27<00:30,  5.11s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0445, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8433, 'compress@10': 0.717, 'time@10': 8.2592}:  50%|█████     | 5/10 [00:27<00:29,  5.96s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0477, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8409, 'compress@10': 0.7153, 'time@10': 8.6445}:  50%|█████     | 5/10 [00:38<00:29,  5.96s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0477, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8409, 'compress@10': 0.7153, 'time@10': 8.6445}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0476, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8404, 'compress@10': 0.7148, 'time@10': 9.0309}:  60%|██████    | 6/10 [00:43<00:30,  7.54s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0476, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8404, 'compress@10': 0.7148, 'time@10': 9.0309}:  70%|███████   | 7/10 [00:43<00:20,  6.94s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0492, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8502, 'compress@10': 0.714, 'time@10': 8.9122}:  70%|███████   | 7/10 [00:52<00:20,  6.94s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.0492, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8502, 'compress@10': 0.714, 'time@10': 8.9122}:  80%|████████  | 8/10 [00:52<00:14,  7.32s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0478, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8589, 'compress@10': 0.7134, 'time@10': 9.3574}:  80%|████████  | 8/10 [00:58<00:14,  7.32s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0478, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8589, 'compress@10': 0.7134, 'time@10': 9.3574}:  90%|█████████ | 9/10 [00:58<00:07,  7.06s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0473, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8579, 'compress@10': 0.7128, 'time@10': 9.4545}:  90%|█████████ | 9/10 [01:08<00:07,  7.06s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0473, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8579, 'compress@10': 0.7128, 'time@10': 9.4545}: 100%|██████████| 10/10 [01:08<00:00,  8.08s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0473, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8579, 'compress@10': 0.7128, 'time@10': 9.4545}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04727807990293838
Avg hit ratio: 0.8561588845035365
Avg ndcg: 0.8578941253389978
Avg compression ratio: 0.7127562757099376
Avg train time: 9.45450563430786
Std train time: 3.0202631569987073
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 16, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.7158, 'time@10': 8.6144}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.7158, 'time@10': 8.6144}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8561, 'compress@10': 0.7127, 'time@10': 7.8567}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8561, 'compress@10': 0.7127, 'time@10': 7.8567}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8564, 'compress@10': 0.7228, 'time@10': 6.7656}:  20%|██        | 2/10 [00:13<00:47,  5.98s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8564, 'compress@10': 0.7228, 'time@10': 6.7656}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8564, 'compress@10': 0.7197, 'time@10': 6.6671}:  30%|███       | 3/10 [00:20<00:30,  4.32s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8564, 'compress@10': 0.7197, 'time@10': 6.6671}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0443, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8411, 'compress@10': 0.717, 'time@10': 8.11}:  40%|████      | 4/10 [00:27<00:30,  5.14s/it]   {'epoch': 6, 'num_users': 5.8, 'loss': 0.0443, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8411, 'compress@10': 0.717, 'time@10': 8.11}:  50%|█████     | 5/10 [00:27<00:29,  5.81s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0467, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8392, 'compress@10': 0.7153, 'time@10': 8.4985}:  50%|█████     | 5/10 [00:37<00:29,  5.81s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0467, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8392, 'compress@10': 0.7153, 'time@10': 8.4985}:  60%|██████    | 6/10 [00:37<00:29,  7.39s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0473, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8465, 'compress@10': 0.7148, 'time@10': 8.9351}:  60%|██████    | 6/10 [00:43<00:29,  7.39s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.0473, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8465, 'compress@10': 0.7148, 'time@10': 8.9351}:  70%|███████   | 7/10 [00:43<00:20,  6.88s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.048, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8583, 'compress@10': 0.714, 'time@10': 8.8183}:  70%|███████   | 7/10 [00:51<00:20,  6.88s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.048, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8583, 'compress@10': 0.714, 'time@10': 8.8183}:  80%|████████  | 8/10 [00:51<00:14,  7.25s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0466, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8676, 'compress@10': 0.7134, 'time@10': 9.2853}:  80%|████████  | 8/10 [00:58<00:14,  7.25s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0466, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8676, 'compress@10': 0.7134, 'time@10': 9.2853}:  90%|█████████ | 9/10 [00:58<00:07,  7.03s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0457, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8691, 'compress@10': 0.7128, 'time@10': 9.3611}:  90%|█████████ | 9/10 [01:08<00:07,  7.03s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0457, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8691, 'compress@10': 0.7128, 'time@10': 9.3611}: 100%|██████████| 10/10 [01:08<00:00,  7.97s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0457, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8691, 'compress@10': 0.7128, 'time@10': 9.3611}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.045655319519370255
Avg hit ratio: 0.8548002753707337
Avg ndcg: 0.8691277010442588
Avg compression ratio: 0.7127562782833444
Avg train time: 9.361124539375306
Std train time: 2.820811694963875
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 17, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.7158, 'time@10': 8.474}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.7158, 'time@10': 8.474}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8544, 'compress@10': 0.7127, 'time@10': 7.7663}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8544, 'compress@10': 0.7127, 'time@10': 7.7663}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8553, 'compress@10': 0.7228, 'time@10': 6.8689}:  20%|██        | 2/10 [00:13<00:47,  5.93s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8553, 'compress@10': 0.7228, 'time@10': 6.8689}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8319, 'compress@10': 0.7197, 'time@10': 6.7306}:  30%|███       | 3/10 [00:20<00:30,  4.40s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8319, 'compress@10': 0.7197, 'time@10': 6.7306}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0451, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8229, 'compress@10': 0.717, 'time@10': 8.2112}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0451, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8229, 'compress@10': 0.717, 'time@10': 8.2112}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0471, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8252, 'compress@10': 0.7153, 'time@10': 8.5697}:  50%|█████     | 5/10 [00:37<00:29,  5.87s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0471, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8252, 'compress@10': 0.7153, 'time@10': 8.5697}:  60%|██████    | 6/10 [00:37<00:29,  7.41s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0466, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8268, 'compress@10': 0.7148, 'time@10': 8.9709}:  60%|██████    | 6/10 [00:43<00:29,  7.41s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0466, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8268, 'compress@10': 0.7148, 'time@10': 8.9709}:  70%|███████   | 7/10 [00:43<00:20,  6.86s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0467, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8345, 'compress@10': 0.714, 'time@10': 8.8525}:  70%|███████   | 7/10 [00:51<00:20,  6.86s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.0467, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8345, 'compress@10': 0.714, 'time@10': 8.8525}:  80%|████████  | 8/10 [00:51<00:14,  7.24s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0459, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8452, 'compress@10': 0.7134, 'time@10': 9.3207}:  80%|████████  | 8/10 [00:58<00:14,  7.24s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0459, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8452, 'compress@10': 0.7134, 'time@10': 9.3207}:  90%|█████████ | 9/10 [00:58<00:07,  7.03s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0459, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8466, 'compress@10': 0.7128, 'time@10': 9.3903}:  90%|█████████ | 9/10 [01:08<00:07,  7.03s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0459, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8466, 'compress@10': 0.7128, 'time@10': 9.3903}: 100%|██████████| 10/10 [01:08<00:00,  7.96s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0459, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8466, 'compress@10': 0.7128, 'time@10': 9.3903}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.045859066493008735
Avg hit ratio: 0.8641588845035365
Avg ndcg: 0.8466207300584963
Avg compression ratio: 0.7127562617866221
Avg train time: 9.390308904647828
Std train time: 2.7842279836460246
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 18, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.7158, 'time@10': 8.3445}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 0.7158, 'time@10': 8.3445}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0416, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.86, 'compress@10': 0.7127, 'time@10': 7.7222}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it]  {'epoch': 8, 'num_users': 7.0, 'loss': 0.0416, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.86, 'compress@10': 0.7127, 'time@10': 7.7222}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.859, 'compress@10': 0.7228, 'time@10': 6.8691}:  20%|██        | 2/10 [00:13<00:47,  5.93s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.859, 'compress@10': 0.7228, 'time@10': 6.8691}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8597, 'compress@10': 0.7197, 'time@10': 6.738}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8597, 'compress@10': 0.7197, 'time@10': 6.738}:  40%|████      | 4/10 [00:20<00:31,  5.19s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8455, 'compress@10': 0.717, 'time@10': 8.2917}:  40%|████      | 4/10 [00:27<00:31,  5.19s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8455, 'compress@10': 0.717, 'time@10': 8.2917}:  50%|█████     | 5/10 [00:27<00:29,  5.95s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.043, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8459, 'compress@10': 0.7153, 'time@10': 8.6593}:  50%|█████     | 5/10 [00:38<00:29,  5.95s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.043, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8459, 'compress@10': 0.7153, 'time@10': 8.6593}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0426, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8495, 'compress@10': 0.7148, 'time@10': 9.0562}:  60%|██████    | 6/10 [00:43<00:30,  7.51s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0426, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8495, 'compress@10': 0.7148, 'time@10': 9.0562}:  70%|███████   | 7/10 [00:43<00:20,  6.94s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.043, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8555, 'compress@10': 0.714, 'time@10': 8.9204}:  70%|███████   | 7/10 [00:51<00:20,  6.94s/it]   {'epoch': 8, 'num_users': 6.125, 'loss': 0.043, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8555, 'compress@10': 0.714, 'time@10': 8.9204}:  80%|████████  | 8/10 [00:51<00:14,  7.28s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0429, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.863, 'compress@10': 0.7134, 'time@10': 9.3699}:  80%|████████  | 8/10 [00:58<00:14,  7.28s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0429, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.863, 'compress@10': 0.7134, 'time@10': 9.3699}:  90%|█████████ | 9/10 [00:58<00:07,  7.04s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0413, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8658, 'compress@10': 0.7128, 'time@10': 9.4807}:  90%|█████████ | 9/10 [01:08<00:07,  7.04s/it]  {'epoch': 8, 'num_users': 6.3, 'loss': 0.0413, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8658, 'compress@10': 0.7128, 'time@10': 9.4807}: 100%|██████████| 10/10 [01:08<00:00,  8.12s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0413, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.8658, 'compress@10': 0.7128, 'time@10': 9.4807}: 100%|██████████| 10/10 [01:08<00:00,  6.90s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.041320087963976154
Avg hit ratio: 0.8729395482842002
Avg ndcg: 0.8657811246445037
Avg compression ratio: 0.7127562825218969
Avg train time: 9.480744314193725
Std train time: 2.8456984185265393
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8536, 'compress@10': 0.7158, 'time@10': 8.4487}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8536, 'compress@10': 0.7158, 'time@10': 8.4487}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.041, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8564, 'compress@10': 0.7127, 'time@10': 7.8159}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it] {'epoch': 9, 'num_users': 7.0, 'loss': 0.041, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8564, 'compress@10': 0.7127, 'time@10': 7.8159}:  20%|██        | 2/10 [00:11<00:48,  6.00s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8566, 'compress@10': 0.7228, 'time@10': 7.0501}:  20%|██        | 2/10 [00:14<00:48,  6.00s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8566, 'compress@10': 0.7228, 'time@10': 7.0501}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8578, 'compress@10': 0.7197, 'time@10': 6.8912}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8578, 'compress@10': 0.7197, 'time@10': 6.8912}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0409, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.845, 'compress@10': 0.717, 'time@10': 8.2903}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]  {'epoch': 9, 'num_users': 5.8, 'loss': 0.0409, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.845, 'compress@10': 0.717, 'time@10': 8.2903}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0419, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8463, 'compress@10': 0.7153, 'time@10': 8.6711}:  50%|█████     | 5/10 [00:38<00:29,  5.90s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0419, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8463, 'compress@10': 0.7153, 'time@10': 8.6711}:  60%|██████    | 6/10 [00:38<00:30,  7.52s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0411, 'hit_ratio@10': 0.869, 'ndcg@10': 0.8466, 'compress@10': 0.7148, 'time@10': 9.0727}:  60%|██████    | 6/10 [00:44<00:30,  7.52s/it] {'epoch': 9, 'num_users': 6.2857, 'loss': 0.0411, 'hit_ratio@10': 0.869, 'ndcg@10': 0.8466, 'compress@10': 0.7148, 'time@10': 9.0727}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0415, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8537, 'compress@10': 0.714, 'time@10': 8.9276}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0415, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8537, 'compress@10': 0.714, 'time@10': 8.9276}:  80%|████████  | 8/10 [00:52<00:14,  7.27s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0411, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8612, 'compress@10': 0.7134, 'time@10': 9.3497}:  80%|████████  | 8/10 [00:58<00:14,  7.27s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0411, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8612, 'compress@10': 0.7134, 'time@10': 9.3497}:  90%|█████████ | 9/10 [00:58<00:06,  7.00s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8635, 'compress@10': 0.7128, 'time@10': 9.4267}:  90%|█████████ | 9/10 [01:08<00:06,  7.00s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8635, 'compress@10': 0.7128, 'time@10': 9.4267}: 100%|██████████| 10/10 [01:08<00:00,  7.98s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8635, 'compress@10': 0.7128, 'time@10': 9.4267}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.040221816829065886
Avg hit ratio: 0.8723046276492795
Avg ndcg: 0.8635298888409807
Avg compression ratio: 0.7127562757099376
Avg train time: 9.426675748825073
Std train time: 2.6350700589841405
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8536, 'compress@10': 0.7158, 'time@10': 8.4271}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8536, 'compress@10': 0.7158, 'time@10': 8.4271}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8602, 'compress@10': 0.7127, 'time@10': 7.8009}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8602, 'compress@10': 0.7127, 'time@10': 7.8009}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8592, 'compress@10': 0.7228, 'time@10': 6.9968}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8592, 'compress@10': 0.7228, 'time@10': 6.9968}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8615, 'compress@10': 0.7197, 'time@10': 6.8656}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8615, 'compress@10': 0.7197, 'time@10': 6.8656}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.848, 'compress@10': 0.717, 'time@10': 8.2923}:  40%|████      | 4/10 [00:27<00:31,  5.30s/it]  {'epoch': 10, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.848, 'compress@10': 0.717, 'time@10': 8.2923}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0401, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8497, 'compress@10': 0.7153, 'time@10': 8.6434}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0401, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8497, 'compress@10': 0.7153, 'time@10': 8.6434}:  60%|██████    | 6/10 [00:38<00:29,  7.46s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0403, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8556, 'compress@10': 0.7148, 'time@10': 8.9997}:  60%|██████    | 6/10 [00:43<00:29,  7.46s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0403, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8556, 'compress@10': 0.7148, 'time@10': 8.9997}:  70%|███████   | 7/10 [00:43<00:20,  6.85s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0404, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8584, 'compress@10': 0.714, 'time@10': 8.8724}:  70%|███████   | 7/10 [00:51<00:20,  6.85s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.0404, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8584, 'compress@10': 0.714, 'time@10': 8.8724}:  80%|████████  | 8/10 [00:51<00:14,  7.24s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0401, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.8654, 'compress@10': 0.7134, 'time@10': 9.3836}:  80%|████████  | 8/10 [00:58<00:14,  7.24s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0401, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.8654, 'compress@10': 0.7134, 'time@10': 9.3836}:  90%|█████████ | 9/10 [00:58<00:07,  7.09s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0391, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.8693, 'compress@10': 0.7128, 'time@10': 9.4734}:  90%|█████████ | 9/10 [01:08<00:07,  7.09s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0391, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.8693, 'compress@10': 0.7128, 'time@10': 9.4734}: 100%|██████████| 10/10 [01:08<00:00,  8.09s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0391, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.8693, 'compress@10': 0.7128, 'time@10': 9.4734}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.039137055287049125
Avg hit ratio: 0.8780982784429303
Avg ndcg: 0.8692739207510588
Avg compression ratio: 0.7127562780515486
Avg train time: 9.473387432098388
Std train time: 2.7397704837923245
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8504, 'compress@10': 0.7158, 'time@10': 8.4007}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8504, 'compress@10': 0.7158, 'time@10': 8.4007}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8643, 'compress@10': 0.7127, 'time@10': 7.7904}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8643, 'compress@10': 0.7127, 'time@10': 7.7904}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8619, 'compress@10': 0.7228, 'time@10': 6.9583}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8619, 'compress@10': 0.7228, 'time@10': 6.9583}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8651, 'compress@10': 0.7197, 'time@10': 6.8284}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8651, 'compress@10': 0.7197, 'time@10': 6.8284}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0371, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8515, 'compress@10': 0.717, 'time@10': 8.3133}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it] {'epoch': 11, 'num_users': 5.8, 'loss': 0.0371, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8515, 'compress@10': 0.717, 'time@10': 8.3133}:  50%|█████     | 5/10 [00:27<00:29,  5.95s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0376, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8537, 'compress@10': 0.7153, 'time@10': 8.6892}:  50%|█████     | 5/10 [00:38<00:29,  5.95s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0376, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8537, 'compress@10': 0.7153, 'time@10': 8.6892}:  60%|██████    | 6/10 [00:38<00:30,  7.54s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.8589, 'compress@10': 0.7148, 'time@10': 9.1002}:  60%|██████    | 6/10 [00:44<00:30,  7.54s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.8589, 'compress@10': 0.7148, 'time@10': 9.1002}:  70%|███████   | 7/10 [00:44<00:20,  6.98s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0384, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.862, 'compress@10': 0.714, 'time@10': 8.9552}:  70%|███████   | 7/10 [00:52<00:20,  6.98s/it]   {'epoch': 11, 'num_users': 6.125, 'loss': 0.0384, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.862, 'compress@10': 0.714, 'time@10': 8.9552}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0383, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8687, 'compress@10': 0.7134, 'time@10': 9.4039}:  80%|████████  | 8/10 [00:58<00:14,  7.30s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0383, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8687, 'compress@10': 0.7134, 'time@10': 9.4039}:  90%|█████████ | 9/10 [00:58<00:07,  7.06s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0374, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.8706, 'compress@10': 0.7128, 'time@10': 9.4751}:  90%|█████████ | 9/10 [01:08<00:07,  7.06s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0374, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.8706, 'compress@10': 0.7128, 'time@10': 9.4751}: 100%|██████████| 10/10 [01:08<00:00,  8.01s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0374, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.8706, 'compress@10': 0.7128, 'time@10': 9.4751}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03744276355557001
Avg hit ratio: 0.8794633578080099
Avg ndcg: 0.8705754193093622
Avg compression ratio: 0.7127562825218969
Avg train time: 9.475076580047608
Std train time: 2.768797065723049
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8595, 'compress@10': 0.7158, 'time@10': 8.8071}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8595, 'compress@10': 0.7158, 'time@10': 8.8071}:  10%|█         | 1/10 [00:04<00:39,  4.44s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8704, 'compress@10': 0.7127, 'time@10': 7.9489}:  10%|█         | 1/10 [00:11<00:39,  4.44s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8704, 'compress@10': 0.7127, 'time@10': 7.9489}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.866, 'compress@10': 0.7228, 'time@10': 7.1499}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.866, 'compress@10': 0.7228, 'time@10': 7.1499}:  30%|███       | 3/10 [00:14<00:31,  4.56s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8677, 'compress@10': 0.7197, 'time@10': 6.9693}:  30%|███       | 3/10 [00:20<00:31,  4.56s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8677, 'compress@10': 0.7197, 'time@10': 6.9693}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0346, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8551, 'compress@10': 0.717, 'time@10': 8.393}:  40%|████      | 4/10 [00:27<00:31,  5.31s/it]  {'epoch': 12, 'num_users': 5.8, 'loss': 0.0346, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.8551, 'compress@10': 0.717, 'time@10': 8.393}:  50%|█████     | 5/10 [00:27<00:29,  5.95s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0352, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8573, 'compress@10': 0.7153, 'time@10': 8.7401}:  50%|█████     | 5/10 [00:38<00:29,  5.95s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0352, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8573, 'compress@10': 0.7153, 'time@10': 8.7401}:  60%|██████    | 6/10 [00:38<00:30,  7.50s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0351, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.8548, 'compress@10': 0.7148, 'time@10': 9.1637}:  60%|██████    | 6/10 [00:44<00:30,  7.50s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0351, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.8548, 'compress@10': 0.7148, 'time@10': 9.1637}:  70%|███████   | 7/10 [00:44<00:20,  6.98s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0341, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8596, 'compress@10': 0.714, 'time@10': 8.9988}:  70%|███████   | 7/10 [00:52<00:20,  6.98s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.0341, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8596, 'compress@10': 0.714, 'time@10': 8.9988}:  80%|████████  | 8/10 [00:52<00:14,  7.27s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0342, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8666, 'compress@10': 0.7134, 'time@10': 9.4051}:  80%|████████  | 8/10 [00:58<00:14,  7.27s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0342, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8666, 'compress@10': 0.7134, 'time@10': 9.4051}:  90%|█████████ | 9/10 [00:58<00:06,  6.99s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8728, 'compress@10': 0.7128, 'time@10': 9.4756}:  90%|█████████ | 9/10 [01:08<00:06,  6.99s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8728, 'compress@10': 0.7128, 'time@10': 9.4756}: 100%|██████████| 10/10 [01:08<00:00,  7.96s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8728, 'compress@10': 0.7128, 'time@10': 9.4756}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03241773870371049
Avg hit ratio: 0.881736085080737
Avg ndcg: 0.8727872968532857
Avg compression ratio: 0.7127562825218969
Avg train time: 9.475620746612549
Std train time: 2.669041052082398
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8397, 'compress@10': 0.7158, 'time@10': 8.5371}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8397, 'compress@10': 0.7158, 'time@10': 8.5371}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8605, 'compress@10': 0.7127, 'time@10': 7.8493}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8605, 'compress@10': 0.7127, 'time@10': 7.8493}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8594, 'compress@10': 0.7228, 'time@10': 7.1196}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0252, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8594, 'compress@10': 0.7228, 'time@10': 7.1196}:  30%|███       | 3/10 [00:14<00:32,  4.57s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8627, 'compress@10': 0.7197, 'time@10': 6.9535}:  30%|███       | 3/10 [00:20<00:32,  4.57s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0286, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8627, 'compress@10': 0.7197, 'time@10': 6.9535}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.035, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8514, 'compress@10': 0.717, 'time@10': 8.3995}:  40%|████      | 4/10 [00:27<00:31,  5.33s/it]  {'epoch': 13, 'num_users': 5.8, 'loss': 0.035, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8514, 'compress@10': 0.717, 'time@10': 8.3995}:  50%|█████     | 5/10 [00:27<00:29,  5.98s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0363, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8542, 'compress@10': 0.7153, 'time@10': 8.7625}:  50%|█████     | 5/10 [00:38<00:29,  5.98s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0363, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8542, 'compress@10': 0.7153, 'time@10': 8.7625}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0361, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.8618, 'compress@10': 0.7148, 'time@10': 9.1265}:  60%|██████    | 6/10 [00:44<00:30,  7.56s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0361, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.8618, 'compress@10': 0.7148, 'time@10': 9.1265}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0343, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.8674, 'compress@10': 0.714, 'time@10': 9.0121}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it]  {'epoch': 13, 'num_users': 6.125, 'loss': 0.0343, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.8674, 'compress@10': 0.714, 'time@10': 9.0121}:  80%|████████  | 8/10 [00:52<00:14,  7.36s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0347, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8735, 'compress@10': 0.7134, 'time@10': 9.4858}:  80%|████████  | 8/10 [00:59<00:14,  7.36s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0347, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8735, 'compress@10': 0.7134, 'time@10': 9.4858}:  90%|█████████ | 9/10 [00:59<00:07,  7.15s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.8789, 'compress@10': 0.7128, 'time@10': 9.56}:  90%|█████████ | 9/10 [01:09<00:07,  7.15s/it]     {'epoch': 13, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.8789, 'compress@10': 0.7128, 'time@10': 9.56}: 100%|██████████| 10/10 [01:09<00:00,  8.11s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.8789, 'compress@10': 0.7128, 'time@10': 9.56}: 100%|██████████| 10/10 [01:09<00:00,  6.95s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03322396509339353
Avg hit ratio: 0.8895836585598895
Avg ndcg: 0.8788577329788486
Avg compression ratio: 0.7127562825218969
Avg train time: 9.560003757476807
Std train time: 2.7054314584965846
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.872, 'compress@10': 0.7158, 'time@10': 8.3163}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.872, 'compress@10': 0.7158, 'time@10': 8.3163}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8765, 'compress@10': 0.7127, 'time@10': 7.7786}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8765, 'compress@10': 0.7127, 'time@10': 7.7786}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8701, 'compress@10': 0.7228, 'time@10': 7.0141}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8701, 'compress@10': 0.7228, 'time@10': 7.0141}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8693, 'compress@10': 0.7197, 'time@10': 6.8604}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0259, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8693, 'compress@10': 0.7197, 'time@10': 6.8604}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0323, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8573, 'compress@10': 0.717, 'time@10': 8.341}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]  {'epoch': 14, 'num_users': 5.8, 'loss': 0.0323, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8573, 'compress@10': 0.717, 'time@10': 8.341}:  50%|█████     | 5/10 [00:27<00:29,  5.97s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0333, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8623, 'compress@10': 0.7153, 'time@10': 8.701}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0333, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8623, 'compress@10': 0.7153, 'time@10': 8.701}:  60%|██████    | 6/10 [00:38<00:30,  7.52s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0329, 'hit_ratio@10': 0.895, 'ndcg@10': 0.8635, 'compress@10': 0.7148, 'time@10': 9.0961}:  60%|██████    | 6/10 [00:44<00:30,  7.52s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0329, 'hit_ratio@10': 0.895, 'ndcg@10': 0.8635, 'compress@10': 0.7148, 'time@10': 9.0961}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0314, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.8692, 'compress@10': 0.714, 'time@10': 8.9476}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0314, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.8692, 'compress@10': 0.714, 'time@10': 8.9476}:  80%|████████  | 8/10 [00:52<00:14,  7.27s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.8739, 'compress@10': 0.7134, 'time@10': 9.3935}:  80%|████████  | 8/10 [00:58<00:14,  7.27s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.8739, 'compress@10': 0.7134, 'time@10': 9.3935}:  90%|█████████ | 9/10 [00:58<00:07,  7.03s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.8761, 'compress@10': 0.7128, 'time@10': 9.502}:  90%|█████████ | 9/10 [01:09<00:07,  7.03s/it]    {'epoch': 14, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.8761, 'compress@10': 0.7128, 'time@10': 9.502}: 100%|██████████| 10/10 [01:09<00:00,  8.11s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0317, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.8761, 'compress@10': 0.7128, 'time@10': 9.502}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.031694861329966025
Avg hit ratio: 0.8933998657445177
Avg ndcg: 0.8760770322762008
Avg compression ratio: 0.7127562825218969
Avg train time: 9.502021837234498
Std train time: 2.743461776921913
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8678, 'compress@10': 0.7158, 'time@10': 8.6289}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.035, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8678, 'compress@10': 0.7158, 'time@10': 8.6289}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8809, 'compress@10': 0.7127, 'time@10': 7.9028}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8809, 'compress@10': 0.7127, 'time@10': 7.9028}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8729, 'compress@10': 0.7228, 'time@10': 7.0794}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8729, 'compress@10': 0.7228, 'time@10': 7.0794}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8743, 'compress@10': 0.7197, 'time@10': 6.9205}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8743, 'compress@10': 0.7197, 'time@10': 6.9205}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0305, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8627, 'compress@10': 0.717, 'time@10': 8.3853}:  40%|████      | 4/10 [00:27<00:31,  5.30s/it] {'epoch': 15, 'num_users': 5.8, 'loss': 0.0305, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8627, 'compress@10': 0.717, 'time@10': 8.3853}:  50%|█████     | 5/10 [00:27<00:29,  5.97s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.03, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8682, 'compress@10': 0.7153, 'time@10': 8.7513}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.03, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8682, 'compress@10': 0.7153, 'time@10': 8.7513}:  60%|██████    | 6/10 [00:38<00:30,  7.55s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0294, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.874, 'compress@10': 0.7148, 'time@10': 9.251}:  60%|██████    | 6/10 [00:44<00:30,  7.55s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0294, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.874, 'compress@10': 0.7148, 'time@10': 9.251}:  70%|███████   | 7/10 [00:44<00:21,  7.10s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0286, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.8784, 'compress@10': 0.714, 'time@10': 9.0962}:  70%|███████   | 7/10 [00:52<00:21,  7.10s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0286, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.8784, 'compress@10': 0.714, 'time@10': 9.0962}:  80%|████████  | 8/10 [00:52<00:14,  7.40s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0298, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8831, 'compress@10': 0.7134, 'time@10': 9.5545}:  80%|████████  | 8/10 [00:59<00:14,  7.40s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0298, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8831, 'compress@10': 0.7134, 'time@10': 9.5545}:  90%|█████████ | 9/10 [00:59<00:07,  7.17s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.8888, 'compress@10': 0.7128, 'time@10': 9.6186}:  90%|█████████ | 9/10 [01:09<00:07,  7.17s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.8888, 'compress@10': 0.7128, 'time@10': 9.6186}: 100%|██████████| 10/10 [01:09<00:00,  8.11s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.8888, 'compress@10': 0.7128, 'time@10': 9.6186}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.029415548188602807
Avg hit ratio: 0.9029357509119817
Avg ndcg: 0.8888307319573864
Avg compression ratio: 0.7127562712395893
Avg train time: 9.618625664710999
Std train time: 2.8227844879924415
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8699, 'compress@10': 0.7158, 'time@10': 8.3767}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0373, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8699, 'compress@10': 0.7158, 'time@10': 8.3767}:  10%|█         | 1/10 [00:04<00:38,  4.22s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8837, 'compress@10': 0.7127, 'time@10': 7.8704}:  10%|█         | 1/10 [00:11<00:38,  4.22s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8837, 'compress@10': 0.7127, 'time@10': 7.8704}:  20%|██        | 2/10 [00:11<00:48,  6.09s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8748, 'compress@10': 0.7228, 'time@10': 7.0093}:  20%|██        | 2/10 [00:14<00:48,  6.09s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8748, 'compress@10': 0.7228, 'time@10': 7.0093}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8776, 'compress@10': 0.7197, 'time@10': 6.8839}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8776, 'compress@10': 0.7197, 'time@10': 6.8839}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8664, 'compress@10': 0.717, 'time@10': 8.3441}:  40%|████      | 4/10 [00:27<00:31,  5.33s/it] {'epoch': 16, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8664, 'compress@10': 0.717, 'time@10': 8.3441}:  50%|█████     | 5/10 [00:27<00:29,  5.98s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0293, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8723, 'compress@10': 0.7153, 'time@10': 8.6969}:  50%|█████     | 5/10 [00:38<00:29,  5.98s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0293, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.8723, 'compress@10': 0.7153, 'time@10': 8.6969}:  60%|██████    | 6/10 [00:38<00:30,  7.52s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0297, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.8761, 'compress@10': 0.7148, 'time@10': 9.0816}:  60%|██████    | 6/10 [00:44<00:30,  7.52s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0297, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.8761, 'compress@10': 0.7148, 'time@10': 9.0816}:  70%|███████   | 7/10 [00:44<00:20,  6.93s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0287, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.8802, 'compress@10': 0.714, 'time@10': 8.9647}:  70%|███████   | 7/10 [00:52<00:20,  6.93s/it]  {'epoch': 16, 'num_users': 6.125, 'loss': 0.0287, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.8802, 'compress@10': 0.714, 'time@10': 8.9647}:  80%|████████  | 8/10 [00:52<00:14,  7.33s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0301, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8848, 'compress@10': 0.7134, 'time@10': 9.4958}:  80%|████████  | 8/10 [00:59<00:14,  7.33s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0301, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8848, 'compress@10': 0.7134, 'time@10': 9.4958}:  90%|█████████ | 9/10 [00:59<00:07,  7.21s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0303, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.8862, 'compress@10': 0.7128, 'time@10': 9.5734}:  90%|█████████ | 9/10 [01:09<00:07,  7.21s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0303, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.8862, 'compress@10': 0.7128, 'time@10': 9.5734}: 100%|██████████| 10/10 [01:09<00:00,  8.17s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0303, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.8862, 'compress@10': 0.7128, 'time@10': 9.5734}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.03031185790976071
Avg hit ratio: 0.9006630236392545
Avg ndcg: 0.8862085684987425
Avg compression ratio: 0.7127562598863235
Avg train time: 9.573380088806152
Std train time: 2.8171483098764254
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8699, 'compress@10': 0.7158, 'time@10': 8.4983}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8699, 'compress@10': 0.7158, 'time@10': 8.4983}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0299, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8839, 'compress@10': 0.7127, 'time@10': 7.8412}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0299, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8839, 'compress@10': 0.7127, 'time@10': 7.8412}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.846, 'ndcg@10': 0.875, 'compress@10': 0.7228, 'time@10': 7.1075}:  20%|██        | 2/10 [00:14<00:48,  6.02s/it]  {'epoch': 17, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.846, 'ndcg@10': 0.875, 'compress@10': 0.7228, 'time@10': 7.1075}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8789, 'compress@10': 0.7197, 'time@10': 6.9134}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8789, 'compress@10': 0.7197, 'time@10': 6.9134}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.028, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8682, 'compress@10': 0.717, 'time@10': 8.4295}:  40%|████      | 4/10 [00:28<00:31,  5.29s/it]  {'epoch': 17, 'num_users': 5.8, 'loss': 0.028, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8682, 'compress@10': 0.717, 'time@10': 8.4295}:  50%|█████     | 5/10 [00:28<00:30,  6.02s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0296, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.876, 'compress@10': 0.7153, 'time@10': 8.7703}:  50%|█████     | 5/10 [00:38<00:30,  6.02s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0296, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.876, 'compress@10': 0.7153, 'time@10': 8.7703}:  60%|██████    | 6/10 [00:38<00:30,  7.55s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.8788, 'compress@10': 0.7148, 'time@10': 9.1364}:  60%|██████    | 6/10 [00:44<00:30,  7.55s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.8788, 'compress@10': 0.7148, 'time@10': 9.1364}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0286, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.8815, 'compress@10': 0.714, 'time@10': 8.9896}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 0.0286, 'hit_ratio@10': 0.9137, 'ndcg@10': 0.8815, 'compress@10': 0.714, 'time@10': 8.9896}:  80%|████████  | 8/10 [00:52<00:14,  7.28s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.7134, 'time@10': 9.4064}:  80%|████████  | 8/10 [00:58<00:14,  7.28s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8894, 'compress@10': 0.7134, 'time@10': 9.4064}:  90%|█████████ | 9/10 [00:58<00:07,  7.01s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.8954, 'compress@10': 0.7128, 'time@10': 9.4856}:  90%|█████████ | 9/10 [01:08<00:07,  7.01s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.8954, 'compress@10': 0.7128, 'time@10': 9.4856}: 100%|██████████| 10/10 [01:08<00:00,  8.00s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0279, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.8954, 'compress@10': 0.7128, 'time@10': 9.4856}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02790175673087434
Avg hit ratio: 0.9029357509119817
Avg ndcg: 0.8953694698793955
Avg compression ratio: 0.7127562757099376
Avg train time: 9.485581731796264
Std train time: 2.7186759976650023
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8738, 'compress@10': 0.7158, 'time@10': 8.5886}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8738, 'compress@10': 0.7158, 'time@10': 8.5886}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8943, 'compress@10': 0.7127, 'time@10': 7.8425}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8943, 'compress@10': 0.7127, 'time@10': 7.8425}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8819, 'compress@10': 0.7228, 'time@10': 7.0631}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8819, 'compress@10': 0.7228, 'time@10': 7.0631}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8855, 'compress@10': 0.7197, 'time@10': 6.8919}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.8855, 'compress@10': 0.7197, 'time@10': 6.8919}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0263, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.8745, 'compress@10': 0.717, 'time@10': 8.3018}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it] {'epoch': 18, 'num_users': 5.8, 'loss': 0.0263, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.8745, 'compress@10': 0.717, 'time@10': 8.3018}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.026, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.8823, 'compress@10': 0.7153, 'time@10': 8.6942}:  50%|█████     | 5/10 [00:38<00:29,  5.90s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.026, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.8823, 'compress@10': 0.7153, 'time@10': 8.6942}:  60%|██████    | 6/10 [00:38<00:30,  7.53s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0253, 'hit_ratio@10': 0.91, 'ndcg@10': 0.8866, 'compress@10': 0.7148, 'time@10': 9.1392}:  60%|██████    | 6/10 [00:44<00:30,  7.53s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.0253, 'hit_ratio@10': 0.91, 'ndcg@10': 0.8866, 'compress@10': 0.7148, 'time@10': 9.1392}:  70%|███████   | 7/10 [00:44<00:21,  7.01s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.9177, 'ndcg@10': 0.8886, 'compress@10': 0.714, 'time@10': 8.9793}:  70%|███████   | 7/10 [00:52<00:21,  7.01s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.9177, 'ndcg@10': 0.8886, 'compress@10': 0.714, 'time@10': 8.9793}:  80%|████████  | 8/10 [00:52<00:14,  7.29s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0273, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9001, 'compress@10': 0.7134, 'time@10': 9.3998}:  80%|████████  | 8/10 [00:58<00:14,  7.29s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0273, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9001, 'compress@10': 0.7134, 'time@10': 9.3998}:  90%|█████████ | 9/10 [00:58<00:07,  7.02s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.8993, 'compress@10': 0.7128, 'time@10': 9.4825}:  90%|█████████ | 9/10 [01:08<00:07,  7.02s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.8993, 'compress@10': 0.7128, 'time@10': 9.4825}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.8993, 'compress@10': 0.7128, 'time@10': 9.4825}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.02759149239858851
Avg hit ratio: 0.9067459729480104
Avg ndcg: 0.8992531652765503
Avg compression ratio: 0.7127562770723295
Avg train time: 9.482489895820617
Std train time: 2.694136597445792
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8778, 'compress@10': 0.7158, 'time@10': 8.4436}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8778, 'compress@10': 0.7158, 'time@10': 8.4436}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8937, 'compress@10': 0.7127, 'time@10': 7.8365}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8937, 'compress@10': 0.7127, 'time@10': 7.8365}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8815, 'compress@10': 0.7228, 'time@10': 7.0377}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8815, 'compress@10': 0.7228, 'time@10': 7.0377}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.8832, 'compress@10': 0.7197, 'time@10': 6.8776}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.8832, 'compress@10': 0.7197, 'time@10': 6.8776}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.874, 'compress@10': 0.717, 'time@10': 8.3005}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]  {'epoch': 19, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.874, 'compress@10': 0.717, 'time@10': 8.3005}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0245, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.8837, 'compress@10': 0.7153, 'time@10': 8.6706}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0245, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.8837, 'compress@10': 0.7153, 'time@10': 8.6706}:  60%|██████    | 6/10 [00:38<00:29,  7.50s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0252, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.8869, 'compress@10': 0.7148, 'time@10': 9.0738}:  60%|██████    | 6/10 [00:44<00:29,  7.50s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0252, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.8869, 'compress@10': 0.7148, 'time@10': 9.0738}:  70%|███████   | 7/10 [00:44<00:20,  6.94s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0245, 'hit_ratio@10': 0.9217, 'ndcg@10': 0.891, 'compress@10': 0.714, 'time@10': 8.9098}:  70%|███████   | 7/10 [00:51<00:20,  6.94s/it]   {'epoch': 19, 'num_users': 6.125, 'loss': 0.0245, 'hit_ratio@10': 0.9217, 'ndcg@10': 0.891, 'compress@10': 0.714, 'time@10': 8.9098}:  80%|████████  | 8/10 [00:51<00:14,  7.21s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.909, 'compress@10': 0.7134, 'time@10': 9.3955}:  80%|████████  | 8/10 [00:58<00:14,  7.21s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.909, 'compress@10': 0.7134, 'time@10': 9.3955}:  90%|█████████ | 9/10 [00:58<00:07,  7.04s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9139, 'compress@10': 0.7128, 'time@10': 9.479}:  90%|█████████ | 9/10 [01:08<00:07,  7.04s/it]    {'epoch': 19, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9139, 'compress@10': 0.7128, 'time@10': 9.479}: 100%|██████████| 10/10 [01:08<00:00,  8.04s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9139, 'compress@10': 0.7128, 'time@10': 9.479}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.025658904674441534
Avg hit ratio: 0.9179587923866361
Avg ndcg: 0.9138722734842611
Avg compression ratio: 0.712756240987767
Avg train time: 9.47901384830475
Std train time: 2.7463228427622686
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0397, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8729, 'compress@10': 0.7158, 'time@10': 8.6567}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0397, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8729, 'compress@10': 0.7158, 'time@10': 8.6567}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0297, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.897, 'compress@10': 0.7127, 'time@10': 7.8638}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it] {'epoch': 20, 'num_users': 7.0, 'loss': 0.0297, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.897, 'compress@10': 0.7127, 'time@10': 7.8638}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8837, 'compress@10': 0.7228, 'time@10': 6.9944}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8837, 'compress@10': 0.7228, 'time@10': 6.9944}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8874, 'compress@10': 0.7197, 'time@10': 6.8241}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8874, 'compress@10': 0.7197, 'time@10': 6.8241}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8786, 'compress@10': 0.717, 'time@10': 8.3384}:  40%|████      | 4/10 [00:27<00:31,  5.21s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8786, 'compress@10': 0.717, 'time@10': 8.3384}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0273, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.8868, 'compress@10': 0.7153, 'time@10': 8.7238}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0273, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.8868, 'compress@10': 0.7153, 'time@10': 8.7238}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0276, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.8879, 'compress@10': 0.7148, 'time@10': 9.1114}:  60%|██████    | 6/10 [00:44<00:30,  7.56s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0276, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.8879, 'compress@10': 0.7148, 'time@10': 9.1114}:  70%|███████   | 7/10 [00:44<00:20,  6.97s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0265, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.8915, 'compress@10': 0.714, 'time@10': 8.9562}:  70%|███████   | 7/10 [00:52<00:20,  6.97s/it]  {'epoch': 20, 'num_users': 6.125, 'loss': 0.0265, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.8915, 'compress@10': 0.714, 'time@10': 8.9562}:  80%|████████  | 8/10 [00:52<00:14,  7.27s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9067, 'compress@10': 0.7134, 'time@10': 9.404}:  80%|████████  | 8/10 [00:58<00:14,  7.27s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9067, 'compress@10': 0.7134, 'time@10': 9.404}:  90%|█████████ | 9/10 [00:58<00:07,  7.04s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9139, 'compress@10': 0.7128, 'time@10': 9.4861}:  90%|█████████ | 9/10 [01:08<00:07,  7.04s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9139, 'compress@10': 0.7128, 'time@10': 9.4861}: 100%|██████████| 10/10 [01:08<00:00,  8.03s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9139, 'compress@10': 0.7128, 'time@10': 9.4861}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.028345390202003606
Avg hit ratio: 0.8979587923866361
Avg ndcg: 0.9138989617922325
Avg compression ratio: 0.7127562825218969
Avg train time: 9.486146497726441
Std train time: 2.8135985999089526
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0292, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.886, 'compress@10': 0.7158, 'time@10': 8.4572}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0292, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.886, 'compress@10': 0.7158, 'time@10': 8.4572}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8953, 'compress@10': 0.7127, 'time@10': 7.8359}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8953, 'compress@10': 0.7127, 'time@10': 7.8359}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8826, 'compress@10': 0.7228, 'time@10': 7.1144}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8826, 'compress@10': 0.7228, 'time@10': 7.1144}:  30%|███       | 3/10 [00:14<00:32,  4.60s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8912, 'compress@10': 0.7197, 'time@10': 6.9282}:  30%|███       | 3/10 [00:20<00:32,  4.60s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8912, 'compress@10': 0.7197, 'time@10': 6.9282}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8825, 'compress@10': 0.717, 'time@10': 8.3442}:  40%|████      | 4/10 [00:27<00:31,  5.31s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8825, 'compress@10': 0.717, 'time@10': 8.3442}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0226, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8919, 'compress@10': 0.7153, 'time@10': 8.7068}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0226, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8919, 'compress@10': 0.7153, 'time@10': 8.7068}:  60%|██████    | 6/10 [00:38<00:30,  7.51s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0218, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.8948, 'compress@10': 0.7148, 'time@10': 9.1064}:  60%|██████    | 6/10 [00:44<00:30,  7.51s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0218, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.8948, 'compress@10': 0.7148, 'time@10': 9.1064}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0211, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9, 'compress@10': 0.714, 'time@10': 8.971}:  70%|███████   | 7/10 [00:52<00:20,  6.95s/it]      {'epoch': 21, 'num_users': 6.125, 'loss': 0.0211, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9, 'compress@10': 0.714, 'time@10': 8.971}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9055, 'compress@10': 0.7134, 'time@10': 9.3912}:  80%|████████  | 8/10 [00:58<00:14,  7.30s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0216, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9055, 'compress@10': 0.7134, 'time@10': 9.3912}:  90%|█████████ | 9/10 [00:58<00:07,  7.02s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9099, 'compress@10': 0.7128, 'time@10': 9.4628}:  90%|█████████ | 9/10 [01:08<00:07,  7.02s/it]  {'epoch': 21, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9099, 'compress@10': 0.7128, 'time@10': 9.4628}: 100%|██████████| 10/10 [01:08<00:00,  7.99s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9099, 'compress@10': 0.7128, 'time@10': 9.4628}: 100%|██████████| 10/10 [01:08<00:00,  6.88s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.021218631712986227
Avg hit ratio: 0.8915302209580649
Avg ndcg: 0.909853255684528
Avg compression ratio: 0.7127562825218969
Avg train time: 9.462769722938537
Std train time: 2.6318619083435166
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.886, 'compress@10': 0.7158, 'time@10': 8.3578}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.886, 'compress@10': 0.7158, 'time@10': 8.3578}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0253, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8969, 'compress@10': 0.7127, 'time@10': 7.8391}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0253, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8969, 'compress@10': 0.7127, 'time@10': 7.8391}:  20%|██        | 2/10 [00:11<00:48,  6.06s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8836, 'compress@10': 0.7228, 'time@10': 7.0927}:  20%|██        | 2/10 [00:14<00:48,  6.06s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8836, 'compress@10': 0.7228, 'time@10': 7.0927}:  30%|███       | 3/10 [00:14<00:32,  4.59s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8904, 'compress@10': 0.7197, 'time@10': 6.9361}:  30%|███       | 3/10 [00:20<00:32,  4.59s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8904, 'compress@10': 0.7197, 'time@10': 6.9361}:  40%|████      | 4/10 [00:20<00:32,  5.35s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.8827, 'compress@10': 0.717, 'time@10': 8.368}:  40%|████      | 4/10 [00:27<00:32,  5.35s/it]  {'epoch': 22, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.8827, 'compress@10': 0.717, 'time@10': 8.368}:  50%|█████     | 5/10 [00:27<00:29,  5.97s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.8939, 'compress@10': 0.7153, 'time@10': 8.7384}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.8939, 'compress@10': 0.7153, 'time@10': 8.7384}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0206, 'hit_ratio@10': 0.9156, 'ndcg@10': 0.8993, 'compress@10': 0.7148, 'time@10': 9.1135}:  60%|██████    | 6/10 [00:44<00:30,  7.56s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0206, 'hit_ratio@10': 0.9156, 'ndcg@10': 0.8993, 'compress@10': 0.7148, 'time@10': 9.1135}:  70%|███████   | 7/10 [00:44<00:20,  6.96s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.02, 'hit_ratio@10': 0.9226, 'ndcg@10': 0.9035, 'compress@10': 0.714, 'time@10': 8.9531}:  70%|███████   | 7/10 [00:52<00:20,  6.96s/it]    {'epoch': 22, 'num_users': 6.125, 'loss': 0.02, 'hit_ratio@10': 0.9226, 'ndcg@10': 0.9035, 'compress@10': 0.714, 'time@10': 8.9531}:  80%|████████  | 8/10 [00:52<00:14,  7.25s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9081, 'compress@10': 0.7134, 'time@10': 9.418}:  80%|████████  | 8/10 [00:58<00:14,  7.25s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9081, 'compress@10': 0.7134, 'time@10': 9.418}:  90%|█████████ | 9/10 [00:58<00:07,  7.05s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.9129, 'ndcg@10': 0.9142, 'compress@10': 0.7128, 'time@10': 9.5026}:  90%|█████████ | 9/10 [01:09<00:07,  7.05s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.9129, 'ndcg@10': 0.9142, 'compress@10': 0.7128, 'time@10': 9.5026}: 100%|██████████| 10/10 [01:09<00:00,  8.05s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.9129, 'ndcg@10': 0.9142, 'compress@10': 0.7128, 'time@10': 9.5026}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.019000998228354632
Avg hit ratio: 0.9129326517662679
Avg ndcg: 0.9142046928584391
Avg compression ratio: 0.71275627026037
Avg train time: 9.502589440345764
Std train time: 2.699083005582693
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0292, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8843, 'compress@10': 0.7158, 'time@10': 8.5541}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0292, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8843, 'compress@10': 0.7158, 'time@10': 8.5541}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9031, 'compress@10': 0.7127, 'time@10': 7.7845}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9031, 'compress@10': 0.7127, 'time@10': 7.7845}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8878, 'compress@10': 0.7228, 'time@10': 6.9138}:  20%|██        | 2/10 [00:13<00:47,  5.92s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8878, 'compress@10': 0.7228, 'time@10': 6.9138}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8925, 'compress@10': 0.7197, 'time@10': 6.7372}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]  {'epoch': 23, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8925, 'compress@10': 0.7197, 'time@10': 6.7372}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0227, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8851, 'compress@10': 0.717, 'time@10': 8.3124}:  40%|████      | 4/10 [00:27<00:30,  5.14s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0227, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8851, 'compress@10': 0.717, 'time@10': 8.3124}:  50%|█████     | 5/10 [00:27<00:29,  5.93s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0236, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.8906, 'compress@10': 0.7153, 'time@10': 8.7029}:  50%|█████     | 5/10 [00:38<00:29,  5.93s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0236, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.8906, 'compress@10': 0.7153, 'time@10': 8.7029}:  60%|██████    | 6/10 [00:38<00:30,  7.55s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0242, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.8968, 'compress@10': 0.7148, 'time@10': 9.1065}:  60%|██████    | 6/10 [00:44<00:30,  7.55s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0242, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.8968, 'compress@10': 0.7148, 'time@10': 9.1065}:  70%|███████   | 7/10 [00:44<00:20,  6.98s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.921, 'ndcg@10': 0.9015, 'compress@10': 0.714, 'time@10': 8.9343}:  70%|███████   | 7/10 [00:51<00:20,  6.98s/it]   {'epoch': 23, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.921, 'ndcg@10': 0.9015, 'compress@10': 0.714, 'time@10': 8.9343}:  80%|████████  | 8/10 [00:51<00:14,  7.23s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.9076, 'ndcg@10': 0.9102, 'compress@10': 0.7134, 'time@10': 9.3545}:  80%|████████  | 8/10 [00:58<00:14,  7.23s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.9076, 'ndcg@10': 0.9102, 'compress@10': 0.7134, 'time@10': 9.3545}:  90%|█████████ | 9/10 [00:58<00:06,  6.97s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0243, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.912, 'compress@10': 0.7128, 'time@10': 9.4452}:  90%|█████████ | 9/10 [01:08<00:06,  6.97s/it]    {'epoch': 23, 'num_users': 6.3, 'loss': 0.0243, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.912, 'compress@10': 0.7128, 'time@10': 9.4452}: 100%|██████████| 10/10 [01:08<00:00,  8.00s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0243, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.912, 'compress@10': 0.7128, 'time@10': 9.4452}: 100%|██████████| 10/10 [01:08<00:00,  6.85s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.024252696373846028
Avg hit ratio: 0.914563988171798
Avg ndcg: 0.9120233750720578
Avg compression ratio: 0.7127562825218969
Avg train time: 9.445190668106079
Std train time: 2.8681800925512664
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8902, 'compress@10': 0.7158, 'time@10': 8.6069}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8902, 'compress@10': 0.7158, 'time@10': 8.6069}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9249, 'compress@10': 0.7127, 'time@10': 7.7612}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9249, 'compress@10': 0.7127, 'time@10': 7.7612}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9023, 'compress@10': 0.7228, 'time@10': 7.106}:  20%|██        | 2/10 [00:14<00:47,  5.88s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9023, 'compress@10': 0.7228, 'time@10': 7.106}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9088, 'compress@10': 0.7197, 'time@10': 6.9152}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9088, 'compress@10': 0.7197, 'time@10': 6.9152}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8989, 'compress@10': 0.717, 'time@10': 8.4505}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8989, 'compress@10': 0.717, 'time@10': 8.4505}:  50%|█████     | 5/10 [00:27<00:30,  6.01s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0204, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9072, 'compress@10': 0.7153, 'time@10': 8.8101}:  50%|█████     | 5/10 [00:38<00:30,  6.01s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0204, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9072, 'compress@10': 0.7153, 'time@10': 8.8101}:  60%|██████    | 6/10 [00:38<00:30,  7.59s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0201, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9066, 'compress@10': 0.7148, 'time@10': 9.1648}:  60%|██████    | 6/10 [00:44<00:30,  7.59s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0201, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9066, 'compress@10': 0.7148, 'time@10': 9.1648}:  70%|███████   | 7/10 [00:44<00:20,  6.97s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0191, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.911, 'compress@10': 0.714, 'time@10': 8.9968}:  70%|███████   | 7/10 [00:52<00:20,  6.97s/it]   {'epoch': 24, 'num_users': 6.125, 'loss': 0.0191, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.911, 'compress@10': 0.714, 'time@10': 8.9968}:  80%|████████  | 8/10 [00:52<00:14,  7.25s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0207, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9256, 'compress@10': 0.7134, 'time@10': 9.41}:  80%|████████  | 8/10 [00:58<00:14,  7.25s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0207, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9256, 'compress@10': 0.7134, 'time@10': 9.41}:  90%|█████████ | 9/10 [00:58<00:06,  6.98s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9304, 'compress@10': 0.7128, 'time@10': 9.4839}:  90%|█████████ | 9/10 [01:08<00:06,  6.98s/it]  {'epoch': 24, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9304, 'compress@10': 0.7128, 'time@10': 9.4839}: 100%|██████████| 10/10 [01:08<00:00,  7.97s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9304, 'compress@10': 0.7128, 'time@10': 9.4839}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.019012804775994773
Avg hit ratio: 0.8970524674344708
Avg ndcg: 0.9303941442295149
Avg compression ratio: 0.7127562740447919
Avg train time: 9.483850383758545
Std train time: 2.7406738889780606
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8926, 'compress@10': 0.7158, 'time@10': 8.3854}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8926, 'compress@10': 0.7158, 'time@10': 8.3854}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9231, 'compress@10': 0.7127, 'time@10': 7.7882}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9231, 'compress@10': 0.7127, 'time@10': 7.7882}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9011, 'compress@10': 0.7228, 'time@10': 7.0823}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9011, 'compress@10': 0.7228, 'time@10': 7.0823}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9108, 'compress@10': 0.7197, 'time@10': 6.8886}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9108, 'compress@10': 0.7197, 'time@10': 6.8886}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.9019, 'compress@10': 0.717, 'time@10': 8.2977}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it] {'epoch': 25, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.9019, 'compress@10': 0.717, 'time@10': 8.2977}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9114, 'compress@10': 0.7153, 'time@10': 8.6618}:  50%|█████     | 5/10 [00:38<00:29,  5.90s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9114, 'compress@10': 0.7153, 'time@10': 8.6618}:  60%|██████    | 6/10 [00:38<00:29,  7.47s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9151, 'compress@10': 0.7148, 'time@10': 9.073}:  60%|██████    | 6/10 [00:44<00:29,  7.47s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9151, 'compress@10': 0.7148, 'time@10': 9.073}:  70%|███████   | 7/10 [00:44<00:20,  6.93s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9189, 'compress@10': 0.714, 'time@10': 8.9158}:  70%|███████   | 7/10 [00:51<00:20,  6.93s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9189, 'compress@10': 0.714, 'time@10': 8.9158}:  80%|████████  | 8/10 [00:51<00:14,  7.22s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9339, 'compress@10': 0.7134, 'time@10': 9.3652}:  80%|████████  | 8/10 [00:58<00:14,  7.22s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9339, 'compress@10': 0.7134, 'time@10': 9.3652}:  90%|█████████ | 9/10 [00:58<00:07,  7.00s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9351, 'compress@10': 0.7128, 'time@10': 9.4372}:  90%|█████████ | 9/10 [01:08<00:07,  7.00s/it] {'epoch': 25, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9351, 'compress@10': 0.7128, 'time@10': 9.4372}: 100%|██████████| 10/10 [01:08<00:00,  7.97s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9351, 'compress@10': 0.7128, 'time@10': 9.4372}: 100%|██████████| 10/10 [01:08<00:00,  6.85s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.018076366902846985
Avg hit ratio: 0.8807667531487565
Avg ndcg: 0.935064461918809
Avg compression ratio: 0.7127562594450111
Avg train time: 9.437234449386597
Std train time: 2.6707708426204215
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8944, 'compress@10': 0.7158, 'time@10': 8.4645}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8944, 'compress@10': 0.7158, 'time@10': 8.4645}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9221, 'compress@10': 0.7127, 'time@10': 7.7906}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9221, 'compress@10': 0.7127, 'time@10': 7.7906}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9005, 'compress@10': 0.7228, 'time@10': 7.0173}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9005, 'compress@10': 0.7228, 'time@10': 7.0173}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9099, 'compress@10': 0.7197, 'time@10': 6.8788}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9099, 'compress@10': 0.7197, 'time@10': 6.8788}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9031, 'compress@10': 0.717, 'time@10': 8.5427}:  40%|████      | 4/10 [00:28<00:31,  5.30s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9031, 'compress@10': 0.717, 'time@10': 8.5427}:  50%|█████     | 5/10 [00:28<00:30,  6.14s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9132, 'compress@10': 0.7153, 'time@10': 8.9066}:  50%|█████     | 5/10 [00:39<00:30,  6.14s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9132, 'compress@10': 0.7153, 'time@10': 8.9066}:  60%|██████    | 6/10 [00:39<00:30,  7.71s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0171, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9149, 'compress@10': 0.7148, 'time@10': 9.267}:  60%|██████    | 6/10 [00:44<00:30,  7.71s/it]  {'epoch': 26, 'num_users': 6.2857, 'loss': 0.0171, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9149, 'compress@10': 0.7148, 'time@10': 9.267}:  70%|███████   | 7/10 [00:44<00:21,  7.07s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9156, 'compress@10': 0.714, 'time@10': 9.0702}:  70%|███████   | 7/10 [00:52<00:21,  7.07s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9156, 'compress@10': 0.714, 'time@10': 9.0702}:  80%|████████  | 8/10 [00:52<00:14,  7.28s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9206, 'compress@10': 0.7134, 'time@10': 9.4756}:  80%|████████  | 8/10 [00:58<00:14,  7.28s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9206, 'compress@10': 0.7134, 'time@10': 9.4756}:  90%|█████████ | 9/10 [00:58<00:07,  7.00s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9247, 'compress@10': 0.7128, 'time@10': 9.5651}:  90%|█████████ | 9/10 [01:09<00:07,  7.00s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9247, 'compress@10': 0.7128, 'time@10': 9.5651}: 100%|██████████| 10/10 [01:09<00:00,  8.06s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9247, 'compress@10': 0.7128, 'time@10': 9.5651}: 100%|██████████| 10/10 [01:09<00:00,  6.94s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.017766946640140592
Avg hit ratio: 0.8979096102916136
Avg ndcg: 0.9247218452133307
Avg compression ratio: 0.7127562698062394
Avg train time: 9.565080833435058
Std train time: 2.902613482735612
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8944, 'compress@10': 0.7158, 'time@10': 8.6395}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8944, 'compress@10': 0.7158, 'time@10': 8.6395}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.923, 'compress@10': 0.7127, 'time@10': 7.7733}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it] {'epoch': 27, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.923, 'compress@10': 0.7127, 'time@10': 7.7733}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9011, 'compress@10': 0.7228, 'time@10': 7.079}:  20%|██        | 2/10 [00:14<00:47,  5.88s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9011, 'compress@10': 0.7228, 'time@10': 7.079}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9105, 'compress@10': 0.7197, 'time@10': 6.887}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9105, 'compress@10': 0.7197, 'time@10': 6.887}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9048, 'compress@10': 0.717, 'time@10': 8.3444}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9048, 'compress@10': 0.717, 'time@10': 8.3444}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0211, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9147, 'compress@10': 0.7153, 'time@10': 8.7327}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0211, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.9147, 'compress@10': 0.7153, 'time@10': 8.7327}:  60%|██████    | 6/10 [00:38<00:30,  7.55s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0208, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9157, 'compress@10': 0.7148, 'time@10': 9.1096}:  60%|██████    | 6/10 [00:44<00:30,  7.55s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0208, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9157, 'compress@10': 0.7148, 'time@10': 9.1096}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9208, 'compress@10': 0.714, 'time@10': 8.9327}:  70%|███████   | 7/10 [00:51<00:20,  6.95s/it]  {'epoch': 27, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9208, 'compress@10': 0.714, 'time@10': 8.9327}:  80%|████████  | 8/10 [00:51<00:14,  7.20s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9253, 'compress@10': 0.7134, 'time@10': 9.3292}:  80%|████████  | 8/10 [00:58<00:14,  7.20s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9253, 'compress@10': 0.7134, 'time@10': 9.3292}:  90%|█████████ | 9/10 [00:58<00:06,  6.91s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9313, 'compress@10': 0.7128, 'time@10': 9.4069}:  90%|█████████ | 9/10 [01:08<00:06,  6.91s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9313, 'compress@10': 0.7128, 'time@10': 9.4069}: 100%|██████████| 10/10 [01:08<00:00,  7.91s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9313, 'compress@10': 0.7128, 'time@10': 9.4069}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.02236033696246264
Avg hit ratio: 0.8803156253292077
Avg ndcg: 0.931273702117597
Avg compression ratio: 0.7127562825218969
Avg train time: 9.406930756568908
Std train time: 2.6723865240852613
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8945, 'compress@10': 0.7158, 'time@10': 8.4504}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8945, 'compress@10': 0.7158, 'time@10': 8.4504}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9359, 'compress@10': 0.7127, 'time@10': 7.7193}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it] {'epoch': 28, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9359, 'compress@10': 0.7127, 'time@10': 7.7193}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9097, 'compress@10': 0.7228, 'time@10': 7.022}:  20%|██        | 2/10 [00:14<00:47,  5.89s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9097, 'compress@10': 0.7228, 'time@10': 7.022}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9207, 'compress@10': 0.7197, 'time@10': 6.8635}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9207, 'compress@10': 0.7197, 'time@10': 6.8635}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9142, 'compress@10': 0.717, 'time@10': 8.2732}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9142, 'compress@10': 0.717, 'time@10': 8.2732}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9225, 'compress@10': 0.7153, 'time@10': 8.625}:  50%|█████     | 5/10 [00:37<00:29,  5.89s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9225, 'compress@10': 0.7153, 'time@10': 8.625}:  60%|██████    | 6/10 [00:37<00:29,  7.43s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9259, 'compress@10': 0.7148, 'time@10': 8.9935}:  60%|██████    | 6/10 [00:43<00:29,  7.43s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9259, 'compress@10': 0.7148, 'time@10': 8.9935}:  70%|███████   | 7/10 [00:43<00:20,  6.84s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9297, 'compress@10': 0.714, 'time@10': 8.8254}:  70%|███████   | 7/10 [00:51<00:20,  6.84s/it]  {'epoch': 28, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9297, 'compress@10': 0.714, 'time@10': 8.8254}:  80%|████████  | 8/10 [00:51<00:14,  7.11s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.934, 'compress@10': 0.7134, 'time@10': 9.2901}:  80%|████████  | 8/10 [00:57<00:14,  7.11s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.934, 'compress@10': 0.7134, 'time@10': 9.2901}:  90%|█████████ | 9/10 [00:57<00:06,  6.93s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9345, 'compress@10': 0.7128, 'time@10': 9.3649}:  90%|█████████ | 9/10 [01:07<00:06,  6.93s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9345, 'compress@10': 0.7128, 'time@10': 9.3649}: 100%|██████████| 10/10 [01:07<00:00,  7.90s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9345, 'compress@10': 0.7128, 'time@10': 9.3649}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.016003098535576334
Avg hit ratio: 0.9035414317808206
Avg ndcg: 0.9344883720511348
Avg compression ratio: 0.7127562825218969
Avg train time: 9.364869165420533
Std train time: 2.6661633294033793
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9008, 'compress@10': 0.7158, 'time@10': 8.43}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9008, 'compress@10': 0.7158, 'time@10': 8.43}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9318, 'compress@10': 0.7127, 'time@10': 7.6497}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9318, 'compress@10': 0.7127, 'time@10': 7.6497}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9069, 'compress@10': 0.7228, 'time@10': 6.9298}:  20%|██        | 2/10 [00:13<00:46,  5.81s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9069, 'compress@10': 0.7228, 'time@10': 6.9298}:  30%|███       | 3/10 [00:13<00:31,  4.43s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9184, 'compress@10': 0.7197, 'time@10': 6.756}:  30%|███       | 3/10 [00:20<00:31,  4.43s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9184, 'compress@10': 0.7197, 'time@10': 6.756}:  40%|████      | 4/10 [00:20<00:30,  5.16s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9132, 'compress@10': 0.717, 'time@10': 8.2648}:  40%|████      | 4/10 [00:27<00:30,  5.16s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9132, 'compress@10': 0.717, 'time@10': 8.2648}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9221, 'compress@10': 0.7153, 'time@10': 8.6279}:  50%|█████     | 5/10 [00:37<00:29,  5.89s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9221, 'compress@10': 0.7153, 'time@10': 8.6279}:  60%|██████    | 6/10 [00:37<00:29,  7.45s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.901, 'ndcg@10': 0.925, 'compress@10': 0.7148, 'time@10': 8.9867}:  60%|██████    | 6/10 [00:43<00:29,  7.45s/it]  {'epoch': 29, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.901, 'ndcg@10': 0.925, 'compress@10': 0.7148, 'time@10': 8.9867}:  70%|███████   | 7/10 [00:43<00:20,  6.85s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.9376, 'compress@10': 0.714, 'time@10': 8.8191}:  70%|███████   | 7/10 [00:51<00:20,  6.85s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.9376, 'compress@10': 0.714, 'time@10': 8.8191}:  80%|████████  | 8/10 [00:51<00:14,  7.11s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.947, 'compress@10': 0.7134, 'time@10': 9.2361}:  80%|████████  | 8/10 [00:57<00:14,  7.11s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8976, 'ndcg@10': 0.947, 'compress@10': 0.7134, 'time@10': 9.2361}:  90%|█████████ | 9/10 [00:57<00:06,  6.87s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9498, 'compress@10': 0.7128, 'time@10': 9.3279}:  90%|█████████ | 9/10 [01:07<00:06,  6.87s/it] {'epoch': 29, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9498, 'compress@10': 0.7128, 'time@10': 9.3279}: 100%|██████████| 10/10 [01:07<00:00,  7.90s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0166, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9498, 'compress@10': 0.7128, 'time@10': 9.3279}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.01660614263107217
Avg hit ratio: 0.9055414317808206
Avg ndcg: 0.949782884098154
Avg compression ratio: 0.7127562636612843
Avg train time: 9.32788019180298
Std train time: 2.7281068241359985
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9057, 'compress@10': 0.7158, 'time@10': 8.4936}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9057, 'compress@10': 0.7158, 'time@10': 8.4936}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9357, 'compress@10': 0.7127, 'time@10': 7.7401}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9357, 'compress@10': 0.7127, 'time@10': 7.7401}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9095, 'compress@10': 0.7228, 'time@10': 6.9184}:  20%|██        | 2/10 [00:13<00:47,  5.89s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9095, 'compress@10': 0.7228, 'time@10': 6.9184}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9204, 'compress@10': 0.7197, 'time@10': 6.7112}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9204, 'compress@10': 0.7197, 'time@10': 6.7112}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9175, 'compress@10': 0.717, 'time@10': 8.1267}:  40%|████      | 4/10 [00:27<00:30,  5.10s/it] {'epoch': 30, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.9175, 'compress@10': 0.717, 'time@10': 8.1267}:  50%|█████     | 5/10 [00:27<00:28,  5.76s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9313, 'compress@10': 0.7153, 'time@10': 8.4925}:  50%|█████     | 5/10 [00:37<00:28,  5.76s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9313, 'compress@10': 0.7153, 'time@10': 8.4925}:  60%|██████    | 6/10 [00:37<00:29,  7.32s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0174, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9295, 'compress@10': 0.7148, 'time@10': 8.8611}:  60%|██████    | 6/10 [00:42<00:29,  7.32s/it] {'epoch': 30, 'num_users': 6.2857, 'loss': 0.0174, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9295, 'compress@10': 0.7148, 'time@10': 8.8611}:  70%|███████   | 7/10 [00:42<00:20,  6.75s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.9315, 'compress@10': 0.714, 'time@10': 8.7274}:  70%|███████   | 7/10 [00:50<00:20,  6.75s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.9098, 'ndcg@10': 0.9315, 'compress@10': 0.714, 'time@10': 8.7274}:  80%|████████  | 8/10 [00:50<00:14,  7.09s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9412, 'compress@10': 0.7134, 'time@10': 9.1589}:  80%|████████  | 8/10 [00:57<00:14,  7.09s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9412, 'compress@10': 0.7134, 'time@10': 9.1589}:  90%|█████████ | 9/10 [00:57<00:06,  6.86s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9441, 'compress@10': 0.7128, 'time@10': 9.2558}:  90%|█████████ | 9/10 [01:07<00:06,  6.86s/it]  {'epoch': 30, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9441, 'compress@10': 0.7128, 'time@10': 9.2558}: 100%|██████████| 10/10 [01:07<00:00,  7.88s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9441, 'compress@10': 0.7128, 'time@10': 9.2558}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.01957651718243449
Avg hit ratio: 0.9083985746379634
Avg ndcg: 0.9441486825510463
Avg compression ratio: 0.7127562654310204
Avg train time: 9.255764126777649
Std train time: 2.659870513562971
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9056, 'compress@10': 0.7158, 'time@10': 8.4763}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9056, 'compress@10': 0.7158, 'time@10': 8.4763}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9387, 'compress@10': 0.7127, 'time@10': 7.7844}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9387, 'compress@10': 0.7127, 'time@10': 7.7844}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9115, 'compress@10': 0.7228, 'time@10': 6.9874}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9115, 'compress@10': 0.7228, 'time@10': 6.9874}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9209, 'compress@10': 0.7197, 'time@10': 6.799}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9209, 'compress@10': 0.7197, 'time@10': 6.799}:  40%|████      | 4/10 [00:20<00:31,  5.19s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9188, 'compress@10': 0.717, 'time@10': 8.2206}:  40%|████      | 4/10 [00:27<00:31,  5.19s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9188, 'compress@10': 0.717, 'time@10': 8.2206}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9271, 'compress@10': 0.7153, 'time@10': 8.6034}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9271, 'compress@10': 0.7153, 'time@10': 8.6034}:  60%|██████    | 6/10 [00:37<00:29,  7.44s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9302, 'compress@10': 0.7148, 'time@10': 8.9867}:  60%|██████    | 6/10 [00:43<00:29,  7.44s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9302, 'compress@10': 0.7148, 'time@10': 8.9867}:  70%|███████   | 7/10 [00:43<00:20,  6.86s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.934, 'compress@10': 0.714, 'time@10': 8.8444}:  70%|███████   | 7/10 [00:51<00:20,  6.86s/it]  {'epoch': 31, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.934, 'compress@10': 0.714, 'time@10': 8.8444}:  80%|████████  | 8/10 [00:51<00:14,  7.19s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9368, 'compress@10': 0.7134, 'time@10': 9.3929}:  80%|████████  | 8/10 [00:58<00:14,  7.19s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9368, 'compress@10': 0.7134, 'time@10': 9.3929}:  90%|█████████ | 9/10 [00:58<00:07,  7.11s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9399, 'compress@10': 0.7128, 'time@10': 9.4402}:  90%|█████████ | 9/10 [01:08<00:07,  7.11s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9399, 'compress@10': 0.7128, 'time@10': 9.4402}: 100%|██████████| 10/10 [01:08<00:00,  7.97s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9399, 'compress@10': 0.7128, 'time@10': 9.4402}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.012910800904285997
Avg hit ratio: 0.8865450160102112
Avg ndcg: 0.939870686155212
Avg compression ratio: 0.7127562735812003
Avg train time: 9.440248680114745
Std train time: 2.8139134985720307
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7158, 'time@10': 8.4211}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7158, 'time@10': 8.4211}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9667, 'compress@10': 0.7127, 'time@10': 7.7901}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]  {'epoch': 32, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9667, 'compress@10': 0.7127, 'time@10': 7.7901}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9302, 'compress@10': 0.7228, 'time@10': 7.049}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9302, 'compress@10': 0.7228, 'time@10': 7.049}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9367, 'compress@10': 0.7197, 'time@10': 6.8823}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9367, 'compress@10': 0.7197, 'time@10': 6.8823}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.9325, 'compress@10': 0.717, 'time@10': 8.3155}:  40%|████      | 4/10 [00:27<00:31,  5.28s/it] {'epoch': 32, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.9325, 'compress@10': 0.717, 'time@10': 8.3155}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9392, 'compress@10': 0.7153, 'time@10': 8.598}:  50%|█████     | 5/10 [00:37<00:29,  5.92s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9392, 'compress@10': 0.7153, 'time@10': 8.598}:  60%|██████    | 6/10 [00:37<00:29,  7.32s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.941, 'compress@10': 0.7148, 'time@10': 8.9471}:  60%|██████    | 6/10 [00:43<00:29,  7.32s/it] {'epoch': 32, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.941, 'compress@10': 0.7148, 'time@10': 8.9471}:  70%|███████   | 7/10 [00:43<00:20,  6.75s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9382, 'compress@10': 0.714, 'time@10': 8.8328}:  70%|███████   | 7/10 [00:51<00:20,  6.75s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9382, 'compress@10': 0.714, 'time@10': 8.8328}:  80%|████████  | 8/10 [00:51<00:14,  7.17s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9408, 'compress@10': 0.7134, 'time@10': 9.3863}:  80%|████████  | 8/10 [00:58<00:14,  7.17s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9408, 'compress@10': 0.7134, 'time@10': 9.3863}:  90%|█████████ | 9/10 [00:58<00:07,  7.10s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9439, 'compress@10': 0.7128, 'time@10': 9.4796}:  90%|█████████ | 9/10 [01:08<00:07,  7.10s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9439, 'compress@10': 0.7128, 'time@10': 9.4796}: 100%|██████████| 10/10 [01:08<00:00,  8.10s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9439, 'compress@10': 0.7128, 'time@10': 9.4796}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.013797320848906402
Avg hit ratio: 0.8823156253292076
Avg ndcg: 0.9438576511906469
Avg compression ratio: 0.7127562825218969
Avg train time: 9.479568219184875
Std train time: 2.7674010875401094
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7158, 'time@10': 8.6506}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7158, 'time@10': 8.6506}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9432, 'compress@10': 0.7127, 'time@10': 7.8443}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9432, 'compress@10': 0.7127, 'time@10': 7.8443}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9145, 'compress@10': 0.7228, 'time@10': 7.1083}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9145, 'compress@10': 0.7228, 'time@10': 7.1083}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9253, 'compress@10': 0.7197, 'time@10': 6.9001}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9253, 'compress@10': 0.7197, 'time@10': 6.9001}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9256, 'compress@10': 0.717, 'time@10': 8.2744}:  40%|████      | 4/10 [00:27<00:31,  5.24s/it] {'epoch': 33, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9256, 'compress@10': 0.717, 'time@10': 8.2744}:  50%|█████     | 5/10 [00:27<00:29,  5.85s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9326, 'compress@10': 0.7153, 'time@10': 8.6309}:  50%|█████     | 5/10 [00:37<00:29,  5.85s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9326, 'compress@10': 0.7153, 'time@10': 8.6309}:  60%|██████    | 6/10 [00:37<00:29,  7.41s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9399, 'compress@10': 0.7148, 'time@10': 9.0008}:  60%|██████    | 6/10 [00:43<00:29,  7.41s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9399, 'compress@10': 0.7148, 'time@10': 9.0008}:  70%|███████   | 7/10 [00:43<00:20,  6.83s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9428, 'compress@10': 0.714, 'time@10': 8.8464}:  70%|███████   | 7/10 [00:51<00:20,  6.83s/it]  {'epoch': 33, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9428, 'compress@10': 0.714, 'time@10': 8.8464}:  80%|████████  | 8/10 [00:51<00:14,  7.14s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9446, 'compress@10': 0.7134, 'time@10': 9.2827}:  80%|████████  | 8/10 [00:57<00:14,  7.14s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9446, 'compress@10': 0.7134, 'time@10': 9.2827}:  90%|█████████ | 9/10 [00:57<00:06,  6.92s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9444, 'compress@10': 0.7128, 'time@10': 9.3481}:  90%|█████████ | 9/10 [01:07<00:06,  6.92s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9444, 'compress@10': 0.7128, 'time@10': 9.3481}: 100%|██████████| 10/10 [01:07<00:00,  7.86s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9444, 'compress@10': 0.7128, 'time@10': 9.3481}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.014642659302659422
Avg hit ratio: 0.9075414317808205
Avg ndcg: 0.9443845784357642
Avg compression ratio: 0.7127562825218969
Avg train time: 9.348079562187195
Std train time: 2.6044153446292033
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7158, 'time@10': 8.5283}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9197, 'compress@10': 0.7158, 'time@10': 8.5283}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9522, 'compress@10': 0.7127, 'time@10': 7.7832}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9522, 'compress@10': 0.7127, 'time@10': 7.7832}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9205, 'compress@10': 0.7228, 'time@10': 7.0596}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9205, 'compress@10': 0.7228, 'time@10': 7.0596}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9299, 'compress@10': 0.7197, 'time@10': 6.8873}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9299, 'compress@10': 0.7197, 'time@10': 6.8873}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9299, 'compress@10': 0.717, 'time@10': 8.251}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]  {'epoch': 34, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9299, 'compress@10': 0.717, 'time@10': 8.251}:  50%|█████     | 5/10 [00:27<00:29,  5.85s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9371, 'compress@10': 0.7153, 'time@10': 8.5897}:  50%|█████     | 5/10 [00:37<00:29,  5.85s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9371, 'compress@10': 0.7153, 'time@10': 8.5897}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9357, 'compress@10': 0.7148, 'time@10': 9.0908}:  60%|██████    | 6/10 [00:43<00:29,  7.38s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9357, 'compress@10': 0.7148, 'time@10': 9.0908}:  70%|███████   | 7/10 [00:43<00:20,  6.96s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9411, 'compress@10': 0.714, 'time@10': 8.9281}:  70%|███████   | 7/10 [00:51<00:20,  6.96s/it]  {'epoch': 34, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9411, 'compress@10': 0.714, 'time@10': 8.9281}:  80%|████████  | 8/10 [00:51<00:14,  7.23s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9439, 'compress@10': 0.7134, 'time@10': 9.4376}:  80%|████████  | 8/10 [00:58<00:14,  7.23s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9439, 'compress@10': 0.7134, 'time@10': 9.4376}:  90%|█████████ | 9/10 [00:58<00:07,  7.10s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9472, 'compress@10': 0.7128, 'time@10': 9.5206}:  90%|█████████ | 9/10 [01:08<00:07,  7.10s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9472, 'compress@10': 0.7128, 'time@10': 9.5206}: 100%|██████████| 10/10 [01:08<00:00,  8.09s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9472, 'compress@10': 0.7128, 'time@10': 9.5206}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.013944673540696537
Avg hit ratio: 0.9046842889236777
Avg ndcg: 0.9472222382667154
Avg compression ratio: 0.7127561641470723
Avg train time: 9.520603394508361
Std train time: 2.7673647324209627
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.7158, 'time@10': 8.5107}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.7158, 'time@10': 8.5107}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9622, 'compress@10': 0.7127, 'time@10': 7.7579}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9622, 'compress@10': 0.7127, 'time@10': 7.7579}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9272, 'compress@10': 0.7228, 'time@10': 7.0099}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9272, 'compress@10': 0.7228, 'time@10': 7.0099}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9359, 'compress@10': 0.7197, 'time@10': 6.8263}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9359, 'compress@10': 0.7197, 'time@10': 6.8263}:  40%|████      | 4/10 [00:20<00:31,  5.21s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9352, 'compress@10': 0.717, 'time@10': 8.2491}:  40%|████      | 4/10 [00:27<00:31,  5.21s/it] {'epoch': 35, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9352, 'compress@10': 0.717, 'time@10': 8.2491}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9415, 'compress@10': 0.7153, 'time@10': 8.5929}:  50%|█████     | 5/10 [00:37<00:29,  5.86s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9415, 'compress@10': 0.7153, 'time@10': 8.5929}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9427, 'compress@10': 0.7148, 'time@10': 8.9848}:  60%|██████    | 6/10 [00:43<00:29,  7.38s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9427, 'compress@10': 0.7148, 'time@10': 8.9848}:  70%|███████   | 7/10 [00:43<00:20,  6.83s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0097, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9446, 'compress@10': 0.714, 'time@10': 8.8248}:  70%|███████   | 7/10 [00:51<00:20,  6.83s/it]  {'epoch': 35, 'num_users': 6.125, 'loss': 0.0097, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9446, 'compress@10': 0.714, 'time@10': 8.8248}:  80%|████████  | 8/10 [00:51<00:14,  7.13s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9465, 'compress@10': 0.7134, 'time@10': 9.3383}:  80%|████████  | 8/10 [00:58<00:14,  7.13s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9465, 'compress@10': 0.7134, 'time@10': 9.3383}:  90%|█████████ | 9/10 [00:58<00:07,  7.01s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9493, 'compress@10': 0.7128, 'time@10': 9.4291}:  90%|█████████ | 9/10 [01:08<00:07,  7.01s/it]    {'epoch': 35, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9493, 'compress@10': 0.7128, 'time@10': 9.4291}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9493, 'compress@10': 0.7128, 'time@10': 9.4291}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.010989757229871897
Avg hit ratio: 0.9135219745355568
Avg ndcg: 0.9493147612710429
Avg compression ratio: 0.7127562770723295
Avg train time: 9.42910463809967
Std train time: 2.766586768495606
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.7158, 'time@10': 8.5882}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.7158, 'time@10': 8.5882}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9458, 'compress@10': 0.7127, 'time@10': 7.8178}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9458, 'compress@10': 0.7127, 'time@10': 7.8178}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9163, 'compress@10': 0.7228, 'time@10': 7.0566}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9163, 'compress@10': 0.7228, 'time@10': 7.0566}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.926, 'compress@10': 0.7197, 'time@10': 6.8638}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.926, 'compress@10': 0.7197, 'time@10': 6.8638}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9271, 'compress@10': 0.717, 'time@10': 8.3002}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9271, 'compress@10': 0.717, 'time@10': 8.3002}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.935, 'compress@10': 0.7153, 'time@10': 8.6402}:  50%|█████     | 5/10 [00:37<00:29,  5.89s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.9109, 'ndcg@10': 0.935, 'compress@10': 0.7153, 'time@10': 8.6402}:  60%|██████    | 6/10 [00:37<00:29,  7.41s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9373, 'compress@10': 0.7148, 'time@10': 9.0424}:  60%|██████    | 6/10 [00:43<00:29,  7.41s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9373, 'compress@10': 0.7148, 'time@10': 9.0424}:  70%|███████   | 7/10 [00:43<00:20,  6.87s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9246, 'ndcg@10': 0.9405, 'compress@10': 0.714, 'time@10': 8.9064}:  70%|███████   | 7/10 [00:51<00:20,  6.87s/it]  {'epoch': 36, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9246, 'ndcg@10': 0.9405, 'compress@10': 0.714, 'time@10': 8.9064}:  80%|████████  | 8/10 [00:51<00:14,  7.23s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9432, 'compress@10': 0.7134, 'time@10': 9.3749}:  80%|████████  | 8/10 [00:58<00:14,  7.23s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9432, 'compress@10': 0.7134, 'time@10': 9.3749}:  90%|█████████ | 9/10 [00:58<00:07,  7.03s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.9174, 'ndcg@10': 0.9425, 'compress@10': 0.7128, 'time@10': 9.462}:  90%|█████████ | 9/10 [01:08<00:07,  7.03s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.9174, 'ndcg@10': 0.9425, 'compress@10': 0.7128, 'time@10': 9.462}: 100%|██████████| 10/10 [01:08<00:00,  8.04s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.9174, 'ndcg@10': 0.9425, 'compress@10': 0.7128, 'time@10': 9.462}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.013834344255305336
Avg hit ratio: 0.9173827016220905
Avg ndcg: 0.9424710555884417
Avg compression ratio: 0.7127562757099376
Avg train time: 9.461961317062379
Std train time: 2.7230859278579955
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.7158, 'time@10': 8.5001}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.7158, 'time@10': 8.5001}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9458, 'compress@10': 0.7127, 'time@10': 7.7601}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9458, 'compress@10': 0.7127, 'time@10': 7.7601}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9163, 'compress@10': 0.7228, 'time@10': 7.0622}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9163, 'compress@10': 0.7228, 'time@10': 7.0622}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9272, 'compress@10': 0.7197, 'time@10': 6.8637}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9272, 'compress@10': 0.7197, 'time@10': 6.8637}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9294, 'compress@10': 0.717, 'time@10': 8.3593}:  40%|████      | 4/10 [00:27<00:31,  5.23s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9294, 'compress@10': 0.717, 'time@10': 8.3593}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9414, 'compress@10': 0.7153, 'time@10': 8.7417}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9414, 'compress@10': 0.7153, 'time@10': 8.7417}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.016, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9515, 'compress@10': 0.7148, 'time@10': 9.0847}:  60%|██████    | 6/10 [00:44<00:30,  7.56s/it] {'epoch': 37, 'num_users': 6.2857, 'loss': 0.016, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9515, 'compress@10': 0.7148, 'time@10': 9.0847}:  70%|███████   | 7/10 [00:44<00:20,  6.92s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0154, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9522, 'compress@10': 0.714, 'time@10': 8.9128}:  70%|███████   | 7/10 [00:51<00:20,  6.92s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0154, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9522, 'compress@10': 0.714, 'time@10': 8.9128}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9528, 'compress@10': 0.7134, 'time@10': 9.3779}:  80%|████████  | 8/10 [00:58<00:14,  7.18s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9528, 'compress@10': 0.7134, 'time@10': 9.3779}:  90%|█████████ | 9/10 [00:58<00:06,  6.99s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9553, 'compress@10': 0.7128, 'time@10': 9.4676}:  90%|█████████ | 9/10 [01:08<00:06,  6.99s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9553, 'compress@10': 0.7128, 'time@10': 9.4676}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9553, 'compress@10': 0.7128, 'time@10': 9.4676}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.014507509130551582
Avg hit ratio: 0.8932557174951062
Avg ndcg: 0.9552777223069888
Avg compression ratio: 0.7127562740447919
Avg train time: 9.46756157875061
Std train time: 2.765983558788272
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.7158, 'time@10': 8.4345}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.7158, 'time@10': 8.4345}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9549, 'compress@10': 0.7127, 'time@10': 7.7543}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9549, 'compress@10': 0.7127, 'time@10': 7.7543}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9223, 'compress@10': 0.7228, 'time@10': 7.0614}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9223, 'compress@10': 0.7228, 'time@10': 7.0614}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9322, 'compress@10': 0.7197, 'time@10': 6.9}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it]   {'epoch': 38, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9322, 'compress@10': 0.7197, 'time@10': 6.9}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9338, 'compress@10': 0.717, 'time@10': 8.3171}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9338, 'compress@10': 0.717, 'time@10': 8.3171}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9407, 'compress@10': 0.7153, 'time@10': 8.6742}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9407, 'compress@10': 0.7153, 'time@10': 8.6742}:  60%|██████    | 6/10 [00:38<00:29,  7.48s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9421, 'compress@10': 0.7148, 'time@10': 9.0319}:  60%|██████    | 6/10 [00:43<00:29,  7.48s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9421, 'compress@10': 0.7148, 'time@10': 9.0319}:  70%|███████   | 7/10 [00:43<00:20,  6.87s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9445, 'compress@10': 0.714, 'time@10': 8.8621}:  70%|███████   | 7/10 [00:51<00:20,  6.87s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9445, 'compress@10': 0.714, 'time@10': 8.8621}:  80%|████████  | 8/10 [00:51<00:14,  7.14s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9465, 'compress@10': 0.7134, 'time@10': 9.3771}:  80%|████████  | 8/10 [00:58<00:14,  7.14s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9465, 'compress@10': 0.7134, 'time@10': 9.3771}:  90%|█████████ | 9/10 [00:58<00:07,  7.03s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9475, 'compress@10': 0.7128, 'time@10': 9.4774}:  90%|█████████ | 9/10 [01:08<00:07,  7.03s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9475, 'compress@10': 0.7128, 'time@10': 9.4774}: 100%|██████████| 10/10 [01:08<00:00,  8.07s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9475, 'compress@10': 0.7128, 'time@10': 9.4774}: 100%|██████████| 10/10 [01:08<00:00,  6.88s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.011757608874343498
Avg hit ratio: 0.8914021588673542
Avg ndcg: 0.947514558325186
Avg compression ratio: 0.7127562825218969
Avg train time: 9.477355599403381
Std train time: 2.740239276677383
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.7158, 'time@10': 8.267}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9261, 'compress@10': 0.7158, 'time@10': 8.267}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9806, 'compress@10': 0.7127, 'time@10': 7.6237}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9806, 'compress@10': 0.7127, 'time@10': 7.6237}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9394, 'compress@10': 0.7228, 'time@10': 6.9137}:  20%|██        | 2/10 [00:13<00:46,  5.84s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9394, 'compress@10': 0.7228, 'time@10': 6.9137}:  30%|███       | 3/10 [00:13<00:31,  4.45s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.945, 'compress@10': 0.7197, 'time@10': 6.7566}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.945, 'compress@10': 0.7197, 'time@10': 6.7566}:  40%|████      | 4/10 [00:20<00:31,  5.19s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9446, 'compress@10': 0.717, 'time@10': 8.1902}:  40%|████      | 4/10 [00:27<00:31,  5.19s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9446, 'compress@10': 0.717, 'time@10': 8.1902}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9497, 'compress@10': 0.7153, 'time@10': 8.5573}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9497, 'compress@10': 0.7153, 'time@10': 8.5573}:  60%|██████    | 6/10 [00:37<00:29,  7.40s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9504, 'compress@10': 0.7148, 'time@10': 8.9343}:  60%|██████    | 6/10 [00:43<00:29,  7.40s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9504, 'compress@10': 0.7148, 'time@10': 8.9343}:  70%|███████   | 7/10 [00:43<00:20,  6.82s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9512, 'compress@10': 0.714, 'time@10': 8.7999}:  70%|███████   | 7/10 [00:51<00:20,  6.82s/it]  {'epoch': 39, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9512, 'compress@10': 0.714, 'time@10': 8.7999}:  80%|████████  | 8/10 [00:51<00:14,  7.17s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9524, 'compress@10': 0.7134, 'time@10': 9.2229}:  80%|████████  | 8/10 [00:57<00:14,  7.17s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0106, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9524, 'compress@10': 0.7134, 'time@10': 9.2229}:  90%|█████████ | 9/10 [00:57<00:06,  6.91s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9607, 'compress@10': 0.7128, 'time@10': 9.3305}:  90%|█████████ | 9/10 [01:07<00:06,  6.91s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9607, 'compress@10': 0.7128, 'time@10': 9.3305}: 100%|██████████| 10/10 [01:07<00:00,  7.97s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9607, 'compress@10': 0.7128, 'time@10': 9.3305}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.012246975980900247
Avg hit ratio: 0.9063227937879891
Avg ndcg: 0.9607231574532822
Avg compression ratio: 0.7127562652706098
Avg train time: 9.330474066734315
Std train time: 2.6495043801631657
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9287, 'compress@10': 0.7158, 'time@10': 8.3644}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9287, 'compress@10': 0.7158, 'time@10': 8.3644}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9482, 'compress@10': 0.7127, 'time@10': 7.689}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]  {'epoch': 40, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9482, 'compress@10': 0.7127, 'time@10': 7.689}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9179, 'compress@10': 0.7228, 'time@10': 6.9704}:  20%|██        | 2/10 [00:14<00:47,  5.88s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9179, 'compress@10': 0.7228, 'time@10': 6.9704}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9289, 'compress@10': 0.7197, 'time@10': 6.7798}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9289, 'compress@10': 0.7197, 'time@10': 6.7798}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.933, 'compress@10': 0.717, 'time@10': 8.2567}:  40%|████      | 4/10 [00:27<00:31,  5.17s/it]  {'epoch': 40, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.933, 'compress@10': 0.717, 'time@10': 8.2567}:  50%|█████     | 5/10 [00:27<00:29,  5.88s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9418, 'compress@10': 0.7153, 'time@10': 8.6051}:  50%|█████     | 5/10 [00:37<00:29,  5.88s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9418, 'compress@10': 0.7153, 'time@10': 8.6051}:  60%|██████    | 6/10 [00:37<00:29,  7.41s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9435, 'compress@10': 0.7148, 'time@10': 8.9896}:  60%|██████    | 6/10 [00:43<00:29,  7.41s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9435, 'compress@10': 0.7148, 'time@10': 8.9896}:  70%|███████   | 7/10 [00:43<00:20,  6.85s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9452, 'compress@10': 0.714, 'time@10': 8.8476}:  70%|███████   | 7/10 [00:51<00:20,  6.85s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9452, 'compress@10': 0.714, 'time@10': 8.8476}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9488, 'compress@10': 0.7134, 'time@10': 9.2925}:  80%|████████  | 8/10 [00:57<00:14,  7.18s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9488, 'compress@10': 0.7134, 'time@10': 9.2925}:  90%|█████████ | 9/10 [00:57<00:06,  6.95s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9516, 'compress@10': 0.7128, 'time@10': 9.3797}:  90%|█████████ | 9/10 [01:08<00:06,  6.95s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9516, 'compress@10': 0.7128, 'time@10': 9.3797}: 100%|██████████| 10/10 [01:08<00:00,  7.96s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9516, 'compress@10': 0.7128, 'time@10': 9.3797}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.01230417118316389
Avg hit ratio: 0.9046842889236777
Avg ndcg: 0.9516167284876584
Avg compression ratio: 0.7127562640705207
Avg train time: 9.379735803604126
Std train time: 2.720057610132785
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9287, 'compress@10': 0.7158, 'time@10': 8.4505}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9287, 'compress@10': 0.7158, 'time@10': 8.4505}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9482, 'compress@10': 0.7127, 'time@10': 7.7772}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9482, 'compress@10': 0.7127, 'time@10': 7.7772}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9179, 'compress@10': 0.7228, 'time@10': 7.0612}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9179, 'compress@10': 0.7228, 'time@10': 7.0612}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9289, 'compress@10': 0.7197, 'time@10': 6.879}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9289, 'compress@10': 0.7197, 'time@10': 6.879}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.932, 'compress@10': 0.717, 'time@10': 8.2688}:  40%|████      | 4/10 [00:27<00:31,  5.26s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.932, 'compress@10': 0.717, 'time@10': 8.2688}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.008, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9393, 'compress@10': 0.7153, 'time@10': 8.6492}:  50%|█████     | 5/10 [00:38<00:29,  5.87s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.008, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9393, 'compress@10': 0.7153, 'time@10': 8.6492}:  60%|██████    | 6/10 [00:38<00:29,  7.48s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9445, 'compress@10': 0.7148, 'time@10': 9.0205}:  60%|██████    | 6/10 [00:43<00:29,  7.48s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9445, 'compress@10': 0.7148, 'time@10': 9.0205}:  70%|███████   | 7/10 [00:43<00:20,  6.88s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.947, 'compress@10': 0.714, 'time@10': 8.8686}:  70%|███████   | 7/10 [00:51<00:20,  6.88s/it]   {'epoch': 41, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.947, 'compress@10': 0.714, 'time@10': 8.8686}:  80%|████████  | 8/10 [00:51<00:14,  7.19s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9511, 'compress@10': 0.7134, 'time@10': 9.3252}:  80%|████████  | 8/10 [00:58<00:14,  7.19s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9511, 'compress@10': 0.7134, 'time@10': 9.3252}:  90%|█████████ | 9/10 [00:58<00:06,  6.98s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9529, 'compress@10': 0.7128, 'time@10': 9.4279}:  90%|█████████ | 9/10 [01:08<00:06,  6.98s/it]    {'epoch': 41, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9529, 'compress@10': 0.7128, 'time@10': 9.4279}: 100%|██████████| 10/10 [01:08<00:00,  8.03s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9529, 'compress@10': 0.7128, 'time@10': 9.4279}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.010299319490620022
Avg hit ratio: 0.911033495272884
Avg ndcg: 0.9528514655210831
Avg compression ratio: 0.7127562451197293
Avg train time: 9.427858448028564
Std train time: 2.6531639095883834
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.7158, 'time@10': 8.4335}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.7158, 'time@10': 8.4335}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9676, 'compress@10': 0.7127, 'time@10': 7.7365}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9676, 'compress@10': 0.7127, 'time@10': 7.7365}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9308, 'compress@10': 0.7228, 'time@10': 6.9925}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9308, 'compress@10': 0.7228, 'time@10': 6.9925}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9386, 'compress@10': 0.7197, 'time@10': 6.8774}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9386, 'compress@10': 0.7197, 'time@10': 6.8774}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9414, 'compress@10': 0.717, 'time@10': 8.4237}:  40%|████      | 4/10 [00:28<00:31,  5.31s/it] {'epoch': 42, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9414, 'compress@10': 0.717, 'time@10': 8.4237}:  50%|█████     | 5/10 [00:28<00:30,  6.04s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9471, 'compress@10': 0.7153, 'time@10': 8.763}:  50%|█████     | 5/10 [00:38<00:30,  6.04s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9471, 'compress@10': 0.7153, 'time@10': 8.763}:  60%|██████    | 6/10 [00:38<00:30,  7.56s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9482, 'compress@10': 0.7148, 'time@10': 9.1116}:  60%|██████    | 6/10 [00:44<00:30,  7.56s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9482, 'compress@10': 0.7148, 'time@10': 9.1116}:  70%|███████   | 7/10 [00:44<00:20,  6.93s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9497, 'compress@10': 0.714, 'time@10': 8.9813}:  70%|███████   | 7/10 [00:52<00:20,  6.93s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9497, 'compress@10': 0.714, 'time@10': 8.9813}:  80%|████████  | 8/10 [00:52<00:14,  7.30s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.9034, 'ndcg@10': 0.952, 'compress@10': 0.7134, 'time@10': 9.4434}:  80%|████████  | 8/10 [00:58<00:14,  7.30s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.9034, 'ndcg@10': 0.952, 'compress@10': 0.7134, 'time@10': 9.4434}:  90%|█████████ | 9/10 [00:58<00:07,  7.09s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9597, 'compress@10': 0.7128, 'time@10': 9.504}:  90%|█████████ | 9/10 [01:08<00:07,  7.09s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9597, 'compress@10': 0.7128, 'time@10': 9.504}: 100%|██████████| 10/10 [01:08<00:00,  8.01s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9597, 'compress@10': 0.7128, 'time@10': 9.504}: 100%|██████████| 10/10 [01:08<00:00,  6.90s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.012174370075343688
Avg hit ratio: 0.9107672382324334
Avg ndcg: 0.9596639892391347
Avg compression ratio: 0.7127562825218969
Avg train time: 9.504034686088563
Std train time: 2.783651383780434
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9361, 'compress@10': 0.7158, 'time@10': 8.3741}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9361, 'compress@10': 0.7158, 'time@10': 8.3741}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9645, 'compress@10': 0.7127, 'time@10': 7.7405}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9645, 'compress@10': 0.7127, 'time@10': 7.7405}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9287, 'compress@10': 0.7228, 'time@10': 7.0686}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9287, 'compress@10': 0.7228, 'time@10': 7.0686}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.937, 'compress@10': 0.7197, 'time@10': 6.902}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]  {'epoch': 43, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.937, 'compress@10': 0.7197, 'time@10': 6.902}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9404, 'compress@10': 0.717, 'time@10': 8.2998}:  40%|████      | 4/10 [00:27<00:31,  5.30s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9404, 'compress@10': 0.717, 'time@10': 8.2998}:  50%|█████     | 5/10 [00:27<00:29,  5.91s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9506, 'compress@10': 0.7153, 'time@10': 8.6667}:  50%|█████     | 5/10 [00:38<00:29,  5.91s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9506, 'compress@10': 0.7153, 'time@10': 8.6667}:  60%|██████    | 6/10 [00:38<00:29,  7.48s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9513, 'compress@10': 0.7148, 'time@10': 9.045}:  60%|██████    | 6/10 [00:43<00:29,  7.48s/it]  {'epoch': 43, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9513, 'compress@10': 0.7148, 'time@10': 9.045}:  70%|███████   | 7/10 [00:43<00:20,  6.90s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9529, 'compress@10': 0.714, 'time@10': 8.8961}:  70%|███████   | 7/10 [00:51<00:20,  6.90s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9529, 'compress@10': 0.714, 'time@10': 8.8961}:  80%|████████  | 8/10 [00:51<00:14,  7.21s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.954, 'compress@10': 0.7134, 'time@10': 9.3608}:  80%|████████  | 8/10 [00:58<00:14,  7.21s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0117, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.954, 'compress@10': 0.7134, 'time@10': 9.3608}:  90%|█████████ | 9/10 [00:58<00:07,  7.01s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.91, 'ndcg@10': 0.9563, 'compress@10': 0.7128, 'time@10': 9.4403}:  90%|█████████ | 9/10 [01:08<00:07,  7.01s/it]    {'epoch': 43, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.91, 'ndcg@10': 0.9563, 'compress@10': 0.7128, 'time@10': 9.4403}: 100%|██████████| 10/10 [01:08<00:00,  8.00s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.91, 'ndcg@10': 0.9563, 'compress@10': 0.7128, 'time@10': 9.4403}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.010605218918659448
Avg hit ratio: 0.9100299110434934
Avg ndcg: 0.9562998796568097
Avg compression ratio: 0.7127562318114113
Avg train time: 9.440331029891968
Std train time: 2.6518684184529997
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9291, 'compress@10': 0.7158, 'time@10': 8.5608}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9291, 'compress@10': 0.7158, 'time@10': 8.5608}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9484, 'compress@10': 0.7127, 'time@10': 7.7771}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9484, 'compress@10': 0.7127, 'time@10': 7.7771}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0041, 'hit_ratio@10': 0.855, 'ndcg@10': 0.918, 'compress@10': 0.7228, 'time@10': 7.0398}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]  {'epoch': 44, 'num_users': 5.0, 'loss': 0.0041, 'hit_ratio@10': 0.855, 'ndcg@10': 0.918, 'compress@10': 0.7228, 'time@10': 7.0398}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9282, 'compress@10': 0.7197, 'time@10': 6.8514}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9282, 'compress@10': 0.7197, 'time@10': 6.8514}:  40%|████      | 4/10 [00:20<00:31,  5.22s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9334, 'compress@10': 0.717, 'time@10': 8.2388}:  40%|████      | 4/10 [00:27<00:31,  5.22s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9334, 'compress@10': 0.717, 'time@10': 8.2388}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0067, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9407, 'compress@10': 0.7153, 'time@10': 8.6048}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0067, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9407, 'compress@10': 0.7153, 'time@10': 8.6048}:  60%|██████    | 6/10 [00:37<00:29,  7.41s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0065, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9427, 'compress@10': 0.7148, 'time@10': 8.9759}:  60%|██████    | 6/10 [00:43<00:29,  7.41s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0065, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9427, 'compress@10': 0.7148, 'time@10': 8.9759}:  70%|███████   | 7/10 [00:43<00:20,  6.83s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0067, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9447, 'compress@10': 0.714, 'time@10': 8.8155}:  70%|███████   | 7/10 [00:51<00:20,  6.83s/it]  {'epoch': 44, 'num_users': 6.125, 'loss': 0.0067, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9447, 'compress@10': 0.714, 'time@10': 8.8155}:  80%|████████  | 8/10 [00:51<00:14,  7.12s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0083, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9479, 'compress@10': 0.7134, 'time@10': 9.2527}:  80%|████████  | 8/10 [00:57<00:14,  7.12s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0083, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9479, 'compress@10': 0.7134, 'time@10': 9.2527}:  90%|█████████ | 9/10 [00:57<00:06,  6.90s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.9489, 'compress@10': 0.7128, 'time@10': 9.3381}:  90%|█████████ | 9/10 [01:07<00:06,  6.90s/it]    {'epoch': 44, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.9489, 'compress@10': 0.7128, 'time@10': 9.3381}: 100%|██████████| 10/10 [01:07<00:00,  7.90s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.9175, 'ndcg@10': 0.9489, 'compress@10': 0.7128, 'time@10': 9.3381}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.008970219108020861
Avg hit ratio: 0.9174851081761097
Avg ndcg: 0.948907379232191
Avg compression ratio: 0.712756244631738
Avg train time: 9.33806278705597
Std train time: 2.6282652214918754
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9243, 'compress@10': 0.7158, 'time@10': 8.4367}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9243, 'compress@10': 0.7158, 'time@10': 8.4367}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9563, 'compress@10': 0.7127, 'time@10': 7.7814}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9563, 'compress@10': 0.7127, 'time@10': 7.7814}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9233, 'compress@10': 0.7228, 'time@10': 7.042}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9233, 'compress@10': 0.7228, 'time@10': 7.042}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9322, 'compress@10': 0.7197, 'time@10': 6.8599}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9322, 'compress@10': 0.7197, 'time@10': 6.8599}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.936, 'compress@10': 0.717, 'time@10': 8.2595}:  40%|████      | 4/10 [00:27<00:31,  5.25s/it]    {'epoch': 45, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.936, 'compress@10': 0.717, 'time@10': 8.2595}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9425, 'compress@10': 0.7153, 'time@10': 8.6495}:  50%|█████     | 5/10 [00:38<00:29,  5.87s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9425, 'compress@10': 0.7153, 'time@10': 8.6495}:  60%|██████    | 6/10 [00:38<00:29,  7.49s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9444, 'compress@10': 0.7148, 'time@10': 9.0387}:  60%|██████    | 6/10 [00:43<00:29,  7.49s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9444, 'compress@10': 0.7148, 'time@10': 9.0387}:  70%|███████   | 7/10 [00:43<00:20,  6.91s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9456, 'compress@10': 0.714, 'time@10': 8.8975}:  70%|███████   | 7/10 [00:51<00:20,  6.91s/it]  {'epoch': 45, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9456, 'compress@10': 0.714, 'time@10': 8.8975}:  80%|████████  | 8/10 [00:51<00:14,  7.24s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9513, 'compress@10': 0.7134, 'time@10': 9.3193}:  80%|████████  | 8/10 [00:58<00:14,  7.24s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9513, 'compress@10': 0.7134, 'time@10': 9.3193}:  90%|█████████ | 9/10 [00:58<00:06,  6.98s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9578, 'compress@10': 0.7128, 'time@10': 9.3904}:  90%|█████████ | 9/10 [01:08<00:06,  6.98s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9578, 'compress@10': 0.7128, 'time@10': 9.3904}: 100%|██████████| 10/10 [01:08<00:00,  7.93s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9153, 'ndcg@10': 0.9578, 'compress@10': 0.7128, 'time@10': 9.3904}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.01211847252679932
Avg hit ratio: 0.9152557174951064
Avg ndcg: 0.9578446986219655
Avg compression ratio: 0.712756253092859
Avg train time: 9.390386414527892
Std train time: 2.6271597902602384
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.7158, 'time@10': 8.2738}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.7158, 'time@10': 8.2738}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.975, 'compress@10': 0.7127, 'time@10': 7.9622}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it] {'epoch': 46, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.975, 'compress@10': 0.7127, 'time@10': 7.9622}:  20%|██        | 2/10 [00:11<00:50,  6.25s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9357, 'compress@10': 0.7228, 'time@10': 7.3005}:  20%|██        | 2/10 [00:14<00:50,  6.25s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9357, 'compress@10': 0.7228, 'time@10': 7.3005}:  30%|███       | 3/10 [00:14<00:33,  4.78s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9419, 'compress@10': 0.7197, 'time@10': 7.1583}:  30%|███       | 3/10 [00:21<00:33,  4.78s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9419, 'compress@10': 0.7197, 'time@10': 7.1583}:  40%|████      | 4/10 [00:21<00:33,  5.56s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9443, 'compress@10': 0.717, 'time@10': 8.604}:  40%|████      | 4/10 [00:28<00:33,  5.56s/it]  {'epoch': 46, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9443, 'compress@10': 0.717, 'time@10': 8.604}:  50%|█████     | 5/10 [00:28<00:30,  6.16s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9518, 'compress@10': 0.7153, 'time@10': 8.9673}:  50%|█████     | 5/10 [00:39<00:30,  6.16s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9518, 'compress@10': 0.7153, 'time@10': 8.9673}:  60%|██████    | 6/10 [00:39<00:30,  7.75s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9693, 'compress@10': 0.7148, 'time@10': 9.3807}:  60%|██████    | 6/10 [00:45<00:30,  7.75s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9693, 'compress@10': 0.7148, 'time@10': 9.3807}:  70%|███████   | 7/10 [00:45<00:21,  7.17s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9686, 'compress@10': 0.714, 'time@10': 9.1966}:  70%|███████   | 7/10 [00:53<00:21,  7.17s/it]  {'epoch': 46, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9686, 'compress@10': 0.714, 'time@10': 9.1966}:  80%|████████  | 8/10 [00:53<00:14,  7.41s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9718, 'compress@10': 0.7134, 'time@10': 9.5458}:  80%|████████  | 8/10 [00:59<00:14,  7.41s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9718, 'compress@10': 0.7134, 'time@10': 9.5458}:  90%|█████████ | 9/10 [00:59<00:07,  7.04s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9723, 'compress@10': 0.7128, 'time@10': 9.5558}:  90%|█████████ | 9/10 [01:09<00:07,  7.04s/it]    {'epoch': 46, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9723, 'compress@10': 0.7128, 'time@10': 9.5558}: 100%|██████████| 10/10 [01:09<00:00,  7.85s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9723, 'compress@10': 0.7128, 'time@10': 9.5558}: 100%|██████████| 10/10 [01:09<00:00,  6.95s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.016006793583649245
Avg hit ratio: 0.9063156253292076
Avg ndcg: 0.9723225925665846
Avg compression ratio: 0.7127562584435126
Avg train time: 9.55575475692749
Std train time: 2.582313518422367
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.7158, 'time@10': 8.0348}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.7158, 'time@10': 8.0348}:  10%|█         | 1/10 [00:04<00:36,  4.05s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0063, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9472, 'compress@10': 0.7127, 'time@10': 7.3427}:  10%|█         | 1/10 [00:10<00:36,  4.05s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0063, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9472, 'compress@10': 0.7127, 'time@10': 7.3427}:  20%|██        | 2/10 [00:10<00:44,  5.60s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9172, 'compress@10': 0.7228, 'time@10': 6.6313}:  20%|██        | 2/10 [00:13<00:44,  5.60s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9172, 'compress@10': 0.7228, 'time@10': 6.6313}:  30%|███       | 3/10 [00:13<00:29,  4.25s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9276, 'compress@10': 0.7197, 'time@10': 6.4563}:  30%|███       | 3/10 [00:19<00:29,  4.25s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9276, 'compress@10': 0.7197, 'time@10': 6.4563}:  40%|████      | 4/10 [00:19<00:29,  4.93s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9335, 'compress@10': 0.717, 'time@10': 7.8196}:  40%|████      | 4/10 [00:26<00:29,  4.93s/it] {'epoch': 47, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9335, 'compress@10': 0.717, 'time@10': 7.8196}:  50%|█████     | 5/10 [00:26<00:27,  5.56s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0066, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9409, 'compress@10': 0.7153, 'time@10': 8.1726}:  50%|█████     | 5/10 [00:35<00:27,  5.56s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0066, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9409, 'compress@10': 0.7153, 'time@10': 8.1726}:  60%|██████    | 6/10 [00:35<00:28,  7.06s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9433, 'compress@10': 0.7148, 'time@10': 8.5116}:  60%|██████    | 6/10 [00:41<00:28,  7.06s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0069, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9433, 'compress@10': 0.7148, 'time@10': 8.5116}:  70%|███████   | 7/10 [00:41<00:19,  6.49s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0067, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9458, 'compress@10': 0.714, 'time@10': 8.392}:  70%|███████   | 7/10 [00:48<00:19,  6.49s/it]   {'epoch': 47, 'num_users': 6.125, 'loss': 0.0067, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9458, 'compress@10': 0.714, 'time@10': 8.392}:  80%|████████  | 8/10 [00:48<00:13,  6.84s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0076, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9487, 'compress@10': 0.7134, 'time@10': 8.8229}:  80%|████████  | 8/10 [00:55<00:13,  6.84s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0076, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9487, 'compress@10': 0.7134, 'time@10': 8.8229}:  90%|█████████ | 9/10 [00:55<00:06,  6.63s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0071, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9516, 'compress@10': 0.7128, 'time@10': 8.9072}:  90%|█████████ | 9/10 [01:04<00:06,  6.63s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0071, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9516, 'compress@10': 0.7128, 'time@10': 8.9072}: 100%|██████████| 10/10 [01:04<00:00,  7.58s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0071, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9516, 'compress@10': 0.7128, 'time@10': 8.9072}: 100%|██████████| 10/10 [01:04<00:00,  6.48s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.0071231521634852
Avg hit ratio: 0.9166279653189671
Avg ndcg: 0.951594515645448
Avg compression ratio: 0.7127562782833444
Avg train time: 8.907235670089722
Std train time: 2.547749953672538
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.7158, 'time@10': 8.0335}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.7158, 'time@10': 8.0335}:  10%|█         | 1/10 [00:04<00:36,  4.05s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0229, 'compress@10': 0.7127, 'time@10': 7.3703}:  10%|█         | 1/10 [00:10<00:36,  4.05s/it] {'epoch': 48, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0229, 'compress@10': 0.7127, 'time@10': 7.3703}:  20%|██        | 2/10 [00:10<00:45,  5.63s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9677, 'compress@10': 0.7228, 'time@10': 6.7623}:  20%|██        | 2/10 [00:13<00:45,  5.63s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9677, 'compress@10': 0.7228, 'time@10': 6.7623}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9647, 'compress@10': 0.7197, 'time@10': 6.5696}:  30%|███       | 3/10 [00:19<00:30,  4.34s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9647, 'compress@10': 0.7197, 'time@10': 6.5696}:  40%|████      | 4/10 [00:19<00:30,  5.01s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9631, 'compress@10': 0.717, 'time@10': 7.8255}:  40%|████      | 4/10 [00:26<00:30,  5.01s/it] {'epoch': 48, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9631, 'compress@10': 0.717, 'time@10': 7.8255}:  50%|█████     | 5/10 [00:26<00:27,  5.53s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9654, 'compress@10': 0.7153, 'time@10': 8.2116}:  50%|█████     | 5/10 [00:36<00:27,  5.53s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9654, 'compress@10': 0.7153, 'time@10': 8.2116}:  60%|██████    | 6/10 [00:36<00:28,  7.11s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9642, 'compress@10': 0.7148, 'time@10': 8.5668}:  60%|██████    | 6/10 [00:41<00:28,  7.11s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9642, 'compress@10': 0.7148, 'time@10': 8.5668}:  70%|███████   | 7/10 [00:41<00:19,  6.55s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9645, 'compress@10': 0.714, 'time@10': 8.4163}:  70%|███████   | 7/10 [00:49<00:19,  6.55s/it]  {'epoch': 48, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9645, 'compress@10': 0.714, 'time@10': 8.4163}:  80%|████████  | 8/10 [00:49<00:13,  6.82s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9641, 'compress@10': 0.7134, 'time@10': 8.8258}:  80%|████████  | 8/10 [00:55<00:13,  6.82s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9641, 'compress@10': 0.7134, 'time@10': 8.8258}:  90%|█████████ | 9/10 [00:55<00:06,  6.59s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.9637, 'compress@10': 0.7128, 'time@10': 8.8453}:  90%|█████████ | 9/10 [01:04<00:06,  6.59s/it]    {'epoch': 48, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.9637, 'compress@10': 0.7128, 'time@10': 8.8453}: 100%|██████████| 10/10 [01:04<00:00,  7.35s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9124, 'ndcg@10': 0.9637, 'compress@10': 0.7128, 'time@10': 8.8453}: 100%|██████████| 10/10 [01:04<00:00,  6.42s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.010984696593297507
Avg hit ratio: 0.9123985746379635
Avg ndcg: 0.9636873075119323
Avg compression ratio: 0.7127562780515486
Avg train time: 8.845336198806763
Std train time: 2.413194105166064
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 0.7158, 'time@10': 7.3815}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 0.7158, 'time@10': 7.3815}:  10%|█         | 1/10 [00:03<00:33,  3.72s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9496, 'compress@10': 0.7127, 'time@10': 6.8292}:  10%|█         | 1/10 [00:10<00:33,  3.72s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9496, 'compress@10': 0.7127, 'time@10': 6.8292}:  20%|██        | 2/10 [00:10<00:41,  5.25s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.004, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9188, 'compress@10': 0.7228, 'time@10': 6.2795}:  20%|██        | 2/10 [00:12<00:41,  5.25s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.004, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9188, 'compress@10': 0.7228, 'time@10': 6.2795}:  30%|███       | 3/10 [00:12<00:28,  4.06s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9292, 'compress@10': 0.7197, 'time@10': 6.0608}:  30%|███       | 3/10 [00:18<00:28,  4.06s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9292, 'compress@10': 0.7197, 'time@10': 6.0608}:  40%|████      | 4/10 [00:18<00:27,  4.60s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.007, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9347, 'compress@10': 0.717, 'time@10': 7.2005}:  40%|████      | 4/10 [00:24<00:27,  4.60s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.007, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9347, 'compress@10': 0.717, 'time@10': 7.2005}:  50%|█████     | 5/10 [00:24<00:25,  5.08s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.942, 'compress@10': 0.7153, 'time@10': 7.4518}:  50%|█████     | 5/10 [00:32<00:25,  5.08s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.942, 'compress@10': 0.7153, 'time@10': 7.4518}:  60%|██████    | 6/10 [00:32<00:25,  6.33s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9442, 'compress@10': 0.7148, 'time@10': 7.6612}:  60%|██████    | 6/10 [00:37<00:25,  6.33s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9442, 'compress@10': 0.7148, 'time@10': 7.6612}:  70%|███████   | 7/10 [00:37<00:17,  5.73s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9464, 'compress@10': 0.714, 'time@10': 7.4654}:  70%|███████   | 7/10 [00:43<00:17,  5.73s/it]   {'epoch': 49, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9464, 'compress@10': 0.714, 'time@10': 7.4654}:  80%|████████  | 8/10 [00:43<00:11,  5.85s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9487, 'compress@10': 0.7134, 'time@10': 7.7206}:  80%|████████  | 8/10 [00:48<00:11,  5.85s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9487, 'compress@10': 0.7134, 'time@10': 7.7206}:  90%|█████████ | 9/10 [00:48<00:05,  5.56s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0085, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9516, 'compress@10': 0.7128, 'time@10': 7.7072}:  90%|█████████ | 9/10 [00:55<00:05,  5.56s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0085, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9516, 'compress@10': 0.7128, 'time@10': 7.7072}: 100%|██████████| 10/10 [00:55<00:00,  6.20s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0085, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9516, 'compress@10': 0.7128, 'time@10': 7.7072}: 100%|██████████| 10/10 [00:55<00:00,  5.59s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.008498349698829242
Avg hit ratio: 0.9074216161126177
Avg ndcg: 0.9515728617716853
Avg compression ratio: 0.7127562825218969
Avg train time: 7.707207655906677
Std train time: 1.9890929759298857
[0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
[10, 10, 22, 10, 6, 10, 10, 10, 8, 10]
