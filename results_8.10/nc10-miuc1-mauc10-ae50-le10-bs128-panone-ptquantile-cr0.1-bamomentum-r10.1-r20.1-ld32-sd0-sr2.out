  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1629, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.493, 'compress@10': 0.1474, 'time@10': 9.3728}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1629, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.493, 'compress@10': 0.1474, 'time@10': 9.3728}:  10%|█         | 1/10 [00:04<00:42,  4.73s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1181, 'hit_ratio@10': 0.6927, 'ndcg@10': 0.6402, 'compress@10': 0.1382, 'time@10': 8.1873}:  10%|█         | 1/10 [00:11<00:42,  4.73s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1181, 'hit_ratio@10': 0.6927, 'ndcg@10': 0.6402, 'compress@10': 0.1382, 'time@10': 8.1873}:  20%|██        | 2/10 [00:11<00:48,  6.09s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7379, 'hit_ratio@10': 0.557, 'ndcg@10': 0.4268, 'compress@10': 0.1683, 'time@10': 6.403}:  20%|██        | 2/10 [00:13<00:48,  6.09s/it]  {'epoch': 0, 'num_users': 5.0, 'loss': 0.7379, 'hit_ratio@10': 0.557, 'ndcg@10': 0.4268, 'compress@10': 0.1683, 'time@10': 6.403}:  30%|███       | 3/10 [00:13<00:27,  3.97s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.578, 'hit_ratio@10': 0.6053, 'ndcg@10': 0.4847, 'compress@10': 0.1593, 'time@10': 6.3548}:  30%|███       | 3/10 [00:19<00:27,  3.97s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.578, 'hit_ratio@10': 0.6053, 'ndcg@10': 0.4847, 'compress@10': 0.1593, 'time@10': 6.3548}:  40%|████      | 4/10 [00:19<00:29,  4.87s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4809, 'hit_ratio@10': 0.6482, 'ndcg@10': 0.5399, 'compress@10': 0.151, 'time@10': 9.5985}:  40%|████      | 4/10 [00:30<00:29,  4.87s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4809, 'hit_ratio@10': 0.6482, 'ndcg@10': 0.5399, 'compress@10': 0.151, 'time@10': 9.5985}:  50%|█████     | 5/10 [00:30<00:35,  7.20s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4151, 'hit_ratio@10': 0.6513, 'ndcg@10': 0.5825, 'compress@10': 0.1459, 'time@10': 9.5888}:  50%|█████     | 5/10 [00:40<00:35,  7.20s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4151, 'hit_ratio@10': 0.6513, 'ndcg@10': 0.5825, 'compress@10': 0.1459, 'time@10': 9.5888}:  60%|██████    | 6/10 [00:40<00:32,  8.01s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3708, 'hit_ratio@10': 0.6783, 'ndcg@10': 0.5838, 'compress@10': 0.1445, 'time@10': 9.9067}:  60%|██████    | 6/10 [00:46<00:32,  8.01s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3708, 'hit_ratio@10': 0.6783, 'ndcg@10': 0.5838, 'compress@10': 0.1445, 'time@10': 9.9067}:  70%|███████   | 7/10 [00:46<00:21,  7.33s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3302, 'hit_ratio@10': 0.7078, 'ndcg@10': 0.6117, 'compress@10': 0.1421, 'time@10': 9.6412}:  70%|███████   | 7/10 [00:54<00:21,  7.33s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3302, 'hit_ratio@10': 0.7078, 'ndcg@10': 0.6117, 'compress@10': 0.1421, 'time@10': 9.6412}:  80%|████████  | 8/10 [00:54<00:14,  7.49s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2995, 'hit_ratio@10': 0.7053, 'ndcg@10': 0.6437, 'compress@10': 0.1403, 'time@10': 10.275}:  80%|████████  | 8/10 [01:01<00:14,  7.49s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2995, 'hit_ratio@10': 0.7053, 'ndcg@10': 0.6437, 'compress@10': 0.1403, 'time@10': 10.275}:  90%|█████████ | 9/10 [01:01<00:07,  7.56s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2748, 'hit_ratio@10': 0.728, 'ndcg@10': 0.6638, 'compress@10': 0.1383, 'time@10': 10.2225}:  90%|█████████ | 9/10 [01:11<00:07,  7.56s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2748, 'hit_ratio@10': 0.728, 'ndcg@10': 0.6638, 'compress@10': 0.1383, 'time@10': 10.2225}: 100%|██████████| 10/10 [01:11<00:00,  8.25s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2748, 'hit_ratio@10': 0.728, 'ndcg@10': 0.6638, 'compress@10': 0.1383, 'time@10': 10.2225}: 100%|██████████| 10/10 [01:11<00:00,  7.17s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.27481517648574916
Avg hit ratio: 0.7279598115523412
Avg ndcg: 0.6638328421254223
Avg compression ratio: 0.13830989459015947
Avg train time: 10.222479987144471
Std train time: 5.193684374821451
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0531, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8415, 'compress@10': 0.1474, 'time@10': 7.3833}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0531, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8415, 'compress@10': 0.1474, 'time@10': 7.3833}:  10%|█         | 1/10 [00:03<00:33,  3.73s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0531, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8485, 'compress@10': 0.1382, 'time@10': 7.0141}:  10%|█         | 1/10 [00:10<00:33,  3.73s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0531, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8485, 'compress@10': 0.1382, 'time@10': 7.0141}:  20%|██        | 2/10 [00:10<00:43,  5.47s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0442, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.8003, 'compress@10': 0.1683, 'time@10': 5.6509}:  20%|██        | 2/10 [00:11<00:43,  5.47s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0442, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.8003, 'compress@10': 0.1683, 'time@10': 5.6509}:  30%|███       | 3/10 [00:11<00:25,  3.65s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0456, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8109, 'compress@10': 0.1593, 'time@10': 5.8437}:  30%|███       | 3/10 [00:18<00:25,  3.65s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0456, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8109, 'compress@10': 0.1593, 'time@10': 5.8437}:  40%|████      | 4/10 [00:18<00:28,  4.76s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0539, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8057, 'compress@10': 0.151, 'time@10': 8.4749}:  40%|████      | 4/10 [00:27<00:28,  4.76s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.0539, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8057, 'compress@10': 0.151, 'time@10': 8.4749}:  50%|█████     | 5/10 [00:27<00:32,  6.48s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0578, 'hit_ratio@10': 0.784, 'ndcg@10': 0.8069, 'compress@10': 0.1459, 'time@10': 8.7223}:  50%|█████     | 5/10 [00:37<00:32,  6.48s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0578, 'hit_ratio@10': 0.784, 'ndcg@10': 0.8069, 'compress@10': 0.1459, 'time@10': 8.7223}:  60%|██████    | 6/10 [00:37<00:30,  7.68s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0558, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8165, 'compress@10': 0.1445, 'time@10': 8.9794}:  60%|██████    | 6/10 [00:43<00:30,  7.68s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0558, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8165, 'compress@10': 0.1445, 'time@10': 8.9794}:  70%|███████   | 7/10 [00:43<00:20,  6.90s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0535, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8233, 'compress@10': 0.1421, 'time@10': 8.7693}:  70%|███████   | 7/10 [00:50<00:20,  6.90s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0535, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8233, 'compress@10': 0.1421, 'time@10': 8.7693}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0515, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8328, 'compress@10': 0.1403, 'time@10': 9.3212}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0515, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8328, 'compress@10': 0.1403, 'time@10': 9.3212}:  90%|█████████ | 9/10 [00:57<00:06,  7.00s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0509, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8341, 'compress@10': 0.1383, 'time@10': 9.3637}:  90%|█████████ | 9/10 [01:07<00:06,  7.00s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0509, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8341, 'compress@10': 0.1383, 'time@10': 9.3637}: 100%|██████████| 10/10 [01:07<00:00,  7.86s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0509, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8341, 'compress@10': 0.1383, 'time@10': 9.3637}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05093438196410416
Avg hit ratio: 0.8224159519032185
Avg ndcg: 0.8341400639555457
Avg compression ratio: 0.13830988865263802
Avg train time: 9.363712573051453
Std train time: 4.23681576661578
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.1474, 'time@10': 7.9692}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.1474, 'time@10': 7.9692}:  10%|█         | 1/10 [00:04<00:36,  4.02s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.798, 'ndcg@10': 0.845, 'compress@10': 0.1382, 'time@10': 7.2276}:  10%|█         | 1/10 [00:10<00:36,  4.02s/it]  {'epoch': 2, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.798, 'ndcg@10': 0.845, 'compress@10': 0.1382, 'time@10': 7.2276}:  20%|██        | 2/10 [00:10<00:44,  5.52s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8491, 'compress@10': 0.1683, 'time@10': 5.8838}:  20%|██        | 2/10 [00:12<00:44,  5.52s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8491, 'compress@10': 0.1683, 'time@10': 5.8838}:  30%|███       | 3/10 [00:12<00:26,  3.74s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8485, 'compress@10': 0.1593, 'time@10': 5.8722}:  30%|███       | 3/10 [00:18<00:26,  3.74s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8485, 'compress@10': 0.1593, 'time@10': 5.8722}:  40%|████      | 4/10 [00:18<00:27,  4.58s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8359, 'compress@10': 0.151, 'time@10': 8.0988}:  40%|████      | 4/10 [00:26<00:27,  4.58s/it]  {'epoch': 2, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8359, 'compress@10': 0.151, 'time@10': 8.0988}:  50%|█████     | 5/10 [00:26<00:30,  6.01s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0515, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.8334, 'compress@10': 0.1459, 'time@10': 8.536}:  50%|█████     | 5/10 [00:37<00:30,  6.01s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0515, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.8334, 'compress@10': 0.1459, 'time@10': 8.536}:  60%|██████    | 6/10 [00:37<00:30,  7.62s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0501, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.8367, 'compress@10': 0.1445, 'time@10': 8.8013}:  60%|██████    | 6/10 [00:42<00:30,  7.62s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0501, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.8367, 'compress@10': 0.1445, 'time@10': 8.8013}:  70%|███████   | 7/10 [00:42<00:20,  6.84s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0494, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8429, 'compress@10': 0.1421, 'time@10': 8.5912}:  70%|███████   | 7/10 [00:49<00:20,  6.84s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0494, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8429, 'compress@10': 0.1421, 'time@10': 8.5912}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8526, 'compress@10': 0.1403, 'time@10': 9.1878}:  80%|████████  | 8/10 [00:56<00:13,  6.94s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0488, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8526, 'compress@10': 0.1403, 'time@10': 9.1878}:  90%|█████████ | 9/10 [00:56<00:06,  6.97s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8516, 'compress@10': 0.1383, 'time@10': 9.197}:  90%|█████████ | 9/10 [01:06<00:06,  6.97s/it]    {'epoch': 2, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8516, 'compress@10': 0.1383, 'time@10': 9.197}: 100%|██████████| 10/10 [01:06<00:00,  7.69s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8516, 'compress@10': 0.1383, 'time@10': 9.197}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04863489942843405
Avg hit ratio: 0.8190571761760216
Avg ndcg: 0.8515863686142074
Avg compression ratio: 0.13830988904494063
Avg train time: 9.19700198173523
Std train time: 3.845581415878904
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8537, 'compress@10': 0.1474, 'time@10': 7.7399}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8537, 'compress@10': 0.1474, 'time@10': 7.7399}:  10%|█         | 1/10 [00:03<00:35,  3.91s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8508, 'compress@10': 0.1382, 'time@10': 7.3026}:  10%|█         | 1/10 [00:10<00:35,  3.91s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8508, 'compress@10': 0.1382, 'time@10': 7.3026}:  20%|██        | 2/10 [00:10<00:45,  5.67s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8529, 'compress@10': 0.1683, 'time@10': 5.9414}:  20%|██        | 2/10 [00:12<00:45,  5.67s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8529, 'compress@10': 0.1683, 'time@10': 5.9414}:  30%|███       | 3/10 [00:12<00:26,  3.84s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8532, 'compress@10': 0.1593, 'time@10': 5.9105}:  30%|███       | 3/10 [00:18<00:26,  3.84s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8532, 'compress@10': 0.1593, 'time@10': 5.9105}:  40%|████      | 4/10 [00:18<00:27,  4.63s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.842, 'compress@10': 0.151, 'time@10': 7.7585}:  40%|████      | 4/10 [00:25<00:27,  4.63s/it]  {'epoch': 3, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.842, 'compress@10': 0.151, 'time@10': 7.7585}:  50%|█████     | 5/10 [00:25<00:28,  5.71s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0512, 'hit_ratio@10': 0.778, 'ndcg@10': 0.8391, 'compress@10': 0.1459, 'time@10': 8.1459}:  50%|█████     | 5/10 [00:36<00:28,  5.71s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0512, 'hit_ratio@10': 0.778, 'ndcg@10': 0.8391, 'compress@10': 0.1459, 'time@10': 8.1459}:  60%|██████    | 6/10 [00:36<00:28,  7.21s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.804, 'ndcg@10': 0.842, 'compress@10': 0.1445, 'time@10': 8.4872}:  60%|██████    | 6/10 [00:41<00:28,  7.21s/it] {'epoch': 3, 'num_users': 6.2857, 'loss': 0.0508, 'hit_ratio@10': 0.804, 'ndcg@10': 0.842, 'compress@10': 0.1445, 'time@10': 8.4872}:  70%|███████   | 7/10 [00:41<00:19,  6.59s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0533, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8512, 'compress@10': 0.1421, 'time@10': 8.3178}:  70%|███████   | 7/10 [00:48<00:19,  6.59s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0533, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8512, 'compress@10': 0.1421, 'time@10': 8.3178}:  80%|████████  | 8/10 [00:48<00:13,  6.78s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0518, 'hit_ratio@10': 0.819, 'ndcg@10': 0.8573, 'compress@10': 0.1403, 'time@10': 8.9726}:  80%|████████  | 8/10 [00:55<00:13,  6.78s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0518, 'hit_ratio@10': 0.819, 'ndcg@10': 0.8573, 'compress@10': 0.1403, 'time@10': 8.9726}:  90%|█████████ | 9/10 [00:55<00:06,  6.89s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0517, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8553, 'compress@10': 0.1383, 'time@10': 9.018}:  90%|█████████ | 9/10 [01:05<00:06,  6.89s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0517, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8553, 'compress@10': 0.1383, 'time@10': 9.018}: 100%|██████████| 10/10 [01:05<00:00,  7.68s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0517, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8553, 'compress@10': 0.1383, 'time@10': 9.018}: 100%|██████████| 10/10 [01:05<00:00,  6.52s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.0516606330616482
Avg hit ratio: 0.8302699956146476
Avg ndcg: 0.8552787683191253
Avg compression ratio: 0.13830988533018646
Avg train time: 9.017952132225037
Std train time: 3.491000341707409
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 14, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8386, 'compress@10': 0.1474, 'time@10': 7.7918}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8386, 'compress@10': 0.1474, 'time@10': 7.7918}:  10%|█         | 1/10 [00:03<00:35,  3.93s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8515, 'compress@10': 0.1382, 'time@10': 7.1382}:  10%|█         | 1/10 [00:10<00:35,  3.93s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8515, 'compress@10': 0.1382, 'time@10': 7.1382}:  20%|██        | 2/10 [00:10<00:43,  5.45s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8534, 'compress@10': 0.1683, 'time@10': 5.9431}:  20%|██        | 2/10 [00:12<00:43,  5.45s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8534, 'compress@10': 0.1683, 'time@10': 5.9431}:  30%|███       | 3/10 [00:12<00:26,  3.79s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0385, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8504, 'compress@10': 0.1593, 'time@10': 5.8789}:  30%|███       | 3/10 [00:18<00:26,  3.79s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0385, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8504, 'compress@10': 0.1593, 'time@10': 5.8789}:  40%|████      | 4/10 [00:18<00:27,  4.56s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0468, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8392, 'compress@10': 0.151, 'time@10': 7.8071}:  40%|████      | 4/10 [00:25<00:27,  4.56s/it] {'epoch': 4, 'num_users': 5.8, 'loss': 0.0468, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8392, 'compress@10': 0.151, 'time@10': 7.8071}:  50%|█████     | 5/10 [00:25<00:28,  5.73s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0499, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8372, 'compress@10': 0.1459, 'time@10': 8.1695}:  50%|█████     | 5/10 [00:35<00:28,  5.73s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0499, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8372, 'compress@10': 0.1459, 'time@10': 8.1695}:  60%|██████    | 6/10 [00:35<00:28,  7.19s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.049, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8409, 'compress@10': 0.1445, 'time@10': 8.5082}:  60%|██████    | 6/10 [00:41<00:28,  7.19s/it]  {'epoch': 4, 'num_users': 6.2857, 'loss': 0.049, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8409, 'compress@10': 0.1445, 'time@10': 8.5082}:  70%|███████   | 7/10 [00:41<00:19,  6.57s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8509, 'compress@10': 0.1421, 'time@10': 8.3971}:  70%|███████   | 7/10 [00:48<00:19,  6.57s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8509, 'compress@10': 0.1421, 'time@10': 8.3971}:  80%|████████  | 8/10 [00:48<00:13,  6.92s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8591, 'compress@10': 0.1403, 'time@10': 8.9906}:  80%|████████  | 8/10 [00:55<00:13,  6.92s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8591, 'compress@10': 0.1403, 'time@10': 8.9906}:  90%|█████████ | 9/10 [00:55<00:06,  6.91s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.858, 'compress@10': 0.1383, 'time@10': 9.0395}:  90%|█████████ | 9/10 [01:05<00:06,  6.91s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.858, 'compress@10': 0.1383, 'time@10': 9.0395}: 100%|██████████| 10/10 [01:05<00:00,  7.72s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.858, 'compress@10': 0.1383, 'time@10': 9.0395}: 100%|██████████| 10/10 [01:05<00:00,  6.52s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04953422204915738
Avg hit ratio: 0.8547938051384572
Avg ndcg: 0.8580053993268656
Avg compression ratio: 0.13830989709249014
Avg train time: 9.039499139785766
Std train time: 3.44762588961291
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 0.1474, 'time@10': 8.1644}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 0.1474, 'time@10': 8.1644}:  10%|█         | 1/10 [00:04<00:37,  4.12s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8531, 'compress@10': 0.1382, 'time@10': 7.3545}:  10%|█         | 1/10 [00:10<00:37,  4.12s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8531, 'compress@10': 0.1382, 'time@10': 7.3545}:  20%|██        | 2/10 [00:10<00:44,  5.57s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8544, 'compress@10': 0.1683, 'time@10': 6.1547}:  20%|██        | 2/10 [00:12<00:44,  5.57s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8544, 'compress@10': 0.1683, 'time@10': 6.1547}:  30%|███       | 3/10 [00:12<00:27,  3.90s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.841, 'compress@10': 0.1593, 'time@10': 6.0953}:  30%|███       | 3/10 [00:18<00:27,  3.90s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.841, 'compress@10': 0.1593, 'time@10': 6.0953}:  40%|████      | 4/10 [00:18<00:28,  4.71s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0473, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8298, 'compress@10': 0.151, 'time@10': 7.508}:  40%|████      | 4/10 [00:25<00:28,  4.71s/it] {'epoch': 5, 'num_users': 5.8, 'loss': 0.0473, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8298, 'compress@10': 0.151, 'time@10': 7.508}:  50%|█████     | 5/10 [00:25<00:26,  5.40s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0496, 'hit_ratio@10': 0.82, 'ndcg@10': 0.83, 'compress@10': 0.1459, 'time@10': 7.9193}:  50%|█████     | 5/10 [00:35<00:26,  5.40s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0496, 'hit_ratio@10': 0.82, 'ndcg@10': 0.83, 'compress@10': 0.1459, 'time@10': 7.9193}:  60%|██████    | 6/10 [00:35<00:27,  6.97s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0487, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8313, 'compress@10': 0.1445, 'time@10': 8.3192}:  60%|██████    | 6/10 [00:40<00:27,  6.97s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0487, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8313, 'compress@10': 0.1445, 'time@10': 8.3192}:  70%|███████   | 7/10 [00:40<00:19,  6.45s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0497, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8427, 'compress@10': 0.1421, 'time@10': 8.2761}:  70%|███████   | 7/10 [00:48<00:19,  6.45s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0497, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8427, 'compress@10': 0.1421, 'time@10': 8.2761}:  80%|████████  | 8/10 [00:48<00:13,  6.95s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0514, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8664, 'compress@10': 0.1403, 'time@10': 8.9047}:  80%|████████  | 8/10 [00:55<00:13,  6.95s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0514, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8664, 'compress@10': 0.1403, 'time@10': 8.9047}:  90%|█████████ | 9/10 [00:55<00:06,  6.97s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0507, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8645, 'compress@10': 0.1383, 'time@10': 8.952}:  90%|█████████ | 9/10 [01:05<00:06,  6.97s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0507, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8645, 'compress@10': 0.1383, 'time@10': 8.952}: 100%|██████████| 10/10 [01:05<00:00,  7.72s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0507, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8645, 'compress@10': 0.1383, 'time@10': 8.952}: 100%|██████████| 10/10 [01:05<00:00,  6.50s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.05066694911526304
Avg hit ratio: 0.8554445987892507
Avg ndcg: 0.8644650469691728
Avg compression ratio: 0.13830984302704397
Avg train time: 8.952003455162048
Std train time: 3.007436405694772
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8435, 'compress@10': 0.1474, 'time@10': 7.9633}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8435, 'compress@10': 0.1474, 'time@10': 7.9633}:  10%|█         | 1/10 [00:04<00:36,  4.02s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8565, 'compress@10': 0.1382, 'time@10': 7.262}:  10%|█         | 1/10 [00:10<00:36,  4.02s/it] {'epoch': 6, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8565, 'compress@10': 0.1382, 'time@10': 7.262}:  20%|██        | 2/10 [00:10<00:44,  5.53s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8567, 'compress@10': 0.1683, 'time@10': 6.1768}:  20%|██        | 2/10 [00:12<00:44,  5.53s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8567, 'compress@10': 0.1683, 'time@10': 6.1768}:  30%|███       | 3/10 [00:12<00:27,  3.94s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.846, 'compress@10': 0.1593, 'time@10': 6.048}:  30%|███       | 3/10 [00:18<00:27,  3.94s/it]  {'epoch': 6, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.846, 'compress@10': 0.1593, 'time@10': 6.048}:  40%|████      | 4/10 [00:18<00:27,  4.63s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0447, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8341, 'compress@10': 0.151, 'time@10': 7.4264}:  40%|████      | 4/10 [00:24<00:27,  4.63s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0447, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8341, 'compress@10': 0.151, 'time@10': 7.4264}:  50%|█████     | 5/10 [00:24<00:26,  5.31s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0467, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8349, 'compress@10': 0.1459, 'time@10': 7.8644}:  50%|█████     | 5/10 [00:34<00:26,  5.31s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0467, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8349, 'compress@10': 0.1459, 'time@10': 7.8644}:  60%|██████    | 6/10 [00:34<00:27,  6.94s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0473, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8417, 'compress@10': 0.1445, 'time@10': 8.2561}:  60%|██████    | 6/10 [00:40<00:27,  6.94s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0473, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8417, 'compress@10': 0.1445, 'time@10': 8.2561}:  70%|███████   | 7/10 [00:40<00:19,  6.41s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0476, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8473, 'compress@10': 0.1421, 'time@10': 8.1871}:  70%|███████   | 7/10 [00:48<00:19,  6.41s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0476, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.8473, 'compress@10': 0.1421, 'time@10': 8.1871}:  80%|████████  | 8/10 [00:48<00:13,  6.84s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8491, 'compress@10': 0.1403, 'time@10': 8.8224}:  80%|████████  | 8/10 [00:55<00:13,  6.84s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8491, 'compress@10': 0.1403, 'time@10': 8.8224}:  90%|█████████ | 9/10 [00:55<00:06,  6.88s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.048, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8522, 'compress@10': 0.1383, 'time@10': 8.8905}:  90%|█████████ | 9/10 [01:04<00:06,  6.88s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.048, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8522, 'compress@10': 0.1383, 'time@10': 8.8905}: 100%|██████████| 10/10 [01:04<00:00,  7.70s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.048, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8522, 'compress@10': 0.1383, 'time@10': 8.8905}: 100%|██████████| 10/10 [01:04<00:00,  6.46s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.047979221141442686
Avg hit ratio: 0.8550824054270574
Avg ndcg: 0.8521911224993636
Avg compression ratio: 0.1383098933497205
Avg train time: 8.890481233596802
Std train time: 2.9697222119013613
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.1474, 'time@10': 7.9179}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.047, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 0.1474, 'time@10': 7.9179}:  10%|█         | 1/10 [00:04<00:36,  4.02s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8583, 'compress@10': 0.1382, 'time@10': 7.2578}:  10%|█         | 1/10 [00:10<00:36,  4.02s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8583, 'compress@10': 0.1382, 'time@10': 7.2578}:  20%|██        | 2/10 [00:10<00:44,  5.61s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8579, 'compress@10': 0.1683, 'time@10': 6.2983}:  20%|██        | 2/10 [00:12<00:44,  5.61s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8579, 'compress@10': 0.1683, 'time@10': 6.2983}:  30%|███       | 3/10 [00:12<00:28,  4.07s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8527, 'compress@10': 0.1593, 'time@10': 6.1933}:  30%|███       | 3/10 [00:18<00:28,  4.07s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8527, 'compress@10': 0.1593, 'time@10': 6.1933}:  40%|████      | 4/10 [00:18<00:28,  4.80s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0419, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8407, 'compress@10': 0.151, 'time@10': 7.5529}:  40%|████      | 4/10 [00:25<00:28,  4.80s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.0419, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8407, 'compress@10': 0.151, 'time@10': 7.5529}:  50%|█████     | 5/10 [00:25<00:27,  5.42s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0436, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.841, 'compress@10': 0.1459, 'time@10': 8.0007}:  50%|█████     | 5/10 [00:35<00:27,  5.42s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0436, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.841, 'compress@10': 0.1459, 'time@10': 8.0007}:  60%|██████    | 6/10 [00:35<00:28,  7.07s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0442, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8374, 'compress@10': 0.1445, 'time@10': 8.4383}:  60%|██████    | 6/10 [00:41<00:28,  7.07s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0442, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8374, 'compress@10': 0.1445, 'time@10': 8.4383}:  70%|███████   | 7/10 [00:41<00:19,  6.58s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0445, 'hit_ratio@10': 0.882, 'ndcg@10': 0.844, 'compress@10': 0.1421, 'time@10': 8.3421}:  70%|███████   | 7/10 [00:48<00:19,  6.58s/it]   {'epoch': 7, 'num_users': 6.125, 'loss': 0.0445, 'hit_ratio@10': 0.882, 'ndcg@10': 0.844, 'compress@10': 0.1421, 'time@10': 8.3421}:  80%|████████  | 8/10 [00:48<00:13,  6.94s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0426, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8523, 'compress@10': 0.1403, 'time@10': 8.9183}:  80%|████████  | 8/10 [00:55<00:13,  6.94s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0426, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8523, 'compress@10': 0.1403, 'time@10': 8.9183}:  90%|█████████ | 9/10 [00:55<00:06,  6.90s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0424, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8524, 'compress@10': 0.1383, 'time@10': 8.9574}:  90%|█████████ | 9/10 [01:05<00:06,  6.90s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0424, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8524, 'compress@10': 0.1383, 'time@10': 8.9574}: 100%|██████████| 10/10 [01:05<00:00,  7.65s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0424, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8524, 'compress@10': 0.1383, 'time@10': 8.9574}: 100%|██████████| 10/10 [01:05<00:00,  6.51s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04237292550171729
Avg hit ratio: 0.8701783417488003
Avg ndcg: 0.8523562619899824
Avg compression ratio: 0.1383098940851649
Avg train time: 8.95740110874176
Std train time: 2.8655399002871094
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0512, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8346, 'compress@10': 0.1474, 'time@10': 7.7425}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0512, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8346, 'compress@10': 0.1474, 'time@10': 7.7425}:  10%|█         | 1/10 [00:03<00:35,  3.91s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8442, 'compress@10': 0.1382, 'time@10': 7.1096}:  10%|█         | 1/10 [00:10<00:35,  3.91s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8442, 'compress@10': 0.1382, 'time@10': 7.1096}:  20%|██        | 2/10 [00:10<00:43,  5.44s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8485, 'compress@10': 0.1683, 'time@10': 6.2944}:  20%|██        | 2/10 [00:12<00:43,  5.44s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8485, 'compress@10': 0.1683, 'time@10': 6.2944}:  30%|███       | 3/10 [00:12<00:28,  4.04s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8482, 'compress@10': 0.1593, 'time@10': 6.2428}:  30%|███       | 3/10 [00:18<00:28,  4.04s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8482, 'compress@10': 0.1593, 'time@10': 6.2428}:  40%|████      | 4/10 [00:18<00:29,  4.86s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0417, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8375, 'compress@10': 0.151, 'time@10': 7.5136}:  40%|████      | 4/10 [00:25<00:29,  4.86s/it] {'epoch': 8, 'num_users': 5.8, 'loss': 0.0417, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8375, 'compress@10': 0.151, 'time@10': 7.5136}:  50%|█████     | 5/10 [00:25<00:26,  5.39s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0427, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8404, 'compress@10': 0.1459, 'time@10': 7.9401}:  50%|█████     | 5/10 [00:35<00:26,  5.39s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0427, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8404, 'compress@10': 0.1459, 'time@10': 7.9401}:  60%|██████    | 6/10 [00:35<00:27,  7.00s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0432, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8454, 'compress@10': 0.1445, 'time@10': 8.2962}:  60%|██████    | 6/10 [00:40<00:27,  7.00s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0432, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8454, 'compress@10': 0.1445, 'time@10': 8.2962}:  70%|███████   | 7/10 [00:40<00:19,  6.43s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0433, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.847, 'compress@10': 0.1421, 'time@10': 8.2199}:  70%|███████   | 7/10 [00:48<00:19,  6.43s/it]  {'epoch': 8, 'num_users': 6.125, 'loss': 0.0433, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.847, 'compress@10': 0.1421, 'time@10': 8.2199}:  80%|████████  | 8/10 [00:48<00:13,  6.84s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0423, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8567, 'compress@10': 0.1403, 'time@10': 8.8428}:  80%|████████  | 8/10 [00:55<00:13,  6.84s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0423, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.8567, 'compress@10': 0.1403, 'time@10': 8.8428}:  90%|█████████ | 9/10 [00:55<00:06,  6.87s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0414, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.8613, 'compress@10': 0.1383, 'time@10': 8.9121}:  90%|█████████ | 9/10 [01:04<00:06,  6.87s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0414, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.8613, 'compress@10': 0.1383, 'time@10': 8.9121}: 100%|██████████| 10/10 [01:04<00:00,  7.71s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0414, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.8613, 'compress@10': 0.1383, 'time@10': 8.9121}: 100%|██████████| 10/10 [01:04<00:00,  6.49s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04139403774430752
Avg hit ratio: 0.8832447198151782
Avg ndcg: 0.8612883585503468
Avg compression ratio: 0.1383099039842772
Avg train time: 8.912116122245788
Std train time: 2.7674885836952314
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8521, 'compress@10': 0.1474, 'time@10': 7.842}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8521, 'compress@10': 0.1474, 'time@10': 7.842}:  10%|█         | 1/10 [00:03<00:35,  3.96s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8594, 'compress@10': 0.1382, 'time@10': 7.2105}:  10%|█         | 1/10 [00:10<00:35,  3.96s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8594, 'compress@10': 0.1382, 'time@10': 7.2105}:  20%|██        | 2/10 [00:10<00:44,  5.52s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0256, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8586, 'compress@10': 0.1683, 'time@10': 6.4546}:  20%|██        | 2/10 [00:13<00:44,  5.52s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0256, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8586, 'compress@10': 0.1683, 'time@10': 6.4546}:  30%|███       | 3/10 [00:13<00:29,  4.15s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.857, 'compress@10': 0.1593, 'time@10': 6.2963}:  30%|███       | 3/10 [00:18<00:29,  4.15s/it]   {'epoch': 9, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.857, 'compress@10': 0.1593, 'time@10': 6.2963}:  40%|████      | 4/10 [00:18<00:28,  4.82s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8447, 'compress@10': 0.151, 'time@10': 7.5942}:  40%|████      | 4/10 [00:25<00:28,  4.82s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8447, 'compress@10': 0.151, 'time@10': 7.5942}:  50%|█████     | 5/10 [00:25<00:27,  5.40s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0384, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8477, 'compress@10': 0.1459, 'time@10': 8.0958}:  50%|█████     | 5/10 [00:36<00:27,  5.40s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0384, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8477, 'compress@10': 0.1459, 'time@10': 8.0958}:  60%|██████    | 6/10 [00:36<00:28,  7.18s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0381, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8476, 'compress@10': 0.1445, 'time@10': 8.4862}:  60%|██████    | 6/10 [00:41<00:28,  7.18s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0381, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8476, 'compress@10': 0.1445, 'time@10': 8.4862}:  70%|███████   | 7/10 [00:41<00:19,  6.62s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0387, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8485, 'compress@10': 0.1421, 'time@10': 8.3822}:  70%|███████   | 7/10 [00:49<00:19,  6.62s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0387, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8485, 'compress@10': 0.1421, 'time@10': 8.3822}:  80%|████████  | 8/10 [00:49<00:13,  6.96s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0396, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8719, 'compress@10': 0.1403, 'time@10': 8.952}:  80%|████████  | 8/10 [00:55<00:13,  6.96s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0396, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8719, 'compress@10': 0.1403, 'time@10': 8.952}:  90%|█████████ | 9/10 [00:55<00:06,  6.91s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0392, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8714, 'compress@10': 0.1383, 'time@10': 9.0106}:  90%|█████████ | 9/10 [01:05<00:06,  6.91s/it]  {'epoch': 9, 'num_users': 6.3, 'loss': 0.0392, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8714, 'compress@10': 0.1383, 'time@10': 9.0106}: 100%|██████████| 10/10 [01:05<00:00,  7.73s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0392, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8714, 'compress@10': 0.1383, 'time@10': 9.0106}: 100%|██████████| 10/10 [01:05<00:00,  6.55s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.039192198919278484
Avg hit ratio: 0.8738161483866067
Avg ndcg: 0.8713501161079122
Avg compression ratio: 0.1383099039842772
Avg train time: 9.01061499118805
Std train time: 2.765258105166542
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8559, 'compress@10': 0.1474, 'time@10': 8.0256}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0458, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8559, 'compress@10': 0.1474, 'time@10': 8.0256}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8703, 'compress@10': 0.1382, 'time@10': 7.3332}:  10%|█         | 1/10 [00:10<00:36,  4.08s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8703, 'compress@10': 0.1382, 'time@10': 7.3332}:  20%|██        | 2/10 [00:10<00:44,  5.61s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8659, 'compress@10': 0.1683, 'time@10': 6.589}:  20%|██        | 2/10 [00:13<00:44,  5.61s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8659, 'compress@10': 0.1683, 'time@10': 6.589}:  30%|███       | 3/10 [00:13<00:29,  4.23s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0307, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8662, 'compress@10': 0.1593, 'time@10': 6.4303}:  30%|███       | 3/10 [00:19<00:29,  4.23s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0307, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8662, 'compress@10': 0.1593, 'time@10': 6.4303}:  40%|████      | 4/10 [00:19<00:29,  4.93s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8532, 'compress@10': 0.151, 'time@10': 7.7486}:  40%|████      | 4/10 [00:25<00:29,  4.93s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.8532, 'compress@10': 0.151, 'time@10': 7.7486}:  50%|█████     | 5/10 [00:25<00:27,  5.51s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0375, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8553, 'compress@10': 0.1459, 'time@10': 8.1261}:  50%|█████     | 5/10 [00:35<00:27,  5.51s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0375, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8553, 'compress@10': 0.1459, 'time@10': 8.1261}:  60%|██████    | 6/10 [00:35<00:28,  7.05s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0376, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8621, 'compress@10': 0.1445, 'time@10': 8.4451}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0376, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8621, 'compress@10': 0.1445, 'time@10': 8.4451}:  70%|███████   | 7/10 [00:41<00:19,  6.45s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.037, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.8615, 'compress@10': 0.1421, 'time@10': 8.3851}:  70%|███████   | 7/10 [00:49<00:19,  6.45s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.037, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.8615, 'compress@10': 0.1421, 'time@10': 8.3851}:  80%|████████  | 8/10 [00:49<00:13,  6.95s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0399, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8916, 'compress@10': 0.1403, 'time@10': 9.0025}:  80%|████████  | 8/10 [00:56<00:13,  6.95s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0399, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8916, 'compress@10': 0.1403, 'time@10': 9.0025}:  90%|█████████ | 9/10 [00:56<00:06,  6.97s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0381, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.8948, 'compress@10': 0.1383, 'time@10': 9.0509}:  90%|█████████ | 9/10 [01:05<00:06,  6.97s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0381, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.8948, 'compress@10': 0.1383, 'time@10': 9.0509}: 100%|██████████| 10/10 [01:05<00:00,  7.76s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0381, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.8948, 'compress@10': 0.1383, 'time@10': 9.0509}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03805660874002349
Avg hit ratio: 0.8895174470879054
Avg ndcg: 0.8947602951448793
Avg compression ratio: 0.13830988553522047
Avg train time: 9.050858044624329
Std train time: 2.7523579181982156
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.052, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8528, 'compress@10': 0.1474, 'time@10': 7.8731}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.052, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8528, 'compress@10': 0.1474, 'time@10': 7.8731}:  10%|█         | 1/10 [00:03<00:35,  3.97s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8693, 'compress@10': 0.1382, 'time@10': 7.1848}:  10%|█         | 1/10 [00:10<00:35,  3.97s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8693, 'compress@10': 0.1382, 'time@10': 7.1848}:  20%|██        | 2/10 [00:10<00:43,  5.48s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8653, 'compress@10': 0.1683, 'time@10': 6.5984}:  20%|██        | 2/10 [00:13<00:43,  5.48s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8653, 'compress@10': 0.1683, 'time@10': 6.5984}:  30%|███       | 3/10 [00:13<00:29,  4.23s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8628, 'compress@10': 0.1593, 'time@10': 6.407}:  30%|███       | 3/10 [00:19<00:29,  4.23s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8628, 'compress@10': 0.1593, 'time@10': 6.407}:  40%|████      | 4/10 [00:19<00:29,  4.88s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8524, 'compress@10': 0.151, 'time@10': 7.8891}:  40%|████      | 4/10 [00:26<00:29,  4.88s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8524, 'compress@10': 0.151, 'time@10': 7.8891}:  50%|█████     | 5/10 [00:26<00:28,  5.62s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0399, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8558, 'compress@10': 0.1459, 'time@10': 8.3065}:  50%|█████     | 5/10 [00:36<00:28,  5.62s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0399, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8558, 'compress@10': 0.1459, 'time@10': 8.3065}:  60%|██████    | 6/10 [00:36<00:29,  7.26s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0387, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8569, 'compress@10': 0.1445, 'time@10': 8.63}:  60%|██████    | 6/10 [00:41<00:29,  7.26s/it]  {'epoch': 11, 'num_users': 6.2857, 'loss': 0.0387, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8569, 'compress@10': 0.1445, 'time@10': 8.63}:  70%|███████   | 7/10 [00:41<00:19,  6.63s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0368, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8632, 'compress@10': 0.1421, 'time@10': 8.5118}:  70%|███████   | 7/10 [00:49<00:19,  6.63s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0368, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8632, 'compress@10': 0.1421, 'time@10': 8.5118}:  80%|████████  | 8/10 [00:49<00:13,  6.97s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.038, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.871, 'compress@10': 0.1403, 'time@10': 9.0779}:  80%|████████  | 8/10 [00:56<00:13,  6.97s/it] {'epoch': 11, 'num_users': 6.3333, 'loss': 0.038, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.871, 'compress@10': 0.1403, 'time@10': 9.0779}:  90%|█████████ | 9/10 [00:56<00:06,  6.93s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8716, 'compress@10': 0.1383, 'time@10': 9.1131}:  90%|█████████ | 9/10 [01:05<00:06,  6.93s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8716, 'compress@10': 0.1383, 'time@10': 9.1131}: 100%|██████████| 10/10 [01:05<00:00,  7.72s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.873, 'ndcg@10': 0.8716, 'compress@10': 0.1383, 'time@10': 9.1131}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03787524875739036
Avg hit ratio: 0.8729590055294638
Avg ndcg: 0.8715880277511567
Avg compression ratio: 0.13830988727428062
Avg train time: 9.113145661354064
Std train time: 2.8456037766916156
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.87, 'compress@10': 0.1474, 'time@10': 8.1062}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.87, 'compress@10': 0.1474, 'time@10': 8.1062}:  10%|█         | 1/10 [00:04<00:36,  4.11s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8782, 'compress@10': 0.1382, 'time@10': 7.1661}:  10%|█         | 1/10 [00:10<00:36,  4.11s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8782, 'compress@10': 0.1382, 'time@10': 7.1661}:  20%|██        | 2/10 [00:10<00:43,  5.38s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8712, 'compress@10': 0.1683, 'time@10': 6.5761}:  20%|██        | 2/10 [00:13<00:43,  5.38s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8712, 'compress@10': 0.1683, 'time@10': 6.5761}:  30%|███       | 3/10 [00:13<00:29,  4.17s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8662, 'compress@10': 0.1593, 'time@10': 6.4089}:  30%|███       | 3/10 [00:19<00:29,  4.17s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8662, 'compress@10': 0.1593, 'time@10': 6.4089}:  40%|████      | 4/10 [00:19<00:29,  4.87s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0351, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.856, 'compress@10': 0.151, 'time@10': 7.7037}:  40%|████      | 4/10 [00:25<00:29,  4.87s/it]  {'epoch': 12, 'num_users': 5.8, 'loss': 0.0351, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.856, 'compress@10': 0.151, 'time@10': 7.7037}:  50%|█████     | 5/10 [00:25<00:27,  5.45s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0354, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8597, 'compress@10': 0.1459, 'time@10': 8.0605}:  50%|█████     | 5/10 [00:35<00:27,  5.45s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0354, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8597, 'compress@10': 0.1459, 'time@10': 8.0605}:  60%|██████    | 6/10 [00:35<00:27,  6.96s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0348, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8672, 'compress@10': 0.1445, 'time@10': 8.403}:  60%|██████    | 6/10 [00:40<00:27,  6.96s/it] {'epoch': 12, 'num_users': 6.2857, 'loss': 0.0348, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8672, 'compress@10': 0.1445, 'time@10': 8.403}:  70%|███████   | 7/10 [00:40<00:19,  6.41s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0334, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8723, 'compress@10': 0.1421, 'time@10': 8.3289}:  70%|███████   | 7/10 [00:48<00:19,  6.41s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0334, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8723, 'compress@10': 0.1421, 'time@10': 8.3289}:  80%|████████  | 8/10 [00:48<00:13,  6.87s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0322, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8775, 'compress@10': 0.1403, 'time@10': 8.8904}:  80%|████████  | 8/10 [00:55<00:13,  6.87s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0322, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8775, 'compress@10': 0.1403, 'time@10': 8.8904}:  90%|█████████ | 9/10 [00:55<00:06,  6.82s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8835, 'compress@10': 0.1383, 'time@10': 8.94}:  90%|█████████ | 9/10 [01:04<00:06,  6.82s/it]     {'epoch': 12, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8835, 'compress@10': 0.1383, 'time@10': 8.94}: 100%|██████████| 10/10 [01:04<00:00,  7.63s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8835, 'compress@10': 0.1383, 'time@10': 8.94}: 100%|██████████| 10/10 [01:04<00:00,  6.47s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.030177366533962142
Avg hit ratio: 0.869510278629124
Avg ndcg: 0.8835290402121545
Avg compression ratio: 0.1383099039842772
Avg train time: 8.939958381652833
Std train time: 2.639964738510549
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8747, 'compress@10': 0.1474, 'time@10': 7.754}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8747, 'compress@10': 0.1474, 'time@10': 7.754}:  10%|█         | 1/10 [00:03<00:35,  3.91s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8847, 'compress@10': 0.1382, 'time@10': 7.0452}:  10%|█         | 1/10 [00:10<00:35,  3.91s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8847, 'compress@10': 0.1382, 'time@10': 7.0452}:  20%|██        | 2/10 [00:10<00:42,  5.36s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8755, 'compress@10': 0.1683, 'time@10': 6.465}:  20%|██        | 2/10 [00:12<00:42,  5.36s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8755, 'compress@10': 0.1683, 'time@10': 6.465}:  30%|███       | 3/10 [00:12<00:28,  4.14s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.7829, 'ndcg@10': 0.8735, 'compress@10': 0.1593, 'time@10': 6.3193}:  30%|███       | 3/10 [00:18<00:28,  4.14s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.7829, 'ndcg@10': 0.8735, 'compress@10': 0.1593, 'time@10': 6.3193}:  40%|████      | 4/10 [00:18<00:29,  4.84s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0311, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.862, 'compress@10': 0.151, 'time@10': 7.6108}:  40%|████      | 4/10 [00:25<00:29,  4.84s/it]  {'epoch': 13, 'num_users': 5.8, 'loss': 0.0311, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.862, 'compress@10': 0.151, 'time@10': 7.6108}:  50%|█████     | 5/10 [00:25<00:27,  5.41s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0311, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8658, 'compress@10': 0.1459, 'time@10': 7.9782}:  50%|█████     | 5/10 [00:35<00:27,  5.41s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0311, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8658, 'compress@10': 0.1459, 'time@10': 7.9782}:  60%|██████    | 6/10 [00:35<00:27,  6.92s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0314, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.869, 'compress@10': 0.1445, 'time@10': 8.3031}:  60%|██████    | 6/10 [00:40<00:27,  6.92s/it] {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0314, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.869, 'compress@10': 0.1445, 'time@10': 8.3031}:  70%|███████   | 7/10 [00:40<00:19,  6.35s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.031, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8719, 'compress@10': 0.1421, 'time@10': 8.2485}:  70%|███████   | 7/10 [00:48<00:19,  6.35s/it]  {'epoch': 13, 'num_users': 6.125, 'loss': 0.031, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8719, 'compress@10': 0.1421, 'time@10': 8.2485}:  80%|████████  | 8/10 [00:48<00:13,  6.84s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0298, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8798, 'compress@10': 0.1403, 'time@10': 8.8362}:  80%|████████  | 8/10 [00:55<00:13,  6.84s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0298, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8798, 'compress@10': 0.1403, 'time@10': 8.8362}:  90%|█████████ | 9/10 [00:55<00:06,  6.83s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0301, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.8854, 'compress@10': 0.1383, 'time@10': 8.9293}:  90%|█████████ | 9/10 [01:04<00:06,  6.83s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0301, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.8854, 'compress@10': 0.1383, 'time@10': 8.9293}: 100%|██████████| 10/10 [01:04<00:00,  7.75s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0301, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.8854, 'compress@10': 0.1383, 'time@10': 8.9293}: 100%|██████████| 10/10 [01:04<00:00,  6.49s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.030138514193132827
Avg hit ratio: 0.8718118659307115
Avg ndcg: 0.8854219859533419
Avg compression ratio: 0.13830990012487648
Avg train time: 8.929304432868957
Std train time: 2.6634307586425763
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8782, 'compress@10': 0.1474, 'time@10': 7.7766}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8782, 'compress@10': 0.1474, 'time@10': 7.7766}:  10%|█         | 1/10 [00:03<00:35,  3.93s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0324, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8891, 'compress@10': 0.1382, 'time@10': 7.1495}:  10%|█         | 1/10 [00:10<00:35,  3.93s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0324, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8891, 'compress@10': 0.1382, 'time@10': 7.1495}:  20%|██        | 2/10 [00:10<00:43,  5.48s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8784, 'compress@10': 0.1683, 'time@10': 6.5023}:  20%|██        | 2/10 [00:13<00:43,  5.48s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8784, 'compress@10': 0.1683, 'time@10': 6.5023}:  30%|███       | 3/10 [00:13<00:29,  4.18s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8758, 'compress@10': 0.1593, 'time@10': 6.3485}:  30%|███       | 3/10 [00:19<00:29,  4.18s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8758, 'compress@10': 0.1593, 'time@10': 6.3485}:  40%|████      | 4/10 [00:19<00:29,  4.87s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8128, 'ndcg@10': 0.8641, 'compress@10': 0.151, 'time@10': 7.6378}:  40%|████      | 4/10 [00:25<00:29,  4.87s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8128, 'ndcg@10': 0.8641, 'compress@10': 0.151, 'time@10': 7.6378}:  50%|█████     | 5/10 [00:25<00:27,  5.44s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0304, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.87, 'compress@10': 0.1459, 'time@10': 8.0044}:  50%|█████     | 5/10 [00:35<00:27,  5.44s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0304, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.87, 'compress@10': 0.1459, 'time@10': 8.0044}:  60%|██████    | 6/10 [00:35<00:27,  6.95s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0301, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8719, 'compress@10': 0.1445, 'time@10': 8.3017}:  60%|██████    | 6/10 [00:40<00:27,  6.95s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0301, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8719, 'compress@10': 0.1445, 'time@10': 8.3017}:  70%|███████   | 7/10 [00:40<00:19,  6.34s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.029, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8774, 'compress@10': 0.1421, 'time@10': 8.2204}:  70%|███████   | 7/10 [00:48<00:19,  6.34s/it]  {'epoch': 14, 'num_users': 6.125, 'loss': 0.029, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8774, 'compress@10': 0.1421, 'time@10': 8.2204}:  80%|████████  | 8/10 [00:48<00:13,  6.77s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0287, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8855, 'compress@10': 0.1403, 'time@10': 8.777}:  80%|████████  | 8/10 [00:54<00:13,  6.77s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0287, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8855, 'compress@10': 0.1403, 'time@10': 8.777}:  90%|█████████ | 9/10 [00:54<00:06,  6.73s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8892, 'compress@10': 0.1383, 'time@10': 8.8488}:  90%|█████████ | 9/10 [01:04<00:06,  6.73s/it]  {'epoch': 14, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8892, 'compress@10': 0.1383, 'time@10': 8.8488}: 100%|██████████| 10/10 [01:04<00:00,  7.60s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8892, 'compress@10': 0.1383, 'time@10': 8.8488}: 100%|██████████| 10/10 [01:04<00:00,  6.43s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.02834377112408563
Avg hit ratio: 0.8671011644458163
Avg ndcg: 0.8892281589446756
Avg compression ratio: 0.13830989847084757
Avg train time: 8.84881088733673
Std train time: 2.6021927556004933
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8782, 'compress@10': 0.1474, 'time@10': 7.9295}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8782, 'compress@10': 0.1474, 'time@10': 7.9295}:  10%|█         | 1/10 [00:04<00:36,  4.00s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8921, 'compress@10': 0.1382, 'time@10': 7.212}:  10%|█         | 1/10 [00:10<00:36,  4.00s/it]  {'epoch': 15, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8921, 'compress@10': 0.1382, 'time@10': 7.212}:  20%|██        | 2/10 [00:10<00:44,  5.52s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8804, 'compress@10': 0.1683, 'time@10': 6.6545}:  20%|██        | 2/10 [00:13<00:44,  5.52s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8804, 'compress@10': 0.1683, 'time@10': 6.6545}:  30%|███       | 3/10 [00:13<00:29,  4.28s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.7829, 'ndcg@10': 0.8792, 'compress@10': 0.1593, 'time@10': 6.5051}:  30%|███       | 3/10 [00:19<00:29,  4.28s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0232, 'hit_ratio@10': 0.7829, 'ndcg@10': 0.8792, 'compress@10': 0.1593, 'time@10': 6.5051}:  40%|████      | 4/10 [00:19<00:29,  5.00s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0278, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.8688, 'compress@10': 0.151, 'time@10': 7.7761}:  40%|████      | 4/10 [00:25<00:29,  5.00s/it] {'epoch': 15, 'num_users': 5.8, 'loss': 0.0278, 'hit_ratio@10': 0.8063, 'ndcg@10': 0.8688, 'compress@10': 0.151, 'time@10': 7.7761}:  50%|█████     | 5/10 [00:25<00:27,  5.53s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0288, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8777, 'compress@10': 0.1459, 'time@10': 8.1221}:  50%|█████     | 5/10 [00:35<00:27,  5.53s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0288, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8777, 'compress@10': 0.1459, 'time@10': 8.1221}:  60%|██████    | 6/10 [00:35<00:28,  7.01s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.028, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8831, 'compress@10': 0.1445, 'time@10': 8.4493}:  60%|██████    | 6/10 [00:41<00:28,  7.01s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.028, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8831, 'compress@10': 0.1445, 'time@10': 8.4493}:  70%|███████   | 7/10 [00:41<00:19,  6.43s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0271, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8874, 'compress@10': 0.1421, 'time@10': 8.3757}:  70%|███████   | 7/10 [00:48<00:19,  6.43s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0271, 'hit_ratio@10': 0.864, 'ndcg@10': 0.8874, 'compress@10': 0.1421, 'time@10': 8.3757}:  80%|████████  | 8/10 [00:48<00:13,  6.90s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.027, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9009, 'compress@10': 0.1403, 'time@10': 8.9728}:  80%|████████  | 8/10 [00:55<00:13,  6.90s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.027, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9009, 'compress@10': 0.1403, 'time@10': 8.9728}:  90%|█████████ | 9/10 [00:55<00:06,  6.90s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0254, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9063, 'compress@10': 0.1383, 'time@10': 9.0345}:  90%|█████████ | 9/10 [01:05<00:06,  6.90s/it]  {'epoch': 15, 'num_users': 6.3, 'loss': 0.0254, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9063, 'compress@10': 0.1383, 'time@10': 9.0345}: 100%|██████████| 10/10 [01:05<00:00,  7.74s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0254, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9063, 'compress@10': 0.1383, 'time@10': 9.0345}: 100%|██████████| 10/10 [01:05<00:00,  6.55s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.025391491622860817
Avg hit ratio: 0.8632404373592829
Avg ndcg: 0.9063415549961571
Avg compression ratio: 0.1383099039842772
Avg train time: 9.034498453140259
Std train time: 2.6433941269725136
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8755, 'compress@10': 0.1474, 'time@10': 7.7568}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8755, 'compress@10': 0.1474, 'time@10': 7.7568}:  10%|█         | 1/10 [00:03<00:35,  3.91s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0292, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8925, 'compress@10': 0.1382, 'time@10': 7.1165}:  10%|█         | 1/10 [00:10<00:35,  3.91s/it] {'epoch': 16, 'num_users': 7.0, 'loss': 0.0292, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8925, 'compress@10': 0.1382, 'time@10': 7.1165}:  20%|██        | 2/10 [00:10<00:43,  5.44s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8807, 'compress@10': 0.1683, 'time@10': 6.5059}:  20%|██        | 2/10 [00:13<00:43,  5.44s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8807, 'compress@10': 0.1683, 'time@10': 6.5059}:  30%|███       | 3/10 [00:13<00:29,  4.18s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8854, 'compress@10': 0.1593, 'time@10': 6.3198}:  30%|███       | 3/10 [00:18<00:29,  4.18s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8854, 'compress@10': 0.1593, 'time@10': 6.3198}:  40%|████      | 4/10 [00:18<00:28,  4.82s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0269, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8762, 'compress@10': 0.151, 'time@10': 7.6288}:  40%|████      | 4/10 [00:25<00:28,  4.82s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0269, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8762, 'compress@10': 0.151, 'time@10': 7.6288}:  50%|█████     | 5/10 [00:25<00:27,  5.41s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0273, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8832, 'compress@10': 0.1459, 'time@10': 8.0292}:  50%|█████     | 5/10 [00:35<00:27,  5.41s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0273, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8832, 'compress@10': 0.1459, 'time@10': 8.0292}:  60%|██████    | 6/10 [00:35<00:27,  7.00s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8865, 'compress@10': 0.1445, 'time@10': 8.3545}:  60%|██████    | 6/10 [00:40<00:27,  7.00s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8865, 'compress@10': 0.1445, 'time@10': 8.3545}:  70%|███████   | 7/10 [00:40<00:19,  6.41s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0288, 'hit_ratio@10': 0.881, 'ndcg@10': 0.8877, 'compress@10': 0.1421, 'time@10': 8.2781}:  70%|███████   | 7/10 [00:48<00:19,  6.41s/it]  {'epoch': 16, 'num_users': 6.125, 'loss': 0.0288, 'hit_ratio@10': 0.881, 'ndcg@10': 0.8877, 'compress@10': 0.1421, 'time@10': 8.2781}:  80%|████████  | 8/10 [00:48<00:13,  6.84s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0293, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.9076, 'compress@10': 0.1403, 'time@10': 8.8186}:  80%|████████  | 8/10 [00:55<00:13,  6.84s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0293, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.9076, 'compress@10': 0.1403, 'time@10': 8.8186}:  90%|█████████ | 9/10 [00:55<00:06,  6.77s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9066, 'compress@10': 0.1383, 'time@10': 8.8541}:  90%|█████████ | 9/10 [01:04<00:06,  6.77s/it]    {'epoch': 16, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9066, 'compress@10': 0.1383, 'time@10': 8.8541}: 100%|██████████| 10/10 [01:04<00:00,  7.53s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9066, 'compress@10': 0.1383, 'time@10': 8.8541}: 100%|██████████| 10/10 [01:04<00:00,  6.42s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.029293491139680695
Avg hit ratio: 0.8739547230735687
Avg ndcg: 0.9065838808471719
Avg compression ratio: 0.1383099039842772
Avg train time: 8.854060792922974
Std train time: 2.6165720541528206
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0309, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8844, 'compress@10': 0.1474, 'time@10': 8.2069}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0309, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8844, 'compress@10': 0.1474, 'time@10': 8.2069}:  10%|█         | 1/10 [00:04<00:37,  4.14s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.895, 'compress@10': 0.1382, 'time@10': 7.4417}:  10%|█         | 1/10 [00:10<00:37,  4.14s/it]  {'epoch': 17, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.895, 'compress@10': 0.1382, 'time@10': 7.4417}:  20%|██        | 2/10 [00:10<00:45,  5.65s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8824, 'compress@10': 0.1683, 'time@10': 6.7518}:  20%|██        | 2/10 [00:13<00:45,  5.65s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8824, 'compress@10': 0.1683, 'time@10': 6.7518}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8871, 'compress@10': 0.1593, 'time@10': 6.506}:  30%|███       | 3/10 [00:19<00:30,  4.32s/it]  {'epoch': 17, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8871, 'compress@10': 0.1593, 'time@10': 6.506}:  40%|████      | 4/10 [00:19<00:29,  4.90s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0254, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.877, 'compress@10': 0.151, 'time@10': 7.8013}:  40%|████      | 4/10 [00:25<00:29,  4.90s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0254, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.877, 'compress@10': 0.151, 'time@10': 7.8013}:  50%|█████     | 5/10 [00:25<00:27,  5.49s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0258, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.889, 'compress@10': 0.1459, 'time@10': 8.1057}:  50%|█████     | 5/10 [00:35<00:27,  5.49s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0258, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.889, 'compress@10': 0.1459, 'time@10': 8.1057}:  60%|██████    | 6/10 [00:35<00:27,  6.91s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8903, 'compress@10': 0.1445, 'time@10': 8.4589}:  60%|██████    | 6/10 [00:40<00:27,  6.91s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8903, 'compress@10': 0.1445, 'time@10': 8.4589}:  70%|███████   | 7/10 [00:40<00:19,  6.39s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0256, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.8894, 'compress@10': 0.1421, 'time@10': 8.3933}:  70%|███████   | 7/10 [00:48<00:19,  6.39s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0256, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.8894, 'compress@10': 0.1421, 'time@10': 8.3933}:  80%|████████  | 8/10 [00:48<00:13,  6.90s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0279, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9166, 'compress@10': 0.1403, 'time@10': 8.9115}:  80%|████████  | 8/10 [00:55<00:13,  6.90s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0279, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9166, 'compress@10': 0.1403, 'time@10': 8.9115}:  90%|█████████ | 9/10 [00:55<00:06,  6.79s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9199, 'compress@10': 0.1383, 'time@10': 8.9575}:  90%|█████████ | 9/10 [01:04<00:06,  6.79s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9199, 'compress@10': 0.1383, 'time@10': 8.9575}: 100%|██████████| 10/10 [01:04<00:00,  7.60s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9199, 'compress@10': 0.1383, 'time@10': 8.9575}: 100%|██████████| 10/10 [01:04<00:00,  6.49s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02638172135038442
Avg hit ratio: 0.8873381817201851
Avg ndcg: 0.9199214305013831
Avg compression ratio: 0.13830989293613055
Avg train time: 8.9575364112854
Std train time: 2.570859446762275
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8871, 'compress@10': 0.1474, 'time@10': 7.7641}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8871, 'compress@10': 0.1474, 'time@10': 7.7641}:  10%|█         | 1/10 [00:03<00:35,  3.92s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8981, 'compress@10': 0.1382, 'time@10': 7.1495}:  10%|█         | 1/10 [00:10<00:35,  3.92s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8981, 'compress@10': 0.1382, 'time@10': 7.1495}:  20%|██        | 2/10 [00:10<00:43,  5.48s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8845, 'compress@10': 0.1683, 'time@10': 6.5523}:  20%|██        | 2/10 [00:13<00:43,  5.48s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8845, 'compress@10': 0.1683, 'time@10': 6.5523}:  30%|███       | 3/10 [00:13<00:29,  4.23s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8875, 'compress@10': 0.1593, 'time@10': 6.3866}:  30%|███       | 3/10 [00:19<00:29,  4.23s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8875, 'compress@10': 0.1593, 'time@10': 6.3866}:  40%|████      | 4/10 [00:19<00:29,  4.90s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8804, 'compress@10': 0.151, 'time@10': 7.7239}:  40%|████      | 4/10 [00:25<00:29,  4.90s/it] {'epoch': 18, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8804, 'compress@10': 0.151, 'time@10': 7.7239}:  50%|█████     | 5/10 [00:25<00:27,  5.50s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.024, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.8901, 'compress@10': 0.1459, 'time@10': 8.0659}:  50%|█████     | 5/10 [00:35<00:27,  5.50s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.024, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.8901, 'compress@10': 0.1459, 'time@10': 8.0659}:  60%|██████    | 6/10 [00:35<00:27,  6.97s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.886, 'ndcg@10': 0.8977, 'compress@10': 0.1445, 'time@10': 8.4016}:  60%|██████    | 6/10 [00:40<00:27,  6.97s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.886, 'ndcg@10': 0.8977, 'compress@10': 0.1445, 'time@10': 8.4016}:  70%|███████   | 7/10 [00:40<00:19,  6.41s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0226, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9027, 'compress@10': 0.1421, 'time@10': 8.3148}:  70%|███████   | 7/10 [00:48<00:19,  6.41s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0226, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9027, 'compress@10': 0.1421, 'time@10': 8.3148}:  80%|████████  | 8/10 [00:48<00:13,  6.83s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0258, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.918, 'compress@10': 0.1403, 'time@10': 8.8612}:  80%|████████  | 8/10 [00:55<00:13,  6.83s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0258, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.918, 'compress@10': 0.1403, 'time@10': 8.8612}:  90%|█████████ | 9/10 [00:55<00:06,  6.78s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9243, 'compress@10': 0.1383, 'time@10': 8.9118}:  90%|█████████ | 9/10 [01:04<00:06,  6.78s/it]  {'epoch': 18, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9243, 'compress@10': 0.1383, 'time@10': 8.9118}: 100%|██████████| 10/10 [01:04<00:00,  7.59s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9243, 'compress@10': 0.1383, 'time@10': 8.9118}: 100%|██████████| 10/10 [01:04<00:00,  6.46s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.02509718272060371
Avg hit ratio: 0.8864810388630422
Avg ndcg: 0.9243387030913303
Avg compression ratio: 0.13830990012487648
Avg train time: 8.911774349212646
Std train time: 2.634011524663712
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8913, 'compress@10': 0.1474, 'time@10': 8.037}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8913, 'compress@10': 0.1474, 'time@10': 8.037}:  10%|█         | 1/10 [00:04<00:36,  4.05s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0257, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9089, 'compress@10': 0.1382, 'time@10': 7.1702}:  10%|█         | 1/10 [00:10<00:36,  4.05s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0257, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9089, 'compress@10': 0.1382, 'time@10': 7.1702}:  20%|██        | 2/10 [00:10<00:43,  5.40s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8916, 'compress@10': 0.1683, 'time@10': 6.5829}:  20%|██        | 2/10 [00:13<00:43,  5.40s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8916, 'compress@10': 0.1683, 'time@10': 6.5829}:  30%|███       | 3/10 [00:13<00:29,  4.18s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8923, 'compress@10': 0.1593, 'time@10': 6.4018}:  30%|███       | 3/10 [00:19<00:29,  4.18s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8923, 'compress@10': 0.1593, 'time@10': 6.4018}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8852, 'compress@10': 0.151, 'time@10': 7.668}:  40%|████      | 4/10 [00:25<00:29,  4.86s/it] {'epoch': 19, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8852, 'compress@10': 0.151, 'time@10': 7.668}:  50%|█████     | 5/10 [00:25<00:27,  5.42s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0236, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8945, 'compress@10': 0.1459, 'time@10': 8.0112}:  50%|█████     | 5/10 [00:35<00:27,  5.42s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0236, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8945, 'compress@10': 0.1459, 'time@10': 8.0112}:  60%|██████    | 6/10 [00:35<00:27,  6.89s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0245, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8971, 'compress@10': 0.1445, 'time@10': 8.4143}:  60%|██████    | 6/10 [00:40<00:27,  6.89s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0245, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8971, 'compress@10': 0.1445, 'time@10': 8.4143}:  70%|███████   | 7/10 [00:40<00:19,  6.43s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0241, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.8978, 'compress@10': 0.1421, 'time@10': 8.3383}:  70%|███████   | 7/10 [00:48<00:19,  6.43s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0241, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.8978, 'compress@10': 0.1421, 'time@10': 8.3383}:  80%|████████  | 8/10 [00:48<00:13,  6.88s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0245, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9005, 'compress@10': 0.1403, 'time@10': 8.8901}:  80%|████████  | 8/10 [00:55<00:13,  6.88s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0245, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9005, 'compress@10': 0.1403, 'time@10': 8.8901}:  90%|█████████ | 9/10 [00:55<00:06,  6.82s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0243, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9019, 'compress@10': 0.1383, 'time@10': 8.9306}:  90%|█████████ | 9/10 [01:04<00:06,  6.82s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0243, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9019, 'compress@10': 0.1383, 'time@10': 8.9306}: 100%|██████████| 10/10 [01:04<00:00,  7.60s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0243, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9019, 'compress@10': 0.1383, 'time@10': 8.9306}: 100%|██████████| 10/10 [01:04<00:00,  6.45s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.02429817332116361
Avg hit ratio: 0.8873381817201851
Avg ndcg: 0.9018972724494094
Avg compression ratio: 0.13830988324144572
Avg train time: 8.930643272399902
Std train time: 2.622655959856167
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8929, 'compress@10': 0.1474, 'time@10': 7.7287}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8929, 'compress@10': 0.1474, 'time@10': 7.7287}:  10%|█         | 1/10 [00:03<00:35,  3.90s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9125, 'compress@10': 0.1382, 'time@10': 7.0548}:  10%|█         | 1/10 [00:10<00:35,  3.90s/it] {'epoch': 20, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9125, 'compress@10': 0.1382, 'time@10': 7.0548}:  20%|██        | 2/10 [00:10<00:43,  5.38s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.894, 'compress@10': 0.1683, 'time@10': 6.4924}:  20%|██        | 2/10 [00:13<00:43,  5.38s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.894, 'compress@10': 0.1683, 'time@10': 6.4924}:  30%|███       | 3/10 [00:13<00:29,  4.17s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8945, 'compress@10': 0.1593, 'time@10': 6.3325}:  30%|███       | 3/10 [00:18<00:29,  4.17s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8945, 'compress@10': 0.1593, 'time@10': 6.3325}:  40%|████      | 4/10 [00:18<00:29,  4.86s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8884, 'compress@10': 0.151, 'time@10': 7.6777}:  40%|████      | 4/10 [00:25<00:29,  4.86s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8884, 'compress@10': 0.151, 'time@10': 7.6777}:  50%|█████     | 5/10 [00:25<00:27,  5.47s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0211, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9005, 'compress@10': 0.1459, 'time@10': 8.0094}:  50%|█████     | 5/10 [00:35<00:27,  5.47s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0211, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9005, 'compress@10': 0.1459, 'time@10': 8.0094}:  60%|██████    | 6/10 [00:35<00:27,  6.91s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.021, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9023, 'compress@10': 0.1445, 'time@10': 8.3785}:  60%|██████    | 6/10 [00:40<00:27,  6.91s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 0.021, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9023, 'compress@10': 0.1445, 'time@10': 8.3785}:  70%|███████   | 7/10 [00:40<00:19,  6.40s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0218, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9044, 'compress@10': 0.1421, 'time@10': 8.2885}:  70%|███████   | 7/10 [00:48<00:19,  6.40s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0218, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.9044, 'compress@10': 0.1421, 'time@10': 8.2885}:  80%|████████  | 8/10 [00:48<00:13,  6.81s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9112, 'compress@10': 0.1403, 'time@10': 8.8626}:  80%|████████  | 8/10 [00:55<00:13,  6.81s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9112, 'compress@10': 0.1403, 'time@10': 8.8626}:  90%|█████████ | 9/10 [00:55<00:06,  6.79s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9166, 'compress@10': 0.1383, 'time@10': 8.9244}:  90%|█████████ | 9/10 [01:04<00:06,  6.79s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9166, 'compress@10': 0.1383, 'time@10': 8.9244}: 100%|██████████| 10/10 [01:04<00:00,  7.64s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.9166, 'compress@10': 0.1383, 'time@10': 8.9244}: 100%|██████████| 10/10 [01:04<00:00,  6.45s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.020259016701126863
Avg hit ratio: 0.8873381817201851
Avg ndcg: 0.9166364284006073
Avg compression ratio: 0.1383098922219735
Avg train time: 8.924397444725036
Std train time: 2.699224855543234
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.895, 'compress@10': 0.1474, 'time@10': 7.7852}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.895, 'compress@10': 0.1474, 'time@10': 7.7852}:  10%|█         | 1/10 [00:03<00:35,  3.96s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9172, 'compress@10': 0.1382, 'time@10': 7.2017}:  10%|█         | 1/10 [00:10<00:35,  3.96s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9172, 'compress@10': 0.1382, 'time@10': 7.2017}:  20%|██        | 2/10 [00:10<00:44,  5.55s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8972, 'compress@10': 0.1683, 'time@10': 6.6175}:  20%|██        | 2/10 [00:13<00:44,  5.55s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8972, 'compress@10': 0.1683, 'time@10': 6.6175}:  30%|███       | 3/10 [00:13<00:29,  4.28s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.896, 'compress@10': 0.1593, 'time@10': 6.4159}:  30%|███       | 3/10 [00:19<00:29,  4.28s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.896, 'compress@10': 0.1593, 'time@10': 6.4159}:  40%|████      | 4/10 [00:19<00:29,  4.90s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0203, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8909, 'compress@10': 0.151, 'time@10': 7.6897}:  40%|████      | 4/10 [00:25<00:29,  4.90s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0203, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8909, 'compress@10': 0.151, 'time@10': 7.6897}:  50%|█████     | 5/10 [00:25<00:27,  5.45s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.9002, 'compress@10': 0.1459, 'time@10': 8.0202}:  50%|█████     | 5/10 [00:35<00:27,  5.45s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.9002, 'compress@10': 0.1459, 'time@10': 8.0202}:  60%|██████    | 6/10 [00:35<00:27,  6.90s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0201, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9068, 'compress@10': 0.1445, 'time@10': 8.3927}:  60%|██████    | 6/10 [00:40<00:27,  6.90s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0201, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9068, 'compress@10': 0.1445, 'time@10': 8.3927}:  70%|███████   | 7/10 [00:40<00:19,  6.39s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9132, 'compress@10': 0.1421, 'time@10': 8.3274}:  70%|███████   | 7/10 [00:48<00:19,  6.39s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9132, 'compress@10': 0.1421, 'time@10': 8.3274}:  80%|████████  | 8/10 [00:48<00:13,  6.87s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9206, 'compress@10': 0.1403, 'time@10': 8.8733}:  80%|████████  | 8/10 [00:55<00:13,  6.87s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9206, 'compress@10': 0.1403, 'time@10': 8.8733}:  90%|█████████ | 9/10 [00:55<00:06,  6.81s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9261, 'compress@10': 0.1383, 'time@10': 8.9181}:  90%|█████████ | 9/10 [01:04<00:06,  6.81s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9261, 'compress@10': 0.1383, 'time@10': 8.9181}: 100%|██████████| 10/10 [01:04<00:00,  7.60s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.9261, 'compress@10': 0.1383, 'time@10': 8.9181}: 100%|██████████| 10/10 [01:04<00:00,  6.47s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.02129760513177154
Avg hit ratio: 0.8730524674344708
Avg ndcg: 0.9261074125085289
Avg compression ratio: 0.13830989773540317
Avg train time: 8.91807324886322
Std train time: 2.5815479760601363
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9087, 'compress@10': 0.1474, 'time@10': 7.6377}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9087, 'compress@10': 0.1474, 'time@10': 7.6377}:  10%|█         | 1/10 [00:03<00:34,  3.86s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9293, 'compress@10': 0.1382, 'time@10': 7.0906}:  10%|█         | 1/10 [00:10<00:34,  3.86s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9293, 'compress@10': 0.1382, 'time@10': 7.0906}:  20%|██        | 2/10 [00:10<00:43,  5.46s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9053, 'compress@10': 0.1683, 'time@10': 6.583}:  20%|██        | 2/10 [00:13<00:43,  5.46s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9053, 'compress@10': 0.1683, 'time@10': 6.583}:  30%|███       | 3/10 [00:13<00:29,  4.26s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9067, 'compress@10': 0.1593, 'time@10': 6.3985}:  30%|███       | 3/10 [00:19<00:29,  4.26s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9067, 'compress@10': 0.1593, 'time@10': 6.3985}:  40%|████      | 4/10 [00:19<00:29,  4.90s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.901, 'compress@10': 0.151, 'time@10': 7.6956}:  40%|████      | 4/10 [00:25<00:29,  4.90s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.901, 'compress@10': 0.151, 'time@10': 7.6956}:  50%|█████     | 5/10 [00:25<00:27,  5.47s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9098, 'compress@10': 0.1459, 'time@10': 8.0118}:  50%|█████     | 5/10 [00:35<00:27,  5.47s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9098, 'compress@10': 0.1459, 'time@10': 8.0118}:  60%|██████    | 6/10 [00:35<00:27,  6.89s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9101, 'compress@10': 0.1445, 'time@10': 8.3425}:  60%|██████    | 6/10 [00:40<00:27,  6.89s/it] {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9101, 'compress@10': 0.1445, 'time@10': 8.3425}:  70%|███████   | 7/10 [00:40<00:19,  6.34s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0216, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9082, 'compress@10': 0.1421, 'time@10': 8.2384}:  70%|███████   | 7/10 [00:48<00:19,  6.34s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0216, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9082, 'compress@10': 0.1421, 'time@10': 8.2384}:  80%|████████  | 8/10 [00:48<00:13,  6.72s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9158, 'compress@10': 0.1403, 'time@10': 8.8024}:  80%|████████  | 8/10 [00:54<00:13,  6.72s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9158, 'compress@10': 0.1403, 'time@10': 8.8024}:  90%|█████████ | 9/10 [00:54<00:06,  6.72s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9198, 'compress@10': 0.1383, 'time@10': 8.8632}:  90%|█████████ | 9/10 [01:04<00:06,  6.72s/it]  {'epoch': 22, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9198, 'compress@10': 0.1383, 'time@10': 8.8632}: 100%|██████████| 10/10 [01:04<00:00,  7.56s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9198, 'compress@10': 0.1383, 'time@10': 8.8632}: 100%|██████████| 10/10 [01:04<00:00,  6.42s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.02179420282071029
Avg hit ratio: 0.8836238960058994
Avg ndcg: 0.919801746408789
Avg compression ratio: 0.1383098894030632
Avg train time: 8.863168621063233
Std train time: 2.6006201151191135
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9129, 'compress@10': 0.1474, 'time@10': 7.9049}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9129, 'compress@10': 0.1474, 'time@10': 7.9049}:  10%|█         | 1/10 [00:03<00:35,  3.99s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9317, 'compress@10': 0.1382, 'time@10': 7.1435}:  10%|█         | 1/10 [00:10<00:35,  3.99s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0195, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9317, 'compress@10': 0.1382, 'time@10': 7.1435}:  20%|██        | 2/10 [00:10<00:43,  5.42s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9068, 'compress@10': 0.1683, 'time@10': 6.5094}:  20%|██        | 2/10 [00:13<00:43,  5.42s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9068, 'compress@10': 0.1683, 'time@10': 6.5094}:  30%|███       | 3/10 [00:13<00:29,  4.16s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9081, 'compress@10': 0.1593, 'time@10': 6.3102}:  30%|███       | 3/10 [00:18<00:29,  4.16s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9081, 'compress@10': 0.1593, 'time@10': 6.3102}:  40%|████      | 4/10 [00:18<00:28,  4.78s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.9044, 'compress@10': 0.151, 'time@10': 7.6011}:  40%|████      | 4/10 [00:25<00:28,  4.78s/it] {'epoch': 23, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.9044, 'compress@10': 0.151, 'time@10': 7.6011}:  50%|█████     | 5/10 [00:25<00:26,  5.37s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9128, 'compress@10': 0.1459, 'time@10': 7.9835}:  50%|█████     | 5/10 [00:35<00:26,  5.37s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9128, 'compress@10': 0.1459, 'time@10': 7.9835}:  60%|██████    | 6/10 [00:35<00:27,  6.92s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9156, 'compress@10': 0.1445, 'time@10': 8.3436}:  60%|██████    | 6/10 [00:40<00:27,  6.92s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9156, 'compress@10': 0.1445, 'time@10': 8.3436}:  70%|███████   | 7/10 [00:40<00:19,  6.39s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0193, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9196, 'compress@10': 0.1421, 'time@10': 8.2501}:  70%|███████   | 7/10 [00:48<00:19,  6.39s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0193, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9196, 'compress@10': 0.1421, 'time@10': 8.2501}:  80%|████████  | 8/10 [00:48<00:13,  6.79s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.924, 'compress@10': 0.1403, 'time@10': 8.8028}:  80%|████████  | 8/10 [00:54<00:13,  6.79s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.924, 'compress@10': 0.1403, 'time@10': 8.8028}:  90%|█████████ | 9/10 [00:54<00:06,  6.74s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9289, 'compress@10': 0.1383, 'time@10': 8.8488}:  90%|█████████ | 9/10 [01:04<00:06,  6.74s/it]  {'epoch': 23, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9289, 'compress@10': 0.1383, 'time@10': 8.8488}: 100%|██████████| 10/10 [01:04<00:00,  7.53s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9289, 'compress@10': 0.1383, 'time@10': 8.8488}: 100%|██████████| 10/10 [01:04<00:00,  6.40s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.017138427189180135
Avg hit ratio: 0.8811354167432265
Avg ndcg: 0.9289406228168142
Avg compression ratio: 0.1383098996794973
Avg train time: 8.84882140159607
Std train time: 2.6436521631963195
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.915, 'compress@10': 0.1474, 'time@10': 7.7355}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.915, 'compress@10': 0.1474, 'time@10': 7.7355}:  10%|█         | 1/10 [00:03<00:35,  3.91s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9419, 'compress@10': 0.1382, 'time@10': 7.1409}:  10%|█         | 1/10 [00:10<00:35,  3.91s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9419, 'compress@10': 0.1382, 'time@10': 7.1409}:  20%|██        | 2/10 [00:10<00:43,  5.49s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9136, 'compress@10': 0.1683, 'time@10': 6.4989}:  20%|██        | 2/10 [00:13<00:43,  5.49s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9136, 'compress@10': 0.1683, 'time@10': 6.4989}:  30%|███       | 3/10 [00:13<00:29,  4.19s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9107, 'compress@10': 0.1593, 'time@10': 6.3478}:  30%|███       | 3/10 [00:19<00:29,  4.19s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9107, 'compress@10': 0.1593, 'time@10': 6.3478}:  40%|████      | 4/10 [00:19<00:29,  4.88s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9077, 'compress@10': 0.151, 'time@10': 7.6543}:  40%|████      | 4/10 [00:25<00:29,  4.88s/it]  {'epoch': 24, 'num_users': 5.8, 'loss': 0.018, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9077, 'compress@10': 0.151, 'time@10': 7.6543}:  50%|█████     | 5/10 [00:25<00:27,  5.46s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9157, 'compress@10': 0.1459, 'time@10': 7.9837}:  50%|█████     | 5/10 [00:35<00:27,  5.46s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9157, 'compress@10': 0.1459, 'time@10': 7.9837}:  60%|██████    | 6/10 [00:35<00:27,  6.89s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0172, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9207, 'compress@10': 0.1445, 'time@10': 8.2906}:  60%|██████    | 6/10 [00:40<00:27,  6.89s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0172, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9207, 'compress@10': 0.1445, 'time@10': 8.2906}:  70%|███████   | 7/10 [00:40<00:18,  6.30s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9256, 'compress@10': 0.1421, 'time@10': 8.1883}:  70%|███████   | 7/10 [00:47<00:18,  6.30s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9256, 'compress@10': 0.1421, 'time@10': 8.1883}:  80%|████████  | 8/10 [00:47<00:13,  6.69s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.93, 'compress@10': 0.1403, 'time@10': 8.8796}:  80%|████████  | 8/10 [00:55<00:13,  6.69s/it] {'epoch': 24, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.93, 'compress@10': 0.1403, 'time@10': 8.8796}:  90%|█████████ | 9/10 [00:55<00:06,  6.86s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9306, 'compress@10': 0.1383, 'time@10': 8.9177}:  90%|█████████ | 9/10 [01:04<00:06,  6.86s/it] {'epoch': 24, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9306, 'compress@10': 0.1383, 'time@10': 8.9177}: 100%|██████████| 10/10 [01:04<00:00,  7.61s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9306, 'compress@10': 0.1383, 'time@10': 8.9177}: 100%|██████████| 10/10 [01:04<00:00,  6.44s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.01706755842680367
Avg hit ratio: 0.8923417659495758
Avg ndcg: 0.930639611900669
Avg compression ratio: 0.1383099039842772
Avg train time: 8.917696571350097
Std train time: 2.8272862545377877
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.915, 'compress@10': 0.1474, 'time@10': 7.7867}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.915, 'compress@10': 0.1474, 'time@10': 7.7867}:  10%|█         | 1/10 [00:03<00:35,  3.93s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9387, 'compress@10': 0.1382, 'time@10': 7.0769}:  10%|█         | 1/10 [00:10<00:35,  3.93s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9387, 'compress@10': 0.1382, 'time@10': 7.0769}:  20%|██        | 2/10 [00:10<00:43,  5.39s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9115, 'compress@10': 0.1683, 'time@10': 6.4476}:  20%|██        | 2/10 [00:12<00:43,  5.39s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9115, 'compress@10': 0.1683, 'time@10': 6.4476}:  30%|███       | 3/10 [00:12<00:28,  4.13s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.7914, 'ndcg@10': 0.914, 'compress@10': 0.1593, 'time@10': 6.2545}:  30%|███       | 3/10 [00:18<00:28,  4.13s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.7914, 'ndcg@10': 0.914, 'compress@10': 0.1593, 'time@10': 6.2545}:  40%|████      | 4/10 [00:18<00:28,  4.75s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.9109, 'compress@10': 0.151, 'time@10': 7.5702}:  40%|████      | 4/10 [00:25<00:28,  4.75s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0158, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.9109, 'compress@10': 0.151, 'time@10': 7.5702}:  50%|█████     | 5/10 [00:25<00:26,  5.37s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.9245, 'compress@10': 0.1459, 'time@10': 7.9519}:  50%|█████     | 5/10 [00:35<00:26,  5.37s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.9245, 'compress@10': 0.1459, 'time@10': 7.9519}:  60%|██████    | 6/10 [00:35<00:27,  6.91s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9249, 'compress@10': 0.1445, 'time@10': 8.2722}:  60%|██████    | 6/10 [00:40<00:27,  6.91s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9249, 'compress@10': 0.1445, 'time@10': 8.2722}:  70%|███████   | 7/10 [00:40<00:18,  6.33s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9273, 'compress@10': 0.1421, 'time@10': 8.153}:  70%|███████   | 7/10 [00:47<00:18,  6.33s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9273, 'compress@10': 0.1421, 'time@10': 8.153}:  80%|████████  | 8/10 [00:47<00:13,  6.66s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9331, 'compress@10': 0.1403, 'time@10': 8.708}:  80%|████████  | 8/10 [00:54<00:13,  6.66s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9331, 'compress@10': 0.1403, 'time@10': 8.708}:  90%|█████████ | 9/10 [00:54<00:06,  6.64s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9366, 'compress@10': 0.1383, 'time@10': 8.7483}:  90%|█████████ | 9/10 [01:03<00:06,  6.64s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9366, 'compress@10': 0.1383, 'time@10': 8.7483}: 100%|██████████| 10/10 [01:03<00:00,  7.42s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9366, 'compress@10': 0.1383, 'time@10': 8.7483}: 100%|██████████| 10/10 [01:03<00:00,  6.33s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.019301286045290026
Avg hit ratio: 0.8791953245773281
Avg ndcg: 0.9366214144444479
Avg compression ratio: 0.13830976010292223
Avg train time: 8.748316836357116
Std train time: 2.650542132707513
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9115, 'compress@10': 0.1474, 'time@10': 7.9022}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.018, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9115, 'compress@10': 0.1474, 'time@10': 7.9022}:  10%|█         | 1/10 [00:03<00:35,  3.99s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9379, 'compress@10': 0.1382, 'time@10': 7.2637}:  10%|█         | 1/10 [00:10<00:35,  3.99s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9379, 'compress@10': 0.1382, 'time@10': 7.2637}:  20%|██        | 2/10 [00:10<00:44,  5.56s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.911, 'compress@10': 0.1683, 'time@10': 6.6155}:  20%|██        | 2/10 [00:13<00:44,  5.56s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.911, 'compress@10': 0.1683, 'time@10': 6.6155}:  30%|███       | 3/10 [00:13<00:29,  4.25s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9141, 'compress@10': 0.1593, 'time@10': 6.3972}:  30%|███       | 3/10 [00:19<00:29,  4.25s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9141, 'compress@10': 0.1593, 'time@10': 6.3972}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9128, 'compress@10': 0.151, 'time@10': 7.6543}:  40%|████      | 4/10 [00:25<00:29,  4.86s/it] {'epoch': 26, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9128, 'compress@10': 0.151, 'time@10': 7.6543}:  50%|█████     | 5/10 [00:25<00:27,  5.41s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.921, 'compress@10': 0.1459, 'time@10': 7.9901}:  50%|█████     | 5/10 [00:35<00:27,  5.41s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.921, 'compress@10': 0.1459, 'time@10': 7.9901}:  60%|██████    | 6/10 [00:35<00:27,  6.87s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9229, 'compress@10': 0.1445, 'time@10': 8.307}:  60%|██████    | 6/10 [00:40<00:27,  6.87s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9229, 'compress@10': 0.1445, 'time@10': 8.307}:  70%|███████   | 7/10 [00:40<00:18,  6.30s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9278, 'compress@10': 0.1421, 'time@10': 8.236}:  70%|███████   | 7/10 [00:48<00:18,  6.30s/it]  {'epoch': 26, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9278, 'compress@10': 0.1421, 'time@10': 8.236}:  80%|████████  | 8/10 [00:48<00:13,  6.77s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9468, 'compress@10': 0.1403, 'time@10': 8.7861}:  80%|████████  | 8/10 [00:54<00:13,  6.77s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9468, 'compress@10': 0.1403, 'time@10': 8.7861}:  90%|█████████ | 9/10 [00:54<00:06,  6.73s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9501, 'compress@10': 0.1383, 'time@10': 8.842}:  90%|█████████ | 9/10 [01:04<00:06,  6.73s/it]    {'epoch': 26, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9501, 'compress@10': 0.1383, 'time@10': 8.842}: 100%|██████████| 10/10 [01:04<00:00,  7.55s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0178, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9501, 'compress@10': 0.1383, 'time@10': 8.842}: 100%|██████████| 10/10 [01:04<00:00,  6.41s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.017816047051382924
Avg hit ratio: 0.8864584824720648
Avg ndcg: 0.950149292341069
Avg compression ratio: 0.1383098852664426
Avg train time: 8.842009711265565
Std train time: 2.558682514739211
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8895, 'compress@10': 0.1474, 'time@10': 7.6997}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8895, 'compress@10': 0.1474, 'time@10': 7.6997}:  10%|█         | 1/10 [00:03<00:34,  3.88s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9244, 'compress@10': 0.1382, 'time@10': 7.0233}:  10%|█         | 1/10 [00:10<00:34,  3.88s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9244, 'compress@10': 0.1382, 'time@10': 7.0233}:  20%|██        | 2/10 [00:10<00:42,  5.35s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.902, 'compress@10': 0.1683, 'time@10': 6.4367}:  20%|██        | 2/10 [00:12<00:42,  5.35s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.902, 'compress@10': 0.1683, 'time@10': 6.4367}:  30%|███       | 3/10 [00:12<00:28,  4.13s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9058, 'compress@10': 0.1593, 'time@10': 6.2515}:  30%|███       | 3/10 [00:18<00:28,  4.13s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9058, 'compress@10': 0.1593, 'time@10': 6.2515}:  40%|████      | 4/10 [00:18<00:28,  4.76s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9079, 'compress@10': 0.151, 'time@10': 7.5548}:  40%|████      | 4/10 [00:25<00:28,  4.76s/it] {'epoch': 27, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9079, 'compress@10': 0.151, 'time@10': 7.5548}:  50%|█████     | 5/10 [00:25<00:26,  5.36s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9165, 'compress@10': 0.1459, 'time@10': 7.8938}:  50%|█████     | 5/10 [00:34<00:26,  5.36s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9165, 'compress@10': 0.1459, 'time@10': 7.8938}:  60%|██████    | 6/10 [00:34<00:27,  6.81s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9213, 'compress@10': 0.1445, 'time@10': 8.2583}:  60%|██████    | 6/10 [00:39<00:27,  6.81s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9213, 'compress@10': 0.1445, 'time@10': 8.2583}:  70%|███████   | 7/10 [00:39<00:18,  6.30s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9254, 'compress@10': 0.1421, 'time@10': 8.1484}:  70%|███████   | 7/10 [00:47<00:18,  6.30s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9254, 'compress@10': 0.1421, 'time@10': 8.1484}:  80%|████████  | 8/10 [00:47<00:13,  6.66s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9404, 'compress@10': 0.1403, 'time@10': 8.6855}:  80%|████████  | 8/10 [00:53<00:13,  6.66s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9404, 'compress@10': 0.1403, 'time@10': 8.6855}:  90%|█████████ | 9/10 [00:53<00:06,  6.62s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9408, 'compress@10': 0.1383, 'time@10': 8.731}:  90%|█████████ | 9/10 [01:03<00:06,  6.62s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9408, 'compress@10': 0.1383, 'time@10': 8.731}: 100%|██████████| 10/10 [01:03<00:00,  7.41s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9408, 'compress@10': 0.1383, 'time@10': 8.731}: 100%|██████████| 10/10 [01:03<00:00,  6.31s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.023317969939364948
Avg hit ratio: 0.8778870539006363
Avg ndcg: 0.9407873959279648
Avg compression ratio: 0.1383098764932905
Avg train time: 8.731022310256957
Std train time: 2.6080782530258646
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9019, 'compress@10': 0.1474, 'time@10': 8.2178}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9019, 'compress@10': 0.1474, 'time@10': 8.2178}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9962, 'compress@10': 0.1382, 'time@10': 7.3899}:  10%|█         | 1/10 [00:10<00:37,  4.15s/it] {'epoch': 28, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9962, 'compress@10': 0.1382, 'time@10': 7.3899}:  20%|██        | 2/10 [00:10<00:44,  5.59s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9499, 'compress@10': 0.1683, 'time@10': 6.7413}:  20%|██        | 2/10 [00:13<00:44,  5.59s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9499, 'compress@10': 0.1683, 'time@10': 6.7413}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9453, 'compress@10': 0.1593, 'time@10': 6.5269}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9453, 'compress@10': 0.1593, 'time@10': 6.5269}:  40%|████      | 4/10 [00:19<00:29,  4.94s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0184, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9407, 'compress@10': 0.151, 'time@10': 7.76}:  40%|████      | 4/10 [00:25<00:29,  4.94s/it]   {'epoch': 28, 'num_users': 5.8, 'loss': 0.0184, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9407, 'compress@10': 0.151, 'time@10': 7.76}:  50%|█████     | 5/10 [00:25<00:27,  5.46s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0203, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9495, 'compress@10': 0.1459, 'time@10': 8.0835}:  50%|█████     | 5/10 [00:35<00:27,  5.46s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0203, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9495, 'compress@10': 0.1459, 'time@10': 8.0835}:  60%|██████    | 6/10 [00:35<00:27,  6.92s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0201, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9496, 'compress@10': 0.1445, 'time@10': 8.4104}:  60%|██████    | 6/10 [00:40<00:27,  6.92s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0201, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9496, 'compress@10': 0.1445, 'time@10': 8.4104}:  70%|███████   | 7/10 [00:40<00:19,  6.36s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0191, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9515, 'compress@10': 0.1421, 'time@10': 8.3005}:  70%|███████   | 7/10 [00:48<00:19,  6.36s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0191, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9515, 'compress@10': 0.1421, 'time@10': 8.3005}:  80%|████████  | 8/10 [00:48<00:13,  6.75s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9575, 'compress@10': 0.1403, 'time@10': 8.8166}:  80%|████████  | 8/10 [00:54<00:13,  6.75s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9575, 'compress@10': 0.1403, 'time@10': 8.8166}:  90%|█████████ | 9/10 [00:54<00:06,  6.67s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9594, 'compress@10': 0.1383, 'time@10': 8.8564}:  90%|█████████ | 9/10 [01:04<00:06,  6.67s/it]  {'epoch': 28, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9594, 'compress@10': 0.1383, 'time@10': 8.8564}: 100%|██████████| 10/10 [01:04<00:00,  7.47s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0206, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9594, 'compress@10': 0.1383, 'time@10': 8.8564}: 100%|██████████| 10/10 [01:04<00:00,  6.41s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.02059637300760938
Avg hit ratio: 0.878890638130027
Avg ndcg: 0.9593810713375233
Avg compression ratio: 0.1383098996794973
Avg train time: 8.856353783607483
Std train time: 2.4994936842436357
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8959, 'compress@10': 0.1474, 'time@10': 7.7326}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8959, 'compress@10': 0.1474, 'time@10': 7.7326}:  10%|█         | 1/10 [00:03<00:35,  3.90s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9307, 'compress@10': 0.1382, 'time@10': 7.0692}:  10%|█         | 1/10 [00:10<00:35,  3.90s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9307, 'compress@10': 0.1382, 'time@10': 7.0692}:  20%|██        | 2/10 [00:10<00:43,  5.40s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9061, 'compress@10': 0.1683, 'time@10': 6.5119}:  20%|██        | 2/10 [00:13<00:43,  5.40s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9061, 'compress@10': 0.1683, 'time@10': 6.5119}:  30%|███       | 3/10 [00:13<00:29,  4.19s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9153, 'compress@10': 0.1593, 'time@10': 6.3376}:  30%|███       | 3/10 [00:18<00:29,  4.19s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9153, 'compress@10': 0.1593, 'time@10': 6.3376}:  40%|████      | 4/10 [00:18<00:29,  4.85s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9159, 'compress@10': 0.151, 'time@10': 7.7161}:  40%|████      | 4/10 [00:25<00:29,  4.85s/it] {'epoch': 29, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9159, 'compress@10': 0.151, 'time@10': 7.7161}:  50%|█████     | 5/10 [00:25<00:27,  5.50s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9253, 'compress@10': 0.1459, 'time@10': 8.038}:  50%|█████     | 5/10 [00:35<00:27,  5.50s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9253, 'compress@10': 0.1459, 'time@10': 8.038}:  60%|██████    | 6/10 [00:35<00:27,  6.92s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9263, 'compress@10': 0.1445, 'time@10': 8.3521}:  60%|██████    | 6/10 [00:40<00:27,  6.92s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9263, 'compress@10': 0.1445, 'time@10': 8.3521}:  70%|███████   | 7/10 [00:40<00:19,  6.34s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9297, 'compress@10': 0.1421, 'time@10': 8.2296}:  70%|███████   | 7/10 [00:47<00:19,  6.34s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9297, 'compress@10': 0.1421, 'time@10': 8.2296}:  80%|████████  | 8/10 [00:47<00:13,  6.68s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9358, 'compress@10': 0.1403, 'time@10': 8.8158}:  80%|████████  | 8/10 [00:54<00:13,  6.68s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9358, 'compress@10': 0.1403, 'time@10': 8.8158}:  90%|█████████ | 9/10 [00:54<00:06,  6.72s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9378, 'compress@10': 0.1383, 'time@10': 8.895}:  90%|█████████ | 9/10 [01:04<00:06,  6.72s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9378, 'compress@10': 0.1383, 'time@10': 8.895}: 100%|██████████| 10/10 [01:04<00:00,  7.62s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9378, 'compress@10': 0.1383, 'time@10': 8.895}: 100%|██████████| 10/10 [01:04<00:00,  6.43s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.015058347038368568
Avg hit ratio: 0.8856878731530685
Avg ndcg: 0.9377748345528488
Avg compression ratio: 0.13830989844956018
Avg train time: 8.894952845573425
Std train time: 2.729814086798698
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9126, 'compress@10': 0.1474, 'time@10': 7.9345}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9126, 'compress@10': 0.1474, 'time@10': 7.9345}:  10%|█         | 1/10 [00:04<00:36,  4.01s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9448, 'compress@10': 0.1382, 'time@10': 7.1579}:  10%|█         | 1/10 [00:10<00:36,  4.01s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9448, 'compress@10': 0.1382, 'time@10': 7.1579}:  20%|██        | 2/10 [00:10<00:43,  5.43s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9156, 'compress@10': 0.1683, 'time@10': 6.5339}:  20%|██        | 2/10 [00:13<00:43,  5.43s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9156, 'compress@10': 0.1683, 'time@10': 6.5339}:  30%|███       | 3/10 [00:13<00:29,  4.17s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9223, 'compress@10': 0.1593, 'time@10': 6.3532}:  30%|███       | 3/10 [00:18<00:29,  4.17s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9223, 'compress@10': 0.1593, 'time@10': 6.3532}:  40%|████      | 4/10 [00:18<00:29,  4.83s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9234, 'compress@10': 0.151, 'time@10': 7.5823}:  40%|████      | 4/10 [00:25<00:29,  4.83s/it] {'epoch': 30, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9234, 'compress@10': 0.151, 'time@10': 7.5823}:  50%|█████     | 5/10 [00:25<00:26,  5.36s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0159, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9357, 'compress@10': 0.1459, 'time@10': 7.9468}:  50%|█████     | 5/10 [00:35<00:26,  5.36s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0159, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9357, 'compress@10': 0.1459, 'time@10': 7.9468}:  60%|██████    | 6/10 [00:35<00:27,  6.89s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9379, 'compress@10': 0.1445, 'time@10': 8.3647}:  60%|██████    | 6/10 [00:40<00:27,  6.89s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9379, 'compress@10': 0.1445, 'time@10': 8.3647}:  70%|███████   | 7/10 [00:40<00:19,  6.43s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9392, 'compress@10': 0.1421, 'time@10': 8.268}:  70%|███████   | 7/10 [00:48<00:19,  6.43s/it]  {'epoch': 30, 'num_users': 6.125, 'loss': 0.0144, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9392, 'compress@10': 0.1421, 'time@10': 8.268}:  80%|████████  | 8/10 [00:48<00:13,  6.81s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9412, 'compress@10': 0.1403, 'time@10': 8.8056}:  80%|████████  | 8/10 [00:54<00:13,  6.81s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9412, 'compress@10': 0.1403, 'time@10': 8.8056}:  90%|█████████ | 9/10 [00:54<00:06,  6.74s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9447, 'compress@10': 0.1383, 'time@10': 8.8255}:  90%|█████████ | 9/10 [01:03<00:06,  6.74s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9447, 'compress@10': 0.1383, 'time@10': 8.8255}: 100%|██████████| 10/10 [01:03<00:00,  7.45s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9447, 'compress@10': 0.1383, 'time@10': 8.8255}: 100%|██████████| 10/10 [01:03<00:00,  6.38s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.012783799167149796
Avg hit ratio: 0.8871727681863506
Avg ndcg: 0.9447033622909808
Avg compression ratio: 0.1383099039842772
Avg train time: 8.82554349899292
Std train time: 2.585241639966926
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9104, 'compress@10': 0.1474, 'time@10': 7.7169}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9104, 'compress@10': 0.1474, 'time@10': 7.7169}:  10%|█         | 1/10 [00:03<00:35,  3.89s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9391, 'compress@10': 0.1382, 'time@10': 7.0247}:  10%|█         | 1/10 [00:10<00:35,  3.89s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9391, 'compress@10': 0.1382, 'time@10': 7.0247}:  20%|██        | 2/10 [00:10<00:42,  5.35s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9118, 'compress@10': 0.1683, 'time@10': 6.4131}:  20%|██        | 2/10 [00:12<00:42,  5.35s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9118, 'compress@10': 0.1683, 'time@10': 6.4131}:  30%|███       | 3/10 [00:12<00:28,  4.11s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9204, 'compress@10': 0.1593, 'time@10': 6.2705}:  30%|███       | 3/10 [00:18<00:28,  4.11s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9204, 'compress@10': 0.1593, 'time@10': 6.2705}:  40%|████      | 4/10 [00:18<00:28,  4.81s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9216, 'compress@10': 0.151, 'time@10': 7.5383}:  40%|████      | 4/10 [00:25<00:28,  4.81s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9216, 'compress@10': 0.151, 'time@10': 7.5383}:  50%|█████     | 5/10 [00:25<00:26,  5.36s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9301, 'compress@10': 0.1459, 'time@10': 7.8957}:  50%|█████     | 5/10 [00:34<00:26,  5.36s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9301, 'compress@10': 0.1459, 'time@10': 7.8957}:  60%|██████    | 6/10 [00:34<00:27,  6.84s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9332, 'compress@10': 0.1445, 'time@10': 8.224}:  60%|██████    | 6/10 [00:39<00:27,  6.84s/it]  {'epoch': 31, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9332, 'compress@10': 0.1445, 'time@10': 8.224}:  70%|███████   | 7/10 [00:39<00:18,  6.28s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9362, 'compress@10': 0.1421, 'time@10': 8.1211}:  70%|███████   | 7/10 [00:47<00:18,  6.28s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9362, 'compress@10': 0.1421, 'time@10': 8.1211}:  80%|████████  | 8/10 [00:47<00:13,  6.65s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9453, 'compress@10': 0.1403, 'time@10': 8.6981}:  80%|████████  | 8/10 [00:54<00:13,  6.65s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9453, 'compress@10': 0.1403, 'time@10': 8.6981}:  90%|█████████ | 9/10 [00:54<00:06,  6.67s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9443, 'compress@10': 0.1383, 'time@10': 8.7593}:  90%|█████████ | 9/10 [01:03<00:06,  6.67s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9443, 'compress@10': 0.1383, 'time@10': 8.7593}: 100%|██████████| 10/10 [01:03<00:00,  7.49s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9443, 'compress@10': 0.1383, 'time@10': 8.7593}: 100%|██████████| 10/10 [01:03<00:00,  6.35s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.015576111912818474
Avg hit ratio: 0.8906878731530684
Avg ndcg: 0.9442876394046762
Avg compression ratio: 0.13830989378874586
Avg train time: 8.75926206111908
Std train time: 2.6239594597789715
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.1474, 'time@10': 7.5552}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.1474, 'time@10': 7.5552}:  10%|█         | 1/10 [00:03<00:34,  3.81s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9412, 'compress@10': 0.1382, 'time@10': 7.0228}:  10%|█         | 1/10 [00:10<00:34,  3.81s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9412, 'compress@10': 0.1382, 'time@10': 7.0228}:  20%|██        | 2/10 [00:10<00:43,  5.41s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9132, 'compress@10': 0.1683, 'time@10': 6.3942}:  20%|██        | 2/10 [00:12<00:43,  5.41s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9132, 'compress@10': 0.1683, 'time@10': 6.3942}:  30%|███       | 3/10 [00:12<00:28,  4.13s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9163, 'compress@10': 0.1593, 'time@10': 6.2591}:  30%|███       | 3/10 [00:18<00:28,  4.13s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9163, 'compress@10': 0.1593, 'time@10': 6.2591}:  40%|████      | 4/10 [00:18<00:28,  4.82s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9196, 'compress@10': 0.151, 'time@10': 7.4772}:  40%|████      | 4/10 [00:25<00:28,  4.82s/it] {'epoch': 32, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9196, 'compress@10': 0.151, 'time@10': 7.4772}:  50%|█████     | 5/10 [00:25<00:26,  5.32s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9306, 'compress@10': 0.1459, 'time@10': 7.8494}:  50%|█████     | 5/10 [00:34<00:26,  5.32s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9306, 'compress@10': 0.1459, 'time@10': 7.8494}:  60%|██████    | 6/10 [00:34<00:27,  6.83s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.017, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9385, 'compress@10': 0.1445, 'time@10': 8.1581}:  60%|██████    | 6/10 [00:39<00:27,  6.83s/it] {'epoch': 32, 'num_users': 6.2857, 'loss': 0.017, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9385, 'compress@10': 0.1445, 'time@10': 8.1581}:  70%|███████   | 7/10 [00:39<00:18,  6.24s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9416, 'compress@10': 0.1421, 'time@10': 8.053}:  70%|███████   | 7/10 [00:47<00:18,  6.24s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9416, 'compress@10': 0.1421, 'time@10': 8.053}:  80%|████████  | 8/10 [00:47<00:13,  6.60s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9419, 'compress@10': 0.1403, 'time@10': 8.6297}:  80%|████████  | 8/10 [00:53<00:13,  6.60s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9419, 'compress@10': 0.1403, 'time@10': 8.6297}:  90%|█████████ | 9/10 [00:53<00:06,  6.62s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9453, 'compress@10': 0.1383, 'time@10': 8.6723}:  90%|█████████ | 9/10 [01:02<00:06,  6.62s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9453, 'compress@10': 0.1383, 'time@10': 8.6723}: 100%|██████████| 10/10 [01:02<00:00,  7.38s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9453, 'compress@10': 0.1383, 'time@10': 8.6723}: 100%|██████████| 10/10 [01:02<00:00,  6.29s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.014928254831133131
Avg hit ratio: 0.8778870539006363
Avg ndcg: 0.945322322289511
Avg compression ratio: 0.1383099039842772
Avg train time: 8.672320127487183
Std train time: 2.563381971795463
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9232, 'compress@10': 0.1474, 'time@10': 7.62}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9232, 'compress@10': 0.1474, 'time@10': 7.62}:  10%|█         | 1/10 [00:03<00:34,  3.85s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9452, 'compress@10': 0.1382, 'time@10': 6.9823}:  10%|█         | 1/10 [00:10<00:34,  3.85s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9452, 'compress@10': 0.1382, 'time@10': 6.9823}:  20%|██        | 2/10 [00:10<00:42,  5.34s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9158, 'compress@10': 0.1683, 'time@10': 6.4418}:  20%|██        | 2/10 [00:12<00:42,  5.34s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9158, 'compress@10': 0.1683, 'time@10': 6.4418}:  30%|███       | 3/10 [00:12<00:28,  4.14s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.9226, 'compress@10': 0.1593, 'time@10': 6.2291}:  30%|███       | 3/10 [00:18<00:28,  4.14s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.9226, 'compress@10': 0.1593, 'time@10': 6.2291}:  40%|████      | 4/10 [00:18<00:28,  4.73s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.924, 'compress@10': 0.151, 'time@10': 7.4815}:  40%|████      | 4/10 [00:24<00:28,  4.73s/it]  {'epoch': 33, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.924, 'compress@10': 0.151, 'time@10': 7.4815}:  50%|█████     | 5/10 [00:24<00:26,  5.29s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9313, 'compress@10': 0.1459, 'time@10': 7.867}:  50%|█████     | 5/10 [00:34<00:26,  5.29s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9313, 'compress@10': 0.1459, 'time@10': 7.867}:  60%|██████    | 6/10 [00:34<00:27,  6.83s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9334, 'compress@10': 0.1445, 'time@10': 8.201}:  60%|██████    | 6/10 [00:39<00:27,  6.83s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9334, 'compress@10': 0.1445, 'time@10': 8.201}:  70%|███████   | 7/10 [00:39<00:18,  6.28s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9373, 'compress@10': 0.1421, 'time@10': 8.1235}:  70%|███████   | 7/10 [00:47<00:18,  6.28s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9373, 'compress@10': 0.1421, 'time@10': 8.1235}:  80%|████████  | 8/10 [00:47<00:13,  6.71s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9422, 'compress@10': 0.1403, 'time@10': 8.6662}:  80%|████████  | 8/10 [00:53<00:13,  6.71s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0144, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9422, 'compress@10': 0.1403, 'time@10': 8.6662}:  90%|█████████ | 9/10 [00:53<00:06,  6.66s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9413, 'compress@10': 0.1383, 'time@10': 8.7055}:  90%|█████████ | 9/10 [01:03<00:06,  6.66s/it]    {'epoch': 33, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9413, 'compress@10': 0.1383, 'time@10': 8.7055}: 100%|██████████| 10/10 [01:03<00:00,  7.41s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0171, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9413, 'compress@10': 0.1383, 'time@10': 8.7055}: 100%|██████████| 10/10 [01:03<00:00,  6.31s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.017149839534625407
Avg hit ratio: 0.8810104537982297
Avg ndcg: 0.9413447220352367
Avg compression ratio: 0.1383098996794973
Avg train time: 8.705517172813416
Std train time: 2.555484061777009
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9232, 'compress@10': 0.1474, 'time@10': 7.9748}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9232, 'compress@10': 0.1474, 'time@10': 7.9748}:  10%|█         | 1/10 [00:04<00:36,  4.02s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9702, 'compress@10': 0.1382, 'time@10': 7.1332}:  10%|█         | 1/10 [00:10<00:36,  4.02s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9702, 'compress@10': 0.1382, 'time@10': 7.1332}:  20%|██        | 2/10 [00:10<00:43,  5.38s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9325, 'compress@10': 0.1683, 'time@10': 6.5065}:  20%|██        | 2/10 [00:13<00:43,  5.38s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9325, 'compress@10': 0.1683, 'time@10': 6.5065}:  30%|███       | 3/10 [00:13<00:28,  4.14s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.9373, 'compress@10': 0.1593, 'time@10': 6.3075}:  30%|███       | 3/10 [00:18<00:28,  4.14s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.9373, 'compress@10': 0.1593, 'time@10': 6.3075}:  40%|████      | 4/10 [00:18<00:28,  4.78s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.9369, 'compress@10': 0.151, 'time@10': 7.6593}:  40%|████      | 4/10 [00:25<00:28,  4.78s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.9369, 'compress@10': 0.151, 'time@10': 7.6593}:  50%|█████     | 5/10 [00:25<00:27,  5.42s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0124, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9428, 'compress@10': 0.1459, 'time@10': 8.0096}:  50%|█████     | 5/10 [00:35<00:27,  5.42s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0124, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9428, 'compress@10': 0.1459, 'time@10': 8.0096}:  60%|██████    | 6/10 [00:35<00:27,  6.91s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9442, 'compress@10': 0.1445, 'time@10': 8.6402}:  60%|██████    | 6/10 [00:41<00:27,  6.91s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9442, 'compress@10': 0.1445, 'time@10': 8.6402}:  70%|███████   | 7/10 [00:41<00:20,  6.70s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9469, 'compress@10': 0.1421, 'time@10': 8.4989}:  70%|███████   | 7/10 [00:48<00:20,  6.70s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9469, 'compress@10': 0.1421, 'time@10': 8.4989}:  80%|████████  | 8/10 [00:48<00:13,  6.98s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9447, 'compress@10': 0.1403, 'time@10': 9.0272}:  80%|████████  | 8/10 [00:55<00:13,  6.98s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9447, 'compress@10': 0.1403, 'time@10': 9.0272}:  90%|█████████ | 9/10 [00:55<00:06,  6.88s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0114, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9478, 'compress@10': 0.1383, 'time@10': 9.0368}:  90%|█████████ | 9/10 [01:04<00:06,  6.88s/it]  {'epoch': 34, 'num_users': 6.3, 'loss': 0.0114, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9478, 'compress@10': 0.1383, 'time@10': 9.0368}: 100%|██████████| 10/10 [01:04<00:00,  7.58s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0114, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9478, 'compress@10': 0.1383, 'time@10': 9.0368}: 100%|██████████| 10/10 [01:04<00:00,  6.48s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.011387166430443671
Avg hit ratio: 0.8752961680839441
Avg ndcg: 0.9478470971767436
Avg compression ratio: 0.13830989709249014
Avg train time: 9.036760663986206
Std train time: 2.870540271514751
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9232, 'compress@10': 0.1474, 'time@10': 8.0001}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9232, 'compress@10': 0.1474, 'time@10': 8.0001}:  10%|█         | 1/10 [00:04<00:36,  4.06s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9455, 'compress@10': 0.1382, 'time@10': 7.2193}:  10%|█         | 1/10 [00:10<00:36,  4.06s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9455, 'compress@10': 0.1382, 'time@10': 7.2193}:  20%|██        | 2/10 [00:10<00:43,  5.48s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.916, 'compress@10': 0.1683, 'time@10': 6.5741}:  20%|██        | 2/10 [00:13<00:43,  5.48s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.916, 'compress@10': 0.1683, 'time@10': 6.5741}:  30%|███       | 3/10 [00:13<00:29,  4.20s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.9266, 'compress@10': 0.1593, 'time@10': 6.3449}:  30%|███       | 3/10 [00:18<00:29,  4.20s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.9266, 'compress@10': 0.1593, 'time@10': 6.3449}:  40%|████      | 4/10 [00:18<00:28,  4.79s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.9291, 'compress@10': 0.151, 'time@10': 7.6444}:  40%|████      | 4/10 [00:25<00:28,  4.79s/it]   {'epoch': 35, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.9291, 'compress@10': 0.151, 'time@10': 7.6444}:  50%|█████     | 5/10 [00:25<00:26,  5.40s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9424, 'compress@10': 0.1459, 'time@10': 8.0597}:  50%|█████     | 5/10 [00:35<00:26,  5.40s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9424, 'compress@10': 0.1459, 'time@10': 8.0597}:  60%|██████    | 6/10 [00:35<00:28,  7.02s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9436, 'compress@10': 0.1445, 'time@10': 8.4487}:  60%|██████    | 6/10 [00:40<00:28,  7.02s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9436, 'compress@10': 0.1445, 'time@10': 8.4487}:  70%|███████   | 7/10 [00:40<00:19,  6.50s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9468, 'compress@10': 0.1421, 'time@10': 8.3064}:  70%|███████   | 7/10 [00:48<00:19,  6.50s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9468, 'compress@10': 0.1421, 'time@10': 8.3064}:  80%|████████  | 8/10 [00:48<00:13,  6.77s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9484, 'compress@10': 0.1403, 'time@10': 8.9066}:  80%|████████  | 8/10 [00:55<00:13,  6.77s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9484, 'compress@10': 0.1403, 'time@10': 8.9066}:  90%|█████████ | 9/10 [00:55<00:06,  6.81s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9469, 'compress@10': 0.1383, 'time@10': 8.9725}:  90%|█████████ | 9/10 [01:04<00:06,  6.81s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9469, 'compress@10': 0.1383, 'time@10': 8.9725}: 100%|██████████| 10/10 [01:04<00:00,  7.67s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9469, 'compress@10': 0.1383, 'time@10': 8.9725}: 100%|██████████| 10/10 [01:04<00:00,  6.48s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.014656304474622553
Avg hit ratio: 0.889338666803862
Avg ndcg: 0.9468946668052751
Avg compression ratio: 0.13830989847084757
Avg train time: 8.972468519210816
Std train time: 2.776880021617924
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.1474, 'time@10': 7.4852}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.1474, 'time@10': 7.4852}:  10%|█         | 1/10 [00:03<00:34,  3.78s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9476, 'compress@10': 0.1382, 'time@10': 7.0136}:  10%|█         | 1/10 [00:10<00:34,  3.78s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9476, 'compress@10': 0.1382, 'time@10': 7.0136}:  20%|██        | 2/10 [00:10<00:43,  5.43s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.7167, 'ndcg@10': 0.9175, 'compress@10': 0.1683, 'time@10': 6.4551}:  20%|██        | 2/10 [00:13<00:43,  5.43s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.7167, 'ndcg@10': 0.9175, 'compress@10': 0.1683, 'time@10': 6.4551}:  30%|███       | 3/10 [00:13<00:29,  4.18s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.7518, 'ndcg@10': 0.9189, 'compress@10': 0.1593, 'time@10': 6.2347}:  30%|███       | 3/10 [00:18<00:29,  4.18s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.7518, 'ndcg@10': 0.9189, 'compress@10': 0.1593, 'time@10': 6.2347}:  40%|████      | 4/10 [00:18<00:28,  4.75s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.7935, 'ndcg@10': 0.9225, 'compress@10': 0.151, 'time@10': 7.4579}:  40%|████      | 4/10 [00:24<00:28,  4.75s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.7935, 'ndcg@10': 0.9225, 'compress@10': 0.151, 'time@10': 7.4579}:  50%|█████     | 5/10 [00:24<00:26,  5.27s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.9313, 'compress@10': 0.1459, 'time@10': 7.8372}:  50%|█████     | 5/10 [00:34<00:26,  5.27s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.9313, 'compress@10': 0.1459, 'time@10': 7.8372}:  60%|██████    | 6/10 [00:34<00:27,  6.80s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.932, 'compress@10': 0.1445, 'time@10': 8.1407}:  60%|██████    | 6/10 [00:39<00:27,  6.80s/it]  {'epoch': 36, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.932, 'compress@10': 0.1445, 'time@10': 8.1407}:  70%|███████   | 7/10 [00:39<00:18,  6.22s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9356, 'compress@10': 0.1421, 'time@10': 8.0404}:  70%|███████   | 7/10 [00:47<00:18,  6.22s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9356, 'compress@10': 0.1421, 'time@10': 8.0404}:  80%|████████  | 8/10 [00:47<00:13,  6.59s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9392, 'compress@10': 0.1403, 'time@10': 8.6271}:  80%|████████  | 8/10 [00:53<00:13,  6.59s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.9392, 'compress@10': 0.1403, 'time@10': 8.6271}:  90%|█████████ | 9/10 [00:53<00:06,  6.62s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9431, 'compress@10': 0.1383, 'time@10': 8.6902}:  90%|█████████ | 9/10 [01:03<00:06,  6.62s/it]     {'epoch': 36, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9431, 'compress@10': 0.1383, 'time@10': 8.6902}: 100%|██████████| 10/10 [01:03<00:00,  7.45s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9431, 'compress@10': 0.1383, 'time@10': 8.6902}: 100%|██████████| 10/10 [01:03<00:00,  6.30s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.010015104992384038
Avg hit ratio: 0.8517247395125155
Avg ndcg: 0.9430516550192418
Avg compression ratio: 0.13830989847084757
Avg train time: 8.69019286632538
Std train time: 2.583023296953902
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9288, 'compress@10': 0.1474, 'time@10': 7.8626}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9288, 'compress@10': 0.1474, 'time@10': 7.8626}:  10%|█         | 1/10 [00:03<00:35,  3.97s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9525, 'compress@10': 0.1382, 'time@10': 7.063}:  10%|█         | 1/10 [00:10<00:35,  3.97s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9525, 'compress@10': 0.1382, 'time@10': 7.063}:  20%|██        | 2/10 [00:10<00:42,  5.34s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9207, 'compress@10': 0.1683, 'time@10': 6.5197}:  20%|██        | 2/10 [00:13<00:42,  5.34s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9207, 'compress@10': 0.1683, 'time@10': 6.5197}:  30%|███       | 3/10 [00:13<00:29,  4.16s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.7786, 'ndcg@10': 0.9267, 'compress@10': 0.1593, 'time@10': 6.2922}:  30%|███       | 3/10 [00:18<00:29,  4.16s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.7786, 'ndcg@10': 0.9267, 'compress@10': 0.1593, 'time@10': 6.2922}:  40%|████      | 4/10 [00:18<00:28,  4.74s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8149, 'ndcg@10': 0.9291, 'compress@10': 0.151, 'time@10': 7.5467}:  40%|████      | 4/10 [00:24<00:28,  4.74s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8149, 'ndcg@10': 0.9291, 'compress@10': 0.151, 'time@10': 7.5467}:  50%|█████     | 5/10 [00:24<00:26,  5.31s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.842, 'ndcg@10': 0.9359, 'compress@10': 0.1459, 'time@10': 7.9006}:  50%|█████     | 5/10 [00:34<00:26,  5.31s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0122, 'hit_ratio@10': 0.842, 'ndcg@10': 0.9359, 'compress@10': 0.1459, 'time@10': 7.9006}:  60%|██████    | 6/10 [00:34<00:27,  6.81s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9381, 'compress@10': 0.1445, 'time@10': 8.3444}:  60%|██████    | 6/10 [00:40<00:27,  6.81s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9381, 'compress@10': 0.1445, 'time@10': 8.3444}:  70%|███████   | 7/10 [00:40<00:19,  6.39s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.942, 'compress@10': 0.1421, 'time@10': 8.2164}:  70%|███████   | 7/10 [00:47<00:19,  6.39s/it]  {'epoch': 37, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.942, 'compress@10': 0.1421, 'time@10': 8.2164}:  80%|████████  | 8/10 [00:47<00:13,  6.70s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9564, 'compress@10': 0.1403, 'time@10': 8.7788}:  80%|████████  | 8/10 [00:54<00:13,  6.70s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9564, 'compress@10': 0.1403, 'time@10': 8.7788}:  90%|█████████ | 9/10 [00:54<00:06,  6.69s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9539, 'compress@10': 0.1383, 'time@10': 8.7945}:  90%|█████████ | 9/10 [01:03<00:06,  6.69s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9539, 'compress@10': 0.1383, 'time@10': 8.7945}: 100%|██████████| 10/10 [01:03<00:00,  7.40s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9539, 'compress@10': 0.1383, 'time@10': 8.7945}: 100%|██████████| 10/10 [01:03<00:00,  6.32s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.016745440673672545
Avg hit ratio: 0.8646612474490233
Avg ndcg: 0.9539258344269564
Avg compression ratio: 0.13830988825402885
Avg train time: 8.794469618797303
Std train time: 2.6624685665410235
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9142, 'compress@10': 0.1474, 'time@10': 7.7552}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9142, 'compress@10': 0.1474, 'time@10': 7.7552}:  10%|█         | 1/10 [00:03<00:35,  3.91s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9409, 'compress@10': 0.1382, 'time@10': 7.1221}:  10%|█         | 1/10 [00:10<00:35,  3.91s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9409, 'compress@10': 0.1382, 'time@10': 7.1221}:  20%|██        | 2/10 [00:10<00:43,  5.45s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.913, 'compress@10': 0.1683, 'time@10': 6.4866}:  20%|██        | 2/10 [00:13<00:43,  5.45s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.913, 'compress@10': 0.1683, 'time@10': 6.4866}:  30%|███       | 3/10 [00:13<00:29,  4.18s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9237, 'compress@10': 0.1593, 'time@10': 6.2581}:  30%|███       | 3/10 [00:18<00:29,  4.18s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9237, 'compress@10': 0.1593, 'time@10': 6.2581}:  40%|████      | 4/10 [00:18<00:28,  4.74s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.9262, 'compress@10': 0.151, 'time@10': 7.504}:  40%|████      | 4/10 [00:24<00:28,  4.74s/it]  {'epoch': 38, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.9262, 'compress@10': 0.151, 'time@10': 7.504}:  50%|█████     | 5/10 [00:24<00:26,  5.30s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.9371, 'compress@10': 0.1459, 'time@10': 7.8498}:  50%|█████     | 5/10 [00:34<00:26,  5.30s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0137, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.9371, 'compress@10': 0.1459, 'time@10': 7.8498}:  60%|██████    | 6/10 [00:34<00:27,  6.77s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.9395, 'compress@10': 0.1445, 'time@10': 8.1646}:  60%|██████    | 6/10 [00:39<00:27,  6.77s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.9395, 'compress@10': 0.1445, 'time@10': 8.1646}:  70%|███████   | 7/10 [00:39<00:18,  6.21s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.942, 'compress@10': 0.1421, 'time@10': 8.0652}:  70%|███████   | 7/10 [00:47<00:18,  6.21s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.942, 'compress@10': 0.1421, 'time@10': 8.0652}:  80%|████████  | 8/10 [00:47<00:13,  6.59s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.935, 'compress@10': 0.1403, 'time@10': 8.6235}:  80%|████████  | 8/10 [00:53<00:13,  6.59s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.935, 'compress@10': 0.1403, 'time@10': 8.6235}:  90%|█████████ | 9/10 [00:53<00:06,  6.59s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9392, 'compress@10': 0.1383, 'time@10': 8.6611}:  90%|█████████ | 9/10 [01:02<00:06,  6.59s/it]  {'epoch': 38, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9392, 'compress@10': 0.1383, 'time@10': 8.6611}: 100%|██████████| 10/10 [01:02<00:00,  7.34s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9392, 'compress@10': 0.1383, 'time@10': 8.6611}: 100%|██████████| 10/10 [01:02<00:00,  6.27s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.014773142937714225
Avg hit ratio: 0.8695255587649475
Avg ndcg: 0.9392176170955464
Avg compression ratio: 0.1383099039842772
Avg train time: 8.661109137535096
Std train time: 2.564477411344628
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9288, 'compress@10': 0.1474, 'time@10': 8.1928}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9288, 'compress@10': 0.1474, 'time@10': 8.1928}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0043, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9483, 'compress@10': 0.1382, 'time@10': 7.349}:  10%|█         | 1/10 [00:10<00:37,  4.15s/it]  {'epoch': 39, 'num_users': 7.0, 'loss': 0.0043, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9483, 'compress@10': 0.1382, 'time@10': 7.349}:  20%|██        | 2/10 [00:10<00:44,  5.56s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0029, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9179, 'compress@10': 0.1683, 'time@10': 6.6405}:  20%|██        | 2/10 [00:13<00:44,  5.56s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0029, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9179, 'compress@10': 0.1683, 'time@10': 6.6405}:  30%|███       | 3/10 [00:13<00:29,  4.23s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9284, 'compress@10': 0.1593, 'time@10': 6.3981}:  30%|███       | 3/10 [00:19<00:29,  4.23s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9284, 'compress@10': 0.1593, 'time@10': 6.3981}:  40%|████      | 4/10 [00:19<00:28,  4.81s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.9311, 'compress@10': 0.151, 'time@10': 7.6392}:  40%|████      | 4/10 [00:25<00:28,  4.81s/it] {'epoch': 39, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.9311, 'compress@10': 0.151, 'time@10': 7.6392}:  50%|█████     | 5/10 [00:25<00:26,  5.36s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0068, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9387, 'compress@10': 0.1459, 'time@10': 7.9798}:  50%|█████     | 5/10 [00:35<00:26,  5.36s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0068, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9387, 'compress@10': 0.1459, 'time@10': 7.9798}:  60%|██████    | 6/10 [00:35<00:27,  6.85s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.941, 'compress@10': 0.1445, 'time@10': 8.2676}:  60%|██████    | 6/10 [00:40<00:27,  6.85s/it] {'epoch': 39, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.941, 'compress@10': 0.1445, 'time@10': 8.2676}:  70%|███████   | 7/10 [00:40<00:18,  6.26s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9435, 'compress@10': 0.1421, 'time@10': 8.1446}:  70%|███████   | 7/10 [00:47<00:18,  6.26s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9435, 'compress@10': 0.1421, 'time@10': 8.1446}:  80%|████████  | 8/10 [00:47<00:13,  6.60s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0078, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.946, 'compress@10': 0.1403, 'time@10': 8.7187}:  80%|████████  | 8/10 [00:54<00:13,  6.60s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0078, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.946, 'compress@10': 0.1403, 'time@10': 8.7187}:  90%|█████████ | 9/10 [00:54<00:06,  6.63s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0071, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9491, 'compress@10': 0.1383, 'time@10': 8.7375}:  90%|█████████ | 9/10 [01:03<00:06,  6.63s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0071, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9491, 'compress@10': 0.1383, 'time@10': 8.7375}: 100%|██████████| 10/10 [01:03<00:00,  7.34s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0071, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9491, 'compress@10': 0.1383, 'time@10': 8.7375}: 100%|██████████| 10/10 [01:03<00:00,  6.31s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.007105317268131424
Avg hit ratio: 0.886033495272884
Avg ndcg: 0.9491422288364285
Avg compression ratio: 0.1383098896994822
Avg train time: 8.73750205039978
Std train time: 2.5985056586423183
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9232, 'compress@10': 0.1474, 'time@10': 7.6384}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9232, 'compress@10': 0.1474, 'time@10': 7.6384}:  10%|█         | 1/10 [00:03<00:34,  3.86s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9458, 'compress@10': 0.1382, 'time@10': 7.0418}:  10%|█         | 1/10 [00:10<00:34,  3.86s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9458, 'compress@10': 0.1382, 'time@10': 7.0418}:  20%|██        | 2/10 [00:10<00:43,  5.40s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9162, 'compress@10': 0.1683, 'time@10': 6.4379}:  20%|██        | 2/10 [00:12<00:43,  5.40s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9162, 'compress@10': 0.1683, 'time@10': 6.4379}:  30%|███       | 3/10 [00:12<00:29,  4.14s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9276, 'compress@10': 0.1593, 'time@10': 6.276}:  30%|███       | 3/10 [00:18<00:29,  4.14s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9276, 'compress@10': 0.1593, 'time@10': 6.276}:  40%|████      | 4/10 [00:18<00:28,  4.81s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.9296, 'compress@10': 0.151, 'time@10': 7.5395}:  40%|████      | 4/10 [00:25<00:28,  4.81s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.9296, 'compress@10': 0.151, 'time@10': 7.5395}:  50%|█████     | 5/10 [00:25<00:26,  5.37s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9352, 'compress@10': 0.1459, 'time@10': 7.91}:  50%|█████     | 5/10 [00:34<00:26,  5.37s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9352, 'compress@10': 0.1459, 'time@10': 7.91}:  60%|██████    | 6/10 [00:34<00:27,  6.87s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9374, 'compress@10': 0.1445, 'time@10': 8.189}:  60%|██████    | 6/10 [00:39<00:27,  6.87s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9374, 'compress@10': 0.1445, 'time@10': 8.189}:  70%|███████   | 7/10 [00:39<00:18,  6.25s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9385, 'compress@10': 0.1421, 'time@10': 8.0577}:  70%|███████   | 7/10 [00:47<00:18,  6.25s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9385, 'compress@10': 0.1421, 'time@10': 8.0577}:  80%|████████  | 8/10 [00:47<00:13,  6.54s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9498, 'compress@10': 0.1403, 'time@10': 8.5918}:  80%|████████  | 8/10 [00:53<00:13,  6.54s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9498, 'compress@10': 0.1403, 'time@10': 8.5918}:  90%|█████████ | 9/10 [00:53<00:06,  6.52s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9486, 'compress@10': 0.1383, 'time@10': 8.6541}:  90%|█████████ | 9/10 [01:02<00:06,  6.52s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9486, 'compress@10': 0.1383, 'time@10': 8.6541}: 100%|██████████| 10/10 [01:02<00:00,  7.36s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9486, 'compress@10': 0.1383, 'time@10': 8.6541}: 100%|██████████| 10/10 [01:02<00:00,  6.28s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.014880098614952302
Avg hit ratio: 0.878232676020452
Avg ndcg: 0.9486429433508604
Avg compression ratio: 0.1383099039842772
Avg train time: 8.654101252555847
Std train time: 2.5373394659293687
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0056, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.1474, 'time@10': 7.679}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0056, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.1474, 'time@10': 7.679}:  10%|█         | 1/10 [00:03<00:34,  3.87s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9609, 'compress@10': 0.1382, 'time@10': 7.1821}:  10%|█         | 1/10 [00:10<00:34,  3.87s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9609, 'compress@10': 0.1382, 'time@10': 7.1821}:  20%|██        | 2/10 [00:10<00:44,  5.55s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9263, 'compress@10': 0.1683, 'time@10': 6.4983}:  20%|██        | 2/10 [00:13<00:44,  5.55s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9263, 'compress@10': 0.1683, 'time@10': 6.4983}:  30%|███       | 3/10 [00:13<00:29,  4.20s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9343, 'compress@10': 0.1593, 'time@10': 6.2653}:  30%|███       | 3/10 [00:18<00:29,  4.20s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8054, 'ndcg@10': 0.9343, 'compress@10': 0.1593, 'time@10': 6.2653}:  40%|████      | 4/10 [00:18<00:28,  4.76s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.9358, 'compress@10': 0.151, 'time@10': 7.4785}:  40%|████      | 4/10 [00:25<00:28,  4.76s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.9358, 'compress@10': 0.151, 'time@10': 7.4785}:  50%|█████     | 5/10 [00:25<00:26,  5.28s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9456, 'compress@10': 0.1459, 'time@10': 7.9091}:  50%|█████     | 5/10 [00:35<00:26,  5.28s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.9456, 'compress@10': 0.1459, 'time@10': 7.9091}:  60%|██████    | 6/10 [00:35<00:27,  6.92s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9474, 'compress@10': 0.1445, 'time@10': 8.2676}:  60%|██████    | 6/10 [00:40<00:27,  6.92s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9474, 'compress@10': 0.1445, 'time@10': 8.2676}:  70%|███████   | 7/10 [00:40<00:19,  6.37s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9546, 'compress@10': 0.1421, 'time@10': 8.1567}:  70%|███████   | 7/10 [00:47<00:19,  6.37s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9546, 'compress@10': 0.1421, 'time@10': 8.1567}:  80%|████████  | 8/10 [00:47<00:13,  6.70s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.945, 'compress@10': 0.1403, 'time@10': 8.7255}:  80%|████████  | 8/10 [00:54<00:13,  6.70s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.945, 'compress@10': 0.1403, 'time@10': 8.7255}:  90%|█████████ | 9/10 [00:54<00:06,  6.69s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9482, 'compress@10': 0.1383, 'time@10': 8.7443}:  90%|█████████ | 9/10 [01:03<00:06,  6.69s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9482, 'compress@10': 0.1383, 'time@10': 8.7443}: 100%|██████████| 10/10 [01:03<00:00,  7.39s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9482, 'compress@10': 0.1383, 'time@10': 8.7443}: 100%|██████████| 10/10 [01:03<00:00,  6.34s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.013196121375484232
Avg hit ratio: 0.8788675966553725
Avg ndcg: 0.9482132279872608
Avg compression ratio: 0.1383099039842772
Avg train time: 8.744343757629395
Std train time: 2.6145892256472782
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.1474, 'time@10': 7.3924}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.1474, 'time@10': 7.3924}:  10%|█         | 1/10 [00:03<00:33,  3.73s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9658, 'compress@10': 0.1382, 'time@10': 6.8483}:  10%|█         | 1/10 [00:10<00:33,  3.73s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9658, 'compress@10': 0.1382, 'time@10': 6.8483}:  20%|██        | 2/10 [00:10<00:42,  5.27s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9296, 'compress@10': 0.1683, 'time@10': 6.2865}:  20%|██        | 2/10 [00:12<00:42,  5.27s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9296, 'compress@10': 0.1683, 'time@10': 6.2865}:  30%|███       | 3/10 [00:12<00:28,  4.06s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9373, 'compress@10': 0.1593, 'time@10': 6.1071}:  30%|███       | 3/10 [00:18<00:28,  4.06s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9373, 'compress@10': 0.1593, 'time@10': 6.1071}:  40%|████      | 4/10 [00:18<00:28,  4.67s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9389, 'compress@10': 0.151, 'time@10': 7.4192}:  40%|████      | 4/10 [00:24<00:28,  4.67s/it]  {'epoch': 42, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9389, 'compress@10': 0.151, 'time@10': 7.4192}:  50%|█████     | 5/10 [00:24<00:26,  5.28s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9452, 'compress@10': 0.1459, 'time@10': 7.79}:  50%|█████     | 5/10 [00:34<00:26,  5.28s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9452, 'compress@10': 0.1459, 'time@10': 7.79}:  60%|██████    | 6/10 [00:34<00:27,  6.78s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0083, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9464, 'compress@10': 0.1445, 'time@10': 8.1314}:  60%|██████    | 6/10 [00:39<00:27,  6.78s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0083, 'hit_ratio@10': 0.8872, 'ndcg@10': 0.9464, 'compress@10': 0.1445, 'time@10': 8.1314}:  70%|███████   | 7/10 [00:39<00:18,  6.24s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9489, 'compress@10': 0.1421, 'time@10': 8.0658}:  70%|███████   | 7/10 [00:47<00:18,  6.24s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9489, 'compress@10': 0.1421, 'time@10': 8.0658}:  80%|████████  | 8/10 [00:47<00:13,  6.69s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0081, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9505, 'compress@10': 0.1403, 'time@10': 8.7281}:  80%|████████  | 8/10 [00:54<00:13,  6.69s/it] {'epoch': 42, 'num_users': 6.3333, 'loss': 0.0081, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9505, 'compress@10': 0.1403, 'time@10': 8.7281}:  90%|█████████ | 9/10 [00:54<00:06,  6.80s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9528, 'compress@10': 0.1383, 'time@10': 8.8244}:  90%|█████████ | 9/10 [01:03<00:06,  6.80s/it] {'epoch': 42, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9528, 'compress@10': 0.1383, 'time@10': 8.8244}: 100%|██████████| 10/10 [01:03<00:00,  7.71s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9528, 'compress@10': 0.1383, 'time@10': 8.8244}: 100%|██████████| 10/10 [01:03<00:00,  6.39s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.009386942174462735
Avg hit ratio: 0.8987708224618242
Avg ndcg: 0.9528124412111325
Avg compression ratio: 0.13830989847084757
Avg train time: 8.824421000480651
Std train time: 2.810360421900751
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0058, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 0.1474, 'time@10': 7.7943}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0058, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 0.1474, 'time@10': 7.7943}:  10%|█         | 1/10 [00:03<00:35,  3.95s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0042, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9496, 'compress@10': 0.1382, 'time@10': 7.122}:  10%|█         | 1/10 [00:10<00:35,  3.95s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.0042, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9496, 'compress@10': 0.1382, 'time@10': 7.122}:  20%|██        | 2/10 [00:10<00:43,  5.45s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0028, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9188, 'compress@10': 0.1683, 'time@10': 6.493}:  20%|██        | 2/10 [00:13<00:43,  5.45s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0028, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9188, 'compress@10': 0.1683, 'time@10': 6.493}:  30%|███       | 3/10 [00:13<00:29,  4.17s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9297, 'compress@10': 0.1593, 'time@10': 6.2724}:  30%|███       | 3/10 [00:18<00:29,  4.17s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9297, 'compress@10': 0.1593, 'time@10': 6.2724}:  40%|████      | 4/10 [00:18<00:28,  4.75s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9316, 'compress@10': 0.151, 'time@10': 7.4808}:  40%|████      | 4/10 [00:24<00:28,  4.75s/it] {'epoch': 43, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9316, 'compress@10': 0.151, 'time@10': 7.4808}:  50%|█████     | 5/10 [00:24<00:26,  5.27s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9405, 'compress@10': 0.1459, 'time@10': 7.8307}:  50%|█████     | 5/10 [00:34<00:26,  5.27s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9405, 'compress@10': 0.1459, 'time@10': 7.8307}:  60%|██████    | 6/10 [00:34<00:26,  6.75s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9359, 'compress@10': 0.1445, 'time@10': 8.159}:  60%|██████    | 6/10 [00:39<00:26,  6.75s/it]   {'epoch': 43, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9359, 'compress@10': 0.1445, 'time@10': 8.159}:  70%|███████   | 7/10 [00:39<00:18,  6.21s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9386, 'compress@10': 0.1421, 'time@10': 8.0602}:  70%|███████   | 7/10 [00:47<00:18,  6.21s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9386, 'compress@10': 0.1421, 'time@10': 8.0602}:  80%|████████  | 8/10 [00:47<00:13,  6.59s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9412, 'compress@10': 0.1403, 'time@10': 8.611}:  80%|████████  | 8/10 [00:53<00:13,  6.59s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9412, 'compress@10': 0.1403, 'time@10': 8.611}:  90%|█████████ | 9/10 [00:53<00:06,  6.58s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9448, 'compress@10': 0.1383, 'time@10': 8.6532}:  90%|█████████ | 9/10 [01:02<00:06,  6.58s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9448, 'compress@10': 0.1383, 'time@10': 8.6532}: 100%|██████████| 10/10 [01:02<00:00,  7.35s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9448, 'compress@10': 0.1383, 'time@10': 8.6532}: 100%|██████████| 10/10 [01:02<00:00,  6.27s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.011206981411791148
Avg hit ratio: 0.8894021588673541
Avg ndcg: 0.9447735770919128
Avg compression ratio: 0.1383098941447803
Avg train time: 8.653194689750672
Std train time: 2.5261905452572844
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.1474, 'time@10': 7.4546}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.1474, 'time@10': 7.4546}:  10%|█         | 1/10 [00:03<00:34,  3.78s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9777, 'compress@10': 0.1382, 'time@10': 7.0074}:  10%|█         | 1/10 [00:10<00:34,  3.78s/it]  {'epoch': 44, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9777, 'compress@10': 0.1382, 'time@10': 7.0074}:  20%|██        | 2/10 [00:10<00:43,  5.44s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9375, 'compress@10': 0.1683, 'time@10': 6.3621}:  20%|██        | 2/10 [00:12<00:43,  5.44s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9375, 'compress@10': 0.1683, 'time@10': 6.3621}:  30%|███       | 3/10 [00:12<00:28,  4.13s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9442, 'compress@10': 0.1593, 'time@10': 6.1849}:  30%|███       | 3/10 [00:18<00:28,  4.13s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9442, 'compress@10': 0.1593, 'time@10': 6.1849}:  40%|████      | 4/10 [00:18<00:28,  4.75s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9442, 'compress@10': 0.151, 'time@10': 7.402}:  40%|████      | 4/10 [00:24<00:28,  4.75s/it]  {'epoch': 44, 'num_users': 5.8, 'loss': 0.0145, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9442, 'compress@10': 0.151, 'time@10': 7.402}:  50%|█████     | 5/10 [00:24<00:26,  5.26s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.949, 'compress@10': 0.1459, 'time@10': 7.8261}:  50%|█████     | 5/10 [00:34<00:26,  5.26s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.949, 'compress@10': 0.1459, 'time@10': 7.8261}:  60%|██████    | 6/10 [00:34<00:27,  6.87s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9503, 'compress@10': 0.1445, 'time@10': 8.1791}:  60%|██████    | 6/10 [00:40<00:27,  6.87s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9503, 'compress@10': 0.1445, 'time@10': 8.1791}:  70%|███████   | 7/10 [00:40<00:18,  6.33s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9492, 'compress@10': 0.1421, 'time@10': 8.0977}:  70%|███████   | 7/10 [00:47<00:18,  6.33s/it]  {'epoch': 44, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9492, 'compress@10': 0.1421, 'time@10': 8.0977}:  80%|████████  | 8/10 [00:47<00:13,  6.72s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9607, 'compress@10': 0.1403, 'time@10': 8.6892}:  80%|████████  | 8/10 [00:54<00:13,  6.72s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9607, 'compress@10': 0.1403, 'time@10': 8.6892}:  90%|█████████ | 9/10 [00:54<00:06,  6.73s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9585, 'compress@10': 0.1383, 'time@10': 8.7816}:  90%|█████████ | 9/10 [01:03<00:06,  6.73s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9585, 'compress@10': 0.1383, 'time@10': 8.7816}: 100%|██████████| 10/10 [01:03<00:00,  7.63s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9585, 'compress@10': 0.1383, 'time@10': 8.7816}: 100%|██████████| 10/10 [01:03<00:00,  6.40s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.015649374491755907
Avg hit ratio: 0.8822398444792332
Avg ndcg: 0.9585318815110441
Avg compression ratio: 0.13830989959859455
Avg train time: 8.78157548904419
Std train time: 2.6432038092582215
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.941, 'compress@10': 0.1474, 'time@10': 7.4575}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.941, 'compress@10': 0.1474, 'time@10': 7.4575}:  10%|█         | 1/10 [00:03<00:33,  3.76s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9526, 'compress@10': 0.1382, 'time@10': 6.7995}:  10%|█         | 1/10 [00:09<00:33,  3.76s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9526, 'compress@10': 0.1382, 'time@10': 6.7995}:  20%|██        | 2/10 [00:09<00:41,  5.18s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9208, 'compress@10': 0.1683, 'time@10': 6.4796}:  20%|██        | 2/10 [00:12<00:41,  5.18s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9208, 'compress@10': 0.1683, 'time@10': 6.4796}:  30%|███       | 3/10 [00:12<00:29,  4.17s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9307, 'compress@10': 0.1593, 'time@10': 6.3139}:  30%|███       | 3/10 [00:18<00:29,  4.17s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9307, 'compress@10': 0.1593, 'time@10': 6.3139}:  40%|████      | 4/10 [00:18<00:29,  4.84s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0078, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9355, 'compress@10': 0.151, 'time@10': 7.5276}:  40%|████      | 4/10 [00:24<00:29,  4.84s/it] {'epoch': 45, 'num_users': 5.8, 'loss': 0.0078, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9355, 'compress@10': 0.151, 'time@10': 7.5276}:  50%|█████     | 5/10 [00:24<00:26,  5.34s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0079, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9424, 'compress@10': 0.1459, 'time@10': 7.8826}:  50%|█████     | 5/10 [00:34<00:26,  5.34s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0079, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.9424, 'compress@10': 0.1459, 'time@10': 7.8826}:  60%|██████    | 6/10 [00:34<00:27,  6.82s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0072, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9447, 'compress@10': 0.1445, 'time@10': 8.1804}:  60%|██████    | 6/10 [00:39<00:27,  6.82s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0072, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9447, 'compress@10': 0.1445, 'time@10': 8.1804}:  70%|███████   | 7/10 [00:39<00:18,  6.23s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0077, 'hit_ratio@10': 0.909, 'ndcg@10': 0.9498, 'compress@10': 0.1421, 'time@10': 8.0791}:  70%|███████   | 7/10 [00:47<00:18,  6.23s/it]  {'epoch': 45, 'num_users': 6.125, 'loss': 0.0077, 'hit_ratio@10': 0.909, 'ndcg@10': 0.9498, 'compress@10': 0.1421, 'time@10': 8.0791}:  80%|████████  | 8/10 [00:47<00:13,  6.61s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9474, 'compress@10': 0.1403, 'time@10': 8.6796}:  80%|████████  | 8/10 [00:53<00:13,  6.61s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9474, 'compress@10': 0.1403, 'time@10': 8.6796}:  90%|█████████ | 9/10 [00:53<00:06,  6.66s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9504, 'compress@10': 0.1383, 'time@10': 8.7195}:  90%|█████████ | 9/10 [01:03<00:06,  6.66s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9504, 'compress@10': 0.1383, 'time@10': 8.7195}: 100%|██████████| 10/10 [01:03<00:00,  7.42s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9504, 'compress@10': 0.1383, 'time@10': 8.7195}: 100%|██████████| 10/10 [01:03<00:00,  6.30s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.010974476964296808
Avg hit ratio: 0.9020759939928021
Avg ndcg: 0.950416777963192
Avg compression ratio: 0.1383099039842772
Avg train time: 8.719477486610412
Std train time: 2.5584062024417866
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9359, 'compress@10': 0.1474, 'time@10': 7.3512}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9359, 'compress@10': 0.1474, 'time@10': 7.3512}:  10%|█         | 1/10 [00:03<00:33,  3.71s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0246, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.0246, 'compress@10': 0.1382, 'time@10': 6.7378}:  10%|█         | 1/10 [00:09<00:33,  3.71s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0246, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.0246, 'compress@10': 0.1382, 'time@10': 6.7378}:  20%|██        | 2/10 [00:09<00:41,  5.15s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9688, 'compress@10': 0.1683, 'time@10': 6.2635}:  20%|██        | 2/10 [00:12<00:41,  5.15s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9688, 'compress@10': 0.1683, 'time@10': 6.2635}:  30%|███       | 3/10 [00:12<00:28,  4.03s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9667, 'compress@10': 0.1593, 'time@10': 6.0975}:  30%|███       | 3/10 [00:18<00:28,  4.03s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9667, 'compress@10': 0.1593, 'time@10': 6.0975}:  40%|████      | 4/10 [00:18<00:27,  4.66s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9643, 'compress@10': 0.151, 'time@10': 7.3527}:  40%|████      | 4/10 [00:24<00:27,  4.66s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9643, 'compress@10': 0.151, 'time@10': 7.3527}:  50%|█████     | 5/10 [00:24<00:26,  5.23s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.97, 'compress@10': 0.1459, 'time@10': 7.7306}:  50%|█████     | 5/10 [00:34<00:26,  5.23s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.97, 'compress@10': 0.1459, 'time@10': 7.7306}:  60%|██████    | 6/10 [00:34<00:26,  6.73s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0148, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9677, 'compress@10': 0.1445, 'time@10': 8.0564}:  60%|██████    | 6/10 [00:39<00:26,  6.73s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0148, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9677, 'compress@10': 0.1445, 'time@10': 8.0564}:  70%|███████   | 7/10 [00:39<00:18,  6.18s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9672, 'compress@10': 0.1421, 'time@10': 7.9834}:  70%|███████   | 7/10 [00:46<00:18,  6.18s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9672, 'compress@10': 0.1421, 'time@10': 7.9834}:  80%|████████  | 8/10 [00:46<00:13,  6.60s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9666, 'compress@10': 0.1403, 'time@10': 8.6322}:  80%|████████  | 8/10 [00:53<00:13,  6.60s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9666, 'compress@10': 0.1403, 'time@10': 8.6322}:  90%|█████████ | 9/10 [00:53<00:06,  6.71s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9664, 'compress@10': 0.1383, 'time@10': 8.6691}:  90%|█████████ | 9/10 [01:02<00:06,  6.71s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9664, 'compress@10': 0.1383, 'time@10': 8.6691}: 100%|██████████| 10/10 [01:02<00:00,  7.43s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9664, 'compress@10': 0.1383, 'time@10': 8.6691}: 100%|██████████| 10/10 [01:02<00:00,  6.26s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.01463314676369606
Avg hit ratio: 0.8934021588673542
Avg ndcg: 0.9664254245801664
Avg compression ratio: 0.1383099039842772
Avg train time: 8.669092321395874
Std train time: 2.7095033544369653
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0033, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9359, 'compress@10': 0.1474, 'time@10': 7.3989}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0033, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9359, 'compress@10': 0.1474, 'time@10': 7.3989}:  10%|█         | 1/10 [00:03<00:33,  3.74s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9921, 'compress@10': 0.1382, 'time@10': 6.8059}:  10%|█         | 1/10 [00:09<00:33,  3.74s/it] {'epoch': 47, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9921, 'compress@10': 0.1382, 'time@10': 6.8059}:  20%|██        | 2/10 [00:09<00:41,  5.21s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9471, 'compress@10': 0.1683, 'time@10': 6.3179}:  20%|██        | 2/10 [00:12<00:41,  5.21s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9471, 'compress@10': 0.1683, 'time@10': 6.3179}:  30%|███       | 3/10 [00:12<00:28,  4.07s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9517, 'compress@10': 0.1593, 'time@10': 6.1397}:  30%|███       | 3/10 [00:18<00:28,  4.07s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9517, 'compress@10': 0.1593, 'time@10': 6.1397}:  40%|████      | 4/10 [00:18<00:28,  4.69s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9526, 'compress@10': 0.151, 'time@10': 7.4465}:  40%|████      | 4/10 [00:24<00:28,  4.69s/it]   {'epoch': 47, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9526, 'compress@10': 0.151, 'time@10': 7.4465}:  50%|█████     | 5/10 [00:24<00:26,  5.30s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9566, 'compress@10': 0.1459, 'time@10': 7.8767}:  50%|█████     | 5/10 [00:34<00:26,  5.30s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9566, 'compress@10': 0.1459, 'time@10': 7.8767}:  60%|██████    | 6/10 [00:34<00:27,  6.92s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.956, 'compress@10': 0.1445, 'time@10': 8.2957}:  60%|██████    | 6/10 [00:40<00:27,  6.92s/it] {'epoch': 47, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.956, 'compress@10': 0.1445, 'time@10': 8.2957}:  70%|███████   | 7/10 [00:40<00:19,  6.44s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9559, 'compress@10': 0.1421, 'time@10': 8.1862}:  70%|███████   | 7/10 [00:47<00:19,  6.44s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9559, 'compress@10': 0.1421, 'time@10': 8.1862}:  80%|████████  | 8/10 [00:47<00:13,  6.76s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9561, 'compress@10': 0.1403, 'time@10': 8.7181}:  80%|████████  | 8/10 [00:54<00:13,  6.76s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9561, 'compress@10': 0.1403, 'time@10': 8.7181}:  90%|█████████ | 9/10 [00:54<00:06,  6.69s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9582, 'compress@10': 0.1383, 'time@10': 8.7528}:  90%|█████████ | 9/10 [01:03<00:06,  6.69s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9582, 'compress@10': 0.1383, 'time@10': 8.7528}: 100%|██████████| 10/10 [01:03<00:00,  7.43s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0103, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9582, 'compress@10': 0.1383, 'time@10': 8.7528}: 100%|██████████| 10/10 [01:03<00:00,  6.33s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.010289683039322928
Avg hit ratio: 0.893033495272884
Avg ndcg: 0.9582002699740839
Avg compression ratio: 0.13830989959859455
Avg train time: 8.752770066261292
Std train time: 2.6597465303998336
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9359, 'compress@10': 0.1474, 'time@10': 7.645}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9359, 'compress@10': 0.1474, 'time@10': 7.645}:  10%|█         | 1/10 [00:03<00:34,  3.86s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9518, 'compress@10': 0.1382, 'time@10': 6.9831}:  10%|█         | 1/10 [00:10<00:34,  3.86s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9518, 'compress@10': 0.1382, 'time@10': 6.9831}:  20%|██        | 2/10 [00:10<00:42,  5.33s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0044, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.9203, 'compress@10': 0.1683, 'time@10': 6.4733}:  20%|██        | 2/10 [00:12<00:42,  5.33s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0044, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.9203, 'compress@10': 0.1683, 'time@10': 6.4733}:  30%|███       | 3/10 [00:12<00:29,  4.16s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.93, 'compress@10': 0.1593, 'time@10': 6.2367}:  30%|███       | 3/10 [00:18<00:29,  4.16s/it]  {'epoch': 48, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.93, 'compress@10': 0.1593, 'time@10': 6.2367}:  40%|████      | 4/10 [00:18<00:28,  4.72s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9352, 'compress@10': 0.151, 'time@10': 7.4227}:  40%|████      | 4/10 [00:24<00:28,  4.72s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9352, 'compress@10': 0.151, 'time@10': 7.4227}:  50%|█████     | 5/10 [00:24<00:26,  5.22s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9414, 'compress@10': 0.1459, 'time@10': 7.7446}:  50%|█████     | 5/10 [00:34<00:26,  5.22s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9414, 'compress@10': 0.1459, 'time@10': 7.7446}:  60%|██████    | 6/10 [00:34<00:26,  6.64s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.944, 'compress@10': 0.1445, 'time@10': 8.0472}:  60%|██████    | 6/10 [00:39<00:26,  6.64s/it] {'epoch': 48, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.944, 'compress@10': 0.1445, 'time@10': 8.0472}:  70%|███████   | 7/10 [00:39<00:18,  6.09s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9646, 'compress@10': 0.1421, 'time@10': 7.9266}:  70%|███████   | 7/10 [00:46<00:18,  6.09s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0091, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9646, 'compress@10': 0.1421, 'time@10': 7.9266}:  80%|████████  | 8/10 [00:46<00:12,  6.42s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.965, 'compress@10': 0.1403, 'time@10': 8.5158}:  80%|████████  | 8/10 [00:52<00:12,  6.42s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.965, 'compress@10': 0.1403, 'time@10': 8.5158}:  90%|█████████ | 9/10 [00:52<00:06,  6.50s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9615, 'compress@10': 0.1383, 'time@10': 8.5468}:  90%|█████████ | 9/10 [01:01<00:06,  6.50s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9615, 'compress@10': 0.1383, 'time@10': 8.5468}: 100%|██████████| 10/10 [01:01<00:00,  7.23s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9615, 'compress@10': 0.1383, 'time@10': 8.5468}: 100%|██████████| 10/10 [01:01<00:00,  6.17s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.010923020384078417
Avg hit ratio: 0.905301800444415
Avg ndcg: 0.9614848035017541
Avg compression ratio: 0.1383099039842772
Avg train time: 8.546787095069885
Std train time: 2.5316266463496886
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9408, 'compress@10': 0.1474, 'time@10': 7.4023}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9408, 'compress@10': 0.1474, 'time@10': 7.4023}:  10%|█         | 1/10 [00:03<00:33,  3.74s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9519, 'compress@10': 0.1382, 'time@10': 6.8921}:  10%|█         | 1/10 [00:10<00:33,  3.74s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9519, 'compress@10': 0.1382, 'time@10': 6.8921}:  20%|██        | 2/10 [00:10<00:42,  5.31s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9203, 'compress@10': 0.1683, 'time@10': 6.4556}:  20%|██        | 2/10 [00:12<00:42,  5.31s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9203, 'compress@10': 0.1683, 'time@10': 6.4556}:  30%|███       | 3/10 [00:12<00:29,  4.18s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9308, 'compress@10': 0.1593, 'time@10': 6.1992}:  30%|███       | 3/10 [00:18<00:29,  4.18s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9308, 'compress@10': 0.1593, 'time@10': 6.1992}:  40%|████      | 4/10 [00:18<00:28,  4.69s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9356, 'compress@10': 0.151, 'time@10': 7.3652}:  40%|████      | 4/10 [00:24<00:28,  4.69s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.9356, 'compress@10': 0.151, 'time@10': 7.3652}:  50%|█████     | 5/10 [00:24<00:25,  5.18s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9465, 'compress@10': 0.1459, 'time@10': 7.7203}:  50%|█████     | 5/10 [00:34<00:25,  5.18s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9465, 'compress@10': 0.1459, 'time@10': 7.7203}:  60%|██████    | 6/10 [00:34<00:26,  6.66s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9482, 'compress@10': 0.1445, 'time@10': 8.029}:  60%|██████    | 6/10 [00:39<00:26,  6.66s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9482, 'compress@10': 0.1445, 'time@10': 8.029}:  70%|███████   | 7/10 [00:39<00:18,  6.11s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9563, 'compress@10': 0.1421, 'time@10': 7.9083}:  70%|███████   | 7/10 [00:46<00:18,  6.11s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9563, 'compress@10': 0.1421, 'time@10': 7.9083}:  80%|████████  | 8/10 [00:46<00:12,  6.42s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9572, 'compress@10': 0.1403, 'time@10': 8.5112}:  80%|████████  | 8/10 [00:52<00:12,  6.42s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9572, 'compress@10': 0.1403, 'time@10': 8.5112}:  90%|█████████ | 9/10 [00:52<00:06,  6.51s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9592, 'compress@10': 0.1383, 'time@10': 8.5638}:  90%|█████████ | 9/10 [01:01<00:06,  6.51s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9592, 'compress@10': 0.1383, 'time@10': 8.5638}: 100%|██████████| 10/10 [01:01<00:00,  7.30s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9592, 'compress@10': 0.1383, 'time@10': 8.5638}: 100%|██████████| 10/10 [01:01<00:00,  6.19s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.011330750706306156
Avg hit ratio: 0.8944057430967447
Avg ndcg: 0.9592462265049286
Avg compression ratio: 0.13830989343062328
Avg train time: 8.563804197311402
Std train time: 2.5429893377612647
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
