  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1854, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5269, 'compress@10': 1.0, 'time@10': 4.0912}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1854, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5269, 'compress@10': 1.0, 'time@10': 4.0912}:   3%|▎         | 1/30 [00:02<01:00,  2.09s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1354, 'hit_ratio@10': 0.5756, 'ndcg@10': 0.6132, 'compress@10': 1.0, 'time@10': 3.2384}:   3%|▎         | 1/30 [00:04<01:00,  2.09s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1354, 'hit_ratio@10': 0.5756, 'ndcg@10': 0.6132, 'compress@10': 1.0, 'time@10': 3.2384}:   7%|▋         | 2/30 [00:04<01:03,  2.28s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7953, 'hit_ratio@10': 0.5266, 'ndcg@10': 0.4088, 'compress@10': 1.0, 'time@10': 2.4727}:   7%|▋         | 2/30 [00:05<01:03,  2.28s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7953, 'hit_ratio@10': 0.5266, 'ndcg@10': 0.4088, 'compress@10': 1.0, 'time@10': 2.4727}:  10%|█         | 3/30 [00:05<00:39,  1.48s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6262, 'hit_ratio@10': 0.5824, 'ndcg@10': 0.4517, 'compress@10': 1.0, 'time@10': 2.3903}:  10%|█         | 3/30 [00:07<00:39,  1.48s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6262, 'hit_ratio@10': 0.5824, 'ndcg@10': 0.4517, 'compress@10': 1.0, 'time@10': 2.3903}:  13%|█▎        | 4/30 [00:07<00:45,  1.76s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5198, 'hit_ratio@10': 0.6299, 'ndcg@10': 0.5118, 'compress@10': 1.0, 'time@10': 3.483}:  13%|█▎        | 4/30 [00:11<00:45,  1.76s/it] {'epoch': 0, 'num_users': 5.8, 'loss': 0.5198, 'hit_ratio@10': 0.6299, 'ndcg@10': 0.5118, 'compress@10': 1.0, 'time@10': 3.483}:  17%|█▋        | 5/30 [00:11<01:03,  2.55s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4476, 'hit_ratio@10': 0.6398, 'ndcg@10': 0.5567, 'compress@10': 1.0, 'time@10': 3.4849}:  17%|█▋        | 5/30 [00:14<01:03,  2.55s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4476, 'hit_ratio@10': 0.6398, 'ndcg@10': 0.5567, 'compress@10': 1.0, 'time@10': 3.4849}:  20%|██        | 6/30 [00:14<01:09,  2.89s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4011, 'hit_ratio@10': 0.6455, 'ndcg@10': 0.558, 'compress@10': 1.0, 'time@10': 3.5402}:  20%|██        | 6/30 [00:16<01:09,  2.89s/it] {'epoch': 0, 'num_users': 6.2857, 'loss': 0.4011, 'hit_ratio@10': 0.6455, 'ndcg@10': 0.558, 'compress@10': 1.0, 'time@10': 3.5402}:  23%|██▎       | 7/30 [00:16<00:59,  2.59s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3575, 'hit_ratio@10': 0.6791, 'ndcg@10': 0.5855, 'compress@10': 1.0, 'time@10': 3.4308}:  23%|██▎       | 7/30 [00:19<00:59,  2.59s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3575, 'hit_ratio@10': 0.6791, 'ndcg@10': 0.5855, 'compress@10': 1.0, 'time@10': 3.4308}:  27%|██▋       | 8/30 [00:19<00:57,  2.62s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3235, 'hit_ratio@10': 0.6925, 'ndcg@10': 0.6215, 'compress@10': 1.0, 'time@10': 3.6587}:  27%|██▋       | 8/30 [00:22<00:57,  2.62s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3235, 'hit_ratio@10': 0.6925, 'ndcg@10': 0.6215, 'compress@10': 1.0, 'time@10': 3.6587}:  30%|███       | 9/30 [00:22<00:56,  2.68s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2965, 'hit_ratio@10': 0.7165, 'ndcg@10': 0.6431, 'compress@10': 1.0, 'time@10': 3.6385}:  30%|███       | 9/30 [00:25<00:56,  2.68s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2965, 'hit_ratio@10': 0.7165, 'ndcg@10': 0.6431, 'compress@10': 1.0, 'time@10': 3.6385}:  33%|███▎      | 10/30 [00:25<00:58,  2.93s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.2825, 'hit_ratio@10': 0.7108, 'ndcg@10': 0.6375, 'compress@10': 1.0, 'time@10': 3.6764}:  33%|███▎      | 10/30 [00:27<00:58,  2.93s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.2825, 'hit_ratio@10': 0.7108, 'ndcg@10': 0.6375, 'compress@10': 1.0, 'time@10': 3.6764}:  37%|███▋      | 11/30 [00:27<00:50,  2.67s/it]{'epoch': 0, 'num_users': 6.4167, 'loss': 0.4117, 'hit_ratio@10': 0.6932, 'ndcg@10': 0.5881, 'compress@10': 1.0, 'time@10': 3.4424}:  37%|███▋      | 11/30 [00:28<00:50,  2.67s/it]{'epoch': 0, 'num_users': 6.4167, 'loss': 0.4117, 'hit_ratio@10': 0.6932, 'ndcg@10': 0.5881, 'compress@10': 1.0, 'time@10': 3.4424}:  40%|████      | 12/30 [00:28<00:38,  2.13s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.3926, 'hit_ratio@10': 0.6993, 'ndcg@10': 0.5829, 'compress@10': 1.0, 'time@10': 3.4418}:  40%|████      | 12/30 [00:30<00:38,  2.13s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.3926, 'hit_ratio@10': 0.6993, 'ndcg@10': 0.5829, 'compress@10': 1.0, 'time@10': 3.4418}:  43%|████▎     | 13/30 [00:30<00:34,  2.02s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.5554, 'hit_ratio@10': 0.6613, 'ndcg@10': 0.5412, 'compress@10': 1.0, 'time@10': 3.2259}:  43%|████▎     | 13/30 [00:30<00:34,  2.02s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.5554, 'hit_ratio@10': 0.6613, 'ndcg@10': 0.5412, 'compress@10': 1.0, 'time@10': 3.2259}:  47%|████▋     | 14/30 [00:30<00:24,  1.55s/it]{'epoch': 0, 'num_users': 6.2667, 'loss': 0.5243, 'hit_ratio@10': 0.6753, 'ndcg@10': 0.5502, 'compress@10': 1.0, 'time@10': 3.3275}:  47%|████▋     | 14/30 [00:33<00:24,  1.55s/it]{'epoch': 0, 'num_users': 6.2667, 'loss': 0.5243, 'hit_ratio@10': 0.6753, 'ndcg@10': 0.5502, 'compress@10': 1.0, 'time@10': 3.3275}:  50%|█████     | 15/30 [00:33<00:27,  1.81s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.6059, 'hit_ratio@10': 0.6539, 'ndcg@10': 0.5183, 'compress@10': 1.0, 'time@10': 3.1714}:  50%|█████     | 15/30 [00:34<00:27,  1.81s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.6059, 'hit_ratio@10': 0.6539, 'ndcg@10': 0.5183, 'compress@10': 1.0, 'time@10': 3.1714}:  53%|█████▎    | 16/30 [00:34<00:21,  1.53s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 0.7028, 'hit_ratio@10': 0.639, 'ndcg@10': 0.4878, 'compress@10': 1.0, 'time@10': 3.0208}:  53%|█████▎    | 16/30 [00:34<00:21,  1.53s/it] {'epoch': 0, 'num_users': 5.8235, 'loss': 0.7028, 'hit_ratio@10': 0.639, 'ndcg@10': 0.4878, 'compress@10': 1.0, 'time@10': 3.0208}:  57%|█████▋    | 17/30 [00:34<00:15,  1.17s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.67, 'hit_ratio@10': 0.6451, 'ndcg@10': 0.499, 'compress@10': 1.0, 'time@10': 2.9775}:  57%|█████▋    | 17/30 [00:36<00:15,  1.17s/it]  {'epoch': 0, 'num_users': 6.0556, 'loss': 0.67, 'hit_ratio@10': 0.6451, 'ndcg@10': 0.499, 'compress@10': 1.0, 'time@10': 2.9775}:  60%|██████    | 18/30 [00:36<00:18,  1.50s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.6706, 'hit_ratio@10': 0.6337, 'ndcg@10': 0.4803, 'compress@10': 1.0, 'time@10': 2.9293}:  60%|██████    | 18/30 [00:37<00:18,  1.50s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.6706, 'hit_ratio@10': 0.6337, 'ndcg@10': 0.4803, 'compress@10': 1.0, 'time@10': 2.9293}:  63%|██████▎   | 19/30 [00:37<00:15,  1.37s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.6406, 'hit_ratio@10': 0.6441, 'ndcg@10': 0.4964, 'compress@10': 1.0, 'time@10': 3.0075}:  63%|██████▎   | 19/30 [00:42<00:15,  1.37s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.6406, 'hit_ratio@10': 0.6441, 'ndcg@10': 0.4964, 'compress@10': 1.0, 'time@10': 3.0075}:  67%|██████▋   | 20/30 [00:42<00:23,  2.32s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.6143, 'hit_ratio@10': 0.6492, 'ndcg@10': 0.5101, 'compress@10': 1.0, 'time@10': 3.1738}:  67%|██████▋   | 20/30 [00:45<00:23,  2.32s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.6143, 'hit_ratio@10': 0.6492, 'ndcg@10': 0.5101, 'compress@10': 1.0, 'time@10': 3.1738}:  70%|███████   | 21/30 [00:45<00:23,  2.61s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 0.5982, 'hit_ratio@10': 0.6548, 'ndcg@10': 0.5053, 'compress@10': 1.0, 'time@10': 3.0997}:  70%|███████   | 21/30 [00:47<00:23,  2.61s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 0.5982, 'hit_ratio@10': 0.6548, 'ndcg@10': 0.5053, 'compress@10': 1.0, 'time@10': 3.0997}:  73%|███████▎  | 22/30 [00:47<00:18,  2.30s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 0.5783, 'hit_ratio@10': 0.6589, 'ndcg@10': 0.5051, 'compress@10': 1.0, 'time@10': 3.0951}:  73%|███████▎  | 22/30 [00:48<00:18,  2.30s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 0.5783, 'hit_ratio@10': 0.6589, 'ndcg@10': 0.5051, 'compress@10': 1.0, 'time@10': 3.0951}:  77%|███████▋  | 23/30 [00:48<00:14,  2.07s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.6531, 'hit_ratio@10': 0.6565, 'ndcg@10': 0.484, 'compress@10': 1.0, 'time@10': 2.9791}:  77%|███████▋  | 23/30 [00:49<00:14,  2.07s/it] {'epoch': 0, 'num_users': 5.9583, 'loss': 0.6531, 'hit_ratio@10': 0.6565, 'ndcg@10': 0.484, 'compress@10': 1.0, 'time@10': 2.9791}:  80%|████████  | 24/30 [00:49<00:09,  1.56s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.7061, 'hit_ratio@10': 0.6302, 'ndcg@10': 0.4647, 'compress@10': 1.0, 'time@10': 2.8736}:  80%|████████  | 24/30 [00:49<00:09,  1.56s/it]  {'epoch': 0, 'num_users': 5.8, 'loss': 0.7061, 'hit_ratio@10': 0.6302, 'ndcg@10': 0.4647, 'compress@10': 1.0, 'time@10': 2.8736}:  83%|████████▎ | 25/30 [00:49<00:05,  1.15s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.6825, 'hit_ratio@10': 0.6383, 'ndcg@10': 0.4762, 'compress@10': 1.0, 'time@10': 3.0048}:  83%|████████▎ | 25/30 [00:55<00:05,  1.15s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.6825, 'hit_ratio@10': 0.6383, 'ndcg@10': 0.4762, 'compress@10': 1.0, 'time@10': 3.0048}:  87%|████████▋ | 26/30 [00:55<00:10,  2.70s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.6602, 'hit_ratio@10': 0.6465, 'ndcg@10': 0.4821, 'compress@10': 1.0, 'time@10': 3.0568}:  87%|████████▋ | 26/30 [00:57<00:10,  2.70s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.6602, 'hit_ratio@10': 0.6465, 'ndcg@10': 0.4821, 'compress@10': 1.0, 'time@10': 3.0568}:  90%|█████████ | 27/30 [00:57<00:07,  2.56s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.6388, 'hit_ratio@10': 0.6528, 'ndcg@10': 0.4963, 'compress@10': 1.0, 'time@10': 3.0898}:  90%|█████████ | 27/30 [01:01<00:07,  2.56s/it]   {'epoch': 0, 'num_users': 6.0, 'loss': 0.6388, 'hit_ratio@10': 0.6528, 'ndcg@10': 0.4963, 'compress@10': 1.0, 'time@10': 3.0898}:  93%|█████████▎| 28/30 [01:01<00:05,  3.00s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.6216, 'hit_ratio@10': 0.6616, 'ndcg@10': 0.4979, 'compress@10': 1.0, 'time@10': 3.0929}:  93%|█████████▎| 28/30 [01:03<00:05,  3.00s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.6216, 'hit_ratio@10': 0.6616, 'ndcg@10': 0.4979, 'compress@10': 1.0, 'time@10': 3.0929}:  97%|█████████▋| 29/30 [01:03<00:02,  2.59s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.6027, 'hit_ratio@10': 0.6666, 'ndcg@10': 0.5114, 'compress@10': 1.0, 'time@10': 3.0814}:  97%|█████████▋| 29/30 [01:06<00:02,  2.59s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.6027, 'hit_ratio@10': 0.6666, 'ndcg@10': 0.5114, 'compress@10': 1.0, 'time@10': 3.0814}: 100%|██████████| 30/30 [01:06<00:00,  2.65s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.6027, 'hit_ratio@10': 0.6666, 'ndcg@10': 0.5114, 'compress@10': 1.0, 'time@10': 3.0814}: 100%|██████████| 30/30 [01:06<00:00,  2.21s/it]
Epoch: 0
Avg # of users: 5.866666666666666
Avg Loss: 0.6027421621863888
Avg hit ratio: 0.6665883438446059
Avg ndcg: 0.5113616670955287
Avg compression ratio: 0.9999999860153537
Avg train time: 3.0814447959264117
Std train time: 1.9110241059649236
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[13, 8, 3, 7, 25, 11, 13, 9, 18, 11, 13, 3, 11, 1, 15, 3, 2, 7, 7, 15, 21, 5, 10, 1, 1, 20, 14, 13, 10, 9]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 3.715}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 3.715}:   3%|▎         | 1/30 [00:01<00:55,  1.90s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0544, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 2.7995}:   3%|▎         | 1/30 [00:03<00:55,  1.90s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0544, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 2.7995}:   7%|▋         | 2/30 [00:03<00:53,  1.91s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.2214, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.6219, 'compress@10': 1.0, 'time@10': 1.9687}:   7%|▋         | 2/30 [00:04<00:53,  1.91s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.2214, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.6219, 'compress@10': 1.0, 'time@10': 1.9687}:  10%|█         | 3/30 [00:04<00:30,  1.13s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.1831, 'hit_ratio@10': 0.7391, 'ndcg@10': 0.6667, 'compress@10': 1.0, 'time@10': 1.852}:  10%|█         | 3/30 [00:05<00:30,  1.13s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.1831, 'hit_ratio@10': 0.7391, 'ndcg@10': 0.6667, 'compress@10': 1.0, 'time@10': 1.852}:  13%|█▎        | 4/30 [00:05<00:33,  1.29s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.1583, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.6976, 'compress@10': 1.0, 'time@10': 5.4371}:  13%|█▎        | 4/30 [00:15<00:33,  1.29s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.1583, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.6976, 'compress@10': 1.0, 'time@10': 5.4371}:  17%|█▋        | 5/30 [00:15<01:50,  4.40s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.1448, 'hit_ratio@10': 0.755, 'ndcg@10': 0.7164, 'compress@10': 1.0, 'time@10': 5.1765}:  17%|█▋        | 5/30 [00:19<01:50,  4.40s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.1448, 'hit_ratio@10': 0.755, 'ndcg@10': 0.7164, 'compress@10': 1.0, 'time@10': 5.1765}:  20%|██        | 6/30 [00:19<01:41,  4.24s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.1301, 'hit_ratio@10': 0.7843, 'ndcg@10': 0.7388, 'compress@10': 1.0, 'time@10': 5.1487}:  20%|██        | 6/30 [00:21<01:41,  4.24s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.1301, 'hit_ratio@10': 0.7843, 'ndcg@10': 0.7388, 'compress@10': 1.0, 'time@10': 5.1487}:  23%|██▎       | 7/30 [00:21<01:24,  3.68s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.1187, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.7546, 'compress@10': 1.0, 'time@10': 4.792}:  23%|██▎       | 7/30 [00:24<01:24,  3.68s/it]  {'epoch': 1, 'num_users': 6.125, 'loss': 0.1187, 'hit_ratio@10': 0.8005, 'ndcg@10': 0.7546, 'compress@10': 1.0, 'time@10': 4.792}:  27%|██▋       | 8/30 [00:24<01:11,  3.25s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.109, 'hit_ratio@10': 0.7878, 'ndcg@10': 0.7725, 'compress@10': 1.0, 'time@10': 5.3435}:  27%|██▋       | 8/30 [00:29<01:11,  3.25s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.109, 'hit_ratio@10': 0.7878, 'ndcg@10': 0.7725, 'compress@10': 1.0, 'time@10': 5.3435}:  30%|███       | 9/30 [00:29<01:19,  3.77s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.1027, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.78, 'compress@10': 1.0, 'time@10': 5.177}:  30%|███       | 9/30 [00:32<01:19,  3.77s/it]     {'epoch': 1, 'num_users': 6.3, 'loss': 0.1027, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.78, 'compress@10': 1.0, 'time@10': 5.177}:  33%|███▎      | 10/30 [00:32<01:15,  3.77s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0992, 'hit_ratio@10': 0.8027, 'ndcg@10': 0.7873, 'compress@10': 1.0, 'time@10': 5.2346}:  33%|███▎      | 10/30 [00:35<01:15,  3.77s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0992, 'hit_ratio@10': 0.8027, 'ndcg@10': 0.7873, 'compress@10': 1.0, 'time@10': 5.2346}:  37%|███▋      | 11/30 [00:35<01:06,  3.52s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.1093, 'hit_ratio@10': 0.7844, 'ndcg@10': 0.7565, 'compress@10': 1.0, 'time@10': 4.8193}:  37%|███▋      | 11/30 [00:36<01:06,  3.52s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.1093, 'hit_ratio@10': 0.7844, 'ndcg@10': 0.7565, 'compress@10': 1.0, 'time@10': 4.8193}:  40%|████      | 12/30 [00:36<00:45,  2.54s/it]{'epoch': 1, 'num_users': 6.6154, 'loss': 0.1052, 'hit_ratio@10': 0.787, 'ndcg@10': 0.765, 'compress@10': 1.0, 'time@10': 4.7402}:  40%|████      | 12/30 [00:38<00:45,  2.54s/it]  {'epoch': 1, 'num_users': 6.6154, 'loss': 0.1052, 'hit_ratio@10': 0.787, 'ndcg@10': 0.765, 'compress@10': 1.0, 'time@10': 4.7402}:  43%|████▎     | 13/30 [00:38<00:40,  2.35s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.209, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.7128, 'compress@10': 1.0, 'time@10': 4.4044}:  43%|████▎     | 13/30 [00:38<00:40,  2.35s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.1986, 'hit_ratio@10': 0.7711, 'ndcg@10': 0.7237, 'compress@10': 1.0, 'time@10': 4.5778}:  43%|████▎     | 13/30 [00:41<00:40,  2.35s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.1986, 'hit_ratio@10': 0.7711, 'ndcg@10': 0.7237, 'compress@10': 1.0, 'time@10': 4.5778}:  50%|█████     | 15/30 [00:41<00:31,  2.11s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.1969, 'hit_ratio@10': 0.7385, 'ndcg@10': 0.7073, 'compress@10': 1.0, 'time@10': 4.3069}:  50%|█████     | 15/30 [00:42<00:31,  2.11s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.1969, 'hit_ratio@10': 0.7385, 'ndcg@10': 0.7073, 'compress@10': 1.0, 'time@10': 4.3069}:  53%|█████▎    | 16/30 [00:42<00:23,  1.65s/it]{'epoch': 1, 'num_users': 5.8235, 'loss': 0.2547, 'hit_ratio@10': 0.6951, 'ndcg@10': 0.6679, 'compress@10': 1.0, 'time@10': 4.0605}:  53%|█████▎    | 16/30 [00:42<00:23,  1.65s/it]{'epoch': 1, 'num_users': 6.0556, 'loss': 0.2452, 'hit_ratio@10': 0.6961, 'ndcg@10': 0.6749, 'compress@10': 1.0, 'time@10': 3.918}:  53%|█████▎    | 16/30 [00:43<00:23,  1.65s/it] {'epoch': 1, 'num_users': 6.0556, 'loss': 0.2452, 'hit_ratio@10': 0.6961, 'ndcg@10': 0.6749, 'compress@10': 1.0, 'time@10': 3.918}:  60%|██████    | 18/30 [00:43<00:15,  1.30s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.2362, 'hit_ratio@10': 0.7046, 'ndcg@10': 0.6708, 'compress@10': 1.0, 'time@10': 3.7866}:  60%|██████    | 18/30 [00:44<00:15,  1.30s/it]  {'epoch': 1, 'num_users': 6.0, 'loss': 0.2362, 'hit_ratio@10': 0.7046, 'ndcg@10': 0.6708, 'compress@10': 1.0, 'time@10': 3.7866}:  63%|██████▎   | 19/30 [00:44<00:12,  1.18s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.2273, 'hit_ratio@10': 0.7141, 'ndcg@10': 0.6777, 'compress@10': 1.0, 'time@10': 3.9355}:  63%|██████▎   | 19/30 [00:51<00:12,  1.18s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.2273, 'hit_ratio@10': 0.7141, 'ndcg@10': 0.6777, 'compress@10': 1.0, 'time@10': 3.9355}:  67%|██████▋   | 20/30 [00:51<00:25,  2.56s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.2196, 'hit_ratio@10': 0.7194, 'ndcg@10': 0.6841, 'compress@10': 1.0, 'time@10': 4.3789}:  67%|██████▋   | 20/30 [00:57<00:25,  2.56s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.2196, 'hit_ratio@10': 0.7194, 'ndcg@10': 0.6841, 'compress@10': 1.0, 'time@10': 4.3789}:  70%|███████   | 21/30 [00:57<00:32,  3.63s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.2174, 'hit_ratio@10': 0.7094, 'ndcg@10': 0.6773, 'compress@10': 1.0, 'time@10': 4.2164}:  70%|███████   | 21/30 [00:58<00:32,  3.63s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.2174, 'hit_ratio@10': 0.7094, 'ndcg@10': 0.6773, 'compress@10': 1.0, 'time@10': 4.2164}:  73%|███████▎  | 22/30 [00:58<00:22,  2.87s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.2094, 'hit_ratio@10': 0.7155, 'ndcg@10': 0.6863, 'compress@10': 1.0, 'time@10': 4.162}:  73%|███████▎  | 22/30 [01:00<00:22,  2.87s/it] {'epoch': 1, 'num_users': 6.1304, 'loss': 0.2094, 'hit_ratio@10': 0.7155, 'ndcg@10': 0.6863, 'compress@10': 1.0, 'time@10': 4.162}:  77%|███████▋  | 23/30 [01:00<00:17,  2.50s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.25, 'hit_ratio@10': 0.717, 'ndcg@10': 0.6589, 'compress@10': 1.0, 'time@10': 3.9898}:  77%|███████▋  | 23/30 [01:00<00:17,  2.50s/it]  {'epoch': 1, 'num_users': 5.8, 'loss': 0.2822, 'hit_ratio@10': 0.6883, 'ndcg@10': 0.6332, 'compress@10': 1.0, 'time@10': 3.8316}:  77%|███████▋  | 23/30 [01:00<00:17,  2.50s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.2822, 'hit_ratio@10': 0.6883, 'ndcg@10': 0.6332, 'compress@10': 1.0, 'time@10': 3.8316}:  83%|████████▎ | 25/30 [01:00<00:07,  1.41s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.2733, 'hit_ratio@10': 0.6961, 'ndcg@10': 0.6415, 'compress@10': 1.0, 'time@10': 4.1643}:  83%|████████▎ | 25/30 [01:12<00:07,  1.41s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.2733, 'hit_ratio@10': 0.6961, 'ndcg@10': 0.6415, 'compress@10': 1.0, 'time@10': 4.1643}:  87%|████████▋ | 26/30 [01:12<00:16,  4.09s/it]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.2643, 'hit_ratio@10': 0.706, 'ndcg@10': 0.6508, 'compress@10': 1.0, 'time@10': 4.243}:  87%|████████▋ | 26/30 [01:16<00:16,  4.09s/it]  {'epoch': 1, 'num_users': 5.8889, 'loss': 0.2643, 'hit_ratio@10': 0.706, 'ndcg@10': 0.6508, 'compress@10': 1.0, 'time@10': 4.243}:  90%|█████████ | 27/30 [01:16<00:11,  3.86s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.2567, 'hit_ratio@10': 0.7116, 'ndcg@10': 0.6586, 'compress@10': 1.0, 'time@10': 4.2825}:  90%|█████████ | 27/30 [01:21<00:11,  3.86s/it] {'epoch': 1, 'num_users': 6.0, 'loss': 0.2567, 'hit_ratio@10': 0.7116, 'ndcg@10': 0.6586, 'compress@10': 1.0, 'time@10': 4.2825}:  93%|█████████▎| 28/30 [01:21<00:08,  4.27s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.2486, 'hit_ratio@10': 0.7184, 'ndcg@10': 0.6671, 'compress@10': 1.0, 'time@10': 4.2428}:  93%|█████████▎| 28/30 [01:23<00:08,  4.27s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.2486, 'hit_ratio@10': 0.7184, 'ndcg@10': 0.6671, 'compress@10': 1.0, 'time@10': 4.2428}:  97%|█████████▋| 29/30 [01:23<00:03,  3.53s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.2417, 'hit_ratio@10': 0.7206, 'ndcg@10': 0.6749, 'compress@10': 1.0, 'time@10': 4.1861}:  97%|█████████▋| 29/30 [01:25<00:03,  3.53s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.2417, 'hit_ratio@10': 0.7206, 'ndcg@10': 0.6749, 'compress@10': 1.0, 'time@10': 4.1861}: 100%|██████████| 30/30 [01:25<00:00,  3.26s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.2417, 'hit_ratio@10': 0.7206, 'ndcg@10': 0.6749, 'compress@10': 1.0, 'time@10': 4.1861}: 100%|██████████| 30/30 [01:25<00:00,  2.85s/it]
Epoch: 1
Avg # of users: 5.866666666666666
Avg Loss: 0.24165872639012512
Avg hit ratio: 0.7205894013984656
Avg ndcg: 0.6748992774238941
Avg compression ratio: 0.9999999864458318
Avg train time: 4.186059967676798
Std train time: 4.5146978037147
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[15, 4, 1, 2, 79, 14, 19, 6, 40, 13, 22, 1, 13, 1, 28, 1, 1, 2, 2, 27, 54, 1, 10, 1, 1, 51, 24, 20, 10, 7]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 4.3302}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 4.3302}:   3%|▎         | 1/30 [00:02<01:03,  2.20s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0601, 'hit_ratio@10': 0.7334, 'ndcg@10': 0.8104, 'compress@10': 1.0, 'time@10': 2.6335}:   3%|▎         | 1/30 [00:03<01:03,  2.20s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0601, 'hit_ratio@10': 0.7334, 'ndcg@10': 0.8104, 'compress@10': 1.0, 'time@10': 2.6335}:   7%|▋         | 2/30 [00:03<00:41,  1.48s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.1446, 'hit_ratio@10': 0.6318, 'ndcg@10': 0.6255, 'compress@10': 1.0, 'time@10': 1.7903}:   7%|▋         | 2/30 [00:03<00:41,  1.48s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.15, 'hit_ratio@10': 0.6078, 'ndcg@10': 0.6102, 'compress@10': 1.0, 'time@10': 1.4489}:   7%|▋         | 2/30 [00:03<00:41,  1.48s/it]  {'epoch': 2, 'num_users': 5.0, 'loss': 0.15, 'hit_ratio@10': 0.6078, 'ndcg@10': 0.6102, 'compress@10': 1.0, 'time@10': 1.4489}:  13%|█▎        | 4/30 [00:03<00:18,  1.37it/s]{'epoch': 2, 'num_users': 5.8, 'loss': 0.1216, 'hit_ratio@10': 0.6742, 'ndcg@10': 0.6801, 'compress@10': 1.0, 'time@10': 13.6417}:  13%|█▎        | 4/30 [00:34<00:18,  1.37it/s]{'epoch': 2, 'num_users': 5.8, 'loss': 0.1216, 'hit_ratio@10': 0.6742, 'ndcg@10': 0.6801, 'compress@10': 1.0, 'time@10': 13.6417}:  17%|█▋        | 5/30 [00:34<04:14, 10.17s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.113, 'hit_ratio@10': 0.6915, 'ndcg@10': 0.7033, 'compress@10': 1.0, 'time@10': 12.209}:  17%|█▋        | 5/30 [00:40<04:14, 10.17s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.113, 'hit_ratio@10': 0.6915, 'ndcg@10': 0.7033, 'compress@10': 1.0, 'time@10': 12.209}:  20%|██        | 6/30 [00:40<03:26,  8.61s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.1023, 'hit_ratio@10': 0.7299, 'ndcg@10': 0.7278, 'compress@10': 1.0, 'time@10': 11.4916}:  20%|██        | 6/30 [00:43<03:26,  8.61s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.1023, 'hit_ratio@10': 0.7299, 'ndcg@10': 0.7278, 'compress@10': 1.0, 'time@10': 11.4916}:  23%|██▎       | 7/30 [00:43<02:43,  7.09s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.095, 'hit_ratio@10': 0.7529, 'ndcg@10': 0.7401, 'compress@10': 1.0, 'time@10': 10.2394}:  23%|██▎       | 7/30 [00:45<02:43,  7.09s/it]  {'epoch': 2, 'num_users': 6.125, 'loss': 0.095, 'hit_ratio@10': 0.7529, 'ndcg@10': 0.7401, 'compress@10': 1.0, 'time@10': 10.2394}:  27%|██▋       | 8/30 [00:45<01:58,  5.40s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0869, 'hit_ratio@10': 0.755, 'ndcg@10': 0.7603, 'compress@10': 1.0, 'time@10': 11.7252}:  27%|██▋       | 8/30 [00:57<01:58,  5.40s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0869, 'hit_ratio@10': 0.755, 'ndcg@10': 0.7603, 'compress@10': 1.0, 'time@10': 11.7252}:  30%|███       | 9/30 [00:57<02:34,  7.35s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0825, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.7687, 'compress@10': 1.0, 'time@10': 10.9922}:  30%|███       | 9/30 [01:01<02:34,  7.35s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 0.0825, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.7687, 'compress@10': 1.0, 'time@10': 10.9922}:  33%|███▎      | 10/30 [01:01<02:09,  6.47s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.0801, 'hit_ratio@10': 0.7758, 'ndcg@10': 0.7779, 'compress@10': 1.0, 'time@10': 10.8165}:  33%|███▎      | 10/30 [01:06<02:09,  6.47s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.0801, 'hit_ratio@10': 0.7758, 'ndcg@10': 0.7779, 'compress@10': 1.0, 'time@10': 10.8165}:  37%|███▋      | 11/30 [01:06<01:52,  5.90s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0969, 'hit_ratio@10': 0.7339, 'ndcg@10': 0.74, 'compress@10': 1.0, 'time@10': 9.9225}:  37%|███▋      | 11/30 [01:06<01:52,  5.90s/it]   {'epoch': 2, 'num_users': 6.4167, 'loss': 0.0969, 'hit_ratio@10': 0.7339, 'ndcg@10': 0.74, 'compress@10': 1.0, 'time@10': 9.9225}:  40%|████      | 12/30 [01:06<01:14,  4.16s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0932, 'hit_ratio@10': 0.7439, 'ndcg@10': 0.7502, 'compress@10': 1.0, 'time@10': 9.4954}:  40%|████      | 12/30 [01:08<01:14,  4.16s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0932, 'hit_ratio@10': 0.7439, 'ndcg@10': 0.7502, 'compress@10': 1.0, 'time@10': 9.4954}:  43%|████▎     | 13/30 [01:08<01:00,  3.58s/it]{'epoch': 2, 'num_users': 6.3571, 'loss': 0.1516, 'hit_ratio@10': 0.7193, 'ndcg@10': 0.7031, 'compress@10': 1.0, 'time@10': 8.8198}:  43%|████▎     | 13/30 [01:08<01:00,  3.58s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.1443, 'hit_ratio@10': 0.7359, 'ndcg@10': 0.7153, 'compress@10': 1.0, 'time@10': 9.1006}:  43%|████▎     | 13/30 [01:15<01:00,  3.58s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.1443, 'hit_ratio@10': 0.7359, 'ndcg@10': 0.7153, 'compress@10': 1.0, 'time@10': 9.1006}:  50%|█████     | 15/30 [01:15<00:51,  3.46s/it]{'epoch': 2, 'num_users': 6.0625, 'loss': 0.1473, 'hit_ratio@10': 0.724, 'ndcg@10': 0.6944, 'compress@10': 1.0, 'time@10': 8.5374}:  50%|█████     | 15/30 [01:15<00:51,  3.46s/it] {'epoch': 2, 'num_users': 6.0625, 'loss': 0.1473, 'hit_ratio@10': 0.724, 'ndcg@10': 0.6944, 'compress@10': 1.0, 'time@10': 8.5374}:  53%|█████▎    | 16/30 [01:15<00:36,  2.63s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.1819, 'hit_ratio@10': 0.7108, 'ndcg@10': 0.658, 'compress@10': 1.0, 'time@10': 8.039}:  53%|█████▎    | 16/30 [01:15<00:36,  2.63s/it] {'epoch': 2, 'num_users': 6.0556, 'loss': 0.1806, 'hit_ratio@10': 0.713, 'ndcg@10': 0.6592, 'compress@10': 1.0, 'time@10': 7.6161}:  53%|█████▎    | 16/30 [01:15<00:36,  2.63s/it]{'epoch': 2, 'num_users': 6.0556, 'loss': 0.1806, 'hit_ratio@10': 0.713, 'ndcg@10': 0.6592, 'compress@10': 1.0, 'time@10': 7.6161}:  60%|██████    | 18/30 [01:15<00:19,  1.65s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.1799, 'hit_ratio@10': 0.7131, 'ndcg@10': 0.6517, 'compress@10': 1.0, 'time@10': 7.2363}:  60%|██████    | 18/30 [01:15<00:19,  1.65s/it]  {'epoch': 2, 'num_users': 6.0, 'loss': 0.1799, 'hit_ratio@10': 0.7131, 'ndcg@10': 0.6517, 'compress@10': 1.0, 'time@10': 7.2363}:  63%|██████▎   | 19/30 [01:15<00:14,  1.33s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.1728, 'hit_ratio@10': 0.7248, 'ndcg@10': 0.6627, 'compress@10': 1.0, 'time@10': 7.4813}:  63%|██████▎   | 19/30 [01:28<00:14,  1.33s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.1728, 'hit_ratio@10': 0.7248, 'ndcg@10': 0.6627, 'compress@10': 1.0, 'time@10': 7.4813}:  67%|██████▋   | 20/30 [01:28<00:40,  4.00s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.1657, 'hit_ratio@10': 0.7295, 'ndcg@10': 0.6741, 'compress@10': 1.0, 'time@10': 8.7719}:  67%|██████▋   | 20/30 [01:45<00:40,  4.00s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.1657, 'hit_ratio@10': 0.7295, 'ndcg@10': 0.6741, 'compress@10': 1.0, 'time@10': 8.7719}:  70%|███████   | 21/30 [01:45<01:07,  7.47s/it]{'epoch': 2, 'num_users': 6.1818, 'loss': 0.1767, 'hit_ratio@10': 0.705, 'ndcg@10': 0.6577, 'compress@10': 1.0, 'time@10': 8.3808}:  70%|███████   | 21/30 [01:45<01:07,  7.47s/it] {'epoch': 2, 'num_users': 6.1818, 'loss': 0.1767, 'hit_ratio@10': 0.705, 'ndcg@10': 0.6577, 'compress@10': 1.0, 'time@10': 8.3808}:  73%|███████▎  | 22/30 [01:45<00:44,  5.50s/it]{'epoch': 2, 'num_users': 6.1304, 'loss': 0.1701, 'hit_ratio@10': 0.7113, 'ndcg@10': 0.6682, 'compress@10': 1.0, 'time@10': 8.1427}:  73%|███████▎  | 22/30 [01:47<00:44,  5.50s/it]{'epoch': 2, 'num_users': 6.1304, 'loss': 0.1701, 'hit_ratio@10': 0.7113, 'ndcg@10': 0.6682, 'compress@10': 1.0, 'time@10': 8.1427}:  77%|███████▋  | 23/30 [01:47<00:30,  4.38s/it]{'epoch': 2, 'num_users': 5.9583, 'loss': 0.1904, 'hit_ratio@10': 0.713, 'ndcg@10': 0.644, 'compress@10': 1.0, 'time@10': 7.8047}:  77%|███████▋  | 23/30 [01:47<00:30,  4.38s/it]  {'epoch': 2, 'num_users': 5.8, 'loss': 0.2105, 'hit_ratio@10': 0.6844, 'ndcg@10': 0.6196, 'compress@10': 1.0, 'time@10': 7.4937}:  77%|███████▋  | 23/30 [01:47<00:30,  4.38s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.2105, 'hit_ratio@10': 0.6844, 'ndcg@10': 0.6196, 'compress@10': 1.0, 'time@10': 7.4937}:  83%|████████▎ | 25/30 [01:47<00:12,  2.46s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.2028, 'hit_ratio@10': 0.6956, 'ndcg@10': 0.6333, 'compress@10': 1.0, 'time@10': 8.422}:  83%|████████▎ | 25/30 [02:18<00:12,  2.46s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.2028, 'hit_ratio@10': 0.6956, 'ndcg@10': 0.6333, 'compress@10': 1.0, 'time@10': 8.422}:  87%|████████▋ | 26/30 [02:18<00:37,  9.49s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.1967, 'hit_ratio@10': 0.7056, 'ndcg@10': 0.6427, 'compress@10': 1.0, 'time@10': 8.4998}:  87%|████████▋ | 26/30 [02:24<00:37,  9.49s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.1967, 'hit_ratio@10': 0.7056, 'ndcg@10': 0.6427, 'compress@10': 1.0, 'time@10': 8.4998}:  90%|█████████ | 27/30 [02:24<00:25,  8.42s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.1911, 'hit_ratio@10': 0.7133, 'ndcg@10': 0.6511, 'compress@10': 1.0, 'time@10': 8.4828}:  90%|█████████ | 27/30 [02:32<00:25,  8.42s/it]   {'epoch': 2, 'num_users': 6.0, 'loss': 0.1911, 'hit_ratio@10': 0.7133, 'ndcg@10': 0.6511, 'compress@10': 1.0, 'time@10': 8.4828}:  93%|█████████▎| 28/30 [02:32<00:16,  8.32s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.1851, 'hit_ratio@10': 0.72, 'ndcg@10': 0.6598, 'compress@10': 1.0, 'time@10': 8.3002}:  93%|█████████▎| 28/30 [02:33<00:16,  8.32s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.1851, 'hit_ratio@10': 0.72, 'ndcg@10': 0.6598, 'compress@10': 1.0, 'time@10': 8.3002}:  97%|█████████▋| 29/30 [02:33<00:06,  6.47s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.1803, 'hit_ratio@10': 0.7213, 'ndcg@10': 0.6678, 'compress@10': 1.0, 'time@10': 8.0888}:  97%|█████████▋| 29/30 [02:35<00:06,  6.47s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.1803, 'hit_ratio@10': 0.7213, 'ndcg@10': 0.6678, 'compress@10': 1.0, 'time@10': 8.0888}: 100%|██████████| 30/30 [02:35<00:00,  5.20s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.1803, 'hit_ratio@10': 0.7213, 'ndcg@10': 0.6678, 'compress@10': 1.0, 'time@10': 8.0888}: 100%|██████████| 30/30 [02:35<00:00,  5.20s/it]
Epoch: 2
Avg # of users: 5.866666666666666
Avg Loss: 0.18025300059740496
Avg hit ratio: 0.7212727837712005
Avg ndcg: 0.667820802914596
Avg compression ratio: 0.9999999865602245
Avg train time: 8.088781309127807
Std train time: 13.442664145686614
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[19, 1, 1, 1, 272, 20, 32, 1, 107, 17, 41, 1, 17, 1, 60, 1, 1, 1, 1, 56, 156, 1, 9, 1, 1, 144, 48, 36, 10, 3]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 5.3841}:   0%|          | 0/30 [00:02<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 5.3841}:   3%|▎         | 1/30 [00:02<01:19,  2.73s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.1095, 'hit_ratio@10': 0.7173, 'ndcg@10': 0.7114, 'compress@10': 1.0, 'time@10': 2.8114}:   3%|▎         | 1/30 [00:03<01:19,  2.73s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.1095, 'hit_ratio@10': 0.7173, 'ndcg@10': 0.7114, 'compress@10': 1.0, 'time@10': 2.8114}:   7%|▋         | 2/30 [00:03<00:35,  1.29s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.1439, 'hit_ratio@10': 0.6211, 'ndcg@10': 0.605, 'compress@10': 1.0, 'time@10': 1.9093}:   7%|▋         | 2/30 [00:03<00:35,  1.29s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.1594, 'hit_ratio@10': 0.5954, 'ndcg@10': 0.5898, 'compress@10': 1.0, 'time@10': 1.485}:   7%|▋         | 2/30 [00:03<00:35,  1.29s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.1594, 'hit_ratio@10': 0.5954, 'ndcg@10': 0.5898, 'compress@10': 1.0, 'time@10': 1.485}:  13%|█▎        | 4/30 [00:03<00:15,  1.71it/s]{'epoch': 3, 'num_users': 5.8, 'loss': 0.1285, 'hit_ratio@10': 0.6723, 'ndcg@10': 0.6685, 'compress@10': 1.0, 'time@10': 44.4379}:  13%|█▎        | 4/30 [01:51<00:15,  1.71it/s]{'epoch': 3, 'num_users': 5.8, 'loss': 0.1285, 'hit_ratio@10': 0.6723, 'ndcg@10': 0.6685, 'compress@10': 1.0, 'time@10': 44.4379}:  17%|█▋        | 5/30 [01:51<14:06, 33.86s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.1161, 'hit_ratio@10': 0.7047, 'ndcg@10': 0.6974, 'compress@10': 1.0, 'time@10': 38.2136}:  17%|█▋        | 5/30 [01:58<14:06, 33.86s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.1161, 'hit_ratio@10': 0.7047, 'ndcg@10': 0.6974, 'compress@10': 1.0, 'time@10': 38.2136}:  20%|██        | 6/30 [01:58<10:16, 25.67s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.1036, 'hit_ratio@10': 0.7412, 'ndcg@10': 0.7253, 'compress@10': 1.0, 'time@10': 34.565}:  20%|██        | 6/30 [02:05<10:16, 25.67s/it] {'epoch': 3, 'num_users': 6.2857, 'loss': 0.1036, 'hit_ratio@10': 0.7412, 'ndcg@10': 0.7253, 'compress@10': 1.0, 'time@10': 34.565}:  23%|██▎       | 7/30 [02:05<07:35, 19.79s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.1129, 'hit_ratio@10': 0.7405, 'ndcg@10': 0.6973, 'compress@10': 1.0, 'time@10': 30.2782}:  23%|██▎       | 7/30 [02:05<07:35, 19.79s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.1129, 'hit_ratio@10': 0.7405, 'ndcg@10': 0.6973, 'compress@10': 1.0, 'time@10': 30.2782}:  27%|██▋       | 8/30 [02:05<05:05, 13.89s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.1013, 'hit_ratio@10': 0.7471, 'ndcg@10': 0.7272, 'compress@10': 1.0, 'time@10': 33.4472}:  27%|██▋       | 8/30 [02:34<05:05, 13.89s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.1013, 'hit_ratio@10': 0.7471, 'ndcg@10': 0.7272, 'compress@10': 1.0, 'time@10': 33.4472}:  30%|███       | 9/30 [02:34<06:30, 18.59s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0944, 'hit_ratio@10': 0.7656, 'ndcg@10': 0.7406, 'compress@10': 1.0, 'time@10': 30.665}:  30%|███       | 9/30 [02:40<06:30, 18.59s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.0944, 'hit_ratio@10': 0.7656, 'ndcg@10': 0.7406, 'compress@10': 1.0, 'time@10': 30.665}:  33%|███▎      | 10/30 [02:40<04:53, 14.69s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0894, 'hit_ratio@10': 0.7659, 'ndcg@10': 0.7539, 'compress@10': 1.0, 'time@10': 29.3703}:  33%|███▎      | 10/30 [02:48<04:53, 14.69s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0894, 'hit_ratio@10': 0.7659, 'ndcg@10': 0.7539, 'compress@10': 1.0, 'time@10': 29.3703}:  37%|███▋      | 11/30 [02:48<04:02, 12.75s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.1001, 'hit_ratio@10': 0.7172, 'ndcg@10': 0.7272, 'compress@10': 1.0, 'time@10': 26.9302}:  37%|███▋      | 11/30 [02:48<04:02, 12.75s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.1001, 'hit_ratio@10': 0.7172, 'ndcg@10': 0.7272, 'compress@10': 1.0, 'time@10': 26.9302}:  40%|████      | 12/30 [02:48<02:41,  8.95s/it]{'epoch': 3, 'num_users': 6.6154, 'loss': 0.096, 'hit_ratio@10': 0.7285, 'ndcg@10': 0.7388, 'compress@10': 1.0, 'time@10': 25.3143}:  40%|████      | 12/30 [02:51<02:41,  8.95s/it] {'epoch': 3, 'num_users': 6.6154, 'loss': 0.096, 'hit_ratio@10': 0.7285, 'ndcg@10': 0.7388, 'compress@10': 1.0, 'time@10': 25.3143}:  43%|████▎     | 13/30 [02:51<02:01,  7.16s/it]{'epoch': 3, 'num_users': 6.3571, 'loss': 0.1404, 'hit_ratio@10': 0.6907, 'ndcg@10': 0.6949, 'compress@10': 1.0, 'time@10': 23.509}:  43%|████▎     | 13/30 [02:51<02:01,  7.16s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.1323, 'hit_ratio@10': 0.7092, 'ndcg@10': 0.7106, 'compress@10': 1.0, 'time@10': 23.8338}:  43%|████▎     | 13/30 [03:06<02:01,  7.16s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.1323, 'hit_ratio@10': 0.7092, 'ndcg@10': 0.7106, 'compress@10': 1.0, 'time@10': 23.8338}:  50%|█████     | 15/30 [03:06<01:47,  7.16s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.1324, 'hit_ratio@10': 0.7046, 'ndcg@10': 0.6993, 'compress@10': 1.0, 'time@10': 22.3493}:  50%|█████     | 15/30 [03:06<01:47,  7.16s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.1324, 'hit_ratio@10': 0.7046, 'ndcg@10': 0.6993, 'compress@10': 1.0, 'time@10': 22.3493}:  53%|█████▎    | 16/30 [03:06<01:15,  5.41s/it]{'epoch': 3, 'num_users': 5.8235, 'loss': 0.1603, 'hit_ratio@10': 0.6926, 'ndcg@10': 0.6648, 'compress@10': 1.0, 'time@10': 21.0382}:  53%|█████▎    | 16/30 [03:06<01:15,  5.41s/it]{'epoch': 3, 'num_users': 6.0556, 'loss': 0.1623, 'hit_ratio@10': 0.6883, 'ndcg@10': 0.6614, 'compress@10': 1.0, 'time@10': 19.881}:  53%|█████▎    | 16/30 [03:06<01:15,  5.41s/it] {'epoch': 3, 'num_users': 6.0556, 'loss': 0.1623, 'hit_ratio@10': 0.6883, 'ndcg@10': 0.6614, 'compress@10': 1.0, 'time@10': 19.881}:  60%|██████    | 18/30 [03:06<00:38,  3.23s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.1638, 'hit_ratio@10': 0.6723, 'ndcg@10': 0.6556, 'compress@10': 1.0, 'time@10': 18.8463}:  60%|██████    | 18/30 [03:06<00:38,  3.23s/it]  {'epoch': 3, 'num_users': 6.0, 'loss': 0.1638, 'hit_ratio@10': 0.6723, 'ndcg@10': 0.6556, 'compress@10': 1.0, 'time@10': 18.8463}:  63%|██████▎   | 19/30 [03:06<00:27,  2.53s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.1562, 'hit_ratio@10': 0.687, 'ndcg@10': 0.6709, 'compress@10': 1.0, 'time@10': 19.1677}:  63%|██████▎   | 19/30 [03:31<00:27,  2.53s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.1562, 'hit_ratio@10': 0.687, 'ndcg@10': 0.6709, 'compress@10': 1.0, 'time@10': 19.1677}:  67%|██████▋   | 20/30 [03:31<01:21,  8.14s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.1495, 'hit_ratio@10': 0.6959, 'ndcg@10': 0.6856, 'compress@10': 1.0, 'time@10': 22.9599}:  67%|██████▋   | 20/30 [04:21<01:21,  8.14s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.1495, 'hit_ratio@10': 0.6959, 'ndcg@10': 0.6856, 'compress@10': 1.0, 'time@10': 22.9599}:  70%|███████   | 21/30 [04:21<02:49, 18.88s/it]{'epoch': 3, 'num_users': 6.1818, 'loss': 0.1608, 'hit_ratio@10': 0.6729, 'ndcg@10': 0.6713, 'compress@10': 1.0, 'time@10': 21.924}:  70%|███████   | 21/30 [04:21<02:49, 18.88s/it] {'epoch': 3, 'num_users': 6.1818, 'loss': 0.1608, 'hit_ratio@10': 0.6729, 'ndcg@10': 0.6713, 'compress@10': 1.0, 'time@10': 21.924}:  73%|███████▎  | 22/30 [04:21<01:50, 13.82s/it]{'epoch': 3, 'num_users': 6.1304, 'loss': 0.1548, 'hit_ratio@10': 0.6785, 'ndcg@10': 0.6813, 'compress@10': 1.0, 'time@10': 21.0944}:  73%|███████▎  | 22/30 [04:23<01:50, 13.82s/it]{'epoch': 3, 'num_users': 6.1304, 'loss': 0.1548, 'hit_ratio@10': 0.6785, 'ndcg@10': 0.6813, 'compress@10': 1.0, 'time@10': 21.0944}:  77%|███████▋  | 23/30 [04:23<01:12, 10.37s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.1698, 'hit_ratio@10': 0.6814, 'ndcg@10': 0.6584, 'compress@10': 1.0, 'time@10': 20.2168}:  77%|███████▋  | 23/30 [04:23<01:12, 10.37s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.187, 'hit_ratio@10': 0.6542, 'ndcg@10': 0.6338, 'compress@10': 1.0, 'time@10': 19.4092}:  77%|███████▋  | 23/30 [04:23<01:12, 10.37s/it]    {'epoch': 3, 'num_users': 5.8, 'loss': 0.187, 'hit_ratio@10': 0.6542, 'ndcg@10': 0.6338, 'compress@10': 1.0, 'time@10': 19.4092}:  83%|████████▎ | 25/30 [04:23<00:28,  5.80s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.18, 'hit_ratio@10': 0.6656, 'ndcg@10': 0.6474, 'compress@10': 1.0, 'time@10': 22.1635}:  83%|████████▎ | 25/30 [05:54<00:28,  5.80s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.18, 'hit_ratio@10': 0.6656, 'ndcg@10': 0.6474, 'compress@10': 1.0, 'time@10': 22.1635}:  87%|████████▋ | 26/30 [05:54<01:45, 26.31s/it]{'epoch': 3, 'num_users': 5.8889, 'loss': 0.1741, 'hit_ratio@10': 0.6767, 'ndcg@10': 0.6573, 'compress@10': 1.0, 'time@10': 22.116}:  87%|████████▋ | 26/30 [06:04<01:45, 26.31s/it]{'epoch': 3, 'num_users': 5.8889, 'loss': 0.1741, 'hit_ratio@10': 0.6767, 'ndcg@10': 0.6573, 'compress@10': 1.0, 'time@10': 22.116}:  90%|█████████ | 27/30 [06:04<01:06, 22.26s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.1686, 'hit_ratio@10': 0.6868, 'ndcg@10': 0.6668, 'compress@10': 1.0, 'time@10': 21.8341}:  90%|█████████ | 27/30 [06:19<01:06, 22.26s/it]  {'epoch': 3, 'num_users': 6.0, 'loss': 0.1686, 'hit_ratio@10': 0.6868, 'ndcg@10': 0.6668, 'compress@10': 1.0, 'time@10': 21.8341}:  93%|█████████▎| 28/30 [06:19<00:40, 20.12s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.1634, 'hit_ratio@10': 0.6945, 'ndcg@10': 0.6746, 'compress@10': 1.0, 'time@10': 21.1892}:  93%|█████████▎| 28/30 [06:20<00:40, 20.12s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.1634, 'hit_ratio@10': 0.6945, 'ndcg@10': 0.6746, 'compress@10': 1.0, 'time@10': 21.1892}:  97%|█████████▋| 29/30 [06:20<00:15, 15.00s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.1604, 'hit_ratio@10': 0.6957, 'ndcg@10': 0.6787, 'compress@10': 1.0, 'time@10': 20.5108}:  97%|█████████▋| 29/30 [06:21<00:15, 15.00s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.1604, 'hit_ratio@10': 0.6957, 'ndcg@10': 0.6787, 'compress@10': 1.0, 'time@10': 20.5108}: 100%|██████████| 30/30 [06:21<00:00, 11.00s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.1604, 'hit_ratio@10': 0.6957, 'ndcg@10': 0.6787, 'compress@10': 1.0, 'time@10': 20.5108}: 100%|██████████| 30/30 [06:21<00:00, 12.72s/it]
Epoch: 3
Avg # of users: 5.866666666666666
Avg Loss: 0.16036393481541503
Avg hit ratio: 0.6956597808164233
Avg ndcg: 0.6787380364529007
Avg compression ratio: 0.9999999865656828
Avg train time: 20.510800170898438
Std train time: 44.092743363584766
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[26, 1, 1, 1, 964, 33, 63, 1, 288, 25, 84, 1, 26, 1, 142, 1, 1, 1, 1, 128, 467, 1, 8, 1, 1, 429, 106, 72, 10, 1]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0404, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.857, 'compress@10': 1.0, 'time@10': 8.0186}:   0%|          | 0/30 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0404, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.857, 'compress@10': 1.0, 'time@10': 8.0186}:   3%|▎         | 1/30 [00:04<01:57,  4.06s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1027, 'hit_ratio@10': 0.6851, 'ndcg@10': 0.7272, 'compress@10': 1.0, 'time@10': 4.1291}:   3%|▎         | 1/30 [00:04<01:57,  4.06s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1027, 'hit_ratio@10': 0.6851, 'ndcg@10': 0.7272, 'compress@10': 1.0, 'time@10': 4.1291}:   7%|▋         | 2/30 [00:04<00:51,  1.85s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.1311, 'hit_ratio@10': 0.5996, 'ndcg@10': 0.6281, 'compress@10': 1.0, 'time@10': 2.7886}:   7%|▋         | 2/30 [00:04<00:51,  1.85s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.1471, 'hit_ratio@10': 0.5886, 'ndcg@10': 0.6114, 'compress@10': 1.0, 'time@10': 2.1414}:   7%|▋         | 2/30 [00:04<00:51,  1.85s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.1471, 'hit_ratio@10': 0.5886, 'ndcg@10': 0.6114, 'compress@10': 1.0, 'time@10': 2.1414}:  13%|█▎        | 4/30 [00:04<00:20,  1.26it/s]{'epoch': 4, 'num_users': 5.8, 'loss': 0.1179, 'hit_ratio@10': 0.6668, 'ndcg@10': 0.6851, 'compress@10': 1.0, 'time@10': 154.1391}:  13%|█▎        | 4/30 [06:25<00:20,  1.26it/s]{'epoch': 4, 'num_users': 5.8, 'loss': 0.1179, 'hit_ratio@10': 0.6668, 'ndcg@10': 0.6851, 'compress@10': 1.0, 'time@10': 154.1391}:  17%|█▋        | 5/30 [06:25<49:21, 118.44s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.1033, 'hit_ratio@10': 0.715, 'ndcg@10': 0.7189, 'compress@10': 1.0, 'time@10': 130.3766}:  17%|█▋        | 5/30 [06:37<49:21, 118.44s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.1033, 'hit_ratio@10': 0.715, 'ndcg@10': 0.7189, 'compress@10': 1.0, 'time@10': 130.3766}:  20%|██        | 6/30 [06:37<34:16, 85.70s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0907, 'hit_ratio@10': 0.75, 'ndcg@10': 0.7494, 'compress@10': 1.0, 'time@10': 115.0601}:  20%|██        | 6/30 [06:49<34:16, 85.70s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0907, 'hit_ratio@10': 0.75, 'ndcg@10': 0.7494, 'compress@10': 1.0, 'time@10': 115.0601}:  23%|██▎       | 7/30 [06:49<24:12, 63.14s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0996, 'hit_ratio@10': 0.7481, 'ndcg@10': 0.7202, 'compress@10': 1.0, 'time@10': 100.706}:  23%|██▎       | 7/30 [06:49<24:12, 63.14s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0996, 'hit_ratio@10': 0.7481, 'ndcg@10': 0.7202, 'compress@10': 1.0, 'time@10': 100.706}:  27%|██▋       | 8/30 [06:49<16:09, 44.08s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0891, 'hit_ratio@10': 0.7412, 'ndcg@10': 0.7481, 'compress@10': 1.0, 'time@10': 106.8824}:  27%|██▋       | 8/30 [08:07<16:09, 44.08s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0891, 'hit_ratio@10': 0.7412, 'ndcg@10': 0.7481, 'compress@10': 1.0, 'time@10': 106.8824}:  30%|███       | 9/30 [08:07<19:02, 54.39s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0821, 'hit_ratio@10': 0.7648, 'ndcg@10': 0.7655, 'compress@10': 1.0, 'time@10': 97.0517}:  30%|███       | 9/30 [08:16<19:02, 54.39s/it]    {'epoch': 4, 'num_users': 6.3, 'loss': 0.0821, 'hit_ratio@10': 0.7648, 'ndcg@10': 0.7655, 'compress@10': 1.0, 'time@10': 97.0517}:  33%|███▎      | 10/30 [08:16<13:31, 40.59s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.076, 'hit_ratio@10': 0.7687, 'ndcg@10': 0.7809, 'compress@10': 1.0, 'time@10': 91.4247}:  33%|███▎      | 10/30 [08:33<13:31, 40.59s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.076, 'hit_ratio@10': 0.7687, 'ndcg@10': 0.7809, 'compress@10': 1.0, 'time@10': 91.4247}:  37%|███▋      | 11/30 [08:33<10:39, 33.67s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0875, 'hit_ratio@10': 0.7198, 'ndcg@10': 0.7538, 'compress@10': 1.0, 'time@10': 83.8132}:  37%|███▋      | 11/30 [08:33<10:39, 33.67s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0875, 'hit_ratio@10': 0.7198, 'ndcg@10': 0.7538, 'compress@10': 1.0, 'time@10': 83.8132}:  40%|████      | 12/30 [08:33<07:04, 23.58s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0844, 'hit_ratio@10': 0.7309, 'ndcg@10': 0.7641, 'compress@10': 1.0, 'time@10': 78.0431}:  40%|████      | 12/30 [08:38<07:04, 23.58s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0844, 'hit_ratio@10': 0.7309, 'ndcg@10': 0.7641, 'compress@10': 1.0, 'time@10': 78.0431}:  43%|████▎     | 13/30 [08:38<05:03, 17.83s/it]{'epoch': 4, 'num_users': 6.3571, 'loss': 0.1236, 'hit_ratio@10': 0.6929, 'ndcg@10': 0.7208, 'compress@10': 1.0, 'time@10': 72.4712}:  43%|████▎     | 13/30 [08:38<05:03, 17.83s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.1156, 'hit_ratio@10': 0.7113, 'ndcg@10': 0.7372, 'compress@10': 1.0, 'time@10': 72.0197}:  43%|████▎     | 13/30 [09:11<05:03, 17.83s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.1156, 'hit_ratio@10': 0.7113, 'ndcg@10': 0.7372, 'compress@10': 1.0, 'time@10': 72.0197}:  50%|█████     | 15/30 [09:11<04:18, 17.21s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.1163, 'hit_ratio@10': 0.7066, 'ndcg@10': 0.7256, 'compress@10': 1.0, 'time@10': 67.5239}:  50%|█████     | 15/30 [09:11<04:18, 17.21s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.1163, 'hit_ratio@10': 0.7066, 'ndcg@10': 0.7256, 'compress@10': 1.0, 'time@10': 67.5239}:  53%|█████▎    | 16/30 [09:11<03:01, 12.97s/it]{'epoch': 4, 'num_users': 5.8235, 'loss': 0.1419, 'hit_ratio@10': 0.7091, 'ndcg@10': 0.691, 'compress@10': 1.0, 'time@10': 63.5552}:  53%|█████▎    | 16/30 [09:11<03:01, 12.97s/it] {'epoch': 4, 'num_users': 6.0556, 'loss': 0.1448, 'hit_ratio@10': 0.7039, 'ndcg@10': 0.6862, 'compress@10': 1.0, 'time@10': 60.036}:  53%|█████▎    | 16/30 [09:11<03:01, 12.97s/it]{'epoch': 4, 'num_users': 6.0556, 'loss': 0.1448, 'hit_ratio@10': 0.7039, 'ndcg@10': 0.6862, 'compress@10': 1.0, 'time@10': 60.036}:  60%|██████    | 18/30 [09:11<01:31,  7.65s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.1471, 'hit_ratio@10': 0.6912, 'ndcg@10': 0.6782, 'compress@10': 1.0, 'time@10': 56.8874}:  60%|██████    | 18/30 [09:11<01:31,  7.65s/it]  {'epoch': 4, 'num_users': 6.0, 'loss': 0.1471, 'hit_ratio@10': 0.6912, 'ndcg@10': 0.6782, 'compress@10': 1.0, 'time@10': 56.8874}:  63%|██████▎   | 19/30 [09:11<01:05,  5.94s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.14, 'hit_ratio@10': 0.7057, 'ndcg@10': 0.6933, 'compress@10': 1.0, 'time@10': 56.9114}:  63%|██████▎   | 19/30 [10:09<01:05,  5.94s/it] {'epoch': 4, 'num_users': 6.15, 'loss': 0.14, 'hit_ratio@10': 0.7057, 'ndcg@10': 0.6933, 'compress@10': 1.0, 'time@10': 56.9114}:  67%|██████▋   | 20/30 [10:09<03:06, 18.61s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.1334, 'hit_ratio@10': 0.7138, 'ndcg@10': 0.7067, 'compress@10': 1.0, 'time@10': 68.348}:  67%|██████▋   | 20/30 [12:37<03:06, 18.61s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.1334, 'hit_ratio@10': 0.7138, 'ndcg@10': 0.7067, 'compress@10': 1.0, 'time@10': 68.348}:  70%|███████   | 21/30 [12:37<07:51, 52.42s/it]{'epoch': 4, 'num_users': 6.1818, 'loss': 0.1451, 'hit_ratio@10': 0.69, 'ndcg@10': 0.6917, 'compress@10': 1.0, 'time@10': 65.2476}:  70%|███████   | 21/30 [12:38<07:51, 52.42s/it] {'epoch': 4, 'num_users': 6.1818, 'loss': 0.1451, 'hit_ratio@10': 0.69, 'ndcg@10': 0.6917, 'compress@10': 1.0, 'time@10': 65.2476}:  73%|███████▎  | 22/30 [12:38<05:06, 38.26s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.1399, 'hit_ratio@10': 0.6948, 'ndcg@10': 0.7009, 'compress@10': 1.0, 'time@10': 62.5075}:  73%|███████▎  | 22/30 [12:39<05:06, 38.26s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.1399, 'hit_ratio@10': 0.6948, 'ndcg@10': 0.7009, 'compress@10': 1.0, 'time@10': 62.5075}:  77%|███████▋  | 23/30 [12:39<03:15, 27.91s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.1527, 'hit_ratio@10': 0.6971, 'ndcg@10': 0.6771, 'compress@10': 1.0, 'time@10': 59.9042}:  77%|███████▋  | 23/30 [12:39<03:15, 27.91s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.1687, 'hit_ratio@10': 0.6692, 'ndcg@10': 0.6518, 'compress@10': 1.0, 'time@10': 57.5091}:  77%|███████▋  | 23/30 [12:39<03:15, 27.91s/it]   {'epoch': 4, 'num_users': 5.8, 'loss': 0.1687, 'hit_ratio@10': 0.6692, 'ndcg@10': 0.6518, 'compress@10': 1.0, 'time@10': 57.5091}:  83%|████████▎ | 25/30 [12:39<01:17, 15.55s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.1623, 'hit_ratio@10': 0.6805, 'ndcg@10': 0.6647, 'compress@10': 1.0, 'time@10': 65.6811}:  83%|████████▎ | 25/30 [17:09<01:17, 15.55s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.1623, 'hit_ratio@10': 0.6805, 'ndcg@10': 0.6647, 'compress@10': 1.0, 'time@10': 65.6811}:  87%|████████▋ | 26/30 [17:09<05:07, 76.78s/it]{'epoch': 4, 'num_users': 5.8889, 'loss': 0.1564, 'hit_ratio@10': 0.691, 'ndcg@10': 0.6757, 'compress@10': 1.0, 'time@10': 64.938}:  87%|████████▋ | 26/30 [17:32<05:07, 76.78s/it]  {'epoch': 4, 'num_users': 5.8889, 'loss': 0.1564, 'hit_ratio@10': 0.691, 'ndcg@10': 0.6757, 'compress@10': 1.0, 'time@10': 64.938}:  90%|█████████ | 27/30 [17:32<03:08, 62.99s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.151, 'hit_ratio@10': 0.7, 'ndcg@10': 0.6864, 'compress@10': 1.0, 'time@10': 63.6631}:  90%|█████████ | 27/30 [18:01<03:08, 62.99s/it]     {'epoch': 4, 'num_users': 6.0, 'loss': 0.151, 'hit_ratio@10': 0.7, 'ndcg@10': 0.6864, 'compress@10': 1.0, 'time@10': 63.6631}:  93%|█████████▎| 28/30 [18:01<01:47, 53.96s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.1464, 'hit_ratio@10': 0.7072, 'ndcg@10': 0.6938, 'compress@10': 1.0, 'time@10': 61.5785}:  93%|█████████▎| 28/30 [18:03<01:47, 53.96s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.1464, 'hit_ratio@10': 0.7072, 'ndcg@10': 0.6938, 'compress@10': 1.0, 'time@10': 61.5785}:  97%|█████████▋| 29/30 [18:03<00:39, 39.49s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.1477, 'hit_ratio@10': 0.704, 'ndcg@10': 0.6896, 'compress@10': 1.0, 'time@10': 59.5354}:  97%|█████████▋| 29/30 [18:03<00:39, 39.49s/it] {'epoch': 4, 'num_users': 5.8667, 'loss': 0.1477, 'hit_ratio@10': 0.704, 'ndcg@10': 0.6896, 'compress@10': 1.0, 'time@10': 59.5354}: 100%|██████████| 30/30 [18:03<00:00, 28.40s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.1477, 'hit_ratio@10': 0.704, 'ndcg@10': 0.6896, 'compress@10': 1.0, 'time@10': 59.5354}: 100%|██████████| 30/30 [18:03<00:00, 36.11s/it]
Epoch: 4
Avg # of users: 5.866666666666666
Avg Loss: 0.14772928681232822
Avg hit ratio: 0.7039756395928094
Avg ndcg: 0.6896021572999792
Avg compression ratio: 0.9999999865656828
Avg train time: 59.53538038730621
Std train time: 149.75099371223138
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[42, 1, 1, 1, 3427, 61, 128, 1, 785, 43, 188, 1, 45, 1, 345, 1, 1, 1, 1, 304, 1421, 1, 5, 1, 1, 1295, 244, 157, 10, 1]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 11.9092}:   0%|          | 0/30 [00:05<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 11.9092}:   3%|▎         | 1/30 [00:05<02:53,  5.99s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.1039, 'hit_ratio@10': 0.6528, 'ndcg@10': 0.7275, 'compress@10': 1.0, 'time@10': 6.0704}:   3%|▎         | 1/30 [00:06<02:53,  5.99s/it] {'epoch': 5, 'num_users': 7.0, 'loss': 0.1039, 'hit_ratio@10': 0.6528, 'ndcg@10': 0.7275, 'compress@10': 1.0, 'time@10': 6.0704}:   7%|▋         | 2/30 [00:06<01:13,  2.62s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.1322, 'hit_ratio@10': 0.6257, 'ndcg@10': 0.6295, 'compress@10': 1.0, 'time@10': 4.0784}:   7%|▋         | 2/30 [00:06<01:13,  2.62s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.1504, 'hit_ratio@10': 0.6081, 'ndcg@10': 0.6064, 'compress@10': 1.0, 'time@10': 3.1077}:   7%|▋         | 2/30 [00:06<01:13,  2.62s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.1504, 'hit_ratio@10': 0.6081, 'ndcg@10': 0.6064, 'compress@10': 1.0, 'time@10': 3.1077}:  13%|█▎        | 4/30 [00:06<00:28,  1.08s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.1203, 'hit_ratio@10': 0.6785, 'ndcg@10': 0.6811, 'compress@10': 1.0, 'time@10': 540.0619}:  13%|█▎        | 4/30 [22:30<00:28,  1.08s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.1203, 'hit_ratio@10': 0.6785, 'ndcg@10': 0.6811, 'compress@10': 1.0, 'time@10': 540.0619}:  17%|█▋        | 5/30 [22:30<2:53:31, 416.45s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.1017, 'hit_ratio@10': 0.7284, 'ndcg@10': 0.7285, 'compress@10': 1.0, 'time@10': 453.3841}:  17%|█▋        | 5/30 [22:50<2:53:31, 416.45s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.1017, 'hit_ratio@10': 0.7284, 'ndcg@10': 0.7285, 'compress@10': 1.0, 'time@10': 453.3841}:  20%|██        | 6/30 [22:50<1:57:59, 294.97s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0875, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.7616, 'compress@10': 1.0, 'time@10': 395.2102}:  20%|██        | 6/30 [23:13<1:57:59, 294.97s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0875, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.7616, 'compress@10': 1.0, 'time@10': 395.2102}:  23%|██▎       | 7/30 [23:13<1:21:20, 212.21s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0981, 'hit_ratio@10': 0.7582, 'ndcg@10': 0.7283, 'compress@10': 1.0, 'time@10': 345.8418}:  23%|██▎       | 7/30 [23:14<1:21:20, 212.21s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0981, 'hit_ratio@10': 0.7582, 'ndcg@10': 0.7283, 'compress@10': 1.0, 'time@10': 345.8418}:  27%|██▋       | 8/30 [23:14<54:15, 147.97s/it]  {'epoch': 5, 'num_users': 6.3333, 'loss': 0.0872, 'hit_ratio@10': 0.766, 'ndcg@10': 0.7553, 'compress@10': 1.0, 'time@10': 352.6275}:  27%|██▋       | 8/30 [26:37<54:15, 147.97s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0872, 'hit_ratio@10': 0.766, 'ndcg@10': 0.7553, 'compress@10': 1.0, 'time@10': 352.6275}:  30%|███       | 9/30 [26:37<57:39, 164.75s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0793, 'hit_ratio@10': 0.7872, 'ndcg@10': 0.7759, 'compress@10': 1.0, 'time@10': 318.7193}:  30%|███       | 9/30 [26:51<57:39, 164.75s/it]  {'epoch': 5, 'num_users': 6.3, 'loss': 0.0793, 'hit_ratio@10': 0.7872, 'ndcg@10': 0.7759, 'compress@10': 1.0, 'time@10': 318.7193}:  33%|███▎      | 10/30 [26:51<39:43, 119.17s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0724, 'hit_ratio@10': 0.782, 'ndcg@10': 0.7928, 'compress@10': 1.0, 'time@10': 296.2153}:  33%|███▎      | 10/30 [27:26<39:43, 119.17s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0724, 'hit_ratio@10': 0.782, 'ndcg@10': 0.7928, 'compress@10': 1.0, 'time@10': 296.2153}:  37%|███▋      | 11/30 [27:26<29:46, 94.02s/it] {'epoch': 5, 'num_users': 6.4167, 'loss': 0.0855, 'hit_ratio@10': 0.7396, 'ndcg@10': 0.7595, 'compress@10': 1.0, 'time@10': 271.537}:  37%|███▋      | 11/30 [27:26<29:46, 94.02s/it]{'epoch': 5, 'num_users': 6.4167, 'loss': 0.0855, 'hit_ratio@10': 0.7396, 'ndcg@10': 0.7595, 'compress@10': 1.0, 'time@10': 271.537}:  40%|████      | 12/30 [27:26<19:44, 65.78s/it]{'epoch': 5, 'num_users': 6.6154, 'loss': 0.0812, 'hit_ratio@10': 0.7456, 'ndcg@10': 0.77, 'compress@10': 1.0, 'time@10': 251.7204}:  40%|████      | 12/30 [27:33<19:44, 65.78s/it] {'epoch': 5, 'num_users': 6.6154, 'loss': 0.0812, 'hit_ratio@10': 0.7456, 'ndcg@10': 0.77, 'compress@10': 1.0, 'time@10': 251.7204}:  43%|████▎     | 13/30 [27:33<13:38, 48.12s/it]{'epoch': 5, 'num_users': 6.3571, 'loss': 0.1185, 'hit_ratio@10': 0.7067, 'ndcg@10': 0.7269, 'compress@10': 1.0, 'time@10': 233.7427}:  43%|████▎     | 13/30 [27:33<13:38, 48.12s/it]{'epoch': 5, 'num_users': 6.2667, 'loss': 0.1108, 'hit_ratio@10': 0.7241, 'ndcg@10': 0.743, 'compress@10': 1.0, 'time@10': 227.5948}:  43%|████▎     | 13/30 [28:44<13:38, 48.12s/it] {'epoch': 5, 'num_users': 6.2667, 'loss': 0.1108, 'hit_ratio@10': 0.7241, 'ndcg@10': 0.743, 'compress@10': 1.0, 'time@10': 227.5948}:  50%|█████     | 15/30 [28:44<10:33, 42.26s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.1122, 'hit_ratio@10': 0.7129, 'ndcg@10': 0.7276, 'compress@10': 1.0, 'time@10': 213.3747}:  50%|█████     | 15/30 [28:44<10:33, 42.26s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.1122, 'hit_ratio@10': 0.7129, 'ndcg@10': 0.7276, 'compress@10': 1.0, 'time@10': 213.3747}:  53%|█████▎    | 16/30 [28:44<07:25, 31.80s/it]{'epoch': 5, 'num_users': 5.8235, 'loss': 0.1365, 'hit_ratio@10': 0.7151, 'ndcg@10': 0.693, 'compress@10': 1.0, 'time@10': 200.8264}:  53%|█████▎    | 16/30 [28:44<07:25, 31.80s/it] {'epoch': 5, 'num_users': 6.0556, 'loss': 0.1402, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.6859, 'compress@10': 1.0, 'time@10': 189.6798}:  53%|█████▎    | 16/30 [28:45<07:25, 31.80s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.1402, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.6859, 'compress@10': 1.0, 'time@10': 189.6798}:  60%|██████    | 18/30 [28:45<03:44, 18.67s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.1433, 'hit_ratio@10': 0.6985, 'ndcg@10': 0.6757, 'compress@10': 1.0, 'time@10': 179.7058}:  60%|██████    | 18/30 [28:45<03:44, 18.67s/it]   {'epoch': 5, 'num_users': 6.0, 'loss': 0.1433, 'hit_ratio@10': 0.6985, 'ndcg@10': 0.6757, 'compress@10': 1.0, 'time@10': 179.7058}:  63%|██████▎   | 19/30 [28:45<02:38, 14.43s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.1364, 'hit_ratio@10': 0.7127, 'ndcg@10': 0.691, 'compress@10': 1.0, 'time@10': 176.6353}:  63%|██████▎   | 19/30 [30:43<02:38, 14.43s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.1364, 'hit_ratio@10': 0.7127, 'ndcg@10': 0.691, 'compress@10': 1.0, 'time@10': 176.6353}:  67%|██████▋   | 20/30 [30:43<06:40, 40.01s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.1299, 'hit_ratio@10': 0.724, 'ndcg@10': 0.7046, 'compress@10': 1.0, 'time@10': 205.2364}:  67%|██████▋   | 20/30 [37:12<06:40, 40.01s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.1299, 'hit_ratio@10': 0.724, 'ndcg@10': 0.7046, 'compress@10': 1.0, 'time@10': 205.2364}:  70%|███████   | 21/30 [37:12<19:36, 130.72s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.1419, 'hit_ratio@10': 0.6976, 'ndcg@10': 0.6881, 'compress@10': 1.0, 'time@10': 195.9137}:  70%|███████   | 21/30 [37:12<19:36, 130.72s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.1419, 'hit_ratio@10': 0.6976, 'ndcg@10': 0.6881, 'compress@10': 1.0, 'time@10': 195.9137}:  73%|███████▎  | 22/30 [37:12<12:42, 95.35s/it] {'epoch': 5, 'num_users': 6.1304, 'loss': 0.1383, 'hit_ratio@10': 0.7064, 'ndcg@10': 0.6925, 'compress@10': 1.0, 'time@10': 187.461}:  73%|███████▎  | 22/30 [37:13<12:42, 95.35s/it] {'epoch': 5, 'num_users': 6.1304, 'loss': 0.1383, 'hit_ratio@10': 0.7064, 'ndcg@10': 0.6925, 'compress@10': 1.0, 'time@10': 187.461}:  77%|███████▋  | 23/30 [37:13<08:03, 69.02s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.1495, 'hit_ratio@10': 0.7082, 'ndcg@10': 0.6702, 'compress@10': 1.0, 'time@10': 179.6519}:  77%|███████▋  | 23/30 [37:13<08:03, 69.02s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.1495, 'hit_ratio@10': 0.7082, 'ndcg@10': 0.6702, 'compress@10': 1.0, 'time@10': 179.6519}:  80%|████████  | 24/30 [37:13<04:56, 49.38s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.1639, 'hit_ratio@10': 0.6799, 'ndcg@10': 0.6453, 'compress@10': 1.0, 'time@10': 172.4671}:  80%|████████  | 24/30 [37:13<04:56, 49.38s/it]   {'epoch': 5, 'num_users': 5.8077, 'loss': 0.1576, 'hit_ratio@10': 0.6908, 'ndcg@10': 0.6585, 'compress@10': 1.0, 'time@10': 192.6557}:  80%|████████  | 24/30 [48:51<04:56, 49.38s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.1576, 'hit_ratio@10': 0.6908, 'ndcg@10': 0.6585, 'compress@10': 1.0, 'time@10': 192.6557}:  87%|████████▋ | 26/30 [48:51<12:14, 183.74s/it]{'epoch': 5, 'num_users': 5.8889, 'loss': 0.152, 'hit_ratio@10': 0.7009, 'ndcg@10': 0.6698, 'compress@10': 1.0, 'time@10': 188.8212}:  87%|████████▋ | 26/30 [49:35<12:14, 183.74s/it] {'epoch': 5, 'num_users': 5.8889, 'loss': 0.152, 'hit_ratio@10': 0.7009, 'ndcg@10': 0.6698, 'compress@10': 1.0, 'time@10': 188.8212}:  90%|█████████ | 27/30 [49:35<07:29, 149.96s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.1468, 'hit_ratio@10': 0.7102, 'ndcg@10': 0.6809, 'compress@10': 1.0, 'time@10': 184.0209}:  90%|█████████ | 27/30 [50:30<07:29, 149.96s/it]  {'epoch': 5, 'num_users': 6.0, 'loss': 0.1468, 'hit_ratio@10': 0.7102, 'ndcg@10': 0.6809, 'compress@10': 1.0, 'time@10': 184.0209}:  93%|█████████▎| 28/30 [50:30<04:10, 125.37s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.1424, 'hit_ratio@10': 0.7171, 'ndcg@10': 0.6884, 'compress@10': 1.0, 'time@10': 177.7674}:  93%|█████████▎| 28/30 [50:31<04:10, 125.37s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.1424, 'hit_ratio@10': 0.7171, 'ndcg@10': 0.6884, 'compress@10': 1.0, 'time@10': 177.7674}:  97%|█████████▋| 29/30 [50:31<01:32, 92.02s/it] {'epoch': 5, 'num_users': 5.8667, 'loss': 0.1437, 'hit_ratio@10': 0.7135, 'ndcg@10': 0.6841, 'compress@10': 1.0, 'time@10': 171.8511}:  97%|█████████▋| 29/30 [50:31<01:32, 92.02s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.1437, 'hit_ratio@10': 0.7135, 'ndcg@10': 0.6841, 'compress@10': 1.0, 'time@10': 171.8511}: 100%|██████████| 30/30 [50:31<00:00, 66.57s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.1437, 'hit_ratio@10': 0.7135, 'ndcg@10': 0.6841, 'compress@10': 1.0, 'time@10': 171.8511}: 100%|██████████| 30/30 [50:31<00:00, 101.06s/it]
Epoch: 5
Avg # of users: 5.866666666666666
Avg Loss: 0.14365359132832822
Avg hit ratio: 0.7135254092763552
Avg ndcg: 0.6840551647510196
Avg compression ratio: 0.9999999865656828
Avg train time: 171.85107492605846
Std train time: 504.90250018413286
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[71, 1, 1, 1, 12140, 116, 268, 1, 2096, 77, 409, 1, 80, 1, 794, 1, 1, 1, 1, 678, 3933, 1, 1, 1, 1, 3548, 523, 324, 9, 1]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9051, 'compress@10': 1.0, 'time@10': 17.0715}:   0%|          | 0/30 [00:08<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9051, 'compress@10': 1.0, 'time@10': 17.0715}:   3%|▎         | 1/30 [00:08<04:08,  8.57s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.1072, 'hit_ratio@10': 0.7317, 'ndcg@10': 0.6997, 'compress@10': 1.0, 'time@10': 8.6491}:   3%|▎         | 1/30 [00:08<04:08,  8.57s/it] {'epoch': 6, 'num_users': 7.0, 'loss': 0.1072, 'hit_ratio@10': 0.7317, 'ndcg@10': 0.6997, 'compress@10': 1.0, 'time@10': 8.6491}:   7%|▋         | 2/30 [00:08<01:43,  3.68s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.1441, 'hit_ratio@10': 0.5831, 'ndcg@10': 0.594, 'compress@10': 1.0, 'time@10': 5.7964}:   7%|▋         | 2/30 [00:08<01:43,  3.68s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.1685, 'hit_ratio@10': 0.5762, 'ndcg@10': 0.5595, 'compress@10': 1.0, 'time@10': 4.3914}:   7%|▋         | 2/30 [00:09<01:43,  3.68s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.1685, 'hit_ratio@10': 0.5762, 'ndcg@10': 0.5595, 'compress@10': 1.0, 'time@10': 4.3914}:  13%|█▎        | 4/30 [00:09<00:38,  1.47s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.1348, 'hit_ratio@10': 0.657, 'ndcg@10': 0.6436, 'compress@10': 1.0, 'time@10': 1654.8907}:  13%|█▎        | 4/30 [1:08:57<00:38,  1.47s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.1348, 'hit_ratio@10': 0.657, 'ndcg@10': 0.6436, 'compress@10': 1.0, 'time@10': 1654.8907}:  17%|█▋        | 5/30 [1:08:57<8:52:29, 1278.00s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.1131, 'hit_ratio@10': 0.7104, 'ndcg@10': 0.6993, 'compress@10': 1.0, 'time@10': 1384.8098}:  17%|█▋        | 5/30 [1:09:32<8:52:29, 1278.00s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.1131, 'hit_ratio@10': 0.7104, 'ndcg@10': 0.6993, 'compress@10': 1.0, 'time@10': 1384.8098}:  20%|██        | 6/30 [1:09:32<5:58:45, 896.90s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.0971, 'hit_ratio@10': 0.7461, 'ndcg@10': 0.7365, 'compress@10': 1.0, 'time@10': 1199.8508}:  20%|██        | 6/30 [1:10:17<5:58:45, 896.90s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0971, 'hit_ratio@10': 0.7461, 'ndcg@10': 0.7365, 'compress@10': 1.0, 'time@10': 1199.8508}:  23%|██▎       | 7/30 [1:10:17<4:04:23, 637.53s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.1084, 'hit_ratio@10': 0.7374, 'ndcg@10': 0.6983, 'compress@10': 1.0, 'time@10': 1049.8974}:  23%|██▎       | 7/30 [1:10:17<4:04:23, 637.53s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.1084, 'hit_ratio@10': 0.7374, 'ndcg@10': 0.6983, 'compress@10': 1.0, 'time@10': 1049.8974}:  27%|██▋       | 8/30 [1:10:17<2:42:55, 444.36s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0964, 'hit_ratio@10': 0.738, 'ndcg@10': 0.7286, 'compress@10': 1.0, 'time@10': 1042.8984}:  27%|██▋       | 8/30 [1:18:30<2:42:55, 444.36s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0964, 'hit_ratio@10': 0.738, 'ndcg@10': 0.7286, 'compress@10': 1.0, 'time@10': 1042.8984}:  30%|███       | 9/30 [1:18:30<2:40:43, 459.20s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0869, 'hit_ratio@10': 0.7619, 'ndcg@10': 0.7533, 'compress@10': 1.0, 'time@10': 940.8025}:  30%|███       | 9/30 [1:18:52<2:40:43, 459.20s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0869, 'hit_ratio@10': 0.7619, 'ndcg@10': 0.7533, 'compress@10': 1.0, 'time@10': 940.8025}:  33%|███▎      | 10/30 [1:18:52<1:49:07, 327.37s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.0791, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.7722, 'compress@10': 1.0, 'time@10': 868.2364}:  33%|███▎      | 10/30 [1:20:04<1:49:07, 327.37s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.0791, 'hit_ratio@10': 0.7696, 'ndcg@10': 0.7722, 'compress@10': 1.0, 'time@10': 868.2364}:  37%|███▋      | 11/30 [1:20:04<1:19:15, 250.28s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.0979, 'hit_ratio@10': 0.7282, 'ndcg@10': 0.7347, 'compress@10': 1.0, 'time@10': 795.8896}:  37%|███▋      | 11/30 [1:20:04<1:19:15, 250.28s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.0979, 'hit_ratio@10': 0.7282, 'ndcg@10': 0.7347, 'compress@10': 1.0, 'time@10': 795.8896}:  40%|████      | 12/30 [1:20:04<52:30, 175.04s/it]  {'epoch': 6, 'num_users': 6.6154, 'loss': 0.0912, 'hit_ratio@10': 0.7386, 'ndcg@10': 0.7497, 'compress@10': 1.0, 'time@10': 736.4587}:  40%|████      | 12/30 [1:20:16<52:30, 175.04s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.0912, 'hit_ratio@10': 0.7386, 'ndcg@10': 0.7497, 'compress@10': 1.0, 'time@10': 736.4587}:  43%|████▎     | 13/30 [1:20:16<35:41, 125.95s/it]{'epoch': 6, 'num_users': 6.3571, 'loss': 0.131, 'hit_ratio@10': 0.7001, 'ndcg@10': 0.707, 'compress@10': 1.0, 'time@10': 683.8566}:  43%|████▎     | 13/30 [1:20:16<35:41, 125.95s/it]  {'epoch': 6, 'num_users': 6.2667, 'loss': 0.1224, 'hit_ratio@10': 0.718, 'ndcg@10': 0.7244, 'compress@10': 1.0, 'time@10': 659.0406}:  43%|████▎     | 13/30 [1:22:51<35:41, 125.95s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.1224, 'hit_ratio@10': 0.718, 'ndcg@10': 0.7244, 'compress@10': 1.0, 'time@10': 659.0406}:  50%|█████     | 15/30 [1:22:51<25:56, 103.78s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.1274, 'hit_ratio@10': 0.7072, 'ndcg@10': 0.7029, 'compress@10': 1.0, 'time@10': 617.8551}:  50%|█████     | 15/30 [1:22:52<25:56, 103.78s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.1274, 'hit_ratio@10': 0.7072, 'ndcg@10': 0.7029, 'compress@10': 1.0, 'time@10': 617.8551}:  53%|█████▎    | 16/30 [1:22:52<18:12, 78.06s/it] {'epoch': 6, 'num_users': 5.8235, 'loss': 0.1515, 'hit_ratio@10': 0.7097, 'ndcg@10': 0.6698, 'compress@10': 1.0, 'time@10': 581.5138}:  53%|█████▎    | 16/30 [1:22:52<18:12, 78.06s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.1564, 'hit_ratio@10': 0.7045, 'ndcg@10': 0.6584, 'compress@10': 1.0, 'time@10': 549.2179}:  53%|█████▎    | 16/30 [1:22:52<18:12, 78.06s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.1564, 'hit_ratio@10': 0.7045, 'ndcg@10': 0.6584, 'compress@10': 1.0, 'time@10': 549.2179}:  60%|██████    | 18/30 [1:22:52<09:08, 45.74s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.1612, 'hit_ratio@10': 0.6917, 'ndcg@10': 0.6427, 'compress@10': 1.0, 'time@10': 520.3209}:  60%|██████    | 18/30 [1:22:52<09:08, 45.74s/it]   {'epoch': 6, 'num_users': 6.0, 'loss': 0.1612, 'hit_ratio@10': 0.6917, 'ndcg@10': 0.6427, 'compress@10': 1.0, 'time@10': 520.3209}:  63%|██████▎   | 19/30 [1:22:52<06:28, 35.31s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.1532, 'hit_ratio@10': 0.7062, 'ndcg@10': 0.6597, 'compress@10': 1.0, 'time@10': 507.3298}:  63%|██████▎   | 19/30 [1:27:12<06:28, 35.31s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.1532, 'hit_ratio@10': 0.7062, 'ndcg@10': 0.6597, 'compress@10': 1.0, 'time@10': 507.3298}:  67%|██████▋   | 20/30 [1:27:12<15:07, 90.75s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.1459, 'hit_ratio@10': 0.7166, 'ndcg@10': 0.6747, 'compress@10': 1.0, 'time@10': 585.3047}:  67%|██████▋   | 20/30 [1:45:05<15:07, 90.75s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.1459, 'hit_ratio@10': 0.7166, 'ndcg@10': 0.6747, 'compress@10': 1.0, 'time@10': 585.3047}:  70%|███████   | 21/30 [1:45:05<51:55, 346.16s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.158, 'hit_ratio@10': 0.6927, 'ndcg@10': 0.6571, 'compress@10': 1.0, 'time@10': 558.7063}:  70%|███████   | 21/30 [1:45:05<51:55, 346.16s/it] {'epoch': 6, 'num_users': 6.1818, 'loss': 0.158, 'hit_ratio@10': 0.6927, 'ndcg@10': 0.6571, 'compress@10': 1.0, 'time@10': 558.7063}:  73%|███████▎  | 22/30 [1:45:05<33:39, 252.41s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.1601, 'hit_ratio@10': 0.6832, 'ndcg@10': 0.6484, 'compress@10': 1.0, 'time@10': 534.4258}:  73%|███████▎  | 22/30 [1:45:05<33:39, 252.41s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.1601, 'hit_ratio@10': 0.6832, 'ndcg@10': 0.6484, 'compress@10': 1.0, 'time@10': 534.4258}:  77%|███████▋  | 23/30 [1:45:05<21:14, 182.02s/it]{'epoch': 6, 'num_users': 5.9583, 'loss': 0.1711, 'hit_ratio@10': 0.686, 'ndcg@10': 0.6272, 'compress@10': 1.0, 'time@10': 512.1592}:  77%|███████▋  | 23/30 [1:45:05<21:14, 182.02s/it] {'epoch': 6, 'num_users': 5.8, 'loss': 0.1842, 'hit_ratio@10': 0.6585, 'ndcg@10': 0.6041, 'compress@10': 1.0, 'time@10': 491.6739}:  77%|███████▋  | 23/30 [1:45:05<21:14, 182.02s/it]  {'epoch': 6, 'num_users': 5.8, 'loss': 0.1842, 'hit_ratio@10': 0.6585, 'ndcg@10': 0.6041, 'compress@10': 1.0, 'time@10': 491.6739}:  83%|████████▎ | 25/30 [1:45:05<08:26, 101.30s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.1842, 'hit_ratio@10': 0.6585, 'ndcg@10': 0.6041, 'compress@10': 1.0, 'time@10': 491.6739}:  83%|████████▎ | 25/30 [1:45:22<08:26, 101.30s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.1771, 'hit_ratio@10': 0.6707, 'ndcg@10': 0.6188, 'compress@10': 1.0, 'time@10': 541.767}:  83%|████████▎ | 25/30 [2:14:59<08:26, 101.30s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.1771, 'hit_ratio@10': 0.6707, 'ndcg@10': 0.6188, 'compress@10': 1.0, 'time@10': 541.767}:  87%|████████▋ | 26/30 [2:14:59<33:54, 508.63s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.1706, 'hit_ratio@10': 0.6816, 'ndcg@10': 0.6316, 'compress@10': 1.0, 'time@10': 528.5954}:  87%|████████▋ | 26/30 [2:16:33<33:54, 508.63s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.1706, 'hit_ratio@10': 0.6816, 'ndcg@10': 0.6316, 'compress@10': 1.0, 'time@10': 528.5954}:  90%|█████████ | 27/30 [2:16:33<20:06, 402.33s/it]