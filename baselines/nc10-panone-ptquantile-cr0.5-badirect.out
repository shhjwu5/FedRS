  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.9915, 'hit_ratio@10': 0.3158, 'ndcg@10': 0.1033, 'compress@10': 0.5263, 'time@10': 10.9342}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.9915, 'hit_ratio@10': 0.3158, 'ndcg@10': 0.1033, 'compress@10': 0.5263, 'time@10': 10.9342}:  10%|█         | 1/10 [00:05<00:49,  5.51s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.5682, 'hit_ratio@10': 0.416, 'ndcg@10': 0.3177, 'compress@10': 0.5212, 'time@10': 9.7088}:  10%|█         | 1/10 [00:14<00:49,  5.51s/it]  {'epoch': 0, 'num_users': 7.0, 'loss': 0.5682, 'hit_ratio@10': 0.416, 'ndcg@10': 0.3177, 'compress@10': 0.5212, 'time@10': 9.7088}:  20%|██        | 2/10 [00:14<00:58,  7.28s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 1.1448, 'hit_ratio@10': 0.3249, 'ndcg@10': 0.2118, 'compress@10': 0.538, 'time@10': 7.6386}:  20%|██        | 2/10 [00:15<00:58,  7.28s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 1.1448, 'hit_ratio@10': 0.3249, 'ndcg@10': 0.2118, 'compress@10': 0.538, 'time@10': 7.6386}:  30%|███       | 3/10 [00:15<00:33,  4.77s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9075, 'hit_ratio@10': 0.3866, 'ndcg@10': 0.2837, 'compress@10': 0.5329, 'time@10': 7.6283}:  30%|███       | 3/10 [00:23<00:33,  4.77s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9075, 'hit_ratio@10': 0.3866, 'ndcg@10': 0.2837, 'compress@10': 0.5329, 'time@10': 7.6283}:  40%|████      | 4/10 [00:23<00:35,  5.90s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.7481, 'hit_ratio@10': 0.4772, 'ndcg@10': 0.3611, 'compress@10': 0.5283, 'time@10': 11.236}:  40%|████      | 4/10 [00:36<00:35,  5.90s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.7481, 'hit_ratio@10': 0.4772, 'ndcg@10': 0.3611, 'compress@10': 0.5283, 'time@10': 11.236}:  50%|█████     | 5/10 [00:36<00:42,  8.42s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.643, 'hit_ratio@10': 0.5162, 'ndcg@10': 0.4108, 'compress@10': 0.5255, 'time@10': 11.283}:  50%|█████     | 5/10 [00:47<00:42,  8.42s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.643, 'hit_ratio@10': 0.5162, 'ndcg@10': 0.4108, 'compress@10': 0.5255, 'time@10': 11.283}:  60%|██████    | 6/10 [00:47<00:37,  9.49s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.5804, 'hit_ratio@10': 0.5168, 'ndcg@10': 0.4253, 'compress@10': 0.5247, 'time@10': 11.3744}:  60%|██████    | 6/10 [00:53<00:37,  9.49s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.5804, 'hit_ratio@10': 0.5168, 'ndcg@10': 0.4253, 'compress@10': 0.5247, 'time@10': 11.3744}:  70%|███████   | 7/10 [00:53<00:25,  8.35s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.5216, 'hit_ratio@10': 0.57, 'ndcg@10': 0.4396, 'compress@10': 0.5234, 'time@10': 11.0426}:  70%|███████   | 7/10 [01:02<00:25,  8.35s/it]   {'epoch': 0, 'num_users': 6.125, 'loss': 0.5216, 'hit_ratio@10': 0.57, 'ndcg@10': 0.4396, 'compress@10': 0.5234, 'time@10': 11.0426}:  80%|████████  | 8/10 [01:02<00:16,  8.48s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.4774, 'hit_ratio@10': 0.5924, 'ndcg@10': 0.4605, 'compress@10': 0.5224, 'time@10': 11.7852}:  80%|████████  | 8/10 [01:11<00:16,  8.48s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.4774, 'hit_ratio@10': 0.5924, 'ndcg@10': 0.4605, 'compress@10': 0.5224, 'time@10': 11.7852}:  90%|█████████ | 9/10 [01:11<00:08,  8.61s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.4372, 'hit_ratio@10': 0.6218, 'ndcg@10': 0.4826, 'compress@10': 0.5213, 'time@10': 11.722}:  90%|█████████ | 9/10 [01:22<00:08,  8.61s/it]    {'epoch': 0, 'num_users': 6.3, 'loss': 0.4372, 'hit_ratio@10': 0.6218, 'ndcg@10': 0.4826, 'compress@10': 0.5213, 'time@10': 11.722}: 100%|██████████| 10/10 [01:22<00:00,  9.41s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.4372, 'hit_ratio@10': 0.6218, 'ndcg@10': 0.4826, 'compress@10': 0.5213, 'time@10': 11.722}: 100%|██████████| 10/10 [01:22<00:00,  8.27s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.43717364417184984
Avg hit ratio: 0.621796468198845
Avg ndcg: 0.4825520938383939
Avg compression ratio: 0.5212749006657823
Avg train time: 11.721961259841919
Std train time: 5.793725501244695
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[9, 7, 3, 6, 22, 10, 10, 7, 15, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0827, 'hit_ratio@10': 0.6316, 'ndcg@10': 0.6818, 'compress@10': 0.5263, 'time@10': 8.5257}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0827, 'hit_ratio@10': 0.6316, 'ndcg@10': 0.6818, 'compress@10': 0.5263, 'time@10': 8.5257}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0783, 'hit_ratio@10': 0.6868, 'ndcg@10': 0.7314, 'compress@10': 0.5212, 'time@10': 7.0859}:  10%|█         | 1/10 [00:09<00:38,  4.30s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0783, 'hit_ratio@10': 0.6868, 'ndcg@10': 0.7314, 'compress@10': 0.5212, 'time@10': 7.0859}:  20%|██        | 2/10 [00:09<00:40,  5.11s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.3465, 'hit_ratio@10': 0.6483, 'ndcg@10': 0.5219, 'compress@10': 0.538, 'time@10': 5.0487}:  20%|██        | 2/10 [00:10<00:40,  5.11s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.3465, 'hit_ratio@10': 0.6483, 'ndcg@10': 0.5219, 'compress@10': 0.538, 'time@10': 5.0487}:  30%|███       | 3/10 [00:10<00:21,  3.02s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.2884, 'hit_ratio@10': 0.6827, 'ndcg@10': 0.5445, 'compress@10': 0.5329, 'time@10': 4.8208}:  30%|███       | 3/10 [00:14<00:21,  3.02s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.2884, 'hit_ratio@10': 0.6827, 'ndcg@10': 0.5445, 'compress@10': 0.5329, 'time@10': 4.8208}:  40%|████      | 4/10 [00:14<00:20,  3.49s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.2443, 'hit_ratio@10': 0.7141, 'ndcg@10': 0.5961, 'compress@10': 0.5283, 'time@10': 15.2645}:  40%|████      | 4/10 [00:43<00:20,  3.49s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.2443, 'hit_ratio@10': 0.7141, 'ndcg@10': 0.5961, 'compress@10': 0.5283, 'time@10': 15.2645}:  50%|█████     | 5/10 [00:43<01:02, 12.53s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.217, 'hit_ratio@10': 0.7099, 'ndcg@10': 0.6327, 'compress@10': 0.5255, 'time@10': 14.6408}:  50%|█████     | 5/10 [00:54<01:02, 12.53s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.217, 'hit_ratio@10': 0.7099, 'ndcg@10': 0.6327, 'compress@10': 0.5255, 'time@10': 14.6408}:  60%|██████    | 6/10 [00:54<00:48, 12.20s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.1937, 'hit_ratio@10': 0.7456, 'ndcg@10': 0.6593, 'compress@10': 0.5247, 'time@10': 14.3733}:  60%|██████    | 6/10 [01:01<00:48, 12.20s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.1937, 'hit_ratio@10': 0.7456, 'ndcg@10': 0.6593, 'compress@10': 0.5247, 'time@10': 14.3733}:  70%|███████   | 7/10 [01:01<00:30, 10.31s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.1763, 'hit_ratio@10': 0.7667, 'ndcg@10': 0.6766, 'compress@10': 0.5234, 'time@10': 13.3633}:  70%|███████   | 7/10 [01:07<00:30, 10.31s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.1763, 'hit_ratio@10': 0.7667, 'ndcg@10': 0.6766, 'compress@10': 0.5234, 'time@10': 13.3633}:  80%|████████  | 8/10 [01:07<00:18,  9.04s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.1604, 'hit_ratio@10': 0.7609, 'ndcg@10': 0.703, 'compress@10': 0.5224, 'time@10': 14.849}:  80%|████████  | 8/10 [01:21<00:18,  9.04s/it] {'epoch': 1, 'num_users': 6.3333, 'loss': 0.1604, 'hit_ratio@10': 0.7609, 'ndcg@10': 0.703, 'compress@10': 0.5224, 'time@10': 14.849}:  90%|█████████ | 9/10 [01:21<00:10, 10.41s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.1492, 'hit_ratio@10': 0.778, 'ndcg@10': 0.7175, 'compress@10': 0.5213, 'time@10': 14.5029}:  90%|█████████ | 9/10 [01:32<00:10, 10.41s/it]  {'epoch': 1, 'num_users': 6.3, 'loss': 0.1492, 'hit_ratio@10': 0.778, 'ndcg@10': 0.7175, 'compress@10': 0.5213, 'time@10': 14.5029}: 100%|██████████| 10/10 [01:32<00:00, 10.72s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.1492, 'hit_ratio@10': 0.778, 'ndcg@10': 0.7175, 'compress@10': 0.5213, 'time@10': 14.5029}: 100%|██████████| 10/10 [01:32<00:00,  9.24s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.14923496370577724
Avg hit ratio: 0.7779935787660744
Avg ndcg: 0.7174570981633082
Avg compression ratio: 0.5212749006657823
Avg train time: 14.502894020080566
Std train time: 15.660744017964317
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[6, 2, 1, 1, 61, 10, 11, 2, 28, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0765, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.7332, 'compress@10': 0.5263, 'time@10': 5.3376}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0765, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.7332, 'compress@10': 0.5263, 'time@10': 5.3376}:  10%|█         | 1/10 [00:02<00:24,  2.72s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.1049, 'hit_ratio@10': 0.6808, 'ndcg@10': 0.6796, 'compress@10': 0.5212, 'time@10': 3.4788}:  10%|█         | 1/10 [00:04<00:24,  2.72s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.1049, 'hit_ratio@10': 0.6808, 'ndcg@10': 0.6796, 'compress@10': 0.5212, 'time@10': 3.4788}:  20%|██        | 2/10 [00:04<00:16,  2.09s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.2545, 'hit_ratio@10': 0.5967, 'ndcg@10': 0.5153, 'compress@10': 0.538, 'time@10': 2.441}:  20%|██        | 2/10 [00:04<00:16,  2.09s/it]  {'epoch': 2, 'num_users': 5.0, 'loss': 0.2545, 'hit_ratio@10': 0.5967, 'ndcg@10': 0.5153, 'compress@10': 0.538, 'time@10': 2.441}:  30%|███       | 3/10 [00:04<00:08,  1.24s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.2453, 'hit_ratio@10': 0.5587, 'ndcg@10': 0.5195, 'compress@10': 0.5331, 'time@10': 2.0067}:  30%|███       | 3/10 [00:05<00:08,  1.24s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.2453, 'hit_ratio@10': 0.5587, 'ndcg@10': 0.5195, 'compress@10': 0.5331, 'time@10': 2.0067}:  40%|████      | 4/10 [00:05<00:06,  1.04s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.1985, 'hit_ratio@10': 0.6349, 'ndcg@10': 0.6052, 'compress@10': 0.5285, 'time@10': 33.2397}:  40%|████      | 4/10 [01:24<00:06,  1.04s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.1985, 'hit_ratio@10': 0.6349, 'ndcg@10': 0.6052, 'compress@10': 0.5285, 'time@10': 33.2397}:  50%|█████     | 5/10 [01:24<02:25, 29.20s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.1781, 'hit_ratio@10': 0.655, 'ndcg@10': 0.6403, 'compress@10': 0.5256, 'time@10': 29.6174}:  50%|█████     | 5/10 [01:35<02:25, 29.20s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.1781, 'hit_ratio@10': 0.655, 'ndcg@10': 0.6403, 'compress@10': 0.5256, 'time@10': 29.6174}:  60%|██████    | 6/10 [01:35<01:32, 23.20s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.1587, 'hit_ratio@10': 0.6986, 'ndcg@10': 0.6715, 'compress@10': 0.5248, 'time@10': 27.3752}:  60%|██████    | 6/10 [01:42<01:32, 23.20s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.1587, 'hit_ratio@10': 0.6986, 'ndcg@10': 0.6715, 'compress@10': 0.5248, 'time@10': 27.3752}:  70%|███████   | 7/10 [01:42<00:53, 17.90s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.1533, 'hit_ratio@10': 0.7148, 'ndcg@10': 0.6583, 'compress@10': 0.5235, 'time@10': 24.1675}:  70%|███████   | 7/10 [01:44<00:53, 17.90s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.1533, 'hit_ratio@10': 0.7148, 'ndcg@10': 0.6583, 'compress@10': 0.5235, 'time@10': 24.1675}:  80%|████████  | 8/10 [01:44<00:25, 12.76s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.1394, 'hit_ratio@10': 0.718, 'ndcg@10': 0.6885, 'compress@10': 0.5224, 'time@10': 27.1489}:  80%|████████  | 8/10 [02:10<00:25, 12.76s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.1394, 'hit_ratio@10': 0.718, 'ndcg@10': 0.6885, 'compress@10': 0.5224, 'time@10': 27.1489}:  90%|█████████ | 9/10 [02:10<00:16, 16.76s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.1299, 'hit_ratio@10': 0.7393, 'ndcg@10': 0.7046, 'compress@10': 0.5213, 'time@10': 25.5556}:  90%|█████████ | 9/10 [02:21<00:16, 16.76s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 0.1299, 'hit_ratio@10': 0.7393, 'ndcg@10': 0.7046, 'compress@10': 0.5213, 'time@10': 25.5556}: 100%|██████████| 10/10 [02:21<00:00, 15.06s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.1299, 'hit_ratio@10': 0.7393, 'ndcg@10': 0.7046, 'compress@10': 0.5213, 'time@10': 25.5556}: 100%|██████████| 10/10 [02:21<00:00, 14.16s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.12994778726413508
Avg hit ratio: 0.7393448062972681
Avg ndcg: 0.7046044413705079
Avg compression ratio: 0.5213410386143043
Avg train time: 25.555587577819825
Std train time: 46.449049925234306
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[1, 1, 1, 1, 186, 10, 13, 1, 62, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.1909, 'hit_ratio@10': 0.5556, 'ndcg@10': 0.5551, 'compress@10': 0.5278, 'time@10': 0.9483}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.1909, 'hit_ratio@10': 0.5556, 'ndcg@10': 0.5551, 'compress@10': 0.5278, 'time@10': 0.9483}:  10%|█         | 1/10 [00:00<00:04,  1.96it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.1769, 'hit_ratio@10': 0.6004, 'ndcg@10': 0.5847, 'compress@10': 0.522, 'time@10': 0.8839}:  10%|█         | 1/10 [00:01<00:04,  1.96it/s] {'epoch': 3, 'num_users': 7.0, 'loss': 0.1769, 'hit_ratio@10': 0.6004, 'ndcg@10': 0.5847, 'compress@10': 0.522, 'time@10': 0.8839}:  20%|██        | 2/10 [00:01<00:05,  1.40it/s]{'epoch': 3, 'num_users': 5.0, 'loss': 0.2632, 'hit_ratio@10': 0.5431, 'ndcg@10': 0.4676, 'compress@10': 0.5384, 'time@10': 0.7059}:  20%|██        | 2/10 [00:01<00:05,  1.40it/s]{'epoch': 3, 'num_users': 5.0, 'loss': 0.2632, 'hit_ratio@10': 0.5431, 'ndcg@10': 0.4676, 'compress@10': 0.5384, 'time@10': 0.7059}:  30%|███       | 3/10 [00:01<00:03,  2.07it/s]{'epoch': 3, 'num_users': 5.0, 'loss': 0.2474, 'hit_ratio@10': 0.5277, 'ndcg@10': 0.4892, 'compress@10': 0.5335, 'time@10': 0.715}:  30%|███       | 3/10 [00:02<00:03,  2.07it/s] {'epoch': 3, 'num_users': 5.0, 'loss': 0.2474, 'hit_ratio@10': 0.5277, 'ndcg@10': 0.4892, 'compress@10': 0.5335, 'time@10': 0.715}:  40%|████      | 4/10 [00:02<00:03,  1.67it/s]{'epoch': 3, 'num_users': 5.8, 'loss': 0.1984, 'hit_ratio@10': 0.6182, 'ndcg@10': 0.5873, 'compress@10': 0.5288, 'time@10': 96.4917}:  40%|████      | 4/10 [04:02<00:03,  1.67it/s]{'epoch': 3, 'num_users': 5.8, 'loss': 0.1984, 'hit_ratio@10': 0.6182, 'ndcg@10': 0.5873, 'compress@10': 0.5288, 'time@10': 96.4917}:  50%|█████     | 5/10 [04:02<07:14, 86.87s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.1773, 'hit_ratio@10': 0.6448, 'ndcg@10': 0.6255, 'compress@10': 0.5258, 'time@10': 82.3705}:  50%|█████     | 5/10 [04:13<07:14, 86.87s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.1773, 'hit_ratio@10': 0.6448, 'ndcg@10': 0.6255, 'compress@10': 0.5258, 'time@10': 82.3705}:  60%|██████    | 6/10 [04:13<04:05, 61.35s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.1577, 'hit_ratio@10': 0.6898, 'ndcg@10': 0.6607, 'compress@10': 0.525, 'time@10': 72.8938}:  60%|██████    | 6/10 [04:22<04:05, 61.35s/it] {'epoch': 3, 'num_users': 6.2857, 'loss': 0.1577, 'hit_ratio@10': 0.6898, 'ndcg@10': 0.6607, 'compress@10': 0.525, 'time@10': 72.8938}:  70%|███████   | 7/10 [04:22<02:11, 43.92s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.1574, 'hit_ratio@10': 0.6918, 'ndcg@10': 0.6438, 'compress@10': 0.5237, 'time@10': 63.8924}:  70%|███████   | 7/10 [04:22<02:11, 43.92s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.1574, 'hit_ratio@10': 0.6918, 'ndcg@10': 0.6438, 'compress@10': 0.5237, 'time@10': 63.8924}:  80%|████████  | 8/10 [04:22<01:00, 30.23s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.141, 'hit_ratio@10': 0.7102, 'ndcg@10': 0.6781, 'compress@10': 0.5227, 'time@10': 69.0978}:  80%|████████  | 8/10 [05:18<01:00, 30.23s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.141, 'hit_ratio@10': 0.7102, 'ndcg@10': 0.6781, 'compress@10': 0.5227, 'time@10': 69.0978}:  90%|█████████ | 9/10 [05:18<00:38, 38.10s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.1311, 'hit_ratio@10': 0.7323, 'ndcg@10': 0.6955, 'compress@10': 0.5215, 'time@10': 63.317}:  90%|█████████ | 9/10 [05:29<00:38, 38.10s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.1311, 'hit_ratio@10': 0.7323, 'ndcg@10': 0.6955, 'compress@10': 0.5215, 'time@10': 63.317}: 100%|██████████| 10/10 [05:29<00:00, 29.84s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.1311, 'hit_ratio@10': 0.7323, 'ndcg@10': 0.6955, 'compress@10': 0.5215, 'time@10': 63.317}: 100%|██████████| 10/10 [05:29<00:00, 32.97s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.1311467548407635
Avg hit ratio: 0.732339092561104
Avg ndcg: 0.6955077581494236
Avg compression ratio: 0.5215292553483474
Avg train time: 63.316954255104065
Std train time: 142.37766733438593
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[1, 1, 1, 1, 585, 10, 17, 1, 146, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1913, 'hit_ratio@10': 0.5, 'ndcg@10': 0.5688, 'compress@10': 0.5278, 'time@10': 0.9427}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1913, 'hit_ratio@10': 0.5, 'ndcg@10': 0.5688, 'compress@10': 0.5278, 'time@10': 0.9427}:  10%|█         | 1/10 [00:00<00:04,  1.97it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1774, 'hit_ratio@10': 0.5242, 'ndcg@10': 0.6001, 'compress@10': 0.522, 'time@10': 0.8698}:  10%|█         | 1/10 [00:01<00:04,  1.97it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1774, 'hit_ratio@10': 0.5242, 'ndcg@10': 0.6001, 'compress@10': 0.522, 'time@10': 0.8698}:  20%|██        | 2/10 [00:01<00:05,  1.43it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.2468, 'hit_ratio@10': 0.4923, 'ndcg@10': 0.4907, 'compress@10': 0.5384, 'time@10': 0.7023}:  20%|██        | 2/10 [00:01<00:05,  1.43it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.2468, 'hit_ratio@10': 0.4923, 'ndcg@10': 0.4907, 'compress@10': 0.5384, 'time@10': 0.7023}:  30%|███       | 3/10 [00:01<00:03,  2.08it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.2352, 'hit_ratio@10': 0.4896, 'ndcg@10': 0.5092, 'compress@10': 0.5335, 'time@10': 0.7063}:  30%|███       | 3/10 [00:02<00:03,  2.08it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.2352, 'hit_ratio@10': 0.4896, 'ndcg@10': 0.5092, 'compress@10': 0.5335, 'time@10': 0.7063}:  40%|████      | 4/10 [00:02<00:03,  1.70it/s]{'epoch': 4, 'num_users': 5.8, 'loss': 0.1886, 'hit_ratio@10': 0.5877, 'ndcg@10': 0.6034, 'compress@10': 0.5288, 'time@10': 296.4959}:  40%|████      | 4/10 [12:22<00:03,  1.70it/s]{'epoch': 4, 'num_users': 5.8, 'loss': 0.1886, 'hit_ratio@10': 0.5877, 'ndcg@10': 0.6034, 'compress@10': 0.5288, 'time@10': 296.4959}:  50%|█████     | 5/10 [12:22<22:15, 267.18s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.1688, 'hit_ratio@10': 0.6231, 'ndcg@10': 0.6409, 'compress@10': 0.5258, 'time@10': 248.7995}:  50%|█████     | 5/10 [12:32<22:15, 267.18s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.1688, 'hit_ratio@10': 0.6231, 'ndcg@10': 0.6409, 'compress@10': 0.5258, 'time@10': 248.7995}:  60%|██████    | 6/10 [12:32<11:59, 179.86s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.1501, 'hit_ratio@10': 0.6712, 'ndcg@10': 0.6722, 'compress@10': 0.525, 'time@10': 216.0075}:  60%|██████    | 6/10 [12:42<11:59, 179.86s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.1501, 'hit_ratio@10': 0.6712, 'ndcg@10': 0.6722, 'compress@10': 0.525, 'time@10': 216.0075}:  70%|███████   | 7/10 [12:42<06:12, 124.22s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.1506, 'hit_ratio@10': 0.6719, 'ndcg@10': 0.6546, 'compress@10': 0.5237, 'time@10': 189.1022}:  70%|███████   | 7/10 [12:43<06:12, 124.22s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.1506, 'hit_ratio@10': 0.6719, 'ndcg@10': 0.6546, 'compress@10': 0.5237, 'time@10': 189.1022}:  80%|████████  | 8/10 [12:43<02:49, 84.93s/it] {'epoch': 4, 'num_users': 6.3333, 'loss': 0.1351, 'hit_ratio@10': 0.6829, 'ndcg@10': 0.6898, 'compress@10': 0.5227, 'time@10': 193.6409}:  80%|████████  | 8/10 [14:38<02:49, 84.93s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.1351, 'hit_ratio@10': 0.6829, 'ndcg@10': 0.6898, 'compress@10': 0.5227, 'time@10': 193.6409}:  90%|█████████ | 9/10 [14:38<01:34, 94.34s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.1255, 'hit_ratio@10': 0.7078, 'ndcg@10': 0.7063, 'compress@10': 0.5215, 'time@10': 175.265}:  90%|█████████ | 9/10 [14:47<01:34, 94.34s/it]    {'epoch': 4, 'num_users': 6.3, 'loss': 0.1255, 'hit_ratio@10': 0.7078, 'ndcg@10': 0.7063, 'compress@10': 0.5215, 'time@10': 175.265}: 100%|██████████| 10/10 [14:47<00:00, 68.27s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.1255, 'hit_ratio@10': 0.7078, 'ndcg@10': 0.7063, 'compress@10': 0.5215, 'time@10': 175.265}: 100%|██████████| 10/10 [14:47<00:00, 88.79s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.12554729674503703
Avg hit ratio: 0.7078157348309151
Avg ndcg: 0.7062704318563864
Avg compression ratio: 0.5215292553483474
Avg train time: 175.26496143341063
Std train time: 439.9606175329144
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[1, 1, 1, 1, 1837, 9, 23, 1, 332, 8]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.207, 'hit_ratio@10': 0.5, 'ndcg@10': 0.5433, 'compress@10': 0.5278, 'time@10': 0.8119}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.207, 'hit_ratio@10': 0.5, 'ndcg@10': 0.5433, 'compress@10': 0.5278, 'time@10': 0.8119}:  10%|█         | 1/10 [00:00<00:03,  2.27it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.191, 'hit_ratio@10': 0.4919, 'ndcg@10': 0.5789, 'compress@10': 0.522, 'time@10': 0.7785}:  10%|█         | 1/10 [00:01<00:03,  2.27it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.191, 'hit_ratio@10': 0.4919, 'ndcg@10': 0.5789, 'compress@10': 0.522, 'time@10': 0.7785}:  20%|██        | 2/10 [00:01<00:05,  1.56it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.2593, 'hit_ratio@10': 0.4708, 'ndcg@10': 0.4768, 'compress@10': 0.5384, 'time@10': 0.6227}:  20%|██        | 2/10 [00:01<00:05,  1.56it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.2593, 'hit_ratio@10': 0.4708, 'ndcg@10': 0.4768, 'compress@10': 0.5384, 'time@10': 0.6227}:  30%|███       | 3/10 [00:01<00:03,  2.30it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.2482, 'hit_ratio@10': 0.4735, 'ndcg@10': 0.4947, 'compress@10': 0.5335, 'time@10': 0.6179}:  30%|███       | 3/10 [00:02<00:03,  2.30it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.2482, 'hit_ratio@10': 0.4735, 'ndcg@10': 0.4947, 'compress@10': 0.5335, 'time@10': 0.6179}:  40%|████      | 4/10 [00:02<00:03,  1.94it/s]{'epoch': 5, 'num_users': 5.8, 'loss': 0.1987, 'hit_ratio@10': 0.5748, 'ndcg@10': 0.5918, 'compress@10': 0.5288, 'time@10': 805.5862}:  40%|████      | 4/10 [33:34<00:03,  1.94it/s]{'epoch': 5, 'num_users': 5.8, 'loss': 0.1987, 'hit_ratio@10': 0.5748, 'ndcg@10': 0.5918, 'compress@10': 0.5288, 'time@10': 805.5862}:  50%|█████     | 5/10 [33:34<1:00:30, 726.15s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.1764, 'hit_ratio@10': 0.616, 'ndcg@10': 0.6307, 'compress@10': 0.5258, 'time@10': 672.8146}:  50%|█████     | 5/10 [33:43<1:00:30, 726.15s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.1764, 'hit_ratio@10': 0.616, 'ndcg@10': 0.6307, 'compress@10': 0.5258, 'time@10': 672.8146}:  60%|██████    | 6/10 [33:43<32:09, 482.32s/it]  {'epoch': 5, 'num_users': 6.2857, 'loss': 0.1558, 'hit_ratio@10': 0.6652, 'ndcg@10': 0.6686, 'compress@10': 0.525, 'time@10': 580.2114}:  60%|██████    | 6/10 [33:56<32:09, 482.32s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.1558, 'hit_ratio@10': 0.6652, 'ndcg@10': 0.6686, 'compress@10': 0.525, 'time@10': 580.2114}:  70%|███████   | 7/10 [33:56<16:26, 328.67s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.1574, 'hit_ratio@10': 0.6666, 'ndcg@10': 0.6495, 'compress@10': 0.5237, 'time@10': 507.7756}:  70%|███████   | 7/10 [33:56<16:26, 328.67s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.1574, 'hit_ratio@10': 0.6666, 'ndcg@10': 0.6495, 'compress@10': 0.5237, 'time@10': 507.7756}:  80%|████████  | 8/10 [33:56<07:28, 224.28s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.1402, 'hit_ratio@10': 0.6751, 'ndcg@10': 0.6853, 'compress@10': 0.5227, 'time@10': 507.0697}:  80%|████████  | 8/10 [38:07<07:28, 224.28s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.1402, 'hit_ratio@10': 0.6751, 'ndcg@10': 0.6853, 'compress@10': 0.5227, 'time@10': 507.0697}:  90%|█████████ | 9/10 [38:07<03:52, 232.55s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.13, 'hit_ratio@10': 0.7007, 'ndcg@10': 0.7034, 'compress@10': 0.5215, 'time@10': 457.1118}:  90%|█████████ | 9/10 [38:15<03:52, 232.55s/it]     {'epoch': 5, 'num_users': 6.3, 'loss': 0.13, 'hit_ratio@10': 0.7007, 'ndcg@10': 0.7034, 'compress@10': 0.5215, 'time@10': 457.1118}: 100%|██████████| 10/10 [38:15<00:00, 163.09s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.13, 'hit_ratio@10': 0.7007, 'ndcg@10': 0.7034, 'compress@10': 0.5215, 'time@10': 457.1118}: 100%|██████████| 10/10 [38:15<00:00, 229.52s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.13002869223137897
Avg hit ratio: 0.7007292012927686
Avg ndcg: 0.7033539830119672
Avg compression ratio: 0.5215292553483474
Avg train time: 457.1118121147156
Std train time: 1198.6231970079268
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[1, 1, 1, 1, 5261, 7, 34, 1, 750, 4]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2453, 'hit_ratio@10': 0.5, 'ndcg@10': 0.4553, 'compress@10': 0.5278, 'time@10': 0.7743}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2453, 'hit_ratio@10': 0.5, 'ndcg@10': 0.4553, 'compress@10': 0.5278, 'time@10': 0.7743}:  10%|█         | 1/10 [00:00<00:03,  2.37it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2265, 'hit_ratio@10': 0.4597, 'ndcg@10': 0.4953, 'compress@10': 0.522, 'time@10': 0.7288}:  10%|█         | 1/10 [00:01<00:03,  2.37it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2265, 'hit_ratio@10': 0.4597, 'ndcg@10': 0.4953, 'compress@10': 0.522, 'time@10': 0.7288}:  20%|██        | 2/10 [00:01<00:04,  1.68it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.3002, 'hit_ratio@10': 0.4493, 'ndcg@10': 0.4131, 'compress@10': 0.5384, 'time@10': 0.5865}:  20%|██        | 2/10 [00:01<00:04,  1.68it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.3002, 'hit_ratio@10': 0.4493, 'ndcg@10': 0.4131, 'compress@10': 0.5384, 'time@10': 0.5865}:  30%|███       | 3/10 [00:01<00:02,  2.44it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.2897, 'hit_ratio@10': 0.4666, 'ndcg@10': 0.4264, 'compress@10': 0.5335, 'time@10': 0.5864}:  30%|███       | 3/10 [00:01<00:02,  2.44it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.2897, 'hit_ratio@10': 0.4666, 'ndcg@10': 0.4264, 'compress@10': 0.5335, 'time@10': 0.5864}:  40%|████      | 4/10 [00:01<00:02,  2.03it/s]