  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1496, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5016, 'compress@10': 0.5263, 'time@10': 10.0211}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1496, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5016, 'compress@10': 0.5263, 'time@10': 10.0211}:  10%|█         | 1/10 [00:05<00:45,  5.05s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1081, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.6573, 'compress@10': 0.5212, 'time@10': 8.8236}:  10%|█         | 1/10 [00:12<00:45,  5.05s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.1081, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.6573, 'compress@10': 0.5212, 'time@10': 8.8236}:  20%|██        | 2/10 [00:12<00:52,  6.59s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7584, 'hit_ratio@10': 0.6415, 'ndcg@10': 0.4382, 'compress@10': 0.538, 'time@10': 6.9166}:  20%|██        | 2/10 [00:14<00:52,  6.59s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.7584, 'hit_ratio@10': 0.6415, 'ndcg@10': 0.4382, 'compress@10': 0.538, 'time@10': 6.9166}:  30%|███       | 3/10 [00:14<00:30,  4.31s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5899, 'hit_ratio@10': 0.6865, 'ndcg@10': 0.5064, 'compress@10': 0.5329, 'time@10': 6.8779}:  30%|███       | 3/10 [00:21<00:30,  4.31s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5899, 'hit_ratio@10': 0.6865, 'ndcg@10': 0.5064, 'compress@10': 0.5329, 'time@10': 6.8779}:  40%|████      | 4/10 [00:21<00:31,  5.29s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4904, 'hit_ratio@10': 0.7132, 'ndcg@10': 0.5584, 'compress@10': 0.5283, 'time@10': 10.358}:  40%|████      | 4/10 [00:33<00:31,  5.29s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4904, 'hit_ratio@10': 0.7132, 'ndcg@10': 0.5584, 'compress@10': 0.5283, 'time@10': 10.358}:  50%|█████     | 5/10 [00:33<00:38,  7.78s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4227, 'hit_ratio@10': 0.7054, 'ndcg@10': 0.6009, 'compress@10': 0.5255, 'time@10': 10.4577}:  50%|█████     | 5/10 [00:44<00:38,  7.78s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4227, 'hit_ratio@10': 0.7054, 'ndcg@10': 0.6009, 'compress@10': 0.5255, 'time@10': 10.4577}:  60%|██████    | 6/10 [00:44<00:35,  8.87s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3762, 'hit_ratio@10': 0.7132, 'ndcg@10': 0.6031, 'compress@10': 0.5247, 'time@10': 10.6614}:  60%|██████    | 6/10 [00:50<00:35,  8.87s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3762, 'hit_ratio@10': 0.7132, 'ndcg@10': 0.6031, 'compress@10': 0.5247, 'time@10': 10.6614}:  70%|███████   | 7/10 [00:50<00:23,  7.92s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3347, 'hit_ratio@10': 0.7384, 'ndcg@10': 0.629, 'compress@10': 0.5234, 'time@10': 10.3709}:  70%|███████   | 7/10 [00:58<00:23,  7.92s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.3347, 'hit_ratio@10': 0.7384, 'ndcg@10': 0.629, 'compress@10': 0.5234, 'time@10': 10.3709}:  80%|████████  | 8/10 [00:58<00:16,  8.07s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3023, 'hit_ratio@10': 0.7389, 'ndcg@10': 0.6609, 'compress@10': 0.5224, 'time@10': 11.1374}:  80%|████████  | 8/10 [01:07<00:16,  8.07s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3023, 'hit_ratio@10': 0.7389, 'ndcg@10': 0.6609, 'compress@10': 0.5224, 'time@10': 11.1374}:  90%|█████████ | 9/10 [01:07<00:08,  8.26s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2772, 'hit_ratio@10': 0.7582, 'ndcg@10': 0.6798, 'compress@10': 0.5213, 'time@10': 11.1009}:  90%|█████████ | 9/10 [01:18<00:08,  8.26s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2772, 'hit_ratio@10': 0.7582, 'ndcg@10': 0.6798, 'compress@10': 0.5213, 'time@10': 11.1009}: 100%|██████████| 10/10 [01:18<00:00,  9.05s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2772, 'hit_ratio@10': 0.7582, 'ndcg@10': 0.6798, 'compress@10': 0.5213, 'time@10': 11.1009}: 100%|██████████| 10/10 [01:18<00:00,  7.81s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.2771984539671815
Avg hit ratio: 0.7581625765292997
Avg ndcg: 0.679787809976399
Avg compression ratio: 0.5212749006657823
Avg train time: 11.100864243507385
Std train time: 5.622441358934522
[0.25, 0.25, 0.75, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8426, 'compress@10': 0.2895, 'time@10': 8.4397}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8426, 'compress@10': 0.2895, 'time@10': 8.4397}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0519, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8493, 'compress@10': 0.2818, 'time@10': 7.8496}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0519, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8493, 'compress@10': 0.2818, 'time@10': 7.8496}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.041, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8203, 'compress@10': 0.4498, 'time@10': 6.225}:  20%|██        | 2/10 [00:13<00:48,  6.05s/it]  {'epoch': 1, 'num_users': 5.0, 'loss': 0.041, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8203, 'compress@10': 0.4498, 'time@10': 6.225}:  30%|███       | 3/10 [00:13<00:27,  3.98s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0432, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8259, 'compress@10': 0.4065, 'time@10': 6.2755}:  30%|███       | 3/10 [00:19<00:27,  3.98s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0432, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8259, 'compress@10': 0.4065, 'time@10': 6.2755}:  40%|████      | 4/10 [00:19<00:29,  4.96s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0515, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8183, 'compress@10': 0.3782, 'time@10': 9.7564}:  40%|████      | 4/10 [00:31<00:29,  4.96s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0515, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8183, 'compress@10': 0.3782, 'time@10': 9.7564}:  50%|█████     | 5/10 [00:31<00:37,  7.45s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0558, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8167, 'compress@10': 0.3596, 'time@10': 9.9252}:  50%|█████     | 5/10 [00:42<00:37,  7.45s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0558, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8167, 'compress@10': 0.3596, 'time@10': 9.9252}:  60%|██████    | 6/10 [00:42<00:34,  8.59s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0539, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8227, 'compress@10': 0.3483, 'time@10': 10.1549}:  60%|██████    | 6/10 [00:48<00:34,  8.59s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0539, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8227, 'compress@10': 0.3483, 'time@10': 10.1549}:  70%|███████   | 7/10 [00:48<00:23,  7.68s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.052, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8291, 'compress@10': 0.3387, 'time@10': 9.9276}:  70%|███████   | 7/10 [00:56<00:23,  7.68s/it]   {'epoch': 1, 'num_users': 6.125, 'loss': 0.052, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8291, 'compress@10': 0.3387, 'time@10': 9.9276}:  80%|████████  | 8/10 [00:56<00:15,  7.90s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0501, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8389, 'compress@10': 0.3312, 'time@10': 10.6402}:  80%|████████  | 8/10 [01:04<00:15,  7.90s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0501, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8389, 'compress@10': 0.3312, 'time@10': 10.6402}:  90%|█████████ | 9/10 [01:04<00:07,  8.00s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8393, 'compress@10': 0.3248, 'time@10': 10.5984}:  90%|█████████ | 9/10 [01:14<00:07,  8.00s/it]  {'epoch': 1, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8393, 'compress@10': 0.3248, 'time@10': 10.5984}: 100%|██████████| 10/10 [01:14<00:00,  8.70s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8393, 'compress@10': 0.3248, 'time@10': 10.5984}: 100%|██████████| 10/10 [01:14<00:00,  7.49s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.04973977655704424
Avg hit ratio: 0.8235456554386944
Avg ndcg: 0.8393211526608632
Avg compression ratio: 0.32477201145983037
Avg train time: 10.598392748832703
Std train time: 5.491655653263355
[0.16666666666666669, 0.16666666666666669, 0.5, 0.16666666666666669, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.2105, 'time@10': 7.8615}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.2105, 'time@10': 7.8615}:  10%|█         | 1/10 [00:03<00:35,  3.97s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8515, 'compress@10': 0.202, 'time@10': 7.3895}:  10%|█         | 1/10 [00:10<00:35,  3.97s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8515, 'compress@10': 0.202, 'time@10': 7.3895}:  20%|██        | 2/10 [00:10<00:45,  5.72s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8534, 'compress@10': 0.3252, 'time@10': 5.9293}:  20%|██        | 2/10 [00:12<00:45,  5.72s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8534, 'compress@10': 0.3252, 'time@10': 5.9293}:  30%|███       | 3/10 [00:12<00:26,  3.81s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8519, 'compress@10': 0.293, 'time@10': 5.9383}:  30%|███       | 3/10 [00:18<00:26,  3.81s/it]  {'epoch': 2, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8519, 'compress@10': 0.293, 'time@10': 5.9383}:  40%|████      | 4/10 [00:18<00:28,  4.68s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0467, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.8396, 'compress@10': 0.3364, 'time@10': 9.7272}:  40%|████      | 4/10 [00:30<00:28,  4.68s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0467, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.8396, 'compress@10': 0.3364, 'time@10': 9.7272}:  50%|█████     | 5/10 [00:30<00:37,  7.49s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0513, 'hit_ratio@10': 0.7706, 'ndcg@10': 0.8364, 'compress@10': 0.3112, 'time@10': 9.8235}:  50%|█████     | 5/10 [00:41<00:37,  7.49s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0513, 'hit_ratio@10': 0.7706, 'ndcg@10': 0.8364, 'compress@10': 0.3112, 'time@10': 9.8235}:  60%|██████    | 6/10 [00:41<00:33,  8.46s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.7976, 'ndcg@10': 0.8367, 'compress@10': 0.2953, 'time@10': 10.0319}:  60%|██████    | 6/10 [00:46<00:33,  8.46s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.7976, 'ndcg@10': 0.8367, 'compress@10': 0.2953, 'time@10': 10.0319}:  70%|███████   | 7/10 [00:46<00:22,  7.55s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8419, 'compress@10': 0.2822, 'time@10': 9.8214}:  70%|███████   | 7/10 [00:55<00:22,  7.55s/it]  {'epoch': 2, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8419, 'compress@10': 0.2822, 'time@10': 9.8214}:  80%|████████  | 8/10 [00:55<00:15,  7.82s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0528, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.845, 'compress@10': 0.272, 'time@10': 10.4799}:  80%|████████  | 8/10 [01:03<00:15,  7.82s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0528, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.845, 'compress@10': 0.272, 'time@10': 10.4799}:  90%|█████████ | 9/10 [01:03<00:07,  7.85s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.052, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8455, 'compress@10': 0.2634, 'time@10': 10.431}:  90%|█████████ | 9/10 [01:13<00:07,  7.85s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.052, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8455, 'compress@10': 0.2634, 'time@10': 10.431}: 100%|██████████| 10/10 [01:13<00:00,  8.52s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.052, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8455, 'compress@10': 0.2634, 'time@10': 10.431}: 100%|██████████| 10/10 [01:13<00:00,  7.33s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.05200501618388439
Avg hit ratio: 0.8172469541399933
Avg ndcg: 0.8454882251952727
Avg compression ratio: 0.26337560737471233
Avg train time: 10.430964827537537
Std train time: 5.799840943802807
[0.125, 0.125, 0.375, 0.125, 0.625, 0.125, 0.125, 0.125, 0.125, 0.125]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.853, 'compress@10': 0.1711, 'time@10': 8.1044}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.853, 'compress@10': 0.1711, 'time@10': 8.1044}:  10%|█         | 1/10 [00:04<00:36,  4.09s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8618, 'compress@10': 0.1621, 'time@10': 7.5502}:  10%|█         | 1/10 [00:11<00:36,  4.09s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8618, 'compress@10': 0.1621, 'time@10': 7.5502}:  20%|██        | 2/10 [00:11<00:46,  5.82s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8581, 'compress@10': 0.2629, 'time@10': 6.0804}:  20%|██        | 2/10 [00:12<00:46,  5.82s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8581, 'compress@10': 0.2629, 'time@10': 6.0804}:  30%|███       | 3/10 [00:12<00:27,  3.90s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8563, 'compress@10': 0.2362, 'time@10': 6.0417}:  30%|███       | 3/10 [00:18<00:27,  3.90s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8563, 'compress@10': 0.2362, 'time@10': 6.0417}:  40%|████      | 4/10 [00:18<00:28,  4.71s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8451, 'compress@10': 0.3155, 'time@10': 9.7674}:  40%|████      | 4/10 [00:31<00:28,  4.71s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8451, 'compress@10': 0.3155, 'time@10': 9.7674}:  50%|█████     | 5/10 [00:31<00:37,  7.48s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0493, 'hit_ratio@10': 0.8051, 'ndcg@10': 0.8417, 'compress@10': 0.287, 'time@10': 9.8462}:  50%|█████     | 5/10 [00:41<00:37,  7.48s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0493, 'hit_ratio@10': 0.8051, 'ndcg@10': 0.8417, 'compress@10': 0.287, 'time@10': 9.8462}:  60%|██████    | 6/10 [00:41<00:33,  8.43s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8404, 'compress@10': 0.2688, 'time@10': 9.9524}:  60%|██████    | 6/10 [00:46<00:33,  8.43s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8404, 'compress@10': 0.2688, 'time@10': 9.9524}:  70%|███████   | 7/10 [00:46<00:22,  7.42s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.052, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8511, 'compress@10': 0.254, 'time@10': 9.7188}:  70%|███████   | 7/10 [00:54<00:22,  7.42s/it]   {'epoch': 3, 'num_users': 6.125, 'loss': 0.052, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8511, 'compress@10': 0.254, 'time@10': 9.7188}:  80%|████████  | 8/10 [00:54<00:15,  7.64s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0551, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8463, 'compress@10': 0.2424, 'time@10': 10.4212}:  80%|████████  | 8/10 [01:02<00:15,  7.64s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0551, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8463, 'compress@10': 0.2424, 'time@10': 10.4212}:  90%|█████████ | 9/10 [01:02<00:07,  7.77s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0545, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8456, 'compress@10': 0.2327, 'time@10': 10.3855}:  90%|█████████ | 9/10 [01:12<00:07,  7.77s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0545, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8456, 'compress@10': 0.2327, 'time@10': 10.3855}: 100%|██████████| 10/10 [01:12<00:00,  8.49s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0545, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8456, 'compress@10': 0.2327, 'time@10': 10.3855}: 100%|██████████| 10/10 [01:12<00:00,  7.30s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.054463247583405684
Avg hit ratio: 0.8408414241860761
Avg ndcg: 0.8456080703097395
Avg compression ratio: 0.2326633929797514
Avg train time: 10.38546974658966
Std train time: 5.749481767501343
[0.1, 0.1, 0.3, 0.1, 0.5, 0.1, 0.1, 0.1, 0.3, 0.1]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.1474, 'time@10': 8.1631}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0482, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.1474, 'time@10': 8.1631}:  10%|█         | 1/10 [00:04<00:37,  4.12s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8648, 'compress@10': 0.1382, 'time@10': 7.5492}:  10%|█         | 1/10 [00:11<00:37,  4.12s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8648, 'compress@10': 0.1382, 'time@10': 7.5492}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8601, 'compress@10': 0.2255, 'time@10': 6.007}:  20%|██        | 2/10 [00:12<00:46,  5.80s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8601, 'compress@10': 0.2255, 'time@10': 6.007}:  30%|███       | 3/10 [00:12<00:26,  3.84s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0402, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8664, 'compress@10': 0.2021, 'time@10': 5.9949}:  30%|███       | 3/10 [00:18<00:26,  3.84s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0402, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8664, 'compress@10': 0.2021, 'time@10': 5.9949}:  40%|████      | 4/10 [00:18<00:28,  4.69s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0462, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8553, 'compress@10': 0.2637, 'time@10': 9.7592}:  40%|████      | 4/10 [00:31<00:28,  4.69s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0462, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8553, 'compress@10': 0.2637, 'time@10': 9.7592}:  50%|█████     | 5/10 [00:31<00:37,  7.49s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0493, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8512, 'compress@10': 0.2398, 'time@10': 9.8402}:  50%|█████     | 5/10 [00:41<00:37,  7.49s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0493, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8512, 'compress@10': 0.2398, 'time@10': 9.8402}:  60%|██████    | 6/10 [00:41<00:33,  8.44s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0488, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8523, 'compress@10': 0.2249, 'time@10': 9.9413}:  60%|██████    | 6/10 [00:46<00:33,  8.44s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0488, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8523, 'compress@10': 0.2249, 'time@10': 9.9413}:  70%|███████   | 7/10 [00:46<00:22,  7.42s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0502, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8604, 'compress@10': 0.2125, 'time@10': 9.7095}:  70%|███████   | 7/10 [00:54<00:22,  7.42s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0502, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8604, 'compress@10': 0.2125, 'time@10': 9.7095}:  80%|████████  | 8/10 [00:54<00:15,  7.64s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8792, 'compress@10': 0.2245, 'time@10': 10.5215}:  80%|████████  | 8/10 [01:03<00:15,  7.64s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8792, 'compress@10': 0.2245, 'time@10': 10.5215}:  90%|█████████ | 9/10 [01:03<00:07,  7.92s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8774, 'compress@10': 0.2141, 'time@10': 10.469}:  90%|█████████ | 9/10 [01:13<00:07,  7.92s/it]    {'epoch': 4, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8774, 'compress@10': 0.2141, 'time@10': 10.469}: 100%|██████████| 10/10 [01:13<00:00,  8.58s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8774, 'compress@10': 0.2141, 'time@10': 10.469}: 100%|██████████| 10/10 [01:13<00:00,  7.33s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04973508798134072
Avg hit ratio: 0.8505874559321078
Avg ndcg: 0.8774079079352861
Avg compression ratio: 0.2140786729121579
Avg train time: 10.46895399093628
Std train time: 5.914222063739468
[0.08333333333333334, 0.08333333333333334, 0.25, 0.08333333333333334, 0.5833333333333334, 0.08333333333333334, 0.08333333333333334, 0.08333333333333334, 0.25, 0.08333333333333334]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8436, 'compress@10': 0.1316, 'time@10': 8.0925}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8436, 'compress@10': 0.1316, 'time@10': 8.0925}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8419, 'compress@10': 0.1223, 'time@10': 7.4172}:  10%|█         | 1/10 [00:10<00:36,  4.08s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8419, 'compress@10': 0.1223, 'time@10': 7.4172}:  20%|██        | 2/10 [00:10<00:45,  5.67s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8448, 'compress@10': 0.2005, 'time@10': 5.9254}:  20%|██        | 2/10 [00:12<00:45,  5.67s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8448, 'compress@10': 0.2005, 'time@10': 5.9254}:  30%|███       | 3/10 [00:12<00:26,  3.77s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0411, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8471, 'compress@10': 0.1794, 'time@10': 5.9223}:  30%|███       | 3/10 [00:18<00:26,  3.77s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0411, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8471, 'compress@10': 0.1794, 'time@10': 5.9223}:  40%|████      | 4/10 [00:18<00:27,  4.63s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.8397, 'compress@10': 0.2619, 'time@10': 9.7001}:  40%|████      | 4/10 [00:30<00:27,  4.63s/it] {'epoch': 5, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.8255, 'ndcg@10': 0.8397, 'compress@10': 0.2619, 'time@10': 9.7001}:  50%|█████     | 5/10 [00:30<00:37,  7.45s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.8387, 'compress@10': 0.2355, 'time@10': 9.7673}:  50%|█████     | 5/10 [00:40<00:37,  7.45s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.8387, 'compress@10': 0.2355, 'time@10': 9.7673}:  60%|██████    | 6/10 [00:40<00:33,  8.36s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0484, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8457, 'compress@10': 0.219, 'time@10': 9.8436}:  60%|██████    | 6/10 [00:46<00:33,  8.36s/it] {'epoch': 5, 'num_users': 6.2857, 'loss': 0.0484, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8457, 'compress@10': 0.219, 'time@10': 9.8436}:  70%|███████   | 7/10 [00:46<00:21,  7.32s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0494, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8503, 'compress@10': 0.2053, 'time@10': 9.6227}:  70%|███████   | 7/10 [00:54<00:21,  7.32s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0494, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8503, 'compress@10': 0.2053, 'time@10': 9.6227}:  80%|████████  | 8/10 [00:54<00:15,  7.58s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0537, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8562, 'compress@10': 0.2127, 'time@10': 10.4331}:  80%|████████  | 8/10 [01:02<00:15,  7.58s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0537, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8562, 'compress@10': 0.2127, 'time@10': 10.4331}:  90%|█████████ | 9/10 [01:02<00:07,  7.87s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.053, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.854, 'compress@10': 0.2018, 'time@10': 10.3852}:  90%|█████████ | 9/10 [01:12<00:07,  7.87s/it]     {'epoch': 5, 'num_users': 6.3, 'loss': 0.053, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.854, 'compress@10': 0.2018, 'time@10': 10.3852}: 100%|██████████| 10/10 [01:12<00:00,  8.52s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.053, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.854, 'compress@10': 0.2018, 'time@10': 10.3852}: 100%|██████████| 10/10 [01:12<00:00,  7.27s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.05300882132345208
Avg hit ratio: 0.8531783417488003
Avg ndcg: 0.8540198822057453
Avg compression ratio: 0.20182609370407198
Avg train time: 10.385240292549133
Std train time: 5.9185805930782
[0.07142857142857144, 0.07142857142857144, 0.2142857142857143, 0.07142857142857144, 0.5, 0.07142857142857144, 0.07142857142857144, 0.07142857142857144, 0.35714285714285715, 0.07142857142857144]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8673, 'compress@10': 0.1203, 'time@10': 8.1434}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8673, 'compress@10': 0.1203, 'time@10': 8.1434}:  10%|█         | 1/10 [00:04<00:36,  4.11s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0446, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8608, 'compress@10': 0.1109, 'time@10': 7.4202}:  10%|█         | 1/10 [00:10<00:36,  4.11s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0446, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8608, 'compress@10': 0.1109, 'time@10': 7.4202}:  20%|██        | 2/10 [00:10<00:45,  5.65s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8574, 'compress@10': 0.1827, 'time@10': 5.8683}:  20%|██        | 2/10 [00:12<00:45,  5.65s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8574, 'compress@10': 0.1827, 'time@10': 5.8683}:  30%|███       | 3/10 [00:12<00:26,  3.72s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0393, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8496, 'compress@10': 0.1632, 'time@10': 5.864}:  30%|███       | 3/10 [00:18<00:26,  3.72s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0393, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8496, 'compress@10': 0.1632, 'time@10': 5.864}:  40%|████      | 4/10 [00:18<00:27,  4.58s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0437, 'hit_ratio@10': 0.7905, 'ndcg@10': 0.8422, 'compress@10': 0.2326, 'time@10': 9.714}:  40%|████      | 4/10 [00:30<00:27,  4.58s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0437, 'hit_ratio@10': 0.7905, 'ndcg@10': 0.8422, 'compress@10': 0.2326, 'time@10': 9.714}:  50%|█████     | 5/10 [00:30<00:37,  7.47s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0457, 'hit_ratio@10': 0.8032, 'ndcg@10': 0.841, 'compress@10': 0.2092, 'time@10': 9.6811}:  50%|█████     | 5/10 [00:40<00:37,  7.47s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0457, 'hit_ratio@10': 0.8032, 'ndcg@10': 0.841, 'compress@10': 0.2092, 'time@10': 9.6811}:  60%|██████    | 6/10 [00:40<00:32,  8.18s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0453, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.846, 'compress@10': 0.1948, 'time@10': 9.759}:  60%|██████    | 6/10 [00:45<00:32,  8.18s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.0453, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.846, 'compress@10': 0.1948, 'time@10': 9.759}:  70%|███████   | 7/10 [00:45<00:21,  7.19s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0462, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8489, 'compress@10': 0.1827, 'time@10': 9.5598}:  70%|███████   | 7/10 [00:53<00:21,  7.19s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0462, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8489, 'compress@10': 0.1827, 'time@10': 9.5598}:  80%|████████  | 8/10 [00:53<00:15,  7.51s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0503, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8647, 'compress@10': 0.2041, 'time@10': 10.3683}:  80%|████████  | 8/10 [01:02<00:15,  7.51s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0503, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8647, 'compress@10': 0.2041, 'time@10': 10.3683}:  90%|█████████ | 9/10 [01:02<00:07,  7.81s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8649, 'compress@10': 0.193, 'time@10': 10.3115}:  90%|█████████ | 9/10 [01:11<00:07,  7.81s/it]    {'epoch': 6, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8649, 'compress@10': 0.193, 'time@10': 10.3115}: 100%|██████████| 10/10 [01:11<00:00,  8.43s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0491, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8649, 'compress@10': 0.193, 'time@10': 10.3115}: 100%|██████████| 10/10 [01:11<00:00,  7.20s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04913712733477556
Avg hit ratio: 0.839666821011473
Avg ndcg: 0.8648688388651505
Avg compression ratio: 0.1929543624402988
Avg train time: 10.311477875709533
Std train time: 6.014996318541798
[0.06250000000000001, 0.06250000000000001, 0.1875, 0.06250000000000001, 0.4375, 0.06250000000000001, 0.06250000000000001, 0.06250000000000001, 0.4375, 0.06250000000000001]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8318, 'compress@10': 0.1118, 'time@10': 8.1776}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8318, 'compress@10': 0.1118, 'time@10': 8.1776}:  10%|█         | 1/10 [00:04<00:37,  4.13s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.842, 'compress@10': 0.1023, 'time@10': 7.4706}:  10%|█         | 1/10 [00:10<00:37,  4.13s/it]  {'epoch': 7, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.842, 'compress@10': 0.1023, 'time@10': 7.4706}:  20%|██        | 2/10 [00:10<00:45,  5.70s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8449, 'compress@10': 0.1694, 'time@10': 5.8351}:  20%|██        | 2/10 [00:12<00:45,  5.70s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8449, 'compress@10': 0.1694, 'time@10': 5.8351}:  30%|███       | 3/10 [00:12<00:25,  3.70s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.7943, 'ndcg@10': 0.8376, 'compress@10': 0.151, 'time@10': 5.8795}:  30%|███       | 3/10 [00:18<00:25,  3.70s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0386, 'hit_ratio@10': 0.7943, 'ndcg@10': 0.8376, 'compress@10': 0.151, 'time@10': 5.8795}:  40%|████      | 4/10 [00:18<00:27,  4.63s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0422, 'hit_ratio@10': 0.8115, 'ndcg@10': 0.8348, 'compress@10': 0.2106, 'time@10': 9.6191}:  40%|████      | 4/10 [00:30<00:27,  4.63s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0422, 'hit_ratio@10': 0.8115, 'ndcg@10': 0.8348, 'compress@10': 0.2106, 'time@10': 9.6191}:  50%|█████     | 5/10 [00:30<00:37,  7.41s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0435, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.8353, 'compress@10': 0.1894, 'time@10': 9.5752}:  50%|█████     | 5/10 [00:40<00:37,  7.41s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0435, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.8353, 'compress@10': 0.1894, 'time@10': 9.5752}:  60%|██████    | 6/10 [00:40<00:32,  8.08s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0427, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8356, 'compress@10': 0.1766, 'time@10': 9.6884}:  60%|██████    | 6/10 [00:45<00:32,  8.08s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0427, 'hit_ratio@10': 0.8437, 'ndcg@10': 0.8356, 'compress@10': 0.1766, 'time@10': 9.6884}:  70%|███████   | 7/10 [00:45<00:21,  7.15s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0425, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8353, 'compress@10': 0.1657, 'time@10': 9.4879}:  70%|███████   | 7/10 [00:53<00:21,  7.15s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0425, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8353, 'compress@10': 0.1657, 'time@10': 9.4879}:  80%|████████  | 8/10 [00:53<00:14,  7.46s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0443, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8559, 'compress@10': 0.1977, 'time@10': 10.3393}:  80%|████████  | 8/10 [01:01<00:14,  7.46s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0443, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8559, 'compress@10': 0.1977, 'time@10': 10.3393}:  90%|█████████ | 9/10 [01:01<00:07,  7.82s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0433, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8591, 'compress@10': 0.1863, 'time@10': 10.2831}:  90%|█████████ | 9/10 [01:11<00:07,  7.82s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0433, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8591, 'compress@10': 0.1863, 'time@10': 10.2831}: 100%|██████████| 10/10 [01:11<00:00,  8.44s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0433, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8591, 'compress@10': 0.1863, 'time@10': 10.2831}: 100%|██████████| 10/10 [01:11<00:00,  7.18s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04331702968071159
Avg hit ratio: 0.8552351504371878
Avg ndcg: 0.8590756892384785
Avg compression ratio: 0.18628765140893322
Avg train time: 10.28308708667755
Std train time: 5.933789721921108
[0.055555555555555566, 0.055555555555555566, 0.16666666666666666, 0.055555555555555566, 0.3888888888888889, 0.055555555555555566, 0.055555555555555566, 0.055555555555555566, 0.5, 0.055555555555555566]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.851, 'compress@10': 0.1053, 'time@10': 7.9898}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.851, 'compress@10': 0.1053, 'time@10': 7.9898}:  10%|█         | 1/10 [00:04<00:36,  4.03s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8592, 'compress@10': 0.0957, 'time@10': 7.3807}:  10%|█         | 1/10 [00:10<00:36,  4.03s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8592, 'compress@10': 0.0957, 'time@10': 7.3807}:  20%|██        | 2/10 [00:10<00:45,  5.67s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8563, 'compress@10': 0.159, 'time@10': 5.7971}:  20%|██        | 2/10 [00:12<00:45,  5.67s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8563, 'compress@10': 0.159, 'time@10': 5.7971}:  30%|███       | 3/10 [00:12<00:25,  3.70s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8516, 'compress@10': 0.1416, 'time@10': 5.8333}:  30%|███       | 3/10 [00:18<00:25,  3.70s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0343, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8516, 'compress@10': 0.1416, 'time@10': 5.8333}:  40%|████      | 4/10 [00:18<00:27,  4.60s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.038, 'hit_ratio@10': 0.7945, 'ndcg@10': 0.8486, 'compress@10': 0.1935, 'time@10': 9.5034}:  40%|████      | 4/10 [00:30<00:27,  4.60s/it] {'epoch': 8, 'num_users': 5.8, 'loss': 0.038, 'hit_ratio@10': 0.7945, 'ndcg@10': 0.8486, 'compress@10': 0.1935, 'time@10': 9.5034}:  50%|█████     | 5/10 [00:30<00:36,  7.32s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0393, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.8488, 'compress@10': 0.174, 'time@10': 9.5017}:  50%|█████     | 5/10 [00:39<00:36,  7.32s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0393, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.8488, 'compress@10': 0.174, 'time@10': 9.5017}:  60%|██████    | 6/10 [00:39<00:32,  8.07s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0397, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8555, 'compress@10': 0.1625, 'time@10': 9.6235}:  60%|██████    | 6/10 [00:45<00:32,  8.07s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0397, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8555, 'compress@10': 0.1625, 'time@10': 9.6235}:  70%|███████   | 7/10 [00:45<00:21,  7.14s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0385, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8587, 'compress@10': 0.1525, 'time@10': 9.431}:  70%|███████   | 7/10 [00:53<00:21,  7.14s/it]  {'epoch': 8, 'num_users': 6.125, 'loss': 0.0385, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.8587, 'compress@10': 0.1525, 'time@10': 9.431}:  80%|████████  | 8/10 [00:53<00:14,  7.45s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0398, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8536, 'compress@10': 0.1927, 'time@10': 10.3158}:  80%|████████  | 8/10 [01:01<00:14,  7.45s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0398, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8536, 'compress@10': 0.1927, 'time@10': 10.3158}:  90%|█████████ | 9/10 [01:01<00:07,  7.85s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0398, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8527, 'compress@10': 0.1811, 'time@10': 10.2596}:  90%|█████████ | 9/10 [01:11<00:07,  7.85s/it]  {'epoch': 8, 'num_users': 6.3, 'loss': 0.0398, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8527, 'compress@10': 0.1811, 'time@10': 10.2596}: 100%|██████████| 10/10 [01:11<00:00,  8.45s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0398, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8527, 'compress@10': 0.1811, 'time@10': 10.2596}: 100%|██████████| 10/10 [01:11<00:00,  7.17s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.0398004383084695
Avg hit ratio: 0.8456033289479808
Avg ndcg: 0.8527448620657558
Avg compression ratio: 0.18111875263586383
Avg train time: 10.259624361991882
Std train time: 5.8697299495596535
[0.05000000000000001, 0.05000000000000001, 0.15, 0.05000000000000001, 0.45, 0.05000000000000001, 0.05000000000000001, 0.05000000000000001, 0.45, 0.05000000000000001]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.851, 'compress@10': 0.1, 'time@10': 7.8476}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.851, 'compress@10': 0.1, 'time@10': 7.8476}:  10%|█         | 1/10 [00:03<00:35,  3.96s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8639, 'compress@10': 0.0903, 'time@10': 7.2215}:  10%|█         | 1/10 [00:10<00:35,  3.96s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8639, 'compress@10': 0.0903, 'time@10': 7.2215}:  20%|██        | 2/10 [00:10<00:44,  5.53s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8595, 'compress@10': 0.1507, 'time@10': 5.6924}:  20%|██        | 2/10 [00:11<00:44,  5.53s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8595, 'compress@10': 0.1507, 'time@10': 5.6924}:  30%|███       | 3/10 [00:11<00:25,  3.62s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8572, 'compress@10': 0.134, 'time@10': 5.7587}:  30%|███       | 3/10 [00:17<00:25,  3.62s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8572, 'compress@10': 0.134, 'time@10': 5.7587}:  40%|████      | 4/10 [00:17<00:27,  4.56s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.036, 'hit_ratio@10': 0.7985, 'ndcg@10': 0.8564, 'compress@10': 0.1994, 'time@10': 9.6019}:  40%|████      | 4/10 [00:30<00:27,  4.56s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.036, 'hit_ratio@10': 0.7985, 'ndcg@10': 0.8564, 'compress@10': 0.1994, 'time@10': 9.6019}:  50%|█████     | 5/10 [00:30<00:37,  7.43s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0372, 'hit_ratio@10': 0.8136, 'ndcg@10': 0.8559, 'compress@10': 0.178, 'time@10': 9.582}:  50%|█████     | 5/10 [00:39<00:37,  7.43s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0372, 'hit_ratio@10': 0.8136, 'ndcg@10': 0.8559, 'compress@10': 0.178, 'time@10': 9.582}:  60%|██████    | 6/10 [00:39<00:32,  8.14s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0374, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8587, 'compress@10': 0.1652, 'time@10': 9.7267}:  60%|██████    | 6/10 [00:45<00:32,  8.14s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0374, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8587, 'compress@10': 0.1652, 'time@10': 9.7267}:  70%|███████   | 7/10 [00:45<00:21,  7.23s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0362, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.864, 'compress@10': 0.1542, 'time@10': 9.5007}:  70%|███████   | 7/10 [00:53<00:21,  7.23s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0362, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.864, 'compress@10': 0.1542, 'time@10': 9.5007}:  80%|████████  | 8/10 [00:53<00:14,  7.48s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0358, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8727, 'compress@10': 0.1888, 'time@10': 10.3605}:  80%|████████  | 8/10 [01:02<00:14,  7.48s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0358, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8727, 'compress@10': 0.1888, 'time@10': 10.3605}:  90%|█████████ | 9/10 [01:02<00:07,  7.85s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0344, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8764, 'compress@10': 0.1771, 'time@10': 10.3106}:  90%|█████████ | 9/10 [01:11<00:07,  7.85s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0344, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8764, 'compress@10': 0.1771, 'time@10': 10.3106}: 100%|██████████| 10/10 [01:11<00:00,  8.48s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0344, 'hit_ratio@10': 0.8504, 'ndcg@10': 0.8764, 'compress@10': 0.1771, 'time@10': 10.3106}: 100%|██████████| 10/10 [01:11<00:00,  7.19s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03444532676021824
Avg hit ratio: 0.8504344977791497
Avg ndcg: 0.8764059145474554
Avg compression ratio: 0.17706370441916247
Avg train time: 10.310578465461731
Std train time: 6.061963992113039
[0.04545454545454546, 0.04545454545454546, 0.13636363636363635, 0.04545454545454546, 0.5, 0.04545454545454546, 0.04545454545454546, 0.04545454545454546, 0.4090909090909091, 0.04545454545454546]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.851, 'compress@10': 0.0957, 'time@10': 8.2709}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.851, 'compress@10': 0.0957, 'time@10': 8.2709}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.04, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8639, 'compress@10': 0.086, 'time@10': 7.5268}:  10%|█         | 1/10 [00:10<00:37,  4.17s/it]  {'epoch': 10, 'num_users': 7.0, 'loss': 0.04, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8639, 'compress@10': 0.086, 'time@10': 7.5268}:  20%|██        | 2/10 [00:10<00:45,  5.73s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8595, 'compress@10': 0.1439, 'time@10': 5.899}:  20%|██        | 2/10 [00:12<00:45,  5.73s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8595, 'compress@10': 0.1439, 'time@10': 5.899}:  30%|███       | 3/10 [00:12<00:26,  3.73s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8611, 'compress@10': 0.1278, 'time@10': 5.9181}:  30%|███       | 3/10 [00:18<00:26,  3.73s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8611, 'compress@10': 0.1278, 'time@10': 5.9181}:  40%|████      | 4/10 [00:18<00:27,  4.63s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.034, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.8603, 'compress@10': 0.2043, 'time@10': 9.7063}:  40%|████      | 4/10 [00:30<00:27,  4.63s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.034, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.8603, 'compress@10': 0.2043, 'time@10': 9.7063}:  50%|█████     | 5/10 [00:30<00:37,  7.46s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0353, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8611, 'compress@10': 0.1813, 'time@10': 9.677}:  50%|█████     | 5/10 [00:40<00:37,  7.46s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0353, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8611, 'compress@10': 0.1813, 'time@10': 9.677}:  60%|██████    | 6/10 [00:40<00:32,  8.18s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.035, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8655, 'compress@10': 0.1674, 'time@10': 9.8354}:  60%|██████    | 6/10 [00:45<00:32,  8.18s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.035, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8655, 'compress@10': 0.1674, 'time@10': 9.8354}:  70%|███████   | 7/10 [00:45<00:21,  7.28s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0343, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8682, 'compress@10': 0.1555, 'time@10': 9.5901}:  70%|███████   | 7/10 [00:53<00:21,  7.28s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0343, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8682, 'compress@10': 0.1555, 'time@10': 9.5901}:  80%|████████  | 8/10 [00:53<00:14,  7.48s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0335, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8735, 'compress@10': 0.1856, 'time@10': 10.4097}:  80%|████████  | 8/10 [01:02<00:14,  7.48s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0335, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8735, 'compress@10': 0.1856, 'time@10': 10.4097}:  90%|█████████ | 9/10 [01:02<00:07,  7.81s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0343, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8744, 'compress@10': 0.1737, 'time@10': 10.3455}:  90%|█████████ | 9/10 [01:12<00:07,  7.81s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0343, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8744, 'compress@10': 0.1737, 'time@10': 10.3455}: 100%|██████████| 10/10 [01:12<00:00,  8.43s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0343, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8744, 'compress@10': 0.1737, 'time@10': 10.3455}: 100%|██████████| 10/10 [01:12<00:00,  7.21s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03432722095132586
Avg hit ratio: 0.8553205006651525
Avg ndcg: 0.8744445780989052
Avg compression ratio: 0.1737460185468414
Avg train time: 10.345482206344604
Std train time: 5.976533624687981
[0.04166666666666667, 0.04166666666666667, 0.12499999999999999, 0.04166666666666667, 0.5416666666666666, 0.04166666666666667, 0.04166666666666667, 0.04166666666666667, 0.375, 0.04166666666666667]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0415, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8521, 'compress@10': 0.0921, 'time@10': 8.0949}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0415, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8521, 'compress@10': 0.0921, 'time@10': 8.0949}:  10%|█         | 1/10 [00:04<00:36,  4.09s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8663, 'compress@10': 0.0824, 'time@10': 7.4339}:  10%|█         | 1/10 [00:10<00:36,  4.09s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8663, 'compress@10': 0.0824, 'time@10': 7.4339}:  20%|██        | 2/10 [00:10<00:45,  5.69s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8611, 'compress@10': 0.1382, 'time@10': 5.8589}:  20%|██        | 2/10 [00:12<00:45,  5.69s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8611, 'compress@10': 0.1382, 'time@10': 5.8589}:  30%|███       | 3/10 [00:12<00:26,  3.73s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8682, 'compress@10': 0.1227, 'time@10': 5.9224}:  30%|███       | 3/10 [00:18<00:26,  3.73s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8682, 'compress@10': 0.1227, 'time@10': 5.9224}:  40%|████      | 4/10 [00:18<00:28,  4.68s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.8685, 'compress@10': 0.2083, 'time@10': 9.6168}:  40%|████      | 4/10 [00:30<00:28,  4.68s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.8096, 'ndcg@10': 0.8685, 'compress@10': 0.2083, 'time@10': 9.6168}:  50%|█████     | 5/10 [00:30<00:37,  7.41s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8703, 'compress@10': 0.1841, 'time@10': 9.6052}:  50%|█████     | 5/10 [00:40<00:37,  7.41s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0324, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8703, 'compress@10': 0.1841, 'time@10': 9.6052}:  60%|██████    | 6/10 [00:40<00:32,  8.15s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0325, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8735, 'compress@10': 0.1692, 'time@10': 9.7445}:  60%|██████    | 6/10 [00:45<00:32,  8.15s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0325, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8735, 'compress@10': 0.1692, 'time@10': 9.7445}:  70%|███████   | 7/10 [00:45<00:21,  7.23s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0319, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8729, 'compress@10': 0.1567, 'time@10': 9.5147}:  70%|███████   | 7/10 [00:53<00:21,  7.23s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0319, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8729, 'compress@10': 0.1567, 'time@10': 9.5147}:  80%|████████  | 8/10 [00:53<00:14,  7.45s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8803, 'compress@10': 0.1829, 'time@10': 10.3618}:  80%|████████  | 8/10 [01:02<00:14,  7.45s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8803, 'compress@10': 0.1829, 'time@10': 10.3618}:  90%|█████████ | 9/10 [01:02<00:07,  7.98s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8823, 'compress@10': 0.171, 'time@10': 10.3048}:  90%|█████████ | 9/10 [01:12<00:07,  7.98s/it]    {'epoch': 11, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8823, 'compress@10': 0.171, 'time@10': 10.3048}: 100%|██████████| 10/10 [01:12<00:00,  8.55s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0312, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.8823, 'compress@10': 0.171, 'time@10': 10.3048}: 100%|██████████| 10/10 [01:12<00:00,  7.25s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03119543780011173
Avg hit ratio: 0.8604503707950227
Avg ndcg: 0.8823217894479513
Avg compression ratio: 0.1709800897549453
Avg train time: 10.304790782928468
Std train time: 5.869423733731529
[0.038461538461538464, 0.038461538461538464, 0.11538461538461538, 0.11538461538461539, 0.49999999999999994, 0.038461538461538464, 0.038461538461538464, 0.038461538461538464, 0.34615384615384615, 0.038461538461538464]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8654, 'compress@10': 0.0891, 'time@10': 8.2044}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8654, 'compress@10': 0.0891, 'time@10': 8.2044}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.876, 'compress@10': 0.0793, 'time@10': 7.4667}:  10%|█         | 1/10 [00:10<00:37,  4.15s/it] {'epoch': 12, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.876, 'compress@10': 0.0793, 'time@10': 7.4667}:  20%|██        | 2/10 [00:10<00:45,  5.69s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8676, 'compress@10': 0.1334, 'time@10': 5.8879}:  20%|██        | 2/10 [00:12<00:45,  5.69s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8676, 'compress@10': 0.1334, 'time@10': 5.8879}:  30%|███       | 3/10 [00:12<00:26,  3.73s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8751, 'compress@10': 0.1368, 'time@10': 5.9712}:  30%|███       | 3/10 [00:18<00:26,  3.73s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8751, 'compress@10': 0.1368, 'time@10': 5.9712}:  40%|████      | 4/10 [00:18<00:28,  4.73s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.03, 'hit_ratio@10': 0.8136, 'ndcg@10': 0.8757, 'compress@10': 0.2115, 'time@10': 9.7713}:  40%|████      | 4/10 [00:31<00:28,  4.73s/it] {'epoch': 12, 'num_users': 5.8, 'loss': 0.03, 'hit_ratio@10': 0.8136, 'ndcg@10': 0.8757, 'compress@10': 0.2115, 'time@10': 9.7713}:  50%|█████     | 5/10 [00:31<00:37,  7.54s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0305, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8761, 'compress@10': 0.1862, 'time@10': 9.7233}:  50%|█████     | 5/10 [00:40<00:37,  7.54s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0305, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8761, 'compress@10': 0.1862, 'time@10': 9.7233}:  60%|██████    | 6/10 [00:40<00:32,  8.21s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.032, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8797, 'compress@10': 0.1706, 'time@10': 9.8469}:  60%|██████    | 6/10 [00:45<00:32,  8.21s/it] {'epoch': 12, 'num_users': 6.2857, 'loss': 0.032, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8797, 'compress@10': 0.1706, 'time@10': 9.8469}:  70%|███████   | 7/10 [00:45<00:21,  7.27s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8793, 'compress@10': 0.1575, 'time@10': 9.5978}:  70%|███████   | 7/10 [00:53<00:21,  7.27s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8793, 'compress@10': 0.1575, 'time@10': 9.5978}:  80%|████████  | 8/10 [00:53<00:14,  7.47s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0316, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8887, 'compress@10': 0.1805, 'time@10': 10.4331}:  80%|████████  | 8/10 [01:02<00:14,  7.47s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0316, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8887, 'compress@10': 0.1805, 'time@10': 10.4331}:  90%|█████████ | 9/10 [01:02<00:07,  7.82s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8931, 'compress@10': 0.1685, 'time@10': 10.3805}:  90%|█████████ | 9/10 [01:12<00:07,  7.82s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8931, 'compress@10': 0.1685, 'time@10': 10.3805}: 100%|██████████| 10/10 [01:12<00:00,  8.48s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.8931, 'compress@10': 0.1685, 'time@10': 10.3805}: 100%|██████████| 10/10 [01:12<00:00,  7.24s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.030741644761708098
Avg hit ratio: 0.8681646565093084
Avg ndcg: 0.8931481119864518
Avg compression ratio: 0.16851994065098116
Avg train time: 10.380534720420837
Std train time: 5.99670832718757
[0.03571428571428572, 0.03571428571428572, 0.10714285714285714, 0.17857142857142858, 0.46428571428571425, 0.03571428571428572, 0.03571428571428572, 0.03571428571428572, 0.3214285714285714, 0.03571428571428572]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8507, 'compress@10': 0.0865, 'time@10': 8.3255}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8507, 'compress@10': 0.0865, 'time@10': 8.3255}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8687, 'compress@10': 0.0767, 'time@10': 7.5126}:  10%|█         | 1/10 [00:10<00:37,  4.20s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8687, 'compress@10': 0.0767, 'time@10': 7.5126}:  20%|██        | 2/10 [00:10<00:45,  5.69s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8627, 'compress@10': 0.1293, 'time@10': 5.9279}:  20%|██        | 2/10 [00:12<00:45,  5.69s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8627, 'compress@10': 0.1293, 'time@10': 5.9279}:  30%|███       | 3/10 [00:12<00:26,  3.74s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8704, 'compress@10': 0.149, 'time@10': 5.9979}:  30%|███       | 3/10 [00:18<00:26,  3.74s/it]  {'epoch': 13, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8704, 'compress@10': 0.149, 'time@10': 5.9979}:  40%|████      | 4/10 [00:18<00:28,  4.73s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0314, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8737, 'compress@10': 0.2142, 'time@10': 9.7926}:  40%|████      | 4/10 [00:31<00:28,  4.73s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0314, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8737, 'compress@10': 0.2142, 'time@10': 9.7926}:  50%|█████     | 5/10 [00:31<00:37,  7.54s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0309, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8794, 'compress@10': 0.188, 'time@10': 9.7625}:  50%|█████     | 5/10 [00:40<00:37,  7.54s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0309, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8794, 'compress@10': 0.188, 'time@10': 9.7625}:  60%|██████    | 6/10 [00:40<00:33,  8.26s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0313, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8795, 'compress@10': 0.1718, 'time@10': 9.8944}:  60%|██████    | 6/10 [00:46<00:33,  8.26s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0313, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8795, 'compress@10': 0.1718, 'time@10': 9.8944}:  70%|███████   | 7/10 [00:46<00:21,  7.32s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8785, 'compress@10': 0.1582, 'time@10': 9.6425}:  70%|███████   | 7/10 [00:54<00:21,  7.32s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0307, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8785, 'compress@10': 0.1582, 'time@10': 9.6425}:  80%|████████  | 8/10 [00:54<00:15,  7.51s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0299, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8859, 'compress@10': 0.1785, 'time@10': 10.4284}:  80%|████████  | 8/10 [01:02<00:15,  7.51s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0299, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8859, 'compress@10': 0.1785, 'time@10': 10.4284}:  90%|█████████ | 9/10 [01:02<00:07,  7.78s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8868, 'compress@10': 0.1664, 'time@10': 10.385}:  90%|█████████ | 9/10 [01:12<00:07,  7.78s/it]    {'epoch': 13, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8868, 'compress@10': 0.1664, 'time@10': 10.385}: 100%|██████████| 10/10 [01:12<00:00,  8.48s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8868, 'compress@10': 0.1664, 'time@10': 10.385}: 100%|██████████| 10/10 [01:12<00:00,  7.25s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.029677464202721986
Avg hit ratio: 0.8765107637128011
Avg ndcg: 0.886802318582401
Avg compression ratio: 0.1664119420622675
Avg train time: 10.38500418663025
Std train time: 5.944649855852435
[0.1, 0.03333333333333334, 0.09999999999999999, 0.16666666666666666, 0.4333333333333333, 0.03333333333333334, 0.03333333333333334, 0.03333333333333334, 0.3, 0.03333333333333334]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8603, 'compress@10': 0.1474, 'time@10': 8.4215}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0441, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8603, 'compress@10': 0.1474, 'time@10': 8.4215}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8784, 'compress@10': 0.106, 'time@10': 7.6013}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it] {'epoch': 14, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8784, 'compress@10': 0.106, 'time@10': 7.6013}:  20%|██        | 2/10 [00:11<00:46,  5.76s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8692, 'compress@10': 0.1468, 'time@10': 5.9502}:  20%|██        | 2/10 [00:12<00:46,  5.76s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8692, 'compress@10': 0.1468, 'time@10': 5.9502}:  30%|███       | 3/10 [00:12<00:26,  3.75s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8754, 'compress@10': 0.1592, 'time@10': 6.0467}:  30%|███       | 3/10 [00:18<00:26,  3.75s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0299, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8754, 'compress@10': 0.1592, 'time@10': 6.0467}:  40%|████      | 4/10 [00:18<00:28,  4.79s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8798, 'compress@10': 0.2163, 'time@10': 9.8046}:  40%|████      | 4/10 [00:31<00:28,  4.79s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8798, 'compress@10': 0.2163, 'time@10': 9.8046}:  50%|█████     | 5/10 [00:31<00:37,  7.55s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8833, 'compress@10': 0.1894, 'time@10': 9.756}:  50%|█████     | 5/10 [00:40<00:37,  7.55s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8833, 'compress@10': 0.1894, 'time@10': 9.756}:  60%|██████    | 6/10 [00:40<00:32,  8.24s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.887, 'compress@10': 0.1726, 'time@10': 9.874}:  60%|██████    | 6/10 [00:46<00:32,  8.24s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.887, 'compress@10': 0.1726, 'time@10': 9.874}:  70%|███████   | 7/10 [00:46<00:21,  7.29s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0284, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.8848, 'compress@10': 0.1587, 'time@10': 9.6294}:  70%|███████   | 7/10 [00:54<00:21,  7.29s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0284, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.8848, 'compress@10': 0.1587, 'time@10': 9.6294}:  80%|████████  | 8/10 [00:54<00:14,  7.50s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0286, 'hit_ratio@10': 0.869, 'ndcg@10': 0.8906, 'compress@10': 0.1766, 'time@10': 10.4106}:  80%|████████  | 8/10 [01:02<00:14,  7.50s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0286, 'hit_ratio@10': 0.869, 'ndcg@10': 0.8906, 'compress@10': 0.1766, 'time@10': 10.4106}:  90%|█████████ | 9/10 [01:02<00:07,  7.77s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8954, 'compress@10': 0.1645, 'time@10': 10.3609}:  90%|█████████ | 9/10 [01:12<00:07,  7.77s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8954, 'compress@10': 0.1645, 'time@10': 10.3609}: 100%|██████████| 10/10 [01:12<00:00,  8.44s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.8954, 'compress@10': 0.1645, 'time@10': 10.3609}: 100%|██████████| 10/10 [01:12<00:00,  7.24s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.02702918136036351
Avg hit ratio: 0.8797897946234109
Avg ndcg: 0.8954289203172555
Avg compression ratio: 0.16447272270160854
Avg train time: 10.360917615890504
Std train time: 5.902648336787604
[0.15625, 0.03125000000000001, 0.09374999999999999, 0.15625, 0.40624999999999994, 0.03125000000000001, 0.03125000000000001, 0.03125000000000001, 0.28125, 0.03125000000000001]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8744, 'compress@10': 0.2007, 'time@10': 8.3561}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8744, 'compress@10': 0.2007, 'time@10': 8.3561}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8853, 'compress@10': 0.1316, 'time@10': 7.5577}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8853, 'compress@10': 0.1316, 'time@10': 7.5577}:  20%|██        | 2/10 [00:11<00:45,  5.73s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8738, 'compress@10': 0.1621, 'time@10': 5.9808}:  20%|██        | 2/10 [00:12<00:45,  5.73s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8738, 'compress@10': 0.1621, 'time@10': 5.9808}:  30%|███       | 3/10 [00:12<00:26,  3.78s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8754, 'compress@10': 0.1682, 'time@10': 6.0938}:  30%|███       | 3/10 [00:18<00:26,  3.78s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8754, 'compress@10': 0.1682, 'time@10': 6.0938}:  40%|████      | 4/10 [00:18<00:29,  4.84s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8821, 'compress@10': 0.2182, 'time@10': 9.8033}:  40%|████      | 4/10 [00:31<00:29,  4.84s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8821, 'compress@10': 0.2182, 'time@10': 9.8033}:  50%|█████     | 5/10 [00:31<00:37,  7.55s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0312, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8857, 'compress@10': 0.1906, 'time@10': 9.7914}:  50%|█████     | 5/10 [00:41<00:37,  7.55s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0312, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8857, 'compress@10': 0.1906, 'time@10': 9.7914}:  60%|██████    | 6/10 [00:41<00:33,  8.31s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.032, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.8874, 'compress@10': 0.1734, 'time@10': 9.8782}:  60%|██████    | 6/10 [00:46<00:33,  8.31s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.032, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.8874, 'compress@10': 0.1734, 'time@10': 9.8782}:  70%|███████   | 7/10 [00:46<00:21,  7.30s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0304, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.8915, 'compress@10': 0.1591, 'time@10': 9.6507}:  70%|███████   | 7/10 [00:54<00:21,  7.30s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0304, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.8915, 'compress@10': 0.1591, 'time@10': 9.6507}:  80%|████████  | 8/10 [00:54<00:15,  7.56s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0295, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8975, 'compress@10': 0.1749, 'time@10': 10.3938}:  80%|████████  | 8/10 [01:02<00:15,  7.56s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0295, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8975, 'compress@10': 0.1749, 'time@10': 10.3938}:  90%|█████████ | 9/10 [01:02<00:07,  7.76s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9009, 'compress@10': 0.1628, 'time@10': 10.3494}:  90%|█████████ | 9/10 [01:12<00:07,  7.76s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9009, 'compress@10': 0.1628, 'time@10': 10.3494}: 100%|██████████| 10/10 [01:12<00:00,  8.45s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9009, 'compress@10': 0.1628, 'time@10': 10.3494}: 100%|██████████| 10/10 [01:12<00:00,  7.26s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.029339928115794323
Avg hit ratio: 0.8842183660519825
Avg ndcg: 0.9009168745454954
Avg compression ratio: 0.16276610352376633
Avg train time: 10.349396705627441
Std train time: 5.7854306103907485
[0.20588235294117646, 0.02941176470588236, 0.08823529411764705, 0.14705882352941177, 0.38235294117647056, 0.02941176470588236, 0.02941176470588236, 0.02941176470588236, 0.2647058823529412, 0.02941176470588236]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0314, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8815, 'compress@10': 0.2477, 'time@10': 8.5028}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0314, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8815, 'compress@10': 0.2477, 'time@10': 8.5028}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0314, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8904, 'compress@10': 0.1542, 'time@10': 7.6903}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0314, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8904, 'compress@10': 0.1542, 'time@10': 7.6903}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8771, 'compress@10': 0.1756, 'time@10': 6.0643}:  20%|██        | 2/10 [00:12<00:46,  5.83s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8771, 'compress@10': 0.1756, 'time@10': 6.0643}:  30%|███       | 3/10 [00:12<00:26,  3.83s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.877, 'compress@10': 0.1761, 'time@10': 6.1678}:  30%|███       | 3/10 [00:19<00:26,  3.83s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.877, 'compress@10': 0.1761, 'time@10': 6.1678}:  40%|████      | 4/10 [00:19<00:29,  4.89s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0254, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8838, 'compress@10': 0.2198, 'time@10': 9.8819}:  40%|████      | 4/10 [00:31<00:29,  4.89s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0254, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8838, 'compress@10': 0.2198, 'time@10': 9.8819}:  50%|█████     | 5/10 [00:31<00:38,  7.60s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0242, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8912, 'compress@10': 0.1917, 'time@10': 9.8728}:  50%|█████     | 5/10 [00:41<00:38,  7.60s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0242, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8912, 'compress@10': 0.1917, 'time@10': 9.8728}:  60%|██████    | 6/10 [00:41<00:33,  8.37s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0251, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.8912, 'compress@10': 0.1741, 'time@10': 9.9995}:  60%|██████    | 6/10 [00:46<00:33,  8.37s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0251, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.8912, 'compress@10': 0.1741, 'time@10': 9.9995}:  70%|███████   | 7/10 [00:46<00:22,  7.41s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0244, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.8915, 'compress@10': 0.1594, 'time@10': 9.7411}:  70%|███████   | 7/10 [00:54<00:22,  7.41s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0244, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.8915, 'compress@10': 0.1594, 'time@10': 9.7411}:  80%|████████  | 8/10 [00:54<00:15,  7.59s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8981, 'compress@10': 0.1735, 'time@10': 10.4922}:  80%|████████  | 8/10 [01:03<00:15,  7.59s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8981, 'compress@10': 0.1735, 'time@10': 10.4922}:  90%|█████████ | 9/10 [01:03<00:07,  7.80s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.024, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.8972, 'compress@10': 0.1613, 'time@10': 10.445}:  90%|█████████ | 9/10 [01:13<00:07,  7.80s/it]     {'epoch': 16, 'num_users': 6.3, 'loss': 0.024, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.8972, 'compress@10': 0.1613, 'time@10': 10.445}: 100%|██████████| 10/10 [01:13<00:00,  8.50s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.024, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.8972, 'compress@10': 0.1613, 'time@10': 10.445}: 100%|██████████| 10/10 [01:13<00:00,  7.32s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.02404414709351473
Avg hit ratio: 0.8899326517662681
Avg ndcg: 0.8971619465715783
Avg compression ratio: 0.16127549829955584
Avg train time: 10.44500274658203
Std train time: 5.8175653800931295
[0.19444444444444445, 0.027777777777777783, 0.08333333333333333, 0.19444444444444445, 0.3611111111111111, 0.027777777777777783, 0.027777777777777783, 0.027777777777777783, 0.25, 0.027777777777777783]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0353, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8824, 'compress@10': 0.2368, 'time@10': 8.625}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0353, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8824, 'compress@10': 0.2368, 'time@10': 8.625}:  10%|█         | 1/10 [00:04<00:39,  4.35s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.902, 'compress@10': 0.148, 'time@10': 7.866}:  10%|█         | 1/10 [00:11<00:39,  4.35s/it]  {'epoch': 17, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.902, 'compress@10': 0.148, 'time@10': 7.866}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8849, 'compress@10': 0.1701, 'time@10': 6.1841}:  20%|██        | 2/10 [00:12<00:47,  5.99s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8849, 'compress@10': 0.1701, 'time@10': 6.1841}:  30%|███       | 3/10 [00:12<00:27,  3.92s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8883, 'compress@10': 0.1834, 'time@10': 6.293}:  30%|███       | 3/10 [00:19<00:27,  3.92s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8883, 'compress@10': 0.1834, 'time@10': 6.293}:  40%|████      | 4/10 [00:19<00:30,  5.01s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8938, 'compress@10': 0.2215, 'time@10': 10.0478}:  40%|████      | 4/10 [00:32<00:30,  5.01s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8938, 'compress@10': 0.2215, 'time@10': 10.0478}:  50%|█████     | 5/10 [00:32<00:38,  7.73s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0254, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9001, 'compress@10': 0.1928, 'time@10': 10.0449}:  50%|█████     | 5/10 [00:42<00:38,  7.73s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0254, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9001, 'compress@10': 0.1928, 'time@10': 10.0449}:  60%|██████    | 6/10 [00:42<00:34,  8.53s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.025, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9029, 'compress@10': 0.1748, 'time@10': 10.2028}:  60%|██████    | 6/10 [00:47<00:34,  8.53s/it] {'epoch': 17, 'num_users': 6.2857, 'loss': 0.025, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9029, 'compress@10': 0.1748, 'time@10': 10.2028}:  70%|███████   | 7/10 [00:47<00:22,  7.58s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0253, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9016, 'compress@10': 0.1599, 'time@10': 9.9236}:  70%|███████   | 7/10 [00:55<00:22,  7.58s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0253, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9016, 'compress@10': 0.1599, 'time@10': 9.9236}:  80%|████████  | 8/10 [00:55<00:15,  7.71s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0249, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9079, 'compress@10': 0.1723, 'time@10': 10.5462}:  80%|████████  | 8/10 [01:03<00:15,  7.71s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0249, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9079, 'compress@10': 0.1723, 'time@10': 10.5462}:  90%|█████████ | 9/10 [01:03<00:07,  7.74s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9125, 'compress@10': 0.16, 'time@10': 10.463}:  90%|█████████ | 9/10 [01:13<00:07,  7.74s/it]      {'epoch': 17, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9125, 'compress@10': 0.16, 'time@10': 10.463}: 100%|██████████| 10/10 [01:13<00:00,  8.36s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9125, 'compress@10': 0.16, 'time@10': 10.463}: 100%|██████████| 10/10 [01:13<00:00,  7.34s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.023638758013113097
Avg hit ratio: 0.8947897946234109
Avg ndcg: 0.9124862690920713
Avg compression ratio: 0.1600352181698612
Avg train time: 10.462980556488038
Std train time: 5.780899499871628
[0.2368421052631579, 0.026315789473684216, 0.07894736842105263, 0.1842105263157895, 0.34210526315789475, 0.026315789473684216, 0.026315789473684216, 0.026315789473684216, 0.2368421052631579, 0.026315789473684216]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.886, 'compress@10': 0.277, 'time@10': 8.3224}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.886, 'compress@10': 0.277, 'time@10': 8.3224}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9114, 'compress@10': 0.1674, 'time@10': 7.5805}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0293, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9114, 'compress@10': 0.1674, 'time@10': 7.5805}:  20%|██        | 2/10 [00:11<00:46,  5.79s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8911, 'compress@10': 0.1818, 'time@10': 5.9456}:  20%|██        | 2/10 [00:12<00:46,  5.79s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8911, 'compress@10': 0.1818, 'time@10': 5.9456}:  30%|███       | 3/10 [00:12<00:26,  3.77s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.8972, 'compress@10': 0.1897, 'time@10': 6.0404}:  30%|███       | 3/10 [00:18<00:26,  3.77s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.8972, 'compress@10': 0.1897, 'time@10': 6.0404}:  40%|████      | 4/10 [00:18<00:28,  4.80s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9036, 'compress@10': 0.2228, 'time@10': 9.5252}:  40%|████      | 4/10 [00:30<00:28,  4.80s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0238, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9036, 'compress@10': 0.2228, 'time@10': 9.5252}:  50%|█████     | 5/10 [00:30<00:36,  7.31s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0251, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9127, 'compress@10': 0.1936, 'time@10': 9.5219}:  50%|█████     | 5/10 [00:40<00:36,  7.31s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0251, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9127, 'compress@10': 0.1936, 'time@10': 9.5219}:  60%|██████    | 6/10 [00:40<00:32,  8.07s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.026, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9139, 'compress@10': 0.1753, 'time@10': 9.6965}:  60%|██████    | 6/10 [00:45<00:32,  8.07s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.026, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9139, 'compress@10': 0.1753, 'time@10': 9.6965}:  70%|███████   | 7/10 [00:45<00:21,  7.20s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9129, 'compress@10': 0.1602, 'time@10': 9.4556}:  70%|███████   | 7/10 [00:53<00:21,  7.20s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9129, 'compress@10': 0.1602, 'time@10': 9.4556}:  80%|████████  | 8/10 [00:53<00:14,  7.39s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0246, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9208, 'compress@10': 0.1711, 'time@10': 10.157}:  80%|████████  | 8/10 [01:01<00:14,  7.39s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0246, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9208, 'compress@10': 0.1711, 'time@10': 10.157}:  90%|█████████ | 9/10 [01:01<00:07,  7.56s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9271, 'compress@10': 0.1588, 'time@10': 10.1308}:  90%|█████████ | 9/10 [01:11<00:07,  7.56s/it]  {'epoch': 18, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9271, 'compress@10': 0.1588, 'time@10': 10.1308}: 100%|██████████| 10/10 [01:11<00:00,  8.29s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9271, 'compress@10': 0.1588, 'time@10': 10.1308}: 100%|██████████| 10/10 [01:11<00:00,  7.12s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.024423677953815233
Avg hit ratio: 0.8826238960058994
Avg ndcg: 0.9270957847195025
Avg compression ratio: 0.1588372204714692
Avg train time: 10.130792570114135
Std train time: 5.478498925274193
[0.225, 0.025000000000000005, 0.075, 0.17500000000000002, 0.325, 0.07500000000000001, 0.025000000000000005, 0.025000000000000005, 0.225, 0.025000000000000005]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8856, 'compress@10': 0.2658, 'time@10': 8.321}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8856, 'compress@10': 0.2658, 'time@10': 8.321}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9198, 'compress@10': 0.1611, 'time@10': 7.6644}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9198, 'compress@10': 0.1611, 'time@10': 7.6644}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8967, 'compress@10': 0.1765, 'time@10': 6.0064}:  20%|██        | 2/10 [00:12<00:46,  5.87s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8967, 'compress@10': 0.1765, 'time@10': 6.0064}:  30%|███       | 3/10 [00:12<00:26,  3.82s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9084, 'compress@10': 0.1835, 'time@10': 6.0633}:  30%|███       | 3/10 [00:18<00:26,  3.82s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9084, 'compress@10': 0.1835, 'time@10': 6.0633}:  40%|████      | 4/10 [00:18<00:28,  4.79s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0198, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9162, 'compress@10': 0.2145, 'time@10': 9.5669}:  40%|████      | 4/10 [00:30<00:28,  4.79s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0198, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9162, 'compress@10': 0.2145, 'time@10': 9.5669}:  50%|█████     | 5/10 [00:30<00:36,  7.34s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0195, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9208, 'compress@10': 0.1947, 'time@10': 9.6136}:  50%|█████     | 5/10 [00:40<00:36,  7.34s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0195, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9208, 'compress@10': 0.1947, 'time@10': 9.6136}:  60%|██████    | 6/10 [00:40<00:32,  8.20s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.02, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9198, 'compress@10': 0.176, 'time@10': 9.7235}:  60%|██████    | 6/10 [00:45<00:32,  8.20s/it]    {'epoch': 19, 'num_users': 6.2857, 'loss': 0.02, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9198, 'compress@10': 0.176, 'time@10': 9.7235}:  70%|███████   | 7/10 [00:45<00:21,  7.23s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9243, 'compress@10': 0.1606, 'time@10': 9.4587}:  70%|███████   | 7/10 [00:53<00:21,  7.23s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9243, 'compress@10': 0.1606, 'time@10': 9.4587}:  80%|████████  | 8/10 [00:53<00:14,  7.36s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9292, 'compress@10': 0.1702, 'time@10': 10.1956}:  80%|████████  | 8/10 [01:01<00:14,  7.36s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9292, 'compress@10': 0.1702, 'time@10': 10.1956}:  90%|█████████ | 9/10 [01:01<00:07,  7.59s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.929, 'compress@10': 0.1579, 'time@10': 10.1433}:  90%|█████████ | 9/10 [01:11<00:07,  7.59s/it]    {'epoch': 19, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.929, 'compress@10': 0.1579, 'time@10': 10.1433}: 100%|██████████| 10/10 [01:11<00:00,  8.24s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.929, 'compress@10': 0.1579, 'time@10': 10.1433}: 100%|██████████| 10/10 [01:11<00:00,  7.13s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.018495858215660254
Avg hit ratio: 0.888706845314655
Avg ndcg: 0.9289906392536581
Avg compression ratio: 0.1579143015190113
Avg train time: 10.143274354934693
Std train time: 5.538361901297244
[0.2142857142857143, 0.023809523809523815, 0.07142857142857142, 0.2142857142857143, 0.30952380952380953, 0.07142857142857144, 0.023809523809523815, 0.023809523809523815, 0.2142857142857143, 0.023809523809523815]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8968, 'compress@10': 0.2556, 'time@10': 8.3665}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8968, 'compress@10': 0.2556, 'time@10': 8.3665}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9265, 'compress@10': 0.1555, 'time@10': 7.5728}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9265, 'compress@10': 0.1555, 'time@10': 7.5728}:  20%|██        | 2/10 [00:11<00:45,  5.75s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9012, 'compress@10': 0.1717, 'time@10': 5.9464}:  20%|██        | 2/10 [00:12<00:45,  5.75s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9012, 'compress@10': 0.1717, 'time@10': 5.9464}:  30%|███       | 3/10 [00:12<00:26,  3.76s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9121, 'compress@10': 0.1894, 'time@10': 6.0482}:  30%|███       | 3/10 [00:18<00:26,  3.76s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9121, 'compress@10': 0.1894, 'time@10': 6.0482}:  40%|████      | 4/10 [00:18<00:28,  4.80s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9191, 'compress@10': 0.2161, 'time@10': 9.5685}:  40%|████      | 4/10 [00:30<00:28,  4.80s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9191, 'compress@10': 0.2161, 'time@10': 9.5685}:  50%|█████     | 5/10 [00:30<00:36,  7.34s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9226, 'compress@10': 0.1955, 'time@10': 9.6222}:  50%|█████     | 5/10 [00:40<00:36,  7.34s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9226, 'compress@10': 0.1955, 'time@10': 9.6222}:  60%|██████    | 6/10 [00:40<00:32,  8.22s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9225, 'compress@10': 0.1765, 'time@10': 9.7576}:  60%|██████    | 6/10 [00:45<00:32,  8.22s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9225, 'compress@10': 0.1765, 'time@10': 9.7576}:  70%|███████   | 7/10 [00:45<00:21,  7.28s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9168, 'compress@10': 0.1609, 'time@10': 9.4961}:  70%|███████   | 7/10 [00:53<00:21,  7.28s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9168, 'compress@10': 0.1609, 'time@10': 9.4961}:  80%|████████  | 8/10 [00:53<00:14,  7.41s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9218, 'compress@10': 0.1693, 'time@10': 10.2161}:  80%|████████  | 8/10 [01:01<00:14,  7.41s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9218, 'compress@10': 0.1693, 'time@10': 10.2161}:  90%|█████████ | 9/10 [01:01<00:07,  7.60s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9257, 'compress@10': 0.157, 'time@10': 10.1653}:  90%|█████████ | 9/10 [01:11<00:07,  7.60s/it]    {'epoch': 20, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9257, 'compress@10': 0.157, 'time@10': 10.1653}: 100%|██████████| 10/10 [01:11<00:00,  8.27s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9257, 'compress@10': 0.157, 'time@10': 10.1653}: 100%|██████████| 10/10 [01:11<00:00,  7.14s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.01829192156821203
Avg hit ratio: 0.9054810388630422
Avg ndcg: 0.9256638365934741
Avg compression ratio: 0.15701479078777325
Avg train time: 10.165336441993713
Std train time: 5.54395070811314
[0.20454545454545456, 0.02272727272727273, 0.06818181818181818, 0.25, 0.29545454545454547, 0.06818181818181819, 0.02272727272727273, 0.02272727272727273, 0.20454545454545456, 0.02272727272727273]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.907, 'compress@10': 0.2464, 'time@10': 8.359}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.907, 'compress@10': 0.2464, 'time@10': 8.359}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9224, 'compress@10': 0.1503, 'time@10': 7.5306}:  10%|█         | 1/10 [00:10<00:38,  4.25s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9224, 'compress@10': 0.1503, 'time@10': 7.5306}:  20%|██        | 2/10 [00:10<00:45,  5.71s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8985, 'compress@10': 0.1673, 'time@10': 5.9197}:  20%|██        | 2/10 [00:12<00:45,  5.71s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8985, 'compress@10': 0.1673, 'time@10': 5.9197}:  30%|███       | 3/10 [00:12<00:26,  3.74s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9088, 'compress@10': 0.1947, 'time@10': 6.0273}:  30%|███       | 3/10 [00:18<00:26,  3.74s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9088, 'compress@10': 0.1947, 'time@10': 6.0273}:  40%|████      | 4/10 [00:18<00:28,  4.78s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9161, 'compress@10': 0.2177, 'time@10': 9.5361}:  40%|████      | 4/10 [00:30<00:28,  4.78s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9161, 'compress@10': 0.2177, 'time@10': 9.5361}:  50%|█████     | 5/10 [00:30<00:36,  7.32s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0234, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.927, 'compress@10': 0.1962, 'time@10': 9.5508}:  50%|█████     | 5/10 [00:40<00:36,  7.32s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0234, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.927, 'compress@10': 0.1962, 'time@10': 9.5508}:  60%|██████    | 6/10 [00:40<00:32,  8.12s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0234, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.925, 'compress@10': 0.177, 'time@10': 9.6736}:  60%|██████    | 6/10 [00:45<00:32,  8.12s/it] {'epoch': 21, 'num_users': 6.2857, 'loss': 0.0234, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.925, 'compress@10': 0.177, 'time@10': 9.6736}:  70%|███████   | 7/10 [00:45<00:21,  7.18s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9298, 'compress@10': 0.1612, 'time@10': 9.4069}:  70%|███████   | 7/10 [00:53<00:21,  7.18s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9298, 'compress@10': 0.1612, 'time@10': 9.4069}:  80%|████████  | 8/10 [00:53<00:14,  7.30s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9521, 'compress@10': 0.1686, 'time@10': 10.1219}:  80%|████████  | 8/10 [01:01<00:14,  7.30s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9521, 'compress@10': 0.1686, 'time@10': 10.1219}:  90%|█████████ | 9/10 [01:01<00:07,  7.51s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0246, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9546, 'compress@10': 0.1562, 'time@10': 10.0829}:  90%|█████████ | 9/10 [01:10<00:07,  7.51s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0246, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9546, 'compress@10': 0.1562, 'time@10': 10.0829}: 100%|██████████| 10/10 [01:10<00:00,  8.21s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0246, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9546, 'compress@10': 0.1562, 'time@10': 10.0829}: 100%|██████████| 10/10 [01:10<00:00,  7.08s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.024621659181455605
Avg hit ratio: 0.9001354167432265
Avg ndcg: 0.9546227070519719
Avg compression ratio: 0.1561957693429395
Avg train time: 10.082934188842774
Std train time: 5.521609241307167
[0.1956521739130435, 0.02173913043478261, 0.06521739130434782, 0.2391304347826087, 0.28260869565217395, 0.06521739130434784, 0.02173913043478261, 0.02173913043478261, 0.2391304347826087, 0.02173913043478261]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.907, 'compress@10': 0.238, 'time@10': 8.3791}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.907, 'compress@10': 0.238, 'time@10': 8.3791}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9882, 'compress@10': 0.1456, 'time@10': 7.6606}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9882, 'compress@10': 0.1456, 'time@10': 7.6606}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9424, 'compress@10': 0.1634, 'time@10': 6.011}:  20%|██        | 2/10 [00:12<00:46,  5.85s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9424, 'compress@10': 0.1634, 'time@10': 6.011}:  30%|███       | 3/10 [00:12<00:26,  3.82s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9405, 'compress@10': 0.1891, 'time@10': 6.0679}:  30%|███       | 3/10 [00:19<00:26,  3.82s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9405, 'compress@10': 0.1891, 'time@10': 6.0679}:  40%|████      | 4/10 [00:19<00:29,  4.98s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0208, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9462, 'compress@10': 0.2107, 'time@10': 9.5804}:  40%|████      | 4/10 [00:31<00:29,  4.98s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0208, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9462, 'compress@10': 0.2107, 'time@10': 9.5804}:  50%|█████     | 5/10 [00:31<00:37,  7.46s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0195, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9481, 'compress@10': 0.1899, 'time@10': 9.6288}:  50%|█████     | 5/10 [00:41<00:37,  7.46s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0195, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9481, 'compress@10': 0.1899, 'time@10': 9.6288}:  60%|██████    | 6/10 [00:41<00:33,  8.29s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9444, 'compress@10': 0.1715, 'time@10': 9.7551}:  60%|██████    | 6/10 [00:46<00:33,  8.29s/it] {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9444, 'compress@10': 0.1715, 'time@10': 9.7551}:  70%|███████   | 7/10 [00:46<00:21,  7.31s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9442, 'compress@10': 0.1562, 'time@10': 9.489}:  70%|███████   | 7/10 [00:54<00:21,  7.31s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9442, 'compress@10': 0.1562, 'time@10': 9.489}:  80%|████████  | 8/10 [00:54<00:14,  7.42s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0283, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9369, 'compress@10': 0.1679, 'time@10': 10.2089}:  80%|████████  | 8/10 [01:02<00:14,  7.42s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0283, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9369, 'compress@10': 0.1679, 'time@10': 10.2089}:  90%|█████████ | 9/10 [01:02<00:07,  7.61s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9363, 'compress@10': 0.1555, 'time@10': 10.1665}:  90%|█████████ | 9/10 [01:11<00:07,  7.61s/it]     {'epoch': 22, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9363, 'compress@10': 0.1555, 'time@10': 10.1665}: 100%|██████████| 10/10 [01:11<00:00,  8.29s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9363, 'compress@10': 0.1555, 'time@10': 10.1665}: 100%|██████████| 10/10 [01:11<00:00,  7.19s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.027955848793712552
Avg hit ratio: 0.8829925596003694
Avg ndcg: 0.9363299739374108
Avg compression ratio: 0.15547928533085764
Avg train time: 10.166496396064758
Std train time: 5.534851556915179
[0.1875, 0.020833333333333336, 0.0625, 0.22916666666666669, 0.27083333333333337, 0.06250000000000001, 0.020833333333333336, 0.020833333333333336, 0.27083333333333337, 0.020833333333333336]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9109, 'compress@10': 0.2303, 'time@10': 8.4124}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9109, 'compress@10': 0.2303, 'time@10': 8.4124}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9441, 'compress@10': 0.1413, 'time@10': 7.5847}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9441, 'compress@10': 0.1413, 'time@10': 7.5847}:  20%|██        | 2/10 [00:11<00:45,  5.75s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.913, 'compress@10': 0.1597, 'time@10': 5.972}:  20%|██        | 2/10 [00:12<00:45,  5.75s/it]  {'epoch': 23, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.913, 'compress@10': 0.1597, 'time@10': 5.972}:  30%|███       | 3/10 [00:12<00:26,  3.77s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9144, 'compress@10': 0.184, 'time@10': 6.0612}:  30%|███       | 3/10 [00:18<00:26,  3.77s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9144, 'compress@10': 0.184, 'time@10': 6.0612}:  40%|████      | 4/10 [00:18<00:28,  4.79s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9195, 'compress@10': 0.2043, 'time@10': 9.6399}:  40%|████      | 4/10 [00:30<00:28,  4.79s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9195, 'compress@10': 0.2043, 'time@10': 9.6399}:  50%|█████     | 5/10 [00:30<00:36,  7.40s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9269, 'compress@10': 0.1841, 'time@10': 9.6804}:  50%|█████     | 5/10 [00:40<00:36,  7.40s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9269, 'compress@10': 0.1841, 'time@10': 9.6804}:  60%|██████    | 6/10 [00:40<00:33,  8.26s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9277, 'compress@10': 0.1664, 'time@10': 9.8061}:  60%|██████    | 6/10 [00:46<00:33,  8.26s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9277, 'compress@10': 0.1664, 'time@10': 9.8061}:  70%|███████   | 7/10 [00:46<00:21,  7.30s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9266, 'compress@10': 0.1517, 'time@10': 9.5469}:  70%|███████   | 7/10 [00:53<00:21,  7.30s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0149, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9266, 'compress@10': 0.1517, 'time@10': 9.5469}:  80%|████████  | 8/10 [00:53<00:14,  7.45s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9392, 'compress@10': 0.1672, 'time@10': 10.2719}:  80%|████████  | 8/10 [01:01<00:14,  7.45s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9392, 'compress@10': 0.1672, 'time@10': 10.2719}:  90%|█████████ | 9/10 [01:01<00:07,  7.64s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9429, 'compress@10': 0.1548, 'time@10': 10.2207}:  90%|█████████ | 9/10 [01:11<00:07,  7.64s/it]  {'epoch': 23, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9429, 'compress@10': 0.1548, 'time@10': 10.2207}: 100%|██████████| 10/10 [01:11<00:00,  8.31s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9429, 'compress@10': 0.1548, 'time@10': 10.2207}: 100%|██████████| 10/10 [01:11<00:00,  7.17s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.015306959204133299
Avg hit ratio: 0.8904810388630423
Avg ndcg: 0.9429155882603888
Avg compression ratio: 0.1548197544820417
Avg train time: 10.220710039138794
Std train time: 5.619340488063887
[0.18, 0.020000000000000004, 0.06, 0.22000000000000003, 0.26, 0.06000000000000001, 0.020000000000000004, 0.020000000000000004, 0.30000000000000004, 0.020000000000000004]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9147, 'compress@10': 0.2232, 'time@10': 8.4739}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9147, 'compress@10': 0.2232, 'time@10': 8.4739}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9388, 'compress@10': 0.1374, 'time@10': 7.6754}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9388, 'compress@10': 0.1374, 'time@10': 7.6754}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9094, 'compress@10': 0.1564, 'time@10': 6.03}:  20%|██        | 2/10 [00:12<00:46,  5.83s/it]  {'epoch': 24, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9094, 'compress@10': 0.1564, 'time@10': 6.03}:  30%|███       | 3/10 [00:12<00:26,  3.81s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9137, 'compress@10': 0.1792, 'time@10': 6.1007}:  30%|███       | 3/10 [00:18<00:26,  3.81s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9137, 'compress@10': 0.1792, 'time@10': 6.1007}:  40%|████      | 4/10 [00:18<00:28,  4.81s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9213, 'compress@10': 0.1983, 'time@10': 9.583}:  40%|████      | 4/10 [00:30<00:28,  4.81s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9213, 'compress@10': 0.1983, 'time@10': 9.583}:  50%|█████     | 5/10 [00:30<00:36,  7.33s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9334, 'compress@10': 0.1788, 'time@10': 9.6062}:  50%|█████     | 5/10 [00:40<00:36,  7.33s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9334, 'compress@10': 0.1788, 'time@10': 9.6062}:  60%|██████    | 6/10 [00:40<00:32,  8.16s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.933, 'compress@10': 0.1617, 'time@10': 9.7635}:  60%|██████    | 6/10 [00:45<00:32,  8.16s/it] {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.933, 'compress@10': 0.1617, 'time@10': 9.7635}:  70%|███████   | 7/10 [00:45<00:21,  7.25s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9311, 'compress@10': 0.1475, 'time@10': 9.5059}:  70%|███████   | 7/10 [00:53<00:21,  7.25s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9311, 'compress@10': 0.1475, 'time@10': 9.5059}:  80%|████████  | 8/10 [00:53<00:14,  7.41s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.926, 'compress@10': 0.1667, 'time@10': 10.2151}:  80%|████████  | 8/10 [01:01<00:14,  7.41s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.926, 'compress@10': 0.1667, 'time@10': 10.2151}:  90%|█████████ | 9/10 [01:01<00:07,  7.59s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9312, 'compress@10': 0.1542, 'time@10': 10.1586}:  90%|█████████ | 9/10 [01:11<00:07,  7.59s/it]  {'epoch': 24, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9312, 'compress@10': 0.1542, 'time@10': 10.1586}: 100%|██████████| 10/10 [01:11<00:00,  8.24s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9312, 'compress@10': 0.1542, 'time@10': 10.1586}: 100%|██████████| 10/10 [01:11<00:00,  7.13s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.02039556809207461
Avg hit ratio: 0.898195324577328
Avg ndcg: 0.9312269875690762
Avg compression ratio: 0.1542148972364931
Avg train time: 10.158594059944154
Std train time: 5.489839482562266
[0.17307692307692307, 0.019230769230769235, 0.05769230769230769, 0.21153846153846156, 0.25, 0.09615384615384617, 0.019230769230769235, 0.019230769230769235, 0.2884615384615385, 0.019230769230769235]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9147, 'compress@10': 0.2166, 'time@10': 8.6117}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9147, 'compress@10': 0.2166, 'time@10': 8.6117}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9366, 'compress@10': 0.1337, 'time@10': 7.7249}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9366, 'compress@10': 0.1337, 'time@10': 7.7249}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9079, 'compress@10': 0.1533, 'time@10': 6.0709}:  20%|██        | 2/10 [00:12<00:46,  5.83s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9079, 'compress@10': 0.1533, 'time@10': 6.0709}:  30%|███       | 3/10 [00:12<00:26,  3.82s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9176, 'compress@10': 0.1749, 'time@10': 6.0852}:  30%|███       | 3/10 [00:18<00:26,  3.82s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9176, 'compress@10': 0.1749, 'time@10': 6.0852}:  40%|████      | 4/10 [00:18<00:28,  4.74s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9286, 'compress@10': 0.1929, 'time@10': 9.4737}:  40%|████      | 4/10 [00:30<00:28,  4.74s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9286, 'compress@10': 0.1929, 'time@10': 9.4737}:  50%|█████     | 5/10 [00:30<00:35,  7.20s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9349, 'compress@10': 0.1801, 'time@10': 9.5337}:  50%|█████     | 5/10 [00:40<00:35,  7.20s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.9349, 'compress@10': 0.1801, 'time@10': 9.5337}:  60%|██████    | 6/10 [00:40<00:32,  8.11s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9346, 'compress@10': 0.1627, 'time@10': 9.6873}:  60%|██████    | 6/10 [00:45<00:32,  8.11s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9346, 'compress@10': 0.1627, 'time@10': 9.6873}:  70%|███████   | 7/10 [00:45<00:21,  7.20s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9387, 'compress@10': 0.1483, 'time@10': 9.436}:  70%|███████   | 7/10 [00:53<00:21,  7.20s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9387, 'compress@10': 0.1483, 'time@10': 9.436}:  80%|████████  | 8/10 [00:53<00:14,  7.37s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9432, 'compress@10': 0.1661, 'time@10': 10.1814}:  80%|████████  | 8/10 [01:01<00:14,  7.37s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9432, 'compress@10': 0.1661, 'time@10': 10.1814}:  90%|█████████ | 9/10 [01:01<00:07,  7.60s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.942, 'compress@10': 0.1537, 'time@10': 10.1389}:  90%|█████████ | 9/10 [01:11<00:07,  7.60s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.942, 'compress@10': 0.1537, 'time@10': 10.1389}: 100%|██████████| 10/10 [01:11<00:00,  8.28s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.942, 'compress@10': 0.1537, 'time@10': 10.1389}: 100%|██████████| 10/10 [01:11<00:00,  7.12s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.01653697084889368
Avg hit ratio: 0.8820560516638615
Avg ndcg: 0.9419803700734303
Avg compression ratio: 0.15368136603004742
Avg train time: 10.1388610124588
Std train time: 5.407665905737815
[0.16666666666666666, 0.05555555555555555, 0.05555555555555555, 0.20370370370370372, 0.24074074074074076, 0.09259259259259262, 0.018518518518518524, 0.018518518518518524, 0.2777777777777778, 0.018518518518518524]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9168, 'compress@10': 0.2105, 'time@10': 8.4652}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9168, 'compress@10': 0.2105, 'time@10': 8.4652}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8506, 'ndcg@10': 1.0088, 'compress@10': 0.1483, 'time@10': 7.9502}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8506, 'ndcg@10': 1.0088, 'compress@10': 0.1483, 'time@10': 7.9502}:  20%|██        | 2/10 [00:11<00:49,  6.16s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9561, 'compress@10': 0.1624, 'time@10': 6.2052}:  20%|██        | 2/10 [00:13<00:49,  6.16s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9561, 'compress@10': 0.1624, 'time@10': 6.2052}:  30%|███       | 3/10 [00:13<00:27,  3.99s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9547, 'compress@10': 0.1798, 'time@10': 6.2554}:  30%|███       | 3/10 [00:19<00:27,  3.99s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9547, 'compress@10': 0.1798, 'time@10': 6.2554}:  40%|████      | 4/10 [00:19<00:29,  4.96s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.9545, 'compress@10': 0.195, 'time@10': 9.5964}:  40%|████      | 4/10 [00:31<00:29,  4.96s/it] {'epoch': 26, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.9545, 'compress@10': 0.195, 'time@10': 9.5964}:  50%|█████     | 5/10 [00:31<00:36,  7.32s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.9568, 'compress@10': 0.1813, 'time@10': 9.6433}:  50%|█████     | 5/10 [00:41<00:36,  7.32s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.9568, 'compress@10': 0.1813, 'time@10': 9.6433}:  60%|██████    | 6/10 [00:41<00:32,  8.21s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9545, 'compress@10': 0.1637, 'time@10': 9.7841}:  60%|██████    | 6/10 [00:46<00:32,  8.21s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9545, 'compress@10': 0.1637, 'time@10': 9.7841}:  70%|███████   | 7/10 [00:46<00:21,  7.27s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0181, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9463, 'compress@10': 0.149, 'time@10': 9.5163}:  70%|███████   | 7/10 [00:54<00:21,  7.27s/it]  {'epoch': 26, 'num_users': 6.125, 'loss': 0.0181, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9463, 'compress@10': 0.149, 'time@10': 9.5163}:  80%|████████  | 8/10 [00:54<00:14,  7.40s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9467, 'compress@10': 0.1656, 'time@10': 10.2457}:  80%|████████  | 8/10 [01:02<00:14,  7.40s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9467, 'compress@10': 0.1656, 'time@10': 10.2457}:  90%|█████████ | 9/10 [01:02<00:07,  7.61s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9498, 'compress@10': 0.1532, 'time@10': 10.1858}:  90%|█████████ | 9/10 [01:11<00:07,  7.61s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9498, 'compress@10': 0.1532, 'time@10': 10.1858}: 100%|██████████| 10/10 [01:11<00:00,  8.25s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9498, 'compress@10': 0.1532, 'time@10': 10.1858}: 100%|██████████| 10/10 [01:11<00:00,  7.18s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.0167046496311301
Avg hit ratio: 0.8867667531487566
Avg ndcg: 0.9498397927515315
Avg compression ratio: 0.1531512678869396
Avg train time: 10.185778951644897
Std train time: 5.3443453568790815
[0.1607142857142857, 0.08928571428571427, 0.05357142857142857, 0.19642857142857145, 0.23214285714285715, 0.0892857142857143, 0.017857142857142863, 0.017857142857142863, 0.26785714285714285, 0.017857142857142863]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9189, 'compress@10': 0.2049, 'time@10': 8.3402}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9189, 'compress@10': 0.2049, 'time@10': 8.3402}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.941, 'compress@10': 0.1618, 'time@10': 7.6934}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it]  {'epoch': 27, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.941, 'compress@10': 0.1618, 'time@10': 7.6934}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9109, 'compress@10': 0.1708, 'time@10': 6.0508}:  20%|██        | 2/10 [00:12<00:47,  5.90s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9109, 'compress@10': 0.1708, 'time@10': 6.0508}:  30%|███       | 3/10 [00:12<00:26,  3.85s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9194, 'compress@10': 0.1844, 'time@10': 6.1226}:  30%|███       | 3/10 [00:19<00:26,  3.85s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9194, 'compress@10': 0.1844, 'time@10': 6.1226}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9261, 'compress@10': 0.197, 'time@10': 9.5884}:  40%|████      | 4/10 [00:30<00:29,  4.86s/it] {'epoch': 27, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9261, 'compress@10': 0.197, 'time@10': 9.5884}:  50%|█████     | 5/10 [00:30<00:36,  7.35s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0152, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9356, 'compress@10': 0.1824, 'time@10': 9.6734}:  50%|█████     | 5/10 [00:41<00:36,  7.35s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0152, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9356, 'compress@10': 0.1824, 'time@10': 9.6734}:  60%|██████    | 6/10 [00:41<00:33,  8.30s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9364, 'compress@10': 0.1645, 'time@10': 9.8292}:  60%|██████    | 6/10 [00:46<00:33,  8.30s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9364, 'compress@10': 0.1645, 'time@10': 9.8292}:  70%|███████   | 7/10 [00:46<00:22,  7.37s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9463, 'compress@10': 0.1497, 'time@10': 9.5731}:  70%|███████   | 7/10 [00:54<00:22,  7.37s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0185, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9463, 'compress@10': 0.1497, 'time@10': 9.5731}:  80%|████████  | 8/10 [00:54<00:15,  7.51s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9634, 'compress@10': 0.1652, 'time@10': 10.2944}:  80%|████████  | 8/10 [01:02<00:15,  7.51s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9634, 'compress@10': 0.1652, 'time@10': 10.2944}:  90%|█████████ | 9/10 [01:02<00:07,  7.69s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9647, 'compress@10': 0.1527, 'time@10': 10.2468}:  90%|█████████ | 9/10 [01:12<00:07,  7.69s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9647, 'compress@10': 0.1527, 'time@10': 10.2468}: 100%|██████████| 10/10 [01:12<00:00,  8.36s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9647, 'compress@10': 0.1527, 'time@10': 10.2468}: 100%|██████████| 10/10 [01:12<00:00,  7.22s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.020383121380883905
Avg hit ratio: 0.8846469374805539
Avg ndcg: 0.9646781105066337
Avg compression ratio: 0.1526581075163071
Avg train time: 10.246834301948548
Std train time: 5.476343121484633
[0.15517241379310343, 0.08620689655172413, 0.05172413793103448, 0.18965517241379312, 0.22413793103448276, 0.08620689655172416, 0.017241379310344834, 0.017241379310344834, 0.29310344827586204, 0.017241379310344834]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9189, 'compress@10': 0.1996, 'time@10': 8.4864}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9189, 'compress@10': 0.1996, 'time@10': 8.4864}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9579, 'compress@10': 0.1577, 'time@10': 7.7776}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9579, 'compress@10': 0.1577, 'time@10': 7.7776}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9221, 'compress@10': 0.1675, 'time@10': 6.1525}:  20%|██        | 2/10 [00:12<00:47,  5.96s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9221, 'compress@10': 0.1675, 'time@10': 6.1525}:  30%|███       | 3/10 [00:12<00:27,  3.92s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9255, 'compress@10': 0.1803, 'time@10': 6.1908}:  30%|███       | 3/10 [00:19<00:27,  3.92s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9255, 'compress@10': 0.1803, 'time@10': 6.1908}:  40%|████      | 4/10 [00:19<00:29,  4.88s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.9341, 'compress@10': 0.1922, 'time@10': 9.5757}:  40%|████      | 4/10 [00:30<00:29,  4.88s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.9341, 'compress@10': 0.1922, 'time@10': 9.5757}:  50%|█████     | 5/10 [00:30<00:36,  7.30s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0164, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.9436, 'compress@10': 0.1779, 'time@10': 9.626}:  50%|█████     | 5/10 [00:40<00:36,  7.30s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0164, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.9436, 'compress@10': 0.1779, 'time@10': 9.626}:  60%|██████    | 6/10 [00:40<00:32,  8.19s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9433, 'compress@10': 0.1606, 'time@10': 9.7283}:  60%|██████    | 6/10 [00:45<00:32,  8.19s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9433, 'compress@10': 0.1606, 'time@10': 9.7283}:  70%|███████   | 7/10 [00:45<00:21,  7.22s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9524, 'compress@10': 0.1462, 'time@10': 9.4805}:  70%|███████   | 7/10 [00:53<00:21,  7.22s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9524, 'compress@10': 0.1462, 'time@10': 9.4805}:  80%|████████  | 8/10 [00:53<00:14,  7.40s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9656, 'compress@10': 0.1647, 'time@10': 10.2327}:  80%|████████  | 8/10 [01:01<00:14,  7.40s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0212, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9656, 'compress@10': 0.1647, 'time@10': 10.2327}:  90%|█████████ | 9/10 [01:01<00:07,  7.64s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9636, 'compress@10': 0.1522, 'time@10': 10.1816}:  90%|█████████ | 9/10 [01:11<00:07,  7.64s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9636, 'compress@10': 0.1522, 'time@10': 10.1816}: 100%|██████████| 10/10 [01:11<00:00,  8.29s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9636, 'compress@10': 0.1522, 'time@10': 10.1816}: 100%|██████████| 10/10 [01:11<00:00,  7.17s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.020730897480588078
Avg hit ratio: 0.8781953245773281
Avg ndcg: 0.9635680583286931
Avg compression ratio: 0.15221176486850682
Avg train time: 10.181617856025696
Std train time: 5.393951479354295
[0.14999999999999997, 0.08333333333333333, 0.05, 0.18333333333333335, 0.21666666666666667, 0.08333333333333336, 0.016666666666666673, 0.016666666666666673, 0.31666666666666665, 0.016666666666666673]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.924, 'compress@10': 0.1947, 'time@10': 8.2493}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.924, 'compress@10': 0.1947, 'time@10': 8.2493}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.944, 'compress@10': 0.1538, 'time@10': 7.658}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it]  {'epoch': 29, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.944, 'compress@10': 0.1538, 'time@10': 7.658}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9129, 'compress@10': 0.1645, 'time@10': 5.9915}:  20%|██        | 2/10 [00:12<00:47,  5.89s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9129, 'compress@10': 0.1645, 'time@10': 5.9915}:  30%|███       | 3/10 [00:12<00:26,  3.82s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9204, 'compress@10': 0.1765, 'time@10': 6.0216}:  30%|███       | 3/10 [00:18<00:26,  3.82s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9204, 'compress@10': 0.1765, 'time@10': 6.0216}:  40%|████      | 4/10 [00:18<00:28,  4.74s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9316, 'compress@10': 0.1876, 'time@10': 9.3521}:  40%|████      | 4/10 [00:30<00:28,  4.74s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.9316, 'compress@10': 0.1876, 'time@10': 9.3521}:  50%|█████     | 5/10 [00:30<00:35,  7.13s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9381, 'compress@10': 0.1737, 'time@10': 9.4192}:  50%|█████     | 5/10 [00:39<00:35,  7.13s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9381, 'compress@10': 0.1737, 'time@10': 9.4192}:  60%|██████    | 6/10 [00:39<00:32,  8.04s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9396, 'compress@10': 0.1569, 'time@10': 9.5696}:  60%|██████    | 6/10 [00:45<00:32,  8.04s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9396, 'compress@10': 0.1569, 'time@10': 9.5696}:  70%|███████   | 7/10 [00:45<00:21,  7.13s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9632, 'compress@10': 0.1428, 'time@10': 9.3127}:  70%|███████   | 7/10 [00:52<00:21,  7.13s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9632, 'compress@10': 0.1428, 'time@10': 9.3127}:  80%|████████  | 8/10 [00:52<00:14,  7.27s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9544, 'compress@10': 0.1643, 'time@10': 10.0863}:  80%|████████  | 8/10 [01:00<00:14,  7.27s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.9544, 'compress@10': 0.1643, 'time@10': 10.0863}:  90%|█████████ | 9/10 [01:00<00:07,  7.55s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9565, 'compress@10': 0.1518, 'time@10': 10.0375}:  90%|█████████ | 9/10 [01:10<00:07,  7.55s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9565, 'compress@10': 0.1518, 'time@10': 10.0375}: 100%|██████████| 10/10 [01:10<00:00,  8.20s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0162, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9565, 'compress@10': 0.1518, 'time@10': 10.0375}: 100%|██████████| 10/10 [01:10<00:00,  7.06s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.016238849217064123
Avg hit ratio: 0.8959731023551057
Avg ndcg: 0.9565462810939118
Avg compression ratio: 0.15179580845494955
Avg train time: 10.037531280517578
Std train time: 5.360161463120596
[0.1451612903225806, 0.08064516129032258, 0.048387096774193554, 0.1774193548387097, 0.20967741935483872, 0.0806451612903226, 0.016129032258064523, 0.04838709677419355, 0.3064516129032258, 0.016129032258064523]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.924, 'compress@10': 0.1902, 'time@10': 8.4137}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.924, 'compress@10': 0.1902, 'time@10': 8.4137}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9441, 'compress@10': 0.1502, 'time@10': 7.7433}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9441, 'compress@10': 0.1502, 'time@10': 7.7433}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.913, 'compress@10': 0.1616, 'time@10': 6.0601}:  20%|██        | 2/10 [00:12<00:47,  5.93s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.913, 'compress@10': 0.1616, 'time@10': 6.0601}:  30%|███       | 3/10 [00:12<00:26,  3.85s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9246, 'compress@10': 0.1729, 'time@10': 6.0926}:  30%|███       | 3/10 [00:18<00:26,  3.85s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9246, 'compress@10': 0.1729, 'time@10': 6.0926}:  40%|████      | 4/10 [00:18<00:28,  4.79s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9319, 'compress@10': 0.1834, 'time@10': 9.5488}:  40%|████      | 4/10 [00:30<00:28,  4.79s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9319, 'compress@10': 0.1834, 'time@10': 9.5488}:  50%|█████     | 5/10 [00:30<00:36,  7.29s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.889, 'ndcg@10': 0.942, 'compress@10': 0.1697, 'time@10': 9.6469}:  50%|█████     | 5/10 [00:40<00:36,  7.29s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.016, 'hit_ratio@10': 0.889, 'ndcg@10': 0.942, 'compress@10': 0.1697, 'time@10': 9.6469}:  60%|██████    | 6/10 [00:40<00:33,  8.27s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9433, 'compress@10': 0.1534, 'time@10': 9.7619}:  60%|██████    | 6/10 [00:46<00:33,  8.27s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9433, 'compress@10': 0.1534, 'time@10': 9.7619}:  70%|███████   | 7/10 [00:46<00:21,  7.29s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9452, 'compress@10': 0.1437, 'time@10': 9.5155}:  70%|███████   | 7/10 [00:53<00:21,  7.29s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.9082, 'ndcg@10': 0.9452, 'compress@10': 0.1437, 'time@10': 9.5155}:  80%|████████  | 8/10 [00:53<00:14,  7.46s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9474, 'compress@10': 0.164, 'time@10': 10.2734}:  80%|████████  | 8/10 [01:02<00:14,  7.46s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.8962, 'ndcg@10': 0.9474, 'compress@10': 0.164, 'time@10': 10.2734}:  90%|█████████ | 9/10 [01:02<00:07,  7.69s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9503, 'compress@10': 0.1514, 'time@10': 10.1982}:  90%|█████████ | 9/10 [01:11<00:07,  7.69s/it]  {'epoch': 30, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9503, 'compress@10': 0.1514, 'time@10': 10.1982}: 100%|██████████| 10/10 [01:11<00:00,  8.27s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9503, 'compress@10': 0.1514, 'time@10': 10.1982}: 100%|██████████| 10/10 [01:11<00:00,  7.17s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.013622254200555201
Avg hit ratio: 0.9042782738860838
Avg ndcg: 0.9502683974874586
Avg compression ratio: 0.1514088119559873
Avg train time: 10.198220133781433
Std train time: 5.503899221330684
[0.14062499999999994, 0.078125, 0.04687500000000001, 0.171875, 0.203125, 0.10937500000000003, 0.015625000000000007, 0.046875, 0.296875, 0.015625000000000007]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.924, 'compress@10': 0.1859, 'time@10': 8.7797}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.924, 'compress@10': 0.1859, 'time@10': 8.7797}:  10%|█         | 1/10 [00:04<00:39,  4.43s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.988, 'compress@10': 0.1469, 'time@10': 7.9213}:  10%|█         | 1/10 [00:11<00:39,  4.43s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.988, 'compress@10': 0.1469, 'time@10': 7.9213}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9422, 'compress@10': 0.1589, 'time@10': 6.1685}:  20%|██        | 2/10 [00:12<00:48,  6.01s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9422, 'compress@10': 0.1589, 'time@10': 6.1685}:  30%|███       | 3/10 [00:12<00:27,  3.89s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9485, 'compress@10': 0.1696, 'time@10': 6.174}:  30%|███       | 3/10 [00:19<00:27,  3.89s/it]  {'epoch': 31, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9485, 'compress@10': 0.1696, 'time@10': 6.174}:  40%|████      | 4/10 [00:19<00:28,  4.81s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9521, 'compress@10': 0.1795, 'time@10': 9.5162}:  40%|████      | 4/10 [00:30<00:28,  4.81s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.019, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9521, 'compress@10': 0.1795, 'time@10': 9.5162}:  50%|█████     | 5/10 [00:30<00:36,  7.22s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9545, 'compress@10': 0.1711, 'time@10': 9.6156}:  50%|█████     | 5/10 [00:40<00:36,  7.22s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9545, 'compress@10': 0.1711, 'time@10': 9.6156}:  60%|██████    | 6/10 [00:40<00:32,  8.21s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9536, 'compress@10': 0.1545, 'time@10': 9.7908}:  60%|██████    | 6/10 [00:46<00:32,  8.21s/it] {'epoch': 31, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9536, 'compress@10': 0.1545, 'time@10': 9.7908}:  70%|███████   | 7/10 [00:46<00:21,  7.31s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9554, 'compress@10': 0.1444, 'time@10': 9.5398}:  70%|███████   | 7/10 [00:54<00:21,  7.31s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9554, 'compress@10': 0.1444, 'time@10': 9.5398}:  80%|████████  | 8/10 [00:54<00:14,  7.47s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9564, 'compress@10': 0.1636, 'time@10': 10.2291}:  80%|████████  | 8/10 [01:01<00:14,  7.47s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9564, 'compress@10': 0.1636, 'time@10': 10.2291}:  90%|█████████ | 9/10 [01:01<00:07,  7.61s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9586, 'compress@10': 0.1511, 'time@10': 10.1867}:  90%|█████████ | 9/10 [01:11<00:07,  7.61s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9586, 'compress@10': 0.1511, 'time@10': 10.1867}: 100%|██████████| 10/10 [01:11<00:00,  8.30s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0149, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9586, 'compress@10': 0.1511, 'time@10': 10.1867}: 100%|██████████| 10/10 [01:11<00:00,  7.18s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.014872828468099725
Avg hit ratio: 0.90562748023529
Avg ndcg: 0.9585823269027361
Avg compression ratio: 0.1510533192473421
Avg train time: 10.186681199073792
Std train time: 5.317867466606596
[0.1363636363636363, 0.10606060606060606, 0.04545454545454546, 0.16666666666666666, 0.19696969696969696, 0.10606060606060609, 0.015151515151515159, 0.045454545454545456, 0.2878787878787879, 0.015151515151515159]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9189, 'compress@10': 0.1818, 'time@10': 8.1197}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9189, 'compress@10': 0.1818, 'time@10': 8.1197}:  10%|█         | 1/10 [00:04<00:36,  4.10s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9597, 'compress@10': 0.1584, 'time@10': 7.5691}:  10%|█         | 1/10 [00:11<00:36,  4.10s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9597, 'compress@10': 0.1584, 'time@10': 7.5691}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9234, 'compress@10': 0.1662, 'time@10': 5.9286}:  20%|██        | 2/10 [00:12<00:46,  5.84s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9234, 'compress@10': 0.1662, 'time@10': 5.9286}:  30%|███       | 3/10 [00:12<00:26,  3.79s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9317, 'compress@10': 0.1737, 'time@10': 6.0037}:  30%|███       | 3/10 [00:18<00:26,  3.79s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9317, 'compress@10': 0.1737, 'time@10': 6.0037}:  40%|████      | 4/10 [00:18<00:28,  4.77s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9425, 'compress@10': 0.1816, 'time@10': 9.3957}:  40%|████      | 4/10 [00:30<00:28,  4.77s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9425, 'compress@10': 0.1816, 'time@10': 9.3957}:  50%|█████     | 5/10 [00:30<00:36,  7.20s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9478, 'compress@10': 0.1723, 'time@10': 9.4643}:  50%|█████     | 5/10 [00:40<00:36,  7.20s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9478, 'compress@10': 0.1723, 'time@10': 9.4643}:  60%|██████    | 6/10 [00:40<00:32,  8.10s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9482, 'compress@10': 0.1555, 'time@10': 9.6108}:  60%|██████    | 6/10 [00:45<00:32,  8.10s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9482, 'compress@10': 0.1555, 'time@10': 9.6108}:  70%|███████   | 7/10 [00:45<00:21,  7.18s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9594, 'compress@10': 0.1452, 'time@10': 9.38}:  70%|███████   | 7/10 [00:53<00:21,  7.18s/it]    {'epoch': 32, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.9233, 'ndcg@10': 0.9594, 'compress@10': 0.1452, 'time@10': 9.38}:  80%|████████  | 8/10 [00:53<00:14,  7.38s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9599, 'compress@10': 0.1633, 'time@10': 10.1434}:  80%|████████  | 8/10 [01:01<00:14,  7.38s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9599, 'compress@10': 0.1633, 'time@10': 10.1434}:  90%|█████████ | 9/10 [01:01<00:07,  7.62s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9625, 'compress@10': 0.1507, 'time@10': 10.0853}:  90%|█████████ | 9/10 [01:11<00:07,  7.62s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9625, 'compress@10': 0.1507, 'time@10': 10.0853}: 100%|██████████| 10/10 [01:11<00:00,  8.24s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9625, 'compress@10': 0.1507, 'time@10': 10.0853}: 100%|██████████| 10/10 [01:11<00:00,  7.10s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.01790222671449983
Avg hit ratio: 0.9163417659495758
Avg ndcg: 0.9624509443729709
Avg compression ratio: 0.15070470472211392
Avg train time: 10.08527343273163
Std train time: 5.415079875685038
[0.13235294117647053, 0.10294117647058824, 0.04411764705882354, 0.16176470588235292, 0.19117647058823528, 0.10294117647058826, 0.014705882352941183, 0.04411764705882353, 0.27941176470588236, 0.04411764705882354]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9215, 'compress@10': 0.178, 'time@10': 8.3997}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9215, 'compress@10': 0.178, 'time@10': 8.3997}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9408, 'compress@10': 0.155, 'time@10': 7.7303}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9408, 'compress@10': 0.155, 'time@10': 7.7303}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9107, 'compress@10': 0.1635, 'time@10': 6.0574}:  20%|██        | 2/10 [00:12<00:47,  5.93s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9107, 'compress@10': 0.1635, 'time@10': 6.0574}:  30%|███       | 3/10 [00:12<00:26,  3.86s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9202, 'compress@10': 0.1706, 'time@10': 6.1599}:  30%|███       | 3/10 [00:19<00:26,  3.86s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9202, 'compress@10': 0.1706, 'time@10': 6.1599}:  40%|████      | 4/10 [00:19<00:29,  4.90s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9324, 'compress@10': 0.1779, 'time@10': 9.5543}:  40%|████      | 4/10 [00:30<00:29,  4.90s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9324, 'compress@10': 0.1779, 'time@10': 9.5543}:  50%|█████     | 5/10 [00:30<00:36,  7.32s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9442, 'compress@10': 0.1688, 'time@10': 9.6801}:  50%|█████     | 5/10 [00:41<00:36,  7.32s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9442, 'compress@10': 0.1688, 'time@10': 9.6801}:  60%|██████    | 6/10 [00:41<00:33,  8.35s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9451, 'compress@10': 0.1524, 'time@10': 9.8415}:  60%|██████    | 6/10 [00:46<00:33,  8.35s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9451, 'compress@10': 0.1524, 'time@10': 9.8415}:  70%|███████   | 7/10 [00:46<00:22,  7.40s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9381, 'compress@10': 0.1423, 'time@10': 9.566}:  70%|███████   | 7/10 [00:54<00:22,  7.40s/it]   {'epoch': 33, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9381, 'compress@10': 0.1423, 'time@10': 9.566}:  80%|████████  | 8/10 [00:54<00:14,  7.49s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9634, 'compress@10': 0.1598, 'time@10': 10.2901}:  80%|████████  | 8/10 [01:02<00:14,  7.49s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9634, 'compress@10': 0.1598, 'time@10': 10.2901}:  90%|█████████ | 9/10 [01:02<00:07,  7.67s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9647, 'compress@10': 0.1504, 'time@10': 10.2626}:  90%|█████████ | 9/10 [01:12<00:07,  7.67s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9647, 'compress@10': 0.1504, 'time@10': 10.2626}: 100%|██████████| 10/10 [01:12<00:00,  8.41s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9647, 'compress@10': 0.1504, 'time@10': 10.2626}: 100%|██████████| 10/10 [01:12<00:00,  7.25s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.015612556271522221
Avg hit ratio: 0.9099100953752906
Avg ndcg: 0.9646537547249097
Avg compression ratio: 0.15039715754577573
Avg train time: 10.262579584121704
Std train time: 5.402808604378945
[0.12857142857142853, 0.1, 0.042857142857142864, 0.1571428571428571, 0.1857142857142857, 0.10000000000000002, 0.014285714285714292, 0.04285714285714286, 0.3, 0.042857142857142864]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.1744, 'time@10': 8.342}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.1744, 'time@10': 8.342}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9891, 'compress@10': 0.1517, 'time@10': 7.7366}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0332, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9891, 'compress@10': 0.1517, 'time@10': 7.7366}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9429, 'compress@10': 0.161, 'time@10': 6.0348}:  20%|██        | 2/10 [00:12<00:47,  5.95s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.0233, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9429, 'compress@10': 0.161, 'time@10': 6.0348}:  30%|███       | 3/10 [00:12<00:26,  3.85s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9448, 'compress@10': 0.1676, 'time@10': 6.1105}:  30%|███       | 3/10 [00:19<00:26,  3.85s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9448, 'compress@10': 0.1676, 'time@10': 6.1105}:  40%|████      | 4/10 [00:19<00:29,  4.85s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.952, 'compress@10': 0.1745, 'time@10': 9.4393}:  40%|████      | 4/10 [00:30<00:29,  4.85s/it]   {'epoch': 34, 'num_users': 5.8, 'loss': 0.02, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.952, 'compress@10': 0.1745, 'time@10': 9.4393}:  50%|█████     | 5/10 [00:30<00:36,  7.23s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9555, 'compress@10': 0.1654, 'time@10': 9.5904}:  50%|█████     | 5/10 [00:40<00:36,  7.23s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9555, 'compress@10': 0.1654, 'time@10': 9.5904}:  60%|██████    | 6/10 [00:40<00:33,  8.31s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9564, 'compress@10': 0.1494, 'time@10': 9.7025}:  60%|██████    | 6/10 [00:46<00:33,  8.31s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9564, 'compress@10': 0.1494, 'time@10': 9.7025}:  70%|███████   | 7/10 [00:46<00:21,  7.30s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.019, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9779, 'compress@10': 0.1395, 'time@10': 9.4566}:  70%|███████   | 7/10 [00:53<00:21,  7.30s/it]   {'epoch': 34, 'num_users': 6.125, 'loss': 0.019, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9779, 'compress@10': 0.1395, 'time@10': 9.4566}:  80%|████████  | 8/10 [00:53<00:14,  7.45s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9819, 'compress@10': 0.1596, 'time@10': 10.1832}:  80%|████████  | 8/10 [01:01<00:14,  7.45s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9819, 'compress@10': 0.1596, 'time@10': 10.1832}:  90%|█████████ | 9/10 [01:01<00:07,  7.63s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9788, 'compress@10': 0.1501, 'time@10': 10.1342}:  90%|█████████ | 9/10 [01:11<00:07,  7.63s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9788, 'compress@10': 0.1501, 'time@10': 10.1342}: 100%|██████████| 10/10 [01:11<00:00,  8.28s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9788, 'compress@10': 0.1501, 'time@10': 10.1342}: 100%|██████████| 10/10 [01:11<00:00,  7.17s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.026791296490309285
Avg hit ratio: 0.8983791173926996
Avg ndcg: 0.9787512485119546
Avg compression ratio: 0.1500922592908798
Avg train time: 10.134173727035522
Std train time: 5.316249198283151
[0.12499999999999996, 0.09722222222222222, 0.04166666666666667, 0.15277777777777773, 0.18055555555555552, 0.09722222222222224, 0.013888888888888895, 0.041666666666666664, 0.3194444444444444, 0.04166666666666667]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9105, 'compress@10': 0.1711, 'time@10': 8.3035}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9105, 'compress@10': 0.1711, 'time@10': 8.3035}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.893, 'ndcg@10': 0.941, 'compress@10': 0.1487, 'time@10': 7.8084}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]  {'epoch': 35, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.893, 'ndcg@10': 0.941, 'compress@10': 0.1487, 'time@10': 7.8084}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9109, 'compress@10': 0.1587, 'time@10': 6.0793}:  20%|██        | 2/10 [00:12<00:48,  6.05s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9109, 'compress@10': 0.1587, 'time@10': 6.0793}:  30%|███       | 3/10 [00:12<00:27,  3.90s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9264, 'compress@10': 0.1648, 'time@10': 6.174}:  30%|███       | 3/10 [00:19<00:27,  3.90s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9264, 'compress@10': 0.1648, 'time@10': 6.174}:  40%|████      | 4/10 [00:19<00:29,  4.93s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9396, 'compress@10': 0.1712, 'time@10': 9.5687}:  40%|████      | 4/10 [00:30<00:29,  4.93s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9396, 'compress@10': 0.1712, 'time@10': 9.5687}:  50%|█████     | 5/10 [00:30<00:36,  7.34s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9455, 'compress@10': 0.1622, 'time@10': 9.6915}:  50%|█████     | 5/10 [00:41<00:36,  7.34s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.9455, 'compress@10': 0.1622, 'time@10': 9.6915}:  60%|██████    | 6/10 [00:41<00:33,  8.36s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9467, 'compress@10': 0.1467, 'time@10': 9.7913}:  60%|██████    | 6/10 [00:46<00:33,  8.36s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9467, 'compress@10': 0.1467, 'time@10': 9.7913}:  70%|███████   | 7/10 [00:46<00:22,  7.34s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9473, 'compress@10': 0.137, 'time@10': 9.51}:  70%|███████   | 7/10 [00:54<00:22,  7.34s/it]    {'epoch': 35, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9473, 'compress@10': 0.137, 'time@10': 9.51}:  80%|████████  | 8/10 [00:54<00:14,  7.41s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0165, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.9648, 'compress@10': 0.1594, 'time@10': 10.2479}:  80%|████████  | 8/10 [01:02<00:14,  7.41s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0165, 'hit_ratio@10': 0.9186, 'ndcg@10': 0.9648, 'compress@10': 0.1594, 'time@10': 10.2479}:  90%|█████████ | 9/10 [01:02<00:07,  7.63s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.9245, 'ndcg@10': 0.9658, 'compress@10': 0.1498, 'time@10': 10.2023}:  90%|█████████ | 9/10 [01:12<00:07,  7.63s/it]    {'epoch': 35, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.9245, 'ndcg@10': 0.9658, 'compress@10': 0.1498, 'time@10': 10.2023}: 100%|██████████| 10/10 [01:12<00:00,  8.31s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.9245, 'ndcg@10': 0.9658, 'compress@10': 0.1498, 'time@10': 10.2023}: 100%|██████████| 10/10 [01:12<00:00,  7.21s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.016974920674019435
Avg hit ratio: 0.9244620667014555
Avg ndcg: 0.96578748825312
Avg compression ratio: 0.1498036497070943
Avg train time: 10.20231990814209
Std train time: 5.419482874963092
[0.12162162162162159, 0.0945945945945946, 0.04054054054054054, 0.1486486486486486, 0.17567567567567566, 0.09459459459459461, 0.01351351351351352, 0.040540540540540536, 0.33783783783783783, 0.04054054054054054]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.1679, 'time@10': 8.2922}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9201, 'compress@10': 0.1679, 'time@10': 8.2922}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9421, 'compress@10': 0.1458, 'time@10': 7.72}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]    {'epoch': 36, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9421, 'compress@10': 0.1458, 'time@10': 7.72}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9116, 'compress@10': 0.1564, 'time@10': 6.0417}:  20%|██        | 2/10 [00:12<00:47,  5.95s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9116, 'compress@10': 0.1564, 'time@10': 6.0417}:  30%|███       | 3/10 [00:12<00:27,  3.86s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9218, 'compress@10': 0.1621, 'time@10': 6.0686}:  30%|███       | 3/10 [00:18<00:27,  3.86s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9218, 'compress@10': 0.1621, 'time@10': 6.0686}:  40%|████      | 4/10 [00:18<00:28,  4.78s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.009, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9337, 'compress@10': 0.1681, 'time@10': 9.4466}:  40%|████      | 4/10 [00:30<00:28,  4.78s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.009, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9337, 'compress@10': 0.1681, 'time@10': 9.4466}:  50%|█████     | 5/10 [00:30<00:36,  7.21s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0124, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9462, 'compress@10': 0.1592, 'time@10': 9.6338}:  50%|█████     | 5/10 [00:41<00:36,  7.21s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0124, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9462, 'compress@10': 0.1592, 'time@10': 9.6338}:  60%|██████    | 6/10 [00:41<00:33,  8.37s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9476, 'compress@10': 0.144, 'time@10': 9.8122}:  60%|██████    | 6/10 [00:46<00:33,  8.37s/it] {'epoch': 36, 'num_users': 6.2857, 'loss': 0.0113, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9476, 'compress@10': 0.144, 'time@10': 9.8122}:  70%|███████   | 7/10 [00:46<00:22,  7.42s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9594, 'compress@10': 0.1345, 'time@10': 9.5588}:  70%|███████   | 7/10 [00:54<00:22,  7.42s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9594, 'compress@10': 0.1345, 'time@10': 9.5588}:  80%|████████  | 8/10 [00:54<00:15,  7.55s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9598, 'compress@10': 0.1592, 'time@10': 10.2471}:  80%|████████  | 8/10 [01:02<00:15,  7.55s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9598, 'compress@10': 0.1592, 'time@10': 10.2471}:  90%|█████████ | 9/10 [01:02<00:07,  7.66s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9595, 'compress@10': 0.1495, 'time@10': 10.2169}:  90%|█████████ | 9/10 [01:12<00:07,  7.66s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9595, 'compress@10': 0.1495, 'time@10': 10.2169}: 100%|██████████| 10/10 [01:12<00:00,  8.39s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9595, 'compress@10': 0.1495, 'time@10': 10.2169}: 100%|██████████| 10/10 [01:12<00:00,  7.23s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.012903091441310632
Avg hit ratio: 0.9038271460665349
Avg ndcg: 0.9594957608473434
Avg compression ratio: 0.1495301726485574
Avg train time: 10.21691598892212
Std train time: 5.347402826797307
[0.11842105263157891, 0.09210526315789475, 0.03947368421052632, 0.1447368421052631, 0.17105263157894735, 0.11842105263157897, 0.013157894736842111, 0.039473684210526314, 0.3289473684210526, 0.03947368421052632]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.1648, 'time@10': 8.4027}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.1648, 'time@10': 8.4027}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9428, 'compress@10': 0.1431, 'time@10': 7.7787}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9428, 'compress@10': 0.1431, 'time@10': 7.7787}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9142, 'compress@10': 0.1543, 'time@10': 6.0786}:  20%|██        | 2/10 [00:12<00:47,  5.98s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9142, 'compress@10': 0.1543, 'time@10': 6.0786}:  30%|███       | 3/10 [00:12<00:27,  3.88s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9242, 'compress@10': 0.1596, 'time@10': 6.1248}:  30%|███       | 3/10 [00:19<00:27,  3.88s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9242, 'compress@10': 0.1596, 'time@10': 6.1248}:  40%|████      | 4/10 [00:19<00:29,  4.83s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9348, 'compress@10': 0.1652, 'time@10': 9.537}:  40%|████      | 4/10 [00:30<00:29,  4.83s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9348, 'compress@10': 0.1652, 'time@10': 9.537}:  50%|█████     | 5/10 [00:30<00:36,  7.28s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9417, 'compress@10': 0.1606, 'time@10': 9.655}:  50%|█████     | 5/10 [00:41<00:36,  7.28s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9417, 'compress@10': 0.1606, 'time@10': 9.655}:  60%|██████    | 6/10 [00:41<00:33,  8.30s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9434, 'compress@10': 0.1452, 'time@10': 9.7741}:  60%|██████    | 6/10 [00:46<00:33,  8.30s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0097, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9434, 'compress@10': 0.1452, 'time@10': 9.7741}:  70%|███████   | 7/10 [00:46<00:21,  7.32s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.015, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9678, 'compress@10': 0.1354, 'time@10': 9.5227}:  70%|███████   | 7/10 [00:54<00:21,  7.32s/it]   {'epoch': 37, 'num_users': 6.125, 'loss': 0.015, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9678, 'compress@10': 0.1354, 'time@10': 9.5227}:  80%|████████  | 8/10 [00:54<00:14,  7.47s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9657, 'compress@10': 0.1591, 'time@10': 10.2829}:  80%|████████  | 8/10 [01:02<00:14,  7.47s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9657, 'compress@10': 0.1591, 'time@10': 10.2829}:  90%|█████████ | 9/10 [01:02<00:07,  7.71s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9669, 'compress@10': 0.1493, 'time@10': 10.2501}:  90%|█████████ | 9/10 [01:12<00:07,  7.71s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9669, 'compress@10': 0.1493, 'time@10': 10.2501}: 100%|██████████| 10/10 [01:12<00:00,  8.41s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9669, 'compress@10': 0.1493, 'time@10': 10.2501}: 100%|██████████| 10/10 [01:12<00:00,  7.23s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.01441189575825888
Avg hit ratio: 0.9073192095585985
Avg ndcg: 0.9668742640147846
Avg compression ratio: 0.14928784373384402
Avg train time: 10.250127673149109
Std train time: 5.45223635666682
[0.11538461538461535, 0.08974358974358976, 0.038461538461538464, 0.14102564102564097, 0.16666666666666663, 0.1153846153846154, 0.012820512820512827, 0.0641025641025641, 0.3205128205128205, 0.038461538461538464]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.162, 'time@10': 8.0898}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.162, 'time@10': 8.0898}:  10%|█         | 1/10 [00:04<00:36,  4.10s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.939, 'compress@10': 0.1405, 'time@10': 7.5893}:  10%|█         | 1/10 [00:11<00:36,  4.10s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.939, 'compress@10': 0.1405, 'time@10': 7.5893}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9117, 'compress@10': 0.1523, 'time@10': 5.9724}:  20%|██        | 2/10 [00:12<00:47,  5.88s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9117, 'compress@10': 0.1523, 'time@10': 5.9724}:  30%|███       | 3/10 [00:12<00:26,  3.84s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9499, 'compress@10': 0.1572, 'time@10': 6.0595}:  30%|███       | 3/10 [00:18<00:26,  3.84s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9499, 'compress@10': 0.1572, 'time@10': 6.0595}:  40%|████      | 4/10 [00:18<00:29,  4.83s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.9548, 'compress@10': 0.1624, 'time@10': 9.4459}:  40%|████      | 4/10 [00:30<00:29,  4.83s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.9161, 'ndcg@10': 0.9548, 'compress@10': 0.1624, 'time@10': 9.4459}:  50%|█████     | 5/10 [00:30<00:36,  7.25s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.9264, 'ndcg@10': 0.9585, 'compress@10': 0.1578, 'time@10': 9.5878}:  50%|█████     | 5/10 [00:40<00:36,  7.25s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.9264, 'ndcg@10': 0.9585, 'compress@10': 0.1578, 'time@10': 9.5878}:  60%|██████    | 6/10 [00:40<00:33,  8.30s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0148, 'hit_ratio@10': 0.9312, 'ndcg@10': 0.9637, 'compress@10': 0.1428, 'time@10': 9.7337}:  60%|██████    | 6/10 [00:46<00:33,  8.30s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0148, 'hit_ratio@10': 0.9312, 'ndcg@10': 0.9637, 'compress@10': 0.1428, 'time@10': 9.7337}:  70%|███████   | 7/10 [00:46<00:21,  7.33s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9362, 'ndcg@10': 0.9638, 'compress@10': 0.1363, 'time@10': 9.4746}:  70%|███████   | 7/10 [00:53<00:21,  7.33s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9362, 'ndcg@10': 0.9638, 'compress@10': 0.1363, 'time@10': 9.4746}:  80%|████████  | 8/10 [00:53<00:14,  7.45s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.9211, 'ndcg@10': 0.9641, 'compress@10': 0.1589, 'time@10': 10.1649}:  80%|████████  | 8/10 [01:01<00:14,  7.45s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.9211, 'ndcg@10': 0.9641, 'compress@10': 0.1589, 'time@10': 10.1649}:  90%|█████████ | 9/10 [01:01<00:07,  7.58s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.9267, 'ndcg@10': 0.9629, 'compress@10': 0.149, 'time@10': 10.1348}:  90%|█████████ | 9/10 [01:11<00:07,  7.58s/it]     {'epoch': 38, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.9267, 'ndcg@10': 0.9629, 'compress@10': 0.149, 'time@10': 10.1348}: 100%|██████████| 10/10 [01:11<00:00,  8.30s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.9267, 'ndcg@10': 0.9629, 'compress@10': 0.149, 'time@10': 10.1348}: 100%|██████████| 10/10 [01:11<00:00,  7.17s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.015034305338652989
Avg hit ratio: 0.926707330398332
Avg ndcg: 0.9629241383964011
Avg compression ratio: 0.14904354047333274
Avg train time: 10.134791827201843
Std train time: 5.341242465905013
[0.11249999999999996, 0.08750000000000001, 0.037500000000000006, 0.16249999999999995, 0.16249999999999998, 0.11250000000000002, 0.012500000000000006, 0.06249999999999999, 0.3125, 0.037500000000000006]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9226, 'compress@10': 0.1592, 'time@10': 8.3327}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9226, 'compress@10': 0.1592, 'time@10': 8.3327}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0292, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9862, 'compress@10': 0.1381, 'time@10': 7.764}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it] {'epoch': 39, 'num_users': 7.0, 'loss': 0.0292, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9862, 'compress@10': 0.1381, 'time@10': 7.764}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9432, 'compress@10': 0.1504, 'time@10': 6.0925}:  20%|██        | 2/10 [00:12<00:47,  5.99s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9432, 'compress@10': 0.1504, 'time@10': 6.0925}:  30%|███       | 3/10 [00:12<00:27,  3.90s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9485, 'compress@10': 0.1609, 'time@10': 6.1597}:  30%|███       | 3/10 [00:19<00:27,  3.90s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9485, 'compress@10': 0.1609, 'time@10': 6.1597}:  40%|████      | 4/10 [00:19<00:29,  4.89s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9573, 'compress@10': 0.1646, 'time@10': 9.5127}:  40%|████      | 4/10 [00:30<00:29,  4.89s/it]  {'epoch': 39, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9573, 'compress@10': 0.1646, 'time@10': 9.5127}:  50%|█████     | 5/10 [00:30<00:36,  7.27s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0149, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9604, 'compress@10': 0.1592, 'time@10': 9.6368}:  50%|█████     | 5/10 [00:41<00:36,  7.27s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0149, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9604, 'compress@10': 0.1592, 'time@10': 9.6368}:  60%|██████    | 6/10 [00:41<00:33,  8.30s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9601, 'compress@10': 0.1439, 'time@10': 9.8051}:  60%|██████    | 6/10 [00:46<00:33,  8.30s/it] {'epoch': 39, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9601, 'compress@10': 0.1439, 'time@10': 9.8051}:  70%|███████   | 7/10 [00:46<00:22,  7.37s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9303, 'ndcg@10': 0.9614, 'compress@10': 0.137, 'time@10': 9.5506}:  70%|███████   | 7/10 [00:54<00:22,  7.37s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9303, 'ndcg@10': 0.9614, 'compress@10': 0.137, 'time@10': 9.5506}:  80%|████████  | 8/10 [00:54<00:15,  7.51s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9598, 'compress@10': 0.1587, 'time@10': 10.275}:  80%|████████  | 8/10 [01:02<00:15,  7.51s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0137, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9598, 'compress@10': 0.1587, 'time@10': 10.275}:  90%|█████████ | 9/10 [01:02<00:07,  7.69s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9615, 'compress@10': 0.1488, 'time@10': 10.2361}:  90%|█████████ | 9/10 [01:12<00:07,  7.69s/it]  {'epoch': 39, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9615, 'compress@10': 0.1488, 'time@10': 10.2361}: 100%|██████████| 10/10 [01:12<00:00,  8.38s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9615, 'compress@10': 0.1488, 'time@10': 10.2361}: 100%|██████████| 10/10 [01:12<00:00,  7.23s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.012530527965331498
Avg hit ratio: 0.9162362602498426
Avg ndcg: 0.9615136580887521
Avg compression ratio: 0.14879139850730794
Avg train time: 10.236059474945069
Std train time: 5.343471424950614
[0.10975609756097557, 0.10975609756097562, 0.03658536585365854, 0.1585365853658536, 0.15853658536585363, 0.10975609756097562, 0.012195121951219518, 0.06097560975609755, 0.3048780487804878, 0.03658536585365854]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.1566, 'time@10': 8.2642}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9178, 'compress@10': 0.1566, 'time@10': 8.2642}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9616, 'compress@10': 0.1476, 'time@10': 7.6412}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9616, 'compress@10': 0.1476, 'time@10': 7.6412}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9268, 'compress@10': 0.1564, 'time@10': 6.0483}:  20%|██        | 2/10 [00:12<00:46,  5.87s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9268, 'compress@10': 0.1564, 'time@10': 6.0483}:  30%|███       | 3/10 [00:12<00:27,  3.86s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9376, 'compress@10': 0.1645, 'time@10': 6.0849}:  30%|███       | 3/10 [00:18<00:27,  3.86s/it]  {'epoch': 40, 'num_users': 5.0, 'loss': 0.012, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9376, 'compress@10': 0.1645, 'time@10': 6.0849}:  40%|████      | 4/10 [00:18<00:28,  4.80s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9465, 'compress@10': 0.1667, 'time@10': 9.4576}:  40%|████      | 4/10 [00:30<00:28,  4.80s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9465, 'compress@10': 0.1667, 'time@10': 9.4576}:  50%|█████     | 5/10 [00:30<00:36,  7.22s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.9156, 'ndcg@10': 0.9516, 'compress@10': 0.1605, 'time@10': 9.6176}:  50%|█████     | 5/10 [00:40<00:36,  7.22s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.9156, 'ndcg@10': 0.9516, 'compress@10': 0.1605, 'time@10': 9.6176}:  60%|██████    | 6/10 [00:40<00:33,  8.32s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.922, 'ndcg@10': 0.9526, 'compress@10': 0.1449, 'time@10': 9.7495}:  60%|██████    | 6/10 [00:46<00:33,  8.32s/it]  {'epoch': 40, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.922, 'ndcg@10': 0.9526, 'compress@10': 0.1449, 'time@10': 9.7495}:  70%|███████   | 7/10 [00:46<00:22,  7.34s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.9282, 'ndcg@10': 0.9549, 'compress@10': 0.1378, 'time@10': 9.5209}:  70%|███████   | 7/10 [00:54<00:22,  7.34s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.9282, 'ndcg@10': 0.9549, 'compress@10': 0.1378, 'time@10': 9.5209}:  80%|████████  | 8/10 [00:54<00:15,  7.53s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9798, 'compress@10': 0.1586, 'time@10': 10.2387}:  80%|████████  | 8/10 [01:02<00:15,  7.53s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.9171, 'ndcg@10': 0.9798, 'compress@10': 0.1586, 'time@10': 10.2387}:  90%|█████████ | 9/10 [01:02<00:07,  7.69s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9788, 'compress@10': 0.1486, 'time@10': 10.2172}:  90%|█████████ | 9/10 [01:12<00:07,  7.69s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9788, 'compress@10': 0.1486, 'time@10': 10.2172}: 100%|██████████| 10/10 [01:12<00:00,  8.43s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9231, 'ndcg@10': 0.9788, 'compress@10': 0.1486, 'time@10': 10.2172}: 100%|██████████| 10/10 [01:12<00:00,  7.23s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.013120397356237079
Avg hit ratio: 0.923112860352249
Avg ndcg: 0.9788103304188229
Avg compression ratio: 0.1485615543138322
Avg train time: 10.217155480384827
Std train time: 5.339430331794165
[0.10714285714285711, 0.10714285714285715, 0.03571428571428572, 0.1547619047619047, 0.15476190476190474, 0.10714285714285715, 0.011904761904761911, 0.059523809523809514, 0.3214285714285714, 0.03571428571428572]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.1541, 'time@10': 8.2404}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.1541, 'time@10': 8.2404}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9501, 'compress@10': 0.145, 'time@10': 7.7096}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9501, 'compress@10': 0.145, 'time@10': 7.7096}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9191, 'compress@10': 0.1545, 'time@10': 6.0272}:  20%|██        | 2/10 [00:12<00:47,  5.96s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9191, 'compress@10': 0.1545, 'time@10': 6.0272}:  30%|███       | 3/10 [00:12<00:27,  3.86s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9396, 'compress@10': 0.1621, 'time@10': 6.0961}:  30%|███       | 3/10 [00:19<00:27,  3.86s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9396, 'compress@10': 0.1621, 'time@10': 6.0961}:  40%|████      | 4/10 [00:19<00:29,  4.84s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9486, 'compress@10': 0.164, 'time@10': 9.4807}:  40%|████      | 4/10 [00:30<00:29,  4.84s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9486, 'compress@10': 0.164, 'time@10': 9.4807}:  50%|█████     | 5/10 [00:30<00:36,  7.26s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9576, 'compress@10': 0.1579, 'time@10': 9.6288}:  50%|█████     | 5/10 [00:41<00:36,  7.26s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9576, 'compress@10': 0.1579, 'time@10': 9.6288}:  60%|██████    | 6/10 [00:41<00:33,  8.33s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9628, 'compress@10': 0.1427, 'time@10': 9.7651}:  60%|██████    | 6/10 [00:46<00:33,  8.33s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0152, 'hit_ratio@10': 0.9178, 'ndcg@10': 0.9628, 'compress@10': 0.1427, 'time@10': 9.7651}:  70%|███████   | 7/10 [00:46<00:22,  7.35s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.9245, 'ndcg@10': 0.964, 'compress@10': 0.1356, 'time@10': 9.514}:  70%|███████   | 7/10 [00:54<00:22,  7.35s/it]   {'epoch': 41, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.9245, 'ndcg@10': 0.964, 'compress@10': 0.1356, 'time@10': 9.514}:  80%|████████  | 8/10 [00:54<00:14,  7.49s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.9579, 'compress@10': 0.1584, 'time@10': 10.2078}:  80%|████████  | 8/10 [01:02<00:14,  7.49s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.9012, 'ndcg@10': 0.9579, 'compress@10': 0.1584, 'time@10': 10.2078}:  90%|█████████ | 9/10 [01:02<00:07,  7.62s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9651, 'compress@10': 0.1484, 'time@10': 10.1684}:  90%|█████████ | 9/10 [01:11<00:07,  7.62s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9651, 'compress@10': 0.1484, 'time@10': 10.1684}: 100%|██████████| 10/10 [01:11<00:00,  8.31s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.9088, 'ndcg@10': 0.9651, 'compress@10': 0.1484, 'time@10': 10.1684}: 100%|██████████| 10/10 [01:11<00:00,  7.19s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.02015152379458481
Avg hit ratio: 0.908770822461824
Avg ndcg: 0.9651220527690254
Avg compression ratio: 0.1483500906275803
Avg train time: 10.168437314033508
Std train time: 5.352218585279463
[0.10465116279069764, 0.10465116279069768, 0.034883720930232565, 0.15116279069767438, 0.1511627906976744, 0.10465116279069768, 0.011627906976744193, 0.05813953488372092, 0.3372093023255814, 0.034883720930232565]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.1518, 'time@10': 8.2736}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0093, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.1518, 'time@10': 8.2736}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9643, 'compress@10': 0.1427, 'time@10': 7.6464}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it] {'epoch': 42, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9643, 'compress@10': 0.1427, 'time@10': 7.6464}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9286, 'compress@10': 0.1527, 'time@10': 5.9968}:  20%|██        | 2/10 [00:12<00:46,  5.87s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9286, 'compress@10': 0.1527, 'time@10': 5.9968}:  30%|███       | 3/10 [00:12<00:26,  3.82s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9366, 'compress@10': 0.1599, 'time@10': 6.0531}:  30%|███       | 3/10 [00:18<00:26,  3.82s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9366, 'compress@10': 0.1599, 'time@10': 6.0531}:  40%|████      | 4/10 [00:18<00:28,  4.78s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.945, 'compress@10': 0.1615, 'time@10': 9.454}:  40%|████      | 4/10 [00:30<00:28,  4.78s/it] {'epoch': 42, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.945, 'compress@10': 0.1615, 'time@10': 9.454}:  50%|█████     | 5/10 [00:30<00:36,  7.23s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0078, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9503, 'compress@10': 0.1554, 'time@10': 9.5912}:  50%|█████     | 5/10 [00:40<00:36,  7.23s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0078, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9503, 'compress@10': 0.1554, 'time@10': 9.5912}:  60%|██████    | 6/10 [00:40<00:33,  8.28s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9511, 'compress@10': 0.1405, 'time@10': 9.7335}:  60%|██████    | 6/10 [00:46<00:33,  8.28s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.9159, 'ndcg@10': 0.9511, 'compress@10': 0.1405, 'time@10': 9.7335}:  70%|███████   | 7/10 [00:46<00:21,  7.32s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9229, 'ndcg@10': 0.9492, 'compress@10': 0.1336, 'time@10': 9.501}:  70%|███████   | 7/10 [00:54<00:21,  7.32s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9229, 'ndcg@10': 0.9492, 'compress@10': 0.1336, 'time@10': 9.501}:  80%|████████  | 8/10 [00:54<00:15,  7.51s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9665, 'compress@10': 0.1583, 'time@10': 10.2247}:  80%|████████  | 8/10 [01:02<00:15,  7.51s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9665, 'compress@10': 0.1583, 'time@10': 10.2247}:  90%|█████████ | 9/10 [01:02<00:07,  7.67s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9676, 'compress@10': 0.1482, 'time@10': 10.1898}:  90%|█████████ | 9/10 [01:11<00:07,  7.67s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9676, 'compress@10': 0.1482, 'time@10': 10.1898}: 100%|██████████| 10/10 [01:11<00:00,  8.37s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9676, 'compress@10': 0.1482, 'time@10': 10.1898}: 100%|██████████| 10/10 [01:11<00:00,  7.20s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.01094943565933287
Avg hit ratio: 0.916033495272884
Avg ndcg: 0.9675533765340925
Avg compression ratio: 0.14815183956266914
Avg train time: 10.189817094802857
Std train time: 5.391977490926998
[0.10227272727272724, 0.10227272727272728, 0.034090909090909095, 0.14772727272727268, 0.1477272727272727, 0.10227272727272728, 0.011363636363636371, 0.07954545454545453, 0.32954545454545453, 0.034090909090909095]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.1495, 'time@10': 8.2263}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 0.1495, 'time@10': 8.2263}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9621, 'compress@10': 0.1404, 'time@10': 7.6388}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9621, 'compress@10': 0.1404, 'time@10': 7.6388}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9271, 'compress@10': 0.151, 'time@10': 6.0421}:  20%|██        | 2/10 [00:12<00:47,  5.88s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9271, 'compress@10': 0.151, 'time@10': 6.0421}:  30%|███       | 3/10 [00:12<00:27,  3.86s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9364, 'compress@10': 0.1578, 'time@10': 6.1512}:  30%|███       | 3/10 [00:19<00:27,  3.86s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9364, 'compress@10': 0.1578, 'time@10': 6.1512}:  40%|████      | 4/10 [00:19<00:29,  4.96s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9451, 'compress@10': 0.1592, 'time@10': 9.5647}:  40%|████      | 4/10 [00:31<00:29,  4.96s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9451, 'compress@10': 0.1592, 'time@10': 9.5647}:  50%|█████     | 5/10 [00:31<00:36,  7.37s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.949, 'compress@10': 0.153, 'time@10': 9.6849}:  50%|█████     | 5/10 [00:41<00:36,  7.37s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.9097, 'ndcg@10': 0.949, 'compress@10': 0.153, 'time@10': 9.6849}:  60%|██████    | 6/10 [00:41<00:33,  8.38s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.9169, 'ndcg@10': 0.9502, 'compress@10': 0.1384, 'time@10': 9.8436}:  60%|██████    | 6/10 [00:46<00:33,  8.38s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.9169, 'ndcg@10': 0.9502, 'compress@10': 0.1384, 'time@10': 9.8436}:  70%|███████   | 7/10 [00:46<00:22,  7.41s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9237, 'ndcg@10': 0.971, 'compress@10': 0.1344, 'time@10': 9.5937}:  70%|███████   | 7/10 [00:54<00:22,  7.41s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.9237, 'ndcg@10': 0.971, 'compress@10': 0.1344, 'time@10': 9.5937}:  80%|████████  | 8/10 [00:54<00:15,  7.56s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.977, 'compress@10': 0.1582, 'time@10': 10.3292}:  80%|████████  | 8/10 [01:02<00:15,  7.56s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.977, 'compress@10': 0.1582, 'time@10': 10.3292}:  90%|█████████ | 9/10 [01:02<00:07,  7.75s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9753, 'compress@10': 0.148, 'time@10': 10.2898}:  90%|█████████ | 9/10 [01:12<00:07,  7.75s/it]    {'epoch': 43, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9753, 'compress@10': 0.148, 'time@10': 10.2898}: 100%|██████████| 10/10 [01:12<00:00,  8.43s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9753, 'compress@10': 0.148, 'time@10': 10.2898}: 100%|██████████| 10/10 [01:12<00:00,  7.28s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.01532760391979265
Avg hit ratio: 0.9109700032093919
Avg ndcg: 0.9752839663410592
Avg compression ratio: 0.1479599637114441
Avg train time: 10.289823770523071
Std train time: 5.415225198160542
[0.09999999999999996, 0.1, 0.03333333333333334, 0.1444444444444444, 0.14444444444444443, 0.1, 0.011111111111111118, 0.09999999999999998, 0.3222222222222222, 0.03333333333333334]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.1474, 'time@10': 8.2965}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.1474, 'time@10': 8.2965}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0071, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9501, 'compress@10': 0.1382, 'time@10': 7.7176}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0071, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9501, 'compress@10': 0.1382, 'time@10': 7.7176}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9191, 'compress@10': 0.1493, 'time@10': 6.048}:  20%|██        | 2/10 [00:12<00:47,  5.95s/it]  {'epoch': 44, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9191, 'compress@10': 0.1493, 'time@10': 6.048}:  30%|███       | 3/10 [00:12<00:27,  3.87s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9304, 'compress@10': 0.1557, 'time@10': 6.1233}:  30%|███       | 3/10 [00:19<00:27,  3.87s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9304, 'compress@10': 0.1557, 'time@10': 6.1233}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9386, 'compress@10': 0.1569, 'time@10': 9.4628}:  40%|████      | 4/10 [00:30<00:29,  4.86s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0074, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9386, 'compress@10': 0.1569, 'time@10': 9.4628}:  50%|█████     | 5/10 [00:30<00:36,  7.24s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9446, 'compress@10': 0.1507, 'time@10': 9.6249}:  50%|█████     | 5/10 [00:41<00:36,  7.24s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9446, 'compress@10': 0.1507, 'time@10': 9.6249}:  60%|██████    | 6/10 [00:41<00:33,  8.34s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9459, 'compress@10': 0.1364, 'time@10': 9.7541}:  60%|██████    | 6/10 [00:46<00:33,  8.34s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.9044, 'ndcg@10': 0.9459, 'compress@10': 0.1364, 'time@10': 9.7541}:  70%|███████   | 7/10 [00:46<00:22,  7.35s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9496, 'compress@10': 0.1351, 'time@10': 9.5017}:  70%|███████   | 7/10 [00:54<00:22,  7.35s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9496, 'compress@10': 0.1351, 'time@10': 9.5017}:  80%|████████  | 8/10 [00:54<00:14,  7.48s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9416, 'compress@10': 0.158, 'time@10': 10.232}:  80%|████████  | 8/10 [01:02<00:14,  7.48s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9416, 'compress@10': 0.158, 'time@10': 10.232}:  90%|█████████ | 9/10 [01:02<00:07,  7.67s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9515, 'compress@10': 0.1478, 'time@10': 10.1939}:  90%|█████████ | 9/10 [01:12<00:07,  7.67s/it] {'epoch': 44, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9515, 'compress@10': 0.1478, 'time@10': 10.1939}: 100%|██████████| 10/10 [01:12<00:00,  8.35s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9515, 'compress@10': 0.1478, 'time@10': 10.1939}: 100%|██████████| 10/10 [01:12<00:00,  7.21s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.01257577287903935
Avg hit ratio: 0.9051200288110305
Avg ndcg: 0.9514673025639844
Avg compression ratio: 0.14777545207123707
Avg train time: 10.193923473358154
Std train time: 5.3300872057555395
[0.0978260869565217, 0.09782608695652174, 0.03260869565217392, 0.14130434782608692, 0.14130434782608695, 0.09782608695652174, 0.010869565217391311, 0.09782608695652172, 0.3369565217391304, 0.03260869565217392]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.1453, 'time@10': 8.4698}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.1453, 'time@10': 8.4698}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9473, 'compress@10': 0.1361, 'time@10': 7.8183}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9473, 'compress@10': 0.1361, 'time@10': 7.8183}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9173, 'compress@10': 0.1477, 'time@10': 6.1258}:  20%|██        | 2/10 [00:12<00:47,  6.00s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9173, 'compress@10': 0.1477, 'time@10': 6.1258}:  30%|███       | 3/10 [00:12<00:27,  3.90s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9345, 'compress@10': 0.1538, 'time@10': 6.1668}:  30%|███       | 3/10 [00:19<00:27,  3.90s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9345, 'compress@10': 0.1538, 'time@10': 6.1668}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9444, 'compress@10': 0.1547, 'time@10': 9.5761}:  40%|████      | 4/10 [00:30<00:29,  4.86s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9444, 'compress@10': 0.1547, 'time@10': 9.5761}:  50%|█████     | 5/10 [00:30<00:36,  7.31s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.95, 'compress@10': 0.1486, 'time@10': 9.6842}:  50%|█████     | 5/10 [00:41<00:36,  7.31s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.9179, 'ndcg@10': 0.95, 'compress@10': 0.1486, 'time@10': 9.6842}:  60%|██████    | 6/10 [00:41<00:33,  8.31s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9511, 'compress@10': 0.1346, 'time@10': 9.8112}:  60%|██████    | 6/10 [00:46<00:33,  8.31s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.9239, 'ndcg@10': 0.9511, 'compress@10': 0.1346, 'time@10': 9.8112}:  70%|███████   | 7/10 [00:46<00:22,  7.33s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9566, 'compress@10': 0.1332, 'time@10': 9.5648}:  70%|███████   | 7/10 [00:54<00:22,  7.33s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9298, 'ndcg@10': 0.9566, 'compress@10': 0.1332, 'time@10': 9.5648}:  80%|████████  | 8/10 [00:54<00:15,  7.51s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0119, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9577, 'compress@10': 0.1579, 'time@10': 10.3455}:  80%|████████  | 8/10 [01:02<00:15,  7.51s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0119, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9577, 'compress@10': 0.1579, 'time@10': 10.3455}:  90%|█████████ | 9/10 [01:02<00:07,  7.77s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.9216, 'ndcg@10': 0.9596, 'compress@10': 0.1476, 'time@10': 10.3327}:  90%|█████████ | 9/10 [01:12<00:07,  7.77s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.9216, 'ndcg@10': 0.9596, 'compress@10': 0.1476, 'time@10': 10.3327}: 100%|██████████| 10/10 [01:12<00:00,  8.53s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.9216, 'ndcg@10': 0.9596, 'compress@10': 0.1476, 'time@10': 10.3327}: 100%|██████████| 10/10 [01:12<00:00,  7.29s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.011217181311419907
Avg hit ratio: 0.9216049238443127
Avg ndcg: 0.9596345335755322
Avg compression ratio: 0.14760059258735073
Avg train time: 10.33268404006958
Std train time: 5.466744830792594
[0.09574468085106379, 0.09574468085106383, 0.03191489361702128, 0.15957446808510634, 0.1382978723404255, 0.09574468085106383, 0.010638297872340432, 0.0957446808510638, 0.3297872340425531, 0.03191489361702128]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.1433, 'time@10': 8.6535}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.1433, 'time@10': 8.6535}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9597, 'compress@10': 0.1341, 'time@10': 7.9294}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9597, 'compress@10': 0.1341, 'time@10': 7.9294}:  20%|██        | 2/10 [00:11<00:48,  6.06s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9255, 'compress@10': 0.1462, 'time@10': 6.2466}:  20%|██        | 2/10 [00:13<00:48,  6.06s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9255, 'compress@10': 0.1462, 'time@10': 6.2466}:  30%|███       | 3/10 [00:13<00:27,  3.97s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9347, 'compress@10': 0.157, 'time@10': 6.2943}:  30%|███       | 3/10 [00:19<00:27,  3.97s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9347, 'compress@10': 0.157, 'time@10': 6.2943}:  40%|████      | 4/10 [00:19<00:29,  4.96s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.944, 'compress@10': 0.1567, 'time@10': 9.782}:  40%|████      | 4/10 [00:31<00:29,  4.96s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.944, 'compress@10': 0.1567, 'time@10': 9.782}:  50%|█████     | 5/10 [00:31<00:37,  7.46s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9566, 'compress@10': 0.1499, 'time@10': 9.8483}:  50%|█████     | 5/10 [00:41<00:37,  7.46s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9566, 'compress@10': 0.1499, 'time@10': 9.8483}:  60%|██████    | 6/10 [00:41<00:33,  8.40s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9571, 'compress@10': 0.1357, 'time@10': 9.9545}:  60%|██████    | 6/10 [00:47<00:33,  8.40s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0125, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9571, 'compress@10': 0.1357, 'time@10': 9.9545}:  70%|███████   | 7/10 [00:47<00:22,  7.40s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9627, 'compress@10': 0.1339, 'time@10': 9.6927}:  70%|███████   | 7/10 [00:54<00:22,  7.40s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9627, 'compress@10': 0.1339, 'time@10': 9.6927}:  80%|████████  | 8/10 [00:54<00:15,  7.56s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9629, 'compress@10': 0.1578, 'time@10': 10.406}:  80%|████████  | 8/10 [01:03<00:15,  7.56s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9629, 'compress@10': 0.1578, 'time@10': 10.406}:  90%|█████████ | 9/10 [01:03<00:07,  7.72s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9651, 'compress@10': 0.1474, 'time@10': 10.3571}:  90%|█████████ | 9/10 [01:12<00:07,  7.72s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9651, 'compress@10': 0.1474, 'time@10': 10.3571}: 100%|██████████| 10/10 [01:12<00:00,  8.41s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9651, 'compress@10': 0.1474, 'time@10': 10.3571}: 100%|██████████| 10/10 [01:12<00:00,  7.30s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.012033558937798379
Avg hit ratio: 0.9006243810895762
Avg ndcg: 0.9651426926999671
Avg compression ratio: 0.14741642518276205
Avg train time: 10.35708920955658
Std train time: 5.50129915540717
[0.09374999999999996, 0.09375, 0.03125000000000001, 0.15624999999999994, 0.13541666666666666, 0.11458333333333333, 0.010416666666666673, 0.09374999999999997, 0.3229166666666666, 0.03125000000000001]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.1414, 'time@10': 8.6362}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.1414, 'time@10': 8.6362}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9501, 'compress@10': 0.1322, 'time@10': 7.8627}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9501, 'compress@10': 0.1322, 'time@10': 7.8627}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9191, 'compress@10': 0.1447, 'time@10': 6.1822}:  20%|██        | 2/10 [00:12<00:47,  5.99s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9191, 'compress@10': 0.1447, 'time@10': 6.1822}:  30%|███       | 3/10 [00:12<00:27,  3.92s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9304, 'compress@10': 0.1551, 'time@10': 6.2519}:  30%|███       | 3/10 [00:19<00:27,  3.92s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9304, 'compress@10': 0.1551, 'time@10': 6.2519}:  40%|████      | 4/10 [00:19<00:29,  4.94s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0064, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9412, 'compress@10': 0.1546, 'time@10': 9.6625}:  40%|████      | 4/10 [00:31<00:29,  4.94s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0064, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9412, 'compress@10': 0.1546, 'time@10': 9.6625}:  50%|█████     | 5/10 [00:31<00:36,  7.37s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0057, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9473, 'compress@10': 0.1512, 'time@10': 9.7611}:  50%|█████     | 5/10 [00:41<00:36,  7.37s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0057, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9473, 'compress@10': 0.1512, 'time@10': 9.7611}:  60%|██████    | 6/10 [00:41<00:33,  8.36s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0063, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9488, 'compress@10': 0.1368, 'time@10': 9.8832}:  60%|██████    | 6/10 [00:46<00:33,  8.36s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0063, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9488, 'compress@10': 0.1368, 'time@10': 9.8832}:  70%|███████   | 7/10 [00:46<00:22,  7.38s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0067, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9509, 'compress@10': 0.1346, 'time@10': 9.6093}:  70%|███████   | 7/10 [00:54<00:22,  7.38s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0067, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9509, 'compress@10': 0.1346, 'time@10': 9.6093}:  80%|████████  | 8/10 [00:54<00:14,  7.49s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9749, 'compress@10': 0.1577, 'time@10': 10.3529}:  80%|████████  | 8/10 [01:02<00:14,  7.49s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9749, 'compress@10': 0.1577, 'time@10': 10.3529}:  90%|█████████ | 9/10 [01:02<00:07,  7.71s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9755, 'compress@10': 0.1473, 'time@10': 10.3389}:  90%|█████████ | 9/10 [01:12<00:07,  7.71s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9755, 'compress@10': 0.1473, 'time@10': 10.3389}: 100%|██████████| 10/10 [01:12<00:00,  8.49s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9755, 'compress@10': 0.1473, 'time@10': 10.3389}: 100%|██████████| 10/10 [01:12<00:00,  7.29s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.01104126789510481
Avg hit ratio: 0.9081200288110305
Avg ndcg: 0.9754637723165496
Avg compression ratio: 0.14726514357348577
Avg train time: 10.338929653167725
Std train time: 5.438733869797862
[0.09183673469387751, 0.09183673469387756, 0.03061224489795919, 0.15306122448979587, 0.13265306122448978, 0.11224489795918367, 0.010204081632653067, 0.09183673469387753, 0.33673469387755095, 0.03061224489795919]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.1396, 'time@10': 8.6977}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.1396, 'time@10': 8.6977}:  10%|█         | 1/10 [00:04<00:39,  4.39s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9467, 'compress@10': 0.1304, 'time@10': 7.8849}:  10%|█         | 1/10 [00:11<00:39,  4.39s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9467, 'compress@10': 0.1304, 'time@10': 7.8849}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9168, 'compress@10': 0.1433, 'time@10': 6.2125}:  20%|██        | 2/10 [00:12<00:47,  5.99s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9168, 'compress@10': 0.1433, 'time@10': 6.2125}:  30%|███       | 3/10 [00:12<00:27,  3.93s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9287, 'compress@10': 0.1533, 'time@10': 6.2484}:  30%|███       | 3/10 [00:19<00:27,  3.93s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9287, 'compress@10': 0.1533, 'time@10': 6.2484}:  40%|████      | 4/10 [00:19<00:29,  4.90s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9394, 'compress@10': 0.1526, 'time@10': 9.6426}:  40%|████      | 4/10 [00:31<00:29,  4.90s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9394, 'compress@10': 0.1526, 'time@10': 9.6426}:  50%|█████     | 5/10 [00:31<00:36,  7.33s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9457, 'compress@10': 0.1492, 'time@10': 9.7768}:  50%|█████     | 5/10 [00:41<00:36,  7.33s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9457, 'compress@10': 0.1492, 'time@10': 9.7768}:  60%|██████    | 6/10 [00:41<00:33,  8.41s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9509, 'compress@10': 0.135, 'time@10': 9.9439}:  60%|██████    | 6/10 [00:47<00:33,  8.41s/it] {'epoch': 48, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9509, 'compress@10': 0.135, 'time@10': 9.9439}:  70%|███████   | 7/10 [00:47<00:22,  7.46s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9481, 'compress@10': 0.1328, 'time@10': 9.6749}:  70%|███████   | 7/10 [00:54<00:22,  7.46s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9481, 'compress@10': 0.1328, 'time@10': 9.6749}:  80%|████████  | 8/10 [00:54<00:15,  7.58s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9562, 'compress@10': 0.1576, 'time@10': 10.374}:  80%|████████  | 8/10 [01:02<00:15,  7.58s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9562, 'compress@10': 0.1576, 'time@10': 10.374}:  90%|█████████ | 9/10 [01:02<00:07,  7.72s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9583, 'compress@10': 0.1471, 'time@10': 10.3418}:  90%|█████████ | 9/10 [01:12<00:07,  7.72s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9583, 'compress@10': 0.1471, 'time@10': 10.3418}: 100%|██████████| 10/10 [01:12<00:00,  8.45s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.9583, 'compress@10': 0.1471, 'time@10': 10.3418}: 100%|██████████| 10/10 [01:12<00:00,  7.29s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.015457744171506662
Avg hit ratio: 0.8921727681863505
Avg ndcg: 0.9582904239877275
Avg compression ratio: 0.14711301229592919
Avg train time: 10.34175672531128
Std train time: 5.381249292031009
[0.08999999999999997, 0.09000000000000001, 0.030000000000000006, 0.14999999999999994, 0.12999999999999998, 0.11, 0.010000000000000005, 0.08999999999999998, 0.3499999999999999, 0.030000000000000006]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.1379, 'time@10': 8.4793}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.1379, 'time@10': 8.4793}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9622, 'compress@10': 0.1286, 'time@10': 7.7548}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it] {'epoch': 49, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9622, 'compress@10': 0.1286, 'time@10': 7.7548}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9272, 'compress@10': 0.1419, 'time@10': 6.0976}:  20%|██        | 2/10 [00:12<00:47,  5.92s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9272, 'compress@10': 0.1419, 'time@10': 6.0976}:  30%|███       | 3/10 [00:12<00:27,  3.87s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9478, 'compress@10': 0.1516, 'time@10': 6.1587}:  30%|███       | 3/10 [00:19<00:27,  3.87s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9478, 'compress@10': 0.1516, 'time@10': 6.1587}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9542, 'compress@10': 0.1507, 'time@10': 9.5836}:  40%|████      | 4/10 [00:30<00:29,  4.86s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9542, 'compress@10': 0.1507, 'time@10': 9.5836}:  50%|█████     | 5/10 [00:30<00:36,  7.32s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9582, 'compress@10': 0.1472, 'time@10': 9.7216}:  50%|█████     | 5/10 [00:41<00:36,  7.32s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9582, 'compress@10': 0.1472, 'time@10': 9.7216}:  60%|██████    | 6/10 [00:41<00:33,  8.38s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9584, 'compress@10': 0.1333, 'time@10': 9.871}:  60%|██████    | 6/10 [00:46<00:33,  8.38s/it] {'epoch': 49, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9584, 'compress@10': 0.1333, 'time@10': 9.871}:  70%|███████   | 7/10 [00:46<00:22,  7.41s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9826, 'compress@10': 0.1311, 'time@10': 9.6161}:  70%|███████   | 7/10 [00:54<00:22,  7.41s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9826, 'compress@10': 0.1311, 'time@10': 9.6161}:  80%|████████  | 8/10 [00:54<00:15,  7.56s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9806, 'compress@10': 0.1575, 'time@10': 10.328}:  80%|████████  | 8/10 [01:02<00:15,  7.56s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.9016, 'ndcg@10': 0.9806, 'compress@10': 0.1575, 'time@10': 10.328}:  90%|█████████ | 9/10 [01:02<00:07,  7.71s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9804, 'compress@10': 0.147, 'time@10': 10.2849}:  90%|█████████ | 9/10 [01:12<00:07,  7.71s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9804, 'compress@10': 0.147, 'time@10': 10.2849}: 100%|██████████| 10/10 [01:12<00:00,  8.40s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0119, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9804, 'compress@10': 0.147, 'time@10': 10.2849}: 100%|██████████| 10/10 [01:12<00:00,  7.26s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.011933098544265297
Avg hit ratio: 0.909195809661005
Avg ndcg: 0.9803758315740401
Avg compression ratio: 0.14696574548987437
Avg train time: 10.284861278533935
Std train time: 5.422015473005894
[0.08823529411764702, 0.08823529411764706, 0.02941176470588236, 0.14705882352941171, 0.12745098039215683, 0.10784313725490197, 0.009803921568627456, 0.10784313725490194, 0.34313725490196073, 0.02941176470588236]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
