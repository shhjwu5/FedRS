  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1609, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5006, 'compress@10': 1.0, 'time@10': 3.5019}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1609, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5006, 'compress@10': 1.0, 'time@10': 3.5019}:   3%|▎         | 1/30 [00:01<00:51,  1.79s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1155, 'hit_ratio@10': 0.6604, 'ndcg@10': 0.6529, 'compress@10': 1.0, 'time@10': 2.8349}:   3%|▎         | 1/30 [00:03<00:51,  1.79s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1155, 'hit_ratio@10': 0.6604, 'ndcg@10': 0.6529, 'compress@10': 1.0, 'time@10': 2.8349}:   7%|▋         | 2/30 [00:03<00:56,  2.04s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8506, 'hit_ratio@10': 0.4879, 'ndcg@10': 0.4352, 'compress@10': 1.0, 'time@10': 2.1625}:   7%|▋         | 2/30 [00:04<00:56,  2.04s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8506, 'hit_ratio@10': 0.4879, 'ndcg@10': 0.4352, 'compress@10': 1.0, 'time@10': 2.1625}:  10%|█         | 3/30 [00:04<00:35,  1.31s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.667, 'hit_ratio@10': 0.5624, 'ndcg@10': 0.4754, 'compress@10': 1.0, 'time@10': 2.0812}:  10%|█         | 3/30 [00:06<00:35,  1.31s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.667, 'hit_ratio@10': 0.5624, 'ndcg@10': 0.4754, 'compress@10': 1.0, 'time@10': 2.0812}:  13%|█▎        | 4/30 [00:06<00:39,  1.54s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5523, 'hit_ratio@10': 0.6139, 'ndcg@10': 0.5331, 'compress@10': 1.0, 'time@10': 3.1198}:  13%|█▎        | 4/30 [00:10<00:39,  1.54s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5523, 'hit_ratio@10': 0.6139, 'ndcg@10': 0.5331, 'compress@10': 1.0, 'time@10': 3.1198}:  17%|█▋        | 5/30 [00:10<00:57,  2.31s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4746, 'hit_ratio@10': 0.6301, 'ndcg@10': 0.5796, 'compress@10': 1.0, 'time@10': 3.1266}:  17%|█▋        | 5/30 [00:13<00:57,  2.31s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4746, 'hit_ratio@10': 0.6301, 'ndcg@10': 0.5796, 'compress@10': 1.0, 'time@10': 3.1266}:  20%|██        | 6/30 [00:13<01:02,  2.61s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4214, 'hit_ratio@10': 0.6544, 'ndcg@10': 0.5832, 'compress@10': 1.0, 'time@10': 3.1748}:  20%|██        | 6/30 [00:14<01:02,  2.61s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4214, 'hit_ratio@10': 0.6544, 'ndcg@10': 0.5832, 'compress@10': 1.0, 'time@10': 3.1748}:  23%|██▎       | 7/30 [00:14<00:53,  2.34s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3745, 'hit_ratio@10': 0.6869, 'ndcg@10': 0.6102, 'compress@10': 1.0, 'time@10': 3.073}:  23%|██▎       | 7/30 [00:17<00:53,  2.34s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.3745, 'hit_ratio@10': 0.6869, 'ndcg@10': 0.6102, 'compress@10': 1.0, 'time@10': 3.073}:  27%|██▋       | 8/30 [00:17<00:52,  2.36s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3386, 'hit_ratio@10': 0.6963, 'ndcg@10': 0.6428, 'compress@10': 1.0, 'time@10': 3.2874}:  27%|██▋       | 8/30 [00:19<00:52,  2.36s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3386, 'hit_ratio@10': 0.6963, 'ndcg@10': 0.6428, 'compress@10': 1.0, 'time@10': 3.2874}:  30%|███       | 9/30 [00:19<00:50,  2.42s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3101, 'hit_ratio@10': 0.7198, 'ndcg@10': 0.6632, 'compress@10': 1.0, 'time@10': 3.2627}:  30%|███       | 9/30 [00:23<00:50,  2.42s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3101, 'hit_ratio@10': 0.7198, 'ndcg@10': 0.6632, 'compress@10': 1.0, 'time@10': 3.2627}:  33%|███▎      | 10/30 [00:23<00:52,  2.62s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.2934, 'hit_ratio@10': 0.7278, 'ndcg@10': 0.664, 'compress@10': 1.0, 'time@10': 3.3042}:  33%|███▎      | 10/30 [00:24<00:52,  2.62s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.2934, 'hit_ratio@10': 0.7278, 'ndcg@10': 0.664, 'compress@10': 1.0, 'time@10': 3.3042}:  37%|███▋      | 11/30 [00:24<00:45,  2.40s/it]{'epoch': 0, 'num_users': 6.4167, 'loss': 0.4491, 'hit_ratio@10': 0.7019, 'ndcg@10': 0.6112, 'compress@10': 1.0, 'time@10': 3.0933}:  37%|███▋      | 11/30 [00:25<00:45,  2.40s/it]{'epoch': 0, 'num_users': 6.4167, 'loss': 0.4491, 'hit_ratio@10': 0.7019, 'ndcg@10': 0.6112, 'compress@10': 1.0, 'time@10': 3.0933}:  40%|████      | 12/30 [00:25<00:34,  1.92s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.4258, 'hit_ratio@10': 0.7038, 'ndcg@10': 0.6115, 'compress@10': 1.0, 'time@10': 3.0991}:  40%|████      | 12/30 [00:27<00:34,  1.92s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.4258, 'hit_ratio@10': 0.7038, 'ndcg@10': 0.6115, 'compress@10': 1.0, 'time@10': 3.0991}:  43%|████▎     | 13/30 [00:27<00:31,  1.83s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.6037, 'hit_ratio@10': 0.6774, 'ndcg@10': 0.5678, 'compress@10': 1.0, 'time@10': 2.9024}:  43%|████▎     | 13/30 [00:27<00:31,  1.83s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.6037, 'hit_ratio@10': 0.6774, 'ndcg@10': 0.5678, 'compress@10': 1.0, 'time@10': 2.9024}:  47%|████▋     | 14/30 [00:27<00:22,  1.39s/it]{'epoch': 0, 'num_users': 6.2667, 'loss': 0.5686, 'hit_ratio@10': 0.6946, 'ndcg@10': 0.5782, 'compress@10': 1.0, 'time@10': 2.9856}:  47%|████▋     | 14/30 [00:29<00:22,  1.39s/it]{'epoch': 0, 'num_users': 6.2667, 'loss': 0.5686, 'hit_ratio@10': 0.6946, 'ndcg@10': 0.5782, 'compress@10': 1.0, 'time@10': 2.9856}:  50%|█████     | 15/30 [00:29<00:24,  1.61s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.6391, 'hit_ratio@10': 0.6668, 'ndcg@10': 0.5454, 'compress@10': 1.0, 'time@10': 2.8463}:  50%|█████     | 15/30 [00:30<00:24,  1.61s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.6391, 'hit_ratio@10': 0.6668, 'ndcg@10': 0.5454, 'compress@10': 1.0, 'time@10': 2.8463}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 0.7485, 'hit_ratio@10': 0.6393, 'ndcg@10': 0.5134, 'compress@10': 1.0, 'time@10': 2.7121}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 0.7485, 'hit_ratio@10': 0.6393, 'ndcg@10': 0.5134, 'compress@10': 1.0, 'time@10': 2.7121}:  57%|█████▋    | 17/30 [00:30<00:13,  1.06s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.7126, 'hit_ratio@10': 0.6455, 'ndcg@10': 0.5245, 'compress@10': 1.0, 'time@10': 2.6741}:  57%|█████▋    | 17/30 [00:33<00:13,  1.06s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.7126, 'hit_ratio@10': 0.6455, 'ndcg@10': 0.5245, 'compress@10': 1.0, 'time@10': 2.6741}:  60%|██████    | 18/30 [00:33<00:16,  1.36s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.7243, 'hit_ratio@10': 0.6341, 'ndcg@10': 0.5022, 'compress@10': 1.0, 'time@10': 2.6287}:  60%|██████    | 18/30 [00:33<00:16,  1.36s/it]   {'epoch': 0, 'num_users': 6.0, 'loss': 0.7243, 'hit_ratio@10': 0.6341, 'ndcg@10': 0.5022, 'compress@10': 1.0, 'time@10': 2.6287}:  63%|██████▎   | 19/30 [00:33<00:13,  1.23s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.6916, 'hit_ratio@10': 0.6436, 'ndcg@10': 0.5171, 'compress@10': 1.0, 'time@10': 2.6991}:  63%|██████▎   | 19/30 [00:38<00:13,  1.23s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.6916, 'hit_ratio@10': 0.6436, 'ndcg@10': 0.5171, 'compress@10': 1.0, 'time@10': 2.6991}:  67%|██████▋   | 20/30 [00:38<00:20,  2.09s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.6627, 'hit_ratio@10': 0.651, 'ndcg@10': 0.531, 'compress@10': 1.0, 'time@10': 2.8465}:  67%|██████▋   | 20/30 [00:41<00:20,  2.09s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.6627, 'hit_ratio@10': 0.651, 'ndcg@10': 0.531, 'compress@10': 1.0, 'time@10': 2.8465}:  70%|███████   | 21/30 [00:41<00:21,  2.34s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 0.6423, 'hit_ratio@10': 0.6586, 'ndcg@10': 0.5292, 'compress@10': 1.0, 'time@10': 2.7827}:  70%|███████   | 21/30 [00:42<00:21,  2.34s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 0.6423, 'hit_ratio@10': 0.6586, 'ndcg@10': 0.5292, 'compress@10': 1.0, 'time@10': 2.7827}:  73%|███████▎  | 22/30 [00:42<00:16,  2.08s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 0.6194, 'hit_ratio@10': 0.6583, 'ndcg@10': 0.5295, 'compress@10': 1.0, 'time@10': 2.777}:  73%|███████▎  | 22/30 [00:43<00:16,  2.08s/it] {'epoch': 0, 'num_users': 6.1304, 'loss': 0.6194, 'hit_ratio@10': 0.6583, 'ndcg@10': 0.5295, 'compress@10': 1.0, 'time@10': 2.777}:  77%|███████▋  | 23/30 [00:43<00:13,  1.87s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.704, 'hit_ratio@10': 0.6308, 'ndcg@10': 0.5074, 'compress@10': 1.0, 'time@10': 2.6726}:  77%|███████▋  | 23/30 [00:44<00:13,  1.87s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.704, 'hit_ratio@10': 0.6308, 'ndcg@10': 0.5074, 'compress@10': 1.0, 'time@10': 2.6726}:  80%|████████  | 24/30 [00:44<00:08,  1.40s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.7639, 'hit_ratio@10': 0.6056, 'ndcg@10': 0.4871, 'compress@10': 1.0, 'time@10': 2.5776}:  80%|████████  | 24/30 [00:44<00:08,  1.40s/it]  {'epoch': 0, 'num_users': 5.8, 'loss': 0.7639, 'hit_ratio@10': 0.6056, 'ndcg@10': 0.4871, 'compress@10': 1.0, 'time@10': 2.5776}:  83%|████████▎ | 25/30 [00:44<00:05,  1.04s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.7381, 'hit_ratio@10': 0.6147, 'ndcg@10': 0.4976, 'compress@10': 1.0, 'time@10': 2.7008}:  83%|████████▎ | 25/30 [00:50<00:05,  1.04s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.7381, 'hit_ratio@10': 0.6147, 'ndcg@10': 0.4976, 'compress@10': 1.0, 'time@10': 2.7008}:  87%|████████▋ | 26/30 [00:50<00:09,  2.47s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.7131, 'hit_ratio@10': 0.625, 'ndcg@10': 0.5062, 'compress@10': 1.0, 'time@10': 2.7444}:  87%|████████▋ | 26/30 [00:52<00:09,  2.47s/it] {'epoch': 0, 'num_users': 5.8889, 'loss': 0.7131, 'hit_ratio@10': 0.625, 'ndcg@10': 0.5062, 'compress@10': 1.0, 'time@10': 2.7444}:  90%|█████████ | 27/30 [00:52<00:06,  2.32s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.6898, 'hit_ratio@10': 0.6328, 'ndcg@10': 0.5196, 'compress@10': 1.0, 'time@10': 2.7774}:  90%|█████████ | 27/30 [00:55<00:06,  2.32s/it]  {'epoch': 0, 'num_users': 6.0, 'loss': 0.6898, 'hit_ratio@10': 0.6328, 'ndcg@10': 0.5196, 'compress@10': 1.0, 'time@10': 2.7774}:  93%|█████████▎| 28/30 [00:55<00:05,  2.74s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.67, 'hit_ratio@10': 0.6439, 'ndcg@10': 0.5208, 'compress@10': 1.0, 'time@10': 2.7789}:  93%|█████████▎| 28/30 [00:57<00:05,  2.74s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.67, 'hit_ratio@10': 0.6439, 'ndcg@10': 0.5208, 'compress@10': 1.0, 'time@10': 2.7789}:  97%|█████████▋| 29/30 [00:57<00:02,  2.35s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.6493, 'hit_ratio@10': 0.6494, 'ndcg@10': 0.5339, 'compress@10': 1.0, 'time@10': 2.7705}:  97%|█████████▋| 29/30 [00:59<00:02,  2.35s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.6493, 'hit_ratio@10': 0.6494, 'ndcg@10': 0.5339, 'compress@10': 1.0, 'time@10': 2.7705}: 100%|██████████| 30/30 [00:59<00:00,  2.42s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.6493, 'hit_ratio@10': 0.6494, 'ndcg@10': 0.5339, 'compress@10': 1.0, 'time@10': 2.7705}: 100%|██████████| 30/30 [00:59<00:00,  2.00s/it]
Epoch: 0
Avg # of users: 5.866666666666666
Avg Loss: 0.6492850982136192
Avg hit ratio: 0.649422516448378
Avg ndcg: 0.5338717082213649
Avg compression ratio: 0.9999999860153537
Avg train time: 2.770468521118164
Std train time: 1.7416767120806609
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[8, 12, 16, 13, 1, 9, 8, 11, 3, 9, 7, 16, 9, 18, 6, 17, 17, 12, 13, 6, 1, 14, 10, 18, 18, 1, 6, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0693, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.7673, 'compress@10': 1.0, 'time@10': 2.0654}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0693, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.7673, 'compress@10': 1.0, 'time@10': 2.0654}:   3%|▎         | 1/30 [00:01<00:30,  1.07s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0607, 'hit_ratio@10': 0.7453, 'ndcg@10': 0.8116, 'compress@10': 1.0, 'time@10': 2.4594}:   3%|▎         | 1/30 [00:03<00:30,  1.07s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0607, 'hit_ratio@10': 0.7453, 'ndcg@10': 0.8116, 'compress@10': 1.0, 'time@10': 2.4594}:   7%|▋         | 2/30 [00:03<00:59,  2.14s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0422, 'hit_ratio@10': 0.6874, 'ndcg@10': 0.8178, 'compress@10': 1.0, 'time@10': 2.1083}:   7%|▋         | 2/30 [00:04<00:59,  2.14s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0422, 'hit_ratio@10': 0.6874, 'ndcg@10': 0.8178, 'compress@10': 1.0, 'time@10': 2.1083}:  10%|█         | 3/30 [00:04<00:40,  1.50s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0438, 'hit_ratio@10': 0.7387, 'ndcg@10': 0.824, 'compress@10': 1.0, 'time@10': 2.3068}:  10%|█         | 3/30 [00:07<00:40,  1.50s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.0438, 'hit_ratio@10': 0.7387, 'ndcg@10': 0.824, 'compress@10': 1.0, 'time@10': 2.3068}:  13%|█▎        | 4/30 [00:07<00:53,  2.07s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.1064, 'hit_ratio@10': 0.7053, 'ndcg@10': 0.7403, 'compress@10': 1.0, 'time@10': 1.9861}:  13%|█▎        | 4/30 [00:08<00:53,  2.07s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.1064, 'hit_ratio@10': 0.7053, 'ndcg@10': 0.7403, 'compress@10': 1.0, 'time@10': 1.9861}:  17%|█▋        | 5/30 [00:08<00:36,  1.46s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.1022, 'hit_ratio@10': 0.7062, 'ndcg@10': 0.7524, 'compress@10': 1.0, 'time@10': 2.1442}:  17%|█▋        | 5/30 [00:10<00:36,  1.46s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.1022, 'hit_ratio@10': 0.7062, 'ndcg@10': 0.7524, 'compress@10': 1.0, 'time@10': 2.1442}:  20%|██        | 6/30 [00:10<00:47,  1.98s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.095, 'hit_ratio@10': 0.7425, 'ndcg@10': 0.7641, 'compress@10': 1.0, 'time@10': 2.2215}:  20%|██        | 6/30 [00:12<00:47,  1.98s/it] {'epoch': 1, 'num_users': 6.2857, 'loss': 0.095, 'hit_ratio@10': 0.7425, 'ndcg@10': 0.7641, 'compress@10': 1.0, 'time@10': 2.2215}:  23%|██▎       | 7/30 [00:12<00:40,  1.78s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0878, 'hit_ratio@10': 0.764, 'ndcg@10': 0.7774, 'compress@10': 1.0, 'time@10': 2.2847}:  23%|██▎       | 7/30 [00:15<00:40,  1.78s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0878, 'hit_ratio@10': 0.764, 'ndcg@10': 0.7774, 'compress@10': 1.0, 'time@10': 2.2847}:  27%|██▋       | 8/30 [00:15<00:46,  2.10s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0912, 'hit_ratio@10': 0.7553, 'ndcg@10': 0.7739, 'compress@10': 1.0, 'time@10': 2.1921}:  27%|██▋       | 8/30 [00:15<00:46,  2.10s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0912, 'hit_ratio@10': 0.7553, 'ndcg@10': 0.7739, 'compress@10': 1.0, 'time@10': 2.1921}:  30%|███       | 9/30 [00:15<00:35,  1.68s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0869, 'hit_ratio@10': 0.7729, 'ndcg@10': 0.7816, 'compress@10': 1.0, 'time@10': 2.2477}:  30%|███       | 9/30 [00:18<00:35,  1.68s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0869, 'hit_ratio@10': 0.7729, 'ndcg@10': 0.7816, 'compress@10': 1.0, 'time@10': 2.2477}:  33%|███▎      | 10/30 [00:18<00:40,  2.02s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0865, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.7836, 'compress@10': 1.0, 'time@10': 2.2756}:  33%|███▎      | 10/30 [00:20<00:40,  2.02s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0865, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.7836, 'compress@10': 1.0, 'time@10': 2.2756}:  37%|███▋      | 11/30 [00:20<00:34,  1.80s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.0809, 'hit_ratio@10': 0.7707, 'ndcg@10': 0.7955, 'compress@10': 1.0, 'time@10': 2.1865}:  37%|███▋      | 11/30 [00:21<00:34,  1.80s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.0809, 'hit_ratio@10': 0.7707, 'ndcg@10': 0.7955, 'compress@10': 1.0, 'time@10': 2.1865}:  40%|████      | 12/30 [00:21<00:29,  1.64s/it]{'epoch': 1, 'num_users': 6.6154, 'loss': 0.0791, 'hit_ratio@10': 0.7744, 'ndcg@10': 0.801, 'compress@10': 1.0, 'time@10': 2.2354}:  40%|████      | 12/30 [00:22<00:29,  1.64s/it] {'epoch': 1, 'num_users': 6.6154, 'loss': 0.0791, 'hit_ratio@10': 0.7744, 'ndcg@10': 0.801, 'compress@10': 1.0, 'time@10': 2.2354}:  43%|████▎     | 13/30 [00:22<00:26,  1.58s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.0753, 'hit_ratio@10': 0.7667, 'ndcg@10': 0.8005, 'compress@10': 1.0, 'time@10': 2.1197}:  43%|████▎     | 13/30 [00:23<00:26,  1.58s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.0753, 'hit_ratio@10': 0.7667, 'ndcg@10': 0.8005, 'compress@10': 1.0, 'time@10': 2.1197}:  47%|████▋     | 14/30 [00:23<00:20,  1.30s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.075, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.7997, 'compress@10': 1.0, 'time@10': 2.1444}:  47%|████▋     | 14/30 [00:24<00:20,  1.30s/it] {'epoch': 1, 'num_users': 6.2667, 'loss': 0.075, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.7997, 'compress@10': 1.0, 'time@10': 2.1444}:  50%|█████     | 15/30 [00:24<00:19,  1.29s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.0713, 'hit_ratio@10': 0.7826, 'ndcg@10': 0.8055, 'compress@10': 1.0, 'time@10': 2.0918}:  50%|█████     | 15/30 [00:25<00:19,  1.29s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.0713, 'hit_ratio@10': 0.7826, 'ndcg@10': 0.8055, 'compress@10': 1.0, 'time@10': 2.0918}:  53%|█████▎    | 16/30 [00:25<00:18,  1.31s/it]{'epoch': 1, 'num_users': 5.8235, 'loss': 0.0712, 'hit_ratio@10': 0.7718, 'ndcg@10': 0.7878, 'compress@10': 1.0, 'time@10': 2.0223}:  53%|█████▎    | 16/30 [00:26<00:18,  1.31s/it]{'epoch': 1, 'num_users': 5.8235, 'loss': 0.0712, 'hit_ratio@10': 0.7718, 'ndcg@10': 0.7878, 'compress@10': 1.0, 'time@10': 2.0223}:  57%|█████▋    | 17/30 [00:26<00:13,  1.07s/it]{'epoch': 1, 'num_users': 6.0556, 'loss': 0.0708, 'hit_ratio@10': 0.7686, 'ndcg@10': 0.7914, 'compress@10': 1.0, 'time@10': 2.042}:  57%|█████▋    | 17/30 [00:28<00:13,  1.07s/it] {'epoch': 1, 'num_users': 6.0556, 'loss': 0.0708, 'hit_ratio@10': 0.7686, 'ndcg@10': 0.7914, 'compress@10': 1.0, 'time@10': 2.042}:  60%|██████    | 18/30 [00:28<00:17,  1.47s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.0681, 'hit_ratio@10': 0.7733, 'ndcg@10': 0.7972, 'compress@10': 1.0, 'time@10': 2.0604}:  60%|██████    | 18/30 [00:30<00:17,  1.47s/it]  {'epoch': 1, 'num_users': 6.0, 'loss': 0.0681, 'hit_ratio@10': 0.7733, 'ndcg@10': 0.7972, 'compress@10': 1.0, 'time@10': 2.0604}:  63%|██████▎   | 19/30 [00:30<00:15,  1.40s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.0683, 'hit_ratio@10': 0.7767, 'ndcg@10': 0.7967, 'compress@10': 1.0, 'time@10': 2.0882}:  63%|██████▎   | 19/30 [00:32<00:15,  1.40s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.0683, 'hit_ratio@10': 0.7767, 'ndcg@10': 0.7967, 'compress@10': 1.0, 'time@10': 2.0882}:  67%|██████▋   | 20/30 [00:32<00:17,  1.78s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0892, 'hit_ratio@10': 0.7678, 'ndcg@10': 0.7788, 'compress@10': 1.0, 'time@10': 2.0155}:  67%|██████▋   | 20/30 [00:33<00:17,  1.78s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0892, 'hit_ratio@10': 0.7678, 'ndcg@10': 0.7788, 'compress@10': 1.0, 'time@10': 2.0155}:  70%|███████   | 21/30 [00:33<00:12,  1.34s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.0868, 'hit_ratio@10': 0.7742, 'ndcg@10': 0.7842, 'compress@10': 1.0, 'time@10': 2.0152}:  70%|███████   | 21/30 [00:35<00:12,  1.34s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.0868, 'hit_ratio@10': 0.7742, 'ndcg@10': 0.7842, 'compress@10': 1.0, 'time@10': 2.0152}:  73%|███████▎  | 22/30 [00:35<00:12,  1.55s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.0844, 'hit_ratio@10': 0.7775, 'ndcg@10': 0.7888, 'compress@10': 1.0, 'time@10': 2.0449}:  73%|███████▎  | 22/30 [00:36<00:12,  1.55s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.0844, 'hit_ratio@10': 0.7775, 'ndcg@10': 0.7888, 'compress@10': 1.0, 'time@10': 2.0449}:  77%|███████▋  | 23/30 [00:36<00:10,  1.50s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.0841, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.7766, 'compress@10': 1.0, 'time@10': 1.9807}:  77%|███████▋  | 23/30 [00:37<00:10,  1.50s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.0841, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.7766, 'compress@10': 1.0, 'time@10': 1.9807}:  80%|████████  | 24/30 [00:37<00:07,  1.21s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0924, 'hit_ratio@10': 0.7527, 'ndcg@10': 0.7519, 'compress@10': 1.0, 'time@10': 1.9224}:  80%|████████  | 24/30 [00:37<00:07,  1.21s/it]   {'epoch': 1, 'num_users': 5.8, 'loss': 0.0924, 'hit_ratio@10': 0.7527, 'ndcg@10': 0.7519, 'compress@10': 1.0, 'time@10': 1.9224}:  83%|████████▎ | 25/30 [00:37<00:04,  1.06it/s]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.1006, 'hit_ratio@10': 0.7446, 'ndcg@10': 0.7417, 'compress@10': 1.0, 'time@10': 1.8703}:  83%|████████▎ | 25/30 [00:37<00:04,  1.06it/s]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.1006, 'hit_ratio@10': 0.7446, 'ndcg@10': 0.7417, 'compress@10': 1.0, 'time@10': 1.8703}:  87%|████████▋ | 26/30 [00:37<00:03,  1.19it/s]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.0988, 'hit_ratio@10': 0.7501, 'ndcg@10': 0.7441, 'compress@10': 1.0, 'time@10': 1.8914}:  87%|████████▋ | 26/30 [00:39<00:03,  1.19it/s]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.0988, 'hit_ratio@10': 0.7501, 'ndcg@10': 0.7441, 'compress@10': 1.0, 'time@10': 1.8914}:  90%|█████████ | 27/30 [00:39<00:02,  1.04it/s]{'epoch': 1, 'num_users': 6.0, 'loss': 0.0973, 'hit_ratio@10': 0.7534, 'ndcg@10': 0.7487, 'compress@10': 1.0, 'time@10': 1.9133}:  90%|█████████ | 27/30 [00:41<00:02,  1.04it/s]   {'epoch': 1, 'num_users': 6.0, 'loss': 0.0973, 'hit_ratio@10': 0.7534, 'ndcg@10': 0.7487, 'compress@10': 1.0, 'time@10': 1.9133}:  93%|█████████▎| 28/30 [00:41<00:02,  1.44s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.0946, 'hit_ratio@10': 0.7588, 'ndcg@10': 0.7543, 'compress@10': 1.0, 'time@10': 1.9434}:  93%|█████████▎| 28/30 [00:43<00:02,  1.44s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.0946, 'hit_ratio@10': 0.7588, 'ndcg@10': 0.7543, 'compress@10': 1.0, 'time@10': 1.9434}:  97%|█████████▋| 29/30 [00:43<00:01,  1.43s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0927, 'hit_ratio@10': 0.7587, 'ndcg@10': 0.759, 'compress@10': 1.0, 'time@10': 1.9721}:  97%|█████████▋| 29/30 [00:46<00:01,  1.43s/it] {'epoch': 1, 'num_users': 5.8667, 'loss': 0.0927, 'hit_ratio@10': 0.7587, 'ndcg@10': 0.759, 'compress@10': 1.0, 'time@10': 1.9721}: 100%|██████████| 30/30 [00:46<00:00,  1.86s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0927, 'hit_ratio@10': 0.7587, 'ndcg@10': 0.759, 'compress@10': 1.0, 'time@10': 1.9721}: 100%|██████████| 30/30 [00:46<00:00,  1.54s/it]
Epoch: 1
Avg # of users: 5.866666666666666
Avg Loss: 0.09269755978929392
Avg hit ratio: 0.7587257662482758
Avg ndcg: 0.7590033371895688
Avg compression ratio: 0.9999999860166272
Avg train time: 1.9721287965774537
Std train time: 0.8783653950867029
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 20, 13, 8, 8, 8, 11, 7, 9, 8, 21, 9, 25, 7, 22, 23, 13, 14, 7, 8, 16, 10, 25, 25, 8, 7, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.843, 'compress@10': 1.0, 'time@10': 2.6264}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.843, 'compress@10': 1.0, 'time@10': 2.6264}:   3%|▎         | 1/30 [00:01<00:39,  1.35s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0499, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8467, 'compress@10': 1.0, 'time@10': 2.632}:   3%|▎         | 1/30 [00:04<00:39,  1.35s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0499, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8467, 'compress@10': 1.0, 'time@10': 2.632}:   7%|▋         | 2/30 [00:04<00:59,  2.13s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0334, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 2.2907}:   7%|▋         | 2/30 [00:04<00:59,  2.13s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0334, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 2.2907}:  10%|█         | 3/30 [00:04<00:41,  1.54s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 2.3407}:  10%|█         | 3/30 [00:07<00:41,  1.54s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 2.3407}:  13%|█▎        | 4/30 [00:07<00:50,  1.93s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.7785, 'ndcg@10': 0.836, 'compress@10': 1.0, 'time@10': 3.0201}:  13%|█▎        | 4/30 [00:10<00:50,  1.93s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.7785, 'ndcg@10': 0.836, 'compress@10': 1.0, 'time@10': 3.0201}:  17%|█▋        | 5/30 [00:10<00:57,  2.28s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0531, 'hit_ratio@10': 0.771, 'ndcg@10': 0.8326, 'compress@10': 1.0, 'time@10': 2.946}:  17%|█▋        | 5/30 [00:12<00:57,  2.28s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0531, 'hit_ratio@10': 0.771, 'ndcg@10': 0.8326, 'compress@10': 1.0, 'time@10': 2.946}:  20%|██        | 6/30 [00:12<00:57,  2.39s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0519, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8351, 'compress@10': 1.0, 'time@10': 2.9104}:  20%|██        | 6/30 [00:14<00:57,  2.39s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0519, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8351, 'compress@10': 1.0, 'time@10': 2.9104}:  23%|██▎       | 7/30 [00:14<00:47,  2.06s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0512, 'hit_ratio@10': 0.8125, 'ndcg@10': 0.8422, 'compress@10': 1.0, 'time@10': 2.8694}:  23%|██▎       | 7/30 [00:16<00:47,  2.06s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0512, 'hit_ratio@10': 0.8125, 'ndcg@10': 0.8422, 'compress@10': 1.0, 'time@10': 2.8694}:  27%|██▋       | 8/30 [00:16<00:49,  2.24s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0496, 'hit_ratio@10': 0.8016, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 2.9299}:  27%|██▋       | 8/30 [00:18<00:49,  2.24s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0496, 'hit_ratio@10': 0.8016, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 2.9299}:  30%|███       | 9/30 [00:18<00:43,  2.09s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8146, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 2.9098}:  30%|███       | 9/30 [00:21<00:43,  2.09s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8146, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 2.9098}:  33%|███▎      | 10/30 [00:21<00:45,  2.30s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.051, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 2.9509}:  33%|███▎      | 10/30 [00:23<00:45,  2.30s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.051, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 2.9509}:  37%|███▋      | 11/30 [00:23<00:40,  2.12s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0481, 'hit_ratio@10': 0.8087, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 2.8535}:  37%|███▋      | 11/30 [00:25<00:40,  2.12s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0481, 'hit_ratio@10': 0.8087, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 2.8535}:  40%|████      | 12/30 [00:25<00:36,  2.04s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0485, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 2.8795}:  40%|████      | 12/30 [00:26<00:36,  2.04s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0485, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 2.8795}:  43%|████▎     | 13/30 [00:26<00:32,  1.92s/it]{'epoch': 2, 'num_users': 6.3571, 'loss': 0.0459, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 2.7387}:  43%|████▎     | 13/30 [00:27<00:32,  1.92s/it]{'epoch': 2, 'num_users': 6.3571, 'loss': 0.0459, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 2.7387}:  47%|████▋     | 14/30 [00:27<00:25,  1.62s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.0469, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8544, 'compress@10': 1.0, 'time@10': 2.761}:  47%|████▋     | 14/30 [00:29<00:25,  1.62s/it] {'epoch': 2, 'num_users': 6.2667, 'loss': 0.0469, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8544, 'compress@10': 1.0, 'time@10': 2.761}:  50%|█████     | 15/30 [00:29<00:24,  1.61s/it]{'epoch': 2, 'num_users': 6.0625, 'loss': 0.0449, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8565, 'compress@10': 1.0, 'time@10': 2.6899}:  50%|█████     | 15/30 [00:30<00:24,  1.61s/it]{'epoch': 2, 'num_users': 6.0625, 'loss': 0.0449, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8565, 'compress@10': 1.0, 'time@10': 2.6899}:  53%|█████▎    | 16/30 [00:30<00:22,  1.62s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.0432, 'hit_ratio@10': 0.8149, 'ndcg@10': 0.8499, 'compress@10': 1.0, 'time@10': 2.6099}:  53%|█████▎    | 16/30 [00:31<00:22,  1.62s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.0432, 'hit_ratio@10': 0.8149, 'ndcg@10': 0.8499, 'compress@10': 1.0, 'time@10': 2.6099}:  57%|█████▋    | 17/30 [00:31<00:17,  1.35s/it]{'epoch': 2, 'num_users': 6.0556, 'loss': 0.0442, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 2.6077}:  57%|█████▋    | 17/30 [00:34<00:17,  1.35s/it]{'epoch': 2, 'num_users': 6.0556, 'loss': 0.0442, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 2.6077}:  60%|██████    | 18/30 [00:34<00:20,  1.73s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.0428, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8527, 'compress@10': 1.0, 'time@10': 2.602}:  60%|██████    | 18/30 [00:35<00:20,  1.73s/it]    {'epoch': 2, 'num_users': 6.0, 'loss': 0.0428, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8527, 'compress@10': 1.0, 'time@10': 2.602}:  63%|██████▎   | 19/30 [00:35<00:17,  1.60s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0442, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8492, 'compress@10': 1.0, 'time@10': 2.6185}:  63%|██████▎   | 19/30 [00:38<00:17,  1.60s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0442, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8492, 'compress@10': 1.0, 'time@10': 2.6185}:  67%|██████▋   | 20/30 [00:38<00:20,  2.01s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0457, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 2.7171}:  67%|██████▋   | 20/30 [00:40<00:20,  2.01s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0457, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 2.7171}:  70%|███████   | 21/30 [00:40<00:19,  2.12s/it]{'epoch': 2, 'num_users': 6.1818, 'loss': 0.0455, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.8506, 'compress@10': 1.0, 'time@10': 2.6982}:  70%|███████   | 21/30 [00:43<00:19,  2.12s/it]{'epoch': 2, 'num_users': 6.1818, 'loss': 0.0455, 'hit_ratio@10': 0.8219, 'ndcg@10': 0.8506, 'compress@10': 1.0, 'time@10': 2.6982}:  73%|███████▎  | 22/30 [00:43<00:17,  2.19s/it]{'epoch': 2, 'num_users': 6.1304, 'loss': 0.0446, 'hit_ratio@10': 0.8232, 'ndcg@10': 0.8527, 'compress@10': 1.0, 'time@10': 2.6948}:  73%|███████▎  | 22/30 [00:44<00:17,  2.19s/it]{'epoch': 2, 'num_users': 6.1304, 'loss': 0.0446, 'hit_ratio@10': 0.8232, 'ndcg@10': 0.8527, 'compress@10': 1.0, 'time@10': 2.6948}:  77%|███████▋  | 23/30 [00:44<00:13,  1.94s/it]{'epoch': 2, 'num_users': 5.9583, 'loss': 0.0443, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 2.6111}:  77%|███████▋  | 23/30 [00:45<00:13,  1.94s/it] {'epoch': 2, 'num_users': 5.9583, 'loss': 0.0443, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 2.6111}:  80%|████████  | 24/30 [00:45<00:09,  1.57s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0431, 'hit_ratio@10': 0.816, 'ndcg@10': 0.8348, 'compress@10': 1.0, 'time@10': 2.536}:  80%|████████  | 24/30 [00:45<00:09,  1.57s/it]    {'epoch': 2, 'num_users': 5.8, 'loss': 0.0431, 'hit_ratio@10': 0.816, 'ndcg@10': 0.8348, 'compress@10': 1.0, 'time@10': 2.536}:  83%|████████▎ | 25/30 [00:45<00:06,  1.22s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.0449, 'hit_ratio@10': 0.817, 'ndcg@10': 0.832, 'compress@10': 1.0, 'time@10': 2.6119}:  83%|████████▎ | 25/30 [00:50<00:06,  1.22s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.0449, 'hit_ratio@10': 0.817, 'ndcg@10': 0.832, 'compress@10': 1.0, 'time@10': 2.6119}:  87%|████████▋ | 26/30 [00:50<00:08,  2.22s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.0445, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8338, 'compress@10': 1.0, 'time@10': 2.6157}:  87%|████████▋ | 26/30 [00:51<00:08,  2.22s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.0445, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8338, 'compress@10': 1.0, 'time@10': 2.6157}:  90%|█████████ | 27/30 [00:51<00:05,  1.97s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.045, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8352, 'compress@10': 1.0, 'time@10': 2.6269}:  90%|█████████ | 27/30 [00:54<00:05,  1.97s/it]    {'epoch': 2, 'num_users': 6.0, 'loss': 0.045, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8352, 'compress@10': 1.0, 'time@10': 2.6269}:  93%|█████████▎| 28/30 [00:54<00:04,  2.27s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.0441, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8375, 'compress@10': 1.0, 'time@10': 2.6355}:  93%|█████████▎| 28/30 [00:56<00:04,  2.27s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.0441, 'hit_ratio@10': 0.8268, 'ndcg@10': 0.8375, 'compress@10': 1.0, 'time@10': 2.6355}:  97%|█████████▋| 29/30 [00:56<00:02,  2.03s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0439, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 2.6423}:  97%|█████████▋| 29/30 [00:58<00:02,  2.03s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0439, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 2.6423}: 100%|██████████| 30/30 [00:58<00:00,  2.29s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0439, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 2.6423}: 100%|██████████| 30/30 [00:58<00:00,  1.96s/it]
Epoch: 2
Avg # of users: 5.866666666666666
Avg Loss: 0.04393123165666673
Avg hit ratio: 0.8226575556058181
Avg ndcg: 0.8392451352730245
Avg compression ratio: 0.9999999860153537
Avg train time: 2.6423094113667807
Std train time: 1.070095815652216
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 24, 14, 1, 9, 8, 12, 5, 9, 6, 24, 8, 31, 6, 26, 28, 14, 15, 6, 2, 18, 10, 32, 32, 2, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 2.8184}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 2.8184}:   3%|▎         | 1/30 [00:01<00:41,  1.44s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8484, 'compress@10': 1.0, 'time@10': 2.7138}:   3%|▎         | 1/30 [00:04<00:41,  1.44s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8484, 'compress@10': 1.0, 'time@10': 2.7138}:   7%|▋         | 2/30 [00:04<01:00,  2.15s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8513, 'compress@10': 1.0, 'time@10': 2.4827}:   7%|▋         | 2/30 [00:05<01:00,  2.15s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8513, 'compress@10': 1.0, 'time@10': 2.4827}:  10%|█         | 3/30 [00:05<00:44,  1.65s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0361, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8494, 'compress@10': 1.0, 'time@10': 2.5444}:  10%|█         | 3/30 [00:07<00:44,  1.65s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0361, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8494, 'compress@10': 1.0, 'time@10': 2.5444}:  13%|█▎        | 4/30 [00:07<00:54,  2.09s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0731, 'hit_ratio@10': 0.7552, 'ndcg@10': 0.787, 'compress@10': 1.0, 'time@10': 2.1879}:  13%|█▎        | 4/30 [00:08<00:54,  2.09s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0731, 'hit_ratio@10': 0.7552, 'ndcg@10': 0.787, 'compress@10': 1.0, 'time@10': 2.1879}:  17%|█▋        | 5/30 [00:08<00:37,  1.49s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0738, 'hit_ratio@10': 0.7516, 'ndcg@10': 0.7917, 'compress@10': 1.0, 'time@10': 2.3148}:  17%|█▋        | 5/30 [00:11<00:37,  1.49s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0738, 'hit_ratio@10': 0.7516, 'ndcg@10': 0.7917, 'compress@10': 1.0, 'time@10': 2.3148}:  20%|██        | 6/30 [00:11<00:47,  2.00s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0697, 'hit_ratio@10': 0.7814, 'ndcg@10': 0.8013, 'compress@10': 1.0, 'time@10': 2.3939}:  20%|██        | 6/30 [00:12<00:47,  2.00s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0697, 'hit_ratio@10': 0.7814, 'ndcg@10': 0.8013, 'compress@10': 1.0, 'time@10': 2.3939}:  23%|██▎       | 7/30 [00:12<00:41,  1.82s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0692, 'hit_ratio@10': 0.8051, 'ndcg@10': 0.7986, 'compress@10': 1.0, 'time@10': 2.4785}:  23%|██▎       | 7/30 [00:15<00:41,  1.82s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0692, 'hit_ratio@10': 0.8051, 'ndcg@10': 0.7986, 'compress@10': 1.0, 'time@10': 2.4785}:  27%|██▋       | 8/30 [00:15<00:49,  2.23s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0662, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8105, 'compress@10': 1.0, 'time@10': 2.4787}:  27%|██▋       | 8/30 [00:17<00:49,  2.23s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0662, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8105, 'compress@10': 1.0, 'time@10': 2.4787}:  30%|███       | 9/30 [00:17<00:40,  1.93s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0647, 'hit_ratio@10': 0.8116, 'ndcg@10': 0.8143, 'compress@10': 1.0, 'time@10': 2.5045}:  30%|███       | 9/30 [00:19<00:40,  1.93s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0647, 'hit_ratio@10': 0.8116, 'ndcg@10': 0.8143, 'compress@10': 1.0, 'time@10': 2.5045}:  33%|███▎      | 10/30 [00:19<00:43,  2.19s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0649, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8179, 'compress@10': 1.0, 'time@10': 2.4883}:  33%|███▎      | 10/30 [00:21<00:43,  2.19s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0649, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8179, 'compress@10': 1.0, 'time@10': 2.4883}:  37%|███▋      | 11/30 [00:21<00:35,  1.89s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.0608, 'hit_ratio@10': 0.7992, 'ndcg@10': 0.8262, 'compress@10': 1.0, 'time@10': 2.4399}:  37%|███▋      | 11/30 [00:23<00:35,  1.89s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.0608, 'hit_ratio@10': 0.7992, 'ndcg@10': 0.8262, 'compress@10': 1.0, 'time@10': 2.4399}:  40%|████      | 12/30 [00:23<00:34,  1.91s/it]{'epoch': 3, 'num_users': 6.6154, 'loss': 0.0601, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.8299, 'compress@10': 1.0, 'time@10': 2.4373}:  40%|████      | 12/30 [00:24<00:34,  1.91s/it]{'epoch': 3, 'num_users': 6.6154, 'loss': 0.0601, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.8299, 'compress@10': 1.0, 'time@10': 2.4373}:  43%|████▎     | 13/30 [00:24<00:29,  1.72s/it]{'epoch': 3, 'num_users': 6.3571, 'loss': 0.0565, 'hit_ratio@10': 0.8062, 'ndcg@10': 0.8285, 'compress@10': 1.0, 'time@10': 2.3377}:  43%|████▎     | 13/30 [00:25<00:29,  1.72s/it]{'epoch': 3, 'num_users': 6.3571, 'loss': 0.0565, 'hit_ratio@10': 0.8062, 'ndcg@10': 0.8285, 'compress@10': 1.0, 'time@10': 2.3377}:  47%|████▋     | 14/30 [00:25<00:24,  1.53s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.0568, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8318, 'compress@10': 1.0, 'time@10': 2.3476}:  47%|████▋     | 14/30 [00:26<00:24,  1.53s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.0568, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8318, 'compress@10': 1.0, 'time@10': 2.3476}:  50%|█████     | 15/30 [00:26<00:21,  1.45s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.0542, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8345, 'compress@10': 1.0, 'time@10': 2.3264}:  50%|█████     | 15/30 [00:28<00:21,  1.45s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.0542, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8345, 'compress@10': 1.0, 'time@10': 2.3264}:  53%|█████▎    | 16/30 [00:28<00:22,  1.63s/it]{'epoch': 3, 'num_users': 5.8235, 'loss': 0.0516, 'hit_ratio@10': 0.8082, 'ndcg@10': 0.8292, 'compress@10': 1.0, 'time@10': 2.293}:  53%|█████▎    | 16/30 [00:29<00:22,  1.63s/it] {'epoch': 3, 'num_users': 5.8235, 'loss': 0.0516, 'hit_ratio@10': 0.8082, 'ndcg@10': 0.8292, 'compress@10': 1.0, 'time@10': 2.293}:  57%|█████▋    | 17/30 [00:29<00:18,  1.42s/it]{'epoch': 3, 'num_users': 6.0556, 'loss': 0.0521, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8307, 'compress@10': 1.0, 'time@10': 2.338}:  57%|█████▋    | 17/30 [00:32<00:18,  1.42s/it]{'epoch': 3, 'num_users': 6.0556, 'loss': 0.0521, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8307, 'compress@10': 1.0, 'time@10': 2.338}:  60%|██████    | 18/30 [00:32<00:23,  1.93s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.0503, 'hit_ratio@10': 0.8077, 'ndcg@10': 0.8343, 'compress@10': 1.0, 'time@10': 2.373}:  60%|██████    | 18/30 [00:34<00:23,  1.93s/it]   {'epoch': 3, 'num_users': 6.0, 'loss': 0.0503, 'hit_ratio@10': 0.8077, 'ndcg@10': 0.8343, 'compress@10': 1.0, 'time@10': 2.373}:  63%|██████▎   | 19/30 [00:34<00:20,  1.83s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.0513, 'hit_ratio@10': 0.8085, 'ndcg@10': 0.8325, 'compress@10': 1.0, 'time@10': 2.4004}:  63%|██████▎   | 19/30 [00:37<00:20,  1.83s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.0513, 'hit_ratio@10': 0.8085, 'ndcg@10': 0.8325, 'compress@10': 1.0, 'time@10': 2.4004}:  67%|██████▋   | 20/30 [00:37<00:21,  2.17s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0549, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8263, 'compress@10': 1.0, 'time@10': 2.3772}:  67%|██████▋   | 20/30 [00:38<00:21,  2.17s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0549, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8263, 'compress@10': 1.0, 'time@10': 2.3772}:  70%|███████   | 21/30 [00:38<00:16,  1.83s/it]{'epoch': 3, 'num_users': 6.1818, 'loss': 0.0547, 'hit_ratio@10': 0.807, 'ndcg@10': 0.8302, 'compress@10': 1.0, 'time@10': 2.3931}:  70%|███████   | 21/30 [00:41<00:16,  1.83s/it] {'epoch': 3, 'num_users': 6.1818, 'loss': 0.0547, 'hit_ratio@10': 0.807, 'ndcg@10': 0.8302, 'compress@10': 1.0, 'time@10': 2.3931}:  73%|███████▎  | 22/30 [00:41<00:16,  2.11s/it]{'epoch': 3, 'num_users': 6.1304, 'loss': 0.0533, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8332, 'compress@10': 1.0, 'time@10': 2.4038}:  73%|███████▎  | 22/30 [00:42<00:16,  2.11s/it]{'epoch': 3, 'num_users': 6.1304, 'loss': 0.0533, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8332, 'compress@10': 1.0, 'time@10': 2.4038}:  77%|███████▋  | 23/30 [00:42<00:13,  1.88s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.0521, 'hit_ratio@10': 0.8065, 'ndcg@10': 0.8279, 'compress@10': 1.0, 'time@10': 2.3404}:  77%|███████▋  | 23/30 [00:43<00:13,  1.88s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.0521, 'hit_ratio@10': 0.8065, 'ndcg@10': 0.8279, 'compress@10': 1.0, 'time@10': 2.3404}:  80%|████████  | 24/30 [00:43<00:09,  1.59s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0503, 'hit_ratio@10': 0.8009, 'ndcg@10': 0.8197, 'compress@10': 1.0, 'time@10': 2.2811}:  80%|████████  | 24/30 [00:43<00:09,  1.59s/it]   {'epoch': 3, 'num_users': 5.8, 'loss': 0.0503, 'hit_ratio@10': 0.8009, 'ndcg@10': 0.8197, 'compress@10': 1.0, 'time@10': 2.2811}:  83%|████████▎ | 25/30 [00:43<00:06,  1.26s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0531, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8143, 'compress@10': 1.0, 'time@10': 2.2368}:  83%|████████▎ | 25/30 [00:45<00:06,  1.26s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0531, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8143, 'compress@10': 1.0, 'time@10': 2.2368}:  87%|████████▋ | 26/30 [00:45<00:04,  1.24s/it]{'epoch': 3, 'num_users': 5.8889, 'loss': 0.0524, 'hit_ratio@10': 0.8007, 'ndcg@10': 0.817, 'compress@10': 1.0, 'time@10': 2.2575}:  87%|████████▋ | 26/30 [00:46<00:04,  1.24s/it] {'epoch': 3, 'num_users': 5.8889, 'loss': 0.0524, 'hit_ratio@10': 0.8007, 'ndcg@10': 0.817, 'compress@10': 1.0, 'time@10': 2.2575}:  90%|█████████ | 27/30 [00:46<00:03,  1.30s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.0525, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8189, 'compress@10': 1.0, 'time@10': 2.2701}:  90%|█████████ | 27/30 [00:49<00:03,  1.30s/it]  {'epoch': 3, 'num_users': 6.0, 'loss': 0.0525, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8189, 'compress@10': 1.0, 'time@10': 2.2701}:  93%|█████████▎| 28/30 [00:49<00:03,  1.70s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0514, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8211, 'compress@10': 1.0, 'time@10': 2.2887}:  93%|█████████▎| 28/30 [00:50<00:03,  1.70s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0514, 'hit_ratio@10': 0.8059, 'ndcg@10': 0.8211, 'compress@10': 1.0, 'time@10': 2.2887}:  97%|█████████▋| 29/30 [00:50<00:01,  1.63s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0514, 'hit_ratio@10': 0.8034, 'ndcg@10': 0.8233, 'compress@10': 1.0, 'time@10': 2.3046}:  97%|█████████▋| 29/30 [00:53<00:01,  1.63s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0514, 'hit_ratio@10': 0.8034, 'ndcg@10': 0.8233, 'compress@10': 1.0, 'time@10': 2.3046}: 100%|██████████| 30/30 [00:53<00:00,  1.98s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0514, 'hit_ratio@10': 0.8034, 'ndcg@10': 0.8233, 'compress@10': 1.0, 'time@10': 2.3046}: 100%|██████████| 30/30 [00:53<00:00,  1.78s/it]
Epoch: 3
Avg # of users: 5.866666666666666
Avg Loss: 0.05139415487022755
Avg hit ratio: 0.8033970256528199
Avg ndcg: 0.8232752720935673
Avg compression ratio: 0.9999999860153537
Avg train time: 2.304551919301351
Std train time: 0.7063310136356481
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 26, 14, 8, 8, 8, 11, 6, 9, 7, 27, 9, 37, 7, 28, 31, 13, 14, 6, 5, 18, 10, 38, 38, 7, 7, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 2.7002}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 2.7002}:   3%|▎         | 1/30 [00:01<00:40,  1.39s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8608, 'compress@10': 1.0, 'time@10': 2.773}:   3%|▎         | 1/30 [00:04<00:40,  1.39s/it]  {'epoch': 4, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8608, 'compress@10': 1.0, 'time@10': 2.773}:   7%|▋         | 2/30 [00:04<01:03,  2.27s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8596, 'compress@10': 1.0, 'time@10': 2.5946}:   7%|▋         | 2/30 [00:05<01:03,  2.27s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8596, 'compress@10': 1.0, 'time@10': 2.5946}:  10%|█         | 3/30 [00:05<00:47,  1.76s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0464, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8916, 'compress@10': 1.0, 'time@10': 2.6421}:  10%|█         | 3/30 [00:08<00:47,  1.76s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0464, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8916, 'compress@10': 1.0, 'time@10': 2.6421}:  13%|█▎        | 4/30 [00:08<00:56,  2.18s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.055, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8696, 'compress@10': 1.0, 'time@10': 3.2862}:  13%|█▎        | 4/30 [00:11<00:56,  2.18s/it] {'epoch': 4, 'num_users': 5.8, 'loss': 0.055, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8696, 'compress@10': 1.0, 'time@10': 3.2862}:  17%|█▋        | 5/30 [00:11<01:01,  2.47s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0588, 'hit_ratio@10': 0.7964, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 3.1615}:  17%|█▋        | 5/30 [00:13<01:01,  2.47s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0588, 'hit_ratio@10': 0.7964, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 3.1615}:  20%|██        | 6/30 [00:13<01:00,  2.51s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0576, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 3.1207}:  20%|██        | 6/30 [00:15<01:00,  2.51s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0576, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 3.1207}:  23%|██▎       | 7/30 [00:15<00:49,  2.17s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0567, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8588, 'compress@10': 1.0, 'time@10': 3.0594}:  23%|██▎       | 7/30 [00:17<00:49,  2.17s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0567, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8588, 'compress@10': 1.0, 'time@10': 3.0594}:  27%|██▋       | 8/30 [00:17<00:51,  2.33s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0554, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 3.0517}:  27%|██▋       | 8/30 [00:19<00:51,  2.33s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0554, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 3.0517}:  30%|███       | 9/30 [00:19<00:43,  2.08s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0547, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8622, 'compress@10': 1.0, 'time@10': 3.0156}:  30%|███       | 9/30 [00:22<00:43,  2.08s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0547, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8622, 'compress@10': 1.0, 'time@10': 3.0156}:  33%|███▎      | 10/30 [00:22<00:45,  2.28s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0557, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8616, 'compress@10': 1.0, 'time@10': 2.9845}:  33%|███▎      | 10/30 [00:23<00:45,  2.28s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0557, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8616, 'compress@10': 1.0, 'time@10': 2.9845}:  37%|███▋      | 11/30 [00:23<00:38,  2.00s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0523, 'hit_ratio@10': 0.8168, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 2.9105}:  37%|███▋      | 11/30 [00:25<00:38,  2.00s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0523, 'hit_ratio@10': 0.8168, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 2.9105}:  40%|████      | 12/30 [00:25<00:36,  2.04s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0524, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 2.9004}:  40%|████      | 12/30 [00:27<00:36,  2.04s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0524, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 2.9004}:  43%|████▎     | 13/30 [00:27<00:31,  1.86s/it]{'epoch': 4, 'num_users': 6.3571, 'loss': 0.0492, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 2.7876}:  43%|████▎     | 13/30 [00:28<00:31,  1.86s/it]{'epoch': 4, 'num_users': 6.3571, 'loss': 0.0492, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 2.7876}:  47%|████▋     | 14/30 [00:28<00:27,  1.72s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.0501, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 2.8066}:  47%|████▋     | 14/30 [00:30<00:27,  1.72s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.0501, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 2.8066}:  50%|█████     | 15/30 [00:30<00:25,  1.68s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.0479, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8615, 'compress@10': 1.0, 'time@10': 2.7644}:  50%|█████     | 15/30 [00:32<00:25,  1.68s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.0479, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8615, 'compress@10': 1.0, 'time@10': 2.7644}:  53%|█████▎    | 16/30 [00:32<00:25,  1.82s/it]{'epoch': 4, 'num_users': 5.8235, 'loss': 0.0456, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 2.7038}:  53%|█████▎    | 16/30 [00:33<00:25,  1.82s/it]{'epoch': 4, 'num_users': 5.8235, 'loss': 0.0456, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 2.7038}:  57%|█████▋    | 17/30 [00:33<00:20,  1.55s/it]{'epoch': 4, 'num_users': 6.0556, 'loss': 0.0463, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8546, 'compress@10': 1.0, 'time@10': 2.7029}:  57%|█████▋    | 17/30 [00:35<00:20,  1.55s/it]{'epoch': 4, 'num_users': 6.0556, 'loss': 0.0463, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8546, 'compress@10': 1.0, 'time@10': 2.7029}:  60%|██████    | 18/30 [00:35<00:22,  1.90s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0447, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8569, 'compress@10': 1.0, 'time@10': 2.6947}:  60%|██████    | 18/30 [00:37<00:22,  1.90s/it]   {'epoch': 4, 'num_users': 6.0, 'loss': 0.0447, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8569, 'compress@10': 1.0, 'time@10': 2.6947}:  63%|██████▎   | 19/30 [00:37<00:18,  1.72s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.046, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8541, 'compress@10': 1.0, 'time@10': 2.6841}:  63%|██████▎   | 19/30 [00:39<00:18,  1.72s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.046, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8541, 'compress@10': 1.0, 'time@10': 2.6841}:  67%|██████▋   | 20/30 [00:39<00:19,  1.96s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0478, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8517, 'compress@10': 1.0, 'time@10': 2.6929}:  67%|██████▋   | 20/30 [00:41<00:19,  1.96s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0478, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8517, 'compress@10': 1.0, 'time@10': 2.6929}:  70%|███████   | 21/30 [00:41<00:16,  1.82s/it]{'epoch': 4, 'num_users': 6.1818, 'loss': 0.0472, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 2.7128}:  70%|███████   | 21/30 [00:44<00:16,  1.82s/it]{'epoch': 4, 'num_users': 6.1818, 'loss': 0.0472, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 2.7128}:  73%|███████▎  | 22/30 [00:44<00:17,  2.23s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.0462, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8561, 'compress@10': 1.0, 'time@10': 2.7231}:  73%|███████▎  | 22/30 [00:45<00:17,  2.23s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.0462, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8561, 'compress@10': 1.0, 'time@10': 2.7231}:  77%|███████▋  | 23/30 [00:45<00:14,  2.02s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.0449, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 2.654}:  77%|███████▋  | 23/30 [00:47<00:14,  2.02s/it]  {'epoch': 4, 'num_users': 5.9583, 'loss': 0.0449, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 2.654}:  80%|████████  | 24/30 [00:47<00:10,  1.74s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0434, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8422, 'compress@10': 1.0, 'time@10': 2.5889}:  80%|████████  | 24/30 [00:47<00:10,  1.74s/it]  {'epoch': 4, 'num_users': 5.8, 'loss': 0.0434, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8422, 'compress@10': 1.0, 'time@10': 2.5889}:  83%|████████▎ | 25/30 [00:47<00:06,  1.38s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0451, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 2.6448}:  83%|████████▎ | 25/30 [00:51<00:06,  1.38s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0451, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 2.6448}:  87%|████████▋ | 26/30 [00:51<00:08,  2.19s/it]{'epoch': 4, 'num_users': 5.8889, 'loss': 0.0446, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8412, 'compress@10': 1.0, 'time@10': 2.6474}:  87%|████████▋ | 26/30 [00:53<00:08,  2.19s/it]{'epoch': 4, 'num_users': 5.8889, 'loss': 0.0446, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8412, 'compress@10': 1.0, 'time@10': 2.6474}:  90%|█████████ | 27/30 [00:53<00:05,  1.95s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.045, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8426, 'compress@10': 1.0, 'time@10': 2.6667}:  90%|█████████ | 27/30 [00:56<00:05,  1.95s/it]    {'epoch': 4, 'num_users': 6.0, 'loss': 0.045, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8426, 'compress@10': 1.0, 'time@10': 2.6667}:  93%|█████████▎| 28/30 [00:56<00:04,  2.34s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0447, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8438, 'compress@10': 1.0, 'time@10': 2.6755}:  93%|█████████▎| 28/30 [00:57<00:04,  2.34s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0447, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8438, 'compress@10': 1.0, 'time@10': 2.6755}:  97%|█████████▋| 29/30 [00:57<00:02,  2.08s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0452, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.847, 'compress@10': 1.0, 'time@10': 2.6802}:  97%|█████████▋| 29/30 [01:00<00:02,  2.08s/it] {'epoch': 4, 'num_users': 5.8667, 'loss': 0.0452, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.847, 'compress@10': 1.0, 'time@10': 2.6802}: 100%|██████████| 30/30 [01:00<00:00,  2.32s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0452, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.847, 'compress@10': 1.0, 'time@10': 2.6802}: 100%|██████████| 30/30 [01:00<00:00,  2.02s/it]
Epoch: 4
Avg # of users: 5.866666666666666
Avg Loss: 0.04523964008147606
Avg hit ratio: 0.8182623167514688
Avg ndcg: 0.8470338058935662
Avg compression ratio: 0.9999999860153537
Avg train time: 2.6802058935165407
Std train time: 0.8557995499921605
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 28, 14, 1, 9, 8, 11, 5, 9, 7, 29, 9, 42, 6, 30, 34, 13, 15, 7, 5, 17, 9, 44, 44, 3, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0518, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.839, 'compress@10': 1.0, 'time@10': 2.6101}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0518, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.839, 'compress@10': 1.0, 'time@10': 2.6101}:   3%|▎         | 1/30 [00:01<00:38,  1.34s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8534, 'compress@10': 1.0, 'time@10': 2.6922}:   3%|▎         | 1/30 [00:04<00:38,  1.34s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0509, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8534, 'compress@10': 1.0, 'time@10': 2.6922}:   7%|▋         | 2/30 [00:04<01:01,  2.21s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8546, 'compress@10': 1.0, 'time@10': 2.5546}:   7%|▋         | 2/30 [00:05<01:01,  2.21s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8546, 'compress@10': 1.0, 'time@10': 2.5546}:  10%|█         | 3/30 [00:05<00:47,  1.74s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0427, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 2.5959}:  10%|█         | 3/30 [00:08<00:47,  1.74s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0427, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 2.5959}:  13%|█▎        | 4/30 [00:08<00:55,  2.14s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0779, 'hit_ratio@10': 0.7903, 'ndcg@10': 0.8211, 'compress@10': 1.0, 'time@10': 2.2291}:  13%|█▎        | 4/30 [00:08<00:55,  2.14s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0779, 'hit_ratio@10': 0.7903, 'ndcg@10': 0.8211, 'compress@10': 1.0, 'time@10': 2.2291}:  17%|█▋        | 5/30 [00:08<00:38,  1.52s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0776, 'hit_ratio@10': 0.7882, 'ndcg@10': 0.8206, 'compress@10': 1.0, 'time@10': 2.3347}:  17%|█▋        | 5/30 [00:11<00:38,  1.52s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0776, 'hit_ratio@10': 0.7882, 'ndcg@10': 0.8206, 'compress@10': 1.0, 'time@10': 2.3347}:  20%|██        | 6/30 [00:11<00:47,  1.99s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0754, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8231, 'compress@10': 1.0, 'time@10': 2.3905}:  20%|██        | 6/30 [00:12<00:47,  1.99s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0754, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8231, 'compress@10': 1.0, 'time@10': 2.3905}:  23%|██▎       | 7/30 [00:12<00:41,  1.80s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0748, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8365, 'compress@10': 1.0, 'time@10': 2.4281}:  23%|██▎       | 7/30 [00:15<00:41,  1.80s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.0748, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8365, 'compress@10': 1.0, 'time@10': 2.4281}:  27%|██▋       | 8/30 [00:15<00:46,  2.09s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0715, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8436, 'compress@10': 1.0, 'time@10': 2.4436}:  27%|██▋       | 8/30 [00:16<00:46,  2.09s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0715, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8436, 'compress@10': 1.0, 'time@10': 2.4436}:  30%|███       | 9/30 [00:16<00:38,  1.85s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0688, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8454, 'compress@10': 1.0, 'time@10': 2.48}:  30%|███       | 9/30 [00:20<00:38,  1.85s/it]     {'epoch': 5, 'num_users': 6.3, 'loss': 0.0688, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8454, 'compress@10': 1.0, 'time@10': 2.48}:  33%|███▎      | 10/30 [00:20<00:45,  2.27s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0686, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 2.5024}:  33%|███▎      | 10/30 [00:21<00:45,  2.27s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0686, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 2.5024}:  37%|███▋      | 11/30 [00:21<00:38,  2.00s/it]{'epoch': 5, 'num_users': 6.4167, 'loss': 0.0642, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 2.4851}:  37%|███▋      | 11/30 [00:23<00:38,  2.00s/it] {'epoch': 5, 'num_users': 6.4167, 'loss': 0.0642, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 2.4851}:  40%|████      | 12/30 [00:23<00:37,  2.10s/it]{'epoch': 5, 'num_users': 6.6154, 'loss': 0.064, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8517, 'compress@10': 1.0, 'time@10': 2.5089}:  40%|████      | 12/30 [00:25<00:37,  2.10s/it]{'epoch': 5, 'num_users': 6.6154, 'loss': 0.064, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8517, 'compress@10': 1.0, 'time@10': 2.5089}:  43%|████▎     | 13/30 [00:25<00:32,  1.90s/it]{'epoch': 5, 'num_users': 6.3571, 'loss': 0.0599, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 2.4353}:  43%|████▎     | 13/30 [00:26<00:32,  1.90s/it]{'epoch': 5, 'num_users': 6.3571, 'loss': 0.0599, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 2.4353}:  47%|████▋     | 14/30 [00:26<00:28,  1.79s/it]{'epoch': 5, 'num_users': 6.2667, 'loss': 0.06, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8498, 'compress@10': 1.0, 'time@10': 2.441}:  47%|████▋     | 14/30 [00:28<00:28,  1.79s/it]  {'epoch': 5, 'num_users': 6.2667, 'loss': 0.06, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8498, 'compress@10': 1.0, 'time@10': 2.441}:  50%|█████     | 15/30 [00:28<00:24,  1.64s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.0571, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8516, 'compress@10': 1.0, 'time@10': 2.429}:  50%|█████     | 15/30 [00:30<00:24,  1.64s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.0571, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8516, 'compress@10': 1.0, 'time@10': 2.429}:  53%|█████▎    | 16/30 [00:30<00:25,  1.83s/it]{'epoch': 5, 'num_users': 5.8235, 'loss': 0.0542, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8458, 'compress@10': 1.0, 'time@10': 2.3979}:  53%|█████▎    | 16/30 [00:31<00:25,  1.83s/it]{'epoch': 5, 'num_users': 5.8235, 'loss': 0.0542, 'hit_ratio@10': 0.8194, 'ndcg@10': 0.8458, 'compress@10': 1.0, 'time@10': 2.3979}:  57%|█████▋    | 17/30 [00:31<00:20,  1.58s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.0544, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.8464, 'compress@10': 1.0, 'time@10': 2.4139}:  57%|█████▋    | 17/30 [00:34<00:20,  1.58s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.0544, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.8464, 'compress@10': 1.0, 'time@10': 2.4139}:  60%|██████    | 18/30 [00:34<00:23,  1.92s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.0525, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 2.4407}:  60%|██████    | 18/30 [00:35<00:23,  1.92s/it]   {'epoch': 5, 'num_users': 6.0, 'loss': 0.0525, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 2.4407}:  63%|██████▎   | 19/30 [00:35<00:19,  1.80s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0532, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 2.4691}:  63%|██████▎   | 19/30 [00:38<00:19,  1.80s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0532, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8469, 'compress@10': 1.0, 'time@10': 2.4691}:  67%|██████▋   | 20/30 [00:38<00:21,  2.17s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0546, 'hit_ratio@10': 0.8153, 'ndcg@10': 0.8446, 'compress@10': 1.0, 'time@10': 2.4907}:  67%|██████▋   | 20/30 [00:40<00:21,  2.17s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0546, 'hit_ratio@10': 0.8153, 'ndcg@10': 0.8446, 'compress@10': 1.0, 'time@10': 2.4907}:  70%|███████   | 21/30 [00:40<00:17,  1.97s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.0538, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.8482, 'compress@10': 1.0, 'time@10': 2.4939}:  70%|███████   | 21/30 [00:42<00:17,  1.97s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.0538, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.8482, 'compress@10': 1.0, 'time@10': 2.4939}:  73%|███████▎  | 22/30 [00:42<00:17,  2.16s/it]{'epoch': 5, 'num_users': 6.1304, 'loss': 0.0527, 'hit_ratio@10': 0.8209, 'ndcg@10': 0.8498, 'compress@10': 1.0, 'time@10': 2.4908}:  73%|███████▎  | 22/30 [00:43<00:17,  2.16s/it]{'epoch': 5, 'num_users': 6.1304, 'loss': 0.0527, 'hit_ratio@10': 0.8209, 'ndcg@10': 0.8498, 'compress@10': 1.0, 'time@10': 2.4908}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.051, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8454, 'compress@10': 1.0, 'time@10': 2.4384}:  77%|███████▋  | 23/30 [00:45<00:13,  1.89s/it]   {'epoch': 5, 'num_users': 5.9583, 'loss': 0.051, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8454, 'compress@10': 1.0, 'time@10': 2.4384}:  80%|████████  | 24/30 [00:45<00:10,  1.71s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0491, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8364, 'compress@10': 1.0, 'time@10': 2.3919}:  80%|████████  | 24/30 [00:45<00:10,  1.71s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0491, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8364, 'compress@10': 1.0, 'time@10': 2.3919}:  83%|████████▎ | 25/30 [00:45<00:06,  1.40s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0512, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8327, 'compress@10': 1.0, 'time@10': 2.3733}:  83%|████████▎ | 25/30 [00:47<00:06,  1.40s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0512, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8327, 'compress@10': 1.0, 'time@10': 2.3733}:  87%|████████▋ | 26/30 [00:47<00:06,  1.56s/it]{'epoch': 5, 'num_users': 5.8889, 'loss': 0.0505, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8348, 'compress@10': 1.0, 'time@10': 2.409}:  87%|████████▋ | 26/30 [00:49<00:06,  1.56s/it] {'epoch': 5, 'num_users': 5.8889, 'loss': 0.0505, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8348, 'compress@10': 1.0, 'time@10': 2.409}:  90%|█████████ | 27/30 [00:49<00:04,  1.61s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.0508, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.836, 'compress@10': 1.0, 'time@10': 2.4188}:  90%|█████████ | 27/30 [00:52<00:04,  1.61s/it]   {'epoch': 5, 'num_users': 6.0, 'loss': 0.0508, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.836, 'compress@10': 1.0, 'time@10': 2.4188}:  93%|█████████▎| 28/30 [00:52<00:03,  1.94s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.0502, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8371, 'compress@10': 1.0, 'time@10': 2.4345}:  93%|█████████▎| 28/30 [00:53<00:03,  1.94s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.0502, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8371, 'compress@10': 1.0, 'time@10': 2.4345}:  97%|█████████▋| 29/30 [00:53<00:01,  1.80s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0506, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8388, 'compress@10': 1.0, 'time@10': 2.4478}:  97%|█████████▋| 29/30 [00:56<00:01,  1.80s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0506, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8388, 'compress@10': 1.0, 'time@10': 2.4478}: 100%|██████████| 30/30 [00:56<00:00,  2.12s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.0506, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8388, 'compress@10': 1.0, 'time@10': 2.4478}: 100%|██████████| 30/30 [00:56<00:00,  1.89s/it]
Epoch: 5
Avg # of users: 5.866666666666666
Avg Loss: 0.0505667262528428
Avg hit ratio: 0.8183310489645862
Avg ndcg: 0.8388247211362605
Avg compression ratio: 0.9999999860153537
Avg train time: 2.4477769136428833
Std train time: 0.5827602329420892
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 30, 14, 8, 9, 8, 11, 6, 9, 7, 31, 9, 46, 7, 32, 37, 13, 15, 6, 5, 18, 10, 49, 49, 6, 5, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8364, 'compress@10': 1.0, 'time@10': 2.8736}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8364, 'compress@10': 1.0, 'time@10': 2.8736}:   3%|▎         | 1/30 [00:01<00:42,  1.47s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0595, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8351, 'compress@10': 1.0, 'time@10': 2.8564}:   3%|▎         | 1/30 [00:04<00:42,  1.47s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0595, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8351, 'compress@10': 1.0, 'time@10': 2.8564}:   7%|▋         | 2/30 [00:04<01:04,  2.30s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0397, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8425, 'compress@10': 1.0, 'time@10': 2.8205}:   7%|▋         | 2/30 [00:05<01:04,  2.30s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0397, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8425, 'compress@10': 1.0, 'time@10': 2.8205}:  10%|█         | 3/30 [00:05<00:51,  1.90s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0433, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8537, 'compress@10': 1.0, 'time@10': 2.7914}:  10%|█         | 3/30 [00:08<00:51,  1.90s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0433, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8537, 'compress@10': 1.0, 'time@10': 2.7914}:  13%|█▎        | 4/30 [00:08<00:58,  2.23s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0522, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8384, 'compress@10': 1.0, 'time@10': 3.4058}:  13%|█▎        | 4/30 [00:11<00:58,  2.23s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0522, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8384, 'compress@10': 1.0, 'time@10': 3.4058}:  17%|█▋        | 5/30 [00:11<01:02,  2.50s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0556, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8354, 'compress@10': 1.0, 'time@10': 3.3154}:  17%|█▋        | 5/30 [00:14<01:02,  2.50s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0556, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8354, 'compress@10': 1.0, 'time@10': 3.3154}:  20%|██        | 6/30 [00:14<01:03,  2.64s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0553, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8399, 'compress@10': 1.0, 'time@10': 3.2219}:  20%|██        | 6/30 [00:15<01:03,  2.64s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0553, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8399, 'compress@10': 1.0, 'time@10': 3.2219}:  23%|██▎       | 7/30 [00:15<00:51,  2.22s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0554, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.1451}:  23%|██▎       | 7/30 [00:18<00:51,  2.22s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.0554, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.1451}:  27%|██▋       | 8/30 [00:18<00:51,  2.36s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0549, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8466, 'compress@10': 1.0, 'time@10': 3.1199}:  27%|██▋       | 8/30 [00:19<00:51,  2.36s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0549, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8466, 'compress@10': 1.0, 'time@10': 3.1199}:  30%|███       | 9/30 [00:19<00:43,  2.09s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0554, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8506, 'compress@10': 1.0, 'time@10': 3.08}:  30%|███       | 9/30 [00:22<00:43,  2.09s/it]     {'epoch': 6, 'num_users': 6.3, 'loss': 0.0554, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8506, 'compress@10': 1.0, 'time@10': 3.08}:  33%|███▎      | 10/30 [00:22<00:45,  2.29s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.0565, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.851, 'compress@10': 1.0, 'time@10': 3.0323}:  33%|███▎      | 10/30 [00:23<00:45,  2.29s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.0565, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.851, 'compress@10': 1.0, 'time@10': 3.0323}:  37%|███▋      | 11/30 [00:23<00:37,  1.99s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.053, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 2.9864}:  37%|███▋      | 11/30 [00:26<00:37,  1.99s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.053, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 2.9864}:  40%|████      | 12/30 [00:26<00:38,  2.15s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.0531, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 2.9795}:  40%|████      | 12/30 [00:27<00:38,  2.15s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.0531, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 2.9795}:  43%|████▎     | 13/30 [00:27<00:33,  1.95s/it]{'epoch': 6, 'num_users': 6.3571, 'loss': 0.0498, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 2.8805}:  43%|████▎     | 13/30 [00:29<00:33,  1.95s/it]{'epoch': 6, 'num_users': 6.3571, 'loss': 0.0498, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 2.8805}:  47%|████▋     | 14/30 [00:29<00:29,  1.85s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.0508, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 2.8875}:  47%|████▋     | 14/30 [00:31<00:29,  1.85s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.0508, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 2.8875}:  50%|█████     | 15/30 [00:31<00:26,  1.76s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.0484, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 2.8665}:  50%|█████     | 15/30 [00:33<00:26,  1.76s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.0484, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 2.8665}:  53%|█████▎    | 16/30 [00:33<00:28,  2.01s/it]{'epoch': 6, 'num_users': 5.8235, 'loss': 0.046, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8488, 'compress@10': 1.0, 'time@10': 2.8219}:  53%|█████▎    | 16/30 [00:34<00:28,  2.01s/it] {'epoch': 6, 'num_users': 5.8235, 'loss': 0.046, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8488, 'compress@10': 1.0, 'time@10': 2.8219}:  57%|█████▋    | 17/30 [00:34<00:22,  1.73s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0466, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8504, 'compress@10': 1.0, 'time@10': 2.8129}:  57%|█████▋    | 17/30 [00:37<00:22,  1.73s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0466, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8504, 'compress@10': 1.0, 'time@10': 2.8129}:  60%|██████    | 18/30 [00:37<00:24,  2.02s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.045, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 2.8129}:  60%|██████    | 18/30 [00:38<00:24,  2.02s/it]     {'epoch': 6, 'num_users': 6.0, 'loss': 0.045, 'hit_ratio@10': 0.832, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 2.8129}:  63%|██████▎   | 19/30 [00:38<00:20,  1.85s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.0461, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 2.7963}:  63%|██████▎   | 19/30 [00:41<00:20,  1.85s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.0461, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 2.7963}:  67%|██████▋   | 20/30 [00:41<00:20,  2.05s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0479, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 2.799}:  67%|██████▋   | 20/30 [00:42<00:20,  2.05s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0479, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 2.799}:  70%|███████   | 21/30 [00:42<00:16,  1.87s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.047, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 2.7906}:  70%|███████   | 21/30 [00:45<00:16,  1.87s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.047, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 2.7906}:  73%|███████▎  | 22/30 [00:45<00:16,  2.11s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.0462, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 2.7843}:  73%|███████▎  | 22/30 [00:46<00:16,  2.11s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.0462, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 2.7843}:  77%|███████▋  | 23/30 [00:46<00:13,  1.88s/it]{'epoch': 6, 'num_users': 5.9583, 'loss': 0.0446, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.85, 'compress@10': 1.0, 'time@10': 2.723}:  77%|███████▋  | 23/30 [00:48<00:13,  1.88s/it]   {'epoch': 6, 'num_users': 5.9583, 'loss': 0.0446, 'hit_ratio@10': 0.8295, 'ndcg@10': 0.85, 'compress@10': 1.0, 'time@10': 2.723}:  80%|████████  | 24/30 [00:48<00:10,  1.72s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.043, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8408, 'compress@10': 1.0, 'time@10': 2.6668}:  80%|████████  | 24/30 [00:48<00:10,  1.72s/it]  {'epoch': 6, 'num_users': 5.8, 'loss': 0.043, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8408, 'compress@10': 1.0, 'time@10': 2.6668}:  83%|████████▎ | 25/30 [00:48<00:07,  1.41s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0447, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8379, 'compress@10': 1.0, 'time@10': 2.693}:  83%|████████▎ | 25/30 [00:52<00:07,  1.41s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0447, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8379, 'compress@10': 1.0, 'time@10': 2.693}:  87%|████████▋ | 26/30 [00:52<00:08,  2.00s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.0443, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8394, 'compress@10': 1.0, 'time@10': 2.6683}:  87%|████████▋ | 26/30 [00:53<00:08,  2.00s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.0443, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8394, 'compress@10': 1.0, 'time@10': 2.6683}:  90%|█████████ | 27/30 [00:53<00:05,  1.72s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.0447, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8404, 'compress@10': 1.0, 'time@10': 2.6746}:  90%|█████████ | 27/30 [00:56<00:05,  1.72s/it]   {'epoch': 6, 'num_users': 6.0, 'loss': 0.0447, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8404, 'compress@10': 1.0, 'time@10': 2.6746}:  93%|█████████▎| 28/30 [00:56<00:04,  2.07s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.0444, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8437, 'compress@10': 1.0, 'time@10': 2.689}:  93%|█████████▎| 28/30 [00:57<00:04,  2.07s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.0444, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8437, 'compress@10': 1.0, 'time@10': 2.689}:  97%|█████████▋| 29/30 [00:57<00:01,  1.92s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0442, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8454, 'compress@10': 1.0, 'time@10': 2.7017}:  97%|█████████▋| 29/30 [01:00<00:01,  1.92s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0442, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8454, 'compress@10': 1.0, 'time@10': 2.7017}: 100%|██████████| 30/30 [01:00<00:00,  2.28s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0442, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8454, 'compress@10': 1.0, 'time@10': 2.7017}: 100%|██████████| 30/30 [01:00<00:00,  2.03s/it]
Epoch: 6
Avg # of users: 5.866666666666666
Avg Loss: 0.04422466014072013
Avg hit ratio: 0.83189454944433
Avg ndcg: 0.8454226887624031
Avg compression ratio: 0.9999999860153537
Avg train time: 2.7016984939575197
Std train time: 0.7536087366864714
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 30, 14, 1, 9, 8, 12, 6, 9, 8, 32, 9, 50, 6, 33, 39, 13, 15, 7, 5, 19, 10, 54, 54, 4, 7, 7, 9, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0557, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8798, 'compress@10': 1.0, 'time@10': 3.0694}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0557, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8798, 'compress@10': 1.0, 'time@10': 3.0694}:   3%|▎         | 1/30 [00:01<00:45,  1.57s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0638, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8436, 'compress@10': 1.0, 'time@10': 2.954}:   3%|▎         | 1/30 [00:04<00:45,  1.57s/it]  {'epoch': 7, 'num_users': 7.0, 'loss': 0.0638, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8436, 'compress@10': 1.0, 'time@10': 2.954}:   7%|▋         | 2/30 [00:04<01:05,  2.34s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0425, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 2.8063}:   7%|▋         | 2/30 [00:05<01:05,  2.34s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0425, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 2.8063}:  10%|█         | 3/30 [00:05<00:50,  1.86s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0492, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 2.8195}:  10%|█         | 3/30 [00:08<00:50,  1.86s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0492, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 2.8195}:  13%|█▎        | 4/30 [00:08<00:59,  2.27s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0826, 'hit_ratio@10': 0.7631, 'ndcg@10': 0.8046, 'compress@10': 1.0, 'time@10': 2.4109}:  13%|█▎        | 4/30 [00:09<00:59,  2.27s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0826, 'hit_ratio@10': 0.7631, 'ndcg@10': 0.8046, 'compress@10': 1.0, 'time@10': 2.4109}:  17%|█▋        | 5/30 [00:09<00:40,  1.60s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0806, 'hit_ratio@10': 0.7692, 'ndcg@10': 0.8077, 'compress@10': 1.0, 'time@10': 2.4961}:  17%|█▋        | 5/30 [00:12<00:40,  1.60s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0806, 'hit_ratio@10': 0.7692, 'ndcg@10': 0.8077, 'compress@10': 1.0, 'time@10': 2.4961}:  20%|██        | 6/30 [00:12<00:49,  2.08s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0757, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.8142, 'compress@10': 1.0, 'time@10': 2.5445}:  20%|██        | 6/30 [00:13<00:49,  2.08s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0757, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.8142, 'compress@10': 1.0, 'time@10': 2.5445}:  23%|██▎       | 7/30 [00:13<00:43,  1.87s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0725, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8101, 'compress@10': 1.0, 'time@10': 2.589}:  23%|██▎       | 7/30 [00:16<00:43,  1.87s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.0725, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8101, 'compress@10': 1.0, 'time@10': 2.589}:  27%|██▋       | 8/30 [00:16<00:48,  2.22s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0704, 'hit_ratio@10': 0.8004, 'ndcg@10': 0.8158, 'compress@10': 1.0, 'time@10': 2.6295}:  27%|██▋       | 8/30 [00:17<00:48,  2.22s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0704, 'hit_ratio@10': 0.8004, 'ndcg@10': 0.8158, 'compress@10': 1.0, 'time@10': 2.6295}:  30%|███       | 9/30 [00:17<00:41,  2.00s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0686, 'hit_ratio@10': 0.8136, 'ndcg@10': 0.8211, 'compress@10': 1.0, 'time@10': 2.6354}:  30%|███       | 9/30 [00:20<00:41,  2.00s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0686, 'hit_ratio@10': 0.8136, 'ndcg@10': 0.8211, 'compress@10': 1.0, 'time@10': 2.6354}:  33%|███▎      | 10/30 [00:20<00:44,  2.22s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.0685, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8242, 'compress@10': 1.0, 'time@10': 2.6744}:  33%|███▎      | 10/30 [00:22<00:44,  2.22s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.0685, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8242, 'compress@10': 1.0, 'time@10': 2.6744}:  37%|███▋      | 11/30 [00:22<00:38,  2.02s/it]{'epoch': 7, 'num_users': 6.4167, 'loss': 0.0639, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8308, 'compress@10': 1.0, 'time@10': 2.6615}:  37%|███▋      | 11/30 [00:24<00:38,  2.02s/it]{'epoch': 7, 'num_users': 6.4167, 'loss': 0.0639, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8308, 'compress@10': 1.0, 'time@10': 2.6615}:  40%|████      | 12/30 [00:24<00:39,  2.19s/it]{'epoch': 7, 'num_users': 6.6154, 'loss': 0.0632, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.833, 'compress@10': 1.0, 'time@10': 2.6658}:  40%|████      | 12/30 [00:26<00:39,  2.19s/it] {'epoch': 7, 'num_users': 6.6154, 'loss': 0.0632, 'hit_ratio@10': 0.8057, 'ndcg@10': 0.833, 'compress@10': 1.0, 'time@10': 2.6658}:  43%|████▎     | 13/30 [00:26<00:33,  1.95s/it]{'epoch': 7, 'num_users': 6.3571, 'loss': 0.0591, 'hit_ratio@10': 0.8076, 'ndcg@10': 0.8316, 'compress@10': 1.0, 'time@10': 2.5954}:  43%|████▎     | 13/30 [00:27<00:33,  1.95s/it]{'epoch': 7, 'num_users': 6.3571, 'loss': 0.0591, 'hit_ratio@10': 0.8076, 'ndcg@10': 0.8316, 'compress@10': 1.0, 'time@10': 2.5954}:  47%|████▋     | 14/30 [00:27<00:30,  1.89s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0593, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8335, 'compress@10': 1.0, 'time@10': 2.5906}:  47%|████▋     | 14/30 [00:29<00:30,  1.89s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0593, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8335, 'compress@10': 1.0, 'time@10': 2.5906}:  50%|█████     | 15/30 [00:29<00:25,  1.71s/it]{'epoch': 7, 'num_users': 6.0625, 'loss': 0.0562, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8374, 'compress@10': 1.0, 'time@10': 2.5857}:  50%|█████     | 15/30 [00:31<00:25,  1.71s/it]{'epoch': 7, 'num_users': 6.0625, 'loss': 0.0562, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8374, 'compress@10': 1.0, 'time@10': 2.5857}:  53%|█████▎    | 16/30 [00:31<00:27,  1.96s/it]{'epoch': 7, 'num_users': 5.8235, 'loss': 0.0533, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.833, 'compress@10': 1.0, 'time@10': 2.5553}:  53%|█████▎    | 16/30 [00:32<00:27,  1.96s/it] {'epoch': 7, 'num_users': 5.8235, 'loss': 0.0533, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.833, 'compress@10': 1.0, 'time@10': 2.5553}:  57%|█████▋    | 17/30 [00:32<00:22,  1.70s/it]{'epoch': 7, 'num_users': 6.0556, 'loss': 0.0534, 'hit_ratio@10': 0.8014, 'ndcg@10': 0.8351, 'compress@10': 1.0, 'time@10': 2.5571}:  57%|█████▋    | 17/30 [00:35<00:22,  1.70s/it]{'epoch': 7, 'num_users': 6.0556, 'loss': 0.0534, 'hit_ratio@10': 0.8014, 'ndcg@10': 0.8351, 'compress@10': 1.0, 'time@10': 2.5571}:  60%|██████    | 18/30 [00:35<00:23,  1.97s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.0515, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.8383, 'compress@10': 1.0, 'time@10': 2.5643}:  60%|██████    | 18/30 [00:37<00:23,  1.97s/it]   {'epoch': 7, 'num_users': 6.0, 'loss': 0.0515, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.8383, 'compress@10': 1.0, 'time@10': 2.5643}:  63%|██████▎   | 19/30 [00:37<00:20,  1.90s/it]{'epoch': 7, 'num_users': 6.15, 'loss': 0.0522, 'hit_ratio@10': 0.808, 'ndcg@10': 0.8367, 'compress@10': 1.0, 'time@10': 2.5834}:  63%|██████▎   | 19/30 [00:40<00:20,  1.90s/it]{'epoch': 7, 'num_users': 6.15, 'loss': 0.0522, 'hit_ratio@10': 0.808, 'ndcg@10': 0.8367, 'compress@10': 1.0, 'time@10': 2.5834}:  67%|██████▋   | 20/30 [00:40<00:22,  2.22s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0535, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 2.6004}:  67%|██████▋   | 20/30 [00:41<00:22,  2.22s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0535, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 2.6004}:  70%|███████   | 21/30 [00:41<00:18,  2.01s/it]{'epoch': 7, 'num_users': 6.1818, 'loss': 0.0523, 'hit_ratio@10': 0.81, 'ndcg@10': 0.8396, 'compress@10': 1.0, 'time@10': 2.6101}:  70%|███████   | 21/30 [00:44<00:18,  2.01s/it]  {'epoch': 7, 'num_users': 6.1818, 'loss': 0.0523, 'hit_ratio@10': 0.81, 'ndcg@10': 0.8396, 'compress@10': 1.0, 'time@10': 2.6101}:  73%|███████▎  | 22/30 [00:44<00:18,  2.26s/it]{'epoch': 7, 'num_users': 6.1304, 'loss': 0.0512, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.8419, 'compress@10': 1.0, 'time@10': 2.6122}:  73%|███████▎  | 22/30 [00:45<00:18,  2.26s/it]{'epoch': 7, 'num_users': 6.1304, 'loss': 0.0512, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.8419, 'compress@10': 1.0, 'time@10': 2.6122}:  77%|███████▋  | 23/30 [00:45<00:13,  1.99s/it]{'epoch': 7, 'num_users': 5.9583, 'loss': 0.0493, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8388, 'compress@10': 1.0, 'time@10': 2.5668}:  77%|███████▋  | 23/30 [00:47<00:13,  1.99s/it]{'epoch': 7, 'num_users': 5.9583, 'loss': 0.0493, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8388, 'compress@10': 1.0, 'time@10': 2.5668}:  80%|████████  | 24/30 [00:47<00:11,  1.86s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8034, 'ndcg@10': 0.8301, 'compress@10': 1.0, 'time@10': 2.5236}:  80%|████████  | 24/30 [00:48<00:11,  1.86s/it]   {'epoch': 7, 'num_users': 5.8, 'loss': 0.0475, 'hit_ratio@10': 0.8034, 'ndcg@10': 0.8301, 'compress@10': 1.0, 'time@10': 2.5236}:  83%|████████▎ | 25/30 [00:48<00:07,  1.54s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0492, 'hit_ratio@10': 0.8035, 'ndcg@10': 0.827, 'compress@10': 1.0, 'time@10': 2.5138}:  83%|████████▎ | 25/30 [00:50<00:07,  1.54s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0492, 'hit_ratio@10': 0.8035, 'ndcg@10': 0.827, 'compress@10': 1.0, 'time@10': 2.5138}:  87%|████████▋ | 26/30 [00:50<00:07,  1.77s/it]{'epoch': 7, 'num_users': 5.8889, 'loss': 0.0487, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8293, 'compress@10': 1.0, 'time@10': 2.5224}:  87%|████████▋ | 26/30 [00:52<00:07,  1.77s/it]{'epoch': 7, 'num_users': 5.8889, 'loss': 0.0487, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8293, 'compress@10': 1.0, 'time@10': 2.5224}:  90%|█████████ | 27/30 [00:52<00:04,  1.66s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.0489, 'hit_ratio@10': 0.8121, 'ndcg@10': 0.8303, 'compress@10': 1.0, 'time@10': 2.5261}:  90%|█████████ | 27/30 [00:54<00:04,  1.66s/it]   {'epoch': 7, 'num_users': 6.0, 'loss': 0.0489, 'hit_ratio@10': 0.8121, 'ndcg@10': 0.8303, 'compress@10': 1.0, 'time@10': 2.5261}:  93%|█████████▎| 28/30 [00:54<00:03,  1.96s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0486, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8294, 'compress@10': 1.0, 'time@10': 2.5304}:  93%|█████████▎| 28/30 [00:56<00:03,  1.96s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0486, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8294, 'compress@10': 1.0, 'time@10': 2.5304}:  97%|█████████▋| 29/30 [00:56<00:01,  1.78s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0486, 'hit_ratio@10': 0.8107, 'ndcg@10': 0.8343, 'compress@10': 1.0, 'time@10': 2.5349}:  97%|█████████▋| 29/30 [00:58<00:01,  1.78s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0486, 'hit_ratio@10': 0.8107, 'ndcg@10': 0.8343, 'compress@10': 1.0, 'time@10': 2.5349}: 100%|██████████| 30/30 [00:58<00:00,  2.06s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0486, 'hit_ratio@10': 0.8107, 'ndcg@10': 0.8343, 'compress@10': 1.0, 'time@10': 2.5349}: 100%|██████████| 30/30 [00:58<00:00,  1.96s/it]
Epoch: 7
Avg # of users: 5.866666666666666
Avg Loss: 0.04863675899512348
Avg hit ratio: 0.8107408414200329
Avg ndcg: 0.8342961200435971
Avg compression ratio: 0.9999999860153537
Avg train time: 2.534911100069682
Std train time: 0.520977646326497
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 31, 14, 7, 9, 8, 12, 5, 9, 7, 33, 9, 54, 7, 34, 41, 14, 15, 6, 4, 19, 10, 58, 58, 6, 7, 7, 9, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8426, 'compress@10': 1.0, 'time@10': 2.8533}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8426, 'compress@10': 1.0, 'time@10': 2.8533}:   3%|▎         | 1/30 [00:01<00:42,  1.47s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8455, 'compress@10': 1.0, 'time@10': 2.8672}:   3%|▎         | 1/30 [00:04<00:42,  1.47s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8455, 'compress@10': 1.0, 'time@10': 2.8672}:   7%|▋         | 2/30 [00:04<01:04,  2.32s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8494, 'compress@10': 1.0, 'time@10': 2.8003}:   7%|▋         | 2/30 [00:05<01:04,  2.32s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8494, 'compress@10': 1.0, 'time@10': 2.8003}:  10%|█         | 3/30 [00:05<00:50,  1.89s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0397, 'hit_ratio@10': 0.7829, 'ndcg@10': 0.8612, 'compress@10': 1.0, 'time@10': 2.7656}:  10%|█         | 3/30 [00:08<00:50,  1.89s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0397, 'hit_ratio@10': 0.7829, 'ndcg@10': 0.8612, 'compress@10': 1.0, 'time@10': 2.7656}:  13%|█▎        | 4/30 [00:08<00:57,  2.21s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0492, 'hit_ratio@10': 0.7903, 'ndcg@10': 0.8475, 'compress@10': 1.0, 'time@10': 3.2543}:  13%|█▎        | 4/30 [00:11<00:57,  2.21s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0492, 'hit_ratio@10': 0.7903, 'ndcg@10': 0.8475, 'compress@10': 1.0, 'time@10': 3.2543}:  17%|█▋        | 5/30 [00:11<00:59,  2.36s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0524, 'hit_ratio@10': 0.7956, 'ndcg@10': 0.8433, 'compress@10': 1.0, 'time@10': 3.2187}:  17%|█▋        | 5/30 [00:14<00:59,  2.36s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0524, 'hit_ratio@10': 0.7956, 'ndcg@10': 0.8433, 'compress@10': 1.0, 'time@10': 3.2187}:  20%|██        | 6/30 [00:14<01:02,  2.61s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0526, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.8447, 'compress@10': 1.0, 'time@10': 3.1605}:  20%|██        | 6/30 [00:15<01:02,  2.61s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0526, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.8447, 'compress@10': 1.0, 'time@10': 3.1605}:  23%|██▎       | 7/30 [00:15<00:51,  2.23s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0539, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 3.1232}:  23%|██▎       | 7/30 [00:18<00:51,  2.23s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0539, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 3.1232}:  27%|██▋       | 8/30 [00:18<00:53,  2.45s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.053, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 3.0553}:  27%|██▋       | 8/30 [00:19<00:53,  2.45s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.053, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 3.0553}:  30%|███       | 9/30 [00:19<00:43,  2.09s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0517, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 3.0298}:  30%|███       | 9/30 [00:22<00:43,  2.09s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0517, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 3.0298}:  33%|███▎      | 10/30 [00:22<00:46,  2.32s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.0528, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8605, 'compress@10': 1.0, 'time@10': 2.997}:  33%|███▎      | 10/30 [00:24<00:46,  2.32s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.0528, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8605, 'compress@10': 1.0, 'time@10': 2.997}:  37%|███▋      | 11/30 [00:24<00:38,  2.03s/it]{'epoch': 8, 'num_users': 6.4167, 'loss': 0.0494, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8641, 'compress@10': 1.0, 'time@10': 2.9537}:  37%|███▋      | 11/30 [00:26<00:38,  2.03s/it]{'epoch': 8, 'num_users': 6.4167, 'loss': 0.0494, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8641, 'compress@10': 1.0, 'time@10': 2.9537}:  40%|████      | 12/30 [00:26<00:39,  2.18s/it]{'epoch': 8, 'num_users': 6.6154, 'loss': 0.0497, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 2.9343}:  40%|████      | 12/30 [00:27<00:39,  2.18s/it]{'epoch': 8, 'num_users': 6.6154, 'loss': 0.0497, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 2.9343}:  43%|████▎     | 13/30 [00:27<00:32,  1.94s/it]{'epoch': 8, 'num_users': 6.3571, 'loss': 0.0465, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 2.8597}:  43%|████▎     | 13/30 [00:29<00:32,  1.94s/it]{'epoch': 8, 'num_users': 6.3571, 'loss': 0.0465, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 2.8597}:  47%|████▋     | 14/30 [00:29<00:30,  1.93s/it]{'epoch': 8, 'num_users': 6.2667, 'loss': 0.0476, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8598, 'compress@10': 1.0, 'time@10': 2.8641}:  47%|████▋     | 14/30 [00:31<00:30,  1.93s/it]{'epoch': 8, 'num_users': 6.2667, 'loss': 0.0476, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8598, 'compress@10': 1.0, 'time@10': 2.8641}:  50%|█████     | 15/30 [00:31<00:27,  1.80s/it]{'epoch': 8, 'num_users': 6.0625, 'loss': 0.0452, 'hit_ratio@10': 0.832, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.8508}:  50%|█████     | 15/30 [00:34<00:27,  1.80s/it]  {'epoch': 8, 'num_users': 6.0625, 'loss': 0.0452, 'hit_ratio@10': 0.832, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.8508}:  53%|█████▎    | 16/30 [00:34<00:28,  2.07s/it]{'epoch': 8, 'num_users': 5.8235, 'loss': 0.0429, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.8561, 'compress@10': 1.0, 'time@10': 2.8144}:  53%|█████▎    | 16/30 [00:35<00:28,  2.07s/it]{'epoch': 8, 'num_users': 5.8235, 'loss': 0.0429, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.8561, 'compress@10': 1.0, 'time@10': 2.8144}:  57%|█████▋    | 17/30 [00:35<00:23,  1.79s/it]{'epoch': 8, 'num_users': 6.0556, 'loss': 0.0433, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 2.8139}:  57%|█████▋    | 17/30 [00:38<00:23,  1.79s/it]{'epoch': 8, 'num_users': 6.0556, 'loss': 0.0433, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 2.8139}:  60%|██████    | 18/30 [00:38<00:25,  2.11s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.042, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.815}:  60%|██████    | 18/30 [00:39<00:25,  2.11s/it]     {'epoch': 8, 'num_users': 6.0, 'loss': 0.042, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.815}:  63%|██████▎   | 19/30 [00:39<00:21,  1.91s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.0431, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 2.8013}:  63%|██████▎   | 19/30 [00:42<00:21,  1.91s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.0431, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 2.8013}:  67%|██████▋   | 20/30 [00:42<00:21,  2.11s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0451, 'hit_ratio@10': 0.815, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 2.7797}:  67%|██████▋   | 20/30 [00:43<00:21,  2.11s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0451, 'hit_ratio@10': 0.815, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 2.7797}:  70%|███████   | 21/30 [00:43<00:16,  1.84s/it]{'epoch': 8, 'num_users': 6.1818, 'loss': 0.0441, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 2.7817}:  70%|███████   | 21/30 [00:46<00:16,  1.84s/it]{'epoch': 8, 'num_users': 6.1818, 'loss': 0.0441, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 2.7817}:  73%|███████▎  | 22/30 [00:46<00:17,  2.15s/it]{'epoch': 8, 'num_users': 6.1304, 'loss': 0.0434, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.8579, 'compress@10': 1.0, 'time@10': 2.7797}:  73%|███████▎  | 22/30 [00:47<00:17,  2.15s/it]{'epoch': 8, 'num_users': 6.1304, 'loss': 0.0434, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.8579, 'compress@10': 1.0, 'time@10': 2.7797}:  77%|███████▋  | 23/30 [00:47<00:13,  1.93s/it]{'epoch': 8, 'num_users': 5.9583, 'loss': 0.0418, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8564, 'compress@10': 1.0, 'time@10': 2.7306}:  77%|███████▋  | 23/30 [00:49<00:13,  1.93s/it]{'epoch': 8, 'num_users': 5.9583, 'loss': 0.0418, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8564, 'compress@10': 1.0, 'time@10': 2.7306}:  80%|████████  | 24/30 [00:49<00:11,  1.84s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0403, 'hit_ratio@10': 0.8116, 'ndcg@10': 0.847, 'compress@10': 1.0, 'time@10': 2.6852}:  80%|████████  | 24/30 [00:50<00:11,  1.84s/it]    {'epoch': 8, 'num_users': 5.8, 'loss': 0.0403, 'hit_ratio@10': 0.8116, 'ndcg@10': 0.847, 'compress@10': 1.0, 'time@10': 2.6852}:  83%|████████▎ | 25/30 [00:50<00:07,  1.54s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.0419, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8442, 'compress@10': 1.0, 'time@10': 2.7132}:  83%|████████▎ | 25/30 [00:53<00:07,  1.54s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.0419, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8442, 'compress@10': 1.0, 'time@10': 2.7132}:  87%|████████▋ | 26/30 [00:53<00:08,  2.11s/it]{'epoch': 8, 'num_users': 5.8889, 'loss': 0.0416, 'hit_ratio@10': 0.8188, 'ndcg@10': 0.8465, 'compress@10': 1.0, 'time@10': 2.7179}:  87%|████████▋ | 26/30 [00:54<00:08,  2.11s/it]{'epoch': 8, 'num_users': 5.8889, 'loss': 0.0416, 'hit_ratio@10': 0.8188, 'ndcg@10': 0.8465, 'compress@10': 1.0, 'time@10': 2.7179}:  90%|█████████ | 27/30 [00:54<00:05,  1.92s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0421, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 2.7158}:  90%|█████████ | 27/30 [00:57<00:05,  1.92s/it]   {'epoch': 8, 'num_users': 6.0, 'loss': 0.0421, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 2.7158}:  93%|█████████▎| 28/30 [00:57<00:04,  2.15s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.0415, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8485, 'compress@10': 1.0, 'time@10': 2.7103}:  93%|█████████▎| 28/30 [00:59<00:04,  2.15s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.0415, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8485, 'compress@10': 1.0, 'time@10': 2.7103}:  97%|█████████▋| 29/30 [00:59<00:01,  1.90s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0417, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8496, 'compress@10': 1.0, 'time@10': 2.7095}:  97%|█████████▋| 29/30 [01:01<00:01,  1.90s/it] {'epoch': 8, 'num_users': 5.8667, 'loss': 0.0417, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8496, 'compress@10': 1.0, 'time@10': 2.7095}: 100%|██████████| 30/30 [01:01<00:00,  2.15s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0417, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8496, 'compress@10': 1.0, 'time@10': 2.7095}: 100%|██████████| 30/30 [01:01<00:00,  2.06s/it]
Epoch: 8
Avg # of users: 5.866666666666666
Avg Loss: 0.041672466439627825
Avg hit ratio: 0.8209917104529988
Avg ndcg: 0.8495867711500599
Avg compression ratio: 0.9999999860153537
Avg train time: 2.709472346305847
Std train time: 0.5973493895795172
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 31, 14, 1, 8, 8, 12, 6, 9, 7, 34, 9, 57, 6, 34, 43, 14, 15, 7, 5, 19, 10, 62, 62, 4, 7, 7, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0516, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 2.9926}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0516, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 2.9926}:   3%|▎         | 1/30 [00:01<00:44,  1.54s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 3.1426}:   3%|▎         | 1/30 [00:04<00:44,  1.54s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 3.1426}:   7%|▋         | 2/30 [00:04<01:12,  2.59s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.9765}:   7%|▋         | 2/30 [00:06<01:12,  2.59s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.9765}:  10%|█         | 3/30 [00:06<00:54,  2.03s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 2.9297}:  10%|█         | 3/30 [00:09<00:54,  2.03s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 2.9297}:  13%|█▎        | 4/30 [00:09<01:00,  2.35s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0695, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.806, 'compress@10': 1.0, 'time@10': 2.4853}:  13%|█▎        | 4/30 [00:09<01:00,  2.35s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0695, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.806, 'compress@10': 1.0, 'time@10': 2.4853}:  17%|█▋        | 5/30 [00:09<00:41,  1.64s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0692, 'hit_ratio@10': 0.7624, 'ndcg@10': 0.8078, 'compress@10': 1.0, 'time@10': 2.5126}:  17%|█▋        | 5/30 [00:12<00:41,  1.64s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0692, 'hit_ratio@10': 0.7624, 'ndcg@10': 0.8078, 'compress@10': 1.0, 'time@10': 2.5126}:  20%|██        | 6/30 [00:12<00:47,  2.00s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0676, 'hit_ratio@10': 0.7849, 'ndcg@10': 0.8153, 'compress@10': 1.0, 'time@10': 2.5605}:  20%|██        | 6/30 [00:13<00:47,  2.00s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0676, 'hit_ratio@10': 0.7849, 'ndcg@10': 0.8153, 'compress@10': 1.0, 'time@10': 2.5605}:  23%|██▎       | 7/30 [00:13<00:41,  1.82s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0666, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8196, 'compress@10': 1.0, 'time@10': 2.6169}:  23%|██▎       | 7/30 [00:16<00:41,  1.82s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0666, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8196, 'compress@10': 1.0, 'time@10': 2.6169}:  27%|██▋       | 8/30 [00:16<00:48,  2.22s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0642, 'hit_ratio@10': 0.7946, 'ndcg@10': 0.8288, 'compress@10': 1.0, 'time@10': 2.669}:  27%|██▋       | 8/30 [00:18<00:48,  2.22s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0642, 'hit_ratio@10': 0.7946, 'ndcg@10': 0.8288, 'compress@10': 1.0, 'time@10': 2.669}:  30%|███       | 9/30 [00:18<00:42,  2.02s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0622, 'hit_ratio@10': 0.8083, 'ndcg@10': 0.8341, 'compress@10': 1.0, 'time@10': 2.6772}:  30%|███       | 9/30 [00:21<00:42,  2.02s/it]  {'epoch': 9, 'num_users': 6.3, 'loss': 0.0622, 'hit_ratio@10': 0.8083, 'ndcg@10': 0.8341, 'compress@10': 1.0, 'time@10': 2.6772}:  33%|███▎      | 10/30 [00:21<00:45,  2.26s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.0623, 'hit_ratio@10': 0.8083, 'ndcg@10': 0.8363, 'compress@10': 1.0, 'time@10': 2.6681}:  33%|███▎      | 10/30 [00:22<00:45,  2.26s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.0623, 'hit_ratio@10': 0.8083, 'ndcg@10': 0.8363, 'compress@10': 1.0, 'time@10': 2.6681}:  37%|███▋      | 11/30 [00:22<00:37,  1.97s/it]{'epoch': 9, 'num_users': 6.4167, 'loss': 0.0581, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.8419, 'compress@10': 1.0, 'time@10': 2.671}:  37%|███▋      | 11/30 [00:25<00:37,  1.97s/it] {'epoch': 9, 'num_users': 6.4167, 'loss': 0.0581, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.8419, 'compress@10': 1.0, 'time@10': 2.671}:  40%|████      | 12/30 [00:25<00:39,  2.21s/it]{'epoch': 9, 'num_users': 6.6154, 'loss': 0.0579, 'hit_ratio@10': 0.8016, 'ndcg@10': 0.8427, 'compress@10': 1.0, 'time@10': 2.6847}:  40%|████      | 12/30 [00:26<00:39,  2.21s/it]{'epoch': 9, 'num_users': 6.6154, 'loss': 0.0579, 'hit_ratio@10': 0.8016, 'ndcg@10': 0.8427, 'compress@10': 1.0, 'time@10': 2.6847}:  43%|████▎     | 13/30 [00:26<00:33,  1.98s/it]{'epoch': 9, 'num_users': 6.3571, 'loss': 0.054, 'hit_ratio@10': 0.8039, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 2.6294}:  43%|████▎     | 13/30 [00:28<00:33,  1.98s/it] {'epoch': 9, 'num_users': 6.3571, 'loss': 0.054, 'hit_ratio@10': 0.8039, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 2.6294}:  47%|████▋     | 14/30 [00:28<00:31,  1.97s/it]{'epoch': 9, 'num_users': 6.2667, 'loss': 0.0545, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8423, 'compress@10': 1.0, 'time@10': 2.6212}:  47%|████▋     | 14/30 [00:29<00:31,  1.97s/it]{'epoch': 9, 'num_users': 6.2667, 'loss': 0.0545, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8423, 'compress@10': 1.0, 'time@10': 2.6212}:  50%|█████     | 15/30 [00:29<00:26,  1.77s/it]{'epoch': 9, 'num_users': 6.0625, 'loss': 0.0515, 'hit_ratio@10': 0.816, 'ndcg@10': 0.8455, 'compress@10': 1.0, 'time@10': 2.6218}:  50%|█████     | 15/30 [00:32<00:26,  1.77s/it] {'epoch': 9, 'num_users': 6.0625, 'loss': 0.0515, 'hit_ratio@10': 0.816, 'ndcg@10': 0.8455, 'compress@10': 1.0, 'time@10': 2.6218}:  53%|█████▎    | 16/30 [00:32<00:28,  2.04s/it]{'epoch': 9, 'num_users': 5.8235, 'loss': 0.0488, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 2.6072}:  53%|█████▎    | 16/30 [00:33<00:28,  2.04s/it]{'epoch': 9, 'num_users': 5.8235, 'loss': 0.0488, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 2.6072}:  57%|█████▋    | 17/30 [00:33<00:23,  1.79s/it]{'epoch': 9, 'num_users': 6.0556, 'loss': 0.0489, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8431, 'compress@10': 1.0, 'time@10': 2.6193}:  57%|█████▋    | 17/30 [00:36<00:23,  1.79s/it]{'epoch': 9, 'num_users': 6.0556, 'loss': 0.0489, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8431, 'compress@10': 1.0, 'time@10': 2.6193}:  60%|██████    | 18/30 [00:36<00:25,  2.12s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.0471, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 2.6309}:  60%|██████    | 18/30 [00:38<00:25,  2.12s/it]    {'epoch': 9, 'num_users': 6.0, 'loss': 0.0471, 'hit_ratio@10': 0.8033, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 2.6309}:  63%|██████▎   | 19/30 [00:38<00:21,  1.92s/it]{'epoch': 9, 'num_users': 6.15, 'loss': 0.0479, 'hit_ratio@10': 0.807, 'ndcg@10': 0.8444, 'compress@10': 1.0, 'time@10': 2.6427}:  63%|██████▎   | 19/30 [00:40<00:21,  1.92s/it]{'epoch': 9, 'num_users': 6.15, 'loss': 0.0479, 'hit_ratio@10': 0.807, 'ndcg@10': 0.8444, 'compress@10': 1.0, 'time@10': 2.6427}:  67%|██████▋   | 20/30 [00:40<00:22,  2.21s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8422, 'compress@10': 1.0, 'time@10': 2.6576}:  67%|██████▋   | 20/30 [00:42<00:22,  2.21s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8422, 'compress@10': 1.0, 'time@10': 2.6576}:  70%|███████   | 21/30 [00:42<00:18,  2.00s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0482, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8459, 'compress@10': 1.0, 'time@10': 2.6666}:  70%|███████   | 21/30 [00:45<00:18,  2.00s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0482, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8459, 'compress@10': 1.0, 'time@10': 2.6666}:  73%|███████▎  | 22/30 [00:45<00:18,  2.27s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0473, 'hit_ratio@10': 0.8108, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 2.6685}:  73%|███████▎  | 22/30 [00:46<00:18,  2.27s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0473, 'hit_ratio@10': 0.8108, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 2.6685}:  77%|███████▋  | 23/30 [00:46<00:14,  2.01s/it]{'epoch': 9, 'num_users': 5.9583, 'loss': 0.0455, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.847, 'compress@10': 1.0, 'time@10': 2.6292}:  77%|███████▋  | 23/30 [00:48<00:14,  2.01s/it] {'epoch': 9, 'num_users': 5.9583, 'loss': 0.0455, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.847, 'compress@10': 1.0, 'time@10': 2.6292}:  80%|████████  | 24/30 [00:48<00:11,  1.93s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0438, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8398, 'compress@10': 1.0, 'time@10': 2.5911}:  80%|████████  | 24/30 [00:49<00:11,  1.93s/it]  {'epoch': 9, 'num_users': 5.8, 'loss': 0.0438, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8398, 'compress@10': 1.0, 'time@10': 2.5911}:  83%|████████▎ | 25/30 [00:49<00:08,  1.62s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0455, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8366, 'compress@10': 1.0, 'time@10': 2.5786}:  83%|████████▎ | 25/30 [00:51<00:08,  1.62s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0455, 'hit_ratio@10': 0.8046, 'ndcg@10': 0.8366, 'compress@10': 1.0, 'time@10': 2.5786}:  87%|████████▋ | 26/30 [00:51<00:07,  1.82s/it]{'epoch': 9, 'num_users': 5.8889, 'loss': 0.0451, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.8382, 'compress@10': 1.0, 'time@10': 2.5891}:  87%|████████▋ | 26/30 [00:53<00:07,  1.82s/it]{'epoch': 9, 'num_users': 5.8889, 'loss': 0.0451, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.8382, 'compress@10': 1.0, 'time@10': 2.5891}:  90%|█████████ | 27/30 [00:53<00:05,  1.72s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.0455, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8384, 'compress@10': 1.0, 'time@10': 2.5894}:  90%|█████████ | 27/30 [00:55<00:05,  1.72s/it]   {'epoch': 9, 'num_users': 6.0, 'loss': 0.0455, 'hit_ratio@10': 0.8118, 'ndcg@10': 0.8384, 'compress@10': 1.0, 'time@10': 2.5894}:  93%|█████████▎| 28/30 [00:55<00:04,  2.00s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0453, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.84, 'compress@10': 1.0, 'time@10': 2.6016}:  93%|█████████▎| 28/30 [00:57<00:04,  2.00s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0453, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.84, 'compress@10': 1.0, 'time@10': 2.6016}:  97%|█████████▋| 29/30 [00:57<00:01,  1.85s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0453, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8451, 'compress@10': 1.0, 'time@10': 2.5992}:  97%|█████████▋| 29/30 [00:59<00:01,  1.85s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0453, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8451, 'compress@10': 1.0, 'time@10': 2.5992}: 100%|██████████| 30/30 [00:59<00:00,  2.07s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0453, 'hit_ratio@10': 0.8132, 'ndcg@10': 0.8451, 'compress@10': 1.0, 'time@10': 2.5992}: 100%|██████████| 30/30 [00:59<00:00,  2.00s/it]
Epoch: 9
Avg # of users: 5.866666666666666
Avg Loss: 0.04529160183429133
Avg hit ratio: 0.8132478988395326
Avg ndcg: 0.845091496264448
Avg compression ratio: 0.9999999860153537
Avg train time: 2.599200733502706
Std train time: 0.50528955760935
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[9, 11, 31, 14, 8, 8, 8, 11, 5, 9, 8, 34, 9, 60, 7, 34, 44, 14, 15, 7, 4, 19, 10, 65, 66, 6, 7, 8, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0549, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 2.4318}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0549, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 2.4318}:   3%|▎         | 1/30 [00:01<00:36,  1.25s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0548, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 2.426}:   3%|▎         | 1/30 [00:03<00:36,  1.25s/it]  {'epoch': 10, 'num_users': 7.0, 'loss': 0.0548, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 2.426}:   7%|▋         | 2/30 [00:03<00:54,  1.96s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0365, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8736, 'compress@10': 1.0, 'time@10': 2.4599}:   7%|▋         | 2/30 [00:05<00:54,  1.96s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0365, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8736, 'compress@10': 1.0, 'time@10': 2.4599}:  10%|█         | 3/30 [00:05<00:44,  1.66s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.04, 'hit_ratio@10': 0.7829, 'ndcg@10': 0.8892, 'compress@10': 1.0, 'time@10': 2.5493}:  10%|█         | 3/30 [00:07<00:44,  1.66s/it]  {'epoch': 10, 'num_users': 5.0, 'loss': 0.04, 'hit_ratio@10': 0.7829, 'ndcg@10': 0.8892, 'compress@10': 1.0, 'time@10': 2.5493}:  13%|█▎        | 4/30 [00:07<00:55,  2.13s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0489, 'hit_ratio@10': 0.7943, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.2692}:  13%|█▎        | 4/30 [00:10<00:55,  2.13s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0489, 'hit_ratio@10': 0.7943, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.2692}:  17%|█▋        | 5/30 [00:10<01:02,  2.49s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0514, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8603, 'compress@10': 1.0, 'time@10': 3.1742}:  17%|█▋        | 5/30 [00:13<01:02,  2.49s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0514, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8603, 'compress@10': 1.0, 'time@10': 3.1742}:  20%|██        | 6/30 [00:13<01:01,  2.57s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0517, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 3.1691}:  20%|██        | 6/30 [00:15<01:01,  2.57s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0517, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 3.1691}:  23%|██▎       | 7/30 [00:15<00:51,  2.26s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8739, 'compress@10': 1.0, 'time@10': 3.1046}:  23%|██▎       | 7/30 [00:18<00:51,  2.26s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8739, 'compress@10': 1.0, 'time@10': 3.1046}:  27%|██▋       | 8/30 [00:18<00:52,  2.39s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.0647}:  27%|██▋       | 8/30 [00:19<00:52,  2.39s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.0647}:  30%|███       | 9/30 [00:19<00:43,  2.09s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0506, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.0541}:  30%|███       | 9/30 [00:22<00:43,  2.09s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0506, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.0541}:  33%|███▎      | 10/30 [00:22<00:47,  2.37s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.0519, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8765, 'compress@10': 1.0, 'time@10': 3.0418}:  33%|███▎      | 10/30 [00:23<00:47,  2.37s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.0519, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8765, 'compress@10': 1.0, 'time@10': 3.0418}:  37%|███▋      | 11/30 [00:23<00:39,  2.10s/it]{'epoch': 10, 'num_users': 6.4167, 'loss': 0.0484, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8791, 'compress@10': 1.0, 'time@10': 3.006}:  37%|███▋      | 11/30 [00:26<00:39,  2.10s/it]  {'epoch': 10, 'num_users': 6.4167, 'loss': 0.0484, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8791, 'compress@10': 1.0, 'time@10': 3.006}:  40%|████      | 12/30 [00:26<00:40,  2.27s/it]{'epoch': 10, 'num_users': 6.6154, 'loss': 0.0489, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 2.9909}:  40%|████      | 12/30 [00:28<00:40,  2.27s/it]{'epoch': 10, 'num_users': 6.6154, 'loss': 0.0489, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 2.9909}:  43%|████▎     | 13/30 [00:28<00:34,  2.02s/it]{'epoch': 10, 'num_users': 6.3571, 'loss': 0.0456, 'hit_ratio@10': 0.818, 'ndcg@10': 0.8729, 'compress@10': 1.0, 'time@10': 2.9304}:  43%|████▎     | 13/30 [00:30<00:34,  2.02s/it] {'epoch': 10, 'num_users': 6.3571, 'loss': 0.0456, 'hit_ratio@10': 0.818, 'ndcg@10': 0.8729, 'compress@10': 1.0, 'time@10': 2.9304}:  47%|████▋     | 14/30 [00:30<00:33,  2.07s/it]{'epoch': 10, 'num_users': 6.2667, 'loss': 0.0467, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8709, 'compress@10': 1.0, 'time@10': 2.9345}:  47%|████▋     | 14/30 [00:31<00:33,  2.07s/it]{'epoch': 10, 'num_users': 6.2667, 'loss': 0.0467, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8709, 'compress@10': 1.0, 'time@10': 2.9345}:  50%|█████     | 15/30 [00:31<00:28,  1.91s/it]{'epoch': 10, 'num_users': 6.0625, 'loss': 0.0442, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8728, 'compress@10': 1.0, 'time@10': 2.9136}:  50%|█████     | 15/30 [00:34<00:28,  1.91s/it]{'epoch': 10, 'num_users': 6.0625, 'loss': 0.0442, 'hit_ratio@10': 0.8283, 'ndcg@10': 0.8728, 'compress@10': 1.0, 'time@10': 2.9136}:  53%|█████▎    | 16/30 [00:34<00:29,  2.13s/it]{'epoch': 10, 'num_users': 5.8235, 'loss': 0.0419, 'hit_ratio@10': 0.8149, 'ndcg@10': 0.8663, 'compress@10': 1.0, 'time@10': 2.8841}:  53%|█████▎    | 16/30 [00:35<00:29,  2.13s/it]{'epoch': 10, 'num_users': 5.8235, 'loss': 0.0419, 'hit_ratio@10': 0.8149, 'ndcg@10': 0.8663, 'compress@10': 1.0, 'time@10': 2.8841}:  57%|█████▋    | 17/30 [00:35<00:24,  1.86s/it]{'epoch': 10, 'num_users': 6.0556, 'loss': 0.0422, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8677, 'compress@10': 1.0, 'time@10': 2.883}:  57%|█████▋    | 17/30 [00:38<00:24,  1.86s/it] {'epoch': 10, 'num_users': 6.0556, 'loss': 0.0422, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8677, 'compress@10': 1.0, 'time@10': 2.883}:  60%|██████    | 18/30 [00:38<00:26,  2.17s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.0408, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 2.8866}:  60%|██████    | 18/30 [00:40<00:26,  2.17s/it]  {'epoch': 10, 'num_users': 6.0, 'loss': 0.0408, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 2.8866}:  63%|██████▎   | 19/30 [00:40<00:21,  1.97s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.0418, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 2.8859}:  63%|██████▎   | 19/30 [00:42<00:21,  1.97s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.0418, 'hit_ratio@10': 0.8187, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 2.8859}:  67%|██████▋   | 20/30 [00:42<00:22,  2.26s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0437, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8633, 'compress@10': 1.0, 'time@10': 2.8601}:  67%|██████▋   | 20/30 [00:44<00:22,  2.26s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0437, 'hit_ratio@10': 0.8142, 'ndcg@10': 0.8633, 'compress@10': 1.0, 'time@10': 2.8601}:  70%|███████   | 21/30 [00:44<00:17,  1.94s/it]{'epoch': 10, 'num_users': 6.1818, 'loss': 0.0427, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8657, 'compress@10': 1.0, 'time@10': 2.8537}:  70%|███████   | 21/30 [00:46<00:17,  1.94s/it]{'epoch': 10, 'num_users': 6.1818, 'loss': 0.0427, 'hit_ratio@10': 0.8185, 'ndcg@10': 0.8657, 'compress@10': 1.0, 'time@10': 2.8537}:  73%|███████▎  | 22/30 [00:46<00:17,  2.19s/it]{'epoch': 10, 'num_users': 6.1304, 'loss': 0.0422, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8671, 'compress@10': 1.0, 'time@10': 2.8432}:  73%|███████▎  | 22/30 [00:48<00:17,  2.19s/it]{'epoch': 10, 'num_users': 6.1304, 'loss': 0.0422, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8671, 'compress@10': 1.0, 'time@10': 2.8432}:  77%|███████▋  | 23/30 [00:48<00:13,  1.94s/it]{'epoch': 10, 'num_users': 5.9583, 'loss': 0.0406, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 2.7983}:  77%|███████▋  | 23/30 [00:50<00:13,  1.94s/it] {'epoch': 10, 'num_users': 5.9583, 'loss': 0.0406, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 2.7983}:  80%|████████  | 24/30 [00:50<00:11,  1.90s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.039, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 2.7587}:  80%|████████  | 24/30 [00:51<00:11,  1.90s/it]    {'epoch': 10, 'num_users': 5.8, 'loss': 0.039, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 2.7587}:  83%|████████▎ | 25/30 [00:51<00:08,  1.61s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.0405, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8544, 'compress@10': 1.0, 'time@10': 2.7838}:  83%|████████▎ | 25/30 [00:54<00:08,  1.61s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.0405, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.8544, 'compress@10': 1.0, 'time@10': 2.7838}:  87%|████████▋ | 26/30 [00:54<00:08,  2.16s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.0403, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 2.7866}:  87%|████████▋ | 26/30 [00:55<00:08,  2.16s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.0403, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 2.7866}:  90%|█████████ | 27/30 [00:55<00:05,  1.95s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.0407, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8566, 'compress@10': 1.0, 'time@10': 2.7953}:  90%|█████████ | 27/30 [00:59<00:05,  1.95s/it]   {'epoch': 10, 'num_users': 6.0, 'loss': 0.0407, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8566, 'compress@10': 1.0, 'time@10': 2.7953}:  93%|█████████▎| 28/30 [00:59<00:04,  2.29s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.0403, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 2.7855}:  93%|█████████▎| 28/30 [01:00<00:04,  2.29s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.0403, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 2.7855}:  97%|█████████▋| 29/30 [01:00<00:01,  1.99s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.041, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 2.7867}:  97%|█████████▋| 29/30 [01:03<00:01,  1.99s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.041, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 2.7867}: 100%|██████████| 30/30 [01:03<00:00,  2.25s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.041, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 2.7867}: 100%|██████████| 30/30 [01:03<00:00,  2.11s/it]
Epoch: 10
Avg # of users: 5.866666666666666
Avg Loss: 0.0409765745134369
Avg hit ratio: 0.824705036520814
Avg ndcg: 0.8576899447861442
Avg compression ratio: 0.9999999860153537
Avg train time: 2.7867130438486734
Std train time: 0.7139695279125619
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 32, 14, 1, 8, 7, 11, 5, 8, 8, 35, 9, 62, 6, 35, 45, 14, 14, 7, 5, 19, 11, 68, 69, 4, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8328, 'compress@10': 1.0, 'time@10': 2.6011}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8328, 'compress@10': 1.0, 'time@10': 2.6011}:   3%|▎         | 1/30 [00:01<00:38,  1.34s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0433, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 2.6083}:   3%|▎         | 1/30 [00:03<00:38,  1.34s/it] {'epoch': 11, 'num_users': 7.0, 'loss': 0.0433, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 2.6083}:   7%|▋         | 2/30 [00:03<00:59,  2.11s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0289, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 2.5939}:   7%|▋         | 2/30 [00:05<00:59,  2.11s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0289, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 2.5939}:  10%|█         | 3/30 [00:05<00:47,  1.75s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8838, 'compress@10': 1.0, 'time@10': 2.6082}:  10%|█         | 3/30 [00:08<00:47,  1.75s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8838, 'compress@10': 1.0, 'time@10': 2.6082}:  13%|█▎        | 4/30 [00:08<00:55,  2.12s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0697, 'hit_ratio@10': 0.7773, 'ndcg@10': 0.8203, 'compress@10': 1.0, 'time@10': 2.2451}:  13%|█▎        | 4/30 [00:08<00:55,  2.12s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0697, 'hit_ratio@10': 0.7773, 'ndcg@10': 0.8203, 'compress@10': 1.0, 'time@10': 2.2451}:  17%|█▋        | 5/30 [00:08<00:37,  1.51s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0684, 'hit_ratio@10': 0.7811, 'ndcg@10': 0.8216, 'compress@10': 1.0, 'time@10': 2.3257}:  17%|█▋        | 5/30 [00:11<00:37,  1.51s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0684, 'hit_ratio@10': 0.7811, 'ndcg@10': 0.8216, 'compress@10': 1.0, 'time@10': 2.3257}:  20%|██        | 6/30 [00:11<00:46,  1.94s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.065, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8224, 'compress@10': 1.0, 'time@10': 2.3652}:  20%|██        | 6/30 [00:12<00:46,  1.94s/it] {'epoch': 11, 'num_users': 6.2857, 'loss': 0.065, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8224, 'compress@10': 1.0, 'time@10': 2.3652}:  23%|██▎       | 7/30 [00:12<00:40,  1.74s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0629, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8338, 'compress@10': 1.0, 'time@10': 2.4393}:  23%|██▎       | 7/30 [00:15<00:40,  1.74s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0629, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8338, 'compress@10': 1.0, 'time@10': 2.4393}:  27%|██▋       | 8/30 [00:15<00:47,  2.14s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0604, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8418, 'compress@10': 1.0, 'time@10': 2.4586}:  27%|██▋       | 8/30 [00:16<00:47,  2.14s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0604, 'hit_ratio@10': 0.8179, 'ndcg@10': 0.8418, 'compress@10': 1.0, 'time@10': 2.4586}:  30%|███       | 9/30 [00:16<00:39,  1.89s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0582, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8457, 'compress@10': 1.0, 'time@10': 2.4609}:  30%|███       | 9/30 [00:19<00:39,  1.89s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0582, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8457, 'compress@10': 1.0, 'time@10': 2.4609}:  33%|███▎      | 10/30 [00:19<00:41,  2.09s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.0584, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8473, 'compress@10': 1.0, 'time@10': 2.51}:  33%|███▎      | 10/30 [00:20<00:41,  2.09s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.0584, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8473, 'compress@10': 1.0, 'time@10': 2.51}:  37%|███▋      | 11/30 [00:20<00:36,  1.92s/it]{'epoch': 11, 'num_users': 6.4167, 'loss': 0.0543, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8523, 'compress@10': 1.0, 'time@10': 2.5253}:  37%|███▋      | 11/30 [00:23<00:36,  1.92s/it]{'epoch': 11, 'num_users': 6.4167, 'loss': 0.0543, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8523, 'compress@10': 1.0, 'time@10': 2.5253}:  40%|████      | 12/30 [00:23<00:39,  2.17s/it]{'epoch': 11, 'num_users': 6.6154, 'loss': 0.0541, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8526, 'compress@10': 1.0, 'time@10': 2.5507}:  40%|████      | 12/30 [00:25<00:39,  2.17s/it]{'epoch': 11, 'num_users': 6.6154, 'loss': 0.0541, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8526, 'compress@10': 1.0, 'time@10': 2.5507}:  43%|████▎     | 13/30 [00:25<00:33,  1.96s/it]{'epoch': 11, 'num_users': 6.3571, 'loss': 0.0503, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8498, 'compress@10': 1.0, 'time@10': 2.5217}:  43%|████▎     | 13/30 [00:27<00:33,  1.96s/it]{'epoch': 11, 'num_users': 6.3571, 'loss': 0.0503, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8498, 'compress@10': 1.0, 'time@10': 2.5217}:  47%|████▋     | 14/30 [00:27<00:32,  2.02s/it]{'epoch': 11, 'num_users': 6.2667, 'loss': 0.051, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8507, 'compress@10': 1.0, 'time@10': 2.521}:  47%|████▋     | 14/30 [00:28<00:32,  2.02s/it]  {'epoch': 11, 'num_users': 6.2667, 'loss': 0.051, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8507, 'compress@10': 1.0, 'time@10': 2.521}:  50%|█████     | 15/30 [00:28<00:27,  1.80s/it]{'epoch': 11, 'num_users': 6.0625, 'loss': 0.0482, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 2.5272}:  50%|█████     | 15/30 [00:31<00:27,  1.80s/it]{'epoch': 11, 'num_users': 6.0625, 'loss': 0.0482, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 2.5272}:  53%|█████▎    | 16/30 [00:31<00:28,  2.06s/it]{'epoch': 11, 'num_users': 5.8235, 'loss': 0.0455, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8497, 'compress@10': 1.0, 'time@10': 2.5262}:  53%|█████▎    | 16/30 [00:32<00:28,  2.06s/it]{'epoch': 11, 'num_users': 5.8235, 'loss': 0.0455, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.8497, 'compress@10': 1.0, 'time@10': 2.5262}:  57%|█████▋    | 17/30 [00:32<00:23,  1.83s/it]{'epoch': 11, 'num_users': 6.0556, 'loss': 0.0457, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.853, 'compress@10': 1.0, 'time@10': 2.5404}:  57%|█████▋    | 17/30 [00:35<00:23,  1.83s/it] {'epoch': 11, 'num_users': 6.0556, 'loss': 0.0457, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.853, 'compress@10': 1.0, 'time@10': 2.5404}:  60%|██████    | 18/30 [00:35<00:25,  2.13s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.0442, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 2.5441}:  60%|██████    | 18/30 [00:36<00:25,  2.13s/it]  {'epoch': 11, 'num_users': 6.0, 'loss': 0.0442, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 2.5441}:  63%|██████▎   | 19/30 [00:36<00:20,  1.90s/it]{'epoch': 11, 'num_users': 6.15, 'loss': 0.0449, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 2.5718}:  63%|██████▎   | 19/30 [00:39<00:20,  1.90s/it]{'epoch': 11, 'num_users': 6.15, 'loss': 0.0449, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 2.5718}:  67%|██████▋   | 20/30 [00:39<00:22,  2.27s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0465, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8512, 'compress@10': 1.0, 'time@10': 2.5878}:  67%|██████▋   | 20/30 [00:41<00:22,  2.27s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0465, 'hit_ratio@10': 0.8216, 'ndcg@10': 0.8512, 'compress@10': 1.0, 'time@10': 2.5878}:  70%|███████   | 21/30 [00:41<00:18,  2.03s/it]{'epoch': 11, 'num_users': 6.1818, 'loss': 0.0455, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 2.5979}:  70%|███████   | 21/30 [00:44<00:18,  2.03s/it]{'epoch': 11, 'num_users': 6.1818, 'loss': 0.0455, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 2.5979}:  73%|███████▎  | 22/30 [00:44<00:18,  2.28s/it]{'epoch': 11, 'num_users': 6.1304, 'loss': 0.0446, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 2.6142}:  73%|███████▎  | 22/30 [00:45<00:18,  2.28s/it]{'epoch': 11, 'num_users': 6.1304, 'loss': 0.0446, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 2.6142}:  77%|███████▋  | 23/30 [00:45<00:14,  2.05s/it]{'epoch': 11, 'num_users': 5.9583, 'loss': 0.0429, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8541, 'compress@10': 1.0, 'time@10': 2.5823}:  77%|███████▋  | 23/30 [00:47<00:14,  2.05s/it]{'epoch': 11, 'num_users': 5.9583, 'loss': 0.0429, 'hit_ratio@10': 0.8256, 'ndcg@10': 0.8541, 'compress@10': 1.0, 'time@10': 2.5823}:  80%|████████  | 24/30 [00:47<00:12,  2.00s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0412, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8466, 'compress@10': 1.0, 'time@10': 2.5578}:  80%|████████  | 24/30 [00:48<00:12,  2.00s/it]   {'epoch': 11, 'num_users': 5.8, 'loss': 0.0412, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8466, 'compress@10': 1.0, 'time@10': 2.5578}:  83%|████████▎ | 25/30 [00:48<00:08,  1.71s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.0429, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8434, 'compress@10': 1.0, 'time@10': 2.5466}:  83%|████████▎ | 25/30 [00:50<00:08,  1.71s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.0429, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8434, 'compress@10': 1.0, 'time@10': 2.5466}:  87%|████████▋ | 26/30 [00:50<00:07,  1.89s/it]{'epoch': 11, 'num_users': 5.8889, 'loss': 0.0425, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 2.5552}:  87%|████████▋ | 26/30 [00:52<00:07,  1.89s/it] {'epoch': 11, 'num_users': 5.8889, 'loss': 0.0425, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 2.5552}:  90%|█████████ | 27/30 [00:52<00:05,  1.75s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.0426, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8461, 'compress@10': 1.0, 'time@10': 2.5607}:  90%|█████████ | 27/30 [00:55<00:05,  1.75s/it]  {'epoch': 11, 'num_users': 6.0, 'loss': 0.0426, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8461, 'compress@10': 1.0, 'time@10': 2.5607}:  93%|█████████▎| 28/30 [00:55<00:04,  2.05s/it]{'epoch': 11, 'num_users': 5.8621, 'loss': 0.042, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 2.57}:  93%|█████████▎| 28/30 [00:56<00:04,  2.05s/it] {'epoch': 11, 'num_users': 5.8621, 'loss': 0.042, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 2.57}:  97%|█████████▋| 29/30 [00:56<00:01,  1.87s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0424, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 2.5787}:  97%|█████████▋| 29/30 [00:59<00:01,  1.87s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0424, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 2.5787}: 100%|██████████| 30/30 [00:59<00:00,  2.17s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.0424, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 2.5787}: 100%|██████████| 30/30 [00:59<00:00,  1.98s/it]
Epoch: 11
Avg # of users: 5.866666666666666
Avg Loss: 0.042364694769954775
Avg hit ratio: 0.8276460113433219
Avg ndcg: 0.8489736003541338
Avg compression ratio: 0.9999999860153537
Avg train time: 2.578747614224752
Std train time: 0.43427803113872865
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 33, 14, 7, 8, 8, 10, 6, 9, 7, 35, 9, 64, 7, 35, 46, 14, 15, 6, 5, 19, 10, 71, 72, 6, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0558, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8329, 'compress@10': 1.0, 'time@10': 3.0669}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0558, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8329, 'compress@10': 1.0, 'time@10': 3.0669}:   3%|▎         | 1/30 [00:01<00:45,  1.57s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0554, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8908, 'compress@10': 1.0, 'time@10': 3.0076}:   3%|▎         | 1/30 [00:04<00:45,  1.57s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0554, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8908, 'compress@10': 1.0, 'time@10': 3.0076}:   7%|▋         | 2/30 [00:04<01:07,  2.40s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 2.9268}:   7%|▋         | 2/30 [00:05<01:07,  2.40s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0369, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 2.9268}:  10%|█         | 3/30 [00:05<00:52,  1.95s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0403, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 2.8749}:  10%|█         | 3/30 [00:08<00:52,  1.95s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0403, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 2.8749}:  13%|█▎        | 4/30 [00:08<00:59,  2.27s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0486, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 3.337}:  13%|█▎        | 4/30 [00:11<00:59,  2.27s/it]  {'epoch': 12, 'num_users': 5.8, 'loss': 0.0486, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 3.337}:  17%|█▋        | 5/30 [00:11<01:00,  2.40s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0505, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8691, 'compress@10': 1.0, 'time@10': 3.2203}:  17%|█▋        | 5/30 [00:14<01:00,  2.40s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0505, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8691, 'compress@10': 1.0, 'time@10': 3.2203}:  20%|██        | 6/30 [00:14<00:59,  2.49s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8623, 'compress@10': 1.0, 'time@10': 3.1979}:  20%|██        | 6/30 [00:15<00:59,  2.49s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8623, 'compress@10': 1.0, 'time@10': 3.1979}:  23%|██▎       | 7/30 [00:15<00:50,  2.19s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0498, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8726, 'compress@10': 1.0, 'time@10': 3.107}:  23%|██▎       | 7/30 [00:18<00:50,  2.19s/it]   {'epoch': 12, 'num_users': 6.125, 'loss': 0.0498, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8726, 'compress@10': 1.0, 'time@10': 3.107}:  27%|██▋       | 8/30 [00:18<00:50,  2.30s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8755, 'compress@10': 1.0, 'time@10': 3.1094}:  27%|██▋       | 8/30 [00:19<00:50,  2.30s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8755, 'compress@10': 1.0, 'time@10': 3.1094}:  30%|███       | 9/30 [00:19<00:43,  2.08s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0482, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.1068}:  30%|███       | 9/30 [00:22<00:43,  2.08s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0482, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.1068}:  33%|███▎      | 10/30 [00:22<00:48,  2.41s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.0493, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8754, 'compress@10': 1.0, 'time@10': 3.0615}:  33%|███▎      | 10/30 [00:24<00:48,  2.41s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.0493, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8754, 'compress@10': 1.0, 'time@10': 3.0615}:  37%|███▋      | 11/30 [00:24<00:39,  2.08s/it]{'epoch': 12, 'num_users': 6.4167, 'loss': 0.046, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8783, 'compress@10': 1.0, 'time@10': 3.0298}:  37%|███▋      | 11/30 [00:26<00:39,  2.08s/it] {'epoch': 12, 'num_users': 6.4167, 'loss': 0.046, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8783, 'compress@10': 1.0, 'time@10': 3.0298}:  40%|████      | 12/30 [00:26<00:40,  2.28s/it]{'epoch': 12, 'num_users': 6.6154, 'loss': 0.0464, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8765, 'compress@10': 1.0, 'time@10': 3.0074}:  40%|████      | 12/30 [00:28<00:40,  2.28s/it]{'epoch': 12, 'num_users': 6.6154, 'loss': 0.0464, 'hit_ratio@10': 0.842, 'ndcg@10': 0.8765, 'compress@10': 1.0, 'time@10': 3.0074}:  43%|████▎     | 13/30 [00:28<00:34,  2.01s/it]{'epoch': 12, 'num_users': 6.3571, 'loss': 0.0432, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8734, 'compress@10': 1.0, 'time@10': 2.9529}:  43%|████▎     | 13/30 [00:30<00:34,  2.01s/it]{'epoch': 12, 'num_users': 6.3571, 'loss': 0.0432, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8734, 'compress@10': 1.0, 'time@10': 2.9529}:  47%|████▋     | 14/30 [00:30<00:33,  2.09s/it]{'epoch': 12, 'num_users': 6.2667, 'loss': 0.0443, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8715, 'compress@10': 1.0, 'time@10': 2.9619}:  47%|████▋     | 14/30 [00:32<00:33,  2.09s/it]{'epoch': 12, 'num_users': 6.2667, 'loss': 0.0443, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8715, 'compress@10': 1.0, 'time@10': 2.9619}:  50%|█████     | 15/30 [00:32<00:29,  1.94s/it]{'epoch': 12, 'num_users': 6.0625, 'loss': 0.0419, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 2.9459}:  50%|█████     | 15/30 [00:34<00:29,  1.94s/it]{'epoch': 12, 'num_users': 6.0625, 'loss': 0.0419, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 2.9459}:  53%|█████▎    | 16/30 [00:34<00:30,  2.18s/it]{'epoch': 12, 'num_users': 5.8235, 'loss': 0.0396, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8681, 'compress@10': 1.0, 'time@10': 2.9194}:  53%|█████▎    | 16/30 [00:36<00:30,  2.18s/it]{'epoch': 12, 'num_users': 5.8235, 'loss': 0.0396, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8681, 'compress@10': 1.0, 'time@10': 2.9194}:  57%|█████▋    | 17/30 [00:36<00:24,  1.91s/it]{'epoch': 12, 'num_users': 6.0556, 'loss': 0.0402, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 2.9108}:  57%|█████▋    | 17/30 [00:39<00:24,  1.91s/it]{'epoch': 12, 'num_users': 6.0556, 'loss': 0.0402, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 2.9108}:  60%|██████    | 18/30 [00:39<00:26,  2.18s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.0389, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8726, 'compress@10': 1.0, 'time@10': 2.9039}:  60%|██████    | 18/30 [00:40<00:26,  2.18s/it]   {'epoch': 12, 'num_users': 6.0, 'loss': 0.0389, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8726, 'compress@10': 1.0, 'time@10': 2.9039}:  63%|██████▎   | 19/30 [00:40<00:21,  1.95s/it]{'epoch': 12, 'num_users': 6.15, 'loss': 0.0399, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 2.8845}:  63%|██████▎   | 19/30 [00:43<00:21,  1.95s/it] {'epoch': 12, 'num_users': 6.15, 'loss': 0.0399, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 2.8845}:  67%|██████▋   | 20/30 [00:43<00:21,  2.13s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0418, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 2.885}:  67%|██████▋   | 20/30 [00:44<00:21,  2.13s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0418, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 2.885}:  70%|███████   | 21/30 [00:44<00:17,  1.94s/it]{'epoch': 12, 'num_users': 6.1818, 'loss': 0.0409, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 2.8775}:  70%|███████   | 21/30 [00:47<00:17,  1.94s/it]{'epoch': 12, 'num_users': 6.1818, 'loss': 0.0409, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 2.8775}:  73%|███████▎  | 22/30 [00:47<00:17,  2.18s/it]{'epoch': 12, 'num_users': 6.1304, 'loss': 0.0402, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8709, 'compress@10': 1.0, 'time@10': 2.8689}:  73%|███████▎  | 22/30 [00:48<00:17,  2.18s/it]{'epoch': 12, 'num_users': 6.1304, 'loss': 0.0402, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8709, 'compress@10': 1.0, 'time@10': 2.8689}:  77%|███████▋  | 23/30 [00:48<00:13,  1.94s/it]{'epoch': 12, 'num_users': 5.9583, 'loss': 0.0387, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8679, 'compress@10': 1.0, 'time@10': 2.8282}:  77%|███████▋  | 23/30 [00:50<00:13,  1.94s/it]{'epoch': 12, 'num_users': 5.9583, 'loss': 0.0387, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8679, 'compress@10': 1.0, 'time@10': 2.8282}:  80%|████████  | 24/30 [00:50<00:11,  1.94s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0372, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 2.7963}:  80%|████████  | 24/30 [00:51<00:11,  1.94s/it]   {'epoch': 12, 'num_users': 5.8, 'loss': 0.0372, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 2.7963}:  83%|████████▎ | 25/30 [00:51<00:08,  1.67s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.0386, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8572, 'compress@10': 1.0, 'time@10': 2.8234}:  83%|████████▎ | 25/30 [00:55<00:08,  1.67s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.0386, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8572, 'compress@10': 1.0, 'time@10': 2.8234}:  87%|████████▋ | 26/30 [00:55<00:08,  2.24s/it]{'epoch': 12, 'num_users': 5.8889, 'loss': 0.0382, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8584, 'compress@10': 1.0, 'time@10': 2.8223}:  87%|████████▋ | 26/30 [00:56<00:08,  2.24s/it]{'epoch': 12, 'num_users': 5.8889, 'loss': 0.0382, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8584, 'compress@10': 1.0, 'time@10': 2.8223}:  90%|█████████ | 27/30 [00:56<00:05,  2.00s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.0387, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8579, 'compress@10': 1.0, 'time@10': 2.8108}:  90%|█████████ | 27/30 [00:59<00:05,  2.00s/it]   {'epoch': 12, 'num_users': 6.0, 'loss': 0.0387, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8579, 'compress@10': 1.0, 'time@10': 2.8108}:  93%|█████████▎| 28/30 [00:59<00:04,  2.16s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.0384, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 2.8106}:  93%|█████████▎| 28/30 [01:00<00:04,  2.16s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.0384, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 2.8106}:  97%|█████████▋| 29/30 [01:00<00:01,  1.94s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0381, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.8102}:  97%|█████████▋| 29/30 [01:03<00:01,  1.94s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0381, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.8102}: 100%|██████████| 30/30 [01:03<00:00,  2.21s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.0381, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.8102}: 100%|██████████| 30/30 [01:03<00:00,  2.11s/it]
Epoch: 12
Avg # of users: 5.866666666666666
Avg Loss: 0.038127625500108966
Avg hit ratio: 0.8411380215239078
Avg ndcg: 0.861971225792129
Avg compression ratio: 0.9999999860153537
Avg train time: 2.8102423111597696
Std train time: 0.5430247224734722
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 33, 14, 1, 8, 7, 11, 5, 8, 8, 35, 9, 66, 6, 35, 47, 14, 15, 7, 5, 19, 10, 74, 74, 4, 7, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 2.6348}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 2.6348}:   3%|▎         | 1/30 [00:01<00:39,  1.36s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.798, 'ndcg@10': 0.908, 'compress@10': 1.0, 'time@10': 2.6645}:   3%|▎         | 1/30 [00:04<00:39,  1.36s/it]  {'epoch': 13, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.798, 'ndcg@10': 0.908, 'compress@10': 1.0, 'time@10': 2.6645}:   7%|▋         | 2/30 [00:04<01:00,  2.16s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 2.6715}:   7%|▋         | 2/30 [00:05<01:00,  2.16s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 2.6715}:  10%|█         | 3/30 [00:05<00:48,  1.81s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 2.6713}:  10%|█         | 3/30 [00:08<00:48,  1.81s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 2.6713}:  13%|█▎        | 4/30 [00:08<00:56,  2.16s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0702, 'hit_ratio@10': 0.81, 'ndcg@10': 0.8388, 'compress@10': 1.0, 'time@10': 2.2947}:  13%|█▎        | 4/30 [00:08<00:56,  2.16s/it]  {'epoch': 13, 'num_users': 5.8, 'loss': 0.0702, 'hit_ratio@10': 0.81, 'ndcg@10': 0.8388, 'compress@10': 1.0, 'time@10': 2.2947}:  17%|█▋        | 5/30 [00:08<00:38,  1.54s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0682, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8374, 'compress@10': 1.0, 'time@10': 2.3459}:  17%|█▋        | 5/30 [00:11<00:38,  1.54s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0682, 'hit_ratio@10': 0.812, 'ndcg@10': 0.8374, 'compress@10': 1.0, 'time@10': 2.3459}:  20%|██        | 6/30 [00:11<00:45,  1.91s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.065, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8367, 'compress@10': 1.0, 'time@10': 2.3618}:  20%|██        | 6/30 [00:12<00:45,  1.91s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.065, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8367, 'compress@10': 1.0, 'time@10': 2.3618}:  23%|██▎       | 7/30 [00:12<00:39,  1.70s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0636, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8462, 'compress@10': 1.0, 'time@10': 2.3943}:  23%|██▎       | 7/30 [00:15<00:39,  1.70s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0636, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.8462, 'compress@10': 1.0, 'time@10': 2.3943}:  27%|██▋       | 8/30 [00:15<00:44,  2.01s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0611, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 2.4189}:  27%|██▋       | 8/30 [00:16<00:44,  2.01s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0611, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 2.4189}:  30%|███       | 9/30 [00:16<00:37,  1.80s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0584, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8566, 'compress@10': 1.0, 'time@10': 2.4496}:  30%|███       | 9/30 [00:19<00:37,  1.80s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0584, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.8566, 'compress@10': 1.0, 'time@10': 2.4496}:  33%|███▎      | 10/30 [00:19<00:41,  2.10s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.0589, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.8582, 'compress@10': 1.0, 'time@10': 2.501}:  33%|███▎      | 10/30 [00:20<00:41,  2.10s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.0589, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.8582, 'compress@10': 1.0, 'time@10': 2.501}:  37%|███▋      | 11/30 [00:20<00:36,  1.93s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 0.0546, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 2.535}:  37%|███▋      | 11/30 [00:23<00:36,  1.93s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 0.0546, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 2.535}:  40%|████      | 12/30 [00:23<00:40,  2.24s/it]{'epoch': 13, 'num_users': 6.6154, 'loss': 0.0541, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.5651}:  40%|████      | 12/30 [00:25<00:40,  2.24s/it]{'epoch': 13, 'num_users': 6.6154, 'loss': 0.0541, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.5651}:  43%|████▎     | 13/30 [00:25<00:34,  2.02s/it]{'epoch': 13, 'num_users': 6.3571, 'loss': 0.0503, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 2.5631}:  43%|████▎     | 13/30 [00:27<00:34,  2.02s/it] {'epoch': 13, 'num_users': 6.3571, 'loss': 0.0503, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 2.5631}:  47%|████▋     | 14/30 [00:27<00:34,  2.19s/it]{'epoch': 13, 'num_users': 6.2667, 'loss': 0.0507, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 2.563}:  47%|████▋     | 14/30 [00:29<00:34,  2.19s/it]{'epoch': 13, 'num_users': 6.2667, 'loss': 0.0507, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 2.563}:  50%|█████     | 15/30 [00:29<00:28,  1.92s/it]{'epoch': 13, 'num_users': 6.0625, 'loss': 0.0478, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 2.5729}:  50%|█████     | 15/30 [00:31<00:28,  1.92s/it]{'epoch': 13, 'num_users': 6.0625, 'loss': 0.0478, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 2.5729}:  53%|█████▎    | 16/30 [00:31<00:30,  2.18s/it]{'epoch': 13, 'num_users': 5.8235, 'loss': 0.0451, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 2.5815}:  53%|█████▎    | 16/30 [00:33<00:30,  2.18s/it]{'epoch': 13, 'num_users': 5.8235, 'loss': 0.0451, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 2.5815}:  57%|█████▋    | 17/30 [00:33<00:25,  1.94s/it]{'epoch': 13, 'num_users': 6.0556, 'loss': 0.0463, 'hit_ratio@10': 0.8232, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 2.6025}:  57%|█████▋    | 17/30 [00:36<00:25,  1.94s/it] {'epoch': 13, 'num_users': 6.0556, 'loss': 0.0463, 'hit_ratio@10': 0.8232, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 2.6025}:  60%|██████    | 18/30 [00:36<00:27,  2.26s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.0447, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 2.6093}:  60%|██████    | 18/30 [00:37<00:27,  2.26s/it]  {'epoch': 13, 'num_users': 6.0, 'loss': 0.0447, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 2.6093}:  63%|██████▎   | 19/30 [00:37<00:22,  2.00s/it]{'epoch': 13, 'num_users': 6.15, 'loss': 0.0453, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8631, 'compress@10': 1.0, 'time@10': 2.6239}:  63%|██████▎   | 19/30 [00:40<00:22,  2.00s/it]{'epoch': 13, 'num_users': 6.15, 'loss': 0.0453, 'hit_ratio@10': 0.8312, 'ndcg@10': 0.8631, 'compress@10': 1.0, 'time@10': 2.6239}:  67%|██████▋   | 20/30 [00:40<00:22,  2.29s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0469, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 2.6506}:  67%|██████▋   | 20/30 [00:42<00:22,  2.29s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0469, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 2.6506}:  70%|███████   | 21/30 [00:42<00:18,  2.09s/it]{'epoch': 13, 'num_users': 6.1818, 'loss': 0.0458, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 2.6595}:  70%|███████   | 21/30 [00:45<00:18,  2.09s/it] {'epoch': 13, 'num_users': 6.1818, 'loss': 0.0458, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 2.6595}:  73%|███████▎  | 22/30 [00:45<00:18,  2.33s/it]{'epoch': 13, 'num_users': 6.1304, 'loss': 0.0449, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8657, 'compress@10': 1.0, 'time@10': 2.6636}:  73%|███████▎  | 22/30 [00:46<00:18,  2.33s/it]{'epoch': 13, 'num_users': 6.1304, 'loss': 0.0449, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8657, 'compress@10': 1.0, 'time@10': 2.6636}:  77%|███████▋  | 23/30 [00:46<00:14,  2.05s/it]{'epoch': 13, 'num_users': 5.9583, 'loss': 0.0431, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8629, 'compress@10': 1.0, 'time@10': 2.6366}:  77%|███████▋  | 23/30 [00:48<00:14,  2.05s/it]{'epoch': 13, 'num_users': 5.9583, 'loss': 0.0431, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8629, 'compress@10': 1.0, 'time@10': 2.6366}:  80%|████████  | 24/30 [00:48<00:12,  2.05s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0414, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 2.6149}:  80%|████████  | 24/30 [00:49<00:12,  2.05s/it]    {'epoch': 13, 'num_users': 5.8, 'loss': 0.0414, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 2.6149}:  83%|████████▎ | 25/30 [00:49<00:08,  1.76s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.0429, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8519, 'compress@10': 1.0, 'time@10': 2.6053}:  83%|████████▎ | 25/30 [00:52<00:08,  1.76s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.0429, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8519, 'compress@10': 1.0, 'time@10': 2.6053}:  87%|████████▋ | 26/30 [00:52<00:07,  1.95s/it]{'epoch': 13, 'num_users': 5.8889, 'loss': 0.0424, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 2.6119}:  87%|████████▋ | 26/30 [00:53<00:07,  1.95s/it]{'epoch': 13, 'num_users': 5.8889, 'loss': 0.0424, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 2.6119}:  90%|█████████ | 27/30 [00:53<00:05,  1.80s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.0426, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8545, 'compress@10': 1.0, 'time@10': 2.6244}:  90%|█████████ | 27/30 [00:56<00:05,  1.80s/it]   {'epoch': 13, 'num_users': 6.0, 'loss': 0.0426, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8545, 'compress@10': 1.0, 'time@10': 2.6244}:  93%|█████████▎| 28/30 [00:56<00:04,  2.16s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.042, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 2.6319}:  93%|█████████▎| 28/30 [00:58<00:04,  2.16s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.042, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 2.6319}:  97%|█████████▋| 29/30 [00:58<00:01,  1.95s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0421, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8588, 'compress@10': 1.0, 'time@10': 2.6375}:  97%|█████████▋| 29/30 [01:00<00:01,  1.95s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0421, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8588, 'compress@10': 1.0, 'time@10': 2.6375}: 100%|██████████| 30/30 [01:00<00:00,  2.22s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.0421, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8588, 'compress@10': 1.0, 'time@10': 2.6375}: 100%|██████████| 30/30 [01:00<00:00,  2.03s/it]
Epoch: 13
Avg # of users: 5.866666666666666
Avg Loss: 0.042125498920781705
Avg hit ratio: 0.8357796198402221
Avg ndcg: 0.8588261453495237
Avg compression ratio: 0.9999999860153537
Avg train time: 2.637535587946574
Std train time: 0.4197925669150156
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 33, 14, 7, 9, 8, 11, 6, 8, 7, 35, 8, 67, 7, 35, 47, 13, 15, 7, 4, 19, 10, 76, 76, 5, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8537, 'compress@10': 1.0, 'time@10': 2.6151}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8537, 'compress@10': 1.0, 'time@10': 2.6151}:   3%|▎         | 1/30 [00:01<00:39,  1.35s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0452, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 2.6518}:   3%|▎         | 1/30 [00:04<00:39,  1.35s/it] {'epoch': 14, 'num_users': 7.0, 'loss': 0.0452, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 2.6518}:   7%|▋         | 2/30 [00:04<01:00,  2.16s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 2.6897}:   7%|▋         | 2/30 [00:05<01:00,  2.16s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 2.6897}:  10%|█         | 3/30 [00:05<00:49,  1.82s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 2.7107}:  10%|█         | 3/30 [00:08<00:49,  1.82s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0335, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 2.7107}:  13%|█▎        | 4/30 [00:08<00:57,  2.21s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0429, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8794, 'compress@10': 1.0, 'time@10': 3.1813}:  13%|█▎        | 4/30 [00:10<00:57,  2.21s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0429, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8794, 'compress@10': 1.0, 'time@10': 3.1813}:  17%|█▋        | 5/30 [00:10<00:58,  2.34s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0447, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 3.1343}:  17%|█▋        | 5/30 [00:13<00:58,  2.34s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0447, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 3.1343}:  20%|██        | 6/30 [00:13<01:01,  2.54s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0441, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 3.0839}:  20%|██        | 6/30 [00:15<01:01,  2.54s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0441, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 3.0839}:  23%|██▎       | 7/30 [00:15<00:50,  2.18s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0433, 'hit_ratio@10': 0.881, 'ndcg@10': 0.8682, 'compress@10': 1.0, 'time@10': 3.0457}:  23%|██▎       | 7/30 [00:18<00:50,  2.18s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0433, 'hit_ratio@10': 0.881, 'ndcg@10': 0.8682, 'compress@10': 1.0, 'time@10': 3.0457}:  27%|██▋       | 8/30 [00:18<00:52,  2.38s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.043, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8722, 'compress@10': 1.0, 'time@10': 3.0391}:  27%|██▋       | 8/30 [00:19<00:52,  2.38s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.043, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8722, 'compress@10': 1.0, 'time@10': 3.0391}:  30%|███       | 9/30 [00:19<00:44,  2.12s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 2.9975}:  30%|███       | 9/30 [00:22<00:44,  2.12s/it]  {'epoch': 14, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 2.9975}:  33%|███▎      | 10/30 [00:22<00:45,  2.28s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 0.0444, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8697, 'compress@10': 1.0, 'time@10': 2.9782}:  33%|███▎      | 10/30 [00:23<00:45,  2.28s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 0.0444, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8697, 'compress@10': 1.0, 'time@10': 2.9782}:  37%|███▋      | 11/30 [00:23<00:38,  2.02s/it]{'epoch': 14, 'num_users': 6.4167, 'loss': 0.0415, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8736, 'compress@10': 1.0, 'time@10': 2.9573}:  37%|███▋      | 11/30 [00:26<00:38,  2.02s/it]{'epoch': 14, 'num_users': 6.4167, 'loss': 0.0415, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8736, 'compress@10': 1.0, 'time@10': 2.9573}:  40%|████      | 12/30 [00:26<00:40,  2.25s/it]{'epoch': 14, 'num_users': 6.6154, 'loss': 0.042, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8746, 'compress@10': 1.0, 'time@10': 2.9483}:  40%|████      | 12/30 [00:27<00:40,  2.25s/it] {'epoch': 14, 'num_users': 6.6154, 'loss': 0.042, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8746, 'compress@10': 1.0, 'time@10': 2.9483}:  43%|████▎     | 13/30 [00:27<00:34,  2.01s/it]{'epoch': 14, 'num_users': 6.3571, 'loss': 0.0391, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 2.9126}:  43%|████▎     | 13/30 [00:30<00:34,  2.01s/it]{'epoch': 14, 'num_users': 6.3571, 'loss': 0.0391, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 2.9126}:  47%|████▋     | 14/30 [00:30<00:34,  2.15s/it]{'epoch': 14, 'num_users': 6.2667, 'loss': 0.0402, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 2.9193}:  47%|████▋     | 14/30 [00:31<00:34,  2.15s/it]{'epoch': 14, 'num_users': 6.2667, 'loss': 0.0402, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 2.9193}:  50%|█████     | 15/30 [00:31<00:29,  1.97s/it]{'epoch': 14, 'num_users': 6.0625, 'loss': 0.038, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8727, 'compress@10': 1.0, 'time@10': 2.9039}:  50%|█████     | 15/30 [00:34<00:29,  1.97s/it] {'epoch': 14, 'num_users': 6.0625, 'loss': 0.038, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8727, 'compress@10': 1.0, 'time@10': 2.9039}:  53%|█████▎    | 16/30 [00:34<00:31,  2.23s/it]{'epoch': 14, 'num_users': 5.8235, 'loss': 0.0359, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 2.8915}:  53%|█████▎    | 16/30 [00:36<00:31,  2.23s/it]{'epoch': 14, 'num_users': 5.8235, 'loss': 0.0359, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 2.8915}:  57%|█████▋    | 17/30 [00:36<00:25,  1.97s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 0.0374, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8642, 'compress@10': 1.0, 'time@10': 2.8798}:  57%|█████▋    | 17/30 [00:38<00:25,  1.97s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 0.0374, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8642, 'compress@10': 1.0, 'time@10': 2.8798}:  60%|██████    | 18/30 [00:38<00:26,  2.20s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 0.0362, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 2.8747}:  60%|██████    | 18/30 [00:40<00:26,  2.20s/it]   {'epoch': 14, 'num_users': 6.0, 'loss': 0.0362, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 2.8747}:  63%|██████▎   | 19/30 [00:40<00:21,  1.97s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 0.0372, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8644, 'compress@10': 1.0, 'time@10': 2.8785}:  63%|██████▎   | 19/30 [00:43<00:21,  1.97s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 0.0372, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8644, 'compress@10': 1.0, 'time@10': 2.8785}:  67%|██████▋   | 20/30 [00:43<00:22,  2.28s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0391, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8611, 'compress@10': 1.0, 'time@10': 2.8555}:  67%|██████▋   | 20/30 [00:44<00:22,  2.28s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0391, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8611, 'compress@10': 1.0, 'time@10': 2.8555}:  70%|███████   | 21/30 [00:44<00:17,  1.97s/it]{'epoch': 14, 'num_users': 6.1818, 'loss': 0.0383, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 2.8494}:  70%|███████   | 21/30 [00:47<00:17,  1.97s/it]{'epoch': 14, 'num_users': 6.1818, 'loss': 0.0383, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 2.8494}:  73%|███████▎  | 22/30 [00:47<00:17,  2.20s/it]{'epoch': 14, 'num_users': 6.1304, 'loss': 0.0378, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 2.8398}:  73%|███████▎  | 22/30 [00:48<00:17,  2.20s/it]{'epoch': 14, 'num_users': 6.1304, 'loss': 0.0378, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 2.8398}:  77%|███████▋  | 23/30 [00:48<00:13,  1.95s/it]{'epoch': 14, 'num_users': 5.9583, 'loss': 0.0363, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.8123}:  77%|███████▋  | 23/30 [00:50<00:13,  1.95s/it]{'epoch': 14, 'num_users': 5.9583, 'loss': 0.0363, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.8123}:  80%|████████  | 24/30 [00:50<00:12,  2.03s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0349, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 2.7829}:  80%|████████  | 24/30 [00:51<00:12,  2.03s/it]   {'epoch': 14, 'num_users': 5.8, 'loss': 0.0349, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 2.7829}:  83%|████████▎ | 25/30 [00:51<00:08,  1.74s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 0.0364, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 2.7861}:  83%|████████▎ | 25/30 [00:54<00:08,  1.74s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 0.0364, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 2.7861}:  87%|████████▋ | 26/30 [00:54<00:08,  2.09s/it]{'epoch': 14, 'num_users': 5.8889, 'loss': 0.0361, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8534, 'compress@10': 1.0, 'time@10': 2.7862}:  87%|████████▋ | 26/30 [00:56<00:08,  2.09s/it] {'epoch': 14, 'num_users': 5.8889, 'loss': 0.0361, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8534, 'compress@10': 1.0, 'time@10': 2.7862}:  90%|█████████ | 27/30 [00:56<00:05,  1.89s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 0.0363, 'hit_ratio@10': 0.8401, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 2.7795}:  90%|█████████ | 27/30 [00:58<00:05,  1.89s/it]   {'epoch': 14, 'num_users': 6.0, 'loss': 0.0363, 'hit_ratio@10': 0.8401, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 2.7795}:  93%|█████████▎| 28/30 [00:58<00:04,  2.12s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 0.0359, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8563, 'compress@10': 1.0, 'time@10': 2.7829}:  93%|█████████▎| 28/30 [01:00<00:04,  2.12s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 0.0359, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8563, 'compress@10': 1.0, 'time@10': 2.7829}:  97%|█████████▋| 29/30 [01:00<00:01,  1.92s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0356, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.785}:  97%|█████████▋| 29/30 [01:03<00:01,  1.92s/it] {'epoch': 14, 'num_users': 5.8667, 'loss': 0.0356, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.785}: 100%|██████████| 30/30 [01:03<00:00,  2.21s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 0.0356, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.785}: 100%|██████████| 30/30 [01:03<00:00,  2.11s/it]
Epoch: 14
Avg # of users: 5.866666666666666
Avg Loss: 0.03562220088371949
Avg hit ratio: 0.8413769700523301
Avg ndcg: 0.8582949166165943
Avg compression ratio: 0.9999999860153537
Avg train time: 2.7849674622217813
Std train time: 0.4705617058523483
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 12, 33, 14, 1, 9, 8, 11, 5, 8, 7, 35, 8, 68, 6, 35, 47, 13, 15, 6, 5, 19, 10, 78, 78, 5, 7, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0617, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.884, 'compress@10': 1.0, 'time@10': 3.006}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0617, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.884, 'compress@10': 1.0, 'time@10': 3.006}:   3%|▎         | 1/30 [00:01<00:44,  1.54s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0539, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9028, 'compress@10': 1.0, 'time@10': 2.8118}:   3%|▎         | 1/30 [00:04<00:44,  1.54s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0539, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9028, 'compress@10': 1.0, 'time@10': 2.8118}:   7%|▋         | 2/30 [00:04<01:02,  2.22s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8876, 'compress@10': 1.0, 'time@10': 2.7615}:   7%|▋         | 2/30 [00:05<01:02,  2.22s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8876, 'compress@10': 1.0, 'time@10': 2.7615}:  10%|█         | 3/30 [00:05<00:49,  1.83s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0382, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 2.7643}:  10%|█         | 3/30 [00:08<00:49,  1.83s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0382, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 2.7643}:  13%|█▎        | 4/30 [00:08<00:57,  2.22s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0719, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8335, 'compress@10': 1.0, 'time@10': 2.3584}:  13%|█▎        | 4/30 [00:08<00:57,  2.22s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0719, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8335, 'compress@10': 1.0, 'time@10': 2.3584}:  17%|█▋        | 5/30 [00:08<00:39,  1.56s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0684, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8341, 'compress@10': 1.0, 'time@10': 2.4758}:  17%|█▋        | 5/30 [00:11<00:39,  1.56s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0684, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8341, 'compress@10': 1.0, 'time@10': 2.4758}:  20%|██        | 6/30 [00:11<00:50,  2.09s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0655, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8307, 'compress@10': 1.0, 'time@10': 2.5313}:  20%|██        | 6/30 [00:13<00:50,  2.09s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0655, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8307, 'compress@10': 1.0, 'time@10': 2.5313}:  23%|██▎       | 7/30 [00:13<00:43,  1.89s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0622, 'hit_ratio@10': 0.872, 'ndcg@10': 0.8416, 'compress@10': 1.0, 'time@10': 2.5546}:  23%|██▎       | 7/30 [00:16<00:43,  1.89s/it]  {'epoch': 15, 'num_users': 6.125, 'loss': 0.0622, 'hit_ratio@10': 0.872, 'ndcg@10': 0.8416, 'compress@10': 1.0, 'time@10': 2.5546}:  27%|██▋       | 8/30 [00:16<00:47,  2.16s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0593, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 2.5657}:  27%|██▋       | 8/30 [00:17<00:47,  2.16s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0593, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 2.5657}:  30%|███       | 9/30 [00:17<00:40,  1.91s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0568, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 2.5601}:  30%|███       | 9/30 [00:20<00:40,  1.91s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0568, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 2.5601}:  33%|███▎      | 10/30 [00:20<00:42,  2.11s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 0.0575, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 2.561}:  33%|███▎      | 10/30 [00:21<00:42,  2.11s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 0.0575, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 2.561}:  37%|███▋      | 11/30 [00:21<00:35,  1.87s/it]{'epoch': 15, 'num_users': 6.4167, 'loss': 0.0535, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 2.5924}:  37%|███▋      | 11/30 [00:24<00:35,  1.87s/it] {'epoch': 15, 'num_users': 6.4167, 'loss': 0.0535, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 2.5924}:  40%|████      | 12/30 [00:24<00:39,  2.21s/it]{'epoch': 15, 'num_users': 6.6154, 'loss': 0.0532, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8611, 'compress@10': 1.0, 'time@10': 2.5979}:  40%|████      | 12/30 [00:25<00:39,  2.21s/it]{'epoch': 15, 'num_users': 6.6154, 'loss': 0.0532, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8611, 'compress@10': 1.0, 'time@10': 2.5979}:  43%|████▎     | 13/30 [00:25<00:33,  1.95s/it]{'epoch': 15, 'num_users': 6.3571, 'loss': 0.0494, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8591, 'compress@10': 1.0, 'time@10': 2.5858}:  43%|████▎     | 13/30 [00:28<00:33,  1.95s/it]{'epoch': 15, 'num_users': 6.3571, 'loss': 0.0494, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8591, 'compress@10': 1.0, 'time@10': 2.5858}:  47%|████▋     | 14/30 [00:28<00:33,  2.11s/it]{'epoch': 15, 'num_users': 6.2667, 'loss': 0.0497, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8596, 'compress@10': 1.0, 'time@10': 2.5921}:  47%|████▋     | 14/30 [00:29<00:33,  2.11s/it] {'epoch': 15, 'num_users': 6.2667, 'loss': 0.0497, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8596, 'compress@10': 1.0, 'time@10': 2.5921}:  50%|█████     | 15/30 [00:29<00:28,  1.90s/it]{'epoch': 15, 'num_users': 6.0625, 'loss': 0.0468, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.6103}:  50%|█████     | 15/30 [00:32<00:28,  1.90s/it]{'epoch': 15, 'num_users': 6.0625, 'loss': 0.0468, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.6103}:  53%|█████▎    | 16/30 [00:32<00:30,  2.21s/it]{'epoch': 15, 'num_users': 5.8235, 'loss': 0.0442, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8572, 'compress@10': 1.0, 'time@10': 2.6206}:  53%|█████▎    | 16/30 [00:33<00:30,  2.21s/it]{'epoch': 15, 'num_users': 5.8235, 'loss': 0.0442, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8572, 'compress@10': 1.0, 'time@10': 2.6206}:  57%|█████▋    | 17/30 [00:33<00:25,  1.97s/it]{'epoch': 15, 'num_users': 6.0556, 'loss': 0.0446, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8575, 'compress@10': 1.0, 'time@10': 2.6233}:  57%|█████▋    | 17/30 [00:36<00:25,  1.97s/it]{'epoch': 15, 'num_users': 6.0556, 'loss': 0.0446, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8575, 'compress@10': 1.0, 'time@10': 2.6233}:  60%|██████    | 18/30 [00:36<00:26,  2.19s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 0.043, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 2.6331}:  60%|██████    | 18/30 [00:38<00:26,  2.19s/it]    {'epoch': 15, 'num_users': 6.0, 'loss': 0.043, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 2.6331}:  63%|██████▎   | 19/30 [00:38<00:21,  1.97s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 0.0436, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.6246}:  63%|██████▎   | 19/30 [00:40<00:21,  1.97s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 0.0436, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.6246}:  67%|██████▋   | 20/30 [00:40<00:21,  2.13s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0451, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 2.6397}:  67%|██████▋   | 20/30 [00:42<00:21,  2.13s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0451, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 2.6397}:  70%|███████   | 21/30 [00:42<00:17,  1.94s/it]{'epoch': 15, 'num_users': 6.1818, 'loss': 0.0446, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8608, 'compress@10': 1.0, 'time@10': 2.6406}:  70%|███████   | 21/30 [00:44<00:17,  1.94s/it]{'epoch': 15, 'num_users': 6.1818, 'loss': 0.0446, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8608, 'compress@10': 1.0, 'time@10': 2.6406}:  73%|███████▎  | 22/30 [00:44<00:17,  2.17s/it]{'epoch': 15, 'num_users': 6.1304, 'loss': 0.0437, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 2.6421}:  73%|███████▎  | 22/30 [00:46<00:17,  2.17s/it]{'epoch': 15, 'num_users': 6.1304, 'loss': 0.0437, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 2.6421}:  77%|███████▋  | 23/30 [00:46<00:13,  1.93s/it]{'epoch': 15, 'num_users': 5.9583, 'loss': 0.0419, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8595, 'compress@10': 1.0, 'time@10': 2.625}:  77%|███████▋  | 23/30 [00:48<00:13,  1.93s/it] {'epoch': 15, 'num_users': 5.9583, 'loss': 0.0419, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8595, 'compress@10': 1.0, 'time@10': 2.625}:  80%|████████  | 24/30 [00:48<00:12,  2.03s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0403, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 2.6047}:  80%|████████  | 24/30 [00:49<00:12,  2.03s/it]  {'epoch': 15, 'num_users': 5.8, 'loss': 0.0403, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 2.6047}:  83%|████████▎ | 25/30 [00:49<00:08,  1.75s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 0.0415, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8497, 'compress@10': 1.0, 'time@10': 2.6168}:  83%|████████▎ | 25/30 [00:52<00:08,  1.75s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 0.0415, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8497, 'compress@10': 1.0, 'time@10': 2.6168}:  87%|████████▋ | 26/30 [00:52<00:08,  2.11s/it]{'epoch': 15, 'num_users': 5.8889, 'loss': 0.041, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8511, 'compress@10': 1.0, 'time@10': 2.6268}:  87%|████████▋ | 26/30 [00:54<00:08,  2.11s/it] {'epoch': 15, 'num_users': 5.8889, 'loss': 0.041, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8511, 'compress@10': 1.0, 'time@10': 2.6268}:  90%|█████████ | 27/30 [00:54<00:05,  1.92s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 0.0412, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 2.6418}:  90%|█████████ | 27/30 [00:57<00:05,  1.92s/it]  {'epoch': 15, 'num_users': 6.0, 'loss': 0.0412, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 2.6418}:  93%|█████████▎| 28/30 [00:57<00:04,  2.28s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 0.0405, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8545, 'compress@10': 1.0, 'time@10': 2.6525}:  93%|█████████▎| 28/30 [00:58<00:04,  2.28s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 0.0405, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8545, 'compress@10': 1.0, 'time@10': 2.6525}:  97%|█████████▋| 29/30 [00:58<00:02,  2.05s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0403, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 2.6597}:  97%|█████████▋| 29/30 [01:01<00:02,  2.05s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0403, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 2.6597}: 100%|██████████| 30/30 [01:01<00:00,  2.30s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 0.0403, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 2.6597}: 100%|██████████| 30/30 [01:01<00:00,  2.05s/it]
Epoch: 15
Avg # of users: 5.866666666666666
Avg Loss: 0.040263018462840264
Avg hit ratio: 0.8472612078752758
Avg ndcg: 0.8559230447296646
Avg compression ratio: 0.9999999860153537
Avg train time: 2.6596503973007204
Std train time: 0.4199085231429804
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 33, 14, 8, 8, 8, 11, 5, 9, 8, 34, 8, 69, 6, 35, 47, 13, 15, 7, 4, 19, 10, 80, 80, 5, 7, 7, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8592, 'compress@10': 1.0, 'time@10': 2.7866}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8592, 'compress@10': 1.0, 'time@10': 2.7866}:   3%|▎         | 1/30 [00:01<00:41,  1.43s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 2.7029}:   3%|▎         | 1/30 [00:04<00:41,  1.43s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 2.7029}:   7%|▋         | 2/30 [00:04<01:00,  2.15s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8828, 'compress@10': 1.0, 'time@10': 2.6923}:   7%|▋         | 2/30 [00:05<01:00,  2.15s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8828, 'compress@10': 1.0, 'time@10': 2.6923}:  10%|█         | 3/30 [00:05<00:48,  1.80s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 2.6918}:  10%|█         | 3/30 [00:08<00:48,  1.80s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 2.6918}:  13%|█▎        | 4/30 [00:08<00:56,  2.16s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.042, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 3.305}:  13%|█▎        | 4/30 [00:11<00:56,  2.16s/it]  {'epoch': 16, 'num_users': 5.8, 'loss': 0.042, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 3.305}:  17%|█▋        | 5/30 [00:11<01:00,  2.44s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0435, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8787, 'compress@10': 1.0, 'time@10': 3.1777}:  17%|█▋        | 5/30 [00:13<01:00,  2.44s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0435, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8787, 'compress@10': 1.0, 'time@10': 3.1777}:  20%|██        | 6/30 [00:13<00:59,  2.48s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0444, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8692, 'compress@10': 1.0, 'time@10': 3.1314}:  20%|██        | 6/30 [00:15<00:59,  2.48s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0444, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8692, 'compress@10': 1.0, 'time@10': 3.1314}:  23%|██▎       | 7/30 [00:15<00:49,  2.15s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0451, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 3.0752}:  23%|██▎       | 7/30 [00:17<00:49,  2.15s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0451, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 3.0752}:  27%|██▋       | 8/30 [00:17<00:51,  2.33s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0441, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8804, 'compress@10': 1.0, 'time@10': 3.0136}:  27%|██▋       | 8/30 [00:19<00:51,  2.33s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0441, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8804, 'compress@10': 1.0, 'time@10': 3.0136}:  30%|███       | 9/30 [00:19<00:42,  2.03s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0422, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 2.9897}:  30%|███       | 9/30 [00:22<00:42,  2.03s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0422, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 2.9897}:  33%|███▎      | 10/30 [00:22<00:45,  2.27s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 0.0436, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8806, 'compress@10': 1.0, 'time@10': 2.9921}:  33%|███▎      | 10/30 [00:23<00:45,  2.27s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 0.0436, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8806, 'compress@10': 1.0, 'time@10': 2.9921}:  37%|███▋      | 11/30 [00:23<00:38,  2.05s/it]{'epoch': 16, 'num_users': 6.4167, 'loss': 0.0405, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 2.9642}:  37%|███▋      | 11/30 [00:26<00:38,  2.05s/it]{'epoch': 16, 'num_users': 6.4167, 'loss': 0.0405, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 2.9642}:  40%|████      | 12/30 [00:26<00:40,  2.24s/it]{'epoch': 16, 'num_users': 6.6154, 'loss': 0.0409, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8828, 'compress@10': 1.0, 'time@10': 2.9381}:  40%|████      | 12/30 [00:27<00:40,  2.24s/it]{'epoch': 16, 'num_users': 6.6154, 'loss': 0.0409, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8828, 'compress@10': 1.0, 'time@10': 2.9381}:  43%|████▎     | 13/30 [00:27<00:33,  1.97s/it]{'epoch': 16, 'num_users': 6.3571, 'loss': 0.038, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8793, 'compress@10': 1.0, 'time@10': 2.919}:  43%|████▎     | 13/30 [00:30<00:33,  1.97s/it]  {'epoch': 16, 'num_users': 6.3571, 'loss': 0.038, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8793, 'compress@10': 1.0, 'time@10': 2.919}:  47%|████▋     | 14/30 [00:30<00:35,  2.20s/it]{'epoch': 16, 'num_users': 6.2667, 'loss': 0.039, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 2.888}:  47%|████▋     | 14/30 [00:31<00:35,  2.20s/it]{'epoch': 16, 'num_users': 6.2667, 'loss': 0.039, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 2.888}:  50%|█████     | 15/30 [00:31<00:28,  1.91s/it]{'epoch': 16, 'num_users': 6.0625, 'loss': 0.0369, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8806, 'compress@10': 1.0, 'time@10': 2.8823}:  50%|█████     | 15/30 [00:34<00:28,  1.91s/it]{'epoch': 16, 'num_users': 6.0625, 'loss': 0.0369, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8806, 'compress@10': 1.0, 'time@10': 2.8823}:  53%|█████▎    | 16/30 [00:34<00:30,  2.19s/it]{'epoch': 16, 'num_users': 5.8235, 'loss': 0.0348, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 2.8734}:  53%|█████▎    | 16/30 [00:35<00:30,  2.19s/it]{'epoch': 16, 'num_users': 5.8235, 'loss': 0.0348, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 2.8734}:  57%|█████▋    | 17/30 [00:35<00:25,  1.96s/it]{'epoch': 16, 'num_users': 6.0556, 'loss': 0.035, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 2.8657}:  57%|█████▋    | 17/30 [00:38<00:25,  1.96s/it]  {'epoch': 16, 'num_users': 6.0556, 'loss': 0.035, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8748, 'compress@10': 1.0, 'time@10': 2.8657}:  60%|██████    | 18/30 [00:38<00:26,  2.20s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 0.0337, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.876, 'compress@10': 1.0, 'time@10': 2.8665}:  60%|██████    | 18/30 [00:40<00:26,  2.20s/it]  {'epoch': 16, 'num_users': 6.0, 'loss': 0.0337, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.876, 'compress@10': 1.0, 'time@10': 2.8665}:  63%|██████▎   | 19/30 [00:40<00:21,  1.99s/it]{'epoch': 16, 'num_users': 6.15, 'loss': 0.0347, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 2.8818}:  63%|██████▎   | 19/30 [00:43<00:21,  1.99s/it]{'epoch': 16, 'num_users': 6.15, 'loss': 0.0347, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 2.8818}:  67%|██████▋   | 20/30 [00:43<00:23,  2.36s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0366, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8707, 'compress@10': 1.0, 'time@10': 2.8538}:  67%|██████▋   | 20/30 [00:44<00:23,  2.36s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0366, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8707, 'compress@10': 1.0, 'time@10': 2.8538}:  70%|███████   | 21/30 [00:44<00:18,  2.00s/it]{'epoch': 16, 'num_users': 6.1818, 'loss': 0.0362, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 2.8485}:  70%|███████   | 21/30 [00:47<00:18,  2.00s/it]{'epoch': 16, 'num_users': 6.1818, 'loss': 0.0362, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 2.8485}:  73%|███████▎  | 22/30 [00:47<00:17,  2.24s/it]{'epoch': 16, 'num_users': 6.1304, 'loss': 0.0357, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8728, 'compress@10': 1.0, 'time@10': 2.8458}:  73%|███████▎  | 22/30 [00:48<00:17,  2.24s/it]{'epoch': 16, 'num_users': 6.1304, 'loss': 0.0357, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8728, 'compress@10': 1.0, 'time@10': 2.8458}:  77%|███████▋  | 23/30 [00:48<00:13,  1.99s/it]{'epoch': 16, 'num_users': 5.9583, 'loss': 0.0342, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 2.8215}:  77%|███████▋  | 23/30 [00:51<00:13,  1.99s/it]{'epoch': 16, 'num_users': 5.9583, 'loss': 0.0342, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 2.8215}:  80%|████████  | 24/30 [00:51<00:12,  2.09s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0329, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 2.7962}:  80%|████████  | 24/30 [00:52<00:12,  2.09s/it]   {'epoch': 16, 'num_users': 5.8, 'loss': 0.0329, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 2.7962}:  83%|████████▎ | 25/30 [00:52<00:09,  1.80s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 0.0343, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8593, 'compress@10': 1.0, 'time@10': 2.8018}:  83%|████████▎ | 25/30 [00:55<00:09,  1.80s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 0.0343, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8593, 'compress@10': 1.0, 'time@10': 2.8018}:  87%|████████▋ | 26/30 [00:55<00:08,  2.15s/it]{'epoch': 16, 'num_users': 5.8889, 'loss': 0.0341, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 2.798}:  87%|████████▋ | 26/30 [00:56<00:08,  2.15s/it] {'epoch': 16, 'num_users': 5.8889, 'loss': 0.0341, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 2.798}:  90%|█████████ | 27/30 [00:56<00:05,  1.92s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 0.0342, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 2.7902}:  90%|█████████ | 27/30 [00:59<00:05,  1.92s/it]  {'epoch': 16, 'num_users': 6.0, 'loss': 0.0342, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 2.7902}:  93%|█████████▎| 28/30 [00:59<00:04,  2.13s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 0.0338, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 2.7834}:  93%|█████████▎| 28/30 [01:00<00:04,  2.13s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 0.0338, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 2.7834}:  97%|█████████▋| 29/30 [01:00<00:01,  1.89s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0337, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 2.7874}:  97%|█████████▋| 29/30 [01:03<00:01,  1.89s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0337, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 2.7874}: 100%|██████████| 30/30 [01:03<00:00,  2.21s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 0.0337, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 2.7874}: 100%|██████████| 30/30 [01:03<00:00,  2.11s/it]
Epoch: 16
Avg # of users: 5.866666666666666
Avg Loss: 0.0336677296917604
Avg hit ratio: 0.8463025831954883
Avg ndcg: 0.8639012206748742
Avg compression ratio: 0.9999999860153537
Avg train time: 2.787446896235148
Std train time: 0.589215743906483
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 33, 14, 1, 9, 8, 11, 6, 9, 7, 34, 8, 69, 7, 35, 47, 13, 15, 6, 6, 19, 10, 82, 82, 4, 7, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0548, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 2.6667}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0548, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 2.6667}:   3%|▎         | 1/30 [00:01<00:39,  1.37s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 2.6656}:   3%|▎         | 1/30 [00:04<00:39,  1.37s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 2.6656}:   7%|▋         | 2/30 [00:04<01:00,  2.15s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8827, 'compress@10': 1.0, 'time@10': 2.6958}:   7%|▋         | 2/30 [00:05<01:00,  2.15s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8827, 'compress@10': 1.0, 'time@10': 2.6958}:  10%|█         | 3/30 [00:05<00:49,  1.82s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.9182, 'compress@10': 1.0, 'time@10': 2.7296}:  10%|█         | 3/30 [00:08<00:49,  1.82s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.9182, 'compress@10': 1.0, 'time@10': 2.7296}:  13%|█▎        | 4/30 [00:08<00:58,  2.23s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.068, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8497, 'compress@10': 1.0, 'time@10': 2.3249}:  13%|█▎        | 4/30 [00:08<00:58,  2.23s/it]  {'epoch': 17, 'num_users': 5.8, 'loss': 0.068, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8497, 'compress@10': 1.0, 'time@10': 2.3249}:  17%|█▋        | 5/30 [00:08<00:39,  1.57s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0646, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8496, 'compress@10': 1.0, 'time@10': 2.4215}:  17%|█▋        | 5/30 [00:11<00:39,  1.57s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0646, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8496, 'compress@10': 1.0, 'time@10': 2.4215}:  20%|██        | 6/30 [00:11<00:48,  2.03s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0623, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8445, 'compress@10': 1.0, 'time@10': 2.4777}:  20%|██        | 6/30 [00:13<00:48,  2.03s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0623, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8445, 'compress@10': 1.0, 'time@10': 2.4777}:  23%|██▎       | 7/30 [00:13<00:42,  1.84s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0593, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 2.4947}:  23%|██▎       | 7/30 [00:15<00:42,  1.84s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0593, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 2.4947}:  27%|██▋       | 8/30 [00:15<00:46,  2.10s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0567, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 2.5476}:  27%|██▋       | 8/30 [00:17<00:46,  2.10s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0567, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 2.5476}:  30%|███       | 9/30 [00:17<00:40,  1.92s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0542, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.5751}:  30%|███       | 9/30 [00:20<00:40,  1.92s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0542, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.5751}:  33%|███▎      | 10/30 [00:20<00:44,  2.21s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 0.0547, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8592, 'compress@10': 1.0, 'time@10': 2.5898}:  33%|███▎      | 10/30 [00:21<00:44,  2.21s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 0.0547, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8592, 'compress@10': 1.0, 'time@10': 2.5898}:  37%|███▋      | 11/30 [00:21<00:37,  1.96s/it]{'epoch': 17, 'num_users': 6.4167, 'loss': 0.0506, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 2.6009}:  37%|███▋      | 11/30 [00:24<00:37,  1.96s/it]{'epoch': 17, 'num_users': 6.4167, 'loss': 0.0506, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 2.6009}:  40%|████      | 12/30 [00:24<00:39,  2.21s/it]{'epoch': 17, 'num_users': 6.6154, 'loss': 0.0501, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8648, 'compress@10': 1.0, 'time@10': 2.6047}:  40%|████      | 12/30 [00:25<00:39,  2.21s/it]{'epoch': 17, 'num_users': 6.6154, 'loss': 0.0501, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8648, 'compress@10': 1.0, 'time@10': 2.6047}:  43%|████▎     | 13/30 [00:25<00:33,  1.96s/it]{'epoch': 17, 'num_users': 6.3571, 'loss': 0.0466, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.5924}:  43%|████▎     | 13/30 [00:28<00:33,  1.96s/it]{'epoch': 17, 'num_users': 6.3571, 'loss': 0.0466, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.5924}:  47%|████▋     | 14/30 [00:28<00:33,  2.11s/it]{'epoch': 17, 'num_users': 6.2667, 'loss': 0.0471, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8627, 'compress@10': 1.0, 'time@10': 2.6288}:  47%|████▋     | 14/30 [00:29<00:33,  2.11s/it]{'epoch': 17, 'num_users': 6.2667, 'loss': 0.0471, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.8627, 'compress@10': 1.0, 'time@10': 2.6288}:  50%|█████     | 15/30 [00:29<00:29,  1.96s/it]{'epoch': 17, 'num_users': 6.0625, 'loss': 0.0443, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8657, 'compress@10': 1.0, 'time@10': 2.6499}:  50%|█████     | 15/30 [00:32<00:29,  1.96s/it]{'epoch': 17, 'num_users': 6.0625, 'loss': 0.0443, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8657, 'compress@10': 1.0, 'time@10': 2.6499}:  53%|█████▎    | 16/30 [00:32<00:31,  2.28s/it]{'epoch': 17, 'num_users': 5.8235, 'loss': 0.0418, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8601, 'compress@10': 1.0, 'time@10': 2.6477}:  53%|█████▎    | 16/30 [00:34<00:31,  2.28s/it]{'epoch': 17, 'num_users': 5.8235, 'loss': 0.0418, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8601, 'compress@10': 1.0, 'time@10': 2.6477}:  57%|█████▋    | 17/30 [00:34<00:25,  2.00s/it]{'epoch': 17, 'num_users': 6.0556, 'loss': 0.0425, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8642, 'compress@10': 1.0, 'time@10': 2.6486}:  57%|█████▋    | 17/30 [00:36<00:25,  2.00s/it]{'epoch': 17, 'num_users': 6.0556, 'loss': 0.0425, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8642, 'compress@10': 1.0, 'time@10': 2.6486}:  60%|██████    | 18/30 [00:36<00:26,  2.21s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 0.0411, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 2.6699}:  60%|██████    | 18/30 [00:38<00:26,  2.21s/it]   {'epoch': 17, 'num_users': 6.0, 'loss': 0.0411, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 2.6699}:  63%|██████▎   | 19/30 [00:38<00:22,  2.02s/it]{'epoch': 17, 'num_users': 6.15, 'loss': 0.0417, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8646, 'compress@10': 1.0, 'time@10': 2.6649}:  63%|██████▎   | 19/30 [00:41<00:22,  2.02s/it]{'epoch': 17, 'num_users': 6.15, 'loss': 0.0417, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8646, 'compress@10': 1.0, 'time@10': 2.6649}:  67%|██████▋   | 20/30 [00:41<00:21,  2.20s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0431, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 2.7096}:  67%|██████▋   | 20/30 [00:43<00:21,  2.20s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0431, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 2.7096}:  70%|███████   | 21/30 [00:43<00:20,  2.24s/it]{'epoch': 17, 'num_users': 6.1818, 'loss': 0.0421, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 2.7155}:  70%|███████   | 21/30 [00:46<00:20,  2.24s/it] {'epoch': 17, 'num_users': 6.1818, 'loss': 0.0421, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 2.7155}:  73%|███████▎  | 22/30 [00:46<00:19,  2.43s/it]{'epoch': 17, 'num_users': 6.1304, 'loss': 0.0413, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 2.7185}:  73%|███████▎  | 22/30 [00:47<00:19,  2.43s/it]{'epoch': 17, 'num_users': 6.1304, 'loss': 0.0413, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 2.7185}:  77%|███████▋  | 23/30 [00:47<00:14,  2.13s/it]{'epoch': 17, 'num_users': 5.9583, 'loss': 0.0396, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 2.7015}:  77%|███████▋  | 23/30 [00:50<00:14,  2.13s/it]{'epoch': 17, 'num_users': 5.9583, 'loss': 0.0396, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 2.7015}:  80%|████████  | 24/30 [00:50<00:13,  2.19s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0381, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8556, 'compress@10': 1.0, 'time@10': 2.6859}:  80%|████████  | 24/30 [00:51<00:13,  2.19s/it]   {'epoch': 17, 'num_users': 5.8, 'loss': 0.0381, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8556, 'compress@10': 1.0, 'time@10': 2.6859}:  83%|████████▎ | 25/30 [00:51<00:09,  1.89s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 0.0394, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.853, 'compress@10': 1.0, 'time@10': 2.6722}:  83%|████████▎ | 25/30 [00:53<00:09,  1.89s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 0.0394, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.853, 'compress@10': 1.0, 'time@10': 2.6722}:  87%|████████▋ | 26/30 [00:53<00:08,  2.04s/it]{'epoch': 17, 'num_users': 5.8889, 'loss': 0.0389, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8542, 'compress@10': 1.0, 'time@10': 2.6777}:  87%|████████▋ | 26/30 [00:55<00:08,  2.04s/it]{'epoch': 17, 'num_users': 5.8889, 'loss': 0.0389, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8542, 'compress@10': 1.0, 'time@10': 2.6777}:  90%|█████████ | 27/30 [00:55<00:05,  1.86s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 0.0391, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.8555, 'compress@10': 1.0, 'time@10': 2.6893}:  90%|█████████ | 27/30 [00:58<00:05,  1.86s/it]   {'epoch': 17, 'num_users': 6.0, 'loss': 0.0391, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.8555, 'compress@10': 1.0, 'time@10': 2.6893}:  93%|█████████▎| 28/30 [00:58<00:04,  2.21s/it]{'epoch': 17, 'num_users': 5.8621, 'loss': 0.0385, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 2.6969}:  93%|█████████▎| 28/30 [00:59<00:04,  2.21s/it]{'epoch': 17, 'num_users': 5.8621, 'loss': 0.0385, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 2.6969}:  97%|█████████▋| 29/30 [00:59<00:01,  2.00s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.0381, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8595, 'compress@10': 1.0, 'time@10': 2.7022}:  97%|█████████▋| 29/30 [01:02<00:01,  2.00s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.0381, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8595, 'compress@10': 1.0, 'time@10': 2.7022}: 100%|██████████| 30/30 [01:02<00:00,  2.27s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 0.0381, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8595, 'compress@10': 1.0, 'time@10': 2.7022}: 100%|██████████| 30/30 [01:02<00:00,  2.08s/it]
Epoch: 17
Avg # of users: 5.866666666666666
Avg Loss: 0.03813086254126961
Avg hit ratio: 0.8415159867996914
Avg ndcg: 0.8595409972112859
Avg compression ratio: 0.9999999860153537
Avg train time: 2.702214256922404
Std train time: 0.4508298393755225
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 33, 14, 8, 9, 8, 12, 5, 9, 7, 34, 8, 70, 6, 34, 48, 13, 14, 7, 3, 19, 10, 83, 83, 5, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8732, 'compress@10': 1.0, 'time@10': 2.774}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8732, 'compress@10': 1.0, 'time@10': 2.774}:   3%|▎         | 1/30 [00:01<00:41,  1.43s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0392, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 2.6965}:   3%|▎         | 1/30 [00:04<00:41,  1.43s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0392, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 2.6965}:   7%|▋         | 2/30 [00:04<01:00,  2.15s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8824, 'compress@10': 1.0, 'time@10': 2.6783}:   7%|▋         | 2/30 [00:05<01:00,  2.15s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8824, 'compress@10': 1.0, 'time@10': 2.6783}:  10%|█         | 3/30 [00:05<00:48,  1.79s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 2.6806}:  10%|█         | 3/30 [00:08<00:48,  1.79s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 2.6806}:  13%|█▎        | 4/30 [00:08<00:56,  2.16s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0374, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 3.3221}:  13%|█▎        | 4/30 [00:11<00:56,  2.16s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0374, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 3.3221}:  17%|█▋        | 5/30 [00:11<01:01,  2.46s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0387, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 3.2612}:  17%|█▋        | 5/30 [00:14<01:01,  2.46s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0387, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 3.2612}:  20%|██        | 6/30 [00:14<01:03,  2.64s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0397, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 3.2036}:  20%|██        | 6/30 [00:15<01:03,  2.64s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0397, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 3.2036}:  23%|██▎       | 7/30 [00:15<00:52,  2.26s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0393, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 3.1644}:  23%|██▎       | 7/30 [00:18<00:52,  2.26s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0393, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 3.1644}:  27%|██▋       | 8/30 [00:18<00:54,  2.47s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0389, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8705, 'compress@10': 1.0, 'time@10': 3.0925}:  27%|██▋       | 8/30 [00:19<00:54,  2.47s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0389, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8705, 'compress@10': 1.0, 'time@10': 3.0925}:  30%|███       | 9/30 [00:19<00:44,  2.11s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0395, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8708, 'compress@10': 1.0, 'time@10': 3.0666}:  30%|███       | 9/30 [00:22<00:44,  2.11s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0395, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8708, 'compress@10': 1.0, 'time@10': 3.0666}:  33%|███▎      | 10/30 [00:22<00:46,  2.34s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 0.0409, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 3.0289}:  33%|███▎      | 10/30 [00:24<00:46,  2.34s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 0.0409, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 3.0289}:  37%|███▋      | 11/30 [00:24<00:38,  2.04s/it]{'epoch': 18, 'num_users': 6.4167, 'loss': 0.038, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 2.9931}:  37%|███▋      | 11/30 [00:26<00:38,  2.04s/it] {'epoch': 18, 'num_users': 6.4167, 'loss': 0.038, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 2.9931}:  40%|████      | 12/30 [00:26<00:40,  2.22s/it]{'epoch': 18, 'num_users': 6.6154, 'loss': 0.0385, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 2.9529}:  40%|████      | 12/30 [00:27<00:40,  2.22s/it]{'epoch': 18, 'num_users': 6.6154, 'loss': 0.0385, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 2.9529}:  43%|████▎     | 13/30 [00:27<00:32,  1.93s/it]{'epoch': 18, 'num_users': 6.3571, 'loss': 0.0358, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8714, 'compress@10': 1.0, 'time@10': 2.917}:  43%|████▎     | 13/30 [00:30<00:32,  1.93s/it] {'epoch': 18, 'num_users': 6.3571, 'loss': 0.0358, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8714, 'compress@10': 1.0, 'time@10': 2.917}:  47%|████▋     | 14/30 [00:30<00:33,  2.10s/it]{'epoch': 18, 'num_users': 6.2667, 'loss': 0.0368, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8714, 'compress@10': 1.0, 'time@10': 2.8899}:  47%|████▋     | 14/30 [00:31<00:33,  2.10s/it]{'epoch': 18, 'num_users': 6.2667, 'loss': 0.0368, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8714, 'compress@10': 1.0, 'time@10': 2.8899}:  50%|█████     | 15/30 [00:31<00:27,  1.86s/it]{'epoch': 18, 'num_users': 6.0625, 'loss': 0.0348, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 2.8842}:  50%|█████     | 15/30 [00:34<00:27,  1.86s/it]{'epoch': 18, 'num_users': 6.0625, 'loss': 0.0348, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 2.8842}:  53%|█████▎    | 16/30 [00:34<00:30,  2.15s/it]{'epoch': 18, 'num_users': 5.8235, 'loss': 0.0328, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8674, 'compress@10': 1.0, 'time@10': 2.8892}:  53%|█████▎    | 16/30 [00:36<00:30,  2.15s/it]{'epoch': 18, 'num_users': 5.8235, 'loss': 0.0328, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8674, 'compress@10': 1.0, 'time@10': 2.8892}:  57%|█████▋    | 17/30 [00:36<00:25,  1.96s/it]{'epoch': 18, 'num_users': 6.0556, 'loss': 0.0335, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 2.8755}:  57%|█████▋    | 17/30 [00:38<00:25,  1.96s/it]{'epoch': 18, 'num_users': 6.0556, 'loss': 0.0335, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 2.8755}:  60%|██████    | 18/30 [00:38<00:26,  2.18s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 0.0323, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 2.8622}:  60%|██████    | 18/30 [00:40<00:26,  2.18s/it]   {'epoch': 18, 'num_users': 6.0, 'loss': 0.0323, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 2.8622}:  63%|██████▎   | 19/30 [00:40<00:21,  1.93s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 0.0332, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8689, 'compress@10': 1.0, 'time@10': 2.8663}:  63%|██████▎   | 19/30 [00:43<00:21,  1.93s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 0.0332, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8689, 'compress@10': 1.0, 'time@10': 2.8663}:  67%|██████▋   | 20/30 [00:43<00:22,  2.25s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0354, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8648, 'compress@10': 1.0, 'time@10': 2.8188}:  67%|██████▋   | 20/30 [00:44<00:22,  2.25s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0354, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8648, 'compress@10': 1.0, 'time@10': 2.8188}:  70%|███████   | 21/30 [00:44<00:16,  1.87s/it]{'epoch': 18, 'num_users': 6.1818, 'loss': 0.0345, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 2.8192}:  70%|███████   | 21/30 [00:47<00:16,  1.87s/it]{'epoch': 18, 'num_users': 6.1818, 'loss': 0.0345, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 2.8192}:  73%|███████▎  | 22/30 [00:47<00:17,  2.17s/it]{'epoch': 18, 'num_users': 6.1304, 'loss': 0.0339, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8689, 'compress@10': 1.0, 'time@10': 2.8159}:  73%|███████▎  | 22/30 [00:48<00:17,  2.17s/it]{'epoch': 18, 'num_users': 6.1304, 'loss': 0.0339, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8689, 'compress@10': 1.0, 'time@10': 2.8159}:  77%|███████▋  | 23/30 [00:48<00:13,  1.94s/it]{'epoch': 18, 'num_users': 5.9583, 'loss': 0.0326, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 2.7926}:  77%|███████▋  | 23/30 [00:50<00:13,  1.94s/it] {'epoch': 18, 'num_users': 5.9583, 'loss': 0.0326, 'hit_ratio@10': 0.8406, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 2.7926}:  80%|████████  | 24/30 [00:50<00:12,  2.05s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0313, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 2.7736}:  80%|████████  | 24/30 [00:51<00:12,  2.05s/it]  {'epoch': 18, 'num_users': 5.8, 'loss': 0.0313, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 2.7736}:  83%|████████▎ | 25/30 [00:51<00:08,  1.80s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 0.0326, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 2.7782}:  83%|████████▎ | 25/30 [00:54<00:08,  1.80s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 0.0326, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 2.7782}:  87%|████████▋ | 26/30 [00:54<00:08,  2.14s/it]{'epoch': 18, 'num_users': 5.8889, 'loss': 0.0324, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8575, 'compress@10': 1.0, 'time@10': 2.7755}:  87%|████████▋ | 26/30 [00:56<00:08,  2.14s/it]{'epoch': 18, 'num_users': 5.8889, 'loss': 0.0324, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.8575, 'compress@10': 1.0, 'time@10': 2.7755}:  90%|█████████ | 27/30 [00:56<00:05,  1.91s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 0.0326, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.7695}:  90%|█████████ | 27/30 [00:58<00:05,  1.91s/it]   {'epoch': 18, 'num_users': 6.0, 'loss': 0.0326, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.7695}:  93%|█████████▎| 28/30 [00:58<00:04,  2.13s/it]{'epoch': 18, 'num_users': 5.8621, 'loss': 0.0322, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 2.781}:  93%|█████████▎| 28/30 [01:00<00:04,  2.13s/it]{'epoch': 18, 'num_users': 5.8621, 'loss': 0.0322, 'hit_ratio@10': 0.8476, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 2.781}:  97%|█████████▋| 29/30 [01:00<00:01,  1.97s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0321, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 2.7821}:  97%|█████████▋| 29/30 [01:03<00:01,  1.97s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0321, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 2.7821}: 100%|██████████| 30/30 [01:03<00:00,  2.24s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 0.0321, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 2.7821}: 100%|██████████| 30/30 [01:03<00:00,  2.11s/it]
Epoch: 18
Avg # of users: 5.866666666666666
Avg Loss: 0.0320898947164608
Avg hit ratio: 0.8463644887165044
Avg ndcg: 0.8621469705423034
Avg compression ratio: 0.9999999860153537
Avg train time: 2.7820985476175943
Std train time: 0.6256187622864248
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 33, 14, 1, 8, 8, 12, 6, 9, 7, 35, 9, 71, 7, 34, 47, 13, 14, 6, 6, 19, 10, 85, 84, 5, 7, 8, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8722, 'compress@10': 1.0, 'time@10': 2.6344}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8722, 'compress@10': 1.0, 'time@10': 2.6344}:   3%|▎         | 1/30 [00:01<00:39,  1.36s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9078, 'compress@10': 1.0, 'time@10': 2.635}:   3%|▎         | 1/30 [00:04<00:39,  1.36s/it] {'epoch': 19, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9078, 'compress@10': 1.0, 'time@10': 2.635}:   7%|▋         | 2/30 [00:04<00:59,  2.13s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.028, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 2.6835}:   7%|▋         | 2/30 [00:05<00:59,  2.13s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.028, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 2.6835}:  10%|█         | 3/30 [00:05<00:48,  1.81s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.9153, 'compress@10': 1.0, 'time@10': 2.6606}:  10%|█         | 3/30 [00:08<00:48,  1.81s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.9153, 'compress@10': 1.0, 'time@10': 2.6606}:  13%|█▎        | 4/30 [00:08<00:55,  2.13s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0661, 'hit_ratio@10': 0.7954, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 2.2799}:  13%|█▎        | 4/30 [00:08<00:55,  2.13s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0661, 'hit_ratio@10': 0.7954, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 2.2799}:  17%|█▋        | 5/30 [00:08<00:37,  1.51s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0626, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 2.3302}:  17%|█▋        | 5/30 [00:11<00:37,  1.51s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0626, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 2.3302}:  20%|██        | 6/30 [00:11<00:45,  1.89s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.06, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8454, 'compress@10': 1.0, 'time@10': 2.3932}:  20%|██        | 6/30 [00:12<00:45,  1.89s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.06, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8454, 'compress@10': 1.0, 'time@10': 2.3932}:  23%|██▎       | 7/30 [00:12<00:39,  1.74s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.058, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 2.4562}:  23%|██▎       | 7/30 [00:15<00:39,  1.74s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.058, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 2.4562}:  27%|██▋       | 8/30 [00:15<00:46,  2.12s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0556, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.5045}:  27%|██▋       | 8/30 [00:16<00:46,  2.12s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0556, 'hit_ratio@10': 0.8321, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.5045}:  30%|███       | 9/30 [00:16<00:40,  1.92s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0525, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 2.5343}:  30%|███       | 9/30 [00:19<00:40,  1.92s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 0.0525, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 2.5343}:  33%|███▎      | 10/30 [00:19<00:44,  2.20s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 0.0528, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.868, 'compress@10': 1.0, 'time@10': 2.5393}:  33%|███▎      | 10/30 [00:21<00:44,  2.20s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 0.0528, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.868, 'compress@10': 1.0, 'time@10': 2.5393}:  37%|███▋      | 11/30 [00:21<00:36,  1.94s/it]{'epoch': 19, 'num_users': 6.4167, 'loss': 0.0487, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8721, 'compress@10': 1.0, 'time@10': 2.5556}:  37%|███▋      | 11/30 [00:23<00:36,  1.94s/it]{'epoch': 19, 'num_users': 6.4167, 'loss': 0.0487, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8721, 'compress@10': 1.0, 'time@10': 2.5556}:  40%|████      | 12/30 [00:23<00:39,  2.19s/it]{'epoch': 19, 'num_users': 6.6154, 'loss': 0.0484, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.872, 'compress@10': 1.0, 'time@10': 2.5876}:  40%|████      | 12/30 [00:25<00:39,  2.19s/it] {'epoch': 19, 'num_users': 6.6154, 'loss': 0.0484, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.872, 'compress@10': 1.0, 'time@10': 2.5876}:  43%|████▎     | 13/30 [00:25<00:33,  1.99s/it]{'epoch': 19, 'num_users': 6.3571, 'loss': 0.045, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8692, 'compress@10': 1.0, 'time@10': 2.5785}:  43%|████▎     | 13/30 [00:27<00:33,  1.99s/it]{'epoch': 19, 'num_users': 6.3571, 'loss': 0.045, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8692, 'compress@10': 1.0, 'time@10': 2.5785}:  47%|████▋     | 14/30 [00:27<00:34,  2.14s/it]{'epoch': 19, 'num_users': 6.2667, 'loss': 0.0459, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 2.6112}:  47%|████▋     | 14/30 [00:29<00:34,  2.14s/it]{'epoch': 19, 'num_users': 6.2667, 'loss': 0.0459, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 2.6112}:  50%|█████     | 15/30 [00:29<00:29,  1.97s/it]{'epoch': 19, 'num_users': 6.0625, 'loss': 0.0432, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8715, 'compress@10': 1.0, 'time@10': 2.6123}:  50%|█████     | 15/30 [00:32<00:29,  1.97s/it]{'epoch': 19, 'num_users': 6.0625, 'loss': 0.0432, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8715, 'compress@10': 1.0, 'time@10': 2.6123}:  53%|█████▎    | 16/30 [00:32<00:30,  2.18s/it]{'epoch': 19, 'num_users': 5.8235, 'loss': 0.0407, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 2.6093}:  53%|█████▎    | 16/30 [00:33<00:30,  2.18s/it]{'epoch': 19, 'num_users': 5.8235, 'loss': 0.0407, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 2.6093}:  57%|█████▋    | 17/30 [00:33<00:24,  1.92s/it]{'epoch': 19, 'num_users': 6.0556, 'loss': 0.0409, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8644, 'compress@10': 1.0, 'time@10': 2.623}:  57%|█████▋    | 17/30 [00:36<00:24,  1.92s/it] {'epoch': 19, 'num_users': 6.0556, 'loss': 0.0409, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8644, 'compress@10': 1.0, 'time@10': 2.623}:  60%|██████    | 18/30 [00:36<00:26,  2.21s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 0.0396, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8667, 'compress@10': 1.0, 'time@10': 2.6314}:  60%|██████    | 18/30 [00:37<00:26,  2.21s/it]  {'epoch': 19, 'num_users': 6.0, 'loss': 0.0396, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8667, 'compress@10': 1.0, 'time@10': 2.6314}:  63%|██████▎   | 19/30 [00:37<00:21,  1.98s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 0.0401, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 2.6253}:  63%|██████▎   | 19/30 [00:40<00:21,  1.98s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 0.0401, 'hit_ratio@10': 0.8349, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 2.6253}:  67%|██████▋   | 20/30 [00:40<00:21,  2.15s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0415, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 2.6739}:  67%|██████▋   | 20/30 [00:42<00:21,  2.15s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0415, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 2.6739}:  70%|███████   | 21/30 [00:42<00:18,  2.06s/it]{'epoch': 19, 'num_users': 6.1818, 'loss': 0.0403, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 2.6896}:  70%|███████   | 21/30 [00:45<00:18,  2.06s/it]{'epoch': 19, 'num_users': 6.1818, 'loss': 0.0403, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 2.6896}:  73%|███████▎  | 22/30 [00:45<00:18,  2.36s/it]{'epoch': 19, 'num_users': 6.1304, 'loss': 0.0397, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8671, 'compress@10': 1.0, 'time@10': 2.7093}:  73%|███████▎  | 22/30 [00:46<00:18,  2.36s/it]{'epoch': 19, 'num_users': 6.1304, 'loss': 0.0397, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8671, 'compress@10': 1.0, 'time@10': 2.7093}:  77%|███████▋  | 23/30 [00:46<00:14,  2.14s/it]{'epoch': 19, 'num_users': 5.9583, 'loss': 0.038, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 2.6966}:  77%|███████▋  | 23/30 [00:49<00:14,  2.14s/it] {'epoch': 19, 'num_users': 5.9583, 'loss': 0.038, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 2.6966}:  80%|████████  | 24/30 [00:49<00:13,  2.23s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0365, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8564, 'compress@10': 1.0, 'time@10': 2.6913}:  80%|████████  | 24/30 [00:50<00:13,  2.23s/it]  {'epoch': 19, 'num_users': 5.8, 'loss': 0.0365, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8564, 'compress@10': 1.0, 'time@10': 2.6913}:  83%|████████▎ | 25/30 [00:50<00:09,  1.96s/it]{'epoch': 19, 'num_users': 5.8077, 'loss': 0.0376, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8546, 'compress@10': 1.0, 'time@10': 2.6993}:  83%|████████▎ | 25/30 [00:53<00:09,  1.96s/it]{'epoch': 19, 'num_users': 5.8077, 'loss': 0.0376, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8546, 'compress@10': 1.0, 'time@10': 2.6993}:  87%|████████▋ | 26/30 [00:53<00:09,  2.25s/it]{'epoch': 19, 'num_users': 5.8889, 'loss': 0.0372, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 2.7036}:  87%|████████▋ | 26/30 [00:55<00:09,  2.25s/it]{'epoch': 19, 'num_users': 5.8889, 'loss': 0.0372, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 2.7036}:  90%|█████████ | 27/30 [00:55<00:06,  2.01s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 0.0372, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 2.7138}:  90%|█████████ | 27/30 [00:58<00:06,  2.01s/it]   {'epoch': 19, 'num_users': 6.0, 'loss': 0.0372, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 2.7138}:  93%|█████████▎| 28/30 [00:58<00:04,  2.32s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 0.0367, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8589, 'compress@10': 1.0, 'time@10': 2.718}:  93%|█████████▎| 28/30 [00:59<00:04,  2.32s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 0.0367, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8589, 'compress@10': 1.0, 'time@10': 2.718}:  97%|█████████▋| 29/30 [00:59<00:02,  2.06s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0364, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8607, 'compress@10': 1.0, 'time@10': 2.7217}:  97%|█████████▋| 29/30 [01:02<00:02,  2.06s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0364, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8607, 'compress@10': 1.0, 'time@10': 2.7217}: 100%|██████████| 30/30 [01:02<00:00,  2.30s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 0.0364, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8607, 'compress@10': 1.0, 'time@10': 2.7217}: 100%|██████████| 30/30 [01:02<00:00,  2.08s/it]
Epoch: 19
Avg # of users: 5.866666666666666
Avg Loss: 0.03638946754523618
Avg hit ratio: 0.8425009223128683
Avg ndcg: 0.8607135532223603
Avg compression ratio: 0.9999999860153537
Avg train time: 2.72167653242747
Std train time: 0.4372461455175045
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 33, 15, 8, 9, 8, 12, 6, 9, 8, 35, 8, 72, 6, 34, 48, 13, 14, 7, 3, 18, 9, 86, 85, 5, 7, 7, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8754, 'compress@10': 1.0, 'time@10': 2.7549}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8754, 'compress@10': 1.0, 'time@10': 2.7549}:   3%|▎         | 1/30 [00:01<00:41,  1.42s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 2.6763}:   3%|▎         | 1/30 [00:04<00:41,  1.42s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 2.6763}:   7%|▋         | 2/30 [00:04<00:59,  2.13s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 2.6737}:   7%|▋         | 2/30 [00:05<00:59,  2.13s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 2.6737}:  10%|█         | 3/30 [00:05<00:48,  1.79s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.839, 'ndcg@10': 0.872, 'compress@10': 1.0, 'time@10': 2.7201}:  10%|█         | 3/30 [00:08<00:48,  1.79s/it]  {'epoch': 20, 'num_users': 5.0, 'loss': 0.0319, 'hit_ratio@10': 0.839, 'ndcg@10': 0.872, 'compress@10': 1.0, 'time@10': 2.7201}:  13%|█▎        | 4/30 [00:08<00:57,  2.22s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0397, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 3.3589}:  13%|█▎        | 4/30 [00:11<00:57,  2.22s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0397, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 3.3589}:  17%|█▋        | 5/30 [00:11<01:02,  2.50s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.04, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 3.2904}:  17%|█▋        | 5/30 [00:14<01:02,  2.50s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.04, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 3.2904}:  20%|██        | 6/30 [00:14<01:04,  2.67s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0404, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8537, 'compress@10': 1.0, 'time@10': 3.228}:  20%|██        | 6/30 [00:15<01:04,  2.67s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0404, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8537, 'compress@10': 1.0, 'time@10': 3.228}:  23%|██▎       | 7/30 [00:15<00:52,  2.28s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 3.1832}:  23%|██▎       | 7/30 [00:18<00:52,  2.28s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 3.1832}:  27%|██▋       | 8/30 [00:18<00:54,  2.48s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0404, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 3.1584}:  27%|██▋       | 8/30 [00:20<00:54,  2.48s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0404, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 3.1584}:  30%|███       | 9/30 [00:20<00:45,  2.18s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0383, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.8614, 'compress@10': 1.0, 'time@10': 3.117}:  30%|███       | 9/30 [00:22<00:45,  2.18s/it]    {'epoch': 20, 'num_users': 6.3, 'loss': 0.0383, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.8614, 'compress@10': 1.0, 'time@10': 3.117}:  33%|███▎      | 10/30 [00:22<00:47,  2.37s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 0.0394, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8622, 'compress@10': 1.0, 'time@10': 3.1156}:  33%|███▎      | 10/30 [00:24<00:47,  2.37s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 0.0394, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8622, 'compress@10': 1.0, 'time@10': 3.1156}:  37%|███▋      | 11/30 [00:24<00:40,  2.13s/it]{'epoch': 20, 'num_users': 6.4167, 'loss': 0.0365, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8667, 'compress@10': 1.0, 'time@10': 3.0792}:  37%|███▋      | 11/30 [00:27<00:40,  2.13s/it]{'epoch': 20, 'num_users': 6.4167, 'loss': 0.0365, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8667, 'compress@10': 1.0, 'time@10': 3.0792}:  40%|████      | 12/30 [00:27<00:41,  2.31s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 0.0368, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8686, 'compress@10': 1.0, 'time@10': 3.0359}:  40%|████      | 12/30 [00:28<00:41,  2.31s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 0.0368, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.8686, 'compress@10': 1.0, 'time@10': 3.0359}:  43%|████▎     | 13/30 [00:28<00:34,  2.00s/it]{'epoch': 20, 'num_users': 6.3571, 'loss': 0.0342, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 3.0032}:  43%|████▎     | 13/30 [00:31<00:34,  2.00s/it] {'epoch': 20, 'num_users': 6.3571, 'loss': 0.0342, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 3.0032}:  47%|████▋     | 14/30 [00:31<00:35,  2.20s/it]{'epoch': 20, 'num_users': 6.2667, 'loss': 0.0353, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 2.9732}:  47%|████▋     | 14/30 [00:32<00:35,  2.20s/it]{'epoch': 20, 'num_users': 6.2667, 'loss': 0.0353, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 2.9732}:  50%|█████     | 15/30 [00:32<00:29,  1.93s/it]{'epoch': 20, 'num_users': 6.0625, 'loss': 0.0332, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8691, 'compress@10': 1.0, 'time@10': 2.9525}:  50%|█████     | 15/30 [00:35<00:29,  1.93s/it]{'epoch': 20, 'num_users': 6.0625, 'loss': 0.0332, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8691, 'compress@10': 1.0, 'time@10': 2.9525}:  53%|█████▎    | 16/30 [00:35<00:30,  2.16s/it]{'epoch': 20, 'num_users': 5.8235, 'loss': 0.0313, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8633, 'compress@10': 1.0, 'time@10': 2.9369}:  53%|█████▎    | 16/30 [00:36<00:30,  2.16s/it]{'epoch': 20, 'num_users': 5.8235, 'loss': 0.0313, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.8633, 'compress@10': 1.0, 'time@10': 2.9369}:  57%|█████▋    | 17/30 [00:36<00:25,  1.92s/it]{'epoch': 20, 'num_users': 6.0556, 'loss': 0.031, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.865, 'compress@10': 1.0, 'time@10': 2.934}:  57%|█████▋    | 17/30 [00:39<00:25,  1.92s/it]   {'epoch': 20, 'num_users': 6.0556, 'loss': 0.031, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.865, 'compress@10': 1.0, 'time@10': 2.934}:  60%|██████    | 18/30 [00:39<00:26,  2.23s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 0.0299, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8671, 'compress@10': 1.0, 'time@10': 2.9232}:  60%|██████    | 18/30 [00:40<00:26,  2.23s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 0.0299, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8671, 'compress@10': 1.0, 'time@10': 2.9232}:  63%|██████▎   | 19/30 [00:40<00:21,  1.98s/it]{'epoch': 20, 'num_users': 6.15, 'loss': 0.0307, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 2.9242}:  63%|██████▎   | 19/30 [00:43<00:21,  1.98s/it]{'epoch': 20, 'num_users': 6.15, 'loss': 0.0307, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 2.9242}:  67%|██████▋   | 20/30 [00:43<00:22,  2.28s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.033, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.87}:  67%|██████▋   | 20/30 [00:44<00:22,  2.28s/it] {'epoch': 20, 'num_users': 6.3333, 'loss': 0.033, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.87}:  70%|███████   | 21/30 [00:44<00:16,  1.87s/it]{'epoch': 20, 'num_users': 6.1818, 'loss': 0.0324, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8644, 'compress@10': 1.0, 'time@10': 2.8633}:  70%|███████   | 21/30 [00:47<00:16,  1.87s/it]{'epoch': 20, 'num_users': 6.1818, 'loss': 0.0324, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8644, 'compress@10': 1.0, 'time@10': 2.8633}:  73%|███████▎  | 22/30 [00:47<00:17,  2.14s/it]{'epoch': 20, 'num_users': 6.1304, 'loss': 0.0319, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8665, 'compress@10': 1.0, 'time@10': 2.8469}:  73%|███████▎  | 22/30 [00:48<00:17,  2.14s/it]{'epoch': 20, 'num_users': 6.1304, 'loss': 0.0319, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.8665, 'compress@10': 1.0, 'time@10': 2.8469}:  77%|███████▋  | 23/30 [00:48<00:13,  1.88s/it]{'epoch': 20, 'num_users': 5.9583, 'loss': 0.0306, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 2.8373}:  77%|███████▋  | 23/30 [00:51<00:13,  1.88s/it]{'epoch': 20, 'num_users': 5.9583, 'loss': 0.0306, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 2.8373}:  80%|████████  | 24/30 [00:51<00:12,  2.11s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 2.8185}:  80%|████████  | 24/30 [00:52<00:12,  2.11s/it]   {'epoch': 20, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 2.8185}:  83%|████████▎ | 25/30 [00:52<00:09,  1.85s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 0.0307, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8545, 'compress@10': 1.0, 'time@10': 2.8243}:  83%|████████▎ | 25/30 [00:55<00:09,  1.85s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 0.0307, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8545, 'compress@10': 1.0, 'time@10': 2.8243}:  87%|████████▋ | 26/30 [00:55<00:08,  2.20s/it]{'epoch': 20, 'num_users': 5.8889, 'loss': 0.0305, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8557, 'compress@10': 1.0, 'time@10': 2.8257}:  87%|████████▋ | 26/30 [00:57<00:08,  2.20s/it]{'epoch': 20, 'num_users': 5.8889, 'loss': 0.0305, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8557, 'compress@10': 1.0, 'time@10': 2.8257}:  90%|█████████ | 27/30 [00:57<00:05,  1.98s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 0.0306, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 2.8186}:  90%|█████████ | 27/30 [00:59<00:05,  1.98s/it]   {'epoch': 20, 'num_users': 6.0, 'loss': 0.0306, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 2.8186}:  93%|█████████▎| 28/30 [00:59<00:04,  2.19s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 0.03, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8588, 'compress@10': 1.0, 'time@10': 2.813}:  93%|█████████▎| 28/30 [01:01<00:04,  2.19s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 0.03, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8588, 'compress@10': 1.0, 'time@10': 2.813}:  97%|█████████▋| 29/30 [01:01<00:01,  1.94s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0299, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 2.814}:  97%|█████████▋| 29/30 [01:04<00:01,  1.94s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0299, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 2.814}: 100%|██████████| 30/30 [01:04<00:00,  2.22s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 0.0299, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8606, 'compress@10': 1.0, 'time@10': 2.814}: 100%|██████████| 30/30 [01:04<00:00,  2.14s/it]
Epoch: 20
Avg # of users: 5.866666666666666
Avg Loss: 0.029903321156104976
Avg hit ratio: 0.842971311850927
Avg ndcg: 0.8605728985878508
Avg compression ratio: 0.9999999860153537
Avg train time: 2.8140252510706585
Std train time: 0.6223537538176679
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 33, 15, 1, 8, 8, 12, 5, 9, 7, 35, 9, 73, 7, 34, 48, 13, 14, 6, 6, 18, 10, 87, 86, 4, 7, 7, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.044, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 2.5997}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.044, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 2.5997}:   3%|▎         | 1/30 [00:01<00:38,  1.34s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 2.7356}:   3%|▎         | 1/30 [00:04<00:38,  1.34s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 2.7356}:   7%|▋         | 2/30 [00:04<01:03,  2.26s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8656, 'compress@10': 1.0, 'time@10': 2.7561}:   7%|▋         | 2/30 [00:05<01:03,  2.26s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8656, 'compress@10': 1.0, 'time@10': 2.7561}:  10%|█         | 3/30 [00:05<00:50,  1.88s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.847, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 2.8127}:  10%|█         | 3/30 [00:08<00:50,  1.88s/it]  {'epoch': 21, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.847, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 2.8127}:  13%|█▎        | 4/30 [00:08<01:00,  2.33s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0668, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8313, 'compress@10': 1.0, 'time@10': 2.4148}:  13%|█▎        | 4/30 [00:09<01:00,  2.33s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0668, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.8313, 'compress@10': 1.0, 'time@10': 2.4148}:  17%|█▋        | 5/30 [00:09<00:41,  1.65s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0626, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 2.4688}:  17%|█▋        | 5/30 [00:11<00:41,  1.65s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0626, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 2.4688}:  20%|██        | 6/30 [00:11<00:48,  2.04s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0597, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8348, 'compress@10': 1.0, 'time@10': 2.5283}:  20%|██        | 6/30 [00:13<00:48,  2.04s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0597, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8348, 'compress@10': 1.0, 'time@10': 2.5283}:  23%|██▎       | 7/30 [00:13<00:42,  1.86s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.056, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8473, 'compress@10': 1.0, 'time@10': 2.5741}:  23%|██▎       | 7/30 [00:16<00:42,  1.86s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.056, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8473, 'compress@10': 1.0, 'time@10': 2.5741}:  27%|██▋       | 8/30 [00:16<00:48,  2.20s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0537, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8552, 'compress@10': 1.0, 'time@10': 2.5634}:  27%|██▋       | 8/30 [00:17<00:48,  2.20s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0537, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8552, 'compress@10': 1.0, 'time@10': 2.5634}:  30%|███       | 9/30 [00:17<00:40,  1.91s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0526, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 2.5907}:  30%|███       | 9/30 [00:20<00:40,  1.91s/it]  {'epoch': 21, 'num_users': 6.3, 'loss': 0.0526, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 2.5907}:  33%|███▎      | 10/30 [00:20<00:44,  2.21s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 0.0525, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8646, 'compress@10': 1.0, 'time@10': 2.5964}:  33%|███▎      | 10/30 [00:21<00:44,  2.21s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 0.0525, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8646, 'compress@10': 1.0, 'time@10': 2.5964}:  37%|███▋      | 11/30 [00:21<00:37,  1.95s/it]{'epoch': 21, 'num_users': 6.4167, 'loss': 0.0487, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8689, 'compress@10': 1.0, 'time@10': 2.6094}:  37%|███▋      | 11/30 [00:24<00:37,  1.95s/it] {'epoch': 21, 'num_users': 6.4167, 'loss': 0.0487, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8689, 'compress@10': 1.0, 'time@10': 2.6094}:  40%|████      | 12/30 [00:24<00:40,  2.24s/it]{'epoch': 21, 'num_users': 6.6154, 'loss': 0.0483, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8686, 'compress@10': 1.0, 'time@10': 2.6347}:  40%|████      | 12/30 [00:26<00:40,  2.24s/it]{'epoch': 21, 'num_users': 6.6154, 'loss': 0.0483, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8686, 'compress@10': 1.0, 'time@10': 2.6347}:  43%|████▎     | 13/30 [00:26<00:34,  2.02s/it]{'epoch': 21, 'num_users': 6.3571, 'loss': 0.0449, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 2.6346}:  43%|████▎     | 13/30 [00:28<00:34,  2.02s/it]{'epoch': 21, 'num_users': 6.3571, 'loss': 0.0449, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 2.6346}:  47%|████▋     | 14/30 [00:28<00:35,  2.21s/it]{'epoch': 21, 'num_users': 6.2667, 'loss': 0.0452, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8656, 'compress@10': 1.0, 'time@10': 2.6625}:  47%|████▋     | 14/30 [00:30<00:35,  2.21s/it]{'epoch': 21, 'num_users': 6.2667, 'loss': 0.0452, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8656, 'compress@10': 1.0, 'time@10': 2.6625}:  50%|█████     | 15/30 [00:30<00:30,  2.02s/it]{'epoch': 21, 'num_users': 6.0625, 'loss': 0.0425, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 2.6559}:  50%|█████     | 15/30 [00:33<00:30,  2.02s/it]{'epoch': 21, 'num_users': 6.0625, 'loss': 0.0425, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 2.6559}:  53%|█████▎    | 16/30 [00:33<00:30,  2.19s/it]{'epoch': 21, 'num_users': 5.8235, 'loss': 0.04, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 2.6562}:  53%|█████▎    | 16/30 [00:34<00:30,  2.19s/it]   {'epoch': 21, 'num_users': 5.8235, 'loss': 0.04, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 2.6562}:  57%|█████▋    | 17/30 [00:34<00:25,  1.94s/it]{'epoch': 21, 'num_users': 6.0556, 'loss': 0.0394, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 2.6632}:  57%|█████▋    | 17/30 [00:37<00:25,  1.94s/it]{'epoch': 21, 'num_users': 6.0556, 'loss': 0.0394, 'hit_ratio@10': 0.8299, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 2.6632}:  60%|██████    | 18/30 [00:37<00:26,  2.21s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 0.0382, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 2.666}:  60%|██████    | 18/30 [00:38<00:26,  2.21s/it]     {'epoch': 21, 'num_users': 6.0, 'loss': 0.0382, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 2.666}:  63%|██████▎   | 19/30 [00:38<00:21,  1.96s/it]{'epoch': 21, 'num_users': 6.15, 'loss': 0.0386, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 2.6647}:  63%|██████▎   | 19/30 [00:41<00:21,  1.96s/it]{'epoch': 21, 'num_users': 6.15, 'loss': 0.0386, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 2.6647}:  67%|██████▋   | 20/30 [00:41<00:21,  2.18s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0399, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8631, 'compress@10': 1.0, 'time@10': 2.7086}:  67%|██████▋   | 20/30 [00:43<00:21,  2.18s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0399, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8631, 'compress@10': 1.0, 'time@10': 2.7086}:  70%|███████   | 21/30 [00:43<00:18,  2.07s/it]{'epoch': 21, 'num_users': 6.1818, 'loss': 0.0387, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 2.7052}:  70%|███████   | 21/30 [00:45<00:18,  2.07s/it] {'epoch': 21, 'num_users': 6.1818, 'loss': 0.0387, 'hit_ratio@10': 0.8386, 'ndcg@10': 0.866, 'compress@10': 1.0, 'time@10': 2.7052}:  73%|███████▎  | 22/30 [00:45<00:18,  2.26s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 0.0378, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 2.7048}:  73%|███████▎  | 22/30 [00:47<00:18,  2.26s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 0.0378, 'hit_ratio@10': 0.8391, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 2.7048}:  77%|███████▋  | 23/30 [00:47<00:13,  2.00s/it]{'epoch': 21, 'num_users': 5.9583, 'loss': 0.0363, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 2.6921}:  77%|███████▋  | 23/30 [00:49<00:13,  2.00s/it]{'epoch': 21, 'num_users': 5.9583, 'loss': 0.0363, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 2.6921}:  80%|████████  | 24/30 [00:49<00:12,  2.13s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0348, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.857, 'compress@10': 1.0, 'time@10': 2.6895}:  80%|████████  | 24/30 [00:51<00:12,  2.13s/it]    {'epoch': 21, 'num_users': 5.8, 'loss': 0.0348, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.857, 'compress@10': 1.0, 'time@10': 2.6895}:  83%|████████▎ | 25/30 [00:51<00:09,  1.90s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 0.036, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 2.6905}:  83%|████████▎ | 25/30 [00:53<00:09,  1.90s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 0.036, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 2.6905}:  87%|████████▋ | 26/30 [00:53<00:08,  2.15s/it]{'epoch': 21, 'num_users': 5.8889, 'loss': 0.0356, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8563, 'compress@10': 1.0, 'time@10': 2.6969}:  87%|████████▋ | 26/30 [00:55<00:08,  2.15s/it]{'epoch': 21, 'num_users': 5.8889, 'loss': 0.0356, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8563, 'compress@10': 1.0, 'time@10': 2.6969}:  90%|█████████ | 27/30 [00:55<00:05,  1.95s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 0.0357, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 2.692}:  90%|█████████ | 27/30 [00:57<00:05,  1.95s/it]    {'epoch': 21, 'num_users': 6.0, 'loss': 0.0357, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 2.692}:  93%|█████████▎| 28/30 [00:57<00:04,  2.15s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 0.0351, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8587, 'compress@10': 1.0, 'time@10': 2.6897}:  93%|█████████▎| 28/30 [00:59<00:04,  2.15s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 0.0351, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8587, 'compress@10': 1.0, 'time@10': 2.6897}:  97%|█████████▋| 29/30 [00:59<00:01,  1.91s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0348, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8605, 'compress@10': 1.0, 'time@10': 2.6918}:  97%|█████████▋| 29/30 [01:02<00:01,  1.91s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0348, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8605, 'compress@10': 1.0, 'time@10': 2.6918}: 100%|██████████| 30/30 [01:02<00:00,  2.17s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 0.0348, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8605, 'compress@10': 1.0, 'time@10': 2.6918}: 100%|██████████| 30/30 [01:02<00:00,  2.07s/it]
Epoch: 21
Avg # of users: 5.866666666666666
Avg Loss: 0.03479750729660337
Avg hit ratio: 0.8457796880032062
Avg ndcg: 0.8604622168570571
Avg compression ratio: 0.9999999860153537
Avg train time: 2.691832153002421
Std train time: 0.4063080134032342
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 13, 33, 14, 7, 8, 8, 12, 6, 9, 7, 35, 8, 73, 6, 35, 48, 13, 14, 6, 3, 18, 10, 88, 86, 4, 7, 8, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0423, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8519, 'compress@10': 1.0, 'time@10': 2.9467}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0423, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8519, 'compress@10': 1.0, 'time@10': 2.9467}:   3%|▎         | 1/30 [00:01<00:44,  1.53s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9234, 'compress@10': 1.0, 'time@10': 2.8727}:   3%|▎         | 1/30 [00:04<00:44,  1.53s/it] {'epoch': 22, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9234, 'compress@10': 1.0, 'time@10': 2.8727}:   7%|▋         | 2/30 [00:04<01:04,  2.30s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.9013, 'compress@10': 1.0, 'time@10': 2.8281}:   7%|▋         | 2/30 [00:05<01:04,  2.30s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.9013, 'compress@10': 1.0, 'time@10': 2.8281}:  10%|█         | 3/30 [00:05<00:51,  1.89s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.7799}:  10%|█         | 3/30 [00:08<00:51,  1.89s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.7799}:  13%|█▎        | 4/30 [00:08<00:57,  2.20s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0349, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 3.2132}:  13%|█▎        | 4/30 [00:10<00:57,  2.20s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0349, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 3.2132}:  17%|█▋        | 5/30 [00:10<00:58,  2.32s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0358, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8758, 'compress@10': 1.0, 'time@10': 3.1034}:  17%|█▋        | 5/30 [00:13<00:58,  2.32s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0358, 'hit_ratio@10': 0.8424, 'ndcg@10': 0.8758, 'compress@10': 1.0, 'time@10': 3.1034}:  20%|██        | 6/30 [00:13<00:57,  2.41s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0365, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 3.057}:  20%|██        | 6/30 [00:15<00:57,  2.41s/it] {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0365, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 3.057}:  23%|██▎       | 7/30 [00:15<00:48,  2.09s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0372, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.861, 'compress@10': 1.0, 'time@10': 3.0312}:  23%|██▎       | 7/30 [00:17<00:48,  2.09s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0372, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.861, 'compress@10': 1.0, 'time@10': 3.0312}:  27%|██▋       | 8/30 [00:17<00:51,  2.34s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0369, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8658, 'compress@10': 1.0, 'time@10': 3.0308}:  27%|██▋       | 8/30 [00:19<00:51,  2.34s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0369, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8658, 'compress@10': 1.0, 'time@10': 3.0308}:  30%|███       | 9/30 [00:19<00:44,  2.10s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0359, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 3.0038}:  30%|███       | 9/30 [00:22<00:44,  2.10s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0359, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 3.0038}:  33%|███▎      | 10/30 [00:22<00:46,  2.32s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 0.0371, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 2.9752}:  33%|███▎      | 10/30 [00:23<00:46,  2.32s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 0.0371, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 2.9752}:  37%|███▋      | 11/30 [00:23<00:38,  2.03s/it]{'epoch': 22, 'num_users': 6.4167, 'loss': 0.0345, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 2.9561}:  37%|███▋      | 11/30 [00:26<00:38,  2.03s/it]{'epoch': 22, 'num_users': 6.4167, 'loss': 0.0345, 'hit_ratio@10': 0.8316, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 2.9561}:  40%|████      | 12/30 [00:26<00:40,  2.27s/it]{'epoch': 22, 'num_users': 6.6154, 'loss': 0.0348, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 2.9239}:  40%|████      | 12/30 [00:27<00:40,  2.27s/it] {'epoch': 22, 'num_users': 6.6154, 'loss': 0.0348, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8764, 'compress@10': 1.0, 'time@10': 2.9239}:  43%|████▎     | 13/30 [00:27<00:33,  1.98s/it]{'epoch': 22, 'num_users': 6.3571, 'loss': 0.0323, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8734, 'compress@10': 1.0, 'time@10': 2.8998}:  43%|████▎     | 13/30 [00:30<00:33,  1.98s/it]{'epoch': 22, 'num_users': 6.3571, 'loss': 0.0323, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8734, 'compress@10': 1.0, 'time@10': 2.8998}:  47%|████▋     | 14/30 [00:30<00:34,  2.18s/it]{'epoch': 22, 'num_users': 6.2667, 'loss': 0.0332, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 2.871}:  47%|████▋     | 14/30 [00:31<00:34,  2.18s/it]{'epoch': 22, 'num_users': 6.2667, 'loss': 0.0332, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 2.871}:  50%|█████     | 15/30 [00:31<00:28,  1.90s/it]{'epoch': 22, 'num_users': 6.0625, 'loss': 0.0313, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8762, 'compress@10': 1.0, 'time@10': 2.8534}:  50%|█████     | 15/30 [00:34<00:28,  1.90s/it]{'epoch': 22, 'num_users': 6.0625, 'loss': 0.0313, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8762, 'compress@10': 1.0, 'time@10': 2.8534}:  53%|█████▎    | 16/30 [00:34<00:29,  2.12s/it]{'epoch': 22, 'num_users': 5.8235, 'loss': 0.0295, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8717, 'compress@10': 1.0, 'time@10': 2.8459}:  53%|█████▎    | 16/30 [00:35<00:29,  2.12s/it]{'epoch': 22, 'num_users': 5.8235, 'loss': 0.0295, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8717, 'compress@10': 1.0, 'time@10': 2.8459}:  57%|█████▋    | 17/30 [00:35<00:24,  1.91s/it]{'epoch': 22, 'num_users': 6.0556, 'loss': 0.0305, 'hit_ratio@10': 0.825, 'ndcg@10': 0.868, 'compress@10': 1.0, 'time@10': 2.8336}:  57%|█████▋    | 17/30 [00:38<00:24,  1.91s/it]  {'epoch': 22, 'num_users': 6.0556, 'loss': 0.0305, 'hit_ratio@10': 0.825, 'ndcg@10': 0.868, 'compress@10': 1.0, 'time@10': 2.8336}:  60%|██████    | 18/30 [00:38<00:25,  2.13s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 0.0294, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 2.8221}:  60%|██████    | 18/30 [00:39<00:25,  2.13s/it]   {'epoch': 22, 'num_users': 6.0, 'loss': 0.0294, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 2.8221}:  63%|██████▎   | 19/30 [00:39<00:20,  1.90s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 0.0301, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 2.8114}:  63%|██████▎   | 19/30 [00:42<00:20,  1.90s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 0.0301, 'hit_ratio@10': 0.8328, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 2.8114}:  67%|██████▋   | 20/30 [00:42<00:21,  2.12s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0324, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 2.771}:  67%|██████▋   | 20/30 [00:43<00:21,  2.12s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0324, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8639, 'compress@10': 1.0, 'time@10': 2.771}:  70%|███████   | 21/30 [00:43<00:16,  1.79s/it]{'epoch': 22, 'num_users': 6.1818, 'loss': 0.0315, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 2.7705}:  70%|███████   | 21/30 [00:46<00:16,  1.79s/it]{'epoch': 22, 'num_users': 6.1818, 'loss': 0.0315, 'hit_ratio@10': 0.8346, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 2.7705}:  73%|███████▎  | 22/30 [00:46<00:16,  2.09s/it]{'epoch': 22, 'num_users': 6.1304, 'loss': 0.0313, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8679, 'compress@10': 1.0, 'time@10': 2.7695}:  73%|███████▎  | 22/30 [00:47<00:16,  2.09s/it]{'epoch': 22, 'num_users': 6.1304, 'loss': 0.0313, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8679, 'compress@10': 1.0, 'time@10': 2.7695}:  77%|███████▋  | 23/30 [00:47<00:13,  1.89s/it]{'epoch': 22, 'num_users': 5.9583, 'loss': 0.03, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 2.7568}:  77%|███████▋  | 23/30 [00:50<00:13,  1.89s/it]  {'epoch': 22, 'num_users': 5.9583, 'loss': 0.03, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8651, 'compress@10': 1.0, 'time@10': 2.7568}:  80%|████████  | 24/30 [00:50<00:12,  2.07s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8572, 'compress@10': 1.0, 'time@10': 2.7421}:  80%|████████  | 24/30 [00:51<00:12,  2.07s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8572, 'compress@10': 1.0, 'time@10': 2.7421}:  83%|████████▎ | 25/30 [00:51<00:09,  1.82s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 0.0302, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 2.7278}:  83%|████████▎ | 25/30 [00:53<00:09,  1.82s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 0.0302, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 2.7278}:  87%|████████▋ | 26/30 [00:53<00:07,  2.00s/it]{'epoch': 22, 'num_users': 5.8889, 'loss': 0.03, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8565, 'compress@10': 1.0, 'time@10': 2.7393}:  87%|████████▋ | 26/30 [00:55<00:07,  2.00s/it]  {'epoch': 22, 'num_users': 5.8889, 'loss': 0.03, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8565, 'compress@10': 1.0, 'time@10': 2.7393}:  90%|█████████ | 27/30 [00:55<00:05,  1.86s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 0.0304, 'hit_ratio@10': 0.837, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 2.7544}:  90%|█████████ | 27/30 [00:58<00:05,  1.86s/it]   {'epoch': 22, 'num_users': 6.0, 'loss': 0.0304, 'hit_ratio@10': 0.837, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 2.7544}:  93%|█████████▎| 28/30 [00:58<00:04,  2.27s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 0.0298, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8601, 'compress@10': 1.0, 'time@10': 2.7504}:  93%|█████████▎| 28/30 [00:59<00:04,  2.27s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 0.0298, 'hit_ratio@10': 0.841, 'ndcg@10': 0.8601, 'compress@10': 1.0, 'time@10': 2.7504}:  97%|█████████▋| 29/30 [00:59<00:01,  1.99s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0296, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.761}:  97%|█████████▋| 29/30 [01:02<00:01,  1.99s/it] {'epoch': 22, 'num_users': 5.8667, 'loss': 0.0296, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.761}: 100%|██████████| 30/30 [01:02<00:00,  2.33s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 0.0296, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.761}: 100%|██████████| 30/30 [01:02<00:00,  2.10s/it]
Epoch: 22
Avg # of users: 5.866666666666666
Avg Loss: 0.029573281588669356
Avg hit ratio: 0.8418268214959104
Avg ndcg: 0.861997689578939
Avg compression ratio: 0.9999999860153537
Avg train time: 2.760993727048238
Std train time: 0.4683832742409147
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 33, 14, 1, 9, 8, 12, 5, 9, 7, 35, 9, 74, 7, 36, 48, 13, 15, 7, 6, 18, 10, 89, 87, 5, 6, 7, 9, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8708, 'compress@10': 1.0, 'time@10': 2.7423}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.037, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8708, 'compress@10': 1.0, 'time@10': 2.7423}:   3%|▎         | 1/30 [00:01<00:40,  1.41s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8898, 'compress@10': 1.0, 'time@10': 2.8804}:   3%|▎         | 1/30 [00:04<00:40,  1.41s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8898, 'compress@10': 1.0, 'time@10': 2.8804}:   7%|▋         | 2/30 [00:04<01:06,  2.38s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8789, 'compress@10': 1.0, 'time@10': 2.8443}:   7%|▋         | 2/30 [00:05<01:06,  2.38s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8789, 'compress@10': 1.0, 'time@10': 2.8443}:  10%|█         | 3/30 [00:05<00:52,  1.95s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8976, 'compress@10': 1.0, 'time@10': 2.8396}:  10%|█         | 3/30 [00:08<00:52,  1.95s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0234, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8976, 'compress@10': 1.0, 'time@10': 2.8396}:  13%|█▎        | 4/30 [00:08<01:00,  2.31s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.058, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8297, 'compress@10': 1.0, 'time@10': 2.4172}:  13%|█▎        | 4/30 [00:09<01:00,  2.31s/it] {'epoch': 23, 'num_users': 5.8, 'loss': 0.058, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8297, 'compress@10': 1.0, 'time@10': 2.4172}:  17%|█▋        | 5/30 [00:09<00:40,  1.62s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0543, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8366, 'compress@10': 1.0, 'time@10': 2.5011}:  17%|█▋        | 5/30 [00:12<00:40,  1.62s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0543, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8366, 'compress@10': 1.0, 'time@10': 2.5011}:  20%|██        | 6/30 [00:12<00:49,  2.08s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0522, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8358, 'compress@10': 1.0, 'time@10': 2.5502}:  20%|██        | 6/30 [00:13<00:49,  2.08s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0522, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8358, 'compress@10': 1.0, 'time@10': 2.5502}:  23%|██▎       | 7/30 [00:13<00:43,  1.88s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0493, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 2.6126}:  23%|██▎       | 7/30 [00:16<00:43,  1.88s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0493, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 2.6126}:  27%|██▋       | 8/30 [00:16<00:49,  2.26s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0475, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8557, 'compress@10': 1.0, 'time@10': 2.6109}:  27%|██▋       | 8/30 [00:18<00:49,  2.26s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0475, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.8557, 'compress@10': 1.0, 'time@10': 2.6109}:  30%|███       | 9/30 [00:18<00:41,  1.97s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0448, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.6351}:  30%|███       | 9/30 [00:20<00:41,  1.97s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0448, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.6351}:  33%|███▎      | 10/30 [00:20<00:45,  2.26s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 0.0453, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8636, 'compress@10': 1.0, 'time@10': 2.6388}:  33%|███▎      | 10/30 [00:22<00:45,  2.26s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 0.0453, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8636, 'compress@10': 1.0, 'time@10': 2.6388}:  37%|███▋      | 11/30 [00:22<00:37,  1.99s/it]{'epoch': 23, 'num_users': 6.4167, 'loss': 0.0419, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.868, 'compress@10': 1.0, 'time@10': 2.6479}:  37%|███▋      | 11/30 [00:25<00:37,  1.99s/it] {'epoch': 23, 'num_users': 6.4167, 'loss': 0.0419, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.868, 'compress@10': 1.0, 'time@10': 2.6479}:  40%|████      | 12/30 [00:25<00:40,  2.23s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 0.042, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8679, 'compress@10': 1.0, 'time@10': 2.6533}:  40%|████      | 12/30 [00:26<00:40,  2.23s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 0.042, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8679, 'compress@10': 1.0, 'time@10': 2.6533}:  43%|████▎     | 13/30 [00:26<00:33,  1.98s/it]{'epoch': 23, 'num_users': 6.3571, 'loss': 0.039, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 2.6452}:  43%|████▎     | 13/30 [00:29<00:33,  1.98s/it]{'epoch': 23, 'num_users': 6.3571, 'loss': 0.039, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 2.6452}:  47%|████▋     | 14/30 [00:29<00:34,  2.16s/it]{'epoch': 23, 'num_users': 6.2667, 'loss': 0.04, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8656, 'compress@10': 1.0, 'time@10': 2.6671}:  47%|████▋     | 14/30 [00:30<00:34,  2.16s/it] {'epoch': 23, 'num_users': 6.2667, 'loss': 0.04, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8656, 'compress@10': 1.0, 'time@10': 2.6671}:  50%|█████     | 15/30 [00:30<00:29,  1.97s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 0.0376, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 2.6705}:  50%|█████     | 15/30 [00:33<00:29,  1.97s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 0.0376, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 2.6705}:  53%|█████▎    | 16/30 [00:33<00:30,  2.21s/it]{'epoch': 23, 'num_users': 5.8235, 'loss': 0.0354, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8648, 'compress@10': 1.0, 'time@10': 2.6684}:  53%|█████▎    | 16/30 [00:34<00:30,  2.21s/it]{'epoch': 23, 'num_users': 5.8235, 'loss': 0.0354, 'hit_ratio@10': 0.8201, 'ndcg@10': 0.8648, 'compress@10': 1.0, 'time@10': 2.6684}:  57%|█████▋    | 17/30 [00:34<00:25,  1.97s/it]{'epoch': 23, 'num_users': 6.0556, 'loss': 0.0352, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8674, 'compress@10': 1.0, 'time@10': 2.6673}:  57%|█████▋    | 17/30 [00:37<00:25,  1.97s/it]{'epoch': 23, 'num_users': 6.0556, 'loss': 0.0352, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8674, 'compress@10': 1.0, 'time@10': 2.6673}:  60%|██████    | 18/30 [00:37<00:26,  2.19s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 0.034, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8694, 'compress@10': 1.0, 'time@10': 2.6708}:  60%|██████    | 18/30 [00:38<00:26,  2.19s/it]    {'epoch': 23, 'num_users': 6.0, 'loss': 0.034, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8694, 'compress@10': 1.0, 'time@10': 2.6708}:  63%|██████▎   | 19/30 [00:38<00:21,  1.96s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 0.0344, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 2.6784}:  63%|██████▎   | 19/30 [00:41<00:21,  1.96s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 0.0344, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 2.6784}:  67%|██████▋   | 20/30 [00:41<00:22,  2.23s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0358, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8665, 'compress@10': 1.0, 'time@10': 2.7132}:  67%|██████▋   | 20/30 [00:43<00:22,  2.23s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0358, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8665, 'compress@10': 1.0, 'time@10': 2.7132}:  70%|███████   | 21/30 [00:43<00:18,  2.08s/it]{'epoch': 23, 'num_users': 6.1818, 'loss': 0.0348, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.869, 'compress@10': 1.0, 'time@10': 2.717}:  70%|███████   | 21/30 [00:46<00:18,  2.08s/it]  {'epoch': 23, 'num_users': 6.1818, 'loss': 0.0348, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.869, 'compress@10': 1.0, 'time@10': 2.717}:  73%|███████▎  | 22/30 [00:46<00:18,  2.31s/it]{'epoch': 23, 'num_users': 6.1304, 'loss': 0.0345, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8708, 'compress@10': 1.0, 'time@10': 2.7197}:  73%|███████▎  | 22/30 [00:47<00:18,  2.31s/it]{'epoch': 23, 'num_users': 6.1304, 'loss': 0.0345, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8708, 'compress@10': 1.0, 'time@10': 2.7197}:  77%|███████▋  | 23/30 [00:47<00:14,  2.04s/it]{'epoch': 23, 'num_users': 5.9583, 'loss': 0.033, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 2.711}:  77%|███████▋  | 23/30 [00:50<00:14,  2.04s/it]  {'epoch': 23, 'num_users': 5.9583, 'loss': 0.033, 'hit_ratio@10': 0.8327, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 2.711}:  80%|████████  | 24/30 [00:50<00:13,  2.19s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0317, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8598, 'compress@10': 1.0, 'time@10': 2.6979}:  80%|████████  | 24/30 [00:51<00:13,  2.19s/it] {'epoch': 23, 'num_users': 5.8, 'loss': 0.0317, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8598, 'compress@10': 1.0, 'time@10': 2.6979}:  83%|████████▎ | 25/30 [00:51<00:09,  1.91s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 0.0327, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8586, 'compress@10': 1.0, 'time@10': 2.7029}:  83%|████████▎ | 25/30 [00:54<00:09,  1.91s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 0.0327, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8586, 'compress@10': 1.0, 'time@10': 2.7029}:  87%|████████▋ | 26/30 [00:54<00:08,  2.19s/it]{'epoch': 23, 'num_users': 5.8889, 'loss': 0.0324, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8597, 'compress@10': 1.0, 'time@10': 2.6929}:  87%|████████▋ | 26/30 [00:55<00:08,  2.19s/it]{'epoch': 23, 'num_users': 5.8889, 'loss': 0.0324, 'hit_ratio@10': 0.834, 'ndcg@10': 0.8597, 'compress@10': 1.0, 'time@10': 2.6929}:  90%|█████████ | 27/30 [00:55<00:05,  1.91s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 0.0323, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 2.696}:  90%|█████████ | 27/30 [00:58<00:05,  1.91s/it]   {'epoch': 23, 'num_users': 6.0, 'loss': 0.0323, 'hit_ratio@10': 0.8378, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 2.696}:  93%|█████████▎| 28/30 [00:58<00:04,  2.18s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 0.0323, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 2.7022}:  93%|█████████▎| 28/30 [00:59<00:04,  2.18s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 0.0323, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 2.7022}:  97%|█████████▋| 29/30 [00:59<00:01,  1.97s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0321, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 2.7022}:  97%|█████████▋| 29/30 [01:02<00:01,  1.97s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0321, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 2.7022}: 100%|██████████| 30/30 [01:02<00:00,  2.20s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 0.0321, 'hit_ratio@10': 0.8408, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 2.7022}: 100%|██████████| 30/30 [01:02<00:00,  2.09s/it]
Epoch: 23
Avg # of users: 5.866666666666666
Avg Loss: 0.03210081140457128
Avg hit ratio: 0.8408270458809273
Avg ndcg: 0.8635398350517041
Avg compression ratio: 0.9999999860153537
Avg train time: 2.7022331317265826
Std train time: 0.41428405343201863
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 33, 14, 8, 9, 8, 11, 6, 9, 7, 35, 9, 75, 6, 36, 48, 13, 15, 7, 4, 18, 10, 90, 88, 5, 7, 7, 9, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8708, 'compress@10': 1.0, 'time@10': 2.632}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0376, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8708, 'compress@10': 1.0, 'time@10': 2.632}:   3%|▎         | 1/30 [00:01<00:39,  1.35s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 2.617}:   3%|▎         | 1/30 [00:03<00:39,  1.35s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 2.617}:   7%|▋         | 2/30 [00:03<00:59,  2.11s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8835, 'compress@10': 1.0, 'time@10': 2.6475}:   7%|▋         | 2/30 [00:05<00:59,  2.11s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8835, 'compress@10': 1.0, 'time@10': 2.6475}:  10%|█         | 3/30 [00:05<00:48,  1.78s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 2.6941}:  10%|█         | 3/30 [00:08<00:48,  1.78s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 2.6941}:  13%|█▎        | 4/30 [00:08<00:57,  2.21s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 3.3396}:  13%|█▎        | 4/30 [00:11<00:57,  2.21s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0306, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 3.3396}:  17%|█▋        | 5/30 [00:11<01:02,  2.50s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0315, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8807, 'compress@10': 1.0, 'time@10': 3.2664}:  17%|█▋        | 5/30 [00:14<01:02,  2.50s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0315, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.8807, 'compress@10': 1.0, 'time@10': 3.2664}:  20%|██        | 6/30 [00:14<01:03,  2.65s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0325, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 3.2038}:  20%|██        | 6/30 [00:15<01:03,  2.65s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0325, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 3.2038}:  23%|██▎       | 7/30 [00:15<00:51,  2.26s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0346, 'hit_ratio@10': 0.883, 'ndcg@10': 0.8829, 'compress@10': 1.0, 'time@10': 3.1367}:  23%|██▎       | 7/30 [00:18<00:51,  2.26s/it]  {'epoch': 24, 'num_users': 6.125, 'loss': 0.0346, 'hit_ratio@10': 0.883, 'ndcg@10': 0.8829, 'compress@10': 1.0, 'time@10': 3.1367}:  27%|██▋       | 8/30 [00:18<00:52,  2.40s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0347, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 3.1311}:  27%|██▋       | 8/30 [00:19<00:52,  2.40s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0347, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 3.1311}:  30%|███       | 9/30 [00:19<00:45,  2.14s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0348, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 3.0941}:  30%|███       | 9/30 [00:22<00:45,  2.14s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0348, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 3.0941}:  33%|███▎      | 10/30 [00:22<00:46,  2.35s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 0.036, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8888, 'compress@10': 1.0, 'time@10': 3.0568}:  33%|███▎      | 10/30 [00:24<00:46,  2.35s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 0.036, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.8888, 'compress@10': 1.0, 'time@10': 3.0568}:  37%|███▋      | 11/30 [00:24<00:38,  2.05s/it]{'epoch': 24, 'num_users': 6.4167, 'loss': 0.0334, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 3.027}:  37%|███▋      | 11/30 [00:26<00:38,  2.05s/it]{'epoch': 24, 'num_users': 6.4167, 'loss': 0.0334, 'hit_ratio@10': 0.8303, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 3.027}:  40%|████      | 12/30 [00:26<00:40,  2.26s/it]{'epoch': 24, 'num_users': 6.6154, 'loss': 0.0335, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 3.0059}:  40%|████      | 12/30 [00:28<00:40,  2.26s/it]{'epoch': 24, 'num_users': 6.6154, 'loss': 0.0335, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 3.0059}:  43%|████▎     | 13/30 [00:28<00:34,  2.00s/it]{'epoch': 24, 'num_users': 6.3571, 'loss': 0.0311, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8863, 'compress@10': 1.0, 'time@10': 2.9777}:  43%|████▎     | 13/30 [00:30<00:34,  2.00s/it]{'epoch': 24, 'num_users': 6.3571, 'loss': 0.0311, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8863, 'compress@10': 1.0, 'time@10': 2.9777}:  47%|████▋     | 14/30 [00:30<00:35,  2.20s/it]{'epoch': 24, 'num_users': 6.2667, 'loss': 0.0322, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8855, 'compress@10': 1.0, 'time@10': 2.9576}:  47%|████▋     | 14/30 [00:32<00:35,  2.20s/it]{'epoch': 24, 'num_users': 6.2667, 'loss': 0.0322, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8855, 'compress@10': 1.0, 'time@10': 2.9576}:  50%|█████     | 15/30 [00:32<00:29,  1.96s/it]{'epoch': 24, 'num_users': 6.0625, 'loss': 0.0303, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8875, 'compress@10': 1.0, 'time@10': 2.9447}:  50%|█████     | 15/30 [00:35<00:29,  1.96s/it]{'epoch': 24, 'num_users': 6.0625, 'loss': 0.0303, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8875, 'compress@10': 1.0, 'time@10': 2.9447}:  53%|█████▎    | 16/30 [00:35<00:30,  2.21s/it]{'epoch': 24, 'num_users': 5.8235, 'loss': 0.0286, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 2.9269}:  53%|█████▎    | 16/30 [00:36<00:30,  2.21s/it]{'epoch': 24, 'num_users': 5.8235, 'loss': 0.0286, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 2.9269}:  57%|█████▋    | 17/30 [00:36<00:25,  1.95s/it]{'epoch': 24, 'num_users': 6.0556, 'loss': 0.0298, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 2.9075}:  57%|█████▋    | 17/30 [00:39<00:25,  1.95s/it]{'epoch': 24, 'num_users': 6.0556, 'loss': 0.0298, 'hit_ratio@10': 0.8333, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 2.9075}:  60%|██████    | 18/30 [00:39<00:26,  2.21s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 0.0286, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 2.8993}:  60%|██████    | 18/30 [00:40<00:26,  2.21s/it]   {'epoch': 24, 'num_users': 6.0, 'loss': 0.0286, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 2.8993}:  63%|██████▎   | 19/30 [00:40<00:21,  1.97s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 0.0293, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8806, 'compress@10': 1.0, 'time@10': 2.8995}:  63%|██████▎   | 19/30 [00:43<00:21,  1.97s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 0.0293, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8806, 'compress@10': 1.0, 'time@10': 2.8995}:  67%|██████▋   | 20/30 [00:43<00:22,  2.26s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.8701}:  67%|██████▋   | 20/30 [00:44<00:22,  2.26s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0312, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.8701}:  70%|███████   | 21/30 [00:44<00:17,  1.94s/it]{'epoch': 24, 'num_users': 6.1818, 'loss': 0.0305, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8787, 'compress@10': 1.0, 'time@10': 2.8614}:  70%|███████   | 21/30 [00:47<00:17,  1.94s/it]{'epoch': 24, 'num_users': 6.1818, 'loss': 0.0305, 'hit_ratio@10': 0.8436, 'ndcg@10': 0.8787, 'compress@10': 1.0, 'time@10': 2.8614}:  73%|███████▎  | 22/30 [00:47<00:17,  2.17s/it]{'epoch': 24, 'num_users': 6.1304, 'loss': 0.03, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 2.8666}:  73%|███████▎  | 22/30 [00:49<00:17,  2.17s/it]    {'epoch': 24, 'num_users': 6.1304, 'loss': 0.03, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 2.8666}:  77%|███████▋  | 23/30 [00:49<00:13,  1.98s/it]{'epoch': 24, 'num_users': 5.9583, 'loss': 0.0287, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8767, 'compress@10': 1.0, 'time@10': 2.8562}:  77%|███████▋  | 23/30 [00:51<00:13,  1.98s/it]{'epoch': 24, 'num_users': 5.9583, 'loss': 0.0287, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8767, 'compress@10': 1.0, 'time@10': 2.8562}:  80%|████████  | 24/30 [00:51<00:13,  2.18s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0276, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 2.842}:  80%|████████  | 24/30 [00:52<00:13,  2.18s/it]    {'epoch': 24, 'num_users': 5.8, 'loss': 0.0276, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 2.842}:  83%|████████▎ | 25/30 [00:52<00:09,  1.91s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 0.0286, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8669, 'compress@10': 1.0, 'time@10': 2.8428}:  83%|████████▎ | 25/30 [00:55<00:09,  1.91s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 0.0286, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8669, 'compress@10': 1.0, 'time@10': 2.8428}:  87%|████████▋ | 26/30 [00:55<00:08,  2.21s/it]{'epoch': 24, 'num_users': 5.8889, 'loss': 0.0284, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 2.8394}:  87%|████████▋ | 26/30 [00:57<00:08,  2.21s/it]{'epoch': 24, 'num_users': 5.8889, 'loss': 0.0284, 'hit_ratio@10': 0.8423, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 2.8394}:  90%|█████████ | 27/30 [00:57<00:05,  1.97s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 0.0286, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 2.8316}:  90%|█████████ | 27/30 [00:59<00:05,  1.97s/it]   {'epoch': 24, 'num_users': 6.0, 'loss': 0.0286, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 2.8316}:  93%|█████████▎| 28/30 [00:59<00:04,  2.18s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 0.0283, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 2.8294}:  93%|█████████▎| 28/30 [01:01<00:04,  2.18s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 0.0283, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8711, 'compress@10': 1.0, 'time@10': 2.8294}:  97%|█████████▋| 29/30 [01:01<00:01,  1.95s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0285, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 2.8283}:  97%|█████████▋| 29/30 [01:04<00:01,  1.95s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0285, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 2.8283}: 100%|██████████| 30/30 [01:04<00:00,  2.21s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 0.0285, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 2.8283}: 100%|██████████| 30/30 [01:04<00:00,  2.14s/it]
Epoch: 24
Avg # of users: 5.866666666666666
Avg Loss: 0.028522000132020553
Avg hit ratio: 0.8507875905743264
Avg ndcg: 0.8713422605251271
Avg compression ratio: 0.9999999860153537
Avg train time: 2.828257401784261
Std train time: 0.5931232164544944
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 33, 14, 1, 9, 8, 11, 5, 9, 7, 35, 9, 76, 6, 36, 48, 14, 15, 7, 6, 18, 9, 90, 89, 5, 7, 7, 9, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 2.5402}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 2.5402}:   3%|▎         | 1/30 [00:01<00:37,  1.31s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0499, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 2.7408}:   3%|▎         | 1/30 [00:04<00:37,  1.31s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0499, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 2.7408}:   7%|▋         | 2/30 [00:04<01:04,  2.29s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8829, 'compress@10': 1.0, 'time@10': 2.711}:   7%|▋         | 2/30 [00:05<01:04,  2.29s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0332, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8829, 'compress@10': 1.0, 'time@10': 2.711}:  10%|█         | 3/30 [00:05<00:50,  1.87s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0346, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8743, 'compress@10': 1.0, 'time@10': 2.6902}:  10%|█         | 3/30 [00:08<00:50,  1.87s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0346, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8743, 'compress@10': 1.0, 'time@10': 2.6902}:  13%|█▎        | 4/30 [00:08<00:56,  2.18s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0664, 'hit_ratio@10': 0.7889, 'ndcg@10': 0.8165, 'compress@10': 1.0, 'time@10': 2.2974}:  13%|█▎        | 4/30 [00:08<00:56,  2.18s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0664, 'hit_ratio@10': 0.7889, 'ndcg@10': 0.8165, 'compress@10': 1.0, 'time@10': 2.2974}:  17%|█▋        | 5/30 [00:08<00:38,  1.54s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0611, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8283, 'compress@10': 1.0, 'time@10': 2.3881}:  17%|█▋        | 5/30 [00:11<00:38,  1.54s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0611, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8283, 'compress@10': 1.0, 'time@10': 2.3881}:  20%|██        | 6/30 [00:11<00:47,  1.99s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0574, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.83, 'compress@10': 1.0, 'time@10': 2.4334}:  20%|██        | 6/30 [00:12<00:47,  1.99s/it]  {'epoch': 25, 'num_users': 6.2857, 'loss': 0.0574, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.83, 'compress@10': 1.0, 'time@10': 2.4334}:  23%|██▎       | 7/30 [00:12<00:41,  1.80s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0537, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8367, 'compress@10': 1.0, 'time@10': 2.4635}:  23%|██▎       | 7/30 [00:15<00:41,  1.80s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0537, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8367, 'compress@10': 1.0, 'time@10': 2.4635}:  27%|██▋       | 8/30 [00:15<00:45,  2.09s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0514, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8473, 'compress@10': 1.0, 'time@10': 2.4606}:  27%|██▋       | 8/30 [00:16<00:45,  2.09s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0514, 'hit_ratio@10': 0.8352, 'ndcg@10': 0.8473, 'compress@10': 1.0, 'time@10': 2.4606}:  30%|███       | 9/30 [00:16<00:38,  1.83s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8552, 'compress@10': 1.0, 'time@10': 2.4856}:  30%|███       | 9/30 [00:19<00:38,  1.83s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8472, 'ndcg@10': 0.8552, 'compress@10': 1.0, 'time@10': 2.4856}:  33%|███▎      | 10/30 [00:19<00:42,  2.11s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 0.0485, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 2.5065}:  33%|███▎      | 10/30 [00:21<00:42,  2.11s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 0.0485, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 2.5065}:  37%|███▋      | 11/30 [00:21<00:35,  1.89s/it]{'epoch': 25, 'num_users': 6.4167, 'loss': 0.0449, 'hit_ratio@10': 0.8085, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 2.5287}:  37%|███▋      | 11/30 [00:23<00:35,  1.89s/it]{'epoch': 25, 'num_users': 6.4167, 'loss': 0.0449, 'hit_ratio@10': 0.8085, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 2.5287}:  40%|████      | 12/30 [00:23<00:39,  2.17s/it]{'epoch': 25, 'num_users': 6.6154, 'loss': 0.0445, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.5502}:  40%|████      | 12/30 [00:25<00:39,  2.17s/it]{'epoch': 25, 'num_users': 6.6154, 'loss': 0.0445, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.5502}:  43%|████▎     | 13/30 [00:25<00:33,  1.95s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 0.0413, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8605, 'compress@10': 1.0, 'time@10': 2.5712}:  43%|████▎     | 13/30 [00:28<00:33,  1.95s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 0.0413, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.8605, 'compress@10': 1.0, 'time@10': 2.5712}:  47%|████▋     | 14/30 [00:28<00:35,  2.23s/it]{'epoch': 25, 'num_users': 6.2667, 'loss': 0.0415, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 2.5692}:  47%|████▋     | 14/30 [00:29<00:35,  2.23s/it]{'epoch': 25, 'num_users': 6.2667, 'loss': 0.0415, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 2.5692}:  50%|█████     | 15/30 [00:29<00:29,  1.95s/it]{'epoch': 25, 'num_users': 6.0625, 'loss': 0.0391, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 2.5777}:  50%|█████     | 15/30 [00:32<00:29,  1.95s/it]{'epoch': 25, 'num_users': 6.0625, 'loss': 0.0391, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 2.5777}:  53%|█████▎    | 16/30 [00:32<00:30,  2.19s/it]{'epoch': 25, 'num_users': 5.8235, 'loss': 0.0369, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8615, 'compress@10': 1.0, 'time@10': 2.5778}:  53%|█████▎    | 16/30 [00:33<00:30,  2.19s/it]{'epoch': 25, 'num_users': 5.8235, 'loss': 0.0369, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8615, 'compress@10': 1.0, 'time@10': 2.5778}:  57%|█████▋    | 17/30 [00:33<00:25,  1.93s/it]{'epoch': 25, 'num_users': 6.0556, 'loss': 0.0371, 'hit_ratio@10': 0.8188, 'ndcg@10': 0.8618, 'compress@10': 1.0, 'time@10': 2.5916}:  57%|█████▋    | 17/30 [00:36<00:25,  1.93s/it]{'epoch': 25, 'num_users': 6.0556, 'loss': 0.0371, 'hit_ratio@10': 0.8188, 'ndcg@10': 0.8618, 'compress@10': 1.0, 'time@10': 2.5916}:  60%|██████    | 18/30 [00:36<00:26,  2.21s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 0.0358, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 2.601}:  60%|██████    | 18/30 [00:37<00:26,  2.21s/it]    {'epoch': 25, 'num_users': 6.0, 'loss': 0.0358, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 2.601}:  63%|██████▎   | 19/30 [00:37<00:21,  1.97s/it]{'epoch': 25, 'num_users': 6.15, 'loss': 0.036, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 2.614}:  63%|██████▎   | 19/30 [00:40<00:21,  1.97s/it]{'epoch': 25, 'num_users': 6.15, 'loss': 0.036, 'hit_ratio@10': 0.8281, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 2.614}:  67%|██████▋   | 20/30 [00:40<00:22,  2.25s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0372, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8629, 'compress@10': 1.0, 'time@10': 2.6551}:  67%|██████▋   | 20/30 [00:42<00:22,  2.25s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0372, 'hit_ratio@10': 0.828, 'ndcg@10': 0.8629, 'compress@10': 1.0, 'time@10': 2.6551}:  70%|███████   | 21/30 [00:42<00:18,  2.11s/it]{'epoch': 25, 'num_users': 6.1818, 'loss': 0.036, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8658, 'compress@10': 1.0, 'time@10': 2.6504}:  70%|███████   | 21/30 [00:45<00:18,  2.11s/it]{'epoch': 25, 'num_users': 6.1818, 'loss': 0.036, 'hit_ratio@10': 0.8337, 'ndcg@10': 0.8658, 'compress@10': 1.0, 'time@10': 2.6504}:  73%|███████▎  | 22/30 [00:45<00:18,  2.25s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 0.0352, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8679, 'compress@10': 1.0, 'time@10': 2.6381}:  73%|███████▎  | 22/30 [00:46<00:18,  2.25s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 0.0352, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8679, 'compress@10': 1.0, 'time@10': 2.6381}:  77%|███████▋  | 23/30 [00:46<00:13,  1.94s/it]{'epoch': 25, 'num_users': 5.9583, 'loss': 0.0337, 'hit_ratio@10': 0.833, 'ndcg@10': 0.865, 'compress@10': 1.0, 'time@10': 2.6328}:  77%|███████▋  | 23/30 [00:48<00:13,  1.94s/it]  {'epoch': 25, 'num_users': 5.9583, 'loss': 0.0337, 'hit_ratio@10': 0.833, 'ndcg@10': 0.865, 'compress@10': 1.0, 'time@10': 2.6328}:  80%|████████  | 24/30 [00:48<00:12,  2.13s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0324, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 2.6331}:  80%|████████  | 24/30 [00:50<00:12,  2.13s/it] {'epoch': 25, 'num_users': 5.8, 'loss': 0.0324, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 2.6331}:  83%|████████▎ | 25/30 [00:50<00:09,  1.90s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 0.0332, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8564, 'compress@10': 1.0, 'time@10': 2.648}:  83%|████████▎ | 25/30 [00:53<00:09,  1.90s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 0.0332, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8564, 'compress@10': 1.0, 'time@10': 2.648}:  87%|████████▋ | 26/30 [00:53<00:08,  2.24s/it]{'epoch': 25, 'num_users': 5.8889, 'loss': 0.0329, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 2.6507}:  87%|████████▋ | 26/30 [00:54<00:08,  2.24s/it]{'epoch': 25, 'num_users': 5.8889, 'loss': 0.0329, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 2.6507}:  90%|█████████ | 27/30 [00:54<00:05,  1.99s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 0.0329, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8586, 'compress@10': 1.0, 'time@10': 2.6522}:  90%|█████████ | 27/30 [00:57<00:05,  1.99s/it]   {'epoch': 25, 'num_users': 6.0, 'loss': 0.0329, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8586, 'compress@10': 1.0, 'time@10': 2.6522}:  93%|█████████▎| 28/30 [00:57<00:04,  2.21s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 0.033, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 2.6501}:  93%|█████████▎| 28/30 [00:58<00:04,  2.21s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 0.033, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 2.6501}:  97%|█████████▋| 29/30 [00:58<00:01,  1.95s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.033, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 2.6459}:  97%|█████████▋| 29/30 [01:01<00:01,  1.95s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.033, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 2.6459}: 100%|██████████| 30/30 [01:01<00:00,  2.13s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 0.033, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 2.6459}: 100%|██████████| 30/30 [01:01<00:00,  2.05s/it]
Epoch: 25
Avg # of users: 5.866666666666666
Avg Loss: 0.032991836217397576
Avg hit ratio: 0.8415010985841349
Avg ndcg: 0.8581250931426059
Avg compression ratio: 0.9999999860153537
Avg train time: 2.6459397872289023
Std train time: 0.4096209109804581
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 12, 33, 14, 8, 9, 8, 11, 6, 9, 7, 35, 9, 76, 7, 36, 49, 14, 15, 7, 4, 19, 10, 91, 89, 4, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0416, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 3.1055}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0416, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 3.1055}:   3%|▎         | 1/30 [00:01<00:46,  1.59s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0424, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 2.893}:   3%|▎         | 1/30 [00:04<00:46,  1.59s/it] {'epoch': 26, 'num_users': 7.0, 'loss': 0.0424, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 2.893}:   7%|▋         | 2/30 [00:04<01:03,  2.25s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 2.8334}:   7%|▋         | 2/30 [00:05<01:03,  2.25s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 2.8334}:  10%|█         | 3/30 [00:05<00:50,  1.86s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8874, 'compress@10': 1.0, 'time@10': 2.8215}:  10%|█         | 3/30 [00:08<00:50,  1.86s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8874, 'compress@10': 1.0, 'time@10': 2.8215}:  13%|█▎        | 4/30 [00:08<00:58,  2.24s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0352, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8697, 'compress@10': 1.0, 'time@10': 3.6004}:  13%|█▎        | 4/30 [00:11<00:58,  2.24s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0352, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8697, 'compress@10': 1.0, 'time@10': 3.6004}:  17%|█▋        | 5/30 [00:11<01:06,  2.66s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0347, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.8727, 'compress@10': 1.0, 'time@10': 3.5084}:  17%|█▋        | 5/30 [00:15<01:06,  2.66s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0347, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.8727, 'compress@10': 1.0, 'time@10': 3.5084}:  20%|██        | 6/30 [00:15<01:07,  2.80s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0349, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 3.4097}:  20%|██        | 6/30 [00:16<01:07,  2.80s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0349, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 3.4097}:  23%|██▎       | 7/30 [00:16<00:54,  2.36s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0336, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.876, 'compress@10': 1.0, 'time@10': 3.321}:  23%|██▎       | 7/30 [00:19<00:54,  2.36s/it]   {'epoch': 26, 'num_users': 6.125, 'loss': 0.0336, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.876, 'compress@10': 1.0, 'time@10': 3.321}:  27%|██▋       | 8/30 [00:19<00:54,  2.48s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8798, 'compress@10': 1.0, 'time@10': 3.2828}:  27%|██▋       | 8/30 [00:20<00:54,  2.48s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8798, 'compress@10': 1.0, 'time@10': 3.2828}:  30%|███       | 9/30 [00:20<00:45,  2.18s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0322, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8855, 'compress@10': 1.0, 'time@10': 3.2272}:  30%|███       | 9/30 [00:23<00:45,  2.18s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0322, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.8855, 'compress@10': 1.0, 'time@10': 3.2272}:  33%|███▎      | 10/30 [00:23<00:47,  2.36s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 0.0335, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.884, 'compress@10': 1.0, 'time@10': 3.1736}:  33%|███▎      | 10/30 [00:24<00:47,  2.36s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 0.0335, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.884, 'compress@10': 1.0, 'time@10': 3.1736}:  37%|███▋      | 11/30 [00:24<00:39,  2.05s/it]{'epoch': 26, 'num_users': 6.4167, 'loss': 0.0312, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8867, 'compress@10': 1.0, 'time@10': 3.1382}:  37%|███▋      | 11/30 [00:27<00:39,  2.05s/it]{'epoch': 26, 'num_users': 6.4167, 'loss': 0.0312, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8867, 'compress@10': 1.0, 'time@10': 3.1382}:  40%|████      | 12/30 [00:27<00:40,  2.28s/it]{'epoch': 26, 'num_users': 6.6154, 'loss': 0.0313, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8864, 'compress@10': 1.0, 'time@10': 3.109}:  40%|████      | 12/30 [00:29<00:40,  2.28s/it] {'epoch': 26, 'num_users': 6.6154, 'loss': 0.0313, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8864, 'compress@10': 1.0, 'time@10': 3.109}:  43%|████▎     | 13/30 [00:29<00:34,  2.02s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 0.0291, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8826, 'compress@10': 1.0, 'time@10': 3.0769}:  43%|████▎     | 13/30 [00:31<00:34,  2.02s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 0.0291, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8826, 'compress@10': 1.0, 'time@10': 3.0769}:  47%|████▋     | 14/30 [00:31<00:35,  2.22s/it]{'epoch': 26, 'num_users': 6.2667, 'loss': 0.0303, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8814, 'compress@10': 1.0, 'time@10': 3.0874}:  47%|████▋     | 14/30 [00:33<00:35,  2.22s/it]{'epoch': 26, 'num_users': 6.2667, 'loss': 0.0303, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8814, 'compress@10': 1.0, 'time@10': 3.0874}:  50%|█████     | 15/30 [00:33<00:30,  2.05s/it]{'epoch': 26, 'num_users': 6.0625, 'loss': 0.0286, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8836, 'compress@10': 1.0, 'time@10': 3.0671}:  50%|█████     | 15/30 [00:36<00:30,  2.05s/it]{'epoch': 26, 'num_users': 6.0625, 'loss': 0.0286, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8836, 'compress@10': 1.0, 'time@10': 3.0671}:  53%|█████▎    | 16/30 [00:36<00:31,  2.28s/it]{'epoch': 26, 'num_users': 5.8235, 'loss': 0.027, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8787, 'compress@10': 1.0, 'time@10': 3.044}:  53%|█████▎    | 16/30 [00:37<00:31,  2.28s/it]  {'epoch': 26, 'num_users': 5.8235, 'loss': 0.027, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8787, 'compress@10': 1.0, 'time@10': 3.044}:  57%|█████▋    | 17/30 [00:37<00:26,  2.00s/it]{'epoch': 26, 'num_users': 6.0556, 'loss': 0.0275, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.8799, 'compress@10': 1.0, 'time@10': 3.0359}:  57%|█████▋    | 17/30 [00:40<00:26,  2.00s/it]{'epoch': 26, 'num_users': 6.0556, 'loss': 0.0275, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.8799, 'compress@10': 1.0, 'time@10': 3.0359}:  60%|██████    | 18/30 [00:40<00:27,  2.28s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 0.0264, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8815, 'compress@10': 1.0, 'time@10': 3.0255}:  60%|██████    | 18/30 [00:41<00:27,  2.28s/it]   {'epoch': 26, 'num_users': 6.0, 'loss': 0.0264, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8815, 'compress@10': 1.0, 'time@10': 3.0255}:  63%|██████▎   | 19/30 [00:41<00:22,  2.04s/it]{'epoch': 26, 'num_users': 6.15, 'loss': 0.027, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.881, 'compress@10': 1.0, 'time@10': 3.02}:  63%|██████▎   | 19/30 [00:44<00:22,  2.04s/it]   {'epoch': 26, 'num_users': 6.15, 'loss': 0.027, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.881, 'compress@10': 1.0, 'time@10': 3.02}:  67%|██████▋   | 20/30 [00:44<00:23,  2.31s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 2.9842}:  67%|██████▋   | 20/30 [00:46<00:23,  2.31s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 2.9842}:  70%|███████   | 21/30 [00:46<00:17,  1.97s/it]{'epoch': 26, 'num_users': 6.1818, 'loss': 0.028, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 2.9731}:  70%|███████   | 21/30 [00:48<00:17,  1.97s/it]{'epoch': 26, 'num_users': 6.1818, 'loss': 0.028, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 2.9731}:  73%|███████▎  | 22/30 [00:48<00:17,  2.21s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 0.0274, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 2.9573}:  73%|███████▎  | 22/30 [00:50<00:17,  2.21s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 0.0274, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 2.9573}:  77%|███████▋  | 23/30 [00:50<00:13,  1.95s/it]{'epoch': 26, 'num_users': 5.9583, 'loss': 0.0263, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 2.9381}:  77%|███████▋  | 23/30 [00:52<00:13,  1.95s/it]{'epoch': 26, 'num_users': 5.9583, 'loss': 0.0263, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 2.9381}:  80%|████████  | 24/30 [00:52<00:12,  2.12s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 2.9246}:  80%|████████  | 24/30 [00:54<00:12,  2.12s/it]   {'epoch': 26, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8693, 'compress@10': 1.0, 'time@10': 2.9246}:  83%|████████▎ | 25/30 [00:54<00:09,  1.89s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 0.0264, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 2.9104}:  83%|████████▎ | 25/30 [00:56<00:09,  1.89s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 0.0264, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 2.9104}:  87%|████████▋ | 26/30 [00:56<00:08,  2.10s/it]{'epoch': 26, 'num_users': 5.8889, 'loss': 0.0264, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 2.9088}:  87%|████████▋ | 26/30 [00:58<00:08,  2.10s/it]{'epoch': 26, 'num_users': 5.8889, 'loss': 0.0264, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 2.9088}:  90%|█████████ | 27/30 [00:58<00:05,  1.91s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 0.0266, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 2.9003}:  90%|█████████ | 27/30 [01:00<00:05,  1.91s/it]   {'epoch': 26, 'num_users': 6.0, 'loss': 0.0266, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 2.9003}:  93%|█████████▎| 28/30 [01:00<00:04,  2.15s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 0.0266, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 2.9012}:  93%|█████████▎| 28/30 [01:02<00:04,  2.15s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 0.0266, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 2.9012}:  97%|█████████▋| 29/30 [01:02<00:01,  1.96s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0269, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 2.9016}:  97%|█████████▋| 29/30 [01:05<00:01,  1.96s/it] {'epoch': 26, 'num_users': 5.8667, 'loss': 0.0269, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 2.9016}: 100%|██████████| 30/30 [01:05<00:00,  2.26s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 0.0269, 'hit_ratio@10': 0.861, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 2.9016}: 100%|██████████| 30/30 [01:05<00:00,  2.18s/it]
Epoch: 26
Avg # of users: 5.866666666666666
Avg Loss: 0.02687157697460946
Avg hit ratio: 0.8609797752401954
Avg ndcg: 0.8706216332613208
Avg compression ratio: 0.9999999860153537
Avg train time: 2.901647623380025
Std train time: 0.7323494294810072
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 33, 14, 1, 8, 8, 11, 5, 9, 7, 35, 9, 76, 5, 36, 49, 14, 15, 7, 6, 19, 11, 92, 90, 5, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8826, 'compress@10': 1.0, 'time@10': 2.977}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8826, 'compress@10': 1.0, 'time@10': 2.977}:   3%|▎         | 1/30 [00:01<00:44,  1.53s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0319, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 2.8824}:   3%|▎         | 1/30 [00:04<00:44,  1.53s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0319, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 2.8824}:   7%|▋         | 2/30 [00:04<01:04,  2.29s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 2.8257}:   7%|▋         | 2/30 [00:05<01:04,  2.29s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 2.8257}:  10%|█         | 3/30 [00:05<00:50,  1.89s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 2.8018}:  10%|█         | 3/30 [00:08<00:50,  1.89s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 2.8018}:  13%|█▎        | 4/30 [00:08<00:58,  2.23s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0562, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8347, 'compress@10': 1.0, 'time@10': 2.3846}:  13%|█▎        | 4/30 [00:08<00:58,  2.23s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0562, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8347, 'compress@10': 1.0, 'time@10': 2.3846}:  17%|█▋        | 5/30 [00:08<00:39,  1.57s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0521, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 2.4283}:  17%|█▋        | 5/30 [00:11<00:39,  1.57s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0521, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 2.4283}:  20%|██        | 6/30 [00:11<00:46,  1.95s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 2.4876}:  20%|██        | 6/30 [00:13<00:46,  1.95s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0496, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 2.4876}:  23%|██▎       | 7/30 [00:13<00:41,  1.79s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0486, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8588, 'compress@10': 1.0, 'time@10': 2.5207}:  23%|██▎       | 7/30 [00:15<00:41,  1.79s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0486, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8588, 'compress@10': 1.0, 'time@10': 2.5207}:  27%|██▋       | 8/30 [00:15<00:46,  2.11s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0468, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 2.5431}:  27%|██▋       | 8/30 [00:17<00:46,  2.11s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0468, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 2.5431}:  30%|███       | 9/30 [00:17<00:39,  1.89s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.045, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8752, 'compress@10': 1.0, 'time@10': 2.5823}:  30%|███       | 9/30 [00:20<00:39,  1.89s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.045, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8752, 'compress@10': 1.0, 'time@10': 2.5823}:  33%|███▎      | 10/30 [00:20<00:44,  2.23s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 0.0451, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8747, 'compress@10': 1.0, 'time@10': 2.5995}:  33%|███▎      | 10/30 [00:21<00:44,  2.23s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 0.0451, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8747, 'compress@10': 1.0, 'time@10': 2.5995}:  37%|███▋      | 11/30 [00:21<00:37,  1.98s/it]{'epoch': 27, 'num_users': 6.4167, 'loss': 0.0418, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8782, 'compress@10': 1.0, 'time@10': 2.6041}:  37%|███▋      | 11/30 [00:24<00:37,  1.98s/it]{'epoch': 27, 'num_users': 6.4167, 'loss': 0.0418, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8782, 'compress@10': 1.0, 'time@10': 2.6041}:  40%|████      | 12/30 [00:24<00:39,  2.20s/it]{'epoch': 27, 'num_users': 6.6154, 'loss': 0.0416, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8781, 'compress@10': 1.0, 'time@10': 2.6256}:  40%|████      | 12/30 [00:25<00:39,  2.20s/it]{'epoch': 27, 'num_users': 6.6154, 'loss': 0.0416, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8781, 'compress@10': 1.0, 'time@10': 2.6256}:  43%|████▎     | 13/30 [00:25<00:33,  1.98s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 0.0386, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 2.6251}:  43%|████▎     | 13/30 [00:28<00:33,  1.98s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 0.0386, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 2.6251}:  47%|████▋     | 14/30 [00:28<00:34,  2.18s/it]{'epoch': 27, 'num_users': 6.2667, 'loss': 0.0388, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.8751, 'compress@10': 1.0, 'time@10': 2.5933}:  47%|████▋     | 14/30 [00:29<00:34,  2.18s/it]{'epoch': 27, 'num_users': 6.2667, 'loss': 0.0388, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.8751, 'compress@10': 1.0, 'time@10': 2.5933}:  50%|█████     | 15/30 [00:29<00:27,  1.86s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 0.0367, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 2.6053}:  50%|█████     | 15/30 [00:32<00:27,  1.86s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 0.0367, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 2.6053}:  53%|█████▎    | 16/30 [00:32<00:30,  2.15s/it]{'epoch': 27, 'num_users': 5.8235, 'loss': 0.0345, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8731, 'compress@10': 1.0, 'time@10': 2.6167}:  53%|█████▎    | 16/30 [00:33<00:30,  2.15s/it]{'epoch': 27, 'num_users': 5.8235, 'loss': 0.0345, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8731, 'compress@10': 1.0, 'time@10': 2.6167}:  57%|█████▋    | 17/30 [00:33<00:25,  1.94s/it]{'epoch': 27, 'num_users': 6.0556, 'loss': 0.0344, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8752, 'compress@10': 1.0, 'time@10': 2.6276}:  57%|█████▋    | 17/30 [00:36<00:25,  1.94s/it]{'epoch': 27, 'num_users': 6.0556, 'loss': 0.0344, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8752, 'compress@10': 1.0, 'time@10': 2.6276}:  60%|██████    | 18/30 [00:36<00:26,  2.21s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 0.0331, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 2.6411}:  60%|██████    | 18/30 [00:38<00:26,  2.21s/it]    {'epoch': 27, 'num_users': 6.0, 'loss': 0.0331, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 2.6411}:  63%|██████▎   | 19/30 [00:38<00:21,  1.99s/it]{'epoch': 27, 'num_users': 6.15, 'loss': 0.0333, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 2.6609}:  63%|██████▎   | 19/30 [00:41<00:21,  1.99s/it]{'epoch': 27, 'num_users': 6.15, 'loss': 0.0333, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 2.6609}:  67%|██████▋   | 20/30 [00:41<00:23,  2.32s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0343, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 2.7008}:  67%|██████▋   | 20/30 [00:43<00:23,  2.32s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0343, 'hit_ratio@10': 0.8379, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 2.7008}:  70%|███████   | 21/30 [00:43<00:19,  2.16s/it]{'epoch': 27, 'num_users': 6.1818, 'loss': 0.0332, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 2.7066}:  70%|███████   | 21/30 [00:45<00:19,  2.16s/it]{'epoch': 27, 'num_users': 6.1818, 'loss': 0.0332, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 2.7066}:  73%|███████▎  | 22/30 [00:45<00:18,  2.37s/it]{'epoch': 27, 'num_users': 6.1304, 'loss': 0.0328, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 2.7242}:  73%|███████▎  | 22/30 [00:47<00:18,  2.37s/it]  {'epoch': 27, 'num_users': 6.1304, 'loss': 0.0328, 'hit_ratio@10': 0.8435, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 2.7242}:  77%|███████▋  | 23/30 [00:47<00:14,  2.14s/it]{'epoch': 27, 'num_users': 5.9583, 'loss': 0.0315, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 2.7166}:  77%|███████▋  | 23/30 [00:50<00:14,  2.14s/it]{'epoch': 27, 'num_users': 5.9583, 'loss': 0.0315, 'hit_ratio@10': 0.8417, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 2.7166}:  80%|████████  | 24/30 [00:50<00:13,  2.27s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8682, 'compress@10': 1.0, 'time@10': 2.706}:  80%|████████  | 24/30 [00:51<00:13,  2.27s/it]    {'epoch': 27, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8682, 'compress@10': 1.0, 'time@10': 2.706}:  83%|████████▎ | 25/30 [00:51<00:09,  1.97s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 0.031, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 2.7156}:  83%|████████▎ | 25/30 [00:54<00:09,  1.97s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 0.031, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 2.7156}:  87%|████████▋ | 26/30 [00:54<00:09,  2.27s/it]{'epoch': 27, 'num_users': 5.8889, 'loss': 0.0307, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.868, 'compress@10': 1.0, 'time@10': 2.7283}:  87%|████████▋ | 26/30 [00:55<00:09,  2.27s/it]{'epoch': 27, 'num_users': 5.8889, 'loss': 0.0307, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.868, 'compress@10': 1.0, 'time@10': 2.7283}:  90%|█████████ | 27/30 [00:55<00:06,  2.06s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 0.0308, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 2.7265}:  90%|█████████ | 27/30 [00:58<00:06,  2.06s/it]  {'epoch': 27, 'num_users': 6.0, 'loss': 0.0308, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 2.7265}:  93%|█████████▎| 28/30 [00:58<00:04,  2.26s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 0.0303, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8714, 'compress@10': 1.0, 'time@10': 2.7308}:  93%|█████████▎| 28/30 [01:00<00:04,  2.26s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 0.0303, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.8714, 'compress@10': 1.0, 'time@10': 2.7308}:  97%|█████████▋| 29/30 [01:00<00:02,  2.02s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.0298, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8739, 'compress@10': 1.0, 'time@10': 2.7347}:  97%|█████████▋| 29/30 [01:02<00:02,  2.02s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.0298, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8739, 'compress@10': 1.0, 'time@10': 2.7347}: 100%|██████████| 30/30 [01:02<00:00,  2.28s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 0.0298, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8739, 'compress@10': 1.0, 'time@10': 2.7347}: 100%|██████████| 30/30 [01:02<00:00,  2.10s/it]
Epoch: 27
Avg # of users: 5.866666666666666
Avg Loss: 0.029758442529139516
Avg hit ratio: 0.8512810172833224
Avg ndcg: 0.8738512329257979
Avg compression ratio: 0.9999999860153537
Avg train time: 2.7346728563308718
Std train time: 0.4376618439762339
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[9, 12, 33, 14, 8, 8, 8, 11, 5, 8, 7, 35, 9, 76, 7, 36, 49, 14, 15, 6, 4, 19, 10, 93, 91, 4, 6, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0329, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8891, 'compress@10': 1.0, 'time@10': 2.4041}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0329, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8891, 'compress@10': 1.0, 'time@10': 2.4041}:   3%|▎         | 1/30 [00:01<00:35,  1.24s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8929, 'compress@10': 1.0, 'time@10': 2.6793}:   3%|▎         | 1/30 [00:04<00:35,  1.24s/it] {'epoch': 28, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8929, 'compress@10': 1.0, 'time@10': 2.6793}:   7%|▋         | 2/30 [00:04<01:03,  2.27s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.881, 'compress@10': 1.0, 'time@10': 2.6697}:   7%|▋         | 2/30 [00:05<01:03,  2.27s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.881, 'compress@10': 1.0, 'time@10': 2.6697}:  10%|█         | 3/30 [00:05<00:50,  1.86s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 2.6533}:  10%|█         | 3/30 [00:08<00:50,  1.86s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 2.6533}:  13%|█▎        | 4/30 [00:08<00:56,  2.17s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0296, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8889, 'compress@10': 1.0, 'time@10': 3.3012}:  13%|█▎        | 4/30 [00:11<00:56,  2.17s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0296, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8889, 'compress@10': 1.0, 'time@10': 3.3012}:  17%|█▋        | 5/30 [00:11<01:01,  2.46s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.03, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 3.1836}:  17%|█▋        | 5/30 [00:13<01:01,  2.46s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.03, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 3.1836}:  20%|██        | 6/30 [00:13<01:00,  2.52s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0306, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8824, 'compress@10': 1.0, 'time@10': 3.1337}:  20%|██        | 6/30 [00:15<01:00,  2.52s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0306, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8824, 'compress@10': 1.0, 'time@10': 3.1337}:  23%|██▎       | 7/30 [00:15<00:49,  2.17s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0304, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 3.0849}:  23%|██▎       | 7/30 [00:18<00:49,  2.17s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0304, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 3.0849}:  27%|██▋       | 8/30 [00:18<00:52,  2.37s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0304, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8898, 'compress@10': 1.0, 'time@10': 3.0356}:  27%|██▋       | 8/30 [00:19<00:52,  2.37s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0304, 'hit_ratio@10': 0.868, 'ndcg@10': 0.8898, 'compress@10': 1.0, 'time@10': 3.0356}:  30%|███       | 9/30 [00:19<00:43,  2.05s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 2.9782}:  30%|███       | 9/30 [00:21<00:43,  2.05s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 2.9782}:  33%|███▎      | 10/30 [00:21<00:43,  2.19s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 0.0306, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8929, 'compress@10': 1.0, 'time@10': 2.9388}:  33%|███▎      | 10/30 [00:23<00:43,  2.19s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 0.0306, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8929, 'compress@10': 1.0, 'time@10': 2.9388}:  37%|███▋      | 11/30 [00:23<00:36,  1.92s/it]{'epoch': 28, 'num_users': 6.4167, 'loss': 0.0283, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 2.9156}:  37%|███▋      | 11/30 [00:25<00:36,  1.92s/it]{'epoch': 28, 'num_users': 6.4167, 'loss': 0.0283, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 2.9156}:  40%|████      | 12/30 [00:25<00:38,  2.16s/it]{'epoch': 28, 'num_users': 6.6154, 'loss': 0.0286, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 2.9059}:  40%|████      | 12/30 [00:27<00:38,  2.16s/it]{'epoch': 28, 'num_users': 6.6154, 'loss': 0.0286, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 2.9059}:  43%|████▎     | 13/30 [00:27<00:32,  1.94s/it]{'epoch': 28, 'num_users': 6.3571, 'loss': 0.0266, 'hit_ratio@10': 0.858, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 2.8837}:  43%|████▎     | 13/30 [00:30<00:32,  1.94s/it]   {'epoch': 28, 'num_users': 6.3571, 'loss': 0.0266, 'hit_ratio@10': 0.858, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 2.8837}:  47%|████▋     | 14/30 [00:30<00:34,  2.15s/it]{'epoch': 28, 'num_users': 6.2667, 'loss': 0.0282, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8892, 'compress@10': 1.0, 'time@10': 2.8948}:  47%|████▋     | 14/30 [00:31<00:34,  2.15s/it]{'epoch': 28, 'num_users': 6.2667, 'loss': 0.0282, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8892, 'compress@10': 1.0, 'time@10': 2.8948}:  50%|█████     | 15/30 [00:31<00:29,  1.97s/it]{'epoch': 28, 'num_users': 6.0625, 'loss': 0.0266, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 2.8875}:  50%|█████     | 15/30 [00:34<00:29,  1.97s/it]{'epoch': 28, 'num_users': 6.0625, 'loss': 0.0266, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 2.8875}:  53%|█████▎    | 16/30 [00:34<00:31,  2.23s/it]{'epoch': 28, 'num_users': 5.8235, 'loss': 0.025, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 2.8793}:  53%|█████▎    | 16/30 [00:35<00:31,  2.23s/it] {'epoch': 28, 'num_users': 5.8235, 'loss': 0.025, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 2.8793}:  57%|█████▋    | 17/30 [00:35<00:25,  1.98s/it]{'epoch': 28, 'num_users': 6.0556, 'loss': 0.0254, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.887, 'compress@10': 1.0, 'time@10': 2.8804}:  57%|█████▋    | 17/30 [00:38<00:25,  1.98s/it]{'epoch': 28, 'num_users': 6.0556, 'loss': 0.0254, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.887, 'compress@10': 1.0, 'time@10': 2.8804}:  60%|██████    | 18/30 [00:38<00:27,  2.27s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 0.0244, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8889, 'compress@10': 1.0, 'time@10': 2.8738}:  60%|██████    | 18/30 [00:40<00:27,  2.27s/it]  {'epoch': 28, 'num_users': 6.0, 'loss': 0.0244, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8889, 'compress@10': 1.0, 'time@10': 2.8738}:  63%|██████▎   | 19/30 [00:40<00:22,  2.01s/it]{'epoch': 28, 'num_users': 6.15, 'loss': 0.0249, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 2.8535}:  63%|██████▎   | 19/30 [00:42<00:22,  2.01s/it]{'epoch': 28, 'num_users': 6.15, 'loss': 0.0249, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 2.8535}:  67%|██████▋   | 20/30 [00:42<00:21,  2.16s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0269, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 2.8288}:  67%|██████▋   | 20/30 [00:43<00:21,  2.16s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0269, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8847, 'compress@10': 1.0, 'time@10': 2.8288}:  70%|███████   | 21/30 [00:43<00:16,  1.87s/it]{'epoch': 28, 'num_users': 6.1818, 'loss': 0.0261, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 2.8245}:  70%|███████   | 21/30 [00:46<00:16,  1.87s/it]{'epoch': 28, 'num_users': 6.1818, 'loss': 0.0261, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 2.8245}:  73%|███████▎  | 22/30 [00:46<00:17,  2.14s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 0.0257, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8886, 'compress@10': 1.0, 'time@10': 2.8165}:  73%|███████▎  | 22/30 [00:48<00:17,  2.14s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 0.0257, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8886, 'compress@10': 1.0, 'time@10': 2.8165}:  77%|███████▋  | 23/30 [00:48<00:13,  1.91s/it]{'epoch': 28, 'num_users': 5.9583, 'loss': 0.0246, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8849, 'compress@10': 1.0, 'time@10': 2.8083}:  77%|███████▋  | 23/30 [00:50<00:13,  1.91s/it]{'epoch': 28, 'num_users': 5.9583, 'loss': 0.0246, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8849, 'compress@10': 1.0, 'time@10': 2.8083}:  80%|████████  | 24/30 [00:50<00:12,  2.13s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0236, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8762, 'compress@10': 1.0, 'time@10': 2.7951}:  80%|████████  | 24/30 [00:51<00:12,  2.13s/it]   {'epoch': 28, 'num_users': 5.8, 'loss': 0.0236, 'hit_ratio@10': 0.8516, 'ndcg@10': 0.8762, 'compress@10': 1.0, 'time@10': 2.7951}:  83%|████████▎ | 25/30 [00:51<00:09,  1.88s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 0.0247, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8746, 'compress@10': 1.0, 'time@10': 2.7771}:  83%|████████▎ | 25/30 [00:54<00:09,  1.88s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 0.0247, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8746, 'compress@10': 1.0, 'time@10': 2.7771}:  87%|████████▋ | 26/30 [00:54<00:08,  2.08s/it]{'epoch': 28, 'num_users': 5.8889, 'loss': 0.0246, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8755, 'compress@10': 1.0, 'time@10': 2.765}:  87%|████████▋ | 26/30 [00:55<00:08,  2.08s/it] {'epoch': 28, 'num_users': 5.8889, 'loss': 0.0246, 'hit_ratio@10': 0.8576, 'ndcg@10': 0.8755, 'compress@10': 1.0, 'time@10': 2.765}:  90%|█████████ | 27/30 [00:55<00:05,  1.83s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 0.0249, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8761, 'compress@10': 1.0, 'time@10': 2.768}:  90%|█████████ | 27/30 [00:58<00:05,  1.83s/it]   {'epoch': 28, 'num_users': 6.0, 'loss': 0.0249, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8761, 'compress@10': 1.0, 'time@10': 2.768}:  93%|█████████▎| 28/30 [00:58<00:04,  2.15s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 0.0246, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.8785, 'compress@10': 1.0, 'time@10': 2.7712}:  93%|█████████▎| 28/30 [01:00<00:04,  2.15s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 0.0246, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.8785, 'compress@10': 1.0, 'time@10': 2.7712}:  97%|█████████▋| 29/30 [01:00<00:01,  1.95s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.025, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.8803, 'compress@10': 1.0, 'time@10': 2.7751}:  97%|█████████▋| 29/30 [01:03<00:01,  1.95s/it] {'epoch': 28, 'num_users': 5.8667, 'loss': 0.025, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.8803, 'compress@10': 1.0, 'time@10': 2.7751}: 100%|██████████| 30/30 [01:03<00:00,  2.24s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 0.025, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.8803, 'compress@10': 1.0, 'time@10': 2.7751}: 100%|██████████| 30/30 [01:03<00:00,  2.10s/it]
Epoch: 28
Avg # of users: 5.866666666666666
Avg Loss: 0.025027955725893707
Avg hit ratio: 0.8636289493630537
Avg ndcg: 0.8802741233482567
Avg compression ratio: 0.9999999860153537
Avg train time: 2.775127824147542
Std train time: 0.6063177185223684
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 11, 33, 15, 1, 9, 8, 11, 5, 9, 8, 35, 9, 77, 6, 36, 49, 14, 15, 7, 5, 19, 10, 93, 92, 5, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8822, 'compress@10': 1.0, 'time@10': 2.9531}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0384, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8822, 'compress@10': 1.0, 'time@10': 2.9531}:   3%|▎         | 1/30 [00:01<00:43,  1.51s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8984, 'compress@10': 1.0, 'time@10': 2.712}:   3%|▎         | 1/30 [00:04<00:43,  1.51s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8984, 'compress@10': 1.0, 'time@10': 2.712}:   7%|▋         | 2/30 [00:04<00:58,  2.10s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8846, 'compress@10': 1.0, 'time@10': 2.7588}:   7%|▋         | 2/30 [00:05<00:58,  2.10s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8846, 'compress@10': 1.0, 'time@10': 2.7588}:  10%|█         | 3/30 [00:05<00:48,  1.81s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.847, 'ndcg@10': 0.9113, 'compress@10': 1.0, 'time@10': 2.8493}:  10%|█         | 3/30 [00:08<00:48,  1.81s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.847, 'ndcg@10': 0.9113, 'compress@10': 1.0, 'time@10': 2.8493}:  13%|█▎        | 4/30 [00:08<01:00,  2.34s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0576, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8464, 'compress@10': 1.0, 'time@10': 2.4275}:  13%|█▎        | 4/30 [00:09<01:00,  2.34s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0576, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8464, 'compress@10': 1.0, 'time@10': 2.4275}:  17%|█▋        | 5/30 [00:09<00:41,  1.64s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0534, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.8525, 'compress@10': 1.0, 'time@10': 2.5238}:  17%|█▋        | 5/30 [00:12<00:41,  1.64s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0534, 'hit_ratio@10': 0.8433, 'ndcg@10': 0.8525, 'compress@10': 1.0, 'time@10': 2.5238}:  20%|██        | 6/30 [00:12<00:50,  2.12s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8512, 'compress@10': 1.0, 'time@10': 2.5643}:  20%|██        | 6/30 [00:13<00:50,  2.12s/it]  {'epoch': 29, 'num_users': 6.2857, 'loss': 0.0504, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8512, 'compress@10': 1.0, 'time@10': 2.5643}:  23%|██▎       | 7/30 [00:13<00:43,  1.90s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0473, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8631, 'compress@10': 1.0, 'time@10': 2.5736}:  23%|██▎       | 7/30 [00:16<00:43,  1.90s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0473, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8631, 'compress@10': 1.0, 'time@10': 2.5736}:  27%|██▋       | 8/30 [00:16<00:47,  2.15s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0453, 'hit_ratio@10': 0.853, 'ndcg@10': 0.871, 'compress@10': 1.0, 'time@10': 2.5567}:  27%|██▋       | 8/30 [00:17<00:47,  2.15s/it] {'epoch': 29, 'num_users': 6.3333, 'loss': 0.0453, 'hit_ratio@10': 0.853, 'ndcg@10': 0.871, 'compress@10': 1.0, 'time@10': 2.5567}:  30%|███       | 9/30 [00:17<00:39,  1.87s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0435, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 2.5829}:  30%|███       | 9/30 [00:20<00:39,  1.87s/it] {'epoch': 29, 'num_users': 6.3, 'loss': 0.0435, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 2.5829}:  33%|███▎      | 10/30 [00:20<00:43,  2.17s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 0.0435, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 2.6433}:  33%|███▎      | 10/30 [00:21<00:43,  2.17s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 0.0435, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 2.6433}:  37%|███▋      | 11/30 [00:21<00:38,  2.02s/it]{'epoch': 29, 'num_users': 6.4167, 'loss': 0.0402, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 2.6564}:  37%|███▋      | 11/30 [00:24<00:38,  2.02s/it]{'epoch': 29, 'num_users': 6.4167, 'loss': 0.0402, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.8819, 'compress@10': 1.0, 'time@10': 2.6564}:  40%|████      | 12/30 [00:24<00:40,  2.27s/it]{'epoch': 29, 'num_users': 6.6154, 'loss': 0.0398, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 2.6645}:  40%|████      | 12/30 [00:26<00:40,  2.27s/it]{'epoch': 29, 'num_users': 6.6154, 'loss': 0.0398, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 2.6645}:  43%|████▎     | 13/30 [00:26<00:34,  2.01s/it]{'epoch': 29, 'num_users': 6.3571, 'loss': 0.037, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8783, 'compress@10': 1.0, 'time@10': 2.6625}:  43%|████▎     | 13/30 [00:28<00:34,  2.01s/it] {'epoch': 29, 'num_users': 6.3571, 'loss': 0.037, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8783, 'compress@10': 1.0, 'time@10': 2.6625}:  47%|████▋     | 14/30 [00:28<00:35,  2.21s/it]{'epoch': 29, 'num_users': 6.2667, 'loss': 0.0374, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8787, 'compress@10': 1.0, 'time@10': 2.656}:  47%|████▋     | 14/30 [00:30<00:35,  2.21s/it]{'epoch': 29, 'num_users': 6.2667, 'loss': 0.0374, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.8787, 'compress@10': 1.0, 'time@10': 2.656}:  50%|█████     | 15/30 [00:30<00:29,  1.94s/it]{'epoch': 29, 'num_users': 6.0625, 'loss': 0.0351, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 2.6615}:  50%|█████     | 15/30 [00:33<00:29,  1.94s/it]{'epoch': 29, 'num_users': 6.0625, 'loss': 0.0351, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 2.6615}:  53%|█████▎    | 16/30 [00:33<00:30,  2.19s/it]{'epoch': 29, 'num_users': 5.8235, 'loss': 0.0331, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8763, 'compress@10': 1.0, 'time@10': 2.664}:  53%|█████▎    | 16/30 [00:34<00:30,  2.19s/it]   {'epoch': 29, 'num_users': 5.8235, 'loss': 0.0331, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8763, 'compress@10': 1.0, 'time@10': 2.664}:  57%|█████▋    | 17/30 [00:34<00:25,  1.95s/it]{'epoch': 29, 'num_users': 6.0556, 'loss': 0.033, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.878, 'compress@10': 1.0, 'time@10': 2.679}:  57%|█████▋    | 17/30 [00:37<00:25,  1.95s/it]{'epoch': 29, 'num_users': 6.0556, 'loss': 0.033, 'hit_ratio@10': 0.8429, 'ndcg@10': 0.878, 'compress@10': 1.0, 'time@10': 2.679}:  60%|██████    | 18/30 [00:37<00:27,  2.26s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 0.0317, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 2.6823}:  60%|██████    | 18/30 [00:38<00:27,  2.26s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 0.0317, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 2.6823}:  63%|██████▎   | 19/30 [00:38<00:22,  2.00s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 0.0318, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8805, 'compress@10': 1.0, 'time@10': 2.6923}:  63%|██████▎   | 19/30 [00:41<00:22,  2.00s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 0.0318, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8805, 'compress@10': 1.0, 'time@10': 2.6923}:  67%|██████▋   | 20/30 [00:41<00:22,  2.28s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.033, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 2.7001}:  67%|██████▋   | 20/30 [00:43<00:22,  2.28s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.033, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 2.7001}:  70%|███████   | 21/30 [00:43<00:18,  2.03s/it]{'epoch': 29, 'num_users': 6.1818, 'loss': 0.0325, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 2.7034}:  70%|███████   | 21/30 [00:45<00:18,  2.03s/it]{'epoch': 29, 'num_users': 6.1818, 'loss': 0.0325, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 2.7034}:  73%|███████▎  | 22/30 [00:45<00:18,  2.27s/it]{'epoch': 29, 'num_users': 6.1304, 'loss': 0.0319, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 2.7}:  73%|███████▎  | 22/30 [00:47<00:18,  2.27s/it]   {'epoch': 29, 'num_users': 6.1304, 'loss': 0.0319, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 2.7}:  77%|███████▋  | 23/30 [00:47<00:13,  1.99s/it]{'epoch': 29, 'num_users': 5.9583, 'loss': 0.0306, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8783, 'compress@10': 1.0, 'time@10': 2.7}:  77%|███████▋  | 23/30 [00:50<00:13,  1.99s/it]{'epoch': 29, 'num_users': 5.9583, 'loss': 0.0306, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8783, 'compress@10': 1.0, 'time@10': 2.7}:  80%|████████  | 24/30 [00:50<00:13,  2.21s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 2.6936}:  80%|████████  | 24/30 [00:51<00:13,  2.21s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 2.6936}:  83%|████████▎ | 25/30 [00:51<00:09,  1.95s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 0.03, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8691, 'compress@10': 1.0, 'time@10': 2.7022}:  83%|████████▎ | 25/30 [00:54<00:09,  1.95s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 0.03, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8691, 'compress@10': 1.0, 'time@10': 2.7022}:  87%|████████▋ | 26/30 [00:54<00:08,  2.25s/it]{'epoch': 29, 'num_users': 5.8889, 'loss': 0.0296, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 2.7085}:  87%|████████▋ | 26/30 [00:55<00:08,  2.25s/it]{'epoch': 29, 'num_users': 5.8889, 'loss': 0.0296, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8704, 'compress@10': 1.0, 'time@10': 2.7085}:  90%|█████████ | 27/30 [00:55<00:06,  2.02s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 0.0297, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 2.7069}:  90%|█████████ | 27/30 [00:58<00:06,  2.02s/it]   {'epoch': 29, 'num_users': 6.0, 'loss': 0.0297, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 2.7069}:  93%|█████████▎| 28/30 [00:58<00:04,  2.22s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 0.0292, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 2.7143}:  93%|█████████▎| 28/30 [01:00<00:04,  2.22s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 0.0292, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 2.7143}:  97%|█████████▋| 29/30 [01:00<00:02,  2.01s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0286, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.7237}:  97%|█████████▋| 29/30 [01:03<00:02,  2.01s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0286, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.7237}: 100%|██████████| 30/30 [01:03<00:00,  2.31s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 0.0286, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.7237}: 100%|██████████| 30/30 [01:03<00:00,  2.10s/it]
Epoch: 29
Avg # of users: 5.866666666666666
Avg Loss: 0.02858675197720561
Avg hit ratio: 0.8605982964314287
Avg ndcg: 0.8768897131632597
Avg compression ratio: 0.9999999860153537
Avg train time: 2.723660929997762
Std train time: 0.4099886506772442
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[9, 12, 33, 14, 8, 8, 8, 11, 6, 9, 6, 35, 9, 77, 7, 36, 49, 13, 15, 7, 5, 19, 10, 93, 93, 5, 7, 7, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8891, 'compress@10': 1.0, 'time@10': 2.549}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0301, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8891, 'compress@10': 1.0, 'time@10': 2.549}:   3%|▎         | 1/30 [00:01<00:38,  1.31s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0253, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9054, 'compress@10': 1.0, 'time@10': 2.6107}:   3%|▎         | 1/30 [00:04<00:38,  1.31s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0253, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9054, 'compress@10': 1.0, 'time@10': 2.6107}:   7%|▋         | 2/30 [00:04<00:59,  2.14s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8893, 'compress@10': 1.0, 'time@10': 2.6657}:   7%|▋         | 2/30 [00:05<00:59,  2.14s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8893, 'compress@10': 1.0, 'time@10': 2.6657}:  10%|█         | 3/30 [00:05<00:48,  1.81s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 2.6913}:  10%|█         | 3/30 [00:08<00:48,  1.81s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 2.6913}:  13%|█▎        | 4/30 [00:08<00:57,  2.21s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8786, 'compress@10': 1.0, 'time@10': 3.4137}:  13%|█▎        | 4/30 [00:11<00:57,  2.21s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8336, 'ndcg@10': 0.8786, 'compress@10': 1.0, 'time@10': 3.4137}:  17%|█▋        | 5/30 [00:11<01:04,  2.56s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.026, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 3.291}:  17%|█▋        | 5/30 [00:14<01:04,  2.56s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.026, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 3.291}:  20%|██        | 6/30 [00:14<01:02,  2.62s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0267, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.878, 'compress@10': 1.0, 'time@10': 3.2554}:  20%|██        | 6/30 [00:15<01:02,  2.62s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0267, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.878, 'compress@10': 1.0, 'time@10': 3.2554}:  23%|██▎       | 7/30 [00:15<00:52,  2.27s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.1794}:  23%|██▎       | 7/30 [00:18<00:52,  2.27s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.1794}:  27%|██▋       | 8/30 [00:18<00:52,  2.40s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0282, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8926, 'compress@10': 1.0, 'time@10': 3.1616}:  27%|██▋       | 8/30 [00:19<00:52,  2.40s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0282, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8926, 'compress@10': 1.0, 'time@10': 3.1616}:  30%|███       | 9/30 [00:19<00:44,  2.14s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.8972, 'compress@10': 1.0, 'time@10': 3.1227}:  30%|███       | 9/30 [00:22<00:44,  2.14s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0276, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.8972, 'compress@10': 1.0, 'time@10': 3.1227}:  33%|███▎      | 10/30 [00:22<00:46,  2.34s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 0.029, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 3.0388}:  33%|███▎      | 10/30 [00:23<00:46,  2.34s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 0.029, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 3.0388}:  37%|███▋      | 11/30 [00:23<00:37,  1.97s/it]{'epoch': 30, 'num_users': 6.4167, 'loss': 0.0266, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 3.0111}:  37%|███▋      | 11/30 [00:26<00:37,  1.97s/it]{'epoch': 30, 'num_users': 6.4167, 'loss': 0.0266, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 3.0111}:  40%|████      | 12/30 [00:26<00:39,  2.21s/it]{'epoch': 30, 'num_users': 6.6154, 'loss': 0.027, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.002}:  40%|████      | 12/30 [00:28<00:39,  2.21s/it]  {'epoch': 30, 'num_users': 6.6154, 'loss': 0.027, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.002}:  43%|████▎     | 13/30 [00:28<00:33,  1.99s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 0.0251, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 2.9869}:  43%|████▎     | 13/30 [00:30<00:33,  1.99s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 0.0251, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 2.9869}:  47%|████▋     | 14/30 [00:30<00:35,  2.24s/it]{'epoch': 30, 'num_users': 6.2667, 'loss': 0.0264, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8905, 'compress@10': 1.0, 'time@10': 2.9889}:  47%|████▋     | 14/30 [00:32<00:35,  2.24s/it]{'epoch': 30, 'num_users': 6.2667, 'loss': 0.0264, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8905, 'compress@10': 1.0, 'time@10': 2.9889}:  50%|█████     | 15/30 [00:32<00:30,  2.03s/it]{'epoch': 30, 'num_users': 6.0625, 'loss': 0.0249, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 2.981}:  50%|█████     | 15/30 [00:35<00:30,  2.03s/it] {'epoch': 30, 'num_users': 6.0625, 'loss': 0.0249, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 2.981}:  53%|█████▎    | 16/30 [00:35<00:32,  2.29s/it]{'epoch': 30, 'num_users': 5.8235, 'loss': 0.0234, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8867, 'compress@10': 1.0, 'time@10': 2.9617}:  53%|█████▎    | 16/30 [00:36<00:32,  2.29s/it]{'epoch': 30, 'num_users': 5.8235, 'loss': 0.0234, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8867, 'compress@10': 1.0, 'time@10': 2.9617}:  57%|█████▋    | 17/30 [00:36<00:26,  2.01s/it]{'epoch': 30, 'num_users': 6.0556, 'loss': 0.0236, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8866, 'compress@10': 1.0, 'time@10': 2.9458}:  57%|█████▋    | 17/30 [00:39<00:26,  2.01s/it]{'epoch': 30, 'num_users': 6.0556, 'loss': 0.0236, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8866, 'compress@10': 1.0, 'time@10': 2.9458}:  60%|██████    | 18/30 [00:39<00:26,  2.22s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 0.0227, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8886, 'compress@10': 1.0, 'time@10': 2.9362}:  60%|██████    | 18/30 [00:40<00:26,  2.22s/it]   {'epoch': 30, 'num_users': 6.0, 'loss': 0.0227, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8886, 'compress@10': 1.0, 'time@10': 2.9362}:  63%|██████▎   | 19/30 [00:40<00:21,  1.98s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 0.0231, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 2.9338}:  63%|██████▎   | 19/30 [00:43<00:21,  1.98s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 0.0231, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 2.9338}:  67%|██████▋   | 20/30 [00:43<00:22,  2.27s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0246, 'hit_ratio@10': 0.859, 'ndcg@10': 0.886, 'compress@10': 1.0, 'time@10': 2.9345}:  67%|██████▋   | 20/30 [00:45<00:22,  2.27s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0246, 'hit_ratio@10': 0.859, 'ndcg@10': 0.886, 'compress@10': 1.0, 'time@10': 2.9345}:  70%|███████   | 21/30 [00:45<00:18,  2.04s/it]{'epoch': 30, 'num_users': 6.1818, 'loss': 0.0237, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 2.9293}:  70%|███████   | 21/30 [00:48<00:18,  2.04s/it]{'epoch': 30, 'num_users': 6.1818, 'loss': 0.0237, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 2.9293}:  73%|███████▎  | 22/30 [00:48<00:18,  2.29s/it]{'epoch': 30, 'num_users': 6.1304, 'loss': 0.0234, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8895, 'compress@10': 1.0, 'time@10': 2.9167}:  73%|███████▎  | 22/30 [00:49<00:18,  2.29s/it]{'epoch': 30, 'num_users': 6.1304, 'loss': 0.0234, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8895, 'compress@10': 1.0, 'time@10': 2.9167}:  77%|███████▋  | 23/30 [00:49<00:14,  2.01s/it]{'epoch': 30, 'num_users': 5.9583, 'loss': 0.0224, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8858, 'compress@10': 1.0, 'time@10': 2.9069}:  77%|███████▋  | 23/30 [00:52<00:14,  2.01s/it]{'epoch': 30, 'num_users': 5.9583, 'loss': 0.0224, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8858, 'compress@10': 1.0, 'time@10': 2.9069}:  80%|████████  | 24/30 [00:52<00:13,  2.22s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0215, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 2.892}:  80%|████████  | 24/30 [00:53<00:13,  2.22s/it]     {'epoch': 30, 'num_users': 5.8, 'loss': 0.0215, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 2.892}:  83%|████████▎ | 25/30 [00:53<00:09,  1.95s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 0.0224, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8763, 'compress@10': 1.0, 'time@10': 2.8914}:  83%|████████▎ | 25/30 [00:56<00:09,  1.95s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 0.0224, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8763, 'compress@10': 1.0, 'time@10': 2.8914}:  87%|████████▋ | 26/30 [00:56<00:08,  2.24s/it]{'epoch': 30, 'num_users': 5.8889, 'loss': 0.0223, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 2.8877}:  87%|████████▋ | 26/30 [00:57<00:08,  2.24s/it]{'epoch': 30, 'num_users': 5.8889, 'loss': 0.0223, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 2.8877}:  90%|█████████ | 27/30 [00:57<00:05,  1.99s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 0.0226, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8782, 'compress@10': 1.0, 'time@10': 2.8775}:  90%|█████████ | 27/30 [01:00<00:05,  1.99s/it]   {'epoch': 30, 'num_users': 6.0, 'loss': 0.0226, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8782, 'compress@10': 1.0, 'time@10': 2.8775}:  93%|█████████▎| 28/30 [01:00<00:04,  2.19s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 0.0223, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.8807, 'compress@10': 1.0, 'time@10': 2.8738}:  93%|█████████▎| 28/30 [01:01<00:04,  2.19s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 0.0223, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.8807, 'compress@10': 1.0, 'time@10': 2.8738}:  97%|█████████▋| 29/30 [01:01<00:01,  1.96s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.0224, 'hit_ratio@10': 0.866, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 2.8751}:  97%|█████████▋| 29/30 [01:04<00:01,  1.96s/it] {'epoch': 30, 'num_users': 5.8667, 'loss': 0.0224, 'hit_ratio@10': 0.866, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 2.8751}: 100%|██████████| 30/30 [01:04<00:00,  2.26s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 0.0224, 'hit_ratio@10': 0.866, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 2.8751}: 100%|██████████| 30/30 [01:04<00:00,  2.17s/it]
Epoch: 30
Avg # of users: 5.866666666666666
Avg Loss: 0.02242642245334319
Avg hit ratio: 0.8660194692760796
Avg ndcg: 0.8856298972801923
Avg compression ratio: 0.9999999860153537
Avg train time: 2.8751047690709433
Std train time: 0.658160504815007
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 33, 14, 1, 8, 7, 11, 5, 9, 8, 35, 9, 77, 6, 36, 49, 13, 15, 7, 4, 19, 10, 93, 94, 5, 7, 8, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 2.7512}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 2.7512}:   3%|▎         | 1/30 [00:01<00:41,  1.42s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0402, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9269, 'compress@10': 1.0, 'time@10': 2.7507}:   3%|▎         | 1/30 [00:04<00:41,  1.42s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0402, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9269, 'compress@10': 1.0, 'time@10': 2.7507}:   7%|▋         | 2/30 [00:04<01:02,  2.23s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9036, 'compress@10': 1.0, 'time@10': 2.7094}:   7%|▋         | 2/30 [00:05<01:02,  2.23s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9036, 'compress@10': 1.0, 'time@10': 2.7094}:  10%|█         | 3/30 [00:05<00:49,  1.84s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.9167, 'compress@10': 1.0, 'time@10': 2.7156}:  10%|█         | 3/30 [00:08<00:49,  1.84s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.9167, 'compress@10': 1.0, 'time@10': 2.7156}:  13%|█▎        | 4/30 [00:08<00:57,  2.21s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0593, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 2.3165}:  13%|█▎        | 4/30 [00:08<00:57,  2.21s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0593, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 2.3165}:  17%|█▋        | 5/30 [00:08<00:38,  1.55s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0547, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 2.39}:  17%|█▋        | 5/30 [00:11<00:38,  1.55s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0547, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 2.39}:  20%|██        | 6/30 [00:11<00:47,  1.98s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0506, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 2.4032}:  20%|██        | 6/30 [00:12<00:47,  1.98s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0506, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 2.4032}:  23%|██▎       | 7/30 [00:12<00:40,  1.75s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0478, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 2.4376}:  23%|██▎       | 7/30 [00:15<00:40,  1.75s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0478, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 2.4376}:  27%|██▋       | 8/30 [00:15<00:45,  2.06s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0459, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 2.4496}:  27%|██▋       | 8/30 [00:16<00:45,  2.06s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0459, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 2.4496}:  30%|███       | 9/30 [00:16<00:38,  1.82s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0435, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8882, 'compress@10': 1.0, 'time@10': 2.486}:  30%|███       | 9/30 [00:19<00:38,  1.82s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.0435, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8882, 'compress@10': 1.0, 'time@10': 2.486}:  33%|███▎      | 10/30 [00:19<00:42,  2.14s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 0.0433, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8883, 'compress@10': 1.0, 'time@10': 2.5374}:  33%|███▎      | 10/30 [00:21<00:42,  2.14s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 0.0433, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8883, 'compress@10': 1.0, 'time@10': 2.5374}:  37%|███▋      | 11/30 [00:21<00:37,  1.97s/it]{'epoch': 31, 'num_users': 6.4167, 'loss': 0.0399, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 2.5543}:  37%|███▋      | 11/30 [00:24<00:37,  1.97s/it]{'epoch': 31, 'num_users': 6.4167, 'loss': 0.0399, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 2.5543}:  40%|████      | 12/30 [00:24<00:39,  2.21s/it]{'epoch': 31, 'num_users': 6.6154, 'loss': 0.0395, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8897, 'compress@10': 1.0, 'time@10': 2.5681}:  40%|████      | 12/30 [00:25<00:39,  2.21s/it]{'epoch': 31, 'num_users': 6.6154, 'loss': 0.0395, 'hit_ratio@10': 0.8362, 'ndcg@10': 0.8897, 'compress@10': 1.0, 'time@10': 2.5681}:  43%|████▎     | 13/30 [00:25<00:33,  1.97s/it]{'epoch': 31, 'num_users': 6.3571, 'loss': 0.0366, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 2.5728}:  43%|████▎     | 13/30 [00:28<00:33,  1.97s/it] {'epoch': 31, 'num_users': 6.3571, 'loss': 0.0366, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 2.5728}:  47%|████▋     | 14/30 [00:28<00:34,  2.18s/it]{'epoch': 31, 'num_users': 6.2667, 'loss': 0.0366, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8852, 'compress@10': 1.0, 'time@10': 2.5681}:  47%|████▋     | 14/30 [00:29<00:34,  2.18s/it]{'epoch': 31, 'num_users': 6.2667, 'loss': 0.0366, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8852, 'compress@10': 1.0, 'time@10': 2.5681}:  50%|█████     | 15/30 [00:29<00:28,  1.91s/it]{'epoch': 31, 'num_users': 6.0625, 'loss': 0.0344, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8871, 'compress@10': 1.0, 'time@10': 2.5816}:  50%|█████     | 15/30 [00:32<00:28,  1.91s/it]{'epoch': 31, 'num_users': 6.0625, 'loss': 0.0344, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8871, 'compress@10': 1.0, 'time@10': 2.5816}:  53%|█████▎    | 16/30 [00:32<00:30,  2.19s/it]{'epoch': 31, 'num_users': 5.8235, 'loss': 0.0324, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.882, 'compress@10': 1.0, 'time@10': 2.5973}:  53%|█████▎    | 16/30 [00:33<00:30,  2.19s/it] {'epoch': 31, 'num_users': 5.8235, 'loss': 0.0324, 'hit_ratio@10': 0.8415, 'ndcg@10': 0.882, 'compress@10': 1.0, 'time@10': 2.5973}:  57%|█████▋    | 17/30 [00:33<00:25,  1.97s/it]{'epoch': 31, 'num_users': 6.0556, 'loss': 0.0314, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8845, 'compress@10': 1.0, 'time@10': 2.5993}:  57%|█████▋    | 17/30 [00:36<00:25,  1.97s/it]{'epoch': 31, 'num_users': 6.0556, 'loss': 0.0314, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.8845, 'compress@10': 1.0, 'time@10': 2.5993}:  60%|██████    | 18/30 [00:36<00:26,  2.19s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 0.0302, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8866, 'compress@10': 1.0, 'time@10': 2.612}:  60%|██████    | 18/30 [00:37<00:26,  2.19s/it]    {'epoch': 31, 'num_users': 6.0, 'loss': 0.0302, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8866, 'compress@10': 1.0, 'time@10': 2.612}:  63%|██████▎   | 19/30 [00:37<00:21,  1.97s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 0.0303, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8872, 'compress@10': 1.0, 'time@10': 2.6326}:  63%|██████▎   | 19/30 [00:40<00:21,  1.97s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 0.0303, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8872, 'compress@10': 1.0, 'time@10': 2.6326}:  67%|██████▋   | 20/30 [00:40<00:22,  2.30s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0317, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8837, 'compress@10': 1.0, 'time@10': 2.6214}:  67%|██████▋   | 20/30 [00:42<00:22,  2.30s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0317, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8837, 'compress@10': 1.0, 'time@10': 2.6214}:  70%|███████   | 21/30 [00:42<00:17,  1.98s/it]{'epoch': 31, 'num_users': 6.1818, 'loss': 0.0306, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8864, 'compress@10': 1.0, 'time@10': 2.6288}:  70%|███████   | 21/30 [00:45<00:17,  1.98s/it]{'epoch': 31, 'num_users': 6.1818, 'loss': 0.0306, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8864, 'compress@10': 1.0, 'time@10': 2.6288}:  73%|███████▎  | 22/30 [00:45<00:17,  2.23s/it]{'epoch': 31, 'num_users': 6.1304, 'loss': 0.0299, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 2.6333}:  73%|███████▎  | 22/30 [00:46<00:17,  2.23s/it]{'epoch': 31, 'num_users': 6.1304, 'loss': 0.0299, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 2.6333}:  77%|███████▋  | 23/30 [00:46<00:13,  1.98s/it]{'epoch': 31, 'num_users': 5.9583, 'loss': 0.0287, 'hit_ratio@10': 0.855, 'ndcg@10': 0.884, 'compress@10': 1.0, 'time@10': 2.6313}:  77%|███████▋  | 23/30 [00:49<00:13,  1.98s/it]  {'epoch': 31, 'num_users': 5.9583, 'loss': 0.0287, 'hit_ratio@10': 0.855, 'ndcg@10': 0.884, 'compress@10': 1.0, 'time@10': 2.6313}:  80%|████████  | 24/30 [00:49<00:13,  2.17s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0275, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 2.6317}:  80%|████████  | 24/30 [00:50<00:13,  2.17s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.0275, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 2.6317}:  83%|████████▎ | 25/30 [00:50<00:09,  1.93s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 0.0281, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 2.6432}:  83%|████████▎ | 25/30 [00:53<00:09,  1.93s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 0.0281, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8749, 'compress@10': 1.0, 'time@10': 2.6432}:  87%|████████▋ | 26/30 [00:53<00:08,  2.24s/it]{'epoch': 31, 'num_users': 5.8889, 'loss': 0.0278, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8761, 'compress@10': 1.0, 'time@10': 2.65}:  87%|████████▋ | 26/30 [00:54<00:08,  2.24s/it]  {'epoch': 31, 'num_users': 5.8889, 'loss': 0.0278, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8761, 'compress@10': 1.0, 'time@10': 2.65}:  90%|█████████ | 27/30 [00:54<00:06,  2.00s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 0.028, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 2.6616}:  90%|█████████ | 27/30 [00:57<00:06,  2.00s/it]  {'epoch': 31, 'num_users': 6.0, 'loss': 0.028, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 2.6616}:  93%|█████████▎| 28/30 [00:57<00:04,  2.31s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 0.0275, 'hit_ratio@10': 0.862, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 2.6758}:  93%|█████████▎| 28/30 [00:59<00:04,  2.31s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 0.0275, 'hit_ratio@10': 0.862, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 2.6758}:  97%|█████████▋| 29/30 [00:59<00:02,  2.09s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0291, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.883, 'compress@10': 1.0, 'time@10': 2.6728}:  97%|█████████▋| 29/30 [01:02<00:02,  2.09s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0291, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.883, 'compress@10': 1.0, 'time@10': 2.6728}: 100%|██████████| 30/30 [01:02<00:00,  2.25s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 0.0291, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.883, 'compress@10': 1.0, 'time@10': 2.6728}: 100%|██████████| 30/30 [01:02<00:00,  2.07s/it]
Epoch: 31
Avg # of users: 5.866666666666666
Avg Loss: 0.029128662583887112
Avg hit ratio: 0.8612232218183561
Avg ndcg: 0.8829596295326742
Avg compression ratio: 0.9999999860153537
Avg train time: 2.67281760374705
Std train time: 0.39745872107735625
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 33, 14, 8, 8, 8, 11, 6, 9, 7, 35, 9, 77, 7, 36, 49, 13, 15, 6, 5, 19, 10, 94, 94, 4, 7, 7, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 2.5873}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 2.5873}:   3%|▎         | 1/30 [00:01<00:38,  1.34s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8632, 'compress@10': 1.0, 'time@10': 2.6205}:   3%|▎         | 1/30 [00:04<00:38,  1.34s/it] {'epoch': 32, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8632, 'compress@10': 1.0, 'time@10': 2.6205}:   7%|▋         | 2/30 [00:04<00:59,  2.13s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8612, 'compress@10': 1.0, 'time@10': 2.6367}:   7%|▋         | 2/30 [00:05<00:59,  2.13s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8612, 'compress@10': 1.0, 'time@10': 2.6367}:  10%|█         | 3/30 [00:05<00:48,  1.79s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8867, 'compress@10': 1.0, 'time@10': 2.6561}:  10%|█         | 3/30 [00:08<00:48,  1.79s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8867, 'compress@10': 1.0, 'time@10': 2.6561}:  13%|█▎        | 4/30 [00:08<00:56,  2.17s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 3.2993}:  13%|█▎        | 4/30 [00:11<00:56,  2.17s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0302, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 3.2993}:  17%|█▋        | 5/30 [00:11<01:01,  2.46s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0296, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8768, 'compress@10': 1.0, 'time@10': 3.218}:  17%|█▋        | 5/30 [00:13<01:01,  2.46s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0296, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.8768, 'compress@10': 1.0, 'time@10': 3.218}:  20%|██        | 6/30 [00:13<01:02,  2.59s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 3.1857}:  20%|██        | 6/30 [00:15<01:02,  2.59s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 3.1857}:  23%|██▎       | 7/30 [00:15<00:51,  2.25s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.029, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 3.1214}:  23%|██▎       | 7/30 [00:18<00:51,  2.25s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.029, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 3.1214}:  27%|██▋       | 8/30 [00:18<00:52,  2.39s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.8917, 'compress@10': 1.0, 'time@10': 3.1192}:  27%|██▋       | 8/30 [00:19<00:52,  2.39s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.8917, 'compress@10': 1.0, 'time@10': 3.1192}:  30%|███       | 9/30 [00:19<00:44,  2.14s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0285, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.0858}:  30%|███       | 9/30 [00:22<00:44,  2.14s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0285, 'hit_ratio@10': 0.8901, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.0858}:  33%|███▎      | 10/30 [00:22<00:47,  2.35s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 0.0295, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 3.0445}:  33%|███▎      | 10/30 [00:23<00:47,  2.35s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 0.0295, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 3.0445}:  37%|███▋      | 11/30 [00:23<00:38,  2.05s/it]{'epoch': 32, 'num_users': 6.4167, 'loss': 0.0271, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 3.0094}:  37%|███▋      | 11/30 [00:26<00:38,  2.05s/it]{'epoch': 32, 'num_users': 6.4167, 'loss': 0.0271, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 3.0094}:  40%|████      | 12/30 [00:26<00:40,  2.23s/it]{'epoch': 32, 'num_users': 6.6154, 'loss': 0.0274, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.9903}:  40%|████      | 12/30 [00:28<00:40,  2.23s/it]{'epoch': 32, 'num_users': 6.6154, 'loss': 0.0274, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.9903}:  43%|████▎     | 13/30 [00:28<00:33,  1.99s/it]{'epoch': 32, 'num_users': 6.3571, 'loss': 0.0254, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8923, 'compress@10': 1.0, 'time@10': 2.9802}:  43%|████▎     | 13/30 [00:30<00:33,  1.99s/it]{'epoch': 32, 'num_users': 6.3571, 'loss': 0.0254, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8923, 'compress@10': 1.0, 'time@10': 2.9802}:  47%|████▋     | 14/30 [00:30<00:36,  2.26s/it]{'epoch': 32, 'num_users': 6.2667, 'loss': 0.0263, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8917, 'compress@10': 1.0, 'time@10': 2.9851}:  47%|████▋     | 14/30 [00:32<00:36,  2.26s/it]{'epoch': 32, 'num_users': 6.2667, 'loss': 0.0263, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8917, 'compress@10': 1.0, 'time@10': 2.9851}:  50%|█████     | 15/30 [00:32<00:30,  2.05s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 0.0249, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 2.9807}:  50%|█████     | 15/30 [00:35<00:30,  2.05s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 0.0249, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 2.9807}:  53%|█████▎    | 16/30 [00:35<00:32,  2.32s/it]{'epoch': 32, 'num_users': 5.8235, 'loss': 0.0234, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 2.9761}:  53%|█████▎    | 16/30 [00:36<00:32,  2.32s/it]{'epoch': 32, 'num_users': 5.8235, 'loss': 0.0234, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 2.9761}:  57%|█████▋    | 17/30 [00:36<00:26,  2.08s/it]{'epoch': 32, 'num_users': 6.0556, 'loss': 0.0239, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8879, 'compress@10': 1.0, 'time@10': 2.9589}:  57%|█████▋    | 17/30 [00:39<00:26,  2.08s/it]{'epoch': 32, 'num_users': 6.0556, 'loss': 0.0239, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8879, 'compress@10': 1.0, 'time@10': 2.9589}:  60%|██████    | 18/30 [00:39<00:27,  2.26s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 0.0228, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8898, 'compress@10': 1.0, 'time@10': 2.9652}:  60%|██████    | 18/30 [00:41<00:27,  2.26s/it]   {'epoch': 32, 'num_users': 6.0, 'loss': 0.0228, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.8898, 'compress@10': 1.0, 'time@10': 2.9652}:  63%|██████▎   | 19/30 [00:41<00:22,  2.06s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 0.0231, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 2.9446}:  63%|██████▎   | 19/30 [00:43<00:22,  2.06s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 0.0231, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 2.9446}:  67%|██████▋   | 20/30 [00:43<00:22,  2.22s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0245, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 2.949}:  67%|██████▋   | 20/30 [00:45<00:22,  2.22s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0245, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 2.949}:  70%|███████   | 21/30 [00:45<00:18,  2.02s/it]{'epoch': 32, 'num_users': 6.1818, 'loss': 0.0244, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 2.9421}:  70%|███████   | 21/30 [00:48<00:18,  2.02s/it]{'epoch': 32, 'num_users': 6.1818, 'loss': 0.0244, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 2.9421}:  73%|███████▎  | 22/30 [00:48<00:18,  2.27s/it]{'epoch': 32, 'num_users': 6.1304, 'loss': 0.024, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 2.9331}:  73%|███████▎  | 22/30 [00:49<00:18,  2.27s/it] {'epoch': 32, 'num_users': 6.1304, 'loss': 0.024, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 2.9331}:  77%|███████▋  | 23/30 [00:49<00:14,  2.01s/it]{'epoch': 32, 'num_users': 5.9583, 'loss': 0.023, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 2.92}:  77%|███████▋  | 23/30 [00:52<00:14,  2.01s/it]  {'epoch': 32, 'num_users': 5.9583, 'loss': 0.023, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 2.92}:  80%|████████  | 24/30 [00:52<00:13,  2.21s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0221, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 2.9091}:  80%|████████  | 24/30 [00:53<00:13,  2.21s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0221, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 2.9091}:  83%|████████▎ | 25/30 [00:53<00:09,  1.95s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 0.0229, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 2.8862}:  83%|████████▎ | 25/30 [00:56<00:09,  1.95s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 0.0229, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 2.8862}:  87%|████████▋ | 26/30 [00:56<00:08,  2.07s/it]{'epoch': 32, 'num_users': 5.8889, 'loss': 0.0228, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.879, 'compress@10': 1.0, 'time@10': 2.886}:  87%|████████▋ | 26/30 [00:57<00:08,  2.07s/it]  {'epoch': 32, 'num_users': 5.8889, 'loss': 0.0228, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.879, 'compress@10': 1.0, 'time@10': 2.886}:  90%|█████████ | 27/30 [00:57<00:05,  1.89s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 0.0227, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8804, 'compress@10': 1.0, 'time@10': 2.8761}:  90%|█████████ | 27/30 [01:00<00:05,  1.89s/it] {'epoch': 32, 'num_users': 6.0, 'loss': 0.0227, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8804, 'compress@10': 1.0, 'time@10': 2.8761}:  93%|█████████▎| 28/30 [01:00<00:04,  2.12s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 0.0224, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 2.8699}:  93%|█████████▎| 28/30 [01:01<00:04,  2.12s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 0.0224, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 2.8699}:  97%|█████████▋| 29/30 [01:01<00:01,  1.90s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.022, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 2.872}:  97%|█████████▋| 29/30 [01:04<00:01,  1.90s/it]  {'epoch': 32, 'num_users': 5.8667, 'loss': 0.022, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 2.872}: 100%|██████████| 30/30 [01:04<00:00,  2.22s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 0.022, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 2.872}: 100%|██████████| 30/30 [01:04<00:00,  2.15s/it]
Epoch: 32
Avg # of users: 5.866666666666666
Avg Loss: 0.021994113902253244
Avg hit ratio: 0.8672044389347335
Avg ndcg: 0.8848004986407186
Avg compression ratio: 0.9999999860153537
Avg train time: 2.871961077054342
Std train time: 0.5844962081968205
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 12, 33, 14, 1, 8, 7, 11, 5, 9, 7, 35, 9, 77, 6, 36, 49, 13, 14, 7, 4, 19, 10, 94, 94, 5, 7, 8, 9, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0291, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 2.9865}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0291, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 2.9865}:   3%|▎         | 1/30 [00:01<00:44,  1.53s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.8849, 'compress@10': 1.0, 'time@10': 2.8228}:   3%|▎         | 1/30 [00:04<00:44,  1.53s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.8849, 'compress@10': 1.0, 'time@10': 2.8228}:   7%|▋         | 2/30 [00:04<01:02,  2.22s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8757, 'compress@10': 1.0, 'time@10': 2.8137}:   7%|▋         | 2/30 [00:05<01:02,  2.22s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8757, 'compress@10': 1.0, 'time@10': 2.8137}:  10%|█         | 3/30 [00:05<00:50,  1.86s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 2.8015}:  10%|█         | 3/30 [00:08<00:50,  1.86s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 2.8015}:  13%|█▎        | 4/30 [00:08<00:58,  2.23s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0524, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8295, 'compress@10': 1.0, 'time@10': 2.3827}:  13%|█▎        | 4/30 [00:08<00:58,  2.23s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0524, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.8295, 'compress@10': 1.0, 'time@10': 2.3827}:  17%|█▋        | 5/30 [00:08<00:39,  1.57s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0481, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8427, 'compress@10': 1.0, 'time@10': 2.4124}:  17%|█▋        | 5/30 [00:11<00:39,  1.57s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0481, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.8427, 'compress@10': 1.0, 'time@10': 2.4124}:  20%|██        | 6/30 [00:11<00:46,  1.92s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0456, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8494, 'compress@10': 1.0, 'time@10': 2.414}:  20%|██        | 6/30 [00:12<00:46,  1.92s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0456, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8494, 'compress@10': 1.0, 'time@10': 2.414}:  23%|██▎       | 7/30 [00:12<00:39,  1.70s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0442, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 2.4518}:  23%|██▎       | 7/30 [00:15<00:39,  1.70s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0442, 'hit_ratio@10': 0.8922, 'ndcg@10': 0.8647, 'compress@10': 1.0, 'time@10': 2.4518}:  27%|██▋       | 8/30 [00:15<00:44,  2.04s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0425, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.8739, 'compress@10': 1.0, 'time@10': 2.4817}:  27%|██▋       | 8/30 [00:16<00:44,  2.04s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0425, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.8739, 'compress@10': 1.0, 'time@10': 2.4817}:  30%|███       | 9/30 [00:16<00:38,  1.84s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0405, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 2.5105}:  30%|███       | 9/30 [00:19<00:38,  1.84s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0405, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 2.5105}:  33%|███▎      | 10/30 [00:19<00:42,  2.14s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 0.0404, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 2.5312}:  33%|███▎      | 10/30 [00:21<00:42,  2.14s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 0.0404, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 2.5312}:  37%|███▋      | 11/30 [00:21<00:36,  1.91s/it]{'epoch': 33, 'num_users': 6.4167, 'loss': 0.0373, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8827, 'compress@10': 1.0, 'time@10': 2.548}:  37%|███▋      | 11/30 [00:23<00:36,  1.91s/it]   {'epoch': 33, 'num_users': 6.4167, 'loss': 0.0373, 'hit_ratio@10': 0.85, 'ndcg@10': 0.8827, 'compress@10': 1.0, 'time@10': 2.548}:  40%|████      | 12/30 [00:23<00:39,  2.18s/it]{'epoch': 33, 'num_users': 6.6154, 'loss': 0.037, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8827, 'compress@10': 1.0, 'time@10': 2.5734}:  40%|████      | 12/30 [00:25<00:39,  2.18s/it]{'epoch': 33, 'num_users': 6.6154, 'loss': 0.037, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8827, 'compress@10': 1.0, 'time@10': 2.5734}:  43%|████▎     | 13/30 [00:25<00:33,  1.97s/it]{'epoch': 33, 'num_users': 6.3571, 'loss': 0.0343, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8792, 'compress@10': 1.0, 'time@10': 2.5857}:  43%|████▎     | 13/30 [00:28<00:33,  1.97s/it]{'epoch': 33, 'num_users': 6.3571, 'loss': 0.0343, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8792, 'compress@10': 1.0, 'time@10': 2.5857}:  47%|████▋     | 14/30 [00:28<00:35,  2.21s/it]{'epoch': 33, 'num_users': 6.2667, 'loss': 0.0343, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8794, 'compress@10': 1.0, 'time@10': 2.5891}:  47%|████▋     | 14/30 [00:29<00:35,  2.21s/it]{'epoch': 33, 'num_users': 6.2667, 'loss': 0.0343, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8794, 'compress@10': 1.0, 'time@10': 2.5891}:  50%|█████     | 15/30 [00:29<00:29,  1.96s/it]{'epoch': 33, 'num_users': 6.0625, 'loss': 0.0323, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 2.6078}:  50%|█████     | 15/30 [00:32<00:29,  1.96s/it] {'epoch': 33, 'num_users': 6.0625, 'loss': 0.0323, 'hit_ratio@10': 0.859, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 2.6078}:  53%|█████▎    | 16/30 [00:32<00:31,  2.25s/it]{'epoch': 33, 'num_users': 5.8235, 'loss': 0.0304, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.6203}:  53%|█████▎    | 16/30 [00:33<00:31,  2.25s/it]{'epoch': 33, 'num_users': 5.8235, 'loss': 0.0304, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.6203}:  57%|█████▋    | 17/30 [00:33<00:26,  2.01s/it]{'epoch': 33, 'num_users': 6.0556, 'loss': 0.0313, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 2.6193}:  57%|█████▋    | 17/30 [00:36<00:26,  2.01s/it]{'epoch': 33, 'num_users': 6.0556, 'loss': 0.0313, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 2.6193}:  60%|██████    | 18/30 [00:36<00:26,  2.20s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 0.0302, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8839, 'compress@10': 1.0, 'time@10': 2.6198}:  60%|██████    | 18/30 [00:37<00:26,  2.20s/it]   {'epoch': 33, 'num_users': 6.0, 'loss': 0.0302, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8839, 'compress@10': 1.0, 'time@10': 2.6198}:  63%|██████▎   | 19/30 [00:37<00:21,  1.97s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 0.0301, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 2.6365}:  63%|██████▎   | 19/30 [00:40<00:21,  1.97s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 0.0301, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8848, 'compress@10': 1.0, 'time@10': 2.6365}:  67%|██████▋   | 20/30 [00:40<00:22,  2.27s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8815, 'compress@10': 1.0, 'time@10': 2.6223}:  67%|██████▋   | 20/30 [00:42<00:22,  2.27s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0315, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8815, 'compress@10': 1.0, 'time@10': 2.6223}:  70%|███████   | 21/30 [00:42<00:17,  1.95s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 0.0302, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 2.6266}:  70%|███████   | 21/30 [00:44<00:17,  1.95s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 0.0302, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 2.6266}:  73%|███████▎  | 22/30 [00:44<00:17,  2.19s/it]{'epoch': 33, 'num_users': 6.1304, 'loss': 0.0295, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 2.6354}:  73%|███████▎  | 22/30 [00:46<00:17,  2.19s/it]{'epoch': 33, 'num_users': 6.1304, 'loss': 0.0295, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 2.6354}:  77%|███████▋  | 23/30 [00:46<00:13,  1.97s/it]{'epoch': 33, 'num_users': 5.9583, 'loss': 0.0283, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8822, 'compress@10': 1.0, 'time@10': 2.6363}:  77%|███████▋  | 23/30 [00:49<00:13,  1.97s/it]{'epoch': 33, 'num_users': 5.9583, 'loss': 0.0283, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8822, 'compress@10': 1.0, 'time@10': 2.6363}:  80%|████████  | 24/30 [00:49<00:13,  2.19s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0272, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 2.6361}:  80%|████████  | 24/30 [00:50<00:13,  2.19s/it]   {'epoch': 33, 'num_users': 5.8, 'loss': 0.0272, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 2.6361}:  83%|████████▎ | 25/30 [00:50<00:09,  1.94s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 0.0276, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8739, 'compress@10': 1.0, 'time@10': 2.6464}:  83%|████████▎ | 25/30 [00:53<00:09,  1.94s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 0.0276, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8739, 'compress@10': 1.0, 'time@10': 2.6464}:  87%|████████▋ | 26/30 [00:53<00:08,  2.24s/it]{'epoch': 33, 'num_users': 5.8889, 'loss': 0.0273, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 2.655}:  87%|████████▋ | 26/30 [00:54<00:08,  2.24s/it] {'epoch': 33, 'num_users': 5.8889, 'loss': 0.0273, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 2.655}:  90%|█████████ | 27/30 [00:54<00:06,  2.01s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 0.0275, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.6668}:  90%|█████████ | 27/30 [00:57<00:06,  2.01s/it]  {'epoch': 33, 'num_users': 6.0, 'loss': 0.0275, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.6668}:  93%|█████████▎| 28/30 [00:57<00:04,  2.31s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 0.0267, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8793, 'compress@10': 1.0, 'time@10': 2.6661}:  93%|█████████▎| 28/30 [00:59<00:04,  2.31s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 0.0267, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8793, 'compress@10': 1.0, 'time@10': 2.6661}:  97%|█████████▋| 29/30 [00:59<00:02,  2.03s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0263, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8812, 'compress@10': 1.0, 'time@10': 2.6649}:  97%|█████████▋| 29/30 [01:01<00:02,  2.03s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0263, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8812, 'compress@10': 1.0, 'time@10': 2.6649}: 100%|██████████| 30/30 [01:01<00:00,  2.22s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 0.0263, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.8812, 'compress@10': 1.0, 'time@10': 2.6649}: 100%|██████████| 30/30 [01:01<00:00,  2.06s/it]
Epoch: 33
Avg # of users: 5.866666666666666
Avg Loss: 0.02634088066822792
Avg hit ratio: 0.8710885579557172
Avg ndcg: 0.8812429607089522
Avg compression ratio: 0.9999999860153537
Avg train time: 2.6649022102355957
Std train time: 0.3923159286818
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 33, 14, 8, 9, 8, 11, 5, 9, 7, 35, 9, 77, 6, 36, 49, 14, 14, 6, 5, 19, 10, 94, 94, 5, 7, 7, 9, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.887, 'compress@10': 1.0, 'time@10': 2.5728}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.887, 'compress@10': 1.0, 'time@10': 2.5728}:   3%|▎         | 1/30 [00:01<00:38,  1.33s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9128, 'compress@10': 1.0, 'time@10': 2.7652}:   3%|▎         | 1/30 [00:04<00:38,  1.33s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9128, 'compress@10': 1.0, 'time@10': 2.7652}:   7%|▋         | 2/30 [00:04<01:04,  2.31s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8942, 'compress@10': 1.0, 'time@10': 2.7794}:   7%|▋         | 2/30 [00:05<01:04,  2.31s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8942, 'compress@10': 1.0, 'time@10': 2.7794}:  10%|█         | 3/30 [00:05<00:51,  1.92s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8755, 'compress@10': 1.0, 'time@10': 2.7476}:  10%|█         | 3/30 [00:08<00:51,  1.92s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8755, 'compress@10': 1.0, 'time@10': 2.7476}:  13%|█▎        | 4/30 [00:08<00:57,  2.23s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0277, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8634, 'compress@10': 1.0, 'time@10': 3.3755}:  13%|█▎        | 4/30 [00:11<00:57,  2.23s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0277, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.8634, 'compress@10': 1.0, 'time@10': 3.3755}:  17%|█▋        | 5/30 [00:11<01:02,  2.50s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0279, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8692, 'compress@10': 1.0, 'time@10': 3.2978}:  17%|█▋        | 5/30 [00:14<01:02,  2.50s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0279, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8692, 'compress@10': 1.0, 'time@10': 3.2978}:  20%|██        | 6/30 [00:14<01:03,  2.65s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.028, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 3.2464}:  20%|██        | 6/30 [00:15<01:03,  2.65s/it] {'epoch': 34, 'num_users': 6.2857, 'loss': 0.028, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 3.2464}:  23%|██▎       | 7/30 [00:15<00:52,  2.28s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8845, 'compress@10': 1.0, 'time@10': 3.1665}:  23%|██▎       | 7/30 [00:18<00:52,  2.28s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.8845, 'compress@10': 1.0, 'time@10': 3.1665}:  27%|██▋       | 8/30 [00:18<00:52,  2.39s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8908, 'compress@10': 1.0, 'time@10': 3.1117}:  27%|██▋       | 8/30 [00:19<00:52,  2.39s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.8908, 'compress@10': 1.0, 'time@10': 3.1117}:  30%|███       | 9/30 [00:19<00:43,  2.08s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 3.0891}:  30%|███       | 9/30 [00:22<00:43,  2.08s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0269, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 3.0891}:  33%|███▎      | 10/30 [00:22<00:46,  2.34s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 0.0281, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 3.044}:  33%|███▎      | 10/30 [00:24<00:46,  2.34s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 0.0281, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 3.044}:  37%|███▋      | 11/30 [00:24<00:38,  2.03s/it]{'epoch': 34, 'num_users': 6.4167, 'loss': 0.0259, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.0102}:  37%|███▋      | 11/30 [00:26<00:38,  2.03s/it]{'epoch': 34, 'num_users': 6.4167, 'loss': 0.0259, 'hit_ratio@10': 0.8629, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.0102}:  40%|████      | 12/30 [00:26<00:40,  2.23s/it]{'epoch': 34, 'num_users': 6.6154, 'loss': 0.026, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8959, 'compress@10': 1.0, 'time@10': 3.0041}:  40%|████      | 12/30 [00:28<00:40,  2.23s/it] {'epoch': 34, 'num_users': 6.6154, 'loss': 0.026, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8959, 'compress@10': 1.0, 'time@10': 3.0041}:  43%|████▎     | 13/30 [00:28<00:34,  2.01s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 0.0242, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8914, 'compress@10': 1.0, 'time@10': 2.9798}:  43%|████▎     | 13/30 [00:31<00:34,  2.01s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 0.0242, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8914, 'compress@10': 1.0, 'time@10': 2.9798}:  47%|████▋     | 14/30 [00:31<00:35,  2.22s/it]{'epoch': 34, 'num_users': 6.2667, 'loss': 0.0248, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 2.956}:  47%|████▋     | 14/30 [00:32<00:35,  2.22s/it] {'epoch': 34, 'num_users': 6.2667, 'loss': 0.0248, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 2.956}:  50%|█████     | 15/30 [00:32<00:29,  1.96s/it]{'epoch': 34, 'num_users': 6.0625, 'loss': 0.0234, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 2.9451}:  50%|█████     | 15/30 [00:35<00:29,  1.96s/it]{'epoch': 34, 'num_users': 6.0625, 'loss': 0.0234, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 2.9451}:  53%|█████▎    | 16/30 [00:35<00:31,  2.22s/it]{'epoch': 34, 'num_users': 5.8235, 'loss': 0.022, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8879, 'compress@10': 1.0, 'time@10': 2.9282}:  53%|█████▎    | 16/30 [00:36<00:31,  2.22s/it] {'epoch': 34, 'num_users': 5.8235, 'loss': 0.022, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8879, 'compress@10': 1.0, 'time@10': 2.9282}:  57%|█████▋    | 17/30 [00:36<00:25,  1.96s/it]{'epoch': 34, 'num_users': 6.0556, 'loss': 0.0224, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 2.9183}:  57%|█████▋    | 17/30 [00:39<00:25,  1.96s/it]{'epoch': 34, 'num_users': 6.0556, 'loss': 0.0224, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 2.9183}:  60%|██████    | 18/30 [00:39<00:26,  2.21s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 0.0215, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8927, 'compress@10': 1.0, 'time@10': 2.8964}:  60%|██████    | 18/30 [00:40<00:26,  2.21s/it]   {'epoch': 34, 'num_users': 6.0, 'loss': 0.0215, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.8927, 'compress@10': 1.0, 'time@10': 2.8964}:  63%|██████▎   | 19/30 [00:40<00:21,  1.93s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 0.0218, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 2.8748}:  63%|██████▎   | 19/30 [00:43<00:21,  1.93s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 0.0218, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 2.8748}:  67%|██████▋   | 20/30 [00:43<00:21,  2.11s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8912, 'compress@10': 1.0, 'time@10': 2.8784}:  67%|██████▋   | 20/30 [00:44<00:21,  2.11s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.8912, 'compress@10': 1.0, 'time@10': 2.8784}:  70%|███████   | 21/30 [00:44<00:17,  1.93s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 0.0225, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 2.8725}:  70%|███████   | 21/30 [00:47<00:17,  1.93s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 0.0225, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 2.8725}:  73%|███████▎  | 22/30 [00:47<00:17,  2.19s/it]{'epoch': 34, 'num_users': 6.1304, 'loss': 0.0222, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 2.8674}:  73%|███████▎  | 22/30 [00:48<00:17,  2.19s/it]{'epoch': 34, 'num_users': 6.1304, 'loss': 0.0222, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 2.8674}:  77%|███████▋  | 23/30 [00:48<00:13,  1.95s/it]{'epoch': 34, 'num_users': 5.9583, 'loss': 0.0212, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 2.8627}:  77%|███████▋  | 23/30 [00:51<00:13,  1.95s/it]{'epoch': 34, 'num_users': 5.9583, 'loss': 0.0212, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 2.8627}:  80%|████████  | 24/30 [00:51<00:13,  2.21s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0204, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.882, 'compress@10': 1.0, 'time@10': 2.8529}:  80%|████████  | 24/30 [00:53<00:13,  2.21s/it]    {'epoch': 34, 'num_users': 5.8, 'loss': 0.0204, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.882, 'compress@10': 1.0, 'time@10': 2.8529}:  83%|████████▎ | 25/30 [00:53<00:09,  1.95s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 0.021, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 2.8488}:  83%|████████▎ | 25/30 [00:55<00:09,  1.95s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 0.021, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 2.8488}:  87%|████████▋ | 26/30 [00:55<00:08,  2.20s/it]{'epoch': 34, 'num_users': 5.8889, 'loss': 0.021, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.883, 'compress@10': 1.0, 'time@10': 2.8435}:  87%|████████▋ | 26/30 [00:57<00:08,  2.20s/it] {'epoch': 34, 'num_users': 5.8889, 'loss': 0.021, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.883, 'compress@10': 1.0, 'time@10': 2.8435}:  90%|█████████ | 27/30 [00:57<00:05,  1.96s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 0.0209, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8841, 'compress@10': 1.0, 'time@10': 2.8355}:  90%|█████████ | 27/30 [00:59<00:05,  1.96s/it] {'epoch': 34, 'num_users': 6.0, 'loss': 0.0209, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8841, 'compress@10': 1.0, 'time@10': 2.8355}:  93%|█████████▎| 28/30 [00:59<00:04,  2.17s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 0.0207, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 2.8276}:  93%|█████████▎| 28/30 [01:01<00:04,  2.17s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 0.0207, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 2.8276}:  97%|█████████▋| 29/30 [01:01<00:01,  1.92s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.021, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 2.822}:  97%|█████████▋| 29/30 [01:03<00:01,  1.92s/it]  {'epoch': 34, 'num_users': 5.8667, 'loss': 0.021, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 2.822}: 100%|██████████| 30/30 [01:03<00:00,  2.15s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 0.021, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 2.822}: 100%|██████████| 30/30 [01:03<00:00,  2.13s/it]
Epoch: 34
Avg # of users: 5.866666666666666
Avg Loss: 0.02103453678277101
Avg hit ratio: 0.8736394021604542
Avg ndcg: 0.8853034150017255
Avg compression ratio: 0.9999999860153537
Avg train time: 2.821995162963867
Std train time: 0.5839848055629427
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 11, 33, 14, 1, 9, 7, 12, 5, 9, 8, 35, 8, 77, 6, 36, 49, 14, 15, 7, 4, 19, 10, 94, 94, 5, 7, 7, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0364, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 2.929}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0364, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 2.929}:   3%|▎         | 1/30 [00:01<00:43,  1.50s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 2.7223}:   3%|▎         | 1/30 [00:04<00:43,  1.50s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 2.7223}:   7%|▋         | 2/30 [00:04<00:59,  2.12s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8953, 'compress@10': 1.0, 'time@10': 2.8489}:   7%|▋         | 2/30 [00:05<00:59,  2.12s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8953, 'compress@10': 1.0, 'time@10': 2.8489}:  10%|█         | 3/30 [00:05<00:50,  1.88s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9122, 'compress@10': 1.0, 'time@10': 2.8251}:  10%|█         | 3/30 [00:08<00:50,  1.88s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9122, 'compress@10': 1.0, 'time@10': 2.8251}:  13%|█▎        | 4/30 [00:08<00:58,  2.24s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0508, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 2.4043}:  13%|█▎        | 4/30 [00:08<00:58,  2.24s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0508, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 2.4043}:  17%|█▋        | 5/30 [00:08<00:39,  1.58s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0463, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 2.4924}:  17%|█▋        | 5/30 [00:11<00:39,  1.58s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0463, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8571, 'compress@10': 1.0, 'time@10': 2.4924}:  20%|██        | 6/30 [00:11<00:49,  2.05s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0437, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8612, 'compress@10': 1.0, 'time@10': 2.4951}:  20%|██        | 6/30 [00:13<00:49,  2.05s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0437, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8612, 'compress@10': 1.0, 'time@10': 2.4951}:  23%|██▎       | 7/30 [00:13<00:41,  1.80s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0416, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8585, 'compress@10': 1.0, 'time@10': 2.5506}:  23%|██▎       | 7/30 [00:16<00:41,  1.80s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0416, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8585, 'compress@10': 1.0, 'time@10': 2.5506}:  27%|██▋       | 8/30 [00:16<00:47,  2.18s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0398, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 2.5336}:  27%|██▋       | 8/30 [00:17<00:47,  2.18s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0398, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 2.5336}:  30%|███       | 9/30 [00:17<00:39,  1.88s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0382, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.8747, 'compress@10': 1.0, 'time@10': 2.5573}:  30%|███       | 9/30 [00:20<00:39,  1.88s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0382, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.8747, 'compress@10': 1.0, 'time@10': 2.5573}:  33%|███▎      | 10/30 [00:20<00:43,  2.17s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 0.0385, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8763, 'compress@10': 1.0, 'time@10': 2.6095}:  33%|███▎      | 10/30 [00:21<00:43,  2.17s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 0.0385, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.8763, 'compress@10': 1.0, 'time@10': 2.6095}:  37%|███▋      | 11/30 [00:21<00:37,  2.00s/it]{'epoch': 35, 'num_users': 6.4167, 'loss': 0.0355, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 2.6347}:  37%|███▋      | 11/30 [00:24<00:37,  2.00s/it]{'epoch': 35, 'num_users': 6.4167, 'loss': 0.0355, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.8796, 'compress@10': 1.0, 'time@10': 2.6347}:  40%|████      | 12/30 [00:24<00:41,  2.29s/it]{'epoch': 35, 'num_users': 6.6154, 'loss': 0.0354, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 2.6319}:  40%|████      | 12/30 [00:26<00:41,  2.29s/it]{'epoch': 35, 'num_users': 6.6154, 'loss': 0.0354, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 2.6319}:  43%|████▎     | 13/30 [00:26<00:34,  2.00s/it]{'epoch': 35, 'num_users': 6.3571, 'loss': 0.0329, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8776, 'compress@10': 1.0, 'time@10': 2.6419}:  43%|████▎     | 13/30 [00:28<00:34,  2.00s/it]{'epoch': 35, 'num_users': 6.3571, 'loss': 0.0329, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8776, 'compress@10': 1.0, 'time@10': 2.6419}:  47%|████▋     | 14/30 [00:28<00:35,  2.25s/it]{'epoch': 35, 'num_users': 6.2667, 'loss': 0.033, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8785, 'compress@10': 1.0, 'time@10': 2.6399}:  47%|████▋     | 14/30 [00:30<00:35,  2.25s/it] {'epoch': 35, 'num_users': 6.2667, 'loss': 0.033, 'hit_ratio@10': 0.8387, 'ndcg@10': 0.8785, 'compress@10': 1.0, 'time@10': 2.6399}:  50%|█████     | 15/30 [00:30<00:29,  1.98s/it]{'epoch': 35, 'num_users': 6.0625, 'loss': 0.031, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 2.6552}:  50%|█████     | 15/30 [00:33<00:29,  1.98s/it]{'epoch': 35, 'num_users': 6.0625, 'loss': 0.031, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 2.6552}:  53%|█████▎    | 16/30 [00:33<00:31,  2.26s/it]{'epoch': 35, 'num_users': 5.8235, 'loss': 0.0292, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8762, 'compress@10': 1.0, 'time@10': 2.6539}:  53%|█████▎    | 16/30 [00:34<00:31,  2.26s/it]{'epoch': 35, 'num_users': 5.8235, 'loss': 0.0292, 'hit_ratio@10': 0.8361, 'ndcg@10': 0.8762, 'compress@10': 1.0, 'time@10': 2.6539}:  57%|█████▋    | 17/30 [00:34<00:25,  1.99s/it]{'epoch': 35, 'num_users': 6.0556, 'loss': 0.0291, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8806, 'compress@10': 1.0, 'time@10': 2.6653}:  57%|█████▋    | 17/30 [00:37<00:25,  1.99s/it]{'epoch': 35, 'num_users': 6.0556, 'loss': 0.0291, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8806, 'compress@10': 1.0, 'time@10': 2.6653}:  60%|██████    | 18/30 [00:37<00:27,  2.26s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 0.0279, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 2.6659}:  60%|██████    | 18/30 [00:38<00:27,  2.26s/it]   {'epoch': 35, 'num_users': 6.0, 'loss': 0.0279, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 2.6659}:  63%|██████▎   | 19/30 [00:38<00:21,  2.00s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 0.0278, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 2.6811}:  63%|██████▎   | 19/30 [00:41<00:21,  2.00s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 0.0278, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8843, 'compress@10': 1.0, 'time@10': 2.6811}:  67%|██████▋   | 20/30 [00:41<00:23,  2.30s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0291, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 2.6723}:  67%|██████▋   | 20/30 [00:43<00:23,  2.30s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0291, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 2.6723}:  70%|███████   | 21/30 [00:43<00:18,  2.00s/it]{'epoch': 35, 'num_users': 6.1818, 'loss': 0.0283, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8842, 'compress@10': 1.0, 'time@10': 2.682}:  70%|███████   | 21/30 [00:45<00:18,  2.00s/it] {'epoch': 35, 'num_users': 6.1818, 'loss': 0.0283, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8842, 'compress@10': 1.0, 'time@10': 2.682}:  73%|███████▎  | 22/30 [00:45<00:18,  2.28s/it]{'epoch': 35, 'num_users': 6.1304, 'loss': 0.0277, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 2.6897}:  73%|███████▎  | 22/30 [00:47<00:18,  2.28s/it]{'epoch': 35, 'num_users': 6.1304, 'loss': 0.0277, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 2.6897}:  77%|███████▋  | 23/30 [00:47<00:14,  2.04s/it]{'epoch': 35, 'num_users': 5.9583, 'loss': 0.0265, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 2.6894}:  77%|███████▋  | 23/30 [00:50<00:14,  2.04s/it]{'epoch': 35, 'num_users': 5.9583, 'loss': 0.0265, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 2.6894}:  80%|████████  | 24/30 [00:50<00:13,  2.24s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0255, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8734, 'compress@10': 1.0, 'time@10': 2.6875}:  80%|████████  | 24/30 [00:51<00:13,  2.24s/it]   {'epoch': 35, 'num_users': 5.8, 'loss': 0.0255, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.8734, 'compress@10': 1.0, 'time@10': 2.6875}:  83%|████████▎ | 25/30 [00:51<00:09,  1.98s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 0.0258, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 2.6973}:  83%|████████▎ | 25/30 [00:54<00:09,  1.98s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 0.0258, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 2.6973}:  87%|████████▋ | 26/30 [00:54<00:09,  2.28s/it]{'epoch': 35, 'num_users': 5.8889, 'loss': 0.0256, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8757, 'compress@10': 1.0, 'time@10': 2.7041}:  87%|████████▋ | 26/30 [00:56<00:09,  2.28s/it]{'epoch': 35, 'num_users': 5.8889, 'loss': 0.0256, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8757, 'compress@10': 1.0, 'time@10': 2.7041}:  90%|█████████ | 27/30 [00:56<00:06,  2.04s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 0.0255, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8776, 'compress@10': 1.0, 'time@10': 2.7017}:  90%|█████████ | 27/30 [00:58<00:06,  2.04s/it]   {'epoch': 35, 'num_users': 6.0, 'loss': 0.0255, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8776, 'compress@10': 1.0, 'time@10': 2.7017}:  93%|█████████▎| 28/30 [00:58<00:04,  2.23s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 0.0248, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 2.7088}:  93%|█████████▎| 28/30 [01:00<00:04,  2.23s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 0.0248, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 2.7088}:  97%|█████████▋| 29/30 [01:00<00:02,  2.01s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0245, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8824, 'compress@10': 1.0, 'time@10': 2.7042}:  97%|█████████▋| 29/30 [01:02<00:02,  2.01s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0245, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8824, 'compress@10': 1.0, 'time@10': 2.7042}: 100%|██████████| 30/30 [01:02<00:00,  2.19s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 0.0245, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8824, 'compress@10': 1.0, 'time@10': 2.7042}: 100%|██████████| 30/30 [01:02<00:00,  2.09s/it]
Epoch: 35
Avg # of users: 5.866666666666666
Avg Loss: 0.024480452506850735
Avg hit ratio: 0.8630250604797772
Avg ndcg: 0.88235234426396
Avg compression ratio: 0.9999999860153537
Avg train time: 2.7041515111923218
Std train time: 0.41084892216673635
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 32, 14, 8, 8, 8, 11, 6, 9, 7, 35, 9, 77, 7, 36, 49, 14, 15, 6, 5, 19, 10, 94, 94, 4, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8896, 'compress@10': 1.0, 'time@10': 2.6581}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8896, 'compress@10': 1.0, 'time@10': 2.6581}:   3%|▎         | 1/30 [00:01<00:39,  1.37s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9071, 'compress@10': 1.0, 'time@10': 2.636}:   3%|▎         | 1/30 [00:04<00:39,  1.37s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9071, 'compress@10': 1.0, 'time@10': 2.636}:   7%|▋         | 2/30 [00:04<00:59,  2.12s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8904, 'compress@10': 1.0, 'time@10': 2.63}:   7%|▋         | 2/30 [00:05<00:59,  2.12s/it]  {'epoch': 36, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8904, 'compress@10': 1.0, 'time@10': 2.63}:  10%|█         | 3/30 [00:05<00:47,  1.77s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 2.7019}:  10%|█         | 3/30 [00:08<00:47,  1.77s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 2.7019}:  13%|█▎        | 4/30 [00:08<00:58,  2.24s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0241, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 3.416}:  13%|█▎        | 4/30 [00:11<00:58,  2.24s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 0.0241, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 3.416}:  17%|█▋        | 5/30 [00:11<01:04,  2.58s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9037, 'compress@10': 1.0, 'time@10': 3.2886}:  17%|█▋        | 5/30 [00:14<01:04,  2.58s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.9037, 'compress@10': 1.0, 'time@10': 3.2886}:  20%|██        | 6/30 [00:14<01:02,  2.62s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 3.226}:  20%|██        | 6/30 [00:15<01:02,  2.62s/it]  {'epoch': 36, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 3.226}:  23%|██▎       | 7/30 [00:15<00:51,  2.24s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0235, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 3.1535}:  23%|██▎       | 7/30 [00:18<00:51,  2.24s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0235, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 3.1535}:  27%|██▋       | 8/30 [00:18<00:52,  2.39s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9121, 'compress@10': 1.0, 'time@10': 3.1323}:  27%|██▋       | 8/30 [00:19<00:52,  2.39s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9121, 'compress@10': 1.0, 'time@10': 3.1323}:  30%|███       | 9/30 [00:19<00:44,  2.12s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9149, 'compress@10': 1.0, 'time@10': 3.0943}:  30%|███       | 9/30 [00:22<00:44,  2.12s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9149, 'compress@10': 1.0, 'time@10': 3.0943}:  33%|███▎      | 10/30 [00:22<00:46,  2.32s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 0.0245, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9128, 'compress@10': 1.0, 'time@10': 3.0539}:  33%|███▎      | 10/30 [00:24<00:46,  2.32s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 0.0245, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9128, 'compress@10': 1.0, 'time@10': 3.0539}:  37%|███▋      | 11/30 [00:24<00:38,  2.03s/it]{'epoch': 36, 'num_users': 6.4167, 'loss': 0.0226, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.9131, 'compress@10': 1.0, 'time@10': 3.0432}:  37%|███▋      | 11/30 [00:26<00:38,  2.03s/it]{'epoch': 36, 'num_users': 6.4167, 'loss': 0.0226, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.9131, 'compress@10': 1.0, 'time@10': 3.0432}:  40%|████      | 12/30 [00:26<00:41,  2.31s/it]{'epoch': 36, 'num_users': 6.6154, 'loss': 0.0233, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9113, 'compress@10': 1.0, 'time@10': 3.03}:  40%|████      | 12/30 [00:28<00:41,  2.31s/it]  {'epoch': 36, 'num_users': 6.6154, 'loss': 0.0233, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9113, 'compress@10': 1.0, 'time@10': 3.03}:  43%|████▎     | 13/30 [00:28<00:35,  2.06s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 0.0217, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.9057, 'compress@10': 1.0, 'time@10': 3.0121}:  43%|████▎     | 13/30 [00:31<00:35,  2.06s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 0.0217, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.9057, 'compress@10': 1.0, 'time@10': 3.0121}:  47%|████▋     | 14/30 [00:31<00:36,  2.29s/it]{'epoch': 36, 'num_users': 6.2667, 'loss': 0.0238, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.9086, 'compress@10': 1.0, 'time@10': 3.0251}:  47%|████▋     | 14/30 [00:32<00:36,  2.29s/it]{'epoch': 36, 'num_users': 6.2667, 'loss': 0.0238, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.9086, 'compress@10': 1.0, 'time@10': 3.0251}:  50%|█████     | 15/30 [00:32<00:31,  2.09s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 0.0225, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 3.0162}:  50%|█████     | 15/30 [00:35<00:31,  2.09s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 0.0225, 'hit_ratio@10': 0.8425, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 3.0162}:  53%|█████▎    | 16/30 [00:35<00:32,  2.34s/it]{'epoch': 36, 'num_users': 5.8235, 'loss': 0.0212, 'hit_ratio@10': 0.84, 'ndcg@10': 0.9027, 'compress@10': 1.0, 'time@10': 2.9974}:  53%|█████▎    | 16/30 [00:37<00:32,  2.34s/it]  {'epoch': 36, 'num_users': 5.8235, 'loss': 0.0212, 'hit_ratio@10': 0.84, 'ndcg@10': 0.9027, 'compress@10': 1.0, 'time@10': 2.9974}:  57%|█████▋    | 17/30 [00:37<00:26,  2.06s/it]{'epoch': 36, 'num_users': 6.0556, 'loss': 0.0215, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.9082, 'compress@10': 1.0, 'time@10': 2.9902}:  57%|█████▋    | 17/30 [00:40<00:26,  2.06s/it]{'epoch': 36, 'num_users': 6.0556, 'loss': 0.0215, 'hit_ratio@10': 0.8469, 'ndcg@10': 0.9082, 'compress@10': 1.0, 'time@10': 2.9902}:  60%|██████    | 18/30 [00:40<00:27,  2.31s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 0.0206, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 2.9824}:  60%|██████    | 18/30 [00:41<00:27,  2.31s/it]   {'epoch': 36, 'num_users': 6.0, 'loss': 0.0206, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 2.9824}:  63%|██████▎   | 19/30 [00:41<00:22,  2.06s/it]{'epoch': 36, 'num_users': 6.15, 'loss': 0.0209, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9094, 'compress@10': 1.0, 'time@10': 2.9608}:  63%|██████▎   | 19/30 [00:44<00:22,  2.06s/it]{'epoch': 36, 'num_users': 6.15, 'loss': 0.0209, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9094, 'compress@10': 1.0, 'time@10': 2.9608}:  67%|██████▋   | 20/30 [00:44<00:22,  2.22s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.855, 'ndcg@10': 0.907, 'compress@10': 1.0, 'time@10': 2.9641}:  67%|██████▋   | 20/30 [00:45<00:22,  2.22s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.855, 'ndcg@10': 0.907, 'compress@10': 1.0, 'time@10': 2.9641}:  70%|███████   | 21/30 [00:45<00:18,  2.02s/it]{'epoch': 36, 'num_users': 6.1818, 'loss': 0.0219, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 2.9611}:  70%|███████   | 21/30 [00:48<00:18,  2.02s/it]{'epoch': 36, 'num_users': 6.1818, 'loss': 0.0219, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 2.9611}:  73%|███████▎  | 22/30 [00:48<00:18,  2.29s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 0.0216, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.9111, 'compress@10': 1.0, 'time@10': 2.9498}:  73%|███████▎  | 22/30 [00:50<00:18,  2.29s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 0.0216, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.9111, 'compress@10': 1.0, 'time@10': 2.9498}:  77%|███████▋  | 23/30 [00:50<00:14,  2.02s/it]{'epoch': 36, 'num_users': 5.9583, 'loss': 0.0207, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.9064, 'compress@10': 1.0, 'time@10': 2.9348}:  77%|███████▋  | 23/30 [00:52<00:14,  2.02s/it]{'epoch': 36, 'num_users': 5.9583, 'loss': 0.0207, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.9064, 'compress@10': 1.0, 'time@10': 2.9348}:  80%|████████  | 24/30 [00:52<00:13,  2.20s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0198, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 2.9223}:  80%|████████  | 24/30 [00:54<00:13,  2.20s/it]    {'epoch': 36, 'num_users': 5.8, 'loss': 0.0198, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 2.9223}:  83%|████████▎ | 25/30 [00:54<00:09,  1.95s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 0.0205, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 2.9022}:  83%|████████▎ | 25/30 [00:56<00:09,  1.95s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 0.0205, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 2.9022}:  87%|████████▋ | 26/30 [00:56<00:08,  2.10s/it]{'epoch': 36, 'num_users': 5.8889, 'loss': 0.0204, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 2.8962}:  87%|████████▋ | 26/30 [00:57<00:08,  2.10s/it]{'epoch': 36, 'num_users': 5.8889, 'loss': 0.0204, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 2.8962}:  90%|█████████ | 27/30 [00:57<00:05,  1.89s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 0.0208, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.8881}:  90%|█████████ | 27/30 [01:00<00:05,  1.89s/it]  {'epoch': 36, 'num_users': 6.0, 'loss': 0.0208, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.8881}:  93%|█████████▎| 28/30 [01:00<00:04,  2.14s/it]{'epoch': 36, 'num_users': 5.8621, 'loss': 0.0211, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.9024, 'compress@10': 1.0, 'time@10': 2.8884}:  93%|█████████▎| 28/30 [01:02<00:04,  2.14s/it]{'epoch': 36, 'num_users': 5.8621, 'loss': 0.0211, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.9024, 'compress@10': 1.0, 'time@10': 2.8884}:  97%|█████████▋| 29/30 [01:02<00:01,  1.94s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0213, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 2.8872}:  97%|█████████▋| 29/30 [01:05<00:01,  1.94s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0213, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 2.8872}: 100%|██████████| 30/30 [01:05<00:00,  2.23s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 0.0213, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 2.8872}: 100%|██████████| 30/30 [01:05<00:00,  2.17s/it]
Epoch: 36
Avg # of users: 5.866666666666666
Avg Loss: 0.021252517233747086
Avg hit ratio: 0.8627837481871532
Avg ndcg: 0.9019045385307956
Avg compression ratio: 0.9999999860153537
Avg train time: 2.8871774355570476
Std train time: 0.6492445187907325
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 32, 14, 1, 8, 8, 11, 5, 9, 7, 34, 9, 77, 6, 36, 49, 14, 15, 7, 4, 19, 10, 95, 94, 5, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 2.8234}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 2.8234}:   3%|▎         | 1/30 [00:01<00:42,  1.45s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0324, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 2.8138}:   3%|▎         | 1/30 [00:04<00:42,  1.45s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0324, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 2.8138}:   7%|▋         | 2/30 [00:04<01:03,  2.27s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 2.805}:   7%|▋         | 2/30 [00:05<01:03,  2.27s/it]   {'epoch': 37, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 2.805}:  10%|█         | 3/30 [00:05<00:50,  1.89s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9385, 'compress@10': 1.0, 'time@10': 2.8465}:  10%|█         | 3/30 [00:08<00:50,  1.89s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9385, 'compress@10': 1.0, 'time@10': 2.8465}:  13%|█▎        | 4/30 [00:08<01:00,  2.33s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0537, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8703, 'compress@10': 1.0, 'time@10': 2.4613}:  13%|█▎        | 4/30 [00:09<01:00,  2.33s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0537, 'hit_ratio@10': 0.8416, 'ndcg@10': 0.8703, 'compress@10': 1.0, 'time@10': 2.4613}:  17%|█▋        | 5/30 [00:09<00:41,  1.67s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 2.508}:  17%|█▋        | 5/30 [00:12<00:41,  1.67s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 2.508}:  20%|██        | 6/30 [00:12<00:49,  2.05s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0473, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8712, 'compress@10': 1.0, 'time@10': 2.5464}:  20%|██        | 6/30 [00:13<00:49,  2.05s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0473, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8712, 'compress@10': 1.0, 'time@10': 2.5464}:  23%|██▎       | 7/30 [00:13<00:42,  1.84s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0489, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 2.5675}:  23%|██▎       | 7/30 [00:16<00:42,  1.84s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0489, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 2.5675}:  27%|██▋       | 8/30 [00:16<00:46,  2.13s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0465, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 2.5515}:  27%|██▋       | 8/30 [00:17<00:46,  2.13s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0465, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 2.5515}:  30%|███       | 9/30 [00:17<00:39,  1.86s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0439, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9015, 'compress@10': 1.0, 'time@10': 2.5626}:  30%|███       | 9/30 [00:20<00:39,  1.86s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0439, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9015, 'compress@10': 1.0, 'time@10': 2.5626}:  33%|███▎      | 10/30 [00:20<00:42,  2.12s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 0.0431, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9009, 'compress@10': 1.0, 'time@10': 2.5868}:  33%|███▎      | 10/30 [00:21<00:42,  2.12s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 0.0431, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9009, 'compress@10': 1.0, 'time@10': 2.5868}:  37%|███▋      | 11/30 [00:21<00:36,  1.92s/it]{'epoch': 37, 'num_users': 6.4167, 'loss': 0.0396, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9022, 'compress@10': 1.0, 'time@10': 2.6013}:  37%|███▋      | 11/30 [00:24<00:36,  1.92s/it]{'epoch': 37, 'num_users': 6.4167, 'loss': 0.0396, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9022, 'compress@10': 1.0, 'time@10': 2.6013}:  40%|████      | 12/30 [00:24<00:39,  2.19s/it]{'epoch': 37, 'num_users': 6.6154, 'loss': 0.0384, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 2.6272}:  40%|████      | 12/30 [00:25<00:39,  2.19s/it]{'epoch': 37, 'num_users': 6.6154, 'loss': 0.0384, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 2.6272}:  43%|████▎     | 13/30 [00:25<00:33,  1.98s/it]{'epoch': 37, 'num_users': 6.3571, 'loss': 0.0357, 'hit_ratio@10': 0.855, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 2.6454}:  43%|████▎     | 13/30 [00:28<00:33,  1.98s/it]  {'epoch': 37, 'num_users': 6.3571, 'loss': 0.0357, 'hit_ratio@10': 0.855, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 2.6454}:  47%|████▋     | 14/30 [00:28<00:36,  2.26s/it]{'epoch': 37, 'num_users': 6.2667, 'loss': 0.0355, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 2.6551}:  47%|████▋     | 14/30 [00:30<00:36,  2.26s/it]{'epoch': 37, 'num_users': 6.2667, 'loss': 0.0355, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 2.6551}:  50%|█████     | 15/30 [00:30<00:30,  2.01s/it]{'epoch': 37, 'num_users': 6.0625, 'loss': 0.0334, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 2.6677}:  50%|█████     | 15/30 [00:33<00:30,  2.01s/it]{'epoch': 37, 'num_users': 6.0625, 'loss': 0.0334, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 2.6677}:  53%|█████▎    | 16/30 [00:33<00:31,  2.29s/it]{'epoch': 37, 'num_users': 5.8235, 'loss': 0.0315, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8914, 'compress@10': 1.0, 'time@10': 2.6712}:  53%|█████▎    | 16/30 [00:34<00:31,  2.29s/it]{'epoch': 37, 'num_users': 5.8235, 'loss': 0.0315, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.8914, 'compress@10': 1.0, 'time@10': 2.6712}:  57%|█████▋    | 17/30 [00:34<00:26,  2.02s/it]{'epoch': 37, 'num_users': 6.0556, 'loss': 0.0312, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 2.687}:  57%|█████▋    | 17/30 [00:37<00:26,  2.02s/it] {'epoch': 37, 'num_users': 6.0556, 'loss': 0.0312, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 2.687}:  60%|██████    | 18/30 [00:37<00:27,  2.31s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 0.0298, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 2.6916}:  60%|██████    | 18/30 [00:39<00:27,  2.31s/it]  {'epoch': 37, 'num_users': 6.0, 'loss': 0.0298, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 2.6916}:  63%|██████▎   | 19/30 [00:39<00:22,  2.05s/it]{'epoch': 37, 'num_users': 6.15, 'loss': 0.0296, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 2.6991}:  63%|██████▎   | 19/30 [00:41<00:22,  2.05s/it]{'epoch': 37, 'num_users': 6.15, 'loss': 0.0296, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 2.6991}:  67%|██████▋   | 20/30 [00:41<00:22,  2.30s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0309, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 2.6887}:  67%|██████▋   | 20/30 [00:43<00:22,  2.30s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0309, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 2.6887}:  70%|███████   | 21/30 [00:43<00:17,  1.99s/it]{'epoch': 37, 'num_users': 6.1818, 'loss': 0.0298, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 2.6919}:  70%|███████   | 21/30 [00:45<00:17,  1.99s/it]{'epoch': 37, 'num_users': 6.1818, 'loss': 0.0298, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 2.6919}:  73%|███████▎  | 22/30 [00:45<00:17,  2.23s/it]{'epoch': 37, 'num_users': 6.1304, 'loss': 0.0291, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 2.6995}:  73%|███████▎  | 22/30 [00:47<00:17,  2.23s/it]{'epoch': 37, 'num_users': 6.1304, 'loss': 0.0291, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 2.6995}:  77%|███████▋  | 23/30 [00:47<00:14,  2.00s/it]{'epoch': 37, 'num_users': 5.9583, 'loss': 0.0279, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 2.7046}:  77%|███████▋  | 23/30 [00:50<00:14,  2.00s/it]{'epoch': 37, 'num_users': 5.9583, 'loss': 0.0279, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 2.7046}:  80%|████████  | 24/30 [00:50<00:13,  2.26s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0268, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8865, 'compress@10': 1.0, 'time@10': 2.7063}:  80%|████████  | 24/30 [00:51<00:13,  2.26s/it]   {'epoch': 37, 'num_users': 5.8, 'loss': 0.0268, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8865, 'compress@10': 1.0, 'time@10': 2.7063}:  83%|████████▎ | 25/30 [00:51<00:10,  2.01s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 0.027, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8871, 'compress@10': 1.0, 'time@10': 2.7136}:  83%|████████▎ | 25/30 [00:54<00:10,  2.01s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 0.027, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.8871, 'compress@10': 1.0, 'time@10': 2.7136}:  87%|████████▋ | 26/30 [00:54<00:09,  2.29s/it]{'epoch': 37, 'num_users': 5.8889, 'loss': 0.0266, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 2.7158}:  87%|████████▋ | 26/30 [00:56<00:09,  2.29s/it]{'epoch': 37, 'num_users': 5.8889, 'loss': 0.0266, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 2.7158}:  90%|█████████ | 27/30 [00:56<00:06,  2.03s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 0.0265, 'hit_ratio@10': 0.869, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 2.7117}:  90%|█████████ | 27/30 [00:58<00:06,  2.03s/it]      {'epoch': 37, 'num_users': 6.0, 'loss': 0.0265, 'hit_ratio@10': 0.869, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 2.7117}:  93%|█████████▎| 28/30 [00:58<00:04,  2.21s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 0.0259, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8923, 'compress@10': 1.0, 'time@10': 2.7276}:  93%|█████████▎| 28/30 [01:00<00:04,  2.21s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 0.0259, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8923, 'compress@10': 1.0, 'time@10': 2.7276}:  97%|█████████▋| 29/30 [01:00<00:02,  2.03s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0253, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 2.7314}:  97%|█████████▋| 29/30 [01:03<00:02,  2.03s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0253, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 2.7314}: 100%|██████████| 30/30 [01:03<00:00,  2.29s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 0.0253, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 2.7314}: 100%|██████████| 30/30 [01:03<00:00,  2.11s/it]
Epoch: 37
Avg # of users: 5.866666666666666
Avg Loss: 0.02527237094224999
Avg hit ratio: 0.8717083855635744
Avg ndcg: 0.8944557636785675
Avg compression ratio: 0.9999999860153537
Avg train time: 2.7313629468282064
Std train time: 0.36318714759620707
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 32, 13, 7, 8, 8, 11, 6, 9, 7, 34, 8, 77, 6, 36, 49, 13, 15, 7, 5, 19, 10, 95, 94, 5, 7, 8, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 2.6403}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 2.6403}:   3%|▎         | 1/30 [00:01<00:39,  1.36s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.899, 'ndcg@10': 1.0162, 'compress@10': 1.0, 'time@10': 2.7281}:   3%|▎         | 1/30 [00:04<00:39,  1.36s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.899, 'ndcg@10': 1.0162, 'compress@10': 1.0, 'time@10': 2.7281}:   7%|▋         | 2/30 [00:04<01:02,  2.24s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9632, 'compress@10': 1.0, 'time@10': 2.6978}:   7%|▋         | 2/30 [00:05<01:02,  2.24s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.9632, 'compress@10': 1.0, 'time@10': 2.6978}:  10%|█         | 3/30 [00:05<00:49,  1.83s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9888, 'compress@10': 1.0, 'time@10': 2.675}:  10%|█         | 3/30 [00:08<00:49,  1.83s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9888, 'compress@10': 1.0, 'time@10': 2.675}:  13%|█▎        | 4/30 [00:08<00:55,  2.15s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9571, 'compress@10': 1.0, 'time@10': 3.192}:  13%|█▎        | 4/30 [00:10<00:55,  2.15s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9571, 'compress@10': 1.0, 'time@10': 3.192}:  17%|█▋        | 5/30 [00:10<00:58,  2.36s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 3.0952}:  17%|█▋        | 5/30 [00:13<00:58,  2.36s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 3.0952}:  20%|██        | 6/30 [00:13<00:58,  2.46s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0295, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9372, 'compress@10': 1.0, 'time@10': 3.0638}:  20%|██        | 6/30 [00:15<00:58,  2.46s/it] {'epoch': 38, 'num_users': 6.2857, 'loss': 0.0295, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9372, 'compress@10': 1.0, 'time@10': 3.0638}:  23%|██▎       | 7/30 [00:15<00:49,  2.14s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0283, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9329, 'compress@10': 1.0, 'time@10': 3.0123}:  23%|██▎       | 7/30 [00:17<00:49,  2.14s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0283, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9329, 'compress@10': 1.0, 'time@10': 3.0123}:  27%|██▋       | 8/30 [00:17<00:50,  2.31s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9324, 'compress@10': 1.0, 'time@10': 3.0092}:  27%|██▋       | 8/30 [00:19<00:50,  2.31s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9324, 'compress@10': 1.0, 'time@10': 3.0092}:  30%|███       | 9/30 [00:19<00:43,  2.07s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0271, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9316, 'compress@10': 1.0, 'time@10': 2.9918}:  30%|███       | 9/30 [00:22<00:43,  2.07s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0271, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9316, 'compress@10': 1.0, 'time@10': 2.9918}:  33%|███▎      | 10/30 [00:22<00:46,  2.32s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 0.0279, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9284, 'compress@10': 1.0, 'time@10': 2.9935}:  33%|███▎      | 10/30 [00:23<00:46,  2.32s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 0.0279, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9284, 'compress@10': 1.0, 'time@10': 2.9935}:  37%|███▋      | 11/30 [00:23<00:39,  2.08s/it]{'epoch': 38, 'num_users': 6.4167, 'loss': 0.0257, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9274, 'compress@10': 1.0, 'time@10': 2.9793}:  37%|███▋      | 11/30 [00:26<00:39,  2.08s/it]{'epoch': 38, 'num_users': 6.4167, 'loss': 0.0257, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9274, 'compress@10': 1.0, 'time@10': 2.9793}:  40%|████      | 12/30 [00:26<00:41,  2.32s/it]{'epoch': 38, 'num_users': 6.6154, 'loss': 0.0261, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9254, 'compress@10': 1.0, 'time@10': 2.9801}:  40%|████      | 12/30 [00:28<00:41,  2.32s/it]{'epoch': 38, 'num_users': 6.6154, 'loss': 0.0261, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9254, 'compress@10': 1.0, 'time@10': 2.9801}:  43%|████▎     | 13/30 [00:28<00:35,  2.08s/it]{'epoch': 38, 'num_users': 6.3571, 'loss': 0.0242, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 2.9649}:  43%|████▎     | 13/30 [00:30<00:35,  2.08s/it]{'epoch': 38, 'num_users': 6.3571, 'loss': 0.0242, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 2.9649}:  47%|████▋     | 14/30 [00:30<00:36,  2.30s/it]{'epoch': 38, 'num_users': 6.2667, 'loss': 0.0247, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.917, 'compress@10': 1.0, 'time@10': 2.9433}:  47%|████▋     | 14/30 [00:32<00:36,  2.30s/it] {'epoch': 38, 'num_users': 6.2667, 'loss': 0.0247, 'hit_ratio@10': 0.8554, 'ndcg@10': 0.917, 'compress@10': 1.0, 'time@10': 2.9433}:  50%|█████     | 15/30 [00:32<00:30,  2.02s/it]{'epoch': 38, 'num_users': 6.0625, 'loss': 0.0232, 'hit_ratio@10': 0.854, 'ndcg@10': 0.9169, 'compress@10': 1.0, 'time@10': 2.9355}:  50%|█████     | 15/30 [00:35<00:30,  2.02s/it]{'epoch': 38, 'num_users': 6.0625, 'loss': 0.0232, 'hit_ratio@10': 0.854, 'ndcg@10': 0.9169, 'compress@10': 1.0, 'time@10': 2.9355}:  53%|█████▎    | 16/30 [00:35<00:31,  2.27s/it]{'epoch': 38, 'num_users': 5.8235, 'loss': 0.0219, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.9101, 'compress@10': 1.0, 'time@10': 2.9256}:  53%|█████▎    | 16/30 [00:36<00:31,  2.27s/it]{'epoch': 38, 'num_users': 5.8235, 'loss': 0.0219, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.9101, 'compress@10': 1.0, 'time@10': 2.9256}:  57%|█████▋    | 17/30 [00:36<00:26,  2.01s/it]{'epoch': 38, 'num_users': 6.0556, 'loss': 0.022, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.9108, 'compress@10': 1.0, 'time@10': 2.9125}:  57%|█████▋    | 17/30 [00:39<00:26,  2.01s/it] {'epoch': 38, 'num_users': 6.0556, 'loss': 0.022, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.9108, 'compress@10': 1.0, 'time@10': 2.9125}:  60%|██████    | 18/30 [00:39<00:26,  2.23s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 0.0211, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.9117, 'compress@10': 1.0, 'time@10': 2.9023}:  60%|██████    | 18/30 [00:40<00:26,  2.23s/it]  {'epoch': 38, 'num_users': 6.0, 'loss': 0.0211, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.9117, 'compress@10': 1.0, 'time@10': 2.9023}:  63%|██████▎   | 19/30 [00:40<00:21,  1.98s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 0.0214, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.9118, 'compress@10': 1.0, 'time@10': 2.9033}:  63%|██████▎   | 19/30 [00:43<00:21,  1.98s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 0.0214, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.9118, 'compress@10': 1.0, 'time@10': 2.9033}:  67%|██████▋   | 20/30 [00:43<00:22,  2.28s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 2.915}:  67%|██████▋   | 20/30 [00:45<00:22,  2.28s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 2.915}:  70%|███████   | 21/30 [00:45<00:18,  2.08s/it]{'epoch': 38, 'num_users': 6.1818, 'loss': 0.022, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.9109, 'compress@10': 1.0, 'time@10': 2.9128}:  70%|███████   | 21/30 [00:48<00:18,  2.08s/it]{'epoch': 38, 'num_users': 6.1818, 'loss': 0.022, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.9109, 'compress@10': 1.0, 'time@10': 2.9128}:  73%|███████▎  | 22/30 [00:48<00:18,  2.32s/it]{'epoch': 38, 'num_users': 6.1304, 'loss': 0.0217, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9114, 'compress@10': 1.0, 'time@10': 2.9066}:  73%|███████▎  | 22/30 [00:49<00:18,  2.32s/it]{'epoch': 38, 'num_users': 6.1304, 'loss': 0.0217, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9114, 'compress@10': 1.0, 'time@10': 2.9066}:  77%|███████▋  | 23/30 [00:49<00:14,  2.06s/it]{'epoch': 38, 'num_users': 5.9583, 'loss': 0.0208, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 2.8988}:  77%|███████▋  | 23/30 [00:52<00:14,  2.06s/it]{'epoch': 38, 'num_users': 5.9583, 'loss': 0.0208, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 2.8988}:  80%|████████  | 24/30 [00:52<00:13,  2.27s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 2.8963}:  80%|████████  | 24/30 [00:53<00:13,  2.27s/it]   {'epoch': 38, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 2.8963}:  83%|████████▎ | 25/30 [00:53<00:10,  2.03s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 0.0203, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 2.9019}:  83%|████████▎ | 25/30 [00:57<00:10,  2.03s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 0.0203, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 2.9019}:  87%|████████▋ | 26/30 [00:57<00:09,  2.42s/it]{'epoch': 38, 'num_users': 5.8889, 'loss': 0.0201, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8992, 'compress@10': 1.0, 'time@10': 2.9031}:  87%|████████▋ | 26/30 [00:58<00:09,  2.42s/it]{'epoch': 38, 'num_users': 5.8889, 'loss': 0.0201, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8992, 'compress@10': 1.0, 'time@10': 2.9031}:  90%|█████████ | 27/30 [00:58<00:06,  2.14s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 0.0205, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.9004, 'compress@10': 1.0, 'time@10': 2.9066}:  90%|█████████ | 27/30 [01:01<00:06,  2.14s/it]   {'epoch': 38, 'num_users': 6.0, 'loss': 0.0205, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.9004, 'compress@10': 1.0, 'time@10': 2.9066}:  93%|█████████▎| 28/30 [01:01<00:04,  2.41s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 0.0202, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 2.8968}:  93%|█████████▎| 28/30 [01:03<00:04,  2.41s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 0.0202, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 2.8968}:  97%|█████████▋| 29/30 [01:03<00:02,  2.09s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0203, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 2.895}:  97%|█████████▋| 29/30 [01:05<00:02,  2.09s/it]  {'epoch': 38, 'num_users': 5.8667, 'loss': 0.0203, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 2.895}: 100%|██████████| 30/30 [01:05<00:00,  2.33s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 0.0203, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 2.895}: 100%|██████████| 30/30 [01:05<00:00,  2.20s/it]
Epoch: 38
Avg # of users: 5.866666666666666
Avg Loss: 0.020295774996457162
Avg hit ratio: 0.8652216814063635
Avg ndcg: 0.9029827989273641
Avg compression ratio: 0.9999999860153537
Avg train time: 2.894951812426249
Std train time: 0.4617401258283231
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 32, 14, 1, 9, 8, 11, 5, 9, 6, 34, 7, 77, 6, 36, 49, 13, 15, 7, 4, 19, 10, 95, 94, 4, 6, 7, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9023, 'compress@10': 1.0, 'time@10': 2.6598}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9023, 'compress@10': 1.0, 'time@10': 2.6598}:   3%|▎         | 1/30 [00:01<00:39,  1.37s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9323, 'compress@10': 1.0, 'time@10': 2.84}:   3%|▎         | 1/30 [00:04<00:39,  1.37s/it]    {'epoch': 39, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9323, 'compress@10': 1.0, 'time@10': 2.84}:   7%|▋         | 2/30 [00:04<01:06,  2.36s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9073, 'compress@10': 1.0, 'time@10': 2.8141}:   7%|▋         | 2/30 [00:05<01:06,  2.36s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9073, 'compress@10': 1.0, 'time@10': 2.8141}:  10%|█         | 3/30 [00:05<00:52,  1.93s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9593, 'compress@10': 1.0, 'time@10': 2.7826}:  10%|█         | 3/30 [00:08<00:52,  1.93s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9593, 'compress@10': 1.0, 'time@10': 2.7826}:  13%|█▎        | 4/30 [00:08<00:58,  2.24s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.05, 'hit_ratio@10': 0.8082, 'ndcg@10': 0.885, 'compress@10': 1.0, 'time@10': 2.3718}:  13%|█▎        | 4/30 [00:08<00:58,  2.24s/it]   {'epoch': 39, 'num_users': 5.8, 'loss': 0.05, 'hit_ratio@10': 0.8082, 'ndcg@10': 0.885, 'compress@10': 1.0, 'time@10': 2.3718}:  17%|█▋        | 5/30 [00:08<00:39,  1.58s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0472, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8867, 'compress@10': 1.0, 'time@10': 2.4564}:  17%|█▋        | 5/30 [00:11<00:39,  1.58s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0472, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8867, 'compress@10': 1.0, 'time@10': 2.4564}:  20%|██        | 6/30 [00:11<00:48,  2.03s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0448, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 2.5061}:  20%|██        | 6/30 [00:13<00:48,  2.03s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0448, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 2.5061}:  23%|██▎       | 7/30 [00:13<00:42,  1.84s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 2.5328}:  23%|██▎       | 7/30 [00:16<00:42,  1.84s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 2.5328}:  27%|██▋       | 8/30 [00:16<00:46,  2.13s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0395, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 2.5404}:  27%|██▋       | 8/30 [00:17<00:46,  2.13s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0395, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 2.5404}:  30%|███       | 9/30 [00:17<00:39,  1.89s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0373, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9034, 'compress@10': 1.0, 'time@10': 2.5641}:  30%|███       | 9/30 [00:20<00:39,  1.89s/it]  {'epoch': 39, 'num_users': 6.3, 'loss': 0.0373, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9034, 'compress@10': 1.0, 'time@10': 2.5641}:  33%|███▎      | 10/30 [00:20<00:43,  2.17s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 0.0371, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 2.5548}:  33%|███▎      | 10/30 [00:21<00:43,  2.17s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 0.0371, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 2.5548}:  37%|███▋      | 11/30 [00:21<00:36,  1.90s/it]{'epoch': 39, 'num_users': 6.4167, 'loss': 0.0342, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.9025, 'compress@10': 1.0, 'time@10': 2.5784}:  37%|███▋      | 11/30 [00:24<00:36,  1.90s/it]{'epoch': 39, 'num_users': 6.4167, 'loss': 0.0342, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.9025, 'compress@10': 1.0, 'time@10': 2.5784}:  40%|████      | 12/30 [00:24<00:39,  2.20s/it]{'epoch': 39, 'num_users': 6.6154, 'loss': 0.0338, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 2.559}:  40%|████      | 12/30 [00:25<00:39,  2.20s/it] {'epoch': 39, 'num_users': 6.6154, 'loss': 0.0338, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 2.559}:  43%|████▎     | 13/30 [00:25<00:32,  1.90s/it]{'epoch': 39, 'num_users': 6.3571, 'loss': 0.0314, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 2.5745}:  43%|████▎     | 13/30 [00:28<00:32,  1.90s/it]{'epoch': 39, 'num_users': 6.3571, 'loss': 0.0314, 'hit_ratio@10': 0.8273, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 2.5745}:  47%|████▋     | 14/30 [00:28<00:34,  2.17s/it]{'epoch': 39, 'num_users': 6.2667, 'loss': 0.0314, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 2.5731}:  47%|████▋     | 14/30 [00:29<00:34,  2.17s/it]{'epoch': 39, 'num_users': 6.2667, 'loss': 0.0314, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 2.5731}:  50%|█████     | 15/30 [00:29<00:28,  1.91s/it]{'epoch': 39, 'num_users': 6.0625, 'loss': 0.0296, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8992, 'compress@10': 1.0, 'time@10': 2.5897}:  50%|█████     | 15/30 [00:32<00:28,  1.91s/it]{'epoch': 39, 'num_users': 6.0625, 'loss': 0.0296, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8992, 'compress@10': 1.0, 'time@10': 2.5897}:  53%|█████▎    | 16/30 [00:32<00:30,  2.20s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 0.0278, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 2.5981}:  53%|█████▎    | 16/30 [00:34<00:30,  2.20s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 0.0278, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 2.5981}:  57%|█████▋    | 17/30 [00:34<00:25,  1.96s/it]{'epoch': 39, 'num_users': 6.0556, 'loss': 0.0277, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 2.6066}:  57%|█████▋    | 17/30 [00:36<00:25,  1.96s/it]{'epoch': 39, 'num_users': 6.0556, 'loss': 0.0277, 'hit_ratio@10': 0.8338, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 2.6066}:  60%|██████    | 18/30 [00:36<00:26,  2.21s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 0.0265, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 2.6131}:  60%|██████    | 18/30 [00:38<00:26,  2.21s/it]   {'epoch': 39, 'num_users': 6.0, 'loss': 0.0265, 'hit_ratio@10': 0.8388, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 2.6131}:  63%|██████▎   | 19/30 [00:38<00:21,  1.97s/it]{'epoch': 39, 'num_users': 6.15, 'loss': 0.0265, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 2.6322}:  63%|██████▎   | 19/30 [00:41<00:21,  1.97s/it]{'epoch': 39, 'num_users': 6.15, 'loss': 0.0265, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 2.6322}:  67%|██████▋   | 20/30 [00:41<00:22,  2.29s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 2.6166}:  67%|██████▋   | 20/30 [00:42<00:22,  2.29s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0277, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 2.6166}:  70%|███████   | 21/30 [00:42<00:17,  1.96s/it]{'epoch': 39, 'num_users': 6.1818, 'loss': 0.027, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8942, 'compress@10': 1.0, 'time@10': 2.6314}:  70%|███████   | 21/30 [00:45<00:17,  1.96s/it] {'epoch': 39, 'num_users': 6.1818, 'loss': 0.027, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.8942, 'compress@10': 1.0, 'time@10': 2.6314}:  73%|███████▎  | 22/30 [00:45<00:18,  2.26s/it]{'epoch': 39, 'num_users': 6.1304, 'loss': 0.0264, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 2.6477}:  73%|███████▎  | 22/30 [00:46<00:18,  2.26s/it]{'epoch': 39, 'num_users': 6.1304, 'loss': 0.0264, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 2.6477}:  77%|███████▋  | 23/30 [00:46<00:14,  2.05s/it]{'epoch': 39, 'num_users': 5.9583, 'loss': 0.0253, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8914, 'compress@10': 1.0, 'time@10': 2.6553}:  77%|███████▋  | 23/30 [00:49<00:14,  2.05s/it]{'epoch': 39, 'num_users': 5.9583, 'loss': 0.0253, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8914, 'compress@10': 1.0, 'time@10': 2.6553}:  80%|████████  | 24/30 [00:49<00:13,  2.30s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8825, 'compress@10': 1.0, 'time@10': 2.6535}:  80%|████████  | 24/30 [00:51<00:13,  2.30s/it]   {'epoch': 39, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8825, 'compress@10': 1.0, 'time@10': 2.6535}:  83%|████████▎ | 25/30 [00:51<00:10,  2.01s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 0.0246, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 2.644}:  83%|████████▎ | 25/30 [00:53<00:10,  2.01s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 0.0246, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 2.644}:  87%|████████▋ | 26/30 [00:53<00:08,  2.14s/it]{'epoch': 39, 'num_users': 5.8889, 'loss': 0.0242, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.885, 'compress@10': 1.0, 'time@10': 2.6329}:  87%|████████▋ | 26/30 [00:54<00:08,  2.14s/it]{'epoch': 39, 'num_users': 5.8889, 'loss': 0.0242, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.885, 'compress@10': 1.0, 'time@10': 2.6329}:  90%|█████████ | 27/30 [00:54<00:05,  1.86s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 0.0238, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8866, 'compress@10': 1.0, 'time@10': 2.6297}:  90%|█████████ | 27/30 [00:57<00:05,  1.86s/it]  {'epoch': 39, 'num_users': 6.0, 'loss': 0.0238, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8866, 'compress@10': 1.0, 'time@10': 2.6297}:  93%|█████████▎| 28/30 [00:57<00:04,  2.08s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 0.0231, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 2.6276}:  93%|█████████▎| 28/30 [00:58<00:04,  2.08s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 0.0231, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 2.6276}:  97%|█████████▋| 29/30 [00:58<00:01,  1.85s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0228, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 2.6341}:  97%|█████████▋| 29/30 [01:01<00:01,  1.85s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0228, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 2.6341}: 100%|██████████| 30/30 [01:01<00:00,  2.15s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 0.0228, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 2.6341}: 100%|██████████| 30/30 [01:01<00:00,  2.05s/it]
Epoch: 39
Avg # of users: 5.866666666666666
Avg Loss: 0.022845702733840224
Avg hit ratio: 0.8573457449156691
Avg ndcg: 0.8913024168125306
Avg compression ratio: 0.9999999860153537
Avg train time: 2.6340506871541343
Std train time: 0.40343479894104006
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 32, 14, 8, 9, 8, 11, 6, 9, 7, 34, 8, 77, 7, 36, 49, 13, 15, 6, 6, 18, 9, 95, 95, 5, 7, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 2.7559}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0221, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 2.7559}:   3%|▎         | 1/30 [00:01<00:41,  1.42s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9007, 'compress@10': 1.0, 'time@10': 2.7359}:   3%|▎         | 1/30 [00:04<00:41,  1.42s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9007, 'compress@10': 1.0, 'time@10': 2.7359}:   7%|▋         | 2/30 [00:04<01:01,  2.20s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 2.7825}:   7%|▋         | 2/30 [00:05<01:01,  2.20s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 2.7825}:  10%|█         | 3/30 [00:05<00:50,  1.87s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.8791, 'compress@10': 1.0, 'time@10': 2.8297}:  10%|█         | 3/30 [00:08<00:50,  1.87s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.8791, 'compress@10': 1.0, 'time@10': 2.8297}:  13%|█▎        | 4/30 [00:08<01:00,  2.32s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 3.4629}:  13%|█▎        | 4/30 [00:11<01:00,  2.32s/it] {'epoch': 40, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.826, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 3.4629}:  17%|█▋        | 5/30 [00:11<01:04,  2.58s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.025, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8776, 'compress@10': 1.0, 'time@10': 3.3749}:  17%|█▋        | 5/30 [00:14<01:04,  2.58s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.025, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8776, 'compress@10': 1.0, 'time@10': 3.3749}:  20%|██        | 6/30 [00:14<01:05,  2.71s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0254, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 3.2924}:  20%|██        | 6/30 [00:16<01:05,  2.71s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0254, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 3.2924}:  23%|██▎       | 7/30 [00:16<00:52,  2.30s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 3.2085}:  23%|██▎       | 7/30 [00:18<00:52,  2.30s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 3.2085}:  27%|██▋       | 8/30 [00:18<00:53,  2.41s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0272, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8928, 'compress@10': 1.0, 'time@10': 3.1893}:  27%|██▋       | 8/30 [00:20<00:53,  2.41s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0272, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.8928, 'compress@10': 1.0, 'time@10': 3.1893}:  30%|███       | 9/30 [00:20<00:45,  2.14s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0266, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 3.1514}:  30%|███       | 9/30 [00:23<00:45,  2.14s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0266, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 3.1514}:  33%|███▎      | 10/30 [00:23<00:47,  2.36s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 0.0272, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.898, 'compress@10': 1.0, 'time@10': 3.1047}:  33%|███▎      | 10/30 [00:24<00:47,  2.36s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 0.0272, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.898, 'compress@10': 1.0, 'time@10': 3.1047}:  37%|███▋      | 11/30 [00:24<00:39,  2.05s/it]{'epoch': 40, 'num_users': 6.4167, 'loss': 0.0251, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8996, 'compress@10': 1.0, 'time@10': 3.0999}:  37%|███▋      | 11/30 [00:27<00:39,  2.05s/it]{'epoch': 40, 'num_users': 6.4167, 'loss': 0.0251, 'hit_ratio@10': 0.8598, 'ndcg@10': 0.8996, 'compress@10': 1.0, 'time@10': 3.0999}:  40%|████      | 12/30 [00:27<00:42,  2.37s/it]{'epoch': 40, 'num_users': 6.6154, 'loss': 0.0252, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.0745}:  40%|████      | 12/30 [00:29<00:42,  2.37s/it]{'epoch': 40, 'num_users': 6.6154, 'loss': 0.0252, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.0745}:  43%|████▎     | 13/30 [00:29<00:35,  2.08s/it]{'epoch': 40, 'num_users': 6.3571, 'loss': 0.0234, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 3.0526}:  43%|████▎     | 13/30 [00:31<00:35,  2.08s/it] {'epoch': 40, 'num_users': 6.3571, 'loss': 0.0234, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 3.0526}:  47%|████▋     | 14/30 [00:31<00:36,  2.30s/it]{'epoch': 40, 'num_users': 6.2667, 'loss': 0.0247, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.0582}:  47%|████▋     | 14/30 [00:33<00:36,  2.30s/it]{'epoch': 40, 'num_users': 6.2667, 'loss': 0.0247, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.0582}:  50%|█████     | 15/30 [00:33<00:31,  2.10s/it]{'epoch': 40, 'num_users': 6.0625, 'loss': 0.0232, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 3.0414}:  50%|█████     | 15/30 [00:36<00:31,  2.10s/it] {'epoch': 40, 'num_users': 6.0625, 'loss': 0.0232, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 3.0414}:  53%|█████▎    | 16/30 [00:36<00:32,  2.32s/it]{'epoch': 40, 'num_users': 5.8235, 'loss': 0.0218, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.0252}:  53%|█████▎    | 16/30 [00:37<00:32,  2.32s/it]{'epoch': 40, 'num_users': 5.8235, 'loss': 0.0218, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.0252}:  57%|█████▋    | 17/30 [00:37<00:26,  2.05s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 0.0217, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8927, 'compress@10': 1.0, 'time@10': 3.0037}:  57%|█████▋    | 17/30 [00:40<00:26,  2.05s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 0.0217, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8927, 'compress@10': 1.0, 'time@10': 3.0037}:  60%|██████    | 18/30 [00:40<00:26,  2.24s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 0.0208, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8946, 'compress@10': 1.0, 'time@10': 3.004}:  60%|██████    | 18/30 [00:42<00:26,  2.24s/it]    {'epoch': 40, 'num_users': 6.0, 'loss': 0.0208, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8946, 'compress@10': 1.0, 'time@10': 3.004}:  63%|██████▎   | 19/30 [00:42<00:22,  2.06s/it]{'epoch': 40, 'num_users': 6.15, 'loss': 0.0209, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 2.9806}:  63%|██████▎   | 19/30 [00:44<00:22,  2.06s/it]{'epoch': 40, 'num_users': 6.15, 'loss': 0.0209, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 2.9806}:  67%|██████▋   | 20/30 [00:44<00:22,  2.21s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.0069}:  67%|██████▋   | 20/30 [00:46<00:22,  2.21s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 3.0069}:  70%|███████   | 21/30 [00:46<00:18,  2.09s/it]{'epoch': 40, 'num_users': 6.1818, 'loss': 0.0217, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8976, 'compress@10': 1.0, 'time@10': 2.9939}:  70%|███████   | 21/30 [00:49<00:18,  2.09s/it]{'epoch': 40, 'num_users': 6.1818, 'loss': 0.0217, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8976, 'compress@10': 1.0, 'time@10': 2.9939}:  73%|███████▎  | 22/30 [00:49<00:18,  2.29s/it]{'epoch': 40, 'num_users': 6.1304, 'loss': 0.0212, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 2.9744}:  73%|███████▎  | 22/30 [00:50<00:18,  2.29s/it] {'epoch': 40, 'num_users': 6.1304, 'loss': 0.0212, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 2.9744}:  77%|███████▋  | 23/30 [00:50<00:13,  2.00s/it]{'epoch': 40, 'num_users': 5.9583, 'loss': 0.0204, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8947, 'compress@10': 1.0, 'time@10': 2.9627}:  77%|███████▋  | 23/30 [00:53<00:13,  2.00s/it]{'epoch': 40, 'num_users': 5.9583, 'loss': 0.0204, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8947, 'compress@10': 1.0, 'time@10': 2.9627}:  80%|████████  | 24/30 [00:53<00:13,  2.22s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0195, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8855, 'compress@10': 1.0, 'time@10': 2.9535}:  80%|████████  | 24/30 [00:54<00:13,  2.22s/it]   {'epoch': 40, 'num_users': 5.8, 'loss': 0.0195, 'hit_ratio@10': 0.8545, 'ndcg@10': 0.8855, 'compress@10': 1.0, 'time@10': 2.9535}:  83%|████████▎ | 25/30 [00:54<00:09,  1.97s/it]{'epoch': 40, 'num_users': 5.8077, 'loss': 0.0199, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8868, 'compress@10': 1.0, 'time@10': 2.9521}:  83%|████████▎ | 25/30 [00:57<00:09,  1.97s/it]{'epoch': 40, 'num_users': 5.8077, 'loss': 0.0199, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8868, 'compress@10': 1.0, 'time@10': 2.9521}:  87%|████████▋ | 26/30 [00:57<00:09,  2.27s/it]{'epoch': 40, 'num_users': 5.8889, 'loss': 0.0197, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8888, 'compress@10': 1.0, 'time@10': 2.9443}:  87%|████████▋ | 26/30 [00:58<00:09,  2.27s/it]{'epoch': 40, 'num_users': 5.8889, 'loss': 0.0197, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8888, 'compress@10': 1.0, 'time@10': 2.9443}:  90%|█████████ | 27/30 [00:58<00:06,  2.01s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 0.02, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 2.9463}:  90%|█████████ | 27/30 [01:02<00:06,  2.01s/it]     {'epoch': 40, 'num_users': 6.0, 'loss': 0.02, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 2.9463}:  93%|█████████▎| 28/30 [01:02<00:04,  2.32s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 0.0198, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.8927, 'compress@10': 1.0, 'time@10': 2.9446}:  93%|█████████▎| 28/30 [01:03<00:04,  2.32s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 0.0198, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.8927, 'compress@10': 1.0, 'time@10': 2.9446}:  97%|█████████▋| 29/30 [01:03<00:02,  2.07s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0196, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 2.941}:  97%|█████████▋| 29/30 [01:06<00:02,  2.07s/it] {'epoch': 40, 'num_users': 5.8667, 'loss': 0.0196, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 2.941}: 100%|██████████| 30/30 [01:06<00:00,  2.31s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 0.0196, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 2.941}: 100%|██████████| 30/30 [01:06<00:00,  2.21s/it]
Epoch: 40
Avg # of users: 5.866666666666666
Avg Loss: 0.01958072748999889
Avg hit ratio: 0.8685280916081523
Avg ndcg: 0.8945029299154682
Avg compression ratio: 0.9999999860153537
Avg train time: 2.9410452286402387
Std train time: 0.600033541881085
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 32, 13, 1, 8, 8, 11, 5, 9, 7, 33, 8, 77, 6, 36, 49, 13, 14, 7, 4, 18, 10, 95, 95, 5, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9118, 'compress@10': 1.0, 'time@10': 2.9302}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9118, 'compress@10': 1.0, 'time@10': 2.9302}:   3%|▎         | 1/30 [00:01<00:43,  1.50s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9703, 'compress@10': 1.0, 'time@10': 2.9537}:   3%|▎         | 1/30 [00:04<00:43,  1.50s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9703, 'compress@10': 1.0, 'time@10': 2.9537}:   7%|▋         | 2/30 [00:04<01:06,  2.39s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9326, 'compress@10': 1.0, 'time@10': 2.8427}:   7%|▋         | 2/30 [00:05<01:06,  2.39s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9326, 'compress@10': 1.0, 'time@10': 2.8427}:  10%|█         | 3/30 [00:05<00:51,  1.92s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9334, 'compress@10': 1.0, 'time@10': 2.7608}:  10%|█         | 3/30 [00:08<00:51,  1.92s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9334, 'compress@10': 1.0, 'time@10': 2.7608}:  13%|█▎        | 4/30 [00:08<00:56,  2.18s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0518, 'hit_ratio@10': 0.796, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 2.3631}:  13%|█▎        | 4/30 [00:08<00:56,  2.18s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.0518, 'hit_ratio@10': 0.796, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 2.3631}:  17%|█▋        | 5/30 [00:08<00:38,  1.55s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0472, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 2.4084}:  17%|█▋        | 5/30 [00:11<00:38,  1.55s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0472, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 2.4084}:  20%|██        | 6/30 [00:11<00:46,  1.93s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0439, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 2.4752}:  20%|██        | 6/30 [00:13<00:46,  1.93s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0439, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 2.4752}:  23%|██▎       | 7/30 [00:13<00:40,  1.78s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0412, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 2.5112}:  23%|██▎       | 7/30 [00:15<00:40,  1.78s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0412, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 2.5112}:  27%|██▋       | 8/30 [00:15<00:46,  2.11s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0393, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.886, 'compress@10': 1.0, 'time@10': 2.5101}:  27%|██▋       | 8/30 [00:17<00:46,  2.11s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0393, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.886, 'compress@10': 1.0, 'time@10': 2.5101}:  30%|███       | 9/30 [00:17<00:38,  1.85s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.037, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 2.5357}:  30%|███       | 9/30 [00:19<00:38,  1.85s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.037, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 2.5357}:  33%|███▎      | 10/30 [00:19<00:42,  2.14s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 0.0366, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8928, 'compress@10': 1.0, 'time@10': 2.5326}:  33%|███▎      | 10/30 [00:21<00:42,  2.14s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 0.0366, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8928, 'compress@10': 1.0, 'time@10': 2.5326}:  37%|███▋      | 11/30 [00:21<00:35,  1.88s/it]{'epoch': 41, 'num_users': 6.4167, 'loss': 0.0337, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8948, 'compress@10': 1.0, 'time@10': 2.5444}:  37%|███▋      | 11/30 [00:23<00:35,  1.88s/it]{'epoch': 41, 'num_users': 6.4167, 'loss': 0.0337, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8948, 'compress@10': 1.0, 'time@10': 2.5444}:  40%|████      | 12/30 [00:23<00:38,  2.13s/it]{'epoch': 41, 'num_users': 6.6154, 'loss': 0.033, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 2.5736}:  40%|████      | 12/30 [00:25<00:38,  2.13s/it]{'epoch': 41, 'num_users': 6.6154, 'loss': 0.033, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 2.5736}:  43%|████▎     | 13/30 [00:25<00:33,  1.94s/it]{'epoch': 41, 'num_users': 6.3571, 'loss': 0.0307, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 2.5929}:  43%|████▎     | 13/30 [00:28<00:33,  1.94s/it]{'epoch': 41, 'num_users': 6.3571, 'loss': 0.0307, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8911, 'compress@10': 1.0, 'time@10': 2.5929}:  47%|████▋     | 14/30 [00:28<00:35,  2.23s/it]{'epoch': 41, 'num_users': 6.2667, 'loss': 0.0306, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8917, 'compress@10': 1.0, 'time@10': 2.5876}:  47%|████▋     | 14/30 [00:29<00:35,  2.23s/it]{'epoch': 41, 'num_users': 6.2667, 'loss': 0.0306, 'hit_ratio@10': 0.8459, 'ndcg@10': 0.8917, 'compress@10': 1.0, 'time@10': 2.5876}:  50%|█████     | 15/30 [00:29<00:29,  1.95s/it]{'epoch': 41, 'num_users': 6.0625, 'loss': 0.0289, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 2.5956}:  50%|█████     | 15/30 [00:32<00:29,  1.95s/it]{'epoch': 41, 'num_users': 6.0625, 'loss': 0.0289, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8932, 'compress@10': 1.0, 'time@10': 2.5956}:  53%|█████▎    | 16/30 [00:32<00:30,  2.19s/it]{'epoch': 41, 'num_users': 5.8235, 'loss': 0.0272, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 2.6082}:  53%|█████▎    | 16/30 [00:33<00:30,  2.19s/it]{'epoch': 41, 'num_users': 5.8235, 'loss': 0.0272, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 2.6082}:  57%|█████▋    | 17/30 [00:33<00:25,  1.96s/it]{'epoch': 41, 'num_users': 6.0556, 'loss': 0.0264, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 2.6091}:  57%|█████▋    | 17/30 [00:36<00:25,  1.96s/it]  {'epoch': 41, 'num_users': 6.0556, 'loss': 0.0264, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 2.6091}:  60%|██████    | 18/30 [00:36<00:26,  2.17s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 0.0253, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.892, 'compress@10': 1.0, 'time@10': 2.6083}:  60%|██████    | 18/30 [00:37<00:26,  2.17s/it]  {'epoch': 41, 'num_users': 6.0, 'loss': 0.0253, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.892, 'compress@10': 1.0, 'time@10': 2.6083}:  63%|██████▎   | 19/30 [00:37<00:21,  1.92s/it]{'epoch': 41, 'num_users': 6.15, 'loss': 0.0252, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 2.6271}:  63%|██████▎   | 19/30 [00:40<00:21,  1.92s/it]{'epoch': 41, 'num_users': 6.15, 'loss': 0.0252, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 2.6271}:  67%|██████▋   | 20/30 [00:40<00:22,  2.25s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0264, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8912, 'compress@10': 1.0, 'time@10': 2.6154}:  67%|██████▋   | 20/30 [00:42<00:22,  2.25s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0264, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8912, 'compress@10': 1.0, 'time@10': 2.6154}:  70%|███████   | 21/30 [00:42<00:17,  1.95s/it]{'epoch': 41, 'num_users': 6.1818, 'loss': 0.0255, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 2.6171}:  70%|███████   | 21/30 [00:44<00:17,  1.95s/it]{'epoch': 41, 'num_users': 6.1818, 'loss': 0.0255, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 2.6171}:  73%|███████▎  | 22/30 [00:44<00:17,  2.18s/it]{'epoch': 41, 'num_users': 6.1304, 'loss': 0.0248, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 2.618}:  73%|███████▎  | 22/30 [00:46<00:17,  2.18s/it] {'epoch': 41, 'num_users': 6.1304, 'loss': 0.0248, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 2.618}:  77%|███████▋  | 23/30 [00:46<00:13,  1.93s/it]{'epoch': 41, 'num_users': 5.9583, 'loss': 0.0238, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 2.6162}:  77%|███████▋  | 23/30 [00:48<00:13,  1.93s/it]{'epoch': 41, 'num_users': 5.9583, 'loss': 0.0238, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 2.6162}:  80%|████████  | 24/30 [00:48<00:12,  2.13s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 2.6219}:  80%|████████  | 24/30 [00:50<00:12,  2.13s/it]   {'epoch': 41, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8831, 'compress@10': 1.0, 'time@10': 2.6219}:  83%|████████▎ | 25/30 [00:50<00:09,  1.92s/it]{'epoch': 41, 'num_users': 5.8077, 'loss': 0.023, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8846, 'compress@10': 1.0, 'time@10': 2.6324}:  83%|████████▎ | 25/30 [00:53<00:09,  1.92s/it]{'epoch': 41, 'num_users': 5.8077, 'loss': 0.023, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8846, 'compress@10': 1.0, 'time@10': 2.6324}:  87%|████████▋ | 26/30 [00:53<00:08,  2.23s/it]{'epoch': 41, 'num_users': 5.8889, 'loss': 0.0229, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 2.6375}:  87%|████████▋ | 26/30 [00:54<00:08,  2.23s/it]{'epoch': 41, 'num_users': 5.8889, 'loss': 0.0229, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8861, 'compress@10': 1.0, 'time@10': 2.6375}:  90%|█████████ | 27/30 [00:54<00:05,  1.99s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 0.0226, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 2.6366}:  90%|█████████ | 27/30 [00:57<00:05,  1.99s/it]   {'epoch': 41, 'num_users': 6.0, 'loss': 0.0226, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 2.6366}:  93%|█████████▎| 28/30 [00:57<00:04,  2.19s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 0.0223, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8904, 'compress@10': 1.0, 'time@10': 2.6479}:  93%|█████████▎| 28/30 [00:58<00:04,  2.19s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 0.0223, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.8904, 'compress@10': 1.0, 'time@10': 2.6479}:  97%|█████████▋| 29/30 [00:58<00:01,  1.99s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0224, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.893, 'compress@10': 1.0, 'time@10': 2.6607}:  97%|█████████▋| 29/30 [01:01<00:01,  1.99s/it] {'epoch': 41, 'num_users': 5.8667, 'loss': 0.0224, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.893, 'compress@10': 1.0, 'time@10': 2.6607}: 100%|██████████| 30/30 [01:01<00:00,  2.31s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 0.0224, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.893, 'compress@10': 1.0, 'time@10': 2.6607}: 100%|██████████| 30/30 [01:01<00:00,  2.06s/it]
Epoch: 41
Avg # of users: 5.866666666666666
Avg Loss: 0.02239769921654565
Avg hit ratio: 0.8665581946594777
Avg ndcg: 0.8930265711154729
Avg compression ratio: 0.9999999860153537
Avg train time: 2.660651993751526
Std train time: 0.3888367423739099
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[9, 11, 32, 14, 7, 8, 8, 11, 6, 9, 8, 33, 8, 77, 7, 36, 49, 13, 15, 6, 5, 18, 10, 96, 95, 5, 7, 8, 9, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 2.7102}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 2.7102}:   3%|▎         | 1/30 [00:01<00:40,  1.40s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.912, 'compress@10': 1.0, 'time@10': 2.727}:   3%|▎         | 1/30 [00:04<00:40,  1.40s/it]  {'epoch': 42, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.912, 'compress@10': 1.0, 'time@10': 2.727}:   7%|▋         | 2/30 [00:04<01:01,  2.21s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 2.7388}:   7%|▋         | 2/30 [00:05<01:01,  2.21s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.779, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 2.7388}:  10%|█         | 3/30 [00:05<00:49,  1.85s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.7986, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 2.7406}:  10%|█         | 3/30 [00:08<00:49,  1.85s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.7986, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 2.7406}:  13%|█▎        | 4/30 [00:08<00:57,  2.22s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8938, 'compress@10': 1.0, 'time@10': 3.202}:  13%|█▎        | 4/30 [00:10<00:57,  2.22s/it] {'epoch': 42, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8938, 'compress@10': 1.0, 'time@10': 3.202}:  17%|█▋        | 5/30 [00:10<00:58,  2.34s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0211, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 3.1085}:  17%|█▋        | 5/30 [00:13<00:58,  2.34s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0211, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 3.1085}:  20%|██        | 6/30 [00:13<00:58,  2.46s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0212, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.0686}:  20%|██        | 6/30 [00:15<00:58,  2.46s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0212, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.0686}:  23%|██▎       | 7/30 [00:15<00:48,  2.13s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0205, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9073, 'compress@10': 1.0, 'time@10': 3.0192}:  23%|██▎       | 7/30 [00:17<00:48,  2.13s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0205, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9073, 'compress@10': 1.0, 'time@10': 3.0192}:  27%|██▋       | 8/30 [00:17<00:50,  2.31s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9098, 'compress@10': 1.0, 'time@10': 3.0147}:  27%|██▋       | 8/30 [00:19<00:50,  2.31s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9098, 'compress@10': 1.0, 'time@10': 3.0147}:  30%|███       | 9/30 [00:19<00:43,  2.07s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0205, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9142, 'compress@10': 1.0, 'time@10': 2.9909}:  30%|███       | 9/30 [00:22<00:43,  2.07s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0205, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9142, 'compress@10': 1.0, 'time@10': 2.9909}:  33%|███▎      | 10/30 [00:22<00:46,  2.30s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 0.0217, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9142, 'compress@10': 1.0, 'time@10': 2.9917}:  33%|███▎      | 10/30 [00:23<00:46,  2.30s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 0.0217, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9142, 'compress@10': 1.0, 'time@10': 2.9917}:  37%|███▋      | 11/30 [00:23<00:39,  2.07s/it]{'epoch': 42, 'num_users': 6.4167, 'loss': 0.0202, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 2.9835}:  37%|███▋      | 11/30 [00:26<00:39,  2.07s/it]{'epoch': 42, 'num_users': 6.4167, 'loss': 0.0202, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 2.9835}:  40%|████      | 12/30 [00:26<00:41,  2.33s/it]{'epoch': 42, 'num_users': 6.6154, 'loss': 0.0205, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9136, 'compress@10': 1.0, 'time@10': 2.9504}:  40%|████      | 12/30 [00:27<00:41,  2.33s/it]{'epoch': 42, 'num_users': 6.6154, 'loss': 0.0205, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9136, 'compress@10': 1.0, 'time@10': 2.9504}:  43%|████▎     | 13/30 [00:27<00:34,  2.03s/it]{'epoch': 42, 'num_users': 6.3571, 'loss': 0.0191, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9079, 'compress@10': 1.0, 'time@10': 2.9342}:  43%|████▎     | 13/30 [00:30<00:34,  2.03s/it]{'epoch': 42, 'num_users': 6.3571, 'loss': 0.0191, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9079, 'compress@10': 1.0, 'time@10': 2.9342}:  47%|████▋     | 14/30 [00:30<00:36,  2.25s/it]{'epoch': 42, 'num_users': 6.2667, 'loss': 0.0199, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.908, 'compress@10': 1.0, 'time@10': 2.932}:  47%|████▋     | 14/30 [00:32<00:36,  2.25s/it]  {'epoch': 42, 'num_users': 6.2667, 'loss': 0.0199, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.908, 'compress@10': 1.0, 'time@10': 2.932}:  50%|█████     | 15/30 [00:32<00:30,  2.02s/it]{'epoch': 42, 'num_users': 6.0625, 'loss': 0.0187, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9085, 'compress@10': 1.0, 'time@10': 2.9221}:  50%|█████     | 15/30 [00:35<00:30,  2.02s/it]{'epoch': 42, 'num_users': 6.0625, 'loss': 0.0187, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9085, 'compress@10': 1.0, 'time@10': 2.9221}:  53%|█████▎    | 16/30 [00:35<00:31,  2.26s/it]{'epoch': 42, 'num_users': 5.8235, 'loss': 0.0176, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9021, 'compress@10': 1.0, 'time@10': 2.9061}:  53%|█████▎    | 16/30 [00:36<00:31,  2.26s/it]{'epoch': 42, 'num_users': 5.8235, 'loss': 0.0176, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9021, 'compress@10': 1.0, 'time@10': 2.9061}:  57%|█████▋    | 17/30 [00:36<00:25,  1.99s/it]{'epoch': 42, 'num_users': 6.0556, 'loss': 0.0182, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 2.8918}:  57%|█████▋    | 17/30 [00:39<00:25,  1.99s/it] {'epoch': 42, 'num_users': 6.0556, 'loss': 0.0182, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 2.8918}:  60%|██████    | 18/30 [00:39<00:26,  2.20s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 0.0176, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9043, 'compress@10': 1.0, 'time@10': 2.8836}:  60%|██████    | 18/30 [00:40<00:26,  2.20s/it]  {'epoch': 42, 'num_users': 6.0, 'loss': 0.0176, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9043, 'compress@10': 1.0, 'time@10': 2.8836}:  63%|██████▎   | 19/30 [00:40<00:21,  1.96s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 0.0179, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 2.8619}:  63%|██████▎   | 19/30 [00:42<00:21,  1.96s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 0.0179, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 2.8619}:  67%|██████▋   | 20/30 [00:42<00:21,  2.12s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9033, 'compress@10': 1.0, 'time@10': 2.8664}:  67%|██████▋   | 20/30 [00:44<00:21,  2.12s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9033, 'compress@10': 1.0, 'time@10': 2.8664}:  70%|███████   | 21/30 [00:44<00:17,  1.94s/it]{'epoch': 42, 'num_users': 6.1818, 'loss': 0.0186, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9053, 'compress@10': 1.0, 'time@10': 2.8565}:  70%|███████   | 21/30 [00:47<00:17,  1.94s/it]{'epoch': 42, 'num_users': 6.1818, 'loss': 0.0186, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9053, 'compress@10': 1.0, 'time@10': 2.8565}:  73%|███████▎  | 22/30 [00:47<00:17,  2.16s/it]{'epoch': 42, 'num_users': 6.1304, 'loss': 0.0183, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9063, 'compress@10': 1.0, 'time@10': 2.8473}:  73%|███████▎  | 22/30 [00:48<00:17,  2.16s/it]{'epoch': 42, 'num_users': 6.1304, 'loss': 0.0183, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9063, 'compress@10': 1.0, 'time@10': 2.8473}:  77%|███████▋  | 23/30 [00:48<00:13,  1.92s/it]{'epoch': 42, 'num_users': 5.9583, 'loss': 0.0175, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9018, 'compress@10': 1.0, 'time@10': 2.8379}:  77%|███████▋  | 23/30 [00:51<00:13,  1.92s/it]{'epoch': 42, 'num_users': 5.9583, 'loss': 0.0175, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9018, 'compress@10': 1.0, 'time@10': 2.8379}:  80%|████████  | 24/30 [00:51<00:12,  2.14s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 2.8415}:  80%|████████  | 24/30 [00:52<00:12,  2.14s/it]   {'epoch': 42, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 2.8415}:  83%|████████▎ | 25/30 [00:52<00:09,  1.95s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 0.0172, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 2.8459}:  83%|████████▎ | 25/30 [00:55<00:09,  1.95s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 0.0172, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 2.8459}:  87%|████████▋ | 26/30 [00:55<00:09,  2.26s/it]{'epoch': 42, 'num_users': 5.8889, 'loss': 0.0174, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 2.8401}:  87%|████████▋ | 26/30 [00:57<00:09,  2.26s/it]{'epoch': 42, 'num_users': 5.8889, 'loss': 0.0174, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 2.8401}:  90%|█████████ | 27/30 [00:57<00:05,  2.00s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 0.0183, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8952, 'compress@10': 1.0, 'time@10': 2.8444}:  90%|█████████ | 27/30 [01:00<00:05,  2.00s/it]   {'epoch': 42, 'num_users': 6.0, 'loss': 0.0183, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8952, 'compress@10': 1.0, 'time@10': 2.8444}:  93%|█████████▎| 28/30 [01:00<00:04,  2.30s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 0.0182, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 2.834}:  93%|█████████▎| 28/30 [01:01<00:04,  2.30s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 0.0182, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 2.834}:  97%|█████████▋| 29/30 [01:01<00:02,  2.00s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0178, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 2.8288}:  97%|█████████▋| 29/30 [01:04<00:02,  2.00s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0178, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 2.8288}: 100%|██████████| 30/30 [01:04<00:00,  2.22s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 0.0178, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 2.8288}: 100%|██████████| 30/30 [01:04<00:00,  2.14s/it]
Epoch: 42
Avg # of users: 5.866666666666666
Avg Loss: 0.017776816402543624
Avg hit ratio: 0.8797067702868311
Avg ndcg: 0.8994592124562506
Avg compression ratio: 0.9999999860153537
Avg train time: 2.828763397534688
Std train time: 0.4351092867852603
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[9, 11, 32, 14, 1, 8, 8, 11, 5, 9, 7, 33, 9, 77, 7, 36, 49, 13, 15, 7, 4, 18, 10, 96, 94, 4, 7, 7, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 2.6928}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 2.6928}:   3%|▎         | 1/30 [00:01<00:40,  1.38s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9117, 'compress@10': 1.0, 'time@10': 2.5598}:   3%|▎         | 1/30 [00:03<00:40,  1.38s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9117, 'compress@10': 1.0, 'time@10': 2.5598}:   7%|▋         | 2/30 [00:03<00:56,  2.03s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.8935, 'compress@10': 1.0, 'time@10': 2.5874}:   7%|▋         | 2/30 [00:05<00:56,  2.03s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.8935, 'compress@10': 1.0, 'time@10': 2.5874}:  10%|█         | 3/30 [00:05<00:46,  1.72s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 2.6083}:  10%|█         | 3/30 [00:07<00:46,  1.72s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 2.6083}:  13%|█▎        | 4/30 [00:07<00:54,  2.11s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8556, 'compress@10': 1.0, 'time@10': 2.235}:  13%|█▎        | 4/30 [00:08<00:54,  2.11s/it] {'epoch': 43, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8556, 'compress@10': 1.0, 'time@10': 2.235}:  17%|█▋        | 5/30 [00:08<00:37,  1.50s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0426, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8694, 'compress@10': 1.0, 'time@10': 2.2834}:  17%|█▋        | 5/30 [00:10<00:37,  1.50s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0426, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8694, 'compress@10': 1.0, 'time@10': 2.2834}:  20%|██        | 6/30 [00:10<00:44,  1.86s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0395, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8743, 'compress@10': 1.0, 'time@10': 2.3412}:  20%|██        | 6/30 [00:12<00:44,  1.86s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0395, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8743, 'compress@10': 1.0, 'time@10': 2.3412}:  23%|██▎       | 7/30 [00:12<00:39,  1.70s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0409, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 2.3734}:  23%|██▎       | 7/30 [00:14<00:39,  1.70s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0409, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 2.3734}:  27%|██▋       | 8/30 [00:14<00:44,  2.00s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.039, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 2.3825}:  27%|██▋       | 8/30 [00:16<00:44,  2.00s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.039, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 2.3825}:  30%|███       | 9/30 [00:16<00:37,  1.77s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0373, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.4152}:  30%|███       | 9/30 [00:18<00:37,  1.77s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 0.0373, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.4152}:  33%|███▎      | 10/30 [00:18<00:41,  2.08s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 0.0365, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 2.4363}:  33%|███▎      | 10/30 [00:20<00:41,  2.08s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 0.0365, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 2.4363}:  37%|███▋      | 11/30 [00:20<00:35,  1.86s/it]{'epoch': 43, 'num_users': 6.4167, 'loss': 0.0338, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9004, 'compress@10': 1.0, 'time@10': 2.448}:  37%|███▋      | 11/30 [00:22<00:35,  1.86s/it]  {'epoch': 43, 'num_users': 6.4167, 'loss': 0.0338, 'hit_ratio@10': 0.862, 'ndcg@10': 0.9004, 'compress@10': 1.0, 'time@10': 2.448}:  40%|████      | 12/30 [00:22<00:37,  2.09s/it]{'epoch': 43, 'num_users': 6.6154, 'loss': 0.0331, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9002, 'compress@10': 1.0, 'time@10': 2.5021}:  40%|████      | 12/30 [00:24<00:37,  2.09s/it]{'epoch': 43, 'num_users': 6.6154, 'loss': 0.0331, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9002, 'compress@10': 1.0, 'time@10': 2.5021}:  43%|████▎     | 13/30 [00:24<00:33,  1.95s/it]{'epoch': 43, 'num_users': 6.3571, 'loss': 0.0308, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 2.5255}:  43%|████▎     | 13/30 [00:27<00:33,  1.95s/it]{'epoch': 43, 'num_users': 6.3571, 'loss': 0.0308, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 2.5255}:  47%|████▋     | 14/30 [00:27<00:35,  2.23s/it]{'epoch': 43, 'num_users': 6.2667, 'loss': 0.0304, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8972, 'compress@10': 1.0, 'time@10': 2.5535}:  47%|████▋     | 14/30 [00:28<00:35,  2.23s/it] {'epoch': 43, 'num_users': 6.2667, 'loss': 0.0304, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8972, 'compress@10': 1.0, 'time@10': 2.5535}:  50%|█████     | 15/30 [00:28<00:30,  2.01s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 0.0285, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8984, 'compress@10': 1.0, 'time@10': 2.5688}:  50%|█████     | 15/30 [00:31<00:30,  2.01s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 0.0285, 'hit_ratio@10': 0.8471, 'ndcg@10': 0.8984, 'compress@10': 1.0, 'time@10': 2.5688}:  53%|█████▎    | 16/30 [00:31<00:31,  2.26s/it]{'epoch': 43, 'num_users': 5.8235, 'loss': 0.0269, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8926, 'compress@10': 1.0, 'time@10': 2.5766}:  53%|█████▎    | 16/30 [00:33<00:31,  2.26s/it]{'epoch': 43, 'num_users': 5.8235, 'loss': 0.0269, 'hit_ratio@10': 0.8444, 'ndcg@10': 0.8926, 'compress@10': 1.0, 'time@10': 2.5766}:  57%|█████▋    | 17/30 [00:33<00:25,  2.00s/it]{'epoch': 43, 'num_users': 6.0556, 'loss': 0.0276, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 2.5795}:  57%|█████▋    | 17/30 [00:35<00:25,  2.00s/it] {'epoch': 43, 'num_users': 6.0556, 'loss': 0.0276, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 2.5795}:  60%|██████    | 18/30 [00:35<00:26,  2.20s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 0.0263, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8984, 'compress@10': 1.0, 'time@10': 2.5888}:  60%|██████    | 18/30 [00:37<00:26,  2.20s/it]  {'epoch': 43, 'num_users': 6.0, 'loss': 0.0263, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8984, 'compress@10': 1.0, 'time@10': 2.5888}:  63%|██████▎   | 19/30 [00:37<00:21,  1.96s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 0.0261, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9001, 'compress@10': 1.0, 'time@10': 2.6066}:  63%|██████▎   | 19/30 [00:40<00:21,  1.96s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 0.0261, 'hit_ratio@10': 0.857, 'ndcg@10': 0.9001, 'compress@10': 1.0, 'time@10': 2.6066}:  67%|██████▋   | 20/30 [00:40<00:22,  2.27s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.027, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 2.5987}:  67%|██████▋   | 20/30 [00:41<00:22,  2.27s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.027, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 2.5987}:  70%|███████   | 21/30 [00:41<00:17,  1.97s/it]{'epoch': 43, 'num_users': 6.1818, 'loss': 0.0268, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 2.5967}:  70%|███████   | 21/30 [00:44<00:17,  1.97s/it] {'epoch': 43, 'num_users': 6.1818, 'loss': 0.0268, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 2.5967}:  73%|███████▎  | 22/30 [00:44<00:17,  2.15s/it]{'epoch': 43, 'num_users': 6.1304, 'loss': 0.0264, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 2.6}:  73%|███████▎  | 22/30 [00:45<00:17,  2.15s/it] {'epoch': 43, 'num_users': 6.1304, 'loss': 0.0264, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 2.6}:  77%|███████▋  | 23/30 [00:45<00:13,  1.92s/it]{'epoch': 43, 'num_users': 5.9583, 'loss': 0.0253, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 2.5996}:  77%|███████▋  | 23/30 [00:48<00:13,  1.92s/it]{'epoch': 43, 'num_users': 5.9583, 'loss': 0.0253, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 2.5996}:  80%|████████  | 24/30 [00:48<00:12,  2.13s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 2.5994}:  80%|████████  | 24/30 [00:49<00:12,  2.13s/it]  {'epoch': 43, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 2.5994}:  83%|████████▎ | 25/30 [00:49<00:09,  1.90s/it]{'epoch': 43, 'num_users': 5.8077, 'loss': 0.0244, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 2.5877}:  83%|████████▎ | 25/30 [00:51<00:09,  1.90s/it]{'epoch': 43, 'num_users': 5.8077, 'loss': 0.0244, 'hit_ratio@10': 0.8553, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 2.5877}:  87%|████████▋ | 26/30 [00:51<00:08,  2.03s/it]{'epoch': 43, 'num_users': 5.8889, 'loss': 0.0243, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 2.5966}:  87%|████████▋ | 26/30 [00:53<00:08,  2.03s/it]{'epoch': 43, 'num_users': 5.8889, 'loss': 0.0243, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 2.5966}:  90%|█████████ | 27/30 [00:53<00:05,  1.86s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 0.0239, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8916, 'compress@10': 1.0, 'time@10': 2.5947}:  90%|█████████ | 27/30 [00:55<00:05,  1.86s/it]    {'epoch': 43, 'num_users': 6.0, 'loss': 0.0239, 'hit_ratio@10': 0.863, 'ndcg@10': 0.8916, 'compress@10': 1.0, 'time@10': 2.5947}:  93%|█████████▎| 28/30 [00:55<00:04,  2.07s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 0.0232, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 2.6039}:  93%|█████████▎| 28/30 [00:57<00:04,  2.07s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 0.0232, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 2.6039}:  97%|█████████▋| 29/30 [00:57<00:01,  1.89s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0235, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 2.6038}:  97%|█████████▋| 29/30 [00:59<00:01,  1.89s/it] {'epoch': 43, 'num_users': 5.8667, 'loss': 0.0235, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 2.6038}: 100%|██████████| 30/30 [00:59<00:00,  2.11s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 0.0235, 'hit_ratio@10': 0.8661, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 2.6038}: 100%|██████████| 30/30 [00:59<00:00,  2.00s/it]
Epoch: 43
Avg # of users: 5.866666666666666
Avg Loss: 0.023467420307221307
Avg hit ratio: 0.8660739691677836
Avg ndcg: 0.8940416230458929
Avg compression ratio: 0.9999999860153537
Avg train time: 2.603751794497172
Std train time: 0.3859708280287664
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[9, 12, 32, 14, 8, 9, 8, 12, 6, 9, 7, 34, 8, 77, 6, 36, 49, 13, 15, 6, 5, 19, 10, 97, 95, 6, 7, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0312, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8785, 'compress@10': 1.0, 'time@10': 2.4063}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0312, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8785, 'compress@10': 1.0, 'time@10': 2.4063}:   3%|▎         | 1/30 [00:01<00:35,  1.24s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9846, 'compress@10': 1.0, 'time@10': 2.6177}:   3%|▎         | 1/30 [00:04<00:35,  1.24s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0325, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9846, 'compress@10': 1.0, 'time@10': 2.6177}:   7%|▋         | 2/30 [00:04<01:01,  2.20s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9421, 'compress@10': 1.0, 'time@10': 2.6557}:   7%|▋         | 2/30 [00:05<01:01,  2.20s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9421, 'compress@10': 1.0, 'time@10': 2.6557}:  10%|█         | 3/30 [00:05<00:49,  1.84s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 2.6648}:  10%|█         | 3/30 [00:08<00:49,  1.84s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8075, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 2.6648}:  13%|█▎        | 4/30 [00:08<00:57,  2.20s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0274, 'hit_ratio@10': 0.826, 'ndcg@10': 0.9292, 'compress@10': 1.0, 'time@10': 3.2975}:  13%|█▎        | 4/30 [00:11<00:57,  2.20s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0274, 'hit_ratio@10': 0.826, 'ndcg@10': 0.9292, 'compress@10': 1.0, 'time@10': 3.2975}:  17%|█▋        | 5/30 [00:11<01:01,  2.47s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0285, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.9293, 'compress@10': 1.0, 'time@10': 3.2249}:  17%|█▋        | 5/30 [00:14<01:01,  2.47s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0285, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.9293, 'compress@10': 1.0, 'time@10': 3.2249}:  20%|██        | 6/30 [00:14<01:02,  2.62s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9263, 'compress@10': 1.0, 'time@10': 3.153}:  20%|██        | 6/30 [00:15<01:02,  2.62s/it] {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9263, 'compress@10': 1.0, 'time@10': 3.153}:  23%|██▎       | 7/30 [00:15<00:51,  2.22s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0277, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9338, 'compress@10': 1.0, 'time@10': 3.1179}:  23%|██▎       | 7/30 [00:18<00:51,  2.22s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0277, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9338, 'compress@10': 1.0, 'time@10': 3.1179}:  27%|██▋       | 8/30 [00:18<00:53,  2.44s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0269, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9336, 'compress@10': 1.0, 'time@10': 3.0956}:  27%|██▋       | 8/30 [00:19<00:53,  2.44s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0269, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9336, 'compress@10': 1.0, 'time@10': 3.0956}:  30%|███       | 9/30 [00:19<00:45,  2.14s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.936, 'compress@10': 1.0, 'time@10': 3.0643}:  30%|███       | 9/30 [00:22<00:45,  2.14s/it]    {'epoch': 44, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.936, 'compress@10': 1.0, 'time@10': 3.0643}:  33%|███▎      | 10/30 [00:22<00:47,  2.35s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 0.0257, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9332, 'compress@10': 1.0, 'time@10': 3.0215}:  33%|███▎      | 10/30 [00:24<00:47,  2.35s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 0.0257, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9332, 'compress@10': 1.0, 'time@10': 3.0215}:  37%|███▋      | 11/30 [00:24<00:38,  2.04s/it]{'epoch': 44, 'num_users': 6.4167, 'loss': 0.0239, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9318, 'compress@10': 1.0, 'time@10': 3.0036}:  37%|███▋      | 11/30 [00:26<00:38,  2.04s/it]{'epoch': 44, 'num_users': 6.4167, 'loss': 0.0239, 'hit_ratio@10': 0.8691, 'ndcg@10': 0.9318, 'compress@10': 1.0, 'time@10': 3.0036}:  40%|████      | 12/30 [00:26<00:41,  2.28s/it]{'epoch': 44, 'num_users': 6.6154, 'loss': 0.0238, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9304, 'compress@10': 1.0, 'time@10': 2.9843}:  40%|████      | 12/30 [00:28<00:41,  2.28s/it]{'epoch': 44, 'num_users': 6.6154, 'loss': 0.0238, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9304, 'compress@10': 1.0, 'time@10': 2.9843}:  43%|████▎     | 13/30 [00:28<00:34,  2.02s/it]{'epoch': 44, 'num_users': 6.3571, 'loss': 0.0221, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.9234, 'compress@10': 1.0, 'time@10': 2.9644}:  43%|████▎     | 13/30 [00:31<00:34,  2.02s/it]{'epoch': 44, 'num_users': 6.3571, 'loss': 0.0221, 'hit_ratio@10': 0.8542, 'ndcg@10': 0.9234, 'compress@10': 1.0, 'time@10': 2.9644}:  47%|████▋     | 14/30 [00:31<00:35,  2.24s/it]{'epoch': 44, 'num_users': 6.2667, 'loss': 0.0221, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.9226, 'compress@10': 1.0, 'time@10': 2.941}:  47%|████▋     | 14/30 [00:32<00:35,  2.24s/it] {'epoch': 44, 'num_users': 6.2667, 'loss': 0.0221, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.9226, 'compress@10': 1.0, 'time@10': 2.941}:  50%|█████     | 15/30 [00:32<00:29,  1.97s/it]{'epoch': 44, 'num_users': 6.0625, 'loss': 0.0208, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9222, 'compress@10': 1.0, 'time@10': 2.9261}:  50%|█████     | 15/30 [00:35<00:29,  1.97s/it]{'epoch': 44, 'num_users': 6.0625, 'loss': 0.0208, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9222, 'compress@10': 1.0, 'time@10': 2.9261}:  53%|█████▎    | 16/30 [00:35<00:30,  2.20s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 0.0195, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.915, 'compress@10': 1.0, 'time@10': 2.9144}:  53%|█████▎    | 16/30 [00:36<00:30,  2.20s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 0.0195, 'hit_ratio@10': 0.8546, 'ndcg@10': 0.915, 'compress@10': 1.0, 'time@10': 2.9144}:  57%|█████▋    | 17/30 [00:36<00:25,  1.96s/it]{'epoch': 44, 'num_users': 6.0556, 'loss': 0.0196, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9186, 'compress@10': 1.0, 'time@10': 2.8952}:  57%|█████▋    | 17/30 [00:39<00:25,  1.96s/it]{'epoch': 44, 'num_users': 6.0556, 'loss': 0.0196, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.9186, 'compress@10': 1.0, 'time@10': 2.8952}:  60%|██████    | 18/30 [00:39<00:25,  2.15s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 0.0188, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 2.8822}:  60%|██████    | 18/30 [00:40<00:25,  2.15s/it]   {'epoch': 44, 'num_users': 6.0, 'loss': 0.0188, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 2.8822}:  63%|██████▎   | 19/30 [00:40<00:21,  1.92s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 0.019, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 2.8577}:  63%|██████▎   | 19/30 [00:42<00:21,  1.92s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 0.019, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 2.8577}:  67%|██████▋   | 20/30 [00:42<00:20,  2.07s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 2.8586}:  67%|██████▋   | 20/30 [00:44<00:20,  2.07s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 2.8586}:  70%|███████   | 21/30 [00:44<00:17,  1.89s/it]{'epoch': 44, 'num_users': 6.1818, 'loss': 0.0193, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 2.8522}:  70%|███████   | 21/30 [00:47<00:17,  1.89s/it] {'epoch': 44, 'num_users': 6.1818, 'loss': 0.0193, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 2.8522}:  73%|███████▎  | 22/30 [00:47<00:17,  2.15s/it]{'epoch': 44, 'num_users': 6.1304, 'loss': 0.0189, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 2.8429}:  73%|███████▎  | 22/30 [00:48<00:17,  2.15s/it]{'epoch': 44, 'num_users': 6.1304, 'loss': 0.0189, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 2.8429}:  77%|███████▋  | 23/30 [00:48<00:13,  1.91s/it]{'epoch': 44, 'num_users': 5.9583, 'loss': 0.0181, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9141, 'compress@10': 1.0, 'time@10': 2.8346}:  77%|███████▋  | 23/30 [00:51<00:13,  1.91s/it]{'epoch': 44, 'num_users': 5.9583, 'loss': 0.0181, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9141, 'compress@10': 1.0, 'time@10': 2.8346}:  80%|████████  | 24/30 [00:51<00:12,  2.14s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 2.826}:  80%|████████  | 24/30 [00:52<00:12,  2.14s/it]     {'epoch': 44, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 2.826}:  83%|████████▎ | 25/30 [00:52<00:09,  1.90s/it]{'epoch': 44, 'num_users': 5.8077, 'loss': 0.0177, 'hit_ratio@10': 0.864, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 2.8484}:  83%|████████▎ | 25/30 [00:56<00:09,  1.90s/it]{'epoch': 44, 'num_users': 5.8077, 'loss': 0.0177, 'hit_ratio@10': 0.864, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 2.8484}:  87%|████████▋ | 26/30 [00:56<00:09,  2.37s/it]{'epoch': 44, 'num_users': 5.8889, 'loss': 0.0176, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9063, 'compress@10': 1.0, 'time@10': 2.8442}:  87%|████████▋ | 26/30 [00:57<00:09,  2.37s/it]{'epoch': 44, 'num_users': 5.8889, 'loss': 0.0176, 'hit_ratio@10': 0.8677, 'ndcg@10': 0.9063, 'compress@10': 1.0, 'time@10': 2.8442}:  90%|█████████ | 27/30 [00:57<00:06,  2.08s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 2.8473}:  90%|█████████ | 27/30 [01:00<00:06,  2.08s/it]    {'epoch': 44, 'num_users': 6.0, 'loss': 0.0182, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 2.8473}:  93%|█████████▎| 28/30 [01:00<00:04,  2.34s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 0.0183, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 2.8487}:  93%|█████████▎| 28/30 [01:01<00:04,  2.34s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 0.0183, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 2.8487}:  97%|█████████▋| 29/30 [01:01<00:02,  2.09s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0214, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9156, 'compress@10': 1.0, 'time@10': 2.8466}:  97%|█████████▋| 29/30 [01:04<00:02,  2.09s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0214, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9156, 'compress@10': 1.0, 'time@10': 2.8466}: 100%|██████████| 30/30 [01:04<00:00,  2.31s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 0.0214, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9156, 'compress@10': 1.0, 'time@10': 2.8466}: 100%|██████████| 30/30 [01:04<00:00,  2.16s/it]
Epoch: 44
Avg # of users: 5.866666666666666
Avg Loss: 0.021390393340399903
Avg hit ratio: 0.8744830411626298
Avg ndcg: 0.9155732897406584
Avg compression ratio: 0.9999999860153537
Avg train time: 2.8466313600540163
Std train time: 0.5815749603317263
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 32, 14, 1, 9, 8, 12, 6, 9, 8, 34, 8, 77, 7, 36, 49, 14, 15, 7, 5, 19, 10, 97, 95, 4, 7, 7, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 2.7516}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 2.7516}:   3%|▎         | 1/30 [00:01<00:41,  1.42s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9276, 'compress@10': 1.0, 'time@10': 2.6977}:   3%|▎         | 1/30 [00:04<00:41,  1.42s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9276, 'compress@10': 1.0, 'time@10': 2.6977}:   7%|▋         | 2/30 [00:04<01:00,  2.16s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9041, 'compress@10': 1.0, 'time@10': 2.6611}:   7%|▋         | 2/30 [00:05<01:00,  2.16s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9041, 'compress@10': 1.0, 'time@10': 2.6611}:  10%|█         | 3/30 [00:05<00:48,  1.78s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 2.6857}:  10%|█         | 3/30 [00:08<00:48,  1.78s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 2.6857}:  13%|█▎        | 4/30 [00:08<00:56,  2.18s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8616, 'compress@10': 1.0, 'time@10': 2.3019}:  13%|█▎        | 4/30 [00:08<00:56,  2.18s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8616, 'compress@10': 1.0, 'time@10': 2.3019}:  17%|█▋        | 5/30 [00:08<00:38,  1.55s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0401, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8751, 'compress@10': 1.0, 'time@10': 2.4112}:  17%|█▋        | 5/30 [00:11<00:38,  1.55s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0401, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8751, 'compress@10': 1.0, 'time@10': 2.4112}:  20%|██        | 6/30 [00:11<00:49,  2.04s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0378, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 2.5158}:  20%|██        | 6/30 [00:13<00:49,  2.04s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0378, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8784, 'compress@10': 1.0, 'time@10': 2.5158}:  23%|██▎       | 7/30 [00:13<00:43,  1.90s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0359, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8839, 'compress@10': 1.0, 'time@10': 2.5614}:  23%|██▎       | 7/30 [00:16<00:43,  1.90s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0359, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8839, 'compress@10': 1.0, 'time@10': 2.5614}:  27%|██▋       | 8/30 [00:16<00:49,  2.23s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0342, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8892, 'compress@10': 1.0, 'time@10': 2.6033}:  27%|██▋       | 8/30 [00:17<00:49,  2.23s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0342, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8892, 'compress@10': 1.0, 'time@10': 2.6033}:  30%|███       | 9/30 [00:17<00:42,  2.01s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.033, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8948, 'compress@10': 1.0, 'time@10': 2.6186}:  30%|███       | 9/30 [00:20<00:42,  2.01s/it]    {'epoch': 45, 'num_users': 6.3, 'loss': 0.033, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.8948, 'compress@10': 1.0, 'time@10': 2.6186}:  33%|███▎      | 10/30 [00:20<00:44,  2.25s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 0.0326, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 2.6565}:  33%|███▎      | 10/30 [00:22<00:44,  2.25s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 0.0326, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 2.6565}:  37%|███▋      | 11/30 [00:22<00:38,  2.04s/it]{'epoch': 45, 'num_users': 6.4167, 'loss': 0.0299, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8985, 'compress@10': 1.0, 'time@10': 2.6654}:  37%|███▋      | 11/30 [00:24<00:38,  2.04s/it] {'epoch': 45, 'num_users': 6.4167, 'loss': 0.0299, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8985, 'compress@10': 1.0, 'time@10': 2.6654}:  40%|████      | 12/30 [00:24<00:40,  2.27s/it]{'epoch': 45, 'num_users': 6.6154, 'loss': 0.0296, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8987, 'compress@10': 1.0, 'time@10': 2.6654}:  40%|████      | 12/30 [00:26<00:40,  2.27s/it]{'epoch': 45, 'num_users': 6.6154, 'loss': 0.0296, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8987, 'compress@10': 1.0, 'time@10': 2.6654}:  43%|████▎     | 13/30 [00:26<00:33,  2.00s/it]{'epoch': 45, 'num_users': 6.3571, 'loss': 0.0275, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 2.6715}:  43%|████▎     | 13/30 [00:29<00:33,  2.00s/it] {'epoch': 45, 'num_users': 6.3571, 'loss': 0.0275, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 2.6715}:  47%|████▋     | 14/30 [00:29<00:35,  2.24s/it]{'epoch': 45, 'num_users': 6.2667, 'loss': 0.0292, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 2.692}:  47%|████▋     | 14/30 [00:30<00:35,  2.24s/it]{'epoch': 45, 'num_users': 6.2667, 'loss': 0.0292, 'hit_ratio@10': 0.8514, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 2.692}:  50%|█████     | 15/30 [00:30<00:30,  2.02s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 0.0275, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 2.6966}:  50%|█████     | 15/30 [00:33<00:30,  2.02s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 0.0275, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 2.6966}:  53%|█████▎    | 16/30 [00:33<00:31,  2.26s/it]{'epoch': 45, 'num_users': 5.8235, 'loss': 0.0259, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 2.6978}:  53%|█████▎    | 16/30 [00:34<00:31,  2.26s/it]{'epoch': 45, 'num_users': 5.8235, 'loss': 0.0259, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 2.6978}:  57%|█████▋    | 17/30 [00:34<00:25,  2.00s/it]{'epoch': 45, 'num_users': 6.0556, 'loss': 0.0257, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8996, 'compress@10': 1.0, 'time@10': 2.703}:  57%|█████▋    | 17/30 [00:37<00:25,  2.00s/it] {'epoch': 45, 'num_users': 6.0556, 'loss': 0.0257, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8996, 'compress@10': 1.0, 'time@10': 2.703}:  60%|██████    | 18/30 [00:37<00:26,  2.25s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 0.0245, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.9011, 'compress@10': 1.0, 'time@10': 2.7049}:  60%|██████    | 18/30 [00:38<00:26,  2.25s/it]  {'epoch': 45, 'num_users': 6.0, 'loss': 0.0245, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.9011, 'compress@10': 1.0, 'time@10': 2.7049}:  63%|██████▎   | 19/30 [00:38<00:21,  2.00s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 0.0243, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 2.7157}:  63%|██████▎   | 19/30 [00:41<00:21,  2.00s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 0.0243, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 2.7157}:  67%|██████▋   | 20/30 [00:41<00:22,  2.28s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0253, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 2.7242}:  67%|██████▋   | 20/30 [00:43<00:22,  2.28s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0253, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 2.7242}:  70%|███████   | 21/30 [00:43<00:18,  2.04s/it]{'epoch': 45, 'num_users': 6.1818, 'loss': 0.0243, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9033, 'compress@10': 1.0, 'time@10': 2.7233}:  70%|███████   | 21/30 [00:46<00:18,  2.04s/it]{'epoch': 45, 'num_users': 6.1818, 'loss': 0.0243, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9033, 'compress@10': 1.0, 'time@10': 2.7233}:  73%|███████▎  | 22/30 [00:46<00:18,  2.25s/it]{'epoch': 45, 'num_users': 6.1304, 'loss': 0.0237, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9043, 'compress@10': 1.0, 'time@10': 2.7176}:  73%|███████▎  | 22/30 [00:47<00:18,  2.25s/it]{'epoch': 45, 'num_users': 6.1304, 'loss': 0.0237, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9043, 'compress@10': 1.0, 'time@10': 2.7176}:  77%|███████▋  | 23/30 [00:47<00:13,  1.98s/it]{'epoch': 45, 'num_users': 5.9583, 'loss': 0.0227, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 2.7106}:  77%|███████▋  | 23/30 [00:50<00:13,  1.98s/it]   {'epoch': 45, 'num_users': 5.9583, 'loss': 0.0227, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 2.7106}:  80%|████████  | 24/30 [00:50<00:12,  2.16s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 2.7055}:  80%|████████  | 24/30 [00:51<00:12,  2.16s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 2.7055}:  83%|████████▎ | 25/30 [00:51<00:09,  1.91s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 0.022, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 2.6901}:  83%|████████▎ | 25/30 [00:53<00:09,  1.91s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 0.022, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 2.6901}:  87%|████████▋ | 26/30 [00:53<00:08,  2.04s/it]{'epoch': 45, 'num_users': 5.8889, 'loss': 0.0215, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8941, 'compress@10': 1.0, 'time@10': 2.691}:  87%|████████▋ | 26/30 [00:55<00:08,  2.04s/it]{'epoch': 45, 'num_users': 5.8889, 'loss': 0.0215, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8941, 'compress@10': 1.0, 'time@10': 2.691}:  90%|█████████ | 27/30 [00:55<00:05,  1.85s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 0.0212, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 2.6865}:  90%|█████████ | 27/30 [00:57<00:05,  1.85s/it]  {'epoch': 45, 'num_users': 6.0, 'loss': 0.0212, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 2.6865}:  93%|█████████▎| 28/30 [00:57<00:04,  2.08s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 0.0208, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 2.6913}:  93%|█████████▎| 28/30 [00:59<00:04,  2.08s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 0.0208, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 2.6913}:  97%|█████████▋| 29/30 [00:59<00:01,  1.89s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.021, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9008, 'compress@10': 1.0, 'time@10': 2.6966}:  97%|█████████▋| 29/30 [01:02<00:01,  1.89s/it] {'epoch': 45, 'num_users': 5.8667, 'loss': 0.021, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9008, 'compress@10': 1.0, 'time@10': 2.6966}: 100%|██████████| 30/30 [01:02<00:00,  2.19s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 0.021, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9008, 'compress@10': 1.0, 'time@10': 2.6966}: 100%|██████████| 30/30 [01:02<00:00,  2.07s/it]
Epoch: 45
Avg # of users: 5.866666666666666
Avg Loss: 0.020958535416151735
Avg hit ratio: 0.8715527282460707
Avg ndcg: 0.9008069566676171
Avg compression ratio: 0.9999999860153537
Avg train time: 2.6966325998306275
Std train time: 0.39481281110743127
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 33, 14, 8, 8, 7, 12, 5, 9, 7, 34, 8, 77, 6, 36, 49, 14, 15, 7, 5, 19, 11, 98, 96, 6, 7, 8, 10, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 2.7607}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 2.7607}:   3%|▎         | 1/30 [00:01<00:41,  1.42s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 2.7054}:   3%|▎         | 1/30 [00:04<00:41,  1.42s/it] {'epoch': 46, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 2.7054}:   7%|▋         | 2/30 [00:04<01:00,  2.17s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 2.8005}:   7%|▋         | 2/30 [00:05<01:00,  2.17s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.8288, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 2.8005}:  10%|█         | 3/30 [00:05<00:50,  1.88s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9334, 'compress@10': 1.0, 'time@10': 2.7832}:  10%|█         | 3/30 [00:08<00:50,  1.88s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.9334, 'compress@10': 1.0, 'time@10': 2.7832}:  13%|█▎        | 4/30 [00:08<00:57,  2.23s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0232, 'hit_ratio@10': 0.867, 'ndcg@10': 0.915, 'compress@10': 1.0, 'time@10': 3.3738}:  13%|█▎        | 4/30 [00:11<00:57,  2.23s/it]  {'epoch': 46, 'num_users': 5.8, 'loss': 0.0232, 'hit_ratio@10': 0.867, 'ndcg@10': 0.915, 'compress@10': 1.0, 'time@10': 3.3738}:  17%|█▋        | 5/30 [00:11<01:01,  2.47s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0226, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9179, 'compress@10': 1.0, 'time@10': 3.2244}:  17%|█▋        | 5/30 [00:13<01:01,  2.47s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0226, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9179, 'compress@10': 1.0, 'time@10': 3.2244}:  20%|██        | 6/30 [00:13<00:59,  2.49s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 3.1028}:  20%|██        | 6/30 [00:15<00:59,  2.49s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 3.1028}:  23%|██▎       | 7/30 [00:15<00:47,  2.07s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0212, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9233, 'compress@10': 1.0, 'time@10': 3.0741}:  23%|██▎       | 7/30 [00:17<00:47,  2.07s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0212, 'hit_ratio@10': 0.9055, 'ndcg@10': 0.9233, 'compress@10': 1.0, 'time@10': 3.0741}:  27%|██▋       | 8/30 [00:17<00:51,  2.34s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9261, 'compress@10': 1.0, 'time@10': 3.0081}:  27%|██▋       | 8/30 [00:19<00:51,  2.34s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0213, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9261, 'compress@10': 1.0, 'time@10': 3.0081}:  30%|███       | 9/30 [00:19<00:42,  2.01s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9276, 'compress@10': 1.0, 'time@10': 2.9818}:  30%|███       | 9/30 [00:22<00:42,  2.01s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0211, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9276, 'compress@10': 1.0, 'time@10': 2.9818}:  33%|███▎      | 10/30 [00:22<00:44,  2.25s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 0.0217, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 2.96}:  33%|███▎      | 10/30 [00:23<00:44,  2.25s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 0.0217, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 2.96}:  37%|███▋      | 11/30 [00:23<00:37,  1.99s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 0.02, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9263, 'compress@10': 1.0, 'time@10': 2.9536}:  37%|███▋      | 11/30 [00:26<00:37,  1.99s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 0.02, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9263, 'compress@10': 1.0, 'time@10': 2.9536}:  40%|████      | 12/30 [00:26<00:40,  2.28s/it]{'epoch': 46, 'num_users': 6.6154, 'loss': 0.0202, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9244, 'compress@10': 1.0, 'time@10': 2.92}:  40%|████      | 12/30 [00:27<00:40,  2.28s/it]{'epoch': 46, 'num_users': 6.6154, 'loss': 0.0202, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9244, 'compress@10': 1.0, 'time@10': 2.92}:  43%|████▎     | 13/30 [00:27<00:33,  1.98s/it]{'epoch': 46, 'num_users': 6.3571, 'loss': 0.0188, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9179, 'compress@10': 1.0, 'time@10': 2.9036}:  43%|████▎     | 13/30 [00:30<00:33,  1.98s/it]{'epoch': 46, 'num_users': 6.3571, 'loss': 0.0188, 'hit_ratio@10': 0.8582, 'ndcg@10': 0.9179, 'compress@10': 1.0, 'time@10': 2.9036}:  47%|████▋     | 14/30 [00:30<00:35,  2.21s/it]{'epoch': 46, 'num_users': 6.2667, 'loss': 0.0201, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 2.8754}:  47%|████▋     | 14/30 [00:31<00:35,  2.21s/it]{'epoch': 46, 'num_users': 6.2667, 'loss': 0.0201, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 2.8754}:  50%|█████     | 15/30 [00:31<00:28,  1.93s/it]{'epoch': 46, 'num_users': 6.0625, 'loss': 0.0189, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 2.864}:  50%|█████     | 15/30 [00:34<00:28,  1.93s/it]  {'epoch': 46, 'num_users': 6.0625, 'loss': 0.0189, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 2.864}:  53%|█████▎    | 16/30 [00:34<00:30,  2.17s/it]{'epoch': 46, 'num_users': 5.8235, 'loss': 0.0178, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.9111, 'compress@10': 1.0, 'time@10': 2.8532}:  53%|█████▎    | 16/30 [00:35<00:30,  2.17s/it]{'epoch': 46, 'num_users': 5.8235, 'loss': 0.0178, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.9111, 'compress@10': 1.0, 'time@10': 2.8532}:  57%|█████▋    | 17/30 [00:35<00:25,  1.93s/it]{'epoch': 46, 'num_users': 6.0556, 'loss': 0.0181, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.9175, 'compress@10': 1.0, 'time@10': 2.8494}:  57%|█████▋    | 17/30 [00:38<00:25,  1.93s/it]{'epoch': 46, 'num_users': 6.0556, 'loss': 0.0181, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.9175, 'compress@10': 1.0, 'time@10': 2.8494}:  60%|██████    | 18/30 [00:38<00:26,  2.20s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 0.0174, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 2.8432}:  60%|██████    | 18/30 [00:40<00:26,  2.20s/it]   {'epoch': 46, 'num_users': 6.0, 'loss': 0.0174, 'hit_ratio@10': 0.8672, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 2.8432}:  63%|██████▎   | 19/30 [00:40<00:21,  1.96s/it]{'epoch': 46, 'num_users': 6.15, 'loss': 0.0178, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 2.8439}:  63%|██████▎   | 19/30 [00:42<00:21,  1.96s/it]{'epoch': 46, 'num_users': 6.15, 'loss': 0.0178, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 2.8439}:  67%|██████▋   | 20/30 [00:42<00:22,  2.24s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9172, 'compress@10': 1.0, 'time@10': 2.8446}:  67%|██████▋   | 20/30 [00:44<00:22,  2.24s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9172, 'compress@10': 1.0, 'time@10': 2.8446}:  70%|███████   | 21/30 [00:44<00:18,  2.01s/it]{'epoch': 46, 'num_users': 6.1818, 'loss': 0.0184, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9187, 'compress@10': 1.0, 'time@10': 2.839}:  70%|███████   | 21/30 [00:47<00:18,  2.01s/it] {'epoch': 46, 'num_users': 6.1818, 'loss': 0.0184, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9187, 'compress@10': 1.0, 'time@10': 2.839}:  73%|███████▎  | 22/30 [00:47<00:17,  2.23s/it]{'epoch': 46, 'num_users': 6.1304, 'loss': 0.018, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9196, 'compress@10': 1.0, 'time@10': 2.8434}:  73%|███████▎  | 22/30 [00:48<00:17,  2.23s/it]{'epoch': 46, 'num_users': 6.1304, 'loss': 0.018, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9196, 'compress@10': 1.0, 'time@10': 2.8434}:  77%|███████▋  | 23/30 [00:48<00:14,  2.01s/it]{'epoch': 46, 'num_users': 5.9583, 'loss': 0.0173, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9146, 'compress@10': 1.0, 'time@10': 2.8356}:  77%|███████▋  | 23/30 [00:51<00:14,  2.01s/it]{'epoch': 46, 'num_users': 5.9583, 'loss': 0.0173, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9146, 'compress@10': 1.0, 'time@10': 2.8356}:  80%|████████  | 24/30 [00:51<00:13,  2.22s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9047, 'compress@10': 1.0, 'time@10': 2.83}:  80%|████████  | 24/30 [00:52<00:13,  2.22s/it]     {'epoch': 46, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9047, 'compress@10': 1.0, 'time@10': 2.83}:  83%|████████▎ | 25/30 [00:52<00:09,  2.00s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 0.0168, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9058, 'compress@10': 1.0, 'time@10': 2.8527}:  83%|████████▎ | 25/30 [00:56<00:09,  2.00s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 0.0168, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9058, 'compress@10': 1.0, 'time@10': 2.8527}:  87%|████████▋ | 26/30 [00:56<00:09,  2.44s/it]{'epoch': 46, 'num_users': 5.8889, 'loss': 0.0166, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 2.848}:  87%|████████▋ | 26/30 [00:57<00:09,  2.44s/it] {'epoch': 46, 'num_users': 5.8889, 'loss': 0.0166, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 2.848}:  90%|█████████ | 27/30 [00:57<00:06,  2.13s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 0.0173, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9081, 'compress@10': 1.0, 'time@10': 2.8515}:  90%|█████████ | 27/30 [01:00<00:06,  2.13s/it]  {'epoch': 46, 'num_users': 6.0, 'loss': 0.0173, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9081, 'compress@10': 1.0, 'time@10': 2.8515}:  93%|█████████▎| 28/30 [01:00<00:04,  2.38s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 0.017, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 2.8549}:  93%|█████████▎| 28/30 [01:02<00:04,  2.38s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 0.017, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 2.8549}:  97%|█████████▋| 29/30 [01:02<00:02,  2.12s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.0171, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.911, 'compress@10': 1.0, 'time@10': 2.858}:  97%|█████████▋| 29/30 [01:05<00:02,  2.12s/it] {'epoch': 46, 'num_users': 5.8667, 'loss': 0.0171, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.911, 'compress@10': 1.0, 'time@10': 2.858}: 100%|██████████| 30/30 [01:05<00:00,  2.38s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 0.0171, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.911, 'compress@10': 1.0, 'time@10': 2.858}: 100%|██████████| 30/30 [01:05<00:00,  2.17s/it]
Epoch: 46
Avg # of users: 5.866666666666666
Avg Loss: 0.017091100895514504
Avg hit ratio: 0.8796380938586363
Avg ndcg: 0.9110185664695606
Avg compression ratio: 0.9999999860153537
Avg train time: 2.858004641532898
Std train time: 0.5698346088550441
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 12, 32, 14, 1, 9, 8, 12, 6, 9, 7, 34, 9, 77, 7, 36, 49, 14, 15, 7, 5, 19, 10, 98, 96, 4, 7, 7, 9, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 2.6261}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0179, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 2.6261}:   3%|▎         | 1/30 [00:01<00:39,  1.35s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0412, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 2.5796}:   3%|▎         | 1/30 [00:03<00:39,  1.35s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0412, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 2.5796}:   7%|▋         | 2/30 [00:03<00:57,  2.07s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 2.5611}:   7%|▋         | 2/30 [00:05<00:57,  2.07s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 2.5611}:  10%|█         | 3/30 [00:05<00:46,  1.72s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9605, 'compress@10': 1.0, 'time@10': 2.5845}:  10%|█         | 3/30 [00:07<00:46,  1.72s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9605, 'compress@10': 1.0, 'time@10': 2.5845}:  13%|█▎        | 4/30 [00:07<00:54,  2.10s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0558, 'hit_ratio@10': 0.7932, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 2.2127}:  13%|█▎        | 4/30 [00:08<00:54,  2.10s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0558, 'hit_ratio@10': 0.7932, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 2.2127}:  17%|█▋        | 5/30 [00:08<00:37,  1.49s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0508, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 2.3128}:  17%|█▋        | 5/30 [00:11<00:37,  1.49s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0508, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 2.3128}:  20%|██        | 6/30 [00:11<00:46,  1.95s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0481, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 2.3704}:  20%|██        | 6/30 [00:12<00:46,  1.95s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0481, 'hit_ratio@10': 0.8434, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 2.3704}:  23%|██▎       | 7/30 [00:12<00:40,  1.77s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0474, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.9112, 'compress@10': 1.0, 'time@10': 2.4272}:  23%|██▎       | 7/30 [00:15<00:40,  1.77s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0474, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.9112, 'compress@10': 1.0, 'time@10': 2.4272}:  27%|██▋       | 8/30 [00:15<00:46,  2.12s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0443, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.9136, 'compress@10': 1.0, 'time@10': 2.4818}:  27%|██▋       | 8/30 [00:16<00:46,  2.12s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0443, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.9136, 'compress@10': 1.0, 'time@10': 2.4818}:  30%|███       | 9/30 [00:16<00:40,  1.92s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0412, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 2.5195}:  30%|███       | 9/30 [00:19<00:40,  1.92s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0412, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 2.5195}:  33%|███▎      | 10/30 [00:19<00:44,  2.22s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 0.0397, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.92, 'compress@10': 1.0, 'time@10': 2.552}:  33%|███▎      | 10/30 [00:21<00:44,  2.22s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 0.0397, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.92, 'compress@10': 1.0, 'time@10': 2.552}:  37%|███▋      | 11/30 [00:21<00:37,  2.00s/it]{'epoch': 47, 'num_users': 6.4167, 'loss': 0.0365, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 2.5637}:  37%|███▋      | 11/30 [00:24<00:37,  2.00s/it]{'epoch': 47, 'num_users': 6.4167, 'loss': 0.0365, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 2.5637}:  40%|████      | 12/30 [00:24<00:40,  2.22s/it]{'epoch': 47, 'num_users': 6.6154, 'loss': 0.0355, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.9184, 'compress@10': 1.0, 'time@10': 2.5921}:  40%|████      | 12/30 [00:25<00:40,  2.22s/it]{'epoch': 47, 'num_users': 6.6154, 'loss': 0.0355, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.9184, 'compress@10': 1.0, 'time@10': 2.5921}:  43%|████▎     | 13/30 [00:25<00:34,  2.00s/it]{'epoch': 47, 'num_users': 6.3571, 'loss': 0.033, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9123, 'compress@10': 1.0, 'time@10': 2.6056}:  43%|████▎     | 13/30 [00:28<00:34,  2.00s/it] {'epoch': 47, 'num_users': 6.3571, 'loss': 0.033, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9123, 'compress@10': 1.0, 'time@10': 2.6056}:  47%|████▋     | 14/30 [00:28<00:36,  2.25s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 0.0331, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9108, 'compress@10': 1.0, 'time@10': 2.6455}:  47%|████▋     | 14/30 [00:30<00:36,  2.25s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 0.0331, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9108, 'compress@10': 1.0, 'time@10': 2.6455}:  50%|█████     | 15/30 [00:30<00:31,  2.07s/it]{'epoch': 47, 'num_users': 6.0625, 'loss': 0.0311, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9112, 'compress@10': 1.0, 'time@10': 2.6579}:  50%|█████     | 15/30 [00:32<00:31,  2.07s/it] {'epoch': 47, 'num_users': 6.0625, 'loss': 0.0311, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9112, 'compress@10': 1.0, 'time@10': 2.6579}:  53%|█████▎    | 16/30 [00:32<00:32,  2.31s/it]{'epoch': 47, 'num_users': 5.8235, 'loss': 0.0293, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9047, 'compress@10': 1.0, 'time@10': 2.671}:  53%|█████▎    | 16/30 [00:34<00:32,  2.31s/it]{'epoch': 47, 'num_users': 5.8235, 'loss': 0.0293, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.9047, 'compress@10': 1.0, 'time@10': 2.671}:  57%|█████▋    | 17/30 [00:34<00:26,  2.06s/it]{'epoch': 47, 'num_users': 6.0556, 'loss': 0.0291, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9113, 'compress@10': 1.0, 'time@10': 2.6841}:  57%|█████▋    | 17/30 [00:37<00:26,  2.06s/it]{'epoch': 47, 'num_users': 6.0556, 'loss': 0.0291, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9113, 'compress@10': 1.0, 'time@10': 2.6841}:  60%|██████    | 18/30 [00:37<00:27,  2.33s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 0.0277, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.9122, 'compress@10': 1.0, 'time@10': 2.6914}:  60%|██████    | 18/30 [00:38<00:27,  2.33s/it]  {'epoch': 47, 'num_users': 6.0, 'loss': 0.0277, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.9122, 'compress@10': 1.0, 'time@10': 2.6914}:  63%|██████▎   | 19/30 [00:38<00:22,  2.06s/it]{'epoch': 47, 'num_users': 6.15, 'loss': 0.0276, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9137, 'compress@10': 1.0, 'time@10': 2.7073}:  63%|██████▎   | 19/30 [00:41<00:22,  2.06s/it]{'epoch': 47, 'num_users': 6.15, 'loss': 0.0276, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9137, 'compress@10': 1.0, 'time@10': 2.7073}:  67%|██████▋   | 20/30 [00:41<00:23,  2.36s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.9124, 'compress@10': 1.0, 'time@10': 2.7361}:  67%|██████▋   | 20/30 [00:43<00:23,  2.36s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0281, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.9124, 'compress@10': 1.0, 'time@10': 2.7361}:  70%|███████   | 21/30 [00:43<00:19,  2.16s/it]{'epoch': 47, 'num_users': 6.1818, 'loss': 0.0275, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9138, 'compress@10': 1.0, 'time@10': 2.7467}:  70%|███████   | 21/30 [00:46<00:19,  2.16s/it]{'epoch': 47, 'num_users': 6.1818, 'loss': 0.0275, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9138, 'compress@10': 1.0, 'time@10': 2.7467}:  73%|███████▎  | 22/30 [00:46<00:19,  2.41s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 0.0267, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9149, 'compress@10': 1.0, 'time@10': 2.7486}:  73%|███████▎  | 22/30 [00:47<00:19,  2.41s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 0.0267, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9149, 'compress@10': 1.0, 'time@10': 2.7486}:  77%|███████▋  | 23/30 [00:47<00:14,  2.12s/it]{'epoch': 47, 'num_users': 5.9583, 'loss': 0.0256, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9101, 'compress@10': 1.0, 'time@10': 2.75}:  77%|███████▋  | 23/30 [00:50<00:14,  2.12s/it]  {'epoch': 47, 'num_users': 5.9583, 'loss': 0.0256, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9101, 'compress@10': 1.0, 'time@10': 2.75}:  80%|████████  | 24/30 [00:50<00:13,  2.33s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0245, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 2.7504}:  80%|████████  | 24/30 [00:52<00:13,  2.33s/it] {'epoch': 47, 'num_users': 5.8, 'loss': 0.0245, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 2.7504}:  83%|████████▎ | 25/30 [00:52<00:10,  2.06s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 0.0245, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9015, 'compress@10': 1.0, 'time@10': 2.7399}:  83%|████████▎ | 25/30 [00:54<00:10,  2.06s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 0.0245, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9015, 'compress@10': 1.0, 'time@10': 2.7399}:  87%|████████▋ | 26/30 [00:54<00:08,  2.21s/it]{'epoch': 47, 'num_users': 5.8889, 'loss': 0.0241, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 2.7398}:  87%|████████▋ | 26/30 [00:56<00:08,  2.21s/it]{'epoch': 47, 'num_users': 5.8889, 'loss': 0.0241, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 2.7398}:  90%|█████████ | 27/30 [00:56<00:05,  1.97s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 0.0237, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9046, 'compress@10': 1.0, 'time@10': 2.7432}:  90%|█████████ | 27/30 [00:58<00:05,  1.97s/it]   {'epoch': 47, 'num_users': 6.0, 'loss': 0.0237, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9046, 'compress@10': 1.0, 'time@10': 2.7432}:  93%|█████████▎| 28/30 [00:58<00:04,  2.24s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 0.0231, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9062, 'compress@10': 1.0, 'time@10': 2.7473}:  93%|█████████▎| 28/30 [01:00<00:04,  2.24s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 0.0231, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9062, 'compress@10': 1.0, 'time@10': 2.7473}:  97%|█████████▋| 29/30 [01:00<00:02,  2.01s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0225, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9083, 'compress@10': 1.0, 'time@10': 2.742}:  97%|█████████▋| 29/30 [01:03<00:02,  2.01s/it] {'epoch': 47, 'num_users': 5.8667, 'loss': 0.0225, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9083, 'compress@10': 1.0, 'time@10': 2.742}: 100%|██████████| 30/30 [01:03<00:00,  2.19s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 0.0225, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9083, 'compress@10': 1.0, 'time@10': 2.742}: 100%|██████████| 30/30 [01:03<00:00,  2.10s/it]
Epoch: 47
Avg # of users: 5.866666666666666
Avg Loss: 0.02250755787071167
Avg hit ratio: 0.8731852224559712
Avg ndcg: 0.9082975847818097
Avg compression ratio: 0.9999999860153537
Avg train time: 2.742034689585368
Std train time: 0.4139018720457997
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 33, 14, 8, 9, 8, 12, 6, 9, 7, 34, 8, 77, 6, 36, 49, 14, 15, 6, 3, 18, 10, 98, 96, 5, 7, 7, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9118, 'compress@10': 1.0, 'time@10': 2.8683}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9118, 'compress@10': 1.0, 'time@10': 2.8683}:   3%|▎         | 1/30 [00:01<00:42,  1.47s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9301, 'compress@10': 1.0, 'time@10': 2.8769}:   3%|▎         | 1/30 [00:04<00:42,  1.47s/it] {'epoch': 48, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9301, 'compress@10': 1.0, 'time@10': 2.8769}:   7%|▋         | 2/30 [00:04<01:05,  2.33s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9057, 'compress@10': 1.0, 'time@10': 2.8782}:   7%|▋         | 2/30 [00:05<01:05,  2.33s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9057, 'compress@10': 1.0, 'time@10': 2.8782}:  10%|█         | 3/30 [00:05<00:52,  1.94s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.932, 'compress@10': 1.0, 'time@10': 2.8364}:  10%|█         | 3/30 [00:08<00:52,  1.94s/it]   {'epoch': 48, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.932, 'compress@10': 1.0, 'time@10': 2.8364}:  13%|█▎        | 4/30 [00:08<00:58,  2.26s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9168, 'compress@10': 1.0, 'time@10': 3.4333}:  13%|█▎        | 4/30 [00:11<00:58,  2.26s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9168, 'compress@10': 1.0, 'time@10': 3.4333}:  17%|█▋        | 5/30 [00:11<01:02,  2.52s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.024, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9212, 'compress@10': 1.0, 'time@10': 3.3633}:  17%|█▋        | 5/30 [00:14<01:02,  2.52s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.024, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9212, 'compress@10': 1.0, 'time@10': 3.3633}:  20%|██        | 6/30 [00:14<01:04,  2.70s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0259, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9099, 'compress@10': 1.0, 'time@10': 3.301}:  20%|██        | 6/30 [00:16<01:04,  2.70s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0259, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9099, 'compress@10': 1.0, 'time@10': 3.301}:  23%|██▎       | 7/30 [00:16<00:53,  2.31s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9217, 'compress@10': 1.0, 'time@10': 3.2922}:  23%|██▎       | 7/30 [00:19<00:53,  2.31s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.9073, 'ndcg@10': 0.9217, 'compress@10': 1.0, 'time@10': 3.2922}:  27%|██▋       | 8/30 [00:19<00:57,  2.61s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 3.2842}:  27%|██▋       | 8/30 [00:21<00:57,  2.61s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 3.2842}:  30%|███       | 9/30 [00:21<00:48,  2.31s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9265, 'compress@10': 1.0, 'time@10': 3.2465}:  30%|███       | 9/30 [00:24<00:48,  2.31s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9265, 'compress@10': 1.0, 'time@10': 3.2465}:  33%|███▎      | 10/30 [00:24<00:50,  2.51s/it]{'epoch': 48, 'num_users': 6.6364, 'loss': 0.026, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9265, 'compress@10': 1.0, 'time@10': 3.207}:  33%|███▎      | 10/30 [00:25<00:50,  2.51s/it]{'epoch': 48, 'num_users': 6.6364, 'loss': 0.026, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9265, 'compress@10': 1.0, 'time@10': 3.207}:  37%|███▋      | 11/30 [00:25<00:41,  2.18s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 0.024, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.1766}:  37%|███▋      | 11/30 [00:28<00:41,  2.18s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 0.024, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.1766}:  40%|████      | 12/30 [00:28<00:43,  2.40s/it]{'epoch': 48, 'num_users': 6.6154, 'loss': 0.0236, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 3.1337}:  40%|████      | 12/30 [00:29<00:43,  2.40s/it]{'epoch': 48, 'num_users': 6.6154, 'loss': 0.0236, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 3.1337}:  43%|████▎     | 13/30 [00:29<00:35,  2.08s/it]{'epoch': 48, 'num_users': 6.3571, 'loss': 0.0219, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9183, 'compress@10': 1.0, 'time@10': 3.111}:  43%|████▎     | 13/30 [00:32<00:35,  2.08s/it]  {'epoch': 48, 'num_users': 6.3571, 'loss': 0.0219, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9183, 'compress@10': 1.0, 'time@10': 3.111}:  47%|████▋     | 14/30 [00:32<00:37,  2.33s/it]{'epoch': 48, 'num_users': 6.2667, 'loss': 0.0217, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9175, 'compress@10': 1.0, 'time@10': 3.0817}:  47%|████▋     | 14/30 [00:33<00:37,  2.33s/it]{'epoch': 48, 'num_users': 6.2667, 'loss': 0.0217, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9175, 'compress@10': 1.0, 'time@10': 3.0817}:  50%|█████     | 15/30 [00:33<00:30,  2.04s/it]{'epoch': 48, 'num_users': 6.0625, 'loss': 0.0204, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9174, 'compress@10': 1.0, 'time@10': 3.0719}:  50%|█████     | 15/30 [00:36<00:30,  2.04s/it] {'epoch': 48, 'num_users': 6.0625, 'loss': 0.0204, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9174, 'compress@10': 1.0, 'time@10': 3.0719}:  53%|█████▎    | 16/30 [00:36<00:32,  2.32s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 0.0192, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9105, 'compress@10': 1.0, 'time@10': 3.0519}:  53%|█████▎    | 16/30 [00:38<00:32,  2.32s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 0.0192, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9105, 'compress@10': 1.0, 'time@10': 3.0519}:  57%|█████▋    | 17/30 [00:38<00:26,  2.05s/it]{'epoch': 48, 'num_users': 6.0556, 'loss': 0.0196, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 3.0463}:  57%|█████▋    | 17/30 [00:41<00:26,  2.05s/it]{'epoch': 48, 'num_users': 6.0556, 'loss': 0.0196, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 3.0463}:  60%|██████    | 18/30 [00:41<00:27,  2.33s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 0.0187, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9183, 'compress@10': 1.0, 'time@10': 3.0411}:  60%|██████    | 18/30 [00:42<00:27,  2.33s/it]    {'epoch': 48, 'num_users': 6.0, 'loss': 0.0187, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9183, 'compress@10': 1.0, 'time@10': 3.0411}:  63%|██████▎   | 19/30 [00:42<00:22,  2.08s/it]{'epoch': 48, 'num_users': 6.15, 'loss': 0.0187, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9193, 'compress@10': 1.0, 'time@10': 3.0226}:  63%|██████▎   | 19/30 [00:45<00:22,  2.08s/it]{'epoch': 48, 'num_users': 6.15, 'loss': 0.0187, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9193, 'compress@10': 1.0, 'time@10': 3.0226}:  67%|██████▋   | 20/30 [00:45<00:22,  2.27s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 2.9619}:  67%|██████▋   | 20/30 [00:46<00:22,  2.27s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 2.9619}:  70%|███████   | 21/30 [00:46<00:16,  1.86s/it]{'epoch': 48, 'num_users': 6.1818, 'loss': 0.0197, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.917, 'compress@10': 1.0, 'time@10': 2.9432}:  70%|███████   | 21/30 [00:49<00:16,  1.86s/it] {'epoch': 48, 'num_users': 6.1818, 'loss': 0.0197, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.917, 'compress@10': 1.0, 'time@10': 2.9432}:  73%|███████▎  | 22/30 [00:49<00:16,  2.08s/it]{'epoch': 48, 'num_users': 6.1304, 'loss': 0.0193, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 2.9441}:  73%|███████▎  | 22/30 [00:50<00:16,  2.08s/it]{'epoch': 48, 'num_users': 6.1304, 'loss': 0.0193, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 2.9441}:  77%|███████▋  | 23/30 [00:50<00:13,  1.91s/it]{'epoch': 48, 'num_users': 5.9583, 'loss': 0.0185, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9128, 'compress@10': 1.0, 'time@10': 2.9362}:  77%|███████▋  | 23/30 [00:53<00:13,  1.91s/it]{'epoch': 48, 'num_users': 5.9583, 'loss': 0.0185, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9128, 'compress@10': 1.0, 'time@10': 2.9362}:  80%|████████  | 24/30 [00:53<00:13,  2.18s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 2.9339}:  80%|████████  | 24/30 [00:54<00:13,  2.18s/it]   {'epoch': 48, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 2.9339}:  83%|████████▎ | 25/30 [00:54<00:09,  1.97s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 0.0179, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9041, 'compress@10': 1.0, 'time@10': 2.9431}:  83%|████████▎ | 25/30 [00:58<00:09,  1.97s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 0.0179, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9041, 'compress@10': 1.0, 'time@10': 2.9431}:  87%|████████▋ | 26/30 [00:58<00:09,  2.35s/it]{'epoch': 48, 'num_users': 5.8889, 'loss': 0.0177, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 2.9501}:  87%|████████▋ | 26/30 [00:59<00:09,  2.35s/it] {'epoch': 48, 'num_users': 5.8889, 'loss': 0.0177, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 2.9501}:  90%|█████████ | 27/30 [00:59<00:06,  2.12s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 0.0178, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 2.9434}:  90%|█████████ | 27/30 [01:02<00:06,  2.12s/it]  {'epoch': 48, 'num_users': 6.0, 'loss': 0.0178, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 2.9434}:  93%|█████████▎| 28/30 [01:02<00:04,  2.33s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 0.0173, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.908, 'compress@10': 1.0, 'time@10': 2.9324}:  93%|█████████▎| 28/30 [01:03<00:04,  2.33s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 0.0173, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.908, 'compress@10': 1.0, 'time@10': 2.9324}:  97%|█████████▋| 29/30 [01:03<00:02,  2.04s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0175, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9082, 'compress@10': 1.0, 'time@10': 2.9314}:  97%|█████████▋| 29/30 [01:06<00:02,  2.04s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0175, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9082, 'compress@10': 1.0, 'time@10': 2.9314}: 100%|██████████| 30/30 [01:06<00:00,  2.31s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 0.0175, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9082, 'compress@10': 1.0, 'time@10': 2.9314}: 100%|██████████| 30/30 [01:06<00:00,  2.23s/it]
Epoch: 48
Avg # of users: 5.866666666666666
Avg Loss: 0.01750119359253543
Avg hit ratio: 0.8817986700302483
Avg ndcg: 0.9081919593583031
Avg compression ratio: 0.9999999860153537
Avg train time: 2.931436030069987
Std train time: 0.5971372219619959
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 33, 14, 1, 8, 7, 11, 5, 9, 7, 34, 8, 77, 6, 35, 49, 13, 14, 6, 6, 19, 9, 98, 96, 4, 6, 7, 9, 11]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9107, 'compress@10': 1.0, 'time@10': 2.7641}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9107, 'compress@10': 1.0, 'time@10': 2.7641}:   3%|▎         | 1/30 [00:01<00:41,  1.42s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9449, 'compress@10': 1.0, 'time@10': 2.8224}:   3%|▎         | 1/30 [00:04<00:41,  1.42s/it] {'epoch': 49, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9449, 'compress@10': 1.0, 'time@10': 2.8224}:   7%|▋         | 2/30 [00:04<01:04,  2.30s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9157, 'compress@10': 1.0, 'time@10': 2.79}:   7%|▋         | 2/30 [00:05<01:04,  2.30s/it]  {'epoch': 49, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9157, 'compress@10': 1.0, 'time@10': 2.79}:  10%|█         | 3/30 [00:05<00:50,  1.89s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9077, 'compress@10': 1.0, 'time@10': 2.7949}:  10%|█         | 3/30 [00:08<00:50,  1.89s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9077, 'compress@10': 1.0, 'time@10': 2.7949}:  13%|█▎        | 4/30 [00:08<00:58,  2.27s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8465, 'compress@10': 1.0, 'time@10': 2.3844}:  13%|█▎        | 4/30 [00:08<00:58,  2.27s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.8113, 'ndcg@10': 0.8465, 'compress@10': 1.0, 'time@10': 2.3844}:  17%|█▋        | 5/30 [00:08<00:39,  1.60s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0418, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 2.4297}:  17%|█▋        | 5/30 [00:11<00:39,  1.60s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0418, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 2.4297}:  20%|██        | 6/30 [00:11<00:47,  1.97s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0391, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 2.4346}:  20%|██        | 6/30 [00:12<00:47,  1.97s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0391, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 2.4346}:  23%|██▎       | 7/30 [00:12<00:40,  1.74s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0371, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8865, 'compress@10': 1.0, 'time@10': 2.485}:  23%|██▎       | 7/30 [00:15<00:40,  1.74s/it]  {'epoch': 49, 'num_users': 6.125, 'loss': 0.0371, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8865, 'compress@10': 1.0, 'time@10': 2.485}:  27%|██▋       | 8/30 [00:15<00:46,  2.10s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0353, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 2.4988}:  27%|██▋       | 8/30 [00:17<00:46,  2.10s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0353, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 2.4988}:  30%|███       | 9/30 [00:17<00:39,  1.87s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0338, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 2.5402}:  30%|███       | 9/30 [00:20<00:39,  1.87s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0338, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 2.5402}:  33%|███▎      | 10/30 [00:20<00:44,  2.20s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 0.0329, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 2.5488}:  33%|███▎      | 10/30 [00:21<00:44,  2.20s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 0.0329, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 2.5488}:  37%|███▋      | 11/30 [00:21<00:36,  1.94s/it]{'epoch': 49, 'num_users': 6.4167, 'loss': 0.0303, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.9018, 'compress@10': 1.0, 'time@10': 2.5606}:  37%|███▋      | 11/30 [00:24<00:36,  1.94s/it]{'epoch': 49, 'num_users': 6.4167, 'loss': 0.0303, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.9018, 'compress@10': 1.0, 'time@10': 2.5606}:  40%|████      | 12/30 [00:24<00:39,  2.18s/it]{'epoch': 49, 'num_users': 6.6154, 'loss': 0.03, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 2.5674}:  40%|████      | 12/30 [00:25<00:39,  2.18s/it]   {'epoch': 49, 'num_users': 6.6154, 'loss': 0.03, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 2.5674}:  43%|████▎     | 13/30 [00:25<00:32,  1.93s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 0.0278, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 2.5771}:  43%|████▎     | 13/30 [00:28<00:32,  1.93s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 0.0278, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 2.5771}:  47%|████▋     | 14/30 [00:28<00:34,  2.18s/it]{'epoch': 49, 'num_users': 6.2667, 'loss': 0.0274, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 2.5883}:  47%|████▋     | 14/30 [00:29<00:34,  2.18s/it]{'epoch': 49, 'num_users': 6.2667, 'loss': 0.0274, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 2.5883}:  50%|█████     | 15/30 [00:29<00:29,  1.95s/it]{'epoch': 49, 'num_users': 6.0625, 'loss': 0.0259, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8985, 'compress@10': 1.0, 'time@10': 2.5985}:  50%|█████     | 15/30 [00:32<00:29,  1.95s/it]{'epoch': 49, 'num_users': 6.0625, 'loss': 0.0259, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8985, 'compress@10': 1.0, 'time@10': 2.5985}:  53%|█████▎    | 16/30 [00:32<00:30,  2.20s/it]{'epoch': 49, 'num_users': 5.8235, 'loss': 0.0243, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8928, 'compress@10': 1.0, 'time@10': 2.6042}:  53%|█████▎    | 16/30 [00:33<00:30,  2.20s/it]{'epoch': 49, 'num_users': 5.8235, 'loss': 0.0243, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8928, 'compress@10': 1.0, 'time@10': 2.6042}:  57%|█████▋    | 17/30 [00:33<00:25,  1.95s/it]{'epoch': 49, 'num_users': 6.0556, 'loss': 0.0241, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 2.6078}:  57%|█████▋    | 17/30 [00:36<00:25,  1.95s/it]{'epoch': 49, 'num_users': 6.0556, 'loss': 0.0241, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8957, 'compress@10': 1.0, 'time@10': 2.6078}:  60%|██████    | 18/30 [00:36<00:26,  2.18s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 0.023, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 2.6106}:  60%|██████    | 18/30 [00:37<00:26,  2.18s/it]    {'epoch': 49, 'num_users': 6.0, 'loss': 0.023, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 2.6106}:  63%|██████▎   | 19/30 [00:37<00:21,  1.94s/it]{'epoch': 49, 'num_users': 6.15, 'loss': 0.0227, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8993, 'compress@10': 1.0, 'time@10': 2.6135}:  63%|██████▎   | 19/30 [00:40<00:21,  1.94s/it]{'epoch': 49, 'num_users': 6.15, 'loss': 0.0227, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.8993, 'compress@10': 1.0, 'time@10': 2.6135}:  67%|██████▋   | 20/30 [00:40<00:21,  2.17s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8987, 'compress@10': 1.0, 'time@10': 2.6696}:  67%|██████▋   | 20/30 [00:42<00:21,  2.17s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8987, 'compress@10': 1.0, 'time@10': 2.6696}:  70%|███████   | 21/30 [00:42<00:18,  2.10s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 0.0226, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 2.6781}:  70%|███████   | 21/30 [00:45<00:18,  2.10s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 0.0226, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9012, 'compress@10': 1.0, 'time@10': 2.6781}:  73%|███████▎  | 22/30 [00:45<00:18,  2.34s/it]{'epoch': 49, 'num_users': 6.1304, 'loss': 0.022, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9025, 'compress@10': 1.0, 'time@10': 2.6772}:  73%|███████▎  | 22/30 [00:46<00:18,  2.34s/it] {'epoch': 49, 'num_users': 6.1304, 'loss': 0.022, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9025, 'compress@10': 1.0, 'time@10': 2.6772}:  77%|███████▋  | 23/30 [00:46<00:14,  2.04s/it]{'epoch': 49, 'num_users': 5.9583, 'loss': 0.0211, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 2.6825}:  77%|███████▋  | 23/30 [00:49<00:14,  2.04s/it]{'epoch': 49, 'num_users': 5.9583, 'loss': 0.0211, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 2.6825}:  80%|████████  | 24/30 [00:49<00:13,  2.29s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0203, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8889, 'compress@10': 1.0, 'time@10': 2.6902}:  80%|████████  | 24/30 [00:51<00:13,  2.29s/it]   {'epoch': 49, 'num_users': 5.8, 'loss': 0.0203, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8889, 'compress@10': 1.0, 'time@10': 2.6902}:  83%|████████▎ | 25/30 [00:51<00:10,  2.04s/it]{'epoch': 49, 'num_users': 5.8077, 'loss': 0.0203, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8905, 'compress@10': 1.0, 'time@10': 2.6776}:  83%|████████▎ | 25/30 [00:53<00:10,  2.04s/it]{'epoch': 49, 'num_users': 5.8077, 'loss': 0.0203, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8905, 'compress@10': 1.0, 'time@10': 2.6776}:  87%|████████▋ | 26/30 [00:53<00:08,  2.20s/it]{'epoch': 49, 'num_users': 5.8889, 'loss': 0.0201, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 2.6738}:  87%|████████▋ | 26/30 [00:55<00:08,  2.20s/it] {'epoch': 49, 'num_users': 5.8889, 'loss': 0.0201, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 2.6738}:  90%|█████████ | 27/30 [00:55<00:05,  1.94s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 0.0205, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 2.6766}:  90%|█████████ | 27/30 [00:57<00:05,  1.94s/it]   {'epoch': 49, 'num_users': 6.0, 'loss': 0.0205, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 2.6766}:  93%|█████████▎| 28/30 [00:57<00:04,  2.19s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 0.0201, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 2.6775}:  93%|█████████▎| 28/30 [00:59<00:04,  2.19s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 0.0201, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 2.6775}:  97%|█████████▋| 29/30 [00:59<00:01,  1.95s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0199, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8976, 'compress@10': 1.0, 'time@10': 2.6852}:  97%|█████████▋| 29/30 [01:02<00:01,  1.95s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0199, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8976, 'compress@10': 1.0, 'time@10': 2.6852}: 100%|██████████| 30/30 [01:02<00:00,  2.25s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 0.0199, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.8976, 'compress@10': 1.0, 'time@10': 2.6852}: 100%|██████████| 30/30 [01:02<00:00,  2.07s/it]
Epoch: 49
Avg # of users: 5.866666666666666
Avg Loss: 0.019894260942952123
Avg hit ratio: 0.8702408513609815
Avg ndcg: 0.8975505078822104
Avg compression ratio: 0.9999999860153537
Avg train time: 2.685158443450928
Std train time: 0.42641275801715456
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 13, 33, 14, 8, 8, 8, 11, 6, 9, 7, 34, 8, 77, 6, 35, 49, 13, 14, 6, 3, 19, 9, 98, 96, 5, 7, 7, 9, 11]
