  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1271, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.5622, 'compress@10': 1.0, 'time@10': 3.7288}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1271, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.5622, 'compress@10': 1.0, 'time@10': 3.7288}:   3%|▎         | 1/30 [00:01<00:55,  1.90s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0938, 'hit_ratio@10': 0.7292, 'ndcg@10': 0.705, 'compress@10': 1.0, 'time@10': 2.9697}:   3%|▎         | 1/30 [00:04<00:55,  1.90s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.0938, 'hit_ratio@10': 0.7292, 'ndcg@10': 0.705, 'compress@10': 1.0, 'time@10': 2.9697}:   7%|▋         | 2/30 [00:04<00:58,  2.10s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6978, 'hit_ratio@10': 0.5338, 'ndcg@10': 0.4786, 'compress@10': 1.0, 'time@10': 2.2625}:   7%|▋         | 2/30 [00:04<00:58,  2.10s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6978, 'hit_ratio@10': 0.5338, 'ndcg@10': 0.4786, 'compress@10': 1.0, 'time@10': 2.2625}:  10%|█         | 3/30 [00:04<00:36,  1.35s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5401, 'hit_ratio@10': 0.6057, 'ndcg@10': 0.5692, 'compress@10': 1.0, 'time@10': 2.1683}:  10%|█         | 3/30 [00:06<00:36,  1.35s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5401, 'hit_ratio@10': 0.6057, 'ndcg@10': 0.5692, 'compress@10': 1.0, 'time@10': 2.1683}:  13%|█▎        | 4/30 [00:06<00:40,  1.57s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4506, 'hit_ratio@10': 0.6485, 'ndcg@10': 0.6116, 'compress@10': 1.0, 'time@10': 3.1942}:  13%|█▎        | 4/30 [00:10<00:40,  1.57s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4506, 'hit_ratio@10': 0.6485, 'ndcg@10': 0.6116, 'compress@10': 1.0, 'time@10': 3.1942}:  17%|█▋        | 5/30 [00:10<00:58,  2.33s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.3896, 'hit_ratio@10': 0.6553, 'ndcg@10': 0.6451, 'compress@10': 1.0, 'time@10': 3.2139}:  17%|█▋        | 5/30 [00:13<00:58,  2.33s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.3896, 'hit_ratio@10': 0.6553, 'ndcg@10': 0.6451, 'compress@10': 1.0, 'time@10': 3.2139}:  20%|██        | 6/30 [00:13<01:04,  2.68s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3453, 'hit_ratio@10': 0.6874, 'ndcg@10': 0.6472, 'compress@10': 1.0, 'time@10': 3.2578}:  20%|██        | 6/30 [00:15<01:04,  2.68s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3453, 'hit_ratio@10': 0.6874, 'ndcg@10': 0.6472, 'compress@10': 1.0, 'time@10': 3.2578}:  23%|██▎       | 7/30 [00:15<00:55,  2.39s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3074, 'hit_ratio@10': 0.7157, 'ndcg@10': 0.6745, 'compress@10': 1.0, 'time@10': 3.1599}:  23%|██▎       | 7/30 [00:17<00:55,  2.39s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3074, 'hit_ratio@10': 0.7157, 'ndcg@10': 0.6745, 'compress@10': 1.0, 'time@10': 3.1599}:  27%|██▋       | 8/30 [00:17<00:53,  2.43s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2778, 'hit_ratio@10': 0.7187, 'ndcg@10': 0.7014, 'compress@10': 1.0, 'time@10': 3.3697}:  27%|██▋       | 8/30 [00:20<00:53,  2.43s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2778, 'hit_ratio@10': 0.7187, 'ndcg@10': 0.7014, 'compress@10': 1.0, 'time@10': 3.3697}:  30%|███       | 9/30 [00:20<00:51,  2.47s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2552, 'hit_ratio@10': 0.7401, 'ndcg@10': 0.7158, 'compress@10': 1.0, 'time@10': 3.3451}:  30%|███       | 9/30 [00:23<00:51,  2.47s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2552, 'hit_ratio@10': 0.7401, 'ndcg@10': 0.7158, 'compress@10': 1.0, 'time@10': 3.3451}:  33%|███▎      | 10/30 [00:23<00:53,  2.69s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.2405, 'hit_ratio@10': 0.7462, 'ndcg@10': 0.7199, 'compress@10': 1.0, 'time@10': 3.3849}:  33%|███▎      | 10/30 [00:25<00:53,  2.69s/it]{'epoch': 0, 'num_users': 6.6364, 'loss': 0.2405, 'hit_ratio@10': 0.7462, 'ndcg@10': 0.7199, 'compress@10': 1.0, 'time@10': 3.3849}:  37%|███▋      | 11/30 [00:25<00:46,  2.46s/it]{'epoch': 0, 'num_users': 6.4167, 'loss': 0.2832, 'hit_ratio@10': 0.7257, 'ndcg@10': 0.6726, 'compress@10': 1.0, 'time@10': 3.1671}:  37%|███▋      | 11/30 [00:26<00:46,  2.46s/it]{'epoch': 0, 'num_users': 6.4167, 'loss': 0.2832, 'hit_ratio@10': 0.7257, 'ndcg@10': 0.6726, 'compress@10': 1.0, 'time@10': 3.1671}:  40%|████      | 12/30 [00:26<00:35,  1.95s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.2706, 'hit_ratio@10': 0.7258, 'ndcg@10': 0.6736, 'compress@10': 1.0, 'time@10': 3.1678}:  40%|████      | 12/30 [00:27<00:35,  1.95s/it]{'epoch': 0, 'num_users': 6.6154, 'loss': 0.2706, 'hit_ratio@10': 0.7258, 'ndcg@10': 0.6736, 'compress@10': 1.0, 'time@10': 3.1678}:  43%|████▎     | 13/30 [00:27<00:31,  1.85s/it]{'epoch': 0, 'num_users': 6.3571, 'loss': 0.4374, 'hit_ratio@10': 0.6859, 'ndcg@10': 0.6255, 'compress@10': 1.0, 'time@10': 2.967}:  43%|████▎     | 13/30 [00:28<00:31,  1.85s/it] {'epoch': 0, 'num_users': 6.3571, 'loss': 0.4374, 'hit_ratio@10': 0.6859, 'ndcg@10': 0.6255, 'compress@10': 1.0, 'time@10': 2.967}:  47%|████▋     | 14/30 [00:28<00:22,  1.41s/it]{'epoch': 0, 'num_users': 6.2667, 'loss': 0.4126, 'hit_ratio@10': 0.7025, 'ndcg@10': 0.6367, 'compress@10': 1.0, 'time@10': 3.0504}:  47%|████▋     | 14/30 [00:30<00:22,  1.41s/it]{'epoch': 0, 'num_users': 6.2667, 'loss': 0.4126, 'hit_ratio@10': 0.7025, 'ndcg@10': 0.6367, 'compress@10': 1.0, 'time@10': 3.0504}:  50%|█████     | 15/30 [00:30<00:24,  1.63s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.4222, 'hit_ratio@10': 0.6899, 'ndcg@10': 0.6082, 'compress@10': 1.0, 'time@10': 2.9089}:  50%|█████     | 15/30 [00:31<00:24,  1.63s/it]{'epoch': 0, 'num_users': 6.0625, 'loss': 0.4222, 'hit_ratio@10': 0.6899, 'ndcg@10': 0.6082, 'compress@10': 1.0, 'time@10': 2.9089}:  53%|█████▎    | 16/30 [00:31<00:19,  1.39s/it]{'epoch': 0, 'num_users': 5.8235, 'loss': 0.53, 'hit_ratio@10': 0.6728, 'ndcg@10': 0.5725, 'compress@10': 1.0, 'time@10': 2.7701}:  53%|█████▎    | 16/30 [00:31<00:19,  1.39s/it]  {'epoch': 0, 'num_users': 5.8235, 'loss': 0.53, 'hit_ratio@10': 0.6728, 'ndcg@10': 0.5725, 'compress@10': 1.0, 'time@10': 2.7701}:  57%|█████▋    | 17/30 [00:31<00:13,  1.06s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.5052, 'hit_ratio@10': 0.6791, 'ndcg@10': 0.5849, 'compress@10': 1.0, 'time@10': 2.7304}:  57%|█████▋    | 17/30 [00:33<00:13,  1.06s/it]{'epoch': 0, 'num_users': 6.0556, 'loss': 0.5052, 'hit_ratio@10': 0.6791, 'ndcg@10': 0.5849, 'compress@10': 1.0, 'time@10': 2.7304}:  60%|██████    | 18/30 [00:33<00:16,  1.37s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.49, 'hit_ratio@10': 0.6734, 'ndcg@10': 0.5808, 'compress@10': 1.0, 'time@10': 2.6851}:  60%|██████    | 18/30 [00:34<00:16,  1.37s/it]     {'epoch': 0, 'num_users': 6.0, 'loss': 0.49, 'hit_ratio@10': 0.6734, 'ndcg@10': 0.5808, 'compress@10': 1.0, 'time@10': 2.6851}:  63%|██████▎   | 19/30 [00:34<00:13,  1.25s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.4691, 'hit_ratio@10': 0.6801, 'ndcg@10': 0.5909, 'compress@10': 1.0, 'time@10': 2.7575}:  63%|██████▎   | 19/30 [00:38<00:13,  1.25s/it]{'epoch': 0, 'num_users': 6.15, 'loss': 0.4691, 'hit_ratio@10': 0.6801, 'ndcg@10': 0.5909, 'compress@10': 1.0, 'time@10': 2.7575}:  67%|██████▋   | 20/30 [00:38<00:21,  2.12s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.4505, 'hit_ratio@10': 0.6858, 'ndcg@10': 0.6018, 'compress@10': 1.0, 'time@10': 2.9059}:  67%|██████▋   | 20/30 [00:41<00:21,  2.12s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.4505, 'hit_ratio@10': 0.6858, 'ndcg@10': 0.6018, 'compress@10': 1.0, 'time@10': 2.9059}:  70%|███████   | 21/30 [00:41<00:21,  2.38s/it]{'epoch': 0, 'num_users': 6.1818, 'loss': 0.4345, 'hit_ratio@10': 0.696, 'ndcg@10': 0.6026, 'compress@10': 1.0, 'time@10': 2.8394}:  70%|███████   | 21/30 [00:43<00:21,  2.38s/it] {'epoch': 0, 'num_users': 6.1818, 'loss': 0.4345, 'hit_ratio@10': 0.696, 'ndcg@10': 0.6026, 'compress@10': 1.0, 'time@10': 2.8394}:  73%|███████▎  | 22/30 [00:43<00:16,  2.11s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 0.4198, 'hit_ratio@10': 0.7026, 'ndcg@10': 0.601, 'compress@10': 1.0, 'time@10': 2.8344}:  73%|███████▎  | 22/30 [00:44<00:16,  2.11s/it]{'epoch': 0, 'num_users': 6.1304, 'loss': 0.4198, 'hit_ratio@10': 0.7026, 'ndcg@10': 0.601, 'compress@10': 1.0, 'time@10': 2.8344}:  77%|███████▋  | 23/30 [00:44<00:13,  1.89s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.5017, 'hit_ratio@10': 0.6734, 'ndcg@10': 0.576, 'compress@10': 1.0, 'time@10': 2.7279}:  77%|███████▋  | 23/30 [00:44<00:13,  1.89s/it]{'epoch': 0, 'num_users': 5.9583, 'loss': 0.5017, 'hit_ratio@10': 0.6734, 'ndcg@10': 0.576, 'compress@10': 1.0, 'time@10': 2.7279}:  80%|████████  | 24/30 [00:44<00:08,  1.42s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5642, 'hit_ratio@10': 0.6464, 'ndcg@10': 0.5529, 'compress@10': 1.0, 'time@10': 2.6312}:  80%|████████  | 24/30 [00:45<00:08,  1.42s/it]  {'epoch': 0, 'num_users': 5.8, 'loss': 0.5642, 'hit_ratio@10': 0.6464, 'ndcg@10': 0.5529, 'compress@10': 1.0, 'time@10': 2.6312}:  83%|████████▎ | 25/30 [00:45<00:05,  1.05s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.5462, 'hit_ratio@10': 0.6535, 'ndcg@10': 0.5606, 'compress@10': 1.0, 'time@10': 2.7484}:  83%|████████▎ | 25/30 [00:50<00:05,  1.05s/it]{'epoch': 0, 'num_users': 5.8077, 'loss': 0.5462, 'hit_ratio@10': 0.6535, 'ndcg@10': 0.5606, 'compress@10': 1.0, 'time@10': 2.7484}:  87%|████████▋ | 26/30 [00:50<00:09,  2.45s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.5277, 'hit_ratio@10': 0.6623, 'ndcg@10': 0.5697, 'compress@10': 1.0, 'time@10': 2.7985}:  87%|████████▋ | 26/30 [00:52<00:09,  2.45s/it]{'epoch': 0, 'num_users': 5.8889, 'loss': 0.5277, 'hit_ratio@10': 0.6623, 'ndcg@10': 0.5697, 'compress@10': 1.0, 'time@10': 2.7985}:  90%|█████████ | 27/30 [00:53<00:07,  2.35s/it]{'epoch': 0, 'num_users': 6.0, 'loss': 0.5111, 'hit_ratio@10': 0.6688, 'ndcg@10': 0.5805, 'compress@10': 1.0, 'time@10': 2.8327}:  90%|█████████ | 27/30 [00:56<00:07,  2.35s/it]   {'epoch': 0, 'num_users': 6.0, 'loss': 0.5111, 'hit_ratio@10': 0.6688, 'ndcg@10': 0.5805, 'compress@10': 1.0, 'time@10': 2.8327}:  93%|█████████▎| 28/30 [00:56<00:05,  2.78s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.4965, 'hit_ratio@10': 0.6771, 'ndcg@10': 0.5804, 'compress@10': 1.0, 'time@10': 2.8354}:  93%|█████████▎| 28/30 [00:58<00:05,  2.78s/it]{'epoch': 0, 'num_users': 5.8621, 'loss': 0.4965, 'hit_ratio@10': 0.6771, 'ndcg@10': 0.5804, 'compress@10': 1.0, 'time@10': 2.8354}:  97%|█████████▋| 29/30 [00:58<00:02,  2.39s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.4815, 'hit_ratio@10': 0.6806, 'ndcg@10': 0.591, 'compress@10': 1.0, 'time@10': 2.8262}:  97%|█████████▋| 29/30 [01:00<00:02,  2.39s/it] {'epoch': 0, 'num_users': 5.8667, 'loss': 0.4815, 'hit_ratio@10': 0.6806, 'ndcg@10': 0.591, 'compress@10': 1.0, 'time@10': 2.8262}: 100%|██████████| 30/30 [01:00<00:00,  2.45s/it]{'epoch': 0, 'num_users': 5.8667, 'loss': 0.4815, 'hit_ratio@10': 0.6806, 'ndcg@10': 0.591, 'compress@10': 1.0, 'time@10': 2.8262}: 100%|██████████| 30/30 [01:00<00:00,  2.03s/it]
Epoch: 0
Avg # of users: 5.866666666666666
Avg Loss: 0.4814719076783021
Avg hit ratio: 0.6806347994282703
Avg ndcg: 0.591019225603113
Avg compression ratio: 1.0
Avg train time: 2.826230589548747
Std train time: 1.7555925128230996
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 2.6251}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 2.6251}:   3%|▎         | 1/30 [00:01<00:39,  1.35s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0542, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 2.3067}:   3%|▎         | 1/30 [00:03<00:39,  1.35s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0542, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 2.3067}:   7%|▋         | 2/30 [00:03<00:48,  1.74s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.038, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8457, 'compress@10': 1.0, 'time@10': 1.7731}:   7%|▋         | 2/30 [00:03<00:48,  1.74s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.038, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8457, 'compress@10': 1.0, 'time@10': 1.7731}:  10%|█         | 3/30 [00:03<00:30,  1.12s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0422, 'hit_ratio@10': 0.7481, 'ndcg@10': 0.8452, 'compress@10': 1.0, 'time@10': 1.8219}:  10%|█         | 3/30 [00:05<00:30,  1.12s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0422, 'hit_ratio@10': 0.7481, 'ndcg@10': 0.8452, 'compress@10': 1.0, 'time@10': 1.8219}:  13%|█▎        | 4/30 [00:05<00:38,  1.47s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.052, 'hit_ratio@10': 0.7624, 'ndcg@10': 0.8341, 'compress@10': 1.0, 'time@10': 2.9112}:  13%|█▎        | 4/30 [00:09<00:38,  1.47s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.052, 'hit_ratio@10': 0.7624, 'ndcg@10': 0.8341, 'compress@10': 1.0, 'time@10': 2.9112}:  17%|█▋        | 5/30 [00:09<00:56,  2.26s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0575, 'hit_ratio@10': 0.7539, 'ndcg@10': 0.8275, 'compress@10': 1.0, 'time@10': 2.9558}:  17%|█▋        | 5/30 [00:12<00:56,  2.26s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0575, 'hit_ratio@10': 0.7539, 'ndcg@10': 0.8275, 'compress@10': 1.0, 'time@10': 2.9558}:  20%|██        | 6/30 [00:12<01:02,  2.59s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0559, 'hit_ratio@10': 0.7776, 'ndcg@10': 0.8317, 'compress@10': 1.0, 'time@10': 3.0255}:  20%|██        | 6/30 [00:14<01:02,  2.59s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0559, 'hit_ratio@10': 0.7776, 'ndcg@10': 0.8317, 'compress@10': 1.0, 'time@10': 3.0255}:  23%|██▎       | 7/30 [00:14<00:53,  2.32s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0555, 'hit_ratio@10': 0.7983, 'ndcg@10': 0.8288, 'compress@10': 1.0, 'time@10': 2.9473}:  23%|██▎       | 7/30 [00:16<00:53,  2.32s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0555, 'hit_ratio@10': 0.7983, 'ndcg@10': 0.8288, 'compress@10': 1.0, 'time@10': 2.9473}:  27%|██▋       | 8/30 [00:16<00:51,  2.35s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0567, 'hit_ratio@10': 0.7953, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 3.1659}:  27%|██▋       | 8/30 [00:19<00:51,  2.35s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0567, 'hit_ratio@10': 0.7953, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 3.1659}:  30%|███       | 9/30 [00:19<00:50,  2.39s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0572, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8521, 'compress@10': 1.0, 'time@10': 3.1542}:  30%|███       | 9/30 [00:22<00:50,  2.39s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0572, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8521, 'compress@10': 1.0, 'time@10': 3.1542}:  33%|███▎      | 10/30 [00:22<00:52,  2.61s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0582, 'hit_ratio@10': 0.8068, 'ndcg@10': 0.8525, 'compress@10': 1.0, 'time@10': 3.2092}:  33%|███▎      | 10/30 [00:24<00:52,  2.61s/it]{'epoch': 1, 'num_users': 6.6364, 'loss': 0.0582, 'hit_ratio@10': 0.8068, 'ndcg@10': 0.8525, 'compress@10': 1.0, 'time@10': 3.2092}:  37%|███▋      | 11/30 [00:24<00:45,  2.39s/it]{'epoch': 1, 'num_users': 6.4167, 'loss': 0.0552, 'hit_ratio@10': 0.802, 'ndcg@10': 0.8586, 'compress@10': 1.0, 'time@10': 3.0055}:  37%|███▋      | 11/30 [00:25<00:45,  2.39s/it] {'epoch': 1, 'num_users': 6.4167, 'loss': 0.0552, 'hit_ratio@10': 0.802, 'ndcg@10': 0.8586, 'compress@10': 1.0, 'time@10': 3.0055}:  40%|████      | 12/30 [00:25<00:34,  1.91s/it]{'epoch': 1, 'num_users': 6.6154, 'loss': 0.0549, 'hit_ratio@10': 0.8068, 'ndcg@10': 0.8597, 'compress@10': 1.0, 'time@10': 3.0107}:  40%|████      | 12/30 [00:26<00:34,  1.91s/it]{'epoch': 1, 'num_users': 6.6154, 'loss': 0.0549, 'hit_ratio@10': 0.8068, 'ndcg@10': 0.8597, 'compress@10': 1.0, 'time@10': 3.0107}:  43%|████▎     | 13/30 [00:26<00:30,  1.80s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.0553, 'hit_ratio@10': 0.7968, 'ndcg@10': 0.8546, 'compress@10': 1.0, 'time@10': 2.8199}:  43%|████▎     | 13/30 [00:27<00:30,  1.80s/it]{'epoch': 1, 'num_users': 6.3571, 'loss': 0.0553, 'hit_ratio@10': 0.7968, 'ndcg@10': 0.8546, 'compress@10': 1.0, 'time@10': 2.8199}:  47%|████▋     | 14/30 [00:27<00:21,  1.37s/it]{'epoch': 1, 'num_users': 6.2667, 'loss': 0.0557, 'hit_ratio@10': 0.806, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 2.9137}:  47%|████▋     | 14/30 [00:29<00:21,  1.37s/it] {'epoch': 1, 'num_users': 6.2667, 'loss': 0.0557, 'hit_ratio@10': 0.806, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 2.9137}:  50%|█████     | 15/30 [00:29<00:24,  1.60s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.0534, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.8589, 'compress@10': 1.0, 'time@10': 2.778}:  50%|█████     | 15/30 [00:29<00:24,  1.60s/it]{'epoch': 1, 'num_users': 6.0625, 'loss': 0.0534, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.8589, 'compress@10': 1.0, 'time@10': 2.778}:  53%|█████▎    | 16/30 [00:29<00:18,  1.35s/it]{'epoch': 1, 'num_users': 5.8235, 'loss': 0.0544, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8395, 'compress@10': 1.0, 'time@10': 2.6454}:  53%|█████▎    | 16/30 [00:30<00:18,  1.35s/it]{'epoch': 1, 'num_users': 5.8235, 'loss': 0.0544, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8395, 'compress@10': 1.0, 'time@10': 2.6454}:  57%|█████▋    | 17/30 [00:30<00:13,  1.03s/it]{'epoch': 1, 'num_users': 6.0556, 'loss': 0.055, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8401, 'compress@10': 1.0, 'time@10': 2.6051}:  57%|█████▋    | 17/30 [00:32<00:13,  1.03s/it] {'epoch': 1, 'num_users': 6.0556, 'loss': 0.055, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8401, 'compress@10': 1.0, 'time@10': 2.6051}:  60%|██████    | 18/30 [00:32<00:15,  1.31s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.0531, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 2.5627}:  60%|██████    | 18/30 [00:33<00:15,  1.31s/it]  {'epoch': 1, 'num_users': 6.0, 'loss': 0.0531, 'hit_ratio@10': 0.8094, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 2.5627}:  63%|██████▎   | 19/30 [00:33<00:13,  1.19s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.0541, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 2.6386}:  63%|██████▎   | 19/30 [00:37<00:13,  1.19s/it]{'epoch': 1, 'num_users': 6.15, 'loss': 0.0541, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 2.6386}:  67%|██████▋   | 20/30 [00:37<00:20,  2.07s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0556, 'hit_ratio@10': 0.8085, 'ndcg@10': 0.8391, 'compress@10': 1.0, 'time@10': 2.7835}:  67%|██████▋   | 20/30 [00:40<00:20,  2.07s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0556, 'hit_ratio@10': 0.8085, 'ndcg@10': 0.8391, 'compress@10': 1.0, 'time@10': 2.7835}:  70%|███████   | 21/30 [00:40<00:20,  2.31s/it]{'epoch': 1, 'num_users': 6.1818, 'loss': 0.0549, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8425, 'compress@10': 1.0, 'time@10': 2.7242}:  70%|███████   | 21/30 [00:41<00:20,  2.31s/it] {'epoch': 1, 'num_users': 6.1818, 'loss': 0.0549, 'hit_ratio@10': 0.813, 'ndcg@10': 0.8425, 'compress@10': 1.0, 'time@10': 2.7242}:  73%|███████▎  | 22/30 [00:41<00:16,  2.07s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.0536, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 2.7273}:  73%|███████▎  | 22/30 [00:43<00:16,  2.07s/it]{'epoch': 1, 'num_users': 6.1304, 'loss': 0.0536, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 2.7273}:  77%|███████▋  | 23/30 [00:43<00:13,  1.88s/it]{'epoch': 1, 'num_users': 5.9583, 'loss': 0.055, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8317, 'compress@10': 1.0, 'time@10': 2.625}:  77%|███████▋  | 23/30 [00:43<00:13,  1.88s/it]   {'epoch': 1, 'num_users': 5.9583, 'loss': 0.055, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8317, 'compress@10': 1.0, 'time@10': 2.625}:  80%|████████  | 24/30 [00:43<00:08,  1.40s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0598, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.8104, 'compress@10': 1.0, 'time@10': 2.5311}:  80%|████████  | 24/30 [00:43<00:08,  1.40s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0598, 'hit_ratio@10': 0.7948, 'ndcg@10': 0.8104, 'compress@10': 1.0, 'time@10': 2.5311}:  83%|████████▎ | 25/30 [00:43<00:05,  1.04s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.0611, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8082, 'compress@10': 1.0, 'time@10': 2.6526}:  83%|████████▎ | 25/30 [00:49<00:05,  1.04s/it]{'epoch': 1, 'num_users': 5.8077, 'loss': 0.0611, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8082, 'compress@10': 1.0, 'time@10': 2.6526}:  87%|████████▋ | 26/30 [00:49<00:09,  2.44s/it]{'epoch': 1, 'num_users': 5.8889, 'loss': 0.0603, 'hit_ratio@10': 0.801, 'ndcg@10': 0.8104, 'compress@10': 1.0, 'time@10': 2.6971}:  87%|████████▋ | 26/30 [00:51<00:09,  2.44s/it] {'epoch': 1, 'num_users': 5.8889, 'loss': 0.0603, 'hit_ratio@10': 0.801, 'ndcg@10': 0.8104, 'compress@10': 1.0, 'time@10': 2.6971}:  90%|█████████ | 27/30 [00:51<00:06,  2.30s/it]{'epoch': 1, 'num_users': 6.0, 'loss': 0.0607, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.813, 'compress@10': 1.0, 'time@10': 2.7318}:  90%|█████████ | 27/30 [00:54<00:06,  2.30s/it]   {'epoch': 1, 'num_users': 6.0, 'loss': 0.0607, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.813, 'compress@10': 1.0, 'time@10': 2.7318}:  93%|█████████▎| 28/30 [00:54<00:05,  2.72s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.0592, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8162, 'compress@10': 1.0, 'time@10': 2.7372}:  93%|█████████▎| 28/30 [00:56<00:05,  2.72s/it]{'epoch': 1, 'num_users': 5.8621, 'loss': 0.0592, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8162, 'compress@10': 1.0, 'time@10': 2.7372}:  97%|█████████▋| 29/30 [00:56<00:02,  2.34s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0588, 'hit_ratio@10': 0.803, 'ndcg@10': 0.8185, 'compress@10': 1.0, 'time@10': 2.731}:  97%|█████████▋| 29/30 [00:58<00:02,  2.34s/it]  {'epoch': 1, 'num_users': 5.8667, 'loss': 0.0588, 'hit_ratio@10': 0.803, 'ndcg@10': 0.8185, 'compress@10': 1.0, 'time@10': 2.731}: 100%|██████████| 30/30 [00:58<00:00,  2.42s/it]{'epoch': 1, 'num_users': 5.8667, 'loss': 0.0588, 'hit_ratio@10': 0.803, 'ndcg@10': 0.8185, 'compress@10': 1.0, 'time@10': 2.731}: 100%|██████████| 30/30 [00:58<00:00,  1.96s/it]
Epoch: 1
Avg # of users: 5.866666666666666
Avg Loss: 0.0587587336536692
Avg hit ratio: 0.8030158753495938
Avg ndcg: 0.8185116648292703
Avg compression ratio: 1.0
Avg train time: 2.730968451499939
Std train time: 1.731836257471696
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 2.5724}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 2.5724}:   3%|▎         | 1/30 [00:01<00:38,  1.31s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0514, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8506, 'compress@10': 1.0, 'time@10': 2.382}:   3%|▎         | 1/30 [00:03<00:38,  1.31s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0514, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8506, 'compress@10': 1.0, 'time@10': 2.382}:   7%|▋         | 2/30 [00:03<00:51,  1.85s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0365, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8527, 'compress@10': 1.0, 'time@10': 1.8702}:   7%|▋         | 2/30 [00:03<00:51,  1.85s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0365, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8527, 'compress@10': 1.0, 'time@10': 1.8702}:  10%|█         | 3/30 [00:03<00:32,  1.21s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0397, 'hit_ratio@10': 0.7918, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 1.8747}:  10%|█         | 3/30 [00:05<00:32,  1.21s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0397, 'hit_ratio@10': 0.7918, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 1.8747}:  13%|█▎        | 4/30 [00:05<00:38,  1.49s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0496, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8363, 'compress@10': 1.0, 'time@10': 2.9703}:  13%|█▎        | 4/30 [00:09<00:38,  1.49s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0496, 'hit_ratio@10': 0.8055, 'ndcg@10': 0.8363, 'compress@10': 1.0, 'time@10': 2.9703}:  17%|█▋        | 5/30 [00:09<00:57,  2.29s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0547, 'hit_ratio@10': 0.7934, 'ndcg@10': 0.8327, 'compress@10': 1.0, 'time@10': 2.9618}:  17%|█▋        | 5/30 [00:12<00:57,  2.29s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0547, 'hit_ratio@10': 0.7934, 'ndcg@10': 0.8327, 'compress@10': 1.0, 'time@10': 2.9618}:  20%|██        | 6/30 [00:12<01:00,  2.51s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0529, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8364, 'compress@10': 1.0, 'time@10': 2.9846}:  20%|██        | 6/30 [00:14<01:00,  2.51s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0529, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8364, 'compress@10': 1.0, 'time@10': 2.9846}:  23%|██▎       | 7/30 [00:14<00:50,  2.21s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0509, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.841, 'compress@10': 1.0, 'time@10': 2.9108}:  23%|██▎       | 7/30 [00:16<00:50,  2.21s/it]  {'epoch': 2, 'num_users': 6.125, 'loss': 0.0509, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.841, 'compress@10': 1.0, 'time@10': 2.9108}:  27%|██▋       | 8/30 [00:16<00:50,  2.28s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.049, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 3.1236}:  27%|██▋       | 8/30 [00:19<00:50,  2.28s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.049, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 3.1236}:  30%|███       | 9/30 [00:19<00:48,  2.33s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8487, 'compress@10': 1.0, 'time@10': 3.129}:  30%|███       | 9/30 [00:22<00:48,  2.33s/it]    {'epoch': 2, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8487, 'compress@10': 1.0, 'time@10': 3.129}:  33%|███▎      | 10/30 [00:22<00:52,  2.60s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.05, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 3.1816}:  33%|███▎      | 10/30 [00:24<00:52,  2.60s/it]{'epoch': 2, 'num_users': 6.6364, 'loss': 0.05, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 3.1816}:  37%|███▋      | 11/30 [00:24<00:45,  2.38s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0482, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 2.9795}:  37%|███▋      | 11/30 [00:24<00:45,  2.38s/it]{'epoch': 2, 'num_users': 6.4167, 'loss': 0.0482, 'hit_ratio@10': 0.8191, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 2.9795}:  40%|████      | 12/30 [00:24<00:34,  1.90s/it]{'epoch': 2, 'num_users': 6.6154, 'loss': 0.0484, 'hit_ratio@10': 0.819, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 2.9872}:  40%|████      | 12/30 [00:26<00:34,  1.90s/it] {'epoch': 2, 'num_users': 6.6154, 'loss': 0.0484, 'hit_ratio@10': 0.819, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 2.9872}:  43%|████▎     | 13/30 [00:26<00:30,  1.80s/it]{'epoch': 2, 'num_users': 6.3571, 'loss': 0.047, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8546, 'compress@10': 1.0, 'time@10': 2.7984}:  43%|████▎     | 13/30 [00:26<00:30,  1.80s/it]{'epoch': 2, 'num_users': 6.3571, 'loss': 0.047, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8546, 'compress@10': 1.0, 'time@10': 2.7984}:  47%|████▋     | 14/30 [00:26<00:21,  1.37s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.0476, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 2.8949}:  47%|████▋     | 14/30 [00:28<00:21,  1.37s/it]{'epoch': 2, 'num_users': 6.2667, 'loss': 0.0476, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 2.8949}:  50%|█████     | 15/30 [00:28<00:24,  1.60s/it]{'epoch': 2, 'num_users': 6.0625, 'loss': 0.046, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8564, 'compress@10': 1.0, 'time@10': 2.7605}:  50%|█████     | 15/30 [00:29<00:24,  1.60s/it] {'epoch': 2, 'num_users': 6.0625, 'loss': 0.046, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8564, 'compress@10': 1.0, 'time@10': 2.7605}:  53%|█████▎    | 16/30 [00:29<00:18,  1.35s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.0451, 'hit_ratio@10': 0.8098, 'ndcg@10': 0.8488, 'compress@10': 1.0, 'time@10': 2.6303}:  53%|█████▎    | 16/30 [00:30<00:18,  1.35s/it]{'epoch': 2, 'num_users': 5.8235, 'loss': 0.0451, 'hit_ratio@10': 0.8098, 'ndcg@10': 0.8488, 'compress@10': 1.0, 'time@10': 2.6303}:  57%|█████▋    | 17/30 [00:30<00:13,  1.04s/it]{'epoch': 2, 'num_users': 6.0556, 'loss': 0.046, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 2.5985}:  57%|█████▋    | 17/30 [00:32<00:13,  1.04s/it] {'epoch': 2, 'num_users': 6.0556, 'loss': 0.046, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 2.5985}:  60%|██████    | 18/30 [00:32<00:16,  1.35s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.0447, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 2.5696}:  60%|██████    | 18/30 [00:33<00:16,  1.35s/it]  {'epoch': 2, 'num_users': 6.0, 'loss': 0.0447, 'hit_ratio@10': 0.8147, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 2.5696}:  63%|██████▎   | 19/30 [00:33<00:13,  1.26s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0459, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8482, 'compress@10': 1.0, 'time@10': 2.6488}:  63%|██████▎   | 19/30 [00:37<00:13,  1.26s/it]{'epoch': 2, 'num_users': 6.15, 'loss': 0.0459, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8482, 'compress@10': 1.0, 'time@10': 2.6488}:  67%|██████▋   | 20/30 [00:37<00:21,  2.14s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8464, 'compress@10': 1.0, 'time@10': 2.8015}:  67%|██████▋   | 20/30 [00:40<00:21,  2.14s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.8464, 'compress@10': 1.0, 'time@10': 2.8015}:  70%|███████   | 21/30 [00:40<00:21,  2.39s/it]{'epoch': 2, 'num_users': 6.1818, 'loss': 0.0467, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8485, 'compress@10': 1.0, 'time@10': 2.7403}:  70%|███████   | 21/30 [00:41<00:21,  2.39s/it]{'epoch': 2, 'num_users': 6.1818, 'loss': 0.0467, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8485, 'compress@10': 1.0, 'time@10': 2.7403}:  73%|███████▎  | 22/30 [00:41<00:16,  2.11s/it]{'epoch': 2, 'num_users': 6.1304, 'loss': 0.0457, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8507, 'compress@10': 1.0, 'time@10': 2.7374}:  73%|███████▎  | 22/30 [00:43<00:16,  2.11s/it]{'epoch': 2, 'num_users': 6.1304, 'loss': 0.0457, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8507, 'compress@10': 1.0, 'time@10': 2.7374}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it]{'epoch': 2, 'num_users': 5.9583, 'loss': 0.0465, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8423, 'compress@10': 1.0, 'time@10': 2.6347}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it]{'epoch': 2, 'num_users': 5.9583, 'loss': 0.0465, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8423, 'compress@10': 1.0, 'time@10': 2.6347}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0488, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8242, 'compress@10': 1.0, 'time@10': 2.5406}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]   {'epoch': 2, 'num_users': 5.8, 'loss': 0.0488, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8242, 'compress@10': 1.0, 'time@10': 2.5406}:  83%|████████▎ | 25/30 [00:43<00:05,  1.04s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.0505, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8215, 'compress@10': 1.0, 'time@10': 2.6616}:  83%|████████▎ | 25/30 [00:49<00:05,  1.04s/it]{'epoch': 2, 'num_users': 5.8077, 'loss': 0.0505, 'hit_ratio@10': 0.8099, 'ndcg@10': 0.8215, 'compress@10': 1.0, 'time@10': 2.6616}:  87%|████████▋ | 26/30 [00:49<00:09,  2.44s/it]{'epoch': 2, 'num_users': 5.8889, 'loss': 0.0497, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.824, 'compress@10': 1.0, 'time@10': 2.7064}:  87%|████████▋ | 26/30 [00:51<00:09,  2.44s/it] {'epoch': 2, 'num_users': 5.8889, 'loss': 0.0497, 'hit_ratio@10': 0.8156, 'ndcg@10': 0.824, 'compress@10': 1.0, 'time@10': 2.7064}:  90%|█████████ | 27/30 [00:51<00:06,  2.30s/it]{'epoch': 2, 'num_users': 6.0, 'loss': 0.0499, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8252, 'compress@10': 1.0, 'time@10': 2.7401}:  90%|█████████ | 27/30 [00:55<00:06,  2.30s/it]  {'epoch': 2, 'num_users': 6.0, 'loss': 0.0499, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8252, 'compress@10': 1.0, 'time@10': 2.7401}:  93%|█████████▎| 28/30 [00:55<00:05,  2.71s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.0488, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8278, 'compress@10': 1.0, 'time@10': 2.7429}:  93%|█████████▎| 28/30 [00:56<00:05,  2.71s/it]{'epoch': 2, 'num_users': 5.8621, 'loss': 0.0488, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8278, 'compress@10': 1.0, 'time@10': 2.7429}:  97%|█████████▋| 29/30 [00:56<00:02,  2.33s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0484, 'hit_ratio@10': 0.8165, 'ndcg@10': 0.8299, 'compress@10': 1.0, 'time@10': 2.7365}:  97%|█████████▋| 29/30 [00:59<00:02,  2.33s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0484, 'hit_ratio@10': 0.8165, 'ndcg@10': 0.8299, 'compress@10': 1.0, 'time@10': 2.7365}: 100%|██████████| 30/30 [00:59<00:00,  2.41s/it]{'epoch': 2, 'num_users': 5.8667, 'loss': 0.0484, 'hit_ratio@10': 0.8165, 'ndcg@10': 0.8299, 'compress@10': 1.0, 'time@10': 2.7365}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 2
Avg # of users: 5.866666666666666
Avg Loss: 0.04842332075957344
Avg hit ratio: 0.8165286094717785
Avg ndcg: 0.8298933990229337
Avg compression ratio: 1.0
Avg train time: 2.7365073045094808
Std train time: 1.730153826207446
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8393, 'compress@10': 1.0, 'time@10': 2.6358}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8393, 'compress@10': 1.0, 'time@10': 2.6358}:   3%|▎         | 1/30 [00:01<00:39,  1.35s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8438, 'compress@10': 1.0, 'time@10': 2.3879}:   3%|▎         | 1/30 [00:03<00:39,  1.35s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8438, 'compress@10': 1.0, 'time@10': 2.3879}:   7%|▋         | 2/30 [00:03<00:51,  1.83s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0346, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8482, 'compress@10': 1.0, 'time@10': 1.8688}:   7%|▋         | 2/30 [00:03<00:51,  1.83s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0346, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8482, 'compress@10': 1.0, 'time@10': 1.8688}:  10%|█         | 3/30 [00:03<00:32,  1.20s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.8131, 'ndcg@10': 0.8484, 'compress@10': 1.0, 'time@10': 1.8654}:  10%|█         | 3/30 [00:05<00:32,  1.20s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0377, 'hit_ratio@10': 0.8131, 'ndcg@10': 0.8484, 'compress@10': 1.0, 'time@10': 1.8654}:  13%|█▎        | 4/30 [00:05<00:38,  1.47s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0446, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8373, 'compress@10': 1.0, 'time@10': 2.9267}:  13%|█▎        | 4/30 [00:09<00:38,  1.47s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0446, 'hit_ratio@10': 0.8264, 'ndcg@10': 0.8373, 'compress@10': 1.0, 'time@10': 2.9267}:  17%|█▋        | 5/30 [00:09<00:56,  2.24s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.049, 'hit_ratio@10': 0.8146, 'ndcg@10': 0.8344, 'compress@10': 1.0, 'time@10': 2.9773}:  17%|█▋        | 5/30 [00:12<00:56,  2.24s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.049, 'hit_ratio@10': 0.8146, 'ndcg@10': 0.8344, 'compress@10': 1.0, 'time@10': 2.9773}:  20%|██        | 6/30 [00:12<01:02,  2.59s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0479, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8388, 'compress@10': 1.0, 'time@10': 3.0617}:  20%|██        | 6/30 [00:14<01:02,  2.59s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0479, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8388, 'compress@10': 1.0, 'time@10': 3.0617}:  23%|██▎       | 7/30 [00:14<00:53,  2.34s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0462, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8434, 'compress@10': 1.0, 'time@10': 2.9798}:  23%|██▎       | 7/30 [00:16<00:53,  2.34s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0462, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8434, 'compress@10': 1.0, 'time@10': 2.9798}:  27%|██▋       | 8/30 [00:16<00:52,  2.37s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0444, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 3.1523}:  27%|██▋       | 8/30 [00:19<00:52,  2.37s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0444, 'hit_ratio@10': 0.8371, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 3.1523}:  30%|███       | 9/30 [00:19<00:49,  2.35s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0444, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 3.1276}:  30%|███       | 9/30 [00:22<00:49,  2.35s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0444, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 3.1276}:  33%|███▎      | 10/30 [00:22<00:50,  2.53s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0457, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 3.2259}:  33%|███▎      | 10/30 [00:24<00:50,  2.53s/it]{'epoch': 3, 'num_users': 6.6364, 'loss': 0.0457, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8528, 'compress@10': 1.0, 'time@10': 3.2259}:  37%|███▋      | 11/30 [00:24<00:45,  2.41s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.044, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8566, 'compress@10': 1.0, 'time@10': 3.0396}:  37%|███▋      | 11/30 [00:25<00:45,  2.41s/it]{'epoch': 3, 'num_users': 6.4167, 'loss': 0.044, 'hit_ratio@10': 0.8353, 'ndcg@10': 0.8566, 'compress@10': 1.0, 'time@10': 3.0396}:  40%|████      | 12/30 [00:25<00:37,  2.07s/it]{'epoch': 3, 'num_users': 6.6154, 'loss': 0.0441, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 3.1242}:  40%|████      | 12/30 [00:27<00:37,  2.07s/it]{'epoch': 3, 'num_users': 6.6154, 'loss': 0.0441, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 3.1242}:  43%|████▎     | 13/30 [00:27<00:35,  2.08s/it]{'epoch': 3, 'num_users': 6.3571, 'loss': 0.0428, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 2.9272}:  43%|████▎     | 13/30 [00:28<00:35,  2.08s/it]{'epoch': 3, 'num_users': 6.3571, 'loss': 0.0428, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8553, 'compress@10': 1.0, 'time@10': 2.9272}:  47%|████▋     | 14/30 [00:28<00:25,  1.57s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.0433, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 3.0152}:  47%|████▋     | 14/30 [00:30<00:25,  1.57s/it]{'epoch': 3, 'num_users': 6.2667, 'loss': 0.0433, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 3.0152}:  50%|█████     | 15/30 [00:30<00:26,  1.75s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.0422, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 2.8778}:  50%|█████     | 15/30 [00:31<00:26,  1.75s/it]{'epoch': 3, 'num_users': 6.0625, 'loss': 0.0422, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 2.8778}:  53%|█████▎    | 16/30 [00:31<00:20,  1.48s/it]{'epoch': 3, 'num_users': 5.8235, 'loss': 0.0416, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8478, 'compress@10': 1.0, 'time@10': 2.7398}:  53%|█████▎    | 16/30 [00:31<00:20,  1.48s/it]{'epoch': 3, 'num_users': 5.8235, 'loss': 0.0416, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8478, 'compress@10': 1.0, 'time@10': 2.7398}:  57%|█████▋    | 17/30 [00:31<00:14,  1.12s/it]{'epoch': 3, 'num_users': 6.0556, 'loss': 0.042, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8488, 'compress@10': 1.0, 'time@10': 2.6963}:  57%|█████▋    | 17/30 [00:33<00:14,  1.12s/it] {'epoch': 3, 'num_users': 6.0556, 'loss': 0.042, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.8488, 'compress@10': 1.0, 'time@10': 2.6963}:  60%|██████    | 18/30 [00:33<00:16,  1.38s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.0408, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.8513, 'compress@10': 1.0, 'time@10': 2.6492}:  60%|██████    | 18/30 [00:34<00:16,  1.38s/it]  {'epoch': 3, 'num_users': 6.0, 'loss': 0.0408, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.8513, 'compress@10': 1.0, 'time@10': 2.6492}:  63%|██████▎   | 19/30 [00:34<00:13,  1.24s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.0416, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 2.7243}:  63%|██████▎   | 19/30 [00:38<00:13,  1.24s/it]{'epoch': 3, 'num_users': 6.15, 'loss': 0.0416, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 2.7243}:  67%|██████▋   | 20/30 [00:38<00:21,  2.13s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0428, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8472, 'compress@10': 1.0, 'time@10': 2.8725}:  67%|██████▋   | 20/30 [00:41<00:21,  2.13s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0428, 'hit_ratio@10': 0.824, 'ndcg@10': 0.8472, 'compress@10': 1.0, 'time@10': 2.8725}:  70%|███████   | 21/30 [00:41<00:21,  2.37s/it]{'epoch': 3, 'num_users': 6.1818, 'loss': 0.0424, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8495, 'compress@10': 1.0, 'time@10': 2.8075}:  70%|███████   | 21/30 [00:42<00:21,  2.37s/it]{'epoch': 3, 'num_users': 6.1818, 'loss': 0.0424, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8495, 'compress@10': 1.0, 'time@10': 2.8075}:  73%|███████▎  | 22/30 [00:42<00:16,  2.10s/it]{'epoch': 3, 'num_users': 6.1304, 'loss': 0.0416, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 2.7999}:  73%|███████▎  | 22/30 [00:44<00:16,  2.10s/it] {'epoch': 3, 'num_users': 6.1304, 'loss': 0.0416, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8522, 'compress@10': 1.0, 'time@10': 2.7999}:  77%|███████▋  | 23/30 [00:44<00:13,  1.88s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.0429, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 2.6946}:  77%|███████▋  | 23/30 [00:44<00:13,  1.88s/it]{'epoch': 3, 'num_users': 5.9583, 'loss': 0.0429, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 2.6946}:  80%|████████  | 24/30 [00:44<00:08,  1.40s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8191, 'compress@10': 1.0, 'time@10': 2.598}:  80%|████████  | 24/30 [00:44<00:08,  1.40s/it]     {'epoch': 3, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8191, 'compress@10': 1.0, 'time@10': 2.598}:  83%|████████▎ | 25/30 [00:44<00:05,  1.03s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0472, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8171, 'compress@10': 1.0, 'time@10': 2.7187}:  83%|████████▎ | 25/30 [00:50<00:05,  1.03s/it]{'epoch': 3, 'num_users': 5.8077, 'loss': 0.0472, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8171, 'compress@10': 1.0, 'time@10': 2.7187}:  87%|████████▋ | 26/30 [00:50<00:09,  2.45s/it]{'epoch': 3, 'num_users': 5.8889, 'loss': 0.0464, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8197, 'compress@10': 1.0, 'time@10': 2.7601}:  87%|████████▋ | 26/30 [00:52<00:09,  2.45s/it]{'epoch': 3, 'num_users': 5.8889, 'loss': 0.0464, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8197, 'compress@10': 1.0, 'time@10': 2.7601}:  90%|█████████ | 27/30 [00:52<00:06,  2.30s/it]{'epoch': 3, 'num_users': 6.0, 'loss': 0.0461, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.822, 'compress@10': 1.0, 'time@10': 2.7904}:  90%|█████████ | 27/30 [00:56<00:06,  2.30s/it]    {'epoch': 3, 'num_users': 6.0, 'loss': 0.0461, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.822, 'compress@10': 1.0, 'time@10': 2.7904}:  93%|█████████▎| 28/30 [00:56<00:05,  2.70s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0451, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8243, 'compress@10': 1.0, 'time@10': 2.7925}:  93%|█████████▎| 28/30 [00:57<00:05,  2.70s/it]{'epoch': 3, 'num_users': 5.8621, 'loss': 0.0451, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8243, 'compress@10': 1.0, 'time@10': 2.7925}:  97%|█████████▋| 29/30 [00:57<00:02,  2.33s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0449, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8268, 'compress@10': 1.0, 'time@10': 2.7879}:  97%|█████████▋| 29/30 [01:00<00:02,  2.33s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0449, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8268, 'compress@10': 1.0, 'time@10': 2.7879}: 100%|██████████| 30/30 [01:00<00:00,  2.44s/it]{'epoch': 3, 'num_users': 5.8667, 'loss': 0.0449, 'hit_ratio@10': 0.8236, 'ndcg@10': 0.8268, 'compress@10': 1.0, 'time@10': 2.7879}: 100%|██████████| 30/30 [01:00<00:00,  2.01s/it]
Epoch: 3
Avg # of users: 5.866666666666666
Avg Loss: 0.044900285211558665
Avg hit ratio: 0.8236236138902332
Avg ndcg: 0.8267800291135433
Avg compression ratio: 1.0
Avg train time: 2.787942051887512
Std train time: 1.7336451647283875
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8628, 'compress@10': 1.0, 'time@10': 2.6171}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8628, 'compress@10': 1.0, 'time@10': 2.6171}:   3%|▎         | 1/30 [00:01<00:38,  1.34s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 2.3738}:   3%|▎         | 1/30 [00:03<00:38,  1.34s/it]  {'epoch': 4, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 2.3738}:   7%|▋         | 2/30 [00:03<00:50,  1.82s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 1.8852}:   7%|▋         | 2/30 [00:03<00:50,  1.82s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0311, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 1.8852}:  10%|█         | 3/30 [00:03<00:32,  1.21s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 1.8952}:  10%|█         | 3/30 [00:05<00:32,  1.21s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.8097, 'ndcg@10': 0.8678, 'compress@10': 1.0, 'time@10': 1.8952}:  13%|█▎        | 4/30 [00:05<00:39,  1.51s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0339, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8667, 'compress@10': 1.0, 'time@10': 2.9423}:  13%|█▎        | 4/30 [00:09<00:39,  1.51s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0339, 'hit_ratio@10': 0.8278, 'ndcg@10': 0.8667, 'compress@10': 1.0, 'time@10': 2.9423}:  17%|█▋        | 5/30 [00:09<00:56,  2.26s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0352, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 2.983}:  17%|█▋        | 5/30 [00:12<00:56,  2.26s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0352, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 2.983}:  20%|██        | 6/30 [00:12<01:02,  2.58s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0351, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8696, 'compress@10': 1.0, 'time@10': 3.0549}:  20%|██        | 6/30 [00:14<01:02,  2.58s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0351, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8696, 'compress@10': 1.0, 'time@10': 3.0549}:  23%|██▎       | 7/30 [00:14<00:53,  2.32s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0341, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 2.9741}:  23%|██▎       | 7/30 [00:16<00:53,  2.32s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0341, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 2.9741}:  27%|██▋       | 8/30 [00:16<00:51,  2.36s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0328, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 3.1849}:  27%|██▋       | 8/30 [00:19<00:51,  2.36s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0328, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.877, 'compress@10': 1.0, 'time@10': 3.1849}:  30%|███       | 9/30 [00:19<00:50,  2.39s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0326, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 3.1744}:  30%|███       | 9/30 [00:22<00:50,  2.39s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.0326, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 3.1744}:  33%|███▎      | 10/30 [00:22<00:52,  2.61s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0342, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 3.2239}:  33%|███▎      | 10/30 [00:24<00:52,  2.61s/it]{'epoch': 4, 'num_users': 6.6364, 'loss': 0.0342, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8778, 'compress@10': 1.0, 'time@10': 3.2239}:  37%|███▋      | 11/30 [00:24<00:45,  2.39s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0335, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8802, 'compress@10': 1.0, 'time@10': 3.0144}:  37%|███▋      | 11/30 [00:25<00:45,  2.39s/it]{'epoch': 4, 'num_users': 6.4167, 'loss': 0.0335, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8802, 'compress@10': 1.0, 'time@10': 3.0144}:  40%|████      | 12/30 [00:25<00:33,  1.89s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0339, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 3.0019}:  40%|████      | 12/30 [00:26<00:33,  1.89s/it]{'epoch': 4, 'num_users': 6.6154, 'loss': 0.0339, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 3.0019}:  43%|████▎     | 13/30 [00:26<00:29,  1.76s/it]{'epoch': 4, 'num_users': 6.3571, 'loss': 0.0333, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 2.8098}:  43%|████▎     | 13/30 [00:26<00:29,  1.76s/it]{'epoch': 4, 'num_users': 6.3571, 'loss': 0.0333, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 2.8098}:  47%|████▋     | 14/30 [00:26<00:21,  1.33s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.0339, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8762, 'compress@10': 1.0, 'time@10': 2.8746}:  47%|████▋     | 14/30 [00:28<00:21,  1.33s/it]{'epoch': 4, 'num_users': 6.2667, 'loss': 0.0339, 'hit_ratio@10': 0.8373, 'ndcg@10': 0.8762, 'compress@10': 1.0, 'time@10': 2.8746}:  50%|█████     | 15/30 [00:28<00:22,  1.51s/it]{'epoch': 4, 'num_users': 6.0625, 'loss': 0.0332, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 2.7402}:  50%|█████     | 15/30 [00:29<00:22,  1.51s/it] {'epoch': 4, 'num_users': 6.0625, 'loss': 0.0332, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 2.7402}:  53%|█████▎    | 16/30 [00:29<00:17,  1.28s/it]{'epoch': 4, 'num_users': 5.8235, 'loss': 0.0346, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8648, 'compress@10': 1.0, 'time@10': 2.6097}:  53%|█████▎    | 16/30 [00:29<00:17,  1.28s/it]{'epoch': 4, 'num_users': 5.8235, 'loss': 0.0346, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8648, 'compress@10': 1.0, 'time@10': 2.6097}:  57%|█████▋    | 17/30 [00:29<00:12,  1.02it/s]{'epoch': 4, 'num_users': 6.0556, 'loss': 0.0343, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8664, 'compress@10': 1.0, 'time@10': 2.573}:  57%|█████▋    | 17/30 [00:31<00:12,  1.02it/s] {'epoch': 4, 'num_users': 6.0556, 'loss': 0.0343, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8664, 'compress@10': 1.0, 'time@10': 2.573}:  60%|██████    | 18/30 [00:31<00:15,  1.28s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0334, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 2.5303}:  60%|██████    | 18/30 [00:32<00:15,  1.28s/it]  {'epoch': 4, 'num_users': 6.0, 'loss': 0.0334, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 2.5303}:  63%|██████▎   | 19/30 [00:32<00:12,  1.17s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.0339, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 2.614}:  63%|██████▎   | 19/30 [00:37<00:12,  1.17s/it]{'epoch': 4, 'num_users': 6.15, 'loss': 0.0339, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 2.614}:  67%|██████▋   | 20/30 [00:37<00:20,  2.09s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0347, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8663, 'compress@10': 1.0, 'time@10': 2.7534}:  67%|██████▋   | 20/30 [00:39<00:20,  2.09s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0347, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8663, 'compress@10': 1.0, 'time@10': 2.7534}:  70%|███████   | 21/30 [00:39<00:20,  2.31s/it]{'epoch': 4, 'num_users': 6.1818, 'loss': 0.0345, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 2.6935}:  70%|███████   | 21/30 [00:41<00:20,  2.31s/it] {'epoch': 4, 'num_users': 6.1818, 'loss': 0.0345, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 2.6935}:  73%|███████▎  | 22/30 [00:41<00:16,  2.05s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.034, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 2.6929}:  73%|███████▎  | 22/30 [00:42<00:16,  2.05s/it]{'epoch': 4, 'num_users': 6.1304, 'loss': 0.034, 'hit_ratio@10': 0.8366, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 2.6929}:  77%|███████▋  | 23/30 [00:42<00:12,  1.85s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.0366, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 2.5921}:  77%|███████▋  | 23/30 [00:43<00:12,  1.85s/it]{'epoch': 4, 'num_users': 5.9583, 'loss': 0.0366, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 2.5921}:  80%|████████  | 24/30 [00:43<00:08,  1.39s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8346, 'compress@10': 1.0, 'time@10': 2.4993}:  80%|████████  | 24/30 [00:43<00:08,  1.39s/it]   {'epoch': 4, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8346, 'compress@10': 1.0, 'time@10': 2.4993}:  83%|████████▎ | 25/30 [00:43<00:05,  1.02s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0414, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8374, 'compress@10': 1.0, 'time@10': 2.6213}:  83%|████████▎ | 25/30 [00:48<00:05,  1.02s/it]{'epoch': 4, 'num_users': 5.8077, 'loss': 0.0414, 'hit_ratio@10': 0.8249, 'ndcg@10': 0.8374, 'compress@10': 1.0, 'time@10': 2.6213}:  87%|████████▋ | 26/30 [00:48<00:09,  2.43s/it]{'epoch': 4, 'num_users': 5.8889, 'loss': 0.0406, 'hit_ratio@10': 0.83, 'ndcg@10': 0.8399, 'compress@10': 1.0, 'time@10': 2.6729}:  87%|████████▋ | 26/30 [00:50<00:09,  2.43s/it]  {'epoch': 4, 'num_users': 5.8889, 'loss': 0.0406, 'hit_ratio@10': 0.83, 'ndcg@10': 0.8399, 'compress@10': 1.0, 'time@10': 2.6729}:  90%|█████████ | 27/30 [00:50<00:06,  2.31s/it]{'epoch': 4, 'num_users': 6.0, 'loss': 0.0402, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8419, 'compress@10': 1.0, 'time@10': 2.7103}:  90%|█████████ | 27/30 [00:54<00:06,  2.31s/it] {'epoch': 4, 'num_users': 6.0, 'loss': 0.0402, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8419, 'compress@10': 1.0, 'time@10': 2.7103}:  93%|█████████▎| 28/30 [00:54<00:05,  2.74s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0394, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8442, 'compress@10': 1.0, 'time@10': 2.7127}:  93%|█████████▎| 28/30 [00:56<00:05,  2.74s/it]{'epoch': 4, 'num_users': 5.8621, 'loss': 0.0394, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8442, 'compress@10': 1.0, 'time@10': 2.7127}:  97%|█████████▋| 29/30 [00:56<00:02,  2.34s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0393, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8458, 'compress@10': 1.0, 'time@10': 2.7079}:  97%|█████████▋| 29/30 [00:58<00:02,  2.34s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0393, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8458, 'compress@10': 1.0, 'time@10': 2.7079}: 100%|██████████| 30/30 [00:58<00:00,  2.43s/it]{'epoch': 4, 'num_users': 5.8667, 'loss': 0.0393, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8458, 'compress@10': 1.0, 'time@10': 2.7079}: 100%|██████████| 30/30 [00:58<00:00,  1.96s/it]
Epoch: 4
Avg # of users: 5.866666666666666
Avg Loss: 0.03933710371512747
Avg hit ratio: 0.8288697626265654
Avg ndcg: 0.8458170810540037
Avg compression ratio: 1.0
Avg train time: 2.707944329579671
Std train time: 1.701932887603663
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8872, 'compress@10': 1.0, 'time@10': 2.6399}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8872, 'compress@10': 1.0, 'time@10': 2.6399}:   3%|▎         | 1/30 [00:01<00:39,  1.35s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9028, 'compress@10': 1.0, 'time@10': 2.3988}:   3%|▎         | 1/30 [00:03<00:39,  1.35s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0254, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9028, 'compress@10': 1.0, 'time@10': 2.3988}:   7%|▋         | 2/30 [00:03<00:51,  1.84s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 1.8696}:   7%|▋         | 2/30 [00:03<00:51,  1.84s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 1.8696}:  10%|█         | 3/30 [00:03<00:32,  1.20s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8828, 'compress@10': 1.0, 'time@10': 1.8729}:  10%|█         | 3/30 [00:05<00:32,  1.20s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8828, 'compress@10': 1.0, 'time@10': 1.8729}:  13%|█▎        | 4/30 [00:05<00:38,  1.48s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 2.9045}:  13%|█▎        | 4/30 [00:09<00:38,  1.48s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8347, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 2.9045}:  17%|█▋        | 5/30 [00:09<00:55,  2.23s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0246, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 2.9485}:  17%|█▋        | 5/30 [00:12<00:55,  2.23s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0246, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 2.9485}:  20%|██        | 6/30 [00:12<01:01,  2.56s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0253, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 3.0292}:  20%|██        | 6/30 [00:14<01:01,  2.56s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0253, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 3.0292}:  23%|██▎       | 7/30 [00:14<00:53,  2.31s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9022, 'compress@10': 1.0, 'time@10': 2.9474}:  23%|██▎       | 7/30 [00:16<00:53,  2.31s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9022, 'compress@10': 1.0, 'time@10': 2.9474}:  27%|██▋       | 8/30 [00:16<00:51,  2.34s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0228, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.9069, 'compress@10': 1.0, 'time@10': 3.1673}:  27%|██▋       | 8/30 [00:19<00:51,  2.34s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0228, 'hit_ratio@10': 0.8531, 'ndcg@10': 0.9069, 'compress@10': 1.0, 'time@10': 3.1673}:  30%|███       | 9/30 [00:19<00:50,  2.39s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0226, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 3.1599}:  30%|███       | 9/30 [00:22<00:50,  2.39s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0226, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 3.1599}:  33%|███▎      | 10/30 [00:22<00:52,  2.61s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0243, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 3.2023}:  33%|███▎      | 10/30 [00:24<00:52,  2.61s/it]{'epoch': 5, 'num_users': 6.6364, 'loss': 0.0243, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 3.2023}:  37%|███▋      | 11/30 [00:24<00:45,  2.38s/it]{'epoch': 5, 'num_users': 6.4167, 'loss': 0.0245, 'hit_ratio@10': 0.851, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 2.9987}:  37%|███▋      | 11/30 [00:25<00:45,  2.38s/it] {'epoch': 5, 'num_users': 6.4167, 'loss': 0.0245, 'hit_ratio@10': 0.851, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 2.9987}:  40%|████      | 12/30 [00:25<00:34,  1.90s/it]{'epoch': 5, 'num_users': 6.6154, 'loss': 0.0251, 'hit_ratio@10': 0.852, 'ndcg@10': 0.9077, 'compress@10': 1.0, 'time@10': 3.014}:  40%|████      | 12/30 [00:26<00:34,  1.90s/it] {'epoch': 5, 'num_users': 6.6154, 'loss': 0.0251, 'hit_ratio@10': 0.852, 'ndcg@10': 0.9077, 'compress@10': 1.0, 'time@10': 3.014}:  43%|████▎     | 13/30 [00:26<00:30,  1.82s/it]{'epoch': 5, 'num_users': 6.3571, 'loss': 0.0251, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 2.8243}:  43%|████▎     | 13/30 [00:27<00:30,  1.82s/it]{'epoch': 5, 'num_users': 6.3571, 'loss': 0.0251, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 2.8243}:  47%|████▋     | 14/30 [00:27<00:22,  1.39s/it]{'epoch': 5, 'num_users': 6.2667, 'loss': 0.0256, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9018, 'compress@10': 1.0, 'time@10': 2.9174}:  47%|████▋     | 14/30 [00:29<00:22,  1.39s/it]{'epoch': 5, 'num_users': 6.2667, 'loss': 0.0256, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.9018, 'compress@10': 1.0, 'time@10': 2.9174}:  50%|█████     | 15/30 [00:29<00:24,  1.62s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.0254, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9011, 'compress@10': 1.0, 'time@10': 2.7824}:  50%|█████     | 15/30 [00:30<00:24,  1.62s/it]{'epoch': 5, 'num_users': 6.0625, 'loss': 0.0254, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9011, 'compress@10': 1.0, 'time@10': 2.7824}:  53%|█████▎    | 16/30 [00:30<00:19,  1.37s/it]{'epoch': 5, 'num_users': 5.8235, 'loss': 0.0274, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 2.6505}:  53%|█████▎    | 16/30 [00:30<00:19,  1.37s/it]  {'epoch': 5, 'num_users': 5.8235, 'loss': 0.0274, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.88, 'compress@10': 1.0, 'time@10': 2.6505}:  57%|█████▋    | 17/30 [00:30<00:13,  1.05s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.0268, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8822, 'compress@10': 1.0, 'time@10': 2.6135}:  57%|█████▋    | 17/30 [00:32<00:13,  1.05s/it]{'epoch': 5, 'num_users': 6.0556, 'loss': 0.0268, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8822, 'compress@10': 1.0, 'time@10': 2.6135}:  60%|██████    | 18/30 [00:32<00:16,  1.34s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.0263, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.884, 'compress@10': 1.0, 'time@10': 2.5678}:  60%|██████    | 18/30 [00:33<00:16,  1.34s/it]    {'epoch': 5, 'num_users': 6.0, 'loss': 0.0263, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.884, 'compress@10': 1.0, 'time@10': 2.5678}:  63%|██████▎   | 19/30 [00:33<00:13,  1.21s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0262, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.888, 'compress@10': 1.0, 'time@10': 2.6372}:  63%|██████▎   | 19/30 [00:37<00:13,  1.21s/it]{'epoch': 5, 'num_users': 6.15, 'loss': 0.0262, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.888, 'compress@10': 1.0, 'time@10': 2.6372}:  67%|██████▋   | 20/30 [00:37<00:20,  2.05s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 2.7773}:  67%|██████▋   | 20/30 [00:40<00:20,  2.05s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 2.7773}:  70%|███████   | 21/30 [00:40<00:20,  2.28s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.0261, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 2.7184}:  70%|███████   | 21/30 [00:41<00:20,  2.28s/it]{'epoch': 5, 'num_users': 6.1818, 'loss': 0.0261, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 2.7184}:  73%|███████▎  | 22/30 [00:41<00:16,  2.09s/it]{'epoch': 5, 'num_users': 6.1304, 'loss': 0.0259, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 2.7198}:  73%|███████▎  | 22/30 [00:43<00:16,  2.09s/it] {'epoch': 5, 'num_users': 6.1304, 'loss': 0.0259, 'hit_ratio@10': 0.867, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 2.7198}:  77%|███████▋  | 23/30 [00:43<00:13,  1.88s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.0289, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8732, 'compress@10': 1.0, 'time@10': 2.6182}:  77%|███████▋  | 23/30 [00:43<00:13,  1.88s/it]{'epoch': 5, 'num_users': 5.9583, 'loss': 0.0289, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.8732, 'compress@10': 1.0, 'time@10': 2.6182}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 2.5256}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]   {'epoch': 5, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 2.5256}:  83%|████████▎ | 25/30 [00:43<00:05,  1.04s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0377, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8495, 'compress@10': 1.0, 'time@10': 2.6438}:  83%|████████▎ | 25/30 [00:49<00:05,  1.04s/it]{'epoch': 5, 'num_users': 5.8077, 'loss': 0.0377, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8495, 'compress@10': 1.0, 'time@10': 2.6438}:  87%|████████▋ | 26/30 [00:49<00:09,  2.42s/it]{'epoch': 5, 'num_users': 5.8889, 'loss': 0.0379, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 2.6918}:  87%|████████▋ | 26/30 [00:51<00:09,  2.42s/it]{'epoch': 5, 'num_users': 5.8889, 'loss': 0.0379, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 2.6918}:  90%|█████████ | 27/30 [00:51<00:06,  2.29s/it]{'epoch': 5, 'num_users': 6.0, 'loss': 0.0378, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 2.7264}:  90%|█████████ | 27/30 [00:54<00:06,  2.29s/it]   {'epoch': 5, 'num_users': 6.0, 'loss': 0.0378, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 2.7264}:  93%|█████████▎| 28/30 [00:54<00:05,  2.71s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.037, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 2.7304}:  93%|█████████▎| 28/30 [00:56<00:05,  2.71s/it]{'epoch': 5, 'num_users': 5.8621, 'loss': 0.037, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8625, 'compress@10': 1.0, 'time@10': 2.7304}:  97%|█████████▋| 29/30 [00:56<00:02,  2.33s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.037, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8642, 'compress@10': 1.0, 'time@10': 2.7253}:  97%|█████████▋| 29/30 [00:59<00:02,  2.33s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.037, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8642, 'compress@10': 1.0, 'time@10': 2.7253}: 100%|██████████| 30/30 [00:59<00:00,  2.42s/it]{'epoch': 5, 'num_users': 5.8667, 'loss': 0.037, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.8642, 'compress@10': 1.0, 'time@10': 2.7253}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 5
Avg # of users: 5.866666666666666
Avg Loss: 0.03699758939432495
Avg hit ratio: 0.8608067261318256
Avg ndcg: 0.8642062538636419
Avg compression ratio: 1.0
Avg train time: 2.725284210840861
Std train time: 1.6905883513352005
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.904, 'compress@10': 1.0, 'time@10': 2.7641}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.904, 'compress@10': 1.0, 'time@10': 2.7641}:   3%|▎         | 1/30 [00:01<00:40,  1.41s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 2.4795}:   3%|▎         | 1/30 [00:03<00:40,  1.41s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 2.4795}:   7%|▋         | 2/30 [00:03<00:52,  1.89s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 1.9372}:   7%|▋         | 2/30 [00:04<00:52,  1.89s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 1.9372}:  10%|█         | 3/30 [00:04<00:33,  1.23s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 1.9529}:  10%|█         | 3/30 [00:06<00:33,  1.23s/it]  {'epoch': 6, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 1.9529}:  13%|█▎        | 4/30 [00:06<00:40,  1.55s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 3.0387}:  13%|█▎        | 4/30 [00:09<00:40,  1.55s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 3.0387}:  17%|█▋        | 5/30 [00:09<00:58,  2.33s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0331, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9064, 'compress@10': 1.0, 'time@10': 3.0561}:  17%|█▋        | 5/30 [00:13<00:58,  2.33s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0331, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9064, 'compress@10': 1.0, 'time@10': 3.0561}:  20%|██        | 6/30 [00:13<01:02,  2.62s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0338, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.908, 'compress@10': 1.0, 'time@10': 3.1085}:  20%|██        | 6/30 [00:14<01:02,  2.62s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.0338, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.908, 'compress@10': 1.0, 'time@10': 3.1085}:  23%|██▎       | 7/30 [00:14<00:53,  2.33s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0315, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9125, 'compress@10': 1.0, 'time@10': 3.0148}:  23%|██▎       | 7/30 [00:17<00:53,  2.33s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0315, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9125, 'compress@10': 1.0, 'time@10': 3.0148}:  27%|██▋       | 8/30 [00:17<00:51,  2.35s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 3.2184}:  27%|██▋       | 8/30 [00:19<00:51,  2.35s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 3.2184}:  30%|███       | 9/30 [00:19<00:50,  2.38s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 3.199}:  30%|███       | 9/30 [00:22<00:50,  2.38s/it]    {'epoch': 6, 'num_users': 6.3, 'loss': 0.0302, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 3.199}:  33%|███▎      | 10/30 [00:22<00:51,  2.59s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.031, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 3.2489}:  33%|███▎      | 10/30 [00:24<00:51,  2.59s/it]{'epoch': 6, 'num_users': 6.6364, 'loss': 0.031, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 3.2489}:  37%|███▋      | 11/30 [00:24<00:45,  2.38s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.0301, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 3.0426}:  37%|███▋      | 11/30 [00:25<00:45,  2.38s/it]{'epoch': 6, 'num_users': 6.4167, 'loss': 0.0301, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 3.0426}:  40%|████      | 12/30 [00:25<00:34,  1.90s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.0304, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 3.0661}:  40%|████      | 12/30 [00:27<00:34,  1.90s/it]{'epoch': 6, 'num_users': 6.6154, 'loss': 0.0304, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 3.0661}:  43%|████▎     | 13/30 [00:27<00:31,  1.84s/it]{'epoch': 6, 'num_users': 6.3571, 'loss': 0.0302, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9086, 'compress@10': 1.0, 'time@10': 2.8736}:  43%|████▎     | 13/30 [00:27<00:31,  1.84s/it]{'epoch': 6, 'num_users': 6.3571, 'loss': 0.0302, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9086, 'compress@10': 1.0, 'time@10': 2.8736}:  47%|████▋     | 14/30 [00:27<00:22,  1.41s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.0317, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9077, 'compress@10': 1.0, 'time@10': 2.9708}:  47%|████▋     | 14/30 [00:29<00:22,  1.41s/it]{'epoch': 6, 'num_users': 6.2667, 'loss': 0.0317, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9077, 'compress@10': 1.0, 'time@10': 2.9708}:  50%|█████     | 15/30 [00:29<00:24,  1.64s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.0309, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9069, 'compress@10': 1.0, 'time@10': 2.8322}:  50%|█████     | 15/30 [00:30<00:24,  1.64s/it]{'epoch': 6, 'num_users': 6.0625, 'loss': 0.0309, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.9069, 'compress@10': 1.0, 'time@10': 2.8322}:  53%|█████▎    | 16/30 [00:30<00:19,  1.38s/it]{'epoch': 6, 'num_users': 5.8235, 'loss': 0.0329, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 2.6981}:  53%|█████▎    | 16/30 [00:30<00:19,  1.38s/it]{'epoch': 6, 'num_users': 5.8235, 'loss': 0.0329, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 2.6981}:  57%|█████▋    | 17/30 [00:30<00:13,  1.06s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0323, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 2.6588}:  57%|█████▋    | 17/30 [00:32<00:13,  1.06s/it]{'epoch': 6, 'num_users': 6.0556, 'loss': 0.0323, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 2.6588}:  60%|██████    | 18/30 [00:32<00:16,  1.35s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.0316, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.6149}:  60%|██████    | 18/30 [00:33<00:16,  1.35s/it]   {'epoch': 6, 'num_users': 6.0, 'loss': 0.0316, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.6149}:  63%|██████▎   | 19/30 [00:33<00:13,  1.23s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.0327, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8962, 'compress@10': 1.0, 'time@10': 2.6995}:  63%|██████▎   | 19/30 [00:38<00:13,  1.23s/it]{'epoch': 6, 'num_users': 6.15, 'loss': 0.0327, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8962, 'compress@10': 1.0, 'time@10': 2.6995}:  67%|██████▋   | 20/30 [00:38<00:21,  2.16s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0325, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8966, 'compress@10': 1.0, 'time@10': 2.8357}:  67%|██████▋   | 20/30 [00:40<00:21,  2.16s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0325, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.8966, 'compress@10': 1.0, 'time@10': 2.8357}:  70%|███████   | 21/30 [00:40<00:21,  2.35s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.0319, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 2.7675}:  70%|███████   | 21/30 [00:42<00:21,  2.35s/it]{'epoch': 6, 'num_users': 6.1818, 'loss': 0.0319, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8975, 'compress@10': 1.0, 'time@10': 2.7675}:  73%|███████▎  | 22/30 [00:42<00:16,  2.06s/it]{'epoch': 6, 'num_users': 6.1304, 'loss': 0.0314, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 2.757}:  73%|███████▎  | 22/30 [00:43<00:16,  2.06s/it] {'epoch': 6, 'num_users': 6.1304, 'loss': 0.0314, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 2.757}:  77%|███████▋  | 23/30 [00:43<00:12,  1.83s/it]{'epoch': 6, 'num_users': 5.9583, 'loss': 0.0339, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8836, 'compress@10': 1.0, 'time@10': 2.6523}:  77%|███████▋  | 23/30 [00:43<00:12,  1.83s/it]{'epoch': 6, 'num_users': 5.9583, 'loss': 0.0339, 'hit_ratio@10': 0.8522, 'ndcg@10': 0.8836, 'compress@10': 1.0, 'time@10': 2.6523}:  80%|████████  | 24/30 [00:43<00:08,  1.36s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0423, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 2.5564}:  80%|████████  | 24/30 [00:43<00:08,  1.36s/it]   {'epoch': 6, 'num_users': 5.8, 'loss': 0.0423, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 2.5564}:  83%|████████▎ | 25/30 [00:43<00:05,  1.00s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0432, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 2.6838}:  83%|████████▎ | 25/30 [00:49<00:05,  1.00s/it]{'epoch': 6, 'num_users': 5.8077, 'loss': 0.0432, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 2.6838}:  87%|████████▋ | 26/30 [00:49<00:09,  2.47s/it]{'epoch': 6, 'num_users': 5.8889, 'loss': 0.0432, 'hit_ratio@10': 0.854, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 2.7609}:  87%|████████▋ | 26/30 [00:52<00:09,  2.47s/it]  {'epoch': 6, 'num_users': 5.8889, 'loss': 0.0432, 'hit_ratio@10': 0.854, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 2.7609}:  90%|█████████ | 27/30 [00:52<00:07,  2.45s/it]{'epoch': 6, 'num_users': 6.0, 'loss': 0.0434, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 2.7961}:  90%|█████████ | 27/30 [00:56<00:07,  2.45s/it] {'epoch': 6, 'num_users': 6.0, 'loss': 0.0434, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 2.7961}:  93%|█████████▎| 28/30 [00:56<00:05,  2.85s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.0423, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8663, 'compress@10': 1.0, 'time@10': 2.7979}:  93%|█████████▎| 28/30 [00:57<00:05,  2.85s/it]{'epoch': 6, 'num_users': 5.8621, 'loss': 0.0423, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.8663, 'compress@10': 1.0, 'time@10': 2.7979}:  97%|█████████▋| 29/30 [00:57<00:02,  2.43s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0415, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 2.7902}:  97%|█████████▋| 29/30 [01:00<00:02,  2.43s/it] {'epoch': 6, 'num_users': 5.8667, 'loss': 0.0415, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 2.7902}: 100%|██████████| 30/30 [01:00<00:00,  2.48s/it]{'epoch': 6, 'num_users': 5.8667, 'loss': 0.0415, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 2.7902}: 100%|██████████| 30/30 [01:00<00:00,  2.00s/it]
Epoch: 6
Avg # of users: 5.866666666666666
Avg Loss: 0.04153759972187698
Avg hit ratio: 0.8579881415843312
Avg ndcg: 0.8683401230754633
Avg compression ratio: 1.0
Avg train time: 2.790190664927165
Std train time: 1.774484786964143
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 2.5947}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 2.5947}:   3%|▎         | 1/30 [00:01<00:38,  1.33s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9151, 'compress@10': 1.0, 'time@10': 2.3595}:   3%|▎         | 1/30 [00:03<00:38,  1.33s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9151, 'compress@10': 1.0, 'time@10': 2.3595}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8942, 'compress@10': 1.0, 'time@10': 1.8447}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8942, 'compress@10': 1.0, 'time@10': 1.8447}:  10%|█         | 3/30 [00:03<00:31,  1.18s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.9073, 'compress@10': 1.0, 'time@10': 1.8542}:  10%|█         | 3/30 [00:05<00:31,  1.18s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.9073, 'compress@10': 1.0, 'time@10': 1.8542}:  13%|█▎        | 4/30 [00:05<00:38,  1.47s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 3.0052}:  13%|█▎        | 4/30 [00:09<00:38,  1.47s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8601, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 3.0052}:  17%|█▋        | 5/30 [00:09<00:58,  2.32s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0232, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9209, 'compress@10': 1.0, 'time@10': 3.043}:  17%|█▋        | 5/30 [00:12<00:58,  2.32s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0232, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9209, 'compress@10': 1.0, 'time@10': 3.043}:  20%|██        | 6/30 [00:12<01:03,  2.64s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9171, 'compress@10': 1.0, 'time@10': 3.1294}:  20%|██        | 6/30 [00:14<01:03,  2.64s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9171, 'compress@10': 1.0, 'time@10': 3.1294}:  23%|██▎       | 7/30 [00:14<00:54,  2.39s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0242, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9164, 'compress@10': 1.0, 'time@10': 3.0386}:  23%|██▎       | 7/30 [00:17<00:54,  2.39s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0242, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9164, 'compress@10': 1.0, 'time@10': 3.0386}:  27%|██▋       | 8/30 [00:17<00:52,  2.40s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9185, 'compress@10': 1.0, 'time@10': 3.2552}:  27%|██▋       | 8/30 [00:19<00:52,  2.40s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.8868, 'ndcg@10': 0.9185, 'compress@10': 1.0, 'time@10': 3.2552}:  30%|███       | 9/30 [00:19<00:51,  2.44s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9218, 'compress@10': 1.0, 'time@10': 3.2493}:  30%|███       | 9/30 [00:22<00:51,  2.44s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9218, 'compress@10': 1.0, 'time@10': 3.2493}:  33%|███▎      | 10/30 [00:22<00:53,  2.68s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.0232, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.921, 'compress@10': 1.0, 'time@10': 3.2909}:  33%|███▎      | 10/30 [00:24<00:53,  2.68s/it]{'epoch': 7, 'num_users': 6.6364, 'loss': 0.0232, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.921, 'compress@10': 1.0, 'time@10': 3.2909}:  37%|███▋      | 11/30 [00:24<00:46,  2.44s/it]{'epoch': 7, 'num_users': 6.4167, 'loss': 0.0225, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9187, 'compress@10': 1.0, 'time@10': 3.0794}:  37%|███▋      | 11/30 [00:25<00:46,  2.44s/it]{'epoch': 7, 'num_users': 6.4167, 'loss': 0.0225, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9187, 'compress@10': 1.0, 'time@10': 3.0794}:  40%|████      | 12/30 [00:25<00:34,  1.93s/it]{'epoch': 7, 'num_users': 6.6154, 'loss': 0.0227, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9179, 'compress@10': 1.0, 'time@10': 3.0793}:  40%|████      | 12/30 [00:27<00:34,  1.93s/it]{'epoch': 7, 'num_users': 6.6154, 'loss': 0.0227, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9179, 'compress@10': 1.0, 'time@10': 3.0793}:  43%|████▎     | 13/30 [00:27<00:31,  1.82s/it]{'epoch': 7, 'num_users': 6.3571, 'loss': 0.023, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 2.8835}:  43%|████▎     | 13/30 [00:27<00:31,  1.82s/it] {'epoch': 7, 'num_users': 6.3571, 'loss': 0.023, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 2.8835}:  47%|████▋     | 14/30 [00:27<00:22,  1.38s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0235, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9121, 'compress@10': 1.0, 'time@10': 2.9711}:  47%|████▋     | 14/30 [00:29<00:22,  1.38s/it]{'epoch': 7, 'num_users': 6.2667, 'loss': 0.0235, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9121, 'compress@10': 1.0, 'time@10': 2.9711}:  50%|█████     | 15/30 [00:29<00:24,  1.61s/it]{'epoch': 7, 'num_users': 6.0625, 'loss': 0.0228, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9112, 'compress@10': 1.0, 'time@10': 2.8328}:  50%|█████     | 15/30 [00:30<00:24,  1.61s/it]{'epoch': 7, 'num_users': 6.0625, 'loss': 0.0228, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9112, 'compress@10': 1.0, 'time@10': 2.8328}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it]{'epoch': 7, 'num_users': 5.8235, 'loss': 0.0237, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 2.6978}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it]{'epoch': 7, 'num_users': 5.8235, 'loss': 0.0237, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 2.6978}:  57%|█████▋    | 17/30 [00:30<00:13,  1.04s/it]{'epoch': 7, 'num_users': 6.0556, 'loss': 0.0256, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8978, 'compress@10': 1.0, 'time@10': 2.6586}:  57%|█████▋    | 17/30 [00:32<00:13,  1.04s/it] {'epoch': 7, 'num_users': 6.0556, 'loss': 0.0256, 'hit_ratio@10': 0.855, 'ndcg@10': 0.8978, 'compress@10': 1.0, 'time@10': 2.6586}:  60%|██████    | 18/30 [00:32<00:16,  1.34s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.0248, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8987, 'compress@10': 1.0, 'time@10': 2.6176}:  60%|██████    | 18/30 [00:33<00:16,  1.34s/it]  {'epoch': 7, 'num_users': 6.0, 'loss': 0.0248, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8987, 'compress@10': 1.0, 'time@10': 2.6176}:  63%|██████▎   | 19/30 [00:33<00:13,  1.23s/it]{'epoch': 7, 'num_users': 6.15, 'loss': 0.0261, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 2.6943}:  63%|██████▎   | 19/30 [00:37<00:13,  1.23s/it]{'epoch': 7, 'num_users': 6.15, 'loss': 0.0261, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9003, 'compress@10': 1.0, 'time@10': 2.6943}:  67%|██████▋   | 20/30 [00:37<00:21,  2.12s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0267, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.9002, 'compress@10': 1.0, 'time@10': 2.8455}:  67%|██████▋   | 20/30 [00:40<00:21,  2.12s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0267, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.9002, 'compress@10': 1.0, 'time@10': 2.8455}:  70%|███████   | 21/30 [00:40<00:21,  2.37s/it]{'epoch': 7, 'num_users': 6.1818, 'loss': 0.0261, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.901, 'compress@10': 1.0, 'time@10': 2.7808}:  70%|███████   | 21/30 [00:42<00:21,  2.37s/it] {'epoch': 7, 'num_users': 6.1818, 'loss': 0.0261, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.901, 'compress@10': 1.0, 'time@10': 2.7808}:  73%|███████▎  | 22/30 [00:42<00:16,  2.10s/it]{'epoch': 7, 'num_users': 6.1304, 'loss': 0.0257, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 2.7799}:  73%|███████▎  | 22/30 [00:43<00:16,  2.10s/it]{'epoch': 7, 'num_users': 6.1304, 'loss': 0.0257, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 2.7799}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it]{'epoch': 7, 'num_users': 5.9583, 'loss': 0.028, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8855, 'compress@10': 1.0, 'time@10': 2.675}:  77%|███████▋  | 23/30 [00:44<00:13,  1.89s/it]  {'epoch': 7, 'num_users': 5.9583, 'loss': 0.028, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.8855, 'compress@10': 1.0, 'time@10': 2.675}:  80%|████████  | 24/30 [00:44<00:08,  1.41s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0382, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8597, 'compress@10': 1.0, 'time@10': 2.579}:  80%|████████  | 24/30 [00:44<00:08,  1.41s/it]  {'epoch': 7, 'num_users': 5.8, 'loss': 0.0382, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8597, 'compress@10': 1.0, 'time@10': 2.579}:  83%|████████▎ | 25/30 [00:44<00:05,  1.04s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0381, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8629, 'compress@10': 1.0, 'time@10': 2.6891}:  83%|████████▎ | 25/30 [00:49<00:05,  1.04s/it]{'epoch': 7, 'num_users': 5.8077, 'loss': 0.0381, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8629, 'compress@10': 1.0, 'time@10': 2.6891}:  87%|████████▋ | 26/30 [00:49<00:09,  2.37s/it]{'epoch': 7, 'num_users': 5.8889, 'loss': 0.0373, 'hit_ratio@10': 0.868, 'ndcg@10': 0.864, 'compress@10': 1.0, 'time@10': 2.729}:  87%|████████▋ | 26/30 [00:51<00:09,  2.37s/it]   {'epoch': 7, 'num_users': 5.8889, 'loss': 0.0373, 'hit_ratio@10': 0.868, 'ndcg@10': 0.864, 'compress@10': 1.0, 'time@10': 2.729}:  90%|█████████ | 27/30 [00:51<00:06,  2.23s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.0372, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8663, 'compress@10': 1.0, 'time@10': 2.7688}:  90%|█████████ | 27/30 [00:55<00:06,  2.23s/it]{'epoch': 7, 'num_users': 6.0, 'loss': 0.0372, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.8663, 'compress@10': 1.0, 'time@10': 2.7688}:  93%|█████████▎| 28/30 [00:55<00:05,  2.72s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0364, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 2.7747}:  93%|█████████▎| 28/30 [00:57<00:05,  2.72s/it]{'epoch': 7, 'num_users': 5.8621, 'loss': 0.0364, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 2.7747}:  97%|█████████▋| 29/30 [00:57<00:02,  2.36s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0359, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8707, 'compress@10': 1.0, 'time@10': 2.7689}:  97%|█████████▋| 29/30 [00:59<00:02,  2.36s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0359, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8707, 'compress@10': 1.0, 'time@10': 2.7689}: 100%|██████████| 30/30 [00:59<00:00,  2.44s/it]{'epoch': 7, 'num_users': 5.8667, 'loss': 0.0359, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.8707, 'compress@10': 1.0, 'time@10': 2.7689}: 100%|██████████| 30/30 [00:59<00:00,  1.99s/it]
Epoch: 7
Avg # of users: 5.866666666666666
Avg Loss: 0.035921817114550426
Avg hit ratio: 0.8716737717766029
Avg ndcg: 0.8707279378914362
Avg compression ratio: 1.0
Avg train time: 2.7688863118489584
Std train time: 1.763627115594202
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 2.6385}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 2.6385}:   3%|▎         | 1/30 [00:01<00:39,  1.35s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9086, 'compress@10': 1.0, 'time@10': 2.3859}:   3%|▎         | 1/30 [00:03<00:39,  1.35s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9086, 'compress@10': 1.0, 'time@10': 2.3859}:   7%|▋         | 2/30 [00:03<00:51,  1.83s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 1.8603}:   7%|▋         | 2/30 [00:03<00:51,  1.83s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 1.8603}:  10%|█         | 3/30 [00:03<00:32,  1.19s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 1.8694}:  10%|█         | 3/30 [00:05<00:32,  1.19s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 1.8694}:  13%|█▎        | 4/30 [00:05<00:38,  1.49s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0211, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9087, 'compress@10': 1.0, 'time@10': 2.9375}:  13%|█▎        | 4/30 [00:09<00:38,  1.49s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0211, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9087, 'compress@10': 1.0, 'time@10': 2.9375}:  17%|█▋        | 5/30 [00:09<00:56,  2.26s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.043, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 2.9744}:  17%|█▋        | 5/30 [00:12<00:56,  2.26s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.043, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 2.9744}:  20%|██        | 6/30 [00:12<01:01,  2.58s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.043, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9106, 'compress@10': 1.0, 'time@10': 3.0606}:  20%|██        | 6/30 [00:14<01:01,  2.58s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.043, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9106, 'compress@10': 1.0, 'time@10': 3.0606}:  23%|██▎       | 7/30 [00:14<00:53,  2.33s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0398, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9131, 'compress@10': 1.0, 'time@10': 2.9873}:  23%|██▎       | 7/30 [00:17<00:53,  2.33s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0398, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9131, 'compress@10': 1.0, 'time@10': 2.9873}:  27%|██▋       | 8/30 [00:17<00:53,  2.41s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0382, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 3.2017}:  27%|██▋       | 8/30 [00:19<00:53,  2.41s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0382, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 3.2017}:  30%|███       | 9/30 [00:19<00:51,  2.43s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0389, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.1855}:  30%|███       | 9/30 [00:22<00:51,  2.43s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0389, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.1855}:  33%|███▎      | 10/30 [00:22<00:52,  2.63s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.0466, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9347, 'compress@10': 1.0, 'time@10': 3.2326}:  33%|███▎      | 10/30 [00:24<00:52,  2.63s/it]{'epoch': 8, 'num_users': 6.6364, 'loss': 0.0466, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9347, 'compress@10': 1.0, 'time@10': 3.2326}:  37%|███▋      | 11/30 [00:24<00:45,  2.40s/it]{'epoch': 8, 'num_users': 6.4167, 'loss': 0.0437, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.0285}:  37%|███▋      | 11/30 [00:25<00:45,  2.40s/it]{'epoch': 8, 'num_users': 6.4167, 'loss': 0.0437, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.0285}:  40%|████      | 12/30 [00:25<00:34,  1.92s/it]{'epoch': 8, 'num_users': 6.6154, 'loss': 0.0443, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9288, 'compress@10': 1.0, 'time@10': 3.0328}:  40%|████      | 12/30 [00:26<00:34,  1.92s/it] {'epoch': 8, 'num_users': 6.6154, 'loss': 0.0443, 'hit_ratio@10': 0.871, 'ndcg@10': 0.9288, 'compress@10': 1.0, 'time@10': 3.0328}:  43%|████▎     | 13/30 [00:26<00:30,  1.81s/it]{'epoch': 8, 'num_users': 6.3571, 'loss': 0.0422, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9203, 'compress@10': 1.0, 'time@10': 2.8419}:  43%|████▎     | 13/30 [00:27<00:30,  1.81s/it]{'epoch': 8, 'num_users': 6.3571, 'loss': 0.0422, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9203, 'compress@10': 1.0, 'time@10': 2.8419}:  47%|████▋     | 14/30 [00:27<00:22,  1.38s/it]{'epoch': 8, 'num_users': 6.2667, 'loss': 0.0411, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9199, 'compress@10': 1.0, 'time@10': 2.9307}:  47%|████▋     | 14/30 [00:29<00:22,  1.38s/it] {'epoch': 8, 'num_users': 6.2667, 'loss': 0.0411, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9199, 'compress@10': 1.0, 'time@10': 2.9307}:  50%|█████     | 15/30 [00:29<00:24,  1.60s/it]{'epoch': 8, 'num_users': 6.0625, 'loss': 0.0394, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 2.7936}:  50%|█████     | 15/30 [00:30<00:24,  1.60s/it]{'epoch': 8, 'num_users': 6.0625, 'loss': 0.0394, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 2.7936}:  53%|█████▎    | 16/30 [00:30<00:18,  1.35s/it]{'epoch': 8, 'num_users': 5.8235, 'loss': 0.0387, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 2.6616}:  53%|█████▎    | 16/30 [00:30<00:18,  1.35s/it]{'epoch': 8, 'num_users': 5.8235, 'loss': 0.0387, 'hit_ratio@10': 0.8563, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 2.6616}:  57%|█████▋    | 17/30 [00:30<00:13,  1.04s/it]{'epoch': 8, 'num_users': 6.0556, 'loss': 0.0378, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 2.6226}:  57%|█████▋    | 17/30 [00:32<00:13,  1.04s/it]{'epoch': 8, 'num_users': 6.0556, 'loss': 0.0378, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 2.6226}:  60%|██████    | 18/30 [00:32<00:15,  1.32s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0364, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.9057, 'compress@10': 1.0, 'time@10': 2.5816}:  60%|██████    | 18/30 [00:33<00:15,  1.32s/it]   {'epoch': 8, 'num_users': 6.0, 'loss': 0.0364, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.9057, 'compress@10': 1.0, 'time@10': 2.5816}:  63%|██████▎   | 19/30 [00:33<00:14,  1.33s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.0386, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 2.6563}:  63%|██████▎   | 19/30 [00:37<00:14,  1.33s/it]{'epoch': 8, 'num_users': 6.15, 'loss': 0.0386, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 2.6563}:  67%|██████▋   | 20/30 [00:37<00:21,  2.16s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0384, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9068, 'compress@10': 1.0, 'time@10': 2.8065}:  67%|██████▋   | 20/30 [00:40<00:21,  2.16s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0384, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9068, 'compress@10': 1.0, 'time@10': 2.8065}:  70%|███████   | 21/30 [00:40<00:21,  2.39s/it]{'epoch': 8, 'num_users': 6.1818, 'loss': 0.0376, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.907, 'compress@10': 1.0, 'time@10': 2.7441}:  70%|███████   | 21/30 [00:42<00:21,  2.39s/it] {'epoch': 8, 'num_users': 6.1818, 'loss': 0.0376, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.907, 'compress@10': 1.0, 'time@10': 2.7441}:  73%|███████▎  | 22/30 [00:42<00:16,  2.12s/it]{'epoch': 8, 'num_users': 6.1304, 'loss': 0.0369, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 2.7433}:  73%|███████▎  | 22/30 [00:43<00:16,  2.12s/it]{'epoch': 8, 'num_users': 6.1304, 'loss': 0.0369, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 2.7433}:  77%|███████▋  | 23/30 [00:43<00:13,  1.90s/it]{'epoch': 8, 'num_users': 5.9583, 'loss': 0.0382, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 2.6397}:  77%|███████▋  | 23/30 [00:44<00:13,  1.90s/it]{'epoch': 8, 'num_users': 5.9583, 'loss': 0.0382, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 2.6397}:  80%|████████  | 24/30 [00:44<00:08,  1.42s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0448, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 2.5441}:  80%|████████  | 24/30 [00:44<00:08,  1.42s/it]   {'epoch': 8, 'num_users': 5.8, 'loss': 0.0448, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 2.5441}:  83%|████████▎ | 25/30 [00:44<00:05,  1.04s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.0453, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8703, 'compress@10': 1.0, 'time@10': 2.6637}:  83%|████████▎ | 25/30 [00:49<00:05,  1.04s/it]{'epoch': 8, 'num_users': 5.8077, 'loss': 0.0453, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.8703, 'compress@10': 1.0, 'time@10': 2.6637}:  87%|████████▋ | 26/30 [00:49<00:09,  2.43s/it]{'epoch': 8, 'num_users': 5.8889, 'loss': 0.0448, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8721, 'compress@10': 1.0, 'time@10': 2.7067}:  87%|████████▋ | 26/30 [00:51<00:09,  2.43s/it]{'epoch': 8, 'num_users': 5.8889, 'loss': 0.0448, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8721, 'compress@10': 1.0, 'time@10': 2.7067}:  90%|█████████ | 27/30 [00:51<00:06,  2.28s/it]{'epoch': 8, 'num_users': 6.0, 'loss': 0.0471, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8718, 'compress@10': 1.0, 'time@10': 2.7357}:  90%|█████████ | 27/30 [00:55<00:06,  2.28s/it]   {'epoch': 8, 'num_users': 6.0, 'loss': 0.0471, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8718, 'compress@10': 1.0, 'time@10': 2.7357}:  93%|█████████▎| 28/30 [00:55<00:05,  2.66s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.064, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 2.7334}:  93%|█████████▎| 28/30 [00:56<00:05,  2.66s/it]{'epoch': 8, 'num_users': 5.8621, 'loss': 0.064, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 2.7334}:  97%|█████████▋| 29/30 [00:56<00:02,  2.28s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0635, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 2.7228}:  97%|█████████▋| 29/30 [00:59<00:02,  2.28s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0635, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 2.7228}: 100%|██████████| 30/30 [00:59<00:00,  2.33s/it]{'epoch': 8, 'num_users': 5.8667, 'loss': 0.0635, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 2.7228}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 8
Avg # of users: 5.866666666666666
Avg Loss: 0.06354414190421658
Avg hit ratio: 0.8427492946735444
Avg ndcg: 0.8962579117275526
Avg compression ratio: 1.0
Avg train time: 2.722790312767029
Std train time: 1.7228700478607575
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0708, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9375, 'compress@10': 1.0, 'time@10': 2.5878}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0708, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9375, 'compress@10': 1.0, 'time@10': 2.5878}:   3%|▎         | 1/30 [00:01<00:38,  1.32s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0614, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9655, 'compress@10': 1.0, 'time@10': 2.3761}:   3%|▎         | 1/30 [00:03<00:38,  1.32s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0614, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9655, 'compress@10': 1.0, 'time@10': 2.3761}:   7%|▋         | 2/30 [00:03<00:51,  1.83s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0421, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9294, 'compress@10': 1.0, 'time@10': 1.8484}:   7%|▋         | 2/30 [00:03<00:51,  1.83s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0421, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9294, 'compress@10': 1.0, 'time@10': 1.8484}:  10%|█         | 3/30 [00:03<00:32,  1.19s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0461, 'hit_ratio@10': 0.805, 'ndcg@10': 0.9353, 'compress@10': 1.0, 'time@10': 1.8584}:  10%|█         | 3/30 [00:05<00:32,  1.19s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0461, 'hit_ratio@10': 0.805, 'ndcg@10': 0.9353, 'compress@10': 1.0, 'time@10': 1.8584}:  13%|█▎        | 4/30 [00:05<00:38,  1.48s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9383, 'compress@10': 1.0, 'time@10': 2.9344}:  13%|█▎        | 4/30 [00:09<00:38,  1.48s/it] {'epoch': 9, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.836, 'ndcg@10': 0.9383, 'compress@10': 1.0, 'time@10': 2.9344}:  17%|█▋        | 5/30 [00:09<00:56,  2.26s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0648, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.9236, 'compress@10': 1.0, 'time@10': 2.9953}:  17%|█▋        | 5/30 [00:12<00:56,  2.26s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0648, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.9236, 'compress@10': 1.0, 'time@10': 2.9953}:  20%|██        | 6/30 [00:12<01:02,  2.62s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0651, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 3.0818}:  20%|██        | 6/30 [00:14<01:02,  2.62s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0651, 'hit_ratio@10': 0.8308, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 3.0818}:  23%|██▎       | 7/30 [00:14<00:54,  2.36s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0635, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.93, 'compress@10': 1.0, 'time@10': 2.9858}:  23%|██▎       | 7/30 [00:17<00:54,  2.36s/it]   {'epoch': 9, 'num_users': 6.125, 'loss': 0.0635, 'hit_ratio@10': 0.8448, 'ndcg@10': 0.93, 'compress@10': 1.0, 'time@10': 2.9858}:  27%|██▋       | 8/30 [00:17<00:51,  2.36s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0637, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.934, 'compress@10': 1.0, 'time@10': 3.2268}:  27%|██▋       | 8/30 [00:19<00:51,  2.36s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0637, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.934, 'compress@10': 1.0, 'time@10': 3.2268}:  30%|███       | 9/30 [00:19<00:51,  2.44s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0719, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.9436, 'compress@10': 1.0, 'time@10': 3.2114}:  30%|███       | 9/30 [00:22<00:51,  2.44s/it]  {'epoch': 9, 'num_users': 6.3, 'loss': 0.0719, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.9436, 'compress@10': 1.0, 'time@10': 3.2114}:  33%|███▎      | 10/30 [00:22<00:52,  2.65s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.0735, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.9421, 'compress@10': 1.0, 'time@10': 3.2666}:  33%|███▎      | 10/30 [00:24<00:52,  2.65s/it]{'epoch': 9, 'num_users': 6.6364, 'loss': 0.0735, 'hit_ratio@10': 0.8456, 'ndcg@10': 0.9421, 'compress@10': 1.0, 'time@10': 3.2666}:  37%|███▋      | 11/30 [00:24<00:46,  2.43s/it]{'epoch': 9, 'num_users': 6.4167, 'loss': 0.0692, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.9367, 'compress@10': 1.0, 'time@10': 3.0591}:  37%|███▋      | 11/30 [00:25<00:46,  2.43s/it]{'epoch': 9, 'num_users': 6.4167, 'loss': 0.0692, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.9367, 'compress@10': 1.0, 'time@10': 3.0591}:  40%|████      | 12/30 [00:25<00:34,  1.94s/it]{'epoch': 9, 'num_users': 6.6154, 'loss': 0.0756, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 3.0697}:  40%|████      | 12/30 [00:27<00:34,  1.94s/it]{'epoch': 9, 'num_users': 6.6154, 'loss': 0.0756, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 3.0697}:  43%|████▎     | 13/30 [00:27<00:31,  1.84s/it]{'epoch': 9, 'num_users': 6.3571, 'loss': 0.0708, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.9378, 'compress@10': 1.0, 'time@10': 2.8751}:  43%|████▎     | 13/30 [00:27<00:31,  1.84s/it]{'epoch': 9, 'num_users': 6.3571, 'loss': 0.0708, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.9378, 'compress@10': 1.0, 'time@10': 2.8751}:  47%|████▋     | 14/30 [00:27<00:22,  1.40s/it]{'epoch': 9, 'num_users': 6.2667, 'loss': 0.0705, 'hit_ratio@10': 0.8079, 'ndcg@10': 0.9435, 'compress@10': 1.0, 'time@10': 2.9644}:  47%|████▋     | 14/30 [00:29<00:22,  1.40s/it]{'epoch': 9, 'num_users': 6.2667, 'loss': 0.0705, 'hit_ratio@10': 0.8079, 'ndcg@10': 0.9435, 'compress@10': 1.0, 'time@10': 2.9644}:  50%|█████     | 15/30 [00:29<00:24,  1.62s/it]{'epoch': 9, 'num_users': 6.0625, 'loss': 0.0666, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 2.8261}:  50%|█████     | 15/30 [00:30<00:24,  1.62s/it]{'epoch': 9, 'num_users': 6.0625, 'loss': 0.0666, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 2.8261}:  53%|█████▎    | 16/30 [00:30<00:19,  1.37s/it]{'epoch': 9, 'num_users': 5.8235, 'loss': 0.0646, 'hit_ratio@10': 0.7971, 'ndcg@10': 0.9424, 'compress@10': 1.0, 'time@10': 2.691}:  53%|█████▎    | 16/30 [00:30<00:19,  1.37s/it] {'epoch': 9, 'num_users': 5.8235, 'loss': 0.0646, 'hit_ratio@10': 0.7971, 'ndcg@10': 0.9424, 'compress@10': 1.0, 'time@10': 2.691}:  57%|█████▋    | 17/30 [00:30<00:13,  1.05s/it]{'epoch': 9, 'num_users': 6.0556, 'loss': 0.0635, 'hit_ratio@10': 0.8025, 'ndcg@10': 0.9417, 'compress@10': 1.0, 'time@10': 2.6558}:  57%|█████▋    | 17/30 [00:32<00:13,  1.05s/it]{'epoch': 9, 'num_users': 6.0556, 'loss': 0.0635, 'hit_ratio@10': 0.8025, 'ndcg@10': 0.9417, 'compress@10': 1.0, 'time@10': 2.6558}:  60%|██████    | 18/30 [00:32<00:16,  1.36s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.0606, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 2.6123}:  60%|██████    | 18/30 [00:33<00:16,  1.36s/it]   {'epoch': 9, 'num_users': 6.0, 'loss': 0.0606, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 2.6123}:  63%|██████▎   | 19/30 [00:33<00:13,  1.23s/it]{'epoch': 9, 'num_users': 6.15, 'loss': 0.0629, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.9437, 'compress@10': 1.0, 'time@10': 2.6869}:  63%|██████▎   | 19/30 [00:37<00:13,  1.23s/it]{'epoch': 9, 'num_users': 6.15, 'loss': 0.0629, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.9437, 'compress@10': 1.0, 'time@10': 2.6869}:  67%|██████▋   | 20/30 [00:37<00:21,  2.11s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0645, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.9433, 'compress@10': 1.0, 'time@10': 2.8326}:  67%|██████▋   | 20/30 [00:40<00:21,  2.11s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0645, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.9433, 'compress@10': 1.0, 'time@10': 2.8326}:  70%|███████   | 21/30 [00:40<00:21,  2.34s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0632, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 2.7742}:  70%|███████   | 21/30 [00:42<00:21,  2.34s/it]{'epoch': 9, 'num_users': 6.1818, 'loss': 0.0632, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 2.7742}:  73%|███████▎  | 22/30 [00:42<00:16,  2.11s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0617, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.9391, 'compress@10': 1.0, 'time@10': 2.7694}:  73%|███████▎  | 22/30 [00:43<00:16,  2.11s/it]{'epoch': 9, 'num_users': 6.1304, 'loss': 0.0617, 'hit_ratio@10': 0.8211, 'ndcg@10': 0.9391, 'compress@10': 1.0, 'time@10': 2.7694}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it]{'epoch': 9, 'num_users': 5.9583, 'loss': 0.0609, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.9292, 'compress@10': 1.0, 'time@10': 2.6654}:  77%|███████▋  | 23/30 [00:44<00:13,  1.89s/it]{'epoch': 9, 'num_users': 5.9583, 'loss': 0.0609, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.9292, 'compress@10': 1.0, 'time@10': 2.6654}:  80%|████████  | 24/30 [00:44<00:08,  1.41s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0608, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.9224, 'compress@10': 1.0, 'time@10': 2.5713}:  80%|████████  | 24/30 [00:44<00:08,  1.41s/it]   {'epoch': 9, 'num_users': 5.8, 'loss': 0.0608, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.9224, 'compress@10': 1.0, 'time@10': 2.5713}:  83%|████████▎ | 25/30 [00:44<00:05,  1.04s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0595, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.9234, 'compress@10': 1.0, 'time@10': 2.6903}:  83%|████████▎ | 25/30 [00:49<00:05,  1.04s/it]{'epoch': 9, 'num_users': 5.8077, 'loss': 0.0595, 'hit_ratio@10': 0.8175, 'ndcg@10': 0.9234, 'compress@10': 1.0, 'time@10': 2.6903}:  87%|████████▋ | 26/30 [00:49<00:09,  2.44s/it]{'epoch': 9, 'num_users': 5.8889, 'loss': 0.058, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.9229, 'compress@10': 1.0, 'time@10': 2.7466}:  87%|████████▋ | 26/30 [00:52<00:09,  2.44s/it] {'epoch': 9, 'num_users': 5.8889, 'loss': 0.058, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.9229, 'compress@10': 1.0, 'time@10': 2.7466}:  90%|█████████ | 27/30 [00:52<00:07,  2.35s/it]{'epoch': 9, 'num_users': 6.0, 'loss': 0.0582, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.926, 'compress@10': 1.0, 'time@10': 2.779}:  90%|█████████ | 27/30 [00:55<00:07,  2.35s/it]    {'epoch': 9, 'num_users': 6.0, 'loss': 0.0582, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.926, 'compress@10': 1.0, 'time@10': 2.779}:  93%|█████████▎| 28/30 [00:55<00:05,  2.75s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0816, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.9273, 'compress@10': 1.0, 'time@10': 2.7807}:  93%|█████████▎| 28/30 [00:57<00:05,  2.75s/it]{'epoch': 9, 'num_users': 5.8621, 'loss': 0.0816, 'hit_ratio@10': 0.8129, 'ndcg@10': 0.9273, 'compress@10': 1.0, 'time@10': 2.7807}:  97%|█████████▋| 29/30 [00:57<00:02,  2.36s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0794, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.928, 'compress@10': 1.0, 'time@10': 2.7735}:  97%|█████████▋| 29/30 [00:59<00:02,  2.36s/it] {'epoch': 9, 'num_users': 5.8667, 'loss': 0.0794, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.928, 'compress@10': 1.0, 'time@10': 2.7735}: 100%|██████████| 30/30 [00:59<00:00,  2.43s/it]{'epoch': 9, 'num_users': 5.8667, 'loss': 0.0794, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.928, 'compress@10': 1.0, 'time@10': 2.7735}: 100%|██████████| 30/30 [00:59<00:00,  1.99s/it]
Epoch: 9
Avg # of users: 5.866666666666666
Avg Loss: 0.07943197277230706
Avg hit ratio: 0.8137560118375144
Avg ndcg: 0.9279999262205691
Avg compression ratio: 1.0
Avg train time: 2.7735207001368205
Std train time: 1.745844768464817
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.056, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9841, 'compress@10': 1.0, 'time@10': 2.6136}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.056, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9841, 'compress@10': 1.0, 'time@10': 2.6136}:   3%|▎         | 1/30 [00:01<00:39,  1.35s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.09, 'hit_ratio@10': 0.7861, 'ndcg@10': 0.9121, 'compress@10': 1.0, 'time@10': 2.3505}:   3%|▎         | 1/30 [00:03<00:39,  1.35s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.09, 'hit_ratio@10': 0.7861, 'ndcg@10': 0.9121, 'compress@10': 1.0, 'time@10': 2.3505}:   7%|▋         | 2/30 [00:03<00:50,  1.80s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0644, 'hit_ratio@10': 0.7145, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 1.8195}:   7%|▋         | 2/30 [00:03<00:50,  1.80s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0644, 'hit_ratio@10': 0.7145, 'ndcg@10': 0.8925, 'compress@10': 1.0, 'time@10': 1.8195}:  10%|█         | 3/30 [00:03<00:31,  1.17s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0636, 'hit_ratio@10': 0.7591, 'ndcg@10': 0.8872, 'compress@10': 1.0, 'time@10': 1.8146}:  10%|█         | 3/30 [00:05<00:31,  1.17s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0636, 'hit_ratio@10': 0.7591, 'ndcg@10': 0.8872, 'compress@10': 1.0, 'time@10': 1.8146}:  13%|█▎        | 4/30 [00:05<00:37,  1.43s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0662, 'hit_ratio@10': 0.7993, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 2.8636}:  13%|█▎        | 4/30 [00:09<00:37,  1.43s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0662, 'hit_ratio@10': 0.7993, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 2.8636}:  17%|█▋        | 5/30 [00:09<00:54,  2.20s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.1037, 'hit_ratio@10': 0.7883, 'ndcg@10': 0.9604, 'compress@10': 1.0, 'time@10': 2.9652}:  17%|█▋        | 5/30 [00:12<00:54,  2.20s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.1037, 'hit_ratio@10': 0.7883, 'ndcg@10': 0.9604, 'compress@10': 1.0, 'time@10': 2.9652}:  20%|██        | 6/30 [00:12<01:03,  2.64s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.1122, 'hit_ratio@10': 0.7728, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 3.0325}:  20%|██        | 6/30 [00:14<01:03,  2.64s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.1122, 'hit_ratio@10': 0.7728, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 3.0325}:  23%|██▎       | 7/30 [00:14<00:54,  2.35s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.1123, 'hit_ratio@10': 0.7869, 'ndcg@10': 0.9643, 'compress@10': 1.0, 'time@10': 2.951}:  23%|██▎       | 7/30 [00:16<00:54,  2.35s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.1123, 'hit_ratio@10': 0.7869, 'ndcg@10': 0.9643, 'compress@10': 1.0, 'time@10': 2.951}:  27%|██▋       | 8/30 [00:16<00:52,  2.37s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.1075, 'hit_ratio@10': 0.782, 'ndcg@10': 0.9694, 'compress@10': 1.0, 'time@10': 3.1474}:  27%|██▋       | 8/30 [00:19<00:52,  2.37s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.1075, 'hit_ratio@10': 0.782, 'ndcg@10': 0.9694, 'compress@10': 1.0, 'time@10': 3.1474}:  30%|███       | 9/30 [00:19<00:49,  2.38s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.1138, 'hit_ratio@10': 0.7788, 'ndcg@10': 0.9728, 'compress@10': 1.0, 'time@10': 3.1406}:  30%|███       | 9/30 [00:22<00:49,  2.38s/it]  {'epoch': 10, 'num_users': 6.3, 'loss': 0.1138, 'hit_ratio@10': 0.7788, 'ndcg@10': 0.9728, 'compress@10': 1.0, 'time@10': 3.1406}:  33%|███▎      | 10/30 [00:22<00:52,  2.60s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.1102, 'hit_ratio@10': 0.7885, 'ndcg@10': 0.9748, 'compress@10': 1.0, 'time@10': 3.1954}:  33%|███▎      | 10/30 [00:24<00:52,  2.60s/it]{'epoch': 10, 'num_users': 6.6364, 'loss': 0.1102, 'hit_ratio@10': 0.7885, 'ndcg@10': 0.9748, 'compress@10': 1.0, 'time@10': 3.1954}:  37%|███▋      | 11/30 [00:24<00:45,  2.39s/it]{'epoch': 10, 'num_users': 6.4167, 'loss': 0.1029, 'hit_ratio@10': 0.7852, 'ndcg@10': 0.9706, 'compress@10': 1.0, 'time@10': 2.9932}:  37%|███▋      | 11/30 [00:25<00:45,  2.39s/it]{'epoch': 10, 'num_users': 6.4167, 'loss': 0.1029, 'hit_ratio@10': 0.7852, 'ndcg@10': 0.9706, 'compress@10': 1.0, 'time@10': 2.9932}:  40%|████      | 12/30 [00:25<00:34,  1.91s/it]{'epoch': 10, 'num_users': 6.6154, 'loss': 0.1183, 'hit_ratio@10': 0.7843, 'ndcg@10': 0.9799, 'compress@10': 1.0, 'time@10': 2.997}:  40%|████      | 12/30 [00:26<00:34,  1.91s/it] {'epoch': 10, 'num_users': 6.6154, 'loss': 0.1183, 'hit_ratio@10': 0.7843, 'ndcg@10': 0.9799, 'compress@10': 1.0, 'time@10': 2.997}:  43%|████▎     | 13/30 [00:26<00:30,  1.80s/it]{'epoch': 10, 'num_users': 6.3571, 'loss': 0.1114, 'hit_ratio@10': 0.764, 'ndcg@10': 0.9651, 'compress@10': 1.0, 'time@10': 2.8078}:  43%|████▎     | 13/30 [00:27<00:30,  1.80s/it]{'epoch': 10, 'num_users': 6.3571, 'loss': 0.1114, 'hit_ratio@10': 0.764, 'ndcg@10': 0.9651, 'compress@10': 1.0, 'time@10': 2.8078}:  47%|████▋     | 14/30 [00:27<00:21,  1.37s/it]{'epoch': 10, 'num_users': 6.2667, 'loss': 0.1082, 'hit_ratio@10': 0.7733, 'ndcg@10': 0.9705, 'compress@10': 1.0, 'time@10': 2.901}:  47%|████▋     | 14/30 [00:29<00:21,  1.37s/it]{'epoch': 10, 'num_users': 6.2667, 'loss': 0.1082, 'hit_ratio@10': 0.7733, 'ndcg@10': 0.9705, 'compress@10': 1.0, 'time@10': 2.901}:  50%|█████     | 15/30 [00:29<00:23,  1.60s/it]{'epoch': 10, 'num_users': 6.0625, 'loss': 0.1031, 'hit_ratio@10': 0.7718, 'ndcg@10': 0.9634, 'compress@10': 1.0, 'time@10': 2.7664}:  50%|█████     | 15/30 [00:29<00:23,  1.60s/it]{'epoch': 10, 'num_users': 6.0625, 'loss': 0.1031, 'hit_ratio@10': 0.7718, 'ndcg@10': 0.9634, 'compress@10': 1.0, 'time@10': 2.7664}:  53%|█████▎    | 16/30 [00:29<00:18,  1.35s/it]{'epoch': 10, 'num_users': 5.8235, 'loss': 0.0996, 'hit_ratio@10': 0.7617, 'ndcg@10': 0.9502, 'compress@10': 1.0, 'time@10': 2.6363}:  53%|█████▎    | 16/30 [00:30<00:18,  1.35s/it]{'epoch': 10, 'num_users': 5.8235, 'loss': 0.0996, 'hit_ratio@10': 0.7617, 'ndcg@10': 0.9502, 'compress@10': 1.0, 'time@10': 2.6363}:  57%|█████▋    | 17/30 [00:30<00:13,  1.04s/it]{'epoch': 10, 'num_users': 6.0556, 'loss': 0.1006, 'hit_ratio@10': 0.7452, 'ndcg@10': 0.9434, 'compress@10': 1.0, 'time@10': 2.6015}:  57%|█████▋    | 17/30 [00:32<00:13,  1.04s/it]{'epoch': 10, 'num_users': 6.0556, 'loss': 0.1006, 'hit_ratio@10': 0.7452, 'ndcg@10': 0.9434, 'compress@10': 1.0, 'time@10': 2.6015}:  60%|██████    | 18/30 [00:32<00:16,  1.34s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.099, 'hit_ratio@10': 0.7548, 'ndcg@10': 0.9335, 'compress@10': 1.0, 'time@10': 2.5602}:  60%|██████    | 18/30 [00:33<00:16,  1.34s/it]    {'epoch': 10, 'num_users': 6.0, 'loss': 0.099, 'hit_ratio@10': 0.7548, 'ndcg@10': 0.9335, 'compress@10': 1.0, 'time@10': 2.5602}:  63%|██████▎   | 19/30 [00:33<00:13,  1.22s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.1012, 'hit_ratio@10': 0.7592, 'ndcg@10': 0.9388, 'compress@10': 1.0, 'time@10': 2.6393}:  63%|██████▎   | 19/30 [00:37<00:13,  1.22s/it]{'epoch': 10, 'num_users': 6.15, 'loss': 0.1012, 'hit_ratio@10': 0.7592, 'ndcg@10': 0.9388, 'compress@10': 1.0, 'time@10': 2.6393}:  67%|██████▋   | 20/30 [00:37<00:21,  2.10s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.1042, 'hit_ratio@10': 0.7552, 'ndcg@10': 0.94, 'compress@10': 1.0, 'time@10': 2.79}:  67%|██████▋   | 20/30 [00:40<00:21,  2.10s/it]  {'epoch': 10, 'num_users': 6.3333, 'loss': 0.1042, 'hit_ratio@10': 0.7552, 'ndcg@10': 0.94, 'compress@10': 1.0, 'time@10': 2.79}:  70%|███████   | 21/30 [00:40<00:21,  2.35s/it]{'epoch': 10, 'num_users': 6.1818, 'loss': 0.1018, 'hit_ratio@10': 0.7622, 'ndcg@10': 0.9369, 'compress@10': 1.0, 'time@10': 2.7281}:  70%|███████   | 21/30 [00:41<00:21,  2.35s/it]{'epoch': 10, 'num_users': 6.1818, 'loss': 0.1018, 'hit_ratio@10': 0.7622, 'ndcg@10': 0.9369, 'compress@10': 1.0, 'time@10': 2.7281}:  73%|███████▎  | 22/30 [00:41<00:16,  2.08s/it]{'epoch': 10, 'num_users': 6.1304, 'loss': 0.1166, 'hit_ratio@10': 0.7638, 'ndcg@10': 0.9278, 'compress@10': 1.0, 'time@10': 2.7297}:  73%|███████▎  | 22/30 [00:43<00:16,  2.08s/it]{'epoch': 10, 'num_users': 6.1304, 'loss': 0.1166, 'hit_ratio@10': 0.7638, 'ndcg@10': 0.9278, 'compress@10': 1.0, 'time@10': 2.7297}:  77%|███████▋  | 23/30 [00:43<00:13,  1.88s/it]{'epoch': 10, 'num_users': 5.9583, 'loss': 0.1135, 'hit_ratio@10': 0.757, 'ndcg@10': 0.92, 'compress@10': 1.0, 'time@10': 2.6269}:  77%|███████▋  | 23/30 [00:43<00:13,  1.88s/it]   {'epoch': 10, 'num_users': 5.9583, 'loss': 0.1135, 'hit_ratio@10': 0.757, 'ndcg@10': 0.92, 'compress@10': 1.0, 'time@10': 2.6269}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.1148, 'hit_ratio@10': 0.7401, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 2.5328}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.1148, 'hit_ratio@10': 0.7401, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 2.5328}:  83%|████████▎ | 25/30 [00:43<00:05,  1.03s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.1208, 'hit_ratio@10': 0.7355, 'ndcg@10': 0.9225, 'compress@10': 1.0, 'time@10': 2.6548}:  83%|████████▎ | 25/30 [00:49<00:05,  1.03s/it]{'epoch': 10, 'num_users': 5.8077, 'loss': 0.1208, 'hit_ratio@10': 0.7355, 'ndcg@10': 0.9225, 'compress@10': 1.0, 'time@10': 2.6548}:  87%|████████▋ | 26/30 [00:49<00:09,  2.44s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.1177, 'hit_ratio@10': 0.7427, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 2.6973}:  87%|████████▋ | 26/30 [00:51<00:09,  2.44s/it]{'epoch': 10, 'num_users': 5.8889, 'loss': 0.1177, 'hit_ratio@10': 0.7427, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 2.6973}:  90%|█████████ | 27/30 [00:51<00:06,  2.29s/it]{'epoch': 10, 'num_users': 6.0, 'loss': 0.116, 'hit_ratio@10': 0.7498, 'ndcg@10': 0.9244, 'compress@10': 1.0, 'time@10': 2.7381}:  90%|█████████ | 27/30 [00:55<00:06,  2.29s/it]    {'epoch': 10, 'num_users': 6.0, 'loss': 0.116, 'hit_ratio@10': 0.7498, 'ndcg@10': 0.9244, 'compress@10': 1.0, 'time@10': 2.7381}:  93%|█████████▎| 28/30 [00:55<00:05,  2.76s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.1183, 'hit_ratio@10': 0.738, 'ndcg@10': 0.9154, 'compress@10': 1.0, 'time@10': 2.7411}:  93%|█████████▎| 28/30 [00:56<00:05,  2.76s/it]{'epoch': 10, 'num_users': 5.8621, 'loss': 0.1183, 'hit_ratio@10': 0.738, 'ndcg@10': 0.9154, 'compress@10': 1.0, 'time@10': 2.7411}:  97%|█████████▋| 29/30 [00:56<00:02,  2.37s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.1315, 'hit_ratio@10': 0.7305, 'ndcg@10': 0.9218, 'compress@10': 1.0, 'time@10': 2.733}:  97%|█████████▋| 29/30 [00:59<00:02,  2.37s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.1315, 'hit_ratio@10': 0.7305, 'ndcg@10': 0.9218, 'compress@10': 1.0, 'time@10': 2.733}: 100%|██████████| 30/30 [00:59<00:00,  2.42s/it]{'epoch': 10, 'num_users': 5.8667, 'loss': 0.1315, 'hit_ratio@10': 0.7305, 'ndcg@10': 0.9218, 'compress@10': 1.0, 'time@10': 2.733}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 10
Avg # of users: 5.866666666666666
Avg Loss: 0.13148645745095644
Avg hit ratio: 0.7305201775548091
Avg ndcg: 0.9217815353319397
Avg compression ratio: 1.0
Avg train time: 2.7329960584640505
Std train time: 1.7182455251905018
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.7239, 'hit_ratio@10': 0.7895, 'ndcg@10': 2.2127, 'compress@10': 1.0, 'time@10': 2.7544}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.7239, 'hit_ratio@10': 0.7895, 'ndcg@10': 2.2127, 'compress@10': 1.0, 'time@10': 2.7544}:   3%|▎         | 1/30 [00:01<00:40,  1.41s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.4008, 'hit_ratio@10': 0.8141, 'ndcg@10': 1.5238, 'compress@10': 1.0, 'time@10': 2.4375}:   3%|▎         | 1/30 [00:03<00:40,  1.41s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.4008, 'hit_ratio@10': 0.8141, 'ndcg@10': 1.5238, 'compress@10': 1.0, 'time@10': 2.4375}:   7%|▋         | 2/30 [00:03<00:51,  1.84s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.2677, 'hit_ratio@10': 0.7332, 'ndcg@10': 1.3016, 'compress@10': 1.0, 'time@10': 1.8994}:   7%|▋         | 2/30 [00:03<00:51,  1.84s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.2677, 'hit_ratio@10': 0.7332, 'ndcg@10': 1.3016, 'compress@10': 1.0, 'time@10': 1.8994}:  10%|█         | 3/30 [00:03<00:32,  1.20s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.3113, 'hit_ratio@10': 0.7731, 'ndcg@10': 1.3659, 'compress@10': 1.0, 'time@10': 1.939}:  10%|█         | 3/30 [00:06<00:32,  1.20s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.3113, 'hit_ratio@10': 0.7731, 'ndcg@10': 1.3659, 'compress@10': 1.0, 'time@10': 1.939}:  13%|█▎        | 4/30 [00:06<00:40,  1.55s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.2641, 'hit_ratio@10': 0.8065, 'ndcg@10': 1.2718, 'compress@10': 1.0, 'time@10': 2.9092}:  13%|█▎        | 4/30 [00:09<00:40,  1.55s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.2641, 'hit_ratio@10': 0.8065, 'ndcg@10': 1.2718, 'compress@10': 1.0, 'time@10': 2.9092}:  17%|█▋        | 5/30 [00:09<00:55,  2.23s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.322, 'hit_ratio@10': 0.8054, 'ndcg@10': 1.3229, 'compress@10': 1.0, 'time@10': 2.9337}:  17%|█▋        | 5/30 [00:12<00:55,  2.23s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.322, 'hit_ratio@10': 0.8054, 'ndcg@10': 1.3229, 'compress@10': 1.0, 'time@10': 2.9337}:  20%|██        | 6/30 [00:12<01:00,  2.52s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.2824, 'hit_ratio@10': 0.8218, 'ndcg@10': 1.2766, 'compress@10': 1.0, 'time@10': 2.9678}:  20%|██        | 6/30 [00:14<01:00,  2.52s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.2824, 'hit_ratio@10': 0.8218, 'ndcg@10': 1.2766, 'compress@10': 1.0, 'time@10': 2.9678}:  23%|██▎       | 7/30 [00:14<00:51,  2.22s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.255, 'hit_ratio@10': 0.8369, 'ndcg@10': 1.219, 'compress@10': 1.0, 'time@10': 2.8966}:  23%|██▎       | 7/30 [00:16<00:51,  2.22s/it]   {'epoch': 11, 'num_users': 6.125, 'loss': 0.255, 'hit_ratio@10': 0.8369, 'ndcg@10': 1.219, 'compress@10': 1.0, 'time@10': 2.8966}:  27%|██▋       | 8/30 [00:16<00:50,  2.29s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.2818, 'hit_ratio@10': 0.8106, 'ndcg@10': 1.232, 'compress@10': 1.0, 'time@10': 3.1234}:  27%|██▋       | 8/30 [00:19<00:50,  2.29s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.2818, 'hit_ratio@10': 0.8106, 'ndcg@10': 1.232, 'compress@10': 1.0, 'time@10': 3.1234}:  30%|███       | 9/30 [00:19<00:49,  2.36s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.2577, 'hit_ratio@10': 0.8273, 'ndcg@10': 1.2004, 'compress@10': 1.0, 'time@10': 3.1272}:  30%|███       | 9/30 [00:22<00:49,  2.36s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.2577, 'hit_ratio@10': 0.8273, 'ndcg@10': 1.2004, 'compress@10': 1.0, 'time@10': 3.1272}:  33%|███▎      | 10/30 [00:22<00:52,  2.61s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.2365, 'hit_ratio@10': 0.829, 'ndcg@10': 1.175, 'compress@10': 1.0, 'time@10': 3.1828}:  33%|███▎      | 10/30 [00:24<00:52,  2.61s/it]{'epoch': 11, 'num_users': 6.6364, 'loss': 0.2365, 'hit_ratio@10': 0.829, 'ndcg@10': 1.175, 'compress@10': 1.0, 'time@10': 3.1828}:  37%|███▋      | 11/30 [00:24<00:45,  2.40s/it]{'epoch': 11, 'num_users': 6.4167, 'loss': 0.3323, 'hit_ratio@10': 0.8085, 'ndcg@10': 1.2587, 'compress@10': 1.0, 'time@10': 2.9814}:  37%|███▋      | 11/30 [00:25<00:45,  2.40s/it]{'epoch': 11, 'num_users': 6.4167, 'loss': 0.3323, 'hit_ratio@10': 0.8085, 'ndcg@10': 1.2587, 'compress@10': 1.0, 'time@10': 2.9814}:  40%|████      | 12/30 [00:25<00:34,  1.91s/it]{'epoch': 11, 'num_users': 6.6154, 'loss': 0.361, 'hit_ratio@10': 0.7813, 'ndcg@10': 1.2637, 'compress@10': 1.0, 'time@10': 2.9937}:  40%|████      | 12/30 [00:26<00:34,  1.91s/it] {'epoch': 11, 'num_users': 6.6154, 'loss': 0.361, 'hit_ratio@10': 0.7813, 'ndcg@10': 1.2637, 'compress@10': 1.0, 'time@10': 2.9937}:  43%|████▎     | 13/30 [00:26<00:30,  1.82s/it]{'epoch': 11, 'num_users': 6.3571, 'loss': 0.337, 'hit_ratio@10': 0.7612, 'ndcg@10': 1.2382, 'compress@10': 1.0, 'time@10': 2.8082}:  43%|████▎     | 13/30 [00:27<00:30,  1.82s/it]{'epoch': 11, 'num_users': 6.3571, 'loss': 0.337, 'hit_ratio@10': 0.7612, 'ndcg@10': 1.2382, 'compress@10': 1.0, 'time@10': 2.8082}:  47%|████▋     | 14/30 [00:27<00:22,  1.40s/it]{'epoch': 11, 'num_users': 6.2667, 'loss': 0.33, 'hit_ratio@10': 0.7707, 'ndcg@10': 1.2274, 'compress@10': 1.0, 'time@10': 2.8888}:  47%|████▋     | 14/30 [00:29<00:22,  1.40s/it] {'epoch': 11, 'num_users': 6.2667, 'loss': 0.33, 'hit_ratio@10': 0.7707, 'ndcg@10': 1.2274, 'compress@10': 1.0, 'time@10': 2.8888}:  50%|█████     | 15/30 [00:29<00:23,  1.59s/it]{'epoch': 11, 'num_users': 6.0625, 'loss': 0.3318, 'hit_ratio@10': 0.7589, 'ndcg@10': 1.1986, 'compress@10': 1.0, 'time@10': 2.7557}:  50%|█████     | 15/30 [00:29<00:23,  1.59s/it]{'epoch': 11, 'num_users': 6.0625, 'loss': 0.3318, 'hit_ratio@10': 0.7589, 'ndcg@10': 1.1986, 'compress@10': 1.0, 'time@10': 2.7557}:  53%|█████▎    | 16/30 [00:29<00:18,  1.35s/it]{'epoch': 11, 'num_users': 5.8235, 'loss': 0.3134, 'hit_ratio@10': 0.7496, 'ndcg@10': 1.1752, 'compress@10': 1.0, 'time@10': 2.6258}:  53%|█████▎    | 16/30 [00:30<00:18,  1.35s/it]{'epoch': 11, 'num_users': 5.8235, 'loss': 0.3134, 'hit_ratio@10': 0.7496, 'ndcg@10': 1.1752, 'compress@10': 1.0, 'time@10': 2.6258}:  57%|█████▋    | 17/30 [00:30<00:13,  1.03s/it]{'epoch': 11, 'num_users': 6.0556, 'loss': 0.307, 'hit_ratio@10': 0.7496, 'ndcg@10': 1.1622, 'compress@10': 1.0, 'time@10': 2.5918}:  57%|█████▋    | 17/30 [00:32<00:13,  1.03s/it] {'epoch': 11, 'num_users': 6.0556, 'loss': 0.307, 'hit_ratio@10': 0.7496, 'ndcg@10': 1.1622, 'compress@10': 1.0, 'time@10': 2.5918}:  60%|██████    | 18/30 [00:32<00:16,  1.34s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.2982, 'hit_ratio@10': 0.7553, 'ndcg@10': 1.1701, 'compress@10': 1.0, 'time@10': 2.558}:  60%|██████    | 18/30 [00:33<00:16,  1.34s/it]   {'epoch': 11, 'num_users': 6.0, 'loss': 0.2982, 'hit_ratio@10': 0.7553, 'ndcg@10': 1.1701, 'compress@10': 1.0, 'time@10': 2.558}:  63%|██████▎   | 19/30 [00:33<00:13,  1.24s/it]{'epoch': 11, 'num_users': 6.15, 'loss': 0.289, 'hit_ratio@10': 0.7666, 'ndcg@10': 1.1637, 'compress@10': 1.0, 'time@10': 2.6331}:  63%|██████▎   | 19/30 [00:37<00:13,  1.24s/it]{'epoch': 11, 'num_users': 6.15, 'loss': 0.289, 'hit_ratio@10': 0.7666, 'ndcg@10': 1.1637, 'compress@10': 1.0, 'time@10': 2.6331}:  67%|██████▋   | 20/30 [00:37<00:20,  2.09s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.2815, 'hit_ratio@10': 0.7658, 'ndcg@10': 1.1472, 'compress@10': 1.0, 'time@10': 2.7839}:  67%|██████▋   | 20/30 [00:40<00:20,  2.09s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.2815, 'hit_ratio@10': 0.7658, 'ndcg@10': 1.1472, 'compress@10': 1.0, 'time@10': 2.7839}:  70%|███████   | 21/30 [00:40<00:21,  2.34s/it]{'epoch': 11, 'num_users': 6.1818, 'loss': 0.3195, 'hit_ratio@10': 0.7682, 'ndcg@10': 1.1569, 'compress@10': 1.0, 'time@10': 2.7239}:  70%|███████   | 21/30 [00:41<00:21,  2.34s/it]{'epoch': 11, 'num_users': 6.1818, 'loss': 0.3195, 'hit_ratio@10': 0.7682, 'ndcg@10': 1.1569, 'compress@10': 1.0, 'time@10': 2.7239}:  73%|███████▎  | 22/30 [00:41<00:16,  2.09s/it]{'epoch': 11, 'num_users': 6.1304, 'loss': 0.311, 'hit_ratio@10': 0.7718, 'ndcg@10': 1.1499, 'compress@10': 1.0, 'time@10': 2.7222}:  73%|███████▎  | 22/30 [00:43<00:16,  2.09s/it] {'epoch': 11, 'num_users': 6.1304, 'loss': 0.311, 'hit_ratio@10': 0.7718, 'ndcg@10': 1.1499, 'compress@10': 1.0, 'time@10': 2.7222}:  77%|███████▋  | 23/30 [00:43<00:13,  1.87s/it]{'epoch': 11, 'num_users': 5.9583, 'loss': 0.3003, 'hit_ratio@10': 0.7646, 'ndcg@10': 1.1289, 'compress@10': 1.0, 'time@10': 2.6204}:  77%|███████▋  | 23/30 [00:43<00:13,  1.87s/it]{'epoch': 11, 'num_users': 5.9583, 'loss': 0.3003, 'hit_ratio@10': 0.7646, 'ndcg@10': 1.1289, 'compress@10': 1.0, 'time@10': 2.6204}:  80%|████████  | 24/30 [00:43<00:08,  1.40s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.2903, 'hit_ratio@10': 0.7474, 'ndcg@10': 1.1103, 'compress@10': 1.0, 'time@10': 2.5266}:  80%|████████  | 24/30 [00:43<00:08,  1.40s/it]   {'epoch': 11, 'num_users': 5.8, 'loss': 0.2903, 'hit_ratio@10': 0.7474, 'ndcg@10': 1.1103, 'compress@10': 1.0, 'time@10': 2.5266}:  83%|████████▎ | 25/30 [00:43<00:05,  1.03s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.2874, 'hit_ratio@10': 0.7557, 'ndcg@10': 1.1072, 'compress@10': 1.0, 'time@10': 2.6558}:  83%|████████▎ | 25/30 [00:49<00:05,  1.03s/it]{'epoch': 11, 'num_users': 5.8077, 'loss': 0.2874, 'hit_ratio@10': 0.7557, 'ndcg@10': 1.1072, 'compress@10': 1.0, 'time@10': 2.6558}:  87%|████████▋ | 26/30 [00:49<00:09,  2.50s/it]{'epoch': 11, 'num_users': 5.8889, 'loss': 0.2841, 'hit_ratio@10': 0.7634, 'ndcg@10': 1.1085, 'compress@10': 1.0, 'time@10': 2.7005}:  87%|████████▋ | 26/30 [00:51<00:09,  2.50s/it]{'epoch': 11, 'num_users': 5.8889, 'loss': 0.2841, 'hit_ratio@10': 0.7634, 'ndcg@10': 1.1085, 'compress@10': 1.0, 'time@10': 2.7005}:  90%|█████████ | 27/30 [00:51<00:07,  2.34s/it]{'epoch': 11, 'num_users': 6.0, 'loss': 0.2804, 'hit_ratio@10': 0.7698, 'ndcg@10': 1.1058, 'compress@10': 1.0, 'time@10': 2.7345}:  90%|█████████ | 27/30 [00:55<00:07,  2.34s/it]   {'epoch': 11, 'num_users': 6.0, 'loss': 0.2804, 'hit_ratio@10': 0.7698, 'ndcg@10': 1.1058, 'compress@10': 1.0, 'time@10': 2.7345}:  93%|█████████▎| 28/30 [00:55<00:05,  2.74s/it]{'epoch': 11, 'num_users': 5.8621, 'loss': 0.2748, 'hit_ratio@10': 0.7746, 'ndcg@10': 1.1042, 'compress@10': 1.0, 'time@10': 2.7378}:  93%|█████████▎| 28/30 [00:56<00:05,  2.74s/it]{'epoch': 11, 'num_users': 5.8621, 'loss': 0.2748, 'hit_ratio@10': 0.7746, 'ndcg@10': 1.1042, 'compress@10': 1.0, 'time@10': 2.7378}:  97%|█████████▋| 29/30 [00:56<00:02,  2.35s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.2759, 'hit_ratio@10': 0.7704, 'ndcg@10': 1.0926, 'compress@10': 1.0, 'time@10': 2.7305}:  97%|█████████▋| 29/30 [00:59<00:02,  2.35s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.2759, 'hit_ratio@10': 0.7704, 'ndcg@10': 1.0926, 'compress@10': 1.0, 'time@10': 2.7305}: 100%|██████████| 30/30 [00:59<00:00,  2.41s/it]{'epoch': 11, 'num_users': 5.8667, 'loss': 0.2759, 'hit_ratio@10': 0.7704, 'ndcg@10': 1.0926, 'compress@10': 1.0, 'time@10': 2.7305}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 11
Avg # of users: 5.866666666666666
Avg Loss: 0.27594923612206307
Avg hit ratio: 0.7703640415210594
Avg ndcg: 1.0925800576357367
Avg compression ratio: 1.0
Avg train time: 2.730505418777466
Std train time: 1.6864735398342496
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 2.638, 'hit_ratio@10': 0.4211, 'ndcg@10': 4.1311, 'compress@10': 1.0, 'time@10': 2.607}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 2.638, 'hit_ratio@10': 0.4211, 'ndcg@10': 4.1311, 'compress@10': 1.0, 'time@10': 2.607}:   3%|▎         | 1/30 [00:01<00:38,  1.33s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 1.7669, 'hit_ratio@10': 0.5976, 'ndcg@10': 2.8862, 'compress@10': 1.0, 'time@10': 2.4072}:   3%|▎         | 1/30 [00:03<00:38,  1.33s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 1.7669, 'hit_ratio@10': 0.5976, 'ndcg@10': 2.8862, 'compress@10': 1.0, 'time@10': 2.4072}:   7%|▋         | 2/30 [00:03<00:52,  1.86s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 1.2146, 'hit_ratio@10': 0.5889, 'ndcg@10': 2.3049, 'compress@10': 1.0, 'time@10': 1.8764}:   7%|▋         | 2/30 [00:04<00:52,  1.86s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 1.2146, 'hit_ratio@10': 0.5889, 'ndcg@10': 2.3049, 'compress@10': 1.0, 'time@10': 1.8764}:  10%|█         | 3/30 [00:04<00:32,  1.21s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.9352, 'hit_ratio@10': 0.647, 'ndcg@10': 1.9256, 'compress@10': 1.0, 'time@10': 1.8809}:  10%|█         | 3/30 [00:05<00:32,  1.21s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.9352, 'hit_ratio@10': 0.647, 'ndcg@10': 1.9256, 'compress@10': 1.0, 'time@10': 1.8809}:  13%|█▎        | 4/30 [00:05<00:38,  1.49s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.8948, 'hit_ratio@10': 0.6976, 'ndcg@10': 1.8842, 'compress@10': 1.0, 'time@10': 2.9495}:  13%|█▎        | 4/30 [00:09<00:38,  1.49s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.8948, 'hit_ratio@10': 0.6976, 'ndcg@10': 1.8842, 'compress@10': 1.0, 'time@10': 2.9495}:  17%|█▋        | 5/30 [00:09<00:56,  2.27s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.776, 'hit_ratio@10': 0.7406, 'ndcg@10': 1.7486, 'compress@10': 1.0, 'time@10': 2.9831}:  17%|█▋        | 5/30 [00:12<00:56,  2.27s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.776, 'hit_ratio@10': 0.7406, 'ndcg@10': 1.7486, 'compress@10': 1.0, 'time@10': 2.9831}:  20%|██        | 6/30 [00:12<01:01,  2.58s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.6771, 'hit_ratio@10': 0.7662, 'ndcg@10': 1.6088, 'compress@10': 1.0, 'time@10': 3.0393}:  20%|██        | 6/30 [00:14<01:01,  2.58s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.6771, 'hit_ratio@10': 0.7662, 'ndcg@10': 1.6088, 'compress@10': 1.0, 'time@10': 3.0393}:  23%|██▎       | 7/30 [00:14<00:52,  2.30s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.6514, 'hit_ratio@10': 0.7883, 'ndcg@10': 1.58, 'compress@10': 1.0, 'time@10': 2.9381}:  23%|██▎       | 7/30 [00:16<00:52,  2.30s/it]   {'epoch': 12, 'num_users': 6.125, 'loss': 0.6514, 'hit_ratio@10': 0.7883, 'ndcg@10': 1.58, 'compress@10': 1.0, 'time@10': 2.9381}:  27%|██▋       | 8/30 [00:16<00:50,  2.28s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.6246, 'hit_ratio@10': 0.7801, 'ndcg@10': 1.5809, 'compress@10': 1.0, 'time@10': 3.1419}:  27%|██▋       | 8/30 [00:19<00:50,  2.28s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.6246, 'hit_ratio@10': 0.7801, 'ndcg@10': 1.5809, 'compress@10': 1.0, 'time@10': 3.1419}:  30%|███       | 9/30 [00:19<00:48,  2.33s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.5674, 'hit_ratio@10': 0.7998, 'ndcg@10': 1.516, 'compress@10': 1.0, 'time@10': 3.1144}:  30%|███       | 9/30 [00:22<00:48,  2.33s/it]    {'epoch': 12, 'num_users': 6.3, 'loss': 0.5674, 'hit_ratio@10': 0.7998, 'ndcg@10': 1.516, 'compress@10': 1.0, 'time@10': 3.1144}:  33%|███▎      | 10/30 [00:22<00:50,  2.50s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.5188, 'hit_ratio@10': 0.797, 'ndcg@10': 1.4598, 'compress@10': 1.0, 'time@10': 3.1701}:  33%|███▎      | 10/30 [00:23<00:50,  2.50s/it]{'epoch': 12, 'num_users': 6.6364, 'loss': 0.5188, 'hit_ratio@10': 0.797, 'ndcg@10': 1.4598, 'compress@10': 1.0, 'time@10': 3.1701}:  37%|███▋      | 11/30 [00:23<00:44,  2.32s/it]{'epoch': 12, 'num_users': 6.4167, 'loss': 0.4767, 'hit_ratio@10': 0.7931, 'ndcg@10': 1.4137, 'compress@10': 1.0, 'time@10': 2.974}:  37%|███▋      | 11/30 [00:24<00:44,  2.32s/it]{'epoch': 12, 'num_users': 6.4167, 'loss': 0.4767, 'hit_ratio@10': 0.7931, 'ndcg@10': 1.4137, 'compress@10': 1.0, 'time@10': 2.974}:  40%|████      | 12/30 [00:24<00:33,  1.87s/it]{'epoch': 12, 'num_users': 6.6154, 'loss': 0.4465, 'hit_ratio@10': 0.802, 'ndcg@10': 1.3893, 'compress@10': 1.0, 'time@10': 2.9941}:  40%|████      | 12/30 [00:26<00:33,  1.87s/it]{'epoch': 12, 'num_users': 6.6154, 'loss': 0.4465, 'hit_ratio@10': 0.802, 'ndcg@10': 1.3893, 'compress@10': 1.0, 'time@10': 2.9941}:  43%|████▎     | 13/30 [00:26<00:30,  1.80s/it]{'epoch': 12, 'num_users': 6.3571, 'loss': 0.4154, 'hit_ratio@10': 0.8043, 'ndcg@10': 1.3488, 'compress@10': 1.0, 'time@10': 2.8061}:  43%|████▎     | 13/30 [00:26<00:30,  1.80s/it]{'epoch': 12, 'num_users': 6.3571, 'loss': 0.4154, 'hit_ratio@10': 0.8043, 'ndcg@10': 1.3488, 'compress@10': 1.0, 'time@10': 2.8061}:  47%|████▋     | 14/30 [00:26<00:22,  1.38s/it]{'epoch': 12, 'num_users': 6.2667, 'loss': 0.3926, 'hit_ratio@10': 0.8152, 'ndcg@10': 1.3191, 'compress@10': 1.0, 'time@10': 2.9089}:  47%|████▋     | 14/30 [00:29<00:22,  1.38s/it]{'epoch': 12, 'num_users': 6.2667, 'loss': 0.3926, 'hit_ratio@10': 0.8152, 'ndcg@10': 1.3191, 'compress@10': 1.0, 'time@10': 2.9089}:  50%|█████     | 15/30 [00:29<00:24,  1.63s/it]{'epoch': 12, 'num_users': 6.0625, 'loss': 0.3784, 'hit_ratio@10': 0.8163, 'ndcg@10': 1.3105, 'compress@10': 1.0, 'time@10': 2.7738}:  50%|█████     | 15/30 [00:29<00:24,  1.63s/it]{'epoch': 12, 'num_users': 6.0625, 'loss': 0.3784, 'hit_ratio@10': 0.8163, 'ndcg@10': 1.3105, 'compress@10': 1.0, 'time@10': 2.7738}:  53%|█████▎    | 16/30 [00:29<00:19,  1.37s/it]{'epoch': 12, 'num_users': 5.8235, 'loss': 0.3574, 'hit_ratio@10': 0.8036, 'ndcg@10': 1.2777, 'compress@10': 1.0, 'time@10': 2.6428}:  53%|█████▎    | 16/30 [00:30<00:19,  1.37s/it]{'epoch': 12, 'num_users': 5.8235, 'loss': 0.3574, 'hit_ratio@10': 0.8036, 'ndcg@10': 1.2777, 'compress@10': 1.0, 'time@10': 2.6428}:  57%|█████▋    | 17/30 [00:30<00:13,  1.05s/it]{'epoch': 12, 'num_users': 6.0556, 'loss': 0.3558, 'hit_ratio@10': 0.7946, 'ndcg@10': 1.2658, 'compress@10': 1.0, 'time@10': 2.6067}:  57%|█████▋    | 17/30 [00:32<00:13,  1.05s/it]{'epoch': 12, 'num_users': 6.0556, 'loss': 0.3558, 'hit_ratio@10': 0.7946, 'ndcg@10': 1.2658, 'compress@10': 1.0, 'time@10': 2.6067}:  60%|██████    | 18/30 [00:32<00:16,  1.34s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.3925, 'hit_ratio@10': 0.7716, 'ndcg@10': 1.2571, 'compress@10': 1.0, 'time@10': 2.5675}:  60%|██████    | 18/30 [00:33<00:16,  1.34s/it]   {'epoch': 12, 'num_users': 6.0, 'loss': 0.3925, 'hit_ratio@10': 0.7716, 'ndcg@10': 1.2571, 'compress@10': 1.0, 'time@10': 2.5675}:  63%|██████▎   | 19/30 [00:33<00:13,  1.23s/it]{'epoch': 12, 'num_users': 6.15, 'loss': 0.388, 'hit_ratio@10': 0.7822, 'ndcg@10': 1.2549, 'compress@10': 1.0, 'time@10': 2.6459}:  63%|██████▎   | 19/30 [00:37<00:13,  1.23s/it]{'epoch': 12, 'num_users': 6.15, 'loss': 0.388, 'hit_ratio@10': 0.7822, 'ndcg@10': 1.2549, 'compress@10': 1.0, 'time@10': 2.6459}:  67%|██████▋   | 20/30 [00:37<00:21,  2.11s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.3717, 'hit_ratio@10': 0.783, 'ndcg@10': 1.2386, 'compress@10': 1.0, 'time@10': 2.7934}:  67%|██████▋   | 20/30 [00:40<00:21,  2.11s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.3717, 'hit_ratio@10': 0.783, 'ndcg@10': 1.2386, 'compress@10': 1.0, 'time@10': 2.7934}:  70%|███████   | 21/30 [00:40<00:21,  2.35s/it]{'epoch': 12, 'num_users': 6.1818, 'loss': 0.6226, 'hit_ratio@10': 0.7763, 'ndcg@10': 3.5743, 'compress@10': 1.0, 'time@10': 2.733}:  70%|███████   | 21/30 [00:41<00:21,  2.35s/it]{'epoch': 12, 'num_users': 6.1818, 'loss': 0.6226, 'hit_ratio@10': 0.7763, 'ndcg@10': 3.5743, 'compress@10': 1.0, 'time@10': 2.733}:  73%|███████▎  | 22/30 [00:41<00:16,  2.09s/it]{'epoch': 12, 'num_users': 6.1304, 'loss': 0.6376, 'hit_ratio@10': 0.7795, 'ndcg@10': 3.538, 'compress@10': 1.0, 'time@10': 2.732}:  73%|███████▎  | 22/30 [00:43<00:16,  2.09s/it] {'epoch': 12, 'num_users': 6.1304, 'loss': 0.6376, 'hit_ratio@10': 0.7795, 'ndcg@10': 3.538, 'compress@10': 1.0, 'time@10': 2.732}:  77%|███████▋  | 23/30 [00:43<00:13,  1.88s/it]{'epoch': 12, 'num_users': 5.9583, 'loss': 0.6126, 'hit_ratio@10': 0.7804, 'ndcg@10': 3.4219, 'compress@10': 1.0, 'time@10': 2.6294}:  77%|███████▋  | 23/30 [00:43<00:13,  1.88s/it]{'epoch': 12, 'num_users': 5.9583, 'loss': 0.6126, 'hit_ratio@10': 0.7804, 'ndcg@10': 3.4219, 'compress@10': 1.0, 'time@10': 2.6294}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.5896, 'hit_ratio@10': 0.7759, 'ndcg@10': 3.307, 'compress@10': 1.0, 'time@10': 2.5362}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]    {'epoch': 12, 'num_users': 5.8, 'loss': 0.5896, 'hit_ratio@10': 0.7759, 'ndcg@10': 3.307, 'compress@10': 1.0, 'time@10': 2.5362}:  83%|████████▎ | 25/30 [00:43<00:05,  1.04s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.5734, 'hit_ratio@10': 0.7807, 'ndcg@10': 3.2151, 'compress@10': 1.0, 'time@10': 2.6682}:  83%|████████▎ | 25/30 [00:49<00:05,  1.04s/it]{'epoch': 12, 'num_users': 5.8077, 'loss': 0.5734, 'hit_ratio@10': 0.7807, 'ndcg@10': 3.2151, 'compress@10': 1.0, 'time@10': 2.6682}:  87%|████████▋ | 26/30 [00:49<00:10,  2.53s/it]{'epoch': 12, 'num_users': 5.8889, 'loss': 0.5786, 'hit_ratio@10': 0.7716, 'ndcg@10': 3.1417, 'compress@10': 1.0, 'time@10': 2.7203}:  87%|████████▋ | 26/30 [00:51<00:10,  2.53s/it]{'epoch': 12, 'num_users': 5.8889, 'loss': 0.5786, 'hit_ratio@10': 0.7716, 'ndcg@10': 3.1417, 'compress@10': 1.0, 'time@10': 2.7203}:  90%|█████████ | 27/30 [00:51<00:07,  2.39s/it]{'epoch': 12, 'num_users': 6.0, 'loss': 0.5606, 'hit_ratio@10': 0.7791, 'ndcg@10': 3.0675, 'compress@10': 1.0, 'time@10': 2.7522}:  90%|█████████ | 27/30 [00:55<00:07,  2.39s/it]   {'epoch': 12, 'num_users': 6.0, 'loss': 0.5606, 'hit_ratio@10': 0.7791, 'ndcg@10': 3.0675, 'compress@10': 1.0, 'time@10': 2.7522}:  93%|█████████▎| 28/30 [00:55<00:05,  2.77s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.545, 'hit_ratio@10': 0.7852, 'ndcg@10': 2.9978, 'compress@10': 1.0, 'time@10': 2.7596}:  93%|█████████▎| 28/30 [00:56<00:05,  2.77s/it]{'epoch': 12, 'num_users': 5.8621, 'loss': 0.545, 'hit_ratio@10': 0.7852, 'ndcg@10': 2.9978, 'compress@10': 1.0, 'time@10': 2.7596}:  97%|█████████▋| 29/30 [00:56<00:02,  2.39s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.544, 'hit_ratio@10': 0.7869, 'ndcg@10': 2.9544, 'compress@10': 1.0, 'time@10': 2.7568}:  97%|█████████▋| 29/30 [00:59<00:02,  2.39s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.544, 'hit_ratio@10': 0.7869, 'ndcg@10': 2.9544, 'compress@10': 1.0, 'time@10': 2.7568}: 100%|██████████| 30/30 [00:59<00:00,  2.49s/it]{'epoch': 12, 'num_users': 5.8667, 'loss': 0.544, 'hit_ratio@10': 0.7869, 'ndcg@10': 2.9544, 'compress@10': 1.0, 'time@10': 2.7568}: 100%|██████████| 30/30 [00:59<00:00,  1.98s/it]
Epoch: 12
Avg # of users: 5.866666666666666
Avg Loss: 0.544030045266443
Avg hit ratio: 0.7869073315332764
Avg ndcg: 2.9543561640371765
Avg compression ratio: 1.0
Avg train time: 2.756819399197896
Std train time: 1.7391130499745382
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.1313, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9841, 'compress@10': 1.0, 'time@10': 2.5767}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.1313, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9841, 'compress@10': 1.0, 'time@10': 2.5767}:   3%|▎         | 1/30 [00:01<00:38,  1.32s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 2.7349, 'hit_ratio@10': 0.6995, 'ndcg@10': 13.805, 'compress@10': 1.0, 'time@10': 2.3679}:   3%|▎         | 1/30 [00:03<00:38,  1.32s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 2.7349, 'hit_ratio@10': 0.6995, 'ndcg@10': 13.805, 'compress@10': 1.0, 'time@10': 2.3679}:   7%|▋         | 2/30 [00:03<00:51,  1.83s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 1.8429, 'hit_ratio@10': 0.6568, 'ndcg@10': 9.424, 'compress@10': 1.0, 'time@10': 1.8471}:   7%|▋         | 2/30 [00:03<00:51,  1.83s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 1.8429, 'hit_ratio@10': 0.6568, 'ndcg@10': 9.424, 'compress@10': 1.0, 'time@10': 1.8471}:  10%|█         | 3/30 [00:03<00:32,  1.19s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 2.0226, 'hit_ratio@10': 0.6355, 'ndcg@10': 8.7977, 'compress@10': 1.0, 'time@10': 1.8543}:  10%|█         | 3/30 [00:05<00:32,  1.19s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 2.0226, 'hit_ratio@10': 0.6355, 'ndcg@10': 8.7977, 'compress@10': 1.0, 'time@10': 1.8543}:  13%|█▎        | 4/30 [00:05<00:38,  1.47s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 1.6559, 'hit_ratio@10': 0.6964, 'ndcg@10': 7.2427, 'compress@10': 1.0, 'time@10': 2.9161}:  13%|█▎        | 4/30 [00:09<00:38,  1.47s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 1.6559, 'hit_ratio@10': 0.6964, 'ndcg@10': 7.2427, 'compress@10': 1.0, 'time@10': 2.9161}:  17%|█▋        | 5/30 [00:09<00:56,  2.24s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 1.3938, 'hit_ratio@10': 0.7322, 'ndcg@10': 6.205, 'compress@10': 1.0, 'time@10': 2.966}:  17%|█▋        | 5/30 [00:12<00:56,  2.24s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 1.3938, 'hit_ratio@10': 0.7322, 'ndcg@10': 6.205, 'compress@10': 1.0, 'time@10': 2.966}:  20%|██        | 6/30 [00:12<01:02,  2.58s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 1.3212, 'hit_ratio@10': 0.719, 'ndcg@10': 5.5696, 'compress@10': 1.0, 'time@10': 3.0394}:  20%|██        | 6/30 [00:14<01:02,  2.58s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 1.3212, 'hit_ratio@10': 0.719, 'ndcg@10': 5.5696, 'compress@10': 1.0, 'time@10': 3.0394}:  23%|██▎       | 7/30 [00:14<00:53,  2.32s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 1.1642, 'hit_ratio@10': 0.7505, 'ndcg@10': 4.9887, 'compress@10': 1.0, 'time@10': 2.9867}:  23%|██▎       | 7/30 [00:17<00:53,  2.32s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 1.1642, 'hit_ratio@10': 0.7505, 'ndcg@10': 4.9887, 'compress@10': 1.0, 'time@10': 2.9867}:  27%|██▋       | 8/30 [00:17<00:53,  2.42s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 1.0871, 'hit_ratio@10': 0.7624, 'ndcg@10': 4.596, 'compress@10': 1.0, 'time@10': 3.2209}:  27%|██▋       | 8/30 [00:19<00:53,  2.42s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 1.0871, 'hit_ratio@10': 0.7624, 'ndcg@10': 4.596, 'compress@10': 1.0, 'time@10': 3.2209}:  30%|███       | 9/30 [00:19<00:51,  2.47s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.996, 'hit_ratio@10': 0.7816, 'ndcg@10': 4.2471, 'compress@10': 1.0, 'time@10': 3.1921}:  30%|███       | 9/30 [00:22<00:51,  2.47s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.996, 'hit_ratio@10': 0.7816, 'ndcg@10': 4.2471, 'compress@10': 1.0, 'time@10': 3.1921}:  33%|███▎      | 10/30 [00:22<00:52,  2.62s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.9429, 'hit_ratio@10': 0.777, 'ndcg@10': 3.9385, 'compress@10': 1.0, 'time@10': 3.2299}:  33%|███▎      | 10/30 [00:24<00:52,  2.62s/it]{'epoch': 13, 'num_users': 6.6364, 'loss': 0.9429, 'hit_ratio@10': 0.777, 'ndcg@10': 3.9385, 'compress@10': 1.0, 'time@10': 3.2299}:  37%|███▋      | 11/30 [00:24<00:45,  2.38s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 1.1818, 'hit_ratio@10': 0.7608, 'ndcg@10': 5.0417, 'compress@10': 1.0, 'time@10': 3.0252}:  37%|███▋      | 11/30 [00:25<00:45,  2.38s/it]{'epoch': 13, 'num_users': 6.4167, 'loss': 1.1818, 'hit_ratio@10': 0.7608, 'ndcg@10': 5.0417, 'compress@10': 1.0, 'time@10': 3.0252}:  40%|████      | 12/30 [00:25<00:34,  1.90s/it]{'epoch': 13, 'num_users': 6.6154, 'loss': 1.0945, 'hit_ratio@10': 0.7653, 'ndcg@10': 4.7239, 'compress@10': 1.0, 'time@10': 3.0184}:  40%|████      | 12/30 [00:26<00:34,  1.90s/it]{'epoch': 13, 'num_users': 6.6154, 'loss': 1.0945, 'hit_ratio@10': 0.7653, 'ndcg@10': 4.7239, 'compress@10': 1.0, 'time@10': 3.0184}:  43%|████▎     | 13/30 [00:26<00:30,  1.78s/it]{'epoch': 13, 'num_users': 6.3571, 'loss': 1.0231, 'hit_ratio@10': 0.7463, 'ndcg@10': 4.4688, 'compress@10': 1.0, 'time@10': 2.8258}:  43%|████▎     | 13/30 [00:27<00:30,  1.78s/it]{'epoch': 13, 'num_users': 6.3571, 'loss': 1.0231, 'hit_ratio@10': 0.7463, 'ndcg@10': 4.4688, 'compress@10': 1.0, 'time@10': 2.8258}:  47%|████▋     | 14/30 [00:27<00:21,  1.35s/it]{'epoch': 13, 'num_users': 6.2667, 'loss': 1.1877, 'hit_ratio@10': 0.7331, 'ndcg@10': 4.6117, 'compress@10': 1.0, 'time@10': 2.9152}:  47%|████▋     | 14/30 [00:29<00:21,  1.35s/it]{'epoch': 13, 'num_users': 6.2667, 'loss': 1.1877, 'hit_ratio@10': 0.7331, 'ndcg@10': 4.6117, 'compress@10': 1.0, 'time@10': 2.9152}:  50%|█████     | 15/30 [00:29<00:23,  1.58s/it]{'epoch': 13, 'num_users': 6.0625, 'loss': 1.1932, 'hit_ratio@10': 0.7081, 'ndcg@10': 4.4596, 'compress@10': 1.0, 'time@10': 2.7813}:  50%|█████     | 15/30 [00:30<00:23,  1.58s/it]{'epoch': 13, 'num_users': 6.0625, 'loss': 1.1932, 'hit_ratio@10': 0.7081, 'ndcg@10': 4.4596, 'compress@10': 1.0, 'time@10': 2.7813}:  53%|█████▎    | 16/30 [00:30<00:18,  1.35s/it]{'epoch': 13, 'num_users': 5.8235, 'loss': 1.1239, 'hit_ratio@10': 0.7018, 'ndcg@10': 4.2465, 'compress@10': 1.0, 'time@10': 2.6539}:  53%|█████▎    | 16/30 [00:30<00:18,  1.35s/it]{'epoch': 13, 'num_users': 5.8235, 'loss': 1.1239, 'hit_ratio@10': 0.7018, 'ndcg@10': 4.2465, 'compress@10': 1.0, 'time@10': 2.6539}:  57%|█████▋    | 17/30 [00:30<00:13,  1.04s/it]{'epoch': 13, 'num_users': 6.0556, 'loss': 1.0751, 'hit_ratio@10': 0.7044, 'ndcg@10': 4.0761, 'compress@10': 1.0, 'time@10': 2.6256}:  57%|█████▋    | 17/30 [00:32<00:13,  1.04s/it]{'epoch': 13, 'num_users': 6.0556, 'loss': 1.0751, 'hit_ratio@10': 0.7044, 'ndcg@10': 4.0761, 'compress@10': 1.0, 'time@10': 2.6256}:  60%|██████    | 18/30 [00:32<00:16,  1.38s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 1.1404, 'hit_ratio@10': 0.705, 'ndcg@10': 3.9441, 'compress@10': 1.0, 'time@10': 2.5833}:  60%|██████    | 18/30 [00:33<00:16,  1.38s/it]    {'epoch': 13, 'num_users': 6.0, 'loss': 1.1404, 'hit_ratio@10': 0.705, 'ndcg@10': 3.9441, 'compress@10': 1.0, 'time@10': 2.5833}:  63%|██████▎   | 19/30 [00:33<00:14,  1.29s/it]{'epoch': 13, 'num_users': 6.15, 'loss': 1.1232, 'hit_ratio@10': 0.7162, 'ndcg@10': 3.8382, 'compress@10': 1.0, 'time@10': 2.6578}:  63%|██████▎   | 19/30 [00:37<00:14,  1.29s/it]{'epoch': 13, 'num_users': 6.15, 'loss': 1.1232, 'hit_ratio@10': 0.7162, 'ndcg@10': 3.8382, 'compress@10': 1.0, 'time@10': 2.6578}:  67%|██████▋   | 20/30 [00:37<00:21,  2.14s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 1.0869, 'hit_ratio@10': 0.7154, 'ndcg@10': 3.7455, 'compress@10': 1.0, 'time@10': 2.8045}:  67%|██████▋   | 20/30 [00:40<00:21,  2.14s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 1.0869, 'hit_ratio@10': 0.7154, 'ndcg@10': 3.7455, 'compress@10': 1.0, 'time@10': 2.8045}:  70%|███████   | 21/30 [00:40<00:21,  2.36s/it]{'epoch': 13, 'num_users': 6.1818, 'loss': 1.1442, 'hit_ratio@10': 0.7222, 'ndcg@10': 4.0736, 'compress@10': 1.0, 'time@10': 2.7418}:  70%|███████   | 21/30 [00:42<00:21,  2.36s/it]{'epoch': 13, 'num_users': 6.1818, 'loss': 1.1442, 'hit_ratio@10': 0.7222, 'ndcg@10': 4.0736, 'compress@10': 1.0, 'time@10': 2.7418}:  73%|███████▎  | 22/30 [00:42<00:16,  2.09s/it]{'epoch': 13, 'num_users': 6.1304, 'loss': 1.103, 'hit_ratio@10': 0.7277, 'ndcg@10': 3.9446, 'compress@10': 1.0, 'time@10': 2.7435}:  73%|███████▎  | 22/30 [00:43<00:16,  2.09s/it] {'epoch': 13, 'num_users': 6.1304, 'loss': 1.103, 'hit_ratio@10': 0.7277, 'ndcg@10': 3.9446, 'compress@10': 1.0, 'time@10': 2.7435}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it]{'epoch': 13, 'num_users': 5.9583, 'loss': 1.0582, 'hit_ratio@10': 0.7307, 'ndcg@10': 3.8092, 'compress@10': 1.0, 'time@10': 2.6424}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it]{'epoch': 13, 'num_users': 5.9583, 'loss': 1.0582, 'hit_ratio@10': 0.7307, 'ndcg@10': 3.8092, 'compress@10': 1.0, 'time@10': 2.6424}:  80%|████████  | 24/30 [00:43<00:08,  1.43s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 1.018, 'hit_ratio@10': 0.7148, 'ndcg@10': 3.682, 'compress@10': 1.0, 'time@10': 2.5474}:  80%|████████  | 24/30 [00:44<00:08,  1.43s/it]     {'epoch': 13, 'num_users': 5.8, 'loss': 1.018, 'hit_ratio@10': 0.7148, 'ndcg@10': 3.682, 'compress@10': 1.0, 'time@10': 2.5474}:  83%|████████▎ | 25/30 [00:44<00:05,  1.05s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.9938, 'hit_ratio@10': 0.7221, 'ndcg@10': 3.5804, 'compress@10': 1.0, 'time@10': 2.6697}:  83%|████████▎ | 25/30 [00:49<00:05,  1.05s/it]{'epoch': 13, 'num_users': 5.8077, 'loss': 0.9938, 'hit_ratio@10': 0.7221, 'ndcg@10': 3.5804, 'compress@10': 1.0, 'time@10': 2.6697}:  87%|████████▋ | 26/30 [00:49<00:09,  2.46s/it]{'epoch': 13, 'num_users': 5.8889, 'loss': 0.9719, 'hit_ratio@10': 0.7271, 'ndcg@10': 3.502, 'compress@10': 1.0, 'time@10': 2.7174}:  87%|████████▋ | 26/30 [00:51<00:09,  2.46s/it] {'epoch': 13, 'num_users': 5.8889, 'loss': 0.9719, 'hit_ratio@10': 0.7271, 'ndcg@10': 3.502, 'compress@10': 1.0, 'time@10': 2.7174}:  90%|█████████ | 27/30 [00:51<00:06,  2.33s/it]{'epoch': 13, 'num_users': 6.0, 'loss': 0.9485, 'hit_ratio@10': 0.7333, 'ndcg@10': 3.4159, 'compress@10': 1.0, 'time@10': 2.7532}:  90%|█████████ | 27/30 [00:55<00:06,  2.33s/it]  {'epoch': 13, 'num_users': 6.0, 'loss': 0.9485, 'hit_ratio@10': 0.7333, 'ndcg@10': 3.4159, 'compress@10': 1.0, 'time@10': 2.7532}:  93%|█████████▎| 28/30 [00:55<00:05,  2.75s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.9205, 'hit_ratio@10': 0.7315, 'ndcg@10': 3.3197, 'compress@10': 1.0, 'time@10': 2.7525}:  93%|█████████▎| 28/30 [00:56<00:05,  2.75s/it]{'epoch': 13, 'num_users': 5.8621, 'loss': 0.9205, 'hit_ratio@10': 0.7315, 'ndcg@10': 3.3197, 'compress@10': 1.0, 'time@10': 2.7525}:  97%|█████████▋| 29/30 [00:56<00:02,  2.35s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.8993, 'hit_ratio@10': 0.727, 'ndcg@10': 3.2383, 'compress@10': 1.0, 'time@10': 2.7429}:  97%|█████████▋| 29/30 [00:59<00:02,  2.35s/it] {'epoch': 13, 'num_users': 5.8667, 'loss': 0.8993, 'hit_ratio@10': 0.727, 'ndcg@10': 3.2383, 'compress@10': 1.0, 'time@10': 2.7429}: 100%|██████████| 30/30 [00:59<00:00,  2.39s/it]{'epoch': 13, 'num_users': 5.8667, 'loss': 0.8993, 'hit_ratio@10': 0.727, 'ndcg@10': 3.2383, 'compress@10': 1.0, 'time@10': 2.7429}: 100%|██████████| 30/30 [00:59<00:00,  1.98s/it]
Epoch: 13
Avg # of users: 5.866666666666666
Avg Loss: 0.8993210873147415
Avg hit ratio: 0.7269702229558003
Avg ndcg: 3.2383002140509545
Avg compression ratio: 1.0
Avg train time: 2.742910861968994
Std train time: 1.7207364331129376
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 2.3215, 'hit_ratio@10': 0.2632, 'ndcg@10': 1.285, 'compress@10': 1.0, 'time@10': 2.7809}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 2.3215, 'hit_ratio@10': 0.2632, 'ndcg@10': 1.285, 'compress@10': 1.0, 'time@10': 2.7809}:   3%|▎         | 1/30 [00:01<00:41,  1.42s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 1.5277, 'hit_ratio@10': 0.4542, 'ndcg@10': 1.324, 'compress@10': 1.0, 'time@10': 2.4762}:   3%|▎         | 1/30 [00:03<00:41,  1.42s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 1.5277, 'hit_ratio@10': 0.4542, 'ndcg@10': 1.324, 'compress@10': 1.0, 'time@10': 2.4762}:   7%|▋         | 2/30 [00:03<00:52,  1.88s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 1.1096, 'hit_ratio@10': 0.5409, 'ndcg@10': 1.2765, 'compress@10': 1.0, 'time@10': 1.9149}:   7%|▋         | 2/30 [00:04<00:52,  1.88s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 1.1096, 'hit_ratio@10': 0.5409, 'ndcg@10': 1.2765, 'compress@10': 1.0, 'time@10': 1.9149}:  10%|█         | 3/30 [00:04<00:32,  1.21s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.8749, 'hit_ratio@10': 0.6021, 'ndcg@10': 1.1751, 'compress@10': 1.0, 'time@10': 1.9016}:  10%|█         | 3/30 [00:05<00:32,  1.21s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.8749, 'hit_ratio@10': 0.6021, 'ndcg@10': 1.1751, 'compress@10': 1.0, 'time@10': 1.9016}:  13%|█▎        | 4/30 [00:05<00:38,  1.48s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.777, 'hit_ratio@10': 0.6617, 'ndcg@10': 1.1927, 'compress@10': 1.0, 'time@10': 2.9481}:  13%|█▎        | 4/30 [00:09<00:38,  1.48s/it] {'epoch': 14, 'num_users': 5.8, 'loss': 0.777, 'hit_ratio@10': 0.6617, 'ndcg@10': 1.1927, 'compress@10': 1.0, 'time@10': 2.9481}:  17%|█▋        | 5/30 [00:09<00:56,  2.24s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.9997, 'hit_ratio@10': 0.6662, 'ndcg@10': 1.6669, 'compress@10': 1.0, 'time@10': 2.9888}:  17%|█▋        | 5/30 [00:12<00:56,  2.24s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.9997, 'hit_ratio@10': 0.6662, 'ndcg@10': 1.6669, 'compress@10': 1.0, 'time@10': 2.9888}:  20%|██        | 6/30 [00:12<01:01,  2.58s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 2.363, 'hit_ratio@10': 0.6339, 'ndcg@10': 33.195, 'compress@10': 1.0, 'time@10': 3.0461}:  20%|██        | 6/30 [00:14<01:01,  2.58s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 2.363, 'hit_ratio@10': 0.6339, 'ndcg@10': 33.195, 'compress@10': 1.0, 'time@10': 3.0461}:  23%|██▎       | 7/30 [00:14<00:52,  2.30s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 2.2861, 'hit_ratio@10': 0.6689, 'ndcg@10': 29.4332, 'compress@10': 1.0, 'time@10': 2.9625}:  23%|██▎       | 7/30 [00:16<00:52,  2.30s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 2.2861, 'hit_ratio@10': 0.6689, 'ndcg@10': 29.4332, 'compress@10': 1.0, 'time@10': 2.9625}:  27%|██▋       | 8/30 [00:16<00:51,  2.34s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 2.2315, 'hit_ratio@10': 0.6359, 'ndcg@10': 26.4773, 'compress@10': 1.0, 'time@10': 3.1781}:  27%|██▋       | 8/30 [00:19<00:51,  2.34s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 2.2315, 'hit_ratio@10': 0.6359, 'ndcg@10': 26.4773, 'compress@10': 1.0, 'time@10': 3.1781}:  30%|███       | 9/30 [00:19<00:50,  2.38s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 2.1689, 'hit_ratio@10': 0.6177, 'ndcg@10': 24.0812, 'compress@10': 1.0, 'time@10': 3.1628}:  30%|███       | 9/30 [00:22<00:50,  2.38s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 2.1689, 'hit_ratio@10': 0.6177, 'ndcg@10': 24.0812, 'compress@10': 1.0, 'time@10': 3.1628}:  33%|███▎      | 10/30 [00:22<00:51,  2.59s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 2.2365, 'hit_ratio@10': 0.6175, 'ndcg@10': 23.0517, 'compress@10': 1.0, 'time@10': 3.2186}:  33%|███▎      | 10/30 [00:24<00:51,  2.59s/it]{'epoch': 14, 'num_users': 6.6364, 'loss': 2.2365, 'hit_ratio@10': 0.6175, 'ndcg@10': 23.0517, 'compress@10': 1.0, 'time@10': 3.2186}:  37%|███▋      | 11/30 [00:24<00:45,  2.38s/it]{'epoch': 14, 'num_users': 6.4167, 'loss': 3.4442, 'hit_ratio@10': 0.573, 'ndcg@10': 21.8745, 'compress@10': 1.0, 'time@10': 3.0136}:  37%|███▋      | 11/30 [00:25<00:45,  2.38s/it] {'epoch': 14, 'num_users': 6.4167, 'loss': 3.4442, 'hit_ratio@10': 0.573, 'ndcg@10': 21.8745, 'compress@10': 1.0, 'time@10': 3.0136}:  40%|████      | 12/30 [00:25<00:34,  1.90s/it]{'epoch': 14, 'num_users': 6.6154, 'loss': 3.238, 'hit_ratio@10': 0.5534, 'ndcg@10': 20.2725, 'compress@10': 1.0, 'time@10': 3.0207}:  40%|████      | 12/30 [00:26<00:34,  1.90s/it]{'epoch': 14, 'num_users': 6.6154, 'loss': 3.238, 'hit_ratio@10': 0.5534, 'ndcg@10': 20.2725, 'compress@10': 1.0, 'time@10': 3.0207}:  43%|████▎     | 13/30 [00:26<00:30,  1.80s/it]{'epoch': 14, 'num_users': 6.3571, 'loss': 3.0254, 'hit_ratio@10': 0.5615, 'ndcg@10': 18.9252, 'compress@10': 1.0, 'time@10': 2.8305}:  43%|████▎     | 13/30 [00:27<00:30,  1.80s/it]{'epoch': 14, 'num_users': 6.3571, 'loss': 3.0254, 'hit_ratio@10': 0.5615, 'ndcg@10': 18.9252, 'compress@10': 1.0, 'time@10': 2.8305}:  47%|████▋     | 14/30 [00:27<00:21,  1.37s/it]{'epoch': 14, 'num_users': 6.2667, 'loss': 2.9679, 'hit_ratio@10': 0.5843, 'ndcg@10': 17.9095, 'compress@10': 1.0, 'time@10': 2.9121}:  47%|████▋     | 14/30 [00:29<00:21,  1.37s/it]{'epoch': 14, 'num_users': 6.2667, 'loss': 2.9679, 'hit_ratio@10': 0.5843, 'ndcg@10': 17.9095, 'compress@10': 1.0, 'time@10': 2.9121}:  50%|█████     | 15/30 [00:29<00:23,  1.58s/it]{'epoch': 14, 'num_users': 6.0625, 'loss': 4.2779, 'hit_ratio@10': 0.579, 'ndcg@10': 419.9673, 'compress@10': 1.0, 'time@10': 2.7738}:  50%|█████     | 15/30 [00:29<00:23,  1.58s/it]{'epoch': 14, 'num_users': 6.0625, 'loss': 4.2779, 'hit_ratio@10': 0.579, 'ndcg@10': 419.9673, 'compress@10': 1.0, 'time@10': 2.7738}:  53%|█████▎    | 16/30 [00:29<00:18,  1.32s/it]{'epoch': 14, 'num_users': 5.8235, 'loss': 4.0302, 'hit_ratio@10': 0.5803, 'ndcg@10': 395.3055, 'compress@10': 1.0, 'time@10': 2.642}:  53%|█████▎    | 16/30 [00:30<00:18,  1.32s/it]{'epoch': 14, 'num_users': 5.8235, 'loss': 4.0302, 'hit_ratio@10': 0.5803, 'ndcg@10': 395.3055, 'compress@10': 1.0, 'time@10': 2.642}:  57%|█████▋    | 17/30 [00:30<00:13,  1.02s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 3.8477, 'hit_ratio@10': 0.5837, 'ndcg@10': 373.4359, 'compress@10': 1.0, 'time@10': 2.6029}:  57%|█████▋    | 17/30 [00:32<00:13,  1.02s/it]{'epoch': 14, 'num_users': 6.0556, 'loss': 3.8477, 'hit_ratio@10': 0.5837, 'ndcg@10': 373.4359, 'compress@10': 1.0, 'time@10': 2.6029}:  60%|██████    | 18/30 [00:32<00:15,  1.30s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 3.911, 'hit_ratio@10': 0.5831, 'ndcg@10': 354.3355, 'compress@10': 1.0, 'time@10': 2.5645}:  60%|██████    | 18/30 [00:33<00:15,  1.30s/it]    {'epoch': 14, 'num_users': 6.0, 'loss': 3.911, 'hit_ratio@10': 0.5831, 'ndcg@10': 354.3355, 'compress@10': 1.0, 'time@10': 2.5645}:  63%|██████▎   | 19/30 [00:33<00:13,  1.20s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 3.7621, 'hit_ratio@10': 0.6004, 'ndcg@10': 336.7039, 'compress@10': 1.0, 'time@10': 2.6317}:  63%|██████▎   | 19/30 [00:37<00:13,  1.20s/it]{'epoch': 14, 'num_users': 6.15, 'loss': 3.7621, 'hit_ratio@10': 0.6004, 'ndcg@10': 336.7039, 'compress@10': 1.0, 'time@10': 2.6317}:  67%|██████▋   | 20/30 [00:37<00:20,  2.04s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 3.6304, 'hit_ratio@10': 0.6064, 'ndcg@10': 320.7641, 'compress@10': 1.0, 'time@10': 2.7951}:  67%|██████▋   | 20/30 [00:40<00:20,  2.04s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 3.6304, 'hit_ratio@10': 0.6064, 'ndcg@10': 320.7641, 'compress@10': 1.0, 'time@10': 2.7951}:  70%|███████   | 21/30 [00:40<00:21,  2.35s/it]{'epoch': 14, 'num_users': 6.1818, 'loss': 3.4702, 'hit_ratio@10': 0.618, 'ndcg@10': 306.2185, 'compress@10': 1.0, 'time@10': 2.7335}:  70%|███████   | 21/30 [00:41<00:21,  2.35s/it] {'epoch': 14, 'num_users': 6.1818, 'loss': 3.4702, 'hit_ratio@10': 0.618, 'ndcg@10': 306.2185, 'compress@10': 1.0, 'time@10': 2.7335}:  73%|███████▎  | 22/30 [00:41<00:16,  2.08s/it]{'epoch': 14, 'num_users': 6.1304, 'loss': 3.3271, 'hit_ratio@10': 0.6194, 'ndcg@10': 292.9377, 'compress@10': 1.0, 'time@10': 2.7304}:  73%|███████▎  | 22/30 [00:43<00:16,  2.08s/it]{'epoch': 14, 'num_users': 6.1304, 'loss': 3.3271, 'hit_ratio@10': 0.6194, 'ndcg@10': 292.9377, 'compress@10': 1.0, 'time@10': 2.7304}:  77%|███████▋  | 23/30 [00:43<00:13,  1.87s/it]{'epoch': 14, 'num_users': 5.9583, 'loss': 3.1918, 'hit_ratio@10': 0.627, 'ndcg@10': 280.7765, 'compress@10': 1.0, 'time@10': 2.6274}:  77%|███████▋  | 23/30 [00:43<00:13,  1.87s/it] {'epoch': 14, 'num_users': 5.9583, 'loss': 3.1918, 'hit_ratio@10': 0.627, 'ndcg@10': 280.7765, 'compress@10': 1.0, 'time@10': 2.6274}:  80%|████████  | 24/30 [00:43<00:08,  1.39s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 3.0677, 'hit_ratio@10': 0.6285, 'ndcg@10': 269.5695, 'compress@10': 1.0, 'time@10': 2.5327}:  80%|████████  | 24/30 [00:43<00:08,  1.39s/it]  {'epoch': 14, 'num_users': 5.8, 'loss': 3.0677, 'hit_ratio@10': 0.6285, 'ndcg@10': 269.5695, 'compress@10': 1.0, 'time@10': 2.5327}:  83%|████████▎ | 25/30 [00:43<00:05,  1.02s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 2.9557, 'hit_ratio@10': 0.64, 'ndcg@10': 259.236, 'compress@10': 1.0, 'time@10': 2.6531}:  83%|████████▎ | 25/30 [00:49<00:05,  1.02s/it]{'epoch': 14, 'num_users': 5.8077, 'loss': 2.9557, 'hit_ratio@10': 0.64, 'ndcg@10': 259.236, 'compress@10': 1.0, 'time@10': 2.6531}:  87%|████████▋ | 26/30 [00:49<00:09,  2.42s/it]{'epoch': 14, 'num_users': 5.8889, 'loss': 2.852, 'hit_ratio@10': 0.6494, 'ndcg@10': 249.6651, 'compress@10': 1.0, 'time@10': 2.6992}:  87%|████████▋ | 26/30 [00:51<00:09,  2.42s/it]{'epoch': 14, 'num_users': 5.8889, 'loss': 2.852, 'hit_ratio@10': 0.6494, 'ndcg@10': 249.6651, 'compress@10': 1.0, 'time@10': 2.6992}:  90%|█████████ | 27/30 [00:51<00:06,  2.29s/it]{'epoch': 14, 'num_users': 6.0, 'loss': 2.7578, 'hit_ratio@10': 0.6577, 'ndcg@10': 240.7846, 'compress@10': 1.0, 'time@10': 2.7412}:  90%|█████████ | 27/30 [00:55<00:06,  2.29s/it]  {'epoch': 14, 'num_users': 6.0, 'loss': 2.7578, 'hit_ratio@10': 0.6577, 'ndcg@10': 240.7846, 'compress@10': 1.0, 'time@10': 2.7412}:  93%|█████████▎| 28/30 [00:55<00:05,  2.78s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 2.6818, 'hit_ratio@10': 0.6491, 'ndcg@10': 232.5057, 'compress@10': 1.0, 'time@10': 2.7457}:  93%|█████████▎| 28/30 [00:56<00:05,  2.78s/it]{'epoch': 14, 'num_users': 5.8621, 'loss': 2.6818, 'hit_ratio@10': 0.6491, 'ndcg@10': 232.5057, 'compress@10': 1.0, 'time@10': 2.7457}:  97%|█████████▋| 29/30 [00:56<00:02,  2.38s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 2.604, 'hit_ratio@10': 0.6509, 'ndcg@10': 224.7962, 'compress@10': 1.0, 'time@10': 2.7396}:  97%|█████████▋| 29/30 [00:59<00:02,  2.38s/it] {'epoch': 14, 'num_users': 5.8667, 'loss': 2.604, 'hit_ratio@10': 0.6509, 'ndcg@10': 224.7962, 'compress@10': 1.0, 'time@10': 2.7396}: 100%|██████████| 30/30 [00:59<00:00,  2.45s/it]{'epoch': 14, 'num_users': 5.8667, 'loss': 2.604, 'hit_ratio@10': 0.6509, 'ndcg@10': 224.7962, 'compress@10': 1.0, 'time@10': 2.7396}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 14
Avg # of users: 5.866666666666666
Avg Loss: 2.6040254656557753
Avg hit ratio: 0.6509168774779419
Avg ndcg: 224.7961958419029
Avg compression ratio: 1.0
Avg train time: 2.7395793994267783
Std train time: 1.7348730083245212
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 4.4908, 'hit_ratio@10': 0.5789, 'ndcg@10': 5226904.1083, 'compress@10': 1.0, 'time@10': 2.6062}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 4.4908, 'hit_ratio@10': 0.5789, 'ndcg@10': 5226904.1083, 'compress@10': 1.0, 'time@10': 2.6062}:   3%|▎         | 1/30 [00:01<00:38,  1.33s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 4.8579, 'hit_ratio@10': 0.483, 'ndcg@10': 2613466.8136, 'compress@10': 1.0, 'time@10': 2.3644}:   3%|▎         | 1/30 [00:03<00:38,  1.33s/it] {'epoch': 15, 'num_users': 7.0, 'loss': 4.8579, 'hit_ratio@10': 0.483, 'ndcg@10': 2613466.8136, 'compress@10': 1.0, 'time@10': 2.3644}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 3.5747, 'hit_ratio@10': 0.5601, 'ndcg@10': 1742311.966, 'compress@10': 1.0, 'time@10': 1.8463}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 3.5747, 'hit_ratio@10': 0.5601, 'ndcg@10': 1742311.966, 'compress@10': 1.0, 'time@10': 1.8463}:  10%|█         | 3/30 [00:03<00:31,  1.18s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 5.7591, 'hit_ratio@10': 0.4826, 'ndcg@10': 1688296.1628, 'compress@10': 1.0, 'time@10': 1.8573}:  10%|█         | 3/30 [00:05<00:31,  1.18s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 5.7591, 'hit_ratio@10': 0.4826, 'ndcg@10': 1688296.1628, 'compress@10': 1.0, 'time@10': 1.8573}:  13%|█▎        | 4/30 [00:05<00:38,  1.47s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 4.6933, 'hit_ratio@10': 0.5741, 'ndcg@10': 1350637.1787, 'compress@10': 1.0, 'time@10': 2.8973}:  13%|█▎        | 4/30 [00:09<00:38,  1.47s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 4.6933, 'hit_ratio@10': 0.5741, 'ndcg@10': 1350637.1787, 'compress@10': 1.0, 'time@10': 2.8973}:  17%|█▋        | 5/30 [00:09<00:55,  2.23s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 4.165, 'hit_ratio@10': 0.5821, 'ndcg@10': 1125531.4997, 'compress@10': 1.0, 'time@10': 2.9329}:  17%|█▋        | 5/30 [00:12<00:55,  2.23s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 4.165, 'hit_ratio@10': 0.5821, 'ndcg@10': 1125531.4997, 'compress@10': 1.0, 'time@10': 2.9329}:  20%|██        | 6/30 [00:12<01:00,  2.54s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 5.0801, 'hit_ratio@10': 0.5675, 'ndcg@10': 965095.5486, 'compress@10': 1.0, 'time@10': 2.9992}:  20%|██        | 6/30 [00:14<01:00,  2.54s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 5.0801, 'hit_ratio@10': 0.5675, 'ndcg@10': 965095.5486, 'compress@10': 1.0, 'time@10': 2.9992}:  23%|██▎       | 7/30 [00:14<00:52,  2.27s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 4.6616, 'hit_ratio@10': 0.5859, 'ndcg@10': 844459.0222, 'compress@10': 1.0, 'time@10': 2.926}:  23%|██▎       | 7/30 [00:16<00:52,  2.27s/it]  {'epoch': 15, 'num_users': 6.125, 'loss': 4.6616, 'hit_ratio@10': 0.5859, 'ndcg@10': 844459.0222, 'compress@10': 1.0, 'time@10': 2.926}:  27%|██▋       | 8/30 [00:16<00:51,  2.33s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 4.3785, 'hit_ratio@10': 0.5874, 'ndcg@10': 750630.8039, 'compress@10': 1.0, 'time@10': 3.1464}:  27%|██▋       | 8/30 [00:19<00:51,  2.33s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 4.3785, 'hit_ratio@10': 0.5874, 'ndcg@10': 750630.8039, 'compress@10': 1.0, 'time@10': 3.1464}:  30%|███       | 9/30 [00:19<00:49,  2.38s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 4.0981, 'hit_ratio@10': 0.5832, 'ndcg@10': 675567.9663, 'compress@10': 1.0, 'time@10': 3.1334}:  30%|███       | 9/30 [00:22<00:49,  2.38s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 4.0981, 'hit_ratio@10': 0.5832, 'ndcg@10': 675567.9663, 'compress@10': 1.0, 'time@10': 3.1334}:  33%|███▎      | 10/30 [00:22<00:51,  2.58s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 3.7427, 'hit_ratio@10': 0.6001, 'ndcg@10': 614152.7649, 'compress@10': 1.0, 'time@10': 3.1827}:  33%|███▎      | 10/30 [00:24<00:51,  2.58s/it]{'epoch': 15, 'num_users': 6.6364, 'loss': 3.7427, 'hit_ratio@10': 0.6001, 'ndcg@10': 614152.7649, 'compress@10': 1.0, 'time@10': 3.1827}:  37%|███▋      | 11/30 [00:24<00:44,  2.36s/it]{'epoch': 15, 'num_users': 6.4167, 'loss': 6.3968, 'hit_ratio@10': 0.5779, 'ndcg@10': 564369.6916, 'compress@10': 1.0, 'time@10': 2.9856}:  37%|███▋      | 11/30 [00:24<00:44,  2.36s/it]{'epoch': 15, 'num_users': 6.4167, 'loss': 6.3968, 'hit_ratio@10': 0.5779, 'ndcg@10': 564369.6916, 'compress@10': 1.0, 'time@10': 2.9856}:  40%|████      | 12/30 [00:24<00:34,  1.90s/it]{'epoch': 15, 'num_users': 6.6154, 'loss': 5.989, 'hit_ratio@10': 0.5789, 'ndcg@10': 520956.8689, 'compress@10': 1.0, 'time@10': 2.9922}:  40%|████      | 12/30 [00:26<00:34,  1.90s/it] {'epoch': 15, 'num_users': 6.6154, 'loss': 5.989, 'hit_ratio@10': 0.5789, 'ndcg@10': 520956.8689, 'compress@10': 1.0, 'time@10': 2.9922}:  43%|████▎     | 13/30 [00:26<00:30,  1.80s/it]{'epoch': 15, 'num_users': 6.3571, 'loss': 5.7211, 'hit_ratio@10': 0.5614, 'ndcg@10': 483745.9981, 'compress@10': 1.0, 'time@10': 2.8035}:  43%|████▎     | 13/30 [00:26<00:30,  1.80s/it]{'epoch': 15, 'num_users': 6.3571, 'loss': 5.7211, 'hit_ratio@10': 0.5614, 'ndcg@10': 483745.9981, 'compress@10': 1.0, 'time@10': 2.8035}:  47%|████▋     | 14/30 [00:26<00:21,  1.37s/it]{'epoch': 15, 'num_users': 6.2667, 'loss': 5.4767, 'hit_ratio@10': 0.567, 'ndcg@10': 451496.4368, 'compress@10': 1.0, 'time@10': 2.8981}:  47%|████▋     | 14/30 [00:29<00:21,  1.37s/it] {'epoch': 15, 'num_users': 6.2667, 'loss': 5.4767, 'hit_ratio@10': 0.567, 'ndcg@10': 451496.4368, 'compress@10': 1.0, 'time@10': 2.8981}:  50%|█████     | 15/30 [00:29<00:24,  1.60s/it]{'epoch': 15, 'num_users': 6.0625, 'loss': 12.7097, 'hit_ratio@10': 0.5419, 'ndcg@10': 356173670.7908, 'compress@10': 1.0, 'time@10': 2.7629}:  50%|█████     | 15/30 [00:29<00:24,  1.60s/it]{'epoch': 15, 'num_users': 6.0625, 'loss': 12.7097, 'hit_ratio@10': 0.5419, 'ndcg@10': 356173670.7908, 'compress@10': 1.0, 'time@10': 2.7629}:  53%|█████▎    | 16/30 [00:29<00:18,  1.35s/it]{'epoch': 15, 'num_users': 5.8235, 'loss': 11.9854, 'hit_ratio@10': 0.5336, 'ndcg@10': 335222278.4601, 'compress@10': 1.0, 'time@10': 2.6308}:  53%|█████▎    | 16/30 [00:30<00:18,  1.35s/it]{'epoch': 15, 'num_users': 5.8235, 'loss': 11.9854, 'hit_ratio@10': 0.5336, 'ndcg@10': 335222278.4601, 'compress@10': 1.0, 'time@10': 2.6308}:  57%|█████▋    | 17/30 [00:30<00:13,  1.03s/it]{'epoch': 15, 'num_users': 6.0556, 'loss': 11.329, 'hit_ratio@10': 0.5476, 'ndcg@10': 316598818.5999, 'compress@10': 1.0, 'time@10': 2.594}:  57%|█████▋    | 17/30 [00:32<00:13,  1.03s/it]  {'epoch': 15, 'num_users': 6.0556, 'loss': 11.329, 'hit_ratio@10': 0.5476, 'ndcg@10': 316598818.5999, 'compress@10': 1.0, 'time@10': 2.594}:  60%|██████    | 18/30 [00:32<00:15,  1.32s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 10.7946, 'hit_ratio@10': 0.5601, 'ndcg@10': 299935723.0245, 'compress@10': 1.0, 'time@10': 2.5516}:  60%|██████    | 18/30 [00:33<00:15,  1.32s/it] {'epoch': 15, 'num_users': 6.0, 'loss': 10.7946, 'hit_ratio@10': 0.5601, 'ndcg@10': 299935723.0245, 'compress@10': 1.0, 'time@10': 2.5516}:  63%|██████▎   | 19/30 [00:33<00:13,  1.20s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 10.4092, 'hit_ratio@10': 0.5576, 'ndcg@10': 284938937.0929, 'compress@10': 1.0, 'time@10': 2.6236}:  63%|██████▎   | 19/30 [00:37<00:13,  1.20s/it]{'epoch': 15, 'num_users': 6.15, 'loss': 10.4092, 'hit_ratio@10': 0.5576, 'ndcg@10': 284938937.0929, 'compress@10': 1.0, 'time@10': 2.6236}:  67%|██████▋   | 20/30 [00:37<00:20,  2.05s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 10.1663, 'hit_ratio@10': 0.5477, 'ndcg@10': 271370416.9479, 'compress@10': 1.0, 'time@10': 2.7672}:  67%|██████▋   | 20/30 [00:39<00:20,  2.05s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 10.1663, 'hit_ratio@10': 0.5477, 'ndcg@10': 271370416.9479, 'compress@10': 1.0, 'time@10': 2.7672}:  70%|███████   | 21/30 [00:39<00:20,  2.29s/it]{'epoch': 15, 'num_users': 6.1818, 'loss': 9.7817, 'hit_ratio@10': 0.5496, 'ndcg@10': 259035398.0737, 'compress@10': 1.0, 'time@10': 2.706}:  70%|███████   | 21/30 [00:41<00:20,  2.29s/it]  {'epoch': 15, 'num_users': 6.1818, 'loss': 9.7817, 'hit_ratio@10': 0.5496, 'ndcg@10': 259035398.0737, 'compress@10': 1.0, 'time@10': 2.706}:  73%|███████▎  | 22/30 [00:41<00:16,  2.04s/it]{'epoch': 15, 'num_users': 6.1304, 'loss': 10.3801, 'hit_ratio@10': 0.5344, 'ndcg@10': 247773064.6737, 'compress@10': 1.0, 'time@10': 2.7037}:  73%|███████▎  | 22/30 [00:42<00:16,  2.04s/it]{'epoch': 15, 'num_users': 6.1304, 'loss': 10.3801, 'hit_ratio@10': 0.5344, 'ndcg@10': 247773064.6737, 'compress@10': 1.0, 'time@10': 2.7037}:  77%|███████▋  | 23/30 [00:42<00:12,  1.83s/it]{'epoch': 15, 'num_users': 5.9583, 'loss': 9.9605, 'hit_ratio@10': 0.5372, 'ndcg@10': 237449187.0154, 'compress@10': 1.0, 'time@10': 2.6017}:  77%|███████▋  | 23/30 [00:42<00:12,  1.83s/it] {'epoch': 15, 'num_users': 5.9583, 'loss': 9.9605, 'hit_ratio@10': 0.5372, 'ndcg@10': 237449187.0154, 'compress@10': 1.0, 'time@10': 2.6017}:  80%|████████  | 24/30 [00:42<00:08,  1.37s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 9.5679, 'hit_ratio@10': 0.5423, 'ndcg@10': 227951219.5982, 'compress@10': 1.0, 'time@10': 2.5085}:  80%|████████  | 24/30 [00:43<00:08,  1.37s/it]   {'epoch': 15, 'num_users': 5.8, 'loss': 9.5679, 'hit_ratio@10': 0.5423, 'ndcg@10': 227951219.5982, 'compress@10': 1.0, 'time@10': 2.5085}:  83%|████████▎ | 25/30 [00:43<00:05,  1.01s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 9.2173, 'hit_ratio@10': 0.5463, 'ndcg@10': 219183865.0434, 'compress@10': 1.0, 'time@10': 2.6242}:  83%|████████▎ | 25/30 [00:48<00:05,  1.01s/it]{'epoch': 15, 'num_users': 5.8077, 'loss': 9.2173, 'hit_ratio@10': 0.5463, 'ndcg@10': 219183865.0434, 'compress@10': 1.0, 'time@10': 2.6242}:  87%|████████▋ | 26/30 [00:48<00:09,  2.37s/it]{'epoch': 15, 'num_users': 5.8889, 'loss': 9.1693, 'hit_ratio@10': 0.5327, 'ndcg@10': 211065949.1981, 'compress@10': 1.0, 'time@10': 2.6722}:  87%|████████▋ | 26/30 [00:50<00:09,  2.37s/it]{'epoch': 15, 'num_users': 5.8889, 'loss': 9.1693, 'hit_ratio@10': 0.5327, 'ndcg@10': 211065949.1981, 'compress@10': 1.0, 'time@10': 2.6722}:  90%|█████████ | 27/30 [00:50<00:06,  2.26s/it]{'epoch': 15, 'num_users': 6.0, 'loss': 8.8847, 'hit_ratio@10': 0.5361, 'ndcg@10': 203527879.6679, 'compress@10': 1.0, 'time@10': 2.7157}:  90%|█████████ | 27/30 [00:54<00:06,  2.26s/it]   {'epoch': 15, 'num_users': 6.0, 'loss': 8.8847, 'hit_ratio@10': 0.5361, 'ndcg@10': 203527879.6679, 'compress@10': 1.0, 'time@10': 2.7157}:  93%|█████████▎| 28/30 [00:54<00:05,  2.76s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 9.3752, 'hit_ratio@10': 0.5255, 'ndcg@10': 196554311.6367, 'compress@10': 1.0, 'time@10': 2.7256}:  93%|█████████▎| 28/30 [00:56<00:05,  2.76s/it]{'epoch': 15, 'num_users': 5.8621, 'loss': 9.3752, 'hit_ratio@10': 0.5255, 'ndcg@10': 196554311.6367, 'compress@10': 1.0, 'time@10': 2.7256}:  97%|█████████▋| 29/30 [00:56<00:02,  2.39s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 9.3124, 'hit_ratio@10': 0.5143, 'ndcg@10': 190040718.7675, 'compress@10': 1.0, 'time@10': 2.7294}:  97%|█████████▋| 29/30 [00:59<00:02,  2.39s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 9.3124, 'hit_ratio@10': 0.5143, 'ndcg@10': 190040718.7675, 'compress@10': 1.0, 'time@10': 2.7294}: 100%|██████████| 30/30 [00:59<00:00,  2.53s/it]{'epoch': 15, 'num_users': 5.8667, 'loss': 9.3124, 'hit_ratio@10': 0.5143, 'ndcg@10': 190040718.7675, 'compress@10': 1.0, 'time@10': 2.7294}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 15
Avg # of users: 5.866666666666666
Avg Loss: 9.312436683763817
Avg hit ratio: 0.5142509623442533
Avg ndcg: 190040718.7675303
Avg compression ratio: 1.0
Avg train time: 2.7293926239013673
Std train time: 1.6979534745302698
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 3.4305, 'hit_ratio@10': 0.5789, 'ndcg@10': 11.5336, 'compress@10': 1.0, 'time@10': 2.5078}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 3.4305, 'hit_ratio@10': 0.5789, 'ndcg@10': 11.5336, 'compress@10': 1.0, 'time@10': 2.5078}:   3%|▎         | 1/30 [00:01<00:37,  1.28s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 5.5994, 'hit_ratio@10': 0.4024, 'ndcg@10': 29.394, 'compress@10': 1.0, 'time@10': 2.3323}:   3%|▎         | 1/30 [00:03<00:37,  1.28s/it] {'epoch': 16, 'num_users': 7.0, 'loss': 5.5994, 'hit_ratio@10': 0.4024, 'ndcg@10': 29.394, 'compress@10': 1.0, 'time@10': 2.3323}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 10.2914, 'hit_ratio@10': 0.4111, 'ndcg@10': 1301.5221, 'compress@10': 1.0, 'time@10': 1.8213}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 10.2914, 'hit_ratio@10': 0.4111, 'ndcg@10': 1301.5221, 'compress@10': 1.0, 'time@10': 1.8213}:  10%|█         | 3/30 [00:03<00:31,  1.18s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 9.3494, 'hit_ratio@10': 0.3976, 'ndcg@10': 981.2247, 'compress@10': 1.0, 'time@10': 1.8394}:  10%|█         | 3/30 [00:05<00:31,  1.18s/it]  {'epoch': 16, 'num_users': 5.0, 'loss': 9.3494, 'hit_ratio@10': 0.3976, 'ndcg@10': 981.2247, 'compress@10': 1.0, 'time@10': 1.8394}:  13%|█▎        | 4/30 [00:05<00:38,  1.47s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 7.7376, 'hit_ratio@10': 0.4221, 'ndcg@10': 785.3631, 'compress@10': 1.0, 'time@10': 2.9209}:  13%|█▎        | 4/30 [00:09<00:38,  1.47s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 7.7376, 'hit_ratio@10': 0.4221, 'ndcg@10': 785.3631, 'compress@10': 1.0, 'time@10': 2.9209}:  17%|█▋        | 5/30 [00:09<00:56,  2.26s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 6.903, 'hit_ratio@10': 0.448, 'ndcg@10': 656.0012, 'compress@10': 1.0, 'time@10': 2.9762}:  17%|█▋        | 5/30 [00:12<00:56,  2.26s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 6.903, 'hit_ratio@10': 0.448, 'ndcg@10': 656.0012, 'compress@10': 1.0, 'time@10': 2.9762}:  20%|██        | 6/30 [00:12<01:02,  2.61s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 7.403, 'hit_ratio@10': 0.4583, 'ndcg@10': 610.7216, 'compress@10': 1.0, 'time@10': 3.045}:  20%|██        | 6/30 [00:14<01:02,  2.61s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 7.403, 'hit_ratio@10': 0.4583, 'ndcg@10': 610.7216, 'compress@10': 1.0, 'time@10': 3.045}:  23%|██▎       | 7/30 [00:14<00:53,  2.33s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 7.3436, 'hit_ratio@10': 0.4617, 'ndcg@10': 541.0809, 'compress@10': 1.0, 'time@10': 2.9522}:  23%|██▎       | 7/30 [00:16<00:53,  2.33s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 7.3436, 'hit_ratio@10': 0.4617, 'ndcg@10': 541.0809, 'compress@10': 1.0, 'time@10': 2.9522}:  27%|██▋       | 8/30 [00:16<00:51,  2.33s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 7.5485, 'hit_ratio@10': 0.4358, 'ndcg@10': 501.4837, 'compress@10': 1.0, 'time@10': 3.1693}:  27%|██▋       | 8/30 [00:19<00:51,  2.33s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 7.5485, 'hit_ratio@10': 0.4358, 'ndcg@10': 501.4837, 'compress@10': 1.0, 'time@10': 3.1693}:  30%|███       | 9/30 [00:19<00:49,  2.38s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 7.0562, 'hit_ratio@10': 0.4468, 'ndcg@10': 451.8407, 'compress@10': 1.0, 'time@10': 3.157}:  30%|███       | 9/30 [00:22<00:49,  2.38s/it]    {'epoch': 16, 'num_users': 6.3, 'loss': 7.0562, 'hit_ratio@10': 0.4468, 'ndcg@10': 451.8407, 'compress@10': 1.0, 'time@10': 3.157}:  33%|███▎      | 10/30 [00:22<00:51,  2.59s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 6.951, 'hit_ratio@10': 0.4411, 'ndcg@10': 411.8527, 'compress@10': 1.0, 'time@10': 3.2021}:  33%|███▎      | 10/30 [00:24<00:51,  2.59s/it]{'epoch': 16, 'num_users': 6.6364, 'loss': 6.951, 'hit_ratio@10': 0.4411, 'ndcg@10': 411.8527, 'compress@10': 1.0, 'time@10': 3.2021}:  37%|███▋      | 11/30 [00:24<00:44,  2.37s/it]/slstore/shihongjian/Federated-Recommendation-Neural-Collaborative-Filtering/metrics.py:20: RuntimeWarning: overflow encountered in power
  dcg_numerator = np.power(2, predicted_recommendation_best_10) - 1
{'epoch': 16, 'num_users': 6.4167, 'loss': 23.9668, 'hit_ratio@10': 0.4322, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9985}:  37%|███▋      | 11/30 [00:25<00:44,  2.37s/it]   {'epoch': 16, 'num_users': 6.4167, 'loss': 23.9668, 'hit_ratio@10': 0.4322, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9985}:  40%|████      | 12/30 [00:25<00:33,  1.89s/it]{'epoch': 16, 'num_users': 6.6154, 'loss': 23.0227, 'hit_ratio@10': 0.4164, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0118}:  40%|████      | 12/30 [00:26<00:33,  1.89s/it]{'epoch': 16, 'num_users': 6.6154, 'loss': 23.0227, 'hit_ratio@10': 0.4164, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0118}:  43%|████▎     | 13/30 [00:26<00:30,  1.81s/it]{'epoch': 16, 'num_users': 6.3571, 'loss': 21.469, 'hit_ratio@10': 0.4105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8232}:  43%|████▎     | 13/30 [00:27<00:30,  1.81s/it] {'epoch': 16, 'num_users': 6.3571, 'loss': 21.469, 'hit_ratio@10': 0.4105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8232}:  47%|████▋     | 14/30 [00:27<00:22,  1.38s/it]{'epoch': 16, 'num_users': 6.2667, 'loss': 20.0842, 'hit_ratio@10': 0.4304, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9278}:  47%|████▋     | 14/30 [00:29<00:22,  1.38s/it]{'epoch': 16, 'num_users': 6.2667, 'loss': 20.0842, 'hit_ratio@10': 0.4304, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9278}:  50%|█████     | 15/30 [00:29<00:24,  1.64s/it]{'epoch': 16, 'num_users': 6.0625, 'loss': 31.276, 'hit_ratio@10': 0.4087, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7926}:  50%|█████     | 15/30 [00:30<00:24,  1.64s/it] {'epoch': 16, 'num_users': 6.0625, 'loss': 31.276, 'hit_ratio@10': 0.4087, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7926}:  53%|█████▎    | 16/30 [00:30<00:19,  1.38s/it]{'epoch': 16, 'num_users': 5.8235, 'loss': 29.5038, 'hit_ratio@10': 0.4317, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.662}:  53%|█████▎    | 16/30 [00:30<00:19,  1.38s/it]{'epoch': 16, 'num_users': 5.8235, 'loss': 29.5038, 'hit_ratio@10': 0.4317, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.662}:  57%|█████▋    | 17/30 [00:30<00:13,  1.06s/it]{'epoch': 16, 'num_users': 6.0556, 'loss': 29.6246, 'hit_ratio@10': 0.4236, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6258}:  57%|█████▋    | 17/30 [00:32<00:13,  1.06s/it]{'epoch': 16, 'num_users': 6.0556, 'loss': 29.6246, 'hit_ratio@10': 0.4236, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6258}:  60%|██████    | 18/30 [00:32<00:16,  1.36s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 28.4247, 'hit_ratio@10': 0.4088, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5824}:  60%|██████    | 18/30 [00:33<00:16,  1.36s/it]   {'epoch': 16, 'num_users': 6.0, 'loss': 28.4247, 'hit_ratio@10': 0.4088, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5824}:  63%|██████▎   | 19/30 [00:33<00:13,  1.23s/it]{'epoch': 16, 'num_users': 6.15, 'loss': 27.2558, 'hit_ratio@10': 0.4112, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6583}:  63%|██████▎   | 19/30 [00:37<00:13,  1.23s/it]{'epoch': 16, 'num_users': 6.15, 'loss': 27.2558, 'hit_ratio@10': 0.4112, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6583}:  67%|██████▋   | 20/30 [00:37<00:21,  2.10s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 26.5556, 'hit_ratio@10': 0.4071, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8097}:  67%|██████▋   | 20/30 [00:40<00:21,  2.10s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 26.5556, 'hit_ratio@10': 0.4071, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8097}:  70%|███████   | 21/30 [00:40<00:21,  2.35s/it]{'epoch': 16, 'num_users': 6.1818, 'loss': 25.3625, 'hit_ratio@10': 0.4237, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7463}:  70%|███████   | 21/30 [00:41<00:21,  2.35s/it]{'epoch': 16, 'num_users': 6.1818, 'loss': 25.3625, 'hit_ratio@10': 0.4237, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7463}:  73%|███████▎  | 22/30 [00:41<00:16,  2.08s/it]{'epoch': 16, 'num_users': 6.1304, 'loss': 24.4465, 'hit_ratio@10': 0.4162, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7484}:  73%|███████▎  | 22/30 [00:43<00:16,  2.08s/it]{'epoch': 16, 'num_users': 6.1304, 'loss': 24.4465, 'hit_ratio@10': 0.4162, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7484}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it]{'epoch': 16, 'num_users': 5.9583, 'loss': 23.4885, 'hit_ratio@10': 0.4238, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6456}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it]{'epoch': 16, 'num_users': 5.9583, 'loss': 23.4885, 'hit_ratio@10': 0.4238, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6456}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 22.5772, 'hit_ratio@10': 0.4335, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5498}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]   {'epoch': 16, 'num_users': 5.8, 'loss': 22.5772, 'hit_ratio@10': 0.4335, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5498}:  83%|████████▎ | 25/30 [00:43<00:05,  1.04s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 22.042, 'hit_ratio@10': 0.4328, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6707}:  83%|████████▎ | 25/30 [00:49<00:05,  1.04s/it]{'epoch': 16, 'num_users': 5.8077, 'loss': 22.042, 'hit_ratio@10': 0.4328, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6707}:  87%|████████▋ | 26/30 [00:49<00:09,  2.44s/it]{'epoch': 16, 'num_users': 5.8889, 'loss': 21.4394, 'hit_ratio@10': 0.4393, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.712}:  87%|████████▋ | 26/30 [00:51<00:09,  2.44s/it]{'epoch': 16, 'num_users': 5.8889, 'loss': 21.4394, 'hit_ratio@10': 0.4393, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.712}:  90%|█████████ | 27/30 [00:51<00:06,  2.29s/it]{'epoch': 16, 'num_users': 6.0, 'loss': 20.773, 'hit_ratio@10': 0.4432, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7408}:  90%|█████████ | 27/30 [00:55<00:06,  2.29s/it]   {'epoch': 16, 'num_users': 6.0, 'loss': 20.773, 'hit_ratio@10': 0.4432, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7408}:  93%|█████████▎| 28/30 [00:55<00:05,  2.77s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 28.3321, 'hit_ratio@10': 0.4357, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7432}:  93%|█████████▎| 28/30 [00:56<00:05,  2.77s/it]{'epoch': 16, 'num_users': 5.8621, 'loss': 28.3321, 'hit_ratio@10': 0.4357, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7432}:  97%|█████████▋| 29/30 [00:56<00:02,  2.37s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 27.4442, 'hit_ratio@10': 0.4383, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7355}:  97%|█████████▋| 29/30 [00:59<00:02,  2.37s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 27.4442, 'hit_ratio@10': 0.4383, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7355}: 100%|██████████| 30/30 [00:59<00:00,  2.42s/it]{'epoch': 16, 'num_users': 5.8667, 'loss': 27.4442, 'hit_ratio@10': 0.4383, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7355}: 100%|██████████| 30/30 [00:59<00:00,  1.98s/it]
Epoch: 16
Avg # of users: 5.866666666666666
Avg Loss: 27.44416690223588
Avg hit ratio: 0.4383413415155163
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7355494578679402
Std train time: 1.7335086031601594
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 18.7563, 'hit_ratio@10': 0.2632, 'ndcg@10': 393.6495, 'compress@10': 1.0, 'time@10': 2.5611}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 18.7563, 'hit_ratio@10': 0.2632, 'ndcg@10': 393.6495, 'compress@10': 1.0, 'time@10': 2.5611}:   3%|▎         | 1/30 [00:01<00:37,  1.31s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 12.3739, 'hit_ratio@10': 0.2767, 'ndcg@10': 217.1917, 'compress@10': 1.0, 'time@10': 2.3459}:   3%|▎         | 1/30 [00:03<00:37,  1.31s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 12.3739, 'hit_ratio@10': 0.2767, 'ndcg@10': 217.1917, 'compress@10': 1.0, 'time@10': 2.3459}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 86.3709, 'hit_ratio@10': 0.2321, 'ndcg@10': 63199857321289.305, 'compress@10': 1.0, 'time@10': 1.8248}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 86.3709, 'hit_ratio@10': 0.2321, 'ndcg@10': 63199857321289.305, 'compress@10': 1.0, 'time@10': 1.8248}:  10%|█         | 3/30 [00:03<00:31,  1.18s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 75.4698, 'hit_ratio@10': 0.2098, 'ndcg@10': 47399921630803.03, 'compress@10': 1.0, 'time@10': 1.8586}:  10%|█         | 3/30 [00:05<00:31,  1.18s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 75.4698, 'hit_ratio@10': 0.2098, 'ndcg@10': 47399921630803.03, 'compress@10': 1.0, 'time@10': 1.8586}:  13%|█▎        | 4/30 [00:05<00:39,  1.50s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 61.035, 'hit_ratio@10': 0.3078, 'ndcg@10': 37919937304644.04, 'compress@10': 1.0, 'time@10': 2.9455}:  13%|█▎        | 4/30 [00:09<00:39,  1.50s/it] {'epoch': 17, 'num_users': 5.8, 'loss': 61.035, 'hit_ratio@10': 0.3078, 'ndcg@10': 37919937304644.04, 'compress@10': 1.0, 'time@10': 2.9455}:  17%|█▋        | 5/30 [00:09<00:57,  2.29s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 52.4716, 'hit_ratio@10': 0.3047, 'ndcg@10': 31599947754032.24, 'compress@10': 1.0, 'time@10': 2.9885}:  17%|█▋        | 5/30 [00:12<00:57,  2.29s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 52.4716, 'hit_ratio@10': 0.3047, 'ndcg@10': 31599947754032.24, 'compress@10': 1.0, 'time@10': 2.9885}:  20%|██        | 6/30 [00:12<01:02,  2.61s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 60.1821, 'hit_ratio@10': 0.3069, 'ndcg@10': 66783817382126.21, 'compress@10': 1.0, 'time@10': 3.051}:  20%|██        | 6/30 [00:14<01:02,  2.61s/it] {'epoch': 17, 'num_users': 6.2857, 'loss': 60.1821, 'hit_ratio@10': 0.3069, 'ndcg@10': 66783817382126.21, 'compress@10': 1.0, 'time@10': 3.051}:  23%|██▎       | 7/30 [00:14<00:53,  2.33s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 53.7329, 'hit_ratio@10': 0.3114, 'ndcg@10': 58435840209368.86, 'compress@10': 1.0, 'time@10': 2.97}:  23%|██▎       | 7/30 [00:16<00:53,  2.33s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 53.7329, 'hit_ratio@10': 0.3114, 'ndcg@10': 58435840209368.86, 'compress@10': 1.0, 'time@10': 2.97}:  27%|██▋       | 8/30 [00:16<00:52,  2.36s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 49.664, 'hit_ratio@10': 0.2958, 'ndcg@10': 51942969075043.2, 'compress@10': 1.0, 'time@10': 3.1882}:  27%|██▋       | 8/30 [00:19<00:52,  2.36s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 49.664, 'hit_ratio@10': 0.2958, 'ndcg@10': 51942969075043.2, 'compress@10': 1.0, 'time@10': 3.1882}:  30%|███       | 9/30 [00:19<00:50,  2.41s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 46.9257, 'hit_ratio@10': 0.2958, 'ndcg@10': 46748672222414.195, 'compress@10': 1.0, 'time@10': 3.1733}:  30%|███       | 9/30 [00:22<00:50,  2.41s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 46.9257, 'hit_ratio@10': 0.2958, 'ndcg@10': 46748672222414.195, 'compress@10': 1.0, 'time@10': 3.1733}:  33%|███▎      | 10/30 [00:22<00:52,  2.61s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 42.7073, 'hit_ratio@10': 0.3318, 'ndcg@10': 42498792929467.59, 'compress@10': 1.0, 'time@10': 3.2265}:  33%|███▎      | 10/30 [00:24<00:52,  2.61s/it]{'epoch': 17, 'num_users': 6.6364, 'loss': 42.7073, 'hit_ratio@10': 0.3318, 'ndcg@10': 42498792929467.59, 'compress@10': 1.0, 'time@10': 3.2265}:  37%|███▋      | 11/30 [00:24<00:45,  2.40s/it]{'epoch': 17, 'num_users': 6.4167, 'loss': 40.0951, 'hit_ratio@10': 0.3389, 'ndcg@10': 38957226852022.555, 'compress@10': 1.0, 'time@10': 3.0225}:  37%|███▋      | 11/30 [00:25<00:45,  2.40s/it]{'epoch': 17, 'num_users': 6.4167, 'loss': 40.0951, 'hit_ratio@10': 0.3389, 'ndcg@10': 38957226852022.555, 'compress@10': 1.0, 'time@10': 3.0225}:  40%|████      | 12/30 [00:25<00:34,  1.91s/it]{'epoch': 17, 'num_users': 6.6154, 'loss': 37.053, 'hit_ratio@10': 0.3618, 'ndcg@10': 35960517094174.766, 'compress@10': 1.0, 'time@10': 3.0266}:  40%|████      | 12/30 [00:26<00:34,  1.91s/it] {'epoch': 17, 'num_users': 6.6154, 'loss': 37.053, 'hit_ratio@10': 0.3618, 'ndcg@10': 35960517094174.766, 'compress@10': 1.0, 'time@10': 3.0266}:  43%|████▎     | 13/30 [00:26<00:30,  1.81s/it]{'epoch': 17, 'num_users': 6.3571, 'loss': 41.607, 'hit_ratio@10': 0.3478, 'ndcg@10': 33391984805752.082, 'compress@10': 1.0, 'time@10': 2.8356}:  43%|████▎     | 13/30 [00:27<00:30,  1.81s/it]{'epoch': 17, 'num_users': 6.3571, 'loss': 41.607, 'hit_ratio@10': 0.3478, 'ndcg@10': 33391984805752.082, 'compress@10': 1.0, 'time@10': 2.8356}:  47%|████▋     | 14/30 [00:27<00:22,  1.38s/it]{'epoch': 17, 'num_users': 6.2667, 'loss': 42.6689, 'hit_ratio@10': 0.3354, 'ndcg@10': 31165860120297.484, 'compress@10': 1.0, 'time@10': 2.9241}:  47%|████▋     | 14/30 [00:29<00:22,  1.38s/it]{'epoch': 17, 'num_users': 6.2667, 'loss': 42.6689, 'hit_ratio@10': 0.3354, 'ndcg@10': 31165860120297.484, 'compress@10': 1.0, 'time@10': 2.9241}:  50%|█████     | 15/30 [00:29<00:24,  1.63s/it]{'epoch': 17, 'num_users': 6.0625, 'loss': 40.0148, 'hit_ratio@10': 0.3405, 'ndcg@10': 29217993862778.957, 'compress@10': 1.0, 'time@10': 2.79}:  50%|█████     | 15/30 [00:30<00:24,  1.63s/it]  {'epoch': 17, 'num_users': 6.0625, 'loss': 40.0148, 'hit_ratio@10': 0.3405, 'ndcg@10': 29217993862778.957, 'compress@10': 1.0, 'time@10': 2.79}:  53%|█████▎    | 16/30 [00:30<00:19,  1.39s/it]{'epoch': 17, 'num_users': 5.8235, 'loss': 38.1558, 'hit_ratio@10': 0.344, 'ndcg@10': 27499288341439.215, 'compress@10': 1.0, 'time@10': 2.6594}:  53%|█████▎    | 16/30 [00:30<00:19,  1.39s/it]{'epoch': 17, 'num_users': 5.8235, 'loss': 38.1558, 'hit_ratio@10': 0.344, 'ndcg@10': 27499288341439.215, 'compress@10': 1.0, 'time@10': 2.6594}:  57%|█████▋    | 17/30 [00:30<00:13,  1.06s/it]{'epoch': 17, 'num_users': 6.0556, 'loss': 38.2806, 'hit_ratio@10': 0.3388, 'ndcg@10': 25971550205211.17, 'compress@10': 1.0, 'time@10': 2.6267}:  57%|█████▋    | 17/30 [00:32<00:13,  1.06s/it]{'epoch': 17, 'num_users': 6.0556, 'loss': 38.2806, 'hit_ratio@10': 0.3388, 'ndcg@10': 25971550205211.17, 'compress@10': 1.0, 'time@10': 2.6267}:  60%|██████    | 18/30 [00:32<00:16,  1.38s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 37.9152, 'hit_ratio@10': 0.3285, 'ndcg@10': 24604626521953.32, 'compress@10': 1.0, 'time@10': 2.5899}:  60%|██████    | 18/30 [00:33<00:16,  1.38s/it]   {'epoch': 17, 'num_users': 6.0, 'loss': 37.9152, 'hit_ratio@10': 0.3285, 'ndcg@10': 24604626521953.32, 'compress@10': 1.0, 'time@10': 2.5899}:  63%|██████▎   | 19/30 [00:33<00:13,  1.26s/it]{'epoch': 17, 'num_users': 6.15, 'loss': 36.5569, 'hit_ratio@10': 0.3261, 'ndcg@10': 23374395195873.13, 'compress@10': 1.0, 'time@10': 2.6674}:  63%|██████▎   | 19/30 [00:37<00:13,  1.26s/it]{'epoch': 17, 'num_users': 6.15, 'loss': 36.5569, 'hit_ratio@10': 0.3261, 'ndcg@10': 23374395195873.13, 'compress@10': 1.0, 'time@10': 2.6674}:  67%|██████▋   | 20/30 [00:37<00:21,  2.13s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 34.8809, 'hit_ratio@10': 0.3391, 'ndcg@10': 22261328757974.508, 'compress@10': 1.0, 'time@10': 2.8141}:  67%|██████▋   | 20/30 [00:40<00:21,  2.13s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 34.8809, 'hit_ratio@10': 0.3391, 'ndcg@10': 22261328757974.508, 'compress@10': 1.0, 'time@10': 2.8141}:  70%|███████   | 21/30 [00:40<00:21,  2.37s/it]{'epoch': 17, 'num_users': 6.1818, 'loss': 36.7764, 'hit_ratio@10': 0.3299, 'ndcg@10': 21249450438807.953, 'compress@10': 1.0, 'time@10': 2.7509}:  70%|███████   | 21/30 [00:42<00:21,  2.37s/it]{'epoch': 17, 'num_users': 6.1818, 'loss': 36.7764, 'hit_ratio@10': 0.3299, 'ndcg@10': 21249450438807.953, 'compress@10': 1.0, 'time@10': 2.7509}:  73%|███████▎  | 22/30 [00:42<00:16,  2.09s/it]{'epoch': 17, 'num_users': 6.1304, 'loss': 35.1835, 'hit_ratio@10': 0.3373, 'ndcg@10': 20325561289294.59, 'compress@10': 1.0, 'time@10': 2.7412}:  73%|███████▎  | 22/30 [00:43<00:16,  2.09s/it] {'epoch': 17, 'num_users': 6.1304, 'loss': 35.1835, 'hit_ratio@10': 0.3373, 'ndcg@10': 20325561289294.59, 'compress@10': 1.0, 'time@10': 2.7412}:  77%|███████▋  | 23/30 [00:43<00:12,  1.85s/it]{'epoch': 17, 'num_users': 5.9583, 'loss': 34.1314, 'hit_ratio@10': 0.3232, 'ndcg@10': 19478662902242.457, 'compress@10': 1.0, 'time@10': 2.6382}:  77%|███████▋  | 23/30 [00:43<00:12,  1.85s/it]{'epoch': 17, 'num_users': 5.9583, 'loss': 34.1314, 'hit_ratio@10': 0.3232, 'ndcg@10': 19478662902242.457, 'compress@10': 1.0, 'time@10': 2.6382}:  80%|████████  | 24/30 [00:43<00:08,  1.39s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 32.796, 'hit_ratio@10': 0.337, 'ndcg@10': 18699516386152.81, 'compress@10': 1.0, 'time@10': 2.5435}:  80%|████████  | 24/30 [00:43<00:08,  1.39s/it]      {'epoch': 17, 'num_users': 5.8, 'loss': 32.796, 'hit_ratio@10': 0.337, 'ndcg@10': 18699516386152.81, 'compress@10': 1.0, 'time@10': 2.5435}:  83%|████████▎ | 25/30 [00:43<00:05,  1.02s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 31.653, 'hit_ratio@10': 0.3423, 'ndcg@10': 17980304217454.906, 'compress@10': 1.0, 'time@10': 2.6633}:  83%|████████▎ | 25/30 [00:49<00:05,  1.02s/it]{'epoch': 17, 'num_users': 5.8077, 'loss': 31.653, 'hit_ratio@10': 0.3423, 'ndcg@10': 17980304217454.906, 'compress@10': 1.0, 'time@10': 2.6633}:  87%|████████▋ | 26/30 [00:49<00:09,  2.42s/it]{'epoch': 17, 'num_users': 5.8889, 'loss': 30.9144, 'hit_ratio@10': 0.3323, 'ndcg@10': 17314367024273.143, 'compress@10': 1.0, 'time@10': 2.7044}:  87%|████████▋ | 26/30 [00:51<00:09,  2.42s/it]{'epoch': 17, 'num_users': 5.8889, 'loss': 30.9144, 'hit_ratio@10': 0.3323, 'ndcg@10': 17314367024273.143, 'compress@10': 1.0, 'time@10': 2.7044}:  90%|█████████ | 27/30 [00:51<00:06,  2.27s/it]{'epoch': 17, 'num_users': 6.0, 'loss': 29.8247, 'hit_ratio@10': 0.3491, 'ndcg@10': 16695996773406.28, 'compress@10': 1.0, 'time@10': 2.7323}:  90%|█████████ | 27/30 [00:55<00:06,  2.27s/it]    {'epoch': 17, 'num_users': 6.0, 'loss': 29.8247, 'hit_ratio@10': 0.3491, 'ndcg@10': 16695996773406.28, 'compress@10': 1.0, 'time@10': 2.7323}:  93%|█████████▎| 28/30 [00:55<00:05,  2.64s/it]{'epoch': 17, 'num_users': 5.8621, 'loss': 49.1048, 'hit_ratio@10': 0.3434, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.736}:  93%|█████████▎| 28/30 [00:56<00:05,  2.64s/it]            {'epoch': 17, 'num_users': 5.8621, 'loss': 49.1048, 'hit_ratio@10': 0.3434, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.736}:  97%|█████████▋| 29/30 [00:56<00:02,  2.28s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 48.5981, 'hit_ratio@10': 0.3373, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7307}:  97%|█████████▋| 29/30 [00:59<00:02,  2.28s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 48.5981, 'hit_ratio@10': 0.3373, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7307}: 100%|██████████| 30/30 [00:59<00:00,  2.38s/it]{'epoch': 17, 'num_users': 5.8667, 'loss': 48.5981, 'hit_ratio@10': 0.3373, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7307}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 17
Avg # of users: 5.866666666666666
Avg Loss: 48.598106652975495
Avg hit ratio: 0.3373105000461583
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7306620279947915
Std train time: 1.7206109496297266
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 43.489, 'hit_ratio@10': 0.3158, 'ndcg@10': 896169565430.8551, 'compress@10': 1.0, 'time@10': 2.4114}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 43.489, 'hit_ratio@10': 0.3158, 'ndcg@10': 896169565430.8551, 'compress@10': 1.0, 'time@10': 2.4114}:   3%|▎         | 1/30 [00:01<00:35,  1.23s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 27.4676, 'hit_ratio@10': 0.2224, 'ndcg@10': 448084782820.6805, 'compress@10': 1.0, 'time@10': 2.306}:   3%|▎         | 1/30 [00:03<00:35,  1.23s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 27.4676, 'hit_ratio@10': 0.2224, 'ndcg@10': 448084782820.6805, 'compress@10': 1.0, 'time@10': 2.306}:   7%|▋         | 2/30 [00:03<00:53,  1.92s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 35.006, 'hit_ratio@10': 0.2435, 'ndcg@10': 298723766338.0039, 'compress@10': 1.0, 'time@10': 1.8114}:   7%|▋         | 2/30 [00:04<00:53,  1.92s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 35.006, 'hit_ratio@10': 0.2435, 'ndcg@10': 298723766338.0039, 'compress@10': 1.0, 'time@10': 1.8114}:  10%|█         | 3/30 [00:04<00:33,  1.24s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 29.5036, 'hit_ratio@10': 0.2808, 'ndcg@10': 224042824797.4436, 'compress@10': 1.0, 'time@10': 1.8222}:  10%|█         | 3/30 [00:05<00:33,  1.24s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 29.5036, 'hit_ratio@10': 0.2808, 'ndcg@10': 224042824797.4436, 'compress@10': 1.0, 'time@10': 1.8222}:  13%|█▎        | 4/30 [00:05<00:38,  1.50s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 23.8389, 'hit_ratio@10': 0.2887, 'ndcg@10': 179234259838.2103, 'compress@10': 1.0, 'time@10': 2.8821}:  13%|█▎        | 4/30 [00:09<00:38,  1.50s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 23.8389, 'hit_ratio@10': 0.2887, 'ndcg@10': 179234259838.2103, 'compress@10': 1.0, 'time@10': 2.8821}:  17%|█▋        | 5/30 [00:09<00:56,  2.25s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 24.4577, 'hit_ratio@10': 0.2776, 'ndcg@10': 149361955603.345, 'compress@10': 1.0, 'time@10': 2.929}:  17%|█▋        | 5/30 [00:12<00:56,  2.25s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 24.4577, 'hit_ratio@10': 0.2776, 'ndcg@10': 149361955603.345, 'compress@10': 1.0, 'time@10': 2.929}:  20%|██        | 6/30 [00:12<01:01,  2.57s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 21.7815, 'hit_ratio@10': 0.2608, 'ndcg@10': 128024533378.579, 'compress@10': 1.0, 'time@10': 3.0155}:  20%|██        | 6/30 [00:14<01:01,  2.57s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 21.7815, 'hit_ratio@10': 0.2608, 'ndcg@10': 128024533378.579, 'compress@10': 1.0, 'time@10': 3.0155}:  23%|██▎       | 7/30 [00:14<00:53,  2.32s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 20.3654, 'hit_ratio@10': 0.2496, 'ndcg@10': 112021466749.7916, 'compress@10': 1.0, 'time@10': 2.9419}:  23%|██▎       | 7/30 [00:16<00:53,  2.32s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 20.3654, 'hit_ratio@10': 0.2496, 'ndcg@10': 112021466749.7916, 'compress@10': 1.0, 'time@10': 2.9419}:  27%|██▋       | 8/30 [00:16<00:51,  2.36s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 21.4379, 'hit_ratio@10': 0.26, 'ndcg@10': 99574792071.5245, 'compress@10': 1.0, 'time@10': 3.1498}:  27%|██▋       | 8/30 [00:19<00:51,  2.36s/it]  {'epoch': 18, 'num_users': 6.3333, 'loss': 21.4379, 'hit_ratio@10': 0.26, 'ndcg@10': 99574792071.5245, 'compress@10': 1.0, 'time@10': 3.1498}:  30%|███       | 9/30 [00:19<00:50,  2.39s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 20.1609, 'hit_ratio@10': 0.2681, 'ndcg@10': 89617312867.2846, 'compress@10': 1.0, 'time@10': 3.142}:  30%|███       | 9/30 [00:22<00:50,  2.39s/it]  {'epoch': 18, 'num_users': 6.3, 'loss': 20.1609, 'hit_ratio@10': 0.2681, 'ndcg@10': 89617312867.2846, 'compress@10': 1.0, 'time@10': 3.142}:  33%|███▎      | 10/30 [00:22<00:52,  2.61s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 67.6317, 'hit_ratio@10': 0.2542, 'ndcg@10': 3.1959099250012854e+24, 'compress@10': 1.0, 'time@10': 3.1934}:  33%|███▎      | 10/30 [00:24<00:52,  2.61s/it]{'epoch': 18, 'num_users': 6.6364, 'loss': 67.6317, 'hit_ratio@10': 0.2542, 'ndcg@10': 3.1959099250012854e+24, 'compress@10': 1.0, 'time@10': 3.1934}:  37%|███▋      | 11/30 [00:24<00:45,  2.39s/it]{'epoch': 18, 'num_users': 6.4167, 'loss': 62.0295, 'hit_ratio@10': 0.2677, 'ndcg@10': 2.929584097917845e+24, 'compress@10': 1.0, 'time@10': 2.9945}:  37%|███▋      | 11/30 [00:25<00:45,  2.39s/it] {'epoch': 18, 'num_users': 6.4167, 'loss': 62.0295, 'hit_ratio@10': 0.2677, 'ndcg@10': 2.929584097917845e+24, 'compress@10': 1.0, 'time@10': 2.9945}:  40%|████      | 12/30 [00:25<00:34,  1.91s/it]{'epoch': 18, 'num_users': 6.6154, 'loss': 69.1288, 'hit_ratio@10': 0.2646, 'ndcg@10': 2.704231475006199e+24, 'compress@10': 1.0, 'time@10': 2.9925}:  40%|████      | 12/30 [00:26<00:34,  1.91s/it]{'epoch': 18, 'num_users': 6.6154, 'loss': 69.1288, 'hit_ratio@10': 0.2646, 'ndcg@10': 2.704231475006199e+24, 'compress@10': 1.0, 'time@10': 2.9925}:  43%|████▎     | 13/30 [00:26<00:30,  1.79s/it]{'epoch': 18, 'num_users': 6.3571, 'loss': 72.01, 'hit_ratio@10': 0.2457, 'ndcg@10': 2.5110720839343277e+24, 'compress@10': 1.0, 'time@10': 2.8033}:  43%|████▎     | 13/30 [00:27<00:30,  1.79s/it] {'epoch': 18, 'num_users': 6.3571, 'loss': 72.01, 'hit_ratio@10': 0.2457, 'ndcg@10': 2.5110720839343277e+24, 'compress@10': 1.0, 'time@10': 2.8033}:  47%|████▋     | 14/30 [00:27<00:21,  1.36s/it]{'epoch': 18, 'num_users': 6.2667, 'loss': 71.2752, 'hit_ratio@10': 0.2465, 'ndcg@10': 2.3436672783387063e+24, 'compress@10': 1.0, 'time@10': 2.8953}:  47%|████▋     | 14/30 [00:29<00:21,  1.36s/it]{'epoch': 18, 'num_users': 6.2667, 'loss': 71.2752, 'hit_ratio@10': 0.2465, 'ndcg@10': 2.3436672783387063e+24, 'compress@10': 1.0, 'time@10': 2.8953}:  50%|█████     | 15/30 [00:29<00:23,  1.59s/it]{'epoch': 18, 'num_users': 6.0625, 'loss': 66.8758, 'hit_ratio@10': 0.2728, 'ndcg@10': 2.1971880734425368e+24, 'compress@10': 1.0, 'time@10': 2.7648}:  50%|█████     | 15/30 [00:30<00:23,  1.59s/it]{'epoch': 18, 'num_users': 6.0625, 'loss': 66.8758, 'hit_ratio@10': 0.2728, 'ndcg@10': 2.1971880734425368e+24, 'compress@10': 1.0, 'time@10': 2.7648}:  53%|█████▎    | 16/30 [00:30<00:19,  1.37s/it]{'epoch': 18, 'num_users': 5.8235, 'loss': 63.341, 'hit_ratio@10': 0.2568, 'ndcg@10': 2.0679417161812112e+24, 'compress@10': 1.0, 'time@10': 2.6369}:  53%|█████▎    | 16/30 [00:30<00:19,  1.37s/it] {'epoch': 18, 'num_users': 5.8235, 'loss': 63.341, 'hit_ratio@10': 0.2568, 'ndcg@10': 2.0679417161812112e+24, 'compress@10': 1.0, 'time@10': 2.6369}:  57%|█████▋    | 17/30 [00:30<00:13,  1.05s/it]{'epoch': 18, 'num_users': 6.0556, 'loss': 65.3407, 'hit_ratio@10': 0.2504, 'ndcg@10': 1.9530560652822552e+24, 'compress@10': 1.0, 'time@10': 2.6079}:  57%|█████▋    | 17/30 [00:32<00:13,  1.05s/it]{'epoch': 18, 'num_users': 6.0556, 'loss': 65.3407, 'hit_ratio@10': 0.2504, 'ndcg@10': 1.9530560652822552e+24, 'compress@10': 1.0, 'time@10': 2.6079}:  60%|██████    | 18/30 [00:32<00:16,  1.38s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 64.5518, 'hit_ratio@10': 0.2523, 'ndcg@10': 1.8502636407937157e+24, 'compress@10': 1.0, 'time@10': 2.5673}:  60%|██████    | 18/30 [00:33<00:16,  1.38s/it]   {'epoch': 18, 'num_users': 6.0, 'loss': 64.5518, 'hit_ratio@10': 0.2523, 'ndcg@10': 1.8502636407937157e+24, 'compress@10': 1.0, 'time@10': 2.5673}:  63%|██████▎   | 19/30 [00:33<00:13,  1.25s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 61.3917, 'hit_ratio@10': 0.2651, 'ndcg@10': 1.7577504587540298e+24, 'compress@10': 1.0, 'time@10': 2.6422}:  63%|██████▎   | 19/30 [00:37<00:13,  1.25s/it]{'epoch': 18, 'num_users': 6.15, 'loss': 61.3917, 'hit_ratio@10': 0.2651, 'ndcg@10': 1.7577504587540298e+24, 'compress@10': 1.0, 'time@10': 2.6422}:  67%|██████▋   | 20/30 [00:37<00:21,  2.11s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 58.5204, 'hit_ratio@10': 0.2703, 'ndcg@10': 1.674048055956219e+24, 'compress@10': 1.0, 'time@10': 2.7849}:  67%|██████▋   | 20/30 [00:40<00:21,  2.11s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 58.5204, 'hit_ratio@10': 0.2703, 'ndcg@10': 1.674048055956219e+24, 'compress@10': 1.0, 'time@10': 2.7849}:  70%|███████   | 21/30 [00:40<00:20,  2.33s/it]{'epoch': 18, 'num_users': 6.1818, 'loss': 59.3431, 'hit_ratio@10': 0.2746, 'ndcg@10': 1.5979549625036642e+24, 'compress@10': 1.0, 'time@10': 2.7235}:  70%|███████   | 21/30 [00:41<00:20,  2.33s/it]{'epoch': 18, 'num_users': 6.1818, 'loss': 59.3431, 'hit_ratio@10': 0.2746, 'ndcg@10': 1.5979549625036642e+24, 'compress@10': 1.0, 'time@10': 2.7235}:  73%|███████▎  | 22/30 [00:41<00:16,  2.07s/it]{'epoch': 18, 'num_users': 6.1304, 'loss': 66.377, 'hit_ratio@10': 0.267, 'ndcg@10': 1.5284786597998353e+24, 'compress@10': 1.0, 'time@10': 2.7226}:  73%|███████▎  | 22/30 [00:43<00:16,  2.07s/it]  {'epoch': 18, 'num_users': 6.1304, 'loss': 66.377, 'hit_ratio@10': 0.267, 'ndcg@10': 1.5284786597998353e+24, 'compress@10': 1.0, 'time@10': 2.7226}:  77%|███████▋  | 23/30 [00:43<00:13,  1.86s/it]{'epoch': 18, 'num_users': 5.9583, 'loss': 63.7728, 'hit_ratio@10': 0.2559, 'ndcg@10': 1.4647920489748423e+24, 'compress@10': 1.0, 'time@10': 2.6206}:  77%|███████▋  | 23/30 [00:43<00:13,  1.86s/it]{'epoch': 18, 'num_users': 5.9583, 'loss': 63.7728, 'hit_ratio@10': 0.2559, 'ndcg@10': 1.4647920489748423e+24, 'compress@10': 1.0, 'time@10': 2.6206}:  80%|████████  | 24/30 [00:43<00:08,  1.39s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 61.4502, 'hit_ratio@10': 0.259, 'ndcg@10': 1.4062003670158487e+24, 'compress@10': 1.0, 'time@10': 2.5268}:  80%|████████  | 24/30 [00:43<00:08,  1.39s/it]    {'epoch': 18, 'num_users': 5.8, 'loss': 61.4502, 'hit_ratio@10': 0.259, 'ndcg@10': 1.4062003670158487e+24, 'compress@10': 1.0, 'time@10': 2.5268}:  83%|████████▎ | 25/30 [00:43<00:05,  1.03s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 59.1438, 'hit_ratio@10': 0.2654, 'ndcg@10': 1.352115737515239e+24, 'compress@10': 1.0, 'time@10': 2.6486}:  83%|████████▎ | 25/30 [00:49<00:05,  1.03s/it]{'epoch': 18, 'num_users': 5.8077, 'loss': 59.1438, 'hit_ratio@10': 0.2654, 'ndcg@10': 1.352115737515239e+24, 'compress@10': 1.0, 'time@10': 2.6486}:  87%|████████▋ | 26/30 [00:49<00:09,  2.44s/it]{'epoch': 18, 'num_users': 5.8889, 'loss': 56.9563, 'hit_ratio@10': 0.2887, 'ndcg@10': 1.3020373768665265e+24, 'compress@10': 1.0, 'time@10': 2.6965}:  87%|████████▋ | 26/30 [00:51<00:09,  2.44s/it]{'epoch': 18, 'num_users': 5.8889, 'loss': 56.9563, 'hit_ratio@10': 0.2887, 'ndcg@10': 1.3020373768665265e+24, 'compress@10': 1.0, 'time@10': 2.6965}:  90%|█████████ | 27/30 [00:51<00:06,  2.31s/it]{'epoch': 18, 'num_users': 6.0, 'loss': 56.2418, 'hit_ratio@10': 0.2896, 'ndcg@10': 1.2555360419784362e+24, 'compress@10': 1.0, 'time@10': 2.732}:  90%|█████████ | 27/30 [00:55<00:06,  2.31s/it]    {'epoch': 18, 'num_users': 6.0, 'loss': 56.2418, 'hit_ratio@10': 0.2896, 'ndcg@10': 1.2555360419784362e+24, 'compress@10': 1.0, 'time@10': 2.732}:  93%|█████████▎| 28/30 [00:55<00:05,  2.73s/it]{'epoch': 18, 'num_users': 5.8621, 'loss': 117.2636, 'hit_ratio@10': 0.2811, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.737}:  93%|█████████▎| 28/30 [00:56<00:05,  2.73s/it]               {'epoch': 18, 'num_users': 5.8621, 'loss': 117.2636, 'hit_ratio@10': 0.2811, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.737}:  97%|█████████▋| 29/30 [00:56<00:02,  2.35s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 113.3685, 'hit_ratio@10': 0.2952, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7309}:  97%|█████████▋| 29/30 [00:59<00:02,  2.35s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 113.3685, 'hit_ratio@10': 0.2952, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7309}: 100%|██████████| 30/30 [00:59<00:00,  2.42s/it]{'epoch': 18, 'num_users': 5.8667, 'loss': 113.3685, 'hit_ratio@10': 0.2952, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7309}: 100%|██████████| 30/30 [00:59<00:00,  1.98s/it]
Epoch: 18
Avg # of users: 5.866666666666666
Avg Loss: 113.3685326505586
Avg hit ratio: 0.29519158615752433
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7308730443318683
Std train time: 1.6994557701545525
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 5.246, 'hit_ratio@10': 0.2105, 'ndcg@10': 20.8615, 'compress@10': 1.0, 'time@10': 2.523}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 5.246, 'hit_ratio@10': 0.2105, 'ndcg@10': 20.8615, 'compress@10': 1.0, 'time@10': 2.523}:   3%|▎         | 1/30 [00:01<00:37,  1.31s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 5.2285, 'hit_ratio@10': 0.2504, 'ndcg@10': 15.8158, 'compress@10': 1.0, 'time@10': 2.354}:   3%|▎         | 1/30 [00:03<00:37,  1.31s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 5.2285, 'hit_ratio@10': 0.2504, 'ndcg@10': 15.8158, 'compress@10': 1.0, 'time@10': 2.354}:   7%|▋         | 2/30 [00:03<00:51,  1.84s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 3.6854, 'hit_ratio@10': 0.3574, 'ndcg@10': 11.0547, 'compress@10': 1.0, 'time@10': 1.8369}:   7%|▋         | 2/30 [00:03<00:51,  1.84s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 3.6854, 'hit_ratio@10': 0.3574, 'ndcg@10': 11.0547, 'compress@10': 1.0, 'time@10': 1.8369}:  10%|█         | 3/30 [00:03<00:32,  1.20s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 2.8727, 'hit_ratio@10': 0.3931, 'ndcg@10': 8.4838, 'compress@10': 1.0, 'time@10': 1.8615}:  10%|█         | 3/30 [00:05<00:32,  1.20s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 2.8727, 'hit_ratio@10': 0.3931, 'ndcg@10': 8.4838, 'compress@10': 1.0, 'time@10': 1.8615}:  13%|█▎        | 4/30 [00:05<00:39,  1.50s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 3.2761, 'hit_ratio@10': 0.4025, 'ndcg@10': 9.2261, 'compress@10': 1.0, 'time@10': 2.9399}:  13%|█▎        | 4/30 [00:09<00:39,  1.50s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 3.2761, 'hit_ratio@10': 0.4025, 'ndcg@10': 9.2261, 'compress@10': 1.0, 'time@10': 2.9399}:  17%|█▋        | 5/30 [00:09<00:56,  2.28s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 3.2329, 'hit_ratio@10': 0.3946, 'ndcg@10': 8.3944, 'compress@10': 1.0, 'time@10': 2.9801}:  17%|█▋        | 5/30 [00:12<00:56,  2.28s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 3.2329, 'hit_ratio@10': 0.3946, 'ndcg@10': 8.3944, 'compress@10': 1.0, 'time@10': 2.9801}:  20%|██        | 6/30 [00:12<01:03,  2.65s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 113.7132, 'hit_ratio@10': 0.3783, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0629}:  20%|██        | 6/30 [00:14<01:03,  2.65s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 113.7132, 'hit_ratio@10': 0.3783, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0629}:  23%|██▎       | 7/30 [00:14<00:54,  2.37s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 104.1157, 'hit_ratio@10': 0.356, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9803}:  23%|██▎       | 7/30 [00:17<00:54,  2.37s/it]  {'epoch': 19, 'num_users': 6.125, 'loss': 104.1157, 'hit_ratio@10': 0.356, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9803}:  27%|██▋       | 8/30 [00:17<00:52,  2.39s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 96.0848, 'hit_ratio@10': 0.3259, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2193}:  27%|██▋       | 8/30 [00:19<00:52,  2.39s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 96.0848, 'hit_ratio@10': 0.3259, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2193}:  30%|███       | 9/30 [00:19<00:51,  2.46s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 91.7736, 'hit_ratio@10': 0.3297, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.208}:  30%|███       | 9/30 [00:22<00:51,  2.46s/it]    {'epoch': 19, 'num_users': 6.3, 'loss': 91.7736, 'hit_ratio@10': 0.3297, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.208}:  33%|███▎      | 10/30 [00:22<00:53,  2.67s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 90.8705, 'hit_ratio@10': 0.3207, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2513}:  33%|███▎      | 10/30 [00:24<00:53,  2.67s/it]{'epoch': 19, 'num_users': 6.6364, 'loss': 90.8705, 'hit_ratio@10': 0.3207, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2513}:  37%|███▋      | 11/30 [00:24<00:46,  2.42s/it]{'epoch': 19, 'num_users': 6.4167, 'loss': 98.1539, 'hit_ratio@10': 0.3148, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0439}:  37%|███▋      | 11/30 [00:25<00:46,  2.42s/it]{'epoch': 19, 'num_users': 6.4167, 'loss': 98.1539, 'hit_ratio@10': 0.3148, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0439}:  40%|████      | 12/30 [00:25<00:34,  1.93s/it]{'epoch': 19, 'num_users': 6.6154, 'loss': 90.9662, 'hit_ratio@10': 0.3291, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0445}:  40%|████      | 12/30 [00:27<00:34,  1.93s/it]{'epoch': 19, 'num_users': 6.6154, 'loss': 90.9662, 'hit_ratio@10': 0.3291, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0445}:  43%|████▎     | 13/30 [00:27<00:31,  1.83s/it]{'epoch': 19, 'num_users': 6.3571, 'loss': 84.8521, 'hit_ratio@10': 0.3294, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8494}:  43%|████▎     | 13/30 [00:27<00:31,  1.83s/it]{'epoch': 19, 'num_users': 6.3571, 'loss': 84.8521, 'hit_ratio@10': 0.3294, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8494}:  47%|████▋     | 14/30 [00:27<00:22,  1.38s/it]{'epoch': 19, 'num_users': 6.2667, 'loss': 79.3815, 'hit_ratio@10': 0.3182, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9415}:  47%|████▋     | 14/30 [00:29<00:22,  1.38s/it]{'epoch': 19, 'num_users': 6.2667, 'loss': 79.3815, 'hit_ratio@10': 0.3182, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9415}:  50%|█████     | 15/30 [00:29<00:24,  1.61s/it]{'epoch': 19, 'num_users': 6.0625, 'loss': 105.78, 'hit_ratio@10': 0.3087, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8045}:  50%|█████     | 15/30 [00:30<00:24,  1.61s/it] {'epoch': 19, 'num_users': 6.0625, 'loss': 105.78, 'hit_ratio@10': 0.3087, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8045}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it]{'epoch': 19, 'num_users': 5.8235, 'loss': 103.863, 'hit_ratio@10': 0.3141, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6725}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it]{'epoch': 19, 'num_users': 5.8235, 'loss': 103.863, 'hit_ratio@10': 0.3141, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6725}:  57%|█████▋    | 17/30 [00:30<00:13,  1.05s/it]{'epoch': 19, 'num_users': 6.0556, 'loss': 107.9298, 'hit_ratio@10': 0.3105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6335}:  57%|█████▋    | 17/30 [00:32<00:13,  1.05s/it]{'epoch': 19, 'num_users': 6.0556, 'loss': 107.9298, 'hit_ratio@10': 0.3105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6335}:  60%|██████    | 18/30 [00:32<00:15,  1.33s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 193.6127, 'hit_ratio@10': 0.313, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5899}:  60%|██████    | 18/30 [00:33<00:15,  1.33s/it]    {'epoch': 19, 'num_users': 6.0, 'loss': 193.6127, 'hit_ratio@10': 0.313, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5899}:  63%|██████▎   | 19/30 [00:33<00:13,  1.21s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 184.3456, 'hit_ratio@10': 0.3192, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6725}:  63%|██████▎   | 19/30 [00:37<00:13,  1.21s/it]{'epoch': 19, 'num_users': 6.15, 'loss': 184.3456, 'hit_ratio@10': 0.3192, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6725}:  67%|██████▋   | 20/30 [00:37<00:21,  2.13s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 180.1622, 'hit_ratio@10': 0.31, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8359}:  67%|██████▋   | 20/30 [00:41<00:21,  2.13s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 180.1622, 'hit_ratio@10': 0.31, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8359}:  70%|███████   | 21/30 [00:41<00:21,  2.42s/it]{'epoch': 19, 'num_users': 6.1818, 'loss': 171.9985, 'hit_ratio@10': 0.3104, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7723}:  70%|███████   | 21/30 [00:42<00:21,  2.42s/it]{'epoch': 19, 'num_users': 6.1818, 'loss': 171.9985, 'hit_ratio@10': 0.3104, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7723}:  73%|███████▎  | 22/30 [00:42<00:17,  2.13s/it]{'epoch': 19, 'num_users': 6.1304, 'loss': 164.7145, 'hit_ratio@10': 0.3077, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7705}:  73%|███████▎  | 22/30 [00:43<00:17,  2.13s/it]{'epoch': 19, 'num_users': 6.1304, 'loss': 164.7145, 'hit_ratio@10': 0.3077, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7705}:  77%|███████▋  | 23/30 [00:43<00:13,  1.91s/it]{'epoch': 19, 'num_users': 5.9583, 'loss': 160.9274, 'hit_ratio@10': 0.3033, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6666}:  77%|███████▋  | 23/30 [00:44<00:13,  1.91s/it]{'epoch': 19, 'num_users': 5.9583, 'loss': 160.9274, 'hit_ratio@10': 0.3033, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6666}:  80%|████████  | 24/30 [00:44<00:08,  1.43s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 154.7747, 'hit_ratio@10': 0.3045, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5711}:  80%|████████  | 24/30 [00:44<00:08,  1.43s/it]   {'epoch': 19, 'num_users': 5.8, 'loss': 154.7747, 'hit_ratio@10': 0.3045, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5711}:  83%|████████▎ | 25/30 [00:44<00:05,  1.05s/it]{'epoch': 19, 'num_users': 5.8077, 'loss': 148.8447, 'hit_ratio@10': 0.3049, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6947}:  83%|████████▎ | 25/30 [00:50<00:05,  1.05s/it]{'epoch': 19, 'num_users': 5.8077, 'loss': 148.8447, 'hit_ratio@10': 0.3049, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6947}:  87%|████████▋ | 26/30 [00:50<00:09,  2.48s/it]{'epoch': 19, 'num_users': 5.8889, 'loss': 152.8538, 'hit_ratio@10': 0.3016, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7497}:  87%|████████▋ | 26/30 [00:52<00:09,  2.48s/it]{'epoch': 19, 'num_users': 5.8889, 'loss': 152.8538, 'hit_ratio@10': 0.3016, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7497}:  90%|█████████ | 27/30 [00:52<00:07,  2.37s/it]{'epoch': 19, 'num_users': 6.0, 'loss': 147.4148, 'hit_ratio@10': 0.309, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7818}:  90%|█████████ | 27/30 [00:56<00:07,  2.37s/it]    {'epoch': 19, 'num_users': 6.0, 'loss': 147.4148, 'hit_ratio@10': 0.309, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7818}:  93%|█████████▎| 28/30 [00:56<00:05,  2.76s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 142.3835, 'hit_ratio@10': 0.314, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7841}:  93%|█████████▎| 28/30 [00:57<00:05,  2.76s/it]{'epoch': 19, 'num_users': 5.8621, 'loss': 142.3835, 'hit_ratio@10': 0.314, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7841}:  97%|█████████▋| 29/30 [00:57<00:02,  2.37s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 140.8451, 'hit_ratio@10': 0.309, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7768}:  97%|█████████▋| 29/30 [01:00<00:02,  2.37s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 140.8451, 'hit_ratio@10': 0.309, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7768}: 100%|██████████| 30/30 [01:00<00:00,  2.44s/it]{'epoch': 19, 'num_users': 5.8667, 'loss': 140.8451, 'hit_ratio@10': 0.309, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7768}: 100%|██████████| 30/30 [01:00<00:00,  2.00s/it]
Epoch: 19
Avg # of users: 5.866666666666666
Avg Loss: 140.84514305874956
Avg hit ratio: 0.30897893830996775
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7768169323603313
Std train time: 1.7767527004067722
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.4235, 'hit_ratio@10': 0.3158, 'ndcg@10': 0.5389, 'compress@10': 1.0, 'time@10': 2.7517}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.4235, 'hit_ratio@10': 0.3158, 'ndcg@10': 0.5389, 'compress@10': 1.0, 'time@10': 2.7517}:   3%|▎         | 1/30 [00:01<00:41,  1.41s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.4164, 'hit_ratio@10': 0.3031, 'ndcg@10': 0.5499, 'compress@10': 1.0, 'time@10': 2.4605}:   3%|▎         | 1/30 [00:03<00:41,  1.41s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.4164, 'hit_ratio@10': 0.3031, 'ndcg@10': 0.5499, 'compress@10': 1.0, 'time@10': 2.4605}:   7%|▋         | 2/30 [00:03<00:52,  1.88s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 1594.544, 'hit_ratio@10': 0.202, 'ndcg@10': 38991267129629.62, 'compress@10': 1.0, 'time@10': 1.894}:   7%|▋         | 2/30 [00:04<00:52,  1.88s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 1594.544, 'hit_ratio@10': 0.202, 'ndcg@10': 38991267129629.62, 'compress@10': 1.0, 'time@10': 1.894}:  10%|█         | 3/30 [00:04<00:32,  1.21s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 1196.0062, 'hit_ratio@10': 0.2676, 'ndcg@10': 29243450347222.348, 'compress@10': 1.0, 'time@10': 1.8631}:  10%|█         | 3/30 [00:05<00:32,  1.21s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 1196.0062, 'hit_ratio@10': 0.2676, 'ndcg@10': 29243450347222.348, 'compress@10': 1.0, 'time@10': 1.8631}:  13%|█▎        | 4/30 [00:05<00:37,  1.44s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 956.8658, 'hit_ratio@10': 0.3301, 'ndcg@10': 23394760277777.977, 'compress@10': 1.0, 'time@10': 2.8965}:  13%|█▎        | 4/30 [00:09<00:37,  1.44s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 956.8658, 'hit_ratio@10': 0.3301, 'ndcg@10': 23394760277777.977, 'compress@10': 1.0, 'time@10': 2.8965}:  17%|█▋        | 5/30 [00:09<00:54,  2.20s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 797.893, 'hit_ratio@10': 0.3454, 'ndcg@10': 19495633564815.94, 'compress@10': 1.0, 'time@10': 2.9383}:  17%|█▋        | 5/30 [00:12<00:54,  2.20s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 797.893, 'hit_ratio@10': 0.3454, 'ndcg@10': 19495633564815.94, 'compress@10': 1.0, 'time@10': 2.9383}:  20%|██        | 6/30 [00:12<01:00,  2.53s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 804.5513, 'hit_ratio@10': 0.3247, 'ndcg@10': 1.3907665058437066e+29, 'compress@10': 1.0, 'time@10': 2.9794}:  20%|██        | 6/30 [00:14<01:00,  2.53s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 804.5513, 'hit_ratio@10': 0.3247, 'ndcg@10': 1.3907665058437066e+29, 'compress@10': 1.0, 'time@10': 2.9794}:  23%|██▎       | 7/30 [00:14<00:51,  2.24s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 704.3466, 'hit_ratio@10': 0.3484, 'ndcg@10': 1.2169206926132432e+29, 'compress@10': 1.0, 'time@10': 2.884}:  23%|██▎       | 7/30 [00:16<00:51,  2.24s/it]  {'epoch': 20, 'num_users': 6.125, 'loss': 704.3466, 'hit_ratio@10': 0.3484, 'ndcg@10': 1.2169206926132432e+29, 'compress@10': 1.0, 'time@10': 2.884}:  27%|██▋       | 8/30 [00:16<00:49,  2.24s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 629.3729, 'hit_ratio@10': 0.3414, 'ndcg@10': 1.0817072823228829e+29, 'compress@10': 1.0, 'time@10': 3.1002}:  27%|██▋       | 8/30 [00:18<00:49,  2.24s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 629.3729, 'hit_ratio@10': 0.3414, 'ndcg@10': 1.0817072823228829e+29, 'compress@10': 1.0, 'time@10': 3.1002}:  30%|███       | 9/30 [00:18<00:48,  2.31s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 596.7163, 'hit_ratio@10': 0.3254, 'ndcg@10': 9.748013566789896e+28, 'compress@10': 1.0, 'time@10': 3.091}:  30%|███       | 9/30 [00:21<00:48,  2.31s/it]     {'epoch': 20, 'num_users': 6.3, 'loss': 596.7163, 'hit_ratio@10': 0.3254, 'ndcg@10': 9.748013566789896e+28, 'compress@10': 1.0, 'time@10': 3.091}:  33%|███▎      | 10/30 [00:21<00:50,  2.53s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 545.1114, 'hit_ratio@10': 0.3029, 'ndcg@10': 8.861830515263541e+28, 'compress@10': 1.0, 'time@10': 3.1447}:  33%|███▎      | 10/30 [00:23<00:50,  2.53s/it]{'epoch': 20, 'num_users': 6.6364, 'loss': 545.1114, 'hit_ratio@10': 0.3029, 'ndcg@10': 8.861830515263541e+28, 'compress@10': 1.0, 'time@10': 3.1447}:  37%|███▋      | 11/30 [00:23<00:44,  2.33s/it]{'epoch': 20, 'num_users': 6.4167, 'loss': 515.7937, 'hit_ratio@10': 0.2846, 'ndcg@10': 8.12334463899158e+28, 'compress@10': 1.0, 'time@10': 2.9456}:  37%|███▋      | 11/30 [00:24<00:44,  2.33s/it] {'epoch': 20, 'num_users': 6.4167, 'loss': 515.7937, 'hit_ratio@10': 0.2846, 'ndcg@10': 8.12334463899158e+28, 'compress@10': 1.0, 'time@10': 2.9456}:  40%|████      | 12/30 [00:24<00:33,  1.86s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 523.6698, 'hit_ratio@10': 0.2767, 'ndcg@10': 7.530251776706927e+28, 'compress@10': 1.0, 'time@10': 2.9531}:  40%|████      | 12/30 [00:26<00:33,  1.86s/it]{'epoch': 20, 'num_users': 6.6154, 'loss': 523.6698, 'hit_ratio@10': 0.2767, 'ndcg@10': 7.530251776706927e+28, 'compress@10': 1.0, 'time@10': 2.9531}:  43%|████▎     | 13/30 [00:26<00:30,  1.77s/it]{'epoch': 20, 'num_users': 6.3571, 'loss': 630.4519, 'hit_ratio@10': 0.2569, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7679}:  43%|████▎     | 13/30 [00:26<00:30,  1.77s/it]                  {'epoch': 20, 'num_users': 6.3571, 'loss': 630.4519, 'hit_ratio@10': 0.2569, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7679}:  47%|████▋     | 14/30 [00:26<00:21,  1.35s/it]{'epoch': 20, 'num_users': 6.2667, 'loss': 614.2915, 'hit_ratio@10': 0.2548, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8651}:  47%|████▋     | 14/30 [00:28<00:21,  1.35s/it]{'epoch': 20, 'num_users': 6.2667, 'loss': 614.2915, 'hit_ratio@10': 0.2548, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8651}:  50%|█████     | 15/30 [00:28<00:23,  1.59s/it]{'epoch': 20, 'num_users': 6.0625, 'loss': 576.0052, 'hit_ratio@10': 0.2649, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.734}:  50%|█████     | 15/30 [00:29<00:23,  1.59s/it] {'epoch': 20, 'num_users': 6.0625, 'loss': 576.0052, 'hit_ratio@10': 0.2649, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.734}:  53%|█████▎    | 16/30 [00:29<00:18,  1.35s/it]{'epoch': 20, 'num_users': 5.8235, 'loss': 545.3949, 'hit_ratio@10': 0.2494, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6051}:  53%|█████▎    | 16/30 [00:29<00:18,  1.35s/it]{'epoch': 20, 'num_users': 5.8235, 'loss': 545.3949, 'hit_ratio@10': 0.2494, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6051}:  57%|█████▋    | 17/30 [00:29<00:13,  1.04s/it]{'epoch': 20, 'num_users': 6.0556, 'loss': 522.0083, 'hit_ratio@10': 0.2494, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5713}:  57%|█████▋    | 17/30 [00:31<00:13,  1.04s/it]{'epoch': 20, 'num_users': 6.0556, 'loss': 522.0083, 'hit_ratio@10': 0.2494, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5713}:  60%|██████    | 18/30 [00:31<00:16,  1.33s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 494.6694, 'hit_ratio@10': 0.2701, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5322}:  60%|██████    | 18/30 [00:32<00:16,  1.33s/it]   {'epoch': 20, 'num_users': 6.0, 'loss': 494.6694, 'hit_ratio@10': 0.2701, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5322}:  63%|██████▎   | 19/30 [00:32<00:13,  1.22s/it]{'epoch': 20, 'num_users': 6.15, 'loss': 469.9527, 'hit_ratio@10': 0.2733, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6088}:  63%|██████▎   | 19/30 [00:36<00:13,  1.22s/it]{'epoch': 20, 'num_users': 6.15, 'loss': 469.9527, 'hit_ratio@10': 0.2733, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6088}:  67%|██████▋   | 20/30 [00:36<00:20,  2.08s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 449.3571, 'hit_ratio@10': 0.265, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7646}:  67%|██████▋   | 20/30 [00:39<00:20,  2.08s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 449.3571, 'hit_ratio@10': 0.265, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7646}:  70%|███████   | 21/30 [00:39<00:21,  2.35s/it]{'epoch': 20, 'num_users': 6.1818, 'loss': 429.1197, 'hit_ratio@10': 0.2654, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7066}:  70%|███████   | 21/30 [00:41<00:21,  2.35s/it]{'epoch': 20, 'num_users': 6.1818, 'loss': 429.1197, 'hit_ratio@10': 0.2654, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7066}:  73%|███████▎  | 22/30 [00:41<00:16,  2.10s/it]{'epoch': 20, 'num_users': 6.1304, 'loss': 410.5063, 'hit_ratio@10': 0.2734, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7056}:  73%|███████▎  | 22/30 [00:42<00:16,  2.10s/it]{'epoch': 20, 'num_users': 6.1304, 'loss': 410.5063, 'hit_ratio@10': 0.2734, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7056}:  77%|███████▋  | 23/30 [00:42<00:13,  1.88s/it]{'epoch': 20, 'num_users': 5.9583, 'loss': 396.332, 'hit_ratio@10': 0.2787, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.604}:  77%|███████▋  | 23/30 [00:42<00:13,  1.88s/it]  {'epoch': 20, 'num_users': 5.9583, 'loss': 396.332, 'hit_ratio@10': 0.2787, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.604}:  80%|████████  | 24/30 [00:42<00:08,  1.41s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 387.4815, 'hit_ratio@10': 0.2675, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5102}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 387.4815, 'hit_ratio@10': 0.2675, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5102}:  83%|████████▎ | 25/30 [00:43<00:05,  1.03s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 373.2225, 'hit_ratio@10': 0.269, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6304}:  83%|████████▎ | 25/30 [00:48<00:05,  1.03s/it]{'epoch': 20, 'num_users': 5.8077, 'loss': 373.2225, 'hit_ratio@10': 0.269, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6304}:  87%|████████▋ | 26/30 [00:48<00:09,  2.42s/it]{'epoch': 20, 'num_users': 5.8889, 'loss': 362.4361, 'hit_ratio@10': 0.263, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6789}:  87%|████████▋ | 26/30 [00:50<00:09,  2.42s/it]{'epoch': 20, 'num_users': 5.8889, 'loss': 362.4361, 'hit_ratio@10': 0.263, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6789}:  90%|█████████ | 27/30 [00:50<00:06,  2.30s/it]{'epoch': 20, 'num_users': 6.0, 'loss': 349.5674, 'hit_ratio@10': 0.2725, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7124}:  90%|█████████ | 27/30 [00:54<00:06,  2.30s/it]  {'epoch': 20, 'num_users': 6.0, 'loss': 349.5674, 'hit_ratio@10': 0.2725, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7124}:  93%|█████████▎| 28/30 [00:54<00:05,  2.70s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 337.528, 'hit_ratio@10': 0.2772, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7149}:  93%|█████████▎| 28/30 [00:55<00:05,  2.70s/it]{'epoch': 20, 'num_users': 5.8621, 'loss': 337.528, 'hit_ratio@10': 0.2772, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7149}:  97%|█████████▋| 29/30 [00:55<00:02,  2.32s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 326.3652, 'hit_ratio@10': 0.2824, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7105}:  97%|█████████▋| 29/30 [00:58<00:02,  2.32s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 326.3652, 'hit_ratio@10': 0.2824, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7105}: 100%|██████████| 30/30 [00:58<00:00,  2.41s/it]{'epoch': 20, 'num_users': 5.8667, 'loss': 326.3652, 'hit_ratio@10': 0.2824, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7105}: 100%|██████████| 30/30 [00:58<00:00,  1.95s/it]
Epoch: 20
Avg # of users: 5.866666666666666
Avg Loss: 326.36515295240565
Avg hit ratio: 0.28236198813599894
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7104861815770467
Std train time: 1.709264441580068
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 16.1067, 'hit_ratio@10': 0.2105, 'ndcg@10': 1252.4632, 'compress@10': 1.0, 'time@10': 2.5675}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 16.1067, 'hit_ratio@10': 0.2105, 'ndcg@10': 1252.4632, 'compress@10': 1.0, 'time@10': 2.5675}:   3%|▎         | 1/30 [00:01<00:38,  1.31s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 8.2206, 'hit_ratio@10': 0.202, 'ndcg@10': 626.4938, 'compress@10': 1.0, 'time@10': 2.3466}:   3%|▎         | 1/30 [00:03<00:38,  1.31s/it]   {'epoch': 21, 'num_users': 7.0, 'loss': 8.2206, 'hit_ratio@10': 0.202, 'ndcg@10': 626.4938, 'compress@10': 1.0, 'time@10': 2.3466}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 125.762, 'hit_ratio@10': 0.1347, 'ndcg@10': 3149256496927012.5, 'compress@10': 1.0, 'time@10': 1.8328}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 125.762, 'hit_ratio@10': 0.1347, 'ndcg@10': 3149256496927012.5, 'compress@10': 1.0, 'time@10': 1.8328}:  10%|█         | 3/30 [00:03<00:31,  1.18s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 94.4173, 'hit_ratio@10': 0.1992, 'ndcg@10': 2361942372695259.5, 'compress@10': 1.0, 'time@10': 1.8449}:  10%|█         | 3/30 [00:05<00:31,  1.18s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 94.4173, 'hit_ratio@10': 0.1992, 'ndcg@10': 2361942372695259.5, 'compress@10': 1.0, 'time@10': 1.8449}:  13%|█▎        | 4/30 [00:05<00:38,  1.47s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 75.5968, 'hit_ratio@10': 0.2674, 'ndcg@10': 1889553898156207.2, 'compress@10': 1.0, 'time@10': 2.9277}:  13%|█▎        | 4/30 [00:09<00:38,  1.47s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 75.5968, 'hit_ratio@10': 0.2674, 'ndcg@10': 1889553898156207.2, 'compress@10': 1.0, 'time@10': 2.9277}:  17%|█▋        | 5/30 [00:09<00:56,  2.26s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 63.0537, 'hit_ratio@10': 0.271, 'ndcg@10': 1574628248463506.2, 'compress@10': 1.0, 'time@10': 2.9577}:  17%|█▋        | 5/30 [00:12<00:56,  2.26s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 63.0537, 'hit_ratio@10': 0.271, 'ndcg@10': 1574628248463506.2, 'compress@10': 1.0, 'time@10': 2.9577}:  20%|██        | 6/30 [00:12<01:01,  2.56s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 54.1191, 'hit_ratio@10': 0.2951, 'ndcg@10': 1349681355825862.5, 'compress@10': 1.0, 'time@10': 2.9906}:  20%|██        | 6/30 [00:14<01:01,  2.56s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 54.1191, 'hit_ratio@10': 0.2951, 'ndcg@10': 1349681355825862.5, 'compress@10': 1.0, 'time@10': 2.9906}:  23%|██▎       | 7/30 [00:14<00:51,  2.25s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 47.9456, 'hit_ratio@10': 0.2689, 'ndcg@10': 1180971186347631.2, 'compress@10': 1.0, 'time@10': 2.9086}:  23%|██▎       | 7/30 [00:16<00:51,  2.25s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 47.9456, 'hit_ratio@10': 0.2689, 'ndcg@10': 1180971186347631.2, 'compress@10': 1.0, 'time@10': 2.9086}:  27%|██▋       | 8/30 [00:16<00:50,  2.29s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 42.6545, 'hit_ratio@10': 0.2708, 'ndcg@10': 1049752165642338.9, 'compress@10': 1.0, 'time@10': 3.125}:  27%|██▋       | 8/30 [00:19<00:50,  2.29s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 42.6545, 'hit_ratio@10': 0.2708, 'ndcg@10': 1049752165642338.9, 'compress@10': 1.0, 'time@10': 3.125}:  30%|███       | 9/30 [00:19<00:49,  2.34s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 38.4161, 'hit_ratio@10': 0.2824, 'ndcg@10': 944776949078105.1, 'compress@10': 1.0, 'time@10': 3.1139}:  30%|███       | 9/30 [00:22<00:49,  2.34s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 38.4161, 'hit_ratio@10': 0.2824, 'ndcg@10': 944776949078105.1, 'compress@10': 1.0, 'time@10': 3.1139}:  33%|███▎      | 10/30 [00:22<00:51,  2.56s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 34.9637, 'hit_ratio@10': 0.3091, 'ndcg@10': 858888135525550.0, 'compress@10': 1.0, 'time@10': 3.1472}:  33%|███▎      | 10/30 [00:23<00:51,  2.56s/it]{'epoch': 21, 'num_users': 6.6364, 'loss': 34.9637, 'hit_ratio@10': 0.3091, 'ndcg@10': 858888135525550.0, 'compress@10': 1.0, 'time@10': 3.1472}:  37%|███▋      | 11/30 [00:23<00:44,  2.32s/it]{'epoch': 21, 'num_users': 6.4167, 'loss': 33.7149, 'hit_ratio@10': 0.3042, 'ndcg@10': 787314124231776.0, 'compress@10': 1.0, 'time@10': 2.9442}:  37%|███▋      | 11/30 [00:24<00:44,  2.32s/it]{'epoch': 21, 'num_users': 6.4167, 'loss': 33.7149, 'hit_ratio@10': 0.3042, 'ndcg@10': 787314124231776.0, 'compress@10': 1.0, 'time@10': 2.9442}:  40%|████      | 12/30 [00:24<00:33,  1.84s/it]{'epoch': 21, 'num_users': 6.6154, 'loss': 31.295, 'hit_ratio@10': 0.2948, 'ndcg@10': 726751499290872.1, 'compress@10': 1.0, 'time@10': 2.9428}:  40%|████      | 12/30 [00:26<00:33,  1.84s/it] {'epoch': 21, 'num_users': 6.6154, 'loss': 31.295, 'hit_ratio@10': 0.2948, 'ndcg@10': 726751499290872.1, 'compress@10': 1.0, 'time@10': 2.9428}:  43%|████▎     | 13/30 [00:26<00:29,  1.73s/it]{'epoch': 21, 'num_users': 6.3571, 'loss': 29.859, 'hit_ratio@10': 0.2856, 'ndcg@10': 674840677912966.0, 'compress@10': 1.0, 'time@10': 2.7564}:  43%|████▎     | 13/30 [00:26<00:29,  1.73s/it]{'epoch': 21, 'num_users': 6.3571, 'loss': 29.859, 'hit_ratio@10': 0.2856, 'ndcg@10': 674840677912966.0, 'compress@10': 1.0, 'time@10': 2.7564}:  47%|████▋     | 14/30 [00:26<00:21,  1.33s/it]{'epoch': 21, 'num_users': 6.2667, 'loss': 27.9006, 'hit_ratio@10': 0.2924, 'ndcg@10': 629851299385434.9, 'compress@10': 1.0, 'time@10': 2.8497}:  47%|████▋     | 14/30 [00:28<00:21,  1.33s/it]{'epoch': 21, 'num_users': 6.2667, 'loss': 27.9006, 'hit_ratio@10': 0.2924, 'ndcg@10': 629851299385434.9, 'compress@10': 1.0, 'time@10': 2.8497}:  50%|█████     | 15/30 [00:28<00:23,  1.56s/it]{'epoch': 21, 'num_users': 6.0625, 'loss': 26.1803, 'hit_ratio@10': 0.3002, 'ndcg@10': 590485593173845.2, 'compress@10': 1.0, 'time@10': 2.7181}:  50%|█████     | 15/30 [00:29<00:23,  1.56s/it]{'epoch': 21, 'num_users': 6.0625, 'loss': 26.1803, 'hit_ratio@10': 0.3002, 'ndcg@10': 590485593173845.2, 'compress@10': 1.0, 'time@10': 2.7181}:  53%|█████▎    | 16/30 [00:29<00:18,  1.33s/it]{'epoch': 21, 'num_users': 5.8235, 'loss': 24.6909, 'hit_ratio@10': 0.306, 'ndcg@10': 555751146516560.3, 'compress@10': 1.0, 'time@10': 2.5904}:  53%|█████▎    | 16/30 [00:29<00:18,  1.33s/it] {'epoch': 21, 'num_users': 5.8235, 'loss': 24.6909, 'hit_ratio@10': 0.306, 'ndcg@10': 555751146516560.3, 'compress@10': 1.0, 'time@10': 2.5904}:  57%|█████▋    | 17/30 [00:29<00:13,  1.02s/it]{'epoch': 21, 'num_users': 6.0556, 'loss': 23.3759, 'hit_ratio@10': 0.3148, 'ndcg@10': 524876082821195.75, 'compress@10': 1.0, 'time@10': 2.5597}:  57%|█████▋    | 17/30 [00:31<00:13,  1.02s/it]{'epoch': 21, 'num_users': 6.0556, 'loss': 23.3759, 'hit_ratio@10': 0.3148, 'ndcg@10': 524876082821195.75, 'compress@10': 1.0, 'time@10': 2.5597}:  60%|██████    | 18/30 [00:31<00:15,  1.33s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 22.1692, 'hit_ratio@10': 0.3171, 'ndcg@10': 497251025830606.6, 'compress@10': 1.0, 'time@10': 2.5206}:  60%|██████    | 18/30 [00:32<00:15,  1.33s/it]    {'epoch': 21, 'num_users': 6.0, 'loss': 22.1692, 'hit_ratio@10': 0.3171, 'ndcg@10': 497251025830606.6, 'compress@10': 1.0, 'time@10': 2.5206}:  63%|██████▎   | 19/30 [00:32<00:13,  1.22s/it]{'epoch': 21, 'num_users': 6.15, 'loss': 21.0774, 'hit_ratio@10': 0.331, 'ndcg@10': 472388474539076.3, 'compress@10': 1.0, 'time@10': 2.6021}:  63%|██████▎   | 19/30 [00:36<00:13,  1.22s/it]{'epoch': 21, 'num_users': 6.15, 'loss': 21.0774, 'hit_ratio@10': 0.331, 'ndcg@10': 472388474539076.3, 'compress@10': 1.0, 'time@10': 2.6021}:  67%|██████▋   | 20/30 [00:36<00:21,  2.11s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 20.0909, 'hit_ratio@10': 0.3307, 'ndcg@10': 449893785275310.75, 'compress@10': 1.0, 'time@10': 2.7566}:  67%|██████▋   | 20/30 [00:39<00:21,  2.11s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 20.0909, 'hit_ratio@10': 0.3307, 'ndcg@10': 449893785275310.75, 'compress@10': 1.0, 'time@10': 2.7566}:  70%|███████   | 21/30 [00:39<00:21,  2.36s/it]{'epoch': 21, 'num_users': 6.1818, 'loss': 97.283, 'hit_ratio@10': 0.324, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6952}:  70%|███████   | 21/30 [00:41<00:21,  2.36s/it]                 {'epoch': 21, 'num_users': 6.1818, 'loss': 97.283, 'hit_ratio@10': 0.324, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6952}:  73%|███████▎  | 22/30 [00:41<00:16,  2.08s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 239.0564, 'hit_ratio@10': 0.3229, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7004}:  73%|███████▎  | 22/30 [00:42<00:16,  2.08s/it]{'epoch': 21, 'num_users': 6.1304, 'loss': 239.0564, 'hit_ratio@10': 0.3229, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7004}:  77%|███████▋  | 23/30 [00:42<00:13,  1.90s/it]{'epoch': 21, 'num_users': 5.9583, 'loss': 229.3082, 'hit_ratio@10': 0.3178, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6005}:  77%|███████▋  | 23/30 [00:43<00:13,  1.90s/it]{'epoch': 21, 'num_users': 5.9583, 'loss': 229.3082, 'hit_ratio@10': 0.3178, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6005}:  80%|████████  | 24/30 [00:43<00:08,  1.43s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 220.9212, 'hit_ratio@10': 0.3184, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5089}:  80%|████████  | 24/30 [00:43<00:08,  1.43s/it]   {'epoch': 21, 'num_users': 5.8, 'loss': 220.9212, 'hit_ratio@10': 0.3184, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5089}:  83%|████████▎ | 25/30 [00:43<00:05,  1.05s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 212.4375, 'hit_ratio@10': 0.3231, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6274}:  83%|████████▎ | 25/30 [00:48<00:05,  1.05s/it]{'epoch': 21, 'num_users': 5.8077, 'loss': 212.4375, 'hit_ratio@10': 0.3231, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6274}:  87%|████████▋ | 26/30 [00:48<00:09,  2.42s/it]{'epoch': 21, 'num_users': 5.8889, 'loss': 204.5836, 'hit_ratio@10': 0.327, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6754}:  87%|████████▋ | 26/30 [00:50<00:09,  2.42s/it] {'epoch': 21, 'num_users': 5.8889, 'loss': 204.5836, 'hit_ratio@10': 0.327, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6754}:  90%|█████████ | 27/30 [00:50<00:06,  2.29s/it]{'epoch': 21, 'num_users': 6.0, 'loss': 197.2951, 'hit_ratio@10': 0.3356, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7096}:  90%|█████████ | 27/30 [00:54<00:06,  2.29s/it]  {'epoch': 21, 'num_users': 6.0, 'loss': 197.2951, 'hit_ratio@10': 0.3356, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7096}:  93%|█████████▎| 28/30 [00:54<00:05,  2.71s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 190.5037, 'hit_ratio@10': 0.3397, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7129}:  93%|█████████▎| 28/30 [00:55<00:05,  2.71s/it]{'epoch': 21, 'num_users': 5.8621, 'loss': 190.5037, 'hit_ratio@10': 0.3397, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7129}:  97%|█████████▋| 29/30 [00:55<00:02,  2.32s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 184.1623, 'hit_ratio@10': 0.3392, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7066}:  97%|█████████▋| 29/30 [00:58<00:02,  2.32s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 184.1623, 'hit_ratio@10': 0.3392, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7066}: 100%|██████████| 30/30 [00:58<00:00,  2.39s/it]{'epoch': 21, 'num_users': 5.8667, 'loss': 184.1623, 'hit_ratio@10': 0.3392, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7066}: 100%|██████████| 30/30 [00:58<00:00,  1.95s/it]
Epoch: 21
Avg # of users: 5.866666666666666
Avg Loss: 184.16234929028002
Avg hit ratio: 0.3391982890669464
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.706643263498942
Std train time: 1.718725441351845
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.2846, 'hit_ratio@10': 0.2105, 'ndcg@10': 0.4514, 'compress@10': 1.0, 'time@10': 2.5953}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.2846, 'hit_ratio@10': 0.2105, 'ndcg@10': 0.4514, 'compress@10': 1.0, 'time@10': 2.5953}:   3%|▎         | 1/30 [00:01<00:38,  1.34s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.2894, 'hit_ratio@10': 0.2343, 'ndcg@10': 0.452, 'compress@10': 1.0, 'time@10': 2.3979}:   3%|▎         | 1/30 [00:03<00:38,  1.34s/it] {'epoch': 22, 'num_users': 7.0, 'loss': 0.2894, 'hit_ratio@10': 0.2343, 'ndcg@10': 0.452, 'compress@10': 1.0, 'time@10': 2.3979}:   7%|▋         | 2/30 [00:03<00:52,  1.86s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 4.6737, 'hit_ratio@10': 0.1562, 'ndcg@10': 19.6738, 'compress@10': 1.0, 'time@10': 1.8656}:   7%|▋         | 2/30 [00:03<00:52,  1.86s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 4.6737, 'hit_ratio@10': 0.1562, 'ndcg@10': 19.6738, 'compress@10': 1.0, 'time@10': 1.8656}:  10%|█         | 3/30 [00:03<00:32,  1.21s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 3.6043, 'hit_ratio@10': 0.1975, 'ndcg@10': 14.8613, 'compress@10': 1.0, 'time@10': 1.8687}:  10%|█         | 3/30 [00:05<00:32,  1.21s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 3.6043, 'hit_ratio@10': 0.1975, 'ndcg@10': 14.8613, 'compress@10': 1.0, 'time@10': 1.8687}:  13%|█▎        | 4/30 [00:05<00:38,  1.48s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 2.9533, 'hit_ratio@10': 0.222, 'ndcg@10': 11.9723, 'compress@10': 1.0, 'time@10': 2.9405}:  13%|█▎        | 4/30 [00:09<00:38,  1.48s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 2.9533, 'hit_ratio@10': 0.222, 'ndcg@10': 11.9723, 'compress@10': 1.0, 'time@10': 2.9405}:  17%|█▋        | 5/30 [00:09<00:56,  2.26s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 2.5087, 'hit_ratio@10': 0.2406, 'ndcg@10': 10.0518, 'compress@10': 1.0, 'time@10': 2.9837}:  17%|█▋        | 5/30 [00:12<00:56,  2.26s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 2.5087, 'hit_ratio@10': 0.2406, 'ndcg@10': 10.0518, 'compress@10': 1.0, 'time@10': 2.9837}:  20%|██        | 6/30 [00:12<01:02,  2.59s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 2.4335, 'hit_ratio@10': 0.2748, 'ndcg@10': 8.9074, 'compress@10': 1.0, 'time@10': 3.0576}:  20%|██        | 6/30 [00:14<01:02,  2.59s/it] {'epoch': 22, 'num_users': 6.2857, 'loss': 2.4335, 'hit_ratio@10': 0.2748, 'ndcg@10': 8.9074, 'compress@10': 1.0, 'time@10': 3.0576}:  23%|██▎       | 7/30 [00:14<00:53,  2.33s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 108.9682, 'hit_ratio@10': 0.2618, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9742}:  23%|██▎       | 7/30 [00:16<00:53,  2.33s/it]  {'epoch': 22, 'num_users': 6.125, 'loss': 108.9682, 'hit_ratio@10': 0.2618, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9742}:  27%|██▋       | 8/30 [00:16<00:51,  2.36s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 102.5082, 'hit_ratio@10': 0.2486, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1887}:  27%|██▋       | 8/30 [00:19<00:51,  2.36s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 102.5082, 'hit_ratio@10': 0.2486, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1887}:  30%|███       | 9/30 [00:19<00:50,  2.40s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 92.2832, 'hit_ratio@10': 0.2533, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1557}:  30%|███       | 9/30 [00:22<00:50,  2.40s/it]    {'epoch': 22, 'num_users': 6.3, 'loss': 92.2832, 'hit_ratio@10': 0.2533, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1557}:  33%|███▎      | 10/30 [00:22<00:50,  2.55s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 83.9313, 'hit_ratio@10': 0.2617, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1868}:  33%|███▎      | 10/30 [00:24<00:50,  2.55s/it]{'epoch': 22, 'num_users': 6.6364, 'loss': 83.9313, 'hit_ratio@10': 0.2617, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1868}:  37%|███▋      | 11/30 [00:24<00:43,  2.31s/it]{'epoch': 22, 'num_users': 6.4167, 'loss': 183.4134, 'hit_ratio@10': 0.2538, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9842}:  37%|███▋      | 11/30 [00:24<00:43,  2.31s/it]{'epoch': 22, 'num_users': 6.4167, 'loss': 183.4134, 'hit_ratio@10': 0.2538, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9842}:  40%|████      | 12/30 [00:24<00:33,  1.85s/it]{'epoch': 22, 'num_users': 6.6154, 'loss': 169.3359, 'hit_ratio@10': 0.2658, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9915}:  40%|████      | 12/30 [00:26<00:33,  1.85s/it]{'epoch': 22, 'num_users': 6.6154, 'loss': 169.3359, 'hit_ratio@10': 0.2658, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9915}:  43%|████▎     | 13/30 [00:26<00:29,  1.76s/it]{'epoch': 22, 'num_users': 6.3571, 'loss': 758.367, 'hit_ratio@10': 0.2468, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8032}:  43%|████▎     | 13/30 [00:26<00:29,  1.76s/it] {'epoch': 22, 'num_users': 6.3571, 'loss': 758.367, 'hit_ratio@10': 0.2468, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8032}:  47%|████▋     | 14/30 [00:26<00:21,  1.35s/it]{'epoch': 22, 'num_users': 6.2667, 'loss': 707.8385, 'hit_ratio@10': 0.2475, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8926}:  47%|████▋     | 14/30 [00:28<00:21,  1.35s/it]{'epoch': 22, 'num_users': 6.2667, 'loss': 707.8385, 'hit_ratio@10': 0.2475, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8926}:  50%|█████     | 15/30 [00:28<00:23,  1.57s/it]{'epoch': 22, 'num_users': 6.0625, 'loss': 664.0303, 'hit_ratio@10': 0.2425, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7608}:  50%|█████     | 15/30 [00:29<00:23,  1.57s/it]{'epoch': 22, 'num_users': 6.0625, 'loss': 664.0303, 'hit_ratio@10': 0.2425, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7608}:  53%|█████▎    | 16/30 [00:29<00:18,  1.34s/it]{'epoch': 22, 'num_users': 5.8235, 'loss': 671.859, 'hit_ratio@10': 0.24, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6312}:  53%|█████▎    | 16/30 [00:30<00:18,  1.34s/it]   {'epoch': 22, 'num_users': 5.8235, 'loss': 671.859, 'hit_ratio@10': 0.24, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6312}:  57%|█████▋    | 17/30 [00:30<00:13,  1.03s/it]{'epoch': 22, 'num_users': 6.0556, 'loss': 634.5516, 'hit_ratio@10': 0.2445, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5917}:  57%|█████▋    | 17/30 [00:32<00:13,  1.03s/it]{'epoch': 22, 'num_users': 6.0556, 'loss': 634.5516, 'hit_ratio@10': 0.2445, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5917}:  60%|██████    | 18/30 [00:32<00:15,  1.31s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 601.1935, 'hit_ratio@10': 0.2392, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5459}:  60%|██████    | 18/30 [00:32<00:15,  1.31s/it]   {'epoch': 22, 'num_users': 6.0, 'loss': 601.1935, 'hit_ratio@10': 0.2392, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5459}:  63%|██████▎   | 19/30 [00:32<00:13,  1.18s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 571.1492, 'hit_ratio@10': 0.2456, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6143}:  63%|██████▎   | 19/30 [00:36<00:13,  1.18s/it]{'epoch': 22, 'num_users': 6.15, 'loss': 571.1492, 'hit_ratio@10': 0.2456, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6143}:  67%|██████▋   | 20/30 [00:36<00:20,  2.01s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 543.9775, 'hit_ratio@10': 0.2518, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7714}:  67%|██████▋   | 20/30 [00:39<00:20,  2.01s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 543.9775, 'hit_ratio@10': 0.2518, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7714}:  70%|███████   | 21/30 [00:39<00:20,  2.30s/it]{'epoch': 22, 'num_users': 6.1818, 'loss': 519.2755, 'hit_ratio@10': 0.2507, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7101}:  70%|███████   | 21/30 [00:41<00:20,  2.30s/it]{'epoch': 22, 'num_users': 6.1818, 'loss': 519.2755, 'hit_ratio@10': 0.2507, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7101}:  73%|███████▎  | 22/30 [00:41<00:16,  2.05s/it]{'epoch': 22, 'num_users': 6.1304, 'loss': 496.781, 'hit_ratio@10': 0.255, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7167}:  73%|███████▎  | 22/30 [00:42<00:16,  2.05s/it]  {'epoch': 22, 'num_users': 6.1304, 'loss': 496.781, 'hit_ratio@10': 0.255, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7167}:  77%|███████▋  | 23/30 [00:42<00:13,  1.88s/it]{'epoch': 22, 'num_users': 5.9583, 'loss': 521.538, 'hit_ratio@10': 0.2527, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6159}:  77%|███████▋  | 23/30 [00:43<00:13,  1.88s/it]{'epoch': 22, 'num_users': 5.9583, 'loss': 521.538, 'hit_ratio@10': 0.2527, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6159}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 668.0103, 'hit_ratio@10': 0.2559, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.523}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]   {'epoch': 22, 'num_users': 5.8, 'loss': 668.0103, 'hit_ratio@10': 0.2559, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.523}:  83%|████████▎ | 25/30 [00:43<00:05,  1.04s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 642.3314, 'hit_ratio@10': 0.2578, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6523}:  83%|████████▎ | 25/30 [00:49<00:05,  1.04s/it]{'epoch': 22, 'num_users': 5.8077, 'loss': 642.3314, 'hit_ratio@10': 0.2578, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6523}:  87%|████████▋ | 26/30 [00:49<00:10,  2.51s/it]{'epoch': 22, 'num_users': 5.8889, 'loss': 618.5539, 'hit_ratio@10': 0.2615, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7047}:  87%|████████▋ | 26/30 [00:51<00:10,  2.51s/it]{'epoch': 22, 'num_users': 5.8889, 'loss': 618.5539, 'hit_ratio@10': 0.2615, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7047}:  90%|█████████ | 27/30 [00:51<00:07,  2.37s/it]{'epoch': 22, 'num_users': 6.0, 'loss': 596.4886, 'hit_ratio@10': 0.2605, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7418}:  90%|█████████ | 27/30 [00:55<00:07,  2.37s/it]   {'epoch': 22, 'num_users': 6.0, 'loss': 596.4886, 'hit_ratio@10': 0.2605, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7418}:  93%|█████████▎| 28/30 [00:55<00:05,  2.79s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 575.936, 'hit_ratio@10': 0.2657, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7503}:  93%|█████████▎| 28/30 [00:56<00:05,  2.79s/it]{'epoch': 22, 'num_users': 5.8621, 'loss': 575.936, 'hit_ratio@10': 0.2657, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7503}:  97%|█████████▋| 29/30 [00:56<00:02,  2.41s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 556.7507, 'hit_ratio@10': 0.2649, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7443}:  97%|█████████▋| 29/30 [00:59<00:02,  2.41s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 556.7507, 'hit_ratio@10': 0.2649, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7443}: 100%|██████████| 30/30 [00:59<00:00,  2.47s/it]{'epoch': 22, 'num_users': 5.8667, 'loss': 556.7507, 'hit_ratio@10': 0.2649, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7443}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 22
Avg # of users: 5.866666666666666
Avg Loss: 556.7507039506461
Avg hit ratio: 0.26492325348519
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7443317969640098
Std train time: 1.7422017329001855
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 15.865, 'hit_ratio@10': 0.1579, 'ndcg@10': 899.5843, 'compress@10': 1.0, 'time@10': 2.6859}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 15.865, 'hit_ratio@10': 0.1579, 'ndcg@10': 899.5843, 'compress@10': 1.0, 'time@10': 2.6859}:   3%|▎         | 1/30 [00:01<00:40,  1.39s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 8.1118, 'hit_ratio@10': 0.1757, 'ndcg@10': 450.0461, 'compress@10': 1.0, 'time@10': 2.4422}:   3%|▎         | 1/30 [00:03<00:40,  1.39s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 8.1118, 'hit_ratio@10': 0.1757, 'ndcg@10': 450.0461, 'compress@10': 1.0, 'time@10': 2.4422}:   7%|▋         | 2/30 [00:03<00:52,  1.88s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 81.0678, 'hit_ratio@10': 0.1648, 'ndcg@10': 32647310464.5758, 'compress@10': 1.0, 'time@10': 1.8985}:   7%|▋         | 2/30 [00:04<00:52,  1.88s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 81.0678, 'hit_ratio@10': 0.1648, 'ndcg@10': 32647310464.5758, 'compress@10': 1.0, 'time@10': 1.8985}:  10%|█         | 3/30 [00:04<00:32,  1.22s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 60.8997, 'hit_ratio@10': 0.2039, 'ndcg@10': 24485482848.5443, 'compress@10': 1.0, 'time@10': 1.9019}:  10%|█         | 3/30 [00:05<00:32,  1.22s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 60.8997, 'hit_ratio@10': 0.2039, 'ndcg@10': 24485482848.5443, 'compress@10': 1.0, 'time@10': 1.9019}:  13%|█▎        | 4/30 [00:05<00:39,  1.51s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 48.7854, 'hit_ratio@10': 0.2311, 'ndcg@10': 19588386278.9158, 'compress@10': 1.0, 'time@10': 2.9364}:  13%|█▎        | 4/30 [00:09<00:39,  1.51s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 48.7854, 'hit_ratio@10': 0.2311, 'ndcg@10': 19588386278.9158, 'compress@10': 1.0, 'time@10': 2.9364}:  17%|█▋        | 5/30 [00:09<00:56,  2.25s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 40.7117, 'hit_ratio@10': 0.2371, 'ndcg@10': 16323655232.5106, 'compress@10': 1.0, 'time@10': 2.9821}:  17%|█▋        | 5/30 [00:12<00:56,  2.25s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 40.7117, 'hit_ratio@10': 0.2371, 'ndcg@10': 16323655232.5106, 'compress@10': 1.0, 'time@10': 2.9821}:  20%|██        | 6/30 [00:12<01:02,  2.59s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 34.9631, 'hit_ratio@10': 0.2375, 'ndcg@10': 13991704485.0733, 'compress@10': 1.0, 'time@10': 3.0516}:  20%|██        | 6/30 [00:14<01:02,  2.59s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 34.9631, 'hit_ratio@10': 0.2375, 'ndcg@10': 13991704485.0733, 'compress@10': 1.0, 'time@10': 3.0516}:  23%|██▎       | 7/30 [00:14<00:53,  2.32s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 30.629, 'hit_ratio@10': 0.2542, 'ndcg@10': 12242741424.4891, 'compress@10': 1.0, 'time@10': 2.9711}:  23%|██▎       | 7/30 [00:17<00:53,  2.32s/it]  {'epoch': 23, 'num_users': 6.125, 'loss': 30.629, 'hit_ratio@10': 0.2542, 'ndcg@10': 12242741424.4891, 'compress@10': 1.0, 'time@10': 2.9711}:  27%|██▋       | 8/30 [00:17<00:51,  2.36s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 27.2626, 'hit_ratio@10': 0.2641, 'ndcg@10': 10882436821.8243, 'compress@10': 1.0, 'time@10': 3.1928}:  27%|██▋       | 8/30 [00:19<00:51,  2.36s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 27.2626, 'hit_ratio@10': 0.2641, 'ndcg@10': 10882436821.8243, 'compress@10': 1.0, 'time@10': 3.1928}:  30%|███       | 9/30 [00:19<00:50,  2.40s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 24.564, 'hit_ratio@10': 0.2877, 'ndcg@10': 9794193139.6887, 'compress@10': 1.0, 'time@10': 3.1682}:  30%|███       | 9/30 [00:22<00:50,  2.40s/it]     {'epoch': 23, 'num_users': 6.3, 'loss': 24.564, 'hit_ratio@10': 0.2877, 'ndcg@10': 9794193139.6887, 'compress@10': 1.0, 'time@10': 3.1682}:  33%|███▎      | 10/30 [00:22<00:51,  2.58s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 22.3601, 'hit_ratio@10': 0.3, 'ndcg@10': 8903811945.2121, 'compress@10': 1.0, 'time@10': 3.2216}:  33%|███▎      | 10/30 [00:24<00:51,  2.58s/it]{'epoch': 23, 'num_users': 6.6364, 'loss': 22.3601, 'hit_ratio@10': 0.3, 'ndcg@10': 8903811945.2121, 'compress@10': 1.0, 'time@10': 3.2216}:  37%|███▋      | 11/30 [00:24<00:45,  2.38s/it]{'epoch': 23, 'num_users': 6.4167, 'loss': 120.5497, 'hit_ratio@10': 0.275, 'ndcg@10': 5.756006364224533e+30, 'compress@10': 1.0, 'time@10': 3.0174}:  37%|███▋      | 11/30 [00:25<00:45,  2.38s/it]{'epoch': 23, 'num_users': 6.4167, 'loss': 120.5497, 'hit_ratio@10': 0.275, 'ndcg@10': 5.756006364224533e+30, 'compress@10': 1.0, 'time@10': 3.0174}:  40%|████      | 12/30 [00:25<00:34,  1.90s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 111.3044, 'hit_ratio@10': 0.2748, 'ndcg@10': 5.313236643899569e+30, 'compress@10': 1.0, 'time@10': 3.028}:  40%|████      | 12/30 [00:26<00:34,  1.90s/it]{'epoch': 23, 'num_users': 6.6154, 'loss': 111.3044, 'hit_ratio@10': 0.2748, 'ndcg@10': 5.313236643899569e+30, 'compress@10': 1.0, 'time@10': 3.028}:  43%|████▎     | 13/30 [00:26<00:30,  1.81s/it]{'epoch': 23, 'num_users': 6.3571, 'loss': 109.3186, 'hit_ratio@10': 0.2552, 'ndcg@10': 4.933719740763885e+30, 'compress@10': 1.0, 'time@10': 2.8351}:  43%|████▎     | 13/30 [00:27<00:30,  1.81s/it]{'epoch': 23, 'num_users': 6.3571, 'loss': 109.3186, 'hit_ratio@10': 0.2552, 'ndcg@10': 4.933719740763885e+30, 'compress@10': 1.0, 'time@10': 2.8351}:  47%|████▋     | 14/30 [00:27<00:21,  1.37s/it]{'epoch': 23, 'num_users': 6.2667, 'loss': 102.1164, 'hit_ratio@10': 0.2532, 'ndcg@10': 4.604805091379626e+30, 'compress@10': 1.0, 'time@10': 2.9066}:  47%|████▋     | 14/30 [00:29<00:21,  1.37s/it]{'epoch': 23, 'num_users': 6.2667, 'loss': 102.1164, 'hit_ratio@10': 0.2532, 'ndcg@10': 4.604805091379626e+30, 'compress@10': 1.0, 'time@10': 2.9066}:  50%|█████     | 15/30 [00:29<00:23,  1.56s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 130.4785, 'hit_ratio@10': 0.2478, 'ndcg@10': 4.489178726302558e+30, 'compress@10': 1.0, 'time@10': 2.7694}:  50%|█████     | 15/30 [00:29<00:23,  1.56s/it]{'epoch': 23, 'num_users': 6.0625, 'loss': 130.4785, 'hit_ratio@10': 0.2478, 'ndcg@10': 4.489178726302558e+30, 'compress@10': 1.0, 'time@10': 2.7694}:  53%|█████▎    | 16/30 [00:29<00:18,  1.31s/it]{'epoch': 23, 'num_users': 5.8235, 'loss': 123.6371, 'hit_ratio@10': 0.2332, 'ndcg@10': 4.2251093894612303e+30, 'compress@10': 1.0, 'time@10': 2.642}:  53%|█████▎    | 16/30 [00:30<00:18,  1.31s/it]{'epoch': 23, 'num_users': 5.8235, 'loss': 123.6371, 'hit_ratio@10': 0.2332, 'ndcg@10': 4.2251093894612303e+30, 'compress@10': 1.0, 'time@10': 2.642}:  57%|█████▋    | 17/30 [00:30<00:13,  1.02s/it]{'epoch': 23, 'num_users': 6.0556, 'loss': 116.7915, 'hit_ratio@10': 0.2322, 'ndcg@10': 3.990381090046718e+30, 'compress@10': 1.0, 'time@10': 2.6051}:  57%|█████▋    | 17/30 [00:32<00:13,  1.02s/it]{'epoch': 23, 'num_users': 6.0556, 'loss': 116.7915, 'hit_ratio@10': 0.2322, 'ndcg@10': 3.990381090046718e+30, 'compress@10': 1.0, 'time@10': 2.6051}:  60%|██████    | 18/30 [00:32<00:15,  1.31s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 110.6665, 'hit_ratio@10': 0.2275, 'ndcg@10': 3.7803610326758377e+30, 'compress@10': 1.0, 'time@10': 2.5647}:  60%|██████    | 18/30 [00:33<00:15,  1.31s/it]  {'epoch': 23, 'num_users': 6.0, 'loss': 110.6665, 'hit_ratio@10': 0.2275, 'ndcg@10': 3.7803610326758377e+30, 'compress@10': 1.0, 'time@10': 2.5647}:  63%|██████▎   | 19/30 [00:33<00:13,  1.21s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 105.1544, 'hit_ratio@10': 0.2336, 'ndcg@10': 3.591342981042046e+30, 'compress@10': 1.0, 'time@10': 2.6419}:  63%|██████▎   | 19/30 [00:37<00:13,  1.21s/it]{'epoch': 23, 'num_users': 6.15, 'loss': 105.1544, 'hit_ratio@10': 0.2336, 'ndcg@10': 3.591342981042046e+30, 'compress@10': 1.0, 'time@10': 2.6419}:  67%|██████▋   | 20/30 [00:37<00:20,  2.09s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 100.1879, 'hit_ratio@10': 0.2416, 'ndcg@10': 3.4203266486114723e+30, 'compress@10': 1.0, 'time@10': 2.7835}:  67%|██████▋   | 20/30 [00:40<00:20,  2.09s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 100.1879, 'hit_ratio@10': 0.2416, 'ndcg@10': 3.4203266486114723e+30, 'compress@10': 1.0, 'time@10': 2.7835}:  70%|███████   | 21/30 [00:40<00:20,  2.31s/it]{'epoch': 23, 'num_users': 6.1818, 'loss': 95.7343, 'hit_ratio@10': 0.2451, 'ndcg@10': 3.264857255492769e+30, 'compress@10': 1.0, 'time@10': 2.7179}:  70%|███████   | 21/30 [00:41<00:20,  2.31s/it]  {'epoch': 23, 'num_users': 6.1818, 'loss': 95.7343, 'hit_ratio@10': 0.2451, 'ndcg@10': 3.264857255492769e+30, 'compress@10': 1.0, 'time@10': 2.7179}:  73%|███████▎  | 22/30 [00:41<00:16,  2.03s/it]{'epoch': 23, 'num_users': 6.1304, 'loss': 92.2503, 'hit_ratio@10': 0.2496, 'ndcg@10': 3.1229069400365616e+30, 'compress@10': 1.0, 'time@10': 2.7117}:  73%|███████▎  | 22/30 [00:42<00:16,  2.03s/it]{'epoch': 23, 'num_users': 6.1304, 'loss': 92.2503, 'hit_ratio@10': 0.2496, 'ndcg@10': 3.1229069400365616e+30, 'compress@10': 1.0, 'time@10': 2.7117}:  77%|███████▋  | 23/30 [00:42<00:12,  1.82s/it]{'epoch': 23, 'num_users': 5.9583, 'loss': 89.1311, 'hit_ratio@10': 0.2559, 'ndcg@10': 2.992785817535038e+30, 'compress@10': 1.0, 'time@10': 2.6097}:  77%|███████▋  | 23/30 [00:43<00:12,  1.82s/it] {'epoch': 23, 'num_users': 5.9583, 'loss': 89.1311, 'hit_ratio@10': 0.2559, 'ndcg@10': 2.992785817535038e+30, 'compress@10': 1.0, 'time@10': 2.6097}:  80%|████████  | 24/30 [00:43<00:08,  1.36s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 98.765, 'hit_ratio@10': 0.259, 'ndcg@10': 2.873074384833637e+30, 'compress@10': 1.0, 'time@10': 2.5165}:  80%|████████  | 24/30 [00:43<00:08,  1.36s/it]     {'epoch': 23, 'num_users': 5.8, 'loss': 98.765, 'hit_ratio@10': 0.259, 'ndcg@10': 2.873074384833637e+30, 'compress@10': 1.0, 'time@10': 2.5165}:  83%|████████▎ | 25/30 [00:43<00:05,  1.00s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 94.9812, 'hit_ratio@10': 0.2645, 'ndcg@10': 2.762571523878497e+30, 'compress@10': 1.0, 'time@10': 2.6367}:  83%|████████▎ | 25/30 [00:48<00:05,  1.00s/it]{'epoch': 23, 'num_users': 5.8077, 'loss': 94.9812, 'hit_ratio@10': 0.2645, 'ndcg@10': 2.762571523878497e+30, 'compress@10': 1.0, 'time@10': 2.6367}:  87%|████████▋ | 26/30 [00:48<00:09,  2.40s/it]{'epoch': 23, 'num_users': 5.8889, 'loss': 1531.7014, 'hit_ratio@10': 0.2573, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6824}:  87%|████████▋ | 26/30 [00:50<00:09,  2.40s/it]                {'epoch': 23, 'num_users': 5.8889, 'loss': 1531.7014, 'hit_ratio@10': 0.2573, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6824}:  90%|█████████ | 27/30 [00:50<00:06,  2.27s/it]{'epoch': 23, 'num_users': 6.0, 'loss': 1477.0147, 'hit_ratio@10': 0.2678, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7184}:  90%|█████████ | 27/30 [00:54<00:06,  2.27s/it]   {'epoch': 23, 'num_users': 6.0, 'loss': 1477.0147, 'hit_ratio@10': 0.2678, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7184}:  93%|█████████▎| 28/30 [00:54<00:05,  2.71s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 1426.0928, 'hit_ratio@10': 0.2679, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7262}:  93%|█████████▎| 28/30 [00:56<00:05,  2.71s/it]{'epoch': 23, 'num_users': 5.8621, 'loss': 1426.0928, 'hit_ratio@10': 0.2679, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7262}:  97%|█████████▋| 29/30 [00:56<00:02,  2.35s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 1378.5735, 'hit_ratio@10': 0.2653, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7195}:  97%|█████████▋| 29/30 [00:58<00:02,  2.35s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 1378.5735, 'hit_ratio@10': 0.2653, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7195}: 100%|██████████| 30/30 [00:58<00:00,  2.41s/it]{'epoch': 23, 'num_users': 5.8667, 'loss': 1378.5735, 'hit_ratio@10': 0.2653, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7195}: 100%|██████████| 30/30 [00:58<00:00,  1.96s/it]
Epoch: 23
Avg # of users: 5.866666666666666
Avg Loss: 1378.5735021346459
Avg hit ratio: 0.26530991334932064
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7195245822270713
Std train time: 1.6996464354846719
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 15.1044, 'hit_ratio@10': 0.3684, 'ndcg@10': 229.1561, 'compress@10': 1.0, 'time@10': 2.8726}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 15.1044, 'hit_ratio@10': 0.3684, 'ndcg@10': 229.1561, 'compress@10': 1.0, 'time@10': 2.8726}:   3%|▎         | 1/30 [00:01<00:42,  1.47s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 7.7002, 'hit_ratio@10': 0.4423, 'ndcg@10': 114.8058, 'compress@10': 1.0, 'time@10': 2.5284}:   3%|▎         | 1/30 [00:03<00:42,  1.47s/it] {'epoch': 24, 'num_users': 7.0, 'loss': 7.7002, 'hit_ratio@10': 0.4423, 'ndcg@10': 114.8058, 'compress@10': 1.0, 'time@10': 2.5284}:   7%|▋         | 2/30 [00:03<00:53,  1.91s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 12.3764, 'hit_ratio@10': 0.3901, 'ndcg@10': 531.6957, 'compress@10': 1.0, 'time@10': 1.9573}:   7%|▋         | 2/30 [00:04<00:53,  1.91s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 12.3764, 'hit_ratio@10': 0.3901, 'ndcg@10': 531.6957, 'compress@10': 1.0, 'time@10': 1.9573}:  10%|█         | 3/30 [00:04<00:33,  1.23s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 9.3843, 'hit_ratio@10': 0.3908, 'ndcg@10': 398.8817, 'compress@10': 1.0, 'time@10': 1.941}:  10%|█         | 3/30 [00:06<00:33,  1.23s/it]  {'epoch': 24, 'num_users': 5.0, 'loss': 9.3843, 'hit_ratio@10': 0.3908, 'ndcg@10': 398.8817, 'compress@10': 1.0, 'time@10': 1.941}:  13%|█▎        | 4/30 [00:06<00:39,  1.51s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 7.5991, 'hit_ratio@10': 0.3766, 'ndcg@10': 319.1928, 'compress@10': 1.0, 'time@10': 2.9388}:  13%|█▎        | 4/30 [00:09<00:39,  1.51s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 7.5991, 'hit_ratio@10': 0.3766, 'ndcg@10': 319.1928, 'compress@10': 1.0, 'time@10': 2.9388}:  17%|█▋        | 5/30 [00:09<00:55,  2.22s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 6.3794, 'hit_ratio@10': 0.3694, 'ndcg@10': 266.0705, 'compress@10': 1.0, 'time@10': 2.9721}:  17%|█▋        | 5/30 [00:12<00:55,  2.22s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 6.3794, 'hit_ratio@10': 0.3694, 'ndcg@10': 266.0705, 'compress@10': 1.0, 'time@10': 2.9721}:  20%|██        | 6/30 [00:12<01:01,  2.54s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 6.9991, 'hit_ratio@10': 0.3452, 'ndcg@10': 235.2674, 'compress@10': 1.0, 'time@10': 3.0436}:  20%|██        | 6/30 [00:14<01:01,  2.54s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 6.9991, 'hit_ratio@10': 0.3452, 'ndcg@10': 235.2674, 'compress@10': 1.0, 'time@10': 3.0436}:  23%|██▎       | 7/30 [00:14<00:52,  2.29s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 6.535, 'hit_ratio@10': 0.3449, 'ndcg@10': 206.2178, 'compress@10': 1.0, 'time@10': 2.9724}:  23%|██▎       | 7/30 [00:16<00:52,  2.29s/it]  {'epoch': 24, 'num_users': 6.125, 'loss': 6.535, 'hit_ratio@10': 0.3449, 'ndcg@10': 206.2178, 'compress@10': 1.0, 'time@10': 2.9724}:  27%|██▋       | 8/30 [00:16<00:51,  2.36s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 5.8621, 'hit_ratio@10': 0.332, 'ndcg@10': 183.3715, 'compress@10': 1.0, 'time@10': 3.193}:  27%|██▋       | 8/30 [00:19<00:51,  2.36s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 5.8621, 'hit_ratio@10': 0.332, 'ndcg@10': 183.3715, 'compress@10': 1.0, 'time@10': 3.193}:  30%|███       | 9/30 [00:19<00:50,  2.41s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 5.3021, 'hit_ratio@10': 0.342, 'ndcg@10': 165.0797, 'compress@10': 1.0, 'time@10': 3.1823}:  30%|███       | 9/30 [00:22<00:50,  2.41s/it]  {'epoch': 24, 'num_users': 6.3, 'loss': 5.3021, 'hit_ratio@10': 0.342, 'ndcg@10': 165.0797, 'compress@10': 1.0, 'time@10': 3.1823}:  33%|███▎      | 10/30 [00:22<00:52,  2.62s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 5.0446, 'hit_ratio@10': 0.3458, 'ndcg@10': 150.2658, 'compress@10': 1.0, 'time@10': 3.2343}:  33%|███▎      | 10/30 [00:24<00:52,  2.62s/it]{'epoch': 24, 'num_users': 6.6364, 'loss': 5.0446, 'hit_ratio@10': 0.3458, 'ndcg@10': 150.2658, 'compress@10': 1.0, 'time@10': 3.2343}:  37%|███▋      | 11/30 [00:24<00:45,  2.41s/it]{'epoch': 24, 'num_users': 6.4167, 'loss': 4.659, 'hit_ratio@10': 0.3379, 'ndcg@10': 137.7952, 'compress@10': 1.0, 'time@10': 3.0297}:  37%|███▋      | 11/30 [00:25<00:45,  2.41s/it] {'epoch': 24, 'num_users': 6.4167, 'loss': 4.659, 'hit_ratio@10': 0.3379, 'ndcg@10': 137.7952, 'compress@10': 1.0, 'time@10': 3.0297}:  40%|████      | 12/30 [00:25<00:34,  1.92s/it]{'epoch': 24, 'num_users': 6.6154, 'loss': 4.3463, 'hit_ratio@10': 0.3433, 'ndcg@10': 127.2438, 'compress@10': 1.0, 'time@10': 3.038}:  40%|████      | 12/30 [00:26<00:34,  1.92s/it]{'epoch': 24, 'num_users': 6.6154, 'loss': 4.3463, 'hit_ratio@10': 0.3433, 'ndcg@10': 127.2438, 'compress@10': 1.0, 'time@10': 3.038}:  43%|████▎     | 13/30 [00:26<00:30,  1.82s/it]{'epoch': 24, 'num_users': 6.3571, 'loss': 645.8531, 'hit_ratio@10': 0.3307, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8447}:  43%|████▎     | 13/30 [00:27<00:30,  1.82s/it]  {'epoch': 24, 'num_users': 6.3571, 'loss': 645.8531, 'hit_ratio@10': 0.3307, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8447}:  47%|████▋     | 14/30 [00:27<00:22,  1.38s/it]{'epoch': 24, 'num_users': 6.2667, 'loss': 602.8258, 'hit_ratio@10': 0.3237, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.937}:  47%|████▋     | 14/30 [00:29<00:22,  1.38s/it] {'epoch': 24, 'num_users': 6.2667, 'loss': 602.8258, 'hit_ratio@10': 0.3237, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.937}:  50%|█████     | 15/30 [00:29<00:24,  1.61s/it]{'epoch': 24, 'num_users': 6.0625, 'loss': 2812.0442, 'hit_ratio@10': 0.3087, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.801}:  50%|█████     | 15/30 [00:30<00:24,  1.61s/it]{'epoch': 24, 'num_users': 6.0625, 'loss': 2812.0442, 'hit_ratio@10': 0.3087, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.801}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it]{'epoch': 24, 'num_users': 5.8235, 'loss': 3311.7485, 'hit_ratio@10': 0.2905, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6683}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it]{'epoch': 24, 'num_users': 5.8235, 'loss': 3311.7485, 'hit_ratio@10': 0.2905, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6683}:  57%|█████▋    | 17/30 [00:30<00:13,  1.04s/it]{'epoch': 24, 'num_users': 6.0556, 'loss': 3127.7891, 'hit_ratio@10': 0.2942, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6354}:  57%|█████▋    | 17/30 [00:32<00:13,  1.04s/it]{'epoch': 24, 'num_users': 6.0556, 'loss': 3127.7891, 'hit_ratio@10': 0.2942, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6354}:  60%|██████    | 18/30 [00:32<00:16,  1.36s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 2974.4833, 'hit_ratio@10': 0.2976, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5964}:  60%|██████    | 18/30 [00:33<00:16,  1.36s/it]   {'epoch': 24, 'num_users': 6.0, 'loss': 2974.4833, 'hit_ratio@10': 0.2976, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5964}:  63%|██████▎   | 19/30 [00:33<00:13,  1.25s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 2825.7767, 'hit_ratio@10': 0.3011, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6648}:  63%|██████▎   | 19/30 [00:37<00:13,  1.25s/it]{'epoch': 24, 'num_users': 6.15, 'loss': 2825.7767, 'hit_ratio@10': 0.3011, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6648}:  67%|██████▋   | 20/30 [00:37<00:20,  2.07s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 2691.2405, 'hit_ratio@10': 0.3058, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.805}:  67%|██████▋   | 20/30 [00:40<00:20,  2.07s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 2691.2405, 'hit_ratio@10': 0.3058, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.805}:  70%|███████   | 21/30 [00:40<00:20,  2.30s/it]{'epoch': 24, 'num_users': 6.1818, 'loss': 2569.0351, 'hit_ratio@10': 0.2981, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7428}:  70%|███████   | 21/30 [00:41<00:20,  2.30s/it]{'epoch': 24, 'num_users': 6.1818, 'loss': 2569.0351, 'hit_ratio@10': 0.2981, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7428}:  73%|███████▎  | 22/30 [00:41<00:16,  2.05s/it]{'epoch': 24, 'num_users': 6.1304, 'loss': 2602.4002, 'hit_ratio@10': 0.2895, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7424}:  73%|███████▎  | 22/30 [00:43<00:16,  2.05s/it]{'epoch': 24, 'num_users': 6.1304, 'loss': 2602.4002, 'hit_ratio@10': 0.2895, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7424}:  77%|███████▋  | 23/30 [00:43<00:12,  1.85s/it]{'epoch': 24, 'num_users': 5.9583, 'loss': 2995.9192, 'hit_ratio@10': 0.2941, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6404}:  77%|███████▋  | 23/30 [00:43<00:12,  1.85s/it]{'epoch': 24, 'num_users': 5.9583, 'loss': 2995.9192, 'hit_ratio@10': 0.2941, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6404}:  80%|████████  | 24/30 [00:43<00:08,  1.40s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 3751.1226, 'hit_ratio@10': 0.2823, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5457}:  80%|████████  | 24/30 [00:43<00:08,  1.40s/it]   {'epoch': 24, 'num_users': 5.8, 'loss': 3751.1226, 'hit_ratio@10': 0.2823, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5457}:  83%|████████▎ | 25/30 [00:43<00:05,  1.03s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 3606.8631, 'hit_ratio@10': 0.2813, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6613}:  83%|████████▎ | 25/30 [00:49<00:05,  1.03s/it]{'epoch': 24, 'num_users': 5.8077, 'loss': 3606.8631, 'hit_ratio@10': 0.2813, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6613}:  87%|████████▋ | 26/30 [00:49<00:09,  2.39s/it]{'epoch': 24, 'num_users': 5.8889, 'loss': 3562.2992, 'hit_ratio@10': 0.2722, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7042}:  87%|████████▋ | 26/30 [00:51<00:09,  2.39s/it]{'epoch': 24, 'num_users': 5.8889, 'loss': 3562.2992, 'hit_ratio@10': 0.2722, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7042}:  90%|█████████ | 27/30 [00:51<00:06,  2.26s/it]{'epoch': 24, 'num_users': 6.0, 'loss': 3435.0934, 'hit_ratio@10': 0.2744, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.739}:  90%|█████████ | 27/30 [00:54<00:06,  2.26s/it]    {'epoch': 24, 'num_users': 6.0, 'loss': 3435.0934, 'hit_ratio@10': 0.2744, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.739}:  93%|█████████▎| 28/30 [00:54<00:05,  2.69s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 3316.6548, 'hit_ratio@10': 0.2791, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7457}:  93%|█████████▎| 28/30 [00:56<00:05,  2.69s/it]{'epoch': 24, 'num_users': 5.8621, 'loss': 3316.6548, 'hit_ratio@10': 0.2791, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7457}:  97%|█████████▋| 29/30 [00:56<00:02,  2.34s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 3206.1134, 'hit_ratio@10': 0.2815, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7408}:  97%|█████████▋| 29/30 [00:59<00:02,  2.34s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 3206.1134, 'hit_ratio@10': 0.2815, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7408}: 100%|██████████| 30/30 [00:59<00:00,  2.42s/it]{'epoch': 24, 'num_users': 5.8667, 'loss': 3206.1134, 'hit_ratio@10': 0.2815, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7408}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 24
Avg # of users: 5.866666666666666
Avg Loss: 3206.1133660032406
Avg hit ratio: 0.2814624063035591
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7408438762029013
Std train time: 1.6787986951166676
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 141475.9209, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6099}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 141475.9209, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6099}:   3%|▎         | 1/30 [00:01<00:38,  1.33s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 70738.1397, 'hit_ratio@10': 0.2445, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4069}:   3%|▎         | 1/30 [00:03<00:38,  1.33s/it] {'epoch': 25, 'num_users': 7.0, 'loss': 70738.1397, 'hit_ratio@10': 0.2445, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4069}:   7%|▋         | 2/30 [00:03<00:52,  1.86s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 52989.2117, 'hit_ratio@10': 0.163, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8752}:   7%|▋         | 2/30 [00:04<00:52,  1.86s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 52989.2117, 'hit_ratio@10': 0.163, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8752}:  10%|█         | 3/30 [00:04<00:32,  1.21s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 39742.0069, 'hit_ratio@10': 0.1847, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8872}:  10%|█         | 3/30 [00:05<00:32,  1.21s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 39742.0069, 'hit_ratio@10': 0.1847, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8872}:  13%|█▎        | 4/30 [00:05<00:39,  1.50s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 31793.6708, 'hit_ratio@10': 0.2038, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0189}:  13%|█▎        | 4/30 [00:09<00:39,  1.50s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 31793.6708, 'hit_ratio@10': 0.2038, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0189}:  17%|█▋        | 5/30 [00:09<00:58,  2.33s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 26494.7866, 'hit_ratio@10': 0.2106, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0436}:  17%|█▋        | 5/30 [00:12<00:58,  2.33s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 26494.7866, 'hit_ratio@10': 0.2106, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0436}:  20%|██        | 6/30 [00:12<01:03,  2.63s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 22718.3823, 'hit_ratio@10': 0.2205, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0988}:  20%|██        | 6/30 [00:14<01:03,  2.63s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 22718.3823, 'hit_ratio@10': 0.2205, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0988}:  23%|██▎       | 7/30 [00:14<00:53,  2.34s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 19878.6165, 'hit_ratio@10': 0.2465, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0084}:  23%|██▎       | 7/30 [00:17<00:53,  2.34s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 19878.6165, 'hit_ratio@10': 0.2465, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0084}:  27%|██▋       | 8/30 [00:17<00:51,  2.36s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 17669.9185, 'hit_ratio@10': 0.2445, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2199}:  27%|██▋       | 8/30 [00:19<00:51,  2.36s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 17669.9185, 'hit_ratio@10': 0.2445, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2199}:  30%|███       | 9/30 [00:19<00:50,  2.40s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 15930.3749, 'hit_ratio@10': 0.2428, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.206}:  30%|███       | 9/30 [00:22<00:50,  2.40s/it]    {'epoch': 25, 'num_users': 6.3, 'loss': 15930.3749, 'hit_ratio@10': 0.2428, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.206}:  33%|███▎      | 10/30 [00:22<00:52,  2.62s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 14482.2068, 'hit_ratio@10': 0.2487, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2498}:  33%|███▎      | 10/30 [00:24<00:52,  2.62s/it]{'epoch': 25, 'num_users': 6.6364, 'loss': 14482.2068, 'hit_ratio@10': 0.2487, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2498}:  37%|███▋      | 11/30 [00:24<00:45,  2.39s/it]{'epoch': 25, 'num_users': 6.4167, 'loss': 13309.3766, 'hit_ratio@10': 0.2418, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0417}:  37%|███▋      | 11/30 [00:25<00:45,  2.39s/it]{'epoch': 25, 'num_users': 6.4167, 'loss': 13309.3766, 'hit_ratio@10': 0.2418, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0417}:  40%|████      | 12/30 [00:25<00:34,  1.90s/it]{'epoch': 25, 'num_users': 6.6154, 'loss': 12285.6168, 'hit_ratio@10': 0.2407, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.041}:  40%|████      | 12/30 [00:26<00:34,  1.90s/it] {'epoch': 25, 'num_users': 6.6154, 'loss': 12285.6168, 'hit_ratio@10': 0.2407, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.041}:  43%|████▎     | 13/30 [00:26<00:30,  1.79s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 11445.5675, 'hit_ratio@10': 0.2235, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8491}:  43%|████▎     | 13/30 [00:27<00:30,  1.79s/it]{'epoch': 25, 'num_users': 6.3571, 'loss': 11445.5675, 'hit_ratio@10': 0.2235, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8491}:  47%|████▋     | 14/30 [00:27<00:21,  1.37s/it]{'epoch': 25, 'num_users': 6.2667, 'loss': 10682.946, 'hit_ratio@10': 0.2194, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9409}:  47%|████▋     | 14/30 [00:29<00:21,  1.37s/it] {'epoch': 25, 'num_users': 6.2667, 'loss': 10682.946, 'hit_ratio@10': 0.2194, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9409}:  50%|█████     | 15/30 [00:29<00:24,  1.60s/it]{'epoch': 25, 'num_users': 6.0625, 'loss': 10015.2805, 'hit_ratio@10': 0.2213, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8047}:  50%|█████     | 15/30 [00:30<00:24,  1.60s/it]{'epoch': 25, 'num_users': 6.0625, 'loss': 10015.2805, 'hit_ratio@10': 0.2213, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8047}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it]{'epoch': 25, 'num_users': 5.8235, 'loss': 9430.5841, 'hit_ratio@10': 0.22, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6727}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it]   {'epoch': 25, 'num_users': 5.8235, 'loss': 9430.5841, 'hit_ratio@10': 0.22, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6727}:  57%|█████▋    | 17/30 [00:30<00:13,  1.04s/it]{'epoch': 25, 'num_users': 6.0556, 'loss': 8906.6986, 'hit_ratio@10': 0.2296, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6361}:  57%|█████▋    | 17/30 [00:32<00:13,  1.04s/it]{'epoch': 25, 'num_users': 6.0556, 'loss': 8906.6986, 'hit_ratio@10': 0.2296, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6361}:  60%|██████    | 18/30 [00:32<00:16,  1.34s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 8438.2496, 'hit_ratio@10': 0.2288, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5929}:  60%|██████    | 18/30 [00:33<00:16,  1.34s/it]   {'epoch': 25, 'num_users': 6.0, 'loss': 8438.2496, 'hit_ratio@10': 0.2288, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5929}:  63%|██████▎   | 19/30 [00:33<00:13,  1.22s/it]{'epoch': 25, 'num_users': 6.15, 'loss': 8016.3564, 'hit_ratio@10': 0.2411, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.667}:  63%|██████▎   | 19/30 [00:37<00:13,  1.22s/it]{'epoch': 25, 'num_users': 6.15, 'loss': 8016.3564, 'hit_ratio@10': 0.2411, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.667}:  67%|██████▋   | 20/30 [00:37<00:20,  2.09s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 7634.6461, 'hit_ratio@10': 0.2451, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8198}:  67%|██████▋   | 20/30 [00:40<00:20,  2.09s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 7634.6461, 'hit_ratio@10': 0.2451, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8198}:  70%|███████   | 21/30 [00:40<00:21,  2.35s/it]{'epoch': 25, 'num_users': 6.1818, 'loss': 7287.7883, 'hit_ratio@10': 0.2525, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7556}:  70%|███████   | 21/30 [00:42<00:21,  2.35s/it]{'epoch': 25, 'num_users': 6.1818, 'loss': 7287.7883, 'hit_ratio@10': 0.2525, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7556}:  73%|███████▎  | 22/30 [00:42<00:16,  2.08s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 6970.9391, 'hit_ratio@10': 0.2524, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7422}:  73%|███████▎  | 22/30 [00:43<00:16,  2.08s/it]{'epoch': 25, 'num_users': 6.1304, 'loss': 6970.9391, 'hit_ratio@10': 0.2524, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7422}:  77%|███████▋  | 23/30 [00:43<00:12,  1.83s/it]{'epoch': 25, 'num_users': 5.9583, 'loss': 6684.8831, 'hit_ratio@10': 0.2419, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6388}:  77%|███████▋  | 23/30 [00:43<00:12,  1.83s/it]{'epoch': 25, 'num_users': 5.9583, 'loss': 6684.8831, 'hit_ratio@10': 0.2419, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6388}:  80%|████████  | 24/30 [00:43<00:08,  1.37s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 6554.1929, 'hit_ratio@10': 0.2322, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5438}:  80%|████████  | 24/30 [00:43<00:08,  1.37s/it]   {'epoch': 25, 'num_users': 5.8, 'loss': 6554.1929, 'hit_ratio@10': 0.2322, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5438}:  83%|████████▎ | 25/30 [00:43<00:05,  1.01s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 6302.1226, 'hit_ratio@10': 0.2364, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6576}:  83%|████████▎ | 25/30 [00:49<00:05,  1.01s/it]{'epoch': 25, 'num_users': 5.8077, 'loss': 6302.1226, 'hit_ratio@10': 0.2364, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6576}:  87%|████████▋ | 26/30 [00:49<00:09,  2.36s/it]{'epoch': 25, 'num_users': 5.8889, 'loss': 6068.8178, 'hit_ratio@10': 0.2356, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7043}:  87%|████████▋ | 26/30 [00:51<00:09,  2.36s/it]{'epoch': 25, 'num_users': 5.8889, 'loss': 6068.8178, 'hit_ratio@10': 0.2356, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7043}:  90%|█████████ | 27/30 [00:51<00:06,  2.25s/it]{'epoch': 25, 'num_users': 6.0, 'loss': 5852.0891, 'hit_ratio@10': 0.2363, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7389}:  90%|█████████ | 27/30 [00:54<00:06,  2.25s/it]   {'epoch': 25, 'num_users': 6.0, 'loss': 5852.0891, 'hit_ratio@10': 0.2363, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7389}:  93%|█████████▎| 28/30 [00:54<00:05,  2.69s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 5681.5529, 'hit_ratio@10': 0.2376, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7411}:  93%|█████████▎| 28/30 [00:56<00:05,  2.69s/it]{'epoch': 25, 'num_users': 5.8621, 'loss': 5681.5529, 'hit_ratio@10': 0.2376, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7411}:  97%|█████████▋| 29/30 [00:56<00:02,  2.31s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 5492.1763, 'hit_ratio@10': 0.2368, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7299}:  97%|█████████▋| 29/30 [00:58<00:02,  2.31s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 5492.1763, 'hit_ratio@10': 0.2368, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7299}: 100%|██████████| 30/30 [00:58<00:00,  2.35s/it]{'epoch': 25, 'num_users': 5.8667, 'loss': 5492.1763, 'hit_ratio@10': 0.2368, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7299}: 100%|██████████| 30/30 [00:58<00:00,  1.96s/it]
Epoch: 25
Avg # of users: 5.866666666666666
Avg Loss: 5492.1763272467915
Avg hit ratio: 0.23684196516099554
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7298845926920574
Std train time: 1.751644489179932
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 456590.9837, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7063}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 456590.9837, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7063}:   3%|▎         | 1/30 [00:01<00:40,  1.38s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 228295.6712, 'hit_ratio@10': 0.0747, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4617}:   3%|▎         | 1/30 [00:03<00:40,  1.38s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 228295.6712, 'hit_ratio@10': 0.0747, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4617}:   7%|▋         | 2/30 [00:03<00:52,  1.89s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 152210.2555, 'hit_ratio@10': 0.0498, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9217}:   7%|▋         | 2/30 [00:04<00:52,  1.89s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 152210.2555, 'hit_ratio@10': 0.0498, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9217}:  10%|█         | 3/30 [00:04<00:33,  1.23s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 114158.6074, 'hit_ratio@10': 0.0731, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9142}:  10%|█         | 3/30 [00:05<00:33,  1.23s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 114158.6074, 'hit_ratio@10': 0.0731, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9142}:  13%|█▎        | 4/30 [00:05<00:39,  1.50s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 91326.963, 'hit_ratio@10': 0.1105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0581}:  13%|█▎        | 4/30 [00:09<00:39,  1.50s/it]  {'epoch': 26, 'num_users': 5.8, 'loss': 91326.963, 'hit_ratio@10': 0.1105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0581}:  17%|█▋        | 5/30 [00:09<00:58,  2.35s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 76105.8546, 'hit_ratio@10': 0.1365, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0791}:  17%|█▋        | 5/30 [00:13<00:58,  2.35s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 76105.8546, 'hit_ratio@10': 0.1365, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0791}:  20%|██        | 6/30 [00:13<01:03,  2.64s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 65233.6313, 'hit_ratio@10': 0.1513, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1361}:  20%|██        | 6/30 [00:14<01:03,  2.64s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 65233.6313, 'hit_ratio@10': 0.1513, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1361}:  23%|██▎       | 7/30 [00:14<00:54,  2.36s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 57079.6035, 'hit_ratio@10': 0.1931, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0437}:  23%|██▎       | 7/30 [00:17<00:54,  2.36s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 57079.6035, 'hit_ratio@10': 0.1931, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0437}:  27%|██▋       | 8/30 [00:17<00:52,  2.38s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 50737.7261, 'hit_ratio@10': 0.2002, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2381}:  27%|██▋       | 8/30 [00:19<00:52,  2.38s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 50737.7261, 'hit_ratio@10': 0.2002, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2381}:  30%|███       | 9/30 [00:19<00:50,  2.39s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 45663.982, 'hit_ratio@10': 0.1961, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2217}:  30%|███       | 9/30 [00:22<00:50,  2.39s/it]    {'epoch': 26, 'num_users': 6.3, 'loss': 45663.982, 'hit_ratio@10': 0.1961, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2217}:  33%|███▎      | 10/30 [00:22<00:52,  2.62s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 41513.0549, 'hit_ratio@10': 0.2167, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2631}:  33%|███▎      | 10/30 [00:24<00:52,  2.62s/it]{'epoch': 26, 'num_users': 6.6364, 'loss': 41513.0549, 'hit_ratio@10': 0.2167, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2631}:  37%|███▋      | 11/30 [00:24<00:45,  2.39s/it]{'epoch': 26, 'num_users': 6.4167, 'loss': 38053.6561, 'hit_ratio@10': 0.2334, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0542}:  37%|███▋      | 11/30 [00:25<00:45,  2.39s/it]{'epoch': 26, 'num_users': 6.4167, 'loss': 38053.6561, 'hit_ratio@10': 0.2334, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0542}:  40%|████      | 12/30 [00:25<00:34,  1.90s/it]{'epoch': 26, 'num_users': 6.6154, 'loss': 35193.7455, 'hit_ratio@10': 0.2259, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0607}:  40%|████      | 12/30 [00:27<00:34,  1.90s/it]{'epoch': 26, 'num_users': 6.6154, 'loss': 35193.7455, 'hit_ratio@10': 0.2259, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0607}:  43%|████▎     | 13/30 [00:27<00:30,  1.81s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 39180.0335, 'hit_ratio@10': 0.2098, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8667}:  43%|████▎     | 13/30 [00:27<00:30,  1.81s/it]{'epoch': 26, 'num_users': 6.3571, 'loss': 39180.0335, 'hit_ratio@10': 0.2098, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8667}:  47%|████▋     | 14/30 [00:27<00:22,  1.38s/it]{'epoch': 26, 'num_users': 6.2667, 'loss': 36568.0769, 'hit_ratio@10': 0.213, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.941}:  47%|████▋     | 14/30 [00:29<00:22,  1.38s/it]  {'epoch': 26, 'num_users': 6.2667, 'loss': 36568.0769, 'hit_ratio@10': 0.213, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.941}:  50%|█████     | 15/30 [00:29<00:23,  1.57s/it]{'epoch': 26, 'num_users': 6.0625, 'loss': 34292.8514, 'hit_ratio@10': 0.2049, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8052}:  50%|█████     | 15/30 [00:30<00:23,  1.57s/it]{'epoch': 26, 'num_users': 6.0625, 'loss': 34292.8514, 'hit_ratio@10': 0.2049, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8052}:  53%|█████▎    | 16/30 [00:30<00:18,  1.34s/it]{'epoch': 26, 'num_users': 5.8235, 'loss': 45117.2598, 'hit_ratio@10': 0.2046, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6779}:  53%|█████▎    | 16/30 [00:30<00:18,  1.34s/it]{'epoch': 26, 'num_users': 5.8235, 'loss': 45117.2598, 'hit_ratio@10': 0.2046, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6779}:  57%|█████▋    | 17/30 [00:30<00:13,  1.04s/it]{'epoch': 26, 'num_users': 6.0556, 'loss': 42610.7676, 'hit_ratio@10': 0.2091, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6485}:  57%|█████▋    | 17/30 [00:32<00:13,  1.04s/it]{'epoch': 26, 'num_users': 6.0556, 'loss': 42610.7676, 'hit_ratio@10': 0.2091, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6485}:  60%|██████    | 18/30 [00:32<00:16,  1.38s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 40374.4312, 'hit_ratio@10': 0.2056, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6056}:  60%|██████    | 18/30 [00:33<00:16,  1.38s/it]   {'epoch': 26, 'num_users': 6.0, 'loss': 40374.4312, 'hit_ratio@10': 0.2056, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6056}:  63%|██████▎   | 19/30 [00:33<00:13,  1.25s/it]{'epoch': 26, 'num_users': 6.15, 'loss': 38355.7259, 'hit_ratio@10': 0.2155, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6813}:  63%|██████▎   | 19/30 [00:37<00:13,  1.25s/it]{'epoch': 26, 'num_users': 6.15, 'loss': 38355.7259, 'hit_ratio@10': 0.2155, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6813}:  67%|██████▋   | 20/30 [00:37<00:21,  2.12s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 36529.2828, 'hit_ratio@10': 0.2172, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.828}:  67%|██████▋   | 20/30 [00:40<00:21,  2.12s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 36529.2828, 'hit_ratio@10': 0.2172, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.828}:  70%|███████   | 21/30 [00:40<00:21,  2.36s/it]{'epoch': 26, 'num_users': 6.1818, 'loss': 34868.9381, 'hit_ratio@10': 0.2176, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7649}:  70%|███████   | 21/30 [00:42<00:21,  2.36s/it]{'epoch': 26, 'num_users': 6.1818, 'loss': 34868.9381, 'hit_ratio@10': 0.2176, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7649}:  73%|███████▎  | 22/30 [00:42<00:16,  2.10s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 33358.5298, 'hit_ratio@10': 0.2147, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7618}:  73%|███████▎  | 22/30 [00:43<00:16,  2.10s/it]{'epoch': 26, 'num_users': 6.1304, 'loss': 33358.5298, 'hit_ratio@10': 0.2147, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7618}:  77%|███████▋  | 23/30 [00:43<00:13,  1.94s/it]{'epoch': 26, 'num_users': 5.9583, 'loss': 40957.6745, 'hit_ratio@10': 0.2141, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6604}:  77%|███████▋  | 23/30 [00:44<00:13,  1.94s/it]{'epoch': 26, 'num_users': 5.9583, 'loss': 40957.6745, 'hit_ratio@10': 0.2141, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6604}:  80%|████████  | 24/30 [00:44<00:08,  1.47s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 73562.7642, 'hit_ratio@10': 0.2055, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5664}:  80%|████████  | 24/30 [00:44<00:08,  1.47s/it]   {'epoch': 26, 'num_users': 5.8, 'loss': 73562.7642, 'hit_ratio@10': 0.2055, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5664}:  83%|████████▎ | 25/30 [00:44<00:05,  1.08s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 70733.4398, 'hit_ratio@10': 0.2075, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.697}:  83%|████████▎ | 25/30 [00:50<00:05,  1.08s/it]{'epoch': 26, 'num_users': 5.8077, 'loss': 70733.4398, 'hit_ratio@10': 0.2075, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.697}:  87%|████████▋ | 26/30 [00:50<00:10,  2.56s/it]{'epoch': 26, 'num_users': 5.8889, 'loss': 68113.699, 'hit_ratio@10': 0.213, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7323}:  87%|████████▋ | 26/30 [00:52<00:10,  2.56s/it] {'epoch': 26, 'num_users': 5.8889, 'loss': 68113.699, 'hit_ratio@10': 0.213, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7323}:  90%|█████████ | 27/30 [00:52<00:07,  2.35s/it]{'epoch': 26, 'num_users': 6.0, 'loss': 65681.0955, 'hit_ratio@10': 0.2138, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7641}:  90%|█████████ | 27/30 [00:55<00:07,  2.35s/it] {'epoch': 26, 'num_users': 6.0, 'loss': 65681.0955, 'hit_ratio@10': 0.2138, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7641}:  93%|█████████▎| 28/30 [00:55<00:05,  2.74s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 63416.2425, 'hit_ratio@10': 0.2143, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7667}:  93%|█████████▎| 28/30 [00:57<00:05,  2.74s/it]{'epoch': 26, 'num_users': 5.8621, 'loss': 63416.2425, 'hit_ratio@10': 0.2143, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7667}:  97%|█████████▋| 29/30 [00:57<00:02,  2.36s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 61302.381, 'hit_ratio@10': 0.2152, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7609}:  97%|█████████▋| 29/30 [01:00<00:02,  2.36s/it] {'epoch': 26, 'num_users': 5.8667, 'loss': 61302.381, 'hit_ratio@10': 0.2152, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7609}: 100%|██████████| 30/30 [01:00<00:00,  2.44s/it]{'epoch': 26, 'num_users': 5.8667, 'loss': 61302.381, 'hit_ratio@10': 0.2152, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7609}: 100%|██████████| 30/30 [01:00<00:00,  2.00s/it]
Epoch: 26
Avg # of users: 5.866666666666666
Avg Loss: 61302.381047358336
Avg hit ratio: 0.21522620478642282
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.760872785250346
Std train time: 1.7503700756279885
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.286, 'hit_ratio@10': 0.3158, 'ndcg@10': 0.4099, 'compress@10': 1.0, 'time@10': 2.6033}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.286, 'hit_ratio@10': 0.3158, 'ndcg@10': 0.4099, 'compress@10': 1.0, 'time@10': 2.6033}:   3%|▎         | 1/30 [00:01<00:38,  1.33s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 1.0579, 'hit_ratio@10': 0.2547, 'ndcg@10': 1.1003, 'compress@10': 1.0, 'time@10': 2.3668}:   3%|▎         | 1/30 [00:03<00:38,  1.33s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 1.0579, 'hit_ratio@10': 0.2547, 'ndcg@10': 1.1003, 'compress@10': 1.0, 'time@10': 2.3668}:   7%|▋         | 2/30 [00:03<00:50,  1.82s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 39611.7585, 'hit_ratio@10': 0.1698, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8256}:   7%|▋         | 2/30 [00:03<00:50,  1.82s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 39611.7585, 'hit_ratio@10': 0.1698, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8256}:  10%|█         | 3/30 [00:03<00:31,  1.17s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 29708.937, 'hit_ratio@10': 0.1898, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8276}:  10%|█         | 3/30 [00:05<00:31,  1.17s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 29708.937, 'hit_ratio@10': 0.1898, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8276}:  13%|█▎        | 4/30 [00:05<00:37,  1.44s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 23767.2132, 'hit_ratio@10': 0.2159, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.902}:  13%|█▎        | 4/30 [00:09<00:37,  1.44s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 23767.2132, 'hit_ratio@10': 0.2159, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.902}:  17%|█▋        | 5/30 [00:09<00:55,  2.23s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 19806.079, 'hit_ratio@10': 0.2206, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9555}:  17%|█▋        | 5/30 [00:12<00:55,  2.23s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 19806.079, 'hit_ratio@10': 0.2206, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9555}:  20%|██        | 6/30 [00:12<01:01,  2.58s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 16976.7763, 'hit_ratio@10': 0.2234, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0194}:  20%|██        | 6/30 [00:14<01:01,  2.58s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 16976.7763, 'hit_ratio@10': 0.2234, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0194}:  23%|██▎       | 7/30 [00:14<00:52,  2.30s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 14854.9145, 'hit_ratio@10': 0.2312, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9413}:  23%|██▎       | 7/30 [00:16<00:52,  2.30s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 14854.9145, 'hit_ratio@10': 0.2312, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9413}:  27%|██▋       | 8/30 [00:16<00:51,  2.34s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 13204.407, 'hit_ratio@10': 0.2309, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1661}:  27%|██▋       | 8/30 [00:19<00:51,  2.34s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 13204.407, 'hit_ratio@10': 0.2309, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1661}:  30%|███       | 9/30 [00:19<00:50,  2.40s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 11895.1861, 'hit_ratio@10': 0.2169, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1472}:  30%|███       | 9/30 [00:22<00:50,  2.40s/it]  {'epoch': 27, 'num_users': 6.3, 'loss': 11895.1861, 'hit_ratio@10': 0.2169, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1472}:  33%|███▎      | 10/30 [00:22<00:51,  2.58s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 10814.0423, 'hit_ratio@10': 0.2042, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2119}:  33%|███▎      | 10/30 [00:24<00:51,  2.58s/it]{'epoch': 27, 'num_users': 6.6364, 'loss': 10814.0423, 'hit_ratio@10': 0.2042, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2119}:  37%|███▋      | 11/30 [00:24<00:45,  2.39s/it]{'epoch': 27, 'num_users': 6.4167, 'loss': 10013.4274, 'hit_ratio@10': 0.1872, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0089}:  37%|███▋      | 11/30 [00:25<00:45,  2.39s/it]{'epoch': 27, 'num_users': 6.4167, 'loss': 10013.4274, 'hit_ratio@10': 0.1872, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0089}:  40%|████      | 12/30 [00:25<00:34,  1.91s/it]{'epoch': 27, 'num_users': 6.6154, 'loss': 9243.198, 'hit_ratio@10': 0.1937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0055}:  40%|████      | 12/30 [00:26<00:34,  1.91s/it]  {'epoch': 27, 'num_users': 6.6154, 'loss': 9243.198, 'hit_ratio@10': 0.1937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0055}:  43%|████▎     | 13/30 [00:26<00:30,  1.79s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 8594.3393, 'hit_ratio@10': 0.1918, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8164}:  43%|████▎     | 13/30 [00:26<00:30,  1.79s/it]{'epoch': 27, 'num_users': 6.3571, 'loss': 8594.3393, 'hit_ratio@10': 0.1918, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8164}:  47%|████▋     | 14/30 [00:26<00:21,  1.37s/it]{'epoch': 27, 'num_users': 6.2667, 'loss': 8021.5113, 'hit_ratio@10': 0.1876, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9084}:  47%|████▋     | 14/30 [00:29<00:21,  1.37s/it]{'epoch': 27, 'num_users': 6.2667, 'loss': 8021.5113, 'hit_ratio@10': 0.1876, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9084}:  50%|█████     | 15/30 [00:29<00:23,  1.60s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 7524.7759, 'hit_ratio@10': 0.1759, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7742}:  50%|█████     | 15/30 [00:29<00:23,  1.60s/it]{'epoch': 27, 'num_users': 6.0625, 'loss': 7524.7759, 'hit_ratio@10': 0.1759, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7742}:  53%|█████▎    | 16/30 [00:29<00:18,  1.35s/it]{'epoch': 27, 'num_users': 5.8235, 'loss': 8228.9236, 'hit_ratio@10': 0.1655, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6426}:  53%|█████▎    | 16/30 [00:30<00:18,  1.35s/it]{'epoch': 27, 'num_users': 5.8235, 'loss': 8228.9236, 'hit_ratio@10': 0.1655, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6426}:  57%|█████▋    | 17/30 [00:30<00:13,  1.04s/it]{'epoch': 27, 'num_users': 6.0556, 'loss': 7771.7842, 'hit_ratio@10': 0.1683, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6079}:  57%|█████▋    | 17/30 [00:32<00:13,  1.04s/it]{'epoch': 27, 'num_users': 6.0556, 'loss': 7771.7842, 'hit_ratio@10': 0.1683, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6079}:  60%|██████    | 18/30 [00:32<00:16,  1.34s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 7362.7674, 'hit_ratio@10': 0.1744, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5698}:  60%|██████    | 18/30 [00:33<00:16,  1.34s/it]   {'epoch': 27, 'num_users': 6.0, 'loss': 7362.7674, 'hit_ratio@10': 0.1744, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5698}:  63%|██████▎   | 19/30 [00:33<00:13,  1.23s/it]{'epoch': 27, 'num_users': 6.15, 'loss': 6994.6503, 'hit_ratio@10': 0.1815, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6455}:  63%|██████▎   | 19/30 [00:37<00:13,  1.23s/it]{'epoch': 27, 'num_users': 6.15, 'loss': 6994.6503, 'hit_ratio@10': 0.1815, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6455}:  67%|██████▋   | 20/30 [00:37<00:20,  2.10s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 6661.6417, 'hit_ratio@10': 0.1824, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7947}:  67%|██████▋   | 20/30 [00:40<00:20,  2.10s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 6661.6417, 'hit_ratio@10': 0.1824, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7947}:  70%|███████   | 21/30 [00:40<00:21,  2.34s/it]{'epoch': 27, 'num_users': 6.1818, 'loss': 6358.863, 'hit_ratio@10': 0.1886, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7328}:  70%|███████   | 21/30 [00:41<00:21,  2.34s/it] {'epoch': 27, 'num_users': 6.1818, 'loss': 6358.863, 'hit_ratio@10': 0.1886, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7328}:  73%|███████▎  | 22/30 [00:41<00:16,  2.08s/it]{'epoch': 27, 'num_users': 6.1304, 'loss': 6082.4117, 'hit_ratio@10': 0.1891, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7308}:  73%|███████▎  | 22/30 [00:43<00:16,  2.08s/it]{'epoch': 27, 'num_users': 6.1304, 'loss': 6082.4117, 'hit_ratio@10': 0.1891, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7308}:  77%|███████▋  | 23/30 [00:43<00:13,  1.87s/it]{'epoch': 27, 'num_users': 5.9583, 'loss': 6235.2511, 'hit_ratio@10': 0.1895, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6282}:  77%|███████▋  | 23/30 [00:43<00:13,  1.87s/it]{'epoch': 27, 'num_users': 5.9583, 'loss': 6235.2511, 'hit_ratio@10': 0.1895, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6282}:  80%|████████  | 24/30 [00:43<00:08,  1.40s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 17321.9161, 'hit_ratio@10': 0.1819, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5339}:  80%|████████  | 24/30 [00:43<00:08,  1.40s/it]  {'epoch': 27, 'num_users': 5.8, 'loss': 17321.9161, 'hit_ratio@10': 0.1819, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5339}:  83%|████████▎ | 25/30 [00:43<00:05,  1.03s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 16655.7034, 'hit_ratio@10': 0.1829, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6577}:  83%|████████▎ | 25/30 [00:49<00:05,  1.03s/it]{'epoch': 27, 'num_users': 5.8077, 'loss': 16655.7034, 'hit_ratio@10': 0.1829, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6577}:  87%|████████▋ | 26/30 [00:49<00:09,  2.45s/it]{'epoch': 27, 'num_users': 5.8889, 'loss': 16039.2137, 'hit_ratio@10': 0.188, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.714}:  87%|████████▋ | 26/30 [00:51<00:09,  2.45s/it]  {'epoch': 27, 'num_users': 5.8889, 'loss': 16039.2137, 'hit_ratio@10': 0.188, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.714}:  90%|█████████ | 27/30 [00:51<00:07,  2.35s/it]{'epoch': 27, 'num_users': 6.0, 'loss': 15466.4105, 'hit_ratio@10': 0.1946, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7569}:  90%|█████████ | 27/30 [00:55<00:07,  2.35s/it] {'epoch': 27, 'num_users': 6.0, 'loss': 15466.4105, 'hit_ratio@10': 0.1946, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7569}:  93%|█████████▎| 28/30 [00:55<00:05,  2.83s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 14933.1013, 'hit_ratio@10': 0.1958, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7588}:  93%|█████████▎| 28/30 [00:56<00:05,  2.83s/it]{'epoch': 27, 'num_users': 5.8621, 'loss': 14933.1013, 'hit_ratio@10': 0.1958, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7588}:  97%|█████████▋| 29/30 [00:56<00:02,  2.41s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 14435.3396, 'hit_ratio@10': 0.1937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7473}:  97%|█████████▋| 29/30 [00:59<00:02,  2.41s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 14435.3396, 'hit_ratio@10': 0.1937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7473}: 100%|██████████| 30/30 [00:59<00:00,  2.42s/it]{'epoch': 27, 'num_users': 5.8667, 'loss': 14435.3396, 'hit_ratio@10': 0.1937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7473}: 100%|██████████| 30/30 [00:59<00:00,  1.98s/it]
Epoch: 27
Avg # of users: 5.866666666666666
Avg Loss: 14435.339641977705
Avg hit ratio: 0.1937333401094268
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7473058144251508
Std train time: 1.74595095802541
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 3.8164, 'hit_ratio@10': 0.2632, 'ndcg@10': 6.8119, 'compress@10': 1.0, 'time@10': 2.4386}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 3.8164, 'hit_ratio@10': 0.2632, 'ndcg@10': 6.8119, 'compress@10': 1.0, 'time@10': 2.4386}:   3%|▎         | 1/30 [00:01<00:36,  1.25s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 21.4554, 'hit_ratio@10': 0.1638, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2708}:   3%|▎         | 1/30 [00:03<00:36,  1.25s/it]  {'epoch': 28, 'num_users': 7.0, 'loss': 21.4554, 'hit_ratio@10': 0.1638, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2708}:   7%|▋         | 2/30 [00:03<00:49,  1.77s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 33.603, 'hit_ratio@10': 0.1092, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7897}:   7%|▋         | 2/30 [00:03<00:49,  1.77s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 33.603, 'hit_ratio@10': 0.1092, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7897}:  10%|█         | 3/30 [00:03<00:31,  1.16s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 25.3256, 'hit_ratio@10': 0.1444, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.819}:  10%|█         | 3/30 [00:05<00:31,  1.16s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 25.3256, 'hit_ratio@10': 0.1444, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.819}:  13%|█▎        | 4/30 [00:05<00:38,  1.47s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 23.4947, 'hit_ratio@10': 0.1675, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9028}:  13%|█▎        | 4/30 [00:09<00:38,  1.47s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 23.4947, 'hit_ratio@10': 0.1675, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9028}:  17%|█▋        | 5/30 [00:09<00:56,  2.26s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 5470.1347, 'hit_ratio@10': 0.1581, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9314}:  17%|█▋        | 5/30 [00:12<00:56,  2.26s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 5470.1347, 'hit_ratio@10': 0.1581, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9314}:  20%|██        | 6/30 [00:12<01:01,  2.54s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 4688.7357, 'hit_ratio@10': 0.1641, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9907}:  20%|██        | 6/30 [00:14<01:01,  2.54s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 4688.7357, 'hit_ratio@10': 0.1641, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9907}:  23%|██▎       | 7/30 [00:14<00:52,  2.27s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 4391.48, 'hit_ratio@10': 0.1615, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9203}:  23%|██▎       | 7/30 [00:16<00:52,  2.27s/it]   {'epoch': 28, 'num_users': 6.125, 'loss': 4391.48, 'hit_ratio@10': 0.1615, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9203}:  27%|██▋       | 8/30 [00:16<00:51,  2.33s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 37883.2655, 'hit_ratio@10': 0.1499, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1468}:  27%|██▋       | 8/30 [00:19<00:51,  2.33s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 37883.2655, 'hit_ratio@10': 0.1499, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1468}:  30%|███       | 9/30 [00:19<00:50,  2.39s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 34099.1645, 'hit_ratio@10': 0.1531, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1378}:  30%|███       | 9/30 [00:22<00:50,  2.39s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 34099.1645, 'hit_ratio@10': 0.1531, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1378}:  33%|███▎      | 10/30 [00:22<00:52,  2.60s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 30999.4402, 'hit_ratio@10': 0.1811, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.19}:  33%|███▎      | 10/30 [00:24<00:52,  2.60s/it]{'epoch': 28, 'num_users': 6.6364, 'loss': 30999.4402, 'hit_ratio@10': 0.1811, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.19}:  37%|███▋      | 11/30 [00:24<00:45,  2.38s/it]{'epoch': 28, 'num_users': 6.4167, 'loss': 28416.2858, 'hit_ratio@10': 0.1799, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9892}:  37%|███▋      | 11/30 [00:24<00:45,  2.38s/it]{'epoch': 28, 'num_users': 6.4167, 'loss': 28416.2858, 'hit_ratio@10': 0.1799, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9892}:  40%|████      | 12/30 [00:24<00:34,  1.90s/it]{'epoch': 28, 'num_users': 6.6154, 'loss': 26230.4508, 'hit_ratio@10': 0.187, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9962}:  40%|████      | 12/30 [00:26<00:34,  1.90s/it] {'epoch': 28, 'num_users': 6.6154, 'loss': 26230.4508, 'hit_ratio@10': 0.187, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9962}:  43%|████▎     | 13/30 [00:26<00:30,  1.80s/it]{'epoch': 28, 'num_users': 6.3571, 'loss': 152650.6502, 'hit_ratio@10': 0.1737, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8074}:  43%|████▎     | 13/30 [00:26<00:30,  1.80s/it]{'epoch': 28, 'num_users': 6.3571, 'loss': 152650.6502, 'hit_ratio@10': 0.1737, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8074}:  47%|████▋     | 14/30 [00:26<00:21,  1.37s/it]{'epoch': 28, 'num_users': 6.2667, 'loss': 142481.2103, 'hit_ratio@10': 0.1707, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9007}:  47%|████▋     | 14/30 [00:29<00:21,  1.37s/it]{'epoch': 28, 'num_users': 6.2667, 'loss': 142481.2103, 'hit_ratio@10': 0.1707, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9007}:  50%|█████     | 15/30 [00:29<00:24,  1.60s/it]{'epoch': 28, 'num_users': 6.0625, 'loss': 133921.5975, 'hit_ratio@10': 0.1652, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7676}:  50%|█████     | 15/30 [00:29<00:24,  1.60s/it]{'epoch': 28, 'num_users': 6.0625, 'loss': 133921.5975, 'hit_ratio@10': 0.1652, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7676}:  53%|█████▎    | 16/30 [00:29<00:19,  1.36s/it]{'epoch': 28, 'num_users': 5.8235, 'loss': 301203.852, 'hit_ratio@10': 0.1555, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6386}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it] {'epoch': 28, 'num_users': 5.8235, 'loss': 301203.852, 'hit_ratio@10': 0.1555, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6386}:  57%|█████▋    | 17/30 [00:30<00:13,  1.05s/it]{'epoch': 28, 'num_users': 6.0556, 'loss': 284470.3258, 'hit_ratio@10': 0.1548, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6049}:  57%|█████▋    | 17/30 [00:32<00:13,  1.05s/it]{'epoch': 28, 'num_users': 6.0556, 'loss': 284470.3258, 'hit_ratio@10': 0.1548, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6049}:  60%|██████    | 18/30 [00:32<00:16,  1.36s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 269533.4285, 'hit_ratio@10': 0.1504, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5681}:  60%|██████    | 18/30 [00:33<00:16,  1.36s/it]   {'epoch': 28, 'num_users': 6.0, 'loss': 269533.4285, 'hit_ratio@10': 0.1504, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5681}:  63%|██████▎   | 19/30 [00:33<00:13,  1.24s/it]{'epoch': 28, 'num_users': 6.15, 'loss': 256056.7788, 'hit_ratio@10': 0.1587, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6482}:  63%|██████▎   | 19/30 [00:37<00:13,  1.24s/it]{'epoch': 28, 'num_users': 6.15, 'loss': 256056.7788, 'hit_ratio@10': 0.1587, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6482}:  67%|██████▋   | 20/30 [00:37<00:21,  2.13s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 243863.6306, 'hit_ratio@10': 0.1619, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8047}:  67%|██████▋   | 20/30 [00:40<00:21,  2.13s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 243863.6306, 'hit_ratio@10': 0.1619, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8047}:  70%|███████   | 21/30 [00:40<00:21,  2.39s/it]{'epoch': 28, 'num_users': 6.1818, 'loss': 232779.048, 'hit_ratio@10': 0.1648, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7418}:  70%|███████   | 21/30 [00:41<00:21,  2.39s/it] {'epoch': 28, 'num_users': 6.1818, 'loss': 232779.048, 'hit_ratio@10': 0.1648, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7418}:  73%|███████▎  | 22/30 [00:41<00:16,  2.11s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 260916.2026, 'hit_ratio@10': 0.162, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7385}:  73%|███████▎  | 22/30 [00:43<00:16,  2.11s/it]{'epoch': 28, 'num_users': 6.1304, 'loss': 260916.2026, 'hit_ratio@10': 0.162, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7385}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it]{'epoch': 28, 'num_users': 5.9583, 'loss': 433145.0921, 'hit_ratio@10': 0.1636, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6355}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it]{'epoch': 28, 'num_users': 5.9583, 'loss': 433145.0921, 'hit_ratio@10': 0.1636, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6355}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 949408.0884, 'hit_ratio@10': 0.157, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5411}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]    {'epoch': 28, 'num_users': 5.8, 'loss': 949408.0884, 'hit_ratio@10': 0.157, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5411}:  83%|████████▎ | 25/30 [00:43<00:05,  1.04s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 912892.4099, 'hit_ratio@10': 0.1595, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.664}:  83%|████████▎ | 25/30 [00:49<00:05,  1.04s/it]{'epoch': 28, 'num_users': 5.8077, 'loss': 912892.4099, 'hit_ratio@10': 0.1595, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.664}:  87%|████████▋ | 26/30 [00:49<00:09,  2.46s/it]{'epoch': 28, 'num_users': 5.8889, 'loss': 879303.6741, 'hit_ratio@10': 0.1562, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.709}:  87%|████████▋ | 26/30 [00:51<00:09,  2.46s/it]{'epoch': 28, 'num_users': 5.8889, 'loss': 879303.6741, 'hit_ratio@10': 0.1562, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.709}:  90%|█████████ | 27/30 [00:51<00:06,  2.31s/it]{'epoch': 28, 'num_users': 6.0, 'loss': 857973.5513, 'hit_ratio@10': 0.1576, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7443}:  90%|█████████ | 27/30 [00:55<00:06,  2.31s/it]  {'epoch': 28, 'num_users': 6.0, 'loss': 857973.5513, 'hit_ratio@10': 0.1576, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7443}:  93%|█████████▎| 28/30 [00:55<00:05,  2.74s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 828388.3157, 'hit_ratio@10': 0.1585, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7484}:  93%|█████████▎| 28/30 [00:56<00:05,  2.74s/it]{'epoch': 28, 'num_users': 5.8621, 'loss': 828388.3157, 'hit_ratio@10': 0.1585, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7484}:  97%|█████████▋| 29/30 [00:56<00:02,  2.35s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 800824.6, 'hit_ratio@10': 0.1559, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7395}:  97%|█████████▋| 29/30 [00:59<00:02,  2.35s/it]   {'epoch': 28, 'num_users': 5.8667, 'loss': 800824.6, 'hit_ratio@10': 0.1559, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7395}: 100%|██████████| 30/30 [00:59<00:00,  2.40s/it]{'epoch': 28, 'num_users': 5.8667, 'loss': 800824.6, 'hit_ratio@10': 0.1559, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7395}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 28
Avg # of users: 5.866666666666666
Avg Loss: 800824.600026694
Avg hit ratio: 0.15587225616978764
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7395238240559894
Std train time: 1.73834233784531
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 9.9387, 'hit_ratio@10': 0.0526, 'ndcg@10': 52.0569, 'compress@10': 1.0, 'time@10': 2.6427}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 9.9387, 'hit_ratio@10': 0.0526, 'ndcg@10': 52.0569, 'compress@10': 1.0, 'time@10': 2.6427}:   3%|▎         | 1/30 [00:01<00:39,  1.35s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 414410.5945, 'hit_ratio@10': 0.0424, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3691}:   3%|▎         | 1/30 [00:03<00:39,  1.35s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 414410.5945, 'hit_ratio@10': 0.0424, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3691}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 1071379.9667, 'hit_ratio@10': 0.0283, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8348}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 1071379.9667, 'hit_ratio@10': 0.0283, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8348}:  10%|█         | 3/30 [00:03<00:31,  1.17s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 803535.08, 'hit_ratio@10': 0.0837, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8234}:  10%|█         | 3/30 [00:05<00:31,  1.17s/it]   {'epoch': 29, 'num_users': 5.0, 'loss': 803535.08, 'hit_ratio@10': 0.0837, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8234}:  13%|█▎        | 4/30 [00:05<00:37,  1.43s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 642828.1564, 'hit_ratio@10': 0.131, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8608}:  13%|█▎        | 4/30 [00:09<00:37,  1.43s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 642828.1564, 'hit_ratio@10': 0.131, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8608}:  17%|█▋        | 5/30 [00:09<00:54,  2.19s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 535690.1789, 'hit_ratio@10': 0.1499, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9117}:  17%|█▋        | 5/30 [00:12<00:54,  2.19s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 535690.1789, 'hit_ratio@10': 0.1499, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9117}:  20%|██        | 6/30 [00:12<01:00,  2.53s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 459163.2402, 'hit_ratio@10': 0.1628, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9937}:  20%|██        | 6/30 [00:14<01:00,  2.53s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 459163.2402, 'hit_ratio@10': 0.1628, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9937}:  23%|██▎       | 7/30 [00:14<00:52,  2.28s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 401767.8674, 'hit_ratio@10': 0.1924, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9134}:  23%|██▎       | 7/30 [00:16<00:52,  2.28s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 401767.8674, 'hit_ratio@10': 0.1924, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9134}:  27%|██▋       | 8/30 [00:16<00:50,  2.31s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 357127.15, 'hit_ratio@10': 0.1964, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1147}:  27%|██▋       | 8/30 [00:18<00:50,  2.31s/it] {'epoch': 29, 'num_users': 6.3333, 'loss': 357127.15, 'hit_ratio@10': 0.1964, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1147}:  30%|███       | 9/30 [00:18<00:49,  2.34s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 321420.801, 'hit_ratio@10': 0.1927, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1049}:  30%|███       | 9/30 [00:22<00:49,  2.34s/it]  {'epoch': 29, 'num_users': 6.3, 'loss': 321420.801, 'hit_ratio@10': 0.1927, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1049}:  33%|███▎      | 10/30 [00:22<00:51,  2.56s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 292200.7581, 'hit_ratio@10': 0.1927, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1638}:  33%|███▎      | 10/30 [00:23<00:51,  2.56s/it]{'epoch': 29, 'num_users': 6.6364, 'loss': 292200.7581, 'hit_ratio@10': 0.1927, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1638}:  37%|███▋      | 11/30 [00:23<00:44,  2.36s/it]{'epoch': 29, 'num_users': 6.4167, 'loss': 269796.326, 'hit_ratio@10': 0.1836, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.965}:  37%|███▋      | 11/30 [00:24<00:44,  2.36s/it]  {'epoch': 29, 'num_users': 6.4167, 'loss': 269796.326, 'hit_ratio@10': 0.1836, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.965}:  40%|████      | 12/30 [00:24<00:33,  1.89s/it]{'epoch': 29, 'num_users': 6.6154, 'loss': 249042.8148, 'hit_ratio@10': 0.1904, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9731}:  40%|████      | 12/30 [00:26<00:33,  1.89s/it]{'epoch': 29, 'num_users': 6.6154, 'loss': 249042.8148, 'hit_ratio@10': 0.1904, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9731}:  43%|████▎     | 13/30 [00:26<00:30,  1.79s/it]{'epoch': 29, 'num_users': 6.3571, 'loss': 232825.3441, 'hit_ratio@10': 0.1768, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7856}:  43%|████▎     | 13/30 [00:26<00:30,  1.79s/it]{'epoch': 29, 'num_users': 6.3571, 'loss': 232825.3441, 'hit_ratio@10': 0.1768, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7856}:  47%|████▋     | 14/30 [00:26<00:21,  1.36s/it]{'epoch': 29, 'num_users': 6.2667, 'loss': 217304.1363, 'hit_ratio@10': 0.1801, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8802}:  47%|████▋     | 14/30 [00:28<00:21,  1.36s/it]{'epoch': 29, 'num_users': 6.2667, 'loss': 217304.1363, 'hit_ratio@10': 0.1801, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8802}:  50%|█████     | 15/30 [00:28<00:23,  1.59s/it]{'epoch': 29, 'num_users': 6.0625, 'loss': 203722.7126, 'hit_ratio@10': 0.1792, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7473}:  50%|█████     | 15/30 [00:29<00:23,  1.59s/it]{'epoch': 29, 'num_users': 6.0625, 'loss': 203722.7126, 'hit_ratio@10': 0.1792, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7473}:  53%|█████▎    | 16/30 [00:29<00:18,  1.35s/it]{'epoch': 29, 'num_users': 5.8235, 'loss': 198265.491, 'hit_ratio@10': 0.1805, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6181}:  53%|█████▎    | 16/30 [00:29<00:18,  1.35s/it] {'epoch': 29, 'num_users': 5.8235, 'loss': 198265.491, 'hit_ratio@10': 0.1805, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6181}:  57%|█████▋    | 17/30 [00:29<00:13,  1.04s/it]{'epoch': 29, 'num_users': 6.0556, 'loss': 187251.055, 'hit_ratio@10': 0.1744, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5843}:  57%|█████▋    | 17/30 [00:31<00:13,  1.04s/it]{'epoch': 29, 'num_users': 6.0556, 'loss': 187251.055, 'hit_ratio@10': 0.1744, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5843}:  60%|██████    | 18/30 [00:31<00:16,  1.34s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 177395.7867, 'hit_ratio@10': 0.1803, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5444}:  60%|██████    | 18/30 [00:32<00:16,  1.34s/it]  {'epoch': 29, 'num_users': 6.0, 'loss': 177395.7867, 'hit_ratio@10': 0.1803, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5444}:  63%|██████▎   | 19/30 [00:32<00:13,  1.22s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 168526.0169, 'hit_ratio@10': 0.187, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6186}:  63%|██████▎   | 19/30 [00:36<00:13,  1.22s/it]{'epoch': 29, 'num_users': 6.15, 'loss': 168526.0169, 'hit_ratio@10': 0.187, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6186}:  67%|██████▋   | 20/30 [00:36<00:20,  2.07s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 160500.9866, 'hit_ratio@10': 0.1865, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7898}:  67%|██████▋   | 20/30 [00:40<00:20,  2.07s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 160500.9866, 'hit_ratio@10': 0.1865, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7898}:  70%|███████   | 21/30 [00:40<00:21,  2.39s/it]{'epoch': 29, 'num_users': 6.1818, 'loss': 153205.5701, 'hit_ratio@10': 0.1925, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7295}:  70%|███████   | 21/30 [00:41<00:21,  2.39s/it]{'epoch': 29, 'num_users': 6.1818, 'loss': 153205.5701, 'hit_ratio@10': 0.1925, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7295}:  73%|███████▎  | 22/30 [00:41<00:16,  2.12s/it]{'epoch': 29, 'num_users': 6.1304, 'loss': 146544.8027, 'hit_ratio@10': 0.1884, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7251}:  73%|███████▎  | 22/30 [00:42<00:16,  2.12s/it]{'epoch': 29, 'num_users': 6.1304, 'loss': 146544.8027, 'hit_ratio@10': 0.1884, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7251}:  77%|███████▋  | 23/30 [00:42<00:13,  1.89s/it]{'epoch': 29, 'num_users': 5.9583, 'loss': 149253.763, 'hit_ratio@10': 0.1889, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6227}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it] {'epoch': 29, 'num_users': 5.9583, 'loss': 149253.763, 'hit_ratio@10': 0.1889, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6227}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 439597.3592, 'hit_ratio@10': 0.1814, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5294}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]  {'epoch': 29, 'num_users': 5.8, 'loss': 439597.3592, 'hit_ratio@10': 0.1814, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5294}:  83%|████████▎ | 25/30 [00:43<00:05,  1.04s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 422689.7843, 'hit_ratio@10': 0.1828, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6615}:  83%|████████▎ | 25/30 [00:49<00:05,  1.04s/it]{'epoch': 29, 'num_users': 5.8077, 'loss': 422689.7843, 'hit_ratio@10': 0.1828, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6615}:  87%|████████▋ | 26/30 [00:49<00:10,  2.53s/it]{'epoch': 29, 'num_users': 5.8889, 'loss': 407034.6182, 'hit_ratio@10': 0.1853, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7087}:  87%|████████▋ | 26/30 [00:51<00:10,  2.53s/it]{'epoch': 29, 'num_users': 5.8889, 'loss': 407034.6182, 'hit_ratio@10': 0.1853, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7087}:  90%|█████████ | 27/30 [00:51<00:07,  2.37s/it]{'epoch': 29, 'num_users': 6.0, 'loss': 392497.6851, 'hit_ratio@10': 0.1871, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7425}:  90%|█████████ | 27/30 [00:55<00:07,  2.37s/it]   {'epoch': 29, 'num_users': 6.0, 'loss': 392497.6851, 'hit_ratio@10': 0.1871, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7425}:  93%|█████████▎| 28/30 [00:55<00:05,  2.77s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 378963.3458, 'hit_ratio@10': 0.1869, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7446}:  93%|█████████▎| 28/30 [00:56<00:05,  2.77s/it]{'epoch': 29, 'num_users': 5.8621, 'loss': 378963.3458, 'hit_ratio@10': 0.1869, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7446}:  97%|█████████▋| 29/30 [00:56<00:02,  2.38s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 366331.2422, 'hit_ratio@10': 0.1852, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7388}:  97%|█████████▋| 29/30 [00:59<00:02,  2.38s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 366331.2422, 'hit_ratio@10': 0.1852, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7388}: 100%|██████████| 30/30 [00:59<00:00,  2.45s/it]{'epoch': 29, 'num_users': 5.8667, 'loss': 366331.2422, 'hit_ratio@10': 0.1852, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7388}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 29
Avg # of users: 5.866666666666666
Avg Loss: 366331.24216709187
Avg hit ratio: 0.1851903873649787
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.738767647743225
Std train time: 1.7465570099065069
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 6.3659, 'hit_ratio@10': 0.1579, 'ndcg@10': 30.2894, 'compress@10': 1.0, 'time@10': 2.5787}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 6.3659, 'hit_ratio@10': 0.1579, 'ndcg@10': 30.2894, 'compress@10': 1.0, 'time@10': 2.5787}:   3%|▎         | 1/30 [00:01<00:38,  1.32s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 3.3626, 'hit_ratio@10': 0.1112, 'ndcg@10': 15.4492, 'compress@10': 1.0, 'time@10': 2.4144}:   3%|▎         | 1/30 [00:03<00:38,  1.32s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 3.3626, 'hit_ratio@10': 0.1112, 'ndcg@10': 15.4492, 'compress@10': 1.0, 'time@10': 2.4144}:   7%|▋         | 2/30 [00:03<00:52,  1.89s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 6524.363, 'hit_ratio@10': 0.1218, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8774}:   7%|▋         | 2/30 [00:04<00:52,  1.89s/it]  {'epoch': 30, 'num_users': 5.0, 'loss': 6524.363, 'hit_ratio@10': 0.1218, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8774}:  10%|█         | 3/30 [00:04<00:33,  1.22s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 6859.1939, 'hit_ratio@10': 0.127, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.882}:  10%|█         | 3/30 [00:05<00:33,  1.22s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 6859.1939, 'hit_ratio@10': 0.127, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.882}:  13%|█▎        | 4/30 [00:05<00:38,  1.50s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 5490.8657, 'hit_ratio@10': 0.1376, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.944}:  13%|█▎        | 4/30 [00:09<00:38,  1.50s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 5490.8657, 'hit_ratio@10': 0.1376, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.944}:  17%|█▋        | 5/30 [00:09<00:56,  2.27s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 4576.2959, 'hit_ratio@10': 0.1443, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.951}:  17%|█▋        | 5/30 [00:12<00:56,  2.27s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 4576.2959, 'hit_ratio@10': 0.1443, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.951}:  20%|██        | 6/30 [00:12<01:00,  2.52s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 3925.6319, 'hit_ratio@10': 0.1408, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0327}:  20%|██        | 6/30 [00:14<01:00,  2.52s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 3925.6319, 'hit_ratio@10': 0.1408, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0327}:  23%|██▎       | 7/30 [00:14<00:52,  2.28s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 3435.4047, 'hit_ratio@10': 0.1482, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9496}:  23%|██▎       | 7/30 [00:16<00:52,  2.28s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 3435.4047, 'hit_ratio@10': 0.1482, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9496}:  27%|██▋       | 8/30 [00:16<00:51,  2.32s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 3067.3948, 'hit_ratio@10': 0.1381, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1706}:  27%|██▋       | 8/30 [00:19<00:51,  2.32s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 3067.3948, 'hit_ratio@10': 0.1381, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1706}:  30%|███       | 9/30 [00:19<00:49,  2.38s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 2760.7018, 'hit_ratio@10': 0.1448, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.147}:  30%|███       | 9/30 [00:22<00:49,  2.38s/it]    {'epoch': 30, 'num_users': 6.3, 'loss': 2760.7018, 'hit_ratio@10': 0.1448, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.147}:  33%|███▎      | 10/30 [00:22<00:51,  2.56s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 2509.9303, 'hit_ratio@10': 0.1491, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1981}:  33%|███▎      | 10/30 [00:24<00:51,  2.56s/it]{'epoch': 30, 'num_users': 6.6364, 'loss': 2509.9303, 'hit_ratio@10': 0.1491, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1981}:  37%|███▋      | 11/30 [00:24<00:44,  2.35s/it]{'epoch': 30, 'num_users': 6.4167, 'loss': 2301.409, 'hit_ratio@10': 0.1436, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9944}:  37%|███▋      | 11/30 [00:24<00:44,  2.35s/it] {'epoch': 30, 'num_users': 6.4167, 'loss': 2301.409, 'hit_ratio@10': 0.1436, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9944}:  40%|████      | 12/30 [00:24<00:33,  1.87s/it]{'epoch': 30, 'num_users': 6.6154, 'loss': 2124.5364, 'hit_ratio@10': 0.1465, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9937}:  40%|████      | 12/30 [00:26<00:33,  1.87s/it]{'epoch': 30, 'num_users': 6.6154, 'loss': 2124.5364, 'hit_ratio@10': 0.1465, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9937}:  43%|████▎     | 13/30 [00:26<00:30,  1.77s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 1029719.7942, 'hit_ratio@10': 0.1361, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8034}:  43%|████▎     | 13/30 [00:26<00:30,  1.77s/it]{'epoch': 30, 'num_users': 6.3571, 'loss': 1029719.7942, 'hit_ratio@10': 0.1361, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8034}:  47%|████▋     | 14/30 [00:26<00:21,  1.34s/it]{'epoch': 30, 'num_users': 6.2667, 'loss': 961147.7718, 'hit_ratio@10': 0.1378, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8856}:  47%|████▋     | 14/30 [00:28<00:21,  1.34s/it] {'epoch': 30, 'num_users': 6.2667, 'loss': 961147.7718, 'hit_ratio@10': 0.1378, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8856}:  50%|█████     | 15/30 [00:28<00:23,  1.55s/it]{'epoch': 30, 'num_users': 6.0625, 'loss': 906189.2896, 'hit_ratio@10': 0.1344, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7536}:  50%|█████     | 15/30 [00:29<00:23,  1.55s/it]{'epoch': 30, 'num_users': 6.0625, 'loss': 906189.2896, 'hit_ratio@10': 0.1344, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7536}:  53%|█████▎    | 16/30 [00:29<00:18,  1.33s/it]{'epoch': 30, 'num_users': 5.8235, 'loss': 3352945.9196, 'hit_ratio@10': 0.1382, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6234}:  53%|█████▎    | 16/30 [00:29<00:18,  1.33s/it]{'epoch': 30, 'num_users': 5.8235, 'loss': 3352945.9196, 'hit_ratio@10': 0.1382, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6234}:  57%|█████▋    | 17/30 [00:29<00:13,  1.02s/it]{'epoch': 30, 'num_users': 6.0556, 'loss': 3166671.1709, 'hit_ratio@10': 0.1365, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5874}:  57%|█████▋    | 17/30 [00:31<00:13,  1.02s/it]{'epoch': 30, 'num_users': 6.0556, 'loss': 3166671.1709, 'hit_ratio@10': 0.1365, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5874}:  60%|██████    | 18/30 [00:31<00:15,  1.32s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 3000438.7254, 'hit_ratio@10': 0.1368, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.544}:  60%|██████    | 18/30 [00:32<00:15,  1.32s/it]    {'epoch': 30, 'num_users': 6.0, 'loss': 3000438.7254, 'hit_ratio@10': 0.1368, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.544}:  63%|██████▎   | 19/30 [00:32<00:13,  1.19s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 2850416.8164, 'hit_ratio@10': 0.1458, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6269}:  63%|██████▎   | 19/30 [00:37<00:13,  1.19s/it]{'epoch': 30, 'num_users': 6.15, 'loss': 2850416.8164, 'hit_ratio@10': 0.1458, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6269}:  67%|██████▋   | 20/30 [00:37<00:21,  2.11s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 2714682.8238, 'hit_ratio@10': 0.1472, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7858}:  67%|██████▋   | 20/30 [00:40<00:21,  2.11s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 2714682.8238, 'hit_ratio@10': 0.1472, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7858}:  70%|███████   | 21/30 [00:40<00:21,  2.38s/it]{'epoch': 30, 'num_users': 6.1818, 'loss': 2591288.1856, 'hit_ratio@10': 0.1549, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7238}:  70%|███████   | 21/30 [00:41<00:21,  2.38s/it]{'epoch': 30, 'num_users': 6.1818, 'loss': 2591288.1856, 'hit_ratio@10': 0.1549, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7238}:  73%|███████▎  | 22/30 [00:41<00:16,  2.10s/it]{'epoch': 30, 'num_users': 6.1304, 'loss': 2478623.6245, 'hit_ratio@10': 0.1569, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7197}:  73%|███████▎  | 22/30 [00:42<00:16,  2.10s/it]{'epoch': 30, 'num_users': 6.1304, 'loss': 2478623.6245, 'hit_ratio@10': 0.1569, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7197}:  77%|███████▋  | 23/30 [00:42<00:13,  1.87s/it]{'epoch': 30, 'num_users': 5.9583, 'loss': 3999348.9298, 'hit_ratio@10': 0.1587, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6179}:  77%|███████▋  | 23/30 [00:43<00:13,  1.87s/it]{'epoch': 30, 'num_users': 5.9583, 'loss': 3999348.9298, 'hit_ratio@10': 0.1587, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6179}:  80%|████████  | 24/30 [00:43<00:08,  1.40s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 6253961.5859, 'hit_ratio@10': 0.1523, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5236}:  80%|████████  | 24/30 [00:43<00:08,  1.40s/it]   {'epoch': 30, 'num_users': 5.8, 'loss': 6253961.5859, 'hit_ratio@10': 0.1523, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5236}:  83%|████████▎ | 25/30 [00:43<00:05,  1.14s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 6013424.6206, 'hit_ratio@10': 0.1549, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6529}:  83%|████████▎ | 25/30 [00:49<00:05,  1.14s/it]{'epoch': 30, 'num_users': 5.8077, 'loss': 6013424.6206, 'hit_ratio@10': 0.1549, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6529}:  87%|████████▋ | 26/30 [00:49<00:10,  2.57s/it]{'epoch': 30, 'num_users': 5.8889, 'loss': 5790705.6274, 'hit_ratio@10': 0.1545, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7017}:  87%|████████▋ | 26/30 [00:51<00:10,  2.57s/it]{'epoch': 30, 'num_users': 5.8889, 'loss': 5790705.6274, 'hit_ratio@10': 0.1545, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7017}:  90%|█████████ | 27/30 [00:51<00:07,  2.42s/it]{'epoch': 30, 'num_users': 6.0, 'loss': 5715231.2675, 'hit_ratio@10': 0.1525, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7377}:  90%|█████████ | 27/30 [00:55<00:07,  2.42s/it]   {'epoch': 30, 'num_users': 6.0, 'loss': 5715231.2675, 'hit_ratio@10': 0.1525, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7377}:  93%|█████████▎| 28/30 [00:55<00:05,  2.82s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 5518154.3523, 'hit_ratio@10': 0.155, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7422}:  93%|█████████▎| 28/30 [00:56<00:05,  2.82s/it]{'epoch': 30, 'num_users': 5.8621, 'loss': 5518154.3523, 'hit_ratio@10': 0.155, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7422}:  97%|█████████▋| 29/30 [00:56<00:02,  2.42s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 5334215.9503, 'hit_ratio@10': 0.1544, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7385}:  97%|█████████▋| 29/30 [00:59<00:02,  2.42s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 5334215.9503, 'hit_ratio@10': 0.1544, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7385}: 100%|██████████| 30/30 [00:59<00:00,  2.49s/it]{'epoch': 30, 'num_users': 5.8667, 'loss': 5334215.9503, 'hit_ratio@10': 0.1544, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7385}: 100%|██████████| 30/30 [00:59<00:00,  1.99s/it]
Epoch: 30
Avg # of users: 5.866666666666666
Avg Loss: 5334215.950251139
Avg hit ratio: 0.1543820604122395
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7384947776794433
Std train time: 1.749223178455009
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 210.7684, 'hit_ratio@10': 0.1053, 'ndcg@10': 2336675344621.082, 'compress@10': 1.0, 'time@10': 2.6135}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 210.7684, 'hit_ratio@10': 0.1053, 'ndcg@10': 2336675344621.082, 'compress@10': 1.0, 'time@10': 2.6135}:   3%|▎         | 1/30 [00:01<00:38,  1.34s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 11543688.2897, 'hit_ratio@10': 0.0849, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3914}:   3%|▎         | 1/30 [00:03<00:38,  1.34s/it]         {'epoch': 31, 'num_users': 7.0, 'loss': 11543688.2897, 'hit_ratio@10': 0.0849, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3914}:   7%|▋         | 2/30 [00:03<00:51,  1.84s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 17856320.9772, 'hit_ratio@10': 0.1042, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8646}:   7%|▋         | 2/30 [00:03<00:51,  1.84s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 17856320.9772, 'hit_ratio@10': 0.1042, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8646}:  10%|█         | 3/30 [00:03<00:32,  1.20s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 13392240.9962, 'hit_ratio@10': 0.1407, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8951}:  10%|█         | 3/30 [00:05<00:32,  1.20s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 13392240.9962, 'hit_ratio@10': 0.1407, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8951}:  13%|█▎        | 4/30 [00:05<00:39,  1.53s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 10713792.9061, 'hit_ratio@10': 0.1765, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9194}:  13%|█▎        | 4/30 [00:09<00:39,  1.53s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 10713792.9061, 'hit_ratio@10': 0.1765, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9194}:  17%|█▋        | 5/30 [00:09<00:56,  2.25s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 8928160.916, 'hit_ratio@10': 0.1878, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9613}:  17%|█▋        | 5/30 [00:12<00:56,  2.25s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 8928160.916, 'hit_ratio@10': 0.1878, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9613}:  20%|██        | 6/30 [00:12<01:01,  2.58s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 8935436.6613, 'hit_ratio@10': 0.1724, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0334}:  20%|██        | 6/30 [00:14<01:01,  2.58s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 8935436.6613, 'hit_ratio@10': 0.1724, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0334}:  23%|██▎       | 7/30 [00:14<00:53,  2.31s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 7818507.1857, 'hit_ratio@10': 0.1902, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9538}:  23%|██▎       | 7/30 [00:16<00:53,  2.31s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 7818507.1857, 'hit_ratio@10': 0.1902, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9538}:  27%|██▋       | 8/30 [00:16<00:51,  2.36s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 6949784.5577, 'hit_ratio@10': 0.1944, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.151}:  27%|██▋       | 8/30 [00:19<00:51,  2.36s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 6949784.5577, 'hit_ratio@10': 0.1944, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.151}:  30%|███       | 9/30 [00:19<00:49,  2.37s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 6254807.8495, 'hit_ratio@10': 0.1841, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1361}:  30%|███       | 9/30 [00:22<00:49,  2.37s/it]  {'epoch': 31, 'num_users': 6.3, 'loss': 6254807.8495, 'hit_ratio@10': 0.1841, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1361}:  33%|███▎      | 10/30 [00:22<00:51,  2.57s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 5686189.0689, 'hit_ratio@10': 0.1813, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1808}:  33%|███▎      | 10/30 [00:24<00:51,  2.57s/it]{'epoch': 31, 'num_users': 6.6364, 'loss': 5686189.0689, 'hit_ratio@10': 0.1813, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1808}:  37%|███▋      | 11/30 [00:24<00:44,  2.35s/it]{'epoch': 31, 'num_users': 6.4167, 'loss': 5242671.6925, 'hit_ratio@10': 0.1801, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9806}:  37%|███▋      | 11/30 [00:25<00:44,  2.35s/it]{'epoch': 31, 'num_users': 6.4167, 'loss': 5242671.6925, 'hit_ratio@10': 0.1801, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9806}:  40%|████      | 12/30 [00:25<00:33,  1.88s/it]{'epoch': 31, 'num_users': 6.6154, 'loss': 4839389.5248, 'hit_ratio@10': 0.1872, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9828}:  40%|████      | 12/30 [00:26<00:33,  1.88s/it]{'epoch': 31, 'num_users': 6.6154, 'loss': 4839389.5248, 'hit_ratio@10': 0.1872, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9828}:  43%|████▎     | 13/30 [00:26<00:30,  1.78s/it]{'epoch': 31, 'num_users': 6.3571, 'loss': 4493883.9839, 'hit_ratio@10': 0.1739, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7942}:  43%|████▎     | 13/30 [00:26<00:30,  1.78s/it]{'epoch': 31, 'num_users': 6.3571, 'loss': 4493883.9839, 'hit_ratio@10': 0.1739, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7942}:  47%|████▋     | 14/30 [00:26<00:21,  1.35s/it]{'epoch': 31, 'num_users': 6.2667, 'loss': 4199634.9351, 'hit_ratio@10': 0.1709, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8891}:  47%|████▋     | 14/30 [00:29<00:21,  1.35s/it]{'epoch': 31, 'num_users': 6.2667, 'loss': 4199634.9351, 'hit_ratio@10': 0.1709, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8891}:  50%|█████     | 15/30 [00:29<00:23,  1.59s/it]{'epoch': 31, 'num_users': 6.0625, 'loss': 3937158.5866, 'hit_ratio@10': 0.1706, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7574}:  50%|█████     | 15/30 [00:29<00:23,  1.59s/it]{'epoch': 31, 'num_users': 6.0625, 'loss': 3937158.5866, 'hit_ratio@10': 0.1706, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7574}:  53%|█████▎    | 16/30 [00:29<00:18,  1.36s/it]{'epoch': 31, 'num_users': 5.8235, 'loss': 3923163.0704, 'hit_ratio@10': 0.1723, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6264}:  53%|█████▎    | 16/30 [00:30<00:18,  1.36s/it]{'epoch': 31, 'num_users': 5.8235, 'loss': 3923163.0704, 'hit_ratio@10': 0.1723, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6264}:  57%|█████▋    | 17/30 [00:30<00:13,  1.04s/it]{'epoch': 31, 'num_users': 6.0556, 'loss': 3705247.5533, 'hit_ratio@10': 0.1648, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5922}:  57%|█████▋    | 17/30 [00:32<00:13,  1.04s/it]{'epoch': 31, 'num_users': 6.0556, 'loss': 3705247.5533, 'hit_ratio@10': 0.1648, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5922}:  60%|██████    | 18/30 [00:32<00:16,  1.36s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 3510237.1074, 'hit_ratio@10': 0.1636, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5504}:  60%|██████    | 18/30 [00:33<00:16,  1.36s/it]   {'epoch': 31, 'num_users': 6.0, 'loss': 3510237.1074, 'hit_ratio@10': 0.1636, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5504}:  63%|██████▎   | 19/30 [00:33<00:13,  1.23s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 3625227.6344, 'hit_ratio@10': 0.1616, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6181}:  63%|██████▎   | 19/30 [00:37<00:13,  1.23s/it]{'epoch': 31, 'num_users': 6.15, 'loss': 3625227.6344, 'hit_ratio@10': 0.1616, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6181}:  67%|██████▋   | 20/30 [00:37<00:20,  2.04s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 3452597.7601, 'hit_ratio@10': 0.1622, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7675}:  67%|██████▋   | 20/30 [00:40<00:20,  2.04s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 3452597.7601, 'hit_ratio@10': 0.1622, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7675}:  70%|███████   | 21/30 [00:40<00:20,  2.30s/it]{'epoch': 31, 'num_users': 6.1818, 'loss': 3295662.5209, 'hit_ratio@10': 0.159, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7073}:  70%|███████   | 21/30 [00:41<00:20,  2.30s/it] {'epoch': 31, 'num_users': 6.1818, 'loss': 3295662.5209, 'hit_ratio@10': 0.159, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7073}:  73%|███████▎  | 22/30 [00:41<00:16,  2.05s/it]{'epoch': 31, 'num_users': 6.1304, 'loss': 3152380.333, 'hit_ratio@10': 0.1586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7068}:  73%|███████▎  | 22/30 [00:42<00:16,  2.05s/it]{'epoch': 31, 'num_users': 6.1304, 'loss': 3152380.333, 'hit_ratio@10': 0.1586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7068}:  77%|███████▋  | 23/30 [00:42<00:12,  1.85s/it]{'epoch': 31, 'num_users': 5.9583, 'loss': 3053371.3831, 'hit_ratio@10': 0.1603, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.605}:  77%|███████▋  | 23/30 [00:43<00:12,  1.85s/it]{'epoch': 31, 'num_users': 5.9583, 'loss': 3053371.3831, 'hit_ratio@10': 0.1603, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.605}:  80%|████████  | 24/30 [00:43<00:08,  1.38s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 8625625.8822, 'hit_ratio@10': 0.1539, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5113}:  80%|████████  | 24/30 [00:43<00:08,  1.38s/it]  {'epoch': 31, 'num_users': 5.8, 'loss': 8625625.8822, 'hit_ratio@10': 0.1539, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5113}:  83%|████████▎ | 25/30 [00:43<00:05,  1.02s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 8293871.0972, 'hit_ratio@10': 0.1564, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6426}:  83%|████████▎ | 25/30 [00:49<00:05,  1.02s/it]{'epoch': 31, 'num_users': 5.8077, 'loss': 8293871.0972, 'hit_ratio@10': 0.1564, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6426}:  87%|████████▋ | 26/30 [00:49<00:09,  2.50s/it]{'epoch': 31, 'num_users': 5.8889, 'loss': 7986690.6979, 'hit_ratio@10': 0.1599, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.692}:  87%|████████▋ | 26/30 [00:51<00:09,  2.50s/it] {'epoch': 31, 'num_users': 5.8889, 'loss': 7986690.6979, 'hit_ratio@10': 0.1599, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.692}:  90%|█████████ | 27/30 [00:51<00:07,  2.35s/it]{'epoch': 31, 'num_users': 6.0, 'loss': 7701451.7894, 'hit_ratio@10': 0.1626, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7252}:  90%|█████████ | 27/30 [00:55<00:07,  2.35s/it]  {'epoch': 31, 'num_users': 6.0, 'loss': 7701451.7894, 'hit_ratio@10': 0.1626, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7252}:  93%|█████████▎| 28/30 [00:55<00:05,  2.74s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 7435885.535, 'hit_ratio@10': 0.1617, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7271}:  93%|█████████▎| 28/30 [00:56<00:05,  2.74s/it]{'epoch': 31, 'num_users': 5.8621, 'loss': 7435885.535, 'hit_ratio@10': 0.1617, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7271}:  97%|█████████▋| 29/30 [00:56<00:02,  2.35s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 7188022.6918, 'hit_ratio@10': 0.1608, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7236}:  97%|█████████▋| 29/30 [00:59<00:02,  2.35s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 7188022.6918, 'hit_ratio@10': 0.1608, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7236}: 100%|██████████| 30/30 [00:59<00:00,  2.44s/it]{'epoch': 31, 'num_users': 5.8667, 'loss': 7188022.6918, 'hit_ratio@10': 0.1608, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7236}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 31
Avg # of users: 5.866666666666666
Avg Loss: 7188022.691778126
Avg hit ratio: 0.16077929157527512
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7236302932103476
Std train time: 1.7068973912052712
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 101.2075, 'hit_ratio@10': 0.0, 'ndcg@10': 69590717251.2668, 'compress@10': 1.0, 'time@10': 2.5465}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 101.2075, 'hit_ratio@10': 0.0, 'ndcg@10': 69590717251.2668, 'compress@10': 1.0, 'time@10': 2.5465}:   3%|▎         | 1/30 [00:01<00:38,  1.32s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 51.0587, 'hit_ratio@10': 0.0323, 'ndcg@10': 34795358626.1885, 'compress@10': 1.0, 'time@10': 2.3371}:   3%|▎         | 1/30 [00:03<00:38,  1.32s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 51.0587, 'hit_ratio@10': 0.0323, 'ndcg@10': 34795358626.1885, 'compress@10': 1.0, 'time@10': 2.3371}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 36342.694, 'hit_ratio@10': 0.0215, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8331}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]           {'epoch': 32, 'num_users': 5.0, 'loss': 36342.694, 'hit_ratio@10': 0.0215, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8331}:  10%|█         | 3/30 [00:03<00:32,  1.19s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 27272.5161, 'hit_ratio@10': 0.0429, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8552}:  10%|█         | 3/30 [00:05<00:32,  1.19s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 27272.5161, 'hit_ratio@10': 0.0429, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8552}:  13%|█▎        | 4/30 [00:05<00:38,  1.49s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 2249929.166, 'hit_ratio@10': 0.0623, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9109}:  13%|█▎        | 4/30 [00:09<00:38,  1.49s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 2249929.166, 'hit_ratio@10': 0.0623, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9109}:  17%|█▋        | 5/30 [00:09<00:56,  2.25s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 1900979.6749, 'hit_ratio@10': 0.0705, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.961}:  17%|█▋        | 5/30 [00:12<00:56,  2.25s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 1900979.6749, 'hit_ratio@10': 0.0705, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.961}:  20%|██        | 6/30 [00:12<01:02,  2.59s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 1629411.9551, 'hit_ratio@10': 0.0775, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0287}:  20%|██        | 6/30 [00:14<01:02,  2.59s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 1629411.9551, 'hit_ratio@10': 0.0775, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0287}:  23%|██▎       | 7/30 [00:14<00:53,  2.31s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 1425744.9434, 'hit_ratio@10': 0.0964, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9521}:  23%|██▎       | 7/30 [00:16<00:53,  2.31s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 1425744.9434, 'hit_ratio@10': 0.0964, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9521}:  27%|██▋       | 8/30 [00:16<00:51,  2.35s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 1267334.7341, 'hit_ratio@10': 0.0984, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1771}:  27%|██▋       | 8/30 [00:19<00:51,  2.35s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 1267334.7341, 'hit_ratio@10': 0.0984, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1771}:  30%|███       | 9/30 [00:19<00:50,  2.41s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 1140601.3403, 'hit_ratio@10': 0.109, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1609}:  30%|███       | 9/30 [00:22<00:50,  2.41s/it]    {'epoch': 32, 'num_users': 6.3, 'loss': 1140601.3403, 'hit_ratio@10': 0.109, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1609}:  33%|███▎      | 10/30 [00:22<00:52,  2.60s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 1036913.23, 'hit_ratio@10': 0.1026, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2132}:  33%|███▎      | 10/30 [00:24<00:52,  2.60s/it]{'epoch': 32, 'num_users': 6.6364, 'loss': 1036913.23, 'hit_ratio@10': 0.1026, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2132}:  37%|███▋      | 11/30 [00:24<00:45,  2.39s/it]{'epoch': 32, 'num_users': 6.4167, 'loss': 950511.9749, 'hit_ratio@10': 0.101, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.016}:  37%|███▋      | 11/30 [00:25<00:45,  2.39s/it] {'epoch': 32, 'num_users': 6.4167, 'loss': 950511.9749, 'hit_ratio@10': 0.101, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.016}:  40%|████      | 12/30 [00:25<00:34,  1.93s/it]{'epoch': 32, 'num_users': 6.6154, 'loss': 877399.8731, 'hit_ratio@10': 0.1037, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0063}:  40%|████      | 12/30 [00:26<00:34,  1.93s/it]{'epoch': 32, 'num_users': 6.6154, 'loss': 877399.8731, 'hit_ratio@10': 0.1037, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0063}:  43%|████▎     | 13/30 [00:26<00:30,  1.79s/it]{'epoch': 32, 'num_users': 6.3571, 'loss': 22081344.0488, 'hit_ratio@10': 0.0963, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8126}:  43%|████▎     | 13/30 [00:27<00:30,  1.79s/it]{'epoch': 32, 'num_users': 6.3571, 'loss': 22081344.0488, 'hit_ratio@10': 0.0963, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8126}:  47%|████▋     | 14/30 [00:27<00:21,  1.35s/it]{'epoch': 32, 'num_users': 6.2667, 'loss': 20609254.5165, 'hit_ratio@10': 0.1028, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8933}:  47%|████▋     | 14/30 [00:29<00:21,  1.35s/it]{'epoch': 32, 'num_users': 6.2667, 'loss': 20609254.5165, 'hit_ratio@10': 0.1028, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8933}:  50%|█████     | 15/30 [00:29<00:23,  1.56s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 19410396.5151, 'hit_ratio@10': 0.1016, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7585}:  50%|█████     | 15/30 [00:29<00:23,  1.56s/it]{'epoch': 32, 'num_users': 6.0625, 'loss': 19410396.5151, 'hit_ratio@10': 0.1016, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7585}:  53%|█████▎    | 16/30 [00:29<00:18,  1.32s/it]{'epoch': 32, 'num_users': 5.8235, 'loss': 55785245.8024, 'hit_ratio@10': 0.1074, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6285}:  53%|█████▎    | 16/30 [00:30<00:18,  1.32s/it]{'epoch': 32, 'num_users': 5.8235, 'loss': 55785245.8024, 'hit_ratio@10': 0.1074, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6285}:  57%|█████▋    | 17/30 [00:30<00:13,  1.02s/it]{'epoch': 32, 'num_users': 6.0556, 'loss': 52686065.7103, 'hit_ratio@10': 0.1034, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5934}:  57%|█████▋    | 17/30 [00:32<00:13,  1.02s/it]{'epoch': 32, 'num_users': 6.0556, 'loss': 52686065.7103, 'hit_ratio@10': 0.1034, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5934}:  60%|██████    | 18/30 [00:32<00:15,  1.32s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 49923294.6737, 'hit_ratio@10': 0.1055, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.554}:  60%|██████    | 18/30 [00:33<00:15,  1.32s/it]    {'epoch': 32, 'num_users': 6.0, 'loss': 49923294.6737, 'hit_ratio@10': 0.1055, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.554}:  63%|██████▎   | 19/30 [00:33<00:13,  1.21s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 47427130.0071, 'hit_ratio@10': 0.1151, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6414}:  63%|██████▎   | 19/30 [00:37<00:13,  1.21s/it]{'epoch': 32, 'num_users': 6.15, 'loss': 47427130.0071, 'hit_ratio@10': 0.1151, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6414}:  67%|██████▋   | 20/30 [00:37<00:21,  2.15s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 45169983.4705, 'hit_ratio@10': 0.112, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7921}:  67%|██████▋   | 20/30 [00:40<00:21,  2.15s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 45169983.4705, 'hit_ratio@10': 0.112, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7921}:  70%|███████   | 21/30 [00:40<00:21,  2.38s/it]{'epoch': 32, 'num_users': 6.1818, 'loss': 43116802.7083, 'hit_ratio@10': 0.1152, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7281}:  70%|███████   | 21/30 [00:41<00:21,  2.38s/it]{'epoch': 32, 'num_users': 6.1818, 'loss': 43116802.7083, 'hit_ratio@10': 0.1152, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7281}:  73%|███████▎  | 22/30 [00:41<00:16,  2.09s/it]{'epoch': 32, 'num_users': 6.1304, 'loss': 41242159.7196, 'hit_ratio@10': 0.1167, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7149}:  73%|███████▎  | 22/30 [00:43<00:16,  2.09s/it]{'epoch': 32, 'num_users': 6.1304, 'loss': 41242159.7196, 'hit_ratio@10': 0.1167, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7149}:  77%|███████▋  | 23/30 [00:43<00:12,  1.84s/it]{'epoch': 32, 'num_users': 5.9583, 'loss': 82948234.1979, 'hit_ratio@10': 0.1202, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.612}:  77%|███████▋  | 23/30 [00:43<00:12,  1.84s/it] {'epoch': 32, 'num_users': 5.9583, 'loss': 82948234.1979, 'hit_ratio@10': 0.1202, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.612}:  80%|████████  | 24/30 [00:43<00:08,  1.37s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 170798308.2433, 'hit_ratio@10': 0.1154, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5169}:  80%|████████  | 24/30 [00:43<00:08,  1.37s/it] {'epoch': 32, 'num_users': 5.8, 'loss': 170798308.2433, 'hit_ratio@10': 0.1154, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5169}:  83%|████████▎ | 25/30 [00:43<00:05,  1.00s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 164229142.5632, 'hit_ratio@10': 0.118, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6358}:  83%|████████▎ | 25/30 [00:49<00:05,  1.00s/it]{'epoch': 32, 'num_users': 5.8077, 'loss': 164229142.5632, 'hit_ratio@10': 0.118, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6358}:  87%|████████▋ | 26/30 [00:49<00:09,  2.39s/it]{'epoch': 32, 'num_users': 5.8889, 'loss': 158146582.5796, 'hit_ratio@10': 0.1189, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.685}:  87%|████████▋ | 26/30 [00:51<00:09,  2.39s/it]{'epoch': 32, 'num_users': 5.8889, 'loss': 158146582.5796, 'hit_ratio@10': 0.1189, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.685}:  90%|█████████ | 27/30 [00:51<00:06,  2.28s/it]{'epoch': 32, 'num_users': 6.0, 'loss': 152498491.3433, 'hit_ratio@10': 0.1195, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7204}:  90%|█████████ | 27/30 [00:54<00:06,  2.28s/it]  {'epoch': 32, 'num_users': 6.0, 'loss': 152498491.3433, 'hit_ratio@10': 0.1195, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7204}:  93%|█████████▎| 28/30 [00:54<00:05,  2.71s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 147239923.7029, 'hit_ratio@10': 0.1201, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7278}:  93%|█████████▎| 28/30 [00:56<00:05,  2.71s/it]{'epoch': 32, 'num_users': 5.8621, 'loss': 147239923.7029, 'hit_ratio@10': 0.1201, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7278}:  97%|█████████▋| 29/30 [00:56<00:02,  2.34s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 142331930.0341, 'hit_ratio@10': 0.1197, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7293}:  97%|█████████▋| 29/30 [00:59<00:02,  2.34s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 142331930.0341, 'hit_ratio@10': 0.1197, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7293}: 100%|██████████| 30/30 [00:59<00:00,  2.48s/it]{'epoch': 32, 'num_users': 5.8667, 'loss': 142331930.0341, 'hit_ratio@10': 0.1197, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7293}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 32
Avg # of users: 5.866666666666666
Avg Loss: 142331930.034118
Avg hit ratio: 0.11971195887533671
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.729299275080363
Std train time: 1.724840261636987
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 3614.3283, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.66}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 3614.3283, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.66}:   3%|▎         | 1/30 [00:01<00:39,  1.36s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 70075834.3804, 'hit_ratio@10': 0.0688, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4623}:   3%|▎         | 1/30 [00:03<00:39,  1.36s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 70075834.3804, 'hit_ratio@10': 0.0688, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4623}:   7%|▋         | 2/30 [00:03<00:53,  1.91s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 152525415.3012, 'hit_ratio@10': 0.0458, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9248}:   7%|▋         | 2/30 [00:04<00:53,  1.91s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 152525415.3012, 'hit_ratio@10': 0.0458, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9248}:  10%|█         | 3/30 [00:04<00:33,  1.24s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 114394063.0487, 'hit_ratio@10': 0.079, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9326}:  10%|█         | 3/30 [00:06<00:33,  1.24s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 114394063.0487, 'hit_ratio@10': 0.079, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9326}:  13%|█▎        | 4/30 [00:06<00:39,  1.54s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 91515250.5767, 'hit_ratio@10': 0.1232, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9511}:  13%|█▎        | 4/30 [00:09<00:39,  1.54s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 91515250.5767, 'hit_ratio@10': 0.1232, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9511}:  17%|█▋        | 5/30 [00:09<00:56,  2.26s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 76262710.276, 'hit_ratio@10': 0.1212, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9928}:  17%|█▋        | 5/30 [00:12<00:56,  2.26s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 76262710.276, 'hit_ratio@10': 0.1212, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9928}:  20%|██        | 6/30 [00:12<01:02,  2.59s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 67446484.216, 'hit_ratio@10': 0.121, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0682}:  20%|██        | 6/30 [00:14<01:02,  2.59s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 67446484.216, 'hit_ratio@10': 0.121, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0682}:  23%|██▎       | 7/30 [00:14<00:53,  2.33s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 59015676.2795, 'hit_ratio@10': 0.1309, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9867}:  23%|██▎       | 7/30 [00:17<00:53,  2.33s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 59015676.2795, 'hit_ratio@10': 0.1309, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9867}:  27%|██▋       | 8/30 [00:17<00:52,  2.37s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 52458416.7655, 'hit_ratio@10': 0.1386, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2093}:  27%|██▋       | 8/30 [00:19<00:52,  2.37s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 52458416.7655, 'hit_ratio@10': 0.1386, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2093}:  30%|███       | 9/30 [00:19<00:50,  2.42s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 82936675.9491, 'hit_ratio@10': 0.1361, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1937}:  30%|███       | 9/30 [00:22<00:50,  2.42s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 82936675.9491, 'hit_ratio@10': 0.1361, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1937}:  33%|███▎      | 10/30 [00:22<00:52,  2.62s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 75396979.0641, 'hit_ratio@10': 0.1412, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2367}:  33%|███▎      | 10/30 [00:24<00:52,  2.62s/it]{'epoch': 33, 'num_users': 6.6364, 'loss': 75396979.0641, 'hit_ratio@10': 0.1412, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2367}:  37%|███▋      | 11/30 [00:24<00:45,  2.39s/it]{'epoch': 33, 'num_users': 6.4167, 'loss': 69382445.4876, 'hit_ratio@10': 0.1433, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0299}:  37%|███▋      | 11/30 [00:25<00:45,  2.39s/it]{'epoch': 33, 'num_users': 6.4167, 'loss': 69382445.4876, 'hit_ratio@10': 0.1433, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0299}:  40%|████      | 12/30 [00:25<00:34,  1.90s/it]{'epoch': 33, 'num_users': 6.6154, 'loss': 64045422.8282, 'hit_ratio@10': 0.1393, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0356}:  40%|████      | 12/30 [00:26<00:34,  1.90s/it]{'epoch': 33, 'num_users': 6.6154, 'loss': 64045422.8282, 'hit_ratio@10': 0.1393, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0356}:  43%|████▎     | 13/30 [00:26<00:30,  1.80s/it]{'epoch': 33, 'num_users': 6.3571, 'loss': 59491267.3321, 'hit_ratio@10': 0.1293, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8435}:  43%|████▎     | 13/30 [00:27<00:30,  1.80s/it]{'epoch': 33, 'num_users': 6.3571, 'loss': 59491267.3321, 'hit_ratio@10': 0.1293, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8435}:  47%|████▋     | 14/30 [00:27<00:21,  1.37s/it]{'epoch': 33, 'num_users': 6.2667, 'loss': 55525187.5837, 'hit_ratio@10': 0.125, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9235}:  47%|████▋     | 14/30 [00:29<00:21,  1.37s/it] {'epoch': 33, 'num_users': 6.2667, 'loss': 55525187.5837, 'hit_ratio@10': 0.125, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9235}:  50%|█████     | 15/30 [00:29<00:23,  1.58s/it]{'epoch': 33, 'num_users': 6.0625, 'loss': 52054981.0207, 'hit_ratio@10': 0.1224, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7883}:  50%|█████     | 15/30 [00:30<00:23,  1.58s/it]{'epoch': 33, 'num_users': 6.0625, 'loss': 52054981.0207, 'hit_ratio@10': 0.1224, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7883}:  53%|█████▎    | 16/30 [00:30<00:18,  1.34s/it]{'epoch': 33, 'num_users': 5.8235, 'loss': 49116028.1489, 'hit_ratio@10': 0.127, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6557}:  53%|█████▎    | 16/30 [00:30<00:18,  1.34s/it] {'epoch': 33, 'num_users': 5.8235, 'loss': 49116028.1489, 'hit_ratio@10': 0.127, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6557}:  57%|█████▋    | 17/30 [00:30<00:13,  1.03s/it]{'epoch': 33, 'num_users': 6.0556, 'loss': 46387377.2138, 'hit_ratio@10': 0.1239, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6199}:  57%|█████▋    | 17/30 [00:32<00:13,  1.03s/it]{'epoch': 33, 'num_users': 6.0556, 'loss': 46387377.2138, 'hit_ratio@10': 0.1239, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6199}:  60%|██████    | 18/30 [00:32<00:15,  1.33s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 43945944.7406, 'hit_ratio@10': 0.1249, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5732}:  60%|██████    | 18/30 [00:33<00:15,  1.33s/it]   {'epoch': 33, 'num_users': 6.0, 'loss': 43945944.7406, 'hit_ratio@10': 0.1249, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5732}:  63%|██████▎   | 19/30 [00:33<00:13,  1.20s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 41857589.9481, 'hit_ratio@10': 0.1257, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6356}:  63%|██████▎   | 19/30 [00:37<00:13,  1.20s/it]{'epoch': 33, 'num_users': 6.15, 'loss': 41857589.9481, 'hit_ratio@10': 0.1257, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6356}:  67%|██████▋   | 20/30 [00:37<00:19,  2.00s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 39864371.3923, 'hit_ratio@10': 0.128, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7867}:  67%|██████▋   | 20/30 [00:40<00:19,  2.00s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 39864371.3923, 'hit_ratio@10': 0.128, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7867}:  70%|███████   | 21/30 [00:40<00:20,  2.28s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 38052360.2842, 'hit_ratio@10': 0.1305, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7245}:  70%|███████   | 21/30 [00:41<00:20,  2.28s/it]{'epoch': 33, 'num_users': 6.1818, 'loss': 38052360.2842, 'hit_ratio@10': 0.1305, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7245}:  73%|███████▎  | 22/30 [00:41<00:16,  2.03s/it]{'epoch': 33, 'num_users': 6.1304, 'loss': 36397957.9788, 'hit_ratio@10': 0.1313, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7228}:  73%|███████▎  | 22/30 [00:43<00:16,  2.03s/it]{'epoch': 33, 'num_users': 6.1304, 'loss': 36397957.9788, 'hit_ratio@10': 0.1313, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7228}:  77%|███████▋  | 23/30 [00:43<00:12,  1.83s/it]{'epoch': 33, 'num_users': 5.9583, 'loss': 35561783.438, 'hit_ratio@10': 0.1342, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6204}:  77%|███████▋  | 23/30 [00:43<00:12,  1.83s/it] {'epoch': 33, 'num_users': 5.9583, 'loss': 35561783.438, 'hit_ratio@10': 0.1342, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6204}:  80%|████████  | 24/30 [00:43<00:08,  1.37s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 105997063.1405, 'hit_ratio@10': 0.1288, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5266}:  80%|████████  | 24/30 [00:43<00:08,  1.37s/it] {'epoch': 33, 'num_users': 5.8, 'loss': 105997063.1405, 'hit_ratio@10': 0.1288, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5266}:  83%|████████▎ | 25/30 [00:43<00:05,  1.01s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 101920253.3466, 'hit_ratio@10': 0.1314, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6528}:  83%|████████▎ | 25/30 [00:49<00:05,  1.01s/it]{'epoch': 33, 'num_users': 5.8077, 'loss': 101920253.3466, 'hit_ratio@10': 0.1314, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6528}:  87%|████████▋ | 26/30 [00:49<00:09,  2.46s/it]{'epoch': 33, 'num_users': 5.8889, 'loss': 98145429.3627, 'hit_ratio@10': 0.1291, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6905}:  87%|████████▋ | 26/30 [00:51<00:09,  2.46s/it] {'epoch': 33, 'num_users': 5.8889, 'loss': 98145429.3627, 'hit_ratio@10': 0.1291, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6905}:  90%|█████████ | 27/30 [00:51<00:06,  2.28s/it]{'epoch': 33, 'num_users': 6.0, 'loss': 94640235.4845, 'hit_ratio@10': 0.1322, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7209}:  90%|█████████ | 27/30 [00:54<00:06,  2.28s/it]   {'epoch': 33, 'num_users': 6.0, 'loss': 94640235.4845, 'hit_ratio@10': 0.1322, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7209}:  93%|█████████▎| 28/30 [00:54<00:05,  2.67s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 91376788.1986, 'hit_ratio@10': 0.1308, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7269}:  93%|█████████▎| 28/30 [00:56<00:05,  2.67s/it]{'epoch': 33, 'num_users': 5.8621, 'loss': 91376788.1986, 'hit_ratio@10': 0.1308, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7269}:  97%|█████████▋| 29/30 [00:56<00:02,  2.31s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 88330895.429, 'hit_ratio@10': 0.13, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7249}:  97%|█████████▋| 29/30 [00:58<00:02,  2.31s/it]   {'epoch': 33, 'num_users': 5.8667, 'loss': 88330895.429, 'hit_ratio@10': 0.13, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7249}: 100%|██████████| 30/30 [00:58<00:00,  2.43s/it]{'epoch': 33, 'num_users': 5.8667, 'loss': 88330895.429, 'hit_ratio@10': 0.13, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7249}: 100%|██████████| 30/30 [00:58<00:00,  1.96s/it]
Epoch: 33
Avg # of users: 5.866666666666666
Avg Loss: 88330895.42896202
Avg hit ratio: 0.13004272691502586
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.724906587600708
Std train time: 1.703289260076418
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 1172.072, 'hit_ratio@10': 0.1053, 'ndcg@10': 4.955183782711174e+27, 'compress@10': 1.0, 'time@10': 2.8176}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 1172.072, 'hit_ratio@10': 0.1053, 'ndcg@10': 4.955183782711174e+27, 'compress@10': 1.0, 'time@10': 2.8176}:   3%|▎         | 1/30 [00:01<00:41,  1.45s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 598.1681, 'hit_ratio@10': 0.0849, 'ndcg@10': 2.477591891355587e+27, 'compress@10': 1.0, 'time@10': 2.5211}:   3%|▎         | 1/30 [00:03<00:41,  1.45s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 598.1681, 'hit_ratio@10': 0.0849, 'ndcg@10': 2.477591891355587e+27, 'compress@10': 1.0, 'time@10': 2.5211}:   7%|▋         | 2/30 [00:03<00:53,  1.92s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 39126.1914, 'hit_ratio@10': 0.1042, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9541}:   7%|▋         | 2/30 [00:04<00:53,  1.92s/it]                {'epoch': 34, 'num_users': 5.0, 'loss': 39126.1914, 'hit_ratio@10': 0.1042, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9541}:  10%|█         | 3/30 [00:04<00:33,  1.24s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 29503.0094, 'hit_ratio@10': 0.1049, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9308}:  10%|█         | 3/30 [00:06<00:33,  1.24s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 29503.0094, 'hit_ratio@10': 0.1049, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9308}:  13%|█▎        | 4/30 [00:06<00:38,  1.50s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 31011.5233, 'hit_ratio@10': 0.112, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9782}:  13%|█▎        | 4/30 [00:09<00:38,  1.50s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 31011.5233, 'hit_ratio@10': 0.112, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9782}:  17%|█▋        | 5/30 [00:09<00:56,  2.26s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 284374052.849, 'hit_ratio@10': 0.1118, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0112}:  17%|█▋        | 5/30 [00:12<00:56,  2.26s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 284374052.849, 'hit_ratio@10': 0.1118, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0112}:  20%|██        | 6/30 [00:12<01:02,  2.58s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 243749220.3585, 'hit_ratio@10': 0.1073, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0839}:  20%|██        | 6/30 [00:14<01:02,  2.58s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 243749220.3585, 'hit_ratio@10': 0.1073, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0839}:  23%|██▎       | 7/30 [00:14<00:53,  2.32s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 213280740.3255, 'hit_ratio@10': 0.1189, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9957}:  23%|██▎       | 7/30 [00:17<00:53,  2.32s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 213280740.3255, 'hit_ratio@10': 0.1189, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9957}:  27%|██▋       | 8/30 [00:17<00:51,  2.35s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 189583411.0942, 'hit_ratio@10': 0.1152, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2107}:  27%|██▋       | 8/30 [00:19<00:51,  2.35s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 189583411.0942, 'hit_ratio@10': 0.1152, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2107}:  30%|███       | 9/30 [00:19<00:50,  2.40s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 170625070.01, 'hit_ratio@10': 0.1241, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1922}:  30%|███       | 9/30 [00:22<00:50,  2.40s/it]     {'epoch': 34, 'num_users': 6.3, 'loss': 170625070.01, 'hit_ratio@10': 0.1241, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1922}:  33%|███▎      | 10/30 [00:22<00:52,  2.60s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 155113833.9467, 'hit_ratio@10': 0.1198, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2345}:  33%|███▎      | 10/30 [00:24<00:52,  2.60s/it]{'epoch': 34, 'num_users': 6.6364, 'loss': 155113833.9467, 'hit_ratio@10': 0.1198, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2345}:  37%|███▋      | 11/30 [00:24<00:45,  2.37s/it]{'epoch': 34, 'num_users': 6.4167, 'loss': 142188077.4694, 'hit_ratio@10': 0.1168, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.029}:  37%|███▋      | 11/30 [00:25<00:45,  2.37s/it] {'epoch': 34, 'num_users': 6.4167, 'loss': 142188077.4694, 'hit_ratio@10': 0.1168, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.029}:  40%|████      | 12/30 [00:25<00:34,  1.89s/it]{'epoch': 34, 'num_users': 6.6154, 'loss': 131250619.7432, 'hit_ratio@10': 0.1218, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0375}:  40%|████      | 12/30 [00:26<00:34,  1.89s/it]{'epoch': 34, 'num_users': 6.6154, 'loss': 131250619.7432, 'hit_ratio@10': 0.1218, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0375}:  43%|████▎     | 13/30 [00:26<00:30,  1.81s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 342734537.7616, 'hit_ratio@10': 0.1131, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8453}:  43%|████▎     | 13/30 [00:27<00:30,  1.81s/it]{'epoch': 34, 'num_users': 6.3571, 'loss': 342734537.7616, 'hit_ratio@10': 0.1131, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8453}:  47%|████▋     | 14/30 [00:27<00:21,  1.37s/it]{'epoch': 34, 'num_users': 6.2667, 'loss': 319885572.2223, 'hit_ratio@10': 0.1098, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9357}:  47%|████▋     | 14/30 [00:29<00:21,  1.37s/it]{'epoch': 34, 'num_users': 6.2667, 'loss': 319885572.2223, 'hit_ratio@10': 0.1098, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9357}:  50%|█████     | 15/30 [00:29<00:24,  1.60s/it]{'epoch': 34, 'num_users': 6.0625, 'loss': 300874504.0735, 'hit_ratio@10': 0.1082, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8005}:  50%|█████     | 15/30 [00:30<00:24,  1.60s/it]{'epoch': 34, 'num_users': 6.0625, 'loss': 300874504.0735, 'hit_ratio@10': 0.1082, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8005}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it]{'epoch': 34, 'num_users': 5.8235, 'loss': 1189891525.3397, 'hit_ratio@10': 0.1018, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6679}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it]{'epoch': 34, 'num_users': 5.8235, 'loss': 1189891525.3397, 'hit_ratio@10': 0.1018, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6679}:  57%|█████▋    | 17/30 [00:30<00:13,  1.04s/it]{'epoch': 34, 'num_users': 6.0556, 'loss': 1123786443.3981, 'hit_ratio@10': 0.0962, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6317}:  57%|█████▋    | 17/30 [00:32<00:13,  1.04s/it]{'epoch': 34, 'num_users': 6.0556, 'loss': 1123786443.3981, 'hit_ratio@10': 0.0962, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6317}:  60%|██████    | 18/30 [00:32<00:16,  1.34s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 1064799904.0186, 'hit_ratio@10': 0.0986, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5874}:  60%|██████    | 18/30 [00:33<00:16,  1.34s/it]   {'epoch': 34, 'num_users': 6.0, 'loss': 1064799904.0186, 'hit_ratio@10': 0.0986, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5874}:  63%|██████▎   | 19/30 [00:33<00:13,  1.22s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 1011559908.8566, 'hit_ratio@10': 0.1095, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6677}:  63%|██████▎   | 19/30 [00:37<00:13,  1.22s/it]{'epoch': 34, 'num_users': 6.15, 'loss': 1011559908.8566, 'hit_ratio@10': 0.1095, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6677}:  67%|██████▋   | 20/30 [00:37<00:21,  2.12s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 963390423.3304, 'hit_ratio@10': 0.109, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8176}:  67%|██████▋   | 20/30 [00:40<00:21,  2.12s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 963390423.3304, 'hit_ratio@10': 0.109, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8176}:  70%|███████   | 21/30 [00:40<00:21,  2.37s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 919599950.5941, 'hit_ratio@10': 0.1165, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7528}:  70%|███████   | 21/30 [00:42<00:21,  2.37s/it]{'epoch': 34, 'num_users': 6.1818, 'loss': 919599950.5941, 'hit_ratio@10': 0.1165, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7528}:  73%|███████▎  | 22/30 [00:42<00:16,  2.08s/it]{'epoch': 34, 'num_users': 6.1304, 'loss': 879617373.5831, 'hit_ratio@10': 0.1158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7449}:  73%|███████▎  | 22/30 [00:43<00:16,  2.08s/it]{'epoch': 34, 'num_users': 6.1304, 'loss': 879617373.5831, 'hit_ratio@10': 0.1158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7449}:  77%|███████▋  | 23/30 [00:43<00:12,  1.85s/it]{'epoch': 34, 'num_users': 5.9583, 'loss': 1126622291.2838, 'hit_ratio@10': 0.1276, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6414}:  77%|███████▋  | 23/30 [00:43<00:12,  1.85s/it]{'epoch': 34, 'num_users': 5.9583, 'loss': 1126622291.2838, 'hit_ratio@10': 0.1276, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6414}:  80%|████████  | 24/30 [00:43<00:08,  1.38s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 1947939687.8458, 'hit_ratio@10': 0.1225, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5456}:  80%|████████  | 24/30 [00:43<00:08,  1.38s/it]   {'epoch': 34, 'num_users': 5.8, 'loss': 1947939687.8458, 'hit_ratio@10': 0.1225, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5456}:  83%|████████▎ | 25/30 [00:43<00:05,  1.01s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 1873018931.2806, 'hit_ratio@10': 0.1262, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6642}:  83%|████████▎ | 25/30 [00:49<00:05,  1.01s/it]{'epoch': 34, 'num_users': 5.8077, 'loss': 1873018931.2806, 'hit_ratio@10': 0.1262, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6642}:  87%|████████▋ | 26/30 [00:49<00:09,  2.41s/it]{'epoch': 34, 'num_users': 5.8889, 'loss': 1803647890.8561, 'hit_ratio@10': 0.1268, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7129}:  87%|████████▋ | 26/30 [00:51<00:09,  2.41s/it]{'epoch': 34, 'num_users': 5.8889, 'loss': 1803647890.8561, 'hit_ratio@10': 0.1268, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7129}:  90%|█████████ | 27/30 [00:51<00:06,  2.29s/it]{'epoch': 34, 'num_users': 6.0, 'loss': 1740872771.4431, 'hit_ratio@10': 0.1258, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7517}:  90%|█████████ | 27/30 [00:55<00:06,  2.29s/it]   {'epoch': 34, 'num_users': 6.0, 'loss': 1740872771.4431, 'hit_ratio@10': 0.1258, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7517}:  93%|█████████▎| 28/30 [00:55<00:05,  2.75s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 1680842682.7882, 'hit_ratio@10': 0.1246, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7583}:  93%|█████████▎| 28/30 [00:56<00:05,  2.75s/it]{'epoch': 34, 'num_users': 5.8621, 'loss': 1680842682.7882, 'hit_ratio@10': 0.1246, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7583}:  97%|█████████▋| 29/30 [00:56<00:02,  2.38s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 1624814661.1972, 'hit_ratio@10': 0.1241, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7496}:  97%|█████████▋| 29/30 [00:59<00:02,  2.38s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 1624814661.1972, 'hit_ratio@10': 0.1241, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7496}: 100%|██████████| 30/30 [00:59<00:00,  2.42s/it]{'epoch': 34, 'num_users': 5.8667, 'loss': 1624814661.1972, 'hit_ratio@10': 0.1241, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7496}: 100%|██████████| 30/30 [00:59<00:00,  1.98s/it]
Epoch: 34
Avg # of users: 5.866666666666666
Avg Loss: 1624814661.197177
Avg hit ratio: 0.12406246115630747
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7495954990386964
Std train time: 1.7310579680437943
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 49756.2171, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5878}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 49756.2171, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5878}:   3%|▎         | 1/30 [00:01<00:38,  1.32s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 26564.682, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3535}:   3%|▎         | 1/30 [00:03<00:38,  1.32s/it] {'epoch': 35, 'num_users': 7.0, 'loss': 26564.682, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3535}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 1723303660.2642, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8352}:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 1723303660.2642, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8352}:  10%|█         | 3/30 [00:03<00:31,  1.18s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 1292477777.9748, 'hit_ratio@10': 0.1156, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8545}:  10%|█         | 3/30 [00:05<00:31,  1.18s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 1292477777.9748, 'hit_ratio@10': 0.1156, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8545}:  13%|█▎        | 4/30 [00:05<00:38,  1.48s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 1033982233.8159, 'hit_ratio@10': 0.1245, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9297}:  13%|█▎        | 4/30 [00:09<00:38,  1.48s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 1033982233.8159, 'hit_ratio@10': 0.1245, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9297}:  17%|█▋        | 5/30 [00:09<00:56,  2.26s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 861651877.8241, 'hit_ratio@10': 0.126, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9662}:  17%|█▋        | 5/30 [00:12<00:56,  2.26s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 861651877.8241, 'hit_ratio@10': 0.126, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9662}:  20%|██        | 6/30 [00:12<01:01,  2.57s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 738559088.5077, 'hit_ratio@10': 0.108, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0355}:  20%|██        | 6/30 [00:14<01:01,  2.57s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 738559088.5077, 'hit_ratio@10': 0.108, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0355}:  23%|██▎       | 7/30 [00:14<00:53,  2.31s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 646239214.2836, 'hit_ratio@10': 0.1088, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9591}:  23%|██▎       | 7/30 [00:16<00:53,  2.31s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 646239214.2836, 'hit_ratio@10': 0.1088, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9591}:  27%|██▋       | 8/30 [00:16<00:51,  2.36s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 574434857.5983, 'hit_ratio@10': 0.1062, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2044}:  27%|██▋       | 8/30 [00:20<00:51,  2.36s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 574434857.5983, 'hit_ratio@10': 0.1062, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2044}:  30%|███       | 9/30 [00:20<00:55,  2.62s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 517002549.3282, 'hit_ratio@10': 0.1024, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1945}:  30%|███       | 9/30 [00:23<00:55,  2.62s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 517002549.3282, 'hit_ratio@10': 0.1024, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1945}:  33%|███▎      | 10/30 [00:23<00:55,  2.78s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 470002339.8168, 'hit_ratio@10': 0.1001, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2283}:  33%|███▎      | 10/30 [00:25<00:55,  2.78s/it]{'epoch': 35, 'num_users': 6.6364, 'loss': 470002339.8168, 'hit_ratio@10': 0.1001, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2283}:  37%|███▋      | 11/30 [00:25<00:47,  2.49s/it]{'epoch': 35, 'num_users': 6.4167, 'loss': 434862376.7974, 'hit_ratio@10': 0.1056, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0242}:  37%|███▋      | 11/30 [00:25<00:47,  2.49s/it]{'epoch': 35, 'num_users': 6.4167, 'loss': 434862376.7974, 'hit_ratio@10': 0.1056, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0242}:  40%|████      | 12/30 [00:25<00:35,  1.98s/it]{'epoch': 35, 'num_users': 6.6154, 'loss': 401411474.7821, 'hit_ratio@10': 0.115, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0295}:  40%|████      | 12/30 [00:27<00:35,  1.98s/it] {'epoch': 35, 'num_users': 6.6154, 'loss': 401411474.7821, 'hit_ratio@10': 0.115, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0295}:  43%|████▎     | 13/30 [00:27<00:31,  1.87s/it]{'epoch': 35, 'num_users': 6.3571, 'loss': 372877162.6479, 'hit_ratio@10': 0.1068, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8375}:  43%|████▎     | 13/30 [00:27<00:31,  1.87s/it]{'epoch': 35, 'num_users': 6.3571, 'loss': 372877162.6479, 'hit_ratio@10': 0.1068, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8375}:  47%|████▋     | 14/30 [00:27<00:22,  1.42s/it]{'epoch': 35, 'num_users': 6.2667, 'loss': 348018821.223, 'hit_ratio@10': 0.1126, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9302}:  47%|████▋     | 14/30 [00:29<00:22,  1.42s/it] {'epoch': 35, 'num_users': 6.2667, 'loss': 348018821.223, 'hit_ratio@10': 0.1126, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9302}:  50%|█████     | 15/30 [00:29<00:24,  1.63s/it]{'epoch': 35, 'num_users': 6.0625, 'loss': 326268820.9873, 'hit_ratio@10': 0.1107, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7947}:  50%|█████     | 15/30 [00:30<00:24,  1.63s/it]{'epoch': 35, 'num_users': 6.0625, 'loss': 326268820.9873, 'hit_ratio@10': 0.1107, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7947}:  53%|█████▎    | 16/30 [00:30<00:19,  1.38s/it]{'epoch': 35, 'num_users': 5.8235, 'loss': 352272521.2115, 'hit_ratio@10': 0.1042, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6624}:  53%|█████▎    | 16/30 [00:31<00:19,  1.38s/it]{'epoch': 35, 'num_users': 5.8235, 'loss': 352272521.2115, 'hit_ratio@10': 0.1042, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6624}:  57%|█████▋    | 17/30 [00:31<00:13,  1.06s/it]{'epoch': 35, 'num_users': 6.0556, 'loss': 332701939.7967, 'hit_ratio@10': 0.1024, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6261}:  57%|█████▋    | 17/30 [00:33<00:13,  1.06s/it]{'epoch': 35, 'num_users': 6.0556, 'loss': 332701939.7967, 'hit_ratio@10': 0.1024, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6261}:  60%|██████    | 18/30 [00:33<00:16,  1.35s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 315191550.7033, 'hit_ratio@10': 0.1008, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5841}:  60%|██████    | 18/30 [00:34<00:16,  1.35s/it]   {'epoch': 35, 'num_users': 6.0, 'loss': 315191550.7033, 'hit_ratio@10': 0.1008, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5841}:  63%|██████▎   | 19/30 [00:34<00:13,  1.23s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 299551772.3359, 'hit_ratio@10': 0.1027, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6602}:  63%|██████▎   | 19/30 [00:38<00:13,  1.23s/it]{'epoch': 35, 'num_users': 6.15, 'loss': 299551772.3359, 'hit_ratio@10': 0.1027, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6602}:  67%|██████▋   | 20/30 [00:38<00:21,  2.10s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 285287406.8778, 'hit_ratio@10': 0.1026, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.812}:  67%|██████▋   | 20/30 [00:41<00:21,  2.10s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 285287406.8778, 'hit_ratio@10': 0.1026, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.812}:  70%|███████   | 21/30 [00:41<00:21,  2.36s/it]{'epoch': 35, 'num_users': 6.1818, 'loss': 272320010.4736, 'hit_ratio@10': 0.1021, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7493}:  70%|███████   | 21/30 [00:42<00:21,  2.36s/it]{'epoch': 35, 'num_users': 6.1818, 'loss': 272320010.4736, 'hit_ratio@10': 0.1021, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7493}:  73%|███████▎  | 22/30 [00:42<00:16,  2.09s/it]{'epoch': 35, 'num_users': 6.1304, 'loss': 260480696.54, 'hit_ratio@10': 0.102, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7451}:  73%|███████▎  | 22/30 [00:43<00:16,  2.09s/it]   {'epoch': 35, 'num_users': 6.1304, 'loss': 260480696.54, 'hit_ratio@10': 0.102, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7451}:  77%|███████▋  | 23/30 [00:43<00:13,  1.87s/it]{'epoch': 35, 'num_users': 5.9583, 'loss': 262753059.1842, 'hit_ratio@10': 0.1061, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6418}:  77%|███████▋  | 23/30 [00:44<00:13,  1.87s/it]{'epoch': 35, 'num_users': 5.9583, 'loss': 262753059.1842, 'hit_ratio@10': 0.1061, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6418}:  80%|████████  | 24/30 [00:44<00:08,  1.40s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 1918184768.4968, 'hit_ratio@10': 0.1018, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5471}:  80%|████████  | 24/30 [00:44<00:08,  1.40s/it]  {'epoch': 35, 'num_users': 5.8, 'loss': 1918184768.4968, 'hit_ratio@10': 0.1018, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5471}:  83%|████████▎ | 25/30 [00:44<00:05,  1.03s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 1844408431.7217, 'hit_ratio@10': 0.104, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6758}:  83%|████████▎ | 25/30 [00:50<00:05,  1.03s/it]{'epoch': 35, 'num_users': 5.8077, 'loss': 1844408431.7217, 'hit_ratio@10': 0.104, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6758}:  87%|████████▋ | 26/30 [00:50<00:09,  2.50s/it]{'epoch': 35, 'num_users': 5.8889, 'loss': 1776097010.8452, 'hit_ratio@10': 0.1055, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.71}:  87%|████████▋ | 26/30 [00:52<00:09,  2.50s/it] {'epoch': 35, 'num_users': 5.8889, 'loss': 1776097010.8452, 'hit_ratio@10': 0.1055, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.71}:  90%|█████████ | 27/30 [00:52<00:06,  2.30s/it]{'epoch': 35, 'num_users': 6.0, 'loss': 1712664974.8978, 'hit_ratio@10': 0.1052, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7446}:  90%|█████████ | 27/30 [00:55<00:06,  2.30s/it] {'epoch': 35, 'num_users': 6.0, 'loss': 1712664974.8978, 'hit_ratio@10': 0.1052, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7446}:  93%|█████████▎| 28/30 [00:55<00:05,  2.72s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 1653607628.7216, 'hit_ratio@10': 0.1047, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7493}:  93%|█████████▎| 28/30 [00:57<00:05,  2.72s/it]{'epoch': 35, 'num_users': 5.8621, 'loss': 1653607628.7216, 'hit_ratio@10': 0.1047, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7493}:  97%|█████████▋| 29/30 [00:57<00:02,  2.35s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 1598487378.9614, 'hit_ratio@10': 0.1021, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7444}:  97%|█████████▋| 29/30 [01:00<00:02,  2.35s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 1598487378.9614, 'hit_ratio@10': 0.1021, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7444}: 100%|██████████| 30/30 [01:00<00:00,  2.43s/it]{'epoch': 35, 'num_users': 5.8667, 'loss': 1598487378.9614, 'hit_ratio@10': 0.1021, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7444}: 100%|██████████| 30/30 [01:00<00:00,  2.00s/it]
Epoch: 35
Avg # of users: 5.866666666666666
Avg Loss: 1598487378.9613752
Avg hit ratio: 0.10210505102166431
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.744431241353353
Std train time: 1.7470700615036785
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 119788822.3224, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7905}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 119788822.3224, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7905}:   3%|▎         | 1/30 [00:01<00:41,  1.43s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 59895237.7826, 'hit_ratio@10': 0.0424, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5421}:   3%|▎         | 1/30 [00:03<00:41,  1.43s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 59895237.7826, 'hit_ratio@10': 0.0424, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5421}:   7%|▋         | 2/30 [00:03<00:54,  1.96s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 40266242.1849, 'hit_ratio@10': 0.0759, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9416}:   7%|▋         | 2/30 [00:04<00:54,  1.96s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 40266242.1849, 'hit_ratio@10': 0.0759, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9416}:  10%|█         | 3/30 [00:04<00:33,  1.24s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 5529085479.4645, 'hit_ratio@10': 0.0748, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9017}:  10%|█         | 3/30 [00:05<00:33,  1.24s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 5529085479.4645, 'hit_ratio@10': 0.0748, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9017}:  13%|█▎        | 4/30 [00:05<00:38,  1.47s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 4423268724.4081, 'hit_ratio@10': 0.0838, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0414}:  13%|█▎        | 4/30 [00:09<00:38,  1.47s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 4423268724.4081, 'hit_ratio@10': 0.0838, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0414}:  17%|█▋        | 5/30 [00:09<00:58,  2.32s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 7432165826.775, 'hit_ratio@10': 0.081, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0781}:  17%|█▋        | 5/30 [00:13<00:58,  2.32s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 7432165826.775, 'hit_ratio@10': 0.081, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0781}:  20%|██        | 6/30 [00:13<01:03,  2.65s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 6370427916.5183, 'hit_ratio@10': 0.0923, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1406}:  20%|██        | 6/30 [00:14<01:03,  2.65s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 6370427916.5183, 'hit_ratio@10': 0.0923, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1406}:  23%|██▎       | 7/30 [00:14<00:54,  2.37s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 5574462354.2862, 'hit_ratio@10': 0.0914, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0444}:  23%|██▎       | 7/30 [00:17<00:54,  2.37s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 5574462354.2862, 'hit_ratio@10': 0.0914, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0444}:  27%|██▋       | 8/30 [00:17<00:52,  2.38s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 4955431592.1323, 'hit_ratio@10': 0.0845, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2612}:  27%|██▋       | 8/30 [00:19<00:52,  2.38s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 4955431592.1323, 'hit_ratio@10': 0.0845, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2612}:  30%|███       | 9/30 [00:19<00:50,  2.43s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 4459888435.5175, 'hit_ratio@10': 0.0783, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2398}:  30%|███       | 9/30 [00:22<00:50,  2.43s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 4459888435.5175, 'hit_ratio@10': 0.0783, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2398}:  33%|███▎      | 10/30 [00:22<00:52,  2.63s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 4054513548.9133, 'hit_ratio@10': 0.0782, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.3234}:  33%|███▎      | 10/30 [00:24<00:52,  2.63s/it]{'epoch': 36, 'num_users': 6.6364, 'loss': 4054513548.9133, 'hit_ratio@10': 0.0782, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.3234}:  37%|███▋      | 11/30 [00:24<00:46,  2.47s/it]{'epoch': 36, 'num_users': 6.4167, 'loss': 3716644012.176, 'hit_ratio@10': 0.0786, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1134}:  37%|███▋      | 11/30 [00:25<00:46,  2.47s/it] {'epoch': 36, 'num_users': 6.4167, 'loss': 3716644012.176, 'hit_ratio@10': 0.0786, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1134}:  40%|████      | 12/30 [00:25<00:35,  1.97s/it]{'epoch': 36, 'num_users': 6.6154, 'loss': 3430749461.1354, 'hit_ratio@10': 0.0865, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1219}:  40%|████      | 12/30 [00:27<00:35,  1.97s/it]{'epoch': 36, 'num_users': 6.6154, 'loss': 3430749461.1354, 'hit_ratio@10': 0.0865, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1219}:  43%|████▎     | 13/30 [00:27<00:31,  1.88s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 6077372356.3876, 'hit_ratio@10': 0.0804, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9242}:  43%|████▎     | 13/30 [00:27<00:31,  1.88s/it]{'epoch': 36, 'num_users': 6.3571, 'loss': 6077372356.3876, 'hit_ratio@10': 0.0804, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9242}:  47%|████▋     | 14/30 [00:27<00:22,  1.43s/it]{'epoch': 36, 'num_users': 6.2667, 'loss': 5672214232.598, 'hit_ratio@10': 0.0814, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0107}:  47%|████▋     | 14/30 [00:30<00:22,  1.43s/it] {'epoch': 36, 'num_users': 6.2667, 'loss': 5672214232.598, 'hit_ratio@10': 0.0814, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0107}:  50%|█████     | 15/30 [00:30<00:24,  1.64s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 5329844878.0225, 'hit_ratio@10': 0.0764, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8748}:  50%|█████     | 15/30 [00:30<00:24,  1.64s/it]{'epoch': 36, 'num_users': 6.0625, 'loss': 5329844878.0225, 'hit_ratio@10': 0.0764, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8748}:  53%|█████▎    | 16/30 [00:30<00:19,  1.41s/it]{'epoch': 36, 'num_users': 5.8235, 'loss': 12869287167.6447, 'hit_ratio@10': 0.0719, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7402}:  53%|█████▎    | 16/30 [00:31<00:19,  1.41s/it]{'epoch': 36, 'num_users': 5.8235, 'loss': 12869287167.6447, 'hit_ratio@10': 0.0719, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7402}:  57%|█████▋    | 17/30 [00:31<00:14,  1.08s/it]{'epoch': 36, 'num_users': 6.0556, 'loss': 12154326796.4559, 'hit_ratio@10': 0.0718, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7076}:  57%|█████▋    | 17/30 [00:33<00:14,  1.08s/it]{'epoch': 36, 'num_users': 6.0556, 'loss': 12154326796.4559, 'hit_ratio@10': 0.0718, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7076}:  60%|██████    | 18/30 [00:33<00:16,  1.41s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 11515942235.1577, 'hit_ratio@10': 0.0756, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6624}:  60%|██████    | 18/30 [00:34<00:16,  1.41s/it]   {'epoch': 36, 'num_users': 6.0, 'loss': 11515942235.1577, 'hit_ratio@10': 0.0756, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6624}:  63%|██████▎   | 19/30 [00:34<00:14,  1.27s/it]{'epoch': 36, 'num_users': 6.15, 'loss': 10940145162.2183, 'hit_ratio@10': 0.0788, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7408}:  63%|██████▎   | 19/30 [00:38<00:14,  1.27s/it]{'epoch': 36, 'num_users': 6.15, 'loss': 10940145162.2183, 'hit_ratio@10': 0.0788, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7408}:  67%|██████▋   | 20/30 [00:38<00:21,  2.17s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 10419188368.4205, 'hit_ratio@10': 0.0798, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9021}:  67%|██████▋   | 20/30 [00:41<00:21,  2.17s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 10419188368.4205, 'hit_ratio@10': 0.0798, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9021}:  70%|███████   | 21/30 [00:41<00:22,  2.45s/it]{'epoch': 36, 'num_users': 6.1818, 'loss': 9981737873.3188, 'hit_ratio@10': 0.0824, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8358}:  70%|███████   | 21/30 [00:43<00:22,  2.45s/it] {'epoch': 36, 'num_users': 6.1818, 'loss': 9981737873.3188, 'hit_ratio@10': 0.0824, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8358}:  73%|███████▎  | 22/30 [00:43<00:17,  2.16s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 10991234566.8962, 'hit_ratio@10': 0.081, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8314}:  73%|███████▎  | 22/30 [00:44<00:17,  2.16s/it]{'epoch': 36, 'num_users': 6.1304, 'loss': 10991234566.8962, 'hit_ratio@10': 0.081, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8314}:  77%|███████▋  | 23/30 [00:44<00:13,  1.93s/it]{'epoch': 36, 'num_users': 5.9583, 'loss': 16295511477.5422, 'hit_ratio@10': 0.0776, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7249}:  77%|███████▋  | 23/30 [00:44<00:13,  1.93s/it]{'epoch': 36, 'num_users': 5.9583, 'loss': 16295511477.5422, 'hit_ratio@10': 0.0776, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7249}:  80%|████████  | 24/30 [00:44<00:08,  1.44s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 24423597435.0805, 'hit_ratio@10': 0.0745, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6268}:  80%|████████  | 24/30 [00:45<00:08,  1.44s/it]   {'epoch': 36, 'num_users': 5.8, 'loss': 24423597435.0805, 'hit_ratio@10': 0.0745, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6268}:  83%|████████▎ | 25/30 [00:45<00:05,  1.06s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 23484228338.4006, 'hit_ratio@10': 0.0749, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7454}:  83%|████████▎ | 25/30 [00:50<00:05,  1.06s/it]{'epoch': 36, 'num_users': 5.8077, 'loss': 23484228338.4006, 'hit_ratio@10': 0.0749, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7454}:  87%|████████▋ | 26/30 [00:50<00:09,  2.46s/it]{'epoch': 36, 'num_users': 5.8889, 'loss': 22614457151.348, 'hit_ratio@10': 0.0761, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.795}:  87%|████████▋ | 26/30 [00:52<00:09,  2.46s/it]  {'epoch': 36, 'num_users': 5.8889, 'loss': 22614457151.348, 'hit_ratio@10': 0.0761, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.795}:  90%|█████████ | 27/30 [00:52<00:07,  2.35s/it]{'epoch': 36, 'num_users': 6.0, 'loss': 21806798260.7392, 'hit_ratio@10': 0.0762, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8226}:  90%|█████████ | 27/30 [00:56<00:07,  2.35s/it] {'epoch': 36, 'num_users': 6.0, 'loss': 21806798260.7392, 'hit_ratio@10': 0.0762, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8226}:  93%|█████████▎| 28/30 [00:56<00:05,  2.72s/it]{'epoch': 36, 'num_users': 5.8621, 'loss': 21084853779.6422, 'hit_ratio@10': 0.0767, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8182}:  93%|█████████▎| 28/30 [00:57<00:05,  2.72s/it]{'epoch': 36, 'num_users': 5.8621, 'loss': 21084853779.6422, 'hit_ratio@10': 0.0767, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8182}:  97%|█████████▋| 29/30 [00:57<00:02,  2.32s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 21215868761.2289, 'hit_ratio@10': 0.0778, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8082}:  97%|█████████▋| 29/30 [01:00<00:02,  2.32s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 21215868761.2289, 'hit_ratio@10': 0.0778, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8082}: 100%|██████████| 30/30 [01:00<00:00,  2.39s/it]{'epoch': 36, 'num_users': 5.8667, 'loss': 21215868761.2289, 'hit_ratio@10': 0.0778, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8082}: 100%|██████████| 30/30 [01:00<00:00,  2.01s/it]
Epoch: 36
Avg # of users: 5.866666666666666
Avg Loss: 21215868761.228924
Avg hit ratio: 0.07775537690872633
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.808222015698751
Std train time: 1.7982478599771352
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 1030716.399, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5515}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 1030716.399, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5515}:   3%|▎         | 1/30 [00:01<00:37,  1.30s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 3810144.0917, 'hit_ratio@10': 0.0688, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3366}:   3%|▎         | 1/30 [00:03<00:37,  1.30s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 3810144.0917, 'hit_ratio@10': 0.0688, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3366}:   7%|▋         | 2/30 [00:03<00:50,  1.80s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 26006120536.4421, 'hit_ratio@10': 0.0458, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8309}:   7%|▋         | 2/30 [00:03<00:50,  1.80s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 26006120536.4421, 'hit_ratio@10': 0.0458, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8309}:  10%|█         | 3/30 [00:03<00:31,  1.18s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 19504591430.347, 'hit_ratio@10': 0.0701, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8551}:  10%|█         | 3/30 [00:05<00:31,  1.18s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 19504591430.347, 'hit_ratio@10': 0.0701, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8551}:  13%|█▎        | 4/30 [00:05<00:38,  1.49s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 15603673902.3148, 'hit_ratio@10': 0.0921, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9726}:  13%|█▎        | 4/30 [00:09<00:38,  1.49s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 15603673902.3148, 'hit_ratio@10': 0.0921, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9726}:  17%|█▋        | 5/30 [00:09<00:57,  2.30s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 13003061941.5045, 'hit_ratio@10': 0.0915, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9812}:  17%|█▋        | 5/30 [00:12<00:57,  2.30s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 13003061941.5045, 'hit_ratio@10': 0.0915, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9812}:  20%|██        | 6/30 [00:12<01:01,  2.56s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 11154893143.692, 'hit_ratio@10': 0.0899, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0182}:  20%|██        | 6/30 [00:14<01:01,  2.56s/it] {'epoch': 37, 'num_users': 6.2857, 'loss': 11154893143.692, 'hit_ratio@10': 0.0899, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0182}:  23%|██▎       | 7/30 [00:14<00:52,  2.26s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 9760531564.6497, 'hit_ratio@10': 0.0894, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9442}:  23%|██▎       | 7/30 [00:16<00:52,  2.26s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 9760531564.6497, 'hit_ratio@10': 0.0894, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9442}:  27%|██▋       | 8/30 [00:16<00:51,  2.32s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 8676028181.0842, 'hit_ratio@10': 0.089, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1775}:  27%|██▋       | 8/30 [00:19<00:51,  2.32s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 8676028181.0842, 'hit_ratio@10': 0.089, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1775}:  30%|███       | 9/30 [00:19<00:50,  2.40s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 7808449544.4868, 'hit_ratio@10': 0.0892, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1655}:  30%|███       | 9/30 [00:22<00:50,  2.40s/it]  {'epoch': 37, 'num_users': 6.3, 'loss': 7808449544.4868, 'hit_ratio@10': 0.0892, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1655}:  33%|███▎      | 10/30 [00:22<00:52,  2.61s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 7098591386.5318, 'hit_ratio@10': 0.0915, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2321}:  33%|███▎      | 10/30 [00:24<00:52,  2.61s/it]{'epoch': 37, 'num_users': 6.6364, 'loss': 7098591386.5318, 'hit_ratio@10': 0.0915, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2321}:  37%|███▋      | 11/30 [00:24<00:45,  2.42s/it]{'epoch': 37, 'num_users': 6.4167, 'loss': 6571747142.6819, 'hit_ratio@10': 0.0978, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0268}:  37%|███▋      | 11/30 [00:25<00:45,  2.42s/it]{'epoch': 37, 'num_users': 6.4167, 'loss': 6571747142.6819, 'hit_ratio@10': 0.0978, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0268}:  40%|████      | 12/30 [00:25<00:34,  1.92s/it]{'epoch': 37, 'num_users': 6.6154, 'loss': 6598051939.7858, 'hit_ratio@10': 0.1008, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.033}:  40%|████      | 12/30 [00:26<00:34,  1.92s/it] {'epoch': 37, 'num_users': 6.6154, 'loss': 6598051939.7858, 'hit_ratio@10': 0.1008, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.033}:  43%|████▎     | 13/30 [00:26<00:30,  1.82s/it]{'epoch': 37, 'num_users': 6.3571, 'loss': 6136353015.3725, 'hit_ratio@10': 0.0936, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8413}:  43%|████▎     | 13/30 [00:27<00:30,  1.82s/it]{'epoch': 37, 'num_users': 6.3571, 'loss': 6136353015.3725, 'hit_ratio@10': 0.0936, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8413}:  47%|████▋     | 14/30 [00:27<00:22,  1.39s/it]{'epoch': 37, 'num_users': 6.2667, 'loss': 6208701340.6595, 'hit_ratio@10': 0.1002, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9538}:  47%|████▋     | 14/30 [00:29<00:22,  1.39s/it]{'epoch': 37, 'num_users': 6.2667, 'loss': 6208701340.6595, 'hit_ratio@10': 0.1002, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9538}:  50%|█████     | 15/30 [00:29<00:24,  1.66s/it]{'epoch': 37, 'num_users': 6.0625, 'loss': 5820690479.3375, 'hit_ratio@10': 0.0992, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.816}:  50%|█████     | 15/30 [00:30<00:24,  1.66s/it] {'epoch': 37, 'num_users': 6.0625, 'loss': 5820690479.3375, 'hit_ratio@10': 0.0992, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.816}:  53%|█████▎    | 16/30 [00:30<00:19,  1.40s/it]{'epoch': 37, 'num_users': 5.8235, 'loss': 5582533028.4588, 'hit_ratio@10': 0.1051, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.682}:  53%|█████▎    | 16/30 [00:30<00:19,  1.40s/it]{'epoch': 37, 'num_users': 5.8235, 'loss': 5582533028.4588, 'hit_ratio@10': 0.1051, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.682}:  57%|█████▋    | 17/30 [00:30<00:13,  1.07s/it]{'epoch': 37, 'num_users': 6.0556, 'loss': 5272693330.1533, 'hit_ratio@10': 0.1013, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6442}:  57%|█████▋    | 17/30 [00:32<00:13,  1.07s/it]{'epoch': 37, 'num_users': 6.0556, 'loss': 5272693330.1533, 'hit_ratio@10': 0.1013, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6442}:  60%|██████    | 18/30 [00:32<00:16,  1.36s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 4995186917.045, 'hit_ratio@10': 0.1072, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5991}:  60%|██████    | 18/30 [00:33<00:16,  1.36s/it]    {'epoch': 37, 'num_users': 6.0, 'loss': 4995186917.045, 'hit_ratio@10': 0.1072, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5991}:  63%|██████▎   | 19/30 [00:33<00:13,  1.23s/it]{'epoch': 37, 'num_users': 6.15, 'loss': 4745427572.5915, 'hit_ratio@10': 0.1027, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.674}:  63%|██████▎   | 19/30 [00:37<00:13,  1.23s/it]{'epoch': 37, 'num_users': 6.15, 'loss': 4745427572.5915, 'hit_ratio@10': 0.1027, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.674}:  67%|██████▋   | 20/30 [00:37<00:20,  2.10s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 4519454973.6982, 'hit_ratio@10': 0.1026, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8347}:  67%|██████▋   | 20/30 [00:40<00:20,  2.10s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 4519454973.6982, 'hit_ratio@10': 0.1026, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8347}:  70%|███████   | 21/30 [00:40<00:21,  2.38s/it]{'epoch': 37, 'num_users': 6.1818, 'loss': 4314026135.2225, 'hit_ratio@10': 0.1021, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7733}:  70%|███████   | 21/30 [00:42<00:21,  2.38s/it]{'epoch': 37, 'num_users': 6.1818, 'loss': 4314026135.2225, 'hit_ratio@10': 0.1021, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7733}:  73%|███████▎  | 22/30 [00:42<00:16,  2.12s/it]{'epoch': 37, 'num_users': 6.1304, 'loss': 4126477395.8137, 'hit_ratio@10': 0.0998, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7681}:  73%|███████▎  | 22/30 [00:43<00:16,  2.12s/it]{'epoch': 37, 'num_users': 6.1304, 'loss': 4126477395.8137, 'hit_ratio@10': 0.0998, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7681}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it]{'epoch': 37, 'num_users': 5.9583, 'loss': 4278814523.8548, 'hit_ratio@10': 0.0956, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.664}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it] {'epoch': 37, 'num_users': 5.9583, 'loss': 4278814523.8548, 'hit_ratio@10': 0.0956, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.664}:  80%|████████  | 24/30 [00:43<00:08,  1.41s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 33615295750.2606, 'hit_ratio@10': 0.0918, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5684}:  80%|████████  | 24/30 [00:44<00:08,  1.41s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 33615295750.2606, 'hit_ratio@10': 0.0918, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5684}:  83%|████████▎ | 25/30 [00:44<00:05,  1.04s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 32322399762.128, 'hit_ratio@10': 0.0888, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.687}:  83%|████████▎ | 25/30 [00:49<00:05,  1.04s/it]{'epoch': 37, 'num_users': 5.8077, 'loss': 32322399762.128, 'hit_ratio@10': 0.0888, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.687}:  87%|████████▋ | 26/30 [00:49<00:09,  2.43s/it]{'epoch': 37, 'num_users': 5.8889, 'loss': 31125273854.2243, 'hit_ratio@10': 0.0894, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7318}:  87%|████████▋ | 26/30 [00:51<00:09,  2.43s/it]{'epoch': 37, 'num_users': 5.8889, 'loss': 31125273854.2243, 'hit_ratio@10': 0.0894, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7318}:  90%|█████████ | 27/30 [00:51<00:06,  2.30s/it]{'epoch': 37, 'num_users': 6.0, 'loss': 30013657082.1471, 'hit_ratio@10': 0.0876, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7638}:  90%|█████████ | 27/30 [00:55<00:06,  2.30s/it]   {'epoch': 37, 'num_users': 6.0, 'loss': 30013657082.1471, 'hit_ratio@10': 0.0876, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7638}:  93%|█████████▎| 28/30 [00:55<00:05,  2.71s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 28978704263.0635, 'hit_ratio@10': 0.0893, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7677}:  93%|█████████▎| 28/30 [00:56<00:05,  2.71s/it]{'epoch': 37, 'num_users': 5.8621, 'loss': 28978704263.0635, 'hit_ratio@10': 0.0893, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7677}:  97%|█████████▋| 29/30 [00:56<00:02,  2.33s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 28012747454.7195, 'hit_ratio@10': 0.0863, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7634}:  97%|█████████▋| 29/30 [00:59<00:02,  2.33s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 28012747454.7195, 'hit_ratio@10': 0.0863, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7634}: 100%|██████████| 30/30 [00:59<00:00,  2.43s/it]{'epoch': 37, 'num_users': 5.8667, 'loss': 28012747454.7195, 'hit_ratio@10': 0.0863, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7634}: 100%|██████████| 30/30 [00:59<00:00,  1.98s/it]
Epoch: 37
Avg # of users: 5.866666666666666
Avg Loss: 28012747454.719467
Avg hit ratio: 0.08634239358766742
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7634044249852496
Std train time: 1.7741772578266413
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 201969.6158, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4324}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 201969.6158, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4324}:   3%|▎         | 1/30 [00:01<00:36,  1.24s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 107965.6471, 'hit_ratio@10': 0.0849, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2147}:   3%|▎         | 1/30 [00:03<00:36,  1.24s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 107965.6471, 'hit_ratio@10': 0.0849, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2147}:   7%|▋         | 2/30 [00:03<00:47,  1.70s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 475262633.0981, 'hit_ratio@10': 0.0566, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7601}:   7%|▋         | 2/30 [00:03<00:47,  1.70s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 475262633.0981, 'hit_ratio@10': 0.0566, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7601}:  10%|█         | 3/30 [00:03<00:30,  1.13s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 356454904.4167, 'hit_ratio@10': 0.0692, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7892}:  10%|█         | 3/30 [00:05<00:30,  1.13s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 356454904.4167, 'hit_ratio@10': 0.0692, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7892}:  13%|█▎        | 4/30 [00:05<00:37,  1.44s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 286928829.2858, 'hit_ratio@10': 0.0874, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8195}:  13%|█▎        | 4/30 [00:09<00:37,  1.44s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 286928829.2858, 'hit_ratio@10': 0.0874, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8195}:  17%|█▋        | 5/30 [00:09<00:57,  2.28s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 242191573.9993, 'hit_ratio@10': 0.095, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8859}:  17%|█▋        | 5/30 [00:12<00:57,  2.28s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 242191573.9993, 'hit_ratio@10': 0.095, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8859}:  20%|██        | 6/30 [00:12<01:02,  2.61s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 207597763.0883, 'hit_ratio@10': 0.0929, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9637}:  20%|██        | 6/30 [00:14<01:02,  2.61s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 207597763.0883, 'hit_ratio@10': 0.0929, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9637}:  23%|██▎       | 7/30 [00:14<00:53,  2.33s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 193887513.5125, 'hit_ratio@10': 0.092, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.896}:  23%|██▎       | 7/30 [00:16<00:53,  2.33s/it]   {'epoch': 38, 'num_users': 6.125, 'loss': 193887513.5125, 'hit_ratio@10': 0.092, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.896}:  27%|██▋       | 8/30 [00:16<00:52,  2.37s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 42186970382.1445, 'hit_ratio@10': 0.0881, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1488}:  27%|██▋       | 8/30 [00:19<00:52,  2.37s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 42186970382.1445, 'hit_ratio@10': 0.0881, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1488}:  30%|███       | 9/30 [00:19<00:51,  2.44s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 37968274599.9234, 'hit_ratio@10': 0.0929, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1291}:  30%|███       | 9/30 [00:22<00:51,  2.44s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 37968274599.9234, 'hit_ratio@10': 0.0929, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1291}:  33%|███▎      | 10/30 [00:22<00:52,  2.62s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 34667235497.1991, 'hit_ratio@10': 0.088, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1827}:  33%|███▎      | 10/30 [00:24<00:52,  2.62s/it]{'epoch': 38, 'num_users': 6.6364, 'loss': 34667235497.1991, 'hit_ratio@10': 0.088, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1827}:  37%|███▋      | 11/30 [00:24<00:45,  2.39s/it]{'epoch': 38, 'num_users': 6.4167, 'loss': 31778318970.2421, 'hit_ratio@10': 0.0876, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9808}:  37%|███▋      | 11/30 [00:25<00:45,  2.39s/it]{'epoch': 38, 'num_users': 6.4167, 'loss': 31778318970.2421, 'hit_ratio@10': 0.0876, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9808}:  40%|████      | 12/30 [00:25<00:34,  1.91s/it]{'epoch': 38, 'num_users': 6.6154, 'loss': 29333841410.6065, 'hit_ratio@10': 0.0914, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9872}:  40%|████      | 12/30 [00:26<00:34,  1.91s/it]{'epoch': 38, 'num_users': 6.6154, 'loss': 29333841410.6065, 'hit_ratio@10': 0.0914, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9872}:  43%|████▎     | 13/30 [00:26<00:30,  1.80s/it]{'epoch': 38, 'num_users': 6.3571, 'loss': 114901197253.4679, 'hit_ratio@10': 0.0848, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7981}:  43%|████▎     | 13/30 [00:27<00:30,  1.80s/it]{'epoch': 38, 'num_users': 6.3571, 'loss': 114901197253.4679, 'hit_ratio@10': 0.0848, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7981}:  47%|████▋     | 14/30 [00:27<00:21,  1.37s/it]{'epoch': 38, 'num_users': 6.2667, 'loss': 107241117848.4901, 'hit_ratio@10': 0.0856, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8941}:  47%|████▋     | 14/30 [00:29<00:21,  1.37s/it]{'epoch': 38, 'num_users': 6.2667, 'loss': 107241117848.4901, 'hit_ratio@10': 0.0856, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8941}:  50%|█████     | 15/30 [00:29<00:24,  1.60s/it]{'epoch': 38, 'num_users': 6.0625, 'loss': 100723333711.5012, 'hit_ratio@10': 0.0855, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7616}:  50%|█████     | 15/30 [00:30<00:24,  1.60s/it]{'epoch': 38, 'num_users': 6.0625, 'loss': 100723333711.5012, 'hit_ratio@10': 0.0855, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7616}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it]{'epoch': 38, 'num_users': 5.8235, 'loss': 209285282445.0834, 'hit_ratio@10': 0.0805, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6314}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it]{'epoch': 38, 'num_users': 5.8235, 'loss': 209285282445.0834, 'hit_ratio@10': 0.0805, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6314}:  57%|█████▋    | 17/30 [00:30<00:13,  1.04s/it]{'epoch': 38, 'num_users': 6.0556, 'loss': 197658322789.3856, 'hit_ratio@10': 0.078, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5981}:  57%|█████▋    | 17/30 [00:32<00:13,  1.04s/it] {'epoch': 38, 'num_users': 6.0556, 'loss': 197658322789.3856, 'hit_ratio@10': 0.078, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5981}:  60%|██████    | 18/30 [00:32<00:16,  1.35s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 187281831952.7074, 'hit_ratio@10': 0.0776, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.557}:  60%|██████    | 18/30 [00:33<00:16,  1.35s/it]   {'epoch': 38, 'num_users': 6.0, 'loss': 187281831952.7074, 'hit_ratio@10': 0.0776, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.557}:  63%|██████▎   | 19/30 [00:33<00:13,  1.23s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 177917740440.2767, 'hit_ratio@10': 0.0843, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6345}:  63%|██████▎   | 19/30 [00:37<00:13,  1.23s/it]{'epoch': 38, 'num_users': 6.15, 'loss': 177917740440.2767, 'hit_ratio@10': 0.0843, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6345}:  67%|██████▋   | 20/30 [00:37<00:21,  2.11s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 169445690702.5429, 'hit_ratio@10': 0.0862, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7841}:  67%|██████▋   | 20/30 [00:40<00:21,  2.11s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 169445690702.5429, 'hit_ratio@10': 0.0862, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7841}:  70%|███████   | 21/30 [00:40<00:21,  2.35s/it]{'epoch': 38, 'num_users': 6.1818, 'loss': 161743806887.4785, 'hit_ratio@10': 0.0906, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7239}:  70%|███████   | 21/30 [00:41<00:21,  2.35s/it]{'epoch': 38, 'num_users': 6.1818, 'loss': 161743806887.4785, 'hit_ratio@10': 0.0906, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7239}:  73%|███████▎  | 22/30 [00:41<00:16,  2.09s/it]{'epoch': 38, 'num_users': 6.1304, 'loss': 154711473104.9963, 'hit_ratio@10': 0.091, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7266}:  73%|███████▎  | 22/30 [00:43<00:16,  2.09s/it] {'epoch': 38, 'num_users': 6.1304, 'loss': 154711473104.9963, 'hit_ratio@10': 0.091, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7266}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it]{'epoch': 38, 'num_users': 5.9583, 'loss': 304241473055.7548, 'hit_ratio@10': 0.0955, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6247}:  77%|███████▋  | 23/30 [00:43<00:13,  1.89s/it]{'epoch': 38, 'num_users': 5.9583, 'loss': 304241473055.7548, 'hit_ratio@10': 0.0955, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6247}:  80%|████████  | 24/30 [00:43<00:08,  1.42s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 505203609412.0312, 'hit_ratio@10': 0.0917, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5309}:  80%|████████  | 24/30 [00:43<00:08,  1.42s/it]   {'epoch': 38, 'num_users': 5.8, 'loss': 505203609412.0312, 'hit_ratio@10': 0.0917, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5309}:  83%|████████▎ | 25/30 [00:43<00:05,  1.04s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 485772701863.6359, 'hit_ratio@10': 0.0914, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6557}:  83%|████████▎ | 25/30 [00:49<00:05,  1.04s/it]{'epoch': 38, 'num_users': 5.8077, 'loss': 485772701863.6359, 'hit_ratio@10': 0.0914, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6557}:  87%|████████▋ | 26/30 [00:49<00:09,  2.47s/it]{'epoch': 38, 'num_users': 5.8889, 'loss': 467781151420.4696, 'hit_ratio@10': 0.0907, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7042}:  87%|████████▋ | 26/30 [00:51<00:09,  2.47s/it]{'epoch': 38, 'num_users': 5.8889, 'loss': 467781151420.4696, 'hit_ratio@10': 0.0907, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7042}:  90%|█████████ | 27/30 [00:51<00:07,  2.33s/it]{'epoch': 38, 'num_users': 6.0, 'loss': 451078536854.3751, 'hit_ratio@10': 0.0931, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7411}:  90%|█████████ | 27/30 [00:55<00:07,  2.33s/it]   {'epoch': 38, 'num_users': 6.0, 'loss': 451078536854.3751, 'hit_ratio@10': 0.0931, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7411}:  93%|█████████▎| 28/30 [00:55<00:05,  2.76s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 454769946268.8262, 'hit_ratio@10': 0.093, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7466}:  93%|█████████▎| 28/30 [00:56<00:05,  2.76s/it]{'epoch': 38, 'num_users': 5.8621, 'loss': 454769946268.8262, 'hit_ratio@10': 0.093, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7466}:  97%|█████████▋| 29/30 [00:56<00:02,  2.38s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 439610959141.9414, 'hit_ratio@10': 0.0944, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7373}:  97%|█████████▋| 29/30 [00:59<00:02,  2.38s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 439610959141.9414, 'hit_ratio@10': 0.0944, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7373}: 100%|██████████| 30/30 [00:59<00:00,  2.42s/it]{'epoch': 38, 'num_users': 5.8667, 'loss': 439610959141.9414, 'hit_ratio@10': 0.0944, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7373}: 100%|██████████| 30/30 [00:59<00:00,  1.98s/it]
Epoch: 38
Avg # of users: 5.866666666666666
Avg Loss: 439610959141.9414
Avg hit ratio: 0.09439770142146929
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.737324770291646
Std train time: 1.7227092803502997
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 18881264.3668, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4388}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 18881264.3668, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4388}:   3%|▎         | 1/30 [00:01<00:36,  1.25s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 16180676.9111, 'hit_ratio@10': 0.0586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2866}:   3%|▎         | 1/30 [00:03<00:36,  1.25s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 16180676.9111, 'hit_ratio@10': 0.0586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2866}:   7%|▋         | 2/30 [00:03<00:50,  1.79s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 541553106928.9883, 'hit_ratio@10': 0.039, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7819}:   7%|▋         | 2/30 [00:03<00:50,  1.79s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 541553106928.9883, 'hit_ratio@10': 0.039, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7819}:  10%|█         | 3/30 [00:03<00:31,  1.16s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 406164843865.0611, 'hit_ratio@10': 0.0561, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7848}:  10%|█         | 3/30 [00:05<00:31,  1.16s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 406164843865.0611, 'hit_ratio@10': 0.0561, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7848}:  13%|█▎        | 4/30 [00:05<00:36,  1.42s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 324931878105.2664, 'hit_ratio@10': 0.0649, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7387}:  13%|█▎        | 4/30 [00:08<00:36,  1.42s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 324931878105.2664, 'hit_ratio@10': 0.0649, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7387}:  17%|█▋        | 5/30 [00:08<00:52,  2.10s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 270776567211.9752, 'hit_ratio@10': 0.0578, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7687}:  17%|█▋        | 5/30 [00:11<00:52,  2.10s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 270776567211.9752, 'hit_ratio@10': 0.0578, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7687}:  20%|██        | 6/30 [00:11<00:57,  2.39s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 232094811655.3799, 'hit_ratio@10': 0.0552, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8458}:  20%|██        | 6/30 [00:13<00:57,  2.39s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 232094811655.3799, 'hit_ratio@10': 0.0552, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8458}:  23%|██▎       | 7/30 [00:13<00:49,  2.16s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 203082962257.7731, 'hit_ratio@10': 0.0769, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7925}:  23%|██▎       | 7/30 [00:16<00:49,  2.16s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 203082962257.7731, 'hit_ratio@10': 0.0769, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7925}:  27%|██▋       | 8/30 [00:16<00:49,  2.25s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 180518194044.1119, 'hit_ratio@10': 0.0715, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0492}:  27%|██▋       | 8/30 [00:18<00:49,  2.25s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 180518194044.1119, 'hit_ratio@10': 0.0715, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0492}:  30%|███       | 9/30 [00:18<00:51,  2.45s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 277623820604.3553, 'hit_ratio@10': 0.0712, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.053}:  30%|███       | 9/30 [00:22<00:51,  2.45s/it]    {'epoch': 39, 'num_users': 6.3, 'loss': 277623820604.3553, 'hit_ratio@10': 0.0712, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.053}:  33%|███▎      | 10/30 [00:22<00:53,  2.66s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 252385297711.3004, 'hit_ratio@10': 0.0717, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0995}:  33%|███▎      | 10/30 [00:23<00:53,  2.66s/it]{'epoch': 39, 'num_users': 6.6364, 'loss': 252385297711.3004, 'hit_ratio@10': 0.0717, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0995}:  37%|███▋      | 11/30 [00:23<00:45,  2.40s/it]{'epoch': 39, 'num_users': 6.4167, 'loss': 232532536662.9143, 'hit_ratio@10': 0.0727, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9046}:  37%|███▋      | 11/30 [00:24<00:45,  2.40s/it]{'epoch': 39, 'num_users': 6.4167, 'loss': 232532536662.9143, 'hit_ratio@10': 0.0727, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9046}:  40%|████      | 12/30 [00:24<00:34,  1.91s/it]{'epoch': 39, 'num_users': 6.6154, 'loss': 214646418449.9842, 'hit_ratio@10': 0.0776, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9092}:  40%|████      | 12/30 [00:26<00:34,  1.91s/it]{'epoch': 39, 'num_users': 6.6154, 'loss': 214646418449.9842, 'hit_ratio@10': 0.0776, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9092}:  43%|████▎     | 13/30 [00:26<00:30,  1.79s/it]{'epoch': 39, 'num_users': 6.3571, 'loss': 200493018700.1282, 'hit_ratio@10': 0.072, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7232}:  43%|████▎     | 13/30 [00:26<00:30,  1.79s/it] {'epoch': 39, 'num_users': 6.3571, 'loss': 200493018700.1282, 'hit_ratio@10': 0.072, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7232}:  47%|████▋     | 14/30 [00:26<00:21,  1.35s/it]{'epoch': 39, 'num_users': 6.2667, 'loss': 187147407350.6828, 'hit_ratio@10': 0.0715, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7913}:  47%|████▋     | 14/30 [00:28<00:21,  1.35s/it]{'epoch': 39, 'num_users': 6.2667, 'loss': 187147407350.6828, 'hit_ratio@10': 0.0715, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7913}:  50%|█████     | 15/30 [00:28<00:22,  1.52s/it]{'epoch': 39, 'num_users': 6.0625, 'loss': 175450733650.6278, 'hit_ratio@10': 0.0723, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6576}:  50%|█████     | 15/30 [00:29<00:22,  1.52s/it]{'epoch': 39, 'num_users': 6.0625, 'loss': 175450733650.6278, 'hit_ratio@10': 0.0723, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6576}:  53%|█████▎    | 16/30 [00:29<00:17,  1.26s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 167712132866.4733, 'hit_ratio@10': 0.0798, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5304}:  53%|█████▎    | 16/30 [00:29<00:17,  1.26s/it]{'epoch': 39, 'num_users': 5.8235, 'loss': 167712132866.4733, 'hit_ratio@10': 0.0798, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5304}:  57%|█████▋    | 17/30 [00:29<00:12,  1.03it/s]{'epoch': 39, 'num_users': 6.0556, 'loss': 163895915957.564, 'hit_ratio@10': 0.0793, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4993}:  57%|█████▋    | 17/30 [00:31<00:12,  1.03it/s] {'epoch': 39, 'num_users': 6.0556, 'loss': 163895915957.564, 'hit_ratio@10': 0.0793, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4993}:  60%|██████    | 18/30 [00:31<00:15,  1.28s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 155269826890.0479, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4606}:  60%|██████    | 18/30 [00:32<00:15,  1.28s/it]  {'epoch': 39, 'num_users': 6.0, 'loss': 155269826890.0479, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4606}:  63%|██████▎   | 19/30 [00:32<00:12,  1.18s/it]{'epoch': 39, 'num_users': 6.15, 'loss': 147509563363.2567, 'hit_ratio@10': 0.0864, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5365}:  63%|██████▎   | 19/30 [00:36<00:12,  1.18s/it]{'epoch': 39, 'num_users': 6.15, 'loss': 147509563363.2567, 'hit_ratio@10': 0.0864, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5365}:  67%|██████▋   | 20/30 [00:36<00:20,  2.03s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 140485299143.1013, 'hit_ratio@10': 0.0847, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6872}:  67%|██████▋   | 20/30 [00:39<00:20,  2.03s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 140485299143.1013, 'hit_ratio@10': 0.0847, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6872}:  70%|███████   | 21/30 [00:39<00:20,  2.29s/it]{'epoch': 39, 'num_users': 6.1818, 'loss': 134099632533.1095, 'hit_ratio@10': 0.0912, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6297}:  70%|███████   | 21/30 [00:40<00:20,  2.29s/it]{'epoch': 39, 'num_users': 6.1818, 'loss': 134099632533.1095, 'hit_ratio@10': 0.0912, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6297}:  73%|███████▎  | 22/30 [00:40<00:16,  2.04s/it]{'epoch': 39, 'num_users': 6.1304, 'loss': 128269484887.4701, 'hit_ratio@10': 0.0894, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6352}:  73%|███████▎  | 22/30 [00:42<00:16,  2.04s/it]{'epoch': 39, 'num_users': 6.1304, 'loss': 128269484887.4701, 'hit_ratio@10': 0.0894, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6352}:  77%|███████▋  | 23/30 [00:42<00:12,  1.85s/it]{'epoch': 39, 'num_users': 5.9583, 'loss': 130236222328.0922, 'hit_ratio@10': 0.094, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5366}:  77%|███████▋  | 23/30 [00:42<00:12,  1.85s/it] {'epoch': 39, 'num_users': 5.9583, 'loss': 130236222328.0922, 'hit_ratio@10': 0.094, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5366}:  80%|████████  | 24/30 [00:42<00:08,  1.38s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 395217460025.2618, 'hit_ratio@10': 0.0902, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4463}:  80%|████████  | 24/30 [00:42<00:08,  1.38s/it]  {'epoch': 39, 'num_users': 5.8, 'loss': 395217460025.2618, 'hit_ratio@10': 0.0902, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4463}:  83%|████████▎ | 25/30 [00:42<00:05,  1.02s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 380016788485.9844, 'hit_ratio@10': 0.0868, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5646}:  83%|████████▎ | 25/30 [00:48<00:05,  1.02s/it]{'epoch': 39, 'num_users': 5.8077, 'loss': 380016788485.9844, 'hit_ratio@10': 0.0868, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5646}:  87%|████████▋ | 26/30 [00:48<00:09,  2.38s/it]{'epoch': 39, 'num_users': 5.8889, 'loss': 365942094127.6406, 'hit_ratio@10': 0.0888, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6035}:  87%|████████▋ | 26/30 [00:49<00:09,  2.38s/it]{'epoch': 39, 'num_users': 5.8889, 'loss': 365942094127.6406, 'hit_ratio@10': 0.0888, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6035}:  90%|█████████ | 27/30 [00:49<00:06,  2.22s/it]{'epoch': 39, 'num_users': 6.0, 'loss': 352872733623.2055, 'hit_ratio@10': 0.0857, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6381}:  90%|█████████ | 27/30 [00:53<00:06,  2.22s/it]   {'epoch': 39, 'num_users': 6.0, 'loss': 352872733623.2055, 'hit_ratio@10': 0.0857, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6381}:  93%|█████████▎| 28/30 [00:53<00:05,  2.71s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 340704745261.7418, 'hit_ratio@10': 0.0858, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6405}:  93%|█████████▎| 28/30 [00:55<00:05,  2.71s/it]{'epoch': 39, 'num_users': 5.8621, 'loss': 340704745261.7418, 'hit_ratio@10': 0.0858, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6405}:  97%|█████████▋| 29/30 [00:55<00:02,  2.32s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 329347920969.3178, 'hit_ratio@10': 0.0857, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6336}:  97%|█████████▋| 29/30 [00:57<00:02,  2.32s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 329347920969.3178, 'hit_ratio@10': 0.0857, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6336}: 100%|██████████| 30/30 [00:57<00:00,  2.36s/it]{'epoch': 39, 'num_users': 5.8667, 'loss': 329347920969.3178, 'hit_ratio@10': 0.0857, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6336}: 100%|██████████| 30/30 [00:57<00:00,  1.92s/it]
Epoch: 39
Avg # of users: 5.866666666666666
Avg Loss: 329347920969.31793
Avg hit ratio: 0.08568691549676269
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.633562111854553
Std train time: 1.6493849297475618
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 1967572.514, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5784}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 1967572.514, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5784}:   3%|▎         | 1/30 [00:01<00:38,  1.32s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 1073116.8669, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3624}:   3%|▎         | 1/30 [00:03<00:38,  1.32s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 1073116.8669, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3624}:   7%|▋         | 2/30 [00:03<00:51,  1.82s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 3748966029.1494, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8346}:   7%|▋         | 2/30 [00:03<00:51,  1.82s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 3748966029.1494, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8346}:  10%|█         | 3/30 [00:03<00:31,  1.18s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 2812395739.2176, 'hit_ratio@10': 0.1067, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8482}:  10%|█         | 3/30 [00:05<00:31,  1.18s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 2812395739.2176, 'hit_ratio@10': 0.1067, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8482}:  13%|█▎        | 4/30 [00:05<00:38,  1.47s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 27162588550.7127, 'hit_ratio@10': 0.1213, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.005}:  13%|█▎        | 4/30 [00:09<00:38,  1.47s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 27162588550.7127, 'hit_ratio@10': 0.1213, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.005}:  17%|█▋        | 5/30 [00:09<00:58,  2.33s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 24193735022.0699, 'hit_ratio@10': 0.1122, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0303}:  17%|█▋        | 5/30 [00:12<00:58,  2.33s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 24193735022.0699, 'hit_ratio@10': 0.1122, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0303}:  20%|██        | 6/30 [00:12<01:02,  2.62s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 20737512261.3383, 'hit_ratio@10': 0.1076, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0395}:  20%|██        | 6/30 [00:14<01:02,  2.62s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 20737512261.3383, 'hit_ratio@10': 0.1076, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0395}:  23%|██▎       | 7/30 [00:14<00:52,  2.28s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 19793449825.8246, 'hit_ratio@10': 0.1085, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9392}:  23%|██▎       | 7/30 [00:16<00:52,  2.28s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 19793449825.8246, 'hit_ratio@10': 0.1085, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9392}:  27%|██▋       | 8/30 [00:16<00:50,  2.28s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 17605711346.9111, 'hit_ratio@10': 0.1091, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1503}:  27%|██▋       | 8/30 [00:19<00:50,  2.28s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 17605711346.9111, 'hit_ratio@10': 0.1091, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1503}:  30%|███       | 9/30 [00:19<00:48,  2.33s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 15845150977.828, 'hit_ratio@10': 0.1118, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1253}:  30%|███       | 9/30 [00:22<00:48,  2.33s/it]    {'epoch': 40, 'num_users': 6.3, 'loss': 15845150977.828, 'hit_ratio@10': 0.1118, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1253}:  33%|███▎      | 10/30 [00:22<00:50,  2.52s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 14405028432.6881, 'hit_ratio@10': 0.1087, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1756}:  33%|███▎      | 10/30 [00:23<00:50,  2.52s/it]{'epoch': 40, 'num_users': 6.6364, 'loss': 14405028432.6881, 'hit_ratio@10': 0.1087, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1756}:  37%|███▋      | 11/30 [00:23<00:44,  2.32s/it]{'epoch': 40, 'num_users': 6.4167, 'loss': 13204914063.639, 'hit_ratio@10': 0.1135, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9741}:  37%|███▋      | 11/30 [00:24<00:44,  2.32s/it] {'epoch': 40, 'num_users': 6.4167, 'loss': 13204914063.639, 'hit_ratio@10': 0.1135, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9741}:  40%|████      | 12/30 [00:24<00:33,  1.85s/it]{'epoch': 40, 'num_users': 6.6154, 'loss': 12189545677.5472, 'hit_ratio@10': 0.1118, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9731}:  40%|████      | 12/30 [00:26<00:33,  1.85s/it]{'epoch': 40, 'num_users': 6.6154, 'loss': 12189545677.5472, 'hit_ratio@10': 0.1118, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9731}:  43%|████▎     | 13/30 [00:26<00:29,  1.75s/it]{'epoch': 40, 'num_users': 6.3571, 'loss': 1689542351014.4844, 'hit_ratio@10': 0.1038, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7847}:  43%|████▎     | 13/30 [00:26<00:29,  1.75s/it]{'epoch': 40, 'num_users': 6.3571, 'loss': 1689542351014.4844, 'hit_ratio@10': 0.1038, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7847}:  47%|████▋     | 14/30 [00:26<00:21,  1.33s/it]{'epoch': 40, 'num_users': 6.2667, 'loss': 1576906208446.4192, 'hit_ratio@10': 0.1076, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8772}:  47%|████▋     | 14/30 [00:29<00:21,  1.33s/it]{'epoch': 40, 'num_users': 6.2667, 'loss': 1576906208446.4192, 'hit_ratio@10': 0.1076, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8772}:  50%|█████     | 15/30 [00:29<00:25,  1.73s/it]{'epoch': 40, 'num_users': 6.0625, 'loss': 1483583206490.518, 'hit_ratio@10': 0.1061, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.743}:  50%|█████     | 15/30 [00:30<00:25,  1.73s/it]  {'epoch': 40, 'num_users': 6.0625, 'loss': 1483583206490.518, 'hit_ratio@10': 0.1061, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.743}:  53%|█████▎    | 16/30 [00:30<00:20,  1.44s/it]{'epoch': 40, 'num_users': 5.8235, 'loss': 4712567227995.217, 'hit_ratio@10': 0.1116, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6121}:  53%|█████▎    | 16/30 [00:30<00:20,  1.44s/it]{'epoch': 40, 'num_users': 5.8235, 'loss': 4712567227995.217, 'hit_ratio@10': 0.1116, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6121}:  57%|█████▋    | 17/30 [00:30<00:14,  1.09s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 4450757956187.963, 'hit_ratio@10': 0.1094, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5778}:  57%|█████▋    | 17/30 [00:32<00:14,  1.09s/it]{'epoch': 40, 'num_users': 6.0556, 'loss': 4450757956187.963, 'hit_ratio@10': 0.1094, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5778}:  60%|██████    | 18/30 [00:32<00:16,  1.37s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 4217083384103.5815, 'hit_ratio@10': 0.1074, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.528}:  60%|██████    | 18/30 [00:33<00:16,  1.37s/it]   {'epoch': 40, 'num_users': 6.0, 'loss': 4217083384103.5815, 'hit_ratio@10': 0.1074, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.528}:  63%|██████▎   | 19/30 [00:33<00:13,  1.22s/it]{'epoch': 40, 'num_users': 6.15, 'loss': 4006229221886.0015, 'hit_ratio@10': 0.1073, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5881}:  63%|██████▎   | 19/30 [00:36<00:13,  1.22s/it]{'epoch': 40, 'num_users': 6.15, 'loss': 4006229221886.0015, 'hit_ratio@10': 0.1073, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5881}:  67%|██████▋   | 20/30 [00:36<00:19,  1.98s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 3909707876580.3135, 'hit_ratio@10': 0.1045, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7354}:  67%|██████▋   | 20/30 [00:39<00:19,  1.98s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 3909707876580.3135, 'hit_ratio@10': 0.1045, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7354}:  70%|███████   | 21/30 [00:39<00:20,  2.25s/it]{'epoch': 40, 'num_users': 6.1818, 'loss': 3731994000438.405, 'hit_ratio@10': 0.106, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6747}:  70%|███████   | 21/30 [00:41<00:20,  2.25s/it]  {'epoch': 40, 'num_users': 6.1818, 'loss': 3731994000438.405, 'hit_ratio@10': 0.106, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6747}:  73%|███████▎  | 22/30 [00:41<00:16,  2.00s/it]{'epoch': 40, 'num_users': 6.1304, 'loss': 3569733492518.2563, 'hit_ratio@10': 0.1036, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6694}:  73%|███████▎  | 22/30 [00:42<00:16,  2.00s/it]{'epoch': 40, 'num_users': 6.1304, 'loss': 3569733492518.2563, 'hit_ratio@10': 0.1036, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6694}:  77%|███████▋  | 23/30 [00:42<00:12,  1.79s/it]{'epoch': 40, 'num_users': 5.9583, 'loss': 5084427199415.862, 'hit_ratio@10': 0.1076, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.569}:  77%|███████▋  | 23/30 [00:42<00:12,  1.79s/it]  {'epoch': 40, 'num_users': 5.9583, 'loss': 5084427199415.862, 'hit_ratio@10': 0.1076, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.569}:  80%|████████  | 24/30 [00:42<00:08,  1.34s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 7511695105760.294, 'hit_ratio@10': 0.1033, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4768}:  80%|████████  | 24/30 [00:43<00:08,  1.34s/it]  {'epoch': 40, 'num_users': 5.8, 'loss': 7511695105760.294, 'hit_ratio@10': 0.1033, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4768}:  83%|████████▎ | 25/30 [00:43<00:04,  1.01it/s]{'epoch': 40, 'num_users': 5.8077, 'loss': 7222783755538.9, 'hit_ratio@10': 0.0993, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5943}:  83%|████████▎ | 25/30 [00:48<00:04,  1.01it/s]{'epoch': 40, 'num_users': 5.8077, 'loss': 7222783755538.9, 'hit_ratio@10': 0.0993, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5943}:  87%|████████▋ | 26/30 [00:48<00:09,  2.36s/it]{'epoch': 40, 'num_users': 5.8889, 'loss': 6955307307717.335, 'hit_ratio@10': 0.1022, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6548}:  87%|████████▋ | 26/30 [00:50<00:09,  2.36s/it]{'epoch': 40, 'num_users': 5.8889, 'loss': 6955307307717.335, 'hit_ratio@10': 0.1022, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6548}:  90%|█████████ | 27/30 [00:50<00:06,  2.30s/it]{'epoch': 40, 'num_users': 6.0, 'loss': 6706935729386.883, 'hit_ratio@10': 0.1028, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.686}:  90%|█████████ | 27/30 [00:54<00:06,  2.30s/it]    {'epoch': 40, 'num_users': 6.0, 'loss': 6706935729386.883, 'hit_ratio@10': 0.1028, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.686}:  93%|█████████▎| 28/30 [00:54<00:05,  2.69s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 6475662089765.311, 'hit_ratio@10': 0.1071, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6861}:  93%|█████████▎| 28/30 [00:55<00:05,  2.69s/it]{'epoch': 40, 'num_users': 5.8621, 'loss': 6475662089765.311, 'hit_ratio@10': 0.1071, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6861}:  97%|█████████▋| 29/30 [00:55<00:02,  2.29s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 6259878484328.069, 'hit_ratio@10': 0.1071, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6786}:  97%|█████████▋| 29/30 [00:58<00:02,  2.29s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 6259878484328.069, 'hit_ratio@10': 0.1071, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6786}: 100%|██████████| 30/30 [00:58<00:00,  2.35s/it]{'epoch': 40, 'num_users': 5.8667, 'loss': 6259878484328.069, 'hit_ratio@10': 0.1071, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6786}: 100%|██████████| 30/30 [00:58<00:00,  1.94s/it]
Epoch: 40
Avg # of users: 5.866666666666666
Avg Loss: 6259878484328.069
Avg hit ratio: 0.10711664037430539
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.6786282142003377
Std train time: 1.7479255140517929
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 210479973.5759, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4653}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 210479973.5759, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4653}:   3%|▎         | 1/30 [00:01<00:36,  1.26s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 107703946.0089, 'hit_ratio@10': 0.0263, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.292}:   3%|▎         | 1/30 [00:03<00:36,  1.26s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 107703946.0089, 'hit_ratio@10': 0.0263, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.292}:   7%|▋         | 2/30 [00:03<00:49,  1.78s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 9604727420776.197, 'hit_ratio@10': 0.0652, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7844}:   7%|▋         | 2/30 [00:03<00:49,  1.78s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 9604727420776.197, 'hit_ratio@10': 0.0652, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7844}:  10%|█         | 3/30 [00:03<00:31,  1.16s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 7203545788575.459, 'hit_ratio@10': 0.0757, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.789}:  10%|█         | 3/30 [00:05<00:31,  1.16s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 7203545788575.459, 'hit_ratio@10': 0.0757, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.789}:  13%|█▎        | 4/30 [00:05<00:37,  1.42s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 5762836643700.68, 'hit_ratio@10': 0.0925, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8386}:  13%|█▎        | 4/30 [00:09<00:37,  1.42s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 5762836643700.68, 'hit_ratio@10': 0.0925, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8386}:  17%|█▋        | 5/30 [00:09<00:54,  2.19s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 4802363932861.036, 'hit_ratio@10': 0.1067, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8771}:  17%|█▋        | 5/30 [00:12<00:54,  2.19s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 4802363932861.036, 'hit_ratio@10': 0.1067, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8771}:  20%|██        | 6/30 [00:12<01:00,  2.50s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 4116312437137.1553, 'hit_ratio@10': 0.1086, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.933}:  20%|██        | 6/30 [00:13<01:00,  2.50s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 4116312437137.1553, 'hit_ratio@10': 0.1086, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.933}:  23%|██▎       | 7/30 [00:13<00:51,  2.23s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 3601773382495.373, 'hit_ratio@10': 0.0951, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.849}:  23%|██▎       | 7/30 [00:16<00:51,  2.23s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 3601773382495.373, 'hit_ratio@10': 0.0951, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.849}:  27%|██▋       | 8/30 [00:16<00:49,  2.25s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 3201576368277.624, 'hit_ratio@10': 0.0908, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0736}:  27%|██▋       | 8/30 [00:18<00:49,  2.25s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 3201576368277.624, 'hit_ratio@10': 0.0908, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0736}:  30%|███       | 9/30 [00:18<00:48,  2.32s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 2881418731450.2373, 'hit_ratio@10': 0.0818, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0413}:  30%|███       | 9/30 [00:21<00:48,  2.32s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 2881418731450.2373, 'hit_ratio@10': 0.0818, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0413}:  33%|███▎      | 10/30 [00:21<00:49,  2.46s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 2619471754845.856, 'hit_ratio@10': 0.0813, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0754}:  33%|███▎      | 10/30 [00:23<00:49,  2.46s/it]{'epoch': 41, 'num_users': 6.6364, 'loss': 2619471754845.856, 'hit_ratio@10': 0.0813, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0754}:  37%|███▋      | 11/30 [00:23<00:42,  2.24s/it]{'epoch': 41, 'num_users': 6.4167, 'loss': 2418824157618.479, 'hit_ratio@10': 0.0745, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8842}:  37%|███▋      | 11/30 [00:24<00:42,  2.24s/it]{'epoch': 41, 'num_users': 6.4167, 'loss': 2418824157618.479, 'hit_ratio@10': 0.0745, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8842}:  40%|████      | 12/30 [00:24<00:32,  1.81s/it]{'epoch': 41, 'num_users': 6.6154, 'loss': 2232761254232.762, 'hit_ratio@10': 0.0758, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9004}:  40%|████      | 12/30 [00:25<00:32,  1.81s/it]{'epoch': 41, 'num_users': 6.6154, 'loss': 2232761254232.762, 'hit_ratio@10': 0.0758, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9004}:  43%|████▎     | 13/30 [00:25<00:29,  1.74s/it]{'epoch': 41, 'num_users': 6.3571, 'loss': 2102832750619.5647, 'hit_ratio@10': 0.0704, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7183}:  43%|████▎     | 13/30 [00:26<00:29,  1.74s/it]{'epoch': 41, 'num_users': 6.3571, 'loss': 2102832750619.5647, 'hit_ratio@10': 0.0704, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7183}:  47%|████▋     | 14/30 [00:26<00:21,  1.33s/it]{'epoch': 41, 'num_users': 6.2667, 'loss': 1962643909035.6414, 'hit_ratio@10': 0.0764, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8162}:  47%|████▋     | 14/30 [00:28<00:21,  1.33s/it]{'epoch': 41, 'num_users': 6.2667, 'loss': 1962643909035.6414, 'hit_ratio@10': 0.0764, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8162}:  50%|█████     | 15/30 [00:28<00:23,  1.57s/it]{'epoch': 41, 'num_users': 6.0625, 'loss': 1839978997800.506, 'hit_ratio@10': 0.0717, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6842}:  50%|█████     | 15/30 [00:28<00:23,  1.57s/it] {'epoch': 41, 'num_users': 6.0625, 'loss': 1839978997800.506, 'hit_ratio@10': 0.0717, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6842}:  53%|█████▎    | 16/30 [00:28<00:18,  1.32s/it]{'epoch': 41, 'num_users': 5.8235, 'loss': 1740578833181.088, 'hit_ratio@10': 0.0675, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5559}:  53%|█████▎    | 16/30 [00:29<00:18,  1.32s/it]{'epoch': 41, 'num_users': 5.8235, 'loss': 1740578833181.088, 'hit_ratio@10': 0.0675, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5559}:  57%|█████▋    | 17/30 [00:29<00:13,  1.01s/it]{'epoch': 41, 'num_users': 6.0556, 'loss': 1643880937695.9548, 'hit_ratio@10': 0.0677, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5222}:  57%|█████▋    | 17/30 [00:31<00:13,  1.01s/it]{'epoch': 41, 'num_users': 6.0556, 'loss': 1643880937695.9548, 'hit_ratio@10': 0.0677, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5222}:  60%|██████    | 18/30 [00:31<00:15,  1.30s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 1557361793958.2825, 'hit_ratio@10': 0.0679, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4808}:  60%|██████    | 18/30 [00:32<00:15,  1.30s/it]   {'epoch': 41, 'num_users': 6.0, 'loss': 1557361793958.2825, 'hit_ratio@10': 0.0679, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4808}:  63%|██████▎   | 19/30 [00:32<00:13,  1.18s/it]{'epoch': 41, 'num_users': 6.15, 'loss': 1479518516036.6794, 'hit_ratio@10': 0.0715, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5521}:  63%|██████▎   | 19/30 [00:36<00:13,  1.18s/it]{'epoch': 41, 'num_users': 6.15, 'loss': 1479518516036.6794, 'hit_ratio@10': 0.0715, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5521}:  67%|██████▋   | 20/30 [00:36<00:20,  2.01s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 1409065276541.383, 'hit_ratio@10': 0.0717, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6919}:  67%|██████▋   | 20/30 [00:38<00:20,  2.01s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 1409065276541.383, 'hit_ratio@10': 0.0717, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6919}:  70%|███████   | 21/30 [00:38<00:20,  2.24s/it]{'epoch': 41, 'num_users': 6.1818, 'loss': 1345017335096.2068, 'hit_ratio@10': 0.0787, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6306}:  70%|███████   | 21/30 [00:40<00:20,  2.24s/it]{'epoch': 41, 'num_users': 6.1818, 'loss': 1345017335096.2068, 'hit_ratio@10': 0.0787, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6306}:  73%|███████▎  | 22/30 [00:40<00:15,  1.98s/it]{'epoch': 41, 'num_users': 6.1304, 'loss': 1286541431973.257, 'hit_ratio@10': 0.0775, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6196}:  73%|███████▎  | 22/30 [00:41<00:15,  1.98s/it] {'epoch': 41, 'num_users': 6.1304, 'loss': 1286541431973.257, 'hit_ratio@10': 0.0775, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6196}:  77%|███████▋  | 23/30 [00:41<00:12,  1.75s/it]{'epoch': 41, 'num_users': 5.9583, 'loss': 1291423537028.7715, 'hit_ratio@10': 0.0909, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5203}:  77%|███████▋  | 23/30 [00:41<00:12,  1.75s/it]{'epoch': 41, 'num_users': 5.9583, 'loss': 1291423537028.7715, 'hit_ratio@10': 0.0909, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5203}:  80%|████████  | 24/30 [00:41<00:07,  1.31s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 7115432404027.195, 'hit_ratio@10': 0.0873, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4295}:  80%|████████  | 24/30 [00:41<00:07,  1.31s/it]    {'epoch': 41, 'num_users': 5.8, 'loss': 7115432404027.195, 'hit_ratio@10': 0.0873, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4295}:  83%|████████▎ | 25/30 [00:41<00:04,  1.04it/s]{'epoch': 41, 'num_users': 5.8077, 'loss': 6841761926949.382, 'hit_ratio@10': 0.0839, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5437}:  83%|████████▎ | 25/30 [00:47<00:04,  1.04it/s]{'epoch': 41, 'num_users': 5.8077, 'loss': 6841761926949.382, 'hit_ratio@10': 0.0839, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5437}:  87%|████████▋ | 26/30 [00:47<00:09,  2.30s/it]{'epoch': 41, 'num_users': 5.8889, 'loss': 6588363356399.638, 'hit_ratio@10': 0.0848, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5896}:  87%|████████▋ | 26/30 [00:49<00:09,  2.30s/it]{'epoch': 41, 'num_users': 5.8889, 'loss': 6588363356399.638, 'hit_ratio@10': 0.0848, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5896}:  90%|█████████ | 27/30 [00:49<00:06,  2.19s/it]{'epoch': 41, 'num_users': 6.0, 'loss': 6353064679785.398, 'hit_ratio@10': 0.0853, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6231}:  90%|█████████ | 27/30 [00:52<00:06,  2.19s/it]   {'epoch': 41, 'num_users': 6.0, 'loss': 6353064679785.398, 'hit_ratio@10': 0.0853, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6231}:  93%|█████████▎| 28/30 [00:52<00:05,  2.60s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 6133993907708.472, 'hit_ratio@10': 0.087, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.627}:  93%|█████████▎| 28/30 [00:54<00:05,  2.60s/it]{'epoch': 41, 'num_users': 5.8621, 'loss': 6133993907708.472, 'hit_ratio@10': 0.087, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.627}:  97%|█████████▋| 29/30 [00:54<00:02,  2.24s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 5929527456750.863, 'hit_ratio@10': 0.0877, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.621}:  97%|█████████▋| 29/30 [00:56<00:02,  2.24s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 5929527456750.863, 'hit_ratio@10': 0.0877, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.621}: 100%|██████████| 30/30 [00:56<00:00,  2.31s/it]{'epoch': 41, 'num_users': 5.8667, 'loss': 5929527456750.863, 'hit_ratio@10': 0.0877, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.621}: 100%|██████████| 30/30 [00:56<00:00,  1.89s/it]
Epoch: 41
Avg # of users: 5.866666666666666
Avg Loss: 5929527456750.863
Avg hit ratio: 0.08772697563015151
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.6209596474965413
Std train time: 1.6705345092801098
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 8002399.2771, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5576}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 8002399.2771, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5576}:   3%|▎         | 1/30 [00:01<00:37,  1.31s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 4128037.5332, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.308}:   3%|▎         | 1/30 [00:03<00:37,  1.31s/it] {'epoch': 42, 'num_users': 7.0, 'loss': 4128037.5332, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.308}:   7%|▋         | 2/30 [00:03<00:49,  1.77s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 55826170490.546, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7962}:   7%|▋         | 2/30 [00:03<00:49,  1.77s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 55826170490.546, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7962}:  10%|█         | 3/30 [00:03<00:31,  1.15s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 911633010423.338, 'hit_ratio@10': 0.0799, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7943}:  10%|█         | 3/30 [00:05<00:31,  1.15s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 911633010423.338, 'hit_ratio@10': 0.0799, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7943}:  13%|█▎        | 4/30 [00:05<00:36,  1.41s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 729306408339.3198, 'hit_ratio@10': 0.0639, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7996}:  13%|█▎        | 4/30 [00:09<00:36,  1.41s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 729306408339.3198, 'hit_ratio@10': 0.0639, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7996}:  17%|█▋        | 5/30 [00:09<00:53,  2.14s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 607755340283.4272, 'hit_ratio@10': 0.0533, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8645}:  17%|█▋        | 5/30 [00:12<00:53,  2.14s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 607755340283.4272, 'hit_ratio@10': 0.0533, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8645}:  20%|██        | 6/30 [00:12<01:00,  2.51s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 520933559157.8137, 'hit_ratio@10': 0.0456, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9639}:  20%|██        | 6/30 [00:14<01:00,  2.51s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 520933559157.8137, 'hit_ratio@10': 0.0456, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9639}:  23%|██▎       | 7/30 [00:14<00:52,  2.28s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 457738939389.4512, 'hit_ratio@10': 0.0507, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8898}:  23%|██▎       | 7/30 [00:16<00:52,  2.28s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 457738939389.4512, 'hit_ratio@10': 0.0507, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8898}:  27%|██▋       | 8/30 [00:16<00:51,  2.32s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 2207534728821.1377, 'hit_ratio@10': 0.0546, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1}:  27%|██▋       | 8/30 [00:18<00:51,  2.32s/it] {'epoch': 42, 'num_users': 6.3333, 'loss': 2207534728821.1377, 'hit_ratio@10': 0.0546, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1}:  30%|███       | 9/30 [00:18<00:49,  2.35s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 1986781268464.108, 'hit_ratio@10': 0.0514, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0792}:  30%|███       | 9/30 [00:21<00:49,  2.35s/it] {'epoch': 42, 'num_users': 6.3, 'loss': 1986781268464.108, 'hit_ratio@10': 0.0514, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0792}:  33%|███▎      | 10/30 [00:21<00:50,  2.53s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 1806641988147.0088, 'hit_ratio@10': 0.0502, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1225}:  33%|███▎      | 10/30 [00:23<00:50,  2.53s/it]{'epoch': 42, 'num_users': 6.6364, 'loss': 1806641988147.0088, 'hit_ratio@10': 0.0502, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1225}:  37%|███▋      | 11/30 [00:23<00:43,  2.31s/it]{'epoch': 42, 'num_users': 6.4167, 'loss': 1656089413895.4143, 'hit_ratio@10': 0.053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9242}:  37%|███▋      | 11/30 [00:24<00:43,  2.31s/it] {'epoch': 42, 'num_users': 6.4167, 'loss': 1656089413895.4143, 'hit_ratio@10': 0.053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9242}:  40%|████      | 12/30 [00:24<00:33,  1.84s/it]{'epoch': 42, 'num_users': 6.6154, 'loss': 1528701440069.1562, 'hit_ratio@10': 0.0559, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9314}:  40%|████      | 12/30 [00:25<00:33,  1.84s/it]{'epoch': 42, 'num_users': 6.6154, 'loss': 1528701440069.1562, 'hit_ratio@10': 0.0559, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9314}:  43%|████▎     | 13/30 [00:25<00:29,  1.75s/it]{'epoch': 42, 'num_users': 6.3571, 'loss': 24719401923892.027, 'hit_ratio@10': 0.0519, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7459}:  43%|████▎     | 13/30 [00:26<00:29,  1.75s/it]{'epoch': 42, 'num_users': 6.3571, 'loss': 24719401923892.027, 'hit_ratio@10': 0.0519, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7459}:  47%|████▋     | 14/30 [00:26<00:21,  1.33s/it]{'epoch': 42, 'num_users': 6.2667, 'loss': 23071441795632.754, 'hit_ratio@10': 0.0484, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8177}:  47%|████▋     | 14/30 [00:28<00:21,  1.33s/it]{'epoch': 42, 'num_users': 6.2667, 'loss': 23071441795632.754, 'hit_ratio@10': 0.0484, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8177}:  50%|█████     | 15/30 [00:28<00:22,  1.52s/it]{'epoch': 42, 'num_users': 6.0625, 'loss': 21670614725656.375, 'hit_ratio@10': 0.0454, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6831}:  50%|█████     | 15/30 [00:28<00:22,  1.52s/it]{'epoch': 42, 'num_users': 6.0625, 'loss': 21670614725656.375, 'hit_ratio@10': 0.0454, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6831}:  53%|█████▎    | 16/30 [00:28<00:17,  1.27s/it]{'epoch': 42, 'num_users': 5.8235, 'loss': 58269803624205.91, 'hit_ratio@10': 0.0545, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5539}:  53%|█████▎    | 16/30 [00:29<00:17,  1.27s/it] {'epoch': 42, 'num_users': 5.8235, 'loss': 58269803624205.91, 'hit_ratio@10': 0.0545, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5539}:  57%|█████▋    | 17/30 [00:29<00:12,  1.03it/s]{'epoch': 42, 'num_users': 6.0556, 'loss': 55032592389231.66, 'hit_ratio@10': 0.0554, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.515}:  57%|█████▋    | 17/30 [00:31<00:12,  1.03it/s] {'epoch': 42, 'num_users': 6.0556, 'loss': 55032592389231.66, 'hit_ratio@10': 0.0554, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.515}:  60%|██████    | 18/30 [00:31<00:14,  1.24s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 52141531130924.336, 'hit_ratio@10': 0.0563, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.478}:  60%|██████    | 18/30 [00:32<00:14,  1.24s/it]  {'epoch': 42, 'num_users': 6.0, 'loss': 52141531130924.336, 'hit_ratio@10': 0.0563, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.478}:  63%|██████▎   | 19/30 [00:32<00:12,  1.15s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 49534454574378.3, 'hit_ratio@10': 0.0535, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5582}:  63%|██████▎   | 19/30 [00:36<00:12,  1.15s/it]{'epoch': 42, 'num_users': 6.15, 'loss': 49534454574378.3, 'hit_ratio@10': 0.0535, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5582}:  67%|██████▋   | 20/30 [00:36<00:20,  2.05s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 47175671023217.62, 'hit_ratio@10': 0.0509, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7165}:  67%|██████▋   | 20/30 [00:39<00:20,  2.05s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 47175671023217.62, 'hit_ratio@10': 0.0509, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7165}:  70%|███████   | 21/30 [00:39<00:20,  2.33s/it]{'epoch': 42, 'num_users': 6.1818, 'loss': 46530500584778.6, 'hit_ratio@10': 0.0527, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6595}:  70%|███████   | 21/30 [00:40<00:20,  2.33s/it] {'epoch': 42, 'num_users': 6.1818, 'loss': 46530500584778.6, 'hit_ratio@10': 0.0527, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6595}:  73%|███████▎  | 22/30 [00:40<00:16,  2.08s/it]{'epoch': 42, 'num_users': 6.1304, 'loss': 44507442094543.44, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6568}:  73%|███████▎  | 22/30 [00:41<00:16,  2.08s/it]{'epoch': 42, 'num_users': 6.1304, 'loss': 44507442094543.44, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6568}:  77%|███████▋  | 23/30 [00:41<00:12,  1.85s/it]{'epoch': 42, 'num_users': 5.9583, 'loss': 58380284701730.53, 'hit_ratio@10': 0.0588, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5569}:  77%|███████▋  | 23/30 [00:42<00:12,  1.85s/it]{'epoch': 42, 'num_users': 5.9583, 'loss': 58380284701730.53, 'hit_ratio@10': 0.0588, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5569}:  80%|████████  | 24/30 [00:42<00:08,  1.38s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 119581950810445.52, 'hit_ratio@10': 0.0564, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4647}:  80%|████████  | 24/30 [00:42<00:08,  1.38s/it]  {'epoch': 42, 'num_users': 5.8, 'loss': 119581950810445.52, 'hit_ratio@10': 0.0564, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4647}:  83%|████████▎ | 25/30 [00:42<00:05,  1.01s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 114982645010043.92, 'hit_ratio@10': 0.0542, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5855}:  83%|████████▎ | 25/30 [00:48<00:05,  1.01s/it]{'epoch': 42, 'num_users': 5.8077, 'loss': 114982645010043.92, 'hit_ratio@10': 0.0542, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5855}:  87%|████████▋ | 26/30 [00:48<00:09,  2.40s/it]{'epoch': 42, 'num_users': 5.8889, 'loss': 110724046347933.19, 'hit_ratio@10': 0.0549, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6185}:  87%|████████▋ | 26/30 [00:49<00:09,  2.40s/it]{'epoch': 42, 'num_users': 5.8889, 'loss': 110724046347933.19, 'hit_ratio@10': 0.0549, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6185}:  90%|█████████ | 27/30 [00:49<00:06,  2.21s/it]{'epoch': 42, 'num_users': 6.0, 'loss': 106769616171159.33, 'hit_ratio@10': 0.0564, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6502}:  90%|█████████ | 27/30 [00:53<00:06,  2.21s/it]   {'epoch': 42, 'num_users': 6.0, 'loss': 106769616171159.33, 'hit_ratio@10': 0.0564, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6502}:  93%|█████████▎| 28/30 [00:53<00:05,  2.61s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 103087926378311.95, 'hit_ratio@10': 0.0592, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6519}:  93%|█████████▎| 28/30 [00:54<00:05,  2.61s/it]{'epoch': 42, 'num_users': 5.8621, 'loss': 103087926378311.95, 'hit_ratio@10': 0.0592, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6519}:  97%|█████████▋| 29/30 [00:54<00:02,  2.24s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 100184144453027.89, 'hit_ratio@10': 0.0599, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6456}:  97%|█████████▋| 29/30 [00:57<00:02,  2.24s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 100184144453027.89, 'hit_ratio@10': 0.0599, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6456}: 100%|██████████| 30/30 [00:57<00:00,  2.32s/it]{'epoch': 42, 'num_users': 5.8667, 'loss': 100184144453027.89, 'hit_ratio@10': 0.0599, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6456}: 100%|██████████| 30/30 [00:57<00:00,  1.91s/it]
Epoch: 42
Avg # of users: 5.866666666666666
Avg Loss: 100184144453027.89
Avg hit ratio: 0.059902913912201844
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.645604944229126
Std train time: 1.6799131237987965
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 710156583.9276, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.477}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 710156583.9276, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.477}:   3%|▎         | 1/30 [00:01<00:36,  1.27s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 355585680.2894, 'hit_ratio@10': 0.0849, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3246}:   3%|▎         | 1/30 [00:03<00:36,  1.27s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 355585680.2894, 'hit_ratio@10': 0.0849, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3246}:   7%|▋         | 2/30 [00:03<00:50,  1.82s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 15987349742883.24, 'hit_ratio@10': 0.1042, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8181}:   7%|▋         | 2/30 [00:03<00:50,  1.82s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 15987349742883.24, 'hit_ratio@10': 0.1042, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8181}:  10%|█         | 3/30 [00:03<00:31,  1.18s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 11990512925007.137, 'hit_ratio@10': 0.1049, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8122}:  10%|█         | 3/30 [00:05<00:31,  1.18s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 11990512925007.137, 'hit_ratio@10': 0.1049, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8122}:  13%|█▎        | 4/30 [00:05<00:37,  1.44s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 9592410746845.498, 'hit_ratio@10': 0.128, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8544}:  13%|█▎        | 4/30 [00:09<00:37,  1.44s/it]  {'epoch': 43, 'num_users': 5.8, 'loss': 9592410746845.498, 'hit_ratio@10': 0.128, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8544}:  17%|█▋        | 5/30 [00:09<00:54,  2.20s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 7993675793250.727, 'hit_ratio@10': 0.1289, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9045}:  17%|█▋        | 5/30 [00:12<00:54,  2.20s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 7993675793250.727, 'hit_ratio@10': 0.1289, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9045}:  20%|██        | 6/30 [00:12<01:00,  2.53s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 6851722252311.516, 'hit_ratio@10': 0.1219, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.963}:  20%|██        | 6/30 [00:14<01:00,  2.53s/it] {'epoch': 43, 'num_users': 6.2857, 'loss': 6851722252311.516, 'hit_ratio@10': 0.1219, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.963}:  23%|██▎       | 7/30 [00:14<00:51,  2.26s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 5995257098105.051, 'hit_ratio@10': 0.1245, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.877}:  23%|██▎       | 7/30 [00:16<00:51,  2.26s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 5995257098105.051, 'hit_ratio@10': 0.1245, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.877}:  27%|██▋       | 8/30 [00:16<00:49,  2.27s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 5329117420538.317, 'hit_ratio@10': 0.1107, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.114}:  27%|██▋       | 8/30 [00:18<00:49,  2.27s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 5329117420538.317, 'hit_ratio@10': 0.1107, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.114}:  30%|███       | 9/30 [00:18<00:49,  2.35s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 4796213557128.275, 'hit_ratio@10': 0.1064, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0974}:  30%|███       | 9/30 [00:21<00:49,  2.35s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 4796213557128.275, 'hit_ratio@10': 0.1064, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0974}:  33%|███▎      | 10/30 [00:21<00:50,  2.55s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 4360194388563.0464, 'hit_ratio@10': 0.1037, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1494}:  33%|███▎      | 10/30 [00:23<00:50,  2.55s/it]{'epoch': 43, 'num_users': 6.6364, 'loss': 4360194388563.0464, 'hit_ratio@10': 0.1037, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1494}:  37%|███▋      | 11/30 [00:23<00:44,  2.34s/it]{'epoch': 43, 'num_users': 6.4167, 'loss': 4044569482913.459, 'hit_ratio@10': 0.102, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9485}:  37%|███▋      | 11/30 [00:24<00:44,  2.34s/it]  {'epoch': 43, 'num_users': 6.4167, 'loss': 4044569482913.459, 'hit_ratio@10': 0.102, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9485}:  40%|████      | 12/30 [00:24<00:33,  1.87s/it]{'epoch': 43, 'num_users': 6.6154, 'loss': 3733448830438.635, 'hit_ratio@10': 0.1082, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9589}:  40%|████      | 12/30 [00:26<00:33,  1.87s/it]{'epoch': 43, 'num_users': 6.6154, 'loss': 3733448830438.635, 'hit_ratio@10': 0.1082, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9589}:  43%|████▎     | 13/30 [00:26<00:30,  1.78s/it]{'epoch': 43, 'num_users': 6.3571, 'loss': 3545825956413.78, 'hit_ratio@10': 0.1004, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7713}:  43%|████▎     | 13/30 [00:26<00:30,  1.78s/it] {'epoch': 43, 'num_users': 6.3571, 'loss': 3545825956413.78, 'hit_ratio@10': 0.1004, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7713}:  47%|████▋     | 14/30 [00:26<00:21,  1.35s/it]{'epoch': 43, 'num_users': 6.2667, 'loss': 3309437559319.7217, 'hit_ratio@10': 0.0937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8604}:  47%|████▋     | 14/30 [00:28<00:21,  1.35s/it]{'epoch': 43, 'num_users': 6.2667, 'loss': 3309437559319.7217, 'hit_ratio@10': 0.0937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8604}:  50%|█████     | 15/30 [00:28<00:23,  1.57s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 3102602801940.4614, 'hit_ratio@10': 0.0879, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7298}:  50%|█████     | 15/30 [00:29<00:23,  1.57s/it]{'epoch': 43, 'num_users': 6.0625, 'loss': 3102602801940.4614, 'hit_ratio@10': 0.0879, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7298}:  53%|█████▎    | 16/30 [00:29<00:18,  1.34s/it]{'epoch': 43, 'num_users': 5.8235, 'loss': 3785260949571.446, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6005}:  53%|█████▎    | 16/30 [00:29<00:18,  1.34s/it] {'epoch': 43, 'num_users': 5.8235, 'loss': 3785260949571.446, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6005}:  57%|█████▋    | 17/30 [00:29<00:13,  1.03s/it]{'epoch': 43, 'num_users': 6.0556, 'loss': 3574968674595.477, 'hit_ratio@10': 0.0781, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5597}:  57%|█████▋    | 17/30 [00:31<00:13,  1.03s/it]{'epoch': 43, 'num_users': 6.0556, 'loss': 3574968674595.477, 'hit_ratio@10': 0.0781, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5597}:  60%|██████    | 18/30 [00:31<00:15,  1.31s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 3386812878011.934, 'hit_ratio@10': 0.0815, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5268}:  60%|██████    | 18/30 [00:32<00:15,  1.31s/it]   {'epoch': 43, 'num_users': 6.0, 'loss': 3386812878011.934, 'hit_ratio@10': 0.0815, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5268}:  63%|██████▎   | 19/30 [00:32<00:13,  1.22s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 3224542372559.032, 'hit_ratio@10': 0.0853, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5877}:  63%|██████▎   | 19/30 [00:36<00:13,  1.22s/it]{'epoch': 43, 'num_users': 6.15, 'loss': 3224542372559.032, 'hit_ratio@10': 0.0853, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5877}:  67%|██████▋   | 20/30 [00:36<00:19,  1.99s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 3070992735770.7046, 'hit_ratio@10': 0.0813, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7211}:  67%|██████▋   | 20/30 [00:39<00:19,  1.99s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 3070992735770.7046, 'hit_ratio@10': 0.0813, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7211}:  70%|███████   | 21/30 [00:39<00:19,  2.21s/it]{'epoch': 43, 'num_users': 6.1818, 'loss': 2931406283849.852, 'hit_ratio@10': 0.0859, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6592}:  70%|███████   | 21/30 [00:40<00:19,  2.21s/it] {'epoch': 43, 'num_users': 6.1818, 'loss': 2931406283849.852, 'hit_ratio@10': 0.0859, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6592}:  73%|███████▎  | 22/30 [00:40<00:15,  1.96s/it]{'epoch': 43, 'num_users': 6.1304, 'loss': 2803968763408.961, 'hit_ratio@10': 0.0865, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6564}:  73%|███████▎  | 22/30 [00:41<00:15,  1.96s/it]{'epoch': 43, 'num_users': 6.1304, 'loss': 2803968763408.961, 'hit_ratio@10': 0.0865, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6564}:  77%|███████▋  | 23/30 [00:41<00:12,  1.77s/it]{'epoch': 43, 'num_users': 5.9583, 'loss': 3087583624314.9204, 'hit_ratio@10': 0.0912, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.557}:  77%|███████▋  | 23/30 [00:42<00:12,  1.77s/it]{'epoch': 43, 'num_users': 5.9583, 'loss': 3087583624314.9204, 'hit_ratio@10': 0.0912, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.557}:  80%|████████  | 24/30 [00:42<00:07,  1.33s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 10027695475270.217, 'hit_ratio@10': 0.0876, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4653}:  80%|████████  | 24/30 [00:42<00:07,  1.33s/it]  {'epoch': 43, 'num_users': 5.8, 'loss': 10027695475270.217, 'hit_ratio@10': 0.0876, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4653}:  83%|████████▎ | 25/30 [00:42<00:04,  1.02it/s]{'epoch': 43, 'num_users': 5.8077, 'loss': 9714743129053.023, 'hit_ratio@10': 0.0898, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.586}:  83%|████████▎ | 25/30 [00:48<00:04,  1.02it/s]{'epoch': 43, 'num_users': 5.8077, 'loss': 9714743129053.023, 'hit_ratio@10': 0.0898, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.586}:  87%|████████▋ | 26/30 [00:48<00:09,  2.38s/it]{'epoch': 43, 'num_users': 5.8889, 'loss': 9354937865409.021, 'hit_ratio@10': 0.0918, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6298}:  87%|████████▋ | 26/30 [00:49<00:09,  2.38s/it]{'epoch': 43, 'num_users': 5.8889, 'loss': 9354937865409.021, 'hit_ratio@10': 0.0918, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6298}:  90%|█████████ | 27/30 [00:49<00:06,  2.24s/it]{'epoch': 43, 'num_users': 6.0, 'loss': 9020832968809.637, 'hit_ratio@10': 0.0913, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6655}:  90%|█████████ | 27/30 [00:53<00:06,  2.24s/it]   {'epoch': 43, 'num_users': 6.0, 'loss': 9020832968809.637, 'hit_ratio@10': 0.0913, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6655}:  93%|█████████▎| 28/30 [00:53<00:05,  2.67s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 8709771615186.145, 'hit_ratio@10': 0.0897, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6741}:  93%|█████████▎| 28/30 [00:55<00:05,  2.67s/it]{'epoch': 43, 'num_users': 5.8621, 'loss': 8709771615186.145, 'hit_ratio@10': 0.0897, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6741}:  97%|█████████▋| 29/30 [00:55<00:02,  2.31s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 8419445951353.119, 'hit_ratio@10': 0.0894, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6643}:  97%|█████████▋| 29/30 [00:57<00:02,  2.31s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 8419445951353.119, 'hit_ratio@10': 0.0894, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6643}: 100%|██████████| 30/30 [00:57<00:00,  2.34s/it]{'epoch': 43, 'num_users': 5.8667, 'loss': 8419445951353.119, 'hit_ratio@10': 0.0894, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6643}: 100%|██████████| 30/30 [00:57<00:00,  1.92s/it]
Epoch: 43
Avg # of users: 5.866666666666666
Avg Loss: 8419445951353.119
Avg hit ratio: 0.08943206134159115
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.6642858664194744
Std train time: 1.6766376519298425
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 49667564.3609, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6002}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 49667564.3609, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6002}:   3%|▎         | 1/30 [00:01<00:38,  1.33s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 122518864.9466, 'hit_ratio@10': 0.0586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3892}:   3%|▎         | 1/30 [00:03<00:38,  1.33s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 122518864.9466, 'hit_ratio@10': 0.0586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3892}:   7%|▋         | 2/30 [00:03<00:51,  1.85s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 26893103657.7739, 'hit_ratio@10': 0.0867, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8831}:   7%|▋         | 2/30 [00:04<00:51,  1.85s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 26893103657.7739, 'hit_ratio@10': 0.0867, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8831}:  10%|█         | 3/30 [00:04<00:32,  1.22s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 20171400595.7411, 'hit_ratio@10': 0.0829, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8836}:  10%|█         | 3/30 [00:05<00:32,  1.22s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 20171400595.7411, 'hit_ratio@10': 0.0829, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8836}:  13%|█▎        | 4/30 [00:05<00:38,  1.49s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 16161363501.9025, 'hit_ratio@10': 0.0863, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9524}:  13%|█▎        | 4/30 [00:09<00:38,  1.49s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 16161363501.9025, 'hit_ratio@10': 0.0863, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9524}:  17%|█▋        | 5/30 [00:09<00:56,  2.27s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 13470816596.4013, 'hit_ratio@10': 0.083, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.995}:  17%|█▋        | 5/30 [00:12<00:56,  2.27s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 13470816596.4013, 'hit_ratio@10': 0.083, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.995}:  20%|██        | 6/30 [00:12<01:02,  2.60s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 11568535763.4189, 'hit_ratio@10': 0.094, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0473}:  20%|██        | 6/30 [00:14<01:02,  2.60s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 11568535763.4189, 'hit_ratio@10': 0.094, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0473}:  23%|██▎       | 7/30 [00:14<00:53,  2.31s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 10130348035.2353, 'hit_ratio@10': 0.1073, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9573}:  23%|██▎       | 7/30 [00:16<00:53,  2.31s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 10130348035.2353, 'hit_ratio@10': 0.1073, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9573}:  27%|██▋       | 8/30 [00:16<00:51,  2.33s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 9005685810.1044, 'hit_ratio@10': 0.0953, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1982}:  27%|██▋       | 8/30 [00:19<00:51,  2.33s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 9005685810.1044, 'hit_ratio@10': 0.0953, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1982}:  30%|███       | 9/30 [00:19<00:50,  2.41s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 8105117229.4683, 'hit_ratio@10': 0.0858, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1789}:  30%|███       | 9/30 [00:22<00:50,  2.41s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 8105117229.4683, 'hit_ratio@10': 0.0858, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1789}:  33%|███▎      | 10/30 [00:22<00:52,  2.60s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 7369754886.1075, 'hit_ratio@10': 0.085, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2093}:  33%|███▎      | 10/30 [00:24<00:52,  2.60s/it]{'epoch': 44, 'num_users': 6.6364, 'loss': 7369754886.1075, 'hit_ratio@10': 0.085, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2093}:  37%|███▋      | 11/30 [00:24<00:44,  2.35s/it]{'epoch': 44, 'num_users': 6.4167, 'loss': 6791726453.4371, 'hit_ratio@10': 0.0849, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0032}:  37%|███▋      | 11/30 [00:25<00:44,  2.35s/it]{'epoch': 44, 'num_users': 6.4167, 'loss': 6791726453.4371, 'hit_ratio@10': 0.0849, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0032}:  40%|████      | 12/30 [00:25<00:33,  1.87s/it]{'epoch': 44, 'num_users': 6.6154, 'loss': 6319778687.7336, 'hit_ratio@10': 0.0923, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0099}:  40%|████      | 12/30 [00:26<00:33,  1.87s/it]{'epoch': 44, 'num_users': 6.6154, 'loss': 6319778687.7336, 'hit_ratio@10': 0.0923, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0099}:  43%|████▎     | 13/30 [00:26<00:30,  1.78s/it]{'epoch': 44, 'num_users': 6.3571, 'loss': 31529006229.086, 'hit_ratio@10': 0.0857, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8188}:  43%|████▎     | 13/30 [00:26<00:30,  1.78s/it]{'epoch': 44, 'num_users': 6.3571, 'loss': 31529006229.086, 'hit_ratio@10': 0.0857, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8188}:  47%|████▋     | 14/30 [00:26<00:21,  1.35s/it]{'epoch': 44, 'num_users': 6.2667, 'loss': 29456540745.3123, 'hit_ratio@10': 0.0929, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9012}:  47%|████▋     | 14/30 [00:29<00:21,  1.35s/it]{'epoch': 44, 'num_users': 6.2667, 'loss': 29456540745.3123, 'hit_ratio@10': 0.0929, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9012}:  50%|█████     | 15/30 [00:29<00:23,  1.56s/it]{'epoch': 44, 'num_users': 6.0625, 'loss': 27915684661.2303, 'hit_ratio@10': 0.0871, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7642}:  50%|█████     | 15/30 [00:29<00:23,  1.56s/it]{'epoch': 44, 'num_users': 6.0625, 'loss': 27915684661.2303, 'hit_ratio@10': 0.0871, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7642}:  53%|█████▎    | 16/30 [00:29<00:18,  1.32s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 10024659013585.723, 'hit_ratio@10': 0.0937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6356}:  53%|█████▎    | 16/30 [00:30<00:18,  1.32s/it]{'epoch': 44, 'num_users': 5.8235, 'loss': 10024659013585.723, 'hit_ratio@10': 0.0937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6356}:  57%|█████▋    | 17/30 [00:30<00:13,  1.02s/it]{'epoch': 44, 'num_users': 6.0556, 'loss': 9467733837379.566, 'hit_ratio@10': 0.0925, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.592}:  57%|█████▋    | 17/30 [00:31<00:13,  1.02s/it]  {'epoch': 44, 'num_users': 6.0556, 'loss': 9467733837379.566, 'hit_ratio@10': 0.0925, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.592}:  60%|██████    | 18/30 [00:31<00:15,  1.28s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 8969760961710.34, 'hit_ratio@10': 0.0989, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.552}:  60%|██████    | 18/30 [00:32<00:15,  1.28s/it]    {'epoch': 44, 'num_users': 6.0, 'loss': 8969760961710.34, 'hit_ratio@10': 0.0989, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.552}:  63%|██████▎   | 19/30 [00:32<00:13,  1.19s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 8521272913624.995, 'hit_ratio@10': 0.094, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6181}:  63%|██████▎   | 19/30 [00:36<00:13,  1.19s/it]{'epoch': 44, 'num_users': 6.15, 'loss': 8521272913624.995, 'hit_ratio@10': 0.094, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6181}:  67%|██████▋   | 20/30 [00:36<00:20,  2.00s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 8115499306172.917, 'hit_ratio@10': 0.0954, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7525}:  67%|██████▋   | 20/30 [00:39<00:20,  2.00s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 8115499306172.917, 'hit_ratio@10': 0.0954, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7525}:  70%|███████   | 21/30 [00:39<00:20,  2.23s/it]{'epoch': 44, 'num_users': 6.1818, 'loss': 7746613156076.862, 'hit_ratio@10': 0.0973, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6858}:  70%|███████   | 21/30 [00:40<00:20,  2.23s/it]{'epoch': 44, 'num_users': 6.1818, 'loss': 7746613156076.862, 'hit_ratio@10': 0.0973, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6858}:  73%|███████▎  | 22/30 [00:40<00:15,  1.95s/it]{'epoch': 44, 'num_users': 6.1304, 'loss': 7409804508401.232, 'hit_ratio@10': 0.0996, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6718}:  73%|███████▎  | 22/30 [00:42<00:15,  1.95s/it]{'epoch': 44, 'num_users': 6.1304, 'loss': 7409804508401.232, 'hit_ratio@10': 0.0996, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6718}:  77%|███████▋  | 23/30 [00:42<00:12,  1.73s/it]{'epoch': 44, 'num_users': 5.9583, 'loss': 18238400090727.184, 'hit_ratio@10': 0.1038, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5704}:  77%|███████▋  | 23/30 [00:42<00:12,  1.73s/it]{'epoch': 44, 'num_users': 5.9583, 'loss': 18238400090727.184, 'hit_ratio@10': 0.1038, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5704}:  80%|████████  | 24/30 [00:42<00:07,  1.29s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 96966510682374.9, 'hit_ratio@10': 0.0996, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4776}:  80%|████████  | 24/30 [00:42<00:07,  1.29s/it]     {'epoch': 44, 'num_users': 5.8, 'loss': 96966510682374.9, 'hit_ratio@10': 0.0996, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4776}:  83%|████████▎ | 25/30 [00:42<00:04,  1.05it/s]{'epoch': 44, 'num_users': 5.8077, 'loss': 93237029502283.72, 'hit_ratio@10': 0.0958, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.594}:  83%|████████▎ | 25/30 [00:48<00:04,  1.05it/s]{'epoch': 44, 'num_users': 5.8077, 'loss': 93237029502283.72, 'hit_ratio@10': 0.0958, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.594}:  87%|████████▋ | 26/30 [00:48<00:09,  2.34s/it]{'epoch': 44, 'num_users': 5.8889, 'loss': 89783806359384.58, 'hit_ratio@10': 0.0949, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6412}:  87%|████████▋ | 26/30 [00:50<00:09,  2.34s/it]{'epoch': 44, 'num_users': 5.8889, 'loss': 89783806359384.58, 'hit_ratio@10': 0.0949, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6412}:  90%|█████████ | 27/30 [00:50<00:06,  2.22s/it]{'epoch': 44, 'num_users': 6.0, 'loss': 86577247870694.39, 'hit_ratio@10': 0.0964, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6786}:  90%|█████████ | 27/30 [00:53<00:06,  2.22s/it]   {'epoch': 44, 'num_users': 6.0, 'loss': 86577247870694.39, 'hit_ratio@10': 0.0964, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6786}:  93%|█████████▎| 28/30 [00:53<00:05,  2.67s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 83591825674932.23, 'hit_ratio@10': 0.0947, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6851}:  93%|█████████▎| 28/30 [00:55<00:05,  2.67s/it]{'epoch': 44, 'num_users': 5.8621, 'loss': 83591825674932.23, 'hit_ratio@10': 0.0947, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6851}:  97%|█████████▋| 29/30 [00:55<00:02,  2.31s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 80805436749394.64, 'hit_ratio@10': 0.0951, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6818}:  97%|█████████▋| 29/30 [00:57<00:02,  2.31s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 80805436749394.64, 'hit_ratio@10': 0.0951, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6818}: 100%|██████████| 30/30 [00:57<00:00,  2.41s/it]{'epoch': 44, 'num_users': 5.8667, 'loss': 80805436749394.64, 'hit_ratio@10': 0.0951, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6818}: 100%|██████████| 30/30 [00:57<00:00,  1.93s/it]
Epoch: 44
Avg # of users: 5.866666666666666
Avg Loss: 80805436749394.64
Avg hit ratio: 0.09510157057111017
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.6818249066670736
Std train time: 1.7022031631719248
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 573956244.8516, 'hit_ratio@10': 0.0, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5147}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 573956244.8516, 'hit_ratio@10': 0.0, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5147}:   3%|▎         | 1/30 [00:01<00:37,  1.29s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 286978124.4415, 'hit_ratio@10': 0.0, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2701}:   3%|▎         | 1/30 [00:03<00:37,  1.29s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 286978124.4415, 'hit_ratio@10': 0.0, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2701}:   7%|▋         | 2/30 [00:03<00:48,  1.74s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 77009401529541.23, 'hit_ratio@10': 0.0, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7585}:   7%|▋         | 2/30 [00:03<00:48,  1.74s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 77009401529541.23, 'hit_ratio@10': 0.0, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7585}:  10%|█         | 3/30 [00:03<00:30,  1.13s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 57757055191491.38, 'hit_ratio@10': 0.0268, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7385}:  10%|█         | 3/30 [00:05<00:30,  1.13s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 57757055191491.38, 'hit_ratio@10': 0.0268, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7385}:  13%|█▎        | 4/30 [00:05<00:35,  1.36s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 46205644153193.75, 'hit_ratio@10': 0.0214, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7623}:  13%|█▎        | 4/30 [00:08<00:35,  1.36s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 46205644153193.75, 'hit_ratio@10': 0.0214, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7623}:  17%|█▋        | 5/30 [00:08<00:52,  2.11s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 38504703460995.445, 'hit_ratio@10': 0.0179, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8317}:  17%|█▋        | 5/30 [00:12<00:52,  2.11s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 38504703460995.445, 'hit_ratio@10': 0.0179, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8317}:  20%|██        | 6/30 [00:12<01:05,  2.72s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 33004038440630.68, 'hit_ratio@10': 0.0267, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9214}:  20%|██        | 6/30 [00:14<01:05,  2.72s/it] {'epoch': 45, 'num_users': 6.2857, 'loss': 33004038440630.68, 'hit_ratio@10': 0.0267, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9214}:  23%|██▎       | 7/30 [00:14<00:55,  2.41s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 28878533635552.203, 'hit_ratio@10': 0.0234, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8563}:  23%|██▎       | 7/30 [00:16<00:55,  2.41s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 28878533635552.203, 'hit_ratio@10': 0.0234, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8563}:  27%|██▋       | 8/30 [00:16<00:53,  2.42s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 25669807676046.895, 'hit_ratio@10': 0.0208, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0928}:  27%|██▋       | 8/30 [00:19<00:53,  2.42s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 25669807676046.895, 'hit_ratio@10': 0.0208, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0928}:  30%|███       | 9/30 [00:19<00:51,  2.45s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 23102833924441.395, 'hit_ratio@10': 0.0278, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0918}:  30%|███       | 9/30 [00:22<00:51,  2.45s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 23102833924441.395, 'hit_ratio@10': 0.0278, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0918}:  33%|███▎      | 10/30 [00:22<00:53,  2.65s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 21002576940168.105, 'hit_ratio@10': 0.0253, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1405}:  33%|███▎      | 10/30 [00:24<00:53,  2.65s/it]{'epoch': 45, 'num_users': 6.6364, 'loss': 21002576940168.105, 'hit_ratio@10': 0.0253, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1405}:  37%|███▋      | 11/30 [00:24<00:45,  2.41s/it]{'epoch': 45, 'num_users': 6.4167, 'loss': 19334154424416.316, 'hit_ratio@10': 0.0301, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9429}:  37%|███▋      | 11/30 [00:25<00:45,  2.41s/it]{'epoch': 45, 'num_users': 6.4167, 'loss': 19334154424416.316, 'hit_ratio@10': 0.0301, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9429}:  40%|████      | 12/30 [00:25<00:34,  1.92s/it]{'epoch': 45, 'num_users': 6.6154, 'loss': 17846917994568.52, 'hit_ratio@10': 0.0313, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9632}:  40%|████      | 12/30 [00:26<00:34,  1.92s/it] {'epoch': 45, 'num_users': 6.6154, 'loss': 17846917994568.52, 'hit_ratio@10': 0.0313, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9632}:  43%|████▎     | 13/30 [00:26<00:31,  1.83s/it]{'epoch': 45, 'num_users': 6.3571, 'loss': 25194211297103.53, 'hit_ratio@10': 0.0291, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7793}:  43%|████▎     | 13/30 [00:27<00:31,  1.83s/it]{'epoch': 45, 'num_users': 6.3571, 'loss': 25194211297103.53, 'hit_ratio@10': 0.0291, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7793}:  47%|████▋     | 14/30 [00:27<00:22,  1.41s/it]{'epoch': 45, 'num_users': 6.2667, 'loss': 23514598293044.19, 'hit_ratio@10': 0.0336, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8866}:  47%|████▋     | 14/30 [00:29<00:22,  1.41s/it]{'epoch': 45, 'num_users': 6.2667, 'loss': 23514598293044.19, 'hit_ratio@10': 0.0336, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8866}:  50%|█████     | 15/30 [00:29<00:24,  1.65s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 22060112798400.93, 'hit_ratio@10': 0.0367, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7565}:  50%|█████     | 15/30 [00:30<00:24,  1.65s/it]{'epoch': 45, 'num_users': 6.0625, 'loss': 22060112798400.93, 'hit_ratio@10': 0.0367, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7565}:  53%|█████▎    | 16/30 [00:30<00:19,  1.41s/it]{'epoch': 45, 'num_users': 5.8235, 'loss': 34997236448594.19, 'hit_ratio@10': 0.0345, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.625}:  53%|█████▎    | 16/30 [00:30<00:19,  1.41s/it] {'epoch': 45, 'num_users': 5.8235, 'loss': 34997236448594.19, 'hit_ratio@10': 0.0345, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.625}:  57%|█████▋    | 17/30 [00:30<00:13,  1.07s/it]{'epoch': 45, 'num_users': 6.0556, 'loss': 33052980553749.234, 'hit_ratio@10': 0.0366, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5848}:  57%|█████▋    | 17/30 [00:32<00:13,  1.07s/it]{'epoch': 45, 'num_users': 6.0556, 'loss': 33052980553749.234, 'hit_ratio@10': 0.0366, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5848}:  60%|██████    | 18/30 [00:32<00:15,  1.33s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 31315432582896.508, 'hit_ratio@10': 0.0422, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5434}:  60%|██████    | 18/30 [00:33<00:15,  1.33s/it]   {'epoch': 45, 'num_users': 6.0, 'loss': 31315432582896.508, 'hit_ratio@10': 0.0422, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5434}:  63%|██████▎   | 19/30 [00:33<00:13,  1.21s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 29749660953751.855, 'hit_ratio@10': 0.0401, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6205}:  63%|██████▎   | 19/30 [00:37<00:13,  1.21s/it]{'epoch': 45, 'num_users': 6.15, 'loss': 29749660953751.855, 'hit_ratio@10': 0.0401, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6205}:  67%|██████▋   | 20/30 [00:37<00:20,  2.08s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 28333010432144.82, 'hit_ratio@10': 0.0382, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7839}:  67%|██████▋   | 20/30 [00:40<00:20,  2.08s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 28333010432144.82, 'hit_ratio@10': 0.0382, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7839}:  70%|███████   | 21/30 [00:40<00:21,  2.37s/it]{'epoch': 45, 'num_users': 6.1818, 'loss': 27045147846724.09, 'hit_ratio@10': 0.0426, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7253}:  70%|███████   | 21/30 [00:42<00:21,  2.37s/it]{'epoch': 45, 'num_users': 6.1818, 'loss': 27045147846724.09, 'hit_ratio@10': 0.0426, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7253}:  73%|███████▎  | 22/30 [00:42<00:16,  2.12s/it]{'epoch': 45, 'num_users': 6.1304, 'loss': 25869282613214.26, 'hit_ratio@10': 0.0473, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7192}:  73%|███████▎  | 22/30 [00:43<00:16,  2.12s/it]{'epoch': 45, 'num_users': 6.1304, 'loss': 25869282613214.26, 'hit_ratio@10': 0.0473, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7192}:  77%|███████▋  | 23/30 [00:43<00:13,  1.88s/it]{'epoch': 45, 'num_users': 5.9583, 'loss': 24856851347022.03, 'hit_ratio@10': 0.0453, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6166}:  77%|███████▋  | 23/30 [00:43<00:13,  1.88s/it]{'epoch': 45, 'num_users': 5.9583, 'loss': 24856851347022.03, 'hit_ratio@10': 0.0453, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6166}:  80%|████████  | 24/30 [00:43<00:08,  1.40s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 50283274415001.42, 'hit_ratio@10': 0.0435, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5224}:  80%|████████  | 24/30 [00:44<00:08,  1.40s/it]   {'epoch': 45, 'num_users': 5.8, 'loss': 50283274415001.42, 'hit_ratio@10': 0.0435, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5224}:  83%|████████▎ | 25/30 [00:44<00:05,  1.03s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 48349302322116.91, 'hit_ratio@10': 0.0418, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6336}:  83%|████████▎ | 25/30 [00:49<00:05,  1.03s/it]{'epoch': 45, 'num_users': 5.8077, 'loss': 48349302322116.91, 'hit_ratio@10': 0.0418, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6336}:  87%|████████▋ | 26/30 [00:49<00:09,  2.37s/it]{'epoch': 45, 'num_users': 5.8889, 'loss': 46558588286724.055, 'hit_ratio@10': 0.0469, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6833}:  87%|████████▋ | 26/30 [00:51<00:09,  2.37s/it]{'epoch': 45, 'num_users': 5.8889, 'loss': 46558588286724.055, 'hit_ratio@10': 0.0469, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6833}:  90%|█████████ | 27/30 [00:51<00:06,  2.26s/it]{'epoch': 45, 'num_users': 6.0, 'loss': 44895781562198.32, 'hit_ratio@10': 0.0452, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7242}:  90%|█████████ | 27/30 [00:55<00:06,  2.26s/it]    {'epoch': 45, 'num_users': 6.0, 'loss': 44895781562198.32, 'hit_ratio@10': 0.0452, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7242}:  93%|█████████▎| 28/30 [00:55<00:05,  2.74s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 43347652636112.24, 'hit_ratio@10': 0.0499, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7389}:  93%|█████████▎| 28/30 [00:56<00:05,  2.74s/it]{'epoch': 45, 'num_users': 5.8621, 'loss': 43347652636112.24, 'hit_ratio@10': 0.0499, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7389}:  97%|█████████▋| 29/30 [00:56<00:02,  2.40s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 41902731425694.086, 'hit_ratio@10': 0.0519, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7326}:  97%|█████████▋| 29/30 [00:59<00:02,  2.40s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 41902731425694.086, 'hit_ratio@10': 0.0519, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7326}: 100%|██████████| 30/30 [00:59<00:00,  2.47s/it]{'epoch': 45, 'num_users': 5.8667, 'loss': 41902731425694.086, 'hit_ratio@10': 0.0519, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7326}: 100%|██████████| 30/30 [00:59<00:00,  1.99s/it]
Epoch: 45
Avg # of users: 5.866666666666666
Avg Loss: 41902731425694.086
Avg hit ratio: 0.051869814095620546
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7326085567474365
Std train time: 1.7200513146863552
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 35320928.9696, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6367}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 35320928.9696, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6367}:   3%|▎         | 1/30 [00:01<00:39,  1.35s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 70697283.5292, 'hit_ratio@10': 0.0424, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3991}:   3%|▎         | 1/30 [00:03<00:39,  1.35s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 70697283.5292, 'hit_ratio@10': 0.0424, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3991}:   7%|▋         | 2/30 [00:03<00:51,  1.85s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 39708153206.1623, 'hit_ratio@10': 0.0283, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9035}:   7%|▋         | 2/30 [00:04<00:51,  1.85s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 39708153206.1623, 'hit_ratio@10': 0.0283, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9035}:  10%|█         | 3/30 [00:04<00:33,  1.23s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 29798491437.4551, 'hit_ratio@10': 0.0302, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9108}:  10%|█         | 3/30 [00:05<00:33,  1.23s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 29798491437.4551, 'hit_ratio@10': 0.0302, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9108}:  13%|█▎        | 4/30 [00:05<00:39,  1.52s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 23847114506.4565, 'hit_ratio@10': 0.0361, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8309}:  13%|█▎        | 4/30 [00:09<00:39,  1.52s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 23847114506.4565, 'hit_ratio@10': 0.0361, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8309}:  17%|█▋        | 5/30 [00:09<00:53,  2.15s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 19884277455.7722, 'hit_ratio@10': 0.0449, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8778}:  17%|█▋        | 5/30 [00:12<00:53,  2.15s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 19884277455.7722, 'hit_ratio@10': 0.0449, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8778}:  20%|██        | 6/30 [00:12<00:59,  2.49s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 17058238194.0648, 'hit_ratio@10': 0.0442, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9729}:  20%|██        | 6/30 [00:14<00:59,  2.49s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 17058238194.0648, 'hit_ratio@10': 0.0442, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9729}:  23%|██▎       | 7/30 [00:14<00:52,  2.27s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 14938661320.9006, 'hit_ratio@10': 0.0565, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8967}:  23%|██▎       | 7/30 [00:16<00:52,  2.27s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 14938661320.9006, 'hit_ratio@10': 0.0565, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8967}:  27%|██▋       | 8/30 [00:16<00:50,  2.31s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 13312897360.4262, 'hit_ratio@10': 0.0661, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.141}:  27%|██▋       | 8/30 [00:19<00:50,  2.31s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 13312897360.4262, 'hit_ratio@10': 0.0661, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.141}:  30%|███       | 9/30 [00:19<00:50,  2.39s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 12002503214.5595, 'hit_ratio@10': 0.0663, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1273}:  30%|███       | 9/30 [00:22<00:50,  2.39s/it]  {'epoch': 46, 'num_users': 6.3, 'loss': 12002503214.5595, 'hit_ratio@10': 0.0663, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1273}:  33%|███▎      | 10/30 [00:22<00:51,  2.59s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 10921221684.1899, 'hit_ratio@10': 0.0708, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1804}:  33%|███▎      | 10/30 [00:24<00:51,  2.59s/it]{'epoch': 46, 'num_users': 6.6364, 'loss': 10921221684.1899, 'hit_ratio@10': 0.0708, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1804}:  37%|███▋      | 11/30 [00:24<00:45,  2.38s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 10019508013.0137, 'hit_ratio@10': 0.0788, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9784}:  37%|███▋      | 11/30 [00:24<00:45,  2.38s/it]{'epoch': 46, 'num_users': 6.4167, 'loss': 10019508013.0137, 'hit_ratio@10': 0.0788, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9784}:  40%|████      | 12/30 [00:24<00:34,  1.89s/it]{'epoch': 46, 'num_users': 6.6154, 'loss': 9394257444.5441, 'hit_ratio@10': 0.0797, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9917}:  40%|████      | 12/30 [00:26<00:34,  1.89s/it] {'epoch': 46, 'num_users': 6.6154, 'loss': 9394257444.5441, 'hit_ratio@10': 0.0797, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9917}:  43%|████▎     | 13/30 [00:26<00:30,  1.81s/it]{'epoch': 46, 'num_users': 6.3571, 'loss': 37051099937.9338, 'hit_ratio@10': 0.074, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8015}:  43%|████▎     | 13/30 [00:26<00:30,  1.81s/it]{'epoch': 46, 'num_users': 6.3571, 'loss': 37051099937.9338, 'hit_ratio@10': 0.074, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8015}:  47%|████▋     | 14/30 [00:26<00:21,  1.37s/it]{'epoch': 46, 'num_users': 6.2667, 'loss': 34589974366.9277, 'hit_ratio@10': 0.0734, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8921}:  47%|████▋     | 14/30 [00:28<00:21,  1.37s/it]{'epoch': 46, 'num_users': 6.2667, 'loss': 34589974366.9277, 'hit_ratio@10': 0.0734, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8921}:  50%|█████     | 15/30 [00:28<00:23,  1.60s/it]{'epoch': 46, 'num_users': 6.0625, 'loss': 32516530772.7053, 'hit_ratio@10': 0.0688, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7599}:  50%|█████     | 15/30 [00:29<00:23,  1.60s/it]{'epoch': 46, 'num_users': 6.0625, 'loss': 32516530772.7053, 'hit_ratio@10': 0.0688, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7599}:  53%|█████▎    | 16/30 [00:29<00:19,  1.36s/it]{'epoch': 46, 'num_users': 5.8235, 'loss': 5031653449422.217, 'hit_ratio@10': 0.0765, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6328}:  53%|█████▎    | 16/30 [00:30<00:19,  1.36s/it]{'epoch': 46, 'num_users': 5.8235, 'loss': 5031653449422.217, 'hit_ratio@10': 0.0765, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6328}:  57%|█████▋    | 17/30 [00:30<00:13,  1.05s/it]{'epoch': 46, 'num_users': 6.0556, 'loss': 4752117146676.76, 'hit_ratio@10': 0.0723, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5999}:  57%|█████▋    | 17/30 [00:32<00:13,  1.05s/it] {'epoch': 46, 'num_users': 6.0556, 'loss': 4752117146676.76, 'hit_ratio@10': 0.0723, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5999}:  60%|██████    | 18/30 [00:32<00:16,  1.36s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 4502249932557.11, 'hit_ratio@10': 0.0797, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5545}:  60%|██████    | 18/30 [00:33<00:16,  1.36s/it]   {'epoch': 46, 'num_users': 6.0, 'loss': 4502249932557.11, 'hit_ratio@10': 0.0797, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5545}:  63%|██████▎   | 19/30 [00:33<00:13,  1.22s/it]{'epoch': 46, 'num_users': 6.15, 'loss': 4277137435929.428, 'hit_ratio@10': 0.0758, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6359}:  63%|██████▎   | 19/30 [00:37<00:13,  1.22s/it]{'epoch': 46, 'num_users': 6.15, 'loss': 4277137435929.428, 'hit_ratio@10': 0.0758, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6359}:  67%|██████▋   | 20/30 [00:37<00:21,  2.12s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 4073464224694.8896, 'hit_ratio@10': 0.0722, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7824}:  67%|██████▋   | 20/30 [00:40<00:21,  2.12s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 4073464224694.8896, 'hit_ratio@10': 0.0722, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7824}:  70%|███████   | 21/30 [00:40<00:21,  2.35s/it]{'epoch': 46, 'num_users': 6.1818, 'loss': 3888331995122.5107, 'hit_ratio@10': 0.0751, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7201}:  70%|███████   | 21/30 [00:41<00:21,  2.35s/it]{'epoch': 46, 'num_users': 6.1818, 'loss': 3888331995122.5107, 'hit_ratio@10': 0.0751, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7201}:  73%|███████▎  | 22/30 [00:41<00:16,  2.08s/it]{'epoch': 46, 'num_users': 6.1304, 'loss': 3719277437647.919, 'hit_ratio@10': 0.0718, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7163}:  73%|███████▎  | 22/30 [00:43<00:16,  2.08s/it] {'epoch': 46, 'num_users': 6.1304, 'loss': 3719277437647.919, 'hit_ratio@10': 0.0718, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7163}:  77%|███████▋  | 23/30 [00:43<00:13,  1.86s/it]{'epoch': 46, 'num_users': 5.9583, 'loss': 21485408064246.188, 'hit_ratio@10': 0.0855, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6141}:  77%|███████▋  | 23/30 [00:43<00:13,  1.86s/it]{'epoch': 46, 'num_users': 5.9583, 'loss': 21485408064246.188, 'hit_ratio@10': 0.0855, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6141}:  80%|████████  | 24/30 [00:43<00:08,  1.39s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 36030944970742.58, 'hit_ratio@10': 0.0821, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.522}:  80%|████████  | 24/30 [00:43<00:08,  1.39s/it]     {'epoch': 46, 'num_users': 5.8, 'loss': 36030944970742.58, 'hit_ratio@10': 0.0821, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.522}:  83%|████████▎ | 25/30 [00:43<00:05,  1.03s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 34645166465162.152, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6367}:  83%|████████▎ | 25/30 [00:49<00:05,  1.03s/it]{'epoch': 46, 'num_users': 5.8077, 'loss': 34645166465162.152, 'hit_ratio@10': 0.0827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6367}:  87%|████████▋ | 26/30 [00:49<00:09,  2.38s/it]{'epoch': 46, 'num_users': 5.8889, 'loss': 33362016234976.31, 'hit_ratio@10': 0.0822, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6731}:  87%|████████▋ | 26/30 [00:50<00:09,  2.38s/it] {'epoch': 46, 'num_users': 5.8889, 'loss': 33362016234976.31, 'hit_ratio@10': 0.0822, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6731}:  90%|█████████ | 27/30 [00:50<00:06,  2.22s/it]{'epoch': 46, 'num_users': 6.0, 'loss': 32170524819134.254, 'hit_ratio@10': 0.0814, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7031}:  90%|█████████ | 27/30 [00:54<00:06,  2.22s/it]  {'epoch': 46, 'num_users': 6.0, 'loss': 32170524819134.254, 'hit_ratio@10': 0.0814, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7031}:  93%|█████████▎| 28/30 [00:54<00:05,  2.62s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 31061198585968.22, 'hit_ratio@10': 0.0849, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7099}:  93%|█████████▎| 28/30 [00:55<00:05,  2.62s/it]{'epoch': 46, 'num_users': 5.8621, 'loss': 31061198585968.22, 'hit_ratio@10': 0.0849, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7099}:  97%|█████████▋| 29/30 [00:55<00:02,  2.28s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 30025829290035.547, 'hit_ratio@10': 0.0856, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7078}:  97%|█████████▋| 29/30 [00:58<00:02,  2.28s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 30025829290035.547, 'hit_ratio@10': 0.0856, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7078}: 100%|██████████| 30/30 [00:58<00:00,  2.40s/it]{'epoch': 46, 'num_users': 5.8667, 'loss': 30025829290035.547, 'hit_ratio@10': 0.0856, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7078}: 100%|██████████| 30/30 [00:58<00:00,  1.95s/it]
Epoch: 46
Avg # of users: 5.866666666666666
Avg Loss: 30025829290035.547
Avg hit ratio: 0.08564180469937131
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7077902873357136
Std train time: 1.6496813443656797
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 1412799968.4107, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5905}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 1412799968.4107, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5905}:   3%|▎         | 1/30 [00:01<00:38,  1.32s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 13149664510.1408, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4203}:   3%|▎         | 1/30 [00:03<00:38,  1.32s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 13149664510.1408, 'hit_ratio@10': 0.0526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4203}:   7%|▋         | 2/30 [00:03<00:52,  1.89s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 8830353615.6783, 'hit_ratio@10': 0.0351, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8698}:   7%|▋         | 2/30 [00:04<00:52,  1.89s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 8830353615.6783, 'hit_ratio@10': 0.0351, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8698}:  10%|█         | 3/30 [00:04<00:32,  1.21s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 6670700194.0159, 'hit_ratio@10': 0.0531, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8881}:  10%|█         | 3/30 [00:05<00:32,  1.21s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 6670700194.0159, 'hit_ratio@10': 0.0531, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8881}:  13%|█▎        | 4/30 [00:05<00:39,  1.52s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 5381657654.0279, 'hit_ratio@10': 0.0505, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9556}:  13%|█▎        | 4/30 [00:09<00:39,  1.52s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 5381657654.0279, 'hit_ratio@10': 0.0505, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9556}:  17%|█▋        | 5/30 [00:09<00:57,  2.29s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 4520506082.8335, 'hit_ratio@10': 0.0606, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9743}:  17%|█▋        | 5/30 [00:12<00:57,  2.29s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 4520506082.8335, 'hit_ratio@10': 0.0606, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9743}:  20%|██        | 6/30 [00:12<01:01,  2.56s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 3900796386.2977, 'hit_ratio@10': 0.0519, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9982}:  20%|██        | 6/30 [00:14<01:01,  2.56s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 3900796386.2977, 'hit_ratio@10': 0.0519, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9982}:  23%|██▎       | 7/30 [00:14<00:51,  2.25s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 3616905216286.696, 'hit_ratio@10': 0.0669, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9174}:  23%|██▎       | 7/30 [00:16<00:51,  2.25s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 3616905216286.696, 'hit_ratio@10': 0.0669, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9174}:  27%|██▋       | 8/30 [00:16<00:50,  2.29s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 3215878181931.133, 'hit_ratio@10': 0.069, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1349}:  27%|██▋       | 8/30 [00:19<00:50,  2.29s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 3215878181931.133, 'hit_ratio@10': 0.069, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1349}:  30%|███       | 9/30 [00:19<00:49,  2.35s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 4715768873803.692, 'hit_ratio@10': 0.0757, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1347}:  30%|███       | 9/30 [00:22<00:49,  2.35s/it]  {'epoch': 47, 'num_users': 6.3, 'loss': 4715768873803.692, 'hit_ratio@10': 0.0757, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1347}:  33%|███▎      | 10/30 [00:22<00:52,  2.61s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 4397184022436.14, 'hit_ratio@10': 0.0758, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2088}:  33%|███▎      | 10/30 [00:24<00:52,  2.61s/it]{'epoch': 47, 'num_users': 6.6364, 'loss': 4397184022436.14, 'hit_ratio@10': 0.0758, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.2088}:  37%|███▋      | 11/30 [00:24<00:46,  2.42s/it]{'epoch': 47, 'num_users': 6.4167, 'loss': 4030847090038.0054, 'hit_ratio@10': 0.0764, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0153}:  37%|███▋      | 11/30 [00:25<00:46,  2.42s/it]{'epoch': 47, 'num_users': 6.4167, 'loss': 4030847090038.0054, 'hit_ratio@10': 0.0764, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0153}:  40%|████      | 12/30 [00:25<00:35,  1.96s/it]{'epoch': 47, 'num_users': 6.6154, 'loss': 3720801639766.5503, 'hit_ratio@10': 0.081, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0325}:  40%|████      | 12/30 [00:26<00:35,  1.96s/it] {'epoch': 47, 'num_users': 6.6154, 'loss': 3720801639766.5503, 'hit_ratio@10': 0.081, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0325}:  43%|████▎     | 13/30 [00:26<00:31,  1.87s/it]{'epoch': 47, 'num_users': 6.3571, 'loss': 3455256987473.9453, 'hit_ratio@10': 0.0753, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8408}:  43%|████▎     | 13/30 [00:27<00:31,  1.87s/it]{'epoch': 47, 'num_users': 6.3571, 'loss': 3455256987473.9453, 'hit_ratio@10': 0.0753, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8408}:  47%|████▋     | 14/30 [00:27<00:22,  1.42s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 3226277562572.2275, 'hit_ratio@10': 0.0767, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9436}:  47%|████▋     | 14/30 [00:29<00:22,  1.42s/it]{'epoch': 47, 'num_users': 6.2667, 'loss': 3226277562572.2275, 'hit_ratio@10': 0.0767, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9436}:  50%|█████     | 15/30 [00:29<00:24,  1.66s/it]{'epoch': 47, 'num_users': 6.0625, 'loss': 3044068785087.4634, 'hit_ratio@10': 0.0771, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8066}:  50%|█████     | 15/30 [00:30<00:24,  1.66s/it]{'epoch': 47, 'num_users': 6.0625, 'loss': 3044068785087.4634, 'hit_ratio@10': 0.0771, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8066}:  53%|█████▎    | 16/30 [00:30<00:19,  1.40s/it]{'epoch': 47, 'num_users': 5.8235, 'loss': 13337658172584.152, 'hit_ratio@10': 0.0843, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6747}:  53%|█████▎    | 16/30 [00:30<00:19,  1.40s/it]{'epoch': 47, 'num_users': 5.8235, 'loss': 13337658172584.152, 'hit_ratio@10': 0.0843, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6747}:  57%|█████▋    | 17/30 [00:30<00:13,  1.08s/it]{'epoch': 47, 'num_users': 6.0556, 'loss': 12596681956606.418, 'hit_ratio@10': 0.0836, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.64}:  57%|█████▋    | 17/30 [00:32<00:13,  1.08s/it]  {'epoch': 47, 'num_users': 6.0556, 'loss': 12596681956606.418, 'hit_ratio@10': 0.0836, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.64}:  60%|██████    | 18/30 [00:32<00:16,  1.38s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 11934240613384.125, 'hit_ratio@10': 0.0867, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5966}:  60%|██████    | 18/30 [00:33<00:16,  1.38s/it] {'epoch': 47, 'num_users': 6.0, 'loss': 11934240613384.125, 'hit_ratio@10': 0.0867, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5966}:  63%|██████▎   | 19/30 [00:33<00:13,  1.25s/it]{'epoch': 47, 'num_users': 6.15, 'loss': 11337538001481.201, 'hit_ratio@10': 0.0894, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6745}:  63%|██████▎   | 19/30 [00:37<00:13,  1.25s/it]{'epoch': 47, 'num_users': 6.15, 'loss': 11337538001481.201, 'hit_ratio@10': 0.0894, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6745}:  67%|██████▋   | 20/30 [00:37<00:21,  2.13s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 10894950963231.926, 'hit_ratio@10': 0.0911, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8284}:  67%|██████▋   | 20/30 [00:40<00:21,  2.13s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 10894950963231.926, 'hit_ratio@10': 0.0911, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8284}:  70%|███████   | 21/30 [00:40<00:21,  2.38s/it]{'epoch': 47, 'num_users': 6.1818, 'loss': 10399729247374.172, 'hit_ratio@10': 0.087, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7673}:  70%|███████   | 21/30 [00:42<00:21,  2.38s/it] {'epoch': 47, 'num_users': 6.1818, 'loss': 10399729247374.172, 'hit_ratio@10': 0.087, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7673}:  73%|███████▎  | 22/30 [00:42<00:16,  2.12s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 9947760262472.137, 'hit_ratio@10': 0.0897, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7685}:  73%|███████▎  | 22/30 [00:43<00:16,  2.12s/it]{'epoch': 47, 'num_users': 6.1304, 'loss': 9947760262472.137, 'hit_ratio@10': 0.0897, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7685}:  77%|███████▋  | 23/30 [00:43<00:13,  1.91s/it]{'epoch': 47, 'num_users': 5.9583, 'loss': 9589572208928.865, 'hit_ratio@10': 0.1026, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6645}:  77%|███████▋  | 23/30 [00:44<00:13,  1.91s/it]{'epoch': 47, 'num_users': 5.9583, 'loss': 9589572208928.865, 'hit_ratio@10': 0.1026, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6645}:  80%|████████  | 24/30 [00:44<00:08,  1.43s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 12010553290319.338, 'hit_ratio@10': 0.0985, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5687}:  80%|████████  | 24/30 [00:44<00:08,  1.43s/it]  {'epoch': 47, 'num_users': 5.8, 'loss': 12010553290319.338, 'hit_ratio@10': 0.0985, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5687}:  83%|████████▎ | 25/30 [00:44<00:05,  1.05s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 1122271819741382.8, 'hit_ratio@10': 0.1032, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6838}:  83%|████████▎ | 25/30 [00:49<00:05,  1.05s/it]{'epoch': 47, 'num_users': 5.8077, 'loss': 1122271819741382.8, 'hit_ratio@10': 0.1032, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6838}:  87%|████████▋ | 26/30 [00:49<00:09,  2.41s/it]{'epoch': 47, 'num_users': 5.8889, 'loss': 1080706901608631.5, 'hit_ratio@10': 0.1033, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7258}:  87%|████████▋ | 26/30 [00:51<00:09,  2.41s/it]{'epoch': 47, 'num_users': 5.8889, 'loss': 1080706901608631.5, 'hit_ratio@10': 0.1033, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7258}:  90%|█████████ | 27/30 [00:51<00:06,  2.27s/it]{'epoch': 47, 'num_users': 6.0, 'loss': 1042110232002552.4, 'hit_ratio@10': 0.1024, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7526}:  90%|█████████ | 27/30 [00:55<00:06,  2.27s/it]   {'epoch': 47, 'num_users': 6.0, 'loss': 1042110232002552.4, 'hit_ratio@10': 0.1024, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7526}:  93%|█████████▎| 28/30 [00:55<00:05,  2.64s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 1006175520115587.5, 'hit_ratio@10': 0.1005, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7484}:  93%|█████████▎| 28/30 [00:56<00:05,  2.64s/it]{'epoch': 47, 'num_users': 5.8621, 'loss': 1006175520115587.5, 'hit_ratio@10': 0.1005, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7484}:  97%|█████████▋| 29/30 [00:56<00:02,  2.25s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 972636336111734.6, 'hit_ratio@10': 0.0971, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7386}:  97%|█████████▋| 29/30 [00:59<00:02,  2.25s/it] {'epoch': 47, 'num_users': 5.8667, 'loss': 972636336111734.6, 'hit_ratio@10': 0.0971, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7386}: 100%|██████████| 30/30 [00:59<00:00,  2.32s/it]{'epoch': 47, 'num_users': 5.8667, 'loss': 972636336111734.6, 'hit_ratio@10': 0.0971, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7386}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 47
Avg # of users: 5.866666666666666
Avg Loss: 972636336111734.6
Avg hit ratio: 0.0971309584968012
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.738559905687968
Std train time: 1.7241761092327472
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 1.8399648033896772e+16, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5395}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 1.8399648033896772e+16, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5395}:   3%|▎         | 1/30 [00:01<00:37,  1.30s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 1.9212691665163096e+16, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.284}:   3%|▎         | 1/30 [00:03<00:37,  1.30s/it] {'epoch': 48, 'num_users': 7.0, 'loss': 1.9212691665163096e+16, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.284}:   7%|▋         | 2/30 [00:03<00:48,  1.75s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 1.2808935039375638e+16, 'hit_ratio@10': 0.0476, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8001}:   7%|▋         | 2/30 [00:03<00:48,  1.75s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 1.2808935039375638e+16, 'hit_ratio@10': 0.0476, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8001}:  10%|█         | 3/30 [00:03<00:31,  1.15s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 1.2461551881212624e+16, 'hit_ratio@10': 0.0982, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8004}:  10%|█         | 3/30 [00:05<00:31,  1.15s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 1.2461551881212624e+16, 'hit_ratio@10': 0.0982, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8004}:  13%|█▎        | 4/30 [00:05<00:36,  1.42s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 1.5827459326279338e+16, 'hit_ratio@10': 0.1426, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8858}:  13%|█▎        | 4/30 [00:09<00:36,  1.42s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 1.5827459326279338e+16, 'hit_ratio@10': 0.1426, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8858}:  17%|█▋        | 5/30 [00:09<00:55,  2.22s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 1.6888910458620968e+16, 'hit_ratio@10': 0.1596, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9433}:  17%|█▋        | 5/30 [00:12<00:55,  2.22s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 1.6888910458620968e+16, 'hit_ratio@10': 0.1596, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9433}:  20%|██        | 6/30 [00:12<01:01,  2.58s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 1.4476215627871118e+16, 'hit_ratio@10': 0.1425, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0382}:  20%|██        | 6/30 [00:14<01:01,  2.58s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 1.4476215627871118e+16, 'hit_ratio@10': 0.1425, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0382}:  23%|██▎       | 7/30 [00:14<00:53,  2.34s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 1.5550525567430326e+16, 'hit_ratio@10': 0.1247, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9456}:  23%|██▎       | 7/30 [00:16<00:53,  2.34s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 1.5550525567430326e+16, 'hit_ratio@10': 0.1247, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9456}:  27%|██▋       | 8/30 [00:16<00:51,  2.34s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 1.5808139877928992e+16, 'hit_ratio@10': 0.1108, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1116}:  27%|██▋       | 8/30 [00:18<00:51,  2.34s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 1.5808139877928992e+16, 'hit_ratio@10': 0.1108, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1116}:  30%|███       | 9/30 [00:18<00:48,  2.31s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 1.6880136140920934e+16, 'hit_ratio@10': 0.0997, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0967}:  30%|███       | 9/30 [00:21<00:48,  2.31s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 1.6880136140920934e+16, 'hit_ratio@10': 0.0997, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.0967}:  33%|███▎      | 10/30 [00:21<00:50,  2.52s/it]{'epoch': 48, 'num_users': 6.6364, 'loss': 1.7698616689935776e+16, 'hit_ratio@10': 0.0907, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1685}:  33%|███▎      | 10/30 [00:23<00:50,  2.52s/it]{'epoch': 48, 'num_users': 6.6364, 'loss': 1.7698616689935776e+16, 'hit_ratio@10': 0.0907, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 3.1685}:  37%|███▋      | 11/30 [00:23<00:44,  2.36s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 1.6997284372943258e+16, 'hit_ratio@10': 0.0831, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9754}:  37%|███▋      | 11/30 [00:24<00:44,  2.36s/it]{'epoch': 48, 'num_users': 6.4167, 'loss': 1.6997284372943258e+16, 'hit_ratio@10': 0.0831, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9754}:  40%|████      | 12/30 [00:24<00:34,  1.91s/it]{'epoch': 48, 'num_users': 6.6154, 'loss': 1.568980111732251e+16, 'hit_ratio@10': 0.0907, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9871}:  40%|████      | 12/30 [00:26<00:34,  1.91s/it] {'epoch': 48, 'num_users': 6.6154, 'loss': 1.568980111732251e+16, 'hit_ratio@10': 0.0907, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.9871}:  43%|████▎     | 13/30 [00:26<00:30,  1.81s/it]{'epoch': 48, 'num_users': 6.3571, 'loss': 1.5659790086635892e+16, 'hit_ratio@10': 0.0842, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8001}:  43%|████▎     | 13/30 [00:26<00:30,  1.81s/it]{'epoch': 48, 'num_users': 6.3571, 'loss': 1.5659790086635892e+16, 'hit_ratio@10': 0.0842, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8001}:  47%|████▋     | 14/30 [00:26<00:22,  1.39s/it]{'epoch': 48, 'num_users': 6.2667, 'loss': 1.5997478157208846e+16, 'hit_ratio@10': 0.0786, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8922}:  47%|████▋     | 14/30 [00:28<00:22,  1.39s/it]{'epoch': 48, 'num_users': 6.2667, 'loss': 1.5997478157208846e+16, 'hit_ratio@10': 0.0786, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8922}:  50%|█████     | 15/30 [00:28<00:24,  1.61s/it]{'epoch': 48, 'num_users': 6.0625, 'loss': 1.4997637360626618e+16, 'hit_ratio@10': 0.0841, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.762}:  50%|█████     | 15/30 [00:29<00:24,  1.61s/it] {'epoch': 48, 'num_users': 6.0625, 'loss': 1.4997637360626618e+16, 'hit_ratio@10': 0.0841, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.762}:  53%|█████▎    | 16/30 [00:29<00:19,  1.38s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 1.4115930886531946e+16, 'hit_ratio@10': 0.0909, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6294}:  53%|█████▎    | 16/30 [00:30<00:19,  1.38s/it]{'epoch': 48, 'num_users': 5.8235, 'loss': 1.4115930886531946e+16, 'hit_ratio@10': 0.0909, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6294}:  57%|█████▋    | 17/30 [00:30<00:13,  1.05s/it]{'epoch': 48, 'num_users': 6.0556, 'loss': 1.333171315586164e+16, 'hit_ratio@10': 0.0918, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5988}:  57%|█████▋    | 17/30 [00:32<00:13,  1.05s/it] {'epoch': 48, 'num_users': 6.0556, 'loss': 1.333171315586164e+16, 'hit_ratio@10': 0.0918, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5988}:  60%|██████    | 18/30 [00:32<00:16,  1.37s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 1.2630047332244732e+16, 'hit_ratio@10': 0.0908, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5623}:  60%|██████    | 18/30 [00:33<00:16,  1.37s/it]  {'epoch': 48, 'num_users': 6.0, 'loss': 1.2630047332244732e+16, 'hit_ratio@10': 0.0908, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5623}:  63%|██████▎   | 19/30 [00:33<00:13,  1.26s/it]{'epoch': 48, 'num_users': 6.15, 'loss': 1.1998545360279628e+16, 'hit_ratio@10': 0.0932, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6404}:  63%|██████▎   | 19/30 [00:37<00:13,  1.26s/it]{'epoch': 48, 'num_users': 6.15, 'loss': 1.1998545360279628e+16, 'hit_ratio@10': 0.0932, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6404}:  67%|██████▋   | 20/30 [00:37<00:21,  2.13s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 1.295116286826749e+16, 'hit_ratio@10': 0.0888, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8089}:  67%|██████▋   | 20/30 [00:40<00:21,  2.13s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 1.295116286826749e+16, 'hit_ratio@10': 0.0888, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.8089}:  70%|███████   | 21/30 [00:40<00:21,  2.43s/it]{'epoch': 48, 'num_users': 6.1818, 'loss': 1.236247366473043e+16, 'hit_ratio@10': 0.0889, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7531}:  70%|███████   | 21/30 [00:42<00:21,  2.43s/it]{'epoch': 48, 'num_users': 6.1818, 'loss': 1.236247366473043e+16, 'hit_ratio@10': 0.0889, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7531}:  73%|███████▎  | 22/30 [00:42<00:17,  2.18s/it]{'epoch': 48, 'num_users': 6.1304, 'loss': 1.2765466337788688e+16, 'hit_ratio@10': 0.085, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7495}:  73%|███████▎  | 22/30 [00:43<00:17,  2.18s/it]{'epoch': 48, 'num_users': 6.1304, 'loss': 1.2765466337788688e+16, 'hit_ratio@10': 0.085, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7495}:  77%|███████▋  | 23/30 [00:43<00:13,  1.94s/it]{'epoch': 48, 'num_users': 5.9583, 'loss': 1.2233756930602666e+16, 'hit_ratio@10': 0.0898, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6457}:  77%|███████▋  | 23/30 [00:43<00:13,  1.94s/it]{'epoch': 48, 'num_users': 5.9583, 'loss': 1.2233756930602666e+16, 'hit_ratio@10': 0.0898, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6457}:  80%|████████  | 24/30 [00:43<00:08,  1.44s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 1.1745036839809078e+16, 'hit_ratio@10': 0.0862, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5503}:  80%|████████  | 24/30 [00:43<00:08,  1.44s/it]   {'epoch': 48, 'num_users': 5.8, 'loss': 1.1745036839809078e+16, 'hit_ratio@10': 0.0862, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5503}:  83%|████████▎ | 25/30 [00:43<00:05,  1.06s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 1.1299351361975158e+16, 'hit_ratio@10': 0.0914, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6711}:  83%|████████▎ | 25/30 [00:49<00:05,  1.06s/it]{'epoch': 48, 'num_users': 5.8077, 'loss': 1.1299351361975158e+16, 'hit_ratio@10': 0.0914, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.6711}:  87%|████████▋ | 26/30 [00:49<00:09,  2.46s/it]{'epoch': 48, 'num_users': 5.8889, 'loss': 1.1602497425552798e+16, 'hit_ratio@10': 0.088, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7239}:  87%|████████▋ | 26/30 [00:51<00:09,  2.46s/it] {'epoch': 48, 'num_users': 5.8889, 'loss': 1.1602497425552798e+16, 'hit_ratio@10': 0.088, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7239}:  90%|█████████ | 27/30 [00:51<00:07,  2.35s/it]{'epoch': 48, 'num_users': 6.0, 'loss': 1.1188124220595422e+16, 'hit_ratio@10': 0.0904, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7563}:  90%|█████████ | 27/30 [00:55<00:07,  2.35s/it]  {'epoch': 48, 'num_users': 6.0, 'loss': 1.1188124220595422e+16, 'hit_ratio@10': 0.0904, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7563}:  93%|█████████▎| 28/30 [00:55<00:05,  2.74s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 1.1587036585031514e+16, 'hit_ratio@10': 0.0873, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7514}:  93%|█████████▎| 28/30 [00:56<00:05,  2.74s/it]{'epoch': 48, 'num_users': 5.8621, 'loss': 1.1587036585031514e+16, 'hit_ratio@10': 0.0873, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7514}:  97%|█████████▋| 29/30 [00:56<00:02,  2.32s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 1.1878370965285414e+16, 'hit_ratio@10': 0.0889, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7361}:  97%|█████████▋| 29/30 [00:59<00:02,  2.32s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 1.1878370965285414e+16, 'hit_ratio@10': 0.0889, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7361}: 100%|██████████| 30/30 [00:59<00:00,  2.32s/it]{'epoch': 48, 'num_users': 5.8667, 'loss': 1.1878370965285414e+16, 'hit_ratio@10': 0.0889, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.7361}: 100%|██████████| 30/30 [00:59<00:00,  1.97s/it]
Epoch: 48
Avg # of users: 5.866666666666666
Avg Loss: 1.1878370965285414e+16
Avg hit ratio: 0.08890426359383545
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.7361493428548176
Std train time: 1.7404475226569325
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/30 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 7273468794641139.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5593}:   0%|          | 0/30 [00:01<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 7273468794641139.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5593}:   3%|▎         | 1/30 [00:01<00:38,  1.31s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 7351678136519000.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.2895}:   3%|▎         | 1/30 [00:03<00:38,  1.31s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 7351678136519000.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.2895}:   7%|▋         | 2/30 [00:03<00:48,  1.75s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 7094704584634597.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.7642}:   7%|▋         | 2/30 [00:03<00:48,  1.75s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 7094704584634597.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.7642}:  10%|█         | 3/30 [00:03<00:30,  1.12s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 7171866479969452.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.8057}:  10%|█         | 3/30 [00:05<00:30,  1.12s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 7171866479969452.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.8057}:  13%|█▎        | 4/30 [00:05<00:37,  1.45s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 7242293061266874.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.9187}:  13%|█▎        | 4/30 [00:09<00:37,  1.45s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 7242293061266874.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.9187}:  17%|█▋        | 5/30 [00:09<00:56,  2.28s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 7286400576293653.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.9787}:  17%|█▋        | 5/30 [00:12<00:56,  2.28s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 7286400576293653.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.9787}:  20%|██        | 6/30 [00:12<01:03,  2.63s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 7298407408258064.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 3.0381}:  20%|██        | 6/30 [00:14<01:03,  2.63s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 7298407408258064.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 3.0381}:  23%|██▎       | 7/30 [00:14<00:53,  2.33s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 7318380458681793.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.956}:  23%|██▎       | 7/30 [00:16<00:53,  2.33s/it]  {'epoch': 49, 'num_users': 6.125, 'loss': 7318380458681793.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.956}:  27%|██▋       | 8/30 [00:16<00:51,  2.36s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 7333915053455804.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 3.2076}:  27%|██▋       | 8/30 [00:19<00:51,  2.36s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 7333915053455804.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 3.2076}:  30%|███       | 9/30 [00:19<00:51,  2.45s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 7350829606935282.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 3.1603}:  30%|███       | 9/30 [00:22<00:51,  2.45s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 7350829606935282.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 3.1603}:  33%|███▎      | 10/30 [00:22<00:50,  2.55s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 7353686914901255.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 3.2008}:  33%|███▎      | 10/30 [00:24<00:50,  2.55s/it]{'epoch': 49, 'num_users': 6.6364, 'loss': 7353686914901255.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 3.2008}:  37%|███▋      | 11/30 [00:24<00:44,  2.33s/it]{'epoch': 49, 'num_users': 6.4167, 'loss': 7327359216005163.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.9989}:  37%|███▋      | 11/30 [00:24<00:44,  2.33s/it]{'epoch': 49, 'num_users': 6.4167, 'loss': 7327359216005163.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.9989}:  40%|████      | 12/30 [00:24<00:33,  1.86s/it]{'epoch': 49, 'num_users': 6.6154, 'loss': 7327452419033028.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.9895}:  40%|████      | 12/30 [00:26<00:33,  1.86s/it]{'epoch': 49, 'num_users': 6.6154, 'loss': 7327452419033028.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.9895}:  43%|████▎     | 13/30 [00:26<00:29,  1.74s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 7261060007813015.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.8011}:  43%|████▎     | 13/30 [00:26<00:29,  1.74s/it]{'epoch': 49, 'num_users': 6.3571, 'loss': 7261060007813015.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.8011}:  47%|████▋     | 14/30 [00:26<00:21,  1.33s/it]{'epoch': 49, 'num_users': 6.2667, 'loss': 7272315170209483.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.894}:  47%|████▋     | 14/30 [00:28<00:21,  1.33s/it] {'epoch': 49, 'num_users': 6.2667, 'loss': 7272315170209483.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.894}:  50%|█████     | 15/30 [00:28<00:23,  1.57s/it]{'epoch': 49, 'num_users': 6.0625, 'loss': 7257655127284446.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.7617}:  50%|█████     | 15/30 [00:29<00:23,  1.57s/it]{'epoch': 49, 'num_users': 6.0625, 'loss': 7257655127284446.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.7617}:  53%|█████▎    | 16/30 [00:29<00:18,  1.35s/it]{'epoch': 49, 'num_users': 5.8235, 'loss': 7192030726589757.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.6317}:  53%|█████▎    | 16/30 [00:30<00:18,  1.35s/it]{'epoch': 49, 'num_users': 5.8235, 'loss': 7192030726589757.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.6317}:  57%|█████▋    | 17/30 [00:30<00:13,  1.03s/it]{'epoch': 49, 'num_users': 6.0556, 'loss': 7203770807620770.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5949}:  57%|█████▋    | 17/30 [00:32<00:13,  1.03s/it]{'epoch': 49, 'num_users': 6.0556, 'loss': 7203770807620770.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5949}:  60%|██████    | 18/30 [00:32<00:15,  1.32s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 7199843603935709.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5576}:  60%|██████    | 18/30 [00:33<00:15,  1.32s/it]   {'epoch': 49, 'num_users': 6.0, 'loss': 7199843603935709.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5576}:  63%|██████▎   | 19/30 [00:33<00:13,  1.22s/it]{'epoch': 49, 'num_users': 6.15, 'loss': 7216994250127723.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.6347}:  63%|██████▎   | 19/30 [00:37<00:13,  1.22s/it]{'epoch': 49, 'num_users': 6.15, 'loss': 7216994250127723.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.6347}:  67%|██████▋   | 20/30 [00:37<00:20,  2.09s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 7229785554144728.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.7795}:  67%|██████▋   | 20/30 [00:40<00:20,  2.09s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 7229785554144728.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.7795}:  70%|███████   | 21/30 [00:40<00:20,  2.33s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 7234275794000159.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.7166}:  70%|███████   | 21/30 [00:41<00:20,  2.33s/it]{'epoch': 49, 'num_users': 6.1818, 'loss': 7234275794000159.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.7166}:  73%|███████▎  | 22/30 [00:41<00:16,  2.05s/it]{'epoch': 49, 'num_users': 6.1304, 'loss': 7236858275766510.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.7202}:  73%|███████▎  | 22/30 [00:42<00:16,  2.05s/it]{'epoch': 49, 'num_users': 6.1304, 'loss': 7236858275766510.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.7202}:  77%|███████▋  | 23/30 [00:42<00:13,  1.87s/it]{'epoch': 49, 'num_users': 5.9583, 'loss': 7191240860754353.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.6189}:  77%|███████▋  | 23/30 [00:43<00:13,  1.87s/it]{'epoch': 49, 'num_users': 5.9583, 'loss': 7191240860754353.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.6189}:  80%|████████  | 24/30 [00:43<00:08,  1.40s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 7108325903506670.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5251}:  80%|████████  | 24/30 [00:43<00:08,  1.40s/it]   {'epoch': 49, 'num_users': 5.8, 'loss': 7108325903506670.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5251}:  83%|████████▎ | 25/30 [00:43<00:05,  1.03s/it]{'epoch': 49, 'num_users': 5.8077, 'loss': 7126618050466050.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.6502}:  83%|████████▎ | 25/30 [00:49<00:05,  1.03s/it]{'epoch': 49, 'num_users': 5.8077, 'loss': 7126618050466050.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.6502}:  87%|████████▋ | 26/30 [00:49<00:10,  2.64s/it]{'epoch': 49, 'num_users': 5.8889, 'loss': 7136867461441384.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.7015}:  87%|████████▋ | 26/30 [00:51<00:10,  2.64s/it]{'epoch': 49, 'num_users': 5.8889, 'loss': 7136867461441384.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.7015}:  90%|█████████ | 27/30 [00:51<00:07,  2.46s/it]{'epoch': 49, 'num_users': 6.0, 'loss': 7150801131465385.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.741}:  90%|█████████ | 27/30 [00:55<00:07,  2.46s/it]    {'epoch': 49, 'num_users': 6.0, 'loss': 7150801131465385.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.741}:  93%|█████████▎| 28/30 [00:55<00:05,  2.87s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 7156931121103275.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.744}:  93%|█████████▎| 28/30 [00:57<00:05,  2.87s/it]{'epoch': 49, 'num_users': 5.8621, 'loss': 7156931121103275.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.744}:  97%|█████████▋| 29/30 [00:57<00:02,  2.45s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 7167368386261973.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.7385}:  97%|█████████▋| 29/30 [00:59<00:02,  2.45s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 7167368386261973.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.7385}: 100%|██████████| 30/30 [00:59<00:00,  2.50s/it]{'epoch': 49, 'num_users': 5.8667, 'loss': 7167368386261973.0, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.7385}: 100%|██████████| 30/30 [00:59<00:00,  1.99s/it]
Epoch: 49
Avg # of users: 5.866666666666666
Avg Loss: 7167368386261972.0
Avg hit ratio: 0.0
Avg ndcg: 0.0
Avg compression ratio: 1.0
Avg train time: 2.738498902320862
Std train time: 1.7570941860459304
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
