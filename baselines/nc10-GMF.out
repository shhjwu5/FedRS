  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 3.4449, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 3.1367}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 3.4449, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 3.1367}:  10%|█         | 1/10 [00:01<00:14,  1.59s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 3.5479, 'hit_ratio@10': 0.1129, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.4256}:  10%|█         | 1/10 [00:03<00:14,  1.59s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 3.5479, 'hit_ratio@10': 0.1129, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.4256}:  20%|██        | 2/10 [00:03<00:13,  1.67s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 3.2621, 'hit_ratio@10': 0.0753, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.828}:  20%|██        | 2/10 [00:03<00:13,  1.67s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 3.2621, 'hit_ratio@10': 0.0753, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.828}:  30%|███       | 3/10 [00:03<00:07,  1.06s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 3.3403, 'hit_ratio@10': 0.1457, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.7483}:  30%|███       | 3/10 [00:05<00:07,  1.06s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 3.3403, 'hit_ratio@10': 0.1457, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.7483}:  40%|████      | 4/10 [00:05<00:07,  1.24s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 3.2061, 'hit_ratio@10': 0.1686, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5655}:  40%|████      | 4/10 [00:08<00:07,  1.24s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 3.2061, 'hit_ratio@10': 0.1686, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5655}:  50%|█████     | 5/10 [00:08<00:09,  1.85s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 3.2353, 'hit_ratio@10': 0.2257, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5684}:  50%|█████     | 5/10 [00:10<00:09,  1.85s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 3.2353, 'hit_ratio@10': 0.2257, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5684}:  60%|██████    | 6/10 [00:10<00:08,  2.11s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 3.2536, 'hit_ratio@10': 0.222, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5942}:  60%|██████    | 6/10 [00:12<00:08,  2.11s/it] {'epoch': 0, 'num_users': 6.2857, 'loss': 3.2536, 'hit_ratio@10': 0.222, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5942}:  70%|███████   | 7/10 [00:12<00:05,  1.87s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 3.1615, 'hit_ratio@10': 0.2193, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.509}:  70%|███████   | 7/10 [00:14<00:05,  1.87s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 3.1615, 'hit_ratio@10': 0.2193, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.509}:  80%|████████  | 8/10 [00:14<00:03,  1.89s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 3.2517, 'hit_ratio@10': 0.2425, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.6828}:  80%|████████  | 8/10 [00:16<00:03,  1.89s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 3.2517, 'hit_ratio@10': 0.2425, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.6828}:  90%|█████████ | 9/10 [00:16<00:01,  1.94s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 3.2456, 'hit_ratio@10': 0.2478, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.6571}:  90%|█████████ | 9/10 [00:18<00:01,  1.94s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 3.2456, 'hit_ratio@10': 0.2478, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.6571}: 100%|██████████| 10/10 [00:18<00:00,  2.10s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 3.2456, 'hit_ratio@10': 0.2478, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.6571}: 100%|██████████| 10/10 [00:18<00:00,  1.85s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 3.2456036360837346
Avg hit ratio: 0.24780863938928452
Avg ndcg: 0.0
Avg compression ratio: 1.0
Avg train time: 2.6570648670196535
Std train time: 1.3874940156485844
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 3.032, 'hit_ratio@10': 0.2632, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.0295}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 3.032, 'hit_ratio@10': 0.2632, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.0295}:  10%|█         | 1/10 [00:01<00:09,  1.03s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 2.9969, 'hit_ratio@10': 0.3251, 'ndcg@10': 0.0072, 'compress@10': 1.0, 'time@10': 1.8813}:  10%|█         | 1/10 [00:02<00:09,  1.03s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 2.9969, 'hit_ratio@10': 0.3251, 'ndcg@10': 0.0072, 'compress@10': 1.0, 'time@10': 1.8813}:  20%|██        | 2/10 [00:02<00:11,  1.45s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 2.8124, 'hit_ratio@10': 0.3596, 'ndcg@10': 0.0048, 'compress@10': 1.0, 'time@10': 1.4599}:  20%|██        | 2/10 [00:03<00:11,  1.45s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 2.8124, 'hit_ratio@10': 0.3596, 'ndcg@10': 0.0048, 'compress@10': 1.0, 'time@10': 1.4599}:  30%|███       | 3/10 [00:03<00:06,  1.07it/s]{'epoch': 1, 'num_users': 5.0, 'loss': 2.8553, 'hit_ratio@10': 0.3679, 'ndcg@10': 0.0037, 'compress@10': 1.0, 'time@10': 1.4909}:  30%|███       | 3/10 [00:04<00:06,  1.07it/s]{'epoch': 1, 'num_users': 5.0, 'loss': 2.8553, 'hit_ratio@10': 0.3679, 'ndcg@10': 0.0037, 'compress@10': 1.0, 'time@10': 1.4909}:  40%|████      | 4/10 [00:04<00:07,  1.20s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 2.6425, 'hit_ratio@10': 0.3663, 'ndcg@10': 0.011, 'compress@10': 1.0, 'time@10': 2.3517}:  40%|████      | 4/10 [00:07<00:07,  1.20s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 2.6425, 'hit_ratio@10': 0.3663, 'ndcg@10': 0.011, 'compress@10': 1.0, 'time@10': 2.3517}:  50%|█████     | 5/10 [00:07<00:09,  1.82s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 2.6137, 'hit_ratio@10': 0.3831, 'ndcg@10': 0.0148, 'compress@10': 1.0, 'time@10': 2.337}:  50%|█████     | 5/10 [00:09<00:09,  1.82s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 2.6137, 'hit_ratio@10': 0.3831, 'ndcg@10': 0.0148, 'compress@10': 1.0, 'time@10': 2.337}:  60%|██████    | 6/10 [00:09<00:07,  1.98s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 2.6501, 'hit_ratio@10': 0.3626, 'ndcg@10': 0.0127, 'compress@10': 1.0, 'time@10': 2.3721}:  60%|██████    | 6/10 [00:11<00:07,  1.98s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 2.6501, 'hit_ratio@10': 0.3626, 'ndcg@10': 0.0127, 'compress@10': 1.0, 'time@10': 2.3721}:  70%|███████   | 7/10 [00:11<00:05,  1.76s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 2.5592, 'hit_ratio@10': 0.3673, 'ndcg@10': 0.0149, 'compress@10': 1.0, 'time@10': 2.2948}:  70%|███████   | 7/10 [00:12<00:05,  1.76s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 2.5592, 'hit_ratio@10': 0.3673, 'ndcg@10': 0.0149, 'compress@10': 1.0, 'time@10': 2.2948}:  80%|████████  | 8/10 [00:12<00:03,  1.76s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 2.6297, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.0163, 'compress@10': 1.0, 'time@10': 2.4348}:  80%|████████  | 8/10 [00:14<00:03,  1.76s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 2.6297, 'hit_ratio@10': 0.3741, 'ndcg@10': 0.0163, 'compress@10': 1.0, 'time@10': 2.4348}:  90%|█████████ | 9/10 [00:14<00:01,  1.78s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 2.6016, 'hit_ratio@10': 0.364, 'ndcg@10': 0.0182, 'compress@10': 1.0, 'time@10': 2.413}:  90%|█████████ | 9/10 [00:17<00:01,  1.78s/it]     {'epoch': 1, 'num_users': 6.3, 'loss': 2.6016, 'hit_ratio@10': 0.364, 'ndcg@10': 0.0182, 'compress@10': 1.0, 'time@10': 2.413}: 100%|██████████| 10/10 [00:17<00:00,  1.92s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 2.6016, 'hit_ratio@10': 0.364, 'ndcg@10': 0.0182, 'compress@10': 1.0, 'time@10': 2.413}: 100%|██████████| 10/10 [00:17<00:00,  1.70s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 2.6015595523852437
Avg hit ratio: 0.36396486083243296
Avg ndcg: 0.01823151132858842
Avg compression ratio: 1.0
Avg train time: 2.412999987602234
Std train time: 1.3336888156612487
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 2.3046, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 1.9168}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 2.3046, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 1.9168}:  10%|█         | 1/10 [00:00<00:08,  1.03it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 1.9677, 'hit_ratio@10': 0.4261, 'ndcg@10': 0.0497, 'compress@10': 1.0, 'time@10': 1.7531}:  10%|█         | 1/10 [00:02<00:08,  1.03it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 1.9677, 'hit_ratio@10': 0.4261, 'ndcg@10': 0.0497, 'compress@10': 1.0, 'time@10': 1.7531}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 2.0224, 'hit_ratio@10': 0.427, 'ndcg@10': 0.0331, 'compress@10': 1.0, 'time@10': 1.3573}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 2.0224, 'hit_ratio@10': 0.427, 'ndcg@10': 0.0331, 'compress@10': 1.0, 'time@10': 1.3573}:  30%|███       | 3/10 [00:02<00:06,  1.14it/s]{'epoch': 2, 'num_users': 5.0, 'loss': 1.9751, 'hit_ratio@10': 0.4452, 'ndcg@10': 0.0347, 'compress@10': 1.0, 'time@10': 1.3613}:  30%|███       | 3/10 [00:04<00:06,  1.14it/s]{'epoch': 2, 'num_users': 5.0, 'loss': 1.9751, 'hit_ratio@10': 0.4452, 'ndcg@10': 0.0347, 'compress@10': 1.0, 'time@10': 1.3613}:  40%|████      | 4/10 [00:04<00:06,  1.08s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 1.7002, 'hit_ratio@10': 0.4362, 'ndcg@10': 0.0612, 'compress@10': 1.0, 'time@10': 2.1485}:  40%|████      | 4/10 [00:06<00:06,  1.08s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 1.7002, 'hit_ratio@10': 0.4362, 'ndcg@10': 0.0612, 'compress@10': 1.0, 'time@10': 2.1485}:  50%|█████     | 5/10 [00:06<00:08,  1.65s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 1.5843, 'hit_ratio@10': 0.4561, 'ndcg@10': 0.0709, 'compress@10': 1.0, 'time@10': 2.1706}:  50%|█████     | 5/10 [00:09<00:08,  1.65s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 1.5843, 'hit_ratio@10': 0.4561, 'ndcg@10': 0.0709, 'compress@10': 1.0, 'time@10': 2.1706}:  60%|██████    | 6/10 [00:09<00:07,  1.87s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 1.6323, 'hit_ratio@10': 0.4366, 'ndcg@10': 0.0658, 'compress@10': 1.0, 'time@10': 2.2385}:  60%|██████    | 6/10 [00:10<00:07,  1.87s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 1.6323, 'hit_ratio@10': 0.4366, 'ndcg@10': 0.0658, 'compress@10': 1.0, 'time@10': 2.2385}:  70%|███████   | 7/10 [00:10<00:05,  1.70s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 1.544, 'hit_ratio@10': 0.4392, 'ndcg@10': 0.069, 'compress@10': 1.0, 'time@10': 2.1696}:  70%|███████   | 7/10 [00:12<00:05,  1.70s/it]   {'epoch': 2, 'num_users': 6.125, 'loss': 1.544, 'hit_ratio@10': 0.4392, 'ndcg@10': 0.069, 'compress@10': 1.0, 'time@10': 2.1696}:  80%|████████  | 8/10 [00:12<00:03,  1.70s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 1.5675, 'hit_ratio@10': 0.4475, 'ndcg@10': 0.0705, 'compress@10': 1.0, 'time@10': 2.3293}:  80%|████████  | 8/10 [00:14<00:03,  1.70s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 1.5675, 'hit_ratio@10': 0.4475, 'ndcg@10': 0.0705, 'compress@10': 1.0, 'time@10': 2.3293}:  90%|█████████ | 9/10 [00:14<00:01,  1.74s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 1.5115, 'hit_ratio@10': 0.4414, 'ndcg@10': 0.0741, 'compress@10': 1.0, 'time@10': 2.3137}:  90%|█████████ | 9/10 [00:16<00:01,  1.74s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 1.5115, 'hit_ratio@10': 0.4414, 'ndcg@10': 0.0741, 'compress@10': 1.0, 'time@10': 2.3137}: 100%|██████████| 10/10 [00:16<00:00,  1.88s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 1.5115, 'hit_ratio@10': 0.4414, 'ndcg@10': 0.0741, 'compress@10': 1.0, 'time@10': 2.3137}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 1.5114733253222883
Avg hit ratio: 0.4414211212292707
Avg ndcg: 0.07412390981114399
Avg compression ratio: 1.0
Avg train time: 2.3137118816375732
Std train time: 1.2536756630391517
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 1.0127, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.1124, 'compress@10': 1.0, 'time@10': 1.8447}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 1.0127, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.1124, 'compress@10': 1.0, 'time@10': 1.8447}:  10%|█         | 1/10 [00:00<00:08,  1.07it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.6431, 'hit_ratio@10': 0.517, 'ndcg@10': 0.2514, 'compress@10': 1.0, 'time@10': 1.6689}:  10%|█         | 1/10 [00:02<00:08,  1.07it/s] {'epoch': 3, 'num_users': 7.0, 'loss': 0.6431, 'hit_ratio@10': 0.517, 'ndcg@10': 0.2514, 'compress@10': 1.0, 'time@10': 1.6689}:  20%|██        | 2/10 [00:02<00:10,  1.28s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.9548, 'hit_ratio@10': 0.5351, 'ndcg@10': 0.1848, 'compress@10': 1.0, 'time@10': 1.2995}:  20%|██        | 2/10 [00:02<00:10,  1.28s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.9548, 'hit_ratio@10': 0.5351, 'ndcg@10': 0.1848, 'compress@10': 1.0, 'time@10': 1.2995}:  30%|███       | 3/10 [00:02<00:05,  1.21it/s]{'epoch': 3, 'num_users': 5.0, 'loss': 0.8167, 'hit_ratio@10': 0.5442, 'ndcg@10': 0.2055, 'compress@10': 1.0, 'time@10': 1.329}:  30%|███       | 3/10 [00:04<00:05,  1.21it/s] {'epoch': 3, 'num_users': 5.0, 'loss': 0.8167, 'hit_ratio@10': 0.5442, 'ndcg@10': 0.2055, 'compress@10': 1.0, 'time@10': 1.329}:  40%|████      | 4/10 [00:04<00:06,  1.07s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.6699, 'hit_ratio@10': 0.5834, 'ndcg@10': 0.2873, 'compress@10': 1.0, 'time@10': 2.1118}:  40%|████      | 4/10 [00:06<00:06,  1.07s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.6699, 'hit_ratio@10': 0.5834, 'ndcg@10': 0.2873, 'compress@10': 1.0, 'time@10': 2.1118}:  50%|█████     | 5/10 [00:06<00:08,  1.64s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.5783, 'hit_ratio@10': 0.6047, 'ndcg@10': 0.3332, 'compress@10': 1.0, 'time@10': 2.153}:  50%|█████     | 5/10 [00:09<00:08,  1.64s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.5783, 'hit_ratio@10': 0.6047, 'ndcg@10': 0.3332, 'compress@10': 1.0, 'time@10': 2.153}:  60%|██████    | 6/10 [00:09<00:07,  1.89s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.5703, 'hit_ratio@10': 0.5754, 'ndcg@10': 0.3164, 'compress@10': 1.0, 'time@10': 2.1952}:  60%|██████    | 6/10 [00:10<00:07,  1.89s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.5703, 'hit_ratio@10': 0.5754, 'ndcg@10': 0.3164, 'compress@10': 1.0, 'time@10': 2.1952}:  70%|███████   | 7/10 [00:10<00:05,  1.68s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.5166, 'hit_ratio@10': 0.5928, 'ndcg@10': 0.3317, 'compress@10': 1.0, 'time@10': 2.1325}:  70%|███████   | 7/10 [00:12<00:05,  1.68s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.5166, 'hit_ratio@10': 0.5928, 'ndcg@10': 0.3317, 'compress@10': 1.0, 'time@10': 2.1325}:  80%|████████  | 8/10 [00:12<00:03,  1.69s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.4923, 'hit_ratio@10': 0.5872, 'ndcg@10': 0.3389, 'compress@10': 1.0, 'time@10': 2.3025}:  80%|████████  | 8/10 [00:14<00:03,  1.69s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.4923, 'hit_ratio@10': 0.5872, 'ndcg@10': 0.3389, 'compress@10': 1.0, 'time@10': 2.3025}:  90%|█████████ | 9/10 [00:14<00:01,  1.74s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.4535, 'hit_ratio@10': 0.5967, 'ndcg@10': 0.3565, 'compress@10': 1.0, 'time@10': 2.2945}:  90%|█████████ | 9/10 [00:16<00:01,  1.74s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.4535, 'hit_ratio@10': 0.5967, 'ndcg@10': 0.3565, 'compress@10': 1.0, 'time@10': 2.2945}: 100%|██████████| 10/10 [00:16<00:00,  1.89s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.4535, 'hit_ratio@10': 0.5967, 'ndcg@10': 0.3565, 'compress@10': 1.0, 'time@10': 2.2945}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.45346136714994456
Avg hit ratio: 0.5966885150314691
Avg ndcg: 0.35650551039229994
Avg compression ratio: 1.0
Avg train time: 2.294521856307983
Std train time: 1.248078822982546
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1173, 'hit_ratio@10': 0.6316, 'ndcg@10': 0.5399, 'compress@10': 1.0, 'time@10': 1.8918}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1173, 'hit_ratio@10': 0.6316, 'ndcg@10': 0.5399, 'compress@10': 1.0, 'time@10': 1.8918}:  10%|█         | 1/10 [00:00<00:08,  1.04it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0686, 'hit_ratio@10': 0.7351, 'ndcg@10': 0.7145, 'compress@10': 1.0, 'time@10': 1.7259}:  10%|█         | 1/10 [00:02<00:08,  1.04it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0686, 'hit_ratio@10': 0.7351, 'ndcg@10': 0.7145, 'compress@10': 1.0, 'time@10': 1.7259}:  20%|██        | 2/10 [00:02<00:10,  1.32s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.2793, 'hit_ratio@10': 0.6806, 'ndcg@10': 0.526, 'compress@10': 1.0, 'time@10': 1.3415}:  20%|██        | 2/10 [00:02<00:10,  1.32s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.2793, 'hit_ratio@10': 0.6806, 'ndcg@10': 0.526, 'compress@10': 1.0, 'time@10': 1.3415}:  30%|███       | 3/10 [00:02<00:05,  1.17it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.2153, 'hit_ratio@10': 0.7247, 'ndcg@10': 0.608, 'compress@10': 1.0, 'time@10': 1.3478}:  30%|███       | 3/10 [00:04<00:05,  1.17it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.2153, 'hit_ratio@10': 0.7247, 'ndcg@10': 0.608, 'compress@10': 1.0, 'time@10': 1.3478}:  40%|████      | 4/10 [00:04<00:06,  1.06s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.1756, 'hit_ratio@10': 0.7678, 'ndcg@10': 0.668, 'compress@10': 1.0, 'time@10': 2.1058}:  40%|████      | 4/10 [00:06<00:06,  1.06s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.1756, 'hit_ratio@10': 0.7678, 'ndcg@10': 0.668, 'compress@10': 1.0, 'time@10': 2.1058}:  50%|█████     | 5/10 [00:06<00:08,  1.61s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.1493, 'hit_ratio@10': 0.7954, 'ndcg@10': 0.7103, 'compress@10': 1.0, 'time@10': 2.1525}:  50%|█████     | 5/10 [00:09<00:08,  1.61s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.1493, 'hit_ratio@10': 0.7954, 'ndcg@10': 0.7103, 'compress@10': 1.0, 'time@10': 2.1525}:  60%|██████    | 6/10 [00:09<00:07,  1.88s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.1332, 'hit_ratio@10': 0.796, 'ndcg@10': 0.721, 'compress@10': 1.0, 'time@10': 2.2079}:  60%|██████    | 6/10 [00:10<00:07,  1.88s/it]  {'epoch': 4, 'num_users': 6.2857, 'loss': 0.1332, 'hit_ratio@10': 0.796, 'ndcg@10': 0.721, 'compress@10': 1.0, 'time@10': 2.2079}:  70%|███████   | 7/10 [00:10<00:05,  1.69s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.1177, 'hit_ratio@10': 0.8108, 'ndcg@10': 0.7463, 'compress@10': 1.0, 'time@10': 2.1678}:  70%|███████   | 7/10 [00:12<00:05,  1.69s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.1177, 'hit_ratio@10': 0.8108, 'ndcg@10': 0.7463, 'compress@10': 1.0, 'time@10': 2.1678}:  80%|████████  | 8/10 [00:12<00:03,  1.75s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.1067, 'hit_ratio@10': 0.7969, 'ndcg@10': 0.7654, 'compress@10': 1.0, 'time@10': 2.3196}:  80%|████████  | 8/10 [00:14<00:03,  1.75s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.1067, 'hit_ratio@10': 0.7969, 'ndcg@10': 0.7654, 'compress@10': 1.0, 'time@10': 2.3196}:  90%|█████████ | 9/10 [00:14<00:01,  1.76s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0965, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.7858, 'compress@10': 1.0, 'time@10': 2.3096}:  90%|█████████ | 9/10 [00:16<00:01,  1.76s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0965, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.7858, 'compress@10': 1.0, 'time@10': 2.3096}: 100%|██████████| 10/10 [00:16<00:00,  1.91s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0965, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.7858, 'compress@10': 1.0, 'time@10': 2.3096}: 100%|██████████| 10/10 [00:16<00:00,  1.64s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.09649919951943577
Avg hit ratio: 0.8126738841237993
Avg ndcg: 0.7857845539996713
Avg compression ratio: 1.0
Avg train time: 2.3096068859100343
Std train time: 1.1993596987273496
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9262, 'compress@10': 1.0, 'time@10': 1.8353}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0084, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9262, 'compress@10': 1.0, 'time@10': 1.8353}:  10%|█         | 1/10 [00:00<00:08,  1.07it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9369, 'compress@10': 1.0, 'time@10': 1.6795}:  10%|█         | 1/10 [00:02<00:08,  1.07it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9369, 'compress@10': 1.0, 'time@10': 1.6795}:  20%|██        | 2/10 [00:02<00:10,  1.29s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0423, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8212, 'compress@10': 1.0, 'time@10': 1.3155}:  20%|██        | 2/10 [00:02<00:10,  1.29s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0423, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8212, 'compress@10': 1.0, 'time@10': 1.3155}:  30%|███       | 3/10 [00:02<00:05,  1.19it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8541, 'compress@10': 1.0, 'time@10': 1.3224}:  30%|███       | 3/10 [00:04<00:05,  1.19it/s] {'epoch': 5, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8541, 'compress@10': 1.0, 'time@10': 1.3224}:  40%|████      | 4/10 [00:04<00:06,  1.05s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0284, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8722, 'compress@10': 1.0, 'time@10': 2.1115}:  40%|████      | 4/10 [00:06<00:06,  1.05s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0284, 'hit_ratio@10': 0.8731, 'ndcg@10': 0.8722, 'compress@10': 1.0, 'time@10': 2.1115}:  50%|█████     | 5/10 [00:06<00:08,  1.62s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0252, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8864, 'compress@10': 1.0, 'time@10': 2.1535}:  50%|█████     | 5/10 [00:09<00:08,  1.62s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0252, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8864, 'compress@10': 1.0, 'time@10': 2.1535}:  60%|██████    | 6/10 [00:09<00:07,  1.88s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.8953, 'compress@10': 1.0, 'time@10': 2.2054}:  60%|██████    | 6/10 [00:10<00:07,  1.88s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.8953, 'compress@10': 1.0, 'time@10': 2.2054}:  70%|███████   | 7/10 [00:10<00:05,  1.86s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0201, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9034, 'compress@10': 1.0, 'time@10': 2.149}:  70%|███████   | 7/10 [00:12<00:05,  1.86s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.0201, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9034, 'compress@10': 1.0, 'time@10': 2.149}:  80%|████████  | 8/10 [00:12<00:03,  1.83s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9084, 'compress@10': 1.0, 'time@10': 2.3041}:  80%|████████  | 8/10 [00:14<00:03,  1.83s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9084, 'compress@10': 1.0, 'time@10': 2.3041}:  90%|█████████ | 9/10 [00:14<00:01,  1.82s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9153, 'compress@10': 1.0, 'time@10': 2.2933}:  90%|█████████ | 9/10 [00:16<00:01,  1.82s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9153, 'compress@10': 1.0, 'time@10': 2.2933}: 100%|██████████| 10/10 [00:16<00:00,  1.94s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9153, 'compress@10': 1.0, 'time@10': 2.2933}: 100%|██████████| 10/10 [00:16<00:00,  1.68s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.017170737863344464
Avg hit ratio: 0.9051958096610049
Avg ndcg: 0.9153134389744423
Avg compression ratio: 1.0
Avg train time: 2.293270707130432
Std train time: 1.2404526899392465
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0044, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9435, 'compress@10': 1.0, 'time@10': 1.9158}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0044, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9435, 'compress@10': 1.0, 'time@10': 1.9158}:  10%|█         | 1/10 [00:00<00:08,  1.03it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0067, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9578, 'compress@10': 1.0, 'time@10': 1.7262}:  10%|█         | 1/10 [00:02<00:08,  1.03it/s] {'epoch': 6, 'num_users': 7.0, 'loss': 0.0067, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9578, 'compress@10': 1.0, 'time@10': 1.7262}:  20%|██        | 2/10 [00:02<00:10,  1.32s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9185, 'compress@10': 1.0, 'time@10': 1.3355}:  20%|██        | 2/10 [00:02<00:10,  1.32s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9185, 'compress@10': 1.0, 'time@10': 1.3355}:  30%|███       | 3/10 [00:02<00:05,  1.18it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9294, 'compress@10': 1.0, 'time@10': 1.3418}:  30%|███       | 3/10 [00:04<00:05,  1.18it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9294, 'compress@10': 1.0, 'time@10': 1.3418}:  40%|████      | 4/10 [00:04<00:06,  1.06s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0064, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9353, 'compress@10': 1.0, 'time@10': 2.1073}:  40%|████      | 4/10 [00:06<00:06,  1.06s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0064, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9353, 'compress@10': 1.0, 'time@10': 2.1073}:  50%|█████     | 5/10 [00:06<00:08,  1.61s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0066, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9398, 'compress@10': 1.0, 'time@10': 2.1486}:  50%|█████     | 5/10 [00:09<00:08,  1.61s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0066, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9398, 'compress@10': 1.0, 'time@10': 2.1486}:  60%|██████    | 6/10 [00:09<00:07,  1.87s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0062, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9436, 'compress@10': 1.0, 'time@10': 2.2047}:  60%|██████    | 6/10 [00:10<00:07,  1.87s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0062, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9436, 'compress@10': 1.0, 'time@10': 2.2047}:  70%|███████   | 7/10 [00:10<00:05,  1.68s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0058, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9467, 'compress@10': 1.0, 'time@10': 2.1421}:  70%|███████   | 7/10 [00:12<00:05,  1.68s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0058, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9467, 'compress@10': 1.0, 'time@10': 2.1421}:  80%|████████  | 8/10 [00:12<00:03,  1.69s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0059, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 2.3034}:  80%|████████  | 8/10 [00:13<00:03,  1.69s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0059, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 2.3034}:  90%|█████████ | 9/10 [00:13<00:01,  1.73s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0055, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9508, 'compress@10': 1.0, 'time@10': 2.2939}:  90%|█████████ | 9/10 [00:16<00:01,  1.73s/it]    {'epoch': 6, 'num_users': 6.3, 'loss': 0.0055, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9508, 'compress@10': 1.0, 'time@10': 2.2939}: 100%|██████████| 10/10 [00:16<00:00,  1.88s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0055, 'hit_ratio@10': 0.886, 'ndcg@10': 0.9508, 'compress@10': 1.0, 'time@10': 2.2939}: 100%|██████████| 10/10 [00:16<00:00,  1.62s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.005520152931229818
Avg hit ratio: 0.885970003209392
Avg ndcg: 0.9508045531153417
Avg compression ratio: 1.0
Avg train time: 2.293909955024719
Std train time: 1.2245624252999026
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0027, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9502, 'compress@10': 1.0, 'time@10': 1.879}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0027, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9502, 'compress@10': 1.0, 'time@10': 1.879}:  10%|█         | 1/10 [00:00<00:08,  1.03it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9602, 'compress@10': 1.0, 'time@10': 1.7324}:  10%|█         | 1/10 [00:02<00:08,  1.03it/s] {'epoch': 7, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9602, 'compress@10': 1.0, 'time@10': 1.7324}:  20%|██        | 2/10 [00:02<00:10,  1.34s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9258, 'compress@10': 1.0, 'time@10': 1.3478}:  20%|██        | 2/10 [00:02<00:10,  1.34s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9258, 'compress@10': 1.0, 'time@10': 1.3478}:  30%|███       | 3/10 [00:02<00:06,  1.15it/s]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9349, 'compress@10': 1.0, 'time@10': 1.3472}:  30%|███       | 3/10 [00:04<00:06,  1.15it/s]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9349, 'compress@10': 1.0, 'time@10': 1.3472}:  40%|████      | 4/10 [00:04<00:06,  1.06s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0057, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9453, 'compress@10': 1.0, 'time@10': 2.1334}:  40%|████      | 4/10 [00:06<00:06,  1.06s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0057, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9453, 'compress@10': 1.0, 'time@10': 2.1334}:  50%|█████     | 5/10 [00:06<00:08,  1.64s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0064, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9501, 'compress@10': 1.0, 'time@10': 2.1683}:  50%|█████     | 5/10 [00:09<00:08,  1.64s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0064, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9501, 'compress@10': 1.0, 'time@10': 2.1683}:  60%|██████    | 6/10 [00:09<00:07,  1.88s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0059, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9542, 'compress@10': 1.0, 'time@10': 2.2193}:  60%|██████    | 6/10 [00:10<00:07,  1.88s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0059, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9542, 'compress@10': 1.0, 'time@10': 2.2193}:  70%|███████   | 7/10 [00:10<00:05,  1.69s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0055, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9568, 'compress@10': 1.0, 'time@10': 2.1602}:  70%|███████   | 7/10 [00:12<00:05,  1.69s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0055, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9568, 'compress@10': 1.0, 'time@10': 2.1602}:  80%|████████  | 8/10 [00:12<00:03,  1.71s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0056, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9579, 'compress@10': 1.0, 'time@10': 2.3144}:  80%|████████  | 8/10 [00:14<00:03,  1.71s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0056, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9579, 'compress@10': 1.0, 'time@10': 2.3144}:  90%|█████████ | 9/10 [00:14<00:01,  1.74s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0055, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9594, 'compress@10': 1.0, 'time@10': 2.3012}:  90%|█████████ | 9/10 [00:16<00:01,  1.74s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0055, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9594, 'compress@10': 1.0, 'time@10': 2.3012}: 100%|██████████| 10/10 [00:16<00:00,  1.88s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0055, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9594, 'compress@10': 1.0, 'time@10': 2.3012}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.005500718836333574
Avg hit ratio: 0.8831128603522492
Avg ndcg: 0.9594414812944543
Avg compression ratio: 1.0
Avg train time: 2.3011864185333253
Std train time: 1.239468390376179
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0021, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.954, 'compress@10': 1.0, 'time@10': 1.8918}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0021, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.954, 'compress@10': 1.0, 'time@10': 1.8918}:  10%|█         | 1/10 [00:00<00:08,  1.04it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9651, 'compress@10': 1.0, 'time@10': 1.7557}:  10%|█         | 1/10 [00:02<00:08,  1.04it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9651, 'compress@10': 1.0, 'time@10': 1.7557}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 1.3657}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0068, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 1.3657}:  30%|███       | 3/10 [00:02<00:06,  1.14it/s]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.9385, 'compress@10': 1.0, 'time@10': 1.364}:  30%|███       | 3/10 [00:04<00:06,  1.14it/s] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.9385, 'compress@10': 1.0, 'time@10': 1.364}:  40%|████      | 4/10 [00:04<00:06,  1.07s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.9584, 'compress@10': 1.0, 'time@10': 2.1656}:  40%|████      | 4/10 [00:06<00:06,  1.07s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.9584, 'compress@10': 1.0, 'time@10': 2.1656}:  50%|█████     | 5/10 [00:06<00:08,  1.66s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9649, 'compress@10': 1.0, 'time@10': 2.1854}:  50%|█████     | 5/10 [00:09<00:08,  1.66s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9649, 'compress@10': 1.0, 'time@10': 2.1854}:  60%|██████    | 6/10 [00:09<00:07,  1.88s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9669, 'compress@10': 1.0, 'time@10': 2.2339}:  60%|██████    | 6/10 [00:10<00:07,  1.88s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9669, 'compress@10': 1.0, 'time@10': 2.2339}:  70%|███████   | 7/10 [00:10<00:05,  1.68s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0069, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9679, 'compress@10': 1.0, 'time@10': 2.1687}:  70%|███████   | 7/10 [00:12<00:05,  1.68s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0069, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9679, 'compress@10': 1.0, 'time@10': 2.1687}:  80%|████████  | 8/10 [00:12<00:03,  1.70s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0079, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.968, 'compress@10': 1.0, 'time@10': 2.3166}:  80%|████████  | 8/10 [00:14<00:03,  1.70s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0079, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.968, 'compress@10': 1.0, 'time@10': 2.3166}:  90%|█████████ | 9/10 [00:14<00:01,  1.72s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0081, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9695, 'compress@10': 1.0, 'time@10': 2.2983}:  90%|█████████ | 9/10 [00:16<00:01,  1.72s/it]  {'epoch': 8, 'num_users': 6.3, 'loss': 0.0081, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9695, 'compress@10': 1.0, 'time@10': 2.2983}: 100%|██████████| 10/10 [00:16<00:00,  1.85s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0081, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9695, 'compress@10': 1.0, 'time@10': 2.2983}: 100%|██████████| 10/10 [00:16<00:00,  1.62s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.008054036019142011
Avg hit ratio: 0.8756274802352901
Avg ndcg: 0.9694822858994143
Avg compression ratio: 1.0
Avg train time: 2.298268723487854
Std train time: 1.2551568719739161
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.002, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.959, 'compress@10': 1.0, 'time@10': 1.9117}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.002, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.959, 'compress@10': 1.0, 'time@10': 1.9117}:  10%|█         | 1/10 [00:00<00:08,  1.03it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.8667, 'ndcg@10': 1.0167, 'compress@10': 1.0, 'time@10': 1.7597}:  10%|█         | 1/10 [00:02<00:08,  1.03it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.8667, 'ndcg@10': 1.0167, 'compress@10': 1.0, 'time@10': 1.7597}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9619, 'compress@10': 1.0, 'time@10': 1.3639}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9619, 'compress@10': 1.0, 'time@10': 1.3639}:  30%|███       | 3/10 [00:02<00:06,  1.14it/s]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9635, 'compress@10': 1.0, 'time@10': 1.3673}:  30%|███       | 3/10 [00:04<00:06,  1.14it/s] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9635, 'compress@10': 1.0, 'time@10': 1.3673}:  40%|████      | 4/10 [00:04<00:06,  1.08s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.986, 'compress@10': 1.0, 'time@10': 2.1966}:  40%|████      | 4/10 [00:07<00:06,  1.08s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.986, 'compress@10': 1.0, 'time@10': 2.1966}:  50%|█████     | 5/10 [00:07<00:08,  1.69s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0158, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9945, 'compress@10': 1.0, 'time@10': 2.2226}:  50%|█████     | 5/10 [00:09<00:08,  1.69s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0158, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9945, 'compress@10': 1.0, 'time@10': 2.2226}:  60%|██████    | 6/10 [00:09<00:07,  1.92s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9894, 'compress@10': 1.0, 'time@10': 2.2652}:  60%|██████    | 6/10 [00:10<00:07,  1.92s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9894, 'compress@10': 1.0, 'time@10': 2.2652}:  70%|███████   | 7/10 [00:10<00:05,  1.71s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.986, 'compress@10': 1.0, 'time@10': 2.1931}:  70%|███████   | 7/10 [00:12<00:05,  1.71s/it]   {'epoch': 9, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.986, 'compress@10': 1.0, 'time@10': 2.1931}:  80%|████████  | 8/10 [00:12<00:03,  1.71s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.985, 'compress@10': 1.0, 'time@10': 2.3546}:  80%|████████  | 8/10 [00:14<00:03,  1.71s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.985, 'compress@10': 1.0, 'time@10': 2.3546}:  90%|█████████ | 9/10 [00:14<00:01,  1.75s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9843, 'compress@10': 1.0, 'time@10': 2.338}:  90%|█████████ | 9/10 [00:16<00:01,  1.75s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9843, 'compress@10': 1.0, 'time@10': 2.338}: 100%|██████████| 10/10 [00:16<00:00,  1.89s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9843, 'compress@10': 1.0, 'time@10': 2.338}: 100%|██████████| 10/10 [00:16<00:00,  1.65s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.015708464718223063
Avg hit ratio: 0.888484623092433
Avg ndcg: 0.9843434392386051
Avg compression ratio: 1.0
Avg train time: 2.3380181550979615
Std train time: 1.3051438900301813
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0048, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9705, 'compress@10': 1.0, 'time@10': 1.9759}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0048, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9705, 'compress@10': 1.0, 'time@10': 1.9759}:  10%|█         | 1/10 [00:01<00:09,  1.00s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9662, 'compress@10': 1.0, 'time@10': 1.7844}:  10%|█         | 1/10 [00:02<00:09,  1.00s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9662, 'compress@10': 1.0, 'time@10': 1.7844}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9524, 'compress@10': 1.0, 'time@10': 1.3859}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0157, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9524, 'compress@10': 1.0, 'time@10': 1.3859}:  30%|███       | 3/10 [00:02<00:06,  1.13it/s]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.957, 'compress@10': 1.0, 'time@10': 1.3783}:  30%|███       | 3/10 [00:04<00:06,  1.13it/s] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.957, 'compress@10': 1.0, 'time@10': 1.3783}:  40%|████      | 4/10 [00:04<00:06,  1.08s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0312, 'hit_ratio@10': 0.8498, 'ndcg@10': 1.009, 'compress@10': 1.0, 'time@10': 2.1636}:  40%|████      | 4/10 [00:06<00:06,  1.08s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0312, 'hit_ratio@10': 0.8498, 'ndcg@10': 1.009, 'compress@10': 1.0, 'time@10': 2.1636}:  50%|█████     | 5/10 [00:06<00:08,  1.65s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0354, 'hit_ratio@10': 0.8563, 'ndcg@10': 1.0197, 'compress@10': 1.0, 'time@10': 2.1857}:  50%|█████     | 5/10 [00:09<00:08,  1.65s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0354, 'hit_ratio@10': 0.8563, 'ndcg@10': 1.0197, 'compress@10': 1.0, 'time@10': 2.1857}:  60%|██████    | 6/10 [00:09<00:07,  1.88s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.8711, 'ndcg@10': 1.0123, 'compress@10': 1.0, 'time@10': 2.24}:  60%|██████    | 6/10 [00:10<00:07,  1.88s/it]  {'epoch': 10, 'num_users': 6.2857, 'loss': 0.0307, 'hit_ratio@10': 0.8711, 'ndcg@10': 1.0123, 'compress@10': 1.0, 'time@10': 2.24}:  70%|███████   | 7/10 [00:10<00:05,  1.69s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.8837, 'ndcg@10': 1.0051, 'compress@10': 1.0, 'time@10': 2.176}:  70%|███████   | 7/10 [00:12<00:05,  1.69s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0285, 'hit_ratio@10': 0.8837, 'ndcg@10': 1.0051, 'compress@10': 1.0, 'time@10': 2.176}:  80%|████████  | 8/10 [00:12<00:03,  1.71s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0306, 'hit_ratio@10': 0.8712, 'ndcg@10': 1.0039, 'compress@10': 1.0, 'time@10': 2.331}:  80%|████████  | 8/10 [00:14<00:03,  1.71s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0306, 'hit_ratio@10': 0.8712, 'ndcg@10': 1.0039, 'compress@10': 1.0, 'time@10': 2.331}:  90%|█████████ | 9/10 [00:14<00:01,  1.74s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0397, 'hit_ratio@10': 0.8773, 'ndcg@10': 1.0663, 'compress@10': 1.0, 'time@10': 2.3104}:  90%|█████████ | 9/10 [00:16<00:01,  1.74s/it]  {'epoch': 10, 'num_users': 6.3, 'loss': 0.0397, 'hit_ratio@10': 0.8773, 'ndcg@10': 1.0663, 'compress@10': 1.0, 'time@10': 2.3104}: 100%|██████████| 10/10 [00:16<00:00,  1.86s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0397, 'hit_ratio@10': 0.8773, 'ndcg@10': 1.0663, 'compress@10': 1.0, 'time@10': 2.3104}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03974978142188856
Avg hit ratio: 0.8772725018803117
Avg ndcg: 1.0662985978860762
Avg compression ratio: 1.0
Avg train time: 2.3103635787963865
Std train time: 1.2448175093952552
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0023, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9669, 'compress@10': 1.0, 'time@10': 1.9107}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0023, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9669, 'compress@10': 1.0, 'time@10': 1.9107}:  10%|█         | 1/10 [00:00<00:08,  1.02it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8345, 'ndcg@10': 1.1242, 'compress@10': 1.0, 'time@10': 1.7395}:  10%|█         | 1/10 [00:02<00:08,  1.02it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8345, 'ndcg@10': 1.1242, 'compress@10': 1.0, 'time@10': 1.7395}:  20%|██        | 2/10 [00:02<00:10,  1.33s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0412, 'hit_ratio@10': 0.7468, 'ndcg@10': 1.1758, 'compress@10': 1.0, 'time@10': 1.349}:  20%|██        | 2/10 [00:02<00:10,  1.33s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0412, 'hit_ratio@10': 0.7468, 'ndcg@10': 1.1758, 'compress@10': 1.0, 'time@10': 1.349}:  30%|███       | 3/10 [00:02<00:06,  1.16it/s]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0388, 'hit_ratio@10': 0.7654, 'ndcg@10': 1.1287, 'compress@10': 1.0, 'time@10': 1.3446}:  30%|███       | 3/10 [00:04<00:06,  1.16it/s]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0388, 'hit_ratio@10': 0.7654, 'ndcg@10': 1.1287, 'compress@10': 1.0, 'time@10': 1.3446}:  40%|████      | 4/10 [00:04<00:06,  1.05s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.1043, 'hit_ratio@10': 0.8004, 'ndcg@10': 1.8343, 'compress@10': 1.0, 'time@10': 2.1024}:  40%|████      | 4/10 [00:06<00:06,  1.05s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.1043, 'hit_ratio@10': 0.8004, 'ndcg@10': 1.8343, 'compress@10': 1.0, 'time@10': 2.1024}:  50%|█████     | 5/10 [00:06<00:08,  1.60s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.1202, 'hit_ratio@10': 0.8151, 'ndcg@10': 1.7239, 'compress@10': 1.0, 'time@10': 2.1366}:  50%|█████     | 5/10 [00:09<00:08,  1.60s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.1202, 'hit_ratio@10': 0.8151, 'ndcg@10': 1.7239, 'compress@10': 1.0, 'time@10': 2.1366}:  60%|██████    | 6/10 [00:09<00:07,  1.85s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.1051, 'hit_ratio@10': 0.8358, 'ndcg@10': 1.6147, 'compress@10': 1.0, 'time@10': 2.2078}:  60%|██████    | 6/10 [00:10<00:07,  1.85s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.1051, 'hit_ratio@10': 0.8358, 'ndcg@10': 1.6147, 'compress@10': 1.0, 'time@10': 2.2078}:  70%|███████   | 7/10 [00:10<00:05,  1.68s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0995, 'hit_ratio@10': 0.8528, 'ndcg@10': 1.5832, 'compress@10': 1.0, 'time@10': 2.1365}:  70%|███████   | 7/10 [00:12<00:05,  1.68s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0995, 'hit_ratio@10': 0.8528, 'ndcg@10': 1.5832, 'compress@10': 1.0, 'time@10': 2.1365}:  80%|████████  | 8/10 [00:12<00:03,  1.67s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.1666, 'hit_ratio@10': 0.831, 'ndcg@10': 1.5294, 'compress@10': 1.0, 'time@10': 2.2982}:  80%|████████  | 8/10 [00:13<00:03,  1.67s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.1666, 'hit_ratio@10': 0.831, 'ndcg@10': 1.5294, 'compress@10': 1.0, 'time@10': 2.2982}:  90%|█████████ | 9/10 [00:13<00:01,  1.72s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.2135, 'hit_ratio@10': 0.8411, 'ndcg@10': 37.4648, 'compress@10': 1.0, 'time@10': 2.2892}:  90%|█████████ | 9/10 [00:16<00:01,  1.72s/it] {'epoch': 11, 'num_users': 6.3, 'loss': 0.2135, 'hit_ratio@10': 0.8411, 'ndcg@10': 37.4648, 'compress@10': 1.0, 'time@10': 2.2892}: 100%|██████████| 10/10 [00:16<00:00,  1.87s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.2135, 'hit_ratio@10': 0.8411, 'ndcg@10': 37.4648, 'compress@10': 1.0, 'time@10': 2.2892}: 100%|██████████| 10/10 [00:16<00:00,  1.61s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.21351968383687975
Avg hit ratio: 0.8411066032628003
Avg ndcg: 37.464783459460165
Avg compression ratio: 1.0
Avg train time: 2.2891605615615847
Std train time: 1.2198887619621948
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9951, 'compress@10': 1.0, 'time@10': 1.9249}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9951, 'compress@10': 1.0, 'time@10': 1.9249}:  10%|█         | 1/10 [00:00<00:08,  1.02it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.1013, 'hit_ratio@10': 0.792, 'ndcg@10': 1.0431, 'compress@10': 1.0, 'time@10': 1.7538}:  10%|█         | 1/10 [00:02<00:08,  1.02it/s] {'epoch': 12, 'num_users': 7.0, 'loss': 0.1013, 'hit_ratio@10': 0.792, 'ndcg@10': 1.0431, 'compress@10': 1.0, 'time@10': 1.7538}:  20%|██        | 2/10 [00:02<00:10,  1.35s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.094, 'hit_ratio@10': 0.6709, 'ndcg@10': 1.013, 'compress@10': 1.0, 'time@10': 1.362}:  20%|██        | 2/10 [00:02<00:10,  1.35s/it]  {'epoch': 12, 'num_users': 5.0, 'loss': 0.094, 'hit_ratio@10': 0.6709, 'ndcg@10': 1.013, 'compress@10': 1.0, 'time@10': 1.362}:  30%|███       | 3/10 [00:02<00:06,  1.15it/s]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0935, 'hit_ratio@10': 0.6996, 'ndcg@10': 1.0003, 'compress@10': 1.0, 'time@10': 1.3628}:  30%|███       | 3/10 [00:04<00:06,  1.15it/s]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0935, 'hit_ratio@10': 0.6996, 'ndcg@10': 1.0003, 'compress@10': 1.0, 'time@10': 1.3628}:  40%|████      | 4/10 [00:04<00:06,  1.07s/it]/slstore/shihongjian/Federated-Recommendation-Neural-Collaborative-Filtering/metrics.py:20: RuntimeWarning: overflow encountered in power
  dcg_numerator = np.power(2, predicted_recommendation_best_10) - 1
{'epoch': 12, 'num_users': 5.8, 'loss': 0.2869, 'hit_ratio@10': 0.7517, 'ndcg@10': 3.1251, 'compress@10': 1.0, 'time@10': 2.1518}:  40%|████      | 4/10 [00:06<00:06,  1.07s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.2869, 'hit_ratio@10': 0.7517, 'ndcg@10': 3.1251, 'compress@10': 1.0, 'time@10': 2.1518}:  50%|█████     | 5/10 [00:06<00:08,  1.65s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.4005, 'hit_ratio@10': 0.7671, 'ndcg@10': 20734.4258, 'compress@10': 1.0, 'time@10': 2.1884}:  50%|█████     | 5/10 [00:09<00:08,  1.65s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.4005, 'hit_ratio@10': 0.7671, 'ndcg@10': 20734.4258, 'compress@10': 1.0, 'time@10': 2.1884}:  60%|██████    | 6/10 [00:09<00:07,  1.90s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.3619, 'hit_ratio@10': 0.7947, 'ndcg@10': 17772.5576, 'compress@10': 1.0, 'time@10': 2.2303}:  60%|██████    | 6/10 [00:10<00:07,  1.90s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.3619, 'hit_ratio@10': 0.7947, 'ndcg@10': 17772.5576, 'compress@10': 1.0, 'time@10': 2.2303}:  70%|███████   | 7/10 [00:10<00:05,  1.69s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.3408, 'hit_ratio@10': 0.8132, 'ndcg@10': 15551.11, 'compress@10': 1.0, 'time@10': 2.1685}:  70%|███████   | 7/10 [00:12<00:05,  1.69s/it]   {'epoch': 12, 'num_users': 6.125, 'loss': 0.3408, 'hit_ratio@10': 0.8132, 'ndcg@10': 15551.11, 'compress@10': 1.0, 'time@10': 2.1685}:  80%|████████  | 8/10 [00:12<00:03,  1.71s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.392, 'hit_ratio@10': 0.8117, 'ndcg@10': 313413.2421, 'compress@10': 1.0, 'time@10': 2.3194}:  80%|████████  | 8/10 [00:14<00:03,  1.71s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.392, 'hit_ratio@10': 0.8117, 'ndcg@10': 313413.2421, 'compress@10': 1.0, 'time@10': 2.3194}:  90%|█████████ | 9/10 [00:14<00:01,  1.73s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.4687, 'hit_ratio@10': 0.8124, 'ndcg@10': 282212.6818, 'compress@10': 1.0, 'time@10': 2.3039}:  90%|█████████ | 9/10 [00:16<00:01,  1.73s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.4687, 'hit_ratio@10': 0.8124, 'ndcg@10': 282212.6818, 'compress@10': 1.0, 'time@10': 2.3039}: 100%|██████████| 10/10 [00:16<00:00,  1.87s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.4687, 'hit_ratio@10': 0.8124, 'ndcg@10': 282212.6818, 'compress@10': 1.0, 'time@10': 2.3039}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.4687310342164003
Avg hit ratio: 0.8123809866797981
Avg ndcg: 282212.6818359493
Avg compression ratio: 1.0
Avg train time: 2.303937387466431
Std train time: 1.2418125748845648
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 1.8263}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 1.8263}:  10%|█         | 1/10 [00:00<00:08,  1.08it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.3713, 'hit_ratio@10': 0.8608, 'ndcg@10': 45.0555, 'compress@10': 1.0, 'time@10': 1.6765}:  10%|█         | 1/10 [00:02<00:08,  1.08it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.3713, 'hit_ratio@10': 0.8608, 'ndcg@10': 45.0555, 'compress@10': 1.0, 'time@10': 1.6765}:  20%|██        | 2/10 [00:02<00:10,  1.29s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.2994, 'hit_ratio@10': 0.8596, 'ndcg@10': 30.3693, 'compress@10': 1.0, 'time@10': 1.3095}:  20%|██        | 2/10 [00:02<00:10,  1.29s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.2994, 'hit_ratio@10': 0.8596, 'ndcg@10': 30.3693, 'compress@10': 1.0, 'time@10': 1.3095}:  30%|███       | 3/10 [00:02<00:05,  1.19it/s]{'epoch': 13, 'num_users': 5.0, 'loss': 0.3081, 'hit_ratio@10': 0.8411, 'ndcg@10': 23.0229, 'compress@10': 1.0, 'time@10': 1.3173}:  30%|███       | 3/10 [00:04<00:05,  1.19it/s]{'epoch': 13, 'num_users': 5.0, 'loss': 0.3081, 'hit_ratio@10': 0.8411, 'ndcg@10': 23.0229, 'compress@10': 1.0, 'time@10': 1.3173}:  40%|████      | 4/10 [00:04<00:06,  1.04s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.653, 'hit_ratio@10': 0.8449, 'ndcg@10': 183.0766, 'compress@10': 1.0, 'time@10': 2.096}:  40%|████      | 4/10 [00:06<00:06,  1.04s/it] {'epoch': 13, 'num_users': 5.8, 'loss': 0.653, 'hit_ratio@10': 0.8449, 'ndcg@10': 183.0766, 'compress@10': 1.0, 'time@10': 2.096}:  50%|█████     | 5/10 [00:06<00:08,  1.61s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 1.4076, 'hit_ratio@10': 0.8226, 'ndcg@10': 102414.4283, 'compress@10': 1.0, 'time@10': 2.1264}:  50%|█████     | 5/10 [00:09<00:08,  1.61s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 1.4076, 'hit_ratio@10': 0.8226, 'ndcg@10': 102414.4283, 'compress@10': 1.0, 'time@10': 2.1264}:  60%|██████    | 6/10 [00:09<00:07,  1.84s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 1.276, 'hit_ratio@10': 0.8365, 'ndcg@10': 87785.9623, 'compress@10': 1.0, 'time@10': 2.1701}:  60%|██████    | 6/10 [00:10<00:07,  1.84s/it]  {'epoch': 13, 'num_users': 6.2857, 'loss': 1.276, 'hit_ratio@10': 0.8365, 'ndcg@10': 87785.9623, 'compress@10': 1.0, 'time@10': 2.1701}:  70%|███████   | 7/10 [00:10<00:04,  1.64s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 1.1915, 'hit_ratio@10': 0.8498, 'ndcg@10': 76812.8502, 'compress@10': 1.0, 'time@10': 2.1127}:  70%|███████   | 7/10 [00:12<00:04,  1.64s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 1.1915, 'hit_ratio@10': 0.8498, 'ndcg@10': 76812.8502, 'compress@10': 1.0, 'time@10': 2.1127}:  80%|████████  | 8/10 [00:12<00:03,  1.67s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 1.1982, 'hit_ratio@10': 0.8316, 'ndcg@10': 68278.3416, 'compress@10': 1.0, 'time@10': 2.2751}:  80%|████████  | 8/10 [00:13<00:03,  1.67s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 1.1982, 'hit_ratio@10': 0.8316, 'ndcg@10': 68278.3416, 'compress@10': 1.0, 'time@10': 2.2751}:  90%|█████████ | 9/10 [00:13<00:01,  1.71s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 1.413, 'hit_ratio@10': 0.8234, 'ndcg@10': 394858.0922, 'compress@10': 1.0, 'time@10': 2.268}:  90%|█████████ | 9/10 [00:16<00:01,  1.71s/it]    {'epoch': 13, 'num_users': 6.3, 'loss': 1.413, 'hit_ratio@10': 0.8234, 'ndcg@10': 394858.0922, 'compress@10': 1.0, 'time@10': 2.268}: 100%|██████████| 10/10 [00:16<00:00,  1.87s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 1.413, 'hit_ratio@10': 0.8234, 'ndcg@10': 394858.0922, 'compress@10': 1.0, 'time@10': 2.268}: 100%|██████████| 10/10 [00:16<00:00,  1.60s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 1.4130033103760802
Avg hit ratio: 0.8234101651979412
Avg ndcg: 394858.09224966745
Avg compression ratio: 1.0
Avg train time: 2.267995548248291
Std train time: 1.2320777189925054
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.238, 'hit_ratio@10': 0.9474, 'ndcg@10': 10.489, 'compress@10': 1.0, 'time@10': 1.8633}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.238, 'hit_ratio@10': 0.9474, 'ndcg@10': 10.489, 'compress@10': 1.0, 'time@10': 1.8633}:  10%|█         | 1/10 [00:00<00:08,  1.03it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 2.4893, 'hit_ratio@10': 0.8124, 'ndcg@10': 176547.3458, 'compress@10': 1.0, 'time@10': 1.7228}:  10%|█         | 1/10 [00:02<00:08,  1.03it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 2.4893, 'hit_ratio@10': 0.8124, 'ndcg@10': 176547.3458, 'compress@10': 1.0, 'time@10': 1.7228}:  20%|██        | 2/10 [00:02<00:10,  1.34s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 1.7397, 'hit_ratio@10': 0.6845, 'ndcg@10': 117698.6481, 'compress@10': 1.0, 'time@10': 1.3402}:  20%|██        | 2/10 [00:02<00:10,  1.34s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 1.7397, 'hit_ratio@10': 0.6845, 'ndcg@10': 117698.6481, 'compress@10': 1.0, 'time@10': 1.3402}:  30%|███       | 3/10 [00:02<00:06,  1.15it/s]{'epoch': 14, 'num_users': 5.0, 'loss': 2.2151, 'hit_ratio@10': 0.6473, 'ndcg@10': 42051060.4884, 'compress@10': 1.0, 'time@10': 1.3411}:  30%|███       | 3/10 [00:04<00:06,  1.15it/s]{'epoch': 14, 'num_users': 5.0, 'loss': 2.2151, 'hit_ratio@10': 0.6473, 'ndcg@10': 42051060.4884, 'compress@10': 1.0, 'time@10': 1.3411}:  40%|████      | 4/10 [00:04<00:06,  1.06s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 3.018, 'hit_ratio@10': 0.6778, 'ndcg@10': 2361251177.9696, 'compress@10': 1.0, 'time@10': 2.1071}:  40%|████      | 4/10 [00:06<00:06,  1.06s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 3.018, 'hit_ratio@10': 0.6778, 'ndcg@10': 2361251177.9696, 'compress@10': 1.0, 'time@10': 2.1071}:  50%|█████     | 5/10 [00:06<00:08,  1.62s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 5.4707, 'hit_ratio@10': 0.65, 'ndcg@10': 51085831536.5367, 'compress@10': 1.0, 'time@10': 2.1354}:  50%|█████     | 5/10 [00:09<00:08,  1.62s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 5.4707, 'hit_ratio@10': 0.65, 'ndcg@10': 51085831536.5367, 'compress@10': 1.0, 'time@10': 2.1354}:  60%|██████    | 6/10 [00:09<00:07,  1.85s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 4.889, 'hit_ratio@10': 0.6772, 'ndcg@10': 43787855612.0112, 'compress@10': 1.0, 'time@10': 2.19}:  60%|██████    | 6/10 [00:10<00:07,  1.85s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 4.889, 'hit_ratio@10': 0.6772, 'ndcg@10': 43787855612.0112, 'compress@10': 1.0, 'time@10': 2.19}:  70%|███████   | 7/10 [00:10<00:04,  1.66s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 4.8582, 'hit_ratio@10': 0.6497, 'ndcg@10': 38314373665.0557, 'compress@10': 1.0, 'time@10': 2.1319}:  70%|███████   | 7/10 [00:12<00:04,  1.66s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 4.8582, 'hit_ratio@10': 0.6497, 'ndcg@10': 38314373665.0557, 'compress@10': 1.0, 'time@10': 2.1319}:  80%|████████  | 8/10 [00:12<00:03,  1.69s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 5.2854, 'hit_ratio@10': 0.6473, 'ndcg@10': 34057222099.4493, 'compress@10': 1.0, 'time@10': 2.2856}:  80%|████████  | 8/10 [00:13<00:03,  1.69s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 5.2854, 'hit_ratio@10': 0.6473, 'ndcg@10': 34057222099.4493, 'compress@10': 1.0, 'time@10': 2.2856}:  90%|█████████ | 9/10 [00:13<00:01,  1.71s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 5.3409, 'hit_ratio@10': 0.653, 'ndcg@10': 32787357949.847, 'compress@10': 1.0, 'time@10': 2.2781}:  90%|█████████ | 9/10 [00:16<00:01,  1.71s/it]     {'epoch': 14, 'num_users': 6.3, 'loss': 5.3409, 'hit_ratio@10': 0.653, 'ndcg@10': 32787357949.847, 'compress@10': 1.0, 'time@10': 2.2781}: 100%|██████████| 10/10 [00:16<00:00,  1.87s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 5.3409, 'hit_ratio@10': 0.653, 'ndcg@10': 32787357949.847, 'compress@10': 1.0, 'time@10': 2.2781}: 100%|██████████| 10/10 [00:16<00:00,  1.61s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 5.340947215293156
Avg hit ratio: 0.6530444341547907
Avg ndcg: 32787357949.846992
Avg compression ratio: 1.0
Avg train time: 2.2781203508377077
Std train time: 1.212278033464284
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 2.5741, 'hit_ratio@10': 0.7368, 'ndcg@10': 776631.5632, 'compress@10': 1.0, 'time@10': 1.9024}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 2.5741, 'hit_ratio@10': 0.7368, 'ndcg@10': 776631.5632, 'compress@10': 1.0, 'time@10': 1.9024}:  10%|█         | 1/10 [00:00<00:08,  1.04it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 6.0442, 'hit_ratio@10': 0.562, 'ndcg@10': 437292.7378, 'compress@10': 1.0, 'time@10': 1.7368}:  10%|█         | 1/10 [00:02<00:08,  1.04it/s] {'epoch': 15, 'num_users': 7.0, 'loss': 6.0442, 'hit_ratio@10': 0.562, 'ndcg@10': 437292.7378, 'compress@10': 1.0, 'time@10': 1.7368}:  20%|██        | 2/10 [00:02<00:10,  1.33s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 4.1435, 'hit_ratio@10': 0.6127, 'ndcg@10': 291528.9689, 'compress@10': 1.0, 'time@10': 1.3652}:  20%|██        | 2/10 [00:02<00:10,  1.33s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 4.1435, 'hit_ratio@10': 0.6127, 'ndcg@10': 291528.9689, 'compress@10': 1.0, 'time@10': 1.3652}:  30%|███       | 3/10 [00:02<00:06,  1.15it/s]{'epoch': 15, 'num_users': 5.0, 'loss': 6.8356, 'hit_ratio@10': 0.5846, 'ndcg@10': 63075089968057.5, 'compress@10': 1.0, 'time@10': 1.3661}:  30%|███       | 3/10 [00:04<00:06,  1.15it/s]{'epoch': 15, 'num_users': 5.0, 'loss': 6.8356, 'hit_ratio@10': 0.5846, 'ndcg@10': 63075089968057.5, 'compress@10': 1.0, 'time@10': 1.3661}:  40%|████      | 4/10 [00:04<00:06,  1.07s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 10.9711, 'hit_ratio@10': 0.5716, 'ndcg@10': 1.0794496800247899e+26, 'compress@10': 1.0, 'time@10': 2.1682}:  40%|████      | 4/10 [00:06<00:06,  1.07s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 10.9711, 'hit_ratio@10': 0.5716, 'ndcg@10': 1.0794496800247899e+26, 'compress@10': 1.0, 'time@10': 2.1682}:  50%|█████     | 5/10 [00:06<00:08,  1.66s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 13.9464, 'hit_ratio@10': 0.543, 'ndcg@10': 8.99541440768828e+25, 'compress@10': 1.0, 'time@10': 2.2083}:  50%|█████     | 5/10 [00:09<00:08,  1.66s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 13.9464, 'hit_ratio@10': 0.543, 'ndcg@10': 8.99541440768828e+25, 'compress@10': 1.0, 'time@10': 2.2083}:  60%|██████    | 6/10 [00:09<00:07,  1.92s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 12.4505, 'hit_ratio@10': 0.5512, 'ndcg@10': 7.710355206589956e+25, 'compress@10': 1.0, 'time@10': 2.2655}:  60%|██████    | 6/10 [00:10<00:07,  1.92s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 12.4505, 'hit_ratio@10': 0.5512, 'ndcg@10': 7.710355206589956e+25, 'compress@10': 1.0, 'time@10': 2.2655}:  70%|███████   | 7/10 [00:10<00:05,  1.73s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 12.9149, 'hit_ratio@10': 0.5537, 'ndcg@10': 6.7465608057662135e+25, 'compress@10': 1.0, 'time@10': 2.1906}:  70%|███████   | 7/10 [00:12<00:05,  1.73s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 12.9149, 'hit_ratio@10': 0.5537, 'ndcg@10': 6.7465608057662135e+25, 'compress@10': 1.0, 'time@10': 2.1906}:  80%|████████  | 8/10 [00:12<00:03,  1.71s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 13.8031, 'hit_ratio@10': 0.5144, 'ndcg@10': 5.996942941119774e+25, 'compress@10': 1.0, 'time@10': 2.3528}:  80%|████████  | 8/10 [00:14<00:03,  1.71s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 13.8031, 'hit_ratio@10': 0.5144, 'ndcg@10': 5.996942941119774e+25, 'compress@10': 1.0, 'time@10': 2.3528}:  90%|█████████ | 9/10 [00:14<00:01,  1.75s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 14.1698, 'hit_ratio@10': 0.5152, 'ndcg@10': 4.537126072595924e+27, 'compress@10': 1.0, 'time@10': 2.331}:  90%|█████████ | 9/10 [00:16<00:01,  1.75s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 14.1698, 'hit_ratio@10': 0.5152, 'ndcg@10': 4.537126072595924e+27, 'compress@10': 1.0, 'time@10': 2.331}: 100%|██████████| 10/10 [00:16<00:00,  1.88s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 14.1698, 'hit_ratio@10': 0.5152, 'ndcg@10': 4.537126072595924e+27, 'compress@10': 1.0, 'time@10': 2.331}: 100%|██████████| 10/10 [00:16<00:00,  1.64s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 14.169805068594002
Avg hit ratio: 0.5152380437898264
Avg ndcg: 4.537126072595924e+27
Avg compression ratio: 1.0
Avg train time: 2.331026077270508
Std train time: 1.2723211511717316
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 5.2483, 'hit_ratio@10': 0.3684, 'ndcg@10': 45916.024, 'compress@10': 1.0, 'time@10': 1.9698}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 5.2483, 'hit_ratio@10': 0.3684, 'ndcg@10': 45916.024, 'compress@10': 1.0, 'time@10': 1.9698}:  10%|█         | 1/10 [00:00<00:08,  1.00it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 21.2403, 'hit_ratio@10': 0.3939, 'ndcg@10': 4.359123914132476e+16, 'compress@10': 1.0, 'time@10': 1.7908}:  10%|█         | 1/10 [00:02<00:08,  1.00it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 21.2403, 'hit_ratio@10': 0.3939, 'ndcg@10': 4.359123914132476e+16, 'compress@10': 1.0, 'time@10': 1.7908}:  20%|██        | 2/10 [00:02<00:10,  1.37s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 14.345, 'hit_ratio@10': 0.3578, 'ndcg@10': 2.9060826094216508e+16, 'compress@10': 1.0, 'time@10': 1.3827}:  20%|██        | 2/10 [00:02<00:10,  1.37s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 14.345, 'hit_ratio@10': 0.3578, 'ndcg@10': 2.9060826094216508e+16, 'compress@10': 1.0, 'time@10': 1.3827}:  30%|███       | 3/10 [00:02<00:06,  1.14it/s]{'epoch': 16, 'num_users': 5.0, 'loss': 25.4286, 'hit_ratio@10': 0.3934, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3774}:  30%|███       | 3/10 [00:04<00:06,  1.14it/s]                  {'epoch': 16, 'num_users': 5.0, 'loss': 25.4286, 'hit_ratio@10': 0.3934, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3774}:  40%|████      | 4/10 [00:04<00:06,  1.08s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 28.6161, 'hit_ratio@10': 0.4147, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1379}:  40%|████      | 4/10 [00:07<00:06,  1.08s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 28.6161, 'hit_ratio@10': 0.4147, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1379}:  50%|█████     | 5/10 [00:07<00:08,  1.66s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 35.5618, 'hit_ratio@10': 0.4122, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1729}:  50%|█████     | 5/10 [00:09<00:08,  1.66s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 35.5618, 'hit_ratio@10': 0.4122, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1729}:  60%|██████    | 6/10 [00:09<00:07,  1.90s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 36.2915, 'hit_ratio@10': 0.4276, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2178}:  60%|██████    | 6/10 [00:10<00:07,  1.90s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 36.2915, 'hit_ratio@10': 0.4276, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2178}:  70%|███████   | 7/10 [00:10<00:05,  1.69s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 40.4343, 'hit_ratio@10': 0.4206, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.152}:  70%|███████   | 7/10 [00:12<00:05,  1.69s/it]  {'epoch': 16, 'num_users': 6.125, 'loss': 40.4343, 'hit_ratio@10': 0.4206, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.152}:  80%|████████  | 8/10 [00:12<00:03,  1.70s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 41.2119, 'hit_ratio@10': 0.4056, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3101}:  80%|████████  | 8/10 [00:14<00:03,  1.70s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 41.2119, 'hit_ratio@10': 0.4056, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3101}:  90%|█████████ | 9/10 [00:14<00:01,  1.74s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 40.8486, 'hit_ratio@10': 0.4219, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.305}:  90%|█████████ | 9/10 [00:16<00:01,  1.74s/it]    {'epoch': 16, 'num_users': 6.3, 'loss': 40.8486, 'hit_ratio@10': 0.4219, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.305}: 100%|██████████| 10/10 [00:16<00:00,  1.90s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 40.8486, 'hit_ratio@10': 0.4219, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.305}: 100%|██████████| 10/10 [00:16<00:00,  1.64s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 40.848609022741904
Avg hit ratio: 0.4218814852380217
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.3049822807312013
Std train time: 1.2164442661380308
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 38.1545, 'hit_ratio@10': 0.5263, 'ndcg@10': 64391375083.4084, 'compress@10': 1.0, 'time@10': 1.871}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 38.1545, 'hit_ratio@10': 0.5263, 'ndcg@10': 64391375083.4084, 'compress@10': 1.0, 'time@10': 1.871}:  10%|█         | 1/10 [00:00<00:08,  1.05it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 102.6973, 'hit_ratio@10': 0.4567, 'ndcg@10': 7.196430527278e+26, 'compress@10': 1.0, 'time@10': 1.7045}:  10%|█         | 1/10 [00:02<00:08,  1.05it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 102.6973, 'hit_ratio@10': 0.4567, 'ndcg@10': 7.196430527278e+26, 'compress@10': 1.0, 'time@10': 1.7045}:  20%|██        | 2/10 [00:02<00:10,  1.31s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 68.7836, 'hit_ratio@10': 0.3997, 'ndcg@10': 4.7976203515186664e+26, 'compress@10': 1.0, 'time@10': 1.3191}:  20%|██        | 2/10 [00:02<00:10,  1.31s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 68.7836, 'hit_ratio@10': 0.3997, 'ndcg@10': 4.7976203515186664e+26, 'compress@10': 1.0, 'time@10': 1.3191}:  30%|███       | 3/10 [00:02<00:05,  1.18it/s]{'epoch': 17, 'num_users': 5.0, 'loss': 96.7793, 'hit_ratio@10': 0.3355, 'ndcg@10': 3.698665244865389e+26, 'compress@10': 1.0, 'time@10': 1.3284}:  30%|███       | 3/10 [00:04<00:05,  1.18it/s] {'epoch': 17, 'num_users': 5.0, 'loss': 96.7793, 'hit_ratio@10': 0.3355, 'ndcg@10': 3.698665244865389e+26, 'compress@10': 1.0, 'time@10': 1.3284}:  40%|████      | 4/10 [00:04<00:06,  1.05s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 88.6036, 'hit_ratio@10': 0.3724, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1033}:  40%|████      | 4/10 [00:06<00:06,  1.05s/it]                  {'epoch': 17, 'num_users': 5.8, 'loss': 88.6036, 'hit_ratio@10': 0.3724, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1033}:  50%|█████     | 5/10 [00:06<00:08,  1.62s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 92.3977, 'hit_ratio@10': 0.377, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1436}:  50%|█████     | 5/10 [00:09<00:08,  1.62s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 92.3977, 'hit_ratio@10': 0.377, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1436}:  60%|██████    | 6/10 [00:09<00:07,  1.87s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 100.4815, 'hit_ratio@10': 0.3574, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1966}:  60%|██████    | 6/10 [00:10<00:07,  1.87s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 100.4815, 'hit_ratio@10': 0.3574, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1966}:  70%|███████   | 7/10 [00:10<00:05,  1.68s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 116.1261, 'hit_ratio@10': 0.3699, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1344}:  70%|███████   | 7/10 [00:12<00:05,  1.68s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 116.1261, 'hit_ratio@10': 0.3699, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1344}:  80%|████████  | 8/10 [00:12<00:03,  1.69s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 133.6359, 'hit_ratio@10': 0.3859, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3057}:  80%|████████  | 8/10 [00:13<00:03,  1.69s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 133.6359, 'hit_ratio@10': 0.3859, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3057}:  90%|█████████ | 9/10 [00:13<00:01,  1.74s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 125.2569, 'hit_ratio@10': 0.3814, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2917}:  90%|█████████ | 9/10 [00:16<00:01,  1.74s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 125.2569, 'hit_ratio@10': 0.3814, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2917}: 100%|██████████| 10/10 [00:16<00:00,  1.88s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 125.2569, 'hit_ratio@10': 0.3814, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2917}: 100%|██████████| 10/10 [00:16<00:00,  1.62s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 125.25685003978363
Avg hit ratio: 0.38143216545763237
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.2917240619659425
Std train time: 1.2439197089458678
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 95.3588, 'hit_ratio@10': 0.4211, 'ndcg@10': 5.065841597736198e+18, 'compress@10': 1.0, 'time@10': 1.859}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 95.3588, 'hit_ratio@10': 0.4211, 'ndcg@10': 5.065841597736198e+18, 'compress@10': 1.0, 'time@10': 1.859}:  10%|█         | 1/10 [00:00<00:08,  1.06it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 231.6035, 'hit_ratio@10': 0.4363, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7015}:  10%|█         | 1/10 [00:02<00:08,  1.06it/s]                {'epoch': 18, 'num_users': 7.0, 'loss': 231.6035, 'hit_ratio@10': 0.4363, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7015}:  20%|██        | 2/10 [00:02<00:10,  1.31s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 155.1583, 'hit_ratio@10': 0.3861, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3297}:  20%|██        | 2/10 [00:02<00:10,  1.31s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 155.1583, 'hit_ratio@10': 0.3861, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3297}:  30%|███       | 3/10 [00:02<00:05,  1.18it/s]{'epoch': 18, 'num_users': 5.0, 'loss': 254.4549, 'hit_ratio@10': 0.3342, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3659}:  30%|███       | 3/10 [00:04<00:05,  1.18it/s]{'epoch': 18, 'num_users': 5.0, 'loss': 254.4549, 'hit_ratio@10': 0.3342, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3659}:  40%|████      | 4/10 [00:04<00:06,  1.10s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 231.4985, 'hit_ratio@10': 0.3234, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1512}:  40%|████      | 4/10 [00:06<00:06,  1.10s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 231.4985, 'hit_ratio@10': 0.3234, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1512}:  50%|█████     | 5/10 [00:06<00:08,  1.67s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 225.664, 'hit_ratio@10': 0.3362, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.176}:  50%|█████     | 5/10 [00:09<00:08,  1.67s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 225.664, 'hit_ratio@10': 0.3362, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.176}:  60%|██████    | 6/10 [00:09<00:07,  1.89s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 242.9318, 'hit_ratio@10': 0.3339, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2271}:  60%|██████    | 6/10 [00:10<00:07,  1.89s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 242.9318, 'hit_ratio@10': 0.3339, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2271}:  70%|███████   | 7/10 [00:10<00:05,  1.69s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 318.3314, 'hit_ratio@10': 0.3243, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1639}:  70%|███████   | 7/10 [00:12<00:05,  1.69s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 318.3314, 'hit_ratio@10': 0.3243, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1639}:  80%|████████  | 8/10 [00:12<00:03,  1.71s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 395.7713, 'hit_ratio@10': 0.3295, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3156}:  80%|████████  | 8/10 [00:14<00:03,  1.71s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 395.7713, 'hit_ratio@10': 0.3295, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3156}:  90%|█████████ | 9/10 [00:14<00:01,  1.73s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 368.5299, 'hit_ratio@10': 0.3329, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2998}:  90%|█████████ | 9/10 [00:16<00:01,  1.73s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 368.5299, 'hit_ratio@10': 0.3329, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2998}: 100%|██████████| 10/10 [00:16<00:00,  1.88s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 368.5299, 'hit_ratio@10': 0.3329, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2998}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 368.5298711217791
Avg hit ratio: 0.3329159041298261
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.2998237133026125
Std train time: 1.235334506192184
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 223.7027, 'hit_ratio@10': 0.2632, 'ndcg@10': 437982006094.2436, 'compress@10': 1.0, 'time@10': 1.8829}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 223.7027, 'hit_ratio@10': 0.2632, 'ndcg@10': 437982006094.2436, 'compress@10': 1.0, 'time@10': 1.8829}:  10%|█         | 1/10 [00:00<00:08,  1.04it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 1058.9355, 'hit_ratio@10': 0.2767, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7416}:  10%|█         | 1/10 [00:02<00:08,  1.04it/s]             {'epoch': 19, 'num_users': 7.0, 'loss': 1058.9355, 'hit_ratio@10': 0.2767, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7416}:  20%|██        | 2/10 [00:02<00:10,  1.35s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 707.819, 'hit_ratio@10': 0.2321, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3545}:  20%|██        | 2/10 [00:02<00:10,  1.35s/it]  {'epoch': 19, 'num_users': 5.0, 'loss': 707.819, 'hit_ratio@10': 0.2321, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3545}:  30%|███       | 3/10 [00:02<00:06,  1.15it/s]{'epoch': 19, 'num_users': 5.0, 'loss': 1052.6098, 'hit_ratio@10': 0.2723, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3526}:  30%|███       | 3/10 [00:04<00:06,  1.15it/s]{'epoch': 19, 'num_users': 5.0, 'loss': 1052.6098, 'hit_ratio@10': 0.2723, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3526}:  40%|████      | 4/10 [00:04<00:06,  1.06s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 901.0948, 'hit_ratio@10': 0.2978, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1414}:  40%|████      | 4/10 [00:06<00:06,  1.06s/it] {'epoch': 19, 'num_users': 5.8, 'loss': 901.0948, 'hit_ratio@10': 0.2978, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1414}:  50%|█████     | 5/10 [00:06<00:08,  1.64s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 890.842, 'hit_ratio@10': 0.3075, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1651}:  50%|█████     | 5/10 [00:09<00:08,  1.64s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 890.842, 'hit_ratio@10': 0.3075, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1651}:  60%|██████    | 6/10 [00:09<00:07,  1.86s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 957.766, 'hit_ratio@10': 0.3035, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2177}:  60%|██████    | 6/10 [00:10<00:07,  1.86s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 957.766, 'hit_ratio@10': 0.3035, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2177}:  70%|███████   | 7/10 [00:10<00:05,  1.67s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 934.6287, 'hit_ratio@10': 0.3192, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1515}:  70%|███████   | 7/10 [00:12<00:05,  1.67s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 934.6287, 'hit_ratio@10': 0.3192, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1515}:  80%|████████  | 8/10 [00:12<00:03,  1.68s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 990.9715, 'hit_ratio@10': 0.3218, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.307}:  80%|████████  | 8/10 [00:13<00:03,  1.68s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 990.9715, 'hit_ratio@10': 0.3218, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.307}:  90%|█████████ | 9/10 [00:13<00:01,  1.72s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 989.4635, 'hit_ratio@10': 0.3055, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2962}:  90%|█████████ | 9/10 [00:16<00:01,  1.72s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 989.4635, 'hit_ratio@10': 0.3055, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2962}: 100%|██████████| 10/10 [00:16<00:00,  1.87s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 989.4635, 'hit_ratio@10': 0.3055, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2962}: 100%|██████████| 10/10 [00:16<00:00,  1.62s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 989.4634706100529
Avg hit ratio: 0.30552697971713255
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.296236991882324
Std train time: 1.2455154088302682
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 1018.4804, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8977}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 1018.4804, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8977}:  10%|█         | 1/10 [00:00<00:08,  1.04it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 2722.72, 'hit_ratio@10': 0.3294, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7112}:  10%|█         | 1/10 [00:02<00:08,  1.04it/s]  {'epoch': 20, 'num_users': 7.0, 'loss': 2722.72, 'hit_ratio@10': 0.3294, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7112}:  20%|██        | 2/10 [00:02<00:10,  1.30s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 1817.4397, 'hit_ratio@10': 0.4101, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3458}:  20%|██        | 2/10 [00:02<00:10,  1.30s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 1817.4397, 'hit_ratio@10': 0.4101, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3458}:  30%|███       | 3/10 [00:02<00:05,  1.17it/s]{'epoch': 20, 'num_users': 5.0, 'loss': 1700.7062, 'hit_ratio@10': 0.3879, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3554}:  30%|███       | 3/10 [00:04<00:05,  1.17it/s]{'epoch': 20, 'num_users': 5.0, 'loss': 1700.7062, 'hit_ratio@10': 0.3879, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3554}:  40%|████      | 4/10 [00:04<00:06,  1.07s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 1428.1212, 'hit_ratio@10': 0.3863, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1215}:  40%|████      | 4/10 [00:06<00:06,  1.07s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 1428.1212, 'hit_ratio@10': 0.3863, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1215}:  50%|█████     | 5/10 [00:06<00:08,  1.62s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 1548.8118, 'hit_ratio@10': 0.3701, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1701}:  50%|█████     | 5/10 [00:09<00:08,  1.62s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 1548.8118, 'hit_ratio@10': 0.3701, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1701}:  60%|██████    | 6/10 [00:09<00:07,  1.90s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 1848.7695, 'hit_ratio@10': 0.3572, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2031}:  60%|██████    | 6/10 [00:10<00:07,  1.90s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 1848.7695, 'hit_ratio@10': 0.3572, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2031}:  70%|███████   | 7/10 [00:10<00:05,  1.68s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 1792.0383, 'hit_ratio@10': 0.3697, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1461}:  70%|███████   | 7/10 [00:12<00:05,  1.68s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 1792.0383, 'hit_ratio@10': 0.3697, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1461}:  80%|████████  | 8/10 [00:12<00:03,  1.70s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 1851.1691, 'hit_ratio@10': 0.3635, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2923}:  80%|████████  | 8/10 [00:13<00:03,  1.70s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 1851.1691, 'hit_ratio@10': 0.3635, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2923}:  90%|█████████ | 9/10 [00:13<00:01,  1.72s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 1712.3333, 'hit_ratio@10': 0.3681, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.288}:  90%|█████████ | 9/10 [00:16<00:01,  1.72s/it]    {'epoch': 20, 'num_users': 6.3, 'loss': 1712.3333, 'hit_ratio@10': 0.3681, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.288}: 100%|██████████| 10/10 [00:16<00:00,  1.89s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 1712.3333, 'hit_ratio@10': 0.3681, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.288}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 1712.3332722933978
Avg hit ratio: 0.3681009145542252
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.2879757642745973
Std train time: 1.2021198585936863
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 3591.5644, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9262}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 3591.5644, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9262}:  10%|█         | 1/10 [00:00<00:08,  1.02it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 5751.0116, 'hit_ratio@10': 0.3353, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7638}:  10%|█         | 1/10 [00:02<00:08,  1.02it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 5751.0116, 'hit_ratio@10': 0.3353, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7638}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 3838.7147, 'hit_ratio@10': 0.2235, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3716}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 3838.7147, 'hit_ratio@10': 0.2235, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3716}:  30%|███       | 3/10 [00:02<00:06,  1.14it/s]{'epoch': 21, 'num_users': 5.0, 'loss': 5535.0955, 'hit_ratio@10': 0.2212, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.369}:  30%|███       | 3/10 [00:04<00:06,  1.14it/s] {'epoch': 21, 'num_users': 5.0, 'loss': 5535.0955, 'hit_ratio@10': 0.2212, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.369}:  40%|████      | 4/10 [00:04<00:06,  1.07s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 4647.1714, 'hit_ratio@10': 0.257, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1407}:  40%|████      | 4/10 [00:06<00:06,  1.07s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 4647.1714, 'hit_ratio@10': 0.257, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1407}:  50%|█████     | 5/10 [00:06<00:08,  1.63s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 4514.548, 'hit_ratio@10': 0.2697, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1767}:  50%|█████     | 5/10 [00:09<00:08,  1.63s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 4514.548, 'hit_ratio@10': 0.2697, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1767}:  60%|██████    | 6/10 [00:09<00:07,  1.89s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 5861.9847, 'hit_ratio@10': 0.2712, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2237}:  60%|██████    | 6/10 [00:10<00:07,  1.89s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 5861.9847, 'hit_ratio@10': 0.2712, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2237}:  70%|███████   | 7/10 [00:10<00:05,  1.68s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 5510.4069, 'hit_ratio@10': 0.2766, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1592}:  70%|███████   | 7/10 [00:12<00:05,  1.68s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 5510.4069, 'hit_ratio@10': 0.2766, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1592}:  80%|████████  | 8/10 [00:12<00:03,  1.70s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 5470.4676, 'hit_ratio@10': 0.2681, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3148}:  80%|████████  | 8/10 [00:14<00:03,  1.70s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 5470.4676, 'hit_ratio@10': 0.2681, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3148}:  90%|█████████ | 9/10 [00:14<00:01,  1.73s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 5505.2744, 'hit_ratio@10': 0.2776, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3033}:  90%|█████████ | 9/10 [00:16<00:01,  1.73s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 5505.2744, 'hit_ratio@10': 0.2776, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3033}: 100%|██████████| 10/10 [00:16<00:00,  1.88s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 5505.2744, 'hit_ratio@10': 0.2776, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3033}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 5505.274359324796
Avg hit ratio: 0.27761693089027556
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.303286051750183
Std train time: 1.2249096209194366
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 6878.8939, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8902}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 6878.8939, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8902}:  10%|█         | 1/10 [00:00<00:08,  1.04it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 6237.4948, 'hit_ratio@10': 0.1655, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7313}:  10%|█         | 1/10 [00:02<00:08,  1.04it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 6237.4948, 'hit_ratio@10': 0.1655, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7313}:  20%|██        | 2/10 [00:02<00:10,  1.33s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 4987.2422, 'hit_ratio@10': 0.1104, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3513}:  20%|██        | 2/10 [00:02<00:10,  1.33s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 4987.2422, 'hit_ratio@10': 0.1104, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3513}:  30%|███       | 3/10 [00:02<00:06,  1.16it/s]{'epoch': 22, 'num_users': 5.0, 'loss': 6782.8439, 'hit_ratio@10': 0.181, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3551}:  30%|███       | 3/10 [00:04<00:06,  1.16it/s] {'epoch': 22, 'num_users': 5.0, 'loss': 6782.8439, 'hit_ratio@10': 0.181, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3551}:  40%|████      | 4/10 [00:04<00:06,  1.07s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 5977.6273, 'hit_ratio@10': 0.2448, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1067}:  40%|████      | 4/10 [00:06<00:06,  1.07s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 5977.6273, 'hit_ratio@10': 0.2448, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1067}:  50%|█████     | 5/10 [00:06<00:08,  1.61s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 6589.3008, 'hit_ratio@10': 0.2447, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1469}:  50%|█████     | 5/10 [00:09<00:08,  1.61s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 6589.3008, 'hit_ratio@10': 0.2447, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1469}:  60%|██████    | 6/10 [00:09<00:07,  1.87s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 7766.6416, 'hit_ratio@10': 0.2383, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1954}:  60%|██████    | 6/10 [00:10<00:07,  1.87s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 7766.6416, 'hit_ratio@10': 0.2383, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1954}:  70%|███████   | 7/10 [00:10<00:05,  1.67s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 8132.9496, 'hit_ratio@10': 0.2371, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.129}:  70%|███████   | 7/10 [00:12<00:05,  1.67s/it]  {'epoch': 22, 'num_users': 6.125, 'loss': 8132.9496, 'hit_ratio@10': 0.2371, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.129}:  80%|████████  | 8/10 [00:12<00:03,  1.67s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 7924.5064, 'hit_ratio@10': 0.2266, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.293}:  80%|████████  | 8/10 [00:13<00:03,  1.67s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 7924.5064, 'hit_ratio@10': 0.2266, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.293}:  90%|█████████ | 9/10 [00:13<00:01,  1.72s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 7735.2806, 'hit_ratio@10': 0.2563, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2827}:  90%|█████████ | 9/10 [00:16<00:01,  1.72s/it]  {'epoch': 22, 'num_users': 6.3, 'loss': 7735.2806, 'hit_ratio@10': 0.2563, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2827}: 100%|██████████| 10/10 [00:16<00:00,  1.87s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 7735.2806, 'hit_ratio@10': 0.2563, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2827}: 100%|██████████| 10/10 [00:16<00:00,  1.61s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 7735.280571542542
Avg hit ratio: 0.25625270409650713
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.2827321529388427
Std train time: 1.206406800472504
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 21648.2963, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8962}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 21648.2963, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8962}:  10%|█         | 1/10 [00:00<00:08,  1.04it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 34664.4548, 'hit_ratio@10': 0.281, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7398}:  10%|█         | 1/10 [00:02<00:08,  1.04it/s] {'epoch': 23, 'num_users': 7.0, 'loss': 34664.4548, 'hit_ratio@10': 0.281, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7398}:  20%|██        | 2/10 [00:02<00:10,  1.34s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 23214.2457, 'hit_ratio@10': 0.3302, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3608}:  20%|██        | 2/10 [00:02<00:10,  1.34s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 23214.2457, 'hit_ratio@10': 0.3302, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3608}:  30%|███       | 3/10 [00:02<00:06,  1.15it/s]{'epoch': 23, 'num_users': 5.0, 'loss': 19420.3695, 'hit_ratio@10': 0.3369, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3843}:  30%|███       | 3/10 [00:04<00:06,  1.15it/s]{'epoch': 23, 'num_users': 5.0, 'loss': 19420.3695, 'hit_ratio@10': 0.3369, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3843}:  40%|████      | 4/10 [00:04<00:06,  1.11s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 17013.3176, 'hit_ratio@10': 0.3735, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1629}:  40%|████      | 4/10 [00:07<00:06,  1.11s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 17013.3176, 'hit_ratio@10': 0.3735, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1629}:  50%|█████     | 5/10 [00:07<00:08,  1.67s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 14337.1764, 'hit_ratio@10': 0.3854, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1899}:  50%|█████     | 5/10 [00:09<00:08,  1.67s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 14337.1764, 'hit_ratio@10': 0.3854, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1899}:  60%|██████    | 6/10 [00:09<00:07,  1.90s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 21466.412, 'hit_ratio@10': 0.376, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2215}:  60%|██████    | 6/10 [00:10<00:07,  1.90s/it]  {'epoch': 23, 'num_users': 6.2857, 'loss': 21466.412, 'hit_ratio@10': 0.376, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2215}:  70%|███████   | 7/10 [00:10<00:05,  1.68s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 20030.7878, 'hit_ratio@10': 0.3683, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1635}:  70%|███████   | 7/10 [00:12<00:05,  1.68s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 20030.7878, 'hit_ratio@10': 0.3683, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1635}:  80%|████████  | 8/10 [00:12<00:03,  1.71s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 18980.8211, 'hit_ratio@10': 0.3496, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3427}:  80%|████████  | 8/10 [00:14<00:03,  1.71s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 18980.8211, 'hit_ratio@10': 0.3496, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3427}:  90%|█████████ | 9/10 [00:14<00:01,  1.77s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 18890.6778, 'hit_ratio@10': 0.3374, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3326}:  90%|█████████ | 9/10 [00:16<00:01,  1.77s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 18890.6778, 'hit_ratio@10': 0.3374, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3326}: 100%|██████████| 10/10 [00:16<00:00,  1.92s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 18890.6778, 'hit_ratio@10': 0.3374, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3326}: 100%|██████████| 10/10 [00:16<00:00,  1.65s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 18890.677833097045
Avg hit ratio: 0.3373686611445525
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.332555365562439
Std train time: 1.2495435902877399
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 87825.3293, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8947}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 87825.3293, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8947}:  10%|█         | 1/10 [00:00<00:08,  1.04it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 46874.6851, 'hit_ratio@10': 0.2929, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.756}:  10%|█         | 1/10 [00:02<00:08,  1.04it/s] {'epoch': 24, 'num_users': 7.0, 'loss': 46874.6851, 'hit_ratio@10': 0.2929, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.756}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 91588.4549, 'hit_ratio@10': 0.1952, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3605}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 91588.4549, 'hit_ratio@10': 0.1952, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3605}:  30%|███       | 3/10 [00:02<00:06,  1.14it/s]{'epoch': 24, 'num_users': 5.0, 'loss': 80974.5823, 'hit_ratio@10': 0.2357, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3566}:  30%|███       | 3/10 [00:04<00:06,  1.14it/s]{'epoch': 24, 'num_users': 5.0, 'loss': 80974.5823, 'hit_ratio@10': 0.2357, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3566}:  40%|████      | 4/10 [00:04<00:06,  1.07s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 69816.443, 'hit_ratio@10': 0.2606, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1445}:  40%|████      | 4/10 [00:06<00:06,  1.07s/it] {'epoch': 24, 'num_users': 5.8, 'loss': 69816.443, 'hit_ratio@10': 0.2606, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1445}:  50%|█████     | 5/10 [00:06<00:08,  1.64s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 59947.2037, 'hit_ratio@10': 0.2616, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1795}:  50%|█████     | 5/10 [00:09<00:08,  1.64s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 59947.2037, 'hit_ratio@10': 0.2616, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1795}:  60%|██████    | 6/10 [00:09<00:07,  1.89s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 56938.4703, 'hit_ratio@10': 0.2756, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2199}:  60%|██████    | 6/10 [00:10<00:07,  1.89s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 56938.4703, 'hit_ratio@10': 0.2756, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2199}:  70%|███████   | 7/10 [00:10<00:05,  1.68s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 54441.858, 'hit_ratio@10': 0.2805, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1625}:  70%|███████   | 7/10 [00:12<00:05,  1.68s/it]  {'epoch': 24, 'num_users': 6.125, 'loss': 54441.858, 'hit_ratio@10': 0.2805, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1625}:  80%|████████  | 8/10 [00:12<00:03,  1.71s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 51352.943, 'hit_ratio@10': 0.2969, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.326}:  80%|████████  | 8/10 [00:14<00:03,  1.71s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 51352.943, 'hit_ratio@10': 0.2969, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.326}:  90%|█████████ | 9/10 [00:14<00:01,  1.82s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 46893.5982, 'hit_ratio@10': 0.2877, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3137}:  90%|█████████ | 9/10 [00:16<00:01,  1.82s/it] {'epoch': 24, 'num_users': 6.3, 'loss': 46893.5982, 'hit_ratio@10': 0.2877, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3137}: 100%|██████████| 10/10 [00:16<00:00,  1.95s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 46893.5982, 'hit_ratio@10': 0.2877, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3137}: 100%|██████████| 10/10 [00:16<00:00,  1.66s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 46893.598206187104
Avg hit ratio: 0.28769506611102535
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.31374077796936
Std train time: 1.2497083698905271
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 1695192.2122, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9488}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 1695192.2122, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9488}:  10%|█         | 1/10 [00:00<00:08,  1.01it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 962871.3455, 'hit_ratio@10': 0.2343, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7733}:  10%|█         | 1/10 [00:02<00:08,  1.01it/s] {'epoch': 25, 'num_users': 7.0, 'loss': 962871.3455, 'hit_ratio@10': 0.2343, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7733}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 642905.8606, 'hit_ratio@10': 0.1562, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3742}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 642905.8606, 'hit_ratio@10': 0.1562, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3742}:  30%|███       | 3/10 [00:02<00:06,  1.14it/s]{'epoch': 25, 'num_users': 5.0, 'loss': 516108.187, 'hit_ratio@10': 0.2243, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3619}:  30%|███       | 3/10 [00:04<00:06,  1.14it/s] {'epoch': 25, 'num_users': 5.0, 'loss': 516108.187, 'hit_ratio@10': 0.2243, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3619}:  40%|████      | 4/10 [00:04<00:06,  1.06s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 422306.938, 'hit_ratio@10': 0.2754, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1479}:  40%|████      | 4/10 [00:06<00:06,  1.06s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 422306.938, 'hit_ratio@10': 0.2754, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1479}:  50%|█████     | 5/10 [00:06<00:08,  1.64s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 358316.7639, 'hit_ratio@10': 0.2925, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1862}:  50%|█████     | 5/10 [00:09<00:08,  1.64s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 358316.7639, 'hit_ratio@10': 0.2925, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1862}:  60%|██████    | 6/10 [00:09<00:07,  1.90s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 347892.3183, 'hit_ratio@10': 0.2907, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2442}:  60%|██████    | 6/10 [00:10<00:07,  1.90s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 347892.3183, 'hit_ratio@10': 0.2907, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2442}:  70%|███████   | 7/10 [00:10<00:05,  1.71s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 338198.5448, 'hit_ratio@10': 0.3044, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1764}:  70%|███████   | 7/10 [00:12<00:05,  1.71s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 338198.5448, 'hit_ratio@10': 0.3044, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1764}:  80%|████████  | 8/10 [00:12<00:03,  1.71s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 310865.9337, 'hit_ratio@10': 0.315, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3287}:  80%|████████  | 8/10 [00:14<00:03,  1.71s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 310865.9337, 'hit_ratio@10': 0.315, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3287}:  90%|█████████ | 9/10 [00:14<00:01,  1.73s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 284865.569, 'hit_ratio@10': 0.3153, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3144}:  90%|█████████ | 9/10 [00:16<00:01,  1.73s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 284865.569, 'hit_ratio@10': 0.3153, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3144}: 100%|██████████| 10/10 [00:16<00:00,  1.88s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 284865.569, 'hit_ratio@10': 0.3153, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3144}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 284865.5690075908
Avg hit ratio: 0.3153121856449531
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.314372158050537
Std train time: 1.245265255091656
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 1071092.2512, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8908}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 1071092.2512, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8908}:  10%|█         | 1/10 [00:00<00:08,  1.04it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 1027617.1893, 'hit_ratio@10': 0.3557, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7239}:  10%|█         | 1/10 [00:02<00:08,  1.04it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 1027617.1893, 'hit_ratio@10': 0.3557, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7239}:  20%|██        | 2/10 [00:02<00:10,  1.32s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 685094.3203, 'hit_ratio@10': 0.2847, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3499}:  20%|██        | 2/10 [00:02<00:10,  1.32s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 685094.3203, 'hit_ratio@10': 0.2847, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3499}:  30%|███       | 3/10 [00:02<00:06,  1.16it/s]{'epoch': 26, 'num_users': 5.0, 'loss': 582498.9611, 'hit_ratio@10': 0.2671, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3474}:  30%|███       | 3/10 [00:04<00:06,  1.16it/s]{'epoch': 26, 'num_users': 5.0, 'loss': 582498.9611, 'hit_ratio@10': 0.2671, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3474}:  40%|████      | 4/10 [00:04<00:06,  1.06s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 505724.2972, 'hit_ratio@10': 0.2657, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1036}:  40%|████      | 4/10 [00:06<00:06,  1.06s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 505724.2972, 'hit_ratio@10': 0.2657, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1036}:  50%|█████     | 5/10 [00:06<00:08,  1.62s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 463245.2427, 'hit_ratio@10': 0.277, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1461}:  50%|█████     | 5/10 [00:09<00:08,  1.62s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 463245.2427, 'hit_ratio@10': 0.277, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1461}:  60%|██████    | 6/10 [00:09<00:07,  1.87s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 468955.8658, 'hit_ratio@10': 0.2831, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1954}:  60%|██████    | 6/10 [00:10<00:07,  1.87s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 468955.8658, 'hit_ratio@10': 0.2831, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1954}:  70%|███████   | 7/10 [00:10<00:05,  1.67s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 454894.9335, 'hit_ratio@10': 0.3013, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1312}:  70%|███████   | 7/10 [00:12<00:05,  1.67s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 454894.9335, 'hit_ratio@10': 0.3013, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1312}:  80%|████████  | 8/10 [00:12<00:03,  1.68s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 521665.9806, 'hit_ratio@10': 0.3059, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2839}:  80%|████████  | 8/10 [00:13<00:03,  1.68s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 521665.9806, 'hit_ratio@10': 0.3059, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2839}:  90%|█████████ | 9/10 [00:13<00:01,  1.71s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 504988.1958, 'hit_ratio@10': 0.3003, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2719}:  90%|█████████ | 9/10 [00:16<00:01,  1.71s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 504988.1958, 'hit_ratio@10': 0.3003, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2719}: 100%|██████████| 10/10 [00:16<00:00,  1.91s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 504988.1958, 'hit_ratio@10': 0.3003, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2719}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 504988.19579208933
Avg hit ratio: 0.30032799741288707
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.271947741508484
Std train time: 1.2004280537776375
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 892557.1283, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0004}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 892557.1283, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0004}:  10%|█         | 1/10 [00:01<00:09,  1.02s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 1694025.1297, 'hit_ratio@10': 0.2666, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7903}:  10%|█         | 1/10 [00:02<00:09,  1.02s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 1694025.1297, 'hit_ratio@10': 0.2666, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7903}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 1130235.8391, 'hit_ratio@10': 0.1777, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3819}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 1130235.8391, 'hit_ratio@10': 0.1777, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3819}:  30%|███       | 3/10 [00:02<00:06,  1.14it/s]{'epoch': 27, 'num_users': 5.0, 'loss': 2122991.4876, 'hit_ratio@10': 0.2136, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3812}:  30%|███       | 3/10 [00:04<00:06,  1.14it/s]{'epoch': 27, 'num_users': 5.0, 'loss': 2122991.4876, 'hit_ratio@10': 0.2136, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3812}:  40%|████      | 4/10 [00:04<00:06,  1.08s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 1874496.1232, 'hit_ratio@10': 0.2349, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1362}:  40%|████      | 4/10 [00:06<00:06,  1.08s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 1874496.1232, 'hit_ratio@10': 0.2349, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1362}:  50%|█████     | 5/10 [00:06<00:08,  1.63s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 1755709.1925, 'hit_ratio@10': 0.255, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1735}:  50%|█████     | 5/10 [00:09<00:08,  1.63s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 1755709.1925, 'hit_ratio@10': 0.255, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1735}:  60%|██████    | 6/10 [00:09<00:07,  1.88s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 3243791.9822, 'hit_ratio@10': 0.2529, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2108}:  60%|██████    | 6/10 [00:10<00:07,  1.88s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 3243791.9822, 'hit_ratio@10': 0.2529, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2108}:  70%|███████   | 7/10 [00:10<00:05,  1.67s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 3027324.9157, 'hit_ratio@10': 0.2427, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1528}:  70%|███████   | 7/10 [00:12<00:05,  1.67s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 3027324.9157, 'hit_ratio@10': 0.2427, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1528}:  80%|████████  | 8/10 [00:12<00:03,  1.70s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 2829430.382, 'hit_ratio@10': 0.2506, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3185}:  80%|████████  | 8/10 [00:14<00:03,  1.70s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 2829430.382, 'hit_ratio@10': 0.2506, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3185}:  90%|█████████ | 9/10 [00:14<00:01,  1.74s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 2683951.4441, 'hit_ratio@10': 0.2665, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3073}:  90%|█████████ | 9/10 [00:16<00:01,  1.74s/it]  {'epoch': 27, 'num_users': 6.3, 'loss': 2683951.4441, 'hit_ratio@10': 0.2665, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3073}: 100%|██████████| 10/10 [00:16<00:00,  1.89s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 2683951.4441, 'hit_ratio@10': 0.2665, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3073}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 2683951.4441133356
Avg hit ratio: 0.26648962827400857
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.3073288202285767
Std train time: 1.2150881386518306
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 72514138.9474, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8745}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 72514138.9474, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8745}:  10%|█         | 1/10 [00:00<00:08,  1.05it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 37752746.9152, 'hit_ratio@10': 0.2767, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7293}:  10%|█         | 1/10 [00:02<00:08,  1.05it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 37752746.9152, 'hit_ratio@10': 0.2767, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7293}:  20%|██        | 2/10 [00:02<00:10,  1.33s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 32776397.4911, 'hit_ratio@10': 0.2321, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.347}:  20%|██        | 2/10 [00:02<00:10,  1.33s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 32776397.4911, 'hit_ratio@10': 0.2321, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.347}:  30%|███       | 3/10 [00:02<00:06,  1.16it/s]{'epoch': 28, 'num_users': 5.0, 'loss': 28429888.6451, 'hit_ratio@10': 0.2455, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3352}:  30%|███       | 3/10 [00:04<00:06,  1.16it/s]{'epoch': 28, 'num_users': 5.0, 'loss': 28429888.6451, 'hit_ratio@10': 0.2455, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3352}:  40%|████      | 4/10 [00:04<00:06,  1.04s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 23504475.4461, 'hit_ratio@10': 0.2244, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1206}:  40%|████      | 4/10 [00:06<00:06,  1.04s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 23504475.4461, 'hit_ratio@10': 0.2244, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1206}:  50%|█████     | 5/10 [00:06<00:08,  1.62s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 19941382.1678, 'hit_ratio@10': 0.2463, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1534}:  50%|█████     | 5/10 [00:09<00:08,  1.62s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 19941382.1678, 'hit_ratio@10': 0.2463, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1534}:  60%|██████    | 6/10 [00:09<00:07,  1.86s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 24796888.4467, 'hit_ratio@10': 0.2568, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2108}:  60%|██████    | 6/10 [00:10<00:07,  1.86s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 24796888.4467, 'hit_ratio@10': 0.2568, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2108}:  70%|███████   | 7/10 [00:10<00:05,  1.68s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 22774096.8632, 'hit_ratio@10': 0.264, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1496}:  70%|███████   | 7/10 [00:12<00:05,  1.68s/it]  {'epoch': 28, 'num_users': 6.125, 'loss': 22774096.8632, 'hit_ratio@10': 0.264, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1496}:  80%|████████  | 8/10 [00:12<00:03,  1.70s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 21316893.1171, 'hit_ratio@10': 0.2696, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3067}:  80%|████████  | 8/10 [00:13<00:03,  1.70s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 21316893.1171, 'hit_ratio@10': 0.2696, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3067}:  90%|█████████ | 9/10 [00:13<00:01,  1.73s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 19568201.0054, 'hit_ratio@10': 0.2608, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2927}:  90%|█████████ | 9/10 [00:16<00:01,  1.73s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 19568201.0054, 'hit_ratio@10': 0.2608, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2927}: 100%|██████████| 10/10 [00:16<00:00,  1.87s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 19568201.0054, 'hit_ratio@10': 0.2608, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2927}: 100%|██████████| 10/10 [00:16<00:00,  1.62s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 19568201.005360752
Avg hit ratio: 0.2607997069898597
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.2927490949630736
Std train time: 1.2424055153620779
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 146329420.7368, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9401}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 146329420.7368, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9401}:  10%|█         | 1/10 [00:00<00:08,  1.01it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 128637146.0942, 'hit_ratio@10': 0.3353, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7415}:  10%|█         | 1/10 [00:02<00:08,  1.01it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 128637146.0942, 'hit_ratio@10': 0.3353, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7415}:  20%|██        | 2/10 [00:02<00:10,  1.32s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 85765463.6047, 'hit_ratio@10': 0.3664, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3538}:  20%|██        | 2/10 [00:02<00:10,  1.32s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 85765463.6047, 'hit_ratio@10': 0.3664, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3538}:  30%|███       | 3/10 [00:02<00:06,  1.17it/s]{'epoch': 29, 'num_users': 5.0, 'loss': 70147220.8731, 'hit_ratio@10': 0.3552, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3554}:  30%|███       | 3/10 [00:04<00:06,  1.17it/s]{'epoch': 29, 'num_users': 5.0, 'loss': 70147220.8731, 'hit_ratio@10': 0.3552, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3554}:  40%|████      | 4/10 [00:04<00:06,  1.06s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 59611629.7435, 'hit_ratio@10': 0.3521, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1805}:  40%|████      | 4/10 [00:06<00:06,  1.06s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 59611629.7435, 'hit_ratio@10': 0.3521, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1805}:  50%|█████     | 5/10 [00:06<00:08,  1.67s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 51711694.8002, 'hit_ratio@10': 0.3305, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1991}:  50%|█████     | 5/10 [00:09<00:08,  1.67s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 51711694.8002, 'hit_ratio@10': 0.3305, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1991}:  60%|██████    | 6/10 [00:09<00:07,  1.89s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 47498597.3674, 'hit_ratio@10': 0.3233, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2412}:  60%|██████    | 6/10 [00:10<00:07,  1.89s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 47498597.3674, 'hit_ratio@10': 0.3233, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2412}:  70%|███████   | 7/10 [00:10<00:05,  1.68s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 43189049.5313, 'hit_ratio@10': 0.3186, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1729}:  70%|███████   | 7/10 [00:12<00:05,  1.68s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 43189049.5313, 'hit_ratio@10': 0.3186, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1729}:  80%|████████  | 8/10 [00:12<00:03,  1.69s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 44237781.0468, 'hit_ratio@10': 0.3086, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3302}:  80%|████████  | 8/10 [00:14<00:03,  1.69s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 44237781.0468, 'hit_ratio@10': 0.3086, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3302}:  90%|█████████ | 9/10 [00:14<00:01,  1.73s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 43103259.1399, 'hit_ratio@10': 0.3073, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3151}:  90%|█████████ | 9/10 [00:16<00:01,  1.73s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 43103259.1399, 'hit_ratio@10': 0.3073, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3151}: 100%|██████████| 10/10 [00:16<00:00,  1.87s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 43103259.1399, 'hit_ratio@10': 0.3073, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3151}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 43103259.13988155
Avg hit ratio: 0.3072590665324112
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.3151457786560057
Std train time: 1.294108827815227
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 104311614.5, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.009}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 104311614.5, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.009}:  10%|█         | 1/10 [00:01<00:09,  1.02s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 65065235.5565, 'hit_ratio@10': 0.2708, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8028}:  10%|█         | 1/10 [00:02<00:09,  1.02s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 65065235.5565, 'hit_ratio@10': 0.2708, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8028}:  20%|██        | 2/10 [00:02<00:10,  1.37s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 43376906.4652, 'hit_ratio@10': 0.2282, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3965}:  20%|██        | 2/10 [00:02<00:10,  1.37s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 43376906.4652, 'hit_ratio@10': 0.2282, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3965}:  30%|███       | 3/10 [00:02<00:06,  1.13it/s]{'epoch': 30, 'num_users': 5.0, 'loss': 39237169.84, 'hit_ratio@10': 0.2425, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3695}:  30%|███       | 3/10 [00:04<00:06,  1.13it/s]  {'epoch': 30, 'num_users': 5.0, 'loss': 39237169.84, 'hit_ratio@10': 0.2425, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3695}:  40%|████      | 4/10 [00:04<00:06,  1.05s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 41935397.024, 'hit_ratio@10': 0.258, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1599}:  40%|████      | 4/10 [00:06<00:06,  1.05s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 41935397.024, 'hit_ratio@10': 0.258, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1599}:  50%|█████     | 5/10 [00:06<00:08,  1.64s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 37845360.0441, 'hit_ratio@10': 0.278, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1912}:  50%|█████     | 5/10 [00:09<00:08,  1.64s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 37845360.0441, 'hit_ratio@10': 0.278, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1912}:  60%|██████    | 6/10 [00:09<00:07,  1.88s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 33179335.1719, 'hit_ratio@10': 0.2954, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2432}:  60%|██████    | 6/10 [00:10<00:07,  1.88s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 33179335.1719, 'hit_ratio@10': 0.2954, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2432}:  70%|███████   | 7/10 [00:10<00:05,  1.69s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 30559609.0432, 'hit_ratio@10': 0.2799, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1788}:  70%|███████   | 7/10 [00:12<00:05,  1.69s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 30559609.0432, 'hit_ratio@10': 0.2799, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1788}:  80%|████████  | 8/10 [00:12<00:03,  1.71s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 34541959.7435, 'hit_ratio@10': 0.271, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3345}:  80%|████████  | 8/10 [00:14<00:03,  1.71s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 34541959.7435, 'hit_ratio@10': 0.271, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3345}:  90%|█████████ | 9/10 [00:14<00:01,  1.74s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 33046943.9635, 'hit_ratio@10': 0.2712, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3198}:  90%|█████████ | 9/10 [00:16<00:01,  1.74s/it]  {'epoch': 30, 'num_users': 6.3, 'loss': 33046943.9635, 'hit_ratio@10': 0.2712, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3198}: 100%|██████████| 10/10 [00:16<00:00,  1.88s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 33046943.9635, 'hit_ratio@10': 0.2712, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3198}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 33046943.963507485
Avg hit ratio: 0.2712100975802164
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.3198045015335085
Std train time: 1.253752061443213
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 892617265.2336, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8767}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 892617265.2336, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8767}:  10%|█         | 1/10 [00:00<00:08,  1.05it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 888084133.2619, 'hit_ratio@10': 0.2182, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7154}:  10%|█         | 1/10 [00:02<00:08,  1.05it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 888084133.2619, 'hit_ratio@10': 0.2182, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7154}:  20%|██        | 2/10 [00:02<00:10,  1.32s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 593211241.6508, 'hit_ratio@10': 0.1931, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3374}:  20%|██        | 2/10 [00:02<00:10,  1.32s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 593211241.6508, 'hit_ratio@10': 0.1931, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3374}:  30%|███       | 3/10 [00:02<00:05,  1.17it/s]{'epoch': 31, 'num_users': 5.0, 'loss': 509959468.2381, 'hit_ratio@10': 0.2162, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3398}:  30%|███       | 3/10 [00:04<00:05,  1.17it/s]{'epoch': 31, 'num_users': 5.0, 'loss': 509959468.2381, 'hit_ratio@10': 0.2162, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3398}:  40%|████      | 4/10 [00:04<00:06,  1.05s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 436813403.123, 'hit_ratio@10': 0.273, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1244}:  40%|████      | 4/10 [00:06<00:06,  1.05s/it]  {'epoch': 31, 'num_users': 5.8, 'loss': 436813403.123, 'hit_ratio@10': 0.273, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1244}:  50%|█████     | 5/10 [00:06<00:08,  1.63s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 418889253.9358, 'hit_ratio@10': 0.2682, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1538}:  50%|█████     | 5/10 [00:09<00:08,  1.63s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 418889253.9358, 'hit_ratio@10': 0.2682, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1538}:  60%|██████    | 6/10 [00:09<00:07,  1.86s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 936123086.9621, 'hit_ratio@10': 0.2642, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1801}:  60%|██████    | 6/10 [00:10<00:07,  1.86s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 936123086.9621, 'hit_ratio@10': 0.2642, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1801}:  70%|███████   | 7/10 [00:10<00:04,  1.64s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 995335160.2919, 'hit_ratio@10': 0.2633, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1312}:  70%|███████   | 7/10 [00:12<00:04,  1.64s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 995335160.2919, 'hit_ratio@10': 0.2633, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1312}:  80%|████████  | 8/10 [00:12<00:03,  1.69s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 988422057.6531, 'hit_ratio@10': 0.2753, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3034}:  80%|████████  | 8/10 [00:14<00:03,  1.69s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 988422057.6531, 'hit_ratio@10': 0.2753, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3034}:  90%|█████████ | 9/10 [00:14<00:01,  1.75s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 904579906.7423, 'hit_ratio@10': 0.2978, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2935}:  90%|█████████ | 9/10 [00:16<00:01,  1.75s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 904579906.7423, 'hit_ratio@10': 0.2978, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2935}: 100%|██████████| 10/10 [00:16<00:00,  1.89s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 904579906.7423, 'hit_ratio@10': 0.2978, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2935}: 100%|██████████| 10/10 [00:16<00:00,  1.62s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 904579906.7423258
Avg hit ratio: 0.29779200689896784
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.2934602022171022
Std train time: 1.247124481529098
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 1821429734.7368, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9391}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 1821429734.7368, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9391}:  10%|█         | 1/10 [00:00<00:08,  1.01it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 1096147007.1104, 'hit_ratio@10': 0.3879, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7457}:  10%|█         | 1/10 [00:02<00:08,  1.01it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 1096147007.1104, 'hit_ratio@10': 0.3879, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7457}:  20%|██        | 2/10 [00:02<00:10,  1.33s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 850597793.6926, 'hit_ratio@10': 0.2586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3544}:  20%|██        | 2/10 [00:02<00:10,  1.33s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 850597793.6926, 'hit_ratio@10': 0.2586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3544}:  30%|███       | 3/10 [00:02<00:06,  1.16it/s]{'epoch': 32, 'num_users': 5.0, 'loss': 1046652202.4123, 'hit_ratio@10': 0.2743, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3637}:  30%|███       | 3/10 [00:04<00:06,  1.16it/s]{'epoch': 32, 'num_users': 5.0, 'loss': 1046652202.4123, 'hit_ratio@10': 0.2743, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3637}:  40%|████      | 4/10 [00:04<00:06,  1.08s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 1142602421.1299, 'hit_ratio@10': 0.2835, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.183}:  40%|████      | 4/10 [00:07<00:06,  1.08s/it] {'epoch': 32, 'num_users': 5.8, 'loss': 1142602421.1299, 'hit_ratio@10': 0.2835, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.183}:  50%|█████     | 5/10 [00:07<00:08,  1.68s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 962218095.6619, 'hit_ratio@10': 0.2881, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2053}:  50%|█████     | 5/10 [00:09<00:08,  1.68s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 962218095.6619, 'hit_ratio@10': 0.2881, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2053}:  60%|██████    | 6/10 [00:09<00:07,  1.90s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 1157341605.0131, 'hit_ratio@10': 0.2755, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2512}:  60%|██████    | 6/10 [00:10<00:07,  1.90s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 1157341605.0131, 'hit_ratio@10': 0.2755, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2512}:  70%|███████   | 7/10 [00:10<00:05,  1.70s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 1306154296.615, 'hit_ratio@10': 0.2732, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1841}:  70%|███████   | 7/10 [00:12<00:05,  1.70s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 1306154296.615, 'hit_ratio@10': 0.2732, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1841}:  80%|████████  | 8/10 [00:12<00:03,  1.71s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 2741648678.134, 'hit_ratio@10': 0.2873, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3346}:  80%|████████  | 8/10 [00:14<00:03,  1.71s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 2741648678.134, 'hit_ratio@10': 0.2873, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3346}:  90%|█████████ | 9/10 [00:14<00:01,  1.73s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 2656793649.1569, 'hit_ratio@10': 0.2926, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3291}:  90%|█████████ | 9/10 [00:16<00:01,  1.73s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 2656793649.1569, 'hit_ratio@10': 0.2926, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3291}: 100%|██████████| 10/10 [00:16<00:00,  1.91s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 2656793649.1569, 'hit_ratio@10': 0.2926, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3291}: 100%|██████████| 10/10 [00:16<00:00,  1.65s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 2656793649.1569433
Avg hit ratio: 0.29264829718479973
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.3290557146072386
Std train time: 1.2808691116576831
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 47365082624.0, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8885}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 47365082624.0, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8885}:  10%|█         | 1/10 [00:00<00:08,  1.04it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 30453433257.2903, 'hit_ratio@10': 0.3718, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7237}:  10%|█         | 1/10 [00:02<00:08,  1.04it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 30453433257.2903, 'hit_ratio@10': 0.3718, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7237}:  20%|██        | 2/10 [00:02<00:10,  1.32s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 20302448821.393, 'hit_ratio@10': 0.3431, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3401}:  20%|██        | 2/10 [00:02<00:10,  1.32s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 20302448821.393, 'hit_ratio@10': 0.3431, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3401}:  30%|███       | 3/10 [00:02<00:05,  1.17it/s]{'epoch': 33, 'num_users': 5.0, 'loss': 16417902850.3304, 'hit_ratio@10': 0.3466, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3491}:  30%|███       | 3/10 [00:04<00:05,  1.17it/s]{'epoch': 33, 'num_users': 5.0, 'loss': 16417902850.3304, 'hit_ratio@10': 0.3466, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3491}:  40%|████      | 4/10 [00:04<00:06,  1.07s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 13143637560.8828, 'hit_ratio@10': 0.3533, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1178}:  40%|████      | 4/10 [00:06<00:06,  1.07s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 13143637560.8828, 'hit_ratio@10': 0.3533, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1178}:  50%|█████     | 5/10 [00:06<00:08,  1.63s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 11757506479.8764, 'hit_ratio@10': 0.35, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1482}:  50%|█████     | 5/10 [00:09<00:08,  1.63s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 11757506479.8764, 'hit_ratio@10': 0.35, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1482}:  60%|██████    | 6/10 [00:09<00:07,  1.86s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 11480080505.1284, 'hit_ratio@10': 0.3514, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.204}:  60%|██████    | 6/10 [00:10<00:07,  1.86s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 11480080505.1284, 'hit_ratio@10': 0.3514, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.204}:  70%|███████   | 7/10 [00:10<00:05,  1.67s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 10415103493.6445, 'hit_ratio@10': 0.3289, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1448}:  70%|███████   | 7/10 [00:12<00:05,  1.67s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 10415103493.6445, 'hit_ratio@10': 0.3289, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1448}:  80%|████████  | 8/10 [00:12<00:03,  1.70s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 10556128355.0872, 'hit_ratio@10': 0.3019, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3076}:  80%|████████  | 8/10 [00:14<00:03,  1.70s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 10556128355.0872, 'hit_ratio@10': 0.3019, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3076}:  90%|█████████ | 9/10 [00:14<00:01,  1.73s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 9776336054.9966, 'hit_ratio@10': 0.299, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.298}:  90%|█████████ | 9/10 [00:16<00:01,  1.73s/it]      {'epoch': 33, 'num_users': 6.3, 'loss': 9776336054.9966, 'hit_ratio@10': 0.299, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.298}: 100%|██████████| 10/10 [00:16<00:00,  1.89s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 9776336054.9966, 'hit_ratio@10': 0.299, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.298}: 100%|██████████| 10/10 [00:16<00:00,  1.62s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 9776336054.99662
Avg hit ratio: 0.2989693882800844
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.298040246963501
Std train time: 1.2257412042258058
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 252914361.9474, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9542}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 252914361.9474, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9542}:  10%|█         | 1/10 [00:00<00:08,  1.00it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 4026468100.1995, 'hit_ratio@10': 0.3234, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7525}:  10%|█         | 1/10 [00:02<00:08,  1.00it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 4026468100.1995, 'hit_ratio@10': 0.3234, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7525}:  20%|██        | 2/10 [00:02<00:10,  1.33s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 2684330592.7173, 'hit_ratio@10': 0.3585, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3443}:  20%|██        | 2/10 [00:02<00:10,  1.33s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 2684330592.7173, 'hit_ratio@10': 0.3585, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3443}:  30%|███       | 3/10 [00:02<00:05,  1.18it/s]{'epoch': 34, 'num_users': 5.0, 'loss': 13269948675.9665, 'hit_ratio@10': 0.3492, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3584}:  30%|███       | 3/10 [00:04<00:05,  1.18it/s]{'epoch': 34, 'num_users': 5.0, 'loss': 13269948675.9665, 'hit_ratio@10': 0.3492, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3584}:  40%|████      | 4/10 [00:04<00:06,  1.07s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 15458163379.3012, 'hit_ratio@10': 0.3394, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1735}:  40%|████      | 4/10 [00:06<00:06,  1.07s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 15458163379.3012, 'hit_ratio@10': 0.3394, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1735}:  50%|█████     | 5/10 [00:06<00:08,  1.67s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 13755167498.4695, 'hit_ratio@10': 0.3384, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2064}:  50%|█████     | 5/10 [00:09<00:08,  1.67s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 13755167498.4695, 'hit_ratio@10': 0.3384, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2064}:  60%|██████    | 6/10 [00:09<00:07,  1.92s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 12026984865.6596, 'hit_ratio@10': 0.3415, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2604}:  60%|██████    | 6/10 [00:10<00:07,  1.92s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 12026984865.6596, 'hit_ratio@10': 0.3415, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2604}:  70%|███████   | 7/10 [00:10<00:05,  1.72s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 10823262015.4843, 'hit_ratio@10': 0.3345, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1995}:  70%|███████   | 7/10 [00:12<00:05,  1.72s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 10823262015.4843, 'hit_ratio@10': 0.3345, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1995}:  80%|████████  | 8/10 [00:12<00:03,  1.74s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 13991959598.0686, 'hit_ratio@10': 0.3291, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3564}:  80%|████████  | 8/10 [00:14<00:03,  1.74s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 13991959598.0686, 'hit_ratio@10': 0.3291, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3564}:  90%|█████████ | 9/10 [00:14<00:01,  1.77s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 13197031870.4322, 'hit_ratio@10': 0.3189, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3401}:  90%|█████████ | 9/10 [00:16<00:01,  1.77s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 13197031870.4322, 'hit_ratio@10': 0.3189, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3401}: 100%|██████████| 10/10 [00:16<00:00,  1.90s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 13197031870.4322, 'hit_ratio@10': 0.3189, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3401}: 100%|██████████| 10/10 [00:16<00:00,  1.65s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 13197031870.43217
Avg hit ratio: 0.31888937152264824
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.3401452541351317
Std train time: 1.2855852503889047
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 101869792579.3684, 'hit_ratio@10': 0.5263, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8705}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 101869792579.3684, 'hit_ratio@10': 0.5263, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8705}:  10%|█         | 1/10 [00:00<00:08,  1.05it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 125381917543.8777, 'hit_ratio@10': 0.3599, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7498}:  10%|█         | 1/10 [00:02<00:08,  1.05it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 125381917543.8777, 'hit_ratio@10': 0.3599, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7498}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 83659748530.3947, 'hit_ratio@10': 0.24, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3585}:  20%|██        | 2/10 [00:02<00:10,  1.36s/it]   {'epoch': 35, 'num_users': 5.0, 'loss': 83659748530.3947, 'hit_ratio@10': 0.24, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3585}:  30%|███       | 3/10 [00:02<00:06,  1.14it/s]{'epoch': 35, 'num_users': 5.0, 'loss': 68782985221.796, 'hit_ratio@10': 0.2514, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3616}:  30%|███       | 3/10 [00:04<00:06,  1.14it/s]{'epoch': 35, 'num_users': 5.0, 'loss': 68782985221.796, 'hit_ratio@10': 0.2514, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3616}:  40%|████      | 4/10 [00:04<00:06,  1.08s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 62268698524.1888, 'hit_ratio@10': 0.2731, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1306}:  40%|████      | 4/10 [00:06<00:06,  1.08s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 62268698524.1888, 'hit_ratio@10': 0.2731, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1306}:  50%|█████     | 5/10 [00:06<00:08,  1.64s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 74742462077.4166, 'hit_ratio@10': 0.2757, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1483}:  50%|█████     | 5/10 [00:09<00:08,  1.64s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 74742462077.4166, 'hit_ratio@10': 0.2757, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1483}:  60%|██████    | 6/10 [00:09<00:07,  1.85s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 134228110466.9057, 'hit_ratio@10': 0.2764, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2061}:  60%|██████    | 6/10 [00:10<00:07,  1.85s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 134228110466.9057, 'hit_ratio@10': 0.2764, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2061}:  70%|███████   | 7/10 [00:10<00:04,  1.66s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 149064285602.0853, 'hit_ratio@10': 0.2668, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1467}:  70%|███████   | 7/10 [00:12<00:04,  1.66s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 149064285602.0853, 'hit_ratio@10': 0.2668, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1467}:  80%|████████  | 8/10 [00:12<00:03,  1.69s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 155136262641.1933, 'hit_ratio@10': 0.2594, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3053}:  80%|████████  | 8/10 [00:14<00:03,  1.69s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 155136262641.1933, 'hit_ratio@10': 0.2594, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3053}:  90%|█████████ | 9/10 [00:14<00:01,  1.73s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 154535144737.2194, 'hit_ratio@10': 0.2471, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2993}:  90%|█████████ | 9/10 [00:16<00:01,  1.73s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 154535144737.2194, 'hit_ratio@10': 0.2471, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2993}: 100%|██████████| 10/10 [00:16<00:00,  1.89s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 154535144737.2194, 'hit_ratio@10': 0.2471, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2993}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 154535144737.21942
Avg hit ratio: 0.24708309875372697
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.299265742301941
Std train time: 1.2222099175160044
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 381643711973.0526, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.951}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 381643711973.0526, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.951}:  10%|█         | 1/10 [00:00<00:08,  1.01it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 551152473082.7844, 'hit_ratio@10': 0.2547, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.76}:  10%|█         | 1/10 [00:02<00:08,  1.01it/s] {'epoch': 36, 'num_users': 7.0, 'loss': 551152473082.7844, 'hit_ratio@10': 0.2547, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.76}:  20%|██        | 2/10 [00:02<00:10,  1.34s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 409898248383.5706, 'hit_ratio@10': 0.2174, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3625}:  20%|██        | 2/10 [00:02<00:10,  1.34s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 409898248383.5706, 'hit_ratio@10': 0.2174, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3625}:  30%|███       | 3/10 [00:02<00:06,  1.16it/s]{'epoch': 36, 'num_users': 5.0, 'loss': 414318749912.8208, 'hit_ratio@10': 0.2613, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3666}:  30%|███       | 3/10 [00:04<00:06,  1.16it/s]{'epoch': 36, 'num_users': 5.0, 'loss': 414318749912.8208, 'hit_ratio@10': 0.2613, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3666}:  40%|████      | 4/10 [00:04<00:06,  1.07s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 332016352721.4886, 'hit_ratio@10': 0.313, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1309}:  40%|████      | 4/10 [00:06<00:06,  1.07s/it] {'epoch': 36, 'num_users': 5.8, 'loss': 332016352721.4886, 'hit_ratio@10': 0.313, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1309}:  50%|█████     | 5/10 [00:06<00:08,  1.63s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 292774300183.8183, 'hit_ratio@10': 0.3275, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1617}:  50%|█████     | 5/10 [00:09<00:08,  1.63s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 292774300183.8183, 'hit_ratio@10': 0.3275, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1617}:  60%|██████    | 6/10 [00:09<00:07,  1.87s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 418161781417.6271, 'hit_ratio@10': 0.3264, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2042}:  60%|██████    | 6/10 [00:10<00:07,  1.87s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 418161781417.6271, 'hit_ratio@10': 0.3264, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2042}:  70%|███████   | 7/10 [00:10<00:04,  1.66s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 378829005619.5094, 'hit_ratio@10': 0.3249, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1501}:  70%|███████   | 7/10 [00:12<00:04,  1.66s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 378829005619.5094, 'hit_ratio@10': 0.3249, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1501}:  80%|████████  | 8/10 [00:12<00:03,  1.70s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 467767943038.2433, 'hit_ratio@10': 0.3079, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3001}:  80%|████████  | 8/10 [00:14<00:03,  1.70s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 467767943038.2433, 'hit_ratio@10': 0.3079, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3001}:  90%|█████████ | 9/10 [00:14<00:01,  1.72s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 422034225542.9598, 'hit_ratio@10': 0.3157, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2937}:  90%|█████████ | 9/10 [00:16<00:01,  1.72s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 422034225542.9598, 'hit_ratio@10': 0.3157, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2937}: 100%|██████████| 10/10 [00:16<00:00,  1.89s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 422034225542.9598, 'hit_ratio@10': 0.3157, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2937}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 422034225542.9599
Avg hit ratio: 0.3157130068573192
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.2936660766601564
Std train time: 1.2080424686031328
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 2999276401286.737, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9694}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 2999276401286.737, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9694}:  10%|█         | 1/10 [00:00<00:08,  1.00it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 1632059752953.046, 'hit_ratio@10': 0.3616, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7728}:  10%|█         | 1/10 [00:02<00:08,  1.00it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 1632059752953.046, 'hit_ratio@10': 0.3616, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7728}:  20%|██        | 2/10 [00:02<00:10,  1.35s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 1088059615330.602, 'hit_ratio@10': 0.3839, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3581}:  20%|██        | 2/10 [00:02<00:10,  1.35s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 1088059615330.602, 'hit_ratio@10': 0.3839, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3581}:  30%|███       | 3/10 [00:02<00:06,  1.16it/s]{'epoch': 37, 'num_users': 5.0, 'loss': 1124624302812.2373, 'hit_ratio@10': 0.3594, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3352}:  30%|███       | 3/10 [00:04<00:06,  1.16it/s]{'epoch': 37, 'num_users': 5.0, 'loss': 1124624302812.2373, 'hit_ratio@10': 0.3594, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3352}:  40%|████      | 4/10 [00:04<00:06,  1.03s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 1020282181120.0619, 'hit_ratio@10': 0.3715, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1432}:  40%|████      | 4/10 [00:06<00:06,  1.03s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 1020282181120.0619, 'hit_ratio@10': 0.3715, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1432}:  50%|█████     | 5/10 [00:06<00:08,  1.64s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 970345755949.5626, 'hit_ratio@10': 0.3503, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1835}:  50%|█████     | 5/10 [00:10<00:08,  1.64s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 970345755949.5626, 'hit_ratio@10': 0.3503, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1835}:  60%|██████    | 6/10 [00:10<00:08,  2.16s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 1041334822187.4423, 'hit_ratio@10': 0.3574, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2526}:  60%|██████    | 6/10 [00:11<00:08,  2.16s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 1041334822187.4423, 'hit_ratio@10': 0.3574, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2526}:  70%|███████   | 7/10 [00:11<00:05,  1.89s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 947412923065.3834, 'hit_ratio@10': 0.3556, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1928}:  70%|███████   | 7/10 [00:13<00:05,  1.89s/it]  {'epoch': 37, 'num_users': 6.125, 'loss': 947412923065.3834, 'hit_ratio@10': 0.3556, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1928}:  80%|████████  | 8/10 [00:13<00:03,  1.86s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 972250209389.5219, 'hit_ratio@10': 0.3415, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3466}:  80%|████████  | 8/10 [00:14<00:03,  1.86s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 972250209389.5219, 'hit_ratio@10': 0.3415, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3466}:  90%|█████████ | 9/10 [00:14<00:01,  1.84s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 1002351985083.0061, 'hit_ratio@10': 0.3573, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3339}:  90%|█████████ | 9/10 [00:17<00:01,  1.84s/it]  {'epoch': 37, 'num_users': 6.3, 'loss': 1002351985083.0061, 'hit_ratio@10': 0.3573, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3339}: 100%|██████████| 10/10 [00:17<00:00,  1.96s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 1002351985083.0061, 'hit_ratio@10': 0.3573, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3339}: 100%|██████████| 10/10 [00:17<00:00,  1.72s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 1002351985083.0061
Avg hit ratio: 0.3573418492467728
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.3339106798172
Std train time: 1.2783235746146047
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 851899878885.0526, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9221}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 851899878885.0526, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9221}:  10%|█         | 1/10 [00:00<00:08,  1.02it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 3689192166758.139, 'hit_ratio@10': 0.3879, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7485}:  10%|█         | 1/10 [00:02<00:08,  1.02it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 3689192166758.139, 'hit_ratio@10': 0.3879, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7485}:  20%|██        | 2/10 [00:02<00:10,  1.34s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 2459471655193.4263, 'hit_ratio@10': 0.4491, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3596}:  20%|██        | 2/10 [00:02<00:10,  1.34s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 2459471655193.4263, 'hit_ratio@10': 0.4491, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3596}:  30%|███       | 3/10 [00:02<00:06,  1.15it/s]{'epoch': 38, 'num_users': 5.0, 'loss': 2466317987904.7837, 'hit_ratio@10': 0.444, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.361}:  30%|███       | 3/10 [00:04<00:06,  1.15it/s]  {'epoch': 38, 'num_users': 5.0, 'loss': 2466317987904.7837, 'hit_ratio@10': 0.444, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.361}:  40%|████      | 4/10 [00:04<00:06,  1.08s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 1973073724174.9949, 'hit_ratio@10': 0.4192, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1236}:  40%|████      | 4/10 [00:06<00:06,  1.08s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 1973073724174.9949, 'hit_ratio@10': 0.4192, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1236}:  50%|█████     | 5/10 [00:06<00:08,  1.63s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 2186517216658.1846, 'hit_ratio@10': 0.4012, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1559}:  50%|█████     | 5/10 [00:09<00:08,  1.63s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 2186517216658.1846, 'hit_ratio@10': 0.4012, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1559}:  60%|██████    | 6/10 [00:09<00:07,  1.87s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 1978578132786.6953, 'hit_ratio@10': 0.4067, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1946}:  60%|██████    | 6/10 [00:10<00:07,  1.87s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 1978578132786.6953, 'hit_ratio@10': 0.4067, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1946}:  70%|███████   | 7/10 [00:10<00:04,  1.66s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 2564438959041.3867, 'hit_ratio@10': 0.3844, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1435}:  70%|███████   | 7/10 [00:12<00:04,  1.66s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 2564438959041.3867, 'hit_ratio@10': 0.3844, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1435}:  80%|████████  | 8/10 [00:12<00:03,  1.70s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 2335623981164.991, 'hit_ratio@10': 0.3735, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.303}:  80%|████████  | 8/10 [00:14<00:03,  1.70s/it] {'epoch': 38, 'num_users': 6.3333, 'loss': 2335623981164.991, 'hit_ratio@10': 0.3735, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.303}:  90%|█████████ | 9/10 [00:14<00:01,  1.74s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 2301763340218.5283, 'hit_ratio@10': 0.3611, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2912}:  90%|█████████ | 9/10 [00:16<00:01,  1.74s/it] {'epoch': 38, 'num_users': 6.3, 'loss': 2301763340218.5283, 'hit_ratio@10': 0.3611, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2912}: 100%|██████████| 10/10 [00:16<00:00,  1.88s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 2301763340218.5283, 'hit_ratio@10': 0.3611, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2912}: 100%|██████████| 10/10 [00:16<00:00,  1.62s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 2301763340218.5283
Avg hit ratio: 0.3611288166653192
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.2912139892578125
Std train time: 1.2117820574620002
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 78185483386017.69, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9616}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 78185483386017.69, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9616}:  10%|█         | 1/10 [00:00<00:08,  1.00it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 39819570009284.45, 'hit_ratio@10': 0.2343, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7389}:  10%|█         | 1/10 [00:02<00:08,  1.00it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 39819570009284.45, 'hit_ratio@10': 0.2343, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7389}:  20%|██        | 2/10 [00:02<00:10,  1.31s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 26553975918674.207, 'hit_ratio@10': 0.2514, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3546}:  20%|██        | 2/10 [00:02<00:10,  1.31s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 26553975918674.207, 'hit_ratio@10': 0.2514, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3546}:  30%|███       | 3/10 [00:02<00:05,  1.17it/s]{'epoch': 39, 'num_users': 5.0, 'loss': 23087315633506.227, 'hit_ratio@10': 0.2957, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3609}:  30%|███       | 3/10 [00:04<00:05,  1.17it/s]{'epoch': 39, 'num_users': 5.0, 'loss': 23087315633506.227, 'hit_ratio@10': 0.2957, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3609}:  40%|████      | 4/10 [00:04<00:06,  1.07s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 21773544049922.805, 'hit_ratio@10': 0.2966, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1544}:  40%|████      | 4/10 [00:06<00:06,  1.07s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 21773544049922.805, 'hit_ratio@10': 0.2966, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1544}:  50%|█████     | 5/10 [00:06<00:08,  1.65s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 18674646048160.68, 'hit_ratio@10': 0.2805, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1822}:  50%|█████     | 5/10 [00:09<00:08,  1.65s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 18674646048160.68, 'hit_ratio@10': 0.2805, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1822}:  60%|██████    | 6/10 [00:09<00:07,  1.88s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 24015539792720.676, 'hit_ratio@10': 0.2918, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2265}:  60%|██████    | 6/10 [00:10<00:07,  1.88s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 24015539792720.676, 'hit_ratio@10': 0.2918, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2265}:  70%|███████   | 7/10 [00:10<00:05,  1.68s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 36552038877992.42, 'hit_ratio@10': 0.2946, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.16}:  70%|███████   | 7/10 [00:12<00:05,  1.68s/it]    {'epoch': 39, 'num_users': 6.125, 'loss': 36552038877992.42, 'hit_ratio@10': 0.2946, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.16}:  80%|████████  | 8/10 [00:12<00:03,  1.69s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 34548460026282.027, 'hit_ratio@10': 0.2937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3179}:  80%|████████  | 8/10 [00:14<00:03,  1.69s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 34548460026282.027, 'hit_ratio@10': 0.2937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3179}:  90%|█████████ | 9/10 [00:14<00:01,  1.73s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 31105666165183.426, 'hit_ratio@10': 0.3007, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3081}:  90%|█████████ | 9/10 [00:16<00:01,  1.73s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 31105666165183.426, 'hit_ratio@10': 0.3007, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3081}: 100%|██████████| 10/10 [00:16<00:00,  1.88s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 31105666165183.426, 'hit_ratio@10': 0.3007, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3081}: 100%|██████████| 10/10 [00:16<00:00,  1.63s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 31105666165183.418
Avg hit ratio: 0.30065129098405835
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.3080994844436646
Std train time: 1.2543210978284103
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 44075863769088.0, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9826}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 44075863769088.0, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9826}:  10%|█         | 1/10 [00:01<00:09,  1.01s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 336882220793856.0, 'hit_ratio@10': 0.2402, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7548}:  10%|█         | 1/10 [00:02<00:09,  1.01s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 336882220793856.0, 'hit_ratio@10': 0.2402, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7548}:  20%|██        | 2/10 [00:02<00:10,  1.32s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 247477615360487.62, 'hit_ratio@10': 0.2554, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3658}:  20%|██        | 2/10 [00:02<00:10,  1.32s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 247477615360487.62, 'hit_ratio@10': 0.2554, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3658}:  30%|███       | 3/10 [00:02<00:06,  1.16it/s]{'epoch': 40, 'num_users': 5.0, 'loss': 204789751529764.56, 'hit_ratio@10': 0.254, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3679}:  30%|███       | 3/10 [00:04<00:06,  1.16it/s] {'epoch': 40, 'num_users': 5.0, 'loss': 204789751529764.56, 'hit_ratio@10': 0.254, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3679}:  40%|████      | 4/10 [00:04<00:06,  1.07s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 165483255912436.3, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1533}:  40%|████      | 4/10 [00:06<00:06,  1.07s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 165483255912436.3, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1533}:  50%|█████     | 5/10 [00:06<00:08,  1.64s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 142067653866243.53, 'hit_ratio@10': 0.2749, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1878}:  50%|█████     | 5/10 [00:09<00:08,  1.64s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 142067653866243.53, 'hit_ratio@10': 0.2749, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1878}:  60%|██████    | 6/10 [00:09<00:07,  1.89s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 155685611370443.44, 'hit_ratio@10': 0.2699, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2523}:  60%|██████    | 6/10 [00:10<00:07,  1.89s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 155685611370443.44, 'hit_ratio@10': 0.2699, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2523}:  70%|███████   | 7/10 [00:10<00:05,  1.71s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 138878878756777.77, 'hit_ratio@10': 0.2969, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1758}:  70%|███████   | 7/10 [00:12<00:05,  1.71s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 138878878756777.77, 'hit_ratio@10': 0.2969, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1758}:  80%|████████  | 8/10 [00:12<00:03,  1.69s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 136130402210976.67, 'hit_ratio@10': 0.3147, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3452}:  80%|████████  | 8/10 [00:14<00:03,  1.69s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 136130402210976.67, 'hit_ratio@10': 0.3147, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3452}:  90%|█████████ | 9/10 [00:14<00:01,  1.75s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 129948592510031.42, 'hit_ratio@10': 0.3082, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3319}:  90%|█████████ | 9/10 [00:16<00:01,  1.75s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 129948592510031.42, 'hit_ratio@10': 0.3082, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3319}: 100%|██████████| 10/10 [00:16<00:00,  1.90s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 129948592510031.42, 'hit_ratio@10': 0.3082, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3319}: 100%|██████████| 10/10 [00:16<00:00,  1.64s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 129948592510031.42
Avg hit ratio: 0.3082380143908158
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.33185350894928
Std train time: 1.2637505297301308
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 1259826246389113.2, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9642}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 1259826246389113.2, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9642}:  10%|█         | 1/10 [00:00<00:08,  1.00it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 712628346743253.4, 'hit_ratio@10': 0.2385, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7685}:  10%|█         | 1/10 [00:02<00:08,  1.00it/s] {'epoch': 41, 'num_users': 7.0, 'loss': 712628346743253.4, 'hit_ratio@10': 0.2385, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7685}:  20%|██        | 2/10 [00:02<00:10,  1.35s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 475106954710572.75, 'hit_ratio@10': 0.3495, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3696}:  20%|██        | 2/10 [00:02<00:10,  1.35s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 475106954710572.75, 'hit_ratio@10': 0.3495, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3696}:  30%|███       | 3/10 [00:02<00:06,  1.15it/s]{'epoch': 41, 'num_users': 5.0, 'loss': 436758992063137.56, 'hit_ratio@10': 0.3246, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3669}:  30%|███       | 3/10 [00:04<00:06,  1.15it/s]{'epoch': 41, 'num_users': 5.0, 'loss': 436758992063137.56, 'hit_ratio@10': 0.3246, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3669}:  40%|████      | 4/10 [00:04<00:06,  1.07s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 352624749887650.0, 'hit_ratio@10': 0.3397, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1357}:  40%|████      | 4/10 [00:06<00:06,  1.07s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 352624749887650.0, 'hit_ratio@10': 0.3397, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1357}:  50%|█████     | 5/10 [00:06<00:08,  1.63s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 297910949313936.5, 'hit_ratio@10': 0.3349, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1807}:  50%|█████     | 5/10 [00:09<00:08,  1.63s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 297910949313936.5, 'hit_ratio@10': 0.3349, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1807}:  60%|██████    | 6/10 [00:09<00:07,  1.90s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 258973947625499.3, 'hit_ratio@10': 0.3328, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2361}:  60%|██████    | 6/10 [00:10<00:07,  1.90s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 258973947625499.3, 'hit_ratio@10': 0.3328, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2361}:  70%|███████   | 7/10 [00:10<00:05,  1.71s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 236508531545667.78, 'hit_ratio@10': 0.3305, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1733}:  70%|███████   | 7/10 [00:12<00:05,  1.71s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 236508531545667.78, 'hit_ratio@10': 0.3305, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1733}:  80%|████████  | 8/10 [00:12<00:03,  1.72s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 214215023840525.9, 'hit_ratio@10': 0.335, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3239}:  80%|████████  | 8/10 [00:14<00:03,  1.72s/it] {'epoch': 41, 'num_users': 6.3333, 'loss': 214215023840525.9, 'hit_ratio@10': 0.335, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3239}:  90%|█████████ | 9/10 [00:14<00:01,  1.74s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 196382989520358.12, 'hit_ratio@10': 0.3288, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3142}:  90%|█████████ | 9/10 [00:16<00:01,  1.74s/it] {'epoch': 41, 'num_users': 6.3, 'loss': 196382989520358.12, 'hit_ratio@10': 0.3288, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3142}: 100%|██████████| 10/10 [00:16<00:00,  1.89s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 196382989520358.12, 'hit_ratio@10': 0.3288, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3142}: 100%|██████████| 10/10 [00:16<00:00,  1.64s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 196382989520358.12
Avg hit ratio: 0.32880610372460967
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.31416335105896
Std train time: 1.2208192674776521
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 508793378763398.75, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0015}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 508793378763398.75, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0015}:  10%|█         | 1/10 [00:01<00:09,  1.02s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 787923463759006.2, 'hit_ratio@10': 0.3353, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7937}:  10%|█         | 1/10 [00:02<00:09,  1.02s/it] {'epoch': 42, 'num_users': 7.0, 'loss': 787923463759006.2, 'hit_ratio@10': 0.3353, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7937}:  20%|██        | 2/10 [00:02<00:10,  1.37s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 525283002659982.06, 'hit_ratio@10': 0.3188, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3958}:  20%|██        | 2/10 [00:02<00:10,  1.37s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 525283002659982.06, 'hit_ratio@10': 0.3188, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.3958}:  30%|███       | 3/10 [00:02<00:06,  1.13it/s]{'epoch': 42, 'num_users': 5.0, 'loss': 600211650290392.2, 'hit_ratio@10': 0.3194, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4023}:  30%|███       | 3/10 [00:04<00:06,  1.13it/s] {'epoch': 42, 'num_users': 5.0, 'loss': 600211650290392.2, 'hit_ratio@10': 0.3194, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4023}:  40%|████      | 4/10 [00:04<00:06,  1.10s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 573681774723130.2, 'hit_ratio@10': 0.3156, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1905}:  40%|████      | 4/10 [00:07<00:06,  1.10s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 573681774723130.2, 'hit_ratio@10': 0.3156, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1905}:  50%|█████     | 5/10 [00:07<00:08,  1.67s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 593309416864627.0, 'hit_ratio@10': 0.3037, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2291}:  50%|█████     | 5/10 [00:09<00:08,  1.67s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 593309416864627.0, 'hit_ratio@10': 0.3037, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2291}:  60%|██████    | 6/10 [00:09<00:07,  1.94s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 560334444945298.9, 'hit_ratio@10': 0.3232, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2721}:  60%|██████    | 6/10 [00:10<00:07,  1.94s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 560334444945298.9, 'hit_ratio@10': 0.3232, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2721}:  70%|███████   | 7/10 [00:10<00:05,  1.72s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 1127406930867221.5, 'hit_ratio@10': 0.3185, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2024}:  70%|███████   | 7/10 [00:12<00:05,  1.72s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 1127406930867221.5, 'hit_ratio@10': 0.3185, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.2024}:  80%|████████  | 8/10 [00:12<00:03,  1.73s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 1200166742559057.8, 'hit_ratio@10': 0.3022, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3592}:  80%|████████  | 8/10 [00:14<00:03,  1.73s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 1200166742559057.8, 'hit_ratio@10': 0.3022, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3592}:  90%|█████████ | 9/10 [00:14<00:01,  1.76s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 1080177510984561.2, 'hit_ratio@10': 0.3038, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3477}:  90%|█████████ | 9/10 [00:16<00:01,  1.76s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 1080177510984561.2, 'hit_ratio@10': 0.3038, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3477}: 100%|██████████| 10/10 [00:16<00:00,  1.91s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 1080177510984561.2, 'hit_ratio@10': 0.3038, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3477}: 100%|██████████| 10/10 [00:16<00:00,  1.66s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 1080177510984561.2
Avg hit ratio: 0.30375401602736074
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.3476712703704834
Std train time: 1.250543312603579
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 7435060971320805.0, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0876}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 7435060971320805.0, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0876}:  10%|█         | 1/10 [00:01<00:09,  1.06s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 3826303629310178.0, 'hit_ratio@10': 0.2445, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8965}:  10%|█         | 1/10 [00:02<00:09,  1.06s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 3826303629310178.0, 'hit_ratio@10': 0.2445, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8965}:  20%|██        | 2/10 [00:02<00:11,  1.45s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 2550914428353247.5, 'hit_ratio@10': 0.2106, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4778}:  20%|██        | 2/10 [00:03<00:11,  1.45s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 2550914428353247.5, 'hit_ratio@10': 0.2106, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4778}:  30%|███       | 3/10 [00:03<00:06,  1.06it/s]{'epoch': 43, 'num_users': 5.0, 'loss': 1967550271327271.8, 'hit_ratio@10': 0.2472, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4805}:  30%|███       | 3/10 [00:04<00:06,  1.06it/s]{'epoch': 43, 'num_users': 5.0, 'loss': 1967550271327271.8, 'hit_ratio@10': 0.2472, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4805}:  40%|████      | 4/10 [00:04<00:06,  1.16s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 1574062278768422.0, 'hit_ratio@10': 0.2898, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3122}:  40%|████      | 4/10 [00:07<00:06,  1.16s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 1574062278768422.0, 'hit_ratio@10': 0.2898, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3122}:  50%|█████     | 5/10 [00:07<00:08,  1.77s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 1396165486160850.8, 'hit_ratio@10': 0.297, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3494}:  50%|█████     | 5/10 [00:10<00:08,  1.77s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 1396165486160850.8, 'hit_ratio@10': 0.297, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3494}:  60%|██████    | 6/10 [00:10<00:08,  2.03s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 2106754763190128.0, 'hit_ratio@10': 0.2832, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3965}:  60%|██████    | 6/10 [00:11<00:08,  2.03s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 2106754763190128.0, 'hit_ratio@10': 0.2832, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3965}:  70%|███████   | 7/10 [00:11<00:05,  1.81s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 1958692660310870.0, 'hit_ratio@10': 0.2871, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3362}:  70%|███████   | 7/10 [00:13<00:05,  1.81s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 1958692660310870.0, 'hit_ratio@10': 0.2871, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3362}:  80%|████████  | 8/10 [00:13<00:03,  1.85s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 1854459821875465.0, 'hit_ratio@10': 0.2869, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.516}:  80%|████████  | 8/10 [00:15<00:03,  1.85s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 1854459821875465.0, 'hit_ratio@10': 0.2869, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.516}:  90%|█████████ | 9/10 [00:15<00:01,  1.89s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 2209409106678445.2, 'hit_ratio@10': 0.2923, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5065}:  90%|█████████ | 9/10 [00:17<00:01,  1.89s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 2209409106678445.2, 'hit_ratio@10': 0.2923, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5065}: 100%|██████████| 10/10 [00:17<00:00,  2.06s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 2209409106678445.2, 'hit_ratio@10': 0.2923, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5065}: 100%|██████████| 10/10 [00:17<00:00,  1.77s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 2209409106678445.2
Avg hit ratio: 0.29232067705921694
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.5064959287643434
Std train time: 1.3279718270565717
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 1760379155333982.2, 'hit_ratio@10': 0.4737, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0566}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 1760379155333982.2, 'hit_ratio@10': 0.4737, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0566}:  10%|█         | 1/10 [00:01<00:09,  1.04s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 1.5599330376437532e+16, 'hit_ratio@10': 0.3336, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8871}:  10%|█         | 1/10 [00:02<00:09,  1.04s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 1.5599330376437532e+16, 'hit_ratio@10': 0.3336, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8871}:  20%|██        | 2/10 [00:02<00:11,  1.45s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 2.1521462716469292e+16, 'hit_ratio@10': 0.3653, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.477}:  20%|██        | 2/10 [00:03<00:11,  1.45s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 2.1521462716469292e+16, 'hit_ratio@10': 0.3653, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.477}:  30%|███       | 3/10 [00:03<00:06,  1.06it/s]{'epoch': 44, 'num_users': 5.0, 'loss': 2.4145586751163424e+16, 'hit_ratio@10': 0.3365, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4859}:  30%|███       | 3/10 [00:04<00:06,  1.06it/s]{'epoch': 44, 'num_users': 5.0, 'loss': 2.4145586751163424e+16, 'hit_ratio@10': 0.3365, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4859}:  40%|████      | 4/10 [00:04<00:07,  1.17s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 2.0891714629047016e+16, 'hit_ratio@10': 0.3452, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3196}:  40%|████      | 4/10 [00:07<00:07,  1.17s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 2.0891714629047016e+16, 'hit_ratio@10': 0.3452, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3196}:  50%|█████     | 5/10 [00:07<00:08,  1.78s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 1.854696970169564e+16, 'hit_ratio@10': 0.3284, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3336}:  50%|█████     | 5/10 [00:09<00:08,  1.78s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 1.854696970169564e+16, 'hit_ratio@10': 0.3284, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3336}:  60%|██████    | 6/10 [00:09<00:07,  1.99s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 1.6849151311010238e+16, 'hit_ratio@10': 0.3215, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3961}:  60%|██████    | 6/10 [00:11<00:07,  1.99s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 1.6849151311010238e+16, 'hit_ratio@10': 0.3215, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3961}:  70%|███████   | 7/10 [00:11<00:05,  1.80s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 1.4971755503316496e+16, 'hit_ratio@10': 0.317, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3321}:  70%|███████   | 7/10 [00:13<00:05,  1.80s/it]  {'epoch': 44, 'num_users': 6.125, 'loss': 1.4971755503316496e+16, 'hit_ratio@10': 0.317, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3321}:  80%|████████  | 8/10 [00:13<00:03,  1.83s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 2.395628122734309e+16, 'hit_ratio@10': 0.3199, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5078}:  80%|████████  | 8/10 [00:15<00:03,  1.83s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 2.395628122734309e+16, 'hit_ratio@10': 0.3199, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5078}:  90%|█████████ | 9/10 [00:15<00:01,  1.88s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 2.160985726423932e+16, 'hit_ratio@10': 0.3129, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4988}:  90%|█████████ | 9/10 [00:17<00:01,  1.88s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 2.160985726423932e+16, 'hit_ratio@10': 0.3129, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4988}: 100%|██████████| 10/10 [00:17<00:00,  2.05s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 2.160985726423932e+16, 'hit_ratio@10': 0.3129, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4988}: 100%|██████████| 10/10 [00:17<00:00,  1.76s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 2.160985726423932e+16
Avg hit ratio: 0.3128819899210392
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.498843240737915
Std train time: 1.3265719958491862
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 3.96547318340442e+16, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0015}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 3.96547318340442e+16, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0015}:  10%|█         | 1/10 [00:01<00:09,  1.02s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 5.084846618367269e+16, 'hit_ratio@10': 0.2343, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8313}:  10%|█         | 1/10 [00:02<00:09,  1.02s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 5.084846618367269e+16, 'hit_ratio@10': 0.2343, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8313}:  20%|██        | 2/10 [00:02<00:11,  1.40s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 3.391114187900304e+16, 'hit_ratio@10': 0.2514, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4324}:  20%|██        | 2/10 [00:03<00:11,  1.40s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 3.391114187900304e+16, 'hit_ratio@10': 0.2514, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4324}:  30%|███       | 3/10 [00:03<00:06,  1.09it/s]{'epoch': 45, 'num_users': 5.0, 'loss': 4.769395355854102e+16, 'hit_ratio@10': 0.2779, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4503}:  30%|███       | 3/10 [00:04<00:06,  1.09it/s]{'epoch': 45, 'num_users': 5.0, 'loss': 4.769395355854102e+16, 'hit_ratio@10': 0.2779, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4503}:  40%|████      | 4/10 [00:04<00:06,  1.15s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 4.000748583998292e+16, 'hit_ratio@10': 0.2983, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.302}:  40%|████      | 4/10 [00:07<00:06,  1.15s/it] {'epoch': 45, 'num_users': 5.8, 'loss': 4.000748583998292e+16, 'hit_ratio@10': 0.2983, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.302}:  50%|█████     | 5/10 [00:07<00:08,  1.77s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 3.6307484098347944e+16, 'hit_ratio@10': 0.3115, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3318}:  50%|█████     | 5/10 [00:09<00:08,  1.77s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 3.6307484098347944e+16, 'hit_ratio@10': 0.3115, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3318}:  60%|██████    | 6/10 [00:09<00:08,  2.02s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 3.46176816069314e+16, 'hit_ratio@10': 0.3127, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3925}:  60%|██████    | 6/10 [00:11<00:08,  2.02s/it]  {'epoch': 45, 'num_users': 6.2857, 'loss': 3.46176816069314e+16, 'hit_ratio@10': 0.3127, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3925}:  70%|███████   | 7/10 [00:11<00:05,  1.81s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 3.0299885401268296e+16, 'hit_ratio@10': 0.3379, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3298}:  70%|███████   | 7/10 [00:13<00:05,  1.81s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 3.0299885401268296e+16, 'hit_ratio@10': 0.3379, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3298}:  80%|████████  | 8/10 [00:13<00:03,  1.84s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 2.904691039287051e+16, 'hit_ratio@10': 0.3321, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5071}:  80%|████████  | 8/10 [00:15<00:03,  1.84s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 2.904691039287051e+16, 'hit_ratio@10': 0.3321, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5071}:  90%|█████████ | 9/10 [00:15<00:01,  1.89s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 2.9669140084363256e+16, 'hit_ratio@10': 0.3307, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5023}:  90%|█████████ | 9/10 [00:17<00:01,  1.89s/it]  {'epoch': 45, 'num_users': 6.3, 'loss': 2.9669140084363256e+16, 'hit_ratio@10': 0.3307, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5023}: 100%|██████████| 10/10 [00:17<00:00,  2.07s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 2.9669140084363256e+16, 'hit_ratio@10': 0.3307, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5023}: 100%|██████████| 10/10 [00:17<00:00,  1.77s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 2.9669140084363256e+16
Avg hit ratio: 0.33074075707352446
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.5023072957992554
Std train time: 1.34866818701976
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 2.8596660332551072e+17, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0733}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 2.8596660332551072e+17, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0733}:  10%|█         | 1/10 [00:01<00:09,  1.05s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 1.870128972272498e+17, 'hit_ratio@10': 0.3251, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9154}:  10%|█         | 1/10 [00:02<00:09,  1.05s/it] {'epoch': 46, 'num_users': 7.0, 'loss': 1.870128972272498e+17, 'hit_ratio@10': 0.3251, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9154}:  20%|██        | 2/10 [00:02<00:11,  1.48s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 1.2467536327394165e+17, 'hit_ratio@10': 0.312, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4858}:  20%|██        | 2/10 [00:03<00:11,  1.48s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 1.2467536327394165e+17, 'hit_ratio@10': 0.312, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4858}:  30%|███       | 3/10 [00:03<00:06,  1.05it/s]{'epoch': 46, 'num_users': 5.0, 'loss': 9.423669039717309e+16, 'hit_ratio@10': 0.2965, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4953}:  30%|███       | 3/10 [00:04<00:06,  1.05it/s]{'epoch': 46, 'num_users': 5.0, 'loss': 9.423669039717309e+16, 'hit_ratio@10': 0.2965, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4953}:  40%|████      | 4/10 [00:04<00:07,  1.18s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 9.442327381729941e+16, 'hit_ratio@10': 0.2972, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3492}:  40%|████      | 4/10 [00:07<00:07,  1.18s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 9.442327381729941e+16, 'hit_ratio@10': 0.2972, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3492}:  50%|█████     | 5/10 [00:07<00:09,  1.80s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 8.035251366955714e+16, 'hit_ratio@10': 0.318, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3692}:  50%|█████     | 5/10 [00:10<00:09,  1.80s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 8.035251366955714e+16, 'hit_ratio@10': 0.318, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3692}:  60%|██████    | 6/10 [00:10<00:08,  2.03s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 1.1569939694122883e+17, 'hit_ratio@10': 0.3126, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4238}:  60%|██████    | 6/10 [00:11<00:08,  2.03s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 1.1569939694122883e+17, 'hit_ratio@10': 0.3126, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4238}:  70%|███████   | 7/10 [00:11<00:05,  1.82s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 1.2193519550146707e+17, 'hit_ratio@10': 0.3128, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3566}:  70%|███████   | 7/10 [00:13<00:05,  1.82s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 1.2193519550146707e+17, 'hit_ratio@10': 0.3128, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3566}:  80%|████████  | 8/10 [00:13<00:03,  1.85s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 1.1221503124825594e+17, 'hit_ratio@10': 0.313, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5397}:  80%|████████  | 8/10 [00:15<00:03,  1.85s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 1.1221503124825594e+17, 'hit_ratio@10': 0.313, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5397}:  90%|█████████ | 9/10 [00:15<00:01,  1.90s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 1.0588099401209096e+17, 'hit_ratio@10': 0.3112, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5359}:  90%|█████████ | 9/10 [00:17<00:01,  1.90s/it]  {'epoch': 46, 'num_users': 6.3, 'loss': 1.0588099401209096e+17, 'hit_ratio@10': 0.3112, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5359}: 100%|██████████| 10/10 [00:17<00:00,  2.09s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 1.0588099401209096e+17, 'hit_ratio@10': 0.3112, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5359}: 100%|██████████| 10/10 [00:17<00:00,  1.79s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 1.0588099401209098e+17
Avg hit ratio: 0.3112217150892872
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.5358737468719483
Std train time: 1.361916848010162
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 4.7233054310457946e+17, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0847}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 4.7233054310457946e+17, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0847}:  10%|█         | 1/10 [00:01<00:09,  1.06s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 6.094201298450007e+17, 'hit_ratio@10': 0.2182, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8905}:  10%|█         | 1/10 [00:02<00:09,  1.06s/it] {'epoch': 47, 'num_users': 7.0, 'loss': 6.094201298450007e+17, 'hit_ratio@10': 0.2182, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8905}:  20%|██        | 2/10 [00:02<00:11,  1.44s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 4.062801549510905e+17, 'hit_ratio@10': 0.2883, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4821}:  20%|██        | 2/10 [00:03<00:11,  1.44s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 4.062801549510905e+17, 'hit_ratio@10': 0.2883, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4821}:  30%|███       | 3/10 [00:03<00:06,  1.06it/s]{'epoch': 47, 'num_users': 5.0, 'loss': 2.1658442671368077e+18, 'hit_ratio@10': 0.2966, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.496}:  30%|███       | 3/10 [00:04<00:06,  1.06it/s]{'epoch': 47, 'num_users': 5.0, 'loss': 2.1658442671368077e+18, 'hit_ratio@10': 0.2966, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.496}:  40%|████      | 4/10 [00:04<00:07,  1.18s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 1.8126490345343805e+18, 'hit_ratio@10': 0.3133, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3152}:  40%|████      | 4/10 [00:07<00:07,  1.18s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 1.8126490345343805e+18, 'hit_ratio@10': 0.3133, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3152}:  50%|█████     | 5/10 [00:07<00:09,  1.83s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 1.6131723674389558e+18, 'hit_ratio@10': 0.3018, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3499}:  50%|█████     | 5/10 [00:10<00:09,  1.83s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 1.6131723674389558e+18, 'hit_ratio@10': 0.3018, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3499}:  60%|██████    | 6/10 [00:10<00:08,  2.07s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 1.4751027246756705e+18, 'hit_ratio@10': 0.2987, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4062}:  60%|██████    | 6/10 [00:11<00:08,  2.07s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 1.4751027246756705e+18, 'hit_ratio@10': 0.2987, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4062}:  70%|███████   | 7/10 [00:11<00:05,  1.85s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 1.3587127866873475e+18, 'hit_ratio@10': 0.2971, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3481}:  70%|███████   | 7/10 [00:13<00:05,  1.85s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 1.3587127866873475e+18, 'hit_ratio@10': 0.2971, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3481}:  80%|████████  | 8/10 [00:13<00:03,  1.88s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 1.2557972265408376e+18, 'hit_ratio@10': 0.2831, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5164}:  80%|████████  | 8/10 [00:15<00:03,  1.88s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 1.2557972265408376e+18, 'hit_ratio@10': 0.2831, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5164}:  90%|█████████ | 9/10 [00:15<00:01,  1.90s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 1.1375531224372333e+18, 'hit_ratio@10': 0.2889, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4945}:  90%|█████████ | 9/10 [00:17<00:01,  1.90s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 1.1375531224372333e+18, 'hit_ratio@10': 0.2889, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4945}: 100%|██████████| 10/10 [00:17<00:00,  2.03s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 1.1375531224372333e+18, 'hit_ratio@10': 0.2889, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4945}: 100%|██████████| 10/10 [00:17<00:00,  1.78s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 1.1375531224372337e+18
Avg hit ratio: 0.2888829159898769
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.494497466087341
Std train time: 1.301668361015909
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 3.411211457162186e+16, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0933}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 3.411211457162186e+16, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0933}:  10%|█         | 1/10 [00:01<00:09,  1.07s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 4.270686946256894e+17, 'hit_ratio@10': 0.2666, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9163}:  10%|█         | 1/10 [00:02<00:09,  1.07s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 4.270686946256894e+17, 'hit_ratio@10': 0.2666, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9163}:  20%|██        | 2/10 [00:02<00:11,  1.47s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 3.837303669297634e+17, 'hit_ratio@10': 0.3206, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4874}:  20%|██        | 2/10 [00:03<00:11,  1.47s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 3.837303669297634e+17, 'hit_ratio@10': 0.3206, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4874}:  30%|███       | 3/10 [00:03<00:06,  1.05it/s]{'epoch': 48, 'num_users': 5.0, 'loss': 6.049301161670006e+17, 'hit_ratio@10': 0.3208, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4902}:  30%|███       | 3/10 [00:04<00:06,  1.05it/s]{'epoch': 48, 'num_users': 5.0, 'loss': 6.049301161670006e+17, 'hit_ratio@10': 0.3208, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4902}:  40%|████      | 4/10 [00:04<00:07,  1.17s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 7.452940079149856e+17, 'hit_ratio@10': 0.3406, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3027}:  40%|████      | 4/10 [00:07<00:07,  1.17s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 7.452940079149856e+17, 'hit_ratio@10': 0.3406, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3027}:  50%|█████     | 5/10 [00:07<00:08,  1.77s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 6.359397971822401e+17, 'hit_ratio@10': 0.3098, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3427}:  50%|█████     | 5/10 [00:10<00:08,  1.77s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 6.359397971822401e+17, 'hit_ratio@10': 0.3098, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3427}:  60%|██████    | 6/10 [00:10<00:08,  2.04s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 6.536947615649517e+17, 'hit_ratio@10': 0.2998, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4048}:  60%|██████    | 6/10 [00:11<00:08,  2.04s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 6.536947615649517e+17, 'hit_ratio@10': 0.2998, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4048}:  70%|███████   | 7/10 [00:11<00:05,  1.83s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 6.334146649102801e+17, 'hit_ratio@10': 0.2945, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3411}:  70%|███████   | 7/10 [00:13<00:05,  1.83s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 6.334146649102801e+17, 'hit_ratio@10': 0.2945, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3411}:  80%|████████  | 8/10 [00:13<00:03,  1.86s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 2.645992542213022e+18, 'hit_ratio@10': 0.2872, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.496}:  80%|████████  | 8/10 [00:15<00:03,  1.86s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 2.645992542213022e+18, 'hit_ratio@10': 0.2872, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.496}:  90%|█████████ | 9/10 [00:15<00:01,  1.86s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 2.732189173205505e+18, 'hit_ratio@10': 0.2903, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4874}:  90%|█████████ | 9/10 [00:17<00:01,  1.86s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 2.732189173205505e+18, 'hit_ratio@10': 0.2903, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4874}: 100%|██████████| 10/10 [00:17<00:00,  2.04s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 2.732189173205505e+18, 'hit_ratio@10': 0.2903, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4874}: 100%|██████████| 10/10 [00:17<00:00,  1.77s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 2.732189173205505e+18
Avg hit ratio: 0.29025586204024234
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.487373185157776
Std train time: 1.2861670122574513
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 1.539227753281004e+18, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1952}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 1.539227753281004e+18, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.1952}:  10%|█         | 1/10 [00:01<00:10,  1.11s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 1.1335861365564646e+18, 'hit_ratio@10': 0.3879, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0056}:  10%|█         | 1/10 [00:02<00:10,  1.11s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 1.1335861365564646e+18, 'hit_ratio@10': 0.3879, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0056}:  20%|██        | 2/10 [00:02<00:12,  1.54s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 7.674468628221751e+17, 'hit_ratio@10': 0.2586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.55}:  20%|██        | 2/10 [00:03<00:12,  1.54s/it]   {'epoch': 49, 'num_users': 5.0, 'loss': 7.674468628221751e+17, 'hit_ratio@10': 0.2586, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.55}:  30%|███       | 3/10 [00:03<00:06,  1.01it/s]{'epoch': 49, 'num_users': 5.0, 'loss': 8.138456797470013e+17, 'hit_ratio@10': 0.319, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5528}:  30%|███       | 3/10 [00:04<00:06,  1.01it/s]{'epoch': 49, 'num_users': 5.0, 'loss': 8.138456797470013e+17, 'hit_ratio@10': 0.319, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5528}:  40%|████      | 4/10 [00:04<00:07,  1.22s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 2.2513367342641905e+18, 'hit_ratio@10': 0.3352, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.366}:  40%|████      | 4/10 [00:07<00:07,  1.22s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 2.2513367342641905e+18, 'hit_ratio@10': 0.3352, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.366}:  50%|█████     | 5/10 [00:07<00:08,  1.80s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 2.3094084964701896e+18, 'hit_ratio@10': 0.3238, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3975}:  50%|█████     | 5/10 [00:10<00:08,  1.80s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 2.3094084964701896e+18, 'hit_ratio@10': 0.3238, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3975}:  60%|██████    | 6/10 [00:10<00:08,  2.06s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 2.44088553638723e+18, 'hit_ratio@10': 0.3347, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4314}:  60%|██████    | 6/10 [00:11<00:08,  2.06s/it]  {'epoch': 49, 'num_users': 6.2857, 'loss': 2.44088553638723e+18, 'hit_ratio@10': 0.3347, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.4314}:  70%|███████   | 7/10 [00:11<00:05,  1.82s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 2.165214927350304e+18, 'hit_ratio@10': 0.35, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3678}:  70%|███████   | 7/10 [00:13<00:05,  1.82s/it]  {'epoch': 49, 'num_users': 6.125, 'loss': 2.165214927350304e+18, 'hit_ratio@10': 0.35, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.3678}:  80%|████████  | 8/10 [00:13<00:03,  1.86s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 1.952209447875594e+18, 'hit_ratio@10': 0.3206, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5478}:  80%|████████  | 8/10 [00:15<00:03,  1.86s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 1.952209447875594e+18, 'hit_ratio@10': 0.3206, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5478}:  90%|█████████ | 9/10 [00:15<00:01,  1.91s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 2.3383061483887923e+18, 'hit_ratio@10': 0.3249, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5353}:  90%|█████████ | 9/10 [00:17<00:01,  1.91s/it]  {'epoch': 49, 'num_users': 6.3, 'loss': 2.3383061483887923e+18, 'hit_ratio@10': 0.3249, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5353}: 100%|██████████| 10/10 [00:17<00:00,  2.07s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 2.3383061483887923e+18, 'hit_ratio@10': 0.3249, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.5353}: 100%|██████████| 10/10 [00:17<00:00,  1.80s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 2.3383061483887923e+18
Avg hit ratio: 0.324905151441654
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.535258936882019
Std train time: 1.3113817731485509
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
