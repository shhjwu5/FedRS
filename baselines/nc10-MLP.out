  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.123, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5751, 'compress@10': 1.0, 'time@10': 3.7647}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.123, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5751, 'compress@10': 1.0, 'time@10': 3.7647}:  10%|█         | 1/10 [00:01<00:17,  1.91s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0912, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.7094, 'compress@10': 1.0, 'time@10': 2.9469}:  10%|█         | 1/10 [00:04<00:17,  1.91s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.0912, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.7094, 'compress@10': 1.0, 'time@10': 2.9469}:  20%|██        | 2/10 [00:04<00:16,  2.06s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7749, 'hit_ratio@10': 0.5463, 'ndcg@10': 0.473, 'compress@10': 1.0, 'time@10': 2.2364}:  20%|██        | 2/10 [00:04<00:16,  2.06s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.7749, 'hit_ratio@10': 0.5463, 'ndcg@10': 0.473, 'compress@10': 1.0, 'time@10': 2.2364}:  30%|███       | 3/10 [00:04<00:09,  1.32s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5975, 'hit_ratio@10': 0.624, 'ndcg@10': 0.5614, 'compress@10': 1.0, 'time@10': 2.1552}:  30%|███       | 3/10 [00:06<00:09,  1.32s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5975, 'hit_ratio@10': 0.624, 'ndcg@10': 0.5614, 'compress@10': 1.0, 'time@10': 2.1552}:  40%|████      | 4/10 [00:06<00:09,  1.57s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4966, 'hit_ratio@10': 0.6632, 'ndcg@10': 0.6061, 'compress@10': 1.0, 'time@10': 3.1225}:  40%|████      | 4/10 [00:09<00:09,  1.57s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4966, 'hit_ratio@10': 0.6632, 'ndcg@10': 0.6061, 'compress@10': 1.0, 'time@10': 3.1225}:  50%|█████     | 5/10 [00:09<00:11,  2.27s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4278, 'hit_ratio@10': 0.6675, 'ndcg@10': 0.6405, 'compress@10': 1.0, 'time@10': 3.1253}:  50%|█████     | 5/10 [00:13<00:11,  2.27s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4278, 'hit_ratio@10': 0.6675, 'ndcg@10': 0.6405, 'compress@10': 1.0, 'time@10': 3.1253}:  60%|██████    | 6/10 [00:13<00:10,  2.58s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3769, 'hit_ratio@10': 0.7093, 'ndcg@10': 0.6446, 'compress@10': 1.0, 'time@10': 3.1682}:  60%|██████    | 6/10 [00:14<00:10,  2.58s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3769, 'hit_ratio@10': 0.7093, 'ndcg@10': 0.6446, 'compress@10': 1.0, 'time@10': 3.1682}:  70%|███████   | 7/10 [00:14<00:06,  2.31s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3352, 'hit_ratio@10': 0.7349, 'ndcg@10': 0.6669, 'compress@10': 1.0, 'time@10': 3.0664}:  70%|███████   | 7/10 [00:17<00:06,  2.31s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3352, 'hit_ratio@10': 0.7349, 'ndcg@10': 0.6669, 'compress@10': 1.0, 'time@10': 3.0664}:  80%|████████  | 8/10 [00:17<00:04,  2.33s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3024, 'hit_ratio@10': 0.7294, 'ndcg@10': 0.6945, 'compress@10': 1.0, 'time@10': 3.2682}:  80%|████████  | 8/10 [00:19<00:04,  2.33s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3024, 'hit_ratio@10': 0.7294, 'ndcg@10': 0.6945, 'compress@10': 1.0, 'time@10': 3.2682}:  90%|█████████ | 9/10 [00:19<00:02,  2.38s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2773, 'hit_ratio@10': 0.7497, 'ndcg@10': 0.7096, 'compress@10': 1.0, 'time@10': 3.2398}:  90%|█████████ | 9/10 [00:22<00:02,  2.38s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2773, 'hit_ratio@10': 0.7497, 'ndcg@10': 0.7096, 'compress@10': 1.0, 'time@10': 3.2398}: 100%|██████████| 10/10 [00:22<00:00,  2.57s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2773, 'hit_ratio@10': 0.7497, 'ndcg@10': 0.7096, 'compress@10': 1.0, 'time@10': 3.2398}: 100%|██████████| 10/10 [00:22<00:00,  2.28s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.27725005428809624
Avg hit ratio: 0.7496705130372363
Avg ndcg: 0.7096268613925982
Avg compression ratio: 1.0
Avg train time: 3.2398211002349853
Std train time: 1.6377324134960236
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 2.5745}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 2.5745}:  10%|█         | 1/10 [00:01<00:11,  1.32s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0513, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8473, 'compress@10': 1.0, 'time@10': 2.3229}:  10%|█         | 1/10 [00:03<00:11,  1.32s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0513, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8473, 'compress@10': 1.0, 'time@10': 2.3229}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.6641, 'ndcg@10': 0.8506, 'compress@10': 1.0, 'time@10': 1.8358}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.6641, 'ndcg@10': 0.8506, 'compress@10': 1.0, 'time@10': 1.8358}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0403, 'hit_ratio@10': 0.7213, 'ndcg@10': 0.8445, 'compress@10': 1.0, 'time@10': 1.8326}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0403, 'hit_ratio@10': 0.7213, 'ndcg@10': 0.8445, 'compress@10': 1.0, 'time@10': 1.8326}:  40%|████      | 4/10 [00:05<00:08,  1.45s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0506, 'hit_ratio@10': 0.741, 'ndcg@10': 0.8321, 'compress@10': 1.0, 'time@10': 2.8125}:  40%|████      | 4/10 [00:09<00:08,  1.45s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.0506, 'hit_ratio@10': 0.741, 'ndcg@10': 0.8321, 'compress@10': 1.0, 'time@10': 2.8125}:  50%|█████     | 5/10 [00:09<00:10,  2.15s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0563, 'hit_ratio@10': 0.736, 'ndcg@10': 0.8259, 'compress@10': 1.0, 'time@10': 2.8406}:  50%|█████     | 5/10 [00:12<00:10,  2.15s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0563, 'hit_ratio@10': 0.736, 'ndcg@10': 0.8259, 'compress@10': 1.0, 'time@10': 2.8406}:  60%|██████    | 6/10 [00:12<00:09,  2.44s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0544, 'hit_ratio@10': 0.768, 'ndcg@10': 0.8304, 'compress@10': 1.0, 'time@10': 2.9047}:  60%|██████    | 6/10 [00:13<00:09,  2.44s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0544, 'hit_ratio@10': 0.768, 'ndcg@10': 0.8304, 'compress@10': 1.0, 'time@10': 2.9047}:  70%|███████   | 7/10 [00:13<00:06,  2.19s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0537, 'hit_ratio@10': 0.7863, 'ndcg@10': 0.8371, 'compress@10': 1.0, 'time@10': 2.829}:  70%|███████   | 7/10 [00:16<00:06,  2.19s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0537, 'hit_ratio@10': 0.7863, 'ndcg@10': 0.8371, 'compress@10': 1.0, 'time@10': 2.829}:  80%|████████  | 8/10 [00:16<00:04,  2.24s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0523, 'hit_ratio@10': 0.7815, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 3.0273}:  80%|████████  | 8/10 [00:18<00:04,  2.24s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0523, 'hit_ratio@10': 0.7815, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 3.0273}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0522, 'hit_ratio@10': 0.792, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 3.016}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.0522, 'hit_ratio@10': 0.792, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 3.016}: 100%|██████████| 10/10 [00:21<00:00,  2.48s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0522, 'hit_ratio@10': 0.792, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 3.016}: 100%|██████████| 10/10 [00:21<00:00,  2.14s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.052173254251817514
Avg hit ratio: 0.7919713408643799
Avg ndcg: 0.8448732193220323
Avg compression ratio: 1.0
Avg train time: 3.0160048484802244
Std train time: 1.5528425280457392
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 2.4438}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 2.4438}:  10%|█         | 1/10 [00:01<00:11,  1.25s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8452, 'compress@10': 1.0, 'time@10': 2.2438}:  10%|█         | 1/10 [00:03<00:11,  1.25s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0504, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8452, 'compress@10': 1.0, 'time@10': 2.2438}:  20%|██        | 2/10 [00:03<00:13,  1.73s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8492, 'compress@10': 1.0, 'time@10': 1.7525}:  20%|██        | 2/10 [00:03<00:13,  1.73s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8492, 'compress@10': 1.0, 'time@10': 1.7525}:  30%|███       | 3/10 [00:03<00:07,  1.13s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0387, 'hit_ratio@10': 0.7918, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 1.7684}:  30%|███       | 3/10 [00:05<00:07,  1.13s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0387, 'hit_ratio@10': 0.7918, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 1.7684}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0491, 'hit_ratio@10': 0.8015, 'ndcg@10': 0.8351, 'compress@10': 1.0, 'time@10': 2.7859}:  40%|████      | 4/10 [00:09<00:08,  1.41s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0491, 'hit_ratio@10': 0.8015, 'ndcg@10': 0.8351, 'compress@10': 1.0, 'time@10': 2.7859}:  50%|█████     | 5/10 [00:09<00:10,  2.15s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0547, 'hit_ratio@10': 0.7864, 'ndcg@10': 0.8316, 'compress@10': 1.0, 'time@10': 2.8209}:  50%|█████     | 5/10 [00:12<00:10,  2.15s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0547, 'hit_ratio@10': 0.7864, 'ndcg@10': 0.8316, 'compress@10': 1.0, 'time@10': 2.8209}:  60%|██████    | 6/10 [00:12<00:09,  2.45s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0529, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8358, 'compress@10': 1.0, 'time@10': 2.8825}:  60%|██████    | 6/10 [00:13<00:09,  2.45s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0529, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8358, 'compress@10': 1.0, 'time@10': 2.8825}:  70%|███████   | 7/10 [00:13<00:06,  2.19s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0513, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 2.8044}:  70%|███████   | 7/10 [00:16<00:06,  2.19s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0513, 'hit_ratio@10': 0.8241, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 2.8044}:  80%|████████  | 8/10 [00:16<00:04,  2.22s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0503, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 3.0303}:  80%|████████  | 8/10 [00:18<00:04,  2.22s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0503, 'hit_ratio@10': 0.8214, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 3.0303}:  90%|█████████ | 9/10 [00:18<00:02,  2.29s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8496, 'compress@10': 1.0, 'time@10': 3.0158}:  90%|█████████ | 9/10 [00:21<00:02,  2.29s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8496, 'compress@10': 1.0, 'time@10': 3.0158}: 100%|██████████| 10/10 [00:21<00:00,  2.48s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8496, 'compress@10': 1.0, 'time@10': 3.0158}: 100%|██████████| 10/10 [00:21<00:00,  2.14s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.050057049115571975
Avg hit ratio: 0.8324568875757331
Avg ndcg: 0.8496030327315867
Avg compression ratio: 1.0
Avg train time: 3.0158005714416505
Std train time: 1.626794858219775
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 2.4435}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 2.4435}:  10%|█         | 1/10 [00:01<00:11,  1.25s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 2.2329}:  10%|█         | 1/10 [00:03<00:11,  1.25s/it] {'epoch': 3, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 2.2329}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8509, 'compress@10': 1.0, 'time@10': 1.7533}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8509, 'compress@10': 1.0, 'time@10': 1.7533}:  30%|███       | 3/10 [00:03<00:07,  1.13s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.7561, 'ndcg@10': 0.8507, 'compress@10': 1.0, 'time@10': 1.7736}:  30%|███       | 3/10 [00:05<00:07,  1.13s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0375, 'hit_ratio@10': 0.7561, 'ndcg@10': 0.8507, 'compress@10': 1.0, 'time@10': 1.7736}:  40%|████      | 4/10 [00:05<00:08,  1.42s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7689, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 2.7682}:  40%|████      | 4/10 [00:08<00:08,  1.42s/it] {'epoch': 3, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7689, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 2.7682}:  50%|█████     | 5/10 [00:08<00:10,  2.13s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0523, 'hit_ratio@10': 0.763, 'ndcg@10': 0.8335, 'compress@10': 1.0, 'time@10': 2.8326}:  50%|█████     | 5/10 [00:12<00:10,  2.13s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0523, 'hit_ratio@10': 0.763, 'ndcg@10': 0.8335, 'compress@10': 1.0, 'time@10': 2.8326}:  60%|██████    | 6/10 [00:12<00:09,  2.49s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8398, 'compress@10': 1.0, 'time@10': 2.9254}:  60%|██████    | 6/10 [00:13<00:09,  2.49s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8398, 'compress@10': 1.0, 'time@10': 2.9254}:  70%|███████   | 7/10 [00:13<00:06,  2.26s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0489, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8443, 'compress@10': 1.0, 'time@10': 2.8363}:  70%|███████   | 7/10 [00:16<00:06,  2.26s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0489, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8443, 'compress@10': 1.0, 'time@10': 2.8363}:  80%|████████  | 8/10 [00:16<00:04,  2.25s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0475, 'hit_ratio@10': 0.809, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 3.034}:  80%|████████  | 8/10 [00:18<00:04,  2.25s/it]  {'epoch': 3, 'num_users': 6.3333, 'loss': 0.0475, 'hit_ratio@10': 0.809, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 3.034}:  90%|█████████ | 9/10 [00:18<00:02,  2.28s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0471, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 3.0168}:  90%|█████████ | 9/10 [00:21<00:02,  2.28s/it] {'epoch': 3, 'num_users': 6.3, 'loss': 0.0471, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 3.0168}: 100%|██████████| 10/10 [00:21<00:00,  2.47s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0471, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.854, 'compress@10': 1.0, 'time@10': 3.0168}: 100%|██████████| 10/10 [00:21<00:00,  2.14s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.047132227597446785
Avg hit ratio: 0.8212505383693838
Avg ndcg: 0.8540126275598288
Avg compression ratio: 1.0
Avg train time: 3.016815757751465
Std train time: 1.5821645012570587
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8492, 'compress@10': 1.0, 'time@10': 2.5106}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8492, 'compress@10': 1.0, 'time@10': 2.5106}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 2.2693}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 2.2693}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8495, 'compress@10': 1.0, 'time@10': 1.7651}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8495, 'compress@10': 1.0, 'time@10': 1.7651}:  30%|███       | 3/10 [00:03<00:07,  1.13s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 1.7702}:  30%|███       | 3/10 [00:05<00:07,  1.13s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 1.7702}:  40%|████      | 4/10 [00:05<00:08,  1.40s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0381, 'hit_ratio@10': 0.792, 'ndcg@10': 0.8495, 'compress@10': 1.0, 'time@10': 2.7415}:  40%|████      | 4/10 [00:08<00:08,  1.40s/it] {'epoch': 4, 'num_users': 5.8, 'loss': 0.0381, 'hit_ratio@10': 0.792, 'ndcg@10': 0.8495, 'compress@10': 1.0, 'time@10': 2.7415}:  50%|█████     | 5/10 [00:08<00:10,  2.10s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0408, 'hit_ratio@10': 0.7934, 'ndcg@10': 0.8504, 'compress@10': 1.0, 'time@10': 2.7835}:  50%|█████     | 5/10 [00:11<00:10,  2.10s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0408, 'hit_ratio@10': 0.7934, 'ndcg@10': 0.8504, 'compress@10': 1.0, 'time@10': 2.7835}:  60%|██████    | 6/10 [00:11<00:09,  2.42s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.04, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 2.84}:  60%|██████    | 6/10 [00:13<00:09,  2.42s/it]    {'epoch': 4, 'num_users': 6.2857, 'loss': 0.04, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 2.84}:  70%|███████   | 7/10 [00:13<00:06,  2.16s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0386, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 2.7747}:  70%|███████   | 7/10 [00:15<00:06,  2.16s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0386, 'hit_ratio@10': 0.8329, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 2.7747}:  80%|████████  | 8/10 [00:15<00:04,  2.22s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0373, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 2.9764}:  80%|████████  | 8/10 [00:18<00:04,  2.22s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0373, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8645, 'compress@10': 1.0, 'time@10': 2.9764}:  90%|█████████ | 9/10 [00:18<00:02,  2.26s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 2.9634}:  90%|█████████ | 9/10 [00:21<00:02,  2.26s/it]    {'epoch': 4, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 2.9634}: 100%|██████████| 10/10 [00:21<00:00,  2.45s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0369, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 2.9634}: 100%|██████████| 10/10 [00:21<00:00,  2.11s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.036935996511335126
Avg hit ratio: 0.8360470751659207
Avg ndcg: 0.8651723989575437
Avg compression ratio: 1.0
Avg train time: 2.9634196043014525
Std train time: 1.5453031952288603
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0412, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8204, 'compress@10': 1.0, 'time@10': 2.5}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0412, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8204, 'compress@10': 1.0, 'time@10': 2.5}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 2.2779}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0336, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 2.2779}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 1.7646}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 1.7646}:  30%|███       | 3/10 [00:03<00:07,  1.14s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.7723, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 1.7624}:  30%|███       | 3/10 [00:05<00:07,  1.14s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.7723, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 1.7624}:  40%|████      | 4/10 [00:05<00:08,  1.39s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.032, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8627, 'compress@10': 1.0, 'time@10': 2.7637}:  40%|████      | 4/10 [00:08<00:08,  1.39s/it] {'epoch': 5, 'num_users': 5.8, 'loss': 0.032, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8627, 'compress@10': 1.0, 'time@10': 2.7637}:  50%|█████     | 5/10 [00:08<00:10,  2.12s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0338, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 2.816}:  50%|█████     | 5/10 [00:12<00:10,  2.12s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0338, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 2.816}:  60%|██████    | 6/10 [00:12<00:09,  2.46s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 2.8757}:  60%|██████    | 6/10 [00:13<00:09,  2.46s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0333, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8654, 'compress@10': 1.0, 'time@10': 2.8757}:  70%|███████   | 7/10 [00:13<00:06,  2.19s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0309, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 2.7965}:  70%|███████   | 7/10 [00:16<00:06,  2.19s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0309, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 2.7965}:  80%|████████  | 8/10 [00:16<00:04,  2.22s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0297, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 3.0009}:  80%|████████  | 8/10 [00:18<00:04,  2.22s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0297, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 3.0009}:  90%|█████████ | 9/10 [00:18<00:02,  2.26s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.8804, 'compress@10': 1.0, 'time@10': 2.9902}:  90%|█████████ | 9/10 [00:21<00:02,  2.26s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.8804, 'compress@10': 1.0, 'time@10': 2.9902}: 100%|██████████| 10/10 [00:21<00:00,  2.46s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.8486, 'ndcg@10': 0.8804, 'compress@10': 1.0, 'time@10': 2.9902}: 100%|██████████| 10/10 [00:21<00:00,  2.13s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.02920492622724727
Avg hit ratio: 0.8485968121672706
Avg ndcg: 0.8804070569069851
Avg compression ratio: 1.0
Avg train time: 2.9901594161987304
Std train time: 1.5916580680557377
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8758, 'compress@10': 1.0, 'time@10': 2.4744}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8758, 'compress@10': 1.0, 'time@10': 2.4744}:  10%|█         | 1/10 [00:01<00:11,  1.26s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 2.2743}:  10%|█         | 1/10 [00:03<00:11,  1.26s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 2.2743}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.878, 'compress@10': 1.0, 'time@10': 1.768}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.878, 'compress@10': 1.0, 'time@10': 1.768}:  30%|███       | 3/10 [00:03<00:07,  1.14s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 1.7891}:  30%|███       | 3/10 [00:05<00:07,  1.14s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 1.7891}:  40%|████      | 4/10 [00:05<00:08,  1.43s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0232, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8992, 'compress@10': 1.0, 'time@10': 2.8067}:  40%|████      | 4/10 [00:09<00:08,  1.43s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0232, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8992, 'compress@10': 1.0, 'time@10': 2.8067}:  50%|█████     | 5/10 [00:09<00:10,  2.17s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0242, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9026, 'compress@10': 1.0, 'time@10': 2.8334}:  50%|█████     | 5/10 [00:12<00:10,  2.17s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0242, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9026, 'compress@10': 1.0, 'time@10': 2.8334}:  60%|██████    | 6/10 [00:12<00:09,  2.45s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0237, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 2.8826}:  60%|██████    | 6/10 [00:13<00:09,  2.45s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0237, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 2.8826}:  70%|███████   | 7/10 [00:13<00:06,  2.18s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0247, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9162, 'compress@10': 1.0, 'time@10': 2.8066}:  70%|███████   | 7/10 [00:16<00:06,  2.18s/it]  {'epoch': 6, 'num_users': 6.125, 'loss': 0.0247, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9162, 'compress@10': 1.0, 'time@10': 2.8066}:  80%|████████  | 8/10 [00:16<00:04,  2.22s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.023, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9204, 'compress@10': 1.0, 'time@10': 2.9995}:  80%|████████  | 8/10 [00:18<00:04,  2.22s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.023, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9204, 'compress@10': 1.0, 'time@10': 2.9995}:  90%|█████████ | 9/10 [00:18<00:02,  2.24s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.923, 'compress@10': 1.0, 'time@10': 2.9773}:  90%|█████████ | 9/10 [00:21<00:02,  2.24s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.923, 'compress@10': 1.0, 'time@10': 2.9773}: 100%|██████████| 10/10 [00:21<00:00,  2.42s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0221, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.923, 'compress@10': 1.0, 'time@10': 2.9773}: 100%|██████████| 10/10 [00:21<00:00,  2.12s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.02205630789906257
Avg hit ratio: 0.8983862858514812
Avg ndcg: 0.9229822599233864
Avg compression ratio: 1.0
Avg train time: 2.977313256263733
Std train time: 1.5971444069143803
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.901, 'compress@10': 1.0, 'time@10': 2.5551}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.901, 'compress@10': 1.0, 'time@10': 2.5551}:  10%|█         | 1/10 [00:01<00:11,  1.31s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9255, 'compress@10': 1.0, 'time@10': 2.3164}:  10%|█         | 1/10 [00:03<00:11,  1.31s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9255, 'compress@10': 1.0, 'time@10': 2.3164}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9027, 'compress@10': 1.0, 'time@10': 1.7982}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9027, 'compress@10': 1.0, 'time@10': 1.7982}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9214, 'compress@10': 1.0, 'time@10': 1.8222}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9214, 'compress@10': 1.0, 'time@10': 1.8222}:  40%|████      | 4/10 [00:05<00:08,  1.46s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0229, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9239, 'compress@10': 1.0, 'time@10': 2.8151}:  40%|████      | 4/10 [00:09<00:08,  1.46s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0229, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.9239, 'compress@10': 1.0, 'time@10': 2.8151}:  50%|█████     | 5/10 [00:09<00:10,  2.17s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.9287, 'compress@10': 1.0, 'time@10': 2.8447}:  50%|█████     | 5/10 [00:12<00:10,  2.17s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0248, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.9287, 'compress@10': 1.0, 'time@10': 2.8447}:  60%|██████    | 6/10 [00:12<00:09,  2.46s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0234, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9277, 'compress@10': 1.0, 'time@10': 2.9119}:  60%|██████    | 6/10 [00:13<00:09,  2.46s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0234, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9277, 'compress@10': 1.0, 'time@10': 2.9119}:  70%|███████   | 7/10 [00:13<00:06,  2.21s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0302, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9405, 'compress@10': 1.0, 'time@10': 2.8236}:  70%|███████   | 7/10 [00:16<00:06,  2.21s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.0302, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9405, 'compress@10': 1.0, 'time@10': 2.8236}:  80%|████████  | 8/10 [00:16<00:04,  2.32s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0303, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9433, 'compress@10': 1.0, 'time@10': 3.0401}:  80%|████████  | 8/10 [00:18<00:04,  2.32s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0303, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9433, 'compress@10': 1.0, 'time@10': 3.0401}:  90%|█████████ | 9/10 [00:18<00:02,  2.35s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0308, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 3.0212}:  90%|█████████ | 9/10 [00:21<00:02,  2.35s/it]    {'epoch': 7, 'num_users': 6.3, 'loss': 0.0308, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 3.0212}: 100%|██████████| 10/10 [00:21<00:00,  2.52s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0308, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 3.0212}: 100%|██████████| 10/10 [00:21<00:00,  2.18s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.03081604641412783
Avg hit ratio: 0.8820401786479884
Avg ndcg: 0.9486525179263715
Avg compression ratio: 1.0
Avg train time: 3.0212420225143433
Std train time: 1.5970894911810734
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 2.5713}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0417, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 2.5713}:  10%|█         | 1/10 [00:01<00:11,  1.32s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9174, 'compress@10': 1.0, 'time@10': 2.3396}:  10%|█         | 1/10 [00:03<00:11,  1.32s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9174, 'compress@10': 1.0, 'time@10': 2.3396}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 1.8162}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8199, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 1.8162}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.9375, 'compress@10': 1.0, 'time@10': 1.8001}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.8381, 'ndcg@10': 0.9375, 'compress@10': 1.0, 'time@10': 1.8001}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0374, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9247, 'compress@10': 1.0, 'time@10': 2.8108}:  40%|████      | 4/10 [00:09<00:08,  1.41s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0374, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9247, 'compress@10': 1.0, 'time@10': 2.8108}:  50%|█████     | 5/10 [00:09<00:10,  2.15s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0353, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9284, 'compress@10': 1.0, 'time@10': 2.8329}:  50%|█████     | 5/10 [00:12<00:10,  2.15s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0353, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9284, 'compress@10': 1.0, 'time@10': 2.8329}:  60%|██████    | 6/10 [00:12<00:09,  2.43s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0659, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8938, 'compress@10': 1.0, 'time@10': 2.8804}:  60%|██████    | 6/10 [00:13<00:09,  2.43s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0659, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.8938, 'compress@10': 1.0, 'time@10': 2.8804}:  70%|███████   | 7/10 [00:13<00:06,  2.16s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0593, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 2.7952}:  70%|███████   | 7/10 [00:15<00:06,  2.16s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0593, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 2.7952}:  80%|████████  | 8/10 [00:15<00:04,  2.19s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0561, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.9051, 'compress@10': 1.0, 'time@10': 3.003}:  80%|████████  | 8/10 [00:18<00:04,  2.19s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0561, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.9051, 'compress@10': 1.0, 'time@10': 3.003}:  90%|█████████ | 9/10 [00:18<00:02,  2.24s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0518, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9124, 'compress@10': 1.0, 'time@10': 2.9914}:  90%|█████████ | 9/10 [00:21<00:02,  2.24s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0518, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9124, 'compress@10': 1.0, 'time@10': 2.9914}: 100%|██████████| 10/10 [00:21<00:00,  2.45s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0518, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9124, 'compress@10': 1.0, 'time@10': 2.9914}: 100%|██████████| 10/10 [00:21<00:00,  2.12s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.051839107785385655
Avg hit ratio: 0.8579587923866363
Avg ndcg: 0.9123558276891337
Avg compression ratio: 1.0
Avg train time: 2.9914305448532104
Std train time: 1.6069334865843106
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 2.4498}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8945, 'compress@10': 1.0, 'time@10': 2.4498}:  10%|█         | 1/10 [00:01<00:11,  1.25s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9279, 'compress@10': 1.0, 'time@10': 2.1976}:  10%|█         | 1/10 [00:03<00:11,  1.25s/it] {'epoch': 9, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9279, 'compress@10': 1.0, 'time@10': 2.1976}:  20%|██        | 2/10 [00:03<00:13,  1.69s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 1.7268}:  20%|██        | 2/10 [00:03<00:13,  1.69s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.8698, 'compress@10': 1.0, 'time@10': 1.7268}:  30%|███       | 3/10 [00:03<00:07,  1.12s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.8898, 'compress@10': 1.0, 'time@10': 1.7365}:  30%|███       | 3/10 [00:05<00:07,  1.12s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.8898, 'compress@10': 1.0, 'time@10': 1.7365}:  40%|████      | 4/10 [00:05<00:08,  1.38s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9043, 'compress@10': 1.0, 'time@10': 2.7427}:  40%|████      | 4/10 [00:08<00:08,  1.38s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0257, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9043, 'compress@10': 1.0, 'time@10': 2.7427}:  50%|█████     | 5/10 [00:08<00:10,  2.12s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0263, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9099, 'compress@10': 1.0, 'time@10': 2.7842}:  50%|█████     | 5/10 [00:11<00:10,  2.12s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0263, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9099, 'compress@10': 1.0, 'time@10': 2.7842}:  60%|██████    | 6/10 [00:11<00:09,  2.42s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.025, 'hit_ratio@10': 0.9206, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 2.8505}:  60%|██████    | 6/10 [00:13<00:09,  2.42s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.025, 'hit_ratio@10': 0.9206, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 2.8505}:  70%|███████   | 7/10 [00:13<00:06,  2.17s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.9269, 'ndcg@10': 0.912, 'compress@10': 1.0, 'time@10': 2.7787}:  70%|███████   | 7/10 [00:15<00:06,  2.17s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.9269, 'ndcg@10': 0.912, 'compress@10': 1.0, 'time@10': 2.7787}:  80%|████████  | 8/10 [00:15<00:04,  2.22s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0233, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 2.9791}:  80%|████████  | 8/10 [00:18<00:04,  2.22s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0233, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 2.9791}:  90%|█████████ | 9/10 [00:18<00:02,  2.25s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 2.9776}:  90%|█████████ | 9/10 [00:21<00:02,  2.25s/it]    {'epoch': 9, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 2.9776}: 100%|██████████| 10/10 [00:21<00:00,  2.48s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 2.9776}: 100%|██████████| 10/10 [00:21<00:00,  2.12s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.02223993458601982
Avg hit ratio: 0.9049735874387826
Avg ndcg: 0.9223400135513911
Avg compression ratio: 1.0
Avg train time: 2.9775893449783326
Std train time: 1.5851574901703867
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9158, 'compress@10': 1.0, 'time@10': 2.4206}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9158, 'compress@10': 1.0, 'time@10': 2.4206}:  10%|█         | 1/10 [00:01<00:11,  1.24s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9375, 'compress@10': 1.0, 'time@10': 2.2208}:  10%|█         | 1/10 [00:03<00:11,  1.24s/it]  {'epoch': 10, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9375, 'compress@10': 1.0, 'time@10': 2.2208}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8776, 'compress@10': 1.0, 'time@10': 1.7214}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8776, 'compress@10': 1.0, 'time@10': 1.7214}:  30%|███       | 3/10 [00:03<00:07,  1.11s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0347, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8726, 'compress@10': 1.0, 'time@10': 1.7542}:  30%|███       | 3/10 [00:05<00:07,  1.11s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0347, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8726, 'compress@10': 1.0, 'time@10': 1.7542}:  40%|████      | 4/10 [00:05<00:08,  1.42s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.04, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.8736, 'compress@10': 1.0, 'time@10': 2.803}:  40%|████      | 4/10 [00:09<00:08,  1.42s/it]   {'epoch': 10, 'num_users': 5.8, 'loss': 0.04, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.8736, 'compress@10': 1.0, 'time@10': 2.803}:  50%|█████     | 5/10 [00:09<00:10,  2.18s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0377, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.8833, 'compress@10': 1.0, 'time@10': 2.8324}:  50%|█████     | 5/10 [00:12<00:10,  2.18s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0377, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.8833, 'compress@10': 1.0, 'time@10': 2.8324}:  60%|██████    | 6/10 [00:12<00:09,  2.47s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0339, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 2.8897}:  60%|██████    | 6/10 [00:13<00:09,  2.47s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0339, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 2.8897}:  70%|███████   | 7/10 [00:13<00:06,  2.20s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0315, 'hit_ratio@10': 0.905, 'ndcg@10': 0.8974, 'compress@10': 1.0, 'time@10': 2.8122}:  70%|███████   | 7/10 [00:16<00:06,  2.20s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.0315, 'hit_ratio@10': 0.905, 'ndcg@10': 0.8974, 'compress@10': 1.0, 'time@10': 2.8122}:  80%|████████  | 8/10 [00:16<00:04,  2.23s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0376, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 3.011}:  80%|████████  | 8/10 [00:18<00:04,  2.23s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0376, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 3.011}:  90%|█████████ | 9/10 [00:18<00:02,  2.26s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 2.9907}:  90%|█████████ | 9/10 [00:21<00:02,  2.26s/it]  {'epoch': 10, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 2.9907}: 100%|██████████| 10/10 [00:21<00:00,  2.54s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 2.9907}: 100%|██████████| 10/10 [00:21<00:00,  2.16s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03578870091987171
Avg hit ratio: 0.9017477809871698
Avg ndcg: 0.9271585605452304
Avg compression ratio: 1.0
Avg train time: 2.9906582832336426
Std train time: 1.642194546573897
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9171, 'compress@10': 1.0, 'time@10': 2.4111}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9171, 'compress@10': 1.0, 'time@10': 2.4111}:  10%|█         | 1/10 [00:01<00:11,  1.24s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9336, 'compress@10': 1.0, 'time@10': 2.2195}:  10%|█         | 1/10 [00:03<00:11,  1.24s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9336, 'compress@10': 1.0, 'time@10': 2.2195}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8991, 'compress@10': 1.0, 'time@10': 1.7407}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8991, 'compress@10': 1.0, 'time@10': 1.7407}:  30%|███       | 3/10 [00:03<00:07,  1.13s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 1.7812}:  30%|███       | 3/10 [00:05<00:07,  1.13s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 1.7812}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0788, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 2.7748}:  40%|████      | 4/10 [00:09<00:08,  1.44s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0788, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 2.7748}:  50%|█████     | 5/10 [00:09<00:10,  2.15s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0805, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9638, 'compress@10': 1.0, 'time@10': 2.817}:  50%|█████     | 5/10 [00:12<00:10,  2.15s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0805, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9638, 'compress@10': 1.0, 'time@10': 2.817}:  60%|██████    | 6/10 [00:12<00:09,  2.46s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.1032, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.96, 'compress@10': 1.0, 'time@10': 2.87}:  60%|██████    | 6/10 [00:13<00:09,  2.46s/it]   {'epoch': 11, 'num_users': 6.2857, 'loss': 0.1032, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.96, 'compress@10': 1.0, 'time@10': 2.87}:  70%|███████   | 7/10 [00:13<00:06,  2.19s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0938, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9568, 'compress@10': 1.0, 'time@10': 2.7882}:  70%|███████   | 7/10 [00:15<00:06,  2.19s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0938, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9568, 'compress@10': 1.0, 'time@10': 2.7882}:  80%|████████  | 8/10 [00:15<00:04,  2.20s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0865, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9508, 'compress@10': 1.0, 'time@10': 2.9935}:  80%|████████  | 8/10 [00:18<00:04,  2.20s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0865, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9508, 'compress@10': 1.0, 'time@10': 2.9935}:  90%|█████████ | 9/10 [00:18<00:02,  2.25s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.106, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9697, 'compress@10': 1.0, 'time@10': 2.9756}:  90%|█████████ | 9/10 [00:21<00:02,  2.25s/it]     {'epoch': 11, 'num_users': 6.3, 'loss': 0.106, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9697, 'compress@10': 1.0, 'time@10': 2.9756}: 100%|██████████| 10/10 [00:21<00:00,  2.43s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.106, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9697, 'compress@10': 1.0, 'time@10': 2.9756}: 100%|██████████| 10/10 [00:21<00:00,  2.12s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.10603995068189756
Avg hit ratio: 0.8880270250406074
Avg ndcg: 0.9697184180585566
Avg compression ratio: 1.0
Avg train time: 2.9755840063095094
Std train time: 1.575478731100575
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.2034, 'hit_ratio@10': 0.8421, 'ndcg@10': 1.0027, 'compress@10': 1.0, 'time@10': 2.6032}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.2034, 'hit_ratio@10': 0.8421, 'ndcg@10': 1.0027, 'compress@10': 1.0, 'time@10': 2.6032}:  10%|█         | 1/10 [00:01<00:11,  1.33s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.1174, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9573, 'compress@10': 1.0, 'time@10': 2.3098}:  10%|█         | 1/10 [00:03<00:11,  1.33s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.1174, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9573, 'compress@10': 1.0, 'time@10': 2.3098}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0816, 'hit_ratio@10': 0.7723, 'ndcg@10': 0.9239, 'compress@10': 1.0, 'time@10': 1.8118}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0816, 'hit_ratio@10': 0.7723, 'ndcg@10': 0.9239, 'compress@10': 1.0, 'time@10': 1.8118}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0684, 'hit_ratio@10': 0.8024, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 1.8185}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0684, 'hit_ratio@10': 0.8024, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 1.8185}:  40%|████      | 4/10 [00:05<00:08,  1.45s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.1025, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.9471, 'compress@10': 1.0, 'time@10': 2.8139}:  40%|████      | 4/10 [00:09<00:08,  1.45s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.1025, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.9471, 'compress@10': 1.0, 'time@10': 2.8139}:  50%|█████     | 5/10 [00:09<00:10,  2.16s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.1015, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 2.8347}:  50%|█████     | 5/10 [00:12<00:10,  2.16s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.1015, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 2.8347}:  60%|██████    | 6/10 [00:12<00:09,  2.44s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0882, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 2.9268}:  60%|██████    | 6/10 [00:13<00:09,  2.44s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0882, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 2.9268}:  70%|███████   | 7/10 [00:13<00:06,  2.22s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.1223, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9729, 'compress@10': 1.0, 'time@10': 2.839}:  70%|███████   | 7/10 [00:16<00:06,  2.22s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.1223, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9729, 'compress@10': 1.0, 'time@10': 2.839}:  80%|████████  | 8/10 [00:16<00:04,  2.23s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.1263, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9682, 'compress@10': 1.0, 'time@10': 3.0222}:  80%|████████  | 8/10 [00:18<00:04,  2.23s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.1263, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9682, 'compress@10': 1.0, 'time@10': 3.0222}:  90%|█████████ | 9/10 [00:18<00:02,  2.25s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.1602, 'hit_ratio@10': 0.8748, 'ndcg@10': 1.0082, 'compress@10': 1.0, 'time@10': 3.0037}:  90%|█████████ | 9/10 [00:21<00:02,  2.25s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.1602, 'hit_ratio@10': 0.8748, 'ndcg@10': 1.0082, 'compress@10': 1.0, 'time@10': 3.0037}: 100%|██████████| 10/10 [00:21<00:00,  2.44s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.1602, 'hit_ratio@10': 0.8748, 'ndcg@10': 1.0082, 'compress@10': 1.0, 'time@10': 3.0037}: 100%|██████████| 10/10 [00:21<00:00,  2.13s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.16022295303110265
Avg hit ratio: 0.8747654301932741
Avg ndcg: 1.0081614662408769
Avg compression ratio: 1.0
Avg train time: 3.0036977529525757
Std train time: 1.5724893334966998
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.7865, 'hit_ratio@10': 0.6316, 'ndcg@10': 1.7443, 'compress@10': 1.0, 'time@10': 2.401}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.7865, 'hit_ratio@10': 0.6316, 'ndcg@10': 1.7443, 'compress@10': 1.0, 'time@10': 2.401}:  10%|█         | 1/10 [00:01<00:11,  1.23s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.7183, 'hit_ratio@10': 0.59, 'ndcg@10': 1.3866, 'compress@10': 1.0, 'time@10': 2.2174}:  10%|█         | 1/10 [00:03<00:11,  1.23s/it] {'epoch': 13, 'num_users': 7.0, 'loss': 0.7183, 'hit_ratio@10': 0.59, 'ndcg@10': 1.3866, 'compress@10': 1.0, 'time@10': 2.2174}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.4813, 'hit_ratio@10': 0.679, 'ndcg@10': 1.214, 'compress@10': 1.0, 'time@10': 1.7231}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.4813, 'hit_ratio@10': 0.679, 'ndcg@10': 1.214, 'compress@10': 1.0, 'time@10': 1.7231}:  30%|███       | 3/10 [00:03<00:07,  1.11s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.3872, 'hit_ratio@10': 0.7236, 'ndcg@10': 1.1628, 'compress@10': 1.0, 'time@10': 1.7318}:  30%|███       | 3/10 [00:05<00:07,  1.11s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.3872, 'hit_ratio@10': 0.7236, 'ndcg@10': 1.1628, 'compress@10': 1.0, 'time@10': 1.7318}:  40%|████      | 4/10 [00:05<00:08,  1.38s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.3226, 'hit_ratio@10': 0.7749, 'ndcg@10': 1.113, 'compress@10': 1.0, 'time@10': 2.7266}:  40%|████      | 4/10 [00:08<00:08,  1.38s/it] {'epoch': 13, 'num_users': 5.8, 'loss': 0.3226, 'hit_ratio@10': 0.7749, 'ndcg@10': 1.113, 'compress@10': 1.0, 'time@10': 2.7266}:  50%|█████     | 5/10 [00:08<00:10,  2.10s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.2785, 'hit_ratio@10': 0.805, 'ndcg@10': 1.0831, 'compress@10': 1.0, 'time@10': 2.7588}:  50%|█████     | 5/10 [00:11<00:10,  2.10s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.2785, 'hit_ratio@10': 0.805, 'ndcg@10': 1.0831, 'compress@10': 1.0, 'time@10': 2.7588}:  60%|██████    | 6/10 [00:11<00:09,  2.39s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.2428, 'hit_ratio@10': 0.8271, 'ndcg@10': 1.0631, 'compress@10': 1.0, 'time@10': 2.8435}:  60%|██████    | 6/10 [00:13<00:09,  2.39s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.2428, 'hit_ratio@10': 0.8271, 'ndcg@10': 1.0631, 'compress@10': 1.0, 'time@10': 2.8435}:  70%|███████   | 7/10 [00:13<00:06,  2.17s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.2574, 'hit_ratio@10': 0.8452, 'ndcg@10': 1.1216, 'compress@10': 1.0, 'time@10': 2.7711}:  70%|███████   | 7/10 [00:15<00:06,  2.17s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.2574, 'hit_ratio@10': 0.8452, 'ndcg@10': 1.1216, 'compress@10': 1.0, 'time@10': 2.7711}:  80%|████████  | 8/10 [00:15<00:04,  2.21s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.2709, 'hit_ratio@10': 0.8401, 'ndcg@10': 1.1438, 'compress@10': 1.0, 'time@10': 3.0045}:  80%|████████  | 8/10 [00:18<00:04,  2.21s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.2709, 'hit_ratio@10': 0.8401, 'ndcg@10': 1.1438, 'compress@10': 1.0, 'time@10': 3.0045}:  90%|█████████ | 9/10 [00:18<00:02,  2.29s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.2507, 'hit_ratio@10': 0.8539, 'ndcg@10': 1.1317, 'compress@10': 1.0, 'time@10': 2.9954}:  90%|█████████ | 9/10 [00:21<00:02,  2.29s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.2507, 'hit_ratio@10': 0.8539, 'ndcg@10': 1.1317, 'compress@10': 1.0, 'time@10': 2.9954}: 100%|██████████| 10/10 [00:21<00:00,  2.49s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.2507, 'hit_ratio@10': 0.8539, 'ndcg@10': 1.1317, 'compress@10': 1.0, 'time@10': 2.9954}: 100%|██████████| 10/10 [00:21<00:00,  2.12s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.2506523534619321
Avg hit ratio: 0.8538508612685183
Avg ndcg: 1.131745935713782
Avg compression ratio: 1.0
Avg train time: 2.9954002857208253
Std train time: 1.6088038709166053
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.1497, 'hit_ratio@10': 0.7895, 'ndcg@10': 1.0746, 'compress@10': 1.0, 'time@10': 2.4394}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.1497, 'hit_ratio@10': 0.7895, 'ndcg@10': 1.0746, 'compress@10': 1.0, 'time@10': 2.4394}:  10%|█         | 1/10 [00:01<00:11,  1.25s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.2886, 'hit_ratio@10': 0.6528, 'ndcg@10': 1.1413, 'compress@10': 1.0, 'time@10': 2.2453}:  10%|█         | 1/10 [00:03<00:11,  1.25s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.2886, 'hit_ratio@10': 0.6528, 'ndcg@10': 1.1413, 'compress@10': 1.0, 'time@10': 2.2453}:  20%|██        | 2/10 [00:03<00:15,  1.92s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.1936, 'hit_ratio@10': 0.7209, 'ndcg@10': 1.0466, 'compress@10': 1.0, 'time@10': 1.7977}:  20%|██        | 2/10 [00:04<00:15,  1.92s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.1936, 'hit_ratio@10': 0.7209, 'ndcg@10': 1.0466, 'compress@10': 1.0, 'time@10': 1.7977}:  30%|███       | 3/10 [00:04<00:08,  1.26s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.2638, 'hit_ratio@10': 0.7193, 'ndcg@10': 1.067, 'compress@10': 1.0, 'time@10': 1.8055}:  30%|███       | 3/10 [00:06<00:08,  1.26s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.2638, 'hit_ratio@10': 0.7193, 'ndcg@10': 1.067, 'compress@10': 1.0, 'time@10': 1.8055}:  40%|████      | 4/10 [00:06<00:09,  1.52s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.3968, 'hit_ratio@10': 0.7554, 'ndcg@10': 1.2515, 'compress@10': 1.0, 'time@10': 2.7935}:  40%|████      | 4/10 [00:09<00:09,  1.52s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.3968, 'hit_ratio@10': 0.7554, 'ndcg@10': 1.2515, 'compress@10': 1.0, 'time@10': 2.7935}:  50%|█████     | 5/10 [00:09<00:10,  2.20s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.4163, 'hit_ratio@10': 0.7554, 'ndcg@10': 1.2719, 'compress@10': 1.0, 'time@10': 2.8604}:  50%|█████     | 5/10 [00:12<00:10,  2.20s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.4163, 'hit_ratio@10': 0.7554, 'ndcg@10': 1.2719, 'compress@10': 1.0, 'time@10': 2.8604}:  60%|██████    | 6/10 [00:12<00:10,  2.56s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.4504, 'hit_ratio@10': 0.7561, 'ndcg@10': 1.2727, 'compress@10': 1.0, 'time@10': 2.9565}:  60%|██████    | 6/10 [00:14<00:10,  2.56s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.4504, 'hit_ratio@10': 0.7561, 'ndcg@10': 1.2727, 'compress@10': 1.0, 'time@10': 2.9565}:  70%|███████   | 7/10 [00:14<00:06,  2.31s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.4452, 'hit_ratio@10': 0.783, 'ndcg@10': 1.3118, 'compress@10': 1.0, 'time@10': 2.8709}:  70%|███████   | 7/10 [00:16<00:06,  2.31s/it]  {'epoch': 14, 'num_users': 6.125, 'loss': 0.4452, 'hit_ratio@10': 0.783, 'ndcg@10': 1.3118, 'compress@10': 1.0, 'time@10': 2.8709}:  80%|████████  | 8/10 [00:16<00:04,  2.30s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.6248, 'hit_ratio@10': 0.7531, 'ndcg@10': 1.5537, 'compress@10': 1.0, 'time@10': 3.0659}:  80%|████████  | 8/10 [00:19<00:04,  2.30s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.6248, 'hit_ratio@10': 0.7531, 'ndcg@10': 1.5537, 'compress@10': 1.0, 'time@10': 3.0659}:  90%|█████████ | 9/10 [00:19<00:02,  2.32s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.6027, 'hit_ratio@10': 0.7528, 'ndcg@10': 1.5292, 'compress@10': 1.0, 'time@10': 3.0531}:  90%|█████████ | 9/10 [00:22<00:02,  2.32s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.6027, 'hit_ratio@10': 0.7528, 'ndcg@10': 1.5292, 'compress@10': 1.0, 'time@10': 3.0531}: 100%|██████████| 10/10 [00:22<00:00,  2.52s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.6027, 'hit_ratio@10': 0.7528, 'ndcg@10': 1.5292, 'compress@10': 1.0, 'time@10': 3.0531}: 100%|██████████| 10/10 [00:22<00:00,  2.21s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.6026990974349987
Avg hit ratio: 0.7528301129167003
Avg ndcg: 1.529151469886209
Avg compression ratio: 1.0
Avg train time: 3.0531222105026243
Std train time: 1.5648225979586061
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 3.2235, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5083}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 3.2235, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.5083}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 2.0719, 'hit_ratio@10': 0.3531, 'ndcg@10': 0.6453, 'compress@10': 1.0, 'time@10': 2.271}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 2.0719, 'hit_ratio@10': 0.3531, 'ndcg@10': 0.6453, 'compress@10': 1.0, 'time@10': 2.271}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 2.2498, 'hit_ratio@10': 0.2354, 'ndcg@10': 0.4302, 'compress@10': 1.0, 'time@10': 1.7608}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 2.2498, 'hit_ratio@10': 0.2354, 'ndcg@10': 0.4302, 'compress@10': 1.0, 'time@10': 1.7608}:  30%|███       | 3/10 [00:03<00:07,  1.14s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 1.7985, 'hit_ratio@10': 0.3373, 'ndcg@10': 0.7269, 'compress@10': 1.0, 'time@10': 1.7946}:  30%|███       | 3/10 [00:05<00:07,  1.14s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 1.7985, 'hit_ratio@10': 0.3373, 'ndcg@10': 0.7269, 'compress@10': 1.0, 'time@10': 1.7946}:  40%|████      | 4/10 [00:05<00:08,  1.45s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 1.9635, 'hit_ratio@10': 0.3498, 'ndcg@10': 1.093, 'compress@10': 1.0, 'time@10': 2.788}:  40%|████      | 4/10 [00:09<00:08,  1.45s/it]  {'epoch': 15, 'num_users': 5.8, 'loss': 1.9635, 'hit_ratio@10': 0.3498, 'ndcg@10': 1.093, 'compress@10': 1.0, 'time@10': 2.788}:  50%|█████     | 5/10 [00:09<00:10,  2.16s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 1.713, 'hit_ratio@10': 0.436, 'ndcg@10': 1.1471, 'compress@10': 1.0, 'time@10': 2.8336}:  50%|█████     | 5/10 [00:12<00:10,  2.16s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 1.713, 'hit_ratio@10': 0.436, 'ndcg@10': 1.1471, 'compress@10': 1.0, 'time@10': 2.8336}:  60%|██████    | 6/10 [00:12<00:09,  2.48s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 1.932, 'hit_ratio@10': 0.3965, 'ndcg@10': 0.9948, 'compress@10': 1.0, 'time@10': 2.8908}:  60%|██████    | 6/10 [00:13<00:09,  2.48s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 1.932, 'hit_ratio@10': 0.3965, 'ndcg@10': 0.9948, 'compress@10': 1.0, 'time@10': 2.8908}:  70%|███████   | 7/10 [00:13<00:06,  2.20s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 1.8193, 'hit_ratio@10': 0.422, 'ndcg@10': 1.0116, 'compress@10': 1.0, 'time@10': 2.8117}:  70%|███████   | 7/10 [00:16<00:06,  2.20s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 1.8193, 'hit_ratio@10': 0.422, 'ndcg@10': 1.0116, 'compress@10': 1.0, 'time@10': 2.8117}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 1.6853, 'hit_ratio@10': 0.4259, 'ndcg@10': 1.0469, 'compress@10': 1.0, 'time@10': 3.0336}:  80%|████████  | 8/10 [00:18<00:04,  2.28s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 1.6853, 'hit_ratio@10': 0.4259, 'ndcg@10': 1.0469, 'compress@10': 1.0, 'time@10': 3.0336}:  90%|█████████ | 9/10 [00:18<00:02,  2.33s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 1.6717, 'hit_ratio@10': 0.4606, 'ndcg@10': 1.1799, 'compress@10': 1.0, 'time@10': 3.0171}:  90%|█████████ | 9/10 [00:21<00:02,  2.33s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 1.6717, 'hit_ratio@10': 0.4606, 'ndcg@10': 1.1799, 'compress@10': 1.0, 'time@10': 3.0171}: 100%|██████████| 10/10 [00:21<00:00,  2.50s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 1.6717, 'hit_ratio@10': 0.4606, 'ndcg@10': 1.1799, 'compress@10': 1.0, 'time@10': 3.0171}: 100%|██████████| 10/10 [00:21<00:00,  2.16s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 1.671731525339871
Avg hit ratio: 0.46056757730102377
Avg ndcg: 1.1799238050001672
Avg compression ratio: 1.0
Avg train time: 3.0170746803283692
Std train time: 1.5983820230350338
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 3.1124, 'hit_ratio@10': 0.2632, 'ndcg@10': 10.7757, 'compress@10': 1.0, 'time@10': 2.4671}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 3.1124, 'hit_ratio@10': 0.2632, 'ndcg@10': 10.7757, 'compress@10': 1.0, 'time@10': 2.4671}:  10%|█         | 1/10 [00:01<00:11,  1.26s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 2.0257, 'hit_ratio@10': 0.3896, 'ndcg@10': 6.1663, 'compress@10': 1.0, 'time@10': 2.2623}:  10%|█         | 1/10 [00:03<00:11,  1.26s/it] {'epoch': 16, 'num_users': 7.0, 'loss': 2.0257, 'hit_ratio@10': 0.3896, 'ndcg@10': 6.1663, 'compress@10': 1.0, 'time@10': 2.2623}:  20%|██        | 2/10 [00:03<00:13,  1.75s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 2.1555, 'hit_ratio@10': 0.3074, 'ndcg@10': 4.1109, 'compress@10': 1.0, 'time@10': 1.7598}:  20%|██        | 2/10 [00:03<00:13,  1.75s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 2.1555, 'hit_ratio@10': 0.3074, 'ndcg@10': 4.1109, 'compress@10': 1.0, 'time@10': 1.7598}:  30%|███       | 3/10 [00:03<00:07,  1.14s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 2.4224, 'hit_ratio@10': 0.293, 'ndcg@10': 3.0832, 'compress@10': 1.0, 'time@10': 1.76}:  30%|███       | 3/10 [00:05<00:07,  1.14s/it]   {'epoch': 16, 'num_users': 5.0, 'loss': 2.4224, 'hit_ratio@10': 0.293, 'ndcg@10': 3.0832, 'compress@10': 1.0, 'time@10': 1.76}:  40%|████      | 4/10 [00:05<00:08,  1.39s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 2.0983, 'hit_ratio@10': 0.3984, 'ndcg@10': 2.8746, 'compress@10': 1.0, 'time@10': 2.7711}:  40%|████      | 4/10 [00:08<00:08,  1.39s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 2.0983, 'hit_ratio@10': 0.3984, 'ndcg@10': 2.8746, 'compress@10': 1.0, 'time@10': 2.7711}:  50%|█████     | 5/10 [00:08<00:10,  2.13s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 2.307, 'hit_ratio@10': 0.3728, 'ndcg@10': 2.3955, 'compress@10': 1.0, 'time@10': 2.8151}:  50%|█████     | 5/10 [00:12<00:10,  2.13s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 2.307, 'hit_ratio@10': 0.3728, 'ndcg@10': 2.3955, 'compress@10': 1.0, 'time@10': 2.8151}:  60%|██████    | 6/10 [00:12<00:09,  2.45s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 2.4094, 'hit_ratio@10': 0.3424, 'ndcg@10': 2.0533, 'compress@10': 1.0, 'time@10': 2.8695}:  60%|██████    | 6/10 [00:13<00:09,  2.45s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 2.4094, 'hit_ratio@10': 0.3424, 'ndcg@10': 2.0533, 'compress@10': 1.0, 'time@10': 2.8695}:  70%|███████   | 7/10 [00:13<00:06,  2.18s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 2.4006, 'hit_ratio@10': 0.3353, 'ndcg@10': 1.7966, 'compress@10': 1.0, 'time@10': 2.7852}:  70%|███████   | 7/10 [00:15<00:06,  2.18s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 2.4006, 'hit_ratio@10': 0.3353, 'ndcg@10': 1.7966, 'compress@10': 1.0, 'time@10': 2.7852}:  80%|████████  | 8/10 [00:15<00:04,  2.19s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 2.5715, 'hit_ratio@10': 0.3139, 'ndcg@10': 1.597, 'compress@10': 1.0, 'time@10': 2.9923}:  80%|████████  | 8/10 [00:18<00:04,  2.19s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 2.5715, 'hit_ratio@10': 0.3139, 'ndcg@10': 1.597, 'compress@10': 1.0, 'time@10': 2.9923}:  90%|█████████ | 9/10 [00:18<00:02,  2.24s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 2.6272, 'hit_ratio@10': 0.303, 'ndcg@10': 1.4373, 'compress@10': 1.0, 'time@10': 2.9842}:  90%|█████████ | 9/10 [00:21<00:02,  2.24s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 2.6272, 'hit_ratio@10': 0.303, 'ndcg@10': 1.4373, 'compress@10': 1.0, 'time@10': 2.9842}: 100%|██████████| 10/10 [00:21<00:00,  2.46s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 2.6272, 'hit_ratio@10': 0.303, 'ndcg@10': 1.4373, 'compress@10': 1.0, 'time@10': 2.9842}: 100%|██████████| 10/10 [00:21<00:00,  2.12s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 2.627197484689865
Avg hit ratio: 0.3029705397413377
Avg ndcg: 1.4372751280195213
Avg compression ratio: 1.0
Avg train time: 2.9842368841171263
Std train time: 1.6037000368470686
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 2.8818, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.4944}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 2.8818, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.4944}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 2.9474, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.2649}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 2.9474, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.2649}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 2.7156, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.7687}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 2.7156, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.7687}:  30%|███       | 3/10 [00:03<00:07,  1.14s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 2.7851, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.7946}:  30%|███       | 3/10 [00:05<00:07,  1.14s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 2.7851, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.7946}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 2.6664, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.008, 'compress@10': 1.0, 'time@10': 2.8023}:  40%|████      | 4/10 [00:09<00:08,  1.44s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 2.6664, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.008, 'compress@10': 1.0, 'time@10': 2.8023}:  50%|█████     | 5/10 [00:09<00:10,  2.16s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 2.691, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0123, 'compress@10': 1.0, 'time@10': 2.8202}:  50%|█████     | 5/10 [00:12<00:10,  2.16s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 2.691, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0123, 'compress@10': 1.0, 'time@10': 2.8202}:  60%|██████    | 6/10 [00:12<00:09,  2.43s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 2.7109, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0106, 'compress@10': 1.0, 'time@10': 2.8818}:  60%|██████    | 6/10 [00:13<00:09,  2.43s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 2.7109, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0106, 'compress@10': 1.0, 'time@10': 2.8818}:  70%|███████   | 7/10 [00:13<00:06,  2.17s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 2.6283, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.0093, 'compress@10': 1.0, 'time@10': 2.799}:  70%|███████   | 7/10 [00:15<00:06,  2.17s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 2.6283, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.0093, 'compress@10': 1.0, 'time@10': 2.799}:  80%|████████  | 8/10 [00:15<00:04,  2.20s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 2.7062, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0082, 'compress@10': 1.0, 'time@10': 3.0081}:  80%|████████  | 8/10 [00:18<00:04,  2.20s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 2.7062, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0082, 'compress@10': 1.0, 'time@10': 3.0081}:  90%|█████████ | 9/10 [00:18<00:02,  2.25s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 2.702, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0092, 'compress@10': 1.0, 'time@10': 2.9914}:  90%|█████████ | 9/10 [00:21<00:02,  2.25s/it]    {'epoch': 17, 'num_users': 6.3, 'loss': 2.702, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0092, 'compress@10': 1.0, 'time@10': 2.9914}: 100%|██████████| 10/10 [00:21<00:00,  2.44s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 2.702, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0092, 'compress@10': 1.0, 'time@10': 2.9914}: 100%|██████████| 10/10 [00:21<00:00,  2.12s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 2.702008842147661
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.009216060806116944
Avg compression ratio: 1.0
Avg train time: 2.9914209127426146
Std train time: 1.6008395508492255
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 2.5368, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 2.4051}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 2.5368, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 2.4051}:  10%|█         | 1/10 [00:01<00:11,  1.26s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 2.6231, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.034, 'compress@10': 1.0, 'time@10': 2.2287}:  10%|█         | 1/10 [00:03<00:11,  1.26s/it] {'epoch': 18, 'num_users': 7.0, 'loss': 2.6231, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.034, 'compress@10': 1.0, 'time@10': 2.2287}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 2.3921, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0227, 'compress@10': 1.0, 'time@10': 1.7476}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 2.3921, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0227, 'compress@10': 1.0, 'time@10': 1.7476}:  30%|███       | 3/10 [00:03<00:07,  1.14s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 2.4613, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0253, 'compress@10': 1.0, 'time@10': 1.752}:  30%|███       | 3/10 [00:05<00:07,  1.14s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 2.4613, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0253, 'compress@10': 1.0, 'time@10': 1.752}:  40%|████      | 4/10 [00:05<00:08,  1.40s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 2.3633, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.0282, 'compress@10': 1.0, 'time@10': 2.7754}:  40%|████      | 4/10 [00:09<00:08,  1.40s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 2.3633, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.0282, 'compress@10': 1.0, 'time@10': 2.7754}:  50%|█████     | 5/10 [00:09<00:10,  2.15s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 2.3943, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0292, 'compress@10': 1.0, 'time@10': 2.8139}:  50%|█████     | 5/10 [00:12<00:10,  2.15s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 2.3943, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0292, 'compress@10': 1.0, 'time@10': 2.8139}:  60%|██████    | 6/10 [00:12<00:09,  2.45s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 2.4077, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0301, 'compress@10': 1.0, 'time@10': 2.8658}:  60%|██████    | 6/10 [00:13<00:09,  2.45s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 2.4077, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0301, 'compress@10': 1.0, 'time@10': 2.8658}:  70%|███████   | 7/10 [00:13<00:06,  2.18s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 2.3313, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.032, 'compress@10': 1.0, 'time@10': 2.802}:  70%|███████   | 7/10 [00:16<00:06,  2.18s/it]   {'epoch': 18, 'num_users': 6.125, 'loss': 2.3313, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.032, 'compress@10': 1.0, 'time@10': 2.802}:  80%|████████  | 8/10 [00:16<00:04,  2.25s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 2.4076, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0319, 'compress@10': 1.0, 'time@10': 3.0229}:  80%|████████  | 8/10 [00:18<00:04,  2.25s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 2.4076, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0319, 'compress@10': 1.0, 'time@10': 3.0229}:  90%|█████████ | 9/10 [00:18<00:02,  2.30s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 2.4062, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0323, 'compress@10': 1.0, 'time@10': 3.0094}:  90%|█████████ | 9/10 [00:21<00:02,  2.30s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 2.4062, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0323, 'compress@10': 1.0, 'time@10': 3.0094}: 100%|██████████| 10/10 [00:21<00:00,  2.49s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 2.4062, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0323, 'compress@10': 1.0, 'time@10': 3.0094}: 100%|██████████| 10/10 [00:21<00:00,  2.14s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 2.406155024074309
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.03232146909311954
Avg compression ratio: 1.0
Avg train time: 3.0093621730804445
Std train time: 1.622199416064475
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 2.2769, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 2.5587}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 2.2769, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 2.5587}:  10%|█         | 1/10 [00:01<00:11,  1.31s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 2.366, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.034, 'compress@10': 1.0, 'time@10': 2.3812}:  10%|█         | 1/10 [00:03<00:11,  1.31s/it]  {'epoch': 19, 'num_users': 7.0, 'loss': 2.366, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.034, 'compress@10': 1.0, 'time@10': 2.3812}:  20%|██        | 2/10 [00:03<00:14,  1.85s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 2.1433, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0399, 'compress@10': 1.0, 'time@10': 1.838}:  20%|██        | 2/10 [00:03<00:14,  1.85s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 2.1433, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0399, 'compress@10': 1.0, 'time@10': 1.838}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 2.2101, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0382, 'compress@10': 1.0, 'time@10': 1.815}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 2.2101, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0382, 'compress@10': 1.0, 'time@10': 1.815}:  40%|████      | 4/10 [00:05<00:08,  1.42s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 2.1217, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.0385, 'compress@10': 1.0, 'time@10': 2.8824}:  40%|████      | 4/10 [00:09<00:08,  1.42s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 2.1217, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.0385, 'compress@10': 1.0, 'time@10': 2.8824}:  50%|█████     | 5/10 [00:09<00:11,  2.21s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 2.1525, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0378, 'compress@10': 1.0, 'time@10': 2.9088}:  50%|█████     | 5/10 [00:12<00:11,  2.21s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 2.1525, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0378, 'compress@10': 1.0, 'time@10': 2.9088}:  60%|██████    | 6/10 [00:12<00:10,  2.51s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 2.1635, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.9599}:  60%|██████    | 6/10 [00:14<00:10,  2.51s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 2.1635, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.9599}:  70%|███████   | 7/10 [00:14<00:06,  2.23s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 2.092, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.0384, 'compress@10': 1.0, 'time@10': 2.8661}:  70%|███████   | 7/10 [00:16<00:06,  2.23s/it]  {'epoch': 19, 'num_users': 6.125, 'loss': 2.092, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.0384, 'compress@10': 1.0, 'time@10': 2.8661}:  80%|████████  | 8/10 [00:16<00:04,  2.23s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 2.1648, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0377, 'compress@10': 1.0, 'time@10': 3.066}:  80%|████████  | 8/10 [00:18<00:04,  2.23s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 2.1648, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0377, 'compress@10': 1.0, 'time@10': 3.066}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 2.1638, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 3.0522}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 2.1638, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 3.0522}: 100%|██████████| 10/10 [00:21<00:00,  2.48s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 2.1638, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 3.0522}: 100%|██████████| 10/10 [00:21<00:00,  2.16s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 2.163802811423463
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.037492529089753944
Avg compression ratio: 1.0
Avg train time: 3.052185082435608
Std train time: 1.6776554149985154
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 2.0573, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 2.4809}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 2.0573, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 2.4809}:  10%|█         | 1/10 [00:01<00:11,  1.27s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 2.1441, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.034, 'compress@10': 1.0, 'time@10': 2.2513}:  10%|█         | 1/10 [00:03<00:11,  1.27s/it] {'epoch': 20, 'num_users': 7.0, 'loss': 2.1441, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.034, 'compress@10': 1.0, 'time@10': 2.2513}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 1.9317, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0399, 'compress@10': 1.0, 'time@10': 1.7822}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 1.9317, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0399, 'compress@10': 1.0, 'time@10': 1.7822}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 1.9959, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0382, 'compress@10': 1.0, 'time@10': 1.7793}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 1.9959, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0382, 'compress@10': 1.0, 'time@10': 1.7793}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 1.914, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.0385, 'compress@10': 1.0, 'time@10': 2.7545}:  40%|████      | 4/10 [00:08<00:08,  1.41s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 1.914, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.0385, 'compress@10': 1.0, 'time@10': 2.7545}:  50%|█████     | 5/10 [00:08<00:10,  2.11s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 1.9433, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0378, 'compress@10': 1.0, 'time@10': 2.8027}:  50%|█████     | 5/10 [00:12<00:10,  2.11s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 1.9433, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0378, 'compress@10': 1.0, 'time@10': 2.8027}:  60%|██████    | 6/10 [00:12<00:09,  2.44s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 1.953, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.8732}:  60%|██████    | 6/10 [00:13<00:09,  2.44s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 1.953, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.8732}:  70%|███████   | 7/10 [00:13<00:06,  2.19s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 1.8859, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.0384, 'compress@10': 1.0, 'time@10': 2.7977}:  70%|███████   | 7/10 [00:16<00:06,  2.19s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 1.8859, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.0384, 'compress@10': 1.0, 'time@10': 2.7977}:  80%|████████  | 8/10 [00:16<00:04,  2.23s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 1.955, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0377, 'compress@10': 1.0, 'time@10': 3.0001}:  80%|████████  | 8/10 [00:18<00:04,  2.23s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 1.955, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0377, 'compress@10': 1.0, 'time@10': 3.0001}:  90%|█████████ | 9/10 [00:18<00:02,  2.26s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 1.954, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.9908}:  90%|█████████ | 9/10 [00:21<00:02,  2.26s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 1.954, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.9908}: 100%|██████████| 10/10 [00:21<00:00,  2.47s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 1.954, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.9908}: 100%|██████████| 10/10 [00:21<00:00,  2.13s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 1.9539985044047725
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.037492529089753944
Avg compression ratio: 1.0
Avg train time: 2.990755224227905
Std train time: 1.5491705821137267
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 1.8639, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 2.54}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 1.8639, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 2.54}:  10%|█         | 1/10 [00:01<00:11,  1.30s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 1.9464, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.034, 'compress@10': 1.0, 'time@10': 2.2839}:  10%|█         | 1/10 [00:03<00:11,  1.30s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 1.9464, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.034, 'compress@10': 1.0, 'time@10': 2.2839}:  20%|██        | 2/10 [00:03<00:13,  1.75s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 1.7448, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0399, 'compress@10': 1.0, 'time@10': 1.7799}:  20%|██        | 2/10 [00:03<00:13,  1.75s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 1.7448, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0399, 'compress@10': 1.0, 'time@10': 1.7799}:  30%|███       | 3/10 [00:03<00:07,  1.14s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 1.8064, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0382, 'compress@10': 1.0, 'time@10': 1.7807}:  30%|███       | 3/10 [00:05<00:07,  1.14s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 1.8064, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0382, 'compress@10': 1.0, 'time@10': 1.7807}:  40%|████      | 4/10 [00:05<00:08,  1.40s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 1.7298, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.0385, 'compress@10': 1.0, 'time@10': 2.7847}:  40%|████      | 4/10 [00:09<00:08,  1.40s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 1.7298, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.0385, 'compress@10': 1.0, 'time@10': 2.7847}:  50%|█████     | 5/10 [00:09<00:10,  2.14s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 1.7573, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0378, 'compress@10': 1.0, 'time@10': 2.8096}:  50%|█████     | 5/10 [00:11<00:10,  2.14s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 1.7573, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0378, 'compress@10': 1.0, 'time@10': 2.8096}:  60%|██████    | 6/10 [00:11<00:09,  2.42s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 1.7661, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.8639}:  60%|██████    | 6/10 [00:13<00:09,  2.42s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 1.7661, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.8639}:  70%|███████   | 7/10 [00:13<00:06,  2.16s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 1.703, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.0384, 'compress@10': 1.0, 'time@10': 2.7886}:  70%|███████   | 7/10 [00:15<00:06,  2.16s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 1.703, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.0384, 'compress@10': 1.0, 'time@10': 2.7886}:  80%|████████  | 8/10 [00:15<00:04,  2.21s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 1.7685, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0377, 'compress@10': 1.0, 'time@10': 3.0031}:  80%|████████  | 8/10 [00:18<00:04,  2.21s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 1.7685, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0377, 'compress@10': 1.0, 'time@10': 3.0031}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 1.7673, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.9862}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 1.7673, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.9862}: 100%|██████████| 10/10 [00:21<00:00,  2.45s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 1.7673, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.9862}: 100%|██████████| 10/10 [00:21<00:00,  2.12s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 1.767315409418466
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.037492529089753944
Avg compression ratio: 1.0
Avg train time: 2.986187553405762
Std train time: 1.60045211801687
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 1.6898, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 2.652}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 1.6898, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 2.652}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 1.7675, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.034, 'compress@10': 1.0, 'time@10': 2.3256}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 1.7675, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.034, 'compress@10': 1.0, 'time@10': 2.3256}:  20%|██        | 2/10 [00:03<00:14,  1.75s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 1.5766, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0399, 'compress@10': 1.0, 'time@10': 1.8151}:  20%|██        | 2/10 [00:03<00:14,  1.75s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 1.5766, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0399, 'compress@10': 1.0, 'time@10': 1.8151}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 1.6355, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0382, 'compress@10': 1.0, 'time@10': 1.806}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 1.6355, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0382, 'compress@10': 1.0, 'time@10': 1.806}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 1.5638, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.0385, 'compress@10': 1.0, 'time@10': 2.8439}:  40%|████      | 4/10 [00:09<00:08,  1.41s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 1.5638, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.0385, 'compress@10': 1.0, 'time@10': 2.8439}:  50%|█████     | 5/10 [00:09<00:10,  2.17s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 1.5893, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0378, 'compress@10': 1.0, 'time@10': 2.8646}:  50%|█████     | 5/10 [00:12<00:10,  2.17s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 1.5893, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0378, 'compress@10': 1.0, 'time@10': 2.8646}:  60%|██████    | 6/10 [00:12<00:09,  2.45s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 1.5975, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.9183}:  60%|██████    | 6/10 [00:13<00:09,  2.45s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 1.5975, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.9183}:  70%|███████   | 7/10 [00:13<00:06,  2.19s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 1.5382, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.0384, 'compress@10': 1.0, 'time@10': 2.8338}:  70%|███████   | 7/10 [00:16<00:06,  2.19s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 1.5382, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.0384, 'compress@10': 1.0, 'time@10': 2.8338}:  80%|████████  | 8/10 [00:16<00:04,  2.22s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 1.6002, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0377, 'compress@10': 1.0, 'time@10': 3.0316}:  80%|████████  | 8/10 [00:18<00:04,  2.22s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 1.6002, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0377, 'compress@10': 1.0, 'time@10': 3.0316}:  90%|█████████ | 9/10 [00:18<00:02,  2.25s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 1.5987, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 3.0316}:  90%|█████████ | 9/10 [00:21<00:02,  2.25s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 1.5987, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 3.0316}: 100%|██████████| 10/10 [00:21<00:00,  2.50s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 1.5987, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 3.0316}: 100%|██████████| 10/10 [00:21<00:00,  2.15s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 1.5986993368507014
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.037492529089753944
Avg compression ratio: 1.0
Avg train time: 3.0315704107284547
Std train time: 1.6331913899494048
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 1.5314, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 2.4242}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 1.5314, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 2.4242}:  10%|█         | 1/10 [00:01<00:11,  1.24s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 1.6039, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.034, 'compress@10': 1.0, 'time@10': 2.2147}:  10%|█         | 1/10 [00:03<00:11,  1.24s/it] {'epoch': 23, 'num_users': 7.0, 'loss': 1.6039, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.034, 'compress@10': 1.0, 'time@10': 2.2147}:  20%|██        | 2/10 [00:03<00:13,  1.71s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 1.4235, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0399, 'compress@10': 1.0, 'time@10': 1.7357}:  20%|██        | 2/10 [00:03<00:13,  1.71s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 1.4235, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0399, 'compress@10': 1.0, 'time@10': 1.7357}:  30%|███       | 3/10 [00:03<00:07,  1.12s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 1.4799, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0382, 'compress@10': 1.0, 'time@10': 1.7486}:  30%|███       | 3/10 [00:05<00:07,  1.12s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 1.4799, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0382, 'compress@10': 1.0, 'time@10': 1.7486}:  40%|████      | 4/10 [00:05<00:08,  1.39s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 1.4128, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.0385, 'compress@10': 1.0, 'time@10': 2.7444}:  40%|████      | 4/10 [00:08<00:08,  1.39s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 1.4128, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.0385, 'compress@10': 1.0, 'time@10': 2.7444}:  50%|█████     | 5/10 [00:08<00:10,  2.12s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 1.4364, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0378, 'compress@10': 1.0, 'time@10': 2.7831}:  50%|█████     | 5/10 [00:11<00:10,  2.12s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 1.4364, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0378, 'compress@10': 1.0, 'time@10': 2.7831}:  60%|██████    | 6/10 [00:11<00:09,  2.42s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 1.444, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.8333}:  60%|██████    | 6/10 [00:13<00:09,  2.42s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 1.444, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.8333}:  70%|███████   | 7/10 [00:13<00:06,  2.15s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 1.3884, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.0384, 'compress@10': 1.0, 'time@10': 2.7563}:  70%|███████   | 7/10 [00:15<00:06,  2.15s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 1.3884, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.0384, 'compress@10': 1.0, 'time@10': 2.7563}:  80%|████████  | 8/10 [00:15<00:04,  2.18s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 1.4469, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0377, 'compress@10': 1.0, 'time@10': 2.9485}:  80%|████████  | 8/10 [00:18<00:04,  2.18s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 1.4469, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0377, 'compress@10': 1.0, 'time@10': 2.9485}:  90%|█████████ | 9/10 [00:18<00:02,  2.21s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 1.4451, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.9381}:  90%|█████████ | 9/10 [00:20<00:02,  2.21s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 1.4451, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.9381}: 100%|██████████| 10/10 [00:20<00:00,  2.41s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 1.4451, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 2.9381}: 100%|██████████| 10/10 [00:20<00:00,  2.09s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 1.4451472206242255
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.037492529089753944
Avg compression ratio: 1.0
Avg train time: 2.9381144523620604
Std train time: 1.5636610799236812
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 1.3865, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 2.4363}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 1.3865, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0349, 'compress@10': 1.0, 'time@10': 2.4363}:  10%|█         | 1/10 [00:01<00:11,  1.25s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 1.4538, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.0673, 'compress@10': 1.0, 'time@10': 2.242}:  10%|█         | 1/10 [00:03<00:11,  1.25s/it] {'epoch': 24, 'num_users': 7.0, 'loss': 1.4538, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.0673, 'compress@10': 1.0, 'time@10': 2.242}:  20%|██        | 2/10 [00:03<00:13,  1.73s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 1.2835, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0621, 'compress@10': 1.0, 'time@10': 1.7407}:  20%|██        | 2/10 [00:03<00:13,  1.73s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 1.2835, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.0621, 'compress@10': 1.0, 'time@10': 1.7407}:  30%|███       | 3/10 [00:03<00:07,  1.12s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 1.3375, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0713, 'compress@10': 1.0, 'time@10': 1.759}:  30%|███       | 3/10 [00:05<00:07,  1.12s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 1.3375, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.0713, 'compress@10': 1.0, 'time@10': 1.759}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 1.2749, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.081, 'compress@10': 1.0, 'time@10': 2.7809}:  40%|████      | 4/10 [00:09<00:08,  1.41s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 1.2749, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.081, 'compress@10': 1.0, 'time@10': 2.7809}:  50%|█████     | 5/10 [00:09<00:10,  2.15s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 1.2965, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0845, 'compress@10': 1.0, 'time@10': 2.82}:  50%|█████     | 5/10 [00:12<00:10,  2.15s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 1.2965, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.0845, 'compress@10': 1.0, 'time@10': 2.82}:  60%|██████    | 6/10 [00:12<00:09,  2.45s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 1.3036, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0822, 'compress@10': 1.0, 'time@10': 2.8921}:  60%|██████    | 6/10 [00:13<00:09,  2.45s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 1.3036, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.0822, 'compress@10': 1.0, 'time@10': 2.8921}:  70%|███████   | 7/10 [00:13<00:06,  2.20s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 1.2516, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.0888, 'compress@10': 1.0, 'time@10': 2.8127}:  70%|███████   | 7/10 [00:16<00:06,  2.20s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 1.2516, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.0888, 'compress@10': 1.0, 'time@10': 2.8127}:  80%|████████  | 8/10 [00:16<00:04,  2.24s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 1.3067, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0894, 'compress@10': 1.0, 'time@10': 3.0192}:  80%|████████  | 8/10 [00:18<00:04,  2.24s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 1.3067, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.0894, 'compress@10': 1.0, 'time@10': 3.0192}:  90%|█████████ | 9/10 [00:18<00:02,  2.28s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 1.3047, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0913, 'compress@10': 1.0, 'time@10': 3.0084}:  90%|█████████ | 9/10 [00:21<00:02,  2.28s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 1.3047, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0913, 'compress@10': 1.0, 'time@10': 3.0084}: 100%|██████████| 10/10 [00:21<00:00,  2.48s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 1.3047, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.0913, 'compress@10': 1.0, 'time@10': 3.0084}: 100%|██████████| 10/10 [00:21<00:00,  2.14s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 1.3047456004888636
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.09127437672716758
Avg compression ratio: 1.0
Avg train time: 3.008371663093567
Std train time: 1.6178131516397178
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 1.2534, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.7059}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 1.2534, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.7059}:  10%|█         | 1/10 [00:01<00:12,  1.38s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 1.3156, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1021, 'compress@10': 1.0, 'time@10': 2.4043}:  10%|█         | 1/10 [00:03<00:12,  1.38s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 1.3156, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1021, 'compress@10': 1.0, 'time@10': 2.4043}:  20%|██        | 2/10 [00:03<00:14,  1.82s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 1.1552, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1198, 'compress@10': 1.0, 'time@10': 1.8541}:  20%|██        | 2/10 [00:03<00:14,  1.82s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 1.1552, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1198, 'compress@10': 1.0, 'time@10': 1.8541}:  30%|███       | 3/10 [00:03<00:08,  1.18s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 1.2068, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1146, 'compress@10': 1.0, 'time@10': 1.8285}:  30%|███       | 3/10 [00:05<00:08,  1.18s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 1.2068, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1146, 'compress@10': 1.0, 'time@10': 1.8285}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 1.1487, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.1156, 'compress@10': 1.0, 'time@10': 2.8636}:  40%|████      | 4/10 [00:09<00:08,  1.41s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 1.1487, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.1156, 'compress@10': 1.0, 'time@10': 2.8636}:  50%|█████     | 5/10 [00:09<00:10,  2.18s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 1.1685, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.1134, 'compress@10': 1.0, 'time@10': 2.8776}:  50%|█████     | 5/10 [00:12<00:10,  2.18s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 1.1685, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.1134, 'compress@10': 1.0, 'time@10': 2.8776}:  60%|██████    | 6/10 [00:12<00:09,  2.45s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 1.1751, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.9342}:  60%|██████    | 6/10 [00:13<00:09,  2.45s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 1.1751, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.9342}:  70%|███████   | 7/10 [00:13<00:06,  2.19s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 1.1266, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.1153, 'compress@10': 1.0, 'time@10': 2.8507}:  70%|███████   | 7/10 [00:16<00:06,  2.19s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 1.1266, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.1153, 'compress@10': 1.0, 'time@10': 2.8507}:  80%|████████  | 8/10 [00:16<00:04,  2.23s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 1.1784, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.113, 'compress@10': 1.0, 'time@10': 3.0488}:  80%|████████  | 8/10 [00:18<00:04,  2.23s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 1.1784, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.113, 'compress@10': 1.0, 'time@10': 3.0488}:  90%|█████████ | 9/10 [00:18<00:02,  2.26s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 1.1762, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 3.027}:  90%|█████████ | 9/10 [00:21<00:02,  2.26s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 1.1762, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 3.027}: 100%|██████████| 10/10 [00:21<00:00,  2.45s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 1.1762, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 3.027}: 100%|██████████| 10/10 [00:21<00:00,  2.14s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 1.1762042675258924
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.11247758726926185
Avg compression ratio: 1.0
Avg train time: 3.0269914150238035
Std train time: 1.6380790043181948
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 1.1313, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.6584}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 1.1313, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.6584}:  10%|█         | 1/10 [00:01<00:12,  1.37s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 1.1885, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1021, 'compress@10': 1.0, 'time@10': 2.4465}:  10%|█         | 1/10 [00:03<00:12,  1.37s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 1.1885, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1021, 'compress@10': 1.0, 'time@10': 2.4465}:  20%|██        | 2/10 [00:03<00:15,  1.90s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 1.0375, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1198, 'compress@10': 1.0, 'time@10': 1.8992}:  20%|██        | 2/10 [00:04<00:15,  1.90s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 1.0375, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1198, 'compress@10': 1.0, 'time@10': 1.8992}:  30%|███       | 3/10 [00:04<00:08,  1.23s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 1.0869, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1146, 'compress@10': 1.0, 'time@10': 1.8687}:  30%|███       | 3/10 [00:05<00:08,  1.23s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 1.0869, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1146, 'compress@10': 1.0, 'time@10': 1.8687}:  40%|████      | 4/10 [00:05<00:08,  1.46s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 1.0332, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.1156, 'compress@10': 1.0, 'time@10': 2.8843}:  40%|████      | 4/10 [00:09<00:08,  1.46s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 1.0332, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.1156, 'compress@10': 1.0, 'time@10': 2.8843}:  50%|█████     | 5/10 [00:09<00:10,  2.20s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 1.0513, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.1134, 'compress@10': 1.0, 'time@10': 2.9044}:  50%|█████     | 5/10 [00:12<00:10,  2.20s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 1.0513, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.1134, 'compress@10': 1.0, 'time@10': 2.9044}:  60%|██████    | 6/10 [00:12<00:09,  2.48s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 1.0575, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.9566}:  60%|██████    | 6/10 [00:14<00:09,  2.48s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 1.0575, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.9566}:  70%|███████   | 7/10 [00:14<00:06,  2.22s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 1.0125, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.1153, 'compress@10': 1.0, 'time@10': 2.8616}:  70%|███████   | 7/10 [00:16<00:06,  2.22s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 1.0125, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.1153, 'compress@10': 1.0, 'time@10': 2.8616}:  80%|████████  | 8/10 [00:16<00:04,  2.22s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 1.061, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.113, 'compress@10': 1.0, 'time@10': 3.0655}:  80%|████████  | 8/10 [00:18<00:04,  2.22s/it] {'epoch': 26, 'num_users': 6.3333, 'loss': 1.061, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.113, 'compress@10': 1.0, 'time@10': 3.0655}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 1.0586, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 3.0415}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it] {'epoch': 26, 'num_users': 6.3, 'loss': 1.0586, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 3.0415}: 100%|██████████| 10/10 [00:21<00:00,  2.54s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 1.0586, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 3.0415}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 1.0586070221462505
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.11247758726926185
Avg compression ratio: 1.0
Avg train time: 3.0414703607559206
Std train time: 1.6188422422430586
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 1.0195, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.4768}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 1.0195, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.4768}:  10%|█         | 1/10 [00:01<00:11,  1.27s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 1.0717, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1021, 'compress@10': 1.0, 'time@10': 2.2487}:  10%|█         | 1/10 [00:03<00:11,  1.27s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 1.0717, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1021, 'compress@10': 1.0, 'time@10': 2.2487}:  20%|██        | 2/10 [00:03<00:13,  1.73s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.9298, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1198, 'compress@10': 1.0, 'time@10': 1.7436}:  20%|██        | 2/10 [00:03<00:13,  1.73s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.9298, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1198, 'compress@10': 1.0, 'time@10': 1.7436}:  30%|███       | 3/10 [00:03<00:07,  1.12s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.9771, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1146, 'compress@10': 1.0, 'time@10': 1.756}:  30%|███       | 3/10 [00:05<00:07,  1.12s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.9771, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1146, 'compress@10': 1.0, 'time@10': 1.756}:  40%|████      | 4/10 [00:05<00:08,  1.40s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.9279, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.1156, 'compress@10': 1.0, 'time@10': 2.7937}:  40%|████      | 4/10 [00:09<00:08,  1.40s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.9279, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.1156, 'compress@10': 1.0, 'time@10': 2.7937}:  50%|█████     | 5/10 [00:09<00:10,  2.16s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.9444, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.1134, 'compress@10': 1.0, 'time@10': 2.8451}:  50%|█████     | 5/10 [00:12<00:10,  2.16s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.9444, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.1134, 'compress@10': 1.0, 'time@10': 2.8451}:  60%|██████    | 6/10 [00:12<00:09,  2.49s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.9501, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.9012}:  60%|██████    | 6/10 [00:13<00:09,  2.49s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.9501, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.9012}:  70%|███████   | 7/10 [00:13<00:06,  2.21s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.9085, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.1153, 'compress@10': 1.0, 'time@10': 2.8232}:  70%|███████   | 7/10 [00:16<00:06,  2.21s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.9085, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.1153, 'compress@10': 1.0, 'time@10': 2.8232}:  80%|████████  | 8/10 [00:16<00:04,  2.25s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.9538, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.113, 'compress@10': 1.0, 'time@10': 3.0204}:  80%|████████  | 8/10 [00:18<00:04,  2.25s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.9538, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.113, 'compress@10': 1.0, 'time@10': 3.0204}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.9513, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 3.0132}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]  {'epoch': 27, 'num_users': 6.3, 'loss': 0.9513, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 3.0132}: 100%|██████████| 10/10 [00:21<00:00,  2.49s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.9513, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 3.0132}: 100%|██████████| 10/10 [00:21<00:00,  2.14s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.9512706541153276
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.11247758726926185
Avg compression ratio: 1.0
Avg train time: 3.013189196586609
Std train time: 1.6288710550372434
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.9173, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.5472}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.9173, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.5472}:  10%|█         | 1/10 [00:01<00:11,  1.31s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.9648, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1021, 'compress@10': 1.0, 'time@10': 2.331}:  10%|█         | 1/10 [00:03<00:11,  1.31s/it] {'epoch': 28, 'num_users': 7.0, 'loss': 0.9648, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1021, 'compress@10': 1.0, 'time@10': 2.331}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.8316, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1198, 'compress@10': 1.0, 'time@10': 1.8125}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.8316, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1198, 'compress@10': 1.0, 'time@10': 1.8125}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.8769, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1146, 'compress@10': 1.0, 'time@10': 1.7922}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.8769, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1146, 'compress@10': 1.0, 'time@10': 1.7922}:  40%|████      | 4/10 [00:05<00:08,  1.40s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.8321, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.1156, 'compress@10': 1.0, 'time@10': 2.8423}:  40%|████      | 4/10 [00:09<00:08,  1.40s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.8321, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.1156, 'compress@10': 1.0, 'time@10': 2.8423}:  50%|█████     | 5/10 [00:09<00:10,  2.18s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.8471, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.1134, 'compress@10': 1.0, 'time@10': 2.8679}:  50%|█████     | 5/10 [00:12<00:10,  2.18s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.8471, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.1134, 'compress@10': 1.0, 'time@10': 2.8679}:  60%|██████    | 6/10 [00:12<00:10,  2.52s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.8524, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.9236}:  60%|██████    | 6/10 [00:14<00:10,  2.52s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.8524, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.9236}:  70%|███████   | 7/10 [00:14<00:06,  2.24s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.8141, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.1153, 'compress@10': 1.0, 'time@10': 2.8425}:  70%|███████   | 7/10 [00:16<00:06,  2.24s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.8141, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.1153, 'compress@10': 1.0, 'time@10': 2.8425}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.8564, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.113, 'compress@10': 1.0, 'time@10': 3.0296}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.8564, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.113, 'compress@10': 1.0, 'time@10': 3.0296}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.8537, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 3.0181}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]  {'epoch': 28, 'num_users': 6.3, 'loss': 0.8537, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 3.0181}: 100%|██████████| 10/10 [00:21<00:00,  2.48s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.8537, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 3.0181}: 100%|██████████| 10/10 [00:21<00:00,  2.16s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.8536566678065418
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.11247758726926185
Avg compression ratio: 1.0
Avg train time: 3.0180791854858398
Std train time: 1.6374817081358795
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.8243, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.4965}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.8243, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.4965}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.8672, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1021, 'compress@10': 1.0, 'time@10': 2.2677}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.8672, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1021, 'compress@10': 1.0, 'time@10': 2.2677}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.7424, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1198, 'compress@10': 1.0, 'time@10': 1.7757}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.7424, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1198, 'compress@10': 1.0, 'time@10': 1.7757}:  30%|███       | 3/10 [00:03<00:07,  1.14s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.7857, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1146, 'compress@10': 1.0, 'time@10': 1.7749}:  30%|███       | 3/10 [00:05<00:07,  1.14s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.7857, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1146, 'compress@10': 1.0, 'time@10': 1.7749}:  40%|████      | 4/10 [00:05<00:08,  1.40s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.7455, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.1156, 'compress@10': 1.0, 'time@10': 2.7687}:  40%|████      | 4/10 [00:08<00:08,  1.40s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.7455, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.1156, 'compress@10': 1.0, 'time@10': 2.7687}:  50%|█████     | 5/10 [00:08<00:10,  2.12s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.759, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.1134, 'compress@10': 1.0, 'time@10': 2.8025}:  50%|█████     | 5/10 [00:11<00:10,  2.12s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.759, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.1134, 'compress@10': 1.0, 'time@10': 2.8025}:  60%|██████    | 6/10 [00:11<00:09,  2.42s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.7639, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.8788}:  60%|██████    | 6/10 [00:13<00:09,  2.42s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.7639, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.8788}:  70%|███████   | 7/10 [00:13<00:06,  2.19s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.7289, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.1153, 'compress@10': 1.0, 'time@10': 2.8001}:  70%|███████   | 7/10 [00:15<00:06,  2.19s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.7289, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.1153, 'compress@10': 1.0, 'time@10': 2.8001}:  80%|████████  | 8/10 [00:15<00:04,  2.22s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.7681, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.113, 'compress@10': 1.0, 'time@10': 3.0198}:  80%|████████  | 8/10 [00:18<00:04,  2.22s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.7681, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.113, 'compress@10': 1.0, 'time@10': 3.0198}:  90%|█████████ | 9/10 [00:18<00:02,  2.28s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.7653, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 3.0023}:  90%|█████████ | 9/10 [00:21<00:02,  2.28s/it]  {'epoch': 29, 'num_users': 6.3, 'loss': 0.7653, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 3.0023}: 100%|██████████| 10/10 [00:21<00:00,  2.46s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.7653, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 3.0023}: 100%|██████████| 10/10 [00:21<00:00,  2.13s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.7653170561830408
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.11247758726926185
Avg compression ratio: 1.0
Avg train time: 3.0023195505142213
Std train time: 1.5950026686673406
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.7402, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.6097}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.7402, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.6097}:  10%|█         | 1/10 [00:01<00:12,  1.38s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.7787, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1021, 'compress@10': 1.0, 'time@10': 2.3026}:  10%|█         | 1/10 [00:03<00:12,  1.38s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.7787, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1021, 'compress@10': 1.0, 'time@10': 2.3026}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.6618, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1198, 'compress@10': 1.0, 'time@10': 1.7797}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.6618, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1198, 'compress@10': 1.0, 'time@10': 1.7797}:  30%|███       | 3/10 [00:03<00:07,  1.14s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.7034, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1146, 'compress@10': 1.0, 'time@10': 1.7704}:  30%|███       | 3/10 [00:05<00:07,  1.14s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.7034, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1146, 'compress@10': 1.0, 'time@10': 1.7704}:  40%|████      | 4/10 [00:05<00:08,  1.39s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.6676, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.1156, 'compress@10': 1.0, 'time@10': 2.7415}:  40%|████      | 4/10 [00:08<00:08,  1.39s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.6676, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.1156, 'compress@10': 1.0, 'time@10': 2.7415}:  50%|█████     | 5/10 [00:08<00:10,  2.09s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.6797, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.1134, 'compress@10': 1.0, 'time@10': 2.7945}:  50%|█████     | 5/10 [00:12<00:10,  2.09s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.6797, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.1134, 'compress@10': 1.0, 'time@10': 2.7945}:  60%|██████    | 6/10 [00:12<00:09,  2.44s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.6842, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.8516}:  60%|██████    | 6/10 [00:13<00:09,  2.44s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.6842, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.8516}:  70%|███████   | 7/10 [00:13<00:06,  2.17s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.6525, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.1153, 'compress@10': 1.0, 'time@10': 2.7716}:  70%|███████   | 7/10 [00:15<00:06,  2.17s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.6525, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.1153, 'compress@10': 1.0, 'time@10': 2.7716}:  80%|████████  | 8/10 [00:15<00:04,  2.19s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.6888, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.113, 'compress@10': 1.0, 'time@10': 2.9745}:  80%|████████  | 8/10 [00:18<00:04,  2.19s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.6888, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.113, 'compress@10': 1.0, 'time@10': 2.9745}:  90%|█████████ | 9/10 [00:18<00:02,  2.24s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.6859, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.9608}:  90%|█████████ | 9/10 [00:21<00:02,  2.24s/it]  {'epoch': 30, 'num_users': 6.3, 'loss': 0.6859, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.9608}: 100%|██████████| 10/10 [00:21<00:00,  2.43s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.6859, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.9608}: 100%|██████████| 10/10 [00:21<00:00,  2.11s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.6858567619956171
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.11247758726926185
Avg compression ratio: 1.0
Avg train time: 2.9607546806335447
Std train time: 1.5572997092471133
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.6646, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.4623}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.6646, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.4623}:  10%|█         | 1/10 [00:01<00:11,  1.26s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.6989, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1021, 'compress@10': 1.0, 'time@10': 2.2766}:  10%|█         | 1/10 [00:03<00:11,  1.26s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.6989, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1021, 'compress@10': 1.0, 'time@10': 2.2766}:  20%|██        | 2/10 [00:03<00:14,  1.77s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.5895, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1198, 'compress@10': 1.0, 'time@10': 1.7675}:  20%|██        | 2/10 [00:03<00:14,  1.77s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.5895, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1198, 'compress@10': 1.0, 'time@10': 1.7675}:  30%|███       | 3/10 [00:03<00:08,  1.14s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.6294, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1146, 'compress@10': 1.0, 'time@10': 1.7722}:  30%|███       | 3/10 [00:05<00:08,  1.14s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.6294, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1146, 'compress@10': 1.0, 'time@10': 1.7722}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.5981, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.1156, 'compress@10': 1.0, 'time@10': 2.7777}:  40%|████      | 4/10 [00:09<00:08,  1.41s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.5981, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.1156, 'compress@10': 1.0, 'time@10': 2.7777}:  50%|█████     | 5/10 [00:09<00:10,  2.14s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.6088, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.1134, 'compress@10': 1.0, 'time@10': 2.8215}:  50%|█████     | 5/10 [00:12<00:10,  2.14s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.6088, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.1134, 'compress@10': 1.0, 'time@10': 2.8215}:  60%|██████    | 6/10 [00:12<00:09,  2.45s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.613, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.8912}:  60%|██████    | 6/10 [00:13<00:09,  2.45s/it] {'epoch': 31, 'num_users': 6.2857, 'loss': 0.613, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.8912}:  70%|███████   | 7/10 [00:13<00:06,  2.20s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.5845, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.1153, 'compress@10': 1.0, 'time@10': 2.8129}:  70%|███████   | 7/10 [00:16<00:06,  2.20s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.5845, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.1153, 'compress@10': 1.0, 'time@10': 2.8129}:  80%|████████  | 8/10 [00:16<00:04,  2.23s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.6179, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.113, 'compress@10': 1.0, 'time@10': 3.0025}:  80%|████████  | 8/10 [00:18<00:04,  2.23s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.6179, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.113, 'compress@10': 1.0, 'time@10': 3.0025}:  90%|█████████ | 9/10 [00:18<00:02,  2.25s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.6149, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.9861}:  90%|█████████ | 9/10 [00:21<00:02,  2.25s/it]  {'epoch': 31, 'num_users': 6.3, 'loss': 0.6149, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.9861}: 100%|██████████| 10/10 [00:21<00:00,  2.44s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.6149, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.1125, 'compress@10': 1.0, 'time@10': 2.9861}: 100%|██████████| 10/10 [00:21<00:00,  2.12s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.614908443323391
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.11247758726926185
Avg compression ratio: 1.0
Avg train time: 2.9860578298568727
Std train time: 1.5829803661668618
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.5971, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.4638}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.5971, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.1046, 'compress@10': 1.0, 'time@10': 2.4638}:  10%|█         | 1/10 [00:01<00:11,  1.26s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.6274, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1686, 'compress@10': 1.0, 'time@10': 2.2403}:  10%|█         | 1/10 [00:03<00:11,  1.26s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.6274, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.1686, 'compress@10': 1.0, 'time@10': 2.2403}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.5252, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1641, 'compress@10': 1.0, 'time@10': 1.7454}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.5252, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.1641, 'compress@10': 1.0, 'time@10': 1.7454}:  30%|███       | 3/10 [00:03<00:07,  1.12s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.5634, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1807, 'compress@10': 1.0, 'time@10': 1.7711}:  30%|███       | 3/10 [00:05<00:07,  1.12s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.5634, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.1807, 'compress@10': 1.0, 'time@10': 1.7711}:  40%|████      | 4/10 [00:05<00:08,  1.42s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.5366, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2005, 'compress@10': 1.0, 'time@10': 2.783}:  40%|████      | 4/10 [00:09<00:08,  1.42s/it] {'epoch': 32, 'num_users': 5.8, 'loss': 0.5366, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2005, 'compress@10': 1.0, 'time@10': 2.783}:  50%|█████     | 5/10 [00:09<00:10,  2.15s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.5461, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2069, 'compress@10': 1.0, 'time@10': 2.808}:  50%|█████     | 5/10 [00:11<00:10,  2.15s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.5461, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2069, 'compress@10': 1.0, 'time@10': 2.808}:  60%|██████    | 6/10 [00:11<00:09,  2.43s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.5499, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1926, 'compress@10': 1.0, 'time@10': 2.8677}:  60%|██████    | 6/10 [00:13<00:09,  2.43s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.5499, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.1926, 'compress@10': 1.0, 'time@10': 2.8677}:  70%|███████   | 7/10 [00:13<00:06,  2.17s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.5245, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.2079, 'compress@10': 1.0, 'time@10': 2.7919}:  70%|███████   | 7/10 [00:15<00:06,  2.17s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.5245, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.2079, 'compress@10': 1.0, 'time@10': 2.7919}:  80%|████████  | 8/10 [00:15<00:04,  2.21s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.5551, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2093, 'compress@10': 1.0, 'time@10': 3.025}:  80%|████████  | 8/10 [00:18<00:04,  2.21s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.5551, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2093, 'compress@10': 1.0, 'time@10': 3.025}:  90%|█████████ | 9/10 [00:18<00:02,  2.29s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.5521, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2136, 'compress@10': 1.0, 'time@10': 3.0185}:  90%|█████████ | 9/10 [00:21<00:02,  2.29s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.5521, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2136, 'compress@10': 1.0, 'time@10': 3.0185}: 100%|██████████| 10/10 [00:21<00:00,  2.51s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.5521, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2136, 'compress@10': 1.0, 'time@10': 3.0185}: 100%|██████████| 10/10 [00:21<00:00,  2.14s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.5521128293478673
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.21356736617920694
Avg compression ratio: 1.0
Avg train time: 3.018539643287659
Std train time: 1.6267678825504732
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.5374, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.6391}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.5374, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.6391}:  10%|█         | 1/10 [00:01<00:12,  1.35s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.5639, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.3868}:  10%|█         | 1/10 [00:03<00:12,  1.35s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.5639, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.3868}:  20%|██        | 2/10 [00:03<00:14,  1.87s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.4684, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8594}:  20%|██        | 2/10 [00:04<00:14,  1.87s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.4684, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8594}:  30%|███       | 3/10 [00:04<00:08,  1.21s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.5053, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8669}:  30%|███       | 3/10 [00:05<00:08,  1.21s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.5053, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8669}:  40%|████      | 4/10 [00:05<00:08,  1.49s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.4827, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.9222}:  40%|████      | 4/10 [00:09<00:08,  1.49s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.4827, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.9222}:  50%|█████     | 5/10 [00:09<00:11,  2.25s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.4911, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.9609}:  50%|█████     | 5/10 [00:12<00:11,  2.25s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.4911, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.9609}:  60%|██████    | 6/10 [00:12<00:10,  2.57s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.4946, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0279}:  60%|██████    | 6/10 [00:14<00:10,  2.57s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.4946, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0279}:  70%|███████   | 7/10 [00:14<00:06,  2.30s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.4723, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.9426}:  70%|███████   | 7/10 [00:16<00:06,  2.30s/it]  {'epoch': 33, 'num_users': 6.125, 'loss': 0.4723, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.9426}:  80%|████████  | 8/10 [00:16<00:04,  2.32s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.5002, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.1542}:  80%|████████  | 8/10 [00:19<00:04,  2.32s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.5002, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.1542}:  90%|█████████ | 9/10 [00:19<00:02,  2.36s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.4971, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.1394}:  90%|█████████ | 9/10 [00:22<00:02,  2.36s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.4971, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.1394}: 100%|██████████| 10/10 [00:22<00:00,  2.57s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.4971, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.1394}: 100%|██████████| 10/10 [00:22<00:00,  2.23s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.497105569106229
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.26244770362827763
Avg compression ratio: 1.0
Avg train time: 3.139440584182739
Std train time: 1.6719074911443597
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.4853, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.5444}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.4853, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.5444}:  10%|█         | 1/10 [00:01<00:11,  1.30s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.5081, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.332}:  10%|█         | 1/10 [00:03<00:11,  1.30s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.5081, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.332}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.419, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8192}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.419, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8192}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.4544, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8295}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.4544, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8295}:  40%|████      | 4/10 [00:05<00:08,  1.46s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.4361, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.871}:  40%|████      | 4/10 [00:09<00:08,  1.46s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.4361, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.871}:  50%|█████     | 5/10 [00:09<00:11,  2.21s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.4435, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.9147}:  50%|█████     | 5/10 [00:12<00:11,  2.21s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.4435, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.9147}:  60%|██████    | 6/10 [00:12<00:10,  2.53s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.4466, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.9772}:  60%|██████    | 6/10 [00:14<00:10,  2.53s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.4466, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.9772}:  70%|███████   | 7/10 [00:14<00:06,  2.26s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.4272, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.8947}:  70%|███████   | 7/10 [00:16<00:06,  2.26s/it]  {'epoch': 34, 'num_users': 6.125, 'loss': 0.4272, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.8947}:  80%|████████  | 8/10 [00:16<00:04,  2.31s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.4526, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.1108}:  80%|████████  | 8/10 [00:19<00:04,  2.31s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.4526, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.1108}:  90%|█████████ | 9/10 [00:19<00:02,  2.35s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.4495, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0969}:  90%|█████████ | 9/10 [00:22<00:02,  2.35s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.4495, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0969}: 100%|██████████| 10/10 [00:22<00:00,  2.55s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.4495, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0969}: 100%|██████████| 10/10 [00:22<00:00,  2.20s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.4495029053651348
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.26244770362827763
Avg compression ratio: 1.0
Avg train time: 3.0968522787094117
Std train time: 1.6537126058968072
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.4402, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.5605}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.4402, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.5605}:  10%|█         | 1/10 [00:01<00:11,  1.31s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.4596, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.3395}:  10%|█         | 1/10 [00:03<00:11,  1.31s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.4596, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.3395}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.3765, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8238}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.3765, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8238}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.4107, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8391}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.4107, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8391}:  40%|████      | 4/10 [00:05<00:08,  1.47s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.3965, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.886}:  40%|████      | 4/10 [00:09<00:08,  1.47s/it] {'epoch': 35, 'num_users': 5.8, 'loss': 0.3965, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.886}:  50%|█████     | 5/10 [00:09<00:11,  2.22s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.4028, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.9274}:  50%|█████     | 5/10 [00:12<00:11,  2.22s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.4028, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.9274}:  60%|██████    | 6/10 [00:12<00:10,  2.55s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.4057, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.9945}:  60%|██████    | 6/10 [00:14<00:10,  2.55s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.4057, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.9945}:  70%|███████   | 7/10 [00:14<00:06,  2.28s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.3891, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.914}:  70%|███████   | 7/10 [00:16<00:06,  2.28s/it]   {'epoch': 35, 'num_users': 6.125, 'loss': 0.3891, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.914}:  80%|████████  | 8/10 [00:16<00:04,  2.31s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.4119, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.1466}:  80%|████████  | 8/10 [00:19<00:04,  2.31s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.4119, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.1466}:  90%|█████████ | 9/10 [00:19<00:02,  2.38s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.4089, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.1283}:  90%|█████████ | 9/10 [00:22<00:02,  2.38s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.4089, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.1283}: 100%|██████████| 10/10 [00:22<00:00,  2.57s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.4089, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.1283}: 100%|██████████| 10/10 [00:22<00:00,  2.22s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.40889173353384195
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.26244770362827763
Avg compression ratio: 1.0
Avg train time: 3.1283310413360597
Std train time: 1.6776447624642803
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.4019, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.5883}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.4019, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.5883}:  10%|█         | 1/10 [00:01<00:11,  1.32s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.4181, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.3937}:  10%|█         | 1/10 [00:03<00:11,  1.32s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.4181, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.3937}:  20%|██        | 2/10 [00:03<00:14,  1.86s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.3405, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8645}:  20%|██        | 2/10 [00:03<00:14,  1.86s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.3405, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8645}:  30%|███       | 3/10 [00:03<00:08,  1.21s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.3735, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8552}:  30%|███       | 3/10 [00:06<00:08,  1.21s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.3735, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8552}:  40%|████      | 4/10 [00:06<00:09,  1.55s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.3632, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.9015}:  40%|████      | 4/10 [00:09<00:09,  1.55s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.3632, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.9015}:  50%|█████     | 5/10 [00:09<00:11,  2.28s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.3687, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.9393}:  50%|█████     | 5/10 [00:12<00:11,  2.28s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.3687, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.9393}:  60%|██████    | 6/10 [00:12<00:10,  2.58s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.3713, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0074}:  60%|██████    | 6/10 [00:14<00:10,  2.58s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.3713, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0074}:  70%|███████   | 7/10 [00:14<00:06,  2.30s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.3574, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.9191}:  70%|███████   | 7/10 [00:16<00:06,  2.30s/it]  {'epoch': 36, 'num_users': 6.125, 'loss': 0.3574, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.9191}:  80%|████████  | 8/10 [00:16<00:04,  2.31s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.3778, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.1364}:  80%|████████  | 8/10 [00:19<00:04,  2.31s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.3778, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.1364}:  90%|█████████ | 9/10 [00:19<00:02,  2.36s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.3748, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.1229}:  90%|█████████ | 9/10 [00:22<00:02,  2.36s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.3748, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.1229}: 100%|██████████| 10/10 [00:22<00:00,  2.57s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.3748, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.1229}: 100%|██████████| 10/10 [00:22<00:00,  2.24s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.3748189482713304
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.26244770362827763
Avg compression ratio: 1.0
Avg train time: 3.1229260921478272
Std train time: 1.6655971038187005
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.3699, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.5271}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.3699, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.5271}:  10%|█         | 1/10 [00:01<00:11,  1.29s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.383, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.319}:  10%|█         | 1/10 [00:03<00:11,  1.29s/it]  {'epoch': 37, 'num_users': 7.0, 'loss': 0.383, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.319}:  20%|██        | 2/10 [00:03<00:14,  1.79s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.3106, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8116}:  20%|██        | 2/10 [00:03<00:14,  1.79s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.3106, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8116}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.3425, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8288}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.3425, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8288}:  40%|████      | 4/10 [00:05<00:08,  1.46s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.3359, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.8533}:  40%|████      | 4/10 [00:09<00:08,  1.46s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.3359, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.8533}:  50%|█████     | 5/10 [00:09<00:10,  2.20s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.3406, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.9223}:  50%|█████     | 5/10 [00:12<00:10,  2.20s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.3406, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.9223}:  60%|██████    | 6/10 [00:12<00:10,  2.57s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.3429, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0143}:  60%|██████    | 6/10 [00:14<00:10,  2.57s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.3429, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0143}:  70%|███████   | 7/10 [00:14<00:06,  2.32s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.3315, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.9428}:  70%|███████   | 7/10 [00:16<00:06,  2.32s/it]  {'epoch': 37, 'num_users': 6.125, 'loss': 0.3315, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.9428}:  80%|████████  | 8/10 [00:16<00:04,  2.37s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.3498, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.1396}:  80%|████████  | 8/10 [00:19<00:04,  2.37s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.3498, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.1396}:  90%|█████████ | 9/10 [00:19<00:02,  2.38s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.3468, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.1257}:  90%|█████████ | 9/10 [00:22<00:02,  2.38s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.3468, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.1257}: 100%|██████████| 10/10 [00:22<00:00,  2.58s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.3468, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.1257}: 100%|██████████| 10/10 [00:22<00:00,  2.23s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.34678090676452894
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.26244770362827763
Avg compression ratio: 1.0
Avg train time: 3.1257497549057005
Std train time: 1.619115501293329
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.3436, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.6325}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.3436, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.6325}:  10%|█         | 1/10 [00:01<00:12,  1.35s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.354, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.3823}:  10%|█         | 1/10 [00:03<00:12,  1.35s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.354, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.3823}:  20%|██        | 2/10 [00:03<00:14,  1.83s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.2863, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8489}:  20%|██        | 2/10 [00:03<00:14,  1.83s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.2863, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8489}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.3172, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8587}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.3172, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8587}:  40%|████      | 4/10 [00:05<00:08,  1.48s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.3141, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.895}:  40%|████      | 4/10 [00:09<00:08,  1.48s/it] {'epoch': 38, 'num_users': 5.8, 'loss': 0.3141, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.895}:  50%|█████     | 5/10 [00:09<00:11,  2.23s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.318, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.9278}:  50%|█████     | 5/10 [00:12<00:11,  2.23s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.318, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.9278}:  60%|██████    | 6/10 [00:12<00:10,  2.53s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.3201, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.9843}:  60%|██████    | 6/10 [00:14<00:10,  2.53s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.3201, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.9843}:  70%|███████   | 7/10 [00:14<00:06,  2.26s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.3109, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.8919}:  70%|███████   | 7/10 [00:16<00:06,  2.26s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.3109, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.8919}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.3271, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.0939}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.3271, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.0939}:  90%|█████████ | 9/10 [00:18<00:02,  2.30s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.3242, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0857}:  90%|█████████ | 9/10 [00:21<00:02,  2.30s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.3242, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0857}: 100%|██████████| 10/10 [00:21<00:00,  2.53s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.3242, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0857}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.32421782917155817
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.26244770362827763
Avg compression ratio: 1.0
Avg train time: 3.0856852293014527
Std train time: 1.6401548424470884
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.3227, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.4826}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.3227, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.4826}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.3304, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.2628}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.3304, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.2628}:  20%|██        | 2/10 [00:03<00:13,  1.75s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.267, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.7725}:  20%|██        | 2/10 [00:03<00:13,  1.75s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.267, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.7725}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.2971, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.7904}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.2971, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.7904}:  40%|████      | 4/10 [00:05<00:08,  1.43s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.297, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.7781}:  40%|████      | 4/10 [00:09<00:08,  1.43s/it] {'epoch': 39, 'num_users': 5.8, 'loss': 0.297, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.7781}:  50%|█████     | 5/10 [00:09<00:10,  2.14s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.3003, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.8312}:  50%|█████     | 5/10 [00:12<00:10,  2.14s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.3003, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.8312}:  60%|██████    | 6/10 [00:12<00:09,  2.48s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.3022, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.9054}:  60%|██████    | 6/10 [00:13<00:09,  2.48s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.3022, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.9054}:  70%|███████   | 7/10 [00:13<00:06,  2.22s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.295, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.8358}:  70%|███████   | 7/10 [00:16<00:06,  2.22s/it]   {'epoch': 39, 'num_users': 6.125, 'loss': 0.295, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.8358}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.3094, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.0402}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.3094, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.0402}:  90%|█████████ | 9/10 [00:18<00:02,  2.30s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.3065, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0198}:  90%|█████████ | 9/10 [00:21<00:02,  2.30s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.3065, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0198}: 100%|██████████| 10/10 [00:21<00:00,  2.48s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.3065, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0198}: 100%|██████████| 10/10 [00:21<00:00,  2.15s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.30650887705885016
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.26244770362827763
Avg compression ratio: 1.0
Avg train time: 3.019845151901245
Std train time: 1.5710247028098243
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.3063, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.4901}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.3063, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.4901}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.3118, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.2939}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.3118, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.2939}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.2523, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.7961}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.2523, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.7961}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.2816, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.796}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.2816, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.796}:  40%|████      | 4/10 [00:05<00:08,  1.43s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.284, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.8241}:  40%|████      | 4/10 [00:09<00:08,  1.43s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.284, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.8241}:  50%|█████     | 5/10 [00:09<00:10,  2.18s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.2868, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.8583}:  50%|█████     | 5/10 [00:12<00:10,  2.18s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.2868, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.8583}:  60%|██████    | 6/10 [00:12<00:09,  2.48s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.2886, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.8968}:  60%|██████    | 6/10 [00:13<00:09,  2.48s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.2886, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.8968}:  70%|███████   | 7/10 [00:13<00:06,  2.19s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.2831, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.8129}:  70%|███████   | 7/10 [00:16<00:06,  2.19s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 0.2831, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.8129}:  80%|████████  | 8/10 [00:16<00:04,  2.21s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.2957, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 2.9973}:  80%|████████  | 8/10 [00:18<00:04,  2.21s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.2957, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 2.9973}:  90%|█████████ | 9/10 [00:18<00:02,  2.23s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.293, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.991}:  90%|█████████ | 9/10 [00:21<00:02,  2.23s/it]     {'epoch': 40, 'num_users': 6.3, 'loss': 0.293, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.991}: 100%|██████████| 10/10 [00:21<00:00,  2.45s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.293, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.991}: 100%|██████████| 10/10 [00:21<00:00,  2.13s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.2929808603467535
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.26244770362827763
Avg compression ratio: 1.0
Avg train time: 2.990962553024292
Std train time: 1.6014390947855417
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.294, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.4825}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.294, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.4825}:  10%|█         | 1/10 [00:01<00:11,  1.27s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.2975, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.2579}:  10%|█         | 1/10 [00:03<00:11,  1.27s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.2975, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.2579}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.2413, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.7887}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.2413, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.7887}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.2699, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.7796}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.2699, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.7796}:  40%|████      | 4/10 [00:05<00:08,  1.40s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.2745, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.7972}:  40%|████      | 4/10 [00:09<00:08,  1.40s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.2745, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.7972}:  50%|█████     | 5/10 [00:09<00:10,  2.14s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.2768, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.8403}:  50%|█████     | 5/10 [00:12<00:10,  2.14s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.2768, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.8403}:  60%|██████    | 6/10 [00:12<00:09,  2.47s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.2785, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.9264}:  60%|██████    | 6/10 [00:13<00:09,  2.47s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.2785, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.9264}:  70%|███████   | 7/10 [00:13<00:06,  2.24s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.2744, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.8549}:  70%|███████   | 7/10 [00:16<00:06,  2.24s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.2744, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.8549}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.2856, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.0641}:  80%|████████  | 8/10 [00:18<00:04,  2.28s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.2856, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.0641}:  90%|█████████ | 9/10 [00:18<00:02,  2.32s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.2829, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0456}:  90%|█████████ | 9/10 [00:21<00:02,  2.32s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.2829, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0456}: 100%|██████████| 10/10 [00:21<00:00,  2.51s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.2829, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0456}: 100%|██████████| 10/10 [00:21<00:00,  2.16s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.2829295512145371
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.26244770362827763
Avg compression ratio: 1.0
Avg train time: 3.0456445455551147
Std train time: 1.6114404555095714
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.2851, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.5457}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.2851, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.5457}:  10%|█         | 1/10 [00:01<00:11,  1.32s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.2867, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.3202}:  10%|█         | 1/10 [00:03<00:11,  1.32s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.2867, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.3202}:  20%|██        | 2/10 [00:03<00:14,  1.79s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.2334, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8074}:  20%|██        | 2/10 [00:03<00:14,  1.79s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.2334, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8074}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.2615, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8036}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.2615, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8036}:  40%|████      | 4/10 [00:05<00:08,  1.42s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.2677, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.8782}:  40%|████      | 4/10 [00:09<00:08,  1.42s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.2677, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.8782}:  50%|█████     | 5/10 [00:09<00:11,  2.22s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.2697, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.9002}:  50%|█████     | 5/10 [00:12<00:11,  2.22s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.2697, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.2646, 'compress@10': 1.0, 'time@10': 2.9002}:  60%|██████    | 6/10 [00:12<00:09,  2.50s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.2713, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.9459}:  60%|██████    | 6/10 [00:13<00:09,  2.50s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.2713, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 2.9459}:  70%|███████   | 7/10 [00:13<00:06,  2.22s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.2682, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.8532}:  70%|███████   | 7/10 [00:16<00:06,  2.22s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.2682, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.269, 'compress@10': 1.0, 'time@10': 2.8532}:  80%|████████  | 8/10 [00:16<00:04,  2.22s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.2782, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.0548}:  80%|████████  | 8/10 [00:18<00:04,  2.22s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.2782, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2636, 'compress@10': 1.0, 'time@10': 3.0548}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.2757, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0344}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.2757, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0344}: 100%|██████████| 10/10 [00:21<00:00,  2.46s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.2757, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2624, 'compress@10': 1.0, 'time@10': 3.0344}: 100%|██████████| 10/10 [00:21<00:00,  2.15s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.27565790595865747
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.26244770362827763
Avg compression ratio: 1.0
Avg train time: 3.0344128370285035
Std train time: 1.6828562372530116
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.2787, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.548}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.2787, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.548}:  10%|█         | 1/10 [00:01<00:11,  1.30s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.2788, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.3452}:  10%|█         | 1/10 [00:03<00:11,  1.30s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.2788, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.2383, 'compress@10': 1.0, 'time@10': 2.3452}:  20%|██        | 2/10 [00:03<00:14,  1.81s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.228, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8159}:  20%|██        | 2/10 [00:03<00:14,  1.81s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.228, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.2795, 'compress@10': 1.0, 'time@10': 1.8159}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.2555, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8156}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.2555, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.2673, 'compress@10': 1.0, 'time@10': 1.8156}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.263, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.8485}:  40%|████      | 4/10 [00:09<00:08,  1.44s/it] {'epoch': 43, 'num_users': 5.8, 'loss': 0.263, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.2698, 'compress@10': 1.0, 'time@10': 2.8485}:  50%|█████     | 5/10 [00:09<00:10,  2.19s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.2647, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.3024, 'compress@10': 1.0, 'time@10': 2.8702}:  50%|█████     | 5/10 [00:12<00:10,  2.19s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.2647, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.3024, 'compress@10': 1.0, 'time@10': 2.8702}:  60%|██████    | 6/10 [00:12<00:09,  2.47s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.2663, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2948, 'compress@10': 1.0, 'time@10': 2.9289}:  60%|██████    | 6/10 [00:13<00:09,  2.47s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.2663, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.2948, 'compress@10': 1.0, 'time@10': 2.9289}:  70%|███████   | 7/10 [00:13<00:06,  2.21s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.264, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.2974, 'compress@10': 1.0, 'time@10': 2.8448}:  70%|███████   | 7/10 [00:16<00:06,  2.21s/it]  {'epoch': 43, 'num_users': 6.125, 'loss': 0.264, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.2974, 'compress@10': 1.0, 'time@10': 2.8448}:  80%|████████  | 8/10 [00:16<00:04,  2.23s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.273, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2888, 'compress@10': 1.0, 'time@10': 3.0436}:  80%|████████  | 8/10 [00:18<00:04,  2.23s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.273, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.2888, 'compress@10': 1.0, 'time@10': 3.0436}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.2705, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2851, 'compress@10': 1.0, 'time@10': 3.0274}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 0.2705, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2851, 'compress@10': 1.0, 'time@10': 3.0274}: 100%|██████████| 10/10 [00:21<00:00,  2.47s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.2705, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.2851, 'compress@10': 1.0, 'time@10': 3.0274}: 100%|██████████| 10/10 [00:21<00:00,  2.15s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.27051942424356124
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.28510354529483906
Avg compression ratio: 1.0
Avg train time: 3.0273518562316895
Std train time: 1.628717276607389
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.2742, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.4446}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.2742, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.4446}:  10%|█         | 1/10 [00:01<00:11,  1.25s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.2731, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.3328, 'compress@10': 1.0, 'time@10': 2.2512}:  10%|█         | 1/10 [00:03<00:11,  1.25s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.2731, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.3328, 'compress@10': 1.0, 'time@10': 2.2512}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.2243, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.3425, 'compress@10': 1.0, 'time@10': 1.7251}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.2243, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.3425, 'compress@10': 1.0, 'time@10': 1.7251}:  30%|███       | 3/10 [00:03<00:07,  1.11s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.2514, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.3145, 'compress@10': 1.0, 'time@10': 1.7492}:  30%|███       | 3/10 [00:05<00:07,  1.11s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.2514, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.3145, 'compress@10': 1.0, 'time@10': 1.7492}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.2598, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.3075, 'compress@10': 1.0, 'time@10': 2.7634}:  40%|████      | 4/10 [00:09<00:08,  1.41s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.2598, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.3075, 'compress@10': 1.0, 'time@10': 2.7634}:  50%|█████     | 5/10 [00:09<00:10,  2.15s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.2612, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.3416, 'compress@10': 1.0, 'time@10': 2.8235}:  50%|█████     | 5/10 [00:12<00:10,  2.15s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.2612, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.3416, 'compress@10': 1.0, 'time@10': 2.8235}:  60%|██████    | 6/10 [00:12<00:09,  2.49s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.2628, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.3284, 'compress@10': 1.0, 'time@10': 2.8963}:  60%|██████    | 6/10 [00:13<00:09,  2.49s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.2628, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.3284, 'compress@10': 1.0, 'time@10': 2.8963}:  70%|███████   | 7/10 [00:13<00:06,  2.23s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.2612, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.3268, 'compress@10': 1.0, 'time@10': 2.825}:  70%|███████   | 7/10 [00:16<00:06,  2.23s/it]  {'epoch': 44, 'num_users': 6.125, 'loss': 0.2612, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.3268, 'compress@10': 1.0, 'time@10': 2.825}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.2693, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.3429, 'compress@10': 1.0, 'time@10': 3.035}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.2693, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.3429, 'compress@10': 1.0, 'time@10': 3.035}:  90%|█████████ | 9/10 [00:18<00:02,  2.31s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.267, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.3626, 'compress@10': 1.0, 'time@10': 3.018}:  90%|█████████ | 9/10 [00:21<00:02,  2.31s/it]    {'epoch': 44, 'num_users': 6.3, 'loss': 0.267, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.3626, 'compress@10': 1.0, 'time@10': 3.018}: 100%|██████████| 10/10 [00:21<00:00,  2.49s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.267, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.3626, 'compress@10': 1.0, 'time@10': 3.018}: 100%|██████████| 10/10 [00:21<00:00,  2.15s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.26695398188578323
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.3626112672478559
Avg compression ratio: 1.0
Avg train time: 3.017968034744263
Std train time: 1.6164520603519275
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.2712, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.509}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.2712, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.2441, 'compress@10': 1.0, 'time@10': 2.509}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.2689, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.3712, 'compress@10': 1.0, 'time@10': 2.271}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.2689, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.3712, 'compress@10': 1.0, 'time@10': 2.271}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.2219, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.3682, 'compress@10': 1.0, 'time@10': 1.7658}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.2219, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.3682, 'compress@10': 1.0, 'time@10': 1.7658}:  30%|███       | 3/10 [00:03<00:07,  1.13s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.2486, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.3996, 'compress@10': 1.0, 'time@10': 1.7954}:  30%|███       | 3/10 [00:05<00:07,  1.13s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.2486, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.3996, 'compress@10': 1.0, 'time@10': 1.7954}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.2576, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.3756, 'compress@10': 1.0, 'time@10': 2.783}:  40%|████      | 4/10 [00:09<00:08,  1.44s/it] {'epoch': 45, 'num_users': 5.8, 'loss': 0.2576, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.3756, 'compress@10': 1.0, 'time@10': 2.783}:  50%|█████     | 5/10 [00:09<00:10,  2.15s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.2589, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.3983, 'compress@10': 1.0, 'time@10': 2.8338}:  50%|█████     | 5/10 [00:12<00:10,  2.15s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.2589, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.3983, 'compress@10': 1.0, 'time@10': 2.8338}:  60%|██████    | 6/10 [00:12<00:09,  2.48s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.2605, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.3771, 'compress@10': 1.0, 'time@10': 2.8945}:  60%|██████    | 6/10 [00:13<00:09,  2.48s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.2605, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.3771, 'compress@10': 1.0, 'time@10': 2.8945}:  70%|███████   | 7/10 [00:13<00:06,  2.21s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.2594, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.3693, 'compress@10': 1.0, 'time@10': 2.8128}:  70%|███████   | 7/10 [00:16<00:06,  2.21s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.2594, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.3693, 'compress@10': 1.0, 'time@10': 2.8128}:  80%|████████  | 8/10 [00:16<00:04,  2.23s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.2668, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.3807, 'compress@10': 1.0, 'time@10': 3.0298}:  80%|████████  | 8/10 [00:18<00:04,  2.23s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.2668, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.3807, 'compress@10': 1.0, 'time@10': 3.0298}:  90%|█████████ | 9/10 [00:18<00:02,  2.29s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.2645, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.3966, 'compress@10': 1.0, 'time@10': 3.0132}:  90%|█████████ | 9/10 [00:21<00:02,  2.29s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.2645, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.3966, 'compress@10': 1.0, 'time@10': 3.0132}: 100%|██████████| 10/10 [00:21<00:00,  2.47s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.2645, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.3966, 'compress@10': 1.0, 'time@10': 3.0132}: 100%|██████████| 10/10 [00:21<00:00,  2.14s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.26450933924485
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.3966470209539167
Avg compression ratio: 1.0
Avg train time: 3.013239049911499
Std train time: 1.5869538836410215
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.2691, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.523, 'compress@10': 1.0, 'time@10': 2.5004}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.2691, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.523, 'compress@10': 1.0, 'time@10': 2.5004}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.2659, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.5107, 'compress@10': 1.0, 'time@10': 2.2714}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.2659, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.5107, 'compress@10': 1.0, 'time@10': 2.2714}:  20%|██        | 2/10 [00:03<00:13,  1.75s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.2203, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.4611, 'compress@10': 1.0, 'time@10': 1.7643}:  20%|██        | 2/10 [00:03<00:13,  1.75s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.2203, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.4611, 'compress@10': 1.0, 'time@10': 1.7643}:  30%|███       | 3/10 [00:03<00:07,  1.13s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.2468, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.4694, 'compress@10': 1.0, 'time@10': 1.7693}:  30%|███       | 3/10 [00:05<00:07,  1.13s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.2468, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.4694, 'compress@10': 1.0, 'time@10': 1.7693}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.2561, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.4314, 'compress@10': 1.0, 'time@10': 2.7587}:  40%|████      | 4/10 [00:08<00:08,  1.41s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.2561, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.4314, 'compress@10': 1.0, 'time@10': 2.7587}:  50%|█████     | 5/10 [00:08<00:10,  2.12s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.2573, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.4448, 'compress@10': 1.0, 'time@10': 2.8025}:  50%|█████     | 5/10 [00:12<00:10,  2.12s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.2573, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.4448, 'compress@10': 1.0, 'time@10': 2.8025}:  60%|██████    | 6/10 [00:12<00:09,  2.44s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.2589, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.4576, 'compress@10': 1.0, 'time@10': 2.8908}:  60%|██████    | 6/10 [00:13<00:09,  2.44s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.2589, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.4576, 'compress@10': 1.0, 'time@10': 2.8908}:  70%|███████   | 7/10 [00:13<00:06,  2.21s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.2582, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.4398, 'compress@10': 1.0, 'time@10': 2.816}:  70%|███████   | 7/10 [00:16<00:06,  2.21s/it]  {'epoch': 46, 'num_users': 6.125, 'loss': 0.2582, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.4398, 'compress@10': 1.0, 'time@10': 2.816}:  80%|████████  | 8/10 [00:16<00:04,  2.25s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.265, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.4434, 'compress@10': 1.0, 'time@10': 3.0257}:  80%|████████  | 8/10 [00:18<00:04,  2.25s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.265, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.4434, 'compress@10': 1.0, 'time@10': 3.0257}:  90%|█████████ | 9/10 [00:18<00:02,  2.29s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.2628, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.453, 'compress@10': 1.0, 'time@10': 3.0193}:  90%|█████████ | 9/10 [00:21<00:02,  2.29s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.2628, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.453, 'compress@10': 1.0, 'time@10': 3.0193}: 100%|██████████| 10/10 [00:21<00:00,  2.51s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.2628, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.453, 'compress@10': 1.0, 'time@10': 3.0193}: 100%|██████████| 10/10 [00:21<00:00,  2.15s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.2628446808266899
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.45303921587898277
Avg compression ratio: 1.0
Avg train time: 3.0193118333816527
Std train time: 1.584042923193266
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.2676, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.523, 'compress@10': 1.0, 'time@10': 2.425}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.2676, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.523, 'compress@10': 1.0, 'time@10': 2.425}:  10%|█         | 1/10 [00:01<00:11,  1.24s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.2637, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.5107, 'compress@10': 1.0, 'time@10': 2.2593}:  10%|█         | 1/10 [00:03<00:11,  1.24s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.2637, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.5107, 'compress@10': 1.0, 'time@10': 2.2593}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.2192, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.599, 'compress@10': 1.0, 'time@10': 1.7563}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.2192, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.599, 'compress@10': 1.0, 'time@10': 1.7563}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.2455, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.5728, 'compress@10': 1.0, 'time@10': 1.7678}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.2455, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.5728, 'compress@10': 1.0, 'time@10': 1.7678}:  40%|████      | 4/10 [00:05<00:08,  1.42s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.2551, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.5141, 'compress@10': 1.0, 'time@10': 2.7832}:  40%|████      | 4/10 [00:09<00:08,  1.42s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.2551, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.5141, 'compress@10': 1.0, 'time@10': 2.7832}:  50%|█████     | 5/10 [00:09<00:10,  2.15s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.2563, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.5138, 'compress@10': 1.0, 'time@10': 2.8292}:  50%|█████     | 5/10 [00:12<00:10,  2.15s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.2563, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.5138, 'compress@10': 1.0, 'time@10': 2.8292}:  60%|██████    | 6/10 [00:12<00:09,  2.47s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.2579, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.5167, 'compress@10': 1.0, 'time@10': 2.8914}:  60%|██████    | 6/10 [00:13<00:09,  2.47s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.2579, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.5167, 'compress@10': 1.0, 'time@10': 2.8914}:  70%|███████   | 7/10 [00:13<00:06,  2.21s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.2575, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.4915, 'compress@10': 1.0, 'time@10': 2.8158}:  70%|███████   | 7/10 [00:16<00:06,  2.21s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.2575, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.4915, 'compress@10': 1.0, 'time@10': 2.8158}:  80%|████████  | 8/10 [00:16<00:04,  2.24s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.2638, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.4894, 'compress@10': 1.0, 'time@10': 3.0115}:  80%|████████  | 8/10 [00:18<00:04,  2.24s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.2638, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.4894, 'compress@10': 1.0, 'time@10': 3.0115}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.2617, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.4944, 'compress@10': 1.0, 'time@10': 3.0011}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.2617, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.4944, 'compress@10': 1.0, 'time@10': 3.0011}: 100%|██████████| 10/10 [00:21<00:00,  2.47s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.2617, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.4944, 'compress@10': 1.0, 'time@10': 3.0011}: 100%|██████████| 10/10 [00:21<00:00,  2.14s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.26171736817678687
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.494407695852058
Avg compression ratio: 1.0
Avg train time: 3.0011250257492064
Std train time: 1.5972540080769448
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.2666, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.523, 'compress@10': 1.0, 'time@10': 2.5189}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.2666, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.523, 'compress@10': 1.0, 'time@10': 2.5189}:  10%|█         | 1/10 [00:01<00:11,  1.29s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.2621, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.5107, 'compress@10': 1.0, 'time@10': 2.2986}:  10%|█         | 1/10 [00:03<00:11,  1.29s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.2621, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.5107, 'compress@10': 1.0, 'time@10': 2.2986}:  20%|██        | 2/10 [00:03<00:14,  1.77s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.2185, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.599, 'compress@10': 1.0, 'time@10': 1.7882}:  20%|██        | 2/10 [00:03<00:14,  1.77s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.2185, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.599, 'compress@10': 1.0, 'time@10': 1.7882}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.2446, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.5728, 'compress@10': 1.0, 'time@10': 1.7989}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.2446, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.5728, 'compress@10': 1.0, 'time@10': 1.7989}:  40%|████      | 4/10 [00:05<00:08,  1.43s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.2545, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.5141, 'compress@10': 1.0, 'time@10': 2.7732}:  40%|████      | 4/10 [00:09<00:08,  1.43s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.2545, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.5141, 'compress@10': 1.0, 'time@10': 2.7732}:  50%|█████     | 5/10 [00:09<00:10,  2.13s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.2556, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.5138, 'compress@10': 1.0, 'time@10': 2.8036}:  50%|█████     | 5/10 [00:12<00:10,  2.13s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.2556, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.5138, 'compress@10': 1.0, 'time@10': 2.8036}:  60%|██████    | 6/10 [00:12<00:09,  2.42s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.2572, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.5167, 'compress@10': 1.0, 'time@10': 2.8684}:  60%|██████    | 6/10 [00:13<00:09,  2.42s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.2572, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.5167, 'compress@10': 1.0, 'time@10': 2.8684}:  70%|███████   | 7/10 [00:13<00:06,  2.17s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.2571, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.4915, 'compress@10': 1.0, 'time@10': 2.8009}:  70%|███████   | 7/10 [00:16<00:06,  2.17s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.2571, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.4915, 'compress@10': 1.0, 'time@10': 2.8009}:  80%|████████  | 8/10 [00:16<00:04,  2.37s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.263, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.4894, 'compress@10': 1.0, 'time@10': 3.0208}:  80%|████████  | 8/10 [00:18<00:04,  2.37s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.263, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.4894, 'compress@10': 1.0, 'time@10': 3.0208}:  90%|█████████ | 9/10 [00:18<00:02,  2.39s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.261, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.4944, 'compress@10': 1.0, 'time@10': 3.0146}:  90%|█████████ | 9/10 [00:21<00:02,  2.39s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.261, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.4944, 'compress@10': 1.0, 'time@10': 3.0146}: 100%|██████████| 10/10 [00:21<00:00,  2.57s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.261, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.4944, 'compress@10': 1.0, 'time@10': 3.0146}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.2609603746289356
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.494407695852058
Avg compression ratio: 1.0
Avg train time: 3.014581060409546
Std train time: 1.568128767883413
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.2658, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.523, 'compress@10': 1.0, 'time@10': 2.4805}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.2658, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.523, 'compress@10': 1.0, 'time@10': 2.4805}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.2608, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.5107, 'compress@10': 1.0, 'time@10': 2.2561}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.2608, 'hit_ratio@10': 0.1112, 'ndcg@10': 0.5107, 'compress@10': 1.0, 'time@10': 2.2561}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.2181, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.599, 'compress@10': 1.0, 'time@10': 1.7621}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.2181, 'hit_ratio@10': 0.1218, 'ndcg@10': 0.599, 'compress@10': 1.0, 'time@10': 1.7621}:  30%|███       | 3/10 [00:03<00:07,  1.14s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.244, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.5728, 'compress@10': 1.0, 'time@10': 1.7631}:  30%|███       | 3/10 [00:05<00:07,  1.14s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.244, 'hit_ratio@10': 0.1538, 'ndcg@10': 0.5728, 'compress@10': 1.0, 'time@10': 1.7631}:  40%|████      | 4/10 [00:05<00:08,  1.40s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.2541, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.5141, 'compress@10': 1.0, 'time@10': 2.8118}:  40%|████      | 4/10 [00:09<00:08,  1.40s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.2541, 'hit_ratio@10': 0.1871, 'ndcg@10': 0.5141, 'compress@10': 1.0, 'time@10': 2.8118}:  50%|█████     | 5/10 [00:09<00:10,  2.17s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.2551, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.5138, 'compress@10': 1.0, 'time@10': 2.8421}:  50%|█████     | 5/10 [00:12<00:10,  2.17s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.2551, 'hit_ratio@10': 0.1966, 'ndcg@10': 0.5138, 'compress@10': 1.0, 'time@10': 2.8421}:  60%|██████    | 6/10 [00:12<00:09,  2.46s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.2567, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.5167, 'compress@10': 1.0, 'time@10': 2.9036}:  60%|██████    | 6/10 [00:13<00:09,  2.46s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.2567, 'hit_ratio@10': 0.1914, 'ndcg@10': 0.5167, 'compress@10': 1.0, 'time@10': 2.9036}:  70%|███████   | 7/10 [00:13<00:06,  2.20s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.2569, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.4915, 'compress@10': 1.0, 'time@10': 2.8215}:  70%|███████   | 7/10 [00:16<00:06,  2.20s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.2569, 'hit_ratio@10': 0.2032, 'ndcg@10': 0.4915, 'compress@10': 1.0, 'time@10': 2.8215}:  80%|████████  | 8/10 [00:16<00:04,  2.22s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.2625, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.4894, 'compress@10': 1.0, 'time@10': 3.0233}:  80%|████████  | 8/10 [00:18<00:04,  2.22s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.2625, 'hit_ratio@10': 0.1965, 'ndcg@10': 0.4894, 'compress@10': 1.0, 'time@10': 3.0233}:  90%|█████████ | 9/10 [00:18<00:02,  2.26s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.2605, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.4944, 'compress@10': 1.0, 'time@10': 3.0141}:  90%|█████████ | 9/10 [00:21<00:02,  2.26s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.2605, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.4944, 'compress@10': 1.0, 'time@10': 3.0141}: 100%|██████████| 10/10 [00:21<00:00,  2.48s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.2605, 'hit_ratio@10': 0.1973, 'ndcg@10': 0.4944, 'compress@10': 1.0, 'time@10': 3.0141}: 100%|██████████| 10/10 [00:21<00:00,  2.14s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.2604591714772876
Avg hit ratio: 0.19728293362928334
Avg ndcg: 0.494407695852058
Avg compression ratio: 1.0
Avg train time: 3.0141372442245484
Std train time: 1.645144594186058
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
