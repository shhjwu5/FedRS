  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2279, 'hit_ratio@10': 0.3158, 'ndcg@10': 0.5042, 'compress@10': 0.5263, 'time@10': 10.3824}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2279, 'hit_ratio@10': 0.3158, 'ndcg@10': 0.5042, 'compress@10': 0.5263, 'time@10': 10.3824}:  10%|█         | 1/10 [00:05<00:47,  5.23s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1626, 'hit_ratio@10': 0.4966, 'ndcg@10': 0.5519, 'compress@10': 0.5212, 'time@10': 9.0428}:  10%|█         | 1/10 [00:12<00:47,  5.23s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.1626, 'hit_ratio@10': 0.4966, 'ndcg@10': 0.5519, 'compress@10': 0.5212, 'time@10': 9.0428}:  20%|██        | 2/10 [00:12<00:53,  6.71s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.871, 'hit_ratio@10': 0.3787, 'ndcg@10': 0.3679, 'compress@10': 0.538, 'time@10': 7.0704}:  20%|██        | 2/10 [00:14<00:53,  6.71s/it]  {'epoch': 0, 'num_users': 5.0, 'loss': 0.871, 'hit_ratio@10': 0.3787, 'ndcg@10': 0.3679, 'compress@10': 0.538, 'time@10': 7.0704}:  30%|███       | 3/10 [00:14<00:30,  4.38s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6926, 'hit_ratio@10': 0.4626, 'ndcg@10': 0.41, 'compress@10': 0.5329, 'time@10': 7.0582}:  30%|███       | 3/10 [00:21<00:30,  4.38s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6926, 'hit_ratio@10': 0.4626, 'ndcg@10': 0.41, 'compress@10': 0.5329, 'time@10': 7.0582}:  40%|████      | 4/10 [00:21<00:32,  5.44s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5738, 'hit_ratio@10': 0.5341, 'ndcg@10': 0.4742, 'compress@10': 0.5283, 'time@10': 10.7543}:  40%|████      | 4/10 [00:34<00:32,  5.44s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5738, 'hit_ratio@10': 0.5341, 'ndcg@10': 0.4742, 'compress@10': 0.5283, 'time@10': 10.7543}:  50%|█████     | 5/10 [00:34<00:40,  8.10s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4933, 'hit_ratio@10': 0.5636, 'ndcg@10': 0.5214, 'compress@10': 0.5255, 'time@10': 10.8257}:  50%|█████     | 5/10 [00:45<00:40,  8.10s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4933, 'hit_ratio@10': 0.5636, 'ndcg@10': 0.5214, 'compress@10': 0.5255, 'time@10': 10.8257}:  60%|██████    | 6/10 [00:45<00:36,  9.16s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.444, 'hit_ratio@10': 0.5688, 'ndcg@10': 0.5227, 'compress@10': 0.5247, 'time@10': 11.0611}:  60%|██████    | 6/10 [00:51<00:36,  9.16s/it] {'epoch': 0, 'num_users': 6.2857, 'loss': 0.444, 'hit_ratio@10': 0.5688, 'ndcg@10': 0.5227, 'compress@10': 0.5247, 'time@10': 11.0611}:  70%|███████   | 7/10 [00:51<00:24,  8.22s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3974, 'hit_ratio@10': 0.612, 'ndcg@10': 0.5437, 'compress@10': 0.5234, 'time@10': 10.7786}:  70%|███████   | 7/10 [01:00<00:24,  8.22s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3974, 'hit_ratio@10': 0.612, 'ndcg@10': 0.5437, 'compress@10': 0.5234, 'time@10': 10.7786}:  80%|████████  | 8/10 [01:00<00:16,  8.41s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3626, 'hit_ratio@10': 0.6297, 'ndcg@10': 0.5803, 'compress@10': 0.5224, 'time@10': 11.5529}:  80%|████████  | 8/10 [01:09<00:16,  8.41s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3626, 'hit_ratio@10': 0.6297, 'ndcg@10': 0.5803, 'compress@10': 0.5224, 'time@10': 11.5529}:  90%|█████████ | 9/10 [01:09<00:08,  8.58s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3325, 'hit_ratio@10': 0.6599, 'ndcg@10': 0.5984, 'compress@10': 0.5213, 'time@10': 11.4836}:  90%|█████████ | 9/10 [01:20<00:08,  8.58s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3325, 'hit_ratio@10': 0.6599, 'ndcg@10': 0.5984, 'compress@10': 0.5213, 'time@10': 11.4836}: 100%|██████████| 10/10 [01:20<00:00,  9.29s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3325, 'hit_ratio@10': 0.6599, 'ndcg@10': 0.5984, 'compress@10': 0.5213, 'time@10': 11.4836}: 100%|██████████| 10/10 [01:20<00:00,  8.06s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.33251519628466847
Avg hit ratio: 0.6598995264309356
Avg ndcg: 0.5984444559306206
Avg compression ratio: 0.5212749006657823
Avg train time: 11.483583354949952
Std train time: 5.922142486350437
[0.25, 0.25, 0.75, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25]
[9, 7, 3, 6, 22, 10, 11, 8, 15, 9]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0725, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.7367, 'compress@10': 0.2895, 'time@10': 8.52}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0725, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.7367, 'compress@10': 0.2895, 'time@10': 8.52}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0683, 'hit_ratio@10': 0.7292, 'ndcg@10': 0.7957, 'compress@10': 0.2818, 'time@10': 7.0073}:  10%|█         | 1/10 [00:09<00:38,  4.30s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0683, 'hit_ratio@10': 0.7292, 'ndcg@10': 0.7957, 'compress@10': 0.2818, 'time@10': 7.0073}:  20%|██        | 2/10 [00:09<00:40,  5.02s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.2896, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.574, 'compress@10': 0.4498, 'time@10': 4.9746}:  20%|██        | 2/10 [00:10<00:40,  5.02s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.2896, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.574, 'compress@10': 0.4498, 'time@10': 4.9746}:  30%|███       | 3/10 [00:10<00:20,  2.95s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.2362, 'hit_ratio@10': 0.7217, 'ndcg@10': 0.6151, 'compress@10': 0.4065, 'time@10': 4.7442}:  30%|███       | 3/10 [00:14<00:20,  2.95s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.2362, 'hit_ratio@10': 0.7217, 'ndcg@10': 0.6151, 'compress@10': 0.4065, 'time@10': 4.7442}:  40%|████      | 4/10 [00:14<00:20,  3.40s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.2018, 'hit_ratio@10': 0.7454, 'ndcg@10': 0.6537, 'compress@10': 0.3782, 'time@10': 14.9182}:  40%|████      | 4/10 [00:42<00:20,  3.40s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.2018, 'hit_ratio@10': 0.7454, 'ndcg@10': 0.6537, 'compress@10': 0.3782, 'time@10': 14.9182}:  50%|█████     | 5/10 [00:42<01:01, 12.22s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.1811, 'hit_ratio@10': 0.7434, 'ndcg@10': 0.6811, 'compress@10': 0.3596, 'time@10': 14.3252}:  50%|█████     | 5/10 [00:53<01:01, 12.22s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.1811, 'hit_ratio@10': 0.7434, 'ndcg@10': 0.6811, 'compress@10': 0.3596, 'time@10': 14.3252}:  60%|██████    | 6/10 [00:53<00:47, 11.94s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.1617, 'hit_ratio@10': 0.7743, 'ndcg@10': 0.7079, 'compress@10': 0.3483, 'time@10': 14.2043}:  60%|██████    | 6/10 [01:00<00:47, 11.94s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.1617, 'hit_ratio@10': 0.7743, 'ndcg@10': 0.7079, 'compress@10': 0.3483, 'time@10': 14.2043}:  70%|███████   | 7/10 [01:00<00:30, 10.25s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.1467, 'hit_ratio@10': 0.7918, 'ndcg@10': 0.7248, 'compress@10': 0.3387, 'time@10': 13.268}:  70%|███████   | 7/10 [01:07<00:30, 10.25s/it]  {'epoch': 1, 'num_users': 6.125, 'loss': 0.1467, 'hit_ratio@10': 0.7918, 'ndcg@10': 0.7248, 'compress@10': 0.3387, 'time@10': 13.268}:  80%|████████  | 8/10 [01:07<00:18,  9.14s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.134, 'hit_ratio@10': 0.7832, 'ndcg@10': 0.7456, 'compress@10': 0.3312, 'time@10': 14.614}:  80%|████████  | 8/10 [01:19<00:18,  9.14s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.134, 'hit_ratio@10': 0.7832, 'ndcg@10': 0.7456, 'compress@10': 0.3312, 'time@10': 14.614}:  90%|█████████ | 9/10 [01:19<00:10, 10.26s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.1254, 'hit_ratio@10': 0.7981, 'ndcg@10': 0.756, 'compress@10': 0.3248, 'time@10': 14.1485}:  90%|█████████ | 9/10 [01:30<00:10, 10.26s/it]  {'epoch': 1, 'num_users': 6.3, 'loss': 0.1254, 'hit_ratio@10': 0.7981, 'ndcg@10': 0.756, 'compress@10': 0.3248, 'time@10': 14.1485}: 100%|██████████| 10/10 [01:30<00:00, 10.32s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.1254, 'hit_ratio@10': 0.7981, 'ndcg@10': 0.756, 'compress@10': 0.3248, 'time@10': 14.1485}: 100%|██████████| 10/10 [01:30<00:00,  9.04s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.12536295770711678
Avg hit ratio: 0.7980698446997259
Avg ndcg: 0.7559858474149496
Avg compression ratio: 0.3247719942251249
Avg train time: 14.148545837402343
Std train time: 15.200065974278388
[0.16666666666666669, 0.16666666666666669, 0.8333333333333334, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[6, 2, 1, 1, 60, 10, 13, 4, 27, 8]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0646, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.7832, 'compress@10': 0.2105, 'time@10': 5.3411}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0646, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.7832, 'compress@10': 0.2105, 'time@10': 5.3411}:  10%|█         | 1/10 [00:02<00:24,  2.71s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0935, 'hit_ratio@10': 0.6808, 'ndcg@10': 0.7176, 'compress@10': 0.202, 'time@10': 3.4527}:  10%|█         | 1/10 [00:04<00:24,  2.71s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0935, 'hit_ratio@10': 0.6808, 'ndcg@10': 0.7176, 'compress@10': 0.202, 'time@10': 3.4527}:  20%|██        | 2/10 [00:04<00:16,  2.06s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.2091, 'hit_ratio@10': 0.5967, 'ndcg@10': 0.5527, 'compress@10': 0.4204, 'time@10': 2.4143}:  20%|██        | 2/10 [00:04<00:16,  2.06s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.2091, 'hit_ratio@10': 0.5967, 'ndcg@10': 0.5527, 'compress@10': 0.4204, 'time@10': 2.4143}:  30%|███       | 3/10 [00:04<00:08,  1.22s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.2095, 'hit_ratio@10': 0.5587, 'ndcg@10': 0.5463, 'compress@10': 0.3647, 'time@10': 1.9775}:  30%|███       | 3/10 [00:05<00:08,  1.22s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.2095, 'hit_ratio@10': 0.5587, 'ndcg@10': 0.5463, 'compress@10': 0.3647, 'time@10': 1.9775}:  40%|████      | 4/10 [00:05<00:06,  1.02s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.17, 'hit_ratio@10': 0.6349, 'ndcg@10': 0.6263, 'compress@10': 0.3284, 'time@10': 31.8369}:  40%|████      | 4/10 [01:20<00:06,  1.02s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.17, 'hit_ratio@10': 0.6349, 'ndcg@10': 0.6263, 'compress@10': 0.3284, 'time@10': 31.8369}:  50%|█████     | 5/10 [01:20<02:19, 27.94s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.154, 'hit_ratio@10': 0.6587, 'ndcg@10': 0.6583, 'compress@10': 0.3046, 'time@10': 28.372}:  50%|█████     | 5/10 [01:32<02:19, 27.94s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.154, 'hit_ratio@10': 0.6587, 'ndcg@10': 0.6583, 'compress@10': 0.3046, 'time@10': 28.372}:  60%|██████    | 6/10 [01:32<01:28, 22.21s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.1378, 'hit_ratio@10': 0.7018, 'ndcg@10': 0.6869, 'compress@10': 0.2896, 'time@10': 26.6227}:  60%|██████    | 6/10 [01:40<01:28, 22.21s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.1378, 'hit_ratio@10': 0.7018, 'ndcg@10': 0.6869, 'compress@10': 0.2896, 'time@10': 26.6227}:  70%|███████   | 7/10 [01:40<00:52, 17.60s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.1272, 'hit_ratio@10': 0.7283, 'ndcg@10': 0.7007, 'compress@10': 0.2772, 'time@10': 23.7057}:  70%|███████   | 7/10 [01:43<00:52, 17.60s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.1272, 'hit_ratio@10': 0.7283, 'ndcg@10': 0.7007, 'compress@10': 0.2772, 'time@10': 23.7057}:  80%|████████  | 8/10 [01:43<00:26, 13.05s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.1161, 'hit_ratio@10': 0.73, 'ndcg@10': 0.7248, 'compress@10': 0.2676, 'time@10': 26.2312}:  80%|████████  | 8/10 [02:06<00:26, 13.05s/it] {'epoch': 2, 'num_users': 6.3333, 'loss': 0.1161, 'hit_ratio@10': 0.73, 'ndcg@10': 0.7248, 'compress@10': 0.2676, 'time@10': 26.2312}:  90%|█████████ | 9/10 [02:06<00:16, 16.24s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.1092, 'hit_ratio@10': 0.7501, 'ndcg@10': 0.7377, 'compress@10': 0.2594, 'time@10': 24.4935}:  90%|█████████ | 9/10 [02:15<00:16, 16.24s/it] {'epoch': 2, 'num_users': 6.3, 'loss': 0.1092, 'hit_ratio@10': 0.7501, 'ndcg@10': 0.7377, 'compress@10': 0.2594, 'time@10': 24.4935}: 100%|██████████| 10/10 [02:15<00:00, 13.97s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.1092, 'hit_ratio@10': 0.7501, 'ndcg@10': 0.7377, 'compress@10': 0.2594, 'time@10': 24.4935}: 100%|██████████| 10/10 [02:15<00:00, 13.56s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.10918126167577877
Avg hit ratio: 0.7501384570909189
Avg ndcg: 0.7377074645074316
Avg compression ratio: 0.2593906332175414
Avg train time: 24.493535304069518
Std train time: 44.20833501184796
[0.125, 0.125, 0.875, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
[1, 1, 1, 1, 182, 10, 17, 1, 57, 6]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.1941, 'hit_ratio@10': 0.5556, 'ndcg@10': 0.603, 'compress@10': 0.1736, 'time@10': 1.0965}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.1941, 'hit_ratio@10': 0.5556, 'ndcg@10': 0.603, 'compress@10': 0.1736, 'time@10': 1.0965}:  10%|█         | 1/10 [00:00<00:05,  1.69it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.1757, 'hit_ratio@10': 0.6004, 'ndcg@10': 0.6024, 'compress@10': 0.1634, 'time@10': 0.9517}:  10%|█         | 1/10 [00:01<00:05,  1.69it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.1757, 'hit_ratio@10': 0.6004, 'ndcg@10': 0.6024, 'compress@10': 0.1634, 'time@10': 0.9517}:  20%|██        | 2/10 [00:01<00:05,  1.35it/s]{'epoch': 3, 'num_users': 5.0, 'loss': 0.2284, 'hit_ratio@10': 0.5431, 'ndcg@10': 0.4979, 'compress@10': 0.4066, 'time@10': 0.7402}:  20%|██        | 2/10 [00:01<00:05,  1.35it/s]{'epoch': 3, 'num_users': 5.0, 'loss': 0.2284, 'hit_ratio@10': 0.5431, 'ndcg@10': 0.4979, 'compress@10': 0.4066, 'time@10': 0.7402}:  30%|███       | 3/10 [00:01<00:03,  2.03it/s]{'epoch': 3, 'num_users': 5.0, 'loss': 0.2187, 'hit_ratio@10': 0.5277, 'ndcg@10': 0.5123, 'compress@10': 0.3443, 'time@10': 0.7213}:  30%|███       | 3/10 [00:02<00:03,  2.03it/s]{'epoch': 3, 'num_users': 5.0, 'loss': 0.2187, 'hit_ratio@10': 0.5277, 'ndcg@10': 0.5123, 'compress@10': 0.3443, 'time@10': 0.7213}:  40%|████      | 4/10 [00:02<00:03,  1.74it/s]{'epoch': 3, 'num_users': 5.8, 'loss': 0.1755, 'hit_ratio@10': 0.6142, 'ndcg@10': 0.6058, 'compress@10': 0.3039, 'time@10': 92.6195}:  40%|████      | 4/10 [03:52<00:03,  1.74it/s]{'epoch': 3, 'num_users': 5.8, 'loss': 0.1755, 'hit_ratio@10': 0.6142, 'ndcg@10': 0.6058, 'compress@10': 0.3039, 'time@10': 92.6195}:  50%|█████     | 5/10 [03:52<06:56, 83.36s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.158, 'hit_ratio@10': 0.6451, 'ndcg@10': 0.6423, 'compress@10': 0.2773, 'time@10': 78.9175}:  50%|█████     | 5/10 [04:02<06:56, 83.36s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.158, 'hit_ratio@10': 0.6451, 'ndcg@10': 0.6423, 'compress@10': 0.2773, 'time@10': 78.9175}:  60%|██████    | 6/10 [04:02<03:54, 58.57s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.1417, 'hit_ratio@10': 0.6901, 'ndcg@10': 0.6708, 'compress@10': 0.2606, 'time@10': 70.657}:  60%|██████    | 6/10 [04:13<03:54, 58.57s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.1417, 'hit_ratio@10': 0.6901, 'ndcg@10': 0.6708, 'compress@10': 0.2606, 'time@10': 70.657}:  70%|███████   | 7/10 [04:13<02:08, 42.88s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.1431, 'hit_ratio@10': 0.6921, 'ndcg@10': 0.6537, 'compress@10': 0.2468, 'time@10': 61.9299}:  70%|███████   | 7/10 [04:14<02:08, 42.88s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.1431, 'hit_ratio@10': 0.6921, 'ndcg@10': 0.6537, 'compress@10': 0.2468, 'time@10': 61.9299}:  80%|████████  | 8/10 [04:14<00:59, 29.51s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.13, 'hit_ratio@10': 0.7041, 'ndcg@10': 0.6875, 'compress@10': 0.2361, 'time@10': 65.9963}:  80%|████████  | 8/10 [05:03<00:59, 29.51s/it] {'epoch': 3, 'num_users': 6.3333, 'loss': 0.13, 'hit_ratio@10': 0.7041, 'ndcg@10': 0.6875, 'compress@10': 0.2361, 'time@10': 65.9963}:  90%|█████████ | 9/10 [05:03<00:35, 35.70s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.1218, 'hit_ratio@10': 0.7268, 'ndcg@10': 0.7039, 'compress@10': 0.227, 'time@10': 60.0488}:  90%|█████████ | 9/10 [05:10<00:35, 35.70s/it]  {'epoch': 3, 'num_users': 6.3, 'loss': 0.1218, 'hit_ratio@10': 0.7268, 'ndcg@10': 0.7039, 'compress@10': 0.227, 'time@10': 60.0488}: 100%|██████████| 10/10 [05:10<00:00, 26.70s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.1218, 'hit_ratio@10': 0.7268, 'ndcg@10': 0.7039, 'compress@10': 0.227, 'time@10': 60.0488}: 100%|██████████| 10/10 [05:10<00:00, 31.03s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.1217975050857274
Avg hit ratio: 0.7268470290690404
Avg ndcg: 0.7039079872804311
Avg compression ratio: 0.22696566088503464
Avg train time: 60.04884898662567
Std train time: 136.3976640865101
[0.1, 0.1, 0.9, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[1, 1, 1, 1, 573, 9, 25, 1, 133, 2]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1905, 'hit_ratio@10': 0.5, 'ndcg@10': 0.5972, 'compress@10': 0.15, 'time@10': 0.9364}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1905, 'hit_ratio@10': 0.5, 'ndcg@10': 0.5972, 'compress@10': 0.15, 'time@10': 0.9364}:  10%|█         | 1/10 [00:00<00:04,  1.98it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1739, 'hit_ratio@10': 0.5242, 'ndcg@10': 0.604, 'compress@10': 0.1395, 'time@10': 0.8632}:  10%|█         | 1/10 [00:01<00:04,  1.98it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1739, 'hit_ratio@10': 0.5242, 'ndcg@10': 0.604, 'compress@10': 0.1395, 'time@10': 0.8632}:  20%|██        | 2/10 [00:01<00:05,  1.44it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.2178, 'hit_ratio@10': 0.4923, 'ndcg@10': 0.506, 'compress@10': 0.3978, 'time@10': 0.6913}:  20%|██        | 2/10 [00:01<00:05,  1.44it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.2178, 'hit_ratio@10': 0.4923, 'ndcg@10': 0.506, 'compress@10': 0.3978, 'time@10': 0.6913}:  30%|███       | 3/10 [00:01<00:03,  2.11it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.2117, 'hit_ratio@10': 0.4896, 'ndcg@10': 0.5212, 'compress@10': 0.3317, 'time@10': 0.688}:  30%|███       | 3/10 [00:02<00:03,  2.11it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.2117, 'hit_ratio@10': 0.4896, 'ndcg@10': 0.5212, 'compress@10': 0.3317, 'time@10': 0.688}:  40%|████      | 4/10 [00:02<00:03,  1.76it/s]{'epoch': 4, 'num_users': 5.8, 'loss': 0.1697, 'hit_ratio@10': 0.5877, 'ndcg@10': 0.6129, 'compress@10': 0.2889, 'time@10': 282.9134}:  40%|████      | 4/10 [11:48<00:03,  1.76it/s]{'epoch': 4, 'num_users': 5.8, 'loss': 0.1697, 'hit_ratio@10': 0.5877, 'ndcg@10': 0.6129, 'compress@10': 0.2889, 'time@10': 282.9134}:  50%|█████     | 5/10 [11:48<21:14, 254.93s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.1527, 'hit_ratio@10': 0.6231, 'ndcg@10': 0.6487, 'compress@10': 0.2608, 'time@10': 237.2543}:  50%|█████     | 5/10 [11:57<21:14, 254.93s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.1527, 'hit_ratio@10': 0.6231, 'ndcg@10': 0.6487, 'compress@10': 0.2608, 'time@10': 237.2543}:  60%|██████    | 6/10 [11:57<11:25, 171.31s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.1357, 'hit_ratio@10': 0.6712, 'ndcg@10': 0.6784, 'compress@10': 0.243, 'time@10': 207.5238}:  60%|██████    | 6/10 [12:11<11:25, 171.31s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.1357, 'hit_ratio@10': 0.6712, 'ndcg@10': 0.6784, 'compress@10': 0.243, 'time@10': 207.5238}:  70%|███████   | 7/10 [12:11<06:00, 120.08s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.1371, 'hit_ratio@10': 0.6755, 'ndcg@10': 0.6634, 'compress@10': 0.2284, 'time@10': 181.6908}:  70%|███████   | 7/10 [12:12<06:00, 120.08s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.1371, 'hit_ratio@10': 0.6755, 'ndcg@10': 0.6634, 'compress@10': 0.2284, 'time@10': 181.6908}:  80%|████████  | 8/10 [12:12<02:44, 82.14s/it] {'epoch': 4, 'num_users': 6.3333, 'loss': 0.1234, 'hit_ratio@10': 0.6798, 'ndcg@10': 0.6975, 'compress@10': 0.217, 'time@10': 185.8704}:  80%|████████  | 8/10 [14:02<02:44, 82.14s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.1234, 'hit_ratio@10': 0.6798, 'ndcg@10': 0.6975, 'compress@10': 0.217, 'time@10': 185.8704}:  90%|█████████ | 9/10 [14:02<01:30, 90.75s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.1192, 'hit_ratio@10': 0.6891, 'ndcg@10': 0.7003, 'compress@10': 0.2073, 'time@10': 167.4948}:  90%|█████████ | 9/10 [14:04<01:30, 90.75s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.1192, 'hit_ratio@10': 0.6891, 'ndcg@10': 0.7003, 'compress@10': 0.2073, 'time@10': 167.4948}: 100%|██████████| 10/10 [14:04<00:00, 63.40s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.1192, 'hit_ratio@10': 0.6891, 'ndcg@10': 0.7003, 'compress@10': 0.2073, 'time@10': 167.4948}: 100%|██████████| 10/10 [14:04<00:00, 84.45s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.11918376378404723
Avg hit ratio: 0.6891335346781268
Avg ndcg: 0.7002575874821682
Avg compression ratio: 0.20733671155402922
Avg train time: 167.49480271339417
Std train time: 419.72721328140784
[0.08333333333333334, 0.08333333333333334, 0.9166666666666667, 0.08333333333333334, 0.08333333333333334, 0.08333333333333334, 0.08333333333333334, 0.08333333333333334, 0.08333333333333334, 0.08333333333333334]
[1, 1, 1, 1, 1792, 7, 40, 1, 314, 1]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.2033, 'hit_ratio@10': 0.5, 'ndcg@10': 0.559, 'compress@10': 0.1343, 'time@10': 0.8463}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.2033, 'hit_ratio@10': 0.5, 'ndcg@10': 0.559, 'compress@10': 0.1343, 'time@10': 0.8463}:  10%|█         | 1/10 [00:00<00:04,  2.18it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.1889, 'hit_ratio@10': 0.4919, 'ndcg@10': 0.58, 'compress@10': 0.1236, 'time@10': 0.7882}:  10%|█         | 1/10 [00:01<00:04,  2.18it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.1889, 'hit_ratio@10': 0.4919, 'ndcg@10': 0.58, 'compress@10': 0.1236, 'time@10': 0.7882}:  20%|██        | 2/10 [00:01<00:05,  1.56it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.2301, 'hit_ratio@10': 0.4708, 'ndcg@10': 0.4966, 'compress@10': 0.3919, 'time@10': 0.6345}:  20%|██        | 2/10 [00:01<00:05,  1.56it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.2301, 'hit_ratio@10': 0.4708, 'ndcg@10': 0.4966, 'compress@10': 0.3919, 'time@10': 0.6345}:  30%|███       | 3/10 [00:01<00:03,  2.28it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.2259, 'hit_ratio@10': 0.4735, 'ndcg@10': 0.5084, 'compress@10': 0.3233, 'time@10': 0.6328}:  30%|███       | 3/10 [00:02<00:03,  2.28it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.2259, 'hit_ratio@10': 0.4735, 'ndcg@10': 0.5084, 'compress@10': 0.3233, 'time@10': 0.6328}:  40%|████      | 4/10 [00:02<00:03,  1.89it/s]{'epoch': 5, 'num_users': 5.8, 'loss': 0.1808, 'hit_ratio@10': 0.5748, 'ndcg@10': 0.6027, 'compress@10': 0.2789, 'time@10': 824.3314}:  40%|████      | 4/10 [34:21<00:03,  1.89it/s]{'epoch': 5, 'num_users': 5.8, 'loss': 0.1808, 'hit_ratio@10': 0.5748, 'ndcg@10': 0.6027, 'compress@10': 0.2789, 'time@10': 824.3314}:  50%|█████     | 5/10 [34:21<1:01:55, 743.05s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.1616, 'hit_ratio@10': 0.616, 'ndcg@10': 0.6391, 'compress@10': 0.2497, 'time@10': 688.0615}:  50%|█████     | 5/10 [34:28<1:01:55, 743.05s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.1616, 'hit_ratio@10': 0.616, 'ndcg@10': 0.6391, 'compress@10': 0.2497, 'time@10': 688.0615}:  60%|██████    | 6/10 [34:28<32:50, 492.70s/it]  {'epoch': 5, 'num_users': 6.2857, 'loss': 0.1416, 'hit_ratio@10': 0.6652, 'ndcg@10': 0.6785, 'compress@10': 0.2312, 'time@10': 596.3012}:  60%|██████    | 6/10 [34:51<32:50, 492.70s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.1416, 'hit_ratio@10': 0.6652, 'ndcg@10': 0.6785, 'compress@10': 0.2312, 'time@10': 596.3012}:  70%|███████   | 7/10 [34:51<16:57, 339.12s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.1447, 'hit_ratio@10': 0.6666, 'ndcg@10': 0.6588, 'compress@10': 0.2161, 'time@10': 521.8621}:  70%|███████   | 7/10 [34:52<16:57, 339.12s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.1447, 'hit_ratio@10': 0.6666, 'ndcg@10': 0.6588, 'compress@10': 0.2161, 'time@10': 521.8621}:  80%|████████  | 8/10 [34:52<07:42, 231.42s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.1303, 'hit_ratio@10': 0.6751, 'ndcg@10': 0.6935, 'compress@10': 0.2043, 'time@10': 519.8}:  80%|████████  | 8/10 [39:03<07:42, 231.42s/it]  {'epoch': 5, 'num_users': 6.3333, 'loss': 0.1303, 'hit_ratio@10': 0.6751, 'ndcg@10': 0.6935, 'compress@10': 0.2043, 'time@10': 519.8}:  90%|█████████ | 9/10 [39:03<03:57, 237.76s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.1323, 'hit_ratio@10': 0.668, 'ndcg@10': 0.6861, 'compress@10': 0.1943, 'time@10': 467.931}:  90%|█████████ | 9/10 [39:05<03:57, 237.76s/it]  {'epoch': 5, 'num_users': 6.3, 'loss': 0.1323, 'hit_ratio@10': 0.668, 'ndcg@10': 0.6861, 'compress@10': 0.1943, 'time@10': 467.931}: 100%|██████████| 10/10 [39:05<00:00, 164.71s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.1323, 'hit_ratio@10': 0.668, 'ndcg@10': 0.6861, 'compress@10': 0.1943, 'time@10': 467.931}: 100%|██████████| 10/10 [39:05<00:00, 234.50s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.13227049466167204
Avg hit ratio: 0.6680124993900203
Avg ndcg: 0.6861227938327275
Avg compression ratio: 0.19429437803124844
Avg train time: 467.9309792518616
Std train time: 1226.0936263623282
[0.07142857142857144, 0.07142857142857144, 0.9285714285714286, 0.07142857142857144, 0.07142857142857144, 0.07142857142857144, 0.07142857142857144, 0.07142857142857144, 0.07142857142857144, 0.07142857142857144]
[1, 1, 1, 1, 5369, 3, 70, 1, 742, 1]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2291, 'hit_ratio@10': 0.5, 'ndcg@10': 0.4626, 'compress@10': 0.123, 'time@10': 0.8515}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2291, 'hit_ratio@10': 0.5, 'ndcg@10': 0.4626, 'compress@10': 0.123, 'time@10': 0.8515}:  10%|█         | 1/10 [00:00<00:04,  2.17it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2152, 'hit_ratio@10': 0.4597, 'ndcg@10': 0.4927, 'compress@10': 0.1122, 'time@10': 0.7918}:  10%|█         | 1/10 [00:01<00:04,  2.17it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2152, 'hit_ratio@10': 0.4597, 'ndcg@10': 0.4927, 'compress@10': 0.1122, 'time@10': 0.7918}:  20%|██        | 2/10 [00:01<00:05,  1.56it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.254, 'hit_ratio@10': 0.4493, 'ndcg@10': 0.4217, 'compress@10': 0.3877, 'time@10': 0.6335}:  20%|██        | 2/10 [00:01<00:05,  1.56it/s] {'epoch': 6, 'num_users': 5.0, 'loss': 0.254, 'hit_ratio@10': 0.4493, 'ndcg@10': 0.4217, 'compress@10': 0.3877, 'time@10': 0.6335}:  30%|███       | 3/10 [00:01<00:03,  2.28it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.2527, 'hit_ratio@10': 0.4574, 'ndcg@10': 0.4345, 'compress@10': 0.3173, 'time@10': 0.6276}:  30%|███       | 3/10 [00:02<00:03,  2.28it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.2527, 'hit_ratio@10': 0.4574, 'ndcg@10': 0.4345, 'compress@10': 0.3173, 'time@10': 0.6276}:  40%|████      | 4/10 [00:02<00:03,  1.92it/s]