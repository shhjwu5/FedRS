  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1634, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.4961, 'compress@10': 1.0, 'time@10': 3.73}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1634, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.4961, 'compress@10': 1.0, 'time@10': 3.73}:  10%|█         | 1/10 [00:01<00:17,  1.90s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1201, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.634, 'compress@10': 1.0, 'time@10': 2.9535}:  10%|█         | 1/10 [00:04<00:17,  1.90s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1201, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.634, 'compress@10': 1.0, 'time@10': 2.9535}:  20%|██        | 2/10 [00:04<00:16,  2.09s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8264, 'hit_ratio@10': 0.5463, 'ndcg@10': 0.4227, 'compress@10': 1.0, 'time@10': 2.263}:  20%|██        | 2/10 [00:04<00:16,  2.09s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8264, 'hit_ratio@10': 0.5463, 'ndcg@10': 0.4227, 'compress@10': 1.0, 'time@10': 2.263}:  30%|███       | 3/10 [00:04<00:09,  1.36s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6443, 'hit_ratio@10': 0.6061, 'ndcg@10': 0.4805, 'compress@10': 1.0, 'time@10': 2.1686}:  30%|███       | 3/10 [00:06<00:09,  1.36s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6443, 'hit_ratio@10': 0.6061, 'ndcg@10': 0.4805, 'compress@10': 1.0, 'time@10': 2.1686}:  40%|████      | 4/10 [00:06<00:09,  1.59s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5342, 'hit_ratio@10': 0.6489, 'ndcg@10': 0.533, 'compress@10': 1.0, 'time@10': 3.1959}:  40%|████      | 4/10 [00:10<00:09,  1.59s/it] {'epoch': 0, 'num_users': 5.8, 'loss': 0.5342, 'hit_ratio@10': 0.6489, 'ndcg@10': 0.533, 'compress@10': 1.0, 'time@10': 3.1959}:  50%|█████     | 5/10 [00:10<00:11,  2.35s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4595, 'hit_ratio@10': 0.6593, 'ndcg@10': 0.5762, 'compress@10': 1.0, 'time@10': 3.1933}:  50%|█████     | 5/10 [00:13<00:11,  2.35s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4595, 'hit_ratio@10': 0.6593, 'ndcg@10': 0.5762, 'compress@10': 1.0, 'time@10': 3.1933}:  60%|██████    | 6/10 [00:13<00:10,  2.64s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4092, 'hit_ratio@10': 0.668, 'ndcg@10': 0.5791, 'compress@10': 1.0, 'time@10': 3.2303}:  60%|██████    | 6/10 [00:15<00:10,  2.64s/it] {'epoch': 0, 'num_users': 6.2857, 'loss': 0.4092, 'hit_ratio@10': 0.668, 'ndcg@10': 0.5791, 'compress@10': 1.0, 'time@10': 3.2303}:  70%|███████   | 7/10 [00:15<00:07,  2.36s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3643, 'hit_ratio@10': 0.6987, 'ndcg@10': 0.6037, 'compress@10': 1.0, 'time@10': 3.1226}:  70%|███████   | 7/10 [00:17<00:07,  2.36s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3643, 'hit_ratio@10': 0.6987, 'ndcg@10': 0.6037, 'compress@10': 1.0, 'time@10': 3.1226}:  80%|████████  | 8/10 [00:17<00:04,  2.37s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3297, 'hit_ratio@10': 0.7036, 'ndcg@10': 0.6372, 'compress@10': 1.0, 'time@10': 3.3269}:  80%|████████  | 8/10 [00:20<00:04,  2.37s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3297, 'hit_ratio@10': 0.7036, 'ndcg@10': 0.6372, 'compress@10': 1.0, 'time@10': 3.3269}:  90%|█████████ | 9/10 [00:20<00:02,  2.42s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.302, 'hit_ratio@10': 0.7265, 'ndcg@10': 0.6579, 'compress@10': 1.0, 'time@10': 3.3018}:  90%|█████████ | 9/10 [00:23<00:02,  2.42s/it]    {'epoch': 0, 'num_users': 6.3, 'loss': 0.302, 'hit_ratio@10': 0.7265, 'ndcg@10': 0.6579, 'compress@10': 1.0, 'time@10': 3.3018}: 100%|██████████| 10/10 [00:23<00:00,  2.63s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.302, 'hit_ratio@10': 0.7265, 'ndcg@10': 0.6579, 'compress@10': 1.0, 'time@10': 3.3018}: 100%|██████████| 10/10 [00:23<00:00,  2.33s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3019596033377828
Avg hit ratio: 0.7264641638308871
Avg ndcg: 0.6578896875295775
Avg compression ratio: 1.0
Avg train time: 3.3017954349517824
Std train time: 1.704526817739248
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[9, 13, 17, 14, 1, 10, 10, 13, 5, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0556, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8281, 'compress@10': 1.0, 'time@10': 2.3107}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0556, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8281, 'compress@10': 1.0, 'time@10': 2.3107}:  10%|█         | 1/10 [00:01<00:10,  1.19s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0537, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8386, 'compress@10': 1.0, 'time@10': 2.6507}:  10%|█         | 1/10 [00:04<00:10,  1.19s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0537, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8386, 'compress@10': 1.0, 'time@10': 2.6507}:  20%|██        | 2/10 [00:04<00:18,  2.27s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8448, 'compress@10': 1.0, 'time@10': 2.2297}:  20%|██        | 2/10 [00:04<00:18,  2.27s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8448, 'compress@10': 1.0, 'time@10': 2.2297}:  30%|███       | 3/10 [00:04<00:10,  1.57s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0395, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8448, 'compress@10': 1.0, 'time@10': 2.3592}:  30%|███       | 3/10 [00:07<00:10,  1.57s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0395, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8448, 'compress@10': 1.0, 'time@10': 2.3592}:  40%|████      | 4/10 [00:07<00:12,  2.05s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0947, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.7647, 'compress@10': 1.0, 'time@10': 2.0279}:  40%|████      | 4/10 [00:08<00:12,  2.05s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0947, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.7647, 'compress@10': 1.0, 'time@10': 2.0279}:  50%|█████     | 5/10 [00:08<00:07,  1.45s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0918, 'hit_ratio@10': 0.7706, 'ndcg@10': 0.7727, 'compress@10': 1.0, 'time@10': 2.2239}:  50%|█████     | 5/10 [00:11<00:07,  1.45s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0918, 'hit_ratio@10': 0.7706, 'ndcg@10': 0.7727, 'compress@10': 1.0, 'time@10': 2.2239}:  60%|██████    | 6/10 [00:11<00:08,  2.06s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0848, 'hit_ratio@10': 0.7976, 'ndcg@10': 0.787, 'compress@10': 1.0, 'time@10': 2.4055}:  60%|██████    | 6/10 [00:13<00:08,  2.06s/it] {'epoch': 1, 'num_users': 6.2857, 'loss': 0.0848, 'hit_ratio@10': 0.7976, 'ndcg@10': 0.787, 'compress@10': 1.0, 'time@10': 2.4055}:  70%|███████   | 7/10 [00:13<00:05,  1.97s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0788, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.7972, 'compress@10': 1.0, 'time@10': 2.4907}:  70%|███████   | 7/10 [00:16<00:05,  1.97s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0788, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.7972, 'compress@10': 1.0, 'time@10': 2.4907}:  80%|████████  | 8/10 [00:16<00:04,  2.34s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0754, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.8101, 'compress@10': 1.0, 'time@10': 2.4984}:  80%|████████  | 8/10 [00:17<00:04,  2.34s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0754, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.8101, 'compress@10': 1.0, 'time@10': 2.4984}:  90%|█████████ | 9/10 [00:17<00:02,  2.02s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0725, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8134, 'compress@10': 1.0, 'time@10': 2.5891}:  90%|█████████ | 9/10 [00:21<00:02,  2.02s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0725, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8134, 'compress@10': 1.0, 'time@10': 2.5891}: 100%|██████████| 10/10 [00:21<00:00,  2.46s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0725, 'hit_ratio@10': 0.8172, 'ndcg@10': 0.8134, 'compress@10': 1.0, 'time@10': 2.5891}: 100%|██████████| 10/10 [00:21<00:00,  2.10s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.07251892308129827
Avg hit ratio: 0.8172495874513823
Avg ndcg: 0.8134021543415901
Avg compression ratio: 1.0
Avg train time: 2.589079236984253
Std train time: 0.8589831110205697
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 14, 22, 16, 8, 10, 9, 14, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.2365}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8501, 'compress@10': 1.0, 'time@10': 3.2365}:  10%|█         | 1/10 [00:01<00:15,  1.68s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 3.1898}:  10%|█         | 1/10 [00:04<00:15,  1.68s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.845, 'compress@10': 1.0, 'time@10': 3.1898}:  20%|██        | 2/10 [00:04<00:20,  2.56s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 2.7555}:  20%|██        | 2/10 [00:05<00:20,  2.56s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8491, 'compress@10': 1.0, 'time@10': 2.7555}:  30%|███       | 3/10 [00:05<00:12,  1.84s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8505, 'compress@10': 1.0, 'time@10': 2.8537}:  30%|███       | 3/10 [00:09<00:12,  1.84s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8505, 'compress@10': 1.0, 'time@10': 2.8537}:  40%|████      | 4/10 [00:09<00:14,  2.38s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.4597}:  40%|████      | 4/10 [00:12<00:14,  2.38s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.8499, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.4597}:  50%|█████     | 5/10 [00:12<00:12,  2.59s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0513, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8361, 'compress@10': 1.0, 'time@10': 3.4186}:  50%|█████     | 5/10 [00:15<00:12,  2.59s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0513, 'hit_ratio@10': 0.8305, 'ndcg@10': 0.8361, 'compress@10': 1.0, 'time@10': 3.4186}:  60%|██████    | 6/10 [00:15<00:11,  2.82s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.05, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8389, 'compress@10': 1.0, 'time@10': 3.3844}:  60%|██████    | 6/10 [00:16<00:11,  2.82s/it]   {'epoch': 2, 'num_users': 6.2857, 'loss': 0.05, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8389, 'compress@10': 1.0, 'time@10': 3.3844}:  70%|███████   | 7/10 [00:16<00:07,  2.43s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0511, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8296, 'compress@10': 1.0, 'time@10': 3.4009}:  70%|███████   | 7/10 [00:20<00:07,  2.43s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0511, 'hit_ratio@10': 0.8607, 'ndcg@10': 0.8296, 'compress@10': 1.0, 'time@10': 3.4009}:  80%|████████  | 8/10 [00:20<00:05,  2.79s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8389, 'compress@10': 1.0, 'time@10': 3.4214}:  80%|████████  | 8/10 [00:22<00:05,  2.79s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0493, 'hit_ratio@10': 0.8445, 'ndcg@10': 0.8389, 'compress@10': 1.0, 'time@10': 3.4214}:  90%|█████████ | 9/10 [00:22<00:02,  2.49s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8406, 'compress@10': 1.0, 'time@10': 3.4159}:  90%|█████████ | 9/10 [00:25<00:02,  2.49s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8406, 'compress@10': 1.0, 'time@10': 3.4159}: 100%|██████████| 10/10 [00:25<00:00,  2.77s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8406, 'compress@10': 1.0, 'time@10': 3.4159}: 100%|██████████| 10/10 [00:25<00:00,  2.57s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.048853684830558
Avg hit ratio: 0.8531906305352825
Avg ndcg: 0.8406496863122129
Avg compression ratio: 1.0
Avg train time: 3.415945363044739
Std train time: 0.9350405255645201
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 14, 26, 16, 1, 10, 9, 13, 6, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 3.2039}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0463, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 3.2039}:  10%|█         | 1/10 [00:01<00:14,  1.64s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 3.1727}:  10%|█         | 1/10 [00:04<00:14,  1.64s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 3.1727}:  20%|██        | 2/10 [00:04<00:20,  2.55s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8552, 'compress@10': 1.0, 'time@10': 2.8363}:  20%|██        | 2/10 [00:05<00:20,  2.55s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8552, 'compress@10': 1.0, 'time@10': 2.8363}:  30%|███       | 3/10 [00:05<00:13,  1.89s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0384, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8725, 'compress@10': 1.0, 'time@10': 2.9017}:  30%|███       | 3/10 [00:09<00:13,  1.89s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0384, 'hit_ratio@10': 0.8365, 'ndcg@10': 0.8725, 'compress@10': 1.0, 'time@10': 2.9017}:  40%|████      | 4/10 [00:09<00:14,  2.39s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0712, 'hit_ratio@10': 0.7957, 'ndcg@10': 0.8103, 'compress@10': 1.0, 'time@10': 2.481}:  40%|████      | 4/10 [00:09<00:14,  2.39s/it] {'epoch': 3, 'num_users': 5.8, 'loss': 0.0712, 'hit_ratio@10': 0.7957, 'ndcg@10': 0.8103, 'compress@10': 1.0, 'time@10': 2.481}:  50%|█████     | 5/10 [00:09<00:08,  1.68s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0709, 'hit_ratio@10': 0.789, 'ndcg@10': 0.8123, 'compress@10': 1.0, 'time@10': 2.6067}:  50%|█████     | 5/10 [00:12<00:08,  1.68s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0709, 'hit_ratio@10': 0.789, 'ndcg@10': 0.8123, 'compress@10': 1.0, 'time@10': 2.6067}:  60%|██████    | 6/10 [00:12<00:08,  2.22s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.068, 'hit_ratio@10': 0.8077, 'ndcg@10': 0.8228, 'compress@10': 1.0, 'time@10': 2.6835}:  60%|██████    | 6/10 [00:14<00:08,  2.22s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.068, 'hit_ratio@10': 0.8077, 'ndcg@10': 0.8228, 'compress@10': 1.0, 'time@10': 2.6835}:  70%|███████   | 7/10 [00:14<00:06,  2.02s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.065, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.832, 'compress@10': 1.0, 'time@10': 2.7489}:  70%|███████   | 7/10 [00:17<00:06,  2.02s/it]  {'epoch': 3, 'num_users': 6.125, 'loss': 0.065, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.832, 'compress@10': 1.0, 'time@10': 2.7489}:  80%|████████  | 8/10 [00:17<00:04,  2.41s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0623, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 2.7833}:  80%|████████  | 8/10 [00:19<00:04,  2.41s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0623, 'hit_ratio@10': 0.8155, 'ndcg@10': 0.8407, 'compress@10': 1.0, 'time@10': 2.7833}:  90%|█████████ | 9/10 [00:19<00:02,  2.15s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0605, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.8418, 'compress@10': 1.0, 'time@10': 2.8459}:  90%|█████████ | 9/10 [00:22<00:02,  2.15s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0605, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.8418, 'compress@10': 1.0, 'time@10': 2.8459}: 100%|██████████| 10/10 [00:22<00:00,  2.55s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0605, 'hit_ratio@10': 0.8272, 'ndcg@10': 0.8418, 'compress@10': 1.0, 'time@10': 2.8459}: 100%|██████████| 10/10 [00:22<00:00,  2.27s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.06054737275417987
Avg hit ratio: 0.8271666381426266
Avg ndcg: 0.8417765232178983
Avg compression ratio: 1.0
Avg train time: 2.8458527326583862
Std train time: 0.7530776303113752
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 14, 29, 17, 8, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 3.2332}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 3.2332}:  10%|█         | 1/10 [00:01<00:14,  1.65s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8646, 'compress@10': 1.0, 'time@10': 3.168}:  10%|█         | 1/10 [00:04<00:14,  1.65s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0425, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8646, 'compress@10': 1.0, 'time@10': 3.168}:  20%|██        | 2/10 [00:04<00:20,  2.53s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 2.9725}:  20%|██        | 2/10 [00:06<00:20,  2.53s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 2.9725}:  30%|███       | 3/10 [00:06<00:13,  1.98s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 3.0674}:  30%|███       | 3/10 [00:09<00:13,  1.98s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 3.0674}:  40%|████      | 4/10 [00:09<00:15,  2.54s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 3.6469}:  40%|████      | 4/10 [00:12<00:15,  2.54s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0466, 'hit_ratio@10': 0.8072, 'ndcg@10': 0.849, 'compress@10': 1.0, 'time@10': 3.6469}:  50%|█████     | 5/10 [00:12<00:13,  2.71s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0496, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 3.5881}:  50%|█████     | 5/10 [00:15<00:13,  2.71s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0496, 'hit_ratio@10': 0.8134, 'ndcg@10': 0.8449, 'compress@10': 1.0, 'time@10': 3.5881}:  60%|██████    | 6/10 [00:15<00:11,  2.92s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0491, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 3.5403}:  60%|██████    | 6/10 [00:17<00:11,  2.92s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0491, 'hit_ratio@10': 0.8344, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 3.5403}:  70%|███████   | 7/10 [00:17<00:07,  2.51s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0511, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8473, 'compress@10': 1.0, 'time@10': 3.4944}:  70%|███████   | 7/10 [00:20<00:07,  2.51s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0511, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8473, 'compress@10': 1.0, 'time@10': 3.4944}:  80%|████████  | 8/10 [00:20<00:05,  2.74s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0509, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8569, 'compress@10': 1.0, 'time@10': 3.511}:  80%|████████  | 8/10 [00:22<00:05,  2.74s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0509, 'hit_ratio@10': 0.8458, 'ndcg@10': 0.8569, 'compress@10': 1.0, 'time@10': 3.511}:  90%|█████████ | 9/10 [00:22<00:02,  2.46s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 3.4981}:  90%|█████████ | 9/10 [00:26<00:02,  2.46s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 3.4981}: 100%|██████████| 10/10 [00:26<00:00,  2.76s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 3.4981}: 100%|██████████| 10/10 [00:26<00:00,  2.60s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.049918750201843005
Avg hit ratio: 0.8543846909551494
Avg ndcg: 0.857713906680646
Avg compression ratio: 1.0
Avg train time: 3.4980550527572634
Std train time: 0.8610827435918345
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 31, 17, 1, 10, 9, 13, 6, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8436, 'compress@10': 1.0, 'time@10': 3.2203}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8436, 'compress@10': 1.0, 'time@10': 3.2203}:  10%|█         | 1/10 [00:01<00:14,  1.65s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0452, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 3.2399}:  10%|█         | 1/10 [00:04<00:14,  1.65s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0452, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 3.2399}:  20%|██        | 2/10 [00:04<00:20,  2.62s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 3.0029}:  20%|██        | 2/10 [00:06<00:20,  2.62s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 3.0029}:  30%|███       | 3/10 [00:06<00:14,  2.02s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 3.0906}:  30%|███       | 3/10 [00:09<00:14,  2.02s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 3.0906}:  40%|████      | 4/10 [00:09<00:15,  2.56s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0644, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8074, 'compress@10': 1.0, 'time@10': 2.6199}:  40%|████      | 4/10 [00:10<00:15,  2.56s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0644, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8074, 'compress@10': 1.0, 'time@10': 2.6199}:  50%|█████     | 5/10 [00:10<00:08,  1.78s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0636, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.812, 'compress@10': 1.0, 'time@10': 2.7376}:  50%|█████     | 5/10 [00:13<00:08,  1.78s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0636, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.812, 'compress@10': 1.0, 'time@10': 2.7376}:  60%|██████    | 6/10 [00:13<00:09,  2.32s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0607, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8225, 'compress@10': 1.0, 'time@10': 2.7936}:  60%|██████    | 6/10 [00:15<00:09,  2.32s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0607, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8225, 'compress@10': 1.0, 'time@10': 2.7936}:  70%|███████   | 7/10 [00:15<00:06,  2.09s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0588, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8339, 'compress@10': 1.0, 'time@10': 2.8384}:  70%|███████   | 7/10 [00:18<00:06,  2.09s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0588, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8339, 'compress@10': 1.0, 'time@10': 2.8384}:  80%|████████  | 8/10 [00:18<00:04,  2.44s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.057, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8433, 'compress@10': 1.0, 'time@10': 2.8626}:  80%|████████  | 8/10 [00:19<00:04,  2.44s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.057, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8433, 'compress@10': 1.0, 'time@10': 2.8626}:  90%|█████████ | 9/10 [00:19<00:02,  2.17s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.055, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 2.9186}:  90%|█████████ | 9/10 [00:23<00:02,  2.17s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.055, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 2.9186}: 100%|██████████| 10/10 [00:23<00:00,  2.58s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.055, 'hit_ratio@10': 0.8613, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 2.9186}: 100%|██████████| 10/10 [00:23<00:00,  2.33s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.05496489287801857
Avg hit ratio: 0.8612741982732282
Avg ndcg: 0.8471269758221617
Avg compression ratio: 1.0
Avg train time: 2.9186191320419312
Std train time: 0.7645713208631744
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 33, 17, 8, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8425, 'compress@10': 1.0, 'time@10': 3.3237}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8425, 'compress@10': 1.0, 'time@10': 3.3237}:  10%|█         | 1/10 [00:01<00:15,  1.70s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8726, 'compress@10': 1.0, 'time@10': 3.38}:  10%|█         | 1/10 [00:05<00:15,  1.70s/it]  {'epoch': 6, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8726, 'compress@10': 1.0, 'time@10': 3.38}:  20%|██        | 2/10 [00:05<00:21,  2.74s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8674, 'compress@10': 1.0, 'time@10': 3.1768}:  20%|██        | 2/10 [00:06<00:21,  2.74s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8674, 'compress@10': 1.0, 'time@10': 3.1768}:  30%|███       | 3/10 [00:06<00:14,  2.14s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8736, 'compress@10': 1.0, 'time@10': 3.2447}:  30%|███       | 3/10 [00:10<00:14,  2.14s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0352, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8736, 'compress@10': 1.0, 'time@10': 3.2447}:  40%|████      | 4/10 [00:10<00:16,  2.67s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0449, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8561, 'compress@10': 1.0, 'time@10': 3.7861}:  40%|████      | 4/10 [00:13<00:16,  2.67s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0449, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8561, 'compress@10': 1.0, 'time@10': 3.7861}:  50%|█████     | 5/10 [00:13<00:13,  2.80s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0463, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 3.6949}:  50%|█████     | 5/10 [00:16<00:13,  2.80s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0463, 'hit_ratio@10': 0.8497, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 3.6949}:  60%|██████    | 6/10 [00:16<00:11,  2.96s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.046, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 3.6231}:  60%|██████    | 6/10 [00:18<00:11,  2.96s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.046, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 3.6231}:  70%|███████   | 7/10 [00:18<00:07,  2.53s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0469, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8642, 'compress@10': 1.0, 'time@10': 3.5686}:  70%|███████   | 7/10 [00:21<00:07,  2.53s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0469, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8642, 'compress@10': 1.0, 'time@10': 3.5686}:  80%|████████  | 8/10 [00:21<00:05,  2.75s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 3.5574}:  80%|████████  | 8/10 [00:23<00:05,  2.75s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 3.5574}:  90%|█████████ | 9/10 [00:23<00:02,  2.44s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0465, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 3.5397}:  90%|█████████ | 9/10 [00:26<00:02,  2.44s/it]  {'epoch': 6, 'num_users': 6.3, 'loss': 0.0465, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 3.5397}: 100%|██████████| 10/10 [00:26<00:00,  2.74s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0465, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8735, 'compress@10': 1.0, 'time@10': 3.5397}: 100%|██████████| 10/10 [00:26<00:00,  2.64s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04646971056749426
Avg hit ratio: 0.8726768754731402
Avg ndcg: 0.8734610443379139
Avg compression ratio: 1.0
Avg train time: 3.53966281414032
Std train time: 0.8271216674373048
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 34, 17, 1, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8417, 'compress@10': 1.0, 'time@10': 3.3473}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8417, 'compress@10': 1.0, 'time@10': 3.3473}:  10%|█         | 1/10 [00:01<00:15,  1.71s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.064, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8408, 'compress@10': 1.0, 'time@10': 3.3379}:  10%|█         | 1/10 [00:05<00:15,  1.71s/it] {'epoch': 7, 'num_users': 7.0, 'loss': 0.064, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8408, 'compress@10': 1.0, 'time@10': 3.3379}:  20%|██        | 2/10 [00:05<00:21,  2.69s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0427, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8462, 'compress@10': 1.0, 'time@10': 3.1385}:  20%|██        | 2/10 [00:06<00:21,  2.69s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0427, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8462, 'compress@10': 1.0, 'time@10': 3.1385}:  30%|███       | 3/10 [00:06<00:14,  2.10s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0401, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 3.1842}:  30%|███       | 3/10 [00:09<00:14,  2.10s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0401, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 3.1842}:  40%|████      | 4/10 [00:09<00:15,  2.60s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0695, 'hit_ratio@10': 0.8107, 'ndcg@10': 0.8056, 'compress@10': 1.0, 'time@10': 2.6907}:  40%|████      | 4/10 [00:10<00:15,  2.60s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0695, 'hit_ratio@10': 0.8107, 'ndcg@10': 0.8056, 'compress@10': 1.0, 'time@10': 2.6907}:  50%|█████     | 5/10 [00:10<00:09,  1.80s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0657, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8116, 'compress@10': 1.0, 'time@10': 2.802}:  50%|█████     | 5/10 [00:13<00:09,  1.80s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0657, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8116, 'compress@10': 1.0, 'time@10': 2.802}:  60%|██████    | 6/10 [00:13<00:09,  2.35s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0622, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8222, 'compress@10': 1.0, 'time@10': 2.8593}:  60%|██████    | 6/10 [00:15<00:09,  2.35s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0622, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8222, 'compress@10': 1.0, 'time@10': 2.8593}:  70%|███████   | 7/10 [00:15<00:06,  2.12s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0596, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8356, 'compress@10': 1.0, 'time@10': 2.901}:  70%|███████   | 7/10 [00:18<00:06,  2.12s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.0596, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8356, 'compress@10': 1.0, 'time@10': 2.901}:  80%|████████  | 8/10 [00:18<00:04,  2.47s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0581, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8459, 'compress@10': 1.0, 'time@10': 2.9854}:  80%|████████  | 8/10 [00:20<00:04,  2.47s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0581, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8459, 'compress@10': 1.0, 'time@10': 2.9854}:  90%|█████████ | 9/10 [00:20<00:02,  2.28s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0557, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 3.0351}:  90%|█████████ | 9/10 [00:23<00:02,  2.28s/it]     {'epoch': 7, 'num_users': 6.3, 'loss': 0.0557, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 3.0351}: 100%|██████████| 10/10 [00:23<00:00,  2.67s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0557, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 3.0351}: 100%|██████████| 10/10 [00:23<00:00,  2.39s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.055700738777585
Avg hit ratio: 0.8599590055294639
Avg ndcg: 0.8493311708836415
Avg compression ratio: 1.0
Avg train time: 3.0351160049438475
Std train time: 0.8048257918701376
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 36, 17, 8, 10, 9, 13, 6, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0522, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.3034}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0522, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.3034}:  10%|█         | 1/10 [00:01<00:15,  1.69s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9036, 'compress@10': 1.0, 'time@10': 3.3758}:  10%|█         | 1/10 [00:05<00:15,  1.69s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9036, 'compress@10': 1.0, 'time@10': 3.3758}:  20%|██        | 2/10 [00:05<00:21,  2.75s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.6963, 'ndcg@10': 0.8881, 'compress@10': 1.0, 'time@10': 3.246}:  20%|██        | 2/10 [00:06<00:21,  2.75s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.6963, 'ndcg@10': 0.8881, 'compress@10': 1.0, 'time@10': 3.246}:  30%|███       | 3/10 [00:06<00:15,  2.19s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7633, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 3.2628}:  30%|███       | 3/10 [00:10<00:15,  2.19s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7633, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 3.2628}:  40%|████      | 4/10 [00:10<00:15,  2.65s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.042, 'hit_ratio@10': 0.7867, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 3.8002}:  40%|████      | 4/10 [00:13<00:15,  2.65s/it]  {'epoch': 8, 'num_users': 5.8, 'loss': 0.042, 'hit_ratio@10': 0.7867, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 3.8002}:  50%|█████     | 5/10 [00:13<00:13,  2.78s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0418, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 3.7103}:  50%|█████     | 5/10 [00:16<00:13,  2.78s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0418, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8702, 'compress@10': 1.0, 'time@10': 3.7103}:  60%|██████    | 6/10 [00:16<00:11,  2.96s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0412, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.874, 'compress@10': 1.0, 'time@10': 3.6211}:  60%|██████    | 6/10 [00:17<00:11,  2.96s/it] {'epoch': 8, 'num_users': 6.2857, 'loss': 0.0412, 'hit_ratio@10': 0.8324, 'ndcg@10': 0.874, 'compress@10': 1.0, 'time@10': 3.6211}:  70%|███████   | 7/10 [00:17<00:07,  2.51s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0421, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8782, 'compress@10': 1.0, 'time@10': 3.5679}:  70%|███████   | 7/10 [00:21<00:07,  2.51s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0421, 'hit_ratio@10': 0.8462, 'ndcg@10': 0.8782, 'compress@10': 1.0, 'time@10': 3.5679}:  80%|████████  | 8/10 [00:21<00:05,  2.74s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0418, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.5134}:  80%|████████  | 8/10 [00:22<00:05,  2.74s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0418, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 3.5134}:  90%|█████████ | 9/10 [00:22<00:02,  2.38s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0408, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 3.5066}:  90%|█████████ | 9/10 [00:26<00:02,  2.38s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0408, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 3.5066}: 100%|██████████| 10/10 [00:26<00:00,  2.72s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0408, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 3.5066}: 100%|██████████| 10/10 [00:26<00:00,  2.63s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04075752228234471
Avg hit ratio: 0.846104748675207
Avg ndcg: 0.8823023591057633
Avg compression ratio: 1.0
Avg train time: 3.5066131591796874
Std train time: 0.8272723932257481
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 37, 17, 1, 10, 10, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8802, 'compress@10': 1.0, 'time@10': 3.2157}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8802, 'compress@10': 1.0, 'time@10': 3.2157}:  10%|█         | 1/10 [00:01<00:14,  1.65s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.798, 'ndcg@10': 0.9432, 'compress@10': 1.0, 'time@10': 3.363}:  10%|█         | 1/10 [00:05<00:14,  1.65s/it]  {'epoch': 9, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.798, 'ndcg@10': 0.9432, 'compress@10': 1.0, 'time@10': 3.363}:  20%|██        | 2/10 [00:05<00:22,  2.77s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.9145, 'compress@10': 1.0, 'time@10': 3.312}:  20%|██        | 2/10 [00:06<00:22,  2.77s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0264, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.9145, 'compress@10': 1.0, 'time@10': 3.312}:  30%|███       | 3/10 [00:06<00:15,  2.26s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.9186, 'compress@10': 1.0, 'time@10': 3.3296}:  30%|███       | 3/10 [00:10<00:15,  2.26s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.9186, 'compress@10': 1.0, 'time@10': 3.3296}:  40%|████      | 4/10 [00:10<00:16,  2.72s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0579, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 2.8437}:  40%|████      | 4/10 [00:10<00:16,  2.72s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0579, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8529, 'compress@10': 1.0, 'time@10': 2.8437}:  50%|█████     | 5/10 [00:10<00:09,  1.92s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0545, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 2.9533}:  50%|█████     | 5/10 [00:14<00:09,  1.92s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0545, 'hit_ratio@10': 0.8238, 'ndcg@10': 0.8562, 'compress@10': 1.0, 'time@10': 2.9533}:  60%|██████    | 6/10 [00:14<00:09,  2.48s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0524, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8587, 'compress@10': 1.0, 'time@10': 3.0479}:  60%|██████    | 6/10 [00:16<00:09,  2.48s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0524, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8587, 'compress@10': 1.0, 'time@10': 3.0479}:  70%|███████   | 7/10 [00:16<00:06,  2.28s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0497, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 3.0659}:  70%|███████   | 7/10 [00:19<00:06,  2.28s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0497, 'hit_ratio@10': 0.8592, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 3.0659}:  80%|████████  | 8/10 [00:19<00:05,  2.58s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8738, 'compress@10': 1.0, 'time@10': 3.1166}:  80%|████████  | 8/10 [00:21<00:05,  2.58s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8738, 'compress@10': 1.0, 'time@10': 3.1166}:  90%|█████████ | 9/10 [00:21<00:02,  2.34s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0476, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8747, 'compress@10': 1.0, 'time@10': 3.148}:  90%|█████████ | 9/10 [00:24<00:02,  2.34s/it]    {'epoch': 9, 'num_users': 6.3, 'loss': 0.0476, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8747, 'compress@10': 1.0, 'time@10': 3.148}: 100%|██████████| 10/10 [00:24<00:00,  2.69s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0476, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8747, 'compress@10': 1.0, 'time@10': 3.148}: 100%|██████████| 10/10 [00:24<00:00,  2.47s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.047620118127631325
Avg hit ratio: 0.8571355105400704
Avg ndcg: 0.8747103363555645
Avg compression ratio: 1.0
Avg train time: 3.14804744720459
Std train time: 0.7623664509421565
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 14, 37, 17, 8, 9, 9, 13, 6, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8807, 'compress@10': 1.0, 'time@10': 3.1933}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8807, 'compress@10': 1.0, 'time@10': 3.1933}:  10%|█         | 1/10 [00:01<00:14,  1.64s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9045, 'compress@10': 1.0, 'time@10': 3.1466}:  10%|█         | 1/10 [00:04<00:14,  1.64s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9045, 'compress@10': 1.0, 'time@10': 3.1466}:  20%|██        | 2/10 [00:04<00:20,  2.52s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 3.135}:  20%|██        | 2/10 [00:06<00:20,  2.52s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 3.135}:  30%|███       | 3/10 [00:06<00:14,  2.10s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 3.1787}:  30%|███       | 3/10 [00:09<00:14,  2.10s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 3.1787}:  40%|████      | 4/10 [00:09<00:15,  2.59s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8805, 'compress@10': 1.0, 'time@10': 3.7168}:  40%|████      | 4/10 [00:12<00:15,  2.59s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8805, 'compress@10': 1.0, 'time@10': 3.7168}:  50%|█████     | 5/10 [00:12<00:13,  2.73s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0339, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8762, 'compress@10': 1.0, 'time@10': 3.6103}:  50%|█████     | 5/10 [00:15<00:13,  2.73s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0339, 'hit_ratio@10': 0.8513, 'ndcg@10': 0.8762, 'compress@10': 1.0, 'time@10': 3.6103}:  60%|██████    | 6/10 [00:15<00:11,  2.86s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0342, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8802, 'compress@10': 1.0, 'time@10': 3.5453}:  60%|██████    | 6/10 [00:17<00:11,  2.86s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0342, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8802, 'compress@10': 1.0, 'time@10': 3.5453}:  70%|███████   | 7/10 [00:17<00:07,  2.45s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0347, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 3.5006}:  70%|███████   | 7/10 [00:20<00:07,  2.45s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0347, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.8788, 'compress@10': 1.0, 'time@10': 3.5006}:  80%|████████  | 8/10 [00:20<00:05,  2.70s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0353, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8826, 'compress@10': 1.0, 'time@10': 3.4536}:  80%|████████  | 8/10 [00:22<00:05,  2.70s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0353, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8826, 'compress@10': 1.0, 'time@10': 3.4536}:  90%|█████████ | 9/10 [00:22<00:02,  2.35s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0345, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8842, 'compress@10': 1.0, 'time@10': 3.4444}:  90%|█████████ | 9/10 [00:25<00:02,  2.35s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0345, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8842, 'compress@10': 1.0, 'time@10': 3.4444}: 100%|██████████| 10/10 [00:25<00:00,  2.67s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0345, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8842, 'compress@10': 1.0, 'time@10': 3.4444}: 100%|██████████| 10/10 [00:25<00:00,  2.56s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.034490529471193895
Avg hit ratio: 0.8668161483866067
Avg ndcg: 0.8841665441679843
Avg compression ratio: 1.0
Avg train time: 3.444373035430908
Std train time: 0.8134307082603786
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 38, 17, 1, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0424, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.59}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0424, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.59}:  10%|█         | 1/10 [00:01<00:16,  1.83s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0406, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 3.4706}:  10%|█         | 1/10 [00:05<00:16,  1.83s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0406, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 3.4706}:  20%|██        | 2/10 [00:05<00:21,  2.75s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.3814}:  20%|██        | 2/10 [00:06<00:21,  2.75s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.3814}:  30%|███       | 3/10 [00:06<00:15,  2.24s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9094, 'compress@10': 1.0, 'time@10': 3.3568}:  30%|███       | 3/10 [00:10<00:15,  2.24s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.9094, 'compress@10': 1.0, 'time@10': 3.3568}:  40%|████      | 4/10 [00:10<00:16,  2.67s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0567, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8483, 'compress@10': 1.0, 'time@10': 2.85}:  40%|████      | 4/10 [00:10<00:16,  2.67s/it]   {'epoch': 11, 'num_users': 5.8, 'loss': 0.0567, 'hit_ratio@10': 0.827, 'ndcg@10': 0.8483, 'compress@10': 1.0, 'time@10': 2.85}:  50%|█████     | 5/10 [00:10<00:09,  1.87s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0532, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8552, 'compress@10': 1.0, 'time@10': 2.9649}:  50%|█████     | 5/10 [00:14<00:09,  1.87s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0532, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8552, 'compress@10': 1.0, 'time@10': 2.9649}:  60%|██████    | 6/10 [00:14<00:09,  2.45s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0516, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 2.9951}:  60%|██████    | 6/10 [00:15<00:09,  2.45s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0516, 'hit_ratio@10': 0.8586, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 2.9951}:  70%|███████   | 7/10 [00:15<00:06,  2.18s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0477, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.0281}:  70%|███████   | 7/10 [00:19<00:06,  2.18s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0477, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 3.0281}:  80%|████████  | 8/10 [00:19<00:05,  2.54s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.047, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8797, 'compress@10': 1.0, 'time@10': 3.0872}:  80%|████████  | 8/10 [00:20<00:05,  2.54s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.047, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.8797, 'compress@10': 1.0, 'time@10': 3.0872}:  90%|█████████ | 9/10 [00:20<00:02,  2.32s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0449, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8814, 'compress@10': 1.0, 'time@10': 3.1161}:  90%|█████████ | 9/10 [00:24<00:02,  2.32s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.0449, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8814, 'compress@10': 1.0, 'time@10': 3.1161}: 100%|██████████| 10/10 [00:24<00:00,  2.65s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0449, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8814, 'compress@10': 1.0, 'time@10': 3.1161}: 100%|██████████| 10/10 [00:24<00:00,  2.44s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.04494756369378634
Avg hit ratio: 0.8593603660736816
Avg ndcg: 0.881419490470704
Avg compression ratio: 1.0
Avg train time: 3.1160635948181152
Std train time: 0.7772887986621572
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 15, 38, 17, 8, 9, 9, 13, 6, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0374, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 2.8561}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0374, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 2.8561}:  10%|█         | 1/10 [00:01<00:13,  1.47s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0538, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.0899}:  10%|█         | 1/10 [00:04<00:13,  1.47s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0538, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.0899}:  20%|██        | 2/10 [00:04<00:20,  2.58s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9071, 'compress@10': 1.0, 'time@10': 3.0906}:  20%|██        | 2/10 [00:06<00:20,  2.58s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9071, 'compress@10': 1.0, 'time@10': 3.0906}:  30%|███       | 3/10 [00:06<00:14,  2.13s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9187, 'compress@10': 1.0, 'time@10': 3.1531}:  30%|███       | 3/10 [00:09<00:14,  2.13s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9187, 'compress@10': 1.0, 'time@10': 3.1531}:  40%|████      | 4/10 [00:09<00:15,  2.62s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0387, 'hit_ratio@10': 0.895, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 3.7645}:  40%|████      | 4/10 [00:12<00:15,  2.62s/it] {'epoch': 12, 'num_users': 5.8, 'loss': 0.0387, 'hit_ratio@10': 0.895, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 3.7645}:  50%|█████     | 5/10 [00:12<00:14,  2.81s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0368, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.6256}:  50%|█████     | 5/10 [00:15<00:14,  2.81s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0368, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.8983, 'compress@10': 1.0, 'time@10': 3.6256}:  60%|██████    | 6/10 [00:15<00:11,  2.86s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0371, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.9015, 'compress@10': 1.0, 'time@10': 3.5582}:  60%|██████    | 6/10 [00:17<00:11,  2.86s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0371, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.9015, 'compress@10': 1.0, 'time@10': 3.5582}:  70%|███████   | 7/10 [00:17<00:07,  2.46s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0371, 'hit_ratio@10': 0.9152, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 3.5136}:  70%|███████   | 7/10 [00:20<00:07,  2.46s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0371, 'hit_ratio@10': 0.9152, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 3.5136}:  80%|████████  | 8/10 [00:20<00:05,  2.71s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0368, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.8908, 'compress@10': 1.0, 'time@10': 3.4531}:  80%|████████  | 8/10 [00:22<00:05,  2.71s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0368, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.8908, 'compress@10': 1.0, 'time@10': 3.4531}:  90%|█████████ | 9/10 [00:22<00:02,  2.34s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0354, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.8948, 'compress@10': 1.0, 'time@10': 3.4512}:  90%|█████████ | 9/10 [00:25<00:02,  2.34s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0354, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.8948, 'compress@10': 1.0, 'time@10': 3.4512}: 100%|██████████| 10/10 [00:25<00:00,  2.69s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0354, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.8948, 'compress@10': 1.0, 'time@10': 3.4512}: 100%|██████████| 10/10 [00:25<00:00,  2.58s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.035423981880231284
Avg hit ratio: 0.9041989088067186
Avg ndcg: 0.8948392098339625
Avg compression ratio: 1.0
Avg train time: 3.451190733909607
Std train time: 0.9369476485067705
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0389, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.1494}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0389, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.1494}:  10%|█         | 1/10 [00:01<00:14,  1.61s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0318, 'hit_ratio@10': 0.798, 'ndcg@10': 0.9265, 'compress@10': 1.0, 'time@10': 3.2232}:  10%|█         | 1/10 [00:04<00:14,  1.61s/it] {'epoch': 13, 'num_users': 7.0, 'loss': 0.0318, 'hit_ratio@10': 0.798, 'ndcg@10': 0.9265, 'compress@10': 1.0, 'time@10': 3.2232}:  20%|██        | 2/10 [00:04<00:20,  2.62s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.9034, 'compress@10': 1.0, 'time@10': 3.2305}:  20%|██        | 2/10 [00:06<00:20,  2.62s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.9034, 'compress@10': 1.0, 'time@10': 3.2305}:  30%|███       | 3/10 [00:06<00:15,  2.19s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.9164, 'compress@10': 1.0, 'time@10': 3.2394}:  30%|███       | 3/10 [00:09<00:15,  2.19s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.9164, 'compress@10': 1.0, 'time@10': 3.2394}:  40%|████      | 4/10 [00:09<00:15,  2.63s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0515, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 2.7323}:  40%|████      | 4/10 [00:10<00:15,  2.63s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0515, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8559, 'compress@10': 1.0, 'time@10': 2.7323}:  50%|█████     | 5/10 [00:10<00:09,  1.82s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0505, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 2.8221}:  50%|█████     | 5/10 [00:13<00:09,  1.82s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0505, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 2.8221}:  60%|██████    | 6/10 [00:13<00:09,  2.33s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8658, 'compress@10': 1.0, 'time@10': 2.8755}:  60%|██████    | 6/10 [00:15<00:09,  2.33s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.8658, 'compress@10': 1.0, 'time@10': 2.8755}:  70%|███████   | 7/10 [00:15<00:06,  2.10s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0452, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.871, 'compress@10': 1.0, 'time@10': 2.9039}:  70%|███████   | 7/10 [00:18<00:06,  2.10s/it]  {'epoch': 13, 'num_users': 6.125, 'loss': 0.0452, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.871, 'compress@10': 1.0, 'time@10': 2.9039}:  80%|████████  | 8/10 [00:18<00:04,  2.43s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0443, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.9705}:  80%|████████  | 8/10 [00:20<00:04,  2.43s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0443, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.9705}:  90%|█████████ | 9/10 [00:20<00:02,  2.23s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0434, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.0095}:  90%|█████████ | 9/10 [00:23<00:02,  2.23s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0434, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.0095}: 100%|██████████| 10/10 [00:23<00:00,  2.59s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0434, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.0095}: 100%|██████████| 10/10 [00:23<00:00,  2.36s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.043430507325388876
Avg hit ratio: 0.8614037026654053
Avg ndcg: 0.8771281571838392
Avg compression ratio: 1.0
Avg train time: 3.00951771736145
Std train time: 0.775839144037975
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 8, 10, 9, 14, 6, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0297, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 3.1524}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0297, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 3.1524}:  10%|█         | 1/10 [00:01<00:14,  1.61s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9824, 'compress@10': 1.0, 'time@10': 3.2232}:  10%|█         | 1/10 [00:04<00:14,  1.61s/it] {'epoch': 14, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9824, 'compress@10': 1.0, 'time@10': 3.2232}:  20%|██        | 2/10 [00:04<00:21,  2.64s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.846, 'ndcg@10': 0.9407, 'compress@10': 1.0, 'time@10': 3.2604}:  20%|██        | 2/10 [00:06<00:21,  2.64s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0193, 'hit_ratio@10': 0.846, 'ndcg@10': 0.9407, 'compress@10': 1.0, 'time@10': 3.2604}:  30%|███       | 3/10 [00:06<00:15,  2.22s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9453, 'compress@10': 1.0, 'time@10': 3.2837}:  30%|███       | 3/10 [00:10<00:15,  2.22s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9453, 'compress@10': 1.0, 'time@10': 3.2837}:  40%|████      | 4/10 [00:10<00:16,  2.69s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0276, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9205, 'compress@10': 1.0, 'time@10': 3.8167}:  40%|████      | 4/10 [00:13<00:16,  2.69s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0276, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9205, 'compress@10': 1.0, 'time@10': 3.8167}:  50%|█████     | 5/10 [00:13<00:14,  2.81s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0294, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9213, 'compress@10': 1.0, 'time@10': 3.731}:  50%|█████     | 5/10 [00:16<00:14,  2.81s/it] {'epoch': 14, 'num_users': 6.1667, 'loss': 0.0294, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9213, 'compress@10': 1.0, 'time@10': 3.731}:  60%|██████    | 6/10 [00:16<00:11,  2.99s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0299, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9209, 'compress@10': 1.0, 'time@10': 3.6646}:  60%|██████    | 6/10 [00:18<00:11,  2.99s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0299, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9209, 'compress@10': 1.0, 'time@10': 3.6646}:  70%|███████   | 7/10 [00:18<00:07,  2.56s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0273, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9247, 'compress@10': 1.0, 'time@10': 3.642}:  70%|███████   | 7/10 [00:21<00:07,  2.56s/it]  {'epoch': 14, 'num_users': 6.125, 'loss': 0.0273, 'hit_ratio@10': 0.9164, 'ndcg@10': 0.9247, 'compress@10': 1.0, 'time@10': 3.642}:  80%|████████  | 8/10 [00:21<00:05,  2.87s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 3.5638}:  80%|████████  | 8/10 [00:23<00:05,  2.87s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 3.5638}:  90%|█████████ | 9/10 [00:23<00:02,  2.44s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0261, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 3.5541}:  90%|█████████ | 9/10 [00:26<00:02,  2.44s/it]    {'epoch': 14, 'num_users': 6.3, 'loss': 0.0261, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 3.5541}: 100%|██████████| 10/10 [00:26<00:00,  2.77s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0261, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 3.5541}: 100%|██████████| 10/10 [00:26<00:00,  2.67s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.026103943434578745
Avg hit ratio: 0.9080151159913468
Avg ndcg: 0.9271663349414707
Avg compression ratio: 1.0
Avg train time: 3.554138660430908
Std train time: 0.8116981193368894
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 9, 14, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 3.3622}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 3.3622}:  10%|█         | 1/10 [00:01<00:15,  1.72s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9186, 'compress@10': 1.0, 'time@10': 3.3024}:  10%|█         | 1/10 [00:04<00:15,  1.72s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9186, 'compress@10': 1.0, 'time@10': 3.3024}:  20%|██        | 2/10 [00:04<00:21,  2.64s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 3.2782}:  20%|██        | 2/10 [00:06<00:21,  2.64s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 3.2782}:  30%|███       | 3/10 [00:06<00:15,  2.19s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.9163, 'compress@10': 1.0, 'time@10': 3.2875}:  30%|███       | 3/10 [00:10<00:15,  2.19s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.9163, 'compress@10': 1.0, 'time@10': 3.2875}:  40%|████      | 4/10 [00:10<00:15,  2.65s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8545, 'compress@10': 1.0, 'time@10': 2.7829}:  40%|████      | 4/10 [00:10<00:15,  2.65s/it] {'epoch': 15, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8545, 'compress@10': 1.0, 'time@10': 2.7829}:  50%|█████     | 5/10 [00:10<00:09,  1.85s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0452, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 2.8726}:  50%|█████     | 5/10 [00:13<00:09,  1.85s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0452, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8684, 'compress@10': 1.0, 'time@10': 2.8726}:  60%|██████    | 6/10 [00:13<00:09,  2.36s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.043, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 2.9156}:  60%|██████    | 6/10 [00:15<00:09,  2.36s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.043, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 2.9156}:  70%|███████   | 7/10 [00:15<00:06,  2.12s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0441, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.861, 'compress@10': 1.0, 'time@10': 2.9726}:  70%|███████   | 7/10 [00:18<00:06,  2.12s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0441, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.861, 'compress@10': 1.0, 'time@10': 2.9726}:  80%|████████  | 8/10 [00:18<00:05,  2.53s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0425, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8686, 'compress@10': 1.0, 'time@10': 3.0276}:  80%|████████  | 8/10 [00:20<00:05,  2.53s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0425, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8686, 'compress@10': 1.0, 'time@10': 3.0276}:  90%|█████████ | 9/10 [00:20<00:02,  2.29s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0409, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8767, 'compress@10': 1.0, 'time@10': 3.0671}:  90%|█████████ | 9/10 [00:24<00:02,  2.29s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0409, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8767, 'compress@10': 1.0, 'time@10': 3.0671}: 100%|██████████| 10/10 [00:24<00:00,  2.65s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0409, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8767, 'compress@10': 1.0, 'time@10': 3.0671}: 100%|██████████| 10/10 [00:24<00:00,  2.40s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.040871720161071115
Avg hit ratio: 0.876791942851123
Avg ndcg: 0.8767058835046718
Avg compression ratio: 1.0
Avg train time: 3.0670984029769897
Std train time: 0.7721404081582719
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 8, 10, 9, 14, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 3.2871}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 3.2871}:  10%|█         | 1/10 [00:01<00:15,  1.68s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.8829, 'ndcg@10': 1.0056, 'compress@10': 1.0, 'time@10': 3.275}:  10%|█         | 1/10 [00:04<00:15,  1.68s/it] {'epoch': 16, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.8829, 'ndcg@10': 1.0056, 'compress@10': 1.0, 'time@10': 3.275}:  20%|██        | 2/10 [00:04<00:21,  2.64s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9561, 'compress@10': 1.0, 'time@10': 3.2666}:  20%|██        | 2/10 [00:06<00:21,  2.64s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9561, 'compress@10': 1.0, 'time@10': 3.2666}:  30%|███       | 3/10 [00:06<00:15,  2.19s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9581, 'compress@10': 1.0, 'time@10': 3.2791}:  30%|███       | 3/10 [00:10<00:15,  2.19s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9581, 'compress@10': 1.0, 'time@10': 3.2791}:  40%|████      | 4/10 [00:10<00:15,  2.65s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0338, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9331, 'compress@10': 1.0, 'time@10': 3.7633}:  40%|████      | 4/10 [00:12<00:15,  2.65s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0338, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9331, 'compress@10': 1.0, 'time@10': 3.7633}:  50%|█████     | 5/10 [00:12<00:13,  2.74s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0326, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9328, 'compress@10': 1.0, 'time@10': 3.6695}:  50%|█████     | 5/10 [00:16<00:13,  2.74s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0326, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9328, 'compress@10': 1.0, 'time@10': 3.6695}:  60%|██████    | 6/10 [00:16<00:11,  2.91s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0317, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.5892}:  60%|██████    | 6/10 [00:17<00:11,  2.91s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0317, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.5892}:  70%|███████   | 7/10 [00:17<00:07,  2.48s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0299, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9367, 'compress@10': 1.0, 'time@10': 3.5605}:  70%|███████   | 7/10 [00:21<00:07,  2.48s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0299, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9367, 'compress@10': 1.0, 'time@10': 3.5605}:  80%|████████  | 8/10 [00:21<00:05,  2.77s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0296, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9365, 'compress@10': 1.0, 'time@10': 3.5624}:  80%|████████  | 8/10 [00:22<00:05,  2.77s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0296, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9365, 'compress@10': 1.0, 'time@10': 3.5624}:  90%|█████████ | 9/10 [00:22<00:02,  2.48s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9401, 'compress@10': 1.0, 'time@10': 3.554}:  90%|█████████ | 9/10 [00:26<00:02,  2.48s/it]    {'epoch': 16, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9401, 'compress@10': 1.0, 'time@10': 3.554}: 100%|██████████| 10/10 [00:26<00:00,  2.80s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0275, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9401, 'compress@10': 1.0, 'time@10': 3.554}: 100%|██████████| 10/10 [00:26<00:00,  2.65s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.02748490652333465
Avg hit ratio: 0.8965040803376967
Avg ndcg: 0.940115038632886
Avg compression ratio: 1.0
Avg train time: 3.553968405723572
Std train time: 0.72650628439951
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 10, 14, 6, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 3.2439}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 3.2439}:  10%|█         | 1/10 [00:01<00:14,  1.66s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9142, 'compress@10': 1.0, 'time@10': 3.2756}:  10%|█         | 1/10 [00:05<00:14,  1.66s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9142, 'compress@10': 1.0, 'time@10': 3.2756}:  20%|██        | 2/10 [00:05<00:21,  2.66s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.8952, 'compress@10': 1.0, 'time@10': 3.276}:  20%|██        | 2/10 [00:06<00:21,  2.66s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.8952, 'compress@10': 1.0, 'time@10': 3.276}:  30%|███       | 3/10 [00:06<00:15,  2.22s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9142, 'compress@10': 1.0, 'time@10': 3.3009}:  30%|███       | 3/10 [00:10<00:15,  2.22s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9142, 'compress@10': 1.0, 'time@10': 3.3009}:  40%|████      | 4/10 [00:10<00:16,  2.69s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 2.7881}:  40%|████      | 4/10 [00:10<00:16,  2.69s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 2.7881}:  50%|█████     | 5/10 [00:10<00:09,  1.87s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0418, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 2.8776}:  50%|█████     | 5/10 [00:13<00:09,  1.87s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0418, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 2.8776}:  60%|██████    | 6/10 [00:13<00:09,  2.38s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0392, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.871, 'compress@10': 1.0, 'time@10': 2.9832}:  60%|██████    | 6/10 [00:16<00:09,  2.38s/it] {'epoch': 17, 'num_users': 6.2857, 'loss': 0.0392, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.871, 'compress@10': 1.0, 'time@10': 2.9832}:  70%|███████   | 7/10 [00:16<00:06,  2.29s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0388, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8687, 'compress@10': 1.0, 'time@10': 3.0325}:  70%|███████   | 7/10 [00:19<00:06,  2.29s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0388, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.8687, 'compress@10': 1.0, 'time@10': 3.0325}:  80%|████████  | 8/10 [00:19<00:05,  2.65s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0367, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8757, 'compress@10': 1.0, 'time@10': 3.0219}:  80%|████████  | 8/10 [00:20<00:05,  2.65s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0367, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8757, 'compress@10': 1.0, 'time@10': 3.0219}:  90%|█████████ | 9/10 [00:20<00:02,  2.29s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8837, 'compress@10': 1.0, 'time@10': 3.0725}:  90%|█████████ | 9/10 [00:24<00:02,  2.29s/it]    {'epoch': 17, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8837, 'compress@10': 1.0, 'time@10': 3.0725}: 100%|██████████| 10/10 [00:24<00:00,  2.69s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8837, 'compress@10': 1.0, 'time@10': 3.0725}: 100%|██████████| 10/10 [00:24<00:00,  2.45s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.03501721377548093
Avg hit ratio: 0.876768554888128
Avg ndcg: 0.88371129859129
Avg compression ratio: 1.0
Avg train time: 3.0724653720855715
Std train time: 0.7968993967677931
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 8, 10, 9, 14, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 3.1941}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 3.1941}:  10%|█         | 1/10 [00:01<00:14,  1.63s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9358, 'compress@10': 1.0, 'time@10': 3.2863}:  10%|█         | 1/10 [00:05<00:14,  1.63s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0454, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9358, 'compress@10': 1.0, 'time@10': 3.2863}:  20%|██        | 2/10 [00:05<00:21,  2.68s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 3.2491}:  20%|██        | 2/10 [00:06<00:21,  2.68s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0303, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 3.2491}:  30%|███       | 3/10 [00:06<00:15,  2.21s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9218, 'compress@10': 1.0, 'time@10': 3.2718}:  30%|███       | 3/10 [00:10<00:15,  2.21s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9218, 'compress@10': 1.0, 'time@10': 3.2718}:  40%|████      | 4/10 [00:10<00:16,  2.68s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0334, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 3.9003}:  40%|████      | 4/10 [00:13<00:16,  2.68s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0334, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 3.9003}:  50%|█████     | 5/10 [00:13<00:14,  2.88s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0334, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9162, 'compress@10': 1.0, 'time@10': 3.8066}:  50%|█████     | 5/10 [00:16<00:14,  2.88s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0334, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.9162, 'compress@10': 1.0, 'time@10': 3.8066}:  60%|██████    | 6/10 [00:16<00:12,  3.05s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.031, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9185, 'compress@10': 1.0, 'time@10': 3.7293}:  60%|██████    | 6/10 [00:18<00:12,  3.05s/it]  {'epoch': 18, 'num_users': 6.2857, 'loss': 0.031, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9185, 'compress@10': 1.0, 'time@10': 3.7293}:  70%|███████   | 7/10 [00:18<00:07,  2.60s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0319, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9328, 'compress@10': 1.0, 'time@10': 3.688}:  70%|███████   | 7/10 [00:21<00:07,  2.60s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0319, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9328, 'compress@10': 1.0, 'time@10': 3.688}:  80%|████████  | 8/10 [00:21<00:05,  2.87s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.031, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9355, 'compress@10': 1.0, 'time@10': 3.6758}:  80%|████████  | 8/10 [00:23<00:05,  2.87s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.031, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9355, 'compress@10': 1.0, 'time@10': 3.6758}:  90%|█████████ | 9/10 [00:23<00:02,  2.55s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0285, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9391, 'compress@10': 1.0, 'time@10': 3.6197}:  90%|█████████ | 9/10 [00:26<00:02,  2.55s/it]  {'epoch': 18, 'num_users': 6.3, 'loss': 0.0285, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9391, 'compress@10': 1.0, 'time@10': 3.6197}: 100%|██████████| 10/10 [00:26<00:00,  2.74s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0285, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9391, 'compress@10': 1.0, 'time@10': 3.6197}: 100%|██████████| 10/10 [00:26<00:00,  2.69s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.02852422200044367
Avg hit ratio: 0.8802183660519823
Avg ndcg: 0.9391359917217548
Avg compression ratio: 1.0
Avg train time: 3.619679307937622
Std train time: 0.9400298633655795
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 9, 14, 6, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 3.1435}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 3.1435}:  10%|█         | 1/10 [00:01<00:14,  1.61s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.929, 'compress@10': 1.0, 'time@10': 3.2237}:  10%|█         | 1/10 [00:04<00:14,  1.61s/it] {'epoch': 19, 'num_users': 7.0, 'loss': 0.0198, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.929, 'compress@10': 1.0, 'time@10': 3.2237}:  20%|██        | 2/10 [00:04<00:21,  2.63s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 3.264}:  20%|██        | 2/10 [00:06<00:21,  2.63s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 3.264}:  30%|███       | 3/10 [00:06<00:15,  2.21s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9215, 'compress@10': 1.0, 'time@10': 3.2972}:  30%|███       | 3/10 [00:10<00:15,  2.21s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9215, 'compress@10': 1.0, 'time@10': 3.2972}:  40%|████      | 4/10 [00:10<00:16,  2.69s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0422, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.7786}:  40%|████      | 4/10 [00:10<00:16,  2.69s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0422, 'hit_ratio@10': 0.8293, 'ndcg@10': 0.8626, 'compress@10': 1.0, 'time@10': 2.7786}:  50%|█████     | 5/10 [00:10<00:09,  1.86s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0378, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.8579}:  50%|█████     | 5/10 [00:13<00:09,  1.86s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0378, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.8579}:  60%|██████    | 6/10 [00:13<00:09,  2.36s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0364, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8846, 'compress@10': 1.0, 'time@10': 2.9011}:  60%|██████    | 6/10 [00:15<00:09,  2.36s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0364, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8846, 'compress@10': 1.0, 'time@10': 2.9011}:  70%|███████   | 7/10 [00:15<00:06,  2.12s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0349, 'hit_ratio@10': 0.882, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 2.9714}:  70%|███████   | 7/10 [00:18<00:06,  2.12s/it]  {'epoch': 19, 'num_users': 6.125, 'loss': 0.0349, 'hit_ratio@10': 0.882, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 2.9714}:  80%|████████  | 8/10 [00:18<00:05,  2.56s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0329, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 2.9838}:  80%|████████  | 8/10 [00:20<00:05,  2.56s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0329, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 2.9838}:  90%|█████████ | 9/10 [00:20<00:02,  2.25s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0314, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.0302}:  90%|█████████ | 9/10 [00:24<00:02,  2.25s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0314, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.0302}: 100%|██████████| 10/10 [00:24<00:00,  2.64s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0314, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.0302}: 100%|██████████| 10/10 [00:24<00:00,  2.40s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.03136445682740295
Avg hit ratio: 0.874744196757779
Avg ndcg: 0.8967343908159506
Avg compression ratio: 1.0
Avg train time: 3.0301923036575316
Std train time: 0.7850927305017363
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 8, 10, 9, 14, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.92, 'compress@10': 1.0, 'time@10': 3.2304}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.92, 'compress@10': 1.0, 'time@10': 3.2304}:  10%|█         | 1/10 [00:01<00:14,  1.65s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9624, 'compress@10': 1.0, 'time@10': 3.3252}:  10%|█         | 1/10 [00:05<00:14,  1.65s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9624, 'compress@10': 1.0, 'time@10': 3.3252}:  20%|██        | 2/10 [00:05<00:21,  2.72s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9273, 'compress@10': 1.0, 'time@10': 3.3736}:  20%|██        | 2/10 [00:06<00:21,  2.72s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9273, 'compress@10': 1.0, 'time@10': 3.3736}:  30%|███       | 3/10 [00:06<00:16,  2.29s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9357, 'compress@10': 1.0, 'time@10': 3.3526}:  30%|███       | 3/10 [00:10<00:16,  2.29s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9357, 'compress@10': 1.0, 'time@10': 3.3526}:  40%|████      | 4/10 [00:10<00:16,  2.70s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0247, 'hit_ratio@10': 0.8234, 'ndcg@10': 0.9204, 'compress@10': 1.0, 'time@10': 3.8785}:  40%|████      | 4/10 [00:13<00:16,  2.70s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0247, 'hit_ratio@10': 0.8234, 'ndcg@10': 0.9204, 'compress@10': 1.0, 'time@10': 3.8785}:  50%|█████     | 5/10 [00:13<00:14,  2.82s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0243, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 3.7727}:  50%|█████     | 5/10 [00:16<00:14,  2.82s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0243, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 3.7727}:  60%|██████    | 6/10 [00:16<00:11,  2.97s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0241, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9273, 'compress@10': 1.0, 'time@10': 3.694}:  60%|██████    | 6/10 [00:18<00:11,  2.97s/it]  {'epoch': 20, 'num_users': 6.2857, 'loss': 0.0241, 'hit_ratio@10': 0.865, 'ndcg@10': 0.9273, 'compress@10': 1.0, 'time@10': 3.694}:  70%|███████   | 7/10 [00:18<00:07,  2.54s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9449, 'compress@10': 1.0, 'time@10': 3.6645}:  70%|███████   | 7/10 [00:21<00:07,  2.54s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9449, 'compress@10': 1.0, 'time@10': 3.6645}:  80%|████████  | 8/10 [00:21<00:05,  2.84s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0251, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9451, 'compress@10': 1.0, 'time@10': 3.6561}:  80%|████████  | 8/10 [00:23<00:05,  2.84s/it] {'epoch': 20, 'num_users': 6.3333, 'loss': 0.0251, 'hit_ratio@10': 0.86, 'ndcg@10': 0.9451, 'compress@10': 1.0, 'time@10': 3.6561}:  90%|█████████ | 9/10 [00:23<00:02,  2.53s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.6353}:  90%|█████████ | 9/10 [00:26<00:02,  2.53s/it] {'epoch': 20, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.6353}: 100%|██████████| 10/10 [00:26<00:00,  2.83s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0235, 'hit_ratio@10': 0.8718, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.6353}: 100%|██████████| 10/10 [00:26<00:00,  2.70s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.023545348281645558
Avg hit ratio: 0.8717667531487565
Avg ndcg: 0.9479151877552192
Avg compression ratio: 1.0
Avg train time: 3.6352982759475707
Std train time: 0.791106061189756
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 9, 14, 6, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.4376}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 3.4376}:  10%|█         | 1/10 [00:01<00:15,  1.76s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9754, 'compress@10': 1.0, 'time@10': 3.424}:  10%|█         | 1/10 [00:05<00:15,  1.76s/it]  {'epoch': 21, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9754, 'compress@10': 1.0, 'time@10': 3.424}:  20%|██        | 2/10 [00:05<00:22,  2.75s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.936, 'compress@10': 1.0, 'time@10': 3.3824}:  20%|██        | 2/10 [00:06<00:22,  2.75s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.936, 'compress@10': 1.0, 'time@10': 3.3824}:  30%|███       | 3/10 [00:06<00:15,  2.27s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9452, 'compress@10': 1.0, 'time@10': 3.3694}:  30%|███       | 3/10 [00:10<00:15,  2.27s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9452, 'compress@10': 1.0, 'time@10': 3.3694}:  40%|████      | 4/10 [00:10<00:16,  2.70s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0425, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 2.8542}:  40%|████      | 4/10 [00:10<00:16,  2.70s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0425, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 2.8542}:  50%|█████     | 5/10 [00:10<00:09,  1.88s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8952, 'compress@10': 1.0, 'time@10': 2.9234}:  50%|█████     | 5/10 [00:13<00:09,  1.88s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8952, 'compress@10': 1.0, 'time@10': 2.9234}:  60%|██████    | 6/10 [00:13<00:09,  2.37s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0377, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 2.9601}:  60%|██████    | 6/10 [00:15<00:09,  2.37s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0377, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 2.9601}:  70%|███████   | 7/10 [00:15<00:06,  2.13s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0366, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 3.0213}:  70%|███████   | 7/10 [00:19<00:06,  2.13s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.0366, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 3.0213}:  80%|████████  | 8/10 [00:19<00:05,  2.56s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0342, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 3.0278}:  80%|████████  | 8/10 [00:20<00:05,  2.56s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0342, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 3.0278}:  90%|█████████ | 9/10 [00:20<00:02,  2.26s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9132, 'compress@10': 1.0, 'time@10': 3.0693}:  90%|█████████ | 9/10 [00:24<00:02,  2.26s/it]  {'epoch': 21, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9132, 'compress@10': 1.0, 'time@10': 3.0693}: 100%|██████████| 10/10 [00:24<00:00,  2.63s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8915, 'ndcg@10': 0.9132, 'compress@10': 1.0, 'time@10': 3.0693}: 100%|██████████| 10/10 [00:24<00:00,  2.42s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.03241359238470403
Avg hit ratio: 0.8915414317808205
Avg ndcg: 0.9131522270401332
Avg compression ratio: 1.0
Avg train time: 3.0693142652511596
Std train time: 0.7673676941096704
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 8, 10, 9, 14, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.3738}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.3738}:  10%|█         | 1/10 [00:01<00:15,  1.73s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9672, 'compress@10': 1.0, 'time@10': 3.3588}:  10%|█         | 1/10 [00:05<00:15,  1.73s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9672, 'compress@10': 1.0, 'time@10': 3.3588}:  20%|██        | 2/10 [00:05<00:21,  2.70s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9305, 'compress@10': 1.0, 'time@10': 3.3053}:  20%|██        | 2/10 [00:06<00:21,  2.70s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9305, 'compress@10': 1.0, 'time@10': 3.3053}:  30%|███       | 3/10 [00:06<00:15,  2.22s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9392, 'compress@10': 1.0, 'time@10': 3.299}:  30%|███       | 3/10 [00:10<00:15,  2.22s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9392, 'compress@10': 1.0, 'time@10': 3.299}:  40%|████      | 4/10 [00:10<00:15,  2.66s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0211, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.7953}:  40%|████      | 4/10 [00:13<00:15,  2.66s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0211, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.7953}:  50%|█████     | 5/10 [00:13<00:13,  2.75s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0191, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9311, 'compress@10': 1.0, 'time@10': 3.7101}:  50%|█████     | 5/10 [00:16<00:13,  2.75s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0191, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9311, 'compress@10': 1.0, 'time@10': 3.7101}:  60%|██████    | 6/10 [00:16<00:11,  2.95s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9319, 'compress@10': 1.0, 'time@10': 3.6355}:  60%|██████    | 6/10 [00:17<00:11,  2.95s/it] {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9319, 'compress@10': 1.0, 'time@10': 3.6355}:  70%|███████   | 7/10 [00:17<00:07,  2.52s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.909, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 3.6144}:  70%|███████   | 7/10 [00:21<00:07,  2.52s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.909, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 3.6144}:  80%|████████  | 8/10 [00:21<00:05,  2.83s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9488, 'compress@10': 1.0, 'time@10': 3.6122}:  80%|████████  | 8/10 [00:23<00:05,  2.83s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9488, 'compress@10': 1.0, 'time@10': 3.6122}:  90%|█████████ | 9/10 [00:23<00:02,  2.52s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.953, 'compress@10': 1.0, 'time@10': 3.6027}:  90%|█████████ | 9/10 [00:26<00:02,  2.52s/it]    {'epoch': 22, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.953, 'compress@10': 1.0, 'time@10': 3.6027}: 100%|██████████| 10/10 [00:26<00:00,  2.84s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.953, 'compress@10': 1.0, 'time@10': 3.6027}: 100%|██████████| 10/10 [00:26<00:00,  2.69s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.019502108439971397
Avg hit ratio: 0.9048906381300268
Avg ndcg: 0.9530193110837253
Avg compression ratio: 1.0
Avg train time: 3.602651834487915
Std train time: 0.7368566890852171
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 9, 14, 6, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9045, 'compress@10': 1.0, 'time@10': 3.3337}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9045, 'compress@10': 1.0, 'time@10': 3.3337}:  10%|█         | 1/10 [00:01<00:15,  1.70s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9852, 'compress@10': 1.0, 'time@10': 3.3221}:  10%|█         | 1/10 [00:05<00:15,  1.70s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9852, 'compress@10': 1.0, 'time@10': 3.3221}:  20%|██        | 2/10 [00:05<00:21,  2.68s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9425, 'compress@10': 1.0, 'time@10': 3.3068}:  20%|██        | 2/10 [00:06<00:21,  2.68s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0138, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9425, 'compress@10': 1.0, 'time@10': 3.3068}:  30%|███       | 3/10 [00:06<00:15,  2.22s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9491, 'compress@10': 1.0, 'time@10': 3.319}:  30%|███       | 3/10 [00:10<00:15,  2.22s/it]  {'epoch': 23, 'num_users': 5.0, 'loss': 0.0155, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9491, 'compress@10': 1.0, 'time@10': 3.319}:  40%|████      | 4/10 [00:10<00:16,  2.69s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0395, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.8874, 'compress@10': 1.0, 'time@10': 2.7957}:  40%|████      | 4/10 [00:10<00:16,  2.69s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0395, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.8874, 'compress@10': 1.0, 'time@10': 2.7957}:  50%|█████     | 5/10 [00:10<00:09,  1.86s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0357, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9008, 'compress@10': 1.0, 'time@10': 2.8776}:  50%|█████     | 5/10 [00:13<00:09,  1.86s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0357, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9008, 'compress@10': 1.0, 'time@10': 2.8776}:  60%|██████    | 6/10 [00:13<00:09,  2.36s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0336, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9066, 'compress@10': 1.0, 'time@10': 2.9365}:  60%|██████    | 6/10 [00:15<00:09,  2.36s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0336, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9066, 'compress@10': 1.0, 'time@10': 2.9365}:  70%|███████   | 7/10 [00:15<00:06,  2.14s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0319, 'hit_ratio@10': 0.9187, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 2.9903}:  70%|███████   | 7/10 [00:18<00:06,  2.14s/it]  {'epoch': 23, 'num_users': 6.125, 'loss': 0.0319, 'hit_ratio@10': 0.9187, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 2.9903}:  80%|████████  | 8/10 [00:18<00:05,  2.54s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.03, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 2.9935}:  80%|████████  | 8/10 [00:20<00:05,  2.54s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.03, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 2.9935}:  90%|█████████ | 9/10 [00:20<00:02,  2.23s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 3.0067}:  90%|█████████ | 9/10 [00:23<00:02,  2.23s/it] {'epoch': 23, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 3.0067}: 100%|██████████| 10/10 [00:23<00:00,  2.52s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0292, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 3.0067}: 100%|██████████| 10/10 [00:23<00:00,  2.37s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.02924623063047077
Avg hit ratio: 0.9127264219059029
Avg ndcg: 0.914343338374833
Avg compression ratio: 1.0
Avg train time: 3.0067279815673826
Std train time: 0.7749521509767103
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 8, 10, 9, 14, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.2042}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.2042}:  10%|█         | 1/10 [00:01<00:14,  1.64s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8825, 'compress@10': 1.0, 'time@10': 3.2427}:  10%|█         | 1/10 [00:04<00:14,  1.64s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8825, 'compress@10': 1.0, 'time@10': 3.2427}:  20%|██        | 2/10 [00:04<00:21,  2.63s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.874, 'compress@10': 1.0, 'time@10': 3.2539}:  20%|██        | 2/10 [00:06<00:21,  2.63s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.874, 'compress@10': 1.0, 'time@10': 3.2539}:  30%|███       | 3/10 [00:06<00:15,  2.19s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 3.283}:  30%|███       | 3/10 [00:10<00:15,  2.19s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 3.283}:  40%|████      | 4/10 [00:10<00:16,  2.67s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8916, 'compress@10': 1.0, 'time@10': 3.8289}:  40%|████      | 4/10 [00:13<00:16,  2.67s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8484, 'ndcg@10': 0.8916, 'compress@10': 1.0, 'time@10': 3.8289}:  50%|█████     | 5/10 [00:13<00:14,  2.81s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0255, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 3.7322}:  50%|█████     | 5/10 [00:16<00:14,  2.81s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0255, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 3.7322}:  60%|██████    | 6/10 [00:16<00:11,  2.97s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0245, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9146, 'compress@10': 1.0, 'time@10': 3.6511}:  60%|██████    | 6/10 [00:17<00:11,  2.97s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0245, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9146, 'compress@10': 1.0, 'time@10': 3.6511}:  70%|███████   | 7/10 [00:17<00:07,  2.53s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0253, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.935, 'compress@10': 1.0, 'time@10': 3.6425}:  70%|███████   | 7/10 [00:21<00:07,  2.53s/it]  {'epoch': 24, 'num_users': 6.125, 'loss': 0.0253, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.935, 'compress@10': 1.0, 'time@10': 3.6425}:  80%|████████  | 8/10 [00:21<00:05,  2.88s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0257, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9364, 'compress@10': 1.0, 'time@10': 3.6385}:  80%|████████  | 8/10 [00:23<00:05,  2.88s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0257, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9364, 'compress@10': 1.0, 'time@10': 3.6385}:  90%|█████████ | 9/10 [00:23<00:02,  2.55s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.024, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9404, 'compress@10': 1.0, 'time@10': 3.5999}:  90%|█████████ | 9/10 [00:26<00:02,  2.55s/it]    {'epoch': 24, 'num_users': 6.3, 'loss': 0.024, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9404, 'compress@10': 1.0, 'time@10': 3.5999}: 100%|██████████| 10/10 [00:26<00:00,  2.78s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.024, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9404, 'compress@10': 1.0, 'time@10': 3.5999}: 100%|██████████| 10/10 [00:26<00:00,  2.67s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.02395762841111148
Avg hit ratio: 0.8928271460665348
Avg ndcg: 0.9404006586294731
Avg compression ratio: 1.0
Avg train time: 3.5999306201934815
Std train time: 0.8167279635864718
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 9, 13, 6, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 3.1491}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 3.1491}:  10%|█         | 1/10 [00:01<00:14,  1.61s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 3.2249}:  10%|█         | 1/10 [00:04<00:14,  1.61s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0264, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 3.2249}:  20%|██        | 2/10 [00:04<00:21,  2.63s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9133, 'compress@10': 1.0, 'time@10': 3.2528}:  20%|██        | 2/10 [00:06<00:21,  2.63s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9133, 'compress@10': 1.0, 'time@10': 3.2528}:  30%|███       | 3/10 [00:06<00:15,  2.20s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9239, 'compress@10': 1.0, 'time@10': 3.2524}:  30%|███       | 3/10 [00:09<00:15,  2.20s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9239, 'compress@10': 1.0, 'time@10': 3.2524}:  40%|████      | 4/10 [00:09<00:15,  2.63s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.04, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8681, 'compress@10': 1.0, 'time@10': 2.7468}:  40%|████      | 4/10 [00:10<00:15,  2.63s/it]  {'epoch': 25, 'num_users': 5.8, 'loss': 0.04, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8681, 'compress@10': 1.0, 'time@10': 2.7468}:  50%|█████     | 5/10 [00:10<00:09,  1.83s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.035, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.8842, 'compress@10': 1.0, 'time@10': 2.8312}:  50%|█████     | 5/10 [00:13<00:09,  1.83s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.035, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.8842, 'compress@10': 1.0, 'time@10': 2.8312}:  60%|██████    | 6/10 [00:13<00:09,  2.33s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0325, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.8928, 'compress@10': 1.0, 'time@10': 2.8844}:  60%|██████    | 6/10 [00:15<00:09,  2.33s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0325, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.8928, 'compress@10': 1.0, 'time@10': 2.8844}:  70%|███████   | 7/10 [00:15<00:06,  2.10s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.034, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9165, 'compress@10': 1.0, 'time@10': 2.9451}:  70%|███████   | 7/10 [00:18<00:06,  2.10s/it]  {'epoch': 25, 'num_users': 6.125, 'loss': 0.034, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9165, 'compress@10': 1.0, 'time@10': 2.9451}:  80%|████████  | 8/10 [00:18<00:05,  2.52s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0316, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9195, 'compress@10': 1.0, 'time@10': 2.963}:  80%|████████  | 8/10 [00:20<00:05,  2.52s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0316, 'hit_ratio@10': 0.8808, 'ndcg@10': 0.9195, 'compress@10': 1.0, 'time@10': 2.963}:  90%|█████████ | 9/10 [00:20<00:02,  2.23s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9219, 'compress@10': 1.0, 'time@10': 2.9772}:  90%|█████████ | 9/10 [00:23<00:02,  2.23s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9219, 'compress@10': 1.0, 'time@10': 2.9772}: 100%|██████████| 10/10 [00:23<00:00,  2.51s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9219, 'compress@10': 1.0, 'time@10': 2.9772}: 100%|██████████| 10/10 [00:23<00:00,  2.34s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.03183840052729568
Avg hit ratio: 0.8904811582090263
Avg ndcg: 0.9218822406096179
Avg compression ratio: 1.0
Avg train time: 2.977179932594299
Std train time: 0.7555866842670015
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 8, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9271, 'compress@10': 1.0, 'time@10': 3.2519}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9271, 'compress@10': 1.0, 'time@10': 3.2519}:  10%|█         | 1/10 [00:01<00:14,  1.66s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 3.3039}:  10%|█         | 1/10 [00:05<00:14,  1.66s/it] {'epoch': 26, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 3.3039}:  20%|██        | 2/10 [00:05<00:21,  2.68s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9189, 'compress@10': 1.0, 'time@10': 3.2668}:  20%|██        | 2/10 [00:06<00:21,  2.68s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9189, 'compress@10': 1.0, 'time@10': 3.2668}:  30%|███       | 3/10 [00:06<00:15,  2.21s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9289, 'compress@10': 1.0, 'time@10': 3.2571}:  30%|███       | 3/10 [00:09<00:15,  2.21s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9289, 'compress@10': 1.0, 'time@10': 3.2571}:  40%|████      | 4/10 [00:09<00:15,  2.63s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.7672}:  40%|████      | 4/10 [00:12<00:15,  2.63s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0183, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.7672}:  50%|█████     | 5/10 [00:12<00:13,  2.74s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 3.6755}:  50%|█████     | 5/10 [00:16<00:13,  2.74s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 3.6755}:  60%|██████    | 6/10 [00:16<00:11,  2.91s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0173, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9317, 'compress@10': 1.0, 'time@10': 3.6083}:  60%|██████    | 6/10 [00:17<00:11,  2.91s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0173, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9317, 'compress@10': 1.0, 'time@10': 3.6083}:  70%|███████   | 7/10 [00:17<00:07,  2.50s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9362, 'compress@10': 1.0, 'time@10': 3.549}:  70%|███████   | 7/10 [00:20<00:07,  2.50s/it]  {'epoch': 26, 'num_users': 6.125, 'loss': 0.0188, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.9362, 'compress@10': 1.0, 'time@10': 3.549}:  80%|████████  | 8/10 [00:20<00:05,  2.71s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9387, 'compress@10': 1.0, 'time@10': 3.543}:  80%|████████  | 8/10 [00:22<00:05,  2.71s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9387, 'compress@10': 1.0, 'time@10': 3.543}:  90%|█████████ | 9/10 [00:22<00:02,  2.42s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9424, 'compress@10': 1.0, 'time@10': 3.5292}:  90%|█████████ | 9/10 [00:26<00:02,  2.42s/it]  {'epoch': 26, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9424, 'compress@10': 1.0, 'time@10': 3.5292}: 100%|██████████| 10/10 [00:26<00:00,  2.74s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.9424, 'compress@10': 1.0, 'time@10': 3.5292}: 100%|██████████| 10/10 [00:26<00:00,  2.62s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.018843583708088207
Avg hit ratio: 0.907112860352249
Avg ndcg: 0.9423817095426248
Avg compression ratio: 1.0
Avg train time: 3.529244804382324
Std train time: 0.7666079354375598
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 9, 13, 6, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9208, 'compress@10': 1.0, 'time@10': 3.3086}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9208, 'compress@10': 1.0, 'time@10': 3.3086}:  10%|█         | 1/10 [00:01<00:15,  1.69s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9582, 'compress@10': 1.0, 'time@10': 3.3054}:  10%|█         | 1/10 [00:05<00:15,  1.69s/it] {'epoch': 27, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9582, 'compress@10': 1.0, 'time@10': 3.3054}:  20%|██        | 2/10 [00:05<00:21,  2.66s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9245, 'compress@10': 1.0, 'time@10': 3.2796}:  20%|██        | 2/10 [00:06<00:21,  2.66s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9245, 'compress@10': 1.0, 'time@10': 3.2796}:  30%|███       | 3/10 [00:06<00:15,  2.20s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.933, 'compress@10': 1.0, 'time@10': 3.2657}:  30%|███       | 3/10 [00:09<00:15,  2.20s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.933, 'compress@10': 1.0, 'time@10': 3.2657}:  40%|████      | 4/10 [00:09<00:15,  2.62s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0358, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 2.7727}:  40%|████      | 4/10 [00:10<00:15,  2.62s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0358, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 2.7727}:  50%|█████     | 5/10 [00:10<00:09,  1.83s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0331, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 2.863}:  50%|█████     | 5/10 [00:13<00:09,  1.83s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0331, 'hit_ratio@10': 0.8561, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 2.863}:  60%|██████    | 6/10 [00:13<00:09,  2.35s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0309, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9008, 'compress@10': 1.0, 'time@10': 2.9036}:  60%|██████    | 6/10 [00:15<00:09,  2.35s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0309, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9008, 'compress@10': 1.0, 'time@10': 2.9036}:  70%|███████   | 7/10 [00:15<00:06,  2.11s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0304, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9146, 'compress@10': 1.0, 'time@10': 2.9356}:  70%|███████   | 7/10 [00:18<00:06,  2.11s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0304, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9146, 'compress@10': 1.0, 'time@10': 2.9356}:  80%|████████  | 8/10 [00:18<00:04,  2.46s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9175, 'compress@10': 1.0, 'time@10': 2.9406}:  80%|████████  | 8/10 [00:20<00:04,  2.46s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9175, 'compress@10': 1.0, 'time@10': 2.9406}:  90%|█████████ | 9/10 [00:20<00:02,  2.17s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9231, 'compress@10': 1.0, 'time@10': 2.9942}:  90%|█████████ | 9/10 [00:23<00:02,  2.17s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9231, 'compress@10': 1.0, 'time@10': 2.9942}: 100%|██████████| 10/10 [00:23<00:00,  2.58s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9231, 'compress@10': 1.0, 'time@10': 2.9942}: 100%|██████████| 10/10 [00:23<00:00,  2.36s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.027281559056926113
Avg hit ratio: 0.8873577583114327
Avg ndcg: 0.923110901505523
Avg compression ratio: 1.0
Avg train time: 2.994225335121155
Std train time: 0.7415112115952197
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 8, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9271, 'compress@10': 1.0, 'time@10': 3.2685}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9271, 'compress@10': 1.0, 'time@10': 3.2685}:  10%|█         | 1/10 [00:01<00:15,  1.67s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9605, 'compress@10': 1.0, 'time@10': 3.2983}:  10%|█         | 1/10 [00:05<00:15,  1.67s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9605, 'compress@10': 1.0, 'time@10': 3.2983}:  20%|██        | 2/10 [00:05<00:21,  2.67s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9261, 'compress@10': 1.0, 'time@10': 3.2737}:  20%|██        | 2/10 [00:06<00:21,  2.67s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9261, 'compress@10': 1.0, 'time@10': 3.2737}:  30%|███       | 3/10 [00:06<00:15,  2.20s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9361, 'compress@10': 1.0, 'time@10': 3.2681}:  30%|███       | 3/10 [00:09<00:15,  2.20s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9361, 'compress@10': 1.0, 'time@10': 3.2681}:  40%|████      | 4/10 [00:09<00:15,  2.63s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0169, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 3.8172}:  40%|████      | 4/10 [00:13<00:15,  2.63s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0169, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 3.8172}:  50%|█████     | 5/10 [00:13<00:13,  2.78s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9348, 'compress@10': 1.0, 'time@10': 3.7313}:  50%|█████     | 5/10 [00:16<00:13,  2.78s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9348, 'compress@10': 1.0, 'time@10': 3.7313}:  60%|██████    | 6/10 [00:16<00:11,  2.97s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9356, 'compress@10': 1.0, 'time@10': 3.6532}:  60%|██████    | 6/10 [00:17<00:11,  2.97s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0151, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9356, 'compress@10': 1.0, 'time@10': 3.6532}:  70%|███████   | 7/10 [00:17<00:07,  2.53s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.909, 'ndcg@10': 0.9439, 'compress@10': 1.0, 'time@10': 3.5995}:  70%|███████   | 7/10 [00:21<00:07,  2.53s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.909, 'ndcg@10': 0.9439, 'compress@10': 1.0, 'time@10': 3.5995}:  80%|████████  | 8/10 [00:21<00:05,  2.76s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9448, 'compress@10': 1.0, 'time@10': 3.5981}:  80%|████████  | 8/10 [00:23<00:05,  2.76s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9448, 'compress@10': 1.0, 'time@10': 3.5981}:  90%|█████████ | 9/10 [00:23<00:02,  2.47s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.5843}:  90%|█████████ | 9/10 [00:26<00:02,  2.47s/it]    {'epoch': 28, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.5843}: 100%|██████████| 10/10 [00:26<00:00,  2.80s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.5843}: 100%|██████████| 10/10 [00:26<00:00,  2.66s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01682043685855431
Avg hit ratio: 0.902033495272884
Avg ndcg: 0.9479497483811018
Avg compression ratio: 1.0
Avg train time: 3.5843350648880006
Std train time: 0.8181690366958154
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 9, 13, 6, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9208, 'compress@10': 1.0, 'time@10': 3.4251}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9208, 'compress@10': 1.0, 'time@10': 3.4251}:  10%|█         | 1/10 [00:01<00:15,  1.75s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9634, 'compress@10': 1.0, 'time@10': 3.4145}:  10%|█         | 1/10 [00:05<00:15,  1.75s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9634, 'compress@10': 1.0, 'time@10': 3.4145}:  20%|██        | 2/10 [00:05<00:22,  2.75s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.928, 'compress@10': 1.0, 'time@10': 3.4048}:  20%|██        | 2/10 [00:06<00:22,  2.75s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.928, 'compress@10': 1.0, 'time@10': 3.4048}:  30%|███       | 3/10 [00:06<00:15,  2.29s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9367, 'compress@10': 1.0, 'time@10': 3.3681}:  30%|███       | 3/10 [00:10<00:15,  2.29s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9367, 'compress@10': 1.0, 'time@10': 3.3681}:  40%|████      | 4/10 [00:10<00:16,  2.70s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0345, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 2.8359}:  40%|████      | 4/10 [00:10<00:16,  2.70s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0345, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 2.8359}:  50%|█████     | 5/10 [00:10<00:09,  1.87s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0303, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 2.9155}:  50%|█████     | 5/10 [00:14<00:09,  1.87s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0303, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 2.9155}:  60%|██████    | 6/10 [00:14<00:09,  2.37s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0286, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 2.9558}:  60%|██████    | 6/10 [00:15<00:09,  2.37s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0286, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 2.9558}:  70%|███████   | 7/10 [00:15<00:06,  2.13s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9176, 'compress@10': 1.0, 'time@10': 2.9932}:  70%|███████   | 7/10 [00:18<00:06,  2.13s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9176, 'compress@10': 1.0, 'time@10': 2.9932}:  80%|████████  | 8/10 [00:18<00:05,  2.50s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9209, 'compress@10': 1.0, 'time@10': 3.0033}:  80%|████████  | 8/10 [00:20<00:05,  2.50s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9209, 'compress@10': 1.0, 'time@10': 3.0033}:  90%|█████████ | 9/10 [00:20<00:02,  2.21s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.025, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9264, 'compress@10': 1.0, 'time@10': 3.0402}:  90%|█████████ | 9/10 [00:23<00:02,  2.21s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.025, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9264, 'compress@10': 1.0, 'time@10': 3.0402}: 100%|██████████| 10/10 [00:23<00:00,  2.58s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.025, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9264, 'compress@10': 1.0, 'time@10': 3.0402}: 100%|██████████| 10/10 [00:23<00:00,  2.39s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.02497941262633206
Avg hit ratio: 0.90486927904876
Avg ndcg: 0.9263867691893186
Avg compression ratio: 1.0
Avg train time: 3.0402087688446047
Std train time: 0.7841220020548653
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 8, 10, 9, 13, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.2304}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 3.2304}:  10%|█         | 1/10 [00:01<00:15,  1.67s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.959, 'compress@10': 1.0, 'time@10': 3.3169}:  10%|█         | 1/10 [00:05<00:15,  1.67s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.959, 'compress@10': 1.0, 'time@10': 3.3169}:  20%|██        | 2/10 [00:05<00:21,  2.71s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9251, 'compress@10': 1.0, 'time@10': 3.2838}:  20%|██        | 2/10 [00:06<00:21,  2.71s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9251, 'compress@10': 1.0, 'time@10': 3.2838}:  30%|███       | 3/10 [00:06<00:15,  2.23s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9376, 'compress@10': 1.0, 'time@10': 3.2919}:  30%|███       | 3/10 [00:10<00:15,  2.23s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9376, 'compress@10': 1.0, 'time@10': 3.2919}:  40%|████      | 4/10 [00:10<00:16,  2.67s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 3.8166}:  40%|████      | 4/10 [00:13<00:16,  2.67s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0176, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 3.8166}:  50%|█████     | 5/10 [00:13<00:13,  2.79s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0182, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.94, 'compress@10': 1.0, 'time@10': 3.7172}:  50%|█████     | 5/10 [00:16<00:13,  2.79s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0182, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.94, 'compress@10': 1.0, 'time@10': 3.7172}:  60%|██████    | 6/10 [00:16<00:11,  2.95s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9399, 'compress@10': 1.0, 'time@10': 3.6344}:  60%|██████    | 6/10 [00:17<00:11,  2.95s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9399, 'compress@10': 1.0, 'time@10': 3.6344}:  70%|███████   | 7/10 [00:17<00:07,  2.51s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0195, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9466, 'compress@10': 1.0, 'time@10': 3.5633}:  70%|███████   | 7/10 [00:21<00:07,  2.51s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0195, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9466, 'compress@10': 1.0, 'time@10': 3.5633}:  80%|████████  | 8/10 [00:21<00:05,  2.71s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9472, 'compress@10': 1.0, 'time@10': 3.5776}:  80%|████████  | 8/10 [00:22<00:05,  2.71s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9472, 'compress@10': 1.0, 'time@10': 3.5776}:  90%|█████████ | 9/10 [00:22<00:02,  2.45s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9508, 'compress@10': 1.0, 'time@10': 3.5728}:  90%|█████████ | 9/10 [00:26<00:02,  2.45s/it]    {'epoch': 30, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9508, 'compress@10': 1.0, 'time@10': 3.5728}: 100%|██████████| 10/10 [00:26<00:00,  2.80s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9508, 'compress@10': 1.0, 'time@10': 3.5728}: 100%|██████████| 10/10 [00:26<00:00,  2.66s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.018994818329410572
Avg hit ratio: 0.8903386668038621
Avg ndcg: 0.9508022958800136
Avg compression ratio: 1.0
Avg train time: 3.572781801223755
Std train time: 0.8008098659792169
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 9, 14, 6, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9208, 'compress@10': 1.0, 'time@10': 3.3525}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.012, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9208, 'compress@10': 1.0, 'time@10': 3.3525}:  10%|█         | 1/10 [00:01<00:15,  1.71s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9592, 'compress@10': 1.0, 'time@10': 3.3467}:  10%|█         | 1/10 [00:05<00:15,  1.71s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9592, 'compress@10': 1.0, 'time@10': 3.3467}:  20%|██        | 2/10 [00:05<00:21,  2.69s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9252, 'compress@10': 1.0, 'time@10': 3.3191}:  20%|██        | 2/10 [00:06<00:21,  2.69s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9252, 'compress@10': 1.0, 'time@10': 3.3191}:  30%|███       | 3/10 [00:06<00:15,  2.23s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 3.3093}:  30%|███       | 3/10 [00:10<00:15,  2.23s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 3.3093}:  40%|████      | 4/10 [00:10<00:15,  2.66s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0325, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8837, 'compress@10': 1.0, 'time@10': 2.7886}:  40%|████      | 4/10 [00:10<00:15,  2.66s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0325, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.8837, 'compress@10': 1.0, 'time@10': 2.7886}:  50%|█████     | 5/10 [00:10<00:09,  1.84s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.898, 'compress@10': 1.0, 'time@10': 2.8636}:  50%|█████     | 5/10 [00:13<00:09,  1.84s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.898, 'compress@10': 1.0, 'time@10': 2.8636}:  60%|██████    | 6/10 [00:13<00:09,  2.33s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0261, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 2.9106}:  60%|██████    | 6/10 [00:15<00:09,  2.33s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0261, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 2.9106}:  70%|███████   | 7/10 [00:15<00:06,  2.10s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9112, 'compress@10': 1.0, 'time@10': 2.9745}:  70%|███████   | 7/10 [00:18<00:06,  2.10s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9112, 'compress@10': 1.0, 'time@10': 2.9745}:  80%|████████  | 8/10 [00:18<00:05,  2.53s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0232, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9158, 'compress@10': 1.0, 'time@10': 2.9833}:  80%|████████  | 8/10 [00:20<00:05,  2.53s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0232, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9158, 'compress@10': 1.0, 'time@10': 2.9833}:  90%|█████████ | 9/10 [00:20<00:02,  2.23s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9213, 'compress@10': 1.0, 'time@10': 3.0026}:  90%|█████████ | 9/10 [00:23<00:02,  2.23s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9213, 'compress@10': 1.0, 'time@10': 3.0026}: 100%|██████████| 10/10 [00:23<00:00,  2.53s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9213, 'compress@10': 1.0, 'time@10': 3.0026}: 100%|██████████| 10/10 [00:23<00:00,  2.36s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.022477240525391164
Avg hit ratio: 0.8955041996836807
Avg ndcg: 0.9212589068539456
Avg compression ratio: 1.0
Avg train time: 3.0025863885879516
Std train time: 0.7719817175132958
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 8, 10, 9, 14, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9297, 'compress@10': 1.0, 'time@10': 3.1693}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9297, 'compress@10': 1.0, 'time@10': 3.1693}:  10%|█         | 1/10 [00:01<00:14,  1.62s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9702, 'compress@10': 1.0, 'time@10': 3.1977}:  10%|█         | 1/10 [00:04<00:14,  1.62s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0185, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9702, 'compress@10': 1.0, 'time@10': 3.1977}:  20%|██        | 2/10 [00:04<00:20,  2.59s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 3.2088}:  20%|██        | 2/10 [00:06<00:20,  2.59s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 3.2088}:  30%|███       | 3/10 [00:06<00:15,  2.16s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9449, 'compress@10': 1.0, 'time@10': 3.2323}:  30%|███       | 3/10 [00:09<00:15,  2.16s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9449, 'compress@10': 1.0, 'time@10': 3.2323}:  40%|████      | 4/10 [00:09<00:15,  2.63s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.9355, 'compress@10': 1.0, 'time@10': 3.7774}:  40%|████      | 4/10 [00:12<00:15,  2.63s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.9355, 'compress@10': 1.0, 'time@10': 3.7774}:  50%|█████     | 5/10 [00:12<00:13,  2.77s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 3.7077}:  50%|█████     | 5/10 [00:16<00:13,  2.77s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 3.7077}:  60%|██████    | 6/10 [00:16<00:11,  2.98s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9422, 'compress@10': 1.0, 'time@10': 3.6363}:  60%|██████    | 6/10 [00:17<00:11,  2.98s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9422, 'compress@10': 1.0, 'time@10': 3.6363}:  70%|███████   | 7/10 [00:17<00:07,  2.55s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9615, 'compress@10': 1.0, 'time@10': 3.6116}:  70%|███████   | 7/10 [00:21<00:07,  2.55s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0174, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9615, 'compress@10': 1.0, 'time@10': 3.6116}:  80%|████████  | 8/10 [00:21<00:05,  2.84s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9607, 'compress@10': 1.0, 'time@10': 3.621}:  80%|████████  | 8/10 [00:23<00:05,  2.84s/it] {'epoch': 32, 'num_users': 6.3333, 'loss': 0.0177, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9607, 'compress@10': 1.0, 'time@10': 3.621}:  90%|█████████ | 9/10 [00:23<00:02,  2.54s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9612, 'compress@10': 1.0, 'time@10': 3.5709}:  90%|█████████ | 9/10 [00:26<00:02,  2.54s/it] {'epoch': 32, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9612, 'compress@10': 1.0, 'time@10': 3.5709}: 100%|██████████| 10/10 [00:26<00:00,  2.73s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9612, 'compress@10': 1.0, 'time@10': 3.5709}: 100%|██████████| 10/10 [00:26<00:00,  2.65s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.01761808924000592
Avg hit ratio: 0.8960529525181478
Avg ndcg: 0.9612160006025123
Avg compression ratio: 1.0
Avg train time: 3.570878601074219
Std train time: 0.8109595982327794
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 9, 14, 6, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9208, 'compress@10': 1.0, 'time@10': 3.4648}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9208, 'compress@10': 1.0, 'time@10': 3.4648}:  10%|█         | 1/10 [00:01<00:15,  1.77s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9562, 'compress@10': 1.0, 'time@10': 3.4127}:  10%|█         | 1/10 [00:05<00:15,  1.77s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9562, 'compress@10': 1.0, 'time@10': 3.4127}:  20%|██        | 2/10 [00:05<00:21,  2.73s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 3.344}:  20%|██        | 2/10 [00:06<00:21,  2.73s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 3.344}:  30%|███       | 3/10 [00:06<00:15,  2.23s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.9398, 'compress@10': 1.0, 'time@10': 3.3062}:  30%|███       | 3/10 [00:10<00:15,  2.23s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.9398, 'compress@10': 1.0, 'time@10': 3.3062}:  40%|████      | 4/10 [00:10<00:15,  2.63s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0311, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.887, 'compress@10': 1.0, 'time@10': 2.7875}:  40%|████      | 4/10 [00:10<00:15,  2.63s/it] {'epoch': 33, 'num_users': 5.8, 'loss': 0.0311, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.887, 'compress@10': 1.0, 'time@10': 2.7875}:  50%|█████     | 5/10 [00:10<00:09,  1.82s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 2.8853}:  50%|█████     | 5/10 [00:13<00:09,  1.82s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0295, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 2.8853}:  60%|██████    | 6/10 [00:13<00:09,  2.36s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0273, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9117, 'compress@10': 1.0, 'time@10': 2.9261}:  60%|██████    | 6/10 [00:15<00:09,  2.36s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0273, 'hit_ratio@10': 0.8568, 'ndcg@10': 0.9117, 'compress@10': 1.0, 'time@10': 2.9261}:  70%|███████   | 7/10 [00:15<00:06,  2.12s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.027, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9041, 'compress@10': 1.0, 'time@10': 2.9828}:  70%|███████   | 7/10 [00:18<00:06,  2.12s/it]  {'epoch': 33, 'num_users': 6.125, 'loss': 0.027, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9041, 'compress@10': 1.0, 'time@10': 2.9828}:  80%|████████  | 8/10 [00:18<00:05,  2.53s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0251, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 2.9805}:  80%|████████  | 8/10 [00:20<00:05,  2.53s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0251, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 2.9805}:  90%|█████████ | 9/10 [00:20<00:02,  2.22s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0249, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9176, 'compress@10': 1.0, 'time@10': 2.9931}:  90%|█████████ | 9/10 [00:23<00:02,  2.22s/it] {'epoch': 33, 'num_users': 6.3, 'loss': 0.0249, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9176, 'compress@10': 1.0, 'time@10': 2.9931}: 100%|██████████| 10/10 [00:23<00:00,  2.50s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0249, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9176, 'compress@10': 1.0, 'time@10': 2.9931}: 100%|██████████| 10/10 [00:23<00:00,  2.35s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.02491592352197277
Avg hit ratio: 0.8746085080737032
Avg ndcg: 0.9175706994510643
Avg compression ratio: 1.0
Avg train time: 2.9931341409683228
Std train time: 0.7734938328989829
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 8, 10, 9, 14, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 3.3932}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 3.3932}:  10%|█         | 1/10 [00:01<00:15,  1.73s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9653, 'compress@10': 1.0, 'time@10': 3.4269}:  10%|█         | 1/10 [00:05<00:15,  1.73s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9653, 'compress@10': 1.0, 'time@10': 3.4269}:  20%|██        | 2/10 [00:05<00:22,  2.77s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9293, 'compress@10': 1.0, 'time@10': 3.3797}:  20%|██        | 2/10 [00:06<00:22,  2.77s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9293, 'compress@10': 1.0, 'time@10': 3.3797}:  30%|███       | 3/10 [00:06<00:15,  2.27s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9403, 'compress@10': 1.0, 'time@10': 3.3556}:  30%|███       | 3/10 [00:10<00:15,  2.27s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9403, 'compress@10': 1.0, 'time@10': 3.3556}:  40%|████      | 4/10 [00:10<00:16,  2.69s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.9304, 'compress@10': 1.0, 'time@10': 3.8731}:  40%|████      | 4/10 [00:13<00:16,  2.69s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0159, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.9304, 'compress@10': 1.0, 'time@10': 3.8731}:  50%|█████     | 5/10 [00:13<00:14,  2.80s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.938, 'compress@10': 1.0, 'time@10': 3.8031}:  50%|█████     | 5/10 [00:16<00:14,  2.80s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.938, 'compress@10': 1.0, 'time@10': 3.8031}:  60%|██████    | 6/10 [00:16<00:12,  3.04s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9399, 'compress@10': 1.0, 'time@10': 3.7464}:  60%|██████    | 6/10 [00:18<00:12,  3.04s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9399, 'compress@10': 1.0, 'time@10': 3.7464}:  70%|███████   | 7/10 [00:18<00:07,  2.62s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 3.7106}:  70%|███████   | 7/10 [00:21<00:07,  2.62s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 3.7106}:  80%|████████  | 8/10 [00:21<00:05,  2.90s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9501, 'compress@10': 1.0, 'time@10': 3.6832}:  80%|████████  | 8/10 [00:23<00:05,  2.90s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.9501, 'compress@10': 1.0, 'time@10': 3.6832}:  90%|█████████ | 9/10 [00:23<00:02,  2.54s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9528, 'compress@10': 1.0, 'time@10': 3.6619}:  90%|█████████ | 9/10 [00:27<00:02,  2.54s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9528, 'compress@10': 1.0, 'time@10': 3.6619}: 100%|██████████| 10/10 [00:27<00:00,  2.85s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9528, 'compress@10': 1.0, 'time@10': 3.6619}: 100%|██████████| 10/10 [00:27<00:00,  2.73s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.013217005457052271
Avg hit ratio: 0.8938307302959256
Avg ndcg: 0.9528300448268316
Avg compression ratio: 1.0
Avg train time: 3.661944055557251
Std train time: 0.7633332421383148
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 9, 14, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9248, 'compress@10': 1.0, 'time@10': 3.1653}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9248, 'compress@10': 1.0, 'time@10': 3.1653}:  10%|█         | 1/10 [00:01<00:14,  1.64s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9733, 'compress@10': 1.0, 'time@10': 3.2376}:  10%|█         | 1/10 [00:05<00:14,  1.64s/it] {'epoch': 35, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9733, 'compress@10': 1.0, 'time@10': 3.2376}:  20%|██        | 2/10 [00:05<00:21,  2.65s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9346, 'compress@10': 1.0, 'time@10': 3.2123}:  20%|██        | 2/10 [00:06<00:21,  2.65s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9346, 'compress@10': 1.0, 'time@10': 3.2123}:  30%|███       | 3/10 [00:06<00:15,  2.18s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.942, 'compress@10': 1.0, 'time@10': 3.2416}:  30%|███       | 3/10 [00:09<00:15,  2.18s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.942, 'compress@10': 1.0, 'time@10': 3.2416}:  40%|████      | 4/10 [00:09<00:15,  2.65s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.029, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.891, 'compress@10': 1.0, 'time@10': 2.7372}:  40%|████      | 4/10 [00:10<00:15,  2.65s/it] {'epoch': 35, 'num_users': 5.8, 'loss': 0.029, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.891, 'compress@10': 1.0, 'time@10': 2.7372}:  50%|█████     | 5/10 [00:10<00:09,  1.84s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0256, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.9047, 'compress@10': 1.0, 'time@10': 2.8295}:  50%|█████     | 5/10 [00:13<00:09,  1.84s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0256, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.9047, 'compress@10': 1.0, 'time@10': 2.8295}:  60%|██████    | 6/10 [00:13<00:09,  2.35s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0239, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9099, 'compress@10': 1.0, 'time@10': 2.8775}:  60%|██████    | 6/10 [00:15<00:09,  2.35s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0239, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9099, 'compress@10': 1.0, 'time@10': 2.8775}:  70%|███████   | 7/10 [00:15<00:06,  2.11s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0264, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9045, 'compress@10': 1.0, 'time@10': 2.9393}:  70%|███████   | 7/10 [00:18<00:06,  2.11s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0264, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9045, 'compress@10': 1.0, 'time@10': 2.9393}:  80%|████████  | 8/10 [00:18<00:05,  2.52s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9105, 'compress@10': 1.0, 'time@10': 2.9964}:  80%|████████  | 8/10 [00:20<00:05,  2.52s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0248, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9105, 'compress@10': 1.0, 'time@10': 2.9964}:  90%|█████████ | 9/10 [00:20<00:02,  2.29s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9171, 'compress@10': 1.0, 'time@10': 3.0374}:  90%|█████████ | 9/10 [00:23<00:02,  2.29s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9171, 'compress@10': 1.0, 'time@10': 3.0374}: 100%|██████████| 10/10 [00:23<00:00,  2.65s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.023, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9171, 'compress@10': 1.0, 'time@10': 3.0374}: 100%|██████████| 10/10 [00:23<00:00,  2.40s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.022966397539682833
Avg hit ratio: 0.8743985746379634
Avg ndcg: 0.9170501215656831
Avg compression ratio: 1.0
Avg train time: 3.0374013423919677
Std train time: 0.7787490475556775
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 8, 10, 9, 14, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 3.2195}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 3.2195}:  10%|█         | 1/10 [00:01<00:14,  1.65s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9517, 'compress@10': 1.0, 'time@10': 3.2466}:  10%|█         | 1/10 [00:04<00:14,  1.65s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9517, 'compress@10': 1.0, 'time@10': 3.2466}:  20%|██        | 2/10 [00:04<00:21,  2.63s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9202, 'compress@10': 1.0, 'time@10': 3.288}:  20%|██        | 2/10 [00:06<00:21,  2.63s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9202, 'compress@10': 1.0, 'time@10': 3.288}:  30%|███       | 3/10 [00:06<00:15,  2.21s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9312, 'compress@10': 1.0, 'time@10': 3.303}:  30%|███       | 3/10 [00:10<00:15,  2.21s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9312, 'compress@10': 1.0, 'time@10': 3.303}:  40%|████      | 4/10 [00:10<00:16,  2.68s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 3.8552}:  40%|████      | 4/10 [00:13<00:16,  2.68s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 3.8552}:  50%|█████     | 5/10 [00:13<00:14,  2.82s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9364, 'compress@10': 1.0, 'time@10': 3.7855}:  50%|█████     | 5/10 [00:16<00:14,  2.82s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.858, 'ndcg@10': 0.9364, 'compress@10': 1.0, 'time@10': 3.7855}:  60%|██████    | 6/10 [00:16<00:12,  3.04s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9378, 'compress@10': 1.0, 'time@10': 3.7061}:  60%|██████    | 6/10 [00:18<00:12,  3.04s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9378, 'compress@10': 1.0, 'time@10': 3.7061}:  70%|███████   | 7/10 [00:18<00:07,  2.59s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9466, 'compress@10': 1.0, 'time@10': 3.6723}:  70%|███████   | 7/10 [00:21<00:07,  2.59s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9466, 'compress@10': 1.0, 'time@10': 3.6723}:  80%|████████  | 8/10 [00:21<00:05,  2.87s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9483, 'compress@10': 1.0, 'time@10': 3.6638}:  80%|████████  | 8/10 [00:23<00:05,  2.87s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9483, 'compress@10': 1.0, 'time@10': 3.6638}:  90%|█████████ | 9/10 [00:23<00:02,  2.55s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9511, 'compress@10': 1.0, 'time@10': 3.6404}:  90%|█████████ | 9/10 [00:27<00:02,  2.55s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9511, 'compress@10': 1.0, 'time@10': 3.6404}: 100%|██████████| 10/10 [00:27<00:00,  2.83s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9511, 'compress@10': 1.0, 'time@10': 3.6404}: 100%|██████████| 10/10 [00:27<00:00,  2.71s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.012563847375837517
Avg hit ratio: 0.8885414317808206
Avg ndcg: 0.9511048305581751
Avg compression ratio: 1.0
Avg train time: 3.6403507471084593
Std train time: 0.815020740157264
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 9, 14, 6, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9248, 'compress@10': 1.0, 'time@10': 3.2674}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9248, 'compress@10': 1.0, 'time@10': 3.2674}:  10%|█         | 1/10 [00:01<00:15,  1.67s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9726, 'compress@10': 1.0, 'time@10': 3.3321}:  10%|█         | 1/10 [00:05<00:15,  1.67s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9726, 'compress@10': 1.0, 'time@10': 3.3321}:  20%|██        | 2/10 [00:05<00:21,  2.71s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9341, 'compress@10': 1.0, 'time@10': 3.3339}:  20%|██        | 2/10 [00:06<00:21,  2.71s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9341, 'compress@10': 1.0, 'time@10': 3.3339}:  30%|███       | 3/10 [00:06<00:15,  2.25s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9425, 'compress@10': 1.0, 'time@10': 3.3555}:  30%|███       | 3/10 [00:10<00:15,  2.25s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9425, 'compress@10': 1.0, 'time@10': 3.3555}:  40%|████      | 4/10 [00:10<00:16,  2.73s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0281, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 2.8367}:  40%|████      | 4/10 [00:10<00:16,  2.73s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.0281, 'hit_ratio@10': 0.847, 'ndcg@10': 0.8919, 'compress@10': 1.0, 'time@10': 2.8367}:  50%|█████     | 5/10 [00:10<00:09,  1.90s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0242, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 2.918}:  50%|█████     | 5/10 [00:14<00:09,  1.90s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0242, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 2.918}:  60%|██████    | 6/10 [00:14<00:09,  2.40s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0225, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.911, 'compress@10': 1.0, 'time@10': 2.9654}:  60%|██████    | 6/10 [00:15<00:09,  2.40s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0225, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.911, 'compress@10': 1.0, 'time@10': 2.9654}:  70%|███████   | 7/10 [00:15<00:06,  2.16s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9287, 'compress@10': 1.0, 'time@10': 3.0236}:  70%|███████   | 7/10 [00:19<00:06,  2.16s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9287, 'compress@10': 1.0, 'time@10': 3.0236}:  80%|████████  | 8/10 [00:19<00:05,  2.57s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0224, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.0202}:  80%|████████  | 8/10 [00:20<00:05,  2.57s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0224, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.0202}:  90%|█████████ | 9/10 [00:20<00:02,  2.25s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9362, 'compress@10': 1.0, 'time@10': 3.0603}:  90%|█████████ | 9/10 [00:24<00:02,  2.25s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9362, 'compress@10': 1.0, 'time@10': 3.0603}: 100%|██████████| 10/10 [00:24<00:00,  2.62s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9362, 'compress@10': 1.0, 'time@10': 3.0603}: 100%|██████████| 10/10 [00:24<00:00,  2.42s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.021424737639282408
Avg hit ratio: 0.8899314544565575
Avg ndcg: 0.9362363588563873
Avg compression ratio: 1.0
Avg train time: 3.0602869510650637
Std train time: 0.776115725271693
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 8, 10, 9, 14, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 3.2394}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 3.2394}:  10%|█         | 1/10 [00:01<00:14,  1.66s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 3.2894}:  10%|█         | 1/10 [00:05<00:14,  1.66s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 3.2894}:  20%|██        | 2/10 [00:05<00:21,  2.68s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9189, 'compress@10': 1.0, 'time@10': 3.2902}:  20%|██        | 2/10 [00:06<00:21,  2.68s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9189, 'compress@10': 1.0, 'time@10': 3.2902}:  30%|███       | 3/10 [00:06<00:15,  2.22s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9303, 'compress@10': 1.0, 'time@10': 3.2939}:  30%|███       | 3/10 [00:10<00:15,  2.22s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9303, 'compress@10': 1.0, 'time@10': 3.2939}:  40%|████      | 4/10 [00:10<00:16,  2.67s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.9243, 'compress@10': 1.0, 'time@10': 3.7959}:  40%|████      | 4/10 [00:13<00:16,  2.67s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0152, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.9243, 'compress@10': 1.0, 'time@10': 3.7959}:  50%|█████     | 5/10 [00:13<00:13,  2.77s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9326, 'compress@10': 1.0, 'time@10': 3.6984}:  50%|█████     | 5/10 [00:16<00:13,  2.77s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8786, 'ndcg@10': 0.9326, 'compress@10': 1.0, 'time@10': 3.6984}:  60%|██████    | 6/10 [00:16<00:11,  2.93s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9352, 'compress@10': 1.0, 'time@10': 3.6199}:  60%|██████    | 6/10 [00:17<00:11,  2.93s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9352, 'compress@10': 1.0, 'time@10': 3.6199}:  70%|███████   | 7/10 [00:17<00:07,  2.50s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9389, 'compress@10': 1.0, 'time@10': 3.5845}:  70%|███████   | 7/10 [00:21<00:07,  2.50s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9389, 'compress@10': 1.0, 'time@10': 3.5845}:  80%|████████  | 8/10 [00:21<00:05,  2.78s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9401, 'compress@10': 1.0, 'time@10': 3.5919}:  80%|████████  | 8/10 [00:23<00:05,  2.78s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0142, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9401, 'compress@10': 1.0, 'time@10': 3.5919}:  90%|█████████ | 9/10 [00:23<00:02,  2.49s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9438, 'compress@10': 1.0, 'time@10': 3.5733}:  90%|█████████ | 9/10 [00:26<00:02,  2.49s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9438, 'compress@10': 1.0, 'time@10': 3.5733}: 100%|██████████| 10/10 [00:26<00:00,  2.79s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9438, 'compress@10': 1.0, 'time@10': 3.5733}: 100%|██████████| 10/10 [00:26<00:00,  2.66s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.013497272159825819
Avg hit ratio: 0.8951958096610049
Avg ndcg: 0.9437616586421008
Avg compression ratio: 1.0
Avg train time: 3.573259401321411
Std train time: 0.754602698052203
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 9, 14, 6, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 1.0, 'time@10': 3.3894}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9314, 'compress@10': 1.0, 'time@10': 3.3894}:  10%|█         | 1/10 [00:01<00:15,  1.74s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9431, 'compress@10': 1.0, 'time@10': 3.3382}:  10%|█         | 1/10 [00:05<00:15,  1.74s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9431, 'compress@10': 1.0, 'time@10': 3.3382}:  20%|██        | 2/10 [00:05<00:21,  2.67s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 3.3317}:  20%|██        | 2/10 [00:06<00:21,  2.67s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 3.3317}:  30%|███       | 3/10 [00:06<00:15,  2.23s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9269, 'compress@10': 1.0, 'time@10': 3.3111}:  30%|███       | 3/10 [00:10<00:15,  2.23s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9269, 'compress@10': 1.0, 'time@10': 3.3111}:  40%|████      | 4/10 [00:10<00:15,  2.65s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0263, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 2.7896}:  40%|████      | 4/10 [00:10<00:15,  2.65s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0263, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 2.7896}:  50%|█████     | 5/10 [00:10<00:09,  1.83s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.024, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8966, 'compress@10': 1.0, 'time@10': 2.8932}:  50%|█████     | 5/10 [00:13<00:09,  1.83s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.024, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8966, 'compress@10': 1.0, 'time@10': 2.8932}:  60%|██████    | 6/10 [00:13<00:09,  2.38s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0225, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 2.9347}:  60%|██████    | 6/10 [00:15<00:09,  2.38s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0225, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 2.9347}:  70%|███████   | 7/10 [00:15<00:06,  2.14s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0217, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.915, 'compress@10': 1.0, 'time@10': 2.9913}:  70%|███████   | 7/10 [00:18<00:06,  2.14s/it]  {'epoch': 39, 'num_users': 6.125, 'loss': 0.0217, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.915, 'compress@10': 1.0, 'time@10': 2.9913}:  80%|████████  | 8/10 [00:18<00:05,  2.55s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9202, 'compress@10': 1.0, 'time@10': 3.0038}:  80%|████████  | 8/10 [00:20<00:05,  2.55s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9202, 'compress@10': 1.0, 'time@10': 3.0038}:  90%|█████████ | 9/10 [00:20<00:02,  2.25s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.0497}:  90%|█████████ | 9/10 [00:24<00:02,  2.25s/it]  {'epoch': 39, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.0497}: 100%|██████████| 10/10 [00:24<00:00,  2.64s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.0497}: 100%|██████████| 10/10 [00:24<00:00,  2.40s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.01948207967693951
Avg hit ratio: 0.8995858323367418
Avg ndcg: 0.9256517280844679
Avg compression ratio: 1.0
Avg train time: 3.049678349494934
Std train time: 0.788934068123873
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 8, 10, 9, 14, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9381, 'compress@10': 1.0, 'time@10': 3.2843}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9381, 'compress@10': 1.0, 'time@10': 3.2843}:  10%|█         | 1/10 [00:01<00:15,  1.68s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9529, 'compress@10': 1.0, 'time@10': 3.3172}:  10%|█         | 1/10 [00:05<00:15,  1.68s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9529, 'compress@10': 1.0, 'time@10': 3.3172}:  20%|██        | 2/10 [00:05<00:21,  2.69s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.779, 'ndcg@10': 0.921, 'compress@10': 1.0, 'time@10': 3.3197}:  20%|██        | 2/10 [00:06<00:21,  2.69s/it]  {'epoch': 40, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.779, 'ndcg@10': 0.921, 'compress@10': 1.0, 'time@10': 3.3197}:  30%|███       | 3/10 [00:06<00:15,  2.24s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9318, 'compress@10': 1.0, 'time@10': 3.2969}:  30%|███       | 3/10 [00:10<00:15,  2.24s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9318, 'compress@10': 1.0, 'time@10': 3.2969}:  40%|████      | 4/10 [00:10<00:15,  2.64s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9284, 'compress@10': 1.0, 'time@10': 3.8103}:  40%|████      | 4/10 [00:13<00:15,  2.64s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9284, 'compress@10': 1.0, 'time@10': 3.8103}:  50%|█████     | 5/10 [00:13<00:13,  2.77s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0082, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9365, 'compress@10': 1.0, 'time@10': 3.7308}:  50%|█████     | 5/10 [00:16<00:13,  2.77s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0082, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9365, 'compress@10': 1.0, 'time@10': 3.7308}:  60%|██████    | 6/10 [00:16<00:11,  2.97s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9379, 'compress@10': 1.0, 'time@10': 3.6499}:  60%|██████    | 6/10 [00:18<00:11,  2.97s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9379, 'compress@10': 1.0, 'time@10': 3.6499}:  70%|███████   | 7/10 [00:18<00:07,  2.53s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 3.6194}:  70%|███████   | 7/10 [00:21<00:07,  2.53s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 3.6194}:  80%|████████  | 8/10 [00:21<00:05,  2.82s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.951, 'compress@10': 1.0, 'time@10': 3.6058}:  80%|████████  | 8/10 [00:23<00:05,  2.82s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.951, 'compress@10': 1.0, 'time@10': 3.6058}:  90%|█████████ | 9/10 [00:23<00:02,  2.50s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9535, 'compress@10': 1.0, 'time@10': 3.5873}:  90%|█████████ | 9/10 [00:26<00:02,  2.50s/it]  {'epoch': 40, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9535, 'compress@10': 1.0, 'time@10': 3.5873}: 100%|██████████| 10/10 [00:26<00:00,  2.79s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9535, 'compress@10': 1.0, 'time@10': 3.5873}: 100%|██████████| 10/10 [00:26<00:00,  2.67s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.010760739124913227
Avg hit ratio: 0.8934247152583316
Avg ndcg: 0.9535389842343449
Avg compression ratio: 1.0
Avg train time: 3.587300491333008
Std train time: 0.7643094145591974
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 9, 14, 6, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 3.7174}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 3.7174}:  10%|█         | 1/10 [00:01<00:17,  1.90s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9737, 'compress@10': 1.0, 'time@10': 3.6523}:  10%|█         | 1/10 [00:05<00:17,  1.90s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9737, 'compress@10': 1.0, 'time@10': 3.6523}:  20%|██        | 2/10 [00:05<00:23,  2.91s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9348, 'compress@10': 1.0, 'time@10': 3.5183}:  20%|██        | 2/10 [00:07<00:23,  2.91s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9348, 'compress@10': 1.0, 'time@10': 3.5183}:  30%|███       | 3/10 [00:07<00:16,  2.34s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9422, 'compress@10': 1.0, 'time@10': 3.4684}:  30%|███       | 3/10 [00:10<00:16,  2.34s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9422, 'compress@10': 1.0, 'time@10': 3.4684}:  40%|████      | 4/10 [00:10<00:16,  2.76s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0278, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 2.9248}:  40%|████      | 4/10 [00:10<00:16,  2.76s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0278, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.8977, 'compress@10': 1.0, 'time@10': 2.9248}:  50%|█████     | 5/10 [00:10<00:09,  1.91s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0259, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.9123, 'compress@10': 1.0, 'time@10': 2.9909}:  50%|█████     | 5/10 [00:14<00:09,  1.91s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0259, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.9123, 'compress@10': 1.0, 'time@10': 2.9909}:  60%|██████    | 6/10 [00:14<00:09,  2.40s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0238, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9182, 'compress@10': 1.0, 'time@10': 3.0076}:  60%|██████    | 6/10 [00:15<00:09,  2.40s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0238, 'hit_ratio@10': 0.8757, 'ndcg@10': 0.9182, 'compress@10': 1.0, 'time@10': 3.0076}:  70%|███████   | 7/10 [00:15<00:06,  2.14s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0221, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 3.0515}:  70%|███████   | 7/10 [00:19<00:06,  2.14s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0221, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 3.0515}:  80%|████████  | 8/10 [00:19<00:05,  2.54s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.929, 'compress@10': 1.0, 'time@10': 3.0485}:  80%|████████  | 8/10 [00:20<00:05,  2.54s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.929, 'compress@10': 1.0, 'time@10': 3.0485}:  90%|█████████ | 9/10 [00:20<00:02,  2.23s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9336, 'compress@10': 1.0, 'time@10': 3.0807}:  90%|█████████ | 9/10 [00:24<00:02,  2.23s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9336, 'compress@10': 1.0, 'time@10': 3.0807}: 100%|██████████| 10/10 [00:24<00:00,  2.59s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9336, 'compress@10': 1.0, 'time@10': 3.0807}: 100%|██████████| 10/10 [00:24<00:00,  2.43s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.01982298724832012
Avg hit ratio: 0.8850338610105769
Avg ndcg: 0.9336076380272577
Avg compression ratio: 1.0
Avg train time: 3.0807424068450926
Std train time: 0.8000627871000224
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 14, 39, 17, 8, 10, 10, 14, 7, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 3.1237}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 3.1237}:  10%|█         | 1/10 [00:01<00:14,  1.60s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9546, 'compress@10': 1.0, 'time@10': 3.1427}:  10%|█         | 1/10 [00:04<00:14,  1.60s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9546, 'compress@10': 1.0, 'time@10': 3.1427}:  20%|██        | 2/10 [00:04<00:20,  2.54s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.1942}:  20%|██        | 2/10 [00:06<00:20,  2.54s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.1942}:  30%|███       | 3/10 [00:06<00:15,  2.15s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9326, 'compress@10': 1.0, 'time@10': 3.2351}:  30%|███       | 3/10 [00:09<00:15,  2.15s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9326, 'compress@10': 1.0, 'time@10': 3.2351}:  40%|████      | 4/10 [00:09<00:15,  2.64s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.927, 'compress@10': 1.0, 'time@10': 3.76}:  40%|████      | 4/10 [00:12<00:15,  2.64s/it]  {'epoch': 42, 'num_users': 5.8, 'loss': 0.0087, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.927, 'compress@10': 1.0, 'time@10': 3.76}:  50%|█████     | 5/10 [00:12<00:13,  2.76s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9353, 'compress@10': 1.0, 'time@10': 3.6852}:  50%|█████     | 5/10 [00:16<00:13,  2.76s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9353, 'compress@10': 1.0, 'time@10': 3.6852}:  60%|██████    | 6/10 [00:16<00:11,  2.96s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9378, 'compress@10': 1.0, 'time@10': 3.6666}:  60%|██████    | 6/10 [00:18<00:11,  2.96s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9378, 'compress@10': 1.0, 'time@10': 3.6666}:  70%|███████   | 7/10 [00:18<00:07,  2.61s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9473, 'compress@10': 1.0, 'time@10': 3.6767}:  70%|███████   | 7/10 [00:21<00:07,  2.61s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9473, 'compress@10': 1.0, 'time@10': 3.6767}:  80%|████████  | 8/10 [00:21<00:05,  2.98s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9485, 'compress@10': 1.0, 'time@10': 3.6652}:  80%|████████  | 8/10 [00:23<00:05,  2.98s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9485, 'compress@10': 1.0, 'time@10': 3.6652}:  90%|█████████ | 9/10 [00:23<00:02,  2.62s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9513, 'compress@10': 1.0, 'time@10': 3.6346}:  90%|█████████ | 9/10 [00:27<00:02,  2.62s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9513, 'compress@10': 1.0, 'time@10': 3.6346}: 100%|██████████| 10/10 [00:27<00:00,  2.86s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9513, 'compress@10': 1.0, 'time@10': 3.6346}: 100%|██████████| 10/10 [00:27<00:00,  2.71s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.010703995014923948
Avg hit ratio: 0.9060565367475384
Avg ndcg: 0.9513141371587375
Avg compression ratio: 1.0
Avg train time: 3.634610724449158
Std train time: 0.76348904982212
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 14, 39, 17, 1, 10, 9, 13, 6, 11]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 3.2419}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 3.2419}:  10%|█         | 1/10 [00:01<00:14,  1.66s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9546, 'compress@10': 1.0, 'time@10': 3.2694}:  10%|█         | 1/10 [00:05<00:14,  1.66s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9546, 'compress@10': 1.0, 'time@10': 3.2694}:  20%|██        | 2/10 [00:05<00:21,  2.65s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.2866}:  20%|██        | 2/10 [00:06<00:21,  2.65s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.2866}:  30%|███       | 3/10 [00:06<00:15,  2.22s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.9326, 'compress@10': 1.0, 'time@10': 3.2843}:  30%|███       | 3/10 [00:10<00:15,  2.22s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8351, 'ndcg@10': 0.9326, 'compress@10': 1.0, 'time@10': 3.2843}:  40%|████      | 4/10 [00:10<00:15,  2.65s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.8892, 'compress@10': 1.0, 'time@10': 2.7778}:  40%|████      | 4/10 [00:10<00:15,  2.65s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.8892, 'compress@10': 1.0, 'time@10': 2.7778}:  50%|█████     | 5/10 [00:10<00:09,  1.85s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 2.8606}:  50%|█████     | 5/10 [00:13<00:09,  1.85s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0212, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 2.8606}:  60%|██████    | 6/10 [00:13<00:09,  2.35s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0192, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9094, 'compress@10': 1.0, 'time@10': 2.9086}:  60%|██████    | 6/10 [00:15<00:09,  2.35s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0192, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9094, 'compress@10': 1.0, 'time@10': 2.9086}:  70%|███████   | 7/10 [00:15<00:06,  2.11s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0211, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9189, 'compress@10': 1.0, 'time@10': 2.9399}:  70%|███████   | 7/10 [00:18<00:06,  2.11s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0211, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9189, 'compress@10': 1.0, 'time@10': 2.9399}:  80%|████████  | 8/10 [00:18<00:04,  2.46s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.924, 'compress@10': 1.0, 'time@10': 2.9462}:  80%|████████  | 8/10 [00:20<00:04,  2.46s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.924, 'compress@10': 1.0, 'time@10': 2.9462}:  90%|█████████ | 9/10 [00:20<00:02,  2.17s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 3.0007}:  90%|█████████ | 9/10 [00:23<00:02,  2.17s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 3.0007}: 100%|██████████| 10/10 [00:23<00:00,  2.59s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 3.0007}: 100%|██████████| 10/10 [00:23<00:00,  2.37s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.018715996785418947
Avg hit ratio: 0.8953599065391449
Avg ndcg: 0.9290659392094651
Avg compression ratio: 1.0
Avg train time: 3.0007084369659425
Std train time: 0.7590062791334996
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 14, 39, 17, 8, 10, 9, 13, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 3.2606}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 3.2606}:  10%|█         | 1/10 [00:01<00:15,  1.67s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9885, 'compress@10': 1.0, 'time@10': 3.2475}:  10%|█         | 1/10 [00:04<00:15,  1.67s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9151, 'ndcg@10': 0.9885, 'compress@10': 1.0, 'time@10': 3.2475}:  20%|██        | 2/10 [00:04<00:20,  2.61s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 3.2165}:  20%|██        | 2/10 [00:06<00:20,  2.61s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 3.2165}:  30%|███       | 3/10 [00:06<00:15,  2.17s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9496, 'compress@10': 1.0, 'time@10': 3.2468}:  30%|███       | 3/10 [00:09<00:15,  2.17s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9496, 'compress@10': 1.0, 'time@10': 3.2468}:  40%|████      | 4/10 [00:09<00:15,  2.64s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 3.7449}:  40%|████      | 4/10 [00:12<00:15,  2.64s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 3.7449}:  50%|█████     | 5/10 [00:12<00:13,  2.74s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9472, 'compress@10': 1.0, 'time@10': 3.6656}:  50%|█████     | 5/10 [00:16<00:13,  2.74s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9472, 'compress@10': 1.0, 'time@10': 3.6656}:  60%|██████    | 6/10 [00:16<00:11,  2.93s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.9191, 'ndcg@10': 0.9481, 'compress@10': 1.0, 'time@10': 3.6031}:  60%|██████    | 6/10 [00:17<00:11,  2.93s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.9191, 'ndcg@10': 0.9481, 'compress@10': 1.0, 'time@10': 3.6031}:  70%|███████   | 7/10 [00:17<00:07,  2.52s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9256, 'ndcg@10': 0.951, 'compress@10': 1.0, 'time@10': 3.5474}:  70%|███████   | 7/10 [00:21<00:07,  2.52s/it]  {'epoch': 44, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9256, 'ndcg@10': 0.951, 'compress@10': 1.0, 'time@10': 3.5474}:  80%|████████  | 8/10 [00:21<00:05,  2.74s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 3.542}:  80%|████████  | 8/10 [00:22<00:05,  2.74s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 3.542}:  90%|█████████ | 9/10 [00:22<00:02,  2.44s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9543, 'compress@10': 1.0, 'time@10': 3.5009}:  90%|█████████ | 9/10 [00:25<00:02,  2.44s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9543, 'compress@10': 1.0, 'time@10': 3.5009}: 100%|██████████| 10/10 [00:25<00:00,  2.66s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9154, 'ndcg@10': 0.9543, 'compress@10': 1.0, 'time@10': 3.5009}: 100%|██████████| 10/10 [00:25<00:00,  2.60s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.012029270366317948
Avg hit ratio: 0.9153683916536208
Avg ndcg: 0.9543320277133451
Avg compression ratio: 1.0
Avg train time: 3.5009340763092043
Std train time: 0.7523318133109348
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 14, 39, 17, 1, 10, 9, 13, 6, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 3.0783}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 3.0783}:  10%|█         | 1/10 [00:01<00:14,  1.58s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9604, 'compress@10': 1.0, 'time@10': 3.1028}:  10%|█         | 1/10 [00:04<00:14,  1.58s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9604, 'compress@10': 1.0, 'time@10': 3.1028}:  20%|██        | 2/10 [00:04<00:20,  2.51s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.926, 'compress@10': 1.0, 'time@10': 3.1226}:  20%|██        | 2/10 [00:06<00:20,  2.51s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.926, 'compress@10': 1.0, 'time@10': 3.1226}:  30%|███       | 3/10 [00:06<00:14,  2.10s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9393, 'compress@10': 1.0, 'time@10': 3.1802}:  30%|███       | 3/10 [00:09<00:14,  2.10s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9393, 'compress@10': 1.0, 'time@10': 3.1802}:  40%|████      | 4/10 [00:09<00:15,  2.61s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8974, 'compress@10': 1.0, 'time@10': 2.6931}:  40%|████      | 4/10 [00:10<00:15,  2.61s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.862, 'ndcg@10': 0.8974, 'compress@10': 1.0, 'time@10': 2.6931}:  50%|█████     | 5/10 [00:10<00:09,  1.98s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.022, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9106, 'compress@10': 1.0, 'time@10': 2.7917}:  50%|█████     | 5/10 [00:13<00:09,  1.98s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.022, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9106, 'compress@10': 1.0, 'time@10': 2.7917}:  60%|██████    | 6/10 [00:13<00:09,  2.43s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9168, 'compress@10': 1.0, 'time@10': 2.8872}:  60%|██████    | 6/10 [00:15<00:09,  2.43s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9168, 'compress@10': 1.0, 'time@10': 2.8872}:  70%|███████   | 7/10 [00:15<00:06,  2.22s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0211, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9251, 'compress@10': 1.0, 'time@10': 2.9249}:  70%|███████   | 7/10 [00:18<00:06,  2.22s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0211, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9251, 'compress@10': 1.0, 'time@10': 2.9249}:  80%|████████  | 8/10 [00:18<00:05,  2.54s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9292, 'compress@10': 1.0, 'time@10': 2.9256}:  80%|████████  | 8/10 [00:20<00:05,  2.54s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9292, 'compress@10': 1.0, 'time@10': 2.9256}:  90%|█████████ | 9/10 [00:20<00:02,  2.21s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9364, 'compress@10': 1.0, 'time@10': 2.9505}:  90%|█████████ | 9/10 [00:23<00:02,  2.21s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9364, 'compress@10': 1.0, 'time@10': 2.9505}: 100%|██████████| 10/10 [00:23<00:00,  2.52s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0198, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9364, 'compress@10': 1.0, 'time@10': 2.9505}: 100%|██████████| 10/10 [00:23<00:00,  2.36s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.019769847647610094
Avg hit ratio: 0.8967884779677163
Avg ndcg: 0.9364186861394824
Avg compression ratio: 1.0
Avg train time: 2.9505085229873655
Std train time: 0.748303175032986
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 14, 39, 17, 8, 10, 9, 13, 7, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 3.3508}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 3.3508}:  10%|█         | 1/10 [00:01<00:15,  1.71s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9501, 'compress@10': 1.0, 'time@10': 3.2082}:  10%|█         | 1/10 [00:04<00:15,  1.71s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9501, 'compress@10': 1.0, 'time@10': 3.2082}:  20%|██        | 2/10 [00:04<00:20,  2.54s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 3.2374}:  20%|██        | 2/10 [00:06<00:20,  2.54s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0046, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 3.2374}:  30%|███       | 3/10 [00:06<00:15,  2.15s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0041, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9304, 'compress@10': 1.0, 'time@10': 3.2638}:  30%|███       | 3/10 [00:09<00:15,  2.15s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0041, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9304, 'compress@10': 1.0, 'time@10': 3.2638}:  40%|████      | 4/10 [00:09<00:15,  2.64s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0072, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9267, 'compress@10': 1.0, 'time@10': 3.7891}:  40%|████      | 4/10 [00:12<00:15,  2.64s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0072, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9267, 'compress@10': 1.0, 'time@10': 3.7891}:  50%|█████     | 5/10 [00:12<00:13,  2.76s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.939, 'compress@10': 1.0, 'time@10': 3.7461}:  50%|█████     | 5/10 [00:16<00:13,  2.76s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.939, 'compress@10': 1.0, 'time@10': 3.7461}:  60%|██████    | 6/10 [00:16<00:12,  3.04s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.903, 'ndcg@10': 0.941, 'compress@10': 1.0, 'time@10': 3.6725}:  60%|██████    | 6/10 [00:18<00:12,  3.04s/it] {'epoch': 46, 'num_users': 6.2857, 'loss': 0.0094, 'hit_ratio@10': 0.903, 'ndcg@10': 0.941, 'compress@10': 1.0, 'time@10': 3.6725}:  70%|███████   | 7/10 [00:18<00:07,  2.58s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9483, 'compress@10': 1.0, 'time@10': 3.6158}:  70%|███████   | 7/10 [00:21<00:07,  2.58s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0103, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9483, 'compress@10': 1.0, 'time@10': 3.6158}:  80%|████████  | 8/10 [00:21<00:05,  2.87s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9494, 'compress@10': 1.0, 'time@10': 3.6119}:  80%|████████  | 8/10 [00:23<00:05,  2.87s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0111, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9494, 'compress@10': 1.0, 'time@10': 3.6119}:  90%|█████████ | 9/10 [00:23<00:02,  2.55s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.9523, 'compress@10': 1.0, 'time@10': 3.5648}:  90%|█████████ | 9/10 [00:26<00:02,  2.55s/it]  {'epoch': 46, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.9523, 'compress@10': 1.0, 'time@10': 3.5648}: 100%|██████████| 10/10 [00:26<00:00,  2.74s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.9523, 'compress@10': 1.0, 'time@10': 3.5648}: 100%|██████████| 10/10 [00:26<00:00,  2.66s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.010491772309571169
Avg hit ratio: 0.9041164445816399
Avg ndcg: 0.9522519056159823
Avg compression ratio: 1.0
Avg train time: 3.5647785902023315
Std train time: 0.7897710769557635
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 9, 9, 13, 6, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9381, 'compress@10': 1.0, 'time@10': 3.2966}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9381, 'compress@10': 1.0, 'time@10': 3.2966}:  10%|█         | 1/10 [00:01<00:15,  1.69s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9529, 'compress@10': 1.0, 'time@10': 3.3046}:  10%|█         | 1/10 [00:05<00:15,  1.69s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9529, 'compress@10': 1.0, 'time@10': 3.3046}:  20%|██        | 2/10 [00:05<00:21,  2.67s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.855, 'ndcg@10': 0.921, 'compress@10': 1.0, 'time@10': 3.3186}:  20%|██        | 2/10 [00:06<00:21,  2.67s/it]   {'epoch': 47, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.855, 'ndcg@10': 0.921, 'compress@10': 1.0, 'time@10': 3.3186}:  30%|███       | 3/10 [00:06<00:15,  2.23s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9401, 'compress@10': 1.0, 'time@10': 3.3263}:  30%|███       | 3/10 [00:10<00:15,  2.23s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9401, 'compress@10': 1.0, 'time@10': 3.3263}:  40%|████      | 4/10 [00:10<00:16,  2.69s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 2.8167}:  40%|████      | 4/10 [00:10<00:16,  2.69s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0206, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9017, 'compress@10': 1.0, 'time@10': 2.8167}:  50%|█████     | 5/10 [00:10<00:09,  1.88s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9142, 'compress@10': 1.0, 'time@10': 2.8659}:  50%|█████     | 5/10 [00:13<00:09,  1.88s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0178, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9142, 'compress@10': 1.0, 'time@10': 2.8659}:  60%|██████    | 6/10 [00:13<00:09,  2.31s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0167, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9196, 'compress@10': 1.0, 'time@10': 2.8999}:  60%|██████    | 6/10 [00:15<00:09,  2.31s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0167, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.9196, 'compress@10': 1.0, 'time@10': 2.8999}:  70%|███████   | 7/10 [00:15<00:06,  2.08s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9276, 'compress@10': 1.0, 'time@10': 2.931}:  70%|███████   | 7/10 [00:18<00:06,  2.08s/it]  {'epoch': 47, 'num_users': 6.125, 'loss': 0.0177, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9276, 'compress@10': 1.0, 'time@10': 2.931}:  80%|████████  | 8/10 [00:18<00:04,  2.43s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9317, 'compress@10': 1.0, 'time@10': 2.956}:  80%|████████  | 8/10 [00:20<00:04,  2.43s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9317, 'compress@10': 1.0, 'time@10': 2.956}:  90%|█████████ | 9/10 [00:20<00:02,  2.18s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9373, 'compress@10': 1.0, 'time@10': 2.9803}:  90%|█████████ | 9/10 [00:23<00:02,  2.18s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9373, 'compress@10': 1.0, 'time@10': 2.9803}: 100%|██████████| 10/10 [00:23<00:00,  2.51s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9373, 'compress@10': 1.0, 'time@10': 2.9803}: 100%|██████████| 10/10 [00:23<00:00,  2.34s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.016742183581881682
Avg hit ratio: 0.9019953122577424
Avg ndcg: 0.9372799537248616
Avg compression ratio: 1.0
Avg train time: 2.9802995204925535
Std train time: 0.7396123464715383
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 8, 10, 10, 13, 6, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9355, 'compress@10': 1.0, 'time@10': 3.1705}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9355, 'compress@10': 1.0, 'time@10': 3.1705}:  10%|█         | 1/10 [00:01<00:14,  1.62s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9635, 'compress@10': 1.0, 'time@10': 3.3122}:  10%|█         | 1/10 [00:05<00:14,  1.62s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9635, 'compress@10': 1.0, 'time@10': 3.3122}:  20%|██        | 2/10 [00:05<00:21,  2.72s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.928, 'compress@10': 1.0, 'time@10': 3.3664}:  20%|██        | 2/10 [00:06<00:21,  2.72s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.928, 'compress@10': 1.0, 'time@10': 3.3664}:  30%|███       | 3/10 [00:06<00:16,  2.29s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9371, 'compress@10': 1.0, 'time@10': 3.3526}:  30%|███       | 3/10 [00:10<00:16,  2.29s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9371, 'compress@10': 1.0, 'time@10': 3.3526}:  40%|████      | 4/10 [00:10<00:16,  2.71s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9354, 'compress@10': 1.0, 'time@10': 3.913}:  40%|████      | 4/10 [00:13<00:16,  2.71s/it] {'epoch': 48, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9354, 'compress@10': 1.0, 'time@10': 3.913}:  50%|█████     | 5/10 [00:13<00:14,  2.86s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 3.8057}:  50%|█████     | 5/10 [00:16<00:14,  2.86s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 3.8057}:  60%|██████    | 6/10 [00:16<00:12,  3.01s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.946, 'compress@10': 1.0, 'time@10': 3.7899}:  60%|██████    | 6/10 [00:18<00:12,  3.01s/it] {'epoch': 48, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.946, 'compress@10': 1.0, 'time@10': 3.7899}:  70%|███████   | 7/10 [00:18<00:07,  2.65s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.9237, 'ndcg@10': 0.9505, 'compress@10': 1.0, 'time@10': 3.7383}:  70%|███████   | 7/10 [00:21<00:07,  2.65s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.9237, 'ndcg@10': 0.9505, 'compress@10': 1.0, 'time@10': 3.7383}:  80%|████████  | 8/10 [00:21<00:05,  2.89s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 3.6751}:  80%|████████  | 8/10 [00:23<00:05,  2.89s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 3.6751}:  90%|█████████ | 9/10 [00:23<00:02,  2.50s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9542, 'compress@10': 1.0, 'time@10': 3.6567}:  90%|█████████ | 9/10 [00:27<00:02,  2.50s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9542, 'compress@10': 1.0, 'time@10': 3.6567}: 100%|██████████| 10/10 [00:27<00:00,  2.82s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9542, 'compress@10': 1.0, 'time@10': 3.6567}: 100%|██████████| 10/10 [00:27<00:00,  2.72s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.012376235203166129
Avg hit ratio: 0.9166510067936213
Avg ndcg: 0.9541896309104937
Avg compression ratio: 1.0
Avg train time: 3.656726574897766
Std train time: 0.8464556616355327
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 15, 39, 17, 1, 10, 9, 13, 6, 9]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0048, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 3.427}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0048, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 3.427}:  10%|█         | 1/10 [00:01<00:15,  1.76s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9562, 'compress@10': 1.0, 'time@10': 3.4692}:  10%|█         | 1/10 [00:05<00:15,  1.76s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9562, 'compress@10': 1.0, 'time@10': 3.4692}:  20%|██        | 2/10 [00:05<00:22,  2.81s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 3.4442}:  20%|██        | 2/10 [00:07<00:22,  2.81s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 3.4442}:  30%|███       | 3/10 [00:07<00:16,  2.32s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.7986, 'ndcg@10': 0.9331, 'compress@10': 1.0, 'time@10': 3.5046}:  30%|███       | 3/10 [00:11<00:16,  2.32s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.7986, 'ndcg@10': 0.9331, 'compress@10': 1.0, 'time@10': 3.5046}:  40%|████      | 4/10 [00:11<00:18,  3.07s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0202, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 2.9678}:  40%|████      | 4/10 [00:11<00:18,  3.07s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0202, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 2.9678}:  50%|█████     | 5/10 [00:11<00:10,  2.12s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0174, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.9125, 'compress@10': 1.0, 'time@10': 3.0867}:  50%|█████     | 5/10 [00:15<00:10,  2.12s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0174, 'hit_ratio@10': 0.8413, 'ndcg@10': 0.9125, 'compress@10': 1.0, 'time@10': 3.0867}:  60%|██████    | 6/10 [00:15<00:10,  2.67s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9184, 'compress@10': 1.0, 'time@10': 3.1286}:  60%|██████    | 6/10 [00:17<00:10,  2.67s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.9184, 'compress@10': 1.0, 'time@10': 3.1286}:  70%|███████   | 7/10 [00:17<00:07,  2.36s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0173, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.924, 'compress@10': 1.0, 'time@10': 3.1499}:  70%|███████   | 7/10 [00:20<00:07,  2.36s/it]  {'epoch': 49, 'num_users': 6.125, 'loss': 0.0173, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.924, 'compress@10': 1.0, 'time@10': 3.1499}:  80%|████████  | 8/10 [00:20<00:05,  2.68s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0167, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9279, 'compress@10': 1.0, 'time@10': 3.1504}:  80%|████████  | 8/10 [00:22<00:05,  2.68s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0167, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9279, 'compress@10': 1.0, 'time@10': 3.1504}:  90%|█████████ | 9/10 [00:22<00:02,  2.35s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9328, 'compress@10': 1.0, 'time@10': 3.1305}:  90%|█████████ | 9/10 [00:25<00:02,  2.35s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9328, 'compress@10': 1.0, 'time@10': 3.1305}: 100%|██████████| 10/10 [00:25<00:00,  2.55s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9328, 'compress@10': 1.0, 'time@10': 3.1305}: 100%|██████████| 10/10 [00:25<00:00,  2.51s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.015340061509791189
Avg hit ratio: 0.8756492050542499
Avg ndcg: 0.9328036679437963
Avg compression ratio: 1.0
Avg train time: 3.130541467666626
Std train time: 0.798329659195012
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[12, 14, 39, 16, 8, 9, 9, 13, 6, 10]
