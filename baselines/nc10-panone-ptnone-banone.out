  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1644, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5139, 'compress@10': 1.0, 'time@10': 4.0094}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1644, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5139, 'compress@10': 1.0, 'time@10': 4.0094}:  10%|█         | 1/10 [00:02<00:18,  2.05s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1199, 'hit_ratio@10': 0.6604, 'ndcg@10': 0.641, 'compress@10': 1.0, 'time@10': 3.1874}:  10%|█         | 1/10 [00:04<00:18,  2.05s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.1199, 'hit_ratio@10': 0.6604, 'ndcg@10': 0.641, 'compress@10': 1.0, 'time@10': 3.1874}:  20%|██        | 2/10 [00:04<00:18,  2.26s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7718, 'hit_ratio@10': 0.6308, 'ndcg@10': 0.4274, 'compress@10': 1.0, 'time@10': 2.4324}:  20%|██        | 2/10 [00:04<00:18,  2.26s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7718, 'hit_ratio@10': 0.6308, 'ndcg@10': 0.4274, 'compress@10': 1.0, 'time@10': 2.4324}:  30%|███       | 3/10 [00:04<00:10,  1.46s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6066, 'hit_ratio@10': 0.6606, 'ndcg@10': 0.4689, 'compress@10': 1.0, 'time@10': 2.3684}:  30%|███       | 3/10 [00:07<00:10,  1.46s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6066, 'hit_ratio@10': 0.6606, 'ndcg@10': 0.4689, 'compress@10': 1.0, 'time@10': 2.3684}:  40%|████      | 4/10 [00:07<00:10,  1.76s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.504, 'hit_ratio@10': 0.6925, 'ndcg@10': 0.5258, 'compress@10': 1.0, 'time@10': 3.4868}:  40%|████      | 4/10 [00:11<00:10,  1.76s/it] {'epoch': 0, 'num_users': 5.8, 'loss': 0.504, 'hit_ratio@10': 0.6925, 'ndcg@10': 0.5258, 'compress@10': 1.0, 'time@10': 3.4868}:  50%|█████     | 5/10 [00:11<00:12,  2.57s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4344, 'hit_ratio@10': 0.6956, 'ndcg@10': 0.5678, 'compress@10': 1.0, 'time@10': 3.498}:  50%|█████     | 5/10 [00:14<00:12,  2.57s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4344, 'hit_ratio@10': 0.6956, 'ndcg@10': 0.5678, 'compress@10': 1.0, 'time@10': 3.498}:  60%|██████    | 6/10 [00:14<00:11,  2.92s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3882, 'hit_ratio@10': 0.7105, 'ndcg@10': 0.5716, 'compress@10': 1.0, 'time@10': 3.5393}:  60%|██████    | 6/10 [00:16<00:11,  2.92s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3882, 'hit_ratio@10': 0.7105, 'ndcg@10': 0.5716, 'compress@10': 1.0, 'time@10': 3.5393}:  70%|███████   | 7/10 [00:16<00:07,  2.60s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3458, 'hit_ratio@10': 0.736, 'ndcg@10': 0.5975, 'compress@10': 1.0, 'time@10': 3.4251}:  70%|███████   | 7/10 [00:19<00:07,  2.60s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.3458, 'hit_ratio@10': 0.736, 'ndcg@10': 0.5975, 'compress@10': 1.0, 'time@10': 3.4251}:  80%|████████  | 8/10 [00:19<00:05,  2.62s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3123, 'hit_ratio@10': 0.7399, 'ndcg@10': 0.6323, 'compress@10': 1.0, 'time@10': 3.6543}:  80%|████████  | 8/10 [00:22<00:05,  2.62s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3123, 'hit_ratio@10': 0.7399, 'ndcg@10': 0.6323, 'compress@10': 1.0, 'time@10': 3.6543}:  90%|█████████ | 9/10 [00:22<00:02,  2.67s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2863, 'hit_ratio@10': 0.7591, 'ndcg@10': 0.6534, 'compress@10': 1.0, 'time@10': 3.6274}:  90%|█████████ | 9/10 [00:25<00:02,  2.67s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2863, 'hit_ratio@10': 0.7591, 'ndcg@10': 0.6534, 'compress@10': 1.0, 'time@10': 3.6274}: 100%|██████████| 10/10 [00:25<00:00,  2.90s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2863, 'hit_ratio@10': 0.7591, 'ndcg@10': 0.6534, 'compress@10': 1.0, 'time@10': 3.6274}: 100%|██████████| 10/10 [00:25<00:00,  2.56s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.28625954646703333
Avg hit ratio: 0.759095500236417
Avg ndcg: 0.653352557449557
Avg compression ratio: 1.0
Avg train time: 3.627374219894409
Std train time: 1.8572354420860735
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0597, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.7992, 'compress@10': 1.0, 'time@10': 2.7797}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0597, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.7992, 'compress@10': 1.0, 'time@10': 2.7797}:  10%|█         | 1/10 [00:01<00:12,  1.43s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0565, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8268, 'compress@10': 1.0, 'time@10': 2.6261}:  10%|█         | 1/10 [00:03<00:12,  1.43s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0565, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.8268, 'compress@10': 1.0, 'time@10': 2.6261}:  20%|██        | 2/10 [00:03<00:16,  2.07s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0615, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.7967, 'compress@10': 1.0, 'time@10': 2.0543}:  20%|██        | 2/10 [00:04<00:16,  2.07s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0615, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.7967, 'compress@10': 1.0, 'time@10': 2.0543}:  30%|███       | 3/10 [00:04<00:09,  1.35s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0585, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8105, 'compress@10': 1.0, 'time@10': 2.0687}:  30%|███       | 3/10 [00:06<00:09,  1.35s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0585, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8105, 'compress@10': 1.0, 'time@10': 2.0687}:  40%|████      | 4/10 [00:06<00:09,  1.66s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.064, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8058, 'compress@10': 1.0, 'time@10': 3.2501}:  40%|████      | 4/10 [00:10<00:09,  1.66s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.064, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8058, 'compress@10': 1.0, 'time@10': 3.2501}:  50%|█████     | 5/10 [00:10<00:12,  2.51s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0661, 'hit_ratio@10': 0.7877, 'ndcg@10': 0.8072, 'compress@10': 1.0, 'time@10': 3.2906}:  50%|█████     | 5/10 [00:14<00:12,  2.51s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0661, 'hit_ratio@10': 0.7877, 'ndcg@10': 0.8072, 'compress@10': 1.0, 'time@10': 3.2906}:  60%|██████    | 6/10 [00:14<00:11,  2.86s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0631, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.815, 'compress@10': 1.0, 'time@10': 3.3674}:  60%|██████    | 6/10 [00:16<00:11,  2.86s/it] {'epoch': 1, 'num_users': 6.2857, 'loss': 0.0631, 'hit_ratio@10': 0.8123, 'ndcg@10': 0.815, 'compress@10': 1.0, 'time@10': 3.3674}:  70%|███████   | 7/10 [00:16<00:07,  2.56s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0599, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8231, 'compress@10': 1.0, 'time@10': 3.2808}:  70%|███████   | 7/10 [00:19<00:07,  2.56s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0599, 'hit_ratio@10': 0.825, 'ndcg@10': 0.8231, 'compress@10': 1.0, 'time@10': 3.2808}:  80%|████████  | 8/10 [00:19<00:05,  2.75s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.057, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8328, 'compress@10': 1.0, 'time@10': 3.5151}:  80%|████████  | 8/10 [00:21<00:05,  2.75s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.057, 'hit_ratio@10': 0.8127, 'ndcg@10': 0.8328, 'compress@10': 1.0, 'time@10': 3.5151}:  90%|█████████ | 9/10 [00:21<00:02,  2.74s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0558, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8342, 'compress@10': 1.0, 'time@10': 3.5001}:  90%|█████████ | 9/10 [00:25<00:02,  2.74s/it]  {'epoch': 1, 'num_users': 6.3, 'loss': 0.0558, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8342, 'compress@10': 1.0, 'time@10': 3.5001}: 100%|██████████| 10/10 [00:25<00:00,  2.95s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0558, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.8342, 'compress@10': 1.0, 'time@10': 3.5001}: 100%|██████████| 10/10 [00:25<00:00,  2.54s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05583881332667863
Avg hit ratio: 0.8246381741254407
Avg ndcg: 0.834205852135422
Avg compression ratio: 1.0
Avg train time: 3.5000940561294556
Std train time: 1.8605383741010013
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8427, 'compress@10': 1.0, 'time@10': 3.1806}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8427, 'compress@10': 1.0, 'time@10': 3.1806}:  10%|█         | 1/10 [00:01<00:14,  1.63s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 2.8141}:  10%|█         | 1/10 [00:04<00:14,  1.63s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 2.8141}:  20%|██        | 2/10 [00:04<00:17,  2.13s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8375, 'compress@10': 1.0, 'time@10': 2.1747}:  20%|██        | 2/10 [00:04<00:17,  2.13s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8375, 'compress@10': 1.0, 'time@10': 2.1747}:  30%|███       | 3/10 [00:04<00:09,  1.39s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0389, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8389, 'compress@10': 1.0, 'time@10': 2.1554}:  30%|███       | 3/10 [00:06<00:09,  1.39s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0389, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8389, 'compress@10': 1.0, 'time@10': 2.1554}:  40%|████      | 4/10 [00:06<00:10,  1.68s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8301, 'compress@10': 1.0, 'time@10': 3.3181}:  40%|████      | 4/10 [00:10<00:10,  1.68s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8301, 'compress@10': 1.0, 'time@10': 3.3181}:  50%|█████     | 5/10 [00:10<00:12,  2.53s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0516, 'hit_ratio@10': 0.785, 'ndcg@10': 0.8279, 'compress@10': 1.0, 'time@10': 3.3595}:  50%|█████     | 5/10 [00:14<00:12,  2.53s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0516, 'hit_ratio@10': 0.785, 'ndcg@10': 0.8279, 'compress@10': 1.0, 'time@10': 3.3595}:  60%|██████    | 6/10 [00:14<00:11,  2.89s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0501, 'hit_ratio@10': 0.81, 'ndcg@10': 0.8321, 'compress@10': 1.0, 'time@10': 3.423}:  60%|██████    | 6/10 [00:16<00:11,  2.89s/it]  {'epoch': 2, 'num_users': 6.2857, 'loss': 0.0501, 'hit_ratio@10': 0.81, 'ndcg@10': 0.8321, 'compress@10': 1.0, 'time@10': 3.423}:  70%|███████   | 7/10 [00:16<00:07,  2.58s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.049, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8382, 'compress@10': 1.0, 'time@10': 3.3222}:  70%|███████   | 7/10 [00:18<00:07,  2.58s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.049, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8382, 'compress@10': 1.0, 'time@10': 3.3222}:  80%|████████  | 8/10 [00:18<00:05,  2.61s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8462, 'compress@10': 1.0, 'time@10': 3.5638}:  80%|████████  | 8/10 [00:21<00:05,  2.61s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.811, 'ndcg@10': 0.8462, 'compress@10': 1.0, 'time@10': 3.5638}:  90%|█████████ | 9/10 [00:21<00:02,  2.66s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0468, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 3.5638}:  90%|█████████ | 9/10 [00:25<00:02,  2.66s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 0.0468, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 3.5638}: 100%|██████████| 10/10 [00:25<00:00,  2.95s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0468, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8468, 'compress@10': 1.0, 'time@10': 3.5638}: 100%|██████████| 10/10 [00:25<00:00,  2.54s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04675141949870948
Avg hit ratio: 0.8230636464082984
Avg ndcg: 0.8467783485695415
Avg compression ratio: 1.0
Avg train time: 3.563783621788025
Std train time: 1.8642488430419724
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 2.9263}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 2.9263}:  10%|█         | 1/10 [00:01<00:13,  1.50s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8512, 'compress@10': 1.0, 'time@10': 2.6792}:  10%|█         | 1/10 [00:03<00:13,  1.50s/it] {'epoch': 3, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8512, 'compress@10': 1.0, 'time@10': 2.6792}:  20%|██        | 2/10 [00:03<00:16,  2.08s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.851, 'compress@10': 1.0, 'time@10': 2.0873}:  20%|██        | 2/10 [00:04<00:16,  2.08s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.851, 'compress@10': 1.0, 'time@10': 2.0873}:  30%|███       | 3/10 [00:04<00:09,  1.35s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0367, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 2.0931}:  30%|███       | 3/10 [00:06<00:09,  1.35s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0367, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 2.0931}:  40%|████      | 4/10 [00:06<00:09,  1.67s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0442, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.841, 'compress@10': 1.0, 'time@10': 3.3093}:  40%|████      | 4/10 [00:10<00:09,  1.67s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0442, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.841, 'compress@10': 1.0, 'time@10': 3.3093}:  50%|█████     | 5/10 [00:10<00:12,  2.55s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0474, 'hit_ratio@10': 0.784, 'ndcg@10': 0.8386, 'compress@10': 1.0, 'time@10': 3.3543}:  50%|█████     | 5/10 [00:14<00:12,  2.55s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0474, 'hit_ratio@10': 0.784, 'ndcg@10': 0.8386, 'compress@10': 1.0, 'time@10': 3.3543}:  60%|██████    | 6/10 [00:14<00:11,  2.91s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0464, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 3.4185}:  60%|██████    | 6/10 [00:16<00:11,  2.91s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0464, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 3.4185}:  70%|███████   | 7/10 [00:16<00:07,  2.60s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0464, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8513, 'compress@10': 1.0, 'time@10': 3.3376}:  70%|███████   | 7/10 [00:19<00:07,  2.60s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0464, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8513, 'compress@10': 1.0, 'time@10': 3.3376}:  80%|████████  | 8/10 [00:19<00:05,  2.66s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.8071, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 3.5779}:  80%|████████  | 8/10 [00:21<00:05,  2.66s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0472, 'hit_ratio@10': 0.8071, 'ndcg@10': 0.8574, 'compress@10': 1.0, 'time@10': 3.5779}:  90%|█████████ | 9/10 [00:21<00:02,  2.70s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0464, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 3.5566}:  90%|█████████ | 9/10 [00:25<00:02,  2.70s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0464, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 3.5566}: 100%|██████████| 10/10 [00:25<00:00,  2.92s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0464, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 3.5566}: 100%|██████████| 10/10 [00:25<00:00,  2.53s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04636176492843768
Avg hit ratio: 0.8195557099003619
Avg ndcg: 0.8576859535436219
Avg compression ratio: 1.0
Avg train time: 3.556582450866699
Std train time: 1.913322356147587
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 2.8441}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 2.8441}:  10%|█         | 1/10 [00:01<00:13,  1.46s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 2.6839}:  10%|█         | 1/10 [00:04<00:13,  1.46s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 2.6839}:  20%|██        | 2/10 [00:04<00:16,  2.11s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8556, 'compress@10': 1.0, 'time@10': 2.0939}:  20%|██        | 2/10 [00:04<00:16,  2.11s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8556, 'compress@10': 1.0, 'time@10': 2.0939}:  30%|███       | 3/10 [00:04<00:09,  1.37s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8563, 'compress@10': 1.0, 'time@10': 2.1342}:  30%|███       | 3/10 [00:06<00:09,  1.37s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8563, 'compress@10': 1.0, 'time@10': 2.1342}:  40%|████      | 4/10 [00:06<00:10,  1.74s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0388, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 3.3683}:  40%|████      | 4/10 [00:11<00:10,  1.74s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0388, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 3.3683}:  50%|█████     | 5/10 [00:11<00:13,  2.63s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0409, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8526, 'compress@10': 1.0, 'time@10': 3.3956}:  50%|█████     | 5/10 [00:14<00:13,  2.63s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0409, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8526, 'compress@10': 1.0, 'time@10': 3.3956}:  60%|██████    | 6/10 [00:14<00:11,  2.95s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0408, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 3.458}:  60%|██████    | 6/10 [00:16<00:11,  2.95s/it]  {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0408, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 3.458}:  70%|███████   | 7/10 [00:16<00:07,  2.62s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0421, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8622, 'compress@10': 1.0, 'time@10': 3.3585}:  70%|███████   | 7/10 [00:19<00:07,  2.62s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0421, 'hit_ratio@10': 0.8509, 'ndcg@10': 0.8622, 'compress@10': 1.0, 'time@10': 3.3585}:  80%|████████  | 8/10 [00:19<00:05,  2.65s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0456, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8671, 'compress@10': 1.0, 'time@10': 3.5951}:  80%|████████  | 8/10 [00:22<00:05,  2.65s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0456, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8671, 'compress@10': 1.0, 'time@10': 3.5951}:  90%|█████████ | 9/10 [00:22<00:02,  2.69s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0454, 'hit_ratio@10': 0.851, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 3.5643}:  90%|█████████ | 9/10 [00:25<00:02,  2.69s/it]    {'epoch': 4, 'num_users': 6.3, 'loss': 0.0454, 'hit_ratio@10': 0.851, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 3.5643}: 100%|██████████| 10/10 [00:25<00:00,  2.89s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0454, 'hit_ratio@10': 0.851, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 3.5643}: 100%|██████████| 10/10 [00:25<00:00,  2.54s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04536290947357995
Avg hit ratio: 0.8510319003765524
Avg ndcg: 0.8653371472021865
Avg compression ratio: 1.0
Avg train time: 3.564325284957886
Std train time: 1.9358624571381817
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8482, 'compress@10': 1.0, 'time@10': 2.8466}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0426, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8482, 'compress@10': 1.0, 'time@10': 2.8466}:  10%|█         | 1/10 [00:01<00:13,  1.46s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 2.5886}:  10%|█         | 1/10 [00:03<00:13,  1.46s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0377, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8675, 'compress@10': 1.0, 'time@10': 2.5886}:  20%|██        | 2/10 [00:03<00:15,  1.99s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 2.0177}:  20%|██        | 2/10 [00:04<00:15,  1.99s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 2.0177}:  30%|███       | 3/10 [00:04<00:09,  1.30s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 2.0154}:  30%|███       | 3/10 [00:06<00:09,  1.30s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 2.0154}:  40%|████      | 4/10 [00:06<00:09,  1.59s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0388, 'hit_ratio@10': 0.8056, 'ndcg@10': 0.8623, 'compress@10': 1.0, 'time@10': 3.1516}:  40%|████      | 4/10 [00:10<00:09,  1.59s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0388, 'hit_ratio@10': 0.8056, 'ndcg@10': 0.8623, 'compress@10': 1.0, 'time@10': 3.1516}:  50%|█████     | 5/10 [00:10<00:12,  2.42s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 3.2047}:  50%|█████     | 5/10 [00:13<00:12,  2.42s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0403, 'hit_ratio@10': 0.8158, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 3.2047}:  60%|██████    | 6/10 [00:13<00:11,  2.79s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0395, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 3.2826}:  60%|██████    | 6/10 [00:15<00:11,  2.79s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0395, 'hit_ratio@10': 0.8364, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 3.2826}:  70%|███████   | 7/10 [00:15<00:07,  2.50s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0412, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.1949}:  70%|███████   | 7/10 [00:18<00:07,  2.50s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0412, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.1949}:  80%|████████  | 8/10 [00:18<00:05,  2.54s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.042, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 3.4542}:  80%|████████  | 8/10 [00:21<00:05,  2.54s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.042, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 3.4542}:  90%|█████████ | 9/10 [00:21<00:02,  2.62s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0416, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.4384}:  90%|█████████ | 9/10 [00:24<00:02,  2.62s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0416, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.4384}: 100%|██████████| 10/10 [00:24<00:00,  2.85s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0416, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.4384}: 100%|██████████| 10/10 [00:24<00:00,  2.44s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04159629760012259
Avg hit ratio: 0.8529525352971872
Avg ndcg: 0.867551366882975
Avg compression ratio: 1.0
Avg train time: 3.438350701332092
Std train time: 1.8313896611930192
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0436, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 2.9538}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0436, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 2.9538}:  10%|█         | 1/10 [00:01<00:13,  1.52s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 2.615}:  10%|█         | 1/10 [00:03<00:13,  1.52s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 2.615}:  20%|██        | 2/10 [00:03<00:15,  1.99s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.6641, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 2.033}:  20%|██        | 2/10 [00:04<00:15,  1.99s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.6641, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 2.033}:  30%|███       | 3/10 [00:04<00:09,  1.29s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.7302, 'ndcg@10': 0.8879, 'compress@10': 1.0, 'time@10': 2.0272}:  30%|███       | 3/10 [00:06<00:09,  1.29s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.7302, 'ndcg@10': 0.8879, 'compress@10': 1.0, 'time@10': 2.0272}:  40%|████      | 4/10 [00:06<00:09,  1.59s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.7642, 'ndcg@10': 0.8837, 'compress@10': 1.0, 'time@10': 3.2057}:  40%|████      | 4/10 [00:10<00:09,  1.59s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0394, 'hit_ratio@10': 0.7642, 'ndcg@10': 0.8837, 'compress@10': 1.0, 'time@10': 3.2057}:  50%|█████     | 5/10 [00:10<00:12,  2.46s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0438, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.8738, 'compress@10': 1.0, 'time@10': 3.2676}:  50%|█████     | 5/10 [00:13<00:12,  2.46s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0438, 'hit_ratio@10': 0.7812, 'ndcg@10': 0.8738, 'compress@10': 1.0, 'time@10': 3.2676}:  60%|██████    | 6/10 [00:13<00:11,  2.85s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0426, 'hit_ratio@10': 0.8068, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 3.3364}:  60%|██████    | 6/10 [00:15<00:11,  2.85s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0426, 'hit_ratio@10': 0.8068, 'ndcg@10': 0.8775, 'compress@10': 1.0, 'time@10': 3.3364}:  70%|███████   | 7/10 [00:15<00:07,  2.55s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0423, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8757, 'compress@10': 1.0, 'time@10': 3.2424}:  70%|███████   | 7/10 [00:18<00:07,  2.55s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0423, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8757, 'compress@10': 1.0, 'time@10': 3.2424}:  80%|████████  | 8/10 [00:18<00:05,  2.57s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0419, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8835, 'compress@10': 1.0, 'time@10': 3.4603}:  80%|████████  | 8/10 [00:21<00:05,  2.57s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0419, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8835, 'compress@10': 1.0, 'time@10': 3.4603}:  90%|█████████ | 9/10 [00:21<00:02,  2.59s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 3.4361}:  90%|█████████ | 9/10 [00:25<00:02,  2.59s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 3.4361}: 100%|██████████| 10/10 [00:25<00:00,  3.04s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8813, 'compress@10': 1.0, 'time@10': 3.4361}: 100%|██████████| 10/10 [00:25<00:00,  2.52s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04278352964565546
Avg hit ratio: 0.8265009223939614
Avg ndcg: 0.8813379337777288
Avg compression ratio: 1.0
Avg train time: 3.4361151456832886
Std train time: 1.8524724925126237
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8478, 'compress@10': 1.0, 'time@10': 2.738}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8478, 'compress@10': 1.0, 'time@10': 2.738}:  10%|█         | 1/10 [00:01<00:12,  1.41s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8807, 'compress@10': 1.0, 'time@10': 2.5505}:  10%|█         | 1/10 [00:03<00:12,  1.41s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8807, 'compress@10': 1.0, 'time@10': 2.5505}:  20%|██        | 2/10 [00:03<00:15,  1.99s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.6816, 'ndcg@10': 0.8707, 'compress@10': 1.0, 'time@10': 2.005}:  20%|██        | 2/10 [00:04<00:15,  1.99s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0235, 'hit_ratio@10': 0.6816, 'ndcg@10': 0.8707, 'compress@10': 1.0, 'time@10': 2.005}:  30%|███       | 3/10 [00:04<00:09,  1.31s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.7434, 'ndcg@10': 0.893, 'compress@10': 1.0, 'time@10': 2.0141}:  30%|███       | 3/10 [00:06<00:09,  1.31s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0309, 'hit_ratio@10': 0.7434, 'ndcg@10': 0.893, 'compress@10': 1.0, 'time@10': 2.0141}:  40%|████      | 4/10 [00:06<00:09,  1.61s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0351, 'hit_ratio@10': 0.7787, 'ndcg@10': 0.8926, 'compress@10': 1.0, 'time@10': 3.1662}:  40%|████      | 4/10 [00:10<00:09,  1.61s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0351, 'hit_ratio@10': 0.7787, 'ndcg@10': 0.8926, 'compress@10': 1.0, 'time@10': 3.1662}:  50%|█████     | 5/10 [00:10<00:12,  2.45s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0347, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 3.2117}:  50%|█████     | 5/10 [00:13<00:12,  2.45s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0347, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8906, 'compress@10': 1.0, 'time@10': 3.2117}:  60%|██████    | 6/10 [00:13<00:11,  2.80s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0359, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8828, 'compress@10': 1.0, 'time@10': 3.2955}:  60%|██████    | 6/10 [00:15<00:11,  2.80s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0359, 'hit_ratio@10': 0.8235, 'ndcg@10': 0.8828, 'compress@10': 1.0, 'time@10': 3.2955}:  70%|███████   | 7/10 [00:15<00:07,  2.52s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0336, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 3.2241}:  70%|███████   | 7/10 [00:18<00:07,  2.52s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0336, 'hit_ratio@10': 0.8384, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 3.2241}:  80%|████████  | 8/10 [00:18<00:05,  2.60s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0325, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.4655}:  80%|████████  | 8/10 [00:21<00:05,  2.60s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0325, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 3.4655}:  90%|█████████ | 9/10 [00:21<00:02,  2.64s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0313, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 3.4534}:  90%|█████████ | 9/10 [00:24<00:02,  2.64s/it]    {'epoch': 7, 'num_users': 6.3, 'loss': 0.0313, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 3.4534}: 100%|██████████| 10/10 [00:24<00:00,  2.87s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0313, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 3.4534}: 100%|██████████| 10/10 [00:24<00:00,  2.46s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.03133700556074383
Avg hit ratio: 0.8319098234344414
Avg ndcg: 0.8939657832149475
Avg compression ratio: 1.0
Avg train time: 3.453417730331421
Std train time: 1.823614842194517
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.033, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8709, 'compress@10': 1.0, 'time@10': 2.9108}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.033, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8709, 'compress@10': 1.0, 'time@10': 2.9108}:  10%|█         | 1/10 [00:01<00:13,  1.49s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 2.6244}:  10%|█         | 1/10 [00:03<00:13,  1.49s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8939, 'compress@10': 1.0, 'time@10': 2.6244}:  20%|██        | 2/10 [00:03<00:16,  2.01s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.6924, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 2.0429}:  20%|██        | 2/10 [00:04<00:16,  2.01s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.6924, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 2.0429}:  30%|███       | 3/10 [00:04<00:09,  1.31s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.7514, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 2.0461}:  30%|███       | 3/10 [00:06<00:09,  1.31s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0268, 'hit_ratio@10': 0.7514, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 2.0461}:  40%|████      | 4/10 [00:06<00:09,  1.62s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0323, 'hit_ratio@10': 0.7891, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 3.2358}:  40%|████      | 4/10 [00:10<00:09,  1.62s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0323, 'hit_ratio@10': 0.7891, 'ndcg@10': 0.8955, 'compress@10': 1.0, 'time@10': 3.2358}:  50%|█████     | 5/10 [00:10<00:12,  2.50s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0379, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 3.2591}:  50%|█████     | 5/10 [00:13<00:12,  2.50s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0379, 'hit_ratio@10': 0.8095, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 3.2591}:  60%|██████    | 6/10 [00:13<00:11,  2.81s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.037, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8978, 'compress@10': 1.0, 'time@10': 3.3229}:  60%|██████    | 6/10 [00:15<00:11,  2.81s/it] {'epoch': 8, 'num_users': 6.2857, 'loss': 0.037, 'hit_ratio@10': 0.831, 'ndcg@10': 0.8978, 'compress@10': 1.0, 'time@10': 3.3229}:  70%|███████   | 7/10 [00:15<00:07,  2.51s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0365, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 3.233}:  70%|███████   | 7/10 [00:18<00:07,  2.51s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0365, 'hit_ratio@10': 0.845, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 3.233}:  80%|████████  | 8/10 [00:18<00:05,  2.55s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0416, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9134, 'compress@10': 1.0, 'time@10': 3.4624}:  80%|████████  | 8/10 [00:21<00:05,  2.55s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0416, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9134, 'compress@10': 1.0, 'time@10': 3.4624}:  90%|█████████ | 9/10 [00:21<00:02,  2.59s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 3.4477}:  90%|█████████ | 9/10 [00:24<00:02,  2.59s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 3.4477}: 100%|██████████| 10/10 [00:24<00:00,  2.83s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0427, 'hit_ratio@10': 0.8508, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 3.4477}: 100%|██████████| 10/10 [00:24<00:00,  2.45s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04270850561154368
Avg hit ratio: 0.8508369285873529
Avg ndcg: 0.9066821838190815
Avg compression ratio: 1.0
Avg train time: 3.4477410554885863
Std train time: 1.8694656503144835
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8789, 'compress@10': 1.0, 'time@10': 2.7909}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8789, 'compress@10': 1.0, 'time@10': 2.7909}:  10%|█         | 1/10 [00:01<00:12,  1.44s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9014, 'compress@10': 1.0, 'time@10': 2.5587}:  10%|█         | 1/10 [00:03<00:12,  1.44s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0289, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9014, 'compress@10': 1.0, 'time@10': 2.5587}:  20%|██        | 2/10 [00:03<00:15,  1.98s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.8845, 'compress@10': 1.0, 'time@10': 1.992}:  20%|██        | 2/10 [00:04<00:15,  1.98s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.8845, 'compress@10': 1.0, 'time@10': 1.992}:  30%|███       | 3/10 [00:04<00:09,  1.29s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0273, 'hit_ratio@10': 0.7952, 'ndcg@10': 0.899, 'compress@10': 1.0, 'time@10': 2.0111}:  30%|███       | 3/10 [00:06<00:09,  1.29s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0273, 'hit_ratio@10': 0.7952, 'ndcg@10': 0.899, 'compress@10': 1.0, 'time@10': 2.0111}:  40%|████      | 4/10 [00:06<00:09,  1.61s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 3.2082}:  40%|████      | 4/10 [00:10<00:09,  1.61s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0308, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 3.2082}:  50%|█████     | 5/10 [00:10<00:12,  2.49s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0311, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9004, 'compress@10': 1.0, 'time@10': 3.2455}:  50%|█████     | 5/10 [00:13<00:12,  2.49s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0311, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9004, 'compress@10': 1.0, 'time@10': 3.2455}:  60%|██████    | 6/10 [00:13<00:11,  2.83s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0328, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8928, 'compress@10': 1.0, 'time@10': 3.3305}:  60%|██████    | 6/10 [00:15<00:11,  2.83s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0328, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8928, 'compress@10': 1.0, 'time@10': 3.3305}:  70%|███████   | 7/10 [00:15<00:07,  2.54s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0306, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.899, 'compress@10': 1.0, 'time@10': 3.2356}:  70%|███████   | 7/10 [00:18<00:07,  2.54s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0306, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.899, 'compress@10': 1.0, 'time@10': 3.2356}:  80%|████████  | 8/10 [00:18<00:05,  2.56s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0326, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9118, 'compress@10': 1.0, 'time@10': 3.4666}:  80%|████████  | 8/10 [00:21<00:05,  2.56s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0326, 'hit_ratio@10': 0.8605, 'ndcg@10': 0.9118, 'compress@10': 1.0, 'time@10': 3.4666}:  90%|█████████ | 9/10 [00:21<00:02,  2.60s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9092, 'compress@10': 1.0, 'time@10': 3.4456}:  90%|█████████ | 9/10 [00:24<00:02,  2.60s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9092, 'compress@10': 1.0, 'time@10': 3.4456}: 100%|██████████| 10/10 [00:24<00:00,  2.82s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0324, 'hit_ratio@10': 0.8699, 'ndcg@10': 0.9092, 'compress@10': 1.0, 'time@10': 3.4456}: 100%|██████████| 10/10 [00:24<00:00,  2.45s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03243645266526437
Avg hit ratio: 0.8698852458614768
Avg ndcg: 0.9092403617080761
Avg compression ratio: 1.0
Avg train time: 3.4456430673599243
Std train time: 1.8823399403327281
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 2.8037}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 2.8037}:  10%|█         | 1/10 [00:01<00:12,  1.44s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0275, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9133, 'compress@10': 1.0, 'time@10': 2.6095}:  10%|█         | 1/10 [00:03<00:12,  1.44s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0275, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9133, 'compress@10': 1.0, 'time@10': 2.6095}:  20%|██        | 2/10 [00:03<00:16,  2.03s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 2.0434}:  20%|██        | 2/10 [00:04<00:16,  2.03s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0198, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 2.0434}:  30%|███       | 3/10 [00:04<00:09,  1.33s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 2.047}:  30%|███       | 3/10 [00:06<00:09,  1.33s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 2.047}:  40%|████      | 4/10 [00:06<00:09,  1.63s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.9083, 'compress@10': 1.0, 'time@10': 3.1876}:  40%|████      | 4/10 [00:10<00:09,  1.63s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.9083, 'compress@10': 1.0, 'time@10': 3.1876}:  50%|█████     | 5/10 [00:10<00:12,  2.46s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0339, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.907, 'compress@10': 1.0, 'time@10': 3.2333}:  50%|█████     | 5/10 [00:13<00:12,  2.46s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0339, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.907, 'compress@10': 1.0, 'time@10': 3.2333}:  60%|██████    | 6/10 [00:13<00:11,  2.81s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0326, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 3.3223}:  60%|██████    | 6/10 [00:15<00:11,  2.81s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0326, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 3.3223}:  70%|███████   | 7/10 [00:15<00:07,  2.53s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0321, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 3.2248}:  70%|███████   | 7/10 [00:18<00:07,  2.53s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0321, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 3.2248}:  80%|████████  | 8/10 [00:18<00:05,  2.55s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0345, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 3.4607}:  80%|████████  | 8/10 [00:21<00:05,  2.55s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0345, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 3.4607}:  90%|█████████ | 9/10 [00:21<00:02,  2.60s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0335, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8993, 'compress@10': 1.0, 'time@10': 3.4632}:  90%|█████████ | 9/10 [00:24<00:02,  2.60s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0335, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8993, 'compress@10': 1.0, 'time@10': 3.4632}: 100%|██████████| 10/10 [00:24<00:00,  2.89s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0335, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.8993, 'compress@10': 1.0, 'time@10': 3.4632}: 100%|██████████| 10/10 [00:24<00:00,  2.47s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.0334612385270093
Avg hit ratio: 0.8826341636103946
Avg ndcg: 0.8993188380972459
Avg compression ratio: 1.0
Avg train time: 3.4632456064224244
Std train time: 1.815291465367904
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9038, 'compress@10': 1.0, 'time@10': 3.1611}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9038, 'compress@10': 1.0, 'time@10': 3.1611}:  10%|█         | 1/10 [00:01<00:15,  1.76s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0309, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 2.7642}:  10%|█         | 1/10 [00:04<00:15,  1.76s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0309, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 2.7642}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 2.1495}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0222, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.8885, 'compress@10': 1.0, 'time@10': 2.1495}:  30%|███       | 3/10 [00:04<00:09,  1.39s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.7952, 'ndcg@10': 0.8962, 'compress@10': 1.0, 'time@10': 2.1369}:  30%|███       | 3/10 [00:06<00:09,  1.39s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.7952, 'ndcg@10': 0.8962, 'compress@10': 1.0, 'time@10': 2.1369}:  40%|████      | 4/10 [00:06<00:10,  1.69s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8996, 'compress@10': 1.0, 'time@10': 3.2727}:  40%|████      | 4/10 [00:10<00:10,  1.69s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8996, 'compress@10': 1.0, 'time@10': 3.2727}:  50%|█████     | 5/10 [00:10<00:12,  2.50s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0278, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 3.3064}:  50%|█████     | 5/10 [00:14<00:12,  2.50s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0278, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 3.3064}:  60%|██████    | 6/10 [00:14<00:11,  2.84s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0281, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.3692}:  60%|██████    | 6/10 [00:16<00:11,  2.84s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0281, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 3.3692}:  70%|███████   | 7/10 [00:16<00:07,  2.54s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0288, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9051, 'compress@10': 1.0, 'time@10': 3.2695}:  70%|███████   | 7/10 [00:18<00:07,  2.54s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0288, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9051, 'compress@10': 1.0, 'time@10': 3.2695}:  80%|████████  | 8/10 [00:18<00:05,  2.56s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.028, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9109, 'compress@10': 1.0, 'time@10': 3.4894}:  80%|████████  | 8/10 [00:21<00:05,  2.56s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.028, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9109, 'compress@10': 1.0, 'time@10': 3.4894}:  90%|█████████ | 9/10 [00:21<00:02,  2.60s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 3.4717}:  90%|█████████ | 9/10 [00:24<00:02,  2.60s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 3.4717}: 100%|██████████| 10/10 [00:24<00:00,  2.83s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0294, 'hit_ratio@10': 0.875, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 3.4717}: 100%|██████████| 10/10 [00:24<00:00,  2.48s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.029359659576249558
Avg hit ratio: 0.875015115991347
Avg ndcg: 0.9066522608224494
Avg compression ratio: 1.0
Avg train time: 3.4717408418655396
Std train time: 1.806968132936954
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 2.8016}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.897, 'compress@10': 1.0, 'time@10': 2.8016}:  10%|█         | 1/10 [00:01<00:12,  1.44s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.896, 'compress@10': 1.0, 'time@10': 2.6184}:  10%|█         | 1/10 [00:03<00:12,  1.44s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0315, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.896, 'compress@10': 1.0, 'time@10': 2.6184}:  20%|██        | 2/10 [00:03<00:16,  2.05s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 2.0372}:  20%|██        | 2/10 [00:04<00:16,  2.05s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0225, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 2.0372}:  30%|███       | 3/10 [00:04<00:09,  1.33s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0273, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8976, 'compress@10': 1.0, 'time@10': 2.0444}:  30%|███       | 3/10 [00:06<00:09,  1.33s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0273, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8976, 'compress@10': 1.0, 'time@10': 2.0444}:  40%|████      | 4/10 [00:06<00:09,  1.63s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0297, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.9021, 'compress@10': 1.0, 'time@10': 3.1947}:  40%|████      | 4/10 [00:10<00:09,  1.63s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0297, 'hit_ratio@10': 0.8527, 'ndcg@10': 0.9021, 'compress@10': 1.0, 'time@10': 3.1947}:  50%|█████     | 5/10 [00:10<00:12,  2.46s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0336, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.2363}:  50%|█████     | 5/10 [00:13<00:12,  2.46s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0336, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.2363}:  60%|██████    | 6/10 [00:13<00:11,  2.81s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0339, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.8985, 'compress@10': 1.0, 'time@10': 3.2998}:  60%|██████    | 6/10 [00:15<00:11,  2.81s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0339, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.8985, 'compress@10': 1.0, 'time@10': 3.2998}:  70%|███████   | 7/10 [00:15<00:07,  2.51s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.032, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9036, 'compress@10': 1.0, 'time@10': 3.2129}:  70%|███████   | 7/10 [00:18<00:07,  2.51s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.032, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9036, 'compress@10': 1.0, 'time@10': 3.2129}:  80%|████████  | 8/10 [00:18<00:05,  2.55s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0304, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9073, 'compress@10': 1.0, 'time@10': 3.4686}:  80%|████████  | 8/10 [00:21<00:05,  2.55s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0304, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9073, 'compress@10': 1.0, 'time@10': 3.4686}:  90%|█████████ | 9/10 [00:21<00:02,  2.63s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0284, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9123, 'compress@10': 1.0, 'time@10': 3.4585}:  90%|█████████ | 9/10 [00:24<00:02,  2.63s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0284, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9123, 'compress@10': 1.0, 'time@10': 3.4585}: 100%|██████████| 10/10 [00:24<00:00,  2.87s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0284, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9123, 'compress@10': 1.0, 'time@10': 3.4585}: 100%|██████████| 10/10 [00:24<00:00,  2.46s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.028367799602431232
Avg hit ratio: 0.8934278144040453
Avg ndcg: 0.9122724057488452
Avg compression ratio: 1.0
Avg train time: 3.4584961891174317
Std train time: 1.8417857364999854
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8992, 'compress@10': 1.0, 'time@10': 2.8624}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8992, 'compress@10': 1.0, 'time@10': 2.8624}:  10%|█         | 1/10 [00:01<00:13,  1.47s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 2.6151}:  10%|█         | 1/10 [00:03<00:13,  1.47s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0366, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 2.6151}:  20%|██        | 2/10 [00:03<00:16,  2.03s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.7769, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 2.0287}:  20%|██        | 2/10 [00:04<00:16,  2.03s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.7769, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 2.0287}:  30%|███       | 3/10 [00:04<00:09,  1.31s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 2.0465}:  30%|███       | 3/10 [00:06<00:09,  1.31s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 2.0465}:  40%|████      | 4/10 [00:06<00:09,  1.64s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.851, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 3.1639}:  40%|████      | 4/10 [00:10<00:09,  1.64s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0288, 'hit_ratio@10': 0.851, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 3.1639}:  50%|█████     | 5/10 [00:10<00:12,  2.44s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9076, 'compress@10': 1.0, 'time@10': 3.2113}:  50%|█████     | 5/10 [00:13<00:12,  2.44s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9076, 'compress@10': 1.0, 'time@10': 3.2113}:  60%|██████    | 6/10 [00:13<00:11,  2.80s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9068, 'compress@10': 1.0, 'time@10': 3.2786}:  60%|██████    | 6/10 [00:15<00:11,  2.80s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9068, 'compress@10': 1.0, 'time@10': 3.2786}:  70%|███████   | 7/10 [00:15<00:07,  2.50s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0335, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 3.1883}:  70%|███████   | 7/10 [00:18<00:07,  2.50s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0335, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 3.1883}:  80%|████████  | 8/10 [00:18<00:05,  2.53s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0388, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9224, 'compress@10': 1.0, 'time@10': 3.435}:  80%|████████  | 8/10 [00:21<00:05,  2.53s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0388, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9224, 'compress@10': 1.0, 'time@10': 3.435}:  90%|█████████ | 9/10 [00:21<00:02,  2.65s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0389, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9182, 'compress@10': 1.0, 'time@10': 3.4273}:  90%|█████████ | 9/10 [00:24<00:02,  2.65s/it]  {'epoch': 13, 'num_users': 6.3, 'loss': 0.0389, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9182, 'compress@10': 1.0, 'time@10': 3.4273}: 100%|██████████| 10/10 [00:24<00:00,  2.88s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0389, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9182, 'compress@10': 1.0, 'time@10': 3.4273}: 100%|██████████| 10/10 [00:24<00:00,  2.46s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03891996650116899
Avg hit ratio: 0.8912777888024068
Avg ndcg: 0.9182483727895947
Avg compression ratio: 1.0
Avg train time: 3.427315092086792
Std train time: 1.7962061415833088
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 2.8791}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 2.8791}:  10%|█         | 1/10 [00:01<00:13,  1.48s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9467, 'compress@10': 1.0, 'time@10': 2.5897}:  10%|█         | 1/10 [00:03<00:13,  1.48s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9467, 'compress@10': 1.0, 'time@10': 2.5897}:  20%|██        | 2/10 [00:03<00:15,  1.99s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 2.0236}:  20%|██        | 2/10 [00:04<00:15,  1.99s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 2.0236}:  30%|███       | 3/10 [00:04<00:09,  1.30s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 2.0387}:  30%|███       | 3/10 [00:06<00:09,  1.30s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 2.0387}:  40%|████      | 4/10 [00:06<00:09,  1.63s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 3.1833}:  40%|████      | 4/10 [00:10<00:09,  1.63s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 3.1833}:  50%|█████     | 5/10 [00:10<00:12,  2.45s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9208, 'compress@10': 1.0, 'time@10': 3.232}:  50%|█████     | 5/10 [00:13<00:12,  2.45s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.9208, 'compress@10': 1.0, 'time@10': 3.232}:  60%|██████    | 6/10 [00:13<00:11,  2.81s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0263, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9199, 'compress@10': 1.0, 'time@10': 3.3279}:  60%|██████    | 6/10 [00:15<00:11,  2.81s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0263, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9199, 'compress@10': 1.0, 'time@10': 3.3279}:  70%|███████   | 7/10 [00:15<00:07,  2.54s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0258, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.922, 'compress@10': 1.0, 'time@10': 3.2322}:  70%|███████   | 7/10 [00:18<00:07,  2.54s/it]  {'epoch': 14, 'num_users': 6.125, 'loss': 0.0258, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.922, 'compress@10': 1.0, 'time@10': 3.2322}:  80%|████████  | 8/10 [00:18<00:05,  2.57s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9369, 'compress@10': 1.0, 'time@10': 3.4725}:  80%|████████  | 8/10 [00:21<00:05,  2.57s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9369, 'compress@10': 1.0, 'time@10': 3.4725}:  90%|█████████ | 9/10 [00:21<00:02,  2.62s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.026, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9387, 'compress@10': 1.0, 'time@10': 3.4608}:  90%|█████████ | 9/10 [00:24<00:02,  2.62s/it]    {'epoch': 14, 'num_users': 6.3, 'loss': 0.026, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9387, 'compress@10': 1.0, 'time@10': 3.4608}: 100%|██████████| 10/10 [00:24<00:00,  2.86s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.026, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9387, 'compress@10': 1.0, 'time@10': 3.4608}: 100%|██████████| 10/10 [00:24<00:00,  2.46s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.025973307415293308
Avg hit ratio: 0.890932166682591
Avg ndcg: 0.9386667636760551
Avg compression ratio: 1.0
Avg train time: 3.4607940435409548
Std train time: 1.8285437155723425
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 2.6413}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 2.6413}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9087, 'compress@10': 1.0, 'time@10': 2.4331}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9087, 'compress@10': 1.0, 'time@10': 2.4331}:  20%|██        | 2/10 [00:03<00:15,  1.89s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8893, 'compress@10': 1.0, 'time@10': 1.8994}:  20%|██        | 2/10 [00:04<00:15,  1.89s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8893, 'compress@10': 1.0, 'time@10': 1.8994}:  30%|███       | 3/10 [00:04<00:08,  1.23s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 1.9071}:  30%|███       | 3/10 [00:06<00:08,  1.23s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 1.9071}:  40%|████      | 4/10 [00:06<00:09,  1.52s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.025, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 3.0668}:  40%|████      | 4/10 [00:09<00:09,  1.52s/it] {'epoch': 15, 'num_users': 5.8, 'loss': 0.025, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 3.0668}:  50%|█████     | 5/10 [00:09<00:11,  2.38s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0286, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 3.1196}:  50%|█████     | 5/10 [00:13<00:11,  2.38s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0286, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 3.1196}:  60%|██████    | 6/10 [00:13<00:10,  2.74s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0297, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9111, 'compress@10': 1.0, 'time@10': 3.1784}:  60%|██████    | 6/10 [00:15<00:10,  2.74s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0297, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9111, 'compress@10': 1.0, 'time@10': 3.1784}:  70%|███████   | 7/10 [00:15<00:07,  2.44s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0337, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9324, 'compress@10': 1.0, 'time@10': 3.0819}:  70%|███████   | 7/10 [00:17<00:07,  2.44s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0337, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9324, 'compress@10': 1.0, 'time@10': 3.0819}:  80%|████████  | 8/10 [00:17<00:04,  2.44s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0347, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9296, 'compress@10': 1.0, 'time@10': 3.3201}:  80%|████████  | 8/10 [00:20<00:04,  2.44s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0347, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9296, 'compress@10': 1.0, 'time@10': 3.3201}:  90%|█████████ | 9/10 [00:20<00:02,  2.50s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9265, 'compress@10': 1.0, 'time@10': 3.3122}:  90%|█████████ | 9/10 [00:23<00:02,  2.50s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9265, 'compress@10': 1.0, 'time@10': 3.3122}: 100%|██████████| 10/10 [00:23<00:00,  2.75s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.035, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9265, 'compress@10': 1.0, 'time@10': 3.3122}: 100%|██████████| 10/10 [00:23<00:00,  2.36s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.03501001913209918
Avg hit ratio: 0.8913008302770612
Avg ndcg: 0.9265111868437014
Avg compression ratio: 1.0
Avg train time: 3.3121751070022585
Std train time: 1.8312890038250131
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9059, 'compress@10': 1.0, 'time@10': 2.6326}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0258, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9059, 'compress@10': 1.0, 'time@10': 2.6326}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.034, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9749, 'compress@10': 1.0, 'time@10': 2.4691}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it] {'epoch': 16, 'num_users': 7.0, 'loss': 0.034, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9749, 'compress@10': 1.0, 'time@10': 2.4691}:  20%|██        | 2/10 [00:03<00:15,  1.97s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9335, 'compress@10': 1.0, 'time@10': 1.9248}:  20%|██        | 2/10 [00:04<00:15,  1.97s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9335, 'compress@10': 1.0, 'time@10': 1.9248}:  30%|███       | 3/10 [00:04<00:09,  1.29s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9356, 'compress@10': 1.0, 'time@10': 1.959}:  30%|███       | 3/10 [00:06<00:09,  1.29s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9356, 'compress@10': 1.0, 'time@10': 1.959}:  40%|████      | 4/10 [00:06<00:09,  1.61s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.9332, 'compress@10': 1.0, 'time@10': 3.1131}:  40%|████      | 4/10 [00:10<00:09,  1.61s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.9332, 'compress@10': 1.0, 'time@10': 3.1131}:  50%|█████     | 5/10 [00:10<00:12,  2.44s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0253, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9305, 'compress@10': 1.0, 'time@10': 3.1585}:  50%|█████     | 5/10 [00:13<00:12,  2.44s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0253, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9305, 'compress@10': 1.0, 'time@10': 3.1585}:  60%|██████    | 6/10 [00:13<00:11,  2.77s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0261, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9233, 'compress@10': 1.0, 'time@10': 3.198}:  60%|██████    | 6/10 [00:15<00:11,  2.77s/it] {'epoch': 16, 'num_users': 6.2857, 'loss': 0.0261, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9233, 'compress@10': 1.0, 'time@10': 3.198}:  70%|███████   | 7/10 [00:15<00:07,  2.57s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0257, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9265, 'compress@10': 1.0, 'time@10': 3.1131}:  70%|███████   | 7/10 [00:18<00:07,  2.57s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0257, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9265, 'compress@10': 1.0, 'time@10': 3.1131}:  80%|████████  | 8/10 [00:18<00:05,  2.57s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9209, 'compress@10': 1.0, 'time@10': 3.3598}:  80%|████████  | 8/10 [00:21<00:05,  2.57s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9209, 'compress@10': 1.0, 'time@10': 3.3598}:  90%|█████████ | 9/10 [00:21<00:02,  2.61s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0258, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9227, 'compress@10': 1.0, 'time@10': 3.3639}:  90%|█████████ | 9/10 [00:24<00:02,  2.61s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0258, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9227, 'compress@10': 1.0, 'time@10': 3.3639}: 100%|██████████| 10/10 [00:24<00:00,  2.87s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0258, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9227, 'compress@10': 1.0, 'time@10': 3.3639}: 100%|██████████| 10/10 [00:24<00:00,  2.46s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.025756020928965152
Avg hit ratio: 0.8945035952540197
Avg ndcg: 0.9227449638383464
Avg compression ratio: 1.0
Avg train time: 3.3638519525527952
Std train time: 1.8275856606324068
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9041, 'compress@10': 1.0, 'time@10': 2.912}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9041, 'compress@10': 1.0, 'time@10': 2.912}:  10%|█         | 1/10 [00:01<00:13,  1.49s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9171, 'compress@10': 1.0, 'time@10': 2.6569}:  10%|█         | 1/10 [00:03<00:13,  1.49s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9171, 'compress@10': 1.0, 'time@10': 2.6569}:  20%|██        | 2/10 [00:03<00:16,  2.06s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 2.0761}:  20%|██        | 2/10 [00:04<00:16,  2.06s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.895, 'compress@10': 1.0, 'time@10': 2.0761}:  30%|███       | 3/10 [00:04<00:09,  1.35s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 2.0728}:  30%|███       | 3/10 [00:06<00:09,  1.35s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 2.0728}:  40%|████      | 4/10 [00:06<00:09,  1.65s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0215, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.9086, 'compress@10': 1.0, 'time@10': 3.1573}:  40%|████      | 4/10 [00:10<00:09,  1.65s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0215, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.9086, 'compress@10': 1.0, 'time@10': 3.1573}:  50%|█████     | 5/10 [00:10<00:12,  2.42s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0222, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9124, 'compress@10': 1.0, 'time@10': 3.2098}:  50%|█████     | 5/10 [00:13<00:12,  2.42s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0222, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9124, 'compress@10': 1.0, 'time@10': 3.2098}:  60%|██████    | 6/10 [00:13<00:11,  2.79s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9158, 'compress@10': 1.0, 'time@10': 3.2641}:  60%|██████    | 6/10 [00:15<00:11,  2.79s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0211, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9158, 'compress@10': 1.0, 'time@10': 3.2641}:  70%|███████   | 7/10 [00:15<00:07,  2.48s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0212, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 3.1747}:  70%|███████   | 7/10 [00:18<00:07,  2.48s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 0.0212, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 3.1747}:  80%|████████  | 8/10 [00:18<00:05,  2.52s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9228, 'compress@10': 1.0, 'time@10': 3.3933}:  80%|████████  | 8/10 [00:20<00:05,  2.52s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9228, 'compress@10': 1.0, 'time@10': 3.3933}:  90%|█████████ | 9/10 [00:20<00:02,  2.55s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9269, 'compress@10': 1.0, 'time@10': 3.3741}:  90%|█████████ | 9/10 [00:24<00:02,  2.55s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9269, 'compress@10': 1.0, 'time@10': 3.3741}: 100%|██████████| 10/10 [00:24<00:00,  2.76s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0192, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9269, 'compress@10': 1.0, 'time@10': 3.3741}: 100%|██████████| 10/10 [00:24<00:00,  2.41s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.01924204582835547
Avg hit ratio: 0.888789309539734
Avg ndcg: 0.9269095691345619
Avg compression ratio: 1.0
Avg train time: 3.3741140365600586
Std train time: 1.7264377766289734
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9059, 'compress@10': 1.0, 'time@10': 2.791}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.026, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9059, 'compress@10': 1.0, 'time@10': 2.791}:  10%|█         | 1/10 [00:01<00:12,  1.43s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0246, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 2.5028}:  10%|█         | 1/10 [00:03<00:12,  1.43s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0246, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 2.5028}:  20%|██        | 2/10 [00:03<00:15,  1.91s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.7769, 'ndcg@10': 0.9075, 'compress@10': 1.0, 'time@10': 1.952}:  20%|██        | 2/10 [00:04<00:15,  1.91s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0184, 'hit_ratio@10': 0.7769, 'ndcg@10': 0.9075, 'compress@10': 1.0, 'time@10': 1.952}:  30%|███       | 3/10 [00:04<00:08,  1.25s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 1.9606}:  30%|███       | 3/10 [00:06<00:08,  1.25s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 1.9606}:  40%|████      | 4/10 [00:06<00:09,  1.56s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0264, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 3.0826}:  40%|████      | 4/10 [00:09<00:09,  1.56s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0264, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 3.0826}:  50%|█████     | 5/10 [00:09<00:11,  2.37s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0289, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.906, 'compress@10': 1.0, 'time@10': 3.1445}:  50%|█████     | 5/10 [00:13<00:11,  2.37s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0289, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.906, 'compress@10': 1.0, 'time@10': 3.1445}:  60%|██████    | 6/10 [00:13<00:11,  2.75s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0282, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9082, 'compress@10': 1.0, 'time@10': 3.1957}:  60%|██████    | 6/10 [00:15<00:11,  2.75s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0282, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.9082, 'compress@10': 1.0, 'time@10': 3.1957}:  70%|███████   | 7/10 [00:15<00:07,  2.44s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9107, 'compress@10': 1.0, 'time@10': 3.1246}:  70%|███████   | 7/10 [00:17<00:07,  2.44s/it]   {'epoch': 18, 'num_users': 6.125, 'loss': 0.0279, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9107, 'compress@10': 1.0, 'time@10': 3.1246}:  80%|████████  | 8/10 [00:17<00:05,  2.51s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9151, 'compress@10': 1.0, 'time@10': 3.3955}:  80%|████████  | 8/10 [00:20<00:05,  2.51s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.8736, 'ndcg@10': 0.9151, 'compress@10': 1.0, 'time@10': 3.3955}:  90%|█████████ | 9/10 [00:20<00:02,  2.61s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9133, 'compress@10': 1.0, 'time@10': 3.3843}:  90%|█████████ | 9/10 [00:24<00:02,  2.61s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9133, 'compress@10': 1.0, 'time@10': 3.3843}: 100%|██████████| 10/10 [00:24<00:00,  2.83s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9133, 'compress@10': 1.0, 'time@10': 3.3843}: 100%|██████████| 10/10 [00:24<00:00,  2.41s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.026845257592115847
Avg hit ratio: 0.8839920745166925
Avg ndcg: 0.9133328859286409
Avg compression ratio: 1.0
Avg train time: 3.3842599868774412
Std train time: 1.815810481726591
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9041, 'compress@10': 1.0, 'time@10': 2.8306}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9041, 'compress@10': 1.0, 'time@10': 2.8306}:  10%|█         | 1/10 [00:01<00:13,  1.45s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9254, 'compress@10': 1.0, 'time@10': 2.4992}:  10%|█         | 1/10 [00:03<00:13,  1.45s/it]  {'epoch': 19, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9254, 'compress@10': 1.0, 'time@10': 2.4992}:  20%|██        | 2/10 [00:03<00:15,  1.89s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 1.9472}:  20%|██        | 2/10 [00:04<00:15,  1.89s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 1.9472}:  30%|███       | 3/10 [00:04<00:08,  1.24s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9139, 'compress@10': 1.0, 'time@10': 1.9504}:  30%|███       | 3/10 [00:06<00:08,  1.24s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9139, 'compress@10': 1.0, 'time@10': 1.9504}:  40%|████      | 4/10 [00:06<00:09,  1.54s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.9153, 'compress@10': 1.0, 'time@10': 3.1179}:  40%|████      | 4/10 [00:10<00:09,  1.54s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.9153, 'compress@10': 1.0, 'time@10': 3.1179}:  50%|█████     | 5/10 [00:10<00:12,  2.40s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0173, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 3.1704}:  50%|█████     | 5/10 [00:13<00:12,  2.40s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0173, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 3.1704}:  60%|██████    | 6/10 [00:13<00:11,  2.77s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9169, 'compress@10': 1.0, 'time@10': 3.2609}:  60%|██████    | 6/10 [00:15<00:11,  2.77s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9169, 'compress@10': 1.0, 'time@10': 3.2609}:  70%|███████   | 7/10 [00:15<00:07,  2.50s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9201, 'compress@10': 1.0, 'time@10': 3.1644}:  70%|███████   | 7/10 [00:17<00:07,  2.50s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9201, 'compress@10': 1.0, 'time@10': 3.1644}:  80%|████████  | 8/10 [00:17<00:05,  2.51s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9415, 'compress@10': 1.0, 'time@10': 3.3907}:  80%|████████  | 8/10 [00:20<00:05,  2.51s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9415, 'compress@10': 1.0, 'time@10': 3.3907}:  90%|█████████ | 9/10 [00:20<00:02,  2.55s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9446, 'compress@10': 1.0, 'time@10': 3.3726}:  90%|█████████ | 9/10 [00:23<00:02,  2.55s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9446, 'compress@10': 1.0, 'time@10': 3.3726}: 100%|██████████| 10/10 [00:23<00:00,  2.77s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0203, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9446, 'compress@10': 1.0, 'time@10': 3.3726}: 100%|██████████| 10/10 [00:23<00:00,  2.39s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.020286431942256492
Avg hit ratio: 0.8945035952540197
Avg ndcg: 0.9446422284473985
Avg compression ratio: 1.0
Avg train time: 3.372554302215576
Std train time: 1.8432436496760614
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9041, 'compress@10': 1.0, 'time@10': 2.6197}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0222, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9041, 'compress@10': 1.0, 'time@10': 2.6197}:  10%|█         | 1/10 [00:01<00:12,  1.35s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9288, 'compress@10': 1.0, 'time@10': 2.4248}:  10%|█         | 1/10 [00:03<00:12,  1.35s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9288, 'compress@10': 1.0, 'time@10': 2.4248}:  20%|██        | 2/10 [00:03<00:15,  1.89s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9027, 'compress@10': 1.0, 'time@10': 1.9056}:  20%|██        | 2/10 [00:04<00:15,  1.89s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9027, 'compress@10': 1.0, 'time@10': 1.9056}:  30%|███       | 3/10 [00:04<00:08,  1.24s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.9151, 'compress@10': 1.0, 'time@10': 1.9668}:  30%|███       | 3/10 [00:06<00:08,  1.24s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.9151, 'compress@10': 1.0, 'time@10': 1.9668}:  40%|████      | 4/10 [00:06<00:09,  1.61s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.914, 'compress@10': 1.0, 'time@10': 3.0884}:  40%|████      | 4/10 [00:10<00:09,  1.61s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.914, 'compress@10': 1.0, 'time@10': 3.0884}:  50%|█████     | 5/10 [00:10<00:12,  2.42s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0222, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 3.1213}:  50%|█████     | 5/10 [00:13<00:12,  2.42s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0222, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 3.1213}:  60%|██████    | 6/10 [00:13<00:10,  2.73s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9176, 'compress@10': 1.0, 'time@10': 3.2054}:  60%|██████    | 6/10 [00:15<00:10,  2.73s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9176, 'compress@10': 1.0, 'time@10': 3.2054}:  70%|███████   | 7/10 [00:15<00:07,  2.45s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0207, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9212, 'compress@10': 1.0, 'time@10': 3.1185}:  70%|███████   | 7/10 [00:17<00:07,  2.45s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0207, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9212, 'compress@10': 1.0, 'time@10': 3.1185}:  80%|████████  | 8/10 [00:17<00:04,  2.48s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.025, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9337, 'compress@10': 1.0, 'time@10': 3.3471}:  80%|████████  | 8/10 [00:20<00:04,  2.48s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.025, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9337, 'compress@10': 1.0, 'time@10': 3.3471}:  90%|█████████ | 9/10 [00:20<00:02,  2.53s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0245, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9356, 'compress@10': 1.0, 'time@10': 3.3262}:  90%|█████████ | 9/10 [00:23<00:02,  2.53s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.0245, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9356, 'compress@10': 1.0, 'time@10': 3.3262}: 100%|██████████| 10/10 [00:23<00:00,  2.73s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0245, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9356, 'compress@10': 1.0, 'time@10': 3.3262}: 100%|██████████| 10/10 [00:23<00:00,  2.37s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.024476709033135226
Avg hit ratio: 0.8792813730317974
Avg ndcg: 0.9355841742889206
Avg compression ratio: 1.0
Avg train time: 3.326244330406189
Std train time: 1.773464503677167
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 2.6708}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 2.6708}:  10%|█         | 1/10 [00:01<00:12,  1.37s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9254, 'compress@10': 1.0, 'time@10': 2.4588}:  10%|█         | 1/10 [00:03<00:12,  1.37s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9254, 'compress@10': 1.0, 'time@10': 2.4588}:  20%|██        | 2/10 [00:03<00:15,  1.91s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 1.9253}:  20%|██        | 2/10 [00:04<00:15,  1.91s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 1.9253}:  30%|███       | 3/10 [00:04<00:08,  1.25s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.9107, 'compress@10': 1.0, 'time@10': 1.9496}:  30%|███       | 3/10 [00:06<00:08,  1.25s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.9107, 'compress@10': 1.0, 'time@10': 1.9496}:  40%|████      | 4/10 [00:06<00:09,  1.57s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.9145, 'compress@10': 1.0, 'time@10': 3.0049}:  40%|████      | 4/10 [00:09<00:09,  1.57s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.9145, 'compress@10': 1.0, 'time@10': 3.0049}:  50%|█████     | 5/10 [00:09<00:11,  2.32s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9202, 'compress@10': 1.0, 'time@10': 3.0342}:  50%|█████     | 5/10 [00:13<00:11,  2.32s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9202, 'compress@10': 1.0, 'time@10': 3.0342}:  60%|██████    | 6/10 [00:13<00:10,  2.63s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9229, 'compress@10': 1.0, 'time@10': 3.1028}:  60%|██████    | 6/10 [00:14<00:10,  2.63s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9229, 'compress@10': 1.0, 'time@10': 3.1028}:  70%|███████   | 7/10 [00:14<00:07,  2.36s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.02, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9157, 'compress@10': 1.0, 'time@10': 3.0196}:  70%|███████   | 7/10 [00:17<00:07,  2.36s/it]   {'epoch': 21, 'num_users': 6.125, 'loss': 0.02, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9157, 'compress@10': 1.0, 'time@10': 3.0196}:  80%|████████  | 8/10 [00:17<00:04,  2.40s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0229, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 3.2344}:  80%|████████  | 8/10 [00:19<00:04,  2.40s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0229, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 3.2344}:  90%|█████████ | 9/10 [00:19<00:02,  2.43s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0231, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 3.2262}:  90%|█████████ | 9/10 [00:23<00:02,  2.43s/it]    {'epoch': 21, 'num_users': 6.3, 'loss': 0.0231, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 3.2262}: 100%|██████████| 10/10 [00:23<00:00,  2.67s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0231, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 3.2262}: 100%|██████████| 10/10 [00:23<00:00,  2.30s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.023057621772440848
Avg hit ratio: 0.8970151159913469
Avg ndcg: 0.9146535310464973
Avg compression ratio: 1.0
Avg train time: 3.226212763786316
Std train time: 1.6738024173851729
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 2.4453}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 2.4453}:  10%|█         | 1/10 [00:01<00:11,  1.26s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.9473, 'compress@10': 1.0, 'time@10': 2.2712}:  10%|█         | 1/10 [00:03<00:11,  1.26s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.9473, 'compress@10': 1.0, 'time@10': 2.2712}:  20%|██        | 2/10 [00:03<00:14,  1.79s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.7769, 'ndcg@10': 0.9151, 'compress@10': 1.0, 'time@10': 1.807}:  20%|██        | 2/10 [00:03<00:14,  1.79s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.7769, 'ndcg@10': 0.9151, 'compress@10': 1.0, 'time@10': 1.807}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.9247, 'compress@10': 1.0, 'time@10': 1.8398}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.9247, 'compress@10': 1.0, 'time@10': 1.8398}:  40%|████      | 4/10 [00:05<00:09,  1.50s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.851, 'ndcg@10': 0.9267, 'compress@10': 1.0, 'time@10': 2.9598}:  40%|████      | 4/10 [00:09<00:09,  1.50s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.851, 'ndcg@10': 0.9267, 'compress@10': 1.0, 'time@10': 2.9598}:  50%|█████     | 5/10 [00:09<00:11,  2.32s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0266, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9308, 'compress@10': 1.0, 'time@10': 3.0102}:  50%|█████     | 5/10 [00:12<00:11,  2.32s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0266, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9308, 'compress@10': 1.0, 'time@10': 3.0102}:  60%|██████    | 6/10 [00:12<00:10,  2.65s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0276, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9145, 'compress@10': 1.0, 'time@10': 3.0925}:  60%|██████    | 6/10 [00:14<00:10,  2.65s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0276, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9145, 'compress@10': 1.0, 'time@10': 3.0925}:  70%|███████   | 7/10 [00:14<00:07,  2.38s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0264, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9186, 'compress@10': 1.0, 'time@10': 3.0007}:  70%|███████   | 7/10 [00:17<00:07,  2.38s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0264, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9186, 'compress@10': 1.0, 'time@10': 3.0007}:  80%|████████  | 8/10 [00:17<00:04,  2.39s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0255, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9213, 'compress@10': 1.0, 'time@10': 3.2434}:  80%|████████  | 8/10 [00:19<00:04,  2.39s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0255, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9213, 'compress@10': 1.0, 'time@10': 3.2434}:  90%|█████████ | 9/10 [00:19<00:02,  2.47s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9268, 'compress@10': 1.0, 'time@10': 3.2223}:  90%|█████████ | 9/10 [00:22<00:02,  2.47s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9268, 'compress@10': 1.0, 'time@10': 3.2223}: 100%|██████████| 10/10 [00:22<00:00,  2.65s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9268, 'compress@10': 1.0, 'time@10': 3.2223}: 100%|██████████| 10/10 [00:22<00:00,  2.29s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.02591566094379951
Avg hit ratio: 0.8890555665801847
Avg ndcg: 0.9267996551723471
Avg compression ratio: 1.0
Avg train time: 3.2222671270370484
Std train time: 1.776850389268122
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9085, 'compress@10': 1.0, 'time@10': 2.65}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9085, 'compress@10': 1.0, 'time@10': 2.65}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.931, 'compress@10': 1.0, 'time@10': 2.4124}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.931, 'compress@10': 1.0, 'time@10': 2.4124}:  20%|██        | 2/10 [00:03<00:14,  1.86s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 1.8729}:  20%|██        | 2/10 [00:04<00:14,  1.86s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.9042, 'compress@10': 1.0, 'time@10': 1.8729}:  30%|███       | 3/10 [00:04<00:08,  1.21s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9184, 'compress@10': 1.0, 'time@10': 1.8929}:  30%|███       | 3/10 [00:06<00:08,  1.21s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.9184, 'compress@10': 1.0, 'time@10': 1.8929}:  40%|████      | 4/10 [00:06<00:09,  1.52s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 2.9412}:  40%|████      | 4/10 [00:09<00:09,  1.52s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 2.9412}:  50%|█████     | 5/10 [00:09<00:11,  2.27s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.9324, 'compress@10': 1.0, 'time@10': 3.0135}:  50%|█████     | 5/10 [00:13<00:11,  2.27s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.9324, 'compress@10': 1.0, 'time@10': 3.0135}:  60%|██████    | 6/10 [00:13<00:10,  2.66s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9344, 'compress@10': 1.0, 'time@10': 3.0634}:  60%|██████    | 6/10 [00:14<00:10,  2.66s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0136, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9344, 'compress@10': 1.0, 'time@10': 3.0634}:  70%|███████   | 7/10 [00:14<00:07,  2.35s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0213, 'hit_ratio@10': 0.923, 'ndcg@10': 0.9509, 'compress@10': 1.0, 'time@10': 2.9886}:  70%|███████   | 7/10 [00:17<00:07,  2.35s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0213, 'hit_ratio@10': 0.923, 'ndcg@10': 0.9509, 'compress@10': 1.0, 'time@10': 2.9886}:  80%|████████  | 8/10 [00:17<00:04,  2.40s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0207, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9515, 'compress@10': 1.0, 'time@10': 3.2013}:  80%|████████  | 8/10 [00:19<00:04,  2.40s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0207, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9515, 'compress@10': 1.0, 'time@10': 3.2013}:  90%|█████████ | 9/10 [00:19<00:02,  2.43s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9515, 'compress@10': 1.0, 'time@10': 3.184}:  90%|█████████ | 9/10 [00:22<00:02,  2.43s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9515, 'compress@10': 1.0, 'time@10': 3.184}: 100%|██████████| 10/10 [00:22<00:00,  2.63s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9515, 'compress@10': 1.0, 'time@10': 3.184}: 100%|██████████| 10/10 [00:22<00:00,  2.28s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.02119046129911592
Avg hit ratio: 0.910383779585817
Avg ndcg: 0.9514973042980518
Avg compression ratio: 1.0
Avg train time: 3.1840415000915527
Std train time: 1.664423570035646
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9104, 'compress@10': 1.0, 'time@10': 2.45}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9104, 'compress@10': 1.0, 'time@10': 2.45}:  10%|█         | 1/10 [00:01<00:11,  1.26s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8081, 'ndcg@10': 1.0093, 'compress@10': 1.0, 'time@10': 2.3203}:  10%|█         | 1/10 [00:03<00:11,  1.26s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8081, 'ndcg@10': 1.0093, 'compress@10': 1.0, 'time@10': 2.3203}:  20%|██        | 2/10 [00:03<00:14,  1.83s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.9564, 'compress@10': 1.0, 'time@10': 1.8137}:  20%|██        | 2/10 [00:03<00:14,  1.83s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8245, 'ndcg@10': 0.9564, 'compress@10': 1.0, 'time@10': 1.8137}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9558, 'compress@10': 1.0, 'time@10': 1.8317}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.8505, 'ndcg@10': 0.9558, 'compress@10': 1.0, 'time@10': 1.8317}:  40%|████      | 4/10 [00:05<00:08,  1.48s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 2.9096}:  40%|████      | 4/10 [00:09<00:08,  1.48s/it] {'epoch': 24, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 2.9096}:  50%|█████     | 5/10 [00:09<00:11,  2.26s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0249, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9483, 'compress@10': 1.0, 'time@10': 2.9526}:  50%|█████     | 5/10 [00:12<00:11,  2.26s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0249, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9483, 'compress@10': 1.0, 'time@10': 2.9526}:  60%|██████    | 6/10 [00:12<00:10,  2.58s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0244, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9478, 'compress@10': 1.0, 'time@10': 3.0462}:  60%|██████    | 6/10 [00:14<00:10,  2.58s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0244, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9478, 'compress@10': 1.0, 'time@10': 3.0462}:  70%|███████   | 7/10 [00:14<00:07,  2.34s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0245, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9424, 'compress@10': 1.0, 'time@10': 2.9638}:  70%|███████   | 7/10 [00:16<00:07,  2.34s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0245, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9424, 'compress@10': 1.0, 'time@10': 2.9638}:  80%|████████  | 8/10 [00:16<00:04,  2.37s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9444, 'compress@10': 1.0, 'time@10': 3.1857}:  80%|████████  | 8/10 [00:19<00:04,  2.37s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9444, 'compress@10': 1.0, 'time@10': 3.1857}:  90%|█████████ | 9/10 [00:19<00:02,  2.41s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.021, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 3.1826}:  90%|█████████ | 9/10 [00:22<00:02,  2.41s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.021, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 3.1826}: 100%|██████████| 10/10 [00:22<00:00,  2.65s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.021, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 3.1826}: 100%|██████████| 10/10 [00:22<00:00,  2.27s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.021011172644917805
Avg hit ratio: 0.8969127094373274
Avg ndcg: 0.9468184091457121
Avg compression ratio: 1.0
Avg train time: 3.1825674533843995
Std train time: 1.7077457745582385
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9155, 'compress@10': 1.0, 'time@10': 2.5395}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9155, 'compress@10': 1.0, 'time@10': 2.5395}:  10%|█         | 1/10 [00:01<00:11,  1.30s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 2.4198}:  10%|█         | 1/10 [00:03<00:11,  1.30s/it] {'epoch': 25, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 2.4198}:  20%|██        | 2/10 [00:03<00:16,  2.01s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9024, 'compress@10': 1.0, 'time@10': 1.937}:  20%|██        | 2/10 [00:04<00:16,  2.01s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9024, 'compress@10': 1.0, 'time@10': 1.937}:  30%|███       | 3/10 [00:04<00:09,  1.34s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9148, 'compress@10': 1.0, 'time@10': 1.9489}:  30%|███       | 3/10 [00:06<00:09,  1.34s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9148, 'compress@10': 1.0, 'time@10': 1.9489}:  40%|████      | 4/10 [00:06<00:09,  1.61s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 3.0202}:  40%|████      | 4/10 [00:10<00:09,  1.61s/it] {'epoch': 25, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 3.0202}:  50%|█████     | 5/10 [00:10<00:11,  2.36s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.926, 'compress@10': 1.0, 'time@10': 3.0412}:  50%|█████     | 5/10 [00:13<00:11,  2.36s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.926, 'compress@10': 1.0, 'time@10': 3.0412}:  60%|██████    | 6/10 [00:13<00:10,  2.64s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.914, 'compress@10': 1.0, 'time@10': 3.104}:  60%|██████    | 6/10 [00:15<00:10,  2.64s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.914, 'compress@10': 1.0, 'time@10': 3.104}:  70%|███████   | 7/10 [00:15<00:07,  2.36s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9139, 'compress@10': 1.0, 'time@10': 3.012}:  70%|███████   | 7/10 [00:17<00:07,  2.36s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9139, 'compress@10': 1.0, 'time@10': 3.012}:  80%|████████  | 8/10 [00:17<00:04,  2.37s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.93, 'compress@10': 1.0, 'time@10': 3.2151}:  80%|████████  | 8/10 [00:19<00:04,  2.37s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.93, 'compress@10': 1.0, 'time@10': 3.2151}:  90%|█████████ | 9/10 [00:19<00:02,  2.40s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9331, 'compress@10': 1.0, 'time@10': 3.2063}:  90%|█████████ | 9/10 [00:23<00:02,  2.40s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9331, 'compress@10': 1.0, 'time@10': 3.2063}: 100%|██████████| 10/10 [00:23<00:00,  2.64s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9331, 'compress@10': 1.0, 'time@10': 3.2063}: 100%|██████████| 10/10 [00:23<00:00,  2.30s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.01865878924409316
Avg hit ratio: 0.892015115991347
Avg ndcg: 0.9331222937029213
Avg compression ratio: 1.0
Avg train time: 3.2063325166702272
Std train time: 1.6737579743197364
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 2.472}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 2.472}:  10%|█         | 1/10 [00:01<00:11,  1.27s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9675, 'compress@10': 1.0, 'time@10': 2.2836}:  10%|█         | 1/10 [00:03<00:11,  1.27s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0322, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9675, 'compress@10': 1.0, 'time@10': 2.2836}:  20%|██        | 2/10 [00:03<00:14,  1.79s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9285, 'compress@10': 1.0, 'time@10': 1.8002}:  20%|██        | 2/10 [00:03<00:14,  1.79s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9285, 'compress@10': 1.0, 'time@10': 1.8002}:  30%|███       | 3/10 [00:03<00:08,  1.18s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.9353, 'compress@10': 1.0, 'time@10': 1.825}:  30%|███       | 3/10 [00:05<00:08,  1.18s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.9353, 'compress@10': 1.0, 'time@10': 1.825}:  40%|████      | 4/10 [00:05<00:08,  1.48s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.9422, 'compress@10': 1.0, 'time@10': 2.9278}:  40%|████      | 4/10 [00:09<00:08,  1.48s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.8543, 'ndcg@10': 0.9422, 'compress@10': 1.0, 'time@10': 2.9278}:  50%|█████     | 5/10 [00:09<00:11,  2.28s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0243, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 3.0064}:  50%|█████     | 5/10 [00:12<00:11,  2.28s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0243, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 3.0064}:  60%|██████    | 6/10 [00:12<00:10,  2.67s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0222, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9449, 'compress@10': 1.0, 'time@10': 3.1124}:  60%|██████    | 6/10 [00:14<00:10,  2.67s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0222, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9449, 'compress@10': 1.0, 'time@10': 3.1124}:  70%|███████   | 7/10 [00:14<00:07,  2.42s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9428, 'compress@10': 1.0, 'time@10': 3.0163}:  70%|███████   | 7/10 [00:17<00:07,  2.42s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.8948, 'ndcg@10': 0.9428, 'compress@10': 1.0, 'time@10': 3.0163}:  80%|████████  | 8/10 [00:17<00:04,  2.41s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0254, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9555, 'compress@10': 1.0, 'time@10': 3.217}:  80%|████████  | 8/10 [00:19<00:04,  2.41s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0254, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9555, 'compress@10': 1.0, 'time@10': 3.217}:  90%|█████████ | 9/10 [00:19<00:02,  2.42s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0256, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9556, 'compress@10': 1.0, 'time@10': 3.1981}:  90%|█████████ | 9/10 [00:22<00:02,  2.42s/it]  {'epoch': 26, 'num_users': 6.3, 'loss': 0.0256, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9556, 'compress@10': 1.0, 'time@10': 3.1981}: 100%|██████████| 10/10 [00:22<00:00,  2.62s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0256, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9556, 'compress@10': 1.0, 'time@10': 3.1981}: 100%|██████████| 10/10 [00:22<00:00,  2.28s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.025596894994673054
Avg hit ratio: 0.8878528016032261
Avg ndcg: 0.9556493827359475
Avg compression ratio: 1.0
Avg train time: 3.1980925798416138
Std train time: 1.7295540361429607
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 2.5975}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 2.5975}:  10%|█         | 1/10 [00:01<00:12,  1.33s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9664, 'compress@10': 1.0, 'time@10': 2.3486}:  10%|█         | 1/10 [00:03<00:12,  1.33s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9664, 'compress@10': 1.0, 'time@10': 2.3486}:  20%|██        | 2/10 [00:03<00:14,  1.81s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.74, 'ndcg@10': 0.9278, 'compress@10': 1.0, 'time@10': 1.8465}:  20%|██        | 2/10 [00:03<00:14,  1.81s/it]  {'epoch': 27, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.74, 'ndcg@10': 0.9278, 'compress@10': 1.0, 'time@10': 1.8465}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.7871, 'ndcg@10': 0.9361, 'compress@10': 1.0, 'time@10': 1.8353}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.7871, 'ndcg@10': 0.9361, 'compress@10': 1.0, 'time@10': 1.8353}:  40%|████      | 4/10 [00:05<00:08,  1.45s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.9434, 'compress@10': 1.0, 'time@10': 2.8517}:  40%|████      | 4/10 [00:09<00:08,  1.45s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.8257, 'ndcg@10': 0.9434, 'compress@10': 1.0, 'time@10': 2.8517}:  50%|█████     | 5/10 [00:09<00:10,  2.19s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9466, 'compress@10': 1.0, 'time@10': 2.9272}:  50%|█████     | 5/10 [00:12<00:10,  2.19s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0163, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9466, 'compress@10': 1.0, 'time@10': 2.9272}:  60%|██████    | 6/10 [00:12<00:10,  2.58s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 3.0258}:  60%|██████    | 6/10 [00:14<00:10,  2.58s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0164, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 3.0258}:  70%|███████   | 7/10 [00:14<00:07,  2.35s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.948, 'compress@10': 1.0, 'time@10': 2.9675}:  70%|███████   | 7/10 [00:17<00:07,  2.35s/it]  {'epoch': 27, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.948, 'compress@10': 1.0, 'time@10': 2.9675}:  80%|████████  | 8/10 [00:17<00:04,  2.43s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9376, 'compress@10': 1.0, 'time@10': 3.193}:  80%|████████  | 8/10 [00:19<00:04,  2.43s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9376, 'compress@10': 1.0, 'time@10': 3.193}:  90%|█████████ | 9/10 [00:19<00:02,  2.46s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9416, 'compress@10': 1.0, 'time@10': 3.1611}:  90%|█████████ | 9/10 [00:22<00:02,  2.46s/it]  {'epoch': 27, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9416, 'compress@10': 1.0, 'time@10': 3.1611}: 100%|██████████| 10/10 [00:22<00:00,  2.60s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0182, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.9416, 'compress@10': 1.0, 'time@10': 3.1611}: 100%|██████████| 10/10 [00:22<00:00,  2.25s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.018190780069138653
Avg hit ratio: 0.8821385158889404
Avg ndcg: 0.9415726084633214
Avg compression ratio: 1.0
Avg train time: 3.161098265647888
Std train time: 1.6376029289689957
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0191, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 2.4818}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0191, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 2.4818}:  10%|█         | 1/10 [00:01<00:14,  1.56s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 2.3936}:  10%|█         | 1/10 [00:03<00:14,  1.56s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 2.3936}:  20%|██        | 2/10 [00:03<00:16,  2.02s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.74, 'ndcg@10': 0.9155, 'compress@10': 1.0, 'time@10': 1.8913}:  20%|██        | 2/10 [00:04<00:16,  2.02s/it]  {'epoch': 28, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.74, 'ndcg@10': 0.9155, 'compress@10': 1.0, 'time@10': 1.8913}:  30%|███       | 3/10 [00:04<00:09,  1.32s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.7871, 'ndcg@10': 0.9261, 'compress@10': 1.0, 'time@10': 1.8887}:  30%|███       | 3/10 [00:06<00:09,  1.32s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.7871, 'ndcg@10': 0.9261, 'compress@10': 1.0, 'time@10': 1.8887}:  40%|████      | 4/10 [00:06<00:09,  1.56s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.9333, 'compress@10': 1.0, 'time@10': 2.9679}:  40%|████      | 4/10 [00:10<00:09,  1.56s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8217, 'ndcg@10': 0.9333, 'compress@10': 1.0, 'time@10': 2.9679}:  50%|█████     | 5/10 [00:10<00:11,  2.33s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.844, 'ndcg@10': 0.938, 'compress@10': 1.0, 'time@10': 3.001}:  50%|█████     | 5/10 [00:13<00:11,  2.33s/it] {'epoch': 28, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.844, 'ndcg@10': 0.938, 'compress@10': 1.0, 'time@10': 3.001}:  60%|██████    | 6/10 [00:13<00:10,  2.62s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9349, 'compress@10': 1.0, 'time@10': 3.065}:  60%|██████    | 6/10 [00:14<00:10,  2.62s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9349, 'compress@10': 1.0, 'time@10': 3.065}:  70%|███████   | 7/10 [00:14<00:07,  2.34s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0241, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9594, 'compress@10': 1.0, 'time@10': 2.9705}:  70%|███████   | 7/10 [00:17<00:07,  2.34s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0241, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9594, 'compress@10': 1.0, 'time@10': 2.9705}:  80%|████████  | 8/10 [00:17<00:04,  2.34s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9592, 'compress@10': 1.0, 'time@10': 3.2118}:  80%|████████  | 8/10 [00:19<00:04,  2.34s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0225, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9592, 'compress@10': 1.0, 'time@10': 3.2118}:  90%|█████████ | 9/10 [00:19<00:02,  2.43s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0231, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9554, 'compress@10': 1.0, 'time@10': 3.1848}:  90%|█████████ | 9/10 [00:22<00:02,  2.43s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0231, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9554, 'compress@10': 1.0, 'time@10': 3.1848}: 100%|██████████| 10/10 [00:22<00:00,  2.60s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0231, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9554, 'compress@10': 1.0, 'time@10': 3.1848}: 100%|██████████| 10/10 [00:22<00:00,  2.29s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.023133550870148505
Avg hit ratio: 0.8772813730317974
Avg ndcg: 0.9553611018481221
Avg compression ratio: 1.0
Avg train time: 3.1848042249679565
Std train time: 1.7259662141009422
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 2.5688}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 2.5688}:  10%|█         | 1/10 [00:01<00:11,  1.32s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9471, 'compress@10': 1.0, 'time@10': 2.377}:  10%|█         | 1/10 [00:03<00:11,  1.32s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9471, 'compress@10': 1.0, 'time@10': 2.377}:  20%|██        | 2/10 [00:03<00:14,  1.85s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9149, 'compress@10': 1.0, 'time@10': 1.8504}:  20%|██        | 2/10 [00:03<00:14,  1.85s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9149, 'compress@10': 1.0, 'time@10': 1.8504}:  30%|███       | 3/10 [00:03<00:08,  1.21s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.9266, 'compress@10': 1.0, 'time@10': 1.8636}:  30%|███       | 3/10 [00:05<00:08,  1.21s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.9266, 'compress@10': 1.0, 'time@10': 1.8636}:  40%|████      | 4/10 [00:05<00:09,  1.50s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.9367, 'compress@10': 1.0, 'time@10': 2.9608}:  40%|████      | 4/10 [00:09<00:09,  1.50s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.9367, 'compress@10': 1.0, 'time@10': 2.9608}:  50%|█████     | 5/10 [00:09<00:11,  2.30s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 2.9922}:  50%|█████     | 5/10 [00:12<00:11,  2.30s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 2.9922}:  60%|██████    | 6/10 [00:12<00:10,  2.60s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9383, 'compress@10': 1.0, 'time@10': 3.0757}:  60%|██████    | 6/10 [00:14<00:10,  2.60s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9383, 'compress@10': 1.0, 'time@10': 3.0757}:  70%|███████   | 7/10 [00:14<00:07,  2.35s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9399, 'compress@10': 1.0, 'time@10': 2.9961}:  70%|███████   | 7/10 [00:17<00:07,  2.35s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9399, 'compress@10': 1.0, 'time@10': 2.9961}:  80%|████████  | 8/10 [00:17<00:04,  2.39s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9422, 'compress@10': 1.0, 'time@10': 3.212}:  80%|████████  | 8/10 [00:19<00:04,  2.39s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0132, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9422, 'compress@10': 1.0, 'time@10': 3.212}:  90%|█████████ | 9/10 [00:19<00:02,  2.43s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.946, 'compress@10': 1.0, 'time@10': 3.2101}:  90%|█████████ | 9/10 [00:22<00:02,  2.43s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.946, 'compress@10': 1.0, 'time@10': 3.2101}: 100%|██████████| 10/10 [00:22<00:00,  2.68s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.946, 'compress@10': 1.0, 'time@10': 3.2101}: 100%|██████████| 10/10 [00:22<00:00,  2.29s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.012699237622286521
Avg hit ratio: 0.8919357509119819
Avg ndcg: 0.9459711356515956
Avg compression ratio: 1.0
Avg train time: 3.210112452507019
Std train time: 1.7277483198290302
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 2.5376}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 2.5376}:  10%|█         | 1/10 [00:01<00:11,  1.32s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 2.345}:  10%|█         | 1/10 [00:03<00:11,  1.32s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 2.345}:  20%|██        | 2/10 [00:03<00:14,  1.84s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9134, 'compress@10': 1.0, 'time@10': 1.8392}:  20%|██        | 2/10 [00:03<00:14,  1.84s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.9134, 'compress@10': 1.0, 'time@10': 1.8392}:  30%|███       | 3/10 [00:03<00:08,  1.21s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.9274, 'compress@10': 1.0, 'time@10': 1.8664}:  30%|███       | 3/10 [00:05<00:08,  1.21s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.9274, 'compress@10': 1.0, 'time@10': 1.8664}:  40%|████      | 4/10 [00:05<00:09,  1.52s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.9356, 'compress@10': 1.0, 'time@10': 2.9707}:  40%|████      | 4/10 [00:09<00:09,  1.52s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0142, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.9356, 'compress@10': 1.0, 'time@10': 2.9707}:  50%|█████     | 5/10 [00:09<00:11,  2.32s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.941, 'compress@10': 1.0, 'time@10': 3.0503}:  50%|█████     | 5/10 [00:13<00:11,  2.32s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.941, 'compress@10': 1.0, 'time@10': 3.0503}:  60%|██████    | 6/10 [00:13<00:10,  2.71s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9413, 'compress@10': 1.0, 'time@10': 3.1199}:  60%|██████    | 6/10 [00:14<00:10,  2.71s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9413, 'compress@10': 1.0, 'time@10': 3.1199}:  70%|███████   | 7/10 [00:14<00:07,  2.42s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9435, 'compress@10': 1.0, 'time@10': 3.0204}:  70%|███████   | 7/10 [00:17<00:07,  2.42s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9435, 'compress@10': 1.0, 'time@10': 3.0204}:  80%|████████  | 8/10 [00:17<00:04,  2.40s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9457, 'compress@10': 1.0, 'time@10': 3.2746}:  80%|████████  | 8/10 [00:20<00:04,  2.40s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9457, 'compress@10': 1.0, 'time@10': 3.2746}:  90%|█████████ | 9/10 [00:20<00:02,  2.50s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9459, 'compress@10': 1.0, 'time@10': 3.26}:  90%|█████████ | 9/10 [00:23<00:02,  2.50s/it]     {'epoch': 30, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9459, 'compress@10': 1.0, 'time@10': 3.26}: 100%|██████████| 10/10 [00:23<00:00,  2.70s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0167, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9459, 'compress@10': 1.0, 'time@10': 3.26}: 100%|██████████| 10/10 [00:23<00:00,  2.32s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.016664893668827813
Avg hit ratio: 0.890932166682591
Avg ndcg: 0.945914376559846
Avg compression ratio: 1.0
Avg train time: 3.2600253343582155
Std train time: 1.7784214900163056
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 2.4933}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 2.4933}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 2.3735}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 2.3735}:  20%|██        | 2/10 [00:03<00:14,  1.87s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9108, 'compress@10': 1.0, 'time@10': 1.8432}:  20%|██        | 2/10 [00:03<00:14,  1.87s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9108, 'compress@10': 1.0, 'time@10': 1.8432}:  30%|███       | 3/10 [00:03<00:08,  1.21s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 1.8879}:  30%|███       | 3/10 [00:06<00:08,  1.21s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 1.8879}:  40%|████      | 4/10 [00:06<00:09,  1.55s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9331, 'compress@10': 1.0, 'time@10': 2.9867}:  40%|████      | 4/10 [00:09<00:09,  1.55s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9331, 'compress@10': 1.0, 'time@10': 2.9867}:  50%|█████     | 5/10 [00:09<00:11,  2.33s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9387, 'compress@10': 1.0, 'time@10': 3.017}:  50%|█████     | 5/10 [00:12<00:11,  2.33s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9387, 'compress@10': 1.0, 'time@10': 3.017}:  60%|██████    | 6/10 [00:12<00:10,  2.63s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9401, 'compress@10': 1.0, 'time@10': 3.1059}:  60%|██████    | 6/10 [00:14<00:10,  2.63s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9401, 'compress@10': 1.0, 'time@10': 3.1059}:  70%|███████   | 7/10 [00:14<00:07,  2.38s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9425, 'compress@10': 1.0, 'time@10': 3.0109}:  70%|███████   | 7/10 [00:17<00:07,  2.38s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9425, 'compress@10': 1.0, 'time@10': 3.0109}:  80%|████████  | 8/10 [00:17<00:04,  2.38s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9612, 'compress@10': 1.0, 'time@10': 3.2599}:  80%|████████  | 8/10 [00:19<00:04,  2.38s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9612, 'compress@10': 1.0, 'time@10': 3.2599}:  90%|█████████ | 9/10 [00:19<00:02,  2.47s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9628, 'compress@10': 1.0, 'time@10': 3.2309}:  90%|█████████ | 9/10 [00:22<00:02,  2.47s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9628, 'compress@10': 1.0, 'time@10': 3.2309}: 100%|██████████| 10/10 [00:22<00:00,  2.63s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9628, 'compress@10': 1.0, 'time@10': 3.2309}: 100%|██████████| 10/10 [00:22<00:00,  2.29s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.013911369575770166
Avg hit ratio: 0.8889961438297602
Avg ndcg: 0.9628251837955404
Avg compression ratio: 1.0
Avg train time: 3.2308809757232666
Std train time: 1.7688288738753817
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 2.4467}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 2.4467}:  10%|█         | 1/10 [00:01<00:11,  1.26s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9426, 'compress@10': 1.0, 'time@10': 2.3128}:  10%|█         | 1/10 [00:03<00:11,  1.26s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9426, 'compress@10': 1.0, 'time@10': 2.3128}:  20%|██        | 2/10 [00:03<00:14,  1.82s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9119, 'compress@10': 1.0, 'time@10': 1.8183}:  20%|██        | 2/10 [00:03<00:14,  1.82s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9119, 'compress@10': 1.0, 'time@10': 1.8183}:  30%|███       | 3/10 [00:03<00:08,  1.20s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9248, 'compress@10': 1.0, 'time@10': 1.8458}:  30%|███       | 3/10 [00:05<00:08,  1.20s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9248, 'compress@10': 1.0, 'time@10': 1.8458}:  40%|████      | 4/10 [00:05<00:08,  1.50s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9341, 'compress@10': 1.0, 'time@10': 2.9353}:  40%|████      | 4/10 [00:09<00:08,  1.50s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9341, 'compress@10': 1.0, 'time@10': 2.9353}:  50%|█████     | 5/10 [00:09<00:12,  2.41s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9405, 'compress@10': 1.0, 'time@10': 3.0244}:  50%|█████     | 5/10 [00:13<00:12,  2.41s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9405, 'compress@10': 1.0, 'time@10': 3.0244}:  60%|██████    | 6/10 [00:13<00:11,  2.78s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9343, 'compress@10': 1.0, 'time@10': 3.12}:  60%|██████    | 6/10 [00:15<00:11,  2.78s/it]  {'epoch': 32, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9343, 'compress@10': 1.0, 'time@10': 3.12}:  70%|███████   | 7/10 [00:15<00:07,  2.49s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9376, 'compress@10': 1.0, 'time@10': 3.0563}:  70%|███████   | 7/10 [00:17<00:07,  2.49s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0157, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9376, 'compress@10': 1.0, 'time@10': 3.0563}:  80%|████████  | 8/10 [00:17<00:05,  2.54s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9472, 'compress@10': 1.0, 'time@10': 3.2755}:  80%|████████  | 8/10 [00:20<00:05,  2.54s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0226, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9472, 'compress@10': 1.0, 'time@10': 3.2755}:  90%|█████████ | 9/10 [00:20<00:02,  2.54s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.024, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 3.2664}:  90%|█████████ | 9/10 [00:23<00:02,  2.54s/it]    {'epoch': 32, 'num_users': 6.3, 'loss': 0.024, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 3.2664}: 100%|██████████| 10/10 [00:23<00:00,  2.76s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.024, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 3.2664}: 100%|██████████| 10/10 [00:23<00:00,  2.37s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.02404301602576353
Avg hit ratio: 0.9004247152583316
Avg ndcg: 0.9497363509593999
Avg compression ratio: 1.0
Avg train time: 3.26642529964447
Std train time: 1.7195166709408607
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 2.9241}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 2.9241}:  10%|█         | 1/10 [00:01<00:13,  1.50s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9442, 'compress@10': 1.0, 'time@10': 2.6013}:  10%|█         | 1/10 [00:03<00:13,  1.50s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0116, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9442, 'compress@10': 1.0, 'time@10': 2.6013}:  20%|██        | 2/10 [00:03<00:15,  1.98s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.913, 'compress@10': 1.0, 'time@10': 1.9902}:  20%|██        | 2/10 [00:04<00:15,  1.98s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.913, 'compress@10': 1.0, 'time@10': 1.9902}:  30%|███       | 3/10 [00:04<00:08,  1.27s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9253, 'compress@10': 1.0, 'time@10': 1.9893}:  30%|███       | 3/10 [00:06<00:08,  1.27s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9253, 'compress@10': 1.0, 'time@10': 1.9893}:  40%|████      | 4/10 [00:06<00:09,  1.56s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9346, 'compress@10': 1.0, 'time@10': 3.0351}:  40%|████      | 4/10 [00:09<00:09,  1.56s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9346, 'compress@10': 1.0, 'time@10': 3.0351}:  50%|█████     | 5/10 [00:09<00:11,  2.32s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9398, 'compress@10': 1.0, 'time@10': 3.0602}:  50%|█████     | 5/10 [00:13<00:11,  2.32s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9398, 'compress@10': 1.0, 'time@10': 3.0602}:  60%|██████    | 6/10 [00:13<00:10,  2.62s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9416, 'compress@10': 1.0, 'time@10': 3.1182}:  60%|██████    | 6/10 [00:15<00:10,  2.62s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9416, 'compress@10': 1.0, 'time@10': 3.1182}:  70%|███████   | 7/10 [00:15<00:07,  2.53s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9436, 'compress@10': 1.0, 'time@10': 3.0553}:  70%|███████   | 7/10 [00:18<00:07,  2.53s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9436, 'compress@10': 1.0, 'time@10': 3.0553}:  80%|████████  | 8/10 [00:18<00:05,  2.57s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9378, 'compress@10': 1.0, 'time@10': 3.2697}:  80%|████████  | 8/10 [00:20<00:05,  2.57s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9378, 'compress@10': 1.0, 'time@10': 3.2697}:  90%|█████████ | 9/10 [00:20<00:02,  2.56s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9408, 'compress@10': 1.0, 'time@10': 3.2439}:  90%|█████████ | 9/10 [00:23<00:02,  2.56s/it]    {'epoch': 33, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9408, 'compress@10': 1.0, 'time@10': 3.2439}: 100%|██████████| 10/10 [00:23<00:00,  2.71s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9408, 'compress@10': 1.0, 'time@10': 3.2439}: 100%|██████████| 10/10 [00:23<00:00,  2.37s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.013420314791089277
Avg hit ratio: 0.9079541301935189
Avg ndcg: 0.940795226011573
Avg compression ratio: 1.0
Avg train time: 3.2438891410827635
Std train time: 1.6755856818666999
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 2.5608}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 2.5608}:  10%|█         | 1/10 [00:01<00:11,  1.32s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9448, 'compress@10': 1.0, 'time@10': 2.3697}:  10%|█         | 1/10 [00:03<00:11,  1.32s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9448, 'compress@10': 1.0, 'time@10': 2.3697}:  20%|██        | 2/10 [00:03<00:14,  1.85s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9134, 'compress@10': 1.0, 'time@10': 1.8671}:  20%|██        | 2/10 [00:04<00:14,  1.85s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9134, 'compress@10': 1.0, 'time@10': 1.8671}:  30%|███       | 3/10 [00:04<00:08,  1.22s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 1.8528}:  30%|███       | 3/10 [00:05<00:08,  1.22s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 1.8528}:  40%|████      | 4/10 [00:05<00:08,  1.46s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.93, 'compress@10': 1.0, 'time@10': 2.8773}:  40%|████      | 4/10 [00:09<00:08,  1.46s/it]  {'epoch': 34, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.93, 'compress@10': 1.0, 'time@10': 2.8773}:  50%|█████     | 5/10 [00:09<00:11,  2.21s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.937, 'compress@10': 1.0, 'time@10': 2.9251}:  50%|█████     | 5/10 [00:12<00:11,  2.21s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.937, 'compress@10': 1.0, 'time@10': 2.9251}:  60%|██████    | 6/10 [00:12<00:10,  2.55s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9388, 'compress@10': 1.0, 'time@10': 2.989}:  60%|██████    | 6/10 [00:14<00:10,  2.55s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9388, 'compress@10': 1.0, 'time@10': 2.989}:  70%|███████   | 7/10 [00:14<00:06,  2.28s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9377, 'compress@10': 1.0, 'time@10': 2.9221}:  70%|███████   | 7/10 [00:16<00:06,  2.28s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9377, 'compress@10': 1.0, 'time@10': 2.9221}:  80%|████████  | 8/10 [00:16<00:04,  2.35s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9405, 'compress@10': 1.0, 'time@10': 3.1368}:  80%|████████  | 8/10 [00:19<00:04,  2.35s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9405, 'compress@10': 1.0, 'time@10': 3.1368}:  90%|█████████ | 9/10 [00:19<00:02,  2.38s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9429, 'compress@10': 1.0, 'time@10': 3.1371}:  90%|█████████ | 9/10 [00:22<00:02,  2.38s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9429, 'compress@10': 1.0, 'time@10': 3.1371}: 100%|██████████| 10/10 [00:22<00:00,  2.63s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9429, 'compress@10': 1.0, 'time@10': 3.1371}: 100%|██████████| 10/10 [00:22<00:00,  2.24s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.015589870038097978
Avg hit ratio: 0.905096987336376
Avg ndcg: 0.9429282138636588
Avg compression ratio: 1.0
Avg train time: 3.1370748043060304
Std train time: 1.6246060382563243
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 2.666}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 2.666}:  10%|█         | 1/10 [00:01<00:12,  1.37s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9397, 'compress@10': 1.0, 'time@10': 2.4418}:  10%|█         | 1/10 [00:03<00:12,  1.37s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9397, 'compress@10': 1.0, 'time@10': 2.4418}:  20%|██        | 2/10 [00:03<00:15,  1.89s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 1.9271}:  20%|██        | 2/10 [00:04<00:15,  1.89s/it]  {'epoch': 35, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 1.9271}:  30%|███       | 3/10 [00:04<00:08,  1.25s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9196, 'compress@10': 1.0, 'time@10': 1.9313}:  30%|███       | 3/10 [00:06<00:08,  1.25s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0125, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9196, 'compress@10': 1.0, 'time@10': 1.9313}:  40%|████      | 4/10 [00:06<00:09,  1.54s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9251, 'compress@10': 1.0, 'time@10': 2.9632}:  40%|████      | 4/10 [00:09<00:09,  1.54s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9251, 'compress@10': 1.0, 'time@10': 2.9632}:  50%|█████     | 5/10 [00:09<00:11,  2.27s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9314, 'compress@10': 1.0, 'time@10': 3.0039}:  50%|█████     | 5/10 [00:12<00:11,  2.27s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9314, 'compress@10': 1.0, 'time@10': 3.0039}:  60%|██████    | 6/10 [00:12<00:10,  2.60s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9318, 'compress@10': 1.0, 'time@10': 3.0941}:  60%|██████    | 6/10 [00:14<00:10,  2.60s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9318, 'compress@10': 1.0, 'time@10': 3.0941}:  70%|███████   | 7/10 [00:14<00:07,  2.36s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0178, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9307, 'compress@10': 1.0, 'time@10': 3.0}:  70%|███████   | 7/10 [00:17<00:07,  2.36s/it]    {'epoch': 35, 'num_users': 6.125, 'loss': 0.0178, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.9307, 'compress@10': 1.0, 'time@10': 3.0}:  80%|████████  | 8/10 [00:17<00:04,  2.37s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9347, 'compress@10': 1.0, 'time@10': 3.2182}:  80%|████████  | 8/10 [00:19<00:04,  2.37s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0162, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9347, 'compress@10': 1.0, 'time@10': 3.2182}:  90%|█████████ | 9/10 [00:19<00:02,  2.41s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9406, 'compress@10': 1.0, 'time@10': 3.2037}:  90%|█████████ | 9/10 [00:22<00:02,  2.41s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9406, 'compress@10': 1.0, 'time@10': 3.2037}: 100%|██████████| 10/10 [00:22<00:00,  2.63s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9406, 'compress@10': 1.0, 'time@10': 3.2037}: 100%|██████████| 10/10 [00:22<00:00,  2.28s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.0157562193920623
Avg hit ratio: 0.9127672382324334
Avg ndcg: 0.9406034140261242
Avg compression ratio: 1.0
Avg train time: 3.2037095069885253
Std train time: 1.652808927517028
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 2.6762}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 2.6762}:  10%|█         | 1/10 [00:01<00:12,  1.37s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9876, 'compress@10': 1.0, 'time@10': 2.4647}:  10%|█         | 1/10 [00:03<00:12,  1.37s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9876, 'compress@10': 1.0, 'time@10': 2.4647}:  20%|██        | 2/10 [00:03<00:15,  1.91s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9419, 'compress@10': 1.0, 'time@10': 1.9306}:  20%|██        | 2/10 [00:04<00:15,  1.91s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9419, 'compress@10': 1.0, 'time@10': 1.9306}:  30%|███       | 3/10 [00:04<00:08,  1.25s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.947, 'compress@10': 1.0, 'time@10': 1.9213}:  30%|███       | 3/10 [00:06<00:08,  1.25s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.947, 'compress@10': 1.0, 'time@10': 1.9213}:  40%|████      | 4/10 [00:06<00:09,  1.52s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 3.0775}:  40%|████      | 4/10 [00:09<00:09,  1.52s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 3.0775}:  50%|█████     | 5/10 [00:09<00:11,  2.38s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9552, 'compress@10': 1.0, 'time@10': 3.104}:  50%|█████     | 5/10 [00:13<00:11,  2.38s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0128, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9552, 'compress@10': 1.0, 'time@10': 3.104}:  60%|██████    | 6/10 [00:13<00:10,  2.68s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9544, 'compress@10': 1.0, 'time@10': 3.1584}:  60%|██████    | 6/10 [00:15<00:10,  2.68s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9544, 'compress@10': 1.0, 'time@10': 3.1584}:  70%|███████   | 7/10 [00:15<00:07,  2.39s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9675, 'compress@10': 1.0, 'time@10': 3.0606}:  70%|███████   | 7/10 [00:17<00:07,  2.39s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9675, 'compress@10': 1.0, 'time@10': 3.0606}:  80%|████████  | 8/10 [00:17<00:04,  2.40s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9699, 'compress@10': 1.0, 'time@10': 3.2928}:  80%|████████  | 8/10 [00:20<00:04,  2.40s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9699, 'compress@10': 1.0, 'time@10': 3.2928}:  90%|█████████ | 9/10 [00:20<00:02,  2.46s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9638, 'compress@10': 1.0, 'time@10': 3.2542}:  90%|█████████ | 9/10 [00:22<00:02,  2.46s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9638, 'compress@10': 1.0, 'time@10': 3.2542}: 100%|██████████| 10/10 [00:22<00:00,  2.61s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9638, 'compress@10': 1.0, 'time@10': 3.2542}: 100%|██████████| 10/10 [00:22<00:00,  2.30s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.016840116070266635
Avg hit ratio: 0.8976648316784142
Avg ndcg: 0.9637733315320978
Avg compression ratio: 1.0
Avg train time: 3.2542428255081175
Std train time: 1.8231419310985704
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 2.5862}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 2.5862}:  10%|█         | 1/10 [00:01<00:11,  1.33s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9475, 'compress@10': 1.0, 'time@10': 2.355}:  10%|█         | 1/10 [00:03<00:11,  1.33s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9475, 'compress@10': 1.0, 'time@10': 2.355}:  20%|██        | 2/10 [00:03<00:14,  1.82s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9174, 'compress@10': 1.0, 'time@10': 1.8522}:  20%|██        | 2/10 [00:03<00:14,  1.82s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9174, 'compress@10': 1.0, 'time@10': 1.8522}:  30%|███       | 3/10 [00:03<00:08,  1.20s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9286, 'compress@10': 1.0, 'time@10': 1.8584}:  30%|███       | 3/10 [00:05<00:08,  1.20s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9286, 'compress@10': 1.0, 'time@10': 1.8584}:  40%|████      | 4/10 [00:05<00:08,  1.48s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9413, 'compress@10': 1.0, 'time@10': 2.9269}:  40%|████      | 4/10 [00:09<00:08,  1.48s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.012, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9413, 'compress@10': 1.0, 'time@10': 2.9269}:  50%|█████     | 5/10 [00:09<00:11,  2.26s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9467, 'compress@10': 1.0, 'time@10': 2.9706}:  50%|█████     | 5/10 [00:12<00:11,  2.26s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9467, 'compress@10': 1.0, 'time@10': 2.9706}:  60%|██████    | 6/10 [00:12<00:10,  2.59s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9564, 'compress@10': 1.0, 'time@10': 3.03}:  60%|██████    | 6/10 [00:14<00:10,  2.59s/it]  {'epoch': 37, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9564, 'compress@10': 1.0, 'time@10': 3.03}:  70%|███████   | 7/10 [00:14<00:06,  2.31s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.9595, 'compress@10': 1.0, 'time@10': 2.972}:  70%|███████   | 7/10 [00:17<00:06,  2.31s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.9595, 'compress@10': 1.0, 'time@10': 2.972}:  80%|████████  | 8/10 [00:17<00:04,  2.41s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9571, 'compress@10': 1.0, 'time@10': 3.2189}:  80%|████████  | 8/10 [00:20<00:04,  2.41s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9571, 'compress@10': 1.0, 'time@10': 3.2189}:  90%|█████████ | 9/10 [00:20<00:02,  2.59s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.9591, 'compress@10': 1.0, 'time@10': 3.188}:  90%|█████████ | 9/10 [00:23<00:02,  2.59s/it]    {'epoch': 37, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.9591, 'compress@10': 1.0, 'time@10': 3.188}: 100%|██████████| 10/10 [00:23<00:00,  2.70s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.9591, 'compress@10': 1.0, 'time@10': 3.188}: 100%|██████████| 10/10 [00:23<00:00,  2.30s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.014211032550124209
Avg hit ratio: 0.9086914573824589
Avg ndcg: 0.9591203416039067
Avg compression ratio: 1.0
Avg train time: 3.188008761405945
Std train time: 1.7124223712552473
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 2.6579}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 2.6579}:  10%|█         | 1/10 [00:01<00:12,  1.37s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9988, 'compress@10': 1.0, 'time@10': 2.4188}:  10%|█         | 1/10 [00:03<00:12,  1.37s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9988, 'compress@10': 1.0, 'time@10': 2.4188}:  20%|██        | 2/10 [00:03<00:14,  1.87s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 1.9066}:  20%|██        | 2/10 [00:04<00:14,  1.87s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 1.9066}:  30%|███       | 3/10 [00:04<00:08,  1.23s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.952, 'compress@10': 1.0, 'time@10': 1.9379}:  30%|███       | 3/10 [00:06<00:08,  1.23s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.952, 'compress@10': 1.0, 'time@10': 1.9379}:  40%|████      | 4/10 [00:06<00:09,  1.57s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9545, 'compress@10': 1.0, 'time@10': 3.0218}:  40%|████      | 4/10 [00:09<00:09,  1.57s/it] {'epoch': 38, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9545, 'compress@10': 1.0, 'time@10': 3.0218}:  50%|█████     | 5/10 [00:09<00:11,  2.34s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0191, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9591, 'compress@10': 1.0, 'time@10': 3.0463}:  50%|█████     | 5/10 [00:13<00:11,  2.34s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0191, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9591, 'compress@10': 1.0, 'time@10': 3.0463}:  60%|██████    | 6/10 [00:13<00:10,  2.64s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9583, 'compress@10': 1.0, 'time@10': 3.1115}:  60%|██████    | 6/10 [00:14<00:10,  2.64s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9583, 'compress@10': 1.0, 'time@10': 3.1115}:  70%|███████   | 7/10 [00:14<00:07,  2.36s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9615, 'compress@10': 1.0, 'time@10': 3.0219}:  70%|███████   | 7/10 [00:17<00:07,  2.36s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9615, 'compress@10': 1.0, 'time@10': 3.0219}:  80%|████████  | 8/10 [00:17<00:04,  2.38s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0228, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9779, 'compress@10': 1.0, 'time@10': 3.2349}:  80%|████████  | 8/10 [00:19<00:04,  2.38s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0228, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9779, 'compress@10': 1.0, 'time@10': 3.2349}:  90%|█████████ | 9/10 [00:19<00:02,  2.42s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9719, 'compress@10': 1.0, 'time@10': 3.2269}:  90%|█████████ | 9/10 [00:22<00:02,  2.42s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9719, 'compress@10': 1.0, 'time@10': 3.2269}: 100%|██████████| 10/10 [00:22<00:00,  2.66s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.9065, 'ndcg@10': 0.9719, 'compress@10': 1.0, 'time@10': 3.2269}: 100%|██████████| 10/10 [00:22<00:00,  2.30s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.023397280413082283
Avg hit ratio: 0.9064815239467192
Avg ndcg: 0.9719013130387527
Avg compression ratio: 1.0
Avg train time: 3.2268983840942385
Std train time: 1.7064602275671263
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 2.6924}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 2.6924}:  10%|█         | 1/10 [00:01<00:12,  1.38s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8769, 'ndcg@10': 1.0106, 'compress@10': 1.0, 'time@10': 2.5093}:  10%|█         | 1/10 [00:03<00:12,  1.38s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8769, 'ndcg@10': 1.0106, 'compress@10': 1.0, 'time@10': 2.5093}:  20%|██        | 2/10 [00:03<00:15,  1.96s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9595, 'compress@10': 1.0, 'time@10': 1.9652}:  20%|██        | 2/10 [00:04<00:15,  1.96s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9595, 'compress@10': 1.0, 'time@10': 1.9652}:  30%|███       | 3/10 [00:04<00:08,  1.28s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9607, 'compress@10': 1.0, 'time@10': 1.961}:  30%|███       | 3/10 [00:06<00:08,  1.28s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9607, 'compress@10': 1.0, 'time@10': 1.961}:  40%|████      | 4/10 [00:06<00:09,  1.56s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9629, 'compress@10': 1.0, 'time@10': 3.0568}:  40%|████      | 4/10 [00:09<00:09,  1.56s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9629, 'compress@10': 1.0, 'time@10': 3.0568}:  50%|█████     | 5/10 [00:09<00:11,  2.35s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9649, 'compress@10': 1.0, 'time@10': 3.0776}:  50%|█████     | 5/10 [00:13<00:11,  2.35s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9649, 'compress@10': 1.0, 'time@10': 3.0776}:  60%|██████    | 6/10 [00:13<00:10,  2.65s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0124, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9617, 'compress@10': 1.0, 'time@10': 3.1338}:  60%|██████    | 6/10 [00:14<00:10,  2.65s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0124, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9617, 'compress@10': 1.0, 'time@10': 3.1338}:  70%|███████   | 7/10 [00:14<00:07,  2.37s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9638, 'compress@10': 1.0, 'time@10': 3.0427}:  70%|███████   | 7/10 [00:17<00:07,  2.37s/it]  {'epoch': 39, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9638, 'compress@10': 1.0, 'time@10': 3.0427}:  80%|████████  | 8/10 [00:17<00:04,  2.39s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9729, 'compress@10': 1.0, 'time@10': 3.2723}:  80%|████████  | 8/10 [00:20<00:04,  2.39s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9729, 'compress@10': 1.0, 'time@10': 3.2723}:  90%|█████████ | 9/10 [00:20<00:02,  2.46s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9734, 'compress@10': 1.0, 'time@10': 3.2613}:  90%|█████████ | 9/10 [00:23<00:02,  2.46s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9734, 'compress@10': 1.0, 'time@10': 3.2613}: 100%|██████████| 10/10 [00:23<00:00,  2.69s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9734, 'compress@10': 1.0, 'time@10': 3.2613}: 100%|██████████| 10/10 [00:23<00:00,  2.32s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.01479516306370994
Avg hit ratio: 0.9013791173926997
Avg ndcg: 0.9733525120244652
Avg compression ratio: 1.0
Avg train time: 3.2613003253936768
Std train time: 1.7401208992702342
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 2.6067}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 2.6067}:  10%|█         | 1/10 [00:01<00:12,  1.35s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9501, 'compress@10': 1.0, 'time@10': 2.4219}:  10%|█         | 1/10 [00:03<00:12,  1.35s/it]   {'epoch': 40, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9501, 'compress@10': 1.0, 'time@10': 2.4219}:  20%|██        | 2/10 [00:03<00:15,  1.89s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 1.8897}:  20%|██        | 2/10 [00:04<00:15,  1.89s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 1.8897}:  30%|███       | 3/10 [00:04<00:08,  1.23s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9304, 'compress@10': 1.0, 'time@10': 1.9056}:  30%|███       | 3/10 [00:06<00:08,  1.23s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9304, 'compress@10': 1.0, 'time@10': 1.9056}:  40%|████      | 4/10 [00:06<00:09,  1.53s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9399, 'compress@10': 1.0, 'time@10': 2.959}:  40%|████      | 4/10 [00:09<00:09,  1.53s/it] {'epoch': 40, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9399, 'compress@10': 1.0, 'time@10': 2.959}:  50%|█████     | 5/10 [00:09<00:11,  2.29s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9457, 'compress@10': 1.0, 'time@10': 2.9842}:  50%|█████     | 5/10 [00:12<00:11,  2.29s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9457, 'compress@10': 1.0, 'time@10': 2.9842}:  60%|██████    | 6/10 [00:12<00:10,  2.58s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.947, 'compress@10': 1.0, 'time@10': 3.0388}:  60%|██████    | 6/10 [00:14<00:10,  2.58s/it] {'epoch': 40, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.947, 'compress@10': 1.0, 'time@10': 3.0388}:  70%|███████   | 7/10 [00:14<00:06,  2.30s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.953, 'compress@10': 1.0, 'time@10': 2.9506}:  70%|███████   | 7/10 [00:16<00:06,  2.30s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.953, 'compress@10': 1.0, 'time@10': 2.9506}:  80%|████████  | 8/10 [00:16<00:04,  2.32s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9523, 'compress@10': 1.0, 'time@10': 3.1708}:  80%|████████  | 8/10 [00:19<00:04,  2.32s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9523, 'compress@10': 1.0, 'time@10': 3.1708}:  90%|█████████ | 9/10 [00:19<00:02,  2.38s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 3.161}:  90%|█████████ | 9/10 [00:22<00:02,  2.38s/it]    {'epoch': 40, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 3.161}: 100%|██████████| 10/10 [00:22<00:00,  2.60s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 3.161}: 100%|██████████| 10/10 [00:22<00:00,  2.25s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.013715099903193482
Avg hit ratio: 0.8995414317808207
Avg ndcg: 0.9516400410775772
Avg compression ratio: 1.0
Avg train time: 3.161040997505188
Std train time: 1.6747045005231909
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.5829}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.5829}:  10%|█         | 1/10 [00:01<00:11,  1.33s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9531, 'compress@10': 1.0, 'time@10': 2.3925}:  10%|█         | 1/10 [00:03<00:11,  1.33s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9531, 'compress@10': 1.0, 'time@10': 2.3925}:  20%|██        | 2/10 [00:03<00:14,  1.86s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 1.8549}:  20%|██        | 2/10 [00:03<00:14,  1.86s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 1.8549}:  30%|███       | 3/10 [00:03<00:08,  1.21s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9288, 'compress@10': 1.0, 'time@10': 1.8654}:  30%|███       | 3/10 [00:05<00:08,  1.21s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9288, 'compress@10': 1.0, 'time@10': 1.8654}:  40%|████      | 4/10 [00:05<00:08,  1.49s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9383, 'compress@10': 1.0, 'time@10': 2.9087}:  40%|████      | 4/10 [00:09<00:08,  1.49s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.9383, 'compress@10': 1.0, 'time@10': 2.9087}:  50%|█████     | 5/10 [00:09<00:11,  2.25s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9453, 'compress@10': 1.0, 'time@10': 2.9586}:  50%|█████     | 5/10 [00:12<00:11,  2.25s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9453, 'compress@10': 1.0, 'time@10': 2.9586}:  60%|██████    | 6/10 [00:12<00:10,  2.59s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9489, 'compress@10': 1.0, 'time@10': 3.0271}:  60%|██████    | 6/10 [00:14<00:10,  2.59s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9489, 'compress@10': 1.0, 'time@10': 3.0271}:  70%|███████   | 7/10 [00:14<00:06,  2.31s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.955, 'compress@10': 1.0, 'time@10': 2.9411}:  70%|███████   | 7/10 [00:16<00:06,  2.31s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.955, 'compress@10': 1.0, 'time@10': 2.9411}:  80%|████████  | 8/10 [00:16<00:04,  2.33s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9553, 'compress@10': 1.0, 'time@10': 3.187}:  80%|████████  | 8/10 [00:19<00:04,  2.33s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0134, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9553, 'compress@10': 1.0, 'time@10': 3.187}:  90%|█████████ | 9/10 [00:19<00:02,  2.42s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9569, 'compress@10': 1.0, 'time@10': 3.1738}:  90%|█████████ | 9/10 [00:22<00:02,  2.42s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9569, 'compress@10': 1.0, 'time@10': 3.1738}: 100%|██████████| 10/10 [00:22<00:00,  2.63s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9569, 'compress@10': 1.0, 'time@10': 3.1738}: 100%|██████████| 10/10 [00:22<00:00,  2.26s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.013155704834637396
Avg hit ratio: 0.9066049238443126
Avg ndcg: 0.9569084068660709
Avg compression ratio: 1.0
Avg train time: 3.1737613916397094
Std train time: 1.6920995672630608
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.3886}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.3886}:  10%|█         | 1/10 [00:01<00:11,  1.23s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9531, 'compress@10': 1.0, 'time@10': 2.2619}:  10%|█         | 1/10 [00:03<00:11,  1.23s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0083, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9531, 'compress@10': 1.0, 'time@10': 2.2619}:  20%|██        | 2/10 [00:03<00:14,  1.79s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 1.8275}:  20%|██        | 2/10 [00:03<00:14,  1.79s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 1.8275}:  30%|███       | 3/10 [00:03<00:08,  1.21s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9319, 'compress@10': 1.0, 'time@10': 1.8358}:  30%|███       | 3/10 [00:05<00:08,  1.21s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9319, 'compress@10': 1.0, 'time@10': 1.8358}:  40%|████      | 4/10 [00:05<00:08,  1.48s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 2.9453}:  40%|████      | 4/10 [00:09<00:08,  1.48s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 2.9453}:  50%|█████     | 5/10 [00:09<00:11,  2.29s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9465, 'compress@10': 1.0, 'time@10': 3.0111}:  50%|█████     | 5/10 [00:12<00:11,  2.29s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9465, 'compress@10': 1.0, 'time@10': 3.0111}:  60%|██████    | 6/10 [00:12<00:10,  2.66s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9481, 'compress@10': 1.0, 'time@10': 3.0704}:  60%|██████    | 6/10 [00:14<00:10,  2.66s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0096, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9481, 'compress@10': 1.0, 'time@10': 3.0704}:  70%|███████   | 7/10 [00:14<00:07,  2.36s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.9528, 'compress@10': 1.0, 'time@10': 2.9894}:  70%|███████   | 7/10 [00:17<00:07,  2.36s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0109, 'hit_ratio@10': 0.9173, 'ndcg@10': 0.9528, 'compress@10': 1.0, 'time@10': 2.9894}:  80%|████████  | 8/10 [00:17<00:04,  2.39s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0107, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9543, 'compress@10': 1.0, 'time@10': 3.2065}:  80%|████████  | 8/10 [00:19<00:04,  2.39s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0107, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9543, 'compress@10': 1.0, 'time@10': 3.2065}:  90%|█████████ | 9/10 [00:19<00:02,  2.43s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.9586, 'compress@10': 1.0, 'time@10': 3.2138}:  90%|█████████ | 9/10 [00:22<00:02,  2.43s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.9586, 'compress@10': 1.0, 'time@10': 3.2138}: 100%|██████████| 10/10 [00:22<00:00,  2.71s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.9087, 'ndcg@10': 0.9586, 'compress@10': 1.0, 'time@10': 3.2138}: 100%|██████████| 10/10 [00:22<00:00,  2.30s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.012442794046266862
Avg hit ratio: 0.9086914573824589
Avg ndcg: 0.958578453006089
Avg compression ratio: 1.0
Avg train time: 3.2138418436050413
Std train time: 1.727041623598525
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.5472}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.5472}:  10%|█         | 1/10 [00:01<00:11,  1.32s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.958, 'compress@10': 1.0, 'time@10': 2.3725}:  10%|█         | 1/10 [00:03<00:11,  1.32s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.0162, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.958, 'compress@10': 1.0, 'time@10': 2.3725}:  20%|██        | 2/10 [00:03<00:14,  1.87s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9244, 'compress@10': 1.0, 'time@10': 1.8501}:  20%|██        | 2/10 [00:04<00:14,  1.87s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9244, 'compress@10': 1.0, 'time@10': 1.8501}:  30%|███       | 3/10 [00:04<00:08,  1.22s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9335, 'compress@10': 1.0, 'time@10': 1.9085}:  30%|███       | 3/10 [00:06<00:08,  1.22s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9335, 'compress@10': 1.0, 'time@10': 1.9085}:  40%|████      | 4/10 [00:06<00:09,  1.58s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 2.9385}:  40%|████      | 4/10 [00:09<00:09,  1.58s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 2.9385}:  50%|█████     | 5/10 [00:09<00:11,  2.29s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9471, 'compress@10': 1.0, 'time@10': 2.9957}:  50%|█████     | 5/10 [00:13<00:11,  2.29s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9471, 'compress@10': 1.0, 'time@10': 2.9957}:  60%|██████    | 6/10 [00:13<00:10,  2.64s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9459, 'compress@10': 1.0, 'time@10': 3.0631}:  60%|██████    | 6/10 [00:14<00:10,  2.64s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9459, 'compress@10': 1.0, 'time@10': 3.0631}:  70%|███████   | 7/10 [00:14<00:07,  2.36s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9507, 'compress@10': 1.0, 'time@10': 2.9694}:  70%|███████   | 7/10 [00:17<00:07,  2.36s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9507, 'compress@10': 1.0, 'time@10': 2.9694}:  80%|████████  | 8/10 [00:17<00:04,  2.35s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9525, 'compress@10': 1.0, 'time@10': 3.1882}:  80%|████████  | 8/10 [00:19<00:04,  2.35s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0135, 'hit_ratio@10': 0.8921, 'ndcg@10': 0.9525, 'compress@10': 1.0, 'time@10': 3.1882}:  90%|█████████ | 9/10 [00:19<00:02,  2.40s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9548, 'compress@10': 1.0, 'time@10': 3.1747}:  90%|█████████ | 9/10 [00:22<00:02,  2.40s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9548, 'compress@10': 1.0, 'time@10': 3.1747}: 100%|██████████| 10/10 [00:22<00:00,  2.62s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9548, 'compress@10': 1.0, 'time@10': 3.1747}: 100%|██████████| 10/10 [00:22<00:00,  2.28s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.013527603381875558
Avg hit ratio: 0.9006243810895762
Avg ndcg: 0.9547839927985409
Avg compression ratio: 1.0
Avg train time: 3.1747374534606934
Std train time: 1.6492135038518372
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.5937}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.5937}:  10%|█         | 1/10 [00:01<00:11,  1.33s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0024, 'compress@10': 1.0, 'time@10': 2.3616}:  10%|█         | 1/10 [00:03<00:11,  1.33s/it] {'epoch': 44, 'num_users': 7.0, 'loss': 0.0186, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0024, 'compress@10': 1.0, 'time@10': 2.3616}:  20%|██        | 2/10 [00:03<00:14,  1.82s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.954, 'compress@10': 1.0, 'time@10': 1.8222}:  20%|██        | 2/10 [00:03<00:14,  1.82s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.954, 'compress@10': 1.0, 'time@10': 1.8222}:  30%|███       | 3/10 [00:03<00:08,  1.18s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9566, 'compress@10': 1.0, 'time@10': 1.816}:  30%|███       | 3/10 [00:05<00:08,  1.18s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9566, 'compress@10': 1.0, 'time@10': 1.816}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9604, 'compress@10': 1.0, 'time@10': 2.898}:  40%|████      | 4/10 [00:09<00:08,  1.44s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.9604, 'compress@10': 1.0, 'time@10': 2.898}:  50%|█████     | 5/10 [00:09<00:11,  2.23s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9642, 'compress@10': 1.0, 'time@10': 2.9628}:  50%|█████     | 5/10 [00:12<00:11,  2.23s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9642, 'compress@10': 1.0, 'time@10': 2.9628}:  60%|██████    | 6/10 [00:12<00:10,  2.60s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9629, 'compress@10': 1.0, 'time@10': 3.0435}:  60%|██████    | 6/10 [00:14<00:10,  2.60s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9629, 'compress@10': 1.0, 'time@10': 3.0435}:  70%|███████   | 7/10 [00:14<00:07,  2.34s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9658, 'compress@10': 1.0, 'time@10': 2.9569}:  70%|███████   | 7/10 [00:16<00:07,  2.34s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9031, 'ndcg@10': 0.9658, 'compress@10': 1.0, 'time@10': 2.9569}:  80%|████████  | 8/10 [00:16<00:04,  2.36s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9793, 'compress@10': 1.0, 'time@10': 3.2154}:  80%|████████  | 8/10 [00:19<00:04,  2.36s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9793, 'compress@10': 1.0, 'time@10': 3.2154}:  90%|█████████ | 9/10 [00:19<00:02,  2.46s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0169, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.979, 'compress@10': 1.0, 'time@10': 3.2066}:  90%|█████████ | 9/10 [00:22<00:02,  2.46s/it]    {'epoch': 44, 'num_users': 6.3, 'loss': 0.0169, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.979, 'compress@10': 1.0, 'time@10': 3.2066}: 100%|██████████| 10/10 [00:22<00:00,  2.68s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0169, 'hit_ratio@10': 0.9002, 'ndcg@10': 0.979, 'compress@10': 1.0, 'time@10': 3.2066}: 100%|██████████| 10/10 [00:22<00:00,  2.28s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.01688125412932744
Avg hit ratio: 0.9001763524157413
Avg ndcg: 0.9789604793639362
Avg compression ratio: 1.0
Avg train time: 3.206630325317383
Std train time: 1.757903495460459
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.9086}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.9086}:  10%|█         | 1/10 [00:01<00:13,  1.49s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9515, 'compress@10': 1.0, 'time@10': 2.5707}:  10%|█         | 1/10 [00:03<00:13,  1.49s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9515, 'compress@10': 1.0, 'time@10': 2.5707}:  20%|██        | 2/10 [00:03<00:15,  1.95s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9201, 'compress@10': 1.0, 'time@10': 2.0167}:  20%|██        | 2/10 [00:04<00:15,  1.95s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9201, 'compress@10': 1.0, 'time@10': 2.0167}:  30%|███       | 3/10 [00:04<00:09,  1.29s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.9311, 'compress@10': 1.0, 'time@10': 1.9902}:  30%|███       | 3/10 [00:06<00:09,  1.29s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.9311, 'compress@10': 1.0, 'time@10': 1.9902}:  40%|████      | 4/10 [00:06<00:09,  1.55s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.945, 'compress@10': 1.0, 'time@10': 2.9825}:  40%|████      | 4/10 [00:09<00:09,  1.55s/it] {'epoch': 45, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.945, 'compress@10': 1.0, 'time@10': 2.9825}:  50%|█████     | 5/10 [00:09<00:11,  2.26s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.95, 'compress@10': 1.0, 'time@10': 3.0086}:  50%|█████     | 5/10 [00:12<00:11,  2.26s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.95, 'compress@10': 1.0, 'time@10': 3.0086}:  60%|██████    | 6/10 [00:12<00:10,  2.58s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9505, 'compress@10': 1.0, 'time@10': 3.0816}:  60%|██████    | 6/10 [00:14<00:10,  2.58s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.9505, 'compress@10': 1.0, 'time@10': 3.0816}:  70%|███████   | 7/10 [00:14<00:06,  2.32s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9542, 'compress@10': 1.0, 'time@10': 3.0099}:  70%|███████   | 7/10 [00:17<00:06,  2.32s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.9542, 'compress@10': 1.0, 'time@10': 3.0099}:  80%|████████  | 8/10 [00:17<00:04,  2.39s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9667, 'compress@10': 1.0, 'time@10': 3.236}:  80%|████████  | 8/10 [00:19<00:04,  2.39s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9667, 'compress@10': 1.0, 'time@10': 3.236}:  90%|█████████ | 9/10 [00:19<00:02,  2.45s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9666, 'compress@10': 1.0, 'time@10': 3.2264}:  90%|█████████ | 9/10 [00:23<00:02,  2.45s/it]  {'epoch': 45, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9666, 'compress@10': 1.0, 'time@10': 3.2264}: 100%|██████████| 10/10 [00:23<00:00,  2.67s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9666, 'compress@10': 1.0, 'time@10': 3.2264}: 100%|██████████| 10/10 [00:23<00:00,  2.30s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.01512219113524344
Avg hit ratio: 0.8891164445816399
Avg ndcg: 0.9666481405717933
Avg compression ratio: 1.0
Avg train time: 3.2264384508132933
Std train time: 1.6122395739740014
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.6465}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.6465}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.932, 'compress@10': 1.0, 'time@10': 2.4498}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it] {'epoch': 46, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.932, 'compress@10': 1.0, 'time@10': 2.4498}:  20%|██        | 2/10 [00:03<00:15,  1.91s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.907, 'compress@10': 1.0, 'time@10': 1.9306}:  20%|██        | 2/10 [00:04<00:15,  1.91s/it]  {'epoch': 46, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.907, 'compress@10': 1.0, 'time@10': 1.9306}:  30%|███       | 3/10 [00:04<00:08,  1.26s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 1.9134}:  30%|███       | 3/10 [00:06<00:08,  1.26s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8198, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 1.9134}:  40%|████      | 4/10 [00:06<00:09,  1.51s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.934, 'compress@10': 1.0, 'time@10': 2.9466}:  40%|████      | 4/10 [00:09<00:09,  1.51s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.934, 'compress@10': 1.0, 'time@10': 2.9466}:  50%|█████     | 5/10 [00:09<00:11,  2.26s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9411, 'compress@10': 1.0, 'time@10': 2.9945}:  50%|█████     | 5/10 [00:12<00:11,  2.26s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9411, 'compress@10': 1.0, 'time@10': 2.9945}:  60%|██████    | 6/10 [00:12<00:10,  2.60s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9425, 'compress@10': 1.0, 'time@10': 3.045}:  60%|██████    | 6/10 [00:14<00:10,  2.60s/it] {'epoch': 46, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9425, 'compress@10': 1.0, 'time@10': 3.045}:  70%|███████   | 7/10 [00:14<00:06,  2.31s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9467, 'compress@10': 1.0, 'time@10': 2.9516}:  70%|███████   | 7/10 [00:16<00:06,  2.31s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0124, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9467, 'compress@10': 1.0, 'time@10': 2.9516}:  80%|████████  | 8/10 [00:16<00:04,  2.32s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9435, 'compress@10': 1.0, 'time@10': 3.1553}:  80%|████████  | 8/10 [00:19<00:04,  2.32s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9435, 'compress@10': 1.0, 'time@10': 3.1553}:  90%|█████████ | 9/10 [00:19<00:02,  2.35s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 3.1448}:  90%|█████████ | 9/10 [00:22<00:02,  2.35s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 3.1448}: 100%|██████████| 10/10 [00:22<00:00,  2.59s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0128, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 3.1448}: 100%|██████████| 10/10 [00:22<00:00,  2.25s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.012819323334577687
Avg hit ratio: 0.8903422510332527
Avg ndcg: 0.9468468006181201
Avg compression ratio: 1.0
Avg train time: 3.1447733640670776
Std train time: 1.6342720196598235
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.5995}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.5995}:  10%|█         | 1/10 [00:01<00:12,  1.34s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 2.4241}:  10%|█         | 1/10 [00:03<00:12,  1.34s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 2.4241}:  20%|██        | 2/10 [00:03<00:15,  1.89s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9189, 'compress@10': 1.0, 'time@10': 1.9197}:  20%|██        | 2/10 [00:04<00:15,  1.89s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9189, 'compress@10': 1.0, 'time@10': 1.9197}:  30%|███       | 3/10 [00:04<00:08,  1.25s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9294, 'compress@10': 1.0, 'time@10': 1.9327}:  30%|███       | 3/10 [00:06<00:08,  1.25s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.9294, 'compress@10': 1.0, 'time@10': 1.9327}:  40%|████      | 4/10 [00:06<00:09,  1.55s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0083, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9391, 'compress@10': 1.0, 'time@10': 2.9944}:  40%|████      | 4/10 [00:09<00:09,  1.55s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0083, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.9391, 'compress@10': 1.0, 'time@10': 2.9944}:  50%|█████     | 5/10 [00:09<00:11,  2.31s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9448, 'compress@10': 1.0, 'time@10': 3.0367}:  50%|█████     | 5/10 [00:13<00:11,  2.31s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9448, 'compress@10': 1.0, 'time@10': 3.0367}:  60%|██████    | 6/10 [00:13<00:10,  2.64s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9469, 'compress@10': 1.0, 'time@10': 3.12}:  60%|██████    | 6/10 [00:14<00:10,  2.64s/it]  {'epoch': 47, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9469, 'compress@10': 1.0, 'time@10': 3.12}:  70%|███████   | 7/10 [00:14<00:07,  2.38s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9184, 'ndcg@10': 0.9521, 'compress@10': 1.0, 'time@10': 3.0226}:  70%|███████   | 7/10 [00:17<00:07,  2.38s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9184, 'ndcg@10': 0.9521, 'compress@10': 1.0, 'time@10': 3.0226}:  80%|████████  | 8/10 [00:17<00:04,  2.39s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9534, 'compress@10': 1.0, 'time@10': 3.2111}:  80%|████████  | 8/10 [00:19<00:04,  2.39s/it] {'epoch': 47, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.9116, 'ndcg@10': 0.9534, 'compress@10': 1.0, 'time@10': 3.2111}:  90%|█████████ | 9/10 [00:19<00:02,  2.39s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9181, 'ndcg@10': 0.9558, 'compress@10': 1.0, 'time@10': 3.195}:  90%|█████████ | 9/10 [00:22<00:02,  2.39s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9181, 'ndcg@10': 0.9558, 'compress@10': 1.0, 'time@10': 3.195}: 100%|██████████| 10/10 [00:22<00:00,  2.60s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.01, 'hit_ratio@10': 0.9181, 'ndcg@10': 0.9558, 'compress@10': 1.0, 'time@10': 3.195}: 100%|██████████| 10/10 [00:22<00:00,  2.28s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.009971862650023349
Avg hit ratio: 0.9181359018269035
Avg ndcg: 0.9557750879752828
Avg compression ratio: 1.0
Avg train time: 3.1949893951416017
Std train time: 1.661099065401572
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.7644}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9384, 'compress@10': 1.0, 'time@10': 2.7644}:  10%|█         | 1/10 [00:01<00:12,  1.42s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9531, 'compress@10': 1.0, 'time@10': 2.4994}:  10%|█         | 1/10 [00:03<00:12,  1.42s/it] {'epoch': 48, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9531, 'compress@10': 1.0, 'time@10': 2.4994}:  20%|██        | 2/10 [00:03<00:15,  1.92s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 1.9693}:  20%|██        | 2/10 [00:04<00:15,  1.92s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 1.9693}:  30%|███       | 3/10 [00:04<00:08,  1.27s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9319, 'compress@10': 1.0, 'time@10': 1.9402}:  30%|███       | 3/10 [00:06<00:08,  1.27s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9319, 'compress@10': 1.0, 'time@10': 1.9402}:  40%|████      | 4/10 [00:06<00:09,  1.52s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9407, 'compress@10': 1.0, 'time@10': 2.9726}:  40%|████      | 4/10 [00:09<00:09,  1.52s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9407, 'compress@10': 1.0, 'time@10': 2.9726}:  50%|█████     | 5/10 [00:09<00:11,  2.27s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.0195}:  50%|█████     | 5/10 [00:12<00:11,  2.27s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.0195}:  60%|██████    | 6/10 [00:12<00:10,  2.62s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9545, 'compress@10': 1.0, 'time@10': 3.0909}:  60%|██████    | 6/10 [00:14<00:10,  2.62s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9545, 'compress@10': 1.0, 'time@10': 3.0909}:  70%|███████   | 7/10 [00:14<00:07,  2.35s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9616, 'compress@10': 1.0, 'time@10': 3.0091}:  70%|███████   | 7/10 [00:17<00:07,  2.35s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9616, 'compress@10': 1.0, 'time@10': 3.0091}:  80%|████████  | 8/10 [00:17<00:04,  2.39s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9621, 'compress@10': 1.0, 'time@10': 3.2138}:  80%|████████  | 8/10 [00:19<00:04,  2.39s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8716, 'ndcg@10': 0.9621, 'compress@10': 1.0, 'time@10': 3.2138}:  90%|█████████ | 9/10 [00:19<00:02,  2.41s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9639, 'compress@10': 1.0, 'time@10': 3.1853}:  90%|█████████ | 9/10 [00:22<00:02,  2.41s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9639, 'compress@10': 1.0, 'time@10': 3.1853}: 100%|██████████| 10/10 [00:22<00:00,  2.59s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9639, 'compress@10': 1.0, 'time@10': 3.1853}: 100%|██████████| 10/10 [00:22<00:00,  2.27s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.01553330858662134
Avg hit ratio: 0.8821604793998683
Avg ndcg: 0.9639235249481892
Avg compression ratio: 1.0
Avg train time: 3.185259199142456
Std train time: 1.6400728723461504
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9406, 'compress@10': 1.0, 'time@10': 2.515}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0081, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9406, 'compress@10': 1.0, 'time@10': 2.515}:  10%|█         | 1/10 [00:01<00:11,  1.29s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9893, 'compress@10': 1.0, 'time@10': 2.3573}:  10%|█         | 1/10 [00:03<00:11,  1.29s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9893, 'compress@10': 1.0, 'time@10': 2.3573}:  20%|██        | 2/10 [00:03<00:14,  1.85s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9452, 'compress@10': 1.0, 'time@10': 1.8258}:  20%|██        | 2/10 [00:03<00:14,  1.85s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9452, 'compress@10': 1.0, 'time@10': 1.8258}:  30%|███       | 3/10 [00:03<00:08,  1.20s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.95, 'compress@10': 1.0, 'time@10': 1.8531}:  30%|███       | 3/10 [00:05<00:08,  1.20s/it]    {'epoch': 49, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.95, 'compress@10': 1.0, 'time@10': 1.8531}:  40%|████      | 4/10 [00:05<00:09,  1.51s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9551, 'compress@10': 1.0, 'time@10': 2.9622}:  40%|████      | 4/10 [00:09<00:09,  1.51s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9551, 'compress@10': 1.0, 'time@10': 2.9622}:  50%|█████     | 5/10 [00:09<00:11,  2.31s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9586, 'compress@10': 1.0, 'time@10': 3.0229}:  50%|█████     | 5/10 [00:13<00:11,  2.31s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.866, 'ndcg@10': 0.9586, 'compress@10': 1.0, 'time@10': 3.0229}:  60%|██████    | 6/10 [00:13<00:10,  2.67s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9579, 'compress@10': 1.0, 'time@10': 3.0774}:  60%|██████    | 6/10 [00:14<00:10,  2.67s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9579, 'compress@10': 1.0, 'time@10': 3.0774}:  70%|███████   | 7/10 [00:14<00:07,  2.37s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0097, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9629, 'compress@10': 1.0, 'time@10': 2.9877}:  70%|███████   | 7/10 [00:17<00:07,  2.37s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0097, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9629, 'compress@10': 1.0, 'time@10': 2.9877}:  80%|████████  | 8/10 [00:17<00:04,  2.38s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9635, 'compress@10': 1.0, 'time@10': 3.1952}:  80%|████████  | 8/10 [00:19<00:04,  2.38s/it] {'epoch': 49, 'num_users': 6.3333, 'loss': 0.009, 'hit_ratio@10': 0.884, 'ndcg@10': 0.9635, 'compress@10': 1.0, 'time@10': 3.1952}:  90%|█████████ | 9/10 [00:19<00:02,  2.41s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9644, 'compress@10': 1.0, 'time@10': 3.1831}:  90%|█████████ | 9/10 [00:22<00:02,  2.41s/it] {'epoch': 49, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9644, 'compress@10': 1.0, 'time@10': 3.1831}: 100%|██████████| 10/10 [00:22<00:00,  2.63s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0092, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9644, 'compress@10': 1.0, 'time@10': 3.1831}: 100%|██████████| 10/10 [00:22<00:00,  2.28s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.009183524096146839
Avg hit ratio: 0.893322793787989
Avg ndcg: 0.9643658049481629
Avg compression ratio: 1.0
Avg train time: 3.183143162727356
Std train time: 1.7365318379564036
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
