  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.21, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.5317, 'compress@10': 1.0, 'time@10': 3.955}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.21, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.5317, 'compress@10': 1.0, 'time@10': 3.955}:  10%|█         | 1/10 [00:02<00:18,  2.02s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1536, 'hit_ratio@10': 0.539, 'ndcg@10': 0.5736, 'compress@10': 1.0, 'time@10': 3.1746}:  10%|█         | 1/10 [00:04<00:18,  2.02s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1536, 'hit_ratio@10': 0.539, 'ndcg@10': 0.5736, 'compress@10': 1.0, 'time@10': 3.1746}:  20%|██        | 2/10 [00:04<00:18,  2.26s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9307, 'hit_ratio@10': 0.3594, 'ndcg@10': 0.3824, 'compress@10': 1.0, 'time@10': 2.4204}:  20%|██        | 2/10 [00:04<00:18,  2.26s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9307, 'hit_ratio@10': 0.3594, 'ndcg@10': 0.3824, 'compress@10': 1.0, 'time@10': 2.4204}:  30%|███       | 3/10 [00:04<00:10,  1.45s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7328, 'hit_ratio@10': 0.457, 'ndcg@10': 0.4254, 'compress@10': 1.0, 'time@10': 2.3579}:  30%|███       | 3/10 [00:07<00:10,  1.45s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.7328, 'hit_ratio@10': 0.457, 'ndcg@10': 0.4254, 'compress@10': 1.0, 'time@10': 2.3579}:  40%|████      | 4/10 [00:07<00:10,  1.75s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.6057, 'hit_ratio@10': 0.5296, 'ndcg@10': 0.4867, 'compress@10': 1.0, 'time@10': 3.4597}:  40%|████      | 4/10 [00:11<00:10,  1.75s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.6057, 'hit_ratio@10': 0.5296, 'ndcg@10': 0.4867, 'compress@10': 1.0, 'time@10': 3.4597}:  50%|█████     | 5/10 [00:11<00:12,  2.55s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.52, 'hit_ratio@10': 0.5599, 'ndcg@10': 0.5318, 'compress@10': 1.0, 'time@10': 3.478}:  50%|█████     | 5/10 [00:14<00:12,  2.55s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.52, 'hit_ratio@10': 0.5599, 'ndcg@10': 0.5318, 'compress@10': 1.0, 'time@10': 3.478}:  60%|██████    | 6/10 [00:14<00:11,  2.91s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4663, 'hit_ratio@10': 0.577, 'ndcg@10': 0.5324, 'compress@10': 1.0, 'time@10': 3.5272}:  60%|██████    | 6/10 [00:16<00:11,  2.91s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4663, 'hit_ratio@10': 0.577, 'ndcg@10': 0.5324, 'compress@10': 1.0, 'time@10': 3.5272}:  70%|███████   | 7/10 [00:16<00:07,  2.60s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.4161, 'hit_ratio@10': 0.6192, 'ndcg@10': 0.5578, 'compress@10': 1.0, 'time@10': 3.4217}:  70%|███████   | 7/10 [00:19<00:07,  2.60s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.4161, 'hit_ratio@10': 0.6192, 'ndcg@10': 0.5578, 'compress@10': 1.0, 'time@10': 3.4217}:  80%|████████  | 8/10 [00:19<00:05,  2.64s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3779, 'hit_ratio@10': 0.6298, 'ndcg@10': 0.5947, 'compress@10': 1.0, 'time@10': 3.6452}:  80%|████████  | 8/10 [00:22<00:05,  2.64s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3779, 'hit_ratio@10': 0.6298, 'ndcg@10': 0.5947, 'compress@10': 1.0, 'time@10': 3.6452}:  90%|█████████ | 9/10 [00:22<00:02,  2.67s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.346, 'hit_ratio@10': 0.66, 'ndcg@10': 0.614, 'compress@10': 1.0, 'time@10': 3.62}:  90%|█████████ | 9/10 [00:25<00:02,  2.67s/it]         {'epoch': 0, 'num_users': 6.3, 'loss': 0.346, 'hit_ratio@10': 0.66, 'ndcg@10': 0.614, 'compress@10': 1.0, 'time@10': 3.62}: 100%|██████████| 10/10 [00:25<00:00,  2.91s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.346, 'hit_ratio@10': 0.66, 'ndcg@10': 0.614, 'compress@10': 1.0, 'time@10': 3.62}: 100%|██████████| 10/10 [00:25<00:00,  2.56s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3459956260135826
Avg hit ratio: 0.659959919348714
Avg ndcg: 0.6139724342710393
Avg compression ratio: 1.0
Avg train time: 3.620040941238403
Std train time: 1.8261047122250773
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[11, 7, 3, 6, 22, 10, 11, 7, 15, 9]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0556, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8336, 'compress@10': 1.0, 'time@10': 3.1299}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0556, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8336, 'compress@10': 1.0, 'time@10': 3.1299}:  10%|█         | 1/10 [00:01<00:14,  1.60s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0586, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8415, 'compress@10': 1.0, 'time@10': 2.35}:  10%|█         | 1/10 [00:03<00:14,  1.60s/it]  {'epoch': 1, 'num_users': 7.0, 'loss': 0.0586, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8415, 'compress@10': 1.0, 'time@10': 2.35}:  20%|██        | 2/10 [00:03<00:12,  1.61s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.2295, 'hit_ratio@10': 0.6942, 'ndcg@10': 0.62, 'compress@10': 1.0, 'time@10': 1.6722}:  20%|██        | 2/10 [00:03<00:12,  1.61s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.2295, 'hit_ratio@10': 0.6942, 'ndcg@10': 0.62, 'compress@10': 1.0, 'time@10': 1.6722}:  30%|███       | 3/10 [00:03<00:06,  1.04it/s]{'epoch': 1, 'num_users': 5.0, 'loss': 0.1899, 'hit_ratio@10': 0.7349, 'ndcg@10': 0.6558, 'compress@10': 1.0, 'time@10': 1.5543}:  30%|███       | 3/10 [00:04<00:06,  1.04it/s]{'epoch': 1, 'num_users': 5.0, 'loss': 0.1899, 'hit_ratio@10': 0.7349, 'ndcg@10': 0.6558, 'compress@10': 1.0, 'time@10': 1.5543}:  40%|████      | 4/10 [00:04<00:06,  1.07s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.1647, 'hit_ratio@10': 0.7559, 'ndcg@10': 0.6875, 'compress@10': 1.0, 'time@10': 4.6052}:  40%|████      | 4/10 [00:13<00:06,  1.07s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.1647, 'hit_ratio@10': 0.7559, 'ndcg@10': 0.6875, 'compress@10': 1.0, 'time@10': 4.6052}:  50%|█████     | 5/10 [00:13<00:18,  3.73s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.1501, 'hit_ratio@10': 0.7559, 'ndcg@10': 0.7081, 'compress@10': 1.0, 'time@10': 4.4135}:  50%|█████     | 5/10 [00:16<00:18,  3.73s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.1501, 'hit_ratio@10': 0.7559, 'ndcg@10': 0.7081, 'compress@10': 1.0, 'time@10': 4.4135}:  60%|██████    | 6/10 [00:16<00:14,  3.65s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.1349, 'hit_ratio@10': 0.785, 'ndcg@10': 0.7319, 'compress@10': 1.0, 'time@10': 4.3895}:  60%|██████    | 6/10 [00:18<00:14,  3.65s/it] {'epoch': 1, 'num_users': 6.2857, 'loss': 0.1349, 'hit_ratio@10': 0.785, 'ndcg@10': 0.7319, 'compress@10': 1.0, 'time@10': 4.3895}:  70%|███████   | 7/10 [00:18<00:09,  3.16s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.1235, 'hit_ratio@10': 0.8012, 'ndcg@10': 0.7432, 'compress@10': 1.0, 'time@10': 4.0605}:  70%|███████   | 7/10 [00:20<00:09,  3.16s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.1235, 'hit_ratio@10': 0.8012, 'ndcg@10': 0.7432, 'compress@10': 1.0, 'time@10': 4.0605}:  80%|████████  | 8/10 [00:20<00:05,  2.73s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.1133, 'hit_ratio@10': 0.7915, 'ndcg@10': 0.7617, 'compress@10': 1.0, 'time@10': 4.496}:  80%|████████  | 8/10 [00:24<00:05,  2.73s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.1133, 'hit_ratio@10': 0.7915, 'ndcg@10': 0.7617, 'compress@10': 1.0, 'time@10': 4.496}:  90%|█████████ | 9/10 [00:24<00:03,  3.13s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.1067, 'hit_ratio@10': 0.8056, 'ndcg@10': 0.7702, 'compress@10': 1.0, 'time@10': 4.3332}:  90%|█████████ | 9/10 [00:27<00:03,  3.13s/it]  {'epoch': 1, 'num_users': 6.3, 'loss': 0.1067, 'hit_ratio@10': 0.8056, 'ndcg@10': 0.7702, 'compress@10': 1.0, 'time@10': 4.3332}: 100%|██████████| 10/10 [00:27<00:00,  3.07s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.1067, 'hit_ratio@10': 0.8056, 'ndcg@10': 0.7702, 'compress@10': 1.0, 'time@10': 4.3332}: 100%|██████████| 10/10 [00:27<00:00,  2.75s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.10669884178501725
Avg hit ratio: 0.805555224816685
Avg ndcg: 0.7702262308610558
Avg compression ratio: 1.0
Avg train time: 4.3332031726837155
Std train time: 4.620869868639041
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 1, 1, 1, 58, 10, 13, 2, 27, 7]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 2.7785}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 2.7785}:  10%|█         | 1/10 [00:01<00:12,  1.43s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.1073, 'hit_ratio@10': 0.7012, 'ndcg@10': 0.7075, 'compress@10': 1.0, 'time@10': 1.5122}:  10%|█         | 1/10 [00:01<00:12,  1.43s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.1073, 'hit_ratio@10': 0.7012, 'ndcg@10': 0.7075, 'compress@10': 1.0, 'time@10': 1.5122}:  20%|██        | 2/10 [00:01<00:06,  1.32it/s]{'epoch': 2, 'num_users': 5.0, 'loss': 0.1929, 'hit_ratio@10': 0.6103, 'ndcg@10': 0.5621, 'compress@10': 1.0, 'time@10': 1.0402}:  20%|██        | 2/10 [00:01<00:06,  1.32it/s]{'epoch': 2, 'num_users': 5.0, 'loss': 0.1963, 'hit_ratio@10': 0.5781, 'ndcg@10': 0.5566, 'compress@10': 1.0, 'time@10': 0.8285}:  20%|██        | 2/10 [00:02<00:06,  1.32it/s]{'epoch': 2, 'num_users': 5.0, 'loss': 0.1963, 'hit_ratio@10': 0.5781, 'ndcg@10': 0.5566, 'compress@10': 1.0, 'time@10': 0.8285}:  40%|████      | 4/10 [00:02<00:02,  2.62it/s]{'epoch': 2, 'num_users': 5.8, 'loss': 0.1595, 'hit_ratio@10': 0.6505, 'ndcg@10': 0.6328, 'compress@10': 1.0, 'time@10': 9.5223}:  40%|████      | 4/10 [00:24<00:02,  2.62it/s]{'epoch': 2, 'num_users': 5.8, 'loss': 0.1595, 'hit_ratio@10': 0.6505, 'ndcg@10': 0.6328, 'compress@10': 1.0, 'time@10': 9.5223}:  50%|█████     | 5/10 [00:24<00:35,  7.13s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.1452, 'hit_ratio@10': 0.668, 'ndcg@10': 0.6638, 'compress@10': 1.0, 'time@10': 8.5206}:  50%|█████     | 5/10 [00:27<00:35,  7.13s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.1452, 'hit_ratio@10': 0.668, 'ndcg@10': 0.6638, 'compress@10': 1.0, 'time@10': 8.5206}:  60%|██████    | 6/10 [00:27<00:24,  6.04s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.1302, 'hit_ratio@10': 0.7097, 'ndcg@10': 0.6915, 'compress@10': 1.0, 'time@10': 8.0108}:  60%|██████    | 6/10 [00:30<00:24,  6.04s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.1302, 'hit_ratio@10': 0.7097, 'ndcg@10': 0.6915, 'compress@10': 1.0, 'time@10': 8.0108}:  70%|███████   | 7/10 [00:30<00:14,  4.96s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.1267, 'hit_ratio@10': 0.7246, 'ndcg@10': 0.6806, 'compress@10': 1.0, 'time@10': 7.0715}:  70%|███████   | 7/10 [00:30<00:14,  4.96s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.1267, 'hit_ratio@10': 0.7246, 'ndcg@10': 0.6806, 'compress@10': 1.0, 'time@10': 7.0715}:  80%|████████  | 8/10 [00:30<00:07,  3.62s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.1156, 'hit_ratio@10': 0.7298, 'ndcg@10': 0.7078, 'compress@10': 1.0, 'time@10': 7.9219}:  80%|████████  | 8/10 [00:38<00:07,  3.62s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.1156, 'hit_ratio@10': 0.7298, 'ndcg@10': 0.7078, 'compress@10': 1.0, 'time@10': 7.9219}:  90%|█████████ | 9/10 [00:38<00:04,  4.76s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.1089, 'hit_ratio@10': 0.75, 'ndcg@10': 0.7219, 'compress@10': 1.0, 'time@10': 7.3542}:  90%|█████████ | 9/10 [00:40<00:04,  4.76s/it]     {'epoch': 2, 'num_users': 6.3, 'loss': 0.1089, 'hit_ratio@10': 0.75, 'ndcg@10': 0.7219, 'compress@10': 1.0, 'time@10': 7.3542}: 100%|██████████| 10/10 [00:40<00:00,  4.02s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.1089, 'hit_ratio@10': 0.75, 'ndcg@10': 0.7219, 'compress@10': 1.0, 'time@10': 7.3542}: 100%|██████████| 10/10 [00:40<00:00,  4.05s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.10885209696524503
Avg hit ratio: 0.7499803557443625
Avg ndcg: 0.721908298314529
Avg compression ratio: 1.0
Avg train time: 7.354199385643005
Std train time: 12.993178864443173
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[8, 1, 1, 1, 170, 10, 17, 1, 58, 3]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8374, 'compress@10': 1.0, 'time@10': 2.1103}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0506, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8374, 'compress@10': 1.0, 'time@10': 2.1103}:  10%|█         | 1/10 [00:01<00:09,  1.09s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.1026, 'hit_ratio@10': 0.691, 'ndcg@10': 0.721, 'compress@10': 1.0, 'time@10': 1.1772}:  10%|█         | 1/10 [00:01<00:09,  1.09s/it]  {'epoch': 3, 'num_users': 7.0, 'loss': 0.1026, 'hit_ratio@10': 0.691, 'ndcg@10': 0.721, 'compress@10': 1.0, 'time@10': 1.1772}:  20%|██        | 2/10 [00:01<00:04,  1.60it/s]{'epoch': 3, 'num_users': 5.0, 'loss': 0.1603, 'hit_ratio@10': 0.6035, 'ndcg@10': 0.5895, 'compress@10': 1.0, 'time@10': 0.8227}:  20%|██        | 2/10 [00:01<00:04,  1.60it/s]{'epoch': 3, 'num_users': 5.0, 'loss': 0.1603, 'hit_ratio@10': 0.6035, 'ndcg@10': 0.5895, 'compress@10': 1.0, 'time@10': 0.8227}:  30%|███       | 3/10 [00:01<00:02,  2.60it/s]{'epoch': 3, 'num_users': 5.0, 'loss': 0.1671, 'hit_ratio@10': 0.573, 'ndcg@10': 0.5844, 'compress@10': 1.0, 'time@10': 0.6693}:  30%|███       | 3/10 [00:01<00:02,  2.60it/s] {'epoch': 3, 'num_users': 5.0, 'loss': 0.1671, 'hit_ratio@10': 0.573, 'ndcg@10': 0.5844, 'compress@10': 1.0, 'time@10': 0.6693}:  40%|████      | 4/10 [00:01<00:01,  3.03it/s]{'epoch': 3, 'num_users': 5.8, 'loss': 0.1345, 'hit_ratio@10': 0.6544, 'ndcg@10': 0.6635, 'compress@10': 1.0, 'time@10': 26.4633}:  40%|████      | 4/10 [01:06<00:01,  3.03it/s]{'epoch': 3, 'num_users': 5.8, 'loss': 0.1345, 'hit_ratio@10': 0.6544, 'ndcg@10': 0.6635, 'compress@10': 1.0, 'time@10': 26.4633}:  50%|█████     | 5/10 [01:06<01:57, 23.60s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.1237, 'hit_ratio@10': 0.6787, 'ndcg@10': 0.6904, 'compress@10': 1.0, 'time@10': 22.6052}:  50%|█████     | 5/10 [01:09<01:57, 23.60s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.1237, 'hit_ratio@10': 0.6787, 'ndcg@10': 0.6904, 'compress@10': 1.0, 'time@10': 22.6052}:  60%|██████    | 6/10 [01:09<01:06, 16.71s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.1119, 'hit_ratio@10': 0.7189, 'ndcg@10': 0.714, 'compress@10': 1.0, 'time@10': 20.2485}:  60%|██████    | 6/10 [01:13<01:06, 16.71s/it] {'epoch': 3, 'num_users': 6.2857, 'loss': 0.1119, 'hit_ratio@10': 0.7189, 'ndcg@10': 0.714, 'compress@10': 1.0, 'time@10': 20.2485}:  70%|███████   | 7/10 [01:13<00:36, 12.26s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.117, 'hit_ratio@10': 0.7209, 'ndcg@10': 0.6933, 'compress@10': 1.0, 'time@10': 17.7505}:  70%|███████   | 7/10 [01:13<00:36, 12.26s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.117, 'hit_ratio@10': 0.7209, 'ndcg@10': 0.6933, 'compress@10': 1.0, 'time@10': 17.7505}:  80%|████████  | 8/10 [01:13<00:16,  8.45s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.1076, 'hit_ratio@10': 0.7265, 'ndcg@10': 0.7262, 'compress@10': 1.0, 'time@10': 19.1623}:  80%|████████  | 8/10 [01:28<00:16,  8.45s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.1076, 'hit_ratio@10': 0.7265, 'ndcg@10': 0.7262, 'compress@10': 1.0, 'time@10': 19.1623}:  90%|█████████ | 9/10 [01:28<00:10, 10.58s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.1028, 'hit_ratio@10': 0.7425, 'ndcg@10': 0.7336, 'compress@10': 1.0, 'time@10': 17.3438}:  90%|█████████ | 9/10 [01:29<00:10, 10.58s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.1028, 'hit_ratio@10': 0.7425, 'ndcg@10': 0.7336, 'compress@10': 1.0, 'time@10': 17.3438}: 100%|██████████| 10/10 [01:29<00:00,  7.63s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.1028, 'hit_ratio@10': 0.7425, 'ndcg@10': 0.7336, 'compress@10': 1.0, 'time@10': 17.3438}: 100%|██████████| 10/10 [01:29<00:00,  8.96s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.1027599346836853
Avg hit ratio: 0.7425142631077916
Avg ndcg: 0.7335773208219006
Avg compression ratio: 1.0
Avg train time: 17.343768072128295
Std train time: 38.44442587203652
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[4, 1, 1, 1, 518, 9, 24, 1, 132, 1]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0797, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.7383, 'compress@10': 1.0, 'time@10': 1.1158}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0797, 'hit_ratio@10': 0.6842, 'ndcg@10': 0.7383, 'compress@10': 1.0, 'time@10': 1.1158}:  10%|█         | 1/10 [00:00<00:05,  1.68it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1207, 'hit_ratio@10': 0.6163, 'ndcg@10': 0.6782, 'compress@10': 1.0, 'time@10': 0.6723}:  10%|█         | 1/10 [00:00<00:05,  1.68it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1207, 'hit_ratio@10': 0.6163, 'ndcg@10': 0.6782, 'compress@10': 1.0, 'time@10': 0.6723}:  20%|██        | 2/10 [00:00<00:03,  2.49it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.1658, 'hit_ratio@10': 0.5537, 'ndcg@10': 0.5788, 'compress@10': 1.0, 'time@10': 0.4846}:  20%|██        | 2/10 [00:00<00:03,  2.49it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.1722, 'hit_ratio@10': 0.5357, 'ndcg@10': 0.5754, 'compress@10': 1.0, 'time@10': 0.4132}:  20%|██        | 2/10 [00:01<00:03,  2.49it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.1722, 'hit_ratio@10': 0.5357, 'ndcg@10': 0.5754, 'compress@10': 1.0, 'time@10': 0.4132}:  40%|████      | 4/10 [00:01<00:01,  3.95it/s]{'epoch': 4, 'num_users': 5.8, 'loss': 0.138, 'hit_ratio@10': 0.6245, 'ndcg@10': 0.6563, 'compress@10': 1.0, 'time@10': 79.358}:  40%|████      | 4/10 [03:18<00:01,  3.95it/s] {'epoch': 4, 'num_users': 5.8, 'loss': 0.138, 'hit_ratio@10': 0.6245, 'ndcg@10': 0.6563, 'compress@10': 1.0, 'time@10': 79.358}:  50%|█████     | 5/10 [03:18<05:06, 61.30s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.1261, 'hit_ratio@10': 0.6575, 'ndcg@10': 0.6842, 'compress@10': 1.0, 'time@10': 66.6276}:  50%|█████     | 5/10 [03:21<05:06, 61.30s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.1261, 'hit_ratio@10': 0.6575, 'ndcg@10': 0.6842, 'compress@10': 1.0, 'time@10': 66.6276}:  60%|██████    | 6/10 [03:21<02:53, 43.43s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.1126, 'hit_ratio@10': 0.7007, 'ndcg@10': 0.7154, 'compress@10': 1.0, 'time@10': 58.3837}:  60%|██████    | 6/10 [03:26<02:53, 43.43s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.1126, 'hit_ratio@10': 0.7007, 'ndcg@10': 0.7154, 'compress@10': 1.0, 'time@10': 58.3837}:  70%|███████   | 7/10 [03:26<01:34, 31.58s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.1173, 'hit_ratio@10': 0.694, 'ndcg@10': 0.6954, 'compress@10': 1.0, 'time@10': 51.1184}:  70%|███████   | 7/10 [03:26<01:34, 31.58s/it]  {'epoch': 4, 'num_users': 6.125, 'loss': 0.1173, 'hit_ratio@10': 0.694, 'ndcg@10': 0.6954, 'compress@10': 1.0, 'time@10': 51.1184}:  80%|████████  | 8/10 [03:26<00:44, 22.10s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.1059, 'hit_ratio@10': 0.7089, 'ndcg@10': 0.7259, 'compress@10': 1.0, 'time@10': 53.3264}:  80%|████████  | 8/10 [04:02<00:44, 22.10s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.1059, 'hit_ratio@10': 0.7089, 'ndcg@10': 0.7259, 'compress@10': 1.0, 'time@10': 53.3264}:  90%|█████████ | 9/10 [04:02<00:26, 26.16s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.1096, 'hit_ratio@10': 0.7055, 'ndcg@10': 0.7145, 'compress@10': 1.0, 'time@10': 48.0258}:  90%|█████████ | 9/10 [04:02<00:26, 26.16s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.1096, 'hit_ratio@10': 0.7055, 'ndcg@10': 0.7145, 'compress@10': 1.0, 'time@10': 48.0258}: 100%|██████████| 10/10 [04:02<00:00, 18.38s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.1096, 'hit_ratio@10': 0.7055, 'ndcg@10': 0.7145, 'compress@10': 1.0, 'time@10': 48.0258}: 100%|██████████| 10/10 [04:02<00:00, 24.25s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.10962598530145262
Avg hit ratio: 0.7054921612117118
Avg ndcg: 0.7145001958848466
Avg compression ratio: 1.0
Avg train time: 48.025756168365476
Std train time: 117.55763983448301
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[1, 1, 1, 1, 1600, 7, 39, 1, 318, 1]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.1943, 'hit_ratio@10': 0.5, 'ndcg@10': 0.5623, 'compress@10': 1.0, 'time@10': 0.2754}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.1943, 'hit_ratio@10': 0.5, 'ndcg@10': 0.5623, 'compress@10': 1.0, 'time@10': 0.2754}:  10%|█         | 1/10 [00:00<00:01,  5.74it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.1845, 'hit_ratio@10': 0.4919, 'ndcg@10': 0.5775, 'compress@10': 1.0, 'time@10': 0.2536}:  10%|█         | 1/10 [00:00<00:01,  5.74it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.1845, 'hit_ratio@10': 0.4919, 'ndcg@10': 0.5775, 'compress@10': 1.0, 'time@10': 0.2536}:  20%|██        | 2/10 [00:00<00:01,  4.35it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.2142, 'hit_ratio@10': 0.4708, 'ndcg@10': 0.5088, 'compress@10': 1.0, 'time@10': 0.209}:  20%|██        | 2/10 [00:00<00:01,  4.35it/s] {'epoch': 5, 'num_users': 5.0, 'loss': 0.2136, 'hit_ratio@10': 0.4827, 'ndcg@10': 0.5226, 'compress@10': 1.0, 'time@10': 0.2076}:  20%|██        | 2/10 [00:00<00:01,  4.35it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.2136, 'hit_ratio@10': 0.4827, 'ndcg@10': 0.5226, 'compress@10': 1.0, 'time@10': 0.2076}:  40%|████      | 4/10 [00:00<00:01,  5.18it/s]{'epoch': 5, 'num_users': 5.8, 'loss': 0.171, 'hit_ratio@10': 0.5822, 'ndcg@10': 0.6141, 'compress@10': 1.0, 'time@10': 247.1497}:  40%|████      | 4/10 [10:18<00:01,  5.18it/s]{'epoch': 5, 'num_users': 5.8, 'loss': 0.171, 'hit_ratio@10': 0.5822, 'ndcg@10': 0.6141, 'compress@10': 1.0, 'time@10': 247.1497}:  50%|█████     | 5/10 [10:18<15:55, 191.13s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.1533, 'hit_ratio@10': 0.6222, 'ndcg@10': 0.649, 'compress@10': 1.0, 'time@10': 206.3535}:  50%|█████     | 5/10 [10:20<15:55, 191.13s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.1533, 'hit_ratio@10': 0.6222, 'ndcg@10': 0.649, 'compress@10': 1.0, 'time@10': 206.3535}:  60%|██████    | 6/10 [10:20<08:53, 133.30s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.1342, 'hit_ratio@10': 0.6705, 'ndcg@10': 0.6885, 'compress@10': 1.0, 'time@10': 178.9387}:  60%|██████    | 6/10 [10:27<08:53, 133.30s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.1342, 'hit_ratio@10': 0.6705, 'ndcg@10': 0.6885, 'compress@10': 1.0, 'time@10': 178.9387}:  70%|███████   | 7/10 [10:27<04:44, 94.92s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.1385, 'hit_ratio@10': 0.6749, 'ndcg@10': 0.6697, 'compress@10': 1.0, 'time@10': 156.6022}:  70%|███████   | 7/10 [10:28<04:44, 94.92s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.1385, 'hit_ratio@10': 0.6749, 'ndcg@10': 0.6697, 'compress@10': 1.0, 'time@10': 156.6022}:  80%|████████  | 8/10 [10:28<02:12, 66.23s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.1233, 'hit_ratio@10': 0.6761, 'ndcg@10': 0.7033, 'compress@10': 1.0, 'time@10': 157.8536}:  80%|████████  | 8/10 [11:52<02:12, 66.23s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.1233, 'hit_ratio@10': 0.6761, 'ndcg@10': 0.7033, 'compress@10': 1.0, 'time@10': 157.8536}:  90%|█████████ | 9/10 [11:52<01:11, 71.60s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.1256, 'hit_ratio@10': 0.6689, 'ndcg@10': 0.6951, 'compress@10': 1.0, 'time@10': 142.0988}:  90%|█████████ | 9/10 [11:52<01:11, 71.60s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.1256, 'hit_ratio@10': 0.6689, 'ndcg@10': 0.6951, 'compress@10': 1.0, 'time@10': 142.0988}: 100%|██████████| 10/10 [11:52<00:00, 50.12s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.1256, 'hit_ratio@10': 0.6689, 'ndcg@10': 0.6951, 'compress@10': 1.0, 'time@10': 142.0988}: 100%|██████████| 10/10 [11:52<00:00, 71.26s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.12556798409653916
Avg hit ratio: 0.6689430938500266
Avg ndcg: 0.6950596312825881
Avg compression ratio: 1.0
Avg train time: 142.09878120422363
Std train time: 367.6268777589303
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[1, 1, 1, 1, 5001, 4, 69, 1, 772, 1]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2181, 'hit_ratio@10': 0.5, 'ndcg@10': 0.4898, 'compress@10': 1.0, 'time@10': 0.2796}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2181, 'hit_ratio@10': 0.5, 'ndcg@10': 0.4898, 'compress@10': 1.0, 'time@10': 0.2796}:  10%|█         | 1/10 [00:00<00:01,  5.71it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2096, 'hit_ratio@10': 0.4597, 'ndcg@10': 0.5084, 'compress@10': 1.0, 'time@10': 0.2488}:  10%|█         | 1/10 [00:00<00:01,  5.71it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.2096, 'hit_ratio@10': 0.4597, 'ndcg@10': 0.5084, 'compress@10': 1.0, 'time@10': 0.2488}:  20%|██        | 2/10 [00:00<00:01,  4.52it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.2414, 'hit_ratio@10': 0.4493, 'ndcg@10': 0.4405, 'compress@10': 1.0, 'time@10': 0.2057}:  20%|██        | 2/10 [00:00<00:01,  4.52it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.2414, 'hit_ratio@10': 0.4493, 'ndcg@10': 0.4405, 'compress@10': 1.0, 'time@10': 0.2057}:  30%|███       | 3/10 [00:00<00:01,  6.01it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.2432, 'hit_ratio@10': 0.4574, 'ndcg@10': 0.4478, 'compress@10': 1.0, 'time@10': 0.211}:  30%|███       | 3/10 [00:00<00:01,  6.01it/s] {'epoch': 6, 'num_users': 5.0, 'loss': 0.2432, 'hit_ratio@10': 0.4574, 'ndcg@10': 0.4478, 'compress@10': 1.0, 'time@10': 0.211}:  40%|████      | 4/10 [00:00<00:01,  4.89it/s]{'epoch': 6, 'num_users': 5.8, 'loss': 0.1945, 'hit_ratio@10': 0.5619, 'ndcg@10': 0.5542, 'compress@10': 1.0, 'time@10': 709.5754}:  40%|████      | 4/10 [29:34<00:01,  4.89it/s]{'epoch': 6, 'num_users': 5.8, 'loss': 0.1945, 'hit_ratio@10': 0.5619, 'ndcg@10': 0.5542, 'compress@10': 1.0, 'time@10': 709.5754}:  50%|█████     | 5/10 [29:34<53:18, 639.69s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.1756, 'hit_ratio@10': 0.5979, 'ndcg@10': 0.5915, 'compress@10': 1.0, 'time@10': 591.5181}:  50%|█████     | 5/10 [29:35<53:18, 639.69s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.1756, 'hit_ratio@10': 0.5979, 'ndcg@10': 0.5915, 'compress@10': 1.0, 'time@10': 591.5181}:  60%|██████    | 6/10 [29:35<28:10, 422.62s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.151, 'hit_ratio@10': 0.6496, 'ndcg@10': 0.6432, 'compress@10': 1.0, 'time@10': 510.3565}:  60%|██████    | 6/10 [29:47<28:10, 422.62s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.151, 'hit_ratio@10': 0.6496, 'ndcg@10': 0.6432, 'compress@10': 1.0, 'time@10': 510.3565}:  70%|███████   | 7/10 [29:47<14:24, 288.29s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.1556, 'hit_ratio@10': 0.6456, 'ndcg@10': 0.6209, 'compress@10': 1.0, 'time@10': 446.5893}:  70%|███████   | 7/10 [29:47<14:24, 288.29s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.1556, 'hit_ratio@10': 0.6456, 'ndcg@10': 0.6209, 'compress@10': 1.0, 'time@10': 446.5893}:  80%|████████  | 8/10 [29:47<06:33, 196.60s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.1384, 'hit_ratio@10': 0.6532, 'ndcg@10': 0.6598, 'compress@10': 1.0, 'time@10': 438.2216}:  80%|████████  | 8/10 [32:53<06:33, 196.60s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.1384, 'hit_ratio@10': 0.6532, 'ndcg@10': 0.6598, 'compress@10': 1.0, 'time@10': 438.2216}:  90%|█████████ | 9/10 [32:53<03:13, 193.18s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.1416, 'hit_ratio@10': 0.6484, 'ndcg@10': 0.6535, 'compress@10': 1.0, 'time@10': 394.4282}:  90%|█████████ | 9/10 [32:53<03:13, 193.18s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.1416, 'hit_ratio@10': 0.6484, 'ndcg@10': 0.6535, 'compress@10': 1.0, 'time@10': 394.4282}: 100%|██████████| 10/10 [32:53<00:00, 133.64s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.1416, 'hit_ratio@10': 0.6484, 'ndcg@10': 0.6535, 'compress@10': 1.0, 'time@10': 394.4282}: 100%|██████████| 10/10 [32:53<00:00, 197.36s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.14156893386954467
Avg hit ratio: 0.6483769462440307
Avg ndcg: 0.653468600836601
Avg compression ratio: 1.0
Avg train time: 394.4281900882721
Std train time: 1056.6031877933824
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[1, 1, 1, 1, 14789, 1, 124, 1, 1788, 1]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.3134, 'hit_ratio@10': 0.5556, 'ndcg@10': 0.3035, 'compress@10': 1.0, 'time@10': 0.2407}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.3134, 'hit_ratio@10': 0.5556, 'ndcg@10': 0.3035, 'compress@10': 1.0, 'time@10': 0.2407}:  10%|█         | 1/10 [00:00<00:01,  6.45it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.2981, 'hit_ratio@10': 0.5036, 'ndcg@10': 0.352, 'compress@10': 1.0, 'time@10': 0.225}:  10%|█         | 1/10 [00:00<00:01,  6.45it/s]  {'epoch': 7, 'num_users': 7.0, 'loss': 0.2981, 'hit_ratio@10': 0.5036, 'ndcg@10': 0.352, 'compress@10': 1.0, 'time@10': 0.225}:  20%|██        | 2/10 [00:00<00:01,  4.82it/s]{'epoch': 7, 'num_users': 5.0, 'loss': 0.3296, 'hit_ratio@10': 0.4786, 'ndcg@10': 0.3035, 'compress@10': 1.0, 'time@10': 0.1808}:  20%|██        | 2/10 [00:00<00:01,  4.82it/s]{'epoch': 7, 'num_users': 5.0, 'loss': 0.3329, 'hit_ratio@10': 0.4886, 'ndcg@10': 0.3112, 'compress@10': 1.0, 'time@10': 0.1835}:  20%|██        | 2/10 [00:00<00:01,  4.82it/s]{'epoch': 7, 'num_users': 5.0, 'loss': 0.3329, 'hit_ratio@10': 0.4886, 'ndcg@10': 0.3112, 'compress@10': 1.0, 'time@10': 0.1835}:  40%|████      | 4/10 [00:00<00:01,  5.51it/s]