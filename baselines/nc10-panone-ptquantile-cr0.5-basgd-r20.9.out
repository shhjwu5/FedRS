  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1622, 'hit_ratio@10': 0.6316, 'ndcg@10': 0.5044, 'compress@10': 0.5263, 'time@10': 10.2659}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1622, 'hit_ratio@10': 0.6316, 'ndcg@10': 0.5044, 'compress@10': 0.5263, 'time@10': 10.2659}:  10%|█         | 1/10 [00:05<00:46,  5.17s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1199, 'hit_ratio@10': 0.7029, 'ndcg@10': 0.6376, 'compress@10': 0.5212, 'time@10': 8.8756}:  10%|█         | 1/10 [00:12<00:46,  5.17s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.1199, 'hit_ratio@10': 0.7029, 'ndcg@10': 0.6376, 'compress@10': 0.5212, 'time@10': 8.8756}:  20%|██        | 2/10 [00:12<00:52,  6.56s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7512, 'hit_ratio@10': 0.5638, 'ndcg@10': 0.4251, 'compress@10': 0.538, 'time@10': 6.9163}:  20%|██        | 2/10 [00:14<00:52,  6.56s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.7512, 'hit_ratio@10': 0.5638, 'ndcg@10': 0.4251, 'compress@10': 0.538, 'time@10': 6.9163}:  30%|███       | 3/10 [00:14<00:29,  4.27s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5895, 'hit_ratio@10': 0.6193, 'ndcg@10': 0.4742, 'compress@10': 0.5329, 'time@10': 6.8793}:  30%|███       | 3/10 [00:21<00:29,  4.27s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5895, 'hit_ratio@10': 0.6193, 'ndcg@10': 0.4742, 'compress@10': 0.5329, 'time@10': 6.8793}:  40%|████      | 4/10 [00:21<00:31,  5.27s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4902, 'hit_ratio@10': 0.6594, 'ndcg@10': 0.5302, 'compress@10': 0.5283, 'time@10': 10.4414}:  40%|████      | 4/10 [00:33<00:31,  5.27s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4902, 'hit_ratio@10': 0.6594, 'ndcg@10': 0.5302, 'compress@10': 0.5283, 'time@10': 10.4414}:  50%|█████     | 5/10 [00:33<00:39,  7.84s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4228, 'hit_ratio@10': 0.6606, 'ndcg@10': 0.5732, 'compress@10': 0.5255, 'time@10': 10.5486}:  50%|█████     | 5/10 [00:44<00:39,  7.84s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4228, 'hit_ratio@10': 0.6606, 'ndcg@10': 0.5732, 'compress@10': 0.5255, 'time@10': 10.5486}:  60%|██████    | 6/10 [00:44<00:35,  8.96s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3787, 'hit_ratio@10': 0.6634, 'ndcg@10': 0.5746, 'compress@10': 0.5247, 'time@10': 10.7709}:  60%|██████    | 6/10 [00:50<00:35,  8.96s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3787, 'hit_ratio@10': 0.6634, 'ndcg@10': 0.5746, 'compress@10': 0.5247, 'time@10': 10.7709}:  70%|███████   | 7/10 [00:50<00:24,  8.02s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3376, 'hit_ratio@10': 0.6948, 'ndcg@10': 0.6006, 'compress@10': 0.5234, 'time@10': 10.4868}:  70%|███████   | 7/10 [00:59<00:24,  8.02s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3376, 'hit_ratio@10': 0.6948, 'ndcg@10': 0.6006, 'compress@10': 0.5234, 'time@10': 10.4868}:  80%|████████  | 8/10 [00:59<00:16,  8.19s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3054, 'hit_ratio@10': 0.6938, 'ndcg@10': 0.6342, 'compress@10': 0.5224, 'time@10': 11.2205}:  80%|████████  | 8/10 [01:07<00:16,  8.19s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3054, 'hit_ratio@10': 0.6938, 'ndcg@10': 0.6342, 'compress@10': 0.5224, 'time@10': 11.2205}:  90%|█████████ | 9/10 [01:07<00:08,  8.31s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2802, 'hit_ratio@10': 0.7176, 'ndcg@10': 0.6554, 'compress@10': 0.5213, 'time@10': 11.1636}:  90%|█████████ | 9/10 [01:18<00:08,  8.31s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2802, 'hit_ratio@10': 0.7176, 'ndcg@10': 0.6554, 'compress@10': 0.5213, 'time@10': 11.1636}: 100%|██████████| 10/10 [01:18<00:00,  9.04s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2802, 'hit_ratio@10': 0.7176, 'ndcg@10': 0.6554, 'compress@10': 0.5213, 'time@10': 11.1636}: 100%|██████████| 10/10 [01:18<00:00,  7.85s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.28016495676919956
Avg hit ratio: 0.7175685915668938
Avg ndcg: 0.6554227051362375
Avg compression ratio: 0.5212749006657823
Avg train time: 11.163615942001343
Std train time: 5.715454811617833
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0534, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8449, 'compress@10': 0.5263, 'time@10': 8.9627}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0534, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8449, 'compress@10': 0.5263, 'time@10': 8.9627}:  10%|█         | 1/10 [00:04<00:40,  4.52s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0533, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8496, 'compress@10': 0.5212, 'time@10': 8.144}:  10%|█         | 1/10 [00:11<00:40,  4.52s/it] {'epoch': 1, 'num_users': 7.0, 'loss': 0.0533, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8496, 'compress@10': 0.5212, 'time@10': 8.144}:  20%|██        | 2/10 [00:11<00:49,  6.19s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0442, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.819, 'compress@10': 0.538, 'time@10': 6.4014}:  20%|██        | 2/10 [00:13<00:49,  6.19s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.0442, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.819, 'compress@10': 0.538, 'time@10': 6.4014}:  30%|███       | 3/10 [00:13<00:28,  4.05s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0457, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8249, 'compress@10': 0.5329, 'time@10': 6.4706}:  30%|███       | 3/10 [00:20<00:28,  4.05s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0457, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8249, 'compress@10': 0.5329, 'time@10': 6.4706}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0536, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8179, 'compress@10': 0.5283, 'time@10': 10.1908}:  40%|████      | 4/10 [00:32<00:30,  5.10s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0536, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8179, 'compress@10': 0.5283, 'time@10': 10.1908}:  50%|█████     | 5/10 [00:32<00:39,  7.80s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0576, 'hit_ratio@10': 0.7749, 'ndcg@10': 0.8172, 'compress@10': 0.5255, 'time@10': 10.3619}:  50%|█████     | 5/10 [00:43<00:39,  7.80s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0576, 'hit_ratio@10': 0.7749, 'ndcg@10': 0.8172, 'compress@10': 0.5255, 'time@10': 10.3619}:  60%|██████    | 6/10 [00:43<00:35,  8.98s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0555, 'hit_ratio@10': 0.8013, 'ndcg@10': 0.8252, 'compress@10': 0.5247, 'time@10': 10.5522}:  60%|██████    | 6/10 [00:49<00:35,  8.98s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0555, 'hit_ratio@10': 0.8013, 'ndcg@10': 0.8252, 'compress@10': 0.5247, 'time@10': 10.5522}:  70%|███████   | 7/10 [00:49<00:23,  7.97s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0533, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8309, 'compress@10': 0.5234, 'time@10': 10.2783}:  70%|███████   | 7/10 [00:58<00:23,  7.97s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0533, 'hit_ratio@10': 0.8154, 'ndcg@10': 0.8309, 'compress@10': 0.5234, 'time@10': 10.2783}:  80%|████████  | 8/10 [00:58<00:16,  8.11s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0512, 'hit_ratio@10': 0.8042, 'ndcg@10': 0.8401, 'compress@10': 0.5224, 'time@10': 11.0654}:  80%|████████  | 8/10 [01:06<00:16,  8.11s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0512, 'hit_ratio@10': 0.8042, 'ndcg@10': 0.8401, 'compress@10': 0.5224, 'time@10': 11.0654}:  90%|█████████ | 9/10 [01:06<00:08,  8.30s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0507, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8408, 'compress@10': 0.5213, 'time@10': 11.0008}:  90%|█████████ | 9/10 [01:17<00:08,  8.30s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.0507, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8408, 'compress@10': 0.5213, 'time@10': 11.0008}: 100%|██████████| 10/10 [01:17<00:00,  8.96s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0507, 'hit_ratio@10': 0.817, 'ndcg@10': 0.8408, 'compress@10': 0.5213, 'time@10': 11.0008}: 100%|██████████| 10/10 [01:17<00:00,  7.74s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05070452437824837
Avg hit ratio: 0.8169679232293834
Avg ndcg: 0.8407661954582579
Avg compression ratio: 0.5212749006657823
Avg train time: 11.000830340385438
Std train time: 5.899231693564249
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0479, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.5263, 'time@10': 9.1843}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0479, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8478, 'compress@10': 0.5263, 'time@10': 9.1843}:  10%|█         | 1/10 [00:04<00:41,  4.63s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8497, 'compress@10': 0.5212, 'time@10': 8.3282}:  10%|█         | 1/10 [00:12<00:41,  4.63s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0502, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8497, 'compress@10': 0.5212, 'time@10': 8.3282}:  20%|██        | 2/10 [00:12<00:50,  6.32s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.85, 'compress@10': 0.538, 'time@10': 6.5983}:  20%|██        | 2/10 [00:13<00:50,  6.32s/it]   {'epoch': 2, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.85, 'compress@10': 0.538, 'time@10': 6.5983}:  30%|███       | 3/10 [00:13<00:29,  4.17s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8483, 'compress@10': 0.5329, 'time@10': 6.6002}:  30%|███       | 3/10 [00:20<00:29,  4.17s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0391, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8483, 'compress@10': 0.5329, 'time@10': 6.6002}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8365, 'compress@10': 0.5283, 'time@10': 10.32}:  40%|████      | 4/10 [00:33<00:30,  5.14s/it] {'epoch': 2, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8365, 'compress@10': 0.5283, 'time@10': 10.32}:  50%|█████     | 5/10 [00:33<00:39,  7.85s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.052, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.833, 'compress@10': 0.5255, 'time@10': 10.4818}:  50%|█████     | 5/10 [00:44<00:39,  7.85s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.052, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.833, 'compress@10': 0.5255, 'time@10': 10.4818}:  60%|██████    | 6/10 [00:44<00:36,  9.03s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0509, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8385, 'compress@10': 0.5247, 'time@10': 10.675}:  60%|██████    | 6/10 [00:50<00:36,  9.03s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0509, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8385, 'compress@10': 0.5247, 'time@10': 10.675}:  70%|███████   | 7/10 [00:50<00:24,  8.02s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0501, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8442, 'compress@10': 0.5234, 'time@10': 10.3989}:  70%|███████   | 7/10 [00:58<00:24,  8.02s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0501, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8442, 'compress@10': 0.5234, 'time@10': 10.3989}:  80%|████████  | 8/10 [00:58<00:16,  8.18s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0489, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.851, 'compress@10': 0.5224, 'time@10': 11.1545}:  80%|████████  | 8/10 [01:07<00:16,  8.18s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0489, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.851, 'compress@10': 0.5224, 'time@10': 11.1545}:  90%|█████████ | 9/10 [01:07<00:08,  8.32s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.851, 'compress@10': 0.5213, 'time@10': 11.1119}:  90%|█████████ | 9/10 [01:18<00:08,  8.32s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.851, 'compress@10': 0.5213, 'time@10': 11.1119}: 100%|██████████| 10/10 [01:18<00:00,  9.08s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.851, 'compress@10': 0.5213, 'time@10': 11.1119}: 100%|██████████| 10/10 [01:18<00:00,  7.82s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.048730049017115036
Avg hit ratio: 0.8315326684257075
Avg ndcg: 0.8509953801106864
Avg compression ratio: 0.5212748729921973
Avg train time: 11.111869835853577
Std train time: 5.865573330897525
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.5263, 'time@10': 9.1269}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0471, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8544, 'compress@10': 0.5263, 'time@10': 9.1269}:  10%|█         | 1/10 [00:04<00:41,  4.60s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8517, 'compress@10': 0.5212, 'time@10': 8.3788}:  10%|█         | 1/10 [00:12<00:41,  4.60s/it] {'epoch': 3, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8517, 'compress@10': 0.5212, 'time@10': 8.3788}:  20%|██        | 2/10 [00:12<00:51,  6.42s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8513, 'compress@10': 0.538, 'time@10': 6.6455}:  20%|██        | 2/10 [00:13<00:51,  6.42s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0339, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8513, 'compress@10': 0.538, 'time@10': 6.6455}:  30%|███       | 3/10 [00:13<00:29,  4.23s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8476, 'compress@10': 0.5329, 'time@10': 6.6743}:  30%|███       | 3/10 [00:20<00:29,  4.23s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8476, 'compress@10': 0.5329, 'time@10': 6.6743}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8369, 'compress@10': 0.5283, 'time@10': 10.3826}:  40%|████      | 4/10 [00:33<00:31,  5.24s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8369, 'compress@10': 0.5283, 'time@10': 10.3826}:  50%|█████     | 5/10 [00:33<00:39,  7.91s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0499, 'hit_ratio@10': 0.7813, 'ndcg@10': 0.8346, 'compress@10': 0.5255, 'time@10': 10.5167}:  50%|█████     | 5/10 [00:44<00:39,  7.91s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0499, 'hit_ratio@10': 0.7813, 'ndcg@10': 0.8346, 'compress@10': 0.5255, 'time@10': 10.5167}:  60%|██████    | 6/10 [00:44<00:36,  9.04s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.049, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8379, 'compress@10': 0.5247, 'time@10': 10.769}:  60%|██████    | 6/10 [00:50<00:36,  9.04s/it]  {'epoch': 3, 'num_users': 6.2857, 'loss': 0.049, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8379, 'compress@10': 0.5247, 'time@10': 10.769}:  70%|███████   | 7/10 [00:50<00:24,  8.10s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8503, 'compress@10': 0.5234, 'time@10': 10.4825}:  70%|███████   | 7/10 [00:59<00:24,  8.10s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8503, 'compress@10': 0.5234, 'time@10': 10.4825}:  80%|████████  | 8/10 [00:59<00:16,  8.23s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0532, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.8554, 'compress@10': 0.5224, 'time@10': 11.259}:  80%|████████  | 8/10 [01:08<00:16,  8.23s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0532, 'hit_ratio@10': 0.8117, 'ndcg@10': 0.8554, 'compress@10': 0.5224, 'time@10': 11.259}:  90%|█████████ | 9/10 [01:08<00:08,  8.40s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0524, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8551, 'compress@10': 0.5213, 'time@10': 11.2083}:  90%|█████████ | 9/10 [01:18<00:08,  8.40s/it]  {'epoch': 3, 'num_users': 6.3, 'loss': 0.0524, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8551, 'compress@10': 0.5213, 'time@10': 11.2083}: 100%|██████████| 10/10 [01:18<00:00,  9.14s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0524, 'hit_ratio@10': 0.8237, 'ndcg@10': 0.8551, 'compress@10': 0.5213, 'time@10': 11.2083}: 100%|██████████| 10/10 [01:18<00:00,  7.88s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.052441430046163626
Avg hit ratio: 0.8236985670432191
Avg ndcg: 0.8551103596832548
Avg compression ratio: 0.5212749006657823
Avg train time: 11.208278274536132
Std train time: 5.879118479973408
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 0.5263, 'time@10': 9.116}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 0.5263, 'time@10': 9.116}:  10%|█         | 1/10 [00:04<00:41,  4.60s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8573, 'compress@10': 0.5212, 'time@10': 8.3731}:  10%|█         | 1/10 [00:12<00:41,  4.60s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8573, 'compress@10': 0.5212, 'time@10': 8.3731}:  20%|██        | 2/10 [00:12<00:51,  6.40s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8551, 'compress@10': 0.538, 'time@10': 6.5981}:  20%|██        | 2/10 [00:13<00:51,  6.40s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0333, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8551, 'compress@10': 0.538, 'time@10': 6.5981}:  30%|███       | 3/10 [00:13<00:29,  4.19s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0384, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8464, 'compress@10': 0.5329, 'time@10': 6.6115}:  30%|███       | 3/10 [00:20<00:29,  4.19s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0384, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8464, 'compress@10': 0.5329, 'time@10': 6.6115}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0454, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8366, 'compress@10': 0.5283, 'time@10': 10.2673}:  40%|████      | 4/10 [00:33<00:31,  5.18s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0454, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8366, 'compress@10': 0.5283, 'time@10': 10.2673}:  50%|█████     | 5/10 [00:33<00:39,  7.83s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0489, 'hit_ratio@10': 0.8021, 'ndcg@10': 0.8343, 'compress@10': 0.5255, 'time@10': 10.4111}:  50%|█████     | 5/10 [00:44<00:39,  7.83s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0489, 'hit_ratio@10': 0.8021, 'ndcg@10': 0.8343, 'compress@10': 0.5255, 'time@10': 10.4111}:  60%|██████    | 6/10 [00:44<00:35,  8.96s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0495, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.833, 'compress@10': 0.5247, 'time@10': 10.6532}:  60%|██████    | 6/10 [00:50<00:35,  8.96s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0495, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.833, 'compress@10': 0.5247, 'time@10': 10.6532}:  70%|███████   | 7/10 [00:50<00:24,  8.02s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0502, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8478, 'compress@10': 0.5234, 'time@10': 10.3758}:  70%|███████   | 7/10 [00:58<00:24,  8.02s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0502, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8478, 'compress@10': 0.5234, 'time@10': 10.3758}:  80%|████████  | 8/10 [00:58<00:16,  8.17s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.053, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.847, 'compress@10': 0.5224, 'time@10': 11.1405}:  80%|████████  | 8/10 [01:07<00:16,  8.17s/it] {'epoch': 4, 'num_users': 6.3333, 'loss': 0.053, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.847, 'compress@10': 0.5224, 'time@10': 11.1405}:  90%|█████████ | 9/10 [01:07<00:08,  8.32s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0522, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8475, 'compress@10': 0.5213, 'time@10': 11.1246}:  90%|█████████ | 9/10 [01:18<00:08,  8.32s/it] {'epoch': 4, 'num_users': 6.3, 'loss': 0.0522, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8475, 'compress@10': 0.5213, 'time@10': 11.1246}: 100%|██████████| 10/10 [01:18<00:00,  9.16s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0522, 'hit_ratio@10': 0.8419, 'ndcg@10': 0.8475, 'compress@10': 0.5213, 'time@10': 11.1246}: 100%|██████████| 10/10 [01:18<00:00,  7.85s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.05222029984236591
Avg hit ratio: 0.8418731702178223
Avg ndcg: 0.8475363875429656
Avg compression ratio: 0.5212749006657823
Avg train time: 11.124644136428833
Std train time: 5.803581812414105
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.5263, 'time@10': 9.3242}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.5263, 'time@10': 9.3242}:  10%|█         | 1/10 [00:04<00:42,  4.70s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8601, 'compress@10': 0.5212, 'time@10': 8.5215}:  10%|█         | 1/10 [00:12<00:42,  4.70s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8601, 'compress@10': 0.5212, 'time@10': 8.5215}:  20%|██        | 2/10 [00:12<00:51,  6.50s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8569, 'compress@10': 0.538, 'time@10': 6.7233}:  20%|██        | 2/10 [00:14<00:51,  6.50s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8569, 'compress@10': 0.538, 'time@10': 6.7233}:  30%|███       | 3/10 [00:14<00:29,  4.26s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8534, 'compress@10': 0.5329, 'time@10': 6.7566}:  30%|███       | 3/10 [00:20<00:29,  4.26s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8534, 'compress@10': 0.5329, 'time@10': 6.7566}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.043, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8434, 'compress@10': 0.5283, 'time@10': 10.4292}:  40%|████      | 4/10 [00:33<00:31,  5.30s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.043, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8434, 'compress@10': 0.5283, 'time@10': 10.4292}:  50%|█████     | 5/10 [00:33<00:39,  7.93s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0462, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.841, 'compress@10': 0.5255, 'time@10': 10.55}:  50%|█████     | 5/10 [00:44<00:39,  7.93s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0462, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.841, 'compress@10': 0.5255, 'time@10': 10.55}:  60%|██████    | 6/10 [00:44<00:36,  9.04s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0463, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.84, 'compress@10': 0.5247, 'time@10': 10.8228}:  60%|██████    | 6/10 [00:51<00:36,  9.04s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0463, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.84, 'compress@10': 0.5247, 'time@10': 10.8228}:  70%|███████   | 7/10 [00:51<00:24,  8.14s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0469, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.855, 'compress@10': 0.5234, 'time@10': 10.5437}:  70%|███████   | 7/10 [01:00<00:24,  8.14s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0469, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.855, 'compress@10': 0.5234, 'time@10': 10.5437}:  80%|████████  | 8/10 [01:00<00:16,  8.46s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0471, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.856, 'compress@10': 0.5224, 'time@10': 11.3145}:  80%|████████  | 8/10 [01:08<00:16,  8.46s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0471, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.856, 'compress@10': 0.5224, 'time@10': 11.3145}:  90%|█████████ | 9/10 [01:08<00:08,  8.56s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0464, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8566, 'compress@10': 0.5213, 'time@10': 11.2716}:  90%|█████████ | 9/10 [01:19<00:08,  8.56s/it]  {'epoch': 5, 'num_users': 6.3, 'loss': 0.0464, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8566, 'compress@10': 0.5213, 'time@10': 11.2716}: 100%|██████████| 10/10 [01:19<00:00,  9.29s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0464, 'hit_ratio@10': 0.8432, 'ndcg@10': 0.8566, 'compress@10': 0.5213, 'time@10': 11.2716}: 100%|██████████| 10/10 [01:19<00:00,  7.99s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.046360675156587774
Avg hit ratio: 0.8432223765670285
Avg ndcg: 0.8565646121052156
Avg compression ratio: 0.5212749006657823
Avg train time: 11.271618175506593
Std train time: 5.842474640642872
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8584, 'compress@10': 0.5263, 'time@10': 9.5378}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8584, 'compress@10': 0.5263, 'time@10': 9.5378}:  10%|█         | 1/10 [00:04<00:43,  4.81s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.045, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8593, 'compress@10': 0.5212, 'time@10': 8.5753}:  10%|█         | 1/10 [00:12<00:43,  4.81s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.045, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8593, 'compress@10': 0.5212, 'time@10': 8.5753}:  20%|██        | 2/10 [00:12<00:51,  6.48s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8564, 'compress@10': 0.538, 'time@10': 6.7244}:  20%|██        | 2/10 [00:14<00:51,  6.48s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8564, 'compress@10': 0.538, 'time@10': 6.7244}:  30%|███       | 3/10 [00:14<00:29,  4.23s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.782, 'ndcg@10': 0.855, 'compress@10': 0.5329, 'time@10': 6.7192}:  30%|███       | 3/10 [00:20<00:29,  4.23s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.782, 'ndcg@10': 0.855, 'compress@10': 0.5329, 'time@10': 6.7192}:  40%|████      | 4/10 [00:20<00:31,  5.22s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0409, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8455, 'compress@10': 0.5283, 'time@10': 10.4548}:  40%|████      | 4/10 [00:33<00:31,  5.22s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0409, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8455, 'compress@10': 0.5283, 'time@10': 10.4548}:  50%|█████     | 5/10 [00:33<00:39,  7.93s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0438, 'hit_ratio@10': 0.7988, 'ndcg@10': 0.8434, 'compress@10': 0.5255, 'time@10': 10.5884}:  50%|█████     | 5/10 [00:44<00:39,  7.93s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0438, 'hit_ratio@10': 0.7988, 'ndcg@10': 0.8434, 'compress@10': 0.5255, 'time@10': 10.5884}:  60%|██████    | 6/10 [00:44<00:36,  9.07s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0436, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8434, 'compress@10': 0.5247, 'time@10': 10.8214}:  60%|██████    | 6/10 [00:50<00:36,  9.07s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0436, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.8434, 'compress@10': 0.5247, 'time@10': 10.8214}:  70%|███████   | 7/10 [00:50<00:24,  8.12s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0439, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8521, 'compress@10': 0.5234, 'time@10': 10.5393}:  70%|███████   | 7/10 [00:59<00:24,  8.12s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0439, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8521, 'compress@10': 0.5234, 'time@10': 10.5393}:  80%|████████  | 8/10 [00:59<00:16,  8.27s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0433, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8581, 'compress@10': 0.5224, 'time@10': 11.3174}:  80%|████████  | 8/10 [01:08<00:16,  8.27s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0433, 'hit_ratio@10': 0.8265, 'ndcg@10': 0.8581, 'compress@10': 0.5224, 'time@10': 11.3174}:  90%|█████████ | 9/10 [01:08<00:08,  8.44s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8583, 'compress@10': 0.5213, 'time@10': 11.2693}:  90%|█████████ | 9/10 [01:19<00:08,  8.44s/it]    {'epoch': 6, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8583, 'compress@10': 0.5213, 'time@10': 11.2693}: 100%|██████████| 10/10 [01:19<00:00,  9.19s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.837, 'ndcg@10': 0.8583, 'compress@10': 0.5213, 'time@10': 11.2693}: 100%|██████████| 10/10 [01:19<00:00,  7.92s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04276594020795679
Avg hit ratio: 0.8370160273606793
Avg ndcg: 0.8582638695949714
Avg compression ratio: 0.5212749006657823
Avg train time: 11.269296908378601
Std train time: 5.937762607559645
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.5263, 'time@10': 9.1895}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.5263, 'time@10': 9.1895}:  10%|█         | 1/10 [00:04<00:41,  4.63s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.858, 'compress@10': 0.5212, 'time@10': 8.4266}:  10%|█         | 1/10 [00:12<00:41,  4.63s/it] {'epoch': 7, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.858, 'compress@10': 0.5212, 'time@10': 8.4266}:  20%|██        | 2/10 [00:12<00:51,  6.45s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8555, 'compress@10': 0.538, 'time@10': 6.6336}:  20%|██        | 2/10 [00:13<00:51,  6.45s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8555, 'compress@10': 0.538, 'time@10': 6.6336}:  30%|███       | 3/10 [00:13<00:29,  4.22s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8567, 'compress@10': 0.5329, 'time@10': 6.6692}:  30%|███       | 3/10 [00:20<00:29,  4.22s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0342, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8567, 'compress@10': 0.5329, 'time@10': 6.6692}:  40%|████      | 4/10 [00:20<00:31,  5.24s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0392, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8482, 'compress@10': 0.5283, 'time@10': 10.3385}:  40%|████      | 4/10 [00:33<00:31,  5.24s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0392, 'hit_ratio@10': 0.8112, 'ndcg@10': 0.8482, 'compress@10': 0.5283, 'time@10': 10.3385}:  50%|█████     | 5/10 [00:33<00:39,  7.88s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0416, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8465, 'compress@10': 0.5255, 'time@10': 10.4911}:  50%|█████     | 5/10 [00:44<00:39,  7.88s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0416, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8465, 'compress@10': 0.5255, 'time@10': 10.4911}:  60%|██████    | 6/10 [00:44<00:36,  9.04s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.041, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.848, 'compress@10': 0.5247, 'time@10': 10.7788}:  60%|██████    | 6/10 [00:50<00:36,  9.04s/it]  {'epoch': 7, 'num_users': 6.2857, 'loss': 0.041, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.848, 'compress@10': 0.5247, 'time@10': 10.7788}:  70%|███████   | 7/10 [00:50<00:24,  8.14s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0414, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8559, 'compress@10': 0.5234, 'time@10': 10.4982}:  70%|███████   | 7/10 [00:59<00:24,  8.14s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0414, 'hit_ratio@10': 0.8496, 'ndcg@10': 0.8559, 'compress@10': 0.5234, 'time@10': 10.4982}:  80%|████████  | 8/10 [00:59<00:16,  8.28s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0402, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.865, 'compress@10': 0.5224, 'time@10': 11.2404}:  80%|████████  | 8/10 [01:08<00:16,  8.28s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0402, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.865, 'compress@10': 0.5224, 'time@10': 11.2404}:  90%|█████████ | 9/10 [01:08<00:08,  8.39s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0392, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8662, 'compress@10': 0.5213, 'time@10': 11.2205}:  90%|█████████ | 9/10 [01:19<00:08,  8.39s/it]  {'epoch': 7, 'num_users': 6.3, 'loss': 0.0392, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8662, 'compress@10': 0.5213, 'time@10': 11.2205}: 100%|██████████| 10/10 [01:19<00:00,  9.22s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0392, 'hit_ratio@10': 0.8523, 'ndcg@10': 0.8662, 'compress@10': 0.5213, 'time@10': 11.2205}: 100%|██████████| 10/10 [01:19<00:00,  7.91s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.039193605838963363
Avg hit ratio: 0.8523082118786702
Avg ndcg: 0.8662340146168089
Avg compression ratio: 0.5212749006657823
Avg train time: 11.220522260665893
Std train time: 5.81405832745413
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8429, 'compress@10': 0.5263, 'time@10': 9.1355}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8429, 'compress@10': 0.5263, 'time@10': 9.1355}:  10%|█         | 1/10 [00:04<00:41,  4.61s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8593, 'compress@10': 0.5212, 'time@10': 8.3999}:  10%|█         | 1/10 [00:12<00:41,  4.61s/it] {'epoch': 8, 'num_users': 7.0, 'loss': 0.043, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8593, 'compress@10': 0.5212, 'time@10': 8.3999}:  20%|██        | 2/10 [00:12<00:51,  6.43s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8564, 'compress@10': 0.538, 'time@10': 6.6172}:  20%|██        | 2/10 [00:13<00:51,  6.43s/it]  {'epoch': 8, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8564, 'compress@10': 0.538, 'time@10': 6.6172}:  30%|███       | 3/10 [00:13<00:29,  4.21s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8597, 'compress@10': 0.5329, 'time@10': 6.6627}:  30%|███       | 3/10 [00:20<00:29,  4.21s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0338, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8597, 'compress@10': 0.5329, 'time@10': 6.6627}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0382, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8524, 'compress@10': 0.5283, 'time@10': 10.3198}:  40%|████      | 4/10 [00:33<00:31,  5.25s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0382, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8524, 'compress@10': 0.5283, 'time@10': 10.3198}:  50%|█████     | 5/10 [00:33<00:39,  7.87s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.04, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8512, 'compress@10': 0.5255, 'time@10': 10.4648}:  50%|█████     | 5/10 [00:44<00:39,  7.87s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.04, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8512, 'compress@10': 0.5255, 'time@10': 10.4648}:  60%|██████    | 6/10 [00:44<00:36,  9.01s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0395, 'hit_ratio@10': 0.864, 'ndcg@10': 0.852, 'compress@10': 0.5247, 'time@10': 10.6934}:  60%|██████    | 6/10 [00:50<00:36,  9.01s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0395, 'hit_ratio@10': 0.864, 'ndcg@10': 0.852, 'compress@10': 0.5247, 'time@10': 10.6934}:  70%|███████   | 7/10 [00:50<00:24,  8.05s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0397, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8598, 'compress@10': 0.5234, 'time@10': 10.4061}:  70%|███████   | 7/10 [00:58<00:24,  8.05s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0397, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8598, 'compress@10': 0.5234, 'time@10': 10.4061}:  80%|████████  | 8/10 [00:58<00:16,  8.17s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0386, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8655, 'compress@10': 0.5224, 'time@10': 11.1565}:  80%|████████  | 8/10 [01:07<00:16,  8.17s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0386, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8655, 'compress@10': 0.5224, 'time@10': 11.1565}:  90%|█████████ | 9/10 [01:07<00:08,  8.31s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0384, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8672, 'compress@10': 0.5213, 'time@10': 11.1401}:  90%|█████████ | 9/10 [01:18<00:08,  8.31s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0384, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8672, 'compress@10': 0.5213, 'time@10': 11.1401}: 100%|██████████| 10/10 [01:18<00:00,  9.15s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0384, 'hit_ratio@10': 0.8688, 'ndcg@10': 0.8672, 'compress@10': 0.5213, 'time@10': 11.1401}: 100%|██████████| 10/10 [01:18<00:00,  7.86s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.03836377264213138
Avg hit ratio: 0.8688161483866068
Avg ndcg: 0.867202079995525
Avg compression ratio: 0.5212749006657823
Avg train time: 11.140105390548706
Std train time: 5.7937626606856085
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8722, 'compress@10': 0.5263, 'time@10': 9.265}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8722, 'compress@10': 0.5263, 'time@10': 9.265}:  10%|█         | 1/10 [00:04<00:42,  4.67s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.879, 'compress@10': 0.5212, 'time@10': 8.4563}:  10%|█         | 1/10 [00:12<00:42,  4.67s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0391, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.879, 'compress@10': 0.5212, 'time@10': 8.4563}:  20%|██        | 2/10 [00:12<00:51,  6.44s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8696, 'compress@10': 0.538, 'time@10': 6.6111}:  20%|██        | 2/10 [00:13<00:51,  6.44s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0274, 'hit_ratio@10': 0.744, 'ndcg@10': 0.8696, 'compress@10': 0.538, 'time@10': 6.6111}:  30%|███       | 3/10 [00:13<00:29,  4.18s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8699, 'compress@10': 0.5329, 'time@10': 6.6739}:  30%|███       | 3/10 [00:20<00:29,  4.18s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.799, 'ndcg@10': 0.8699, 'compress@10': 0.5329, 'time@10': 6.6739}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0358, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8623, 'compress@10': 0.5283, 'time@10': 10.3446}:  40%|████      | 4/10 [00:33<00:31,  5.26s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0358, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8623, 'compress@10': 0.5283, 'time@10': 10.3446}:  50%|█████     | 5/10 [00:33<00:39,  7.89s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0373, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8599, 'compress@10': 0.5255, 'time@10': 10.4845}:  50%|█████     | 5/10 [00:44<00:39,  7.89s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0373, 'hit_ratio@10': 0.8275, 'ndcg@10': 0.8599, 'compress@10': 0.5255, 'time@10': 10.4845}:  60%|██████    | 6/10 [00:44<00:36,  9.02s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0367, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8644, 'compress@10': 0.5247, 'time@10': 10.7277}:  60%|██████    | 6/10 [00:50<00:36,  9.02s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0367, 'hit_ratio@10': 0.8464, 'ndcg@10': 0.8644, 'compress@10': 0.5247, 'time@10': 10.7277}:  70%|███████   | 7/10 [00:50<00:24,  8.08s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0368, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8714, 'compress@10': 0.5234, 'time@10': 10.4641}:  70%|███████   | 7/10 [00:59<00:24,  8.08s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0368, 'hit_ratio@10': 0.8585, 'ndcg@10': 0.8714, 'compress@10': 0.5234, 'time@10': 10.4641}:  80%|████████  | 8/10 [00:59<00:16,  8.26s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0363, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8776, 'compress@10': 0.5224, 'time@10': 11.2045}:  80%|████████  | 8/10 [01:07<00:16,  8.26s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0363, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8776, 'compress@10': 0.5224, 'time@10': 11.2045}:  90%|█████████ | 9/10 [01:07<00:08,  8.37s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8779, 'compress@10': 0.5213, 'time@10': 11.1795}:  90%|█████████ | 9/10 [01:18<00:08,  8.37s/it]    {'epoch': 9, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8779, 'compress@10': 0.5213, 'time@10': 11.1795}: 100%|██████████| 10/10 [01:18<00:00,  9.18s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0364, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8779, 'compress@10': 0.5213, 'time@10': 11.1795}: 100%|██████████| 10/10 [01:18<00:00,  7.89s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03642423796117557
Avg hit ratio: 0.8599719925424509
Avg ndcg: 0.8779091679799917
Avg compression ratio: 0.5212749006657823
Avg train time: 11.179519534111023
Std train time: 5.811653507579865
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8463, 'compress@10': 0.5263, 'time@10': 9.087}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8463, 'compress@10': 0.5263, 'time@10': 9.087}:  10%|█         | 1/10 [00:04<00:41,  4.58s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0393, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8676, 'compress@10': 0.5212, 'time@10': 8.3818}:  10%|█         | 1/10 [00:12<00:41,  4.58s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0393, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8676, 'compress@10': 0.5212, 'time@10': 8.3818}:  20%|██        | 2/10 [00:12<00:51,  6.43s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.862, 'compress@10': 0.538, 'time@10': 6.585}:  20%|██        | 2/10 [00:13<00:51,  6.43s/it]   {'epoch': 10, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.862, 'compress@10': 0.538, 'time@10': 6.585}:  30%|███       | 3/10 [00:13<00:29,  4.19s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.8651, 'compress@10': 0.5329, 'time@10': 6.6661}:  30%|███       | 3/10 [00:20<00:29,  4.19s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.8651, 'compress@10': 0.5329, 'time@10': 6.6661}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0346, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8629, 'compress@10': 0.5283, 'time@10': 10.4161}:  40%|████      | 4/10 [00:33<00:31,  5.28s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0346, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8629, 'compress@10': 0.5283, 'time@10': 10.4161}:  50%|█████     | 5/10 [00:33<00:39,  7.98s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0355, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8623, 'compress@10': 0.5255, 'time@10': 10.5359}:  50%|█████     | 5/10 [00:44<00:39,  7.98s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0355, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8623, 'compress@10': 0.5255, 'time@10': 10.5359}:  60%|██████    | 6/10 [00:44<00:36,  9.07s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0353, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8636, 'compress@10': 0.5247, 'time@10': 10.7903}:  60%|██████    | 6/10 [00:50<00:36,  9.07s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0353, 'hit_ratio@10': 0.8493, 'ndcg@10': 0.8636, 'compress@10': 0.5247, 'time@10': 10.7903}:  70%|███████   | 7/10 [00:50<00:24,  8.13s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0352, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8709, 'compress@10': 0.5234, 'time@10': 10.5205}:  70%|███████   | 7/10 [00:59<00:24,  8.13s/it] {'epoch': 10, 'num_users': 6.125, 'loss': 0.0352, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8709, 'compress@10': 0.5234, 'time@10': 10.5205}:  80%|████████  | 8/10 [00:59<00:16,  8.30s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0354, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8823, 'compress@10': 0.5224, 'time@10': 11.3061}:  80%|████████  | 8/10 [01:08<00:16,  8.30s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0354, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.8823, 'compress@10': 0.5224, 'time@10': 11.3061}:  90%|█████████ | 9/10 [01:08<00:08,  8.47s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0339, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8847, 'compress@10': 0.5213, 'time@10': 11.2572}:  90%|█████████ | 9/10 [01:19<00:08,  8.47s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0339, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8847, 'compress@10': 0.5213, 'time@10': 11.2572}: 100%|██████████| 10/10 [01:19<00:00,  9.21s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0339, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8847, 'compress@10': 0.5213, 'time@10': 11.2572}: 100%|██████████| 10/10 [01:19<00:00,  7.93s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03391974754599612
Avg hit ratio: 0.8636976556738866
Avg ndcg: 0.8846716268436079
Avg compression ratio: 0.5212749006657823
Avg train time: 11.257152247428895
Std train time: 5.946121382933903
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0382, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8705, 'compress@10': 0.5263, 'time@10': 9.2187}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0382, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8705, 'compress@10': 0.5263, 'time@10': 9.2187}:  10%|█         | 1/10 [00:04<00:41,  4.65s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8819, 'compress@10': 0.5212, 'time@10': 8.4816}:  10%|█         | 1/10 [00:12<00:41,  4.65s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0352, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8819, 'compress@10': 0.5212, 'time@10': 8.4816}:  20%|██        | 2/10 [00:12<00:51,  6.49s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8715, 'compress@10': 0.538, 'time@10': 6.7981}:  20%|██        | 2/10 [00:14<00:51,  6.49s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0247, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8715, 'compress@10': 0.538, 'time@10': 6.7981}:  30%|███       | 3/10 [00:14<00:30,  4.33s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8725, 'compress@10': 0.5329, 'time@10': 6.8195}:  30%|███       | 3/10 [00:21<00:30,  4.33s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8725, 'compress@10': 0.5329, 'time@10': 6.8195}:  40%|████      | 4/10 [00:21<00:32,  5.35s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0317, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8725, 'compress@10': 0.5283, 'time@10': 10.4376}:  40%|████      | 4/10 [00:33<00:32,  5.35s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0317, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8725, 'compress@10': 0.5283, 'time@10': 10.4376}:  50%|█████     | 5/10 [00:33<00:39,  7.93s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0325, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8712, 'compress@10': 0.5255, 'time@10': 10.5745}:  50%|█████     | 5/10 [00:44<00:39,  7.93s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0325, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8712, 'compress@10': 0.5255, 'time@10': 10.5745}:  60%|██████    | 6/10 [00:44<00:36,  9.07s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0323, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8749, 'compress@10': 0.5247, 'time@10': 10.8129}:  60%|██████    | 6/10 [00:51<00:36,  9.07s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0323, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8749, 'compress@10': 0.5247, 'time@10': 10.8129}:  70%|███████   | 7/10 [00:51<00:24,  8.12s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0323, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8815, 'compress@10': 0.5234, 'time@10': 10.5238}:  70%|███████   | 7/10 [00:59<00:24,  8.12s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0323, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.8815, 'compress@10': 0.5234, 'time@10': 10.5238}:  80%|████████  | 8/10 [00:59<00:16,  8.26s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8862, 'compress@10': 0.5224, 'time@10': 11.2699}:  80%|████████  | 8/10 [01:08<00:16,  8.26s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8862, 'compress@10': 0.5224, 'time@10': 11.2699}:  90%|█████████ | 9/10 [01:08<00:08,  8.38s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0315, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.888, 'compress@10': 0.5213, 'time@10': 11.2327}:  90%|█████████ | 9/10 [01:19<00:08,  8.38s/it]    {'epoch': 11, 'num_users': 6.3, 'loss': 0.0315, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.888, 'compress@10': 0.5213, 'time@10': 11.2327}: 100%|██████████| 10/10 [01:19<00:00,  9.17s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0315, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.888, 'compress@10': 0.5213, 'time@10': 11.2327}: 100%|██████████| 10/10 [01:19<00:00,  7.92s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03154361776264043
Avg hit ratio: 0.8705932279378799
Avg ndcg: 0.8879828940888503
Avg compression ratio: 0.5212749006657823
Avg train time: 11.232709074020386
Std train time: 5.724954630812995
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0452, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8548, 'compress@10': 0.5263, 'time@10': 9.322}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0452, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8548, 'compress@10': 0.5263, 'time@10': 9.322}:  10%|█         | 1/10 [00:04<00:42,  4.70s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.878, 'compress@10': 0.5212, 'time@10': 8.507}:  10%|█         | 1/10 [00:12<00:42,  4.70s/it] {'epoch': 12, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.878, 'compress@10': 0.5212, 'time@10': 8.507}:  20%|██        | 2/10 [00:12<00:51,  6.48s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8689, 'compress@10': 0.538, 'time@10': 6.6764}:  20%|██        | 2/10 [00:13<00:51,  6.48s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8689, 'compress@10': 0.538, 'time@10': 6.6764}:  30%|███       | 3/10 [00:13<00:29,  4.23s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8722, 'compress@10': 0.5329, 'time@10': 6.7578}:  30%|███       | 3/10 [00:21<00:29,  4.23s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0294, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8722, 'compress@10': 0.5329, 'time@10': 6.7578}:  40%|████      | 4/10 [00:21<00:32,  5.34s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0312, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.873, 'compress@10': 0.5283, 'time@10': 10.4654}:  40%|████      | 4/10 [00:33<00:32,  5.34s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0312, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.873, 'compress@10': 0.5283, 'time@10': 10.4654}:  50%|█████     | 5/10 [00:33<00:39,  7.99s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0315, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.873, 'compress@10': 0.5255, 'time@10': 10.585}:  50%|█████     | 5/10 [00:44<00:39,  7.99s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0315, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.873, 'compress@10': 0.5255, 'time@10': 10.585}:  60%|██████    | 6/10 [00:44<00:36,  9.09s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0319, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8735, 'compress@10': 0.5247, 'time@10': 10.8494}:  60%|██████    | 6/10 [00:51<00:36,  9.09s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0319, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8735, 'compress@10': 0.5247, 'time@10': 10.8494}:  70%|███████   | 7/10 [00:51<00:24,  8.16s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0317, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8787, 'compress@10': 0.5234, 'time@10': 10.5551}:  70%|███████   | 7/10 [00:59<00:24,  8.16s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0317, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.8787, 'compress@10': 0.5234, 'time@10': 10.5551}:  80%|████████  | 8/10 [00:59<00:16,  8.28s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0317, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.884, 'compress@10': 0.5224, 'time@10': 11.2857}:  80%|████████  | 8/10 [01:08<00:16,  8.28s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0317, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.884, 'compress@10': 0.5224, 'time@10': 11.2857}:  90%|█████████ | 9/10 [01:08<00:08,  8.38s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0303, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8882, 'compress@10': 0.5213, 'time@10': 11.2468}:  90%|█████████ | 9/10 [01:19<00:08,  8.38s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.0303, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8882, 'compress@10': 0.5213, 'time@10': 11.2468}: 100%|██████████| 10/10 [01:19<00:00,  9.17s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0303, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8882, 'compress@10': 0.5213, 'time@10': 11.2468}: 100%|██████████| 10/10 [01:19<00:00,  7.93s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.030278184898260015
Avg hit ratio: 0.8844278144040454
Avg ndcg: 0.8882118574207171
Avg compression ratio: 0.5212749006657823
Avg train time: 11.246789383888245
Std train time: 5.858570231735604
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.868, 'compress@10': 0.5263, 'time@10': 9.2164}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.868, 'compress@10': 0.5263, 'time@10': 9.2164}:  10%|█         | 1/10 [00:04<00:41,  4.65s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0324, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8876, 'compress@10': 0.5212, 'time@10': 8.5047}:  10%|█         | 1/10 [00:12<00:41,  4.65s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0324, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8876, 'compress@10': 0.5212, 'time@10': 8.5047}:  20%|██        | 2/10 [00:12<00:52,  6.52s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8753, 'compress@10': 0.538, 'time@10': 6.7017}:  20%|██        | 2/10 [00:14<00:52,  6.52s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8753, 'compress@10': 0.538, 'time@10': 6.7017}:  30%|███       | 3/10 [00:14<00:29,  4.27s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8779, 'compress@10': 0.5329, 'time@10': 6.7389}:  30%|███       | 3/10 [00:20<00:29,  4.27s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8779, 'compress@10': 0.5329, 'time@10': 6.7389}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0278, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8792, 'compress@10': 0.5283, 'time@10': 10.4383}:  40%|████      | 4/10 [00:33<00:31,  5.30s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0278, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8792, 'compress@10': 0.5283, 'time@10': 10.4383}:  50%|█████     | 5/10 [00:33<00:39,  7.95s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0281, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8802, 'compress@10': 0.5255, 'time@10': 10.588}:  50%|█████     | 5/10 [00:44<00:39,  7.95s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0281, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8802, 'compress@10': 0.5255, 'time@10': 10.588}:  60%|██████    | 6/10 [00:44<00:36,  9.12s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8826, 'compress@10': 0.5247, 'time@10': 10.8351}:  60%|██████    | 6/10 [00:51<00:36,  9.12s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0279, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8826, 'compress@10': 0.5247, 'time@10': 10.8351}:  70%|███████   | 7/10 [00:51<00:24,  8.16s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.8856, 'compress@10': 0.5234, 'time@10': 10.5598}:  70%|███████   | 7/10 [00:59<00:24,  8.16s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.8856, 'compress@10': 0.5234, 'time@10': 10.5598}:  80%|████████  | 8/10 [00:59<00:16,  8.32s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8917, 'compress@10': 0.5224, 'time@10': 11.2952}:  80%|████████  | 8/10 [01:08<00:16,  8.32s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8917, 'compress@10': 0.5224, 'time@10': 11.2952}:  90%|█████████ | 9/10 [01:08<00:08,  8.42s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8906, 'compress@10': 0.5213, 'time@10': 11.2631}:  90%|█████████ | 9/10 [01:19<00:08,  8.42s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8906, 'compress@10': 0.5213, 'time@10': 11.2631}: 100%|██████████| 10/10 [01:19<00:00,  9.22s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8906, 'compress@10': 0.5213, 'time@10': 11.2631}: 100%|██████████| 10/10 [01:19<00:00,  7.95s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.028111439057613548
Avg hit ratio: 0.8866500366262675
Avg ndcg: 0.890615277886322
Avg compression ratio: 0.5212749006657823
Avg train time: 11.26310636997223
Std train time: 5.837413798775967
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8615, 'compress@10': 0.5263, 'time@10': 9.4909}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8615, 'compress@10': 0.5263, 'time@10': 9.4909}:  10%|█         | 1/10 [00:04<00:43,  4.78s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0357, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8808, 'compress@10': 0.5212, 'time@10': 8.5913}:  10%|█         | 1/10 [00:12<00:43,  4.78s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0357, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8808, 'compress@10': 0.5212, 'time@10': 8.5913}:  20%|██        | 2/10 [00:12<00:52,  6.53s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8707, 'compress@10': 0.538, 'time@10': 6.7513}:  20%|██        | 2/10 [00:14<00:52,  6.53s/it]  {'epoch': 14, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8707, 'compress@10': 0.538, 'time@10': 6.7513}:  30%|███       | 3/10 [00:14<00:29,  4.27s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8748, 'compress@10': 0.5329, 'time@10': 6.7849}:  30%|███       | 3/10 [00:21<00:29,  4.27s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8748, 'compress@10': 0.5329, 'time@10': 6.7849}:  40%|████      | 4/10 [00:21<00:31,  5.32s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0283, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8782, 'compress@10': 0.5283, 'time@10': 10.4525}:  40%|████      | 4/10 [00:33<00:31,  5.32s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0283, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8782, 'compress@10': 0.5283, 'time@10': 10.4525}:  50%|█████     | 5/10 [00:33<00:39,  7.94s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.882, 'compress@10': 0.5255, 'time@10': 10.5795}:  50%|█████     | 5/10 [00:44<00:39,  7.94s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.029, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.882, 'compress@10': 0.5255, 'time@10': 10.5795}:  60%|██████    | 6/10 [00:44<00:36,  9.07s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0291, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8844, 'compress@10': 0.5247, 'time@10': 10.8206}:  60%|██████    | 6/10 [00:51<00:36,  9.07s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0291, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8844, 'compress@10': 0.5247, 'time@10': 10.8206}:  70%|███████   | 7/10 [00:51<00:24,  8.12s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0288, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.8896, 'compress@10': 0.5234, 'time@10': 10.5332}:  70%|███████   | 7/10 [00:59<00:24,  8.12s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0288, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.8896, 'compress@10': 0.5234, 'time@10': 10.5332}:  80%|████████  | 8/10 [00:59<00:16,  8.26s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0286, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.895, 'compress@10': 0.5224, 'time@10': 11.3013}:  80%|████████  | 8/10 [01:08<00:16,  8.26s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0286, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.895, 'compress@10': 0.5224, 'time@10': 11.3013}:  90%|█████████ | 9/10 [01:08<00:08,  8.42s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8996, 'compress@10': 0.5213, 'time@10': 11.2703}:  90%|█████████ | 9/10 [01:19<00:08,  8.42s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8996, 'compress@10': 0.5213, 'time@10': 11.2703}: 100%|██████████| 10/10 [01:19<00:00,  9.23s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.027, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8996, 'compress@10': 0.5213, 'time@10': 11.2703}: 100%|██████████| 10/10 [01:19<00:00,  7.94s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.026960792281640604
Avg hit ratio: 0.8809357509119818
Avg ndcg: 0.8995731253645436
Avg compression ratio: 0.5212749006657823
Avg train time: 11.270266699790955
Std train time: 5.8401720080642034
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8733, 'compress@10': 0.5263, 'time@10': 9.2226}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8733, 'compress@10': 0.5263, 'time@10': 9.2226}:  10%|█         | 1/10 [00:04<00:41,  4.65s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8896, 'compress@10': 0.5212, 'time@10': 8.4992}:  10%|█         | 1/10 [00:12<00:41,  4.65s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8896, 'compress@10': 0.5212, 'time@10': 8.4992}:  20%|██        | 2/10 [00:12<00:52,  6.51s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8766, 'compress@10': 0.538, 'time@10': 6.6875}:  20%|██        | 2/10 [00:14<00:52,  6.51s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.7615, 'ndcg@10': 0.8766, 'compress@10': 0.538, 'time@10': 6.6875}:  30%|███       | 3/10 [00:14<00:29,  4.25s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8806, 'compress@10': 0.5329, 'time@10': 6.7253}:  30%|███       | 3/10 [00:20<00:29,  4.25s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8806, 'compress@10': 0.5329, 'time@10': 6.7253}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.027, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8849, 'compress@10': 0.5283, 'time@10': 10.4657}:  40%|████      | 4/10 [00:33<00:31,  5.29s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.027, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8849, 'compress@10': 0.5283, 'time@10': 10.4657}:  50%|█████     | 5/10 [00:33<00:39,  7.98s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0267, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8883, 'compress@10': 0.5255, 'time@10': 10.5584}:  50%|█████     | 5/10 [00:44<00:39,  7.98s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0267, 'hit_ratio@10': 0.8507, 'ndcg@10': 0.8883, 'compress@10': 0.5255, 'time@10': 10.5584}:  60%|██████    | 6/10 [00:44<00:36,  9.03s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0273, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8887, 'compress@10': 0.5247, 'time@10': 10.8122}:  60%|██████    | 6/10 [00:50<00:36,  9.03s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0273, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8887, 'compress@10': 0.5247, 'time@10': 10.8122}:  70%|███████   | 7/10 [00:50<00:24,  8.10s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0265, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8918, 'compress@10': 0.5234, 'time@10': 10.5386}:  70%|███████   | 7/10 [00:59<00:24,  8.10s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0265, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8918, 'compress@10': 0.5234, 'time@10': 10.5386}:  80%|████████  | 8/10 [00:59<00:16,  8.28s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0256, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8975, 'compress@10': 0.5224, 'time@10': 11.3078}:  80%|████████  | 8/10 [01:08<00:16,  8.28s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0256, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.8975, 'compress@10': 0.5224, 'time@10': 11.3078}:  90%|█████████ | 9/10 [01:08<00:08,  8.43s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8986, 'compress@10': 0.5213, 'time@10': 11.2777}:  90%|█████████ | 9/10 [01:19<00:08,  8.43s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8986, 'compress@10': 0.5213, 'time@10': 11.2777}: 100%|██████████| 10/10 [01:19<00:00,  9.24s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.8986, 'compress@10': 0.5213, 'time@10': 11.2777}: 100%|██████████| 10/10 [01:19<00:00,  7.94s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.02586077032229973
Avg hit ratio: 0.8755901287921661
Avg ndcg: 0.8986311080407173
Avg compression ratio: 0.5212748895963483
Avg train time: 11.277710390090942
Std train time: 5.919629190040678
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0357, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8768, 'compress@10': 0.5263, 'time@10': 9.143}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0357, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8768, 'compress@10': 0.5263, 'time@10': 9.143}:  10%|█         | 1/10 [00:04<00:41,  4.61s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.897, 'compress@10': 0.5212, 'time@10': 8.4412}:  10%|█         | 1/10 [00:12<00:41,  4.61s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.897, 'compress@10': 0.5212, 'time@10': 8.4412}:  20%|██        | 2/10 [00:12<00:51,  6.47s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8815, 'compress@10': 0.538, 'time@10': 6.6599}:  20%|██        | 2/10 [00:13<00:51,  6.47s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0214, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8815, 'compress@10': 0.538, 'time@10': 6.6599}:  30%|███       | 3/10 [00:13<00:29,  4.24s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8846, 'compress@10': 0.5329, 'time@10': 6.7194}:  30%|███       | 3/10 [00:20<00:29,  4.24s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8846, 'compress@10': 0.5329, 'time@10': 6.7194}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0249, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8894, 'compress@10': 0.5283, 'time@10': 10.4496}:  40%|████      | 4/10 [00:33<00:31,  5.31s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0249, 'hit_ratio@10': 0.8512, 'ndcg@10': 0.8894, 'compress@10': 0.5283, 'time@10': 10.4496}:  50%|█████     | 5/10 [00:33<00:39,  7.98s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0247, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8928, 'compress@10': 0.5255, 'time@10': 10.4907}:  50%|█████     | 5/10 [00:44<00:39,  7.98s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0247, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8928, 'compress@10': 0.5255, 'time@10': 10.4907}:  60%|██████    | 6/10 [00:44<00:35,  8.92s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0245, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.894, 'compress@10': 0.5247, 'time@10': 10.6484}:  60%|██████    | 6/10 [00:50<00:35,  8.92s/it] {'epoch': 16, 'num_users': 6.2857, 'loss': 0.0245, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.894, 'compress@10': 0.5247, 'time@10': 10.6484}:  70%|███████   | 7/10 [00:50<00:23,  7.91s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8992, 'compress@10': 0.5234, 'time@10': 10.3698}:  70%|███████   | 7/10 [00:58<00:23,  7.91s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8992, 'compress@10': 0.5234, 'time@10': 10.3698}:  80%|████████  | 8/10 [00:58<00:16,  8.08s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9053, 'compress@10': 0.5224, 'time@10': 11.0668}:  80%|████████  | 8/10 [01:07<00:16,  8.08s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9053, 'compress@10': 0.5224, 'time@10': 11.0668}:  90%|█████████ | 9/10 [01:07<00:08,  8.17s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0229, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9092, 'compress@10': 0.5213, 'time@10': 11.0048}:  90%|█████████ | 9/10 [01:17<00:08,  8.17s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0229, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9092, 'compress@10': 0.5213, 'time@10': 11.0048}: 100%|██████████| 10/10 [01:17<00:00,  8.88s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0229, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9092, 'compress@10': 0.5213, 'time@10': 11.0048}: 100%|██████████| 10/10 [01:17<00:00,  7.75s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.022864948733236228
Avg hit ratio: 0.8863044145064519
Avg ndcg: 0.9091644472121354
Avg compression ratio: 0.5212748901104289
Avg train time: 11.004791688919067
Std train time: 5.823414086679344
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8798, 'compress@10': 0.5263, 'time@10': 8.7579}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8798, 'compress@10': 0.5263, 'time@10': 8.7579}:  10%|█         | 1/10 [00:04<00:39,  4.42s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9002, 'compress@10': 0.5212, 'time@10': 8.0631}:  10%|█         | 1/10 [00:11<00:39,  4.42s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9002, 'compress@10': 0.5212, 'time@10': 8.0631}:  20%|██        | 2/10 [00:11<00:49,  6.18s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8837, 'compress@10': 0.538, 'time@10': 6.3478}:  20%|██        | 2/10 [00:13<00:49,  6.18s/it]  {'epoch': 17, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8837, 'compress@10': 0.538, 'time@10': 6.3478}:  30%|███       | 3/10 [00:13<00:28,  4.04s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.889, 'compress@10': 0.5329, 'time@10': 6.4211}:  30%|███       | 3/10 [00:19<00:28,  4.04s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.889, 'compress@10': 0.5329, 'time@10': 6.4211}:  40%|████      | 4/10 [00:19<00:30,  5.08s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8967, 'compress@10': 0.5283, 'time@10': 9.9375}:  40%|████      | 4/10 [00:32<00:30,  5.08s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0237, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.8967, 'compress@10': 0.5283, 'time@10': 9.9375}:  50%|█████     | 5/10 [00:32<00:37,  7.59s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0253, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.8979, 'compress@10': 0.5255, 'time@10': 10.0976}:  50%|█████     | 5/10 [00:42<00:37,  7.59s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0253, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.8979, 'compress@10': 0.5255, 'time@10': 10.0976}:  60%|██████    | 6/10 [00:42<00:34,  8.73s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.8984, 'compress@10': 0.5247, 'time@10': 10.3314}:  60%|██████    | 6/10 [00:48<00:34,  8.73s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.8984, 'compress@10': 0.5247, 'time@10': 10.3314}:  70%|███████   | 7/10 [00:48<00:23,  7.80s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0242, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9035, 'compress@10': 0.5234, 'time@10': 10.0772}:  70%|███████   | 7/10 [00:57<00:23,  7.80s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0242, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9035, 'compress@10': 0.5234, 'time@10': 10.0772}:  80%|████████  | 8/10 [00:57<00:15,  7.97s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9089, 'compress@10': 0.5224, 'time@10': 10.802}:  80%|████████  | 8/10 [01:05<00:15,  7.97s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9089, 'compress@10': 0.5224, 'time@10': 10.802}:  90%|█████████ | 9/10 [01:05<00:08,  8.09s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9114, 'compress@10': 0.5213, 'time@10': 10.7685}:  90%|█████████ | 9/10 [01:16<00:08,  8.09s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9114, 'compress@10': 0.5213, 'time@10': 10.7685}: 100%|██████████| 10/10 [01:16<00:00,  8.83s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.8991, 'ndcg@10': 0.9114, 'compress@10': 0.5213, 'time@10': 10.7685}: 100%|██████████| 10/10 [01:16<00:00,  7.60s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.023256075308561053
Avg hit ratio: 0.8990529525181478
Avg ndcg: 0.9113990271339272
Avg compression ratio: 0.5212749006657823
Avg train time: 10.768460178375244
Std train time: 5.573147497513485
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8848, 'compress@10': 0.5263, 'time@10': 9.0421}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0303, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8848, 'compress@10': 0.5263, 'time@10': 9.0421}:  10%|█         | 1/10 [00:04<00:41,  4.56s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9106, 'compress@10': 0.5212, 'time@10': 8.2067}:  10%|█         | 1/10 [00:11<00:41,  4.56s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9106, 'compress@10': 0.5212, 'time@10': 8.2067}:  20%|██        | 2/10 [00:11<00:50,  6.25s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8906, 'compress@10': 0.538, 'time@10': 6.5244}:  20%|██        | 2/10 [00:13<00:50,  6.25s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8906, 'compress@10': 0.538, 'time@10': 6.5244}:  30%|███       | 3/10 [00:13<00:28,  4.14s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8958, 'compress@10': 0.5329, 'time@10': 6.521}:  30%|███       | 3/10 [00:20<00:28,  4.14s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8958, 'compress@10': 0.5329, 'time@10': 6.521}:  40%|████      | 4/10 [00:20<00:30,  5.09s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9029, 'compress@10': 0.5283, 'time@10': 9.989}:  40%|████      | 4/10 [00:32<00:30,  5.09s/it] {'epoch': 18, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9029, 'compress@10': 0.5283, 'time@10': 9.989}:  50%|█████     | 5/10 [00:32<00:37,  7.57s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0228, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9054, 'compress@10': 0.5255, 'time@10': 10.1235}:  50%|█████     | 5/10 [00:42<00:37,  7.57s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0228, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9054, 'compress@10': 0.5255, 'time@10': 10.1235}:  60%|██████    | 6/10 [00:42<00:34,  8.68s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9038, 'compress@10': 0.5247, 'time@10': 10.3268}:  60%|██████    | 6/10 [00:48<00:34,  8.68s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0231, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9038, 'compress@10': 0.5247, 'time@10': 10.3268}:  70%|███████   | 7/10 [00:48<00:23,  7.74s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0221, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9084, 'compress@10': 0.5234, 'time@10': 10.0668}:  70%|███████   | 7/10 [00:57<00:23,  7.74s/it]  {'epoch': 18, 'num_users': 6.125, 'loss': 0.0221, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9084, 'compress@10': 0.5234, 'time@10': 10.0668}:  80%|████████  | 8/10 [00:57<00:15,  7.92s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9187, 'compress@10': 0.5224, 'time@10': 10.8116}:  80%|████████  | 8/10 [01:05<00:15,  7.92s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.022, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9187, 'compress@10': 0.5224, 'time@10': 10.8116}:  90%|█████████ | 9/10 [01:05<00:08,  8.07s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9213, 'compress@10': 0.5213, 'time@10': 10.7849}:  90%|█████████ | 9/10 [01:16<00:08,  8.07s/it]  {'epoch': 18, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9213, 'compress@10': 0.5213, 'time@10': 10.7849}: 100%|██████████| 10/10 [01:16<00:00,  8.85s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9213, 'compress@10': 0.5213, 'time@10': 10.7849}: 100%|██████████| 10/10 [01:16<00:00,  7.61s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.02193024994776604
Avg hit ratio: 0.9081164445816399
Avg ndcg: 0.9213056773684768
Avg compression ratio: 0.5212749006657823
Avg train time: 10.784885025024414
Std train time: 5.52247148648927
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8848, 'compress@10': 0.5263, 'time@10': 8.9341}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8848, 'compress@10': 0.5263, 'time@10': 8.9341}:  10%|█         | 1/10 [00:04<00:40,  4.52s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9036, 'compress@10': 0.5212, 'time@10': 8.173}:  10%|█         | 1/10 [00:11<00:40,  4.52s/it] {'epoch': 19, 'num_users': 7.0, 'loss': 0.0276, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9036, 'compress@10': 0.5212, 'time@10': 8.173}:  20%|██        | 2/10 [00:11<00:49,  6.24s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.886, 'compress@10': 0.538, 'time@10': 6.3948}:  20%|██        | 2/10 [00:13<00:49,  6.24s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.886, 'compress@10': 0.538, 'time@10': 6.3948}:  30%|███       | 3/10 [00:13<00:28,  4.06s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8937, 'compress@10': 0.5329, 'time@10': 6.4496}:  30%|███       | 3/10 [00:20<00:28,  4.06s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.8937, 'compress@10': 0.5329, 'time@10': 6.4496}:  40%|████      | 4/10 [00:20<00:30,  5.08s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9038, 'compress@10': 0.5283, 'time@10': 9.9021}:  40%|████      | 4/10 [00:31<00:30,  5.08s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0218, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9038, 'compress@10': 0.5283, 'time@10': 9.9021}:  50%|█████     | 5/10 [00:31<00:37,  7.54s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9109, 'compress@10': 0.5255, 'time@10': 10.0824}:  50%|█████     | 5/10 [00:43<00:37,  7.54s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9109, 'compress@10': 0.5255, 'time@10': 10.0824}:  60%|██████    | 6/10 [00:43<00:34,  8.73s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0235, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9128, 'compress@10': 0.5247, 'time@10': 10.3397}:  60%|██████    | 6/10 [00:48<00:34,  8.73s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0235, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9128, 'compress@10': 0.5247, 'time@10': 10.3397}:  70%|███████   | 7/10 [00:48<00:23,  7.83s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9158, 'compress@10': 0.5234, 'time@10': 10.0843}:  70%|███████   | 7/10 [00:57<00:23,  7.83s/it]  {'epoch': 19, 'num_users': 6.125, 'loss': 0.0225, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9158, 'compress@10': 0.5234, 'time@10': 10.0843}:  80%|████████  | 8/10 [00:57<00:15,  7.99s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9379, 'compress@10': 0.5224, 'time@10': 10.8194}:  80%|████████  | 8/10 [01:05<00:15,  7.99s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.9379, 'compress@10': 0.5224, 'time@10': 10.8194}:  90%|█████████ | 9/10 [01:05<00:08,  8.12s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9397, 'compress@10': 0.5213, 'time@10': 10.7831}:  90%|█████████ | 9/10 [01:16<00:08,  8.12s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9397, 'compress@10': 0.5213, 'time@10': 10.7831}: 100%|██████████| 10/10 [01:16<00:00,  8.85s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9397, 'compress@10': 0.5213, 'time@10': 10.7831}: 100%|██████████| 10/10 [01:16<00:00,  7.62s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.022799712153889734
Avg hit ratio: 0.905259301724497
Avg ndcg: 0.9396805119422927
Avg compression ratio: 0.5212749006657823
Avg train time: 10.783060121536256
Std train time: 5.522596234334439
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8893, 'compress@10': 0.5263, 'time@10': 8.8668}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8893, 'compress@10': 0.5263, 'time@10': 8.8668}:  10%|█         | 1/10 [00:04<00:40,  4.47s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9102, 'compress@10': 0.5212, 'time@10': 8.126}:  10%|█         | 1/10 [00:11<00:40,  4.47s/it]  {'epoch': 20, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9102, 'compress@10': 0.5212, 'time@10': 8.126}:  20%|██        | 2/10 [00:11<00:49,  6.21s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8903, 'compress@10': 0.538, 'time@10': 6.4065}:  20%|██        | 2/10 [00:13<00:49,  6.21s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0199, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8903, 'compress@10': 0.538, 'time@10': 6.4065}:  30%|███       | 3/10 [00:13<00:28,  4.07s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9005, 'compress@10': 0.5329, 'time@10': 6.4195}:  30%|███       | 3/10 [00:19<00:28,  4.07s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9005, 'compress@10': 0.5329, 'time@10': 6.4195}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0208, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.909, 'compress@10': 0.5283, 'time@10': 9.9036}:  40%|████      | 4/10 [00:31<00:30,  5.03s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.0208, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.909, 'compress@10': 0.5283, 'time@10': 9.9036}:  50%|█████     | 5/10 [00:31<00:37,  7.53s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.021, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9142, 'compress@10': 0.5255, 'time@10': 10.0618}:  50%|█████     | 5/10 [00:42<00:37,  7.53s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.021, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9142, 'compress@10': 0.5255, 'time@10': 10.0618}:  60%|██████    | 6/10 [00:42<00:34,  8.67s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0217, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9115, 'compress@10': 0.5247, 'time@10': 10.301}:  60%|██████    | 6/10 [00:48<00:34,  8.67s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 0.0217, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9115, 'compress@10': 0.5247, 'time@10': 10.301}:  70%|███████   | 7/10 [00:48<00:23,  7.77s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.909, 'ndcg@10': 0.9151, 'compress@10': 0.5234, 'time@10': 10.026}:  70%|███████   | 7/10 [00:56<00:23,  7.77s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.909, 'ndcg@10': 0.9151, 'compress@10': 0.5234, 'time@10': 10.026}:  80%|████████  | 8/10 [00:56<00:15,  7.88s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.024, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9079, 'compress@10': 0.5224, 'time@10': 10.7523}:  80%|████████  | 8/10 [01:05<00:15,  7.88s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.024, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9079, 'compress@10': 0.5224, 'time@10': 10.7523}:  90%|█████████ | 9/10 [01:05<00:08,  8.02s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0242, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9086, 'compress@10': 0.5213, 'time@10': 10.7273}:  90%|█████████ | 9/10 [01:15<00:08,  8.02s/it]  {'epoch': 20, 'num_users': 6.3, 'loss': 0.0242, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9086, 'compress@10': 0.5213, 'time@10': 10.7273}: 100%|██████████| 10/10 [01:15<00:00,  8.80s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0242, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9086, 'compress@10': 0.5213, 'time@10': 10.7273}: 100%|██████████| 10/10 [01:15<00:00,  7.57s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.02424617083314763
Avg hit ratio: 0.9048906381300268
Avg ndcg: 0.9085880544450553
Avg compression ratio: 0.5212749006657823
Avg train time: 10.727271842956544
Std train time: 5.5411941636192745
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8874, 'compress@10': 0.5263, 'time@10': 8.9388}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8874, 'compress@10': 0.5263, 'time@10': 8.9388}:  10%|█         | 1/10 [00:04<00:40,  4.51s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9155, 'compress@10': 0.5212, 'time@10': 8.1516}:  10%|█         | 1/10 [00:11<00:40,  4.51s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9155, 'compress@10': 0.5212, 'time@10': 8.1516}:  20%|██        | 2/10 [00:11<00:49,  6.21s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8939, 'compress@10': 0.538, 'time@10': 6.4177}:  20%|██        | 2/10 [00:13<00:49,  6.21s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8939, 'compress@10': 0.538, 'time@10': 6.4177}:  30%|███       | 3/10 [00:13<00:28,  4.06s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8982, 'compress@10': 0.5329, 'time@10': 6.4613}:  30%|███       | 3/10 [00:20<00:28,  4.06s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0203, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.8982, 'compress@10': 0.5329, 'time@10': 6.4613}:  40%|████      | 4/10 [00:20<00:30,  5.08s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0202, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9081, 'compress@10': 0.5283, 'time@10': 10.0524}:  40%|████      | 4/10 [00:32<00:30,  5.08s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0202, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9081, 'compress@10': 0.5283, 'time@10': 10.0524}:  50%|█████     | 5/10 [00:32<00:38,  7.66s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9154, 'compress@10': 0.5255, 'time@10': 10.1565}:  50%|█████     | 5/10 [00:43<00:38,  7.66s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9154, 'compress@10': 0.5255, 'time@10': 10.1565}:  60%|██████    | 6/10 [00:43<00:34,  8.70s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9187, 'compress@10': 0.5247, 'time@10': 10.4302}:  60%|██████    | 6/10 [00:49<00:34,  8.70s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9187, 'compress@10': 0.5247, 'time@10': 10.4302}:  70%|███████   | 7/10 [00:49<00:23,  7.84s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.018, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9227, 'compress@10': 0.5234, 'time@10': 10.154}:  70%|███████   | 7/10 [00:57<00:23,  7.84s/it]   {'epoch': 21, 'num_users': 6.125, 'loss': 0.018, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9227, 'compress@10': 0.5234, 'time@10': 10.154}:  80%|████████  | 8/10 [00:57<00:15,  7.97s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9364, 'compress@10': 0.5224, 'time@10': 10.8733}:  80%|████████  | 8/10 [01:05<00:15,  7.97s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.019, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9364, 'compress@10': 0.5224, 'time@10': 10.8733}:  90%|█████████ | 9/10 [01:05<00:08,  8.09s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.94, 'compress@10': 0.5213, 'time@10': 10.8406}:  90%|█████████ | 9/10 [01:16<00:08,  8.09s/it]    {'epoch': 21, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.94, 'compress@10': 0.5213, 'time@10': 10.8406}: 100%|██████████| 10/10 [01:16<00:00,  8.86s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.94, 'compress@10': 0.5213, 'time@10': 10.8406}: 100%|██████████| 10/10 [01:16<00:00,  7.63s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.018062659732952718
Avg hit ratio: 0.901664831678414
Avg ndcg: 0.93996756494292
Avg compression ratio: 0.5212749006657823
Avg train time: 10.840646648406983
Std train time: 5.677315928861562
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8958, 'compress@10': 0.5263, 'time@10': 8.7009}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0267, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8958, 'compress@10': 0.5263, 'time@10': 8.7009}:  10%|█         | 1/10 [00:04<00:39,  4.39s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9269, 'compress@10': 0.5212, 'time@10': 8.0331}:  10%|█         | 1/10 [00:11<00:39,  4.39s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9269, 'compress@10': 0.5212, 'time@10': 8.0331}:  20%|██        | 2/10 [00:11<00:49,  6.16s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9015, 'compress@10': 0.538, 'time@10': 6.3317}:  20%|██        | 2/10 [00:13<00:49,  6.16s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9015, 'compress@10': 0.538, 'time@10': 6.3317}:  30%|███       | 3/10 [00:13<00:28,  4.04s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.909, 'compress@10': 0.5329, 'time@10': 6.4209}:  30%|███       | 3/10 [00:20<00:28,  4.04s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.909, 'compress@10': 0.5329, 'time@10': 6.4209}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0184, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9158, 'compress@10': 0.5283, 'time@10': 10.0252}:  40%|████      | 4/10 [00:32<00:30,  5.10s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0184, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9158, 'compress@10': 0.5283, 'time@10': 10.0252}:  50%|█████     | 5/10 [00:32<00:38,  7.68s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.89, 'ndcg@10': 0.923, 'compress@10': 0.5255, 'time@10': 10.2133}:  50%|█████     | 5/10 [00:43<00:38,  7.68s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.89, 'ndcg@10': 0.923, 'compress@10': 0.5255, 'time@10': 10.2133}:  60%|██████    | 6/10 [00:43<00:35,  8.87s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0215, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9229, 'compress@10': 0.5247, 'time@10': 10.4121}:  60%|██████    | 6/10 [00:49<00:35,  8.87s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0215, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9229, 'compress@10': 0.5247, 'time@10': 10.4121}:  70%|███████   | 7/10 [00:49<00:23,  7.88s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9217, 'compress@10': 0.5234, 'time@10': 10.1433}:  70%|███████   | 7/10 [00:57<00:23,  7.88s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9217, 'compress@10': 0.5234, 'time@10': 10.1433}:  80%|████████  | 8/10 [00:57<00:16,  8.01s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0253, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9124, 'compress@10': 0.5224, 'time@10': 10.8524}:  80%|████████  | 8/10 [01:05<00:16,  8.01s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0253, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9124, 'compress@10': 0.5224, 'time@10': 10.8524}:  90%|█████████ | 9/10 [01:05<00:08,  8.10s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9153, 'compress@10': 0.5213, 'time@10': 10.8172}:  90%|█████████ | 9/10 [01:16<00:08,  8.10s/it]    {'epoch': 22, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9153, 'compress@10': 0.5213, 'time@10': 10.8172}: 100%|██████████| 10/10 [01:16<00:00,  8.86s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9153, 'compress@10': 0.5213, 'time@10': 10.8172}: 100%|██████████| 10/10 [01:16<00:00,  7.65s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.02571025458720134
Avg hit ratio: 0.9019961438297601
Avg ndcg: 0.9152916271771835
Avg compression ratio: 0.5212749006657823
Avg train time: 10.81717689037323
Std train time: 5.667946178856706
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8958, 'compress@10': 0.5263, 'time@10': 8.8868}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8958, 'compress@10': 0.5263, 'time@10': 8.8868}:  10%|█         | 1/10 [00:04<00:40,  4.48s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9208, 'compress@10': 0.5212, 'time@10': 8.16}:  10%|█         | 1/10 [00:11<00:40,  4.48s/it]  {'epoch': 23, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9208, 'compress@10': 0.5212, 'time@10': 8.16}:  20%|██        | 2/10 [00:11<00:49,  6.24s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8974, 'compress@10': 0.538, 'time@10': 6.3909}:  20%|██        | 2/10 [00:13<00:49,  6.24s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8974, 'compress@10': 0.538, 'time@10': 6.3909}:  30%|███       | 3/10 [00:13<00:28,  4.06s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9086, 'compress@10': 0.5329, 'time@10': 6.465}:  30%|███       | 3/10 [00:20<00:28,  4.06s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9086, 'compress@10': 0.5329, 'time@10': 6.465}:  40%|████      | 4/10 [00:20<00:30,  5.11s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9178, 'compress@10': 0.5283, 'time@10': 9.995}:  40%|████      | 4/10 [00:32<00:30,  5.11s/it] {'epoch': 23, 'num_users': 5.8, 'loss': 0.016, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9178, 'compress@10': 0.5283, 'time@10': 9.995}:  50%|█████     | 5/10 [00:32<00:38,  7.63s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9229, 'compress@10': 0.5255, 'time@10': 10.1571}:  50%|█████     | 5/10 [00:43<00:38,  7.63s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9229, 'compress@10': 0.5255, 'time@10': 10.1571}:  60%|██████    | 6/10 [00:43<00:35,  8.78s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0169, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9229, 'compress@10': 0.5247, 'time@10': 10.3965}:  60%|██████    | 6/10 [00:49<00:35,  8.78s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0169, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9229, 'compress@10': 0.5247, 'time@10': 10.3965}:  70%|███████   | 7/10 [00:49<00:23,  7.85s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9265, 'compress@10': 0.5234, 'time@10': 10.1199}:  70%|███████   | 7/10 [00:57<00:23,  7.85s/it]  {'epoch': 23, 'num_users': 6.125, 'loss': 0.016, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9265, 'compress@10': 0.5234, 'time@10': 10.1199}:  80%|████████  | 8/10 [00:57<00:15,  7.97s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9316, 'compress@10': 0.5224, 'time@10': 10.8713}:  80%|████████  | 8/10 [01:05<00:15,  7.97s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9316, 'compress@10': 0.5224, 'time@10': 10.8713}:  90%|█████████ | 9/10 [01:05<00:08,  8.13s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9351, 'compress@10': 0.5213, 'time@10': 10.8507}:  90%|█████████ | 9/10 [01:16<00:08,  8.13s/it]    {'epoch': 23, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9351, 'compress@10': 0.5213, 'time@10': 10.8507}: 100%|██████████| 10/10 [01:16<00:00,  8.92s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9351, 'compress@10': 0.5213, 'time@10': 10.8507}: 100%|██████████| 10/10 [01:16<00:00,  7.66s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.01600849293013904
Avg hit ratio: 0.9114815239467191
Avg ndcg: 0.9351161188968049
Avg compression ratio: 0.5212749006657823
Avg train time: 10.85073344707489
Std train time: 5.632881033923759
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9022, 'compress@10': 0.5263, 'time@10': 8.8064}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9022, 'compress@10': 0.5263, 'time@10': 8.8064}:  10%|█         | 1/10 [00:04<00:39,  4.44s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9271, 'compress@10': 0.5212, 'time@10': 8.0817}:  10%|█         | 1/10 [00:11<00:39,  4.44s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9271, 'compress@10': 0.5212, 'time@10': 8.0817}:  20%|██        | 2/10 [00:11<00:49,  6.18s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9016, 'compress@10': 0.538, 'time@10': 6.3513}:  20%|██        | 2/10 [00:13<00:49,  6.18s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9016, 'compress@10': 0.538, 'time@10': 6.3513}:  30%|███       | 3/10 [00:13<00:28,  4.04s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9122, 'compress@10': 0.5329, 'time@10': 6.4011}:  30%|███       | 3/10 [00:19<00:28,  4.04s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9122, 'compress@10': 0.5329, 'time@10': 6.4011}:  40%|████      | 4/10 [00:19<00:30,  5.04s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9204, 'compress@10': 0.5283, 'time@10': 9.9068}:  40%|████      | 4/10 [00:31<00:30,  5.04s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9204, 'compress@10': 0.5283, 'time@10': 9.9068}:  50%|█████     | 5/10 [00:31<00:37,  7.55s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0195, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9278, 'compress@10': 0.5255, 'time@10': 10.0565}:  50%|█████     | 5/10 [00:42<00:37,  7.55s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0195, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9278, 'compress@10': 0.5255, 'time@10': 10.0565}:  60%|██████    | 6/10 [00:42<00:34,  8.67s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9304, 'compress@10': 0.5247, 'time@10': 10.2962}:  60%|██████    | 6/10 [00:48<00:34,  8.67s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9304, 'compress@10': 0.5247, 'time@10': 10.2962}:  70%|███████   | 7/10 [00:48<00:23,  7.77s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0189, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9317, 'compress@10': 0.5234, 'time@10': 10.0382}:  70%|███████   | 7/10 [00:56<00:23,  7.77s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0189, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9317, 'compress@10': 0.5234, 'time@10': 10.0382}:  80%|████████  | 8/10 [00:56<00:15,  7.93s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9254, 'compress@10': 0.5224, 'time@10': 10.7606}:  80%|████████  | 8/10 [01:05<00:15,  7.93s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9254, 'compress@10': 0.5224, 'time@10': 10.7606}:  90%|█████████ | 9/10 [01:05<00:08,  8.05s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0208, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9294, 'compress@10': 0.5213, 'time@10': 10.7374}:  90%|█████████ | 9/10 [01:15<00:08,  8.05s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0208, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9294, 'compress@10': 0.5213, 'time@10': 10.7374}: 100%|██████████| 10/10 [01:15<00:00,  8.82s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0208, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9294, 'compress@10': 0.5213, 'time@10': 10.7374}: 100%|██████████| 10/10 [01:15<00:00,  7.58s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.020777537873156948
Avg hit ratio: 0.9114815239467191
Avg ndcg: 0.9294109905631872
Avg compression ratio: 0.5212749006657823
Avg train time: 10.737361693382264
Std train time: 5.561399723186862
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9022, 'compress@10': 0.5263, 'time@10': 8.9601}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9022, 'compress@10': 0.5263, 'time@10': 8.9601}:  10%|█         | 1/10 [00:04<00:40,  4.52s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9462, 'compress@10': 0.5212, 'time@10': 8.1424}:  10%|█         | 1/10 [00:11<00:40,  4.52s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9462, 'compress@10': 0.5212, 'time@10': 8.1424}:  20%|██        | 2/10 [00:11<00:49,  6.19s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9143, 'compress@10': 0.538, 'time@10': 6.4198}:  20%|██        | 2/10 [00:13<00:49,  6.19s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9143, 'compress@10': 0.538, 'time@10': 6.4198}:  30%|███       | 3/10 [00:13<00:28,  4.06s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9229, 'compress@10': 0.5329, 'time@10': 6.4945}:  30%|███       | 3/10 [00:20<00:28,  4.06s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9229, 'compress@10': 0.5329, 'time@10': 6.4945}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0185, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9299, 'compress@10': 0.5283, 'time@10': 9.9697}:  40%|████      | 4/10 [00:32<00:30,  5.12s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0185, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9299, 'compress@10': 0.5283, 'time@10': 9.9697}:  50%|█████     | 5/10 [00:32<00:37,  7.59s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9347, 'compress@10': 0.5255, 'time@10': 10.1374}:  50%|█████     | 5/10 [00:43<00:37,  7.59s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9347, 'compress@10': 0.5255, 'time@10': 10.1374}:  60%|██████    | 6/10 [00:43<00:35,  8.76s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0226, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9327, 'compress@10': 0.5247, 'time@10': 10.371}:  60%|██████    | 6/10 [00:49<00:35,  8.76s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.0226, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9327, 'compress@10': 0.5247, 'time@10': 10.371}:  70%|███████   | 7/10 [00:49<00:23,  7.83s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0216, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9352, 'compress@10': 0.5234, 'time@10': 10.1218}:  70%|███████   | 7/10 [00:57<00:23,  7.83s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0216, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9352, 'compress@10': 0.5234, 'time@10': 10.1218}:  80%|████████  | 8/10 [00:57<00:16,  8.02s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0232, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9534, 'compress@10': 0.5224, 'time@10': 10.8546}:  80%|████████  | 8/10 [01:05<00:16,  8.02s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0232, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9534, 'compress@10': 0.5224, 'time@10': 10.8546}:  90%|█████████ | 9/10 [01:05<00:08,  8.14s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0227, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9525, 'compress@10': 0.5213, 'time@10': 10.8112}:  90%|█████████ | 9/10 [01:16<00:08,  8.14s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 0.0227, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9525, 'compress@10': 0.5213, 'time@10': 10.8112}: 100%|██████████| 10/10 [01:16<00:00,  8.85s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0227, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9525, 'compress@10': 0.5213, 'time@10': 10.8112}: 100%|██████████| 10/10 [01:16<00:00,  7.63s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.022689417536665153
Avg hit ratio: 0.9086243810895762
Avg ndcg: 0.9525441043363191
Avg compression ratio: 0.5212748951310653
Avg train time: 10.811217880249023
Std train time: 5.533533906091048
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9032, 'compress@10': 0.5263, 'time@10': 8.7814}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9032, 'compress@10': 0.5263, 'time@10': 8.7814}:  10%|█         | 1/10 [00:04<00:39,  4.43s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9221, 'compress@10': 0.5212, 'time@10': 8.0872}:  10%|█         | 1/10 [00:11<00:39,  4.43s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9221, 'compress@10': 0.5212, 'time@10': 8.0872}:  20%|██        | 2/10 [00:11<00:49,  6.20s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8983, 'compress@10': 0.538, 'time@10': 6.3514}:  20%|██        | 2/10 [00:13<00:49,  6.20s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8983, 'compress@10': 0.538, 'time@10': 6.3514}:  30%|███       | 3/10 [00:13<00:28,  4.04s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9102, 'compress@10': 0.5329, 'time@10': 6.3909}:  30%|███       | 3/10 [00:19<00:28,  4.04s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9102, 'compress@10': 0.5329, 'time@10': 6.3909}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9194, 'compress@10': 0.5283, 'time@10': 9.9078}:  40%|████      | 4/10 [00:31<00:30,  5.03s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9194, 'compress@10': 0.5283, 'time@10': 9.9078}:  50%|█████     | 5/10 [00:31<00:37,  7.55s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0159, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.926, 'compress@10': 0.5255, 'time@10': 10.0461}:  50%|█████     | 5/10 [00:42<00:37,  7.55s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0159, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.926, 'compress@10': 0.5255, 'time@10': 10.0461}:  60%|██████    | 6/10 [00:42<00:34,  8.65s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9286, 'compress@10': 0.5247, 'time@10': 10.3282}:  60%|██████    | 6/10 [00:48<00:34,  8.65s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9286, 'compress@10': 0.5247, 'time@10': 10.3282}:  70%|███████   | 7/10 [00:48<00:23,  7.80s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9326, 'compress@10': 0.5234, 'time@10': 10.0691}:  70%|███████   | 7/10 [00:57<00:23,  7.80s/it]  {'epoch': 26, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9326, 'compress@10': 0.5234, 'time@10': 10.0691}:  80%|████████  | 8/10 [00:57<00:15,  7.96s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9484, 'compress@10': 0.5224, 'time@10': 10.8361}:  80%|████████  | 8/10 [01:05<00:15,  7.96s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.9017, 'ndcg@10': 0.9484, 'compress@10': 0.5224, 'time@10': 10.8361}:  90%|█████████ | 9/10 [01:05<00:08,  8.16s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.951, 'compress@10': 0.5213, 'time@10': 10.8096}:  90%|█████████ | 9/10 [01:16<00:08,  8.16s/it]    {'epoch': 26, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.951, 'compress@10': 0.5213, 'time@10': 10.8096}: 100%|██████████| 10/10 [01:16<00:00,  8.91s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.9093, 'ndcg@10': 0.951, 'compress@10': 0.5213, 'time@10': 10.8096}: 100%|██████████| 10/10 [01:16<00:00,  7.62s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.017587113832288132
Avg hit ratio: 0.9092593017244969
Avg ndcg: 0.9510449057505965
Avg compression ratio: 0.5212749006657823
Avg train time: 10.809560847282409
Std train time: 5.626125675660071
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9092, 'compress@10': 0.5263, 'time@10': 8.8661}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9092, 'compress@10': 0.5263, 'time@10': 8.8661}:  10%|█         | 1/10 [00:04<00:40,  4.47s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9651, 'compress@10': 0.5212, 'time@10': 8.1666}:  10%|█         | 1/10 [00:11<00:40,  4.47s/it] {'epoch': 27, 'num_users': 7.0, 'loss': 0.0284, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9651, 'compress@10': 0.5212, 'time@10': 8.1666}:  20%|██        | 2/10 [00:11<00:50,  6.26s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9269, 'compress@10': 0.538, 'time@10': 6.4354}:  20%|██        | 2/10 [00:13<00:50,  6.26s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9269, 'compress@10': 0.538, 'time@10': 6.4354}:  30%|███       | 3/10 [00:13<00:28,  4.09s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9327, 'compress@10': 0.5329, 'time@10': 6.4693}:  30%|███       | 3/10 [00:20<00:28,  4.09s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9327, 'compress@10': 0.5329, 'time@10': 6.4693}:  40%|████      | 4/10 [00:20<00:30,  5.09s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0202, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9375, 'compress@10': 0.5283, 'time@10': 10.0202}:  40%|████      | 4/10 [00:32<00:30,  5.09s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0202, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9375, 'compress@10': 0.5283, 'time@10': 10.0202}:  50%|█████     | 5/10 [00:32<00:38,  7.63s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9422, 'compress@10': 0.5255, 'time@10': 10.1658}:  50%|█████     | 5/10 [00:43<00:38,  7.63s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9422, 'compress@10': 0.5255, 'time@10': 10.1658}:  60%|██████    | 6/10 [00:43<00:35,  8.75s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0177, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9432, 'compress@10': 0.5247, 'time@10': 10.3868}:  60%|██████    | 6/10 [00:49<00:35,  8.75s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0177, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9432, 'compress@10': 0.5247, 'time@10': 10.3868}:  70%|███████   | 7/10 [00:49<00:23,  7.82s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9421, 'compress@10': 0.5234, 'time@10': 10.1211}:  70%|███████   | 7/10 [00:57<00:23,  7.82s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9421, 'compress@10': 0.5234, 'time@10': 10.1211}:  80%|████████  | 8/10 [00:57<00:15,  7.97s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0199, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9412, 'compress@10': 0.5224, 'time@10': 10.8608}:  80%|████████  | 8/10 [01:05<00:15,  7.97s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0199, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9412, 'compress@10': 0.5224, 'time@10': 10.8608}:  90%|█████████ | 9/10 [01:05<00:08,  8.11s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.021, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9387, 'compress@10': 0.5213, 'time@10': 10.8305}:  90%|█████████ | 9/10 [01:16<00:08,  8.11s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.021, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9387, 'compress@10': 0.5213, 'time@10': 10.8305}: 100%|██████████| 10/10 [01:16<00:00,  8.88s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.021, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9387, 'compress@10': 0.5213, 'time@10': 10.8305}: 100%|██████████| 10/10 [01:16<00:00,  7.64s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.021022555754711077
Avg hit ratio: 0.9082557174951063
Avg ndcg: 0.9387166669766861
Avg compression ratio: 0.5212749006657823
Avg train time: 10.830523014068604
Std train time: 5.632597611933872
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9151, 'compress@10': 0.5263, 'time@10': 8.9569}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9151, 'compress@10': 0.5263, 'time@10': 8.9569}:  10%|█         | 1/10 [00:04<00:40,  4.52s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9799, 'compress@10': 0.5212, 'time@10': 8.1937}:  10%|█         | 1/10 [00:11<00:40,  4.52s/it] {'epoch': 28, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9799, 'compress@10': 0.5212, 'time@10': 8.1937}:  20%|██        | 2/10 [00:11<00:50,  6.25s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9368, 'compress@10': 0.538, 'time@10': 6.4517}:  20%|██        | 2/10 [00:13<00:50,  6.25s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9368, 'compress@10': 0.538, 'time@10': 6.4517}:  30%|███       | 3/10 [00:13<00:28,  4.09s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9394, 'compress@10': 0.5329, 'time@10': 6.4779}:  30%|███       | 3/10 [00:20<00:28,  4.09s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9394, 'compress@10': 0.5329, 'time@10': 6.4779}:  40%|████      | 4/10 [00:20<00:30,  5.08s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9443, 'compress@10': 0.5283, 'time@10': 10.0581}:  40%|████      | 4/10 [00:32<00:30,  5.08s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0175, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9443, 'compress@10': 0.5283, 'time@10': 10.0581}:  50%|█████     | 5/10 [00:32<00:38,  7.66s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9477, 'compress@10': 0.5255, 'time@10': 10.157}:  50%|█████     | 5/10 [00:43<00:38,  7.66s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0199, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9477, 'compress@10': 0.5255, 'time@10': 10.157}:  60%|██████    | 6/10 [00:43<00:34,  8.69s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0202, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9444, 'compress@10': 0.5247, 'time@10': 10.3523}:  60%|██████    | 6/10 [00:48<00:34,  8.69s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0202, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9444, 'compress@10': 0.5247, 'time@10': 10.3523}:  70%|███████   | 7/10 [00:48<00:23,  7.74s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0202, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9445, 'compress@10': 0.5234, 'time@10': 10.0849}:  70%|███████   | 7/10 [00:57<00:23,  7.74s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0202, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9445, 'compress@10': 0.5234, 'time@10': 10.0849}:  80%|████████  | 8/10 [00:57<00:15,  7.90s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9451, 'compress@10': 0.5224, 'time@10': 10.8574}:  80%|████████  | 8/10 [01:05<00:15,  7.90s/it] {'epoch': 28, 'num_users': 6.3333, 'loss': 0.02, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9451, 'compress@10': 0.5224, 'time@10': 10.8574}:  90%|█████████ | 9/10 [01:05<00:08,  8.11s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.948, 'compress@10': 0.5213, 'time@10': 10.811}:  90%|█████████ | 9/10 [01:16<00:08,  8.11s/it]    {'epoch': 28, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.948, 'compress@10': 0.5213, 'time@10': 10.811}: 100%|██████████| 10/10 [01:16<00:00,  8.83s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.948, 'compress@10': 0.5213, 'time@10': 10.811}: 100%|██████████| 10/10 [01:16<00:00,  7.61s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01897768876555218
Avg hit ratio: 0.9082557174951063
Avg ndcg: 0.9480361587604985
Avg compression ratio: 0.5212749006657823
Avg train time: 10.81103732585907
Std train time: 5.699061098883703
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9157, 'compress@10': 0.5263, 'time@10': 8.7884}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9157, 'compress@10': 0.5263, 'time@10': 8.7884}:  10%|█         | 1/10 [00:04<00:39,  4.43s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9393, 'compress@10': 0.5212, 'time@10': 8.0757}:  10%|█         | 1/10 [00:11<00:39,  4.43s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9393, 'compress@10': 0.5212, 'time@10': 8.0757}:  20%|██        | 2/10 [00:11<00:49,  6.18s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9098, 'compress@10': 0.538, 'time@10': 6.3297}:  20%|██        | 2/10 [00:13<00:49,  6.18s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9098, 'compress@10': 0.538, 'time@10': 6.3297}:  30%|███       | 3/10 [00:13<00:28,  4.02s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9196, 'compress@10': 0.5329, 'time@10': 6.3788}:  30%|███       | 3/10 [00:19<00:28,  4.02s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9196, 'compress@10': 0.5329, 'time@10': 6.3788}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9272, 'compress@10': 0.5283, 'time@10': 9.9009}:  40%|████      | 4/10 [00:31<00:30,  5.02s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9272, 'compress@10': 0.5283, 'time@10': 9.9009}:  50%|█████     | 5/10 [00:31<00:37,  7.55s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9339, 'compress@10': 0.5255, 'time@10': 10.0554}:  50%|█████     | 5/10 [00:42<00:37,  7.55s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0148, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9339, 'compress@10': 0.5255, 'time@10': 10.0554}:  60%|██████    | 6/10 [00:42<00:34,  8.68s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9358, 'compress@10': 0.5247, 'time@10': 10.2987}:  60%|██████    | 6/10 [00:48<00:34,  8.68s/it] {'epoch': 29, 'num_users': 6.2857, 'loss': 0.014, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9358, 'compress@10': 0.5247, 'time@10': 10.2987}:  70%|███████   | 7/10 [00:48<00:23,  7.78s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9388, 'compress@10': 0.5234, 'time@10': 10.0383}:  70%|███████   | 7/10 [00:56<00:23,  7.78s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9388, 'compress@10': 0.5234, 'time@10': 10.0383}:  80%|████████  | 8/10 [00:56<00:15,  7.93s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9412, 'compress@10': 0.5224, 'time@10': 10.7612}:  80%|████████  | 8/10 [01:05<00:15,  7.93s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9412, 'compress@10': 0.5224, 'time@10': 10.7612}:  90%|█████████ | 9/10 [01:05<00:08,  8.05s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.9435, 'compress@10': 0.5213, 'time@10': 10.7182}:  90%|█████████ | 9/10 [01:15<00:08,  8.05s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.9435, 'compress@10': 0.5213, 'time@10': 10.7182}: 100%|██████████| 10/10 [01:15<00:00,  8.76s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.9435, 'compress@10': 0.5213, 'time@10': 10.7182}: 100%|██████████| 10/10 [01:15<00:00,  7.56s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.013915572394706633
Avg hit ratio: 0.9121164445816398
Avg ndcg: 0.943489823168165
Avg compression ratio: 0.5212748951310653
Avg train time: 10.718210911750793
Std train time: 5.587733030253692
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.5263, 'time@10': 8.8306}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0159, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9179, 'compress@10': 0.5263, 'time@10': 8.8306}:  10%|█         | 1/10 [00:04<00:40,  4.45s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9369, 'compress@10': 0.5212, 'time@10': 8.0046}:  10%|█         | 1/10 [00:11<00:40,  4.45s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9369, 'compress@10': 0.5212, 'time@10': 8.0046}:  20%|██        | 2/10 [00:11<00:48,  6.08s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9082, 'compress@10': 0.538, 'time@10': 6.2975}:  20%|██        | 2/10 [00:13<00:48,  6.08s/it]  {'epoch': 30, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9082, 'compress@10': 0.538, 'time@10': 6.2975}:  30%|███       | 3/10 [00:13<00:27,  3.98s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9184, 'compress@10': 0.5329, 'time@10': 6.3706}:  30%|███       | 3/10 [00:19<00:27,  3.98s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9184, 'compress@10': 0.5329, 'time@10': 6.3706}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9264, 'compress@10': 0.5283, 'time@10': 10.0616}:  40%|████      | 4/10 [00:32<00:30,  5.02s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9264, 'compress@10': 0.5283, 'time@10': 10.0616}:  50%|█████     | 5/10 [00:32<00:38,  7.70s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9336, 'compress@10': 0.5255, 'time@10': 10.1847}:  50%|█████     | 5/10 [00:43<00:38,  7.70s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9336, 'compress@10': 0.5255, 'time@10': 10.1847}:  60%|██████    | 6/10 [00:43<00:35,  8.77s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9351, 'compress@10': 0.5247, 'time@10': 10.381}:  60%|██████    | 6/10 [00:48<00:35,  8.77s/it]  {'epoch': 30, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9351, 'compress@10': 0.5247, 'time@10': 10.381}:  70%|███████   | 7/10 [00:48<00:23,  7.81s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9376, 'compress@10': 0.5234, 'time@10': 10.099}:  70%|███████   | 7/10 [00:57<00:23,  7.81s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9376, 'compress@10': 0.5234, 'time@10': 10.099}:  80%|████████  | 8/10 [00:57<00:15,  7.92s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9399, 'compress@10': 0.5224, 'time@10': 10.8646}:  80%|████████  | 8/10 [01:05<00:15,  7.92s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0174, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9399, 'compress@10': 0.5224, 'time@10': 10.8646}:  90%|█████████ | 9/10 [01:05<00:08,  8.11s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9435, 'compress@10': 0.5213, 'time@10': 10.8104}:  90%|█████████ | 9/10 [01:15<00:08,  8.11s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9435, 'compress@10': 0.5213, 'time@10': 10.8104}: 100%|██████████| 10/10 [01:15<00:00,  8.81s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9435, 'compress@10': 0.5213, 'time@10': 10.8104}: 100%|██████████| 10/10 [01:15<00:00,  7.60s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.015817719142201602
Avg hit ratio: 0.9111359018269034
Avg ndcg: 0.9435448862669459
Avg compression ratio: 0.5212748967914804
Avg train time: 10.810356092453002
Std train time: 5.834043509932613
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.92, 'compress@10': 0.5263, 'time@10': 8.7834}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.92, 'compress@10': 0.5263, 'time@10': 8.7834}:  10%|█         | 1/10 [00:04<00:39,  4.43s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9385, 'compress@10': 0.5212, 'time@10': 8.1092}:  10%|█         | 1/10 [00:11<00:39,  4.43s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9385, 'compress@10': 0.5212, 'time@10': 8.1092}:  20%|██        | 2/10 [00:11<00:49,  6.22s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9092, 'compress@10': 0.538, 'time@10': 6.3597}:  20%|██        | 2/10 [00:13<00:49,  6.22s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9092, 'compress@10': 0.538, 'time@10': 6.3597}:  30%|███       | 3/10 [00:13<00:28,  4.06s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.92, 'compress@10': 0.5329, 'time@10': 6.4342}:  30%|███       | 3/10 [00:20<00:28,  4.06s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.92, 'compress@10': 0.5329, 'time@10': 6.4342}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9288, 'compress@10': 0.5283, 'time@10': 9.9135}:  40%|████      | 4/10 [00:32<00:30,  5.10s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9288, 'compress@10': 0.5283, 'time@10': 9.9135}:  50%|█████     | 5/10 [00:32<00:37,  7.57s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.937, 'compress@10': 0.5255, 'time@10': 10.0302}:  50%|█████     | 5/10 [00:42<00:37,  7.57s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.937, 'compress@10': 0.5255, 'time@10': 10.0302}:  60%|██████    | 6/10 [00:42<00:34,  8.62s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9373, 'compress@10': 0.5247, 'time@10': 10.2945}:  60%|██████    | 6/10 [00:48<00:34,  8.62s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.9373, 'compress@10': 0.5247, 'time@10': 10.2945}:  70%|███████   | 7/10 [00:48<00:23,  7.76s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0166, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9357, 'compress@10': 0.5234, 'time@10': 10.0345}:  70%|███████   | 7/10 [00:56<00:23,  7.76s/it]  {'epoch': 31, 'num_users': 6.125, 'loss': 0.0166, 'hit_ratio@10': 0.918, 'ndcg@10': 0.9357, 'compress@10': 0.5234, 'time@10': 10.0345}:  80%|████████  | 8/10 [00:56<00:15,  7.91s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9411, 'compress@10': 0.5224, 'time@10': 10.7664}:  80%|████████  | 8/10 [01:05<00:15,  7.91s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0171, 'hit_ratio@10': 0.9049, 'ndcg@10': 0.9411, 'compress@10': 0.5224, 'time@10': 10.7664}:  90%|█████████ | 9/10 [01:05<00:08,  8.05s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.9415, 'compress@10': 0.5213, 'time@10': 10.7535}:  90%|█████████ | 9/10 [01:15<00:08,  8.05s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.9415, 'compress@10': 0.5213, 'time@10': 10.7535}: 100%|██████████| 10/10 [01:15<00:00,  8.86s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.9415, 'compress@10': 0.5213, 'time@10': 10.7535}: 100%|██████████| 10/10 [01:15<00:00,  7.60s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.0187105451476643
Avg hit ratio: 0.9121164445816398
Avg ndcg: 0.941486398388356
Avg compression ratio: 0.5212749006657823
Avg train time: 10.75354449748993
Std train time: 5.542217494509818
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.92, 'compress@10': 0.5263, 'time@10': 8.867}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.92, 'compress@10': 0.5263, 'time@10': 8.867}:  10%|█         | 1/10 [00:04<00:40,  4.47s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9642, 'compress@10': 0.5212, 'time@10': 8.0476}:  10%|█         | 1/10 [00:11<00:40,  4.47s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9642, 'compress@10': 0.5212, 'time@10': 8.0476}:  20%|██        | 2/10 [00:11<00:48,  6.12s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9264, 'compress@10': 0.538, 'time@10': 6.3301}:  20%|██        | 2/10 [00:13<00:48,  6.12s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0176, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9264, 'compress@10': 0.538, 'time@10': 6.3301}:  30%|███       | 3/10 [00:13<00:28,  4.00s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9339, 'compress@10': 0.5329, 'time@10': 6.3682}:  30%|███       | 3/10 [00:19<00:28,  4.00s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9339, 'compress@10': 0.5329, 'time@10': 6.3682}:  40%|████      | 4/10 [00:19<00:29,  5.00s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9398, 'compress@10': 0.5283, 'time@10': 9.8983}:  40%|████      | 4/10 [00:31<00:29,  5.00s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0165, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9398, 'compress@10': 0.5283, 'time@10': 9.8983}:  50%|█████     | 5/10 [00:31<00:37,  7.54s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9452, 'compress@10': 0.5255, 'time@10': 10.0409}:  50%|█████     | 5/10 [00:42<00:37,  7.54s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9452, 'compress@10': 0.5255, 'time@10': 10.0409}:  60%|██████    | 6/10 [00:42<00:34,  8.64s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9459, 'compress@10': 0.5247, 'time@10': 10.2506}:  60%|██████    | 6/10 [00:48<00:34,  8.64s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.9043, 'ndcg@10': 0.9459, 'compress@10': 0.5247, 'time@10': 10.2506}:  70%|███████   | 7/10 [00:48<00:23,  7.71s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9482, 'compress@10': 0.5234, 'time@10': 9.9997}:  70%|███████   | 7/10 [00:56<00:23,  7.71s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9482, 'compress@10': 0.5234, 'time@10': 9.9997}:  80%|████████  | 8/10 [00:56<00:15,  7.89s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9421, 'compress@10': 0.5224, 'time@10': 10.741}:  80%|████████  | 8/10 [01:05<00:15,  7.89s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9421, 'compress@10': 0.5224, 'time@10': 10.741}:  90%|█████████ | 9/10 [01:05<00:08,  8.04s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9453, 'compress@10': 0.5213, 'time@10': 10.7131}:  90%|█████████ | 9/10 [01:15<00:08,  8.04s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9453, 'compress@10': 0.5213, 'time@10': 10.7131}: 100%|██████████| 10/10 [01:15<00:00,  8.80s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9453, 'compress@10': 0.5213, 'time@10': 10.7131}: 100%|██████████| 10/10 [01:15<00:00,  7.55s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.0159049525051534
Avg hit ratio: 0.8993156253292076
Avg ndcg: 0.9453211059088822
Avg compression ratio: 0.5212748920562225
Avg train time: 10.71314537525177
Std train time: 5.602793566821632
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.5263, 'time@10': 8.7511}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.5263, 'time@10': 8.7511}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9847, 'compress@10': 0.5212, 'time@10': 8.0835}:  10%|█         | 1/10 [00:11<00:39,  4.41s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9847, 'compress@10': 0.5212, 'time@10': 8.0835}:  20%|██        | 2/10 [00:11<00:49,  6.20s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.94, 'compress@10': 0.538, 'time@10': 6.3425}:  20%|██        | 2/10 [00:13<00:49,  6.20s/it]  {'epoch': 33, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.94, 'compress@10': 0.538, 'time@10': 6.3425}:  30%|███       | 3/10 [00:13<00:28,  4.04s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9427, 'compress@10': 0.5329, 'time@10': 6.3756}:  30%|███       | 3/10 [00:19<00:28,  4.04s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9427, 'compress@10': 0.5329, 'time@10': 6.3756}:  40%|████      | 4/10 [00:19<00:30,  5.01s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0144, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9474, 'compress@10': 0.5283, 'time@10': 9.9837}:  40%|████      | 4/10 [00:32<00:30,  5.01s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0144, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9474, 'compress@10': 0.5283, 'time@10': 9.9837}:  50%|█████     | 5/10 [00:32<00:38,  7.62s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9542, 'compress@10': 0.5255, 'time@10': 10.1331}:  50%|█████     | 5/10 [00:43<00:38,  7.62s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.9542, 'compress@10': 0.5255, 'time@10': 10.1331}:  60%|██████    | 6/10 [00:43<00:34,  8.74s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.017, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9518, 'compress@10': 0.5247, 'time@10': 10.3514}:  60%|██████    | 6/10 [00:48<00:34,  8.74s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.017, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9518, 'compress@10': 0.5247, 'time@10': 10.3514}:  70%|███████   | 7/10 [00:48<00:23,  7.80s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9603, 'compress@10': 0.5234, 'time@10': 10.0914}:  70%|███████   | 7/10 [00:57<00:23,  7.80s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0179, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9603, 'compress@10': 0.5234, 'time@10': 10.0914}:  80%|████████  | 8/10 [00:57<00:15,  7.96s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0218, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9614, 'compress@10': 0.5224, 'time@10': 10.8577}:  80%|████████  | 8/10 [01:05<00:15,  7.96s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0218, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9614, 'compress@10': 0.5224, 'time@10': 10.8577}:  90%|█████████ | 9/10 [01:05<00:08,  8.14s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9644, 'compress@10': 0.5213, 'time@10': 10.8138}:  90%|█████████ | 9/10 [01:16<00:08,  8.14s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9644, 'compress@10': 0.5213, 'time@10': 10.8138}: 100%|██████████| 10/10 [01:16<00:00,  8.86s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0213, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9644, 'compress@10': 0.5213, 'time@10': 10.8138}: 100%|██████████| 10/10 [01:16<00:00,  7.62s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.02129061027294
Avg hit ratio: 0.9053985746379635
Avg ndcg: 0.9644304940479194
Avg compression ratio: 0.5212749006657823
Avg train time: 10.813773584365844
Std train time: 5.730446219202414
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.5263, 'time@10': 8.6752}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.5263, 'time@10': 8.6752}:  10%|█         | 1/10 [00:04<00:39,  4.41s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.893, 'ndcg@10': 0.944, 'compress@10': 0.5212, 'time@10': 8.0503}:  10%|█         | 1/10 [00:11<00:39,  4.41s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.893, 'ndcg@10': 0.944, 'compress@10': 0.5212, 'time@10': 8.0503}:  20%|██        | 2/10 [00:11<00:49,  6.20s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9129, 'compress@10': 0.538, 'time@10': 6.3023}:  20%|██        | 2/10 [00:13<00:49,  6.20s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9129, 'compress@10': 0.538, 'time@10': 6.3023}:  30%|███       | 3/10 [00:13<00:28,  4.03s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9245, 'compress@10': 0.5329, 'time@10': 6.361}:  30%|███       | 3/10 [00:19<00:28,  4.03s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9245, 'compress@10': 0.5329, 'time@10': 6.361}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9322, 'compress@10': 0.5283, 'time@10': 9.8598}:  40%|████      | 4/10 [00:31<00:30,  5.03s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0136, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9322, 'compress@10': 0.5283, 'time@10': 9.8598}:  50%|█████     | 5/10 [00:31<00:37,  7.53s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.939, 'compress@10': 0.5255, 'time@10': 10.0063}:  50%|█████     | 5/10 [00:42<00:37,  7.53s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0117, 'hit_ratio@10': 0.9004, 'ndcg@10': 0.939, 'compress@10': 0.5255, 'time@10': 10.0063}:  60%|██████    | 6/10 [00:42<00:34,  8.64s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.941, 'compress@10': 0.5247, 'time@10': 10.2742}:  60%|██████    | 6/10 [00:48<00:34,  8.64s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.941, 'compress@10': 0.5247, 'time@10': 10.2742}:  70%|███████   | 7/10 [00:48<00:23,  7.77s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9351, 'compress@10': 0.5234, 'time@10': 10.0294}:  70%|███████   | 7/10 [00:56<00:23,  7.77s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9167, 'ndcg@10': 0.9351, 'compress@10': 0.5234, 'time@10': 10.0294}:  80%|████████  | 8/10 [00:56<00:15,  7.95s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9454, 'compress@10': 0.5224, 'time@10': 10.7652}:  80%|████████  | 8/10 [01:05<00:15,  7.95s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.9454, 'compress@10': 0.5224, 'time@10': 10.7652}:  90%|█████████ | 9/10 [01:05<00:08,  8.08s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9457, 'compress@10': 0.5213, 'time@10': 10.7394}:  90%|█████████ | 9/10 [01:15<00:08,  8.08s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9457, 'compress@10': 0.5213, 'time@10': 10.7394}: 100%|██████████| 10/10 [01:15<00:00,  8.85s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9457, 'compress@10': 0.5213, 'time@10': 10.7394}: 100%|██████████| 10/10 [01:15<00:00,  7.59s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.014520523942713465
Avg hit ratio: 0.913970003209392
Avg ndcg: 0.9457337367719854
Avg compression ratio: 0.5212749006657823
Avg train time: 10.73941786289215
Std train time: 5.568151260139449
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.5263, 'time@10': 8.8584}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.5263, 'time@10': 8.8584}:  10%|█         | 1/10 [00:04<00:42,  4.67s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9589, 'compress@10': 0.5212, 'time@10': 8.0615}:  10%|█         | 1/10 [00:11<00:42,  4.67s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9589, 'compress@10': 0.5212, 'time@10': 8.0615}:  20%|██        | 2/10 [00:11<00:49,  6.22s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9228, 'compress@10': 0.538, 'time@10': 6.3176}:  20%|██        | 2/10 [00:13<00:49,  6.22s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9228, 'compress@10': 0.538, 'time@10': 6.3176}:  30%|███       | 3/10 [00:13<00:28,  4.04s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9322, 'compress@10': 0.5329, 'time@10': 6.4021}:  30%|███       | 3/10 [00:20<00:28,  4.04s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9322, 'compress@10': 0.5329, 'time@10': 6.4021}:  40%|████      | 4/10 [00:20<00:30,  5.09s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9403, 'compress@10': 0.5283, 'time@10': 9.9308}:  40%|████      | 4/10 [00:32<00:30,  5.09s/it] {'epoch': 35, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9403, 'compress@10': 0.5283, 'time@10': 9.9308}:  50%|█████     | 5/10 [00:32<00:38,  7.60s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9446, 'compress@10': 0.5255, 'time@10': 10.0933}:  50%|█████     | 5/10 [00:43<00:38,  7.60s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0141, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9446, 'compress@10': 0.5255, 'time@10': 10.0933}:  60%|██████    | 6/10 [00:43<00:34,  8.74s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9458, 'compress@10': 0.5247, 'time@10': 10.3621}:  60%|██████    | 6/10 [00:49<00:34,  8.74s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9458, 'compress@10': 0.5247, 'time@10': 10.3621}:  70%|███████   | 7/10 [00:49<00:23,  7.85s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9472, 'compress@10': 0.5234, 'time@10': 10.1042}:  70%|███████   | 7/10 [00:57<00:23,  7.85s/it]  {'epoch': 35, 'num_users': 6.125, 'loss': 0.013, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9472, 'compress@10': 0.5234, 'time@10': 10.1042}:  80%|████████  | 8/10 [00:57<00:16,  8.01s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9486, 'compress@10': 0.5224, 'time@10': 10.8254}:  80%|████████  | 8/10 [01:05<00:16,  8.01s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9486, 'compress@10': 0.5224, 'time@10': 10.8254}:  90%|█████████ | 9/10 [01:05<00:08,  8.11s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9514, 'compress@10': 0.5213, 'time@10': 10.7941}:  90%|█████████ | 9/10 [01:16<00:08,  8.11s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9514, 'compress@10': 0.5213, 'time@10': 10.7941}: 100%|██████████| 10/10 [01:16<00:00,  8.87s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9514, 'compress@10': 0.5213, 'time@10': 10.7941}: 100%|██████████| 10/10 [01:16<00:00,  7.64s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.011687114165314346
Avg hit ratio: 0.9114815239467191
Avg ndcg: 0.9514453447429801
Avg compression ratio: 0.5212749006657823
Avg train time: 10.794102001190186
Std train time: 5.6011320350375735
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9228, 'compress@10': 0.5263, 'time@10': 8.9141}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9228, 'compress@10': 0.5263, 'time@10': 8.9141}:  10%|█         | 1/10 [00:04<00:40,  4.49s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9979, 'compress@10': 0.5212, 'time@10': 8.1289}:  10%|█         | 1/10 [00:11<00:40,  4.49s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.0206, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9979, 'compress@10': 0.5212, 'time@10': 8.1289}:  20%|██        | 2/10 [00:11<00:49,  6.19s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9488, 'compress@10': 0.538, 'time@10': 6.3631}:  20%|██        | 2/10 [00:13<00:49,  6.19s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9488, 'compress@10': 0.538, 'time@10': 6.3631}:  30%|███       | 3/10 [00:13<00:28,  4.03s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9498, 'compress@10': 0.5329, 'time@10': 6.4507}:  30%|███       | 3/10 [00:20<00:28,  4.03s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9498, 'compress@10': 0.5329, 'time@10': 6.4507}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9552, 'compress@10': 0.5283, 'time@10': 10.1224}:  40%|████      | 4/10 [00:32<00:30,  5.10s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9552, 'compress@10': 0.5283, 'time@10': 10.1224}:  50%|█████     | 5/10 [00:32<00:38,  7.75s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9581, 'compress@10': 0.5255, 'time@10': 10.2476}:  50%|█████     | 5/10 [00:43<00:38,  7.75s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9581, 'compress@10': 0.5255, 'time@10': 10.2476}:  60%|██████    | 6/10 [00:43<00:35,  8.83s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9572, 'compress@10': 0.5247, 'time@10': 10.4758}:  60%|██████    | 6/10 [00:49<00:35,  8.83s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9572, 'compress@10': 0.5247, 'time@10': 10.4758}:  70%|███████   | 7/10 [00:49<00:23,  7.89s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9581, 'compress@10': 0.5234, 'time@10': 10.2044}:  70%|███████   | 7/10 [00:57<00:23,  7.89s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0145, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9581, 'compress@10': 0.5234, 'time@10': 10.2044}:  80%|████████  | 8/10 [00:57<00:16,  8.03s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9522, 'compress@10': 0.5224, 'time@10': 10.9397}:  80%|████████  | 8/10 [01:06<00:16,  8.03s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9522, 'compress@10': 0.5224, 'time@10': 10.9397}:  90%|█████████ | 9/10 [01:06<00:08,  8.17s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.952, 'compress@10': 0.5213, 'time@10': 10.903}:  90%|█████████ | 9/10 [01:16<00:08,  8.17s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.952, 'compress@10': 0.5213, 'time@10': 10.903}: 100%|██████████| 10/10 [01:16<00:00,  8.92s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0168, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.952, 'compress@10': 0.5213, 'time@10': 10.903}: 100%|██████████| 10/10 [01:16<00:00,  7.68s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.016781639910070843
Avg hit ratio: 0.9095414317808206
Avg ndcg: 0.9519958798998462
Avg compression ratio: 0.5212749006657823
Avg train time: 10.903048610687256
Std train time: 5.79227370716788
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9228, 'compress@10': 0.5263, 'time@10': 8.6063}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9228, 'compress@10': 0.5263, 'time@10': 8.6063}:  10%|█         | 1/10 [00:04<00:39,  4.34s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9428, 'compress@10': 0.5212, 'time@10': 8.0214}:  10%|█         | 1/10 [00:11<00:39,  4.34s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0139, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9428, 'compress@10': 0.5212, 'time@10': 8.0214}:  20%|██        | 2/10 [00:11<00:49,  6.18s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9121, 'compress@10': 0.538, 'time@10': 6.3019}:  20%|██        | 2/10 [00:13<00:49,  6.18s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9121, 'compress@10': 0.538, 'time@10': 6.3019}:  30%|███       | 3/10 [00:13<00:28,  4.03s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9243, 'compress@10': 0.5329, 'time@10': 6.321}:  30%|███       | 3/10 [00:19<00:28,  4.03s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9243, 'compress@10': 0.5329, 'time@10': 6.321}:  40%|████      | 4/10 [00:19<00:29,  4.97s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9336, 'compress@10': 0.5283, 'time@10': 9.9334}:  40%|████      | 4/10 [00:31<00:29,  4.97s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0135, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9336, 'compress@10': 0.5283, 'time@10': 9.9334}:  50%|█████     | 5/10 [00:31<00:37,  7.59s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9402, 'compress@10': 0.5255, 'time@10': 10.0895}:  50%|█████     | 5/10 [00:42<00:37,  7.59s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.9058, 'ndcg@10': 0.9402, 'compress@10': 0.5255, 'time@10': 10.0895}:  60%|██████    | 6/10 [00:42<00:34,  8.72s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9422, 'compress@10': 0.5247, 'time@10': 10.3324}:  60%|██████    | 6/10 [00:48<00:34,  8.72s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0131, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9422, 'compress@10': 0.5247, 'time@10': 10.3324}:  70%|███████   | 7/10 [00:48<00:23,  7.81s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9478, 'compress@10': 0.5234, 'time@10': 10.0618}:  70%|███████   | 7/10 [00:56<00:23,  7.81s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.9208, 'ndcg@10': 0.9478, 'compress@10': 0.5234, 'time@10': 10.0618}:  80%|████████  | 8/10 [00:56<00:15,  7.93s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9499, 'compress@10': 0.5224, 'time@10': 10.7952}:  80%|████████  | 8/10 [01:05<00:15,  7.93s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9499, 'compress@10': 0.5224, 'time@10': 10.7952}:  90%|█████████ | 9/10 [01:05<00:08,  8.07s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9525, 'compress@10': 0.5213, 'time@10': 10.7537}:  90%|█████████ | 9/10 [01:15<00:08,  8.07s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9525, 'compress@10': 0.5213, 'time@10': 10.7537}: 100%|██████████| 10/10 [01:15<00:00,  8.79s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9525, 'compress@10': 0.5213, 'time@10': 10.7537}: 100%|██████████| 10/10 [01:15<00:00,  7.58s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.014126407540036415
Avg hit ratio: 0.9114815239467191
Avg ndcg: 0.9524572342954849
Avg compression ratio: 0.5212749006657823
Avg train time: 10.75368583202362
Std train time: 5.706127416795435
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.5263, 'time@10': 8.9508}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.5263, 'time@10': 8.9508}:  10%|█         | 1/10 [00:04<00:40,  4.51s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9458, 'compress@10': 0.5212, 'time@10': 8.1047}:  10%|█         | 1/10 [00:11<00:40,  4.51s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9458, 'compress@10': 0.5212, 'time@10': 8.1047}:  20%|██        | 2/10 [00:11<00:49,  6.15s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9141, 'compress@10': 0.538, 'time@10': 6.3634}:  20%|██        | 2/10 [00:13<00:49,  6.15s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9141, 'compress@10': 0.538, 'time@10': 6.3634}:  30%|███       | 3/10 [00:13<00:28,  4.02s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9262, 'compress@10': 0.5329, 'time@10': 6.4028}:  30%|███       | 3/10 [00:19<00:28,  4.02s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9262, 'compress@10': 0.5329, 'time@10': 6.4028}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9364, 'compress@10': 0.5283, 'time@10': 9.8885}:  40%|████      | 4/10 [00:31<00:30,  5.02s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9364, 'compress@10': 0.5283, 'time@10': 9.8885}:  50%|█████     | 5/10 [00:31<00:37,  7.52s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9433, 'compress@10': 0.5255, 'time@10': 10.0218}:  50%|█████     | 5/10 [00:42<00:37,  7.52s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9433, 'compress@10': 0.5255, 'time@10': 10.0218}:  60%|██████    | 6/10 [00:42<00:34,  8.61s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9447, 'compress@10': 0.5247, 'time@10': 10.2694}:  60%|██████    | 6/10 [00:48<00:34,  8.61s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9447, 'compress@10': 0.5247, 'time@10': 10.2694}:  70%|███████   | 7/10 [00:48<00:23,  7.73s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9417, 'compress@10': 0.5234, 'time@10': 10.0418}:  70%|███████   | 7/10 [00:56<00:23,  7.73s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9417, 'compress@10': 0.5234, 'time@10': 10.0418}:  80%|████████  | 8/10 [00:56<00:15,  7.97s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.9034, 'ndcg@10': 0.9441, 'compress@10': 0.5224, 'time@10': 10.8249}:  80%|████████  | 8/10 [01:05<00:15,  7.97s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.012, 'hit_ratio@10': 0.9034, 'ndcg@10': 0.9441, 'compress@10': 0.5224, 'time@10': 10.8249}:  90%|█████████ | 9/10 [01:05<00:08,  8.16s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9494, 'compress@10': 0.5213, 'time@10': 10.8095}:  90%|█████████ | 9/10 [01:16<00:08,  8.16s/it]  {'epoch': 38, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9494, 'compress@10': 0.5213, 'time@10': 10.8095}: 100%|██████████| 10/10 [01:16<00:00,  8.95s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.9494, 'compress@10': 0.5213, 'time@10': 10.8095}: 100%|██████████| 10/10 [01:16<00:00,  7.62s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.013463445018756732
Avg hit ratio: 0.9107672382324334
Avg ndcg: 0.9494219485459594
Avg compression ratio: 0.5212748962631665
Avg train time: 10.809472346305848
Std train time: 5.593146429471466
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.5263, 'time@10': 8.8293}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.5263, 'time@10': 8.8293}:  10%|█         | 1/10 [00:04<00:40,  4.45s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9446, 'compress@10': 0.5212, 'time@10': 8.1395}:  10%|█         | 1/10 [00:11<00:40,  4.45s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0075, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9446, 'compress@10': 0.5212, 'time@10': 8.1395}:  20%|██        | 2/10 [00:11<00:49,  6.24s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9133, 'compress@10': 0.538, 'time@10': 6.3899}:  20%|██        | 2/10 [00:13<00:49,  6.24s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9133, 'compress@10': 0.538, 'time@10': 6.3899}:  30%|███       | 3/10 [00:13<00:28,  4.07s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9228, 'compress@10': 0.5329, 'time@10': 6.4762}:  30%|███       | 3/10 [00:20<00:28,  4.07s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9228, 'compress@10': 0.5329, 'time@10': 6.4762}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9339, 'compress@10': 0.5283, 'time@10': 10.1151}:  40%|████      | 4/10 [00:32<00:30,  5.14s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9339, 'compress@10': 0.5283, 'time@10': 10.1151}:  50%|█████     | 5/10 [00:32<00:38,  7.75s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9406, 'compress@10': 0.5255, 'time@10': 10.2599}:  50%|█████     | 5/10 [00:43<00:38,  7.75s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9406, 'compress@10': 0.5255, 'time@10': 10.2599}:  60%|██████    | 6/10 [00:43<00:35,  8.86s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9425, 'compress@10': 0.5247, 'time@10': 10.487}:  60%|██████    | 6/10 [00:49<00:35,  8.86s/it] {'epoch': 39, 'num_users': 6.2857, 'loss': 0.0088, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9425, 'compress@10': 0.5247, 'time@10': 10.487}:  70%|███████   | 7/10 [00:49<00:23,  7.91s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9459, 'compress@10': 0.5234, 'time@10': 10.2049}:  70%|███████   | 7/10 [00:57<00:23,  7.91s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9459, 'compress@10': 0.5234, 'time@10': 10.2049}:  80%|████████  | 8/10 [00:57<00:16,  8.03s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0086, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9478, 'compress@10': 0.5224, 'time@10': 10.9569}:  80%|████████  | 8/10 [01:06<00:16,  8.03s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0086, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9478, 'compress@10': 0.5224, 'time@10': 10.9569}:  90%|█████████ | 9/10 [01:06<00:08,  8.18s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9507, 'compress@10': 0.5213, 'time@10': 10.9356}:  90%|█████████ | 9/10 [01:17<00:08,  8.18s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9507, 'compress@10': 0.5213, 'time@10': 10.9356}: 100%|██████████| 10/10 [01:17<00:00,  8.99s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0083, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9507, 'compress@10': 0.5213, 'time@10': 10.9356}: 100%|██████████| 10/10 [01:17<00:00,  7.71s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.008292535609058292
Avg hit ratio: 0.9048307302959255
Avg ndcg: 0.9507301926210238
Avg compression ratio: 0.5212749006657823
Avg train time: 10.935578966140747
Std train time: 5.764055725601259
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.5263, 'time@10': 8.664}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.5263, 'time@10': 8.664}:  10%|█         | 1/10 [00:04<00:39,  4.37s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9515, 'compress@10': 0.5212, 'time@10': 8.0639}:  10%|█         | 1/10 [00:11<00:39,  4.37s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9515, 'compress@10': 0.5212, 'time@10': 8.0639}:  20%|██        | 2/10 [00:11<00:49,  6.21s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9179, 'compress@10': 0.538, 'time@10': 6.3461}:  20%|██        | 2/10 [00:13<00:49,  6.21s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9179, 'compress@10': 0.538, 'time@10': 6.3461}:  30%|███       | 3/10 [00:13<00:28,  4.06s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9284, 'compress@10': 0.5329, 'time@10': 6.3993}:  30%|███       | 3/10 [00:19<00:28,  4.06s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9284, 'compress@10': 0.5329, 'time@10': 6.3993}:  40%|████      | 4/10 [00:19<00:30,  5.06s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9357, 'compress@10': 0.5283, 'time@10': 9.9847}:  40%|████      | 4/10 [00:32<00:30,  5.06s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9357, 'compress@10': 0.5283, 'time@10': 9.9847}:  50%|█████     | 5/10 [00:32<00:38,  7.63s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.9106, 'ndcg@10': 0.9419, 'compress@10': 0.5255, 'time@10': 10.1225}:  50%|█████     | 5/10 [00:43<00:38,  7.63s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0116, 'hit_ratio@10': 0.9106, 'ndcg@10': 0.9419, 'compress@10': 0.5255, 'time@10': 10.1225}:  60%|██████    | 6/10 [00:43<00:34,  8.73s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9436, 'compress@10': 0.5247, 'time@10': 10.3812}:  60%|██████    | 6/10 [00:49<00:34,  8.73s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0116, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9436, 'compress@10': 0.5247, 'time@10': 10.3812}:  70%|███████   | 7/10 [00:49<00:23,  7.84s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9646, 'compress@10': 0.5234, 'time@10': 10.1066}:  70%|███████   | 7/10 [00:57<00:23,  7.84s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0136, 'hit_ratio@10': 0.9244, 'ndcg@10': 0.9646, 'compress@10': 0.5234, 'time@10': 10.1066}:  80%|████████  | 8/10 [00:57<00:15,  7.96s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9704, 'compress@10': 0.5224, 'time@10': 10.8745}:  80%|████████  | 8/10 [01:05<00:15,  7.96s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9704, 'compress@10': 0.5224, 'time@10': 10.8745}:  90%|█████████ | 9/10 [01:05<00:08,  8.14s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.973, 'compress@10': 0.5213, 'time@10': 10.8407}:  90%|█████████ | 9/10 [01:16<00:08,  8.14s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.973, 'compress@10': 0.5213, 'time@10': 10.8407}: 100%|██████████| 10/10 [01:16<00:00,  8.89s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.973, 'compress@10': 0.5213, 'time@10': 10.8407}: 100%|██████████| 10/10 [01:16<00:00,  7.64s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.01571326297672526
Avg hit ratio: 0.9086474225642306
Avg ndcg: 0.9730308128210605
Avg compression ratio: 0.5212748906271054
Avg train time: 10.840734624862671
Std train time: 5.707279156711089
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.5263, 'time@10': 8.8104}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9299, 'compress@10': 0.5263, 'time@10': 8.8104}:  10%|█         | 1/10 [00:04<00:39,  4.44s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9934, 'compress@10': 0.5212, 'time@10': 8.1116}:  10%|█         | 1/10 [00:11<00:39,  4.44s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9934, 'compress@10': 0.5212, 'time@10': 8.1116}:  20%|██        | 2/10 [00:11<00:49,  6.21s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9458, 'compress@10': 0.538, 'time@10': 6.37}:  20%|██        | 2/10 [00:13<00:49,  6.21s/it]    {'epoch': 41, 'num_users': 5.0, 'loss': 0.0124, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9458, 'compress@10': 0.538, 'time@10': 6.37}:  30%|███       | 3/10 [00:13<00:28,  4.05s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9499, 'compress@10': 0.5329, 'time@10': 6.4315}:  30%|███       | 3/10 [00:20<00:28,  4.05s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9499, 'compress@10': 0.5329, 'time@10': 6.4315}:  40%|████      | 4/10 [00:20<00:30,  5.08s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9555, 'compress@10': 0.5283, 'time@10': 10.0079}:  40%|████      | 4/10 [00:32<00:30,  5.08s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9555, 'compress@10': 0.5283, 'time@10': 10.0079}:  50%|█████     | 5/10 [00:32<00:38,  7.65s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.958, 'compress@10': 0.5255, 'time@10': 10.1141}:  50%|█████     | 5/10 [00:42<00:38,  7.65s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.958, 'compress@10': 0.5255, 'time@10': 10.1141}:  60%|██████    | 6/10 [00:42<00:34,  8.68s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9576, 'compress@10': 0.5247, 'time@10': 10.372}:  60%|██████    | 6/10 [00:48<00:34,  8.68s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9576, 'compress@10': 0.5247, 'time@10': 10.372}:  70%|███████   | 7/10 [00:48<00:23,  7.81s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9588, 'compress@10': 0.5234, 'time@10': 10.0919}:  70%|███████   | 7/10 [00:57<00:23,  7.81s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9588, 'compress@10': 0.5234, 'time@10': 10.0919}:  80%|████████  | 8/10 [00:57<00:15,  7.92s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9769, 'compress@10': 0.5224, 'time@10': 10.8534}:  80%|████████  | 8/10 [01:05<00:15,  7.92s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9769, 'compress@10': 0.5224, 'time@10': 10.8534}:  90%|█████████ | 9/10 [01:05<00:08,  8.11s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.9752, 'compress@10': 0.5213, 'time@10': 10.8118}:  90%|█████████ | 9/10 [01:16<00:08,  8.11s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.9752, 'compress@10': 0.5213, 'time@10': 10.8118}: 100%|██████████| 10/10 [01:16<00:00,  8.92s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.9752, 'compress@10': 0.5213, 'time@10': 10.8118}: 100%|██████████| 10/10 [01:16<00:00,  7.64s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.015584438909818305
Avg hit ratio: 0.914627965318967
Avg ndcg: 0.9751862873045274
Avg compression ratio: 0.5212748906271054
Avg train time: 10.811825776100159
Std train time: 5.696271240135497
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.5263, 'time@10': 8.7142}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.5263, 'time@10': 8.7142}:  10%|█         | 1/10 [00:04<00:39,  4.40s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9491, 'compress@10': 0.5212, 'time@10': 8.0412}:  10%|█         | 1/10 [00:11<00:39,  4.40s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9491, 'compress@10': 0.5212, 'time@10': 8.0412}:  20%|██        | 2/10 [00:11<00:49,  6.17s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9163, 'compress@10': 0.538, 'time@10': 6.3261}:  20%|██        | 2/10 [00:13<00:49,  6.17s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9163, 'compress@10': 0.538, 'time@10': 6.3261}:  30%|███       | 3/10 [00:13<00:28,  4.03s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9278, 'compress@10': 0.5329, 'time@10': 6.4161}:  30%|███       | 3/10 [00:20<00:28,  4.03s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9278, 'compress@10': 0.5329, 'time@10': 6.4161}:  40%|████      | 4/10 [00:20<00:30,  5.09s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9368, 'compress@10': 0.5283, 'time@10': 9.9215}:  40%|████      | 4/10 [00:32<00:30,  5.09s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9368, 'compress@10': 0.5283, 'time@10': 9.9215}:  50%|█████     | 5/10 [00:32<00:37,  7.59s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.943, 'compress@10': 0.5255, 'time@10': 10.0729}:  50%|█████     | 5/10 [00:42<00:37,  7.59s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.9069, 'ndcg@10': 0.943, 'compress@10': 0.5255, 'time@10': 10.0729}:  60%|██████    | 6/10 [00:42<00:34,  8.70s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9445, 'compress@10': 0.5247, 'time@10': 10.2987}:  60%|██████    | 6/10 [00:48<00:34,  8.70s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.9145, 'ndcg@10': 0.9445, 'compress@10': 0.5247, 'time@10': 10.2987}:  70%|███████   | 7/10 [00:48<00:23,  7.78s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.9216, 'ndcg@10': 0.9485, 'compress@10': 0.5234, 'time@10': 10.0396}:  70%|███████   | 7/10 [00:57<00:23,  7.78s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.9216, 'ndcg@10': 0.9485, 'compress@10': 0.5234, 'time@10': 10.0396}:  80%|████████  | 8/10 [00:57<00:15,  7.94s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0119, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9491, 'compress@10': 0.5224, 'time@10': 10.8084}:  80%|████████  | 8/10 [01:05<00:15,  7.94s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0119, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9491, 'compress@10': 0.5224, 'time@10': 10.8084}:  90%|█████████ | 9/10 [01:05<00:08,  8.12s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9519, 'compress@10': 0.5213, 'time@10': 10.7562}:  90%|█████████ | 9/10 [01:15<00:08,  8.12s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9519, 'compress@10': 0.5213, 'time@10': 10.7562}: 100%|██████████| 10/10 [01:15<00:00,  8.80s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0113, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9519, 'compress@10': 0.5213, 'time@10': 10.7562}: 100%|██████████| 10/10 [01:15<00:00,  7.59s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.011315032601147832
Avg hit ratio: 0.9064252003420084
Avg ndcg: 0.9519211952002513
Avg compression ratio: 0.5212748967914804
Avg train time: 10.756162738800048
Std train time: 5.601816935353303
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.5263, 'time@10': 8.781}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.5263, 'time@10': 8.781}:  10%|█         | 1/10 [00:04<00:39,  4.43s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9365, 'compress@10': 0.5212, 'time@10': 8.1343}:  10%|█         | 1/10 [00:11<00:39,  4.43s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9365, 'compress@10': 0.5212, 'time@10': 8.1343}:  20%|██        | 2/10 [00:11<00:50,  6.25s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9079, 'compress@10': 0.538, 'time@10': 6.3864}:  20%|██        | 2/10 [00:13<00:50,  6.25s/it]  {'epoch': 43, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9079, 'compress@10': 0.538, 'time@10': 6.3864}:  30%|███       | 3/10 [00:13<00:28,  4.07s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9199, 'compress@10': 0.5329, 'time@10': 6.4419}:  30%|███       | 3/10 [00:20<00:28,  4.07s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9199, 'compress@10': 0.5329, 'time@10': 6.4419}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9319, 'compress@10': 0.5283, 'time@10': 9.9926}:  40%|████      | 4/10 [00:32<00:30,  5.10s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0104, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9319, 'compress@10': 0.5283, 'time@10': 9.9926}:  50%|█████     | 5/10 [00:32<00:38,  7.64s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9389, 'compress@10': 0.5255, 'time@10': 10.1149}:  50%|█████     | 5/10 [00:43<00:38,  7.64s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9389, 'compress@10': 0.5255, 'time@10': 10.1149}:  60%|██████    | 6/10 [00:43<00:34,  8.70s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9388, 'compress@10': 0.5247, 'time@10': 10.3609}:  60%|██████    | 6/10 [00:48<00:34,  8.70s/it] {'epoch': 43, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9388, 'compress@10': 0.5247, 'time@10': 10.3609}:  70%|███████   | 7/10 [00:48<00:23,  7.81s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9602, 'compress@10': 0.5234, 'time@10': 10.0829}:  70%|███████   | 7/10 [00:57<00:23,  7.81s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9602, 'compress@10': 0.5234, 'time@10': 10.0829}:  80%|████████  | 8/10 [00:57<00:15,  7.93s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9604, 'compress@10': 0.5224, 'time@10': 10.8078}:  80%|████████  | 8/10 [01:05<00:15,  7.93s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9604, 'compress@10': 0.5224, 'time@10': 10.8078}:  90%|█████████ | 9/10 [01:05<00:08,  8.06s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9619, 'compress@10': 0.5213, 'time@10': 10.8088}:  90%|█████████ | 9/10 [01:16<00:08,  8.06s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9619, 'compress@10': 0.5213, 'time@10': 10.8088}: 100%|██████████| 10/10 [01:16<00:00,  8.92s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9619, 'compress@10': 0.5213, 'time@10': 10.8088}: 100%|██████████| 10/10 [01:16<00:00,  7.64s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.012457793568530584
Avg hit ratio: 0.9082787589697606
Avg ndcg: 0.9618737806531603
Avg compression ratio: 0.5212748951310653
Avg train time: 10.808824610710143
Std train time: 5.625792620951451
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.5263, 'time@10': 8.9236}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0072, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.5263, 'time@10': 8.9236}:  10%|█         | 1/10 [00:04<00:40,  4.50s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.92, 'compress@10': 0.5212, 'time@10': 8.0856}:  10%|█         | 1/10 [00:11<00:40,  4.50s/it]  {'epoch': 44, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.92, 'compress@10': 0.5212, 'time@10': 8.0856}:  20%|██        | 2/10 [00:11<00:49,  6.15s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8969, 'compress@10': 0.538, 'time@10': 6.3878}:  20%|██        | 2/10 [00:13<00:49,  6.15s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8969, 'compress@10': 0.538, 'time@10': 6.3878}:  30%|███       | 3/10 [00:13<00:28,  4.04s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9115, 'compress@10': 0.5329, 'time@10': 6.4869}:  30%|███       | 3/10 [00:20<00:28,  4.04s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9115, 'compress@10': 0.5329, 'time@10': 6.4869}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9252, 'compress@10': 0.5283, 'time@10': 9.9932}:  40%|████      | 4/10 [00:32<00:30,  5.14s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0107, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9252, 'compress@10': 0.5283, 'time@10': 9.9932}:  50%|█████     | 5/10 [00:32<00:38,  7.63s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9335, 'compress@10': 0.5255, 'time@10': 10.1341}:  50%|█████     | 5/10 [00:43<00:38,  7.63s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9335, 'compress@10': 0.5255, 'time@10': 10.1341}:  60%|██████    | 6/10 [00:43<00:34,  8.74s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9369, 'compress@10': 0.5247, 'time@10': 10.4067}:  60%|██████    | 6/10 [00:49<00:34,  8.74s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9369, 'compress@10': 0.5247, 'time@10': 10.4067}:  70%|███████   | 7/10 [00:49<00:23,  7.86s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.94, 'compress@10': 0.5234, 'time@10': 10.123}:  70%|███████   | 7/10 [00:57<00:23,  7.86s/it]     {'epoch': 44, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9188, 'ndcg@10': 0.94, 'compress@10': 0.5234, 'time@10': 10.123}:  80%|████████  | 8/10 [00:57<00:15,  7.96s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9426, 'compress@10': 0.5224, 'time@10': 10.8098}:  80%|████████  | 8/10 [01:05<00:15,  7.96s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9426, 'compress@10': 0.5224, 'time@10': 10.8098}:  90%|█████████ | 9/10 [01:05<00:08,  8.03s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9446, 'compress@10': 0.5213, 'time@10': 10.7723}:  90%|█████████ | 9/10 [01:15<00:08,  8.03s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9446, 'compress@10': 0.5213, 'time@10': 10.7723}: 100%|██████████| 10/10 [01:15<00:00,  8.79s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.9128, 'ndcg@10': 0.9446, 'compress@10': 0.5213, 'time@10': 10.7723}: 100%|██████████| 10/10 [01:15<00:00,  7.60s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.011193614652590072
Avg hit ratio: 0.9127672382324334
Avg ndcg: 0.944567321943482
Avg compression ratio: 0.5212748761858125
Avg train time: 10.772271299362183
Std train time: 5.540757597263605
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9388, 'compress@10': 0.5263, 'time@10': 8.9921}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9388, 'compress@10': 0.5263, 'time@10': 8.9921}:  10%|█         | 1/10 [00:04<00:40,  4.53s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9558, 'compress@10': 0.5212, 'time@10': 8.1763}:  10%|█         | 1/10 [00:11<00:40,  4.53s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9558, 'compress@10': 0.5212, 'time@10': 8.1763}:  20%|██        | 2/10 [00:11<00:49,  6.22s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9208, 'compress@10': 0.538, 'time@10': 6.441}:  20%|██        | 2/10 [00:13<00:49,  6.22s/it]   {'epoch': 45, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9208, 'compress@10': 0.538, 'time@10': 6.441}:  30%|███       | 3/10 [00:13<00:28,  4.07s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9311, 'compress@10': 0.5329, 'time@10': 6.5121}:  30%|███       | 3/10 [00:20<00:28,  4.07s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9311, 'compress@10': 0.5329, 'time@10': 6.5121}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9445, 'compress@10': 0.5283, 'time@10': 10.1283}:  40%|████      | 4/10 [00:32<00:30,  5.14s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9445, 'compress@10': 0.5283, 'time@10': 10.1283}:  50%|█████     | 5/10 [00:32<00:38,  7.73s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9496, 'compress@10': 0.5255, 'time@10': 10.2482}:  50%|█████     | 5/10 [00:43<00:38,  7.73s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9496, 'compress@10': 0.5255, 'time@10': 10.2482}:  60%|██████    | 6/10 [00:43<00:35,  8.80s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9508, 'compress@10': 0.5247, 'time@10': 10.4758}:  60%|██████    | 6/10 [00:49<00:35,  8.80s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0095, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9508, 'compress@10': 0.5247, 'time@10': 10.4758}:  70%|███████   | 7/10 [00:49<00:23,  7.87s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9516, 'compress@10': 0.5234, 'time@10': 10.1868}:  70%|███████   | 7/10 [00:57<00:23,  7.87s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9516, 'compress@10': 0.5234, 'time@10': 10.1868}:  80%|████████  | 8/10 [00:57<00:15,  7.98s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9527, 'compress@10': 0.5224, 'time@10': 10.9307}:  80%|████████  | 8/10 [01:06<00:15,  7.98s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9527, 'compress@10': 0.5224, 'time@10': 10.9307}:  90%|█████████ | 9/10 [01:06<00:08,  8.14s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9551, 'compress@10': 0.5213, 'time@10': 10.9016}:  90%|█████████ | 9/10 [01:16<00:08,  8.14s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9551, 'compress@10': 0.5213, 'time@10': 10.9016}: 100%|██████████| 10/10 [01:16<00:00,  8.92s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9551, 'compress@10': 0.5213, 'time@10': 10.9016}: 100%|██████████| 10/10 [01:16<00:00,  7.68s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.009275823406798585
Avg hit ratio: 0.8971164445816399
Avg ndcg: 0.9551204171025068
Avg compression ratio: 0.5212749006657823
Avg train time: 10.901600122451782
Std train time: 5.728794804948616
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9388, 'compress@10': 0.5263, 'time@10': 8.7917}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9388, 'compress@10': 0.5263, 'time@10': 8.7917}:  10%|█         | 1/10 [00:04<00:42,  4.75s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9632, 'compress@10': 0.5212, 'time@10': 8.082}:  10%|█         | 1/10 [00:12<00:42,  4.75s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9632, 'compress@10': 0.5212, 'time@10': 8.082}:  20%|██        | 2/10 [00:12<00:50,  6.31s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9257, 'compress@10': 0.538, 'time@10': 6.3303}:  20%|██        | 2/10 [00:13<00:50,  6.31s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9257, 'compress@10': 0.538, 'time@10': 6.3303}:  30%|███       | 3/10 [00:13<00:28,  4.09s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9349, 'compress@10': 0.5329, 'time@10': 6.3745}:  30%|███       | 3/10 [00:20<00:28,  4.09s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9349, 'compress@10': 0.5329, 'time@10': 6.3745}:  40%|████      | 4/10 [00:20<00:30,  5.07s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9439, 'compress@10': 0.5283, 'time@10': 10.0315}:  40%|████      | 4/10 [00:32<00:30,  5.07s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9439, 'compress@10': 0.5283, 'time@10': 10.0315}:  50%|█████     | 5/10 [00:32<00:38,  7.70s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.929, 'ndcg@10': 0.9489, 'compress@10': 0.5255, 'time@10': 10.2159}:  50%|█████     | 5/10 [00:43<00:38,  7.70s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0096, 'hit_ratio@10': 0.929, 'ndcg@10': 0.9489, 'compress@10': 0.5255, 'time@10': 10.2159}:  60%|██████    | 6/10 [00:43<00:35,  8.88s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.9334, 'ndcg@10': 0.9502, 'compress@10': 0.5247, 'time@10': 10.4908}:  60%|██████    | 6/10 [00:49<00:35,  8.88s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.9334, 'ndcg@10': 0.9502, 'compress@10': 0.5247, 'time@10': 10.4908}:  70%|███████   | 7/10 [00:49<00:23,  7.98s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9382, 'ndcg@10': 0.9528, 'compress@10': 0.5234, 'time@10': 10.2465}:  70%|███████   | 7/10 [00:58<00:23,  7.98s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.9382, 'ndcg@10': 0.9528, 'compress@10': 0.5234, 'time@10': 10.2465}:  80%|████████  | 8/10 [00:58<00:16,  8.17s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.9197, 'ndcg@10': 0.9738, 'compress@10': 0.5224, 'time@10': 10.9534}:  80%|████████  | 8/10 [01:06<00:16,  8.17s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.9197, 'ndcg@10': 0.9738, 'compress@10': 0.5224, 'time@10': 10.9534}:  90%|█████████ | 9/10 [01:06<00:08,  8.22s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9254, 'ndcg@10': 0.9767, 'compress@10': 0.5213, 'time@10': 10.9013}:  90%|█████████ | 9/10 [01:17<00:08,  8.22s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9254, 'ndcg@10': 0.9767, 'compress@10': 0.5213, 'time@10': 10.9013}: 100%|██████████| 10/10 [01:17<00:00,  8.92s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.9254, 'ndcg@10': 0.9767, 'compress@10': 0.5213, 'time@10': 10.9013}: 100%|██████████| 10/10 [01:17<00:00,  7.72s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.013135442384431711
Avg hit ratio: 0.9254216161126179
Avg ndcg: 0.9766822033286866
Avg compression ratio: 0.5212749006657823
Avg train time: 10.90126700401306
Std train time: 5.750557589671227
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0049, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9362, 'compress@10': 0.5263, 'time@10': 8.5242}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0049, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9362, 'compress@10': 0.5263, 'time@10': 8.5242}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9559, 'compress@10': 0.5212, 'time@10': 7.804}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it] {'epoch': 47, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9559, 'compress@10': 0.5212, 'time@10': 7.804}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9208, 'compress@10': 0.538, 'time@10': 6.1783}:  20%|██        | 2/10 [00:12<00:47,  5.96s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9208, 'compress@10': 0.538, 'time@10': 6.1783}:  30%|███       | 3/10 [00:12<00:27,  3.92s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9311, 'compress@10': 0.5329, 'time@10': 6.2206}:  30%|███       | 3/10 [00:19<00:27,  3.92s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9311, 'compress@10': 0.5329, 'time@10': 6.2206}:  40%|████      | 4/10 [00:19<00:29,  4.89s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9409, 'compress@10': 0.5283, 'time@10': 9.6383}:  40%|████      | 4/10 [00:30<00:29,  4.89s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9409, 'compress@10': 0.5283, 'time@10': 9.6383}:  50%|█████     | 5/10 [00:30<00:36,  7.35s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9466, 'compress@10': 0.5255, 'time@10': 9.7952}:  50%|█████     | 5/10 [00:41<00:36,  7.35s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9466, 'compress@10': 0.5255, 'time@10': 9.7952}:  60%|██████    | 6/10 [00:41<00:33,  8.46s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9484, 'compress@10': 0.5247, 'time@10': 10.0005}:  60%|██████    | 6/10 [00:47<00:33,  8.46s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9484, 'compress@10': 0.5247, 'time@10': 10.0005}:  70%|███████   | 7/10 [00:47<00:22,  7.55s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9666, 'compress@10': 0.5234, 'time@10': 9.7322}:  70%|███████   | 7/10 [00:55<00:22,  7.55s/it]  {'epoch': 47, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9666, 'compress@10': 0.5234, 'time@10': 9.7322}:  80%|████████  | 8/10 [00:55<00:15,  7.66s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9834, 'compress@10': 0.5224, 'time@10': 10.4668}:  80%|████████  | 8/10 [01:03<00:15,  7.66s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.9013, 'ndcg@10': 0.9834, 'compress@10': 0.5224, 'time@10': 10.4668}:  90%|█████████ | 9/10 [01:03<00:07,  7.83s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9828, 'compress@10': 0.5213, 'time@10': 10.4615}:  90%|█████████ | 9/10 [01:13<00:07,  7.83s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9828, 'compress@10': 0.5213, 'time@10': 10.4615}: 100%|██████████| 10/10 [01:13<00:00,  8.64s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0145, 'hit_ratio@10': 0.9089, 'ndcg@10': 0.9828, 'compress@10': 0.5213, 'time@10': 10.4615}: 100%|██████████| 10/10 [01:13<00:00,  7.38s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.014507829025324359
Avg hit ratio: 0.9089136796046813
Avg ndcg: 0.9828030186765938
Avg compression ratio: 0.5212748906271054
Avg train time: 10.461501812934875
Std train time: 5.439937135201936
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9292, 'compress@10': 0.5263, 'time@10': 8.5472}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9292, 'compress@10': 0.5263, 'time@10': 8.5472}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9485, 'compress@10': 0.5212, 'time@10': 7.7711}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0121, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9485, 'compress@10': 0.5212, 'time@10': 7.7711}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9159, 'compress@10': 0.538, 'time@10': 6.092}:  20%|██        | 2/10 [00:12<00:47,  5.91s/it]   {'epoch': 48, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9159, 'compress@10': 0.538, 'time@10': 6.092}:  30%|███       | 3/10 [00:12<00:26,  3.85s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.928, 'compress@10': 0.5329, 'time@10': 6.1775}:  30%|███       | 3/10 [00:19<00:26,  3.85s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.928, 'compress@10': 0.5329, 'time@10': 6.1775}:  40%|████      | 4/10 [00:19<00:29,  4.89s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9376, 'compress@10': 0.5283, 'time@10': 9.5623}:  40%|████      | 4/10 [00:30<00:29,  4.89s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9376, 'compress@10': 0.5283, 'time@10': 9.5623}:  50%|█████     | 5/10 [00:30<00:36,  7.30s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0082, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9439, 'compress@10': 0.5255, 'time@10': 9.7215}:  50%|█████     | 5/10 [00:41<00:36,  7.30s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0082, 'hit_ratio@10': 0.9015, 'ndcg@10': 0.9439, 'compress@10': 0.5255, 'time@10': 9.7215}:  60%|██████    | 6/10 [00:41<00:33,  8.41s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9459, 'compress@10': 0.5247, 'time@10': 9.9491}:  60%|██████    | 6/10 [00:47<00:33,  8.41s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0079, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9459, 'compress@10': 0.5247, 'time@10': 9.9491}:  70%|███████   | 7/10 [00:47<00:22,  7.52s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9484, 'compress@10': 0.5234, 'time@10': 9.666}:  70%|███████   | 7/10 [00:54<00:22,  7.52s/it]  {'epoch': 48, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9176, 'ndcg@10': 0.9484, 'compress@10': 0.5234, 'time@10': 9.666}:  80%|████████  | 8/10 [00:54<00:15,  7.59s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.95, 'compress@10': 0.5224, 'time@10': 10.3686}:  80%|████████  | 8/10 [01:02<00:15,  7.59s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.95, 'compress@10': 0.5224, 'time@10': 10.3686}:  90%|█████████ | 9/10 [01:02<00:07,  7.73s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9518, 'compress@10': 0.5213, 'time@10': 10.3213}:  90%|█████████ | 9/10 [01:12<00:07,  7.73s/it] {'epoch': 48, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9518, 'compress@10': 0.5213, 'time@10': 10.3213}: 100%|██████████| 10/10 [01:12<00:00,  8.41s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0108, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9518, 'compress@10': 0.5213, 'time@10': 10.3213}: 100%|██████████| 10/10 [01:12<00:00,  7.28s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.010787925234805523
Avg hit ratio: 0.9003422510332527
Avg ndcg: 0.9518361341214291
Avg compression ratio: 0.5212749006657823
Avg train time: 10.32132077217102
Std train time: 5.389938825741093
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9259, 'compress@10': 0.5263, 'time@10': 8.3543}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9259, 'compress@10': 0.5263, 'time@10': 8.3543}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9468, 'compress@10': 0.5212, 'time@10': 7.6715}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9468, 'compress@10': 0.5212, 'time@10': 7.6715}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9148, 'compress@10': 0.538, 'time@10': 6.024}:  20%|██        | 2/10 [00:12<00:46,  5.87s/it]  {'epoch': 49, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9148, 'compress@10': 0.538, 'time@10': 6.024}:  30%|███       | 3/10 [00:12<00:26,  3.83s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9271, 'compress@10': 0.5329, 'time@10': 6.0836}:  30%|███       | 3/10 [00:18<00:26,  3.83s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9271, 'compress@10': 0.5329, 'time@10': 6.0836}:  40%|████      | 4/10 [00:18<00:28,  4.80s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9377, 'compress@10': 0.5283, 'time@10': 9.4682}:  40%|████      | 4/10 [00:30<00:28,  4.80s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.9193, 'ndcg@10': 0.9377, 'compress@10': 0.5283, 'time@10': 9.4682}:  50%|█████     | 5/10 [00:30<00:36,  7.24s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9439, 'compress@10': 0.5255, 'time@10': 9.5999}:  50%|█████     | 5/10 [00:40<00:36,  7.24s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9439, 'compress@10': 0.5255, 'time@10': 9.5999}:  60%|██████    | 6/10 [00:40<00:33,  8.29s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.9303, 'ndcg@10': 0.9462, 'compress@10': 0.5247, 'time@10': 9.795}:  60%|██████    | 6/10 [00:46<00:33,  8.29s/it]  {'epoch': 49, 'num_users': 6.2857, 'loss': 0.008, 'hit_ratio@10': 0.9303, 'ndcg@10': 0.9462, 'compress@10': 0.5247, 'time@10': 9.795}:  70%|███████   | 7/10 [00:46<00:22,  7.38s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9354, 'ndcg@10': 0.948, 'compress@10': 0.5234, 'time@10': 9.5304}:  70%|███████   | 7/10 [00:54<00:22,  7.38s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0087, 'hit_ratio@10': 0.9354, 'ndcg@10': 0.948, 'compress@10': 0.5234, 'time@10': 9.5304}:  80%|████████  | 8/10 [00:54<00:14,  7.49s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.9204, 'ndcg@10': 0.9496, 'compress@10': 0.5224, 'time@10': 10.183}:  80%|████████  | 8/10 [01:01<00:14,  7.49s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.9204, 'ndcg@10': 0.9496, 'compress@10': 0.5224, 'time@10': 10.183}:  90%|█████████ | 9/10 [01:01<00:07,  7.57s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.9261, 'ndcg@10': 0.9523, 'compress@10': 0.5213, 'time@10': 10.1157}:  90%|█████████ | 9/10 [01:11<00:07,  7.57s/it]  {'epoch': 49, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.9261, 'ndcg@10': 0.9523, 'compress@10': 0.5213, 'time@10': 10.1157}: 100%|██████████| 10/10 [01:11<00:00,  8.18s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0088, 'hit_ratio@10': 0.9261, 'ndcg@10': 0.9523, 'compress@10': 0.5213, 'time@10': 10.1157}: 100%|██████████| 10/10 [01:11<00:00,  7.13s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.008788828187022299
Avg hit ratio: 0.9260565367475385
Avg ndcg: 0.9523353788067652
Avg compression ratio: 0.5212749006657823
Avg train time: 10.115717220306397
Std train time: 5.324271272813418
[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
