  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2357, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.4791, 'compress@10': 0.3368, 'time@10': 9.5708}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2357, 'hit_ratio@10': 0.3684, 'ndcg@10': 0.4791, 'compress@10': 0.3368, 'time@10': 9.5708}:  10%|█         | 1/10 [00:04<00:43,  4.83s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.164, 'hit_ratio@10': 0.5229, 'ndcg@10': 0.5615, 'compress@10': 0.3297, 'time@10': 8.2784}:  10%|█         | 1/10 [00:11<00:43,  4.83s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.164, 'hit_ratio@10': 0.5229, 'ndcg@10': 0.5615, 'compress@10': 0.3297, 'time@10': 8.2784}:  20%|██        | 2/10 [00:11<00:48,  6.12s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9346, 'hit_ratio@10': 0.4439, 'ndcg@10': 0.3744, 'compress@10': 0.3531, 'time@10': 6.4463}:  20%|██        | 2/10 [00:13<00:48,  6.12s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.9346, 'hit_ratio@10': 0.4439, 'ndcg@10': 0.3744, 'compress@10': 0.3531, 'time@10': 6.4463}:  30%|███       | 3/10 [00:13<00:27,  3.98s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7363, 'hit_ratio@10': 0.5025, 'ndcg@10': 0.4184, 'compress@10': 0.3461, 'time@10': 6.4138}:  30%|███       | 3/10 [00:19<00:27,  3.98s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7363, 'hit_ratio@10': 0.5025, 'ndcg@10': 0.4184, 'compress@10': 0.3461, 'time@10': 6.4138}:  40%|████      | 4/10 [00:19<00:29,  4.92s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.6084, 'hit_ratio@10': 0.566, 'ndcg@10': 0.4818, 'compress@10': 0.3397, 'time@10': 9.6662}:  40%|████      | 4/10 [00:31<00:29,  4.92s/it] {'epoch': 0, 'num_users': 5.8, 'loss': 0.6084, 'hit_ratio@10': 0.566, 'ndcg@10': 0.4818, 'compress@10': 0.3397, 'time@10': 9.6662}:  50%|█████     | 5/10 [00:31<00:36,  7.25s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5223, 'hit_ratio@10': 0.5902, 'ndcg@10': 0.5277, 'compress@10': 0.3357, 'time@10': 9.775}:  50%|█████     | 5/10 [00:41<00:36,  7.25s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.5223, 'hit_ratio@10': 0.5902, 'ndcg@10': 0.5277, 'compress@10': 0.3357, 'time@10': 9.775}:  60%|██████    | 6/10 [00:41<00:33,  8.31s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4695, 'hit_ratio@10': 0.5973, 'ndcg@10': 0.5272, 'compress@10': 0.3346, 'time@10': 9.9735}:  60%|██████    | 6/10 [00:47<00:33,  8.31s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4695, 'hit_ratio@10': 0.5973, 'ndcg@10': 0.5272, 'compress@10': 0.3346, 'time@10': 9.9735}:  70%|███████   | 7/10 [00:47<00:22,  7.43s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.4183, 'hit_ratio@10': 0.6334, 'ndcg@10': 0.5562, 'compress@10': 0.3328, 'time@10': 9.6824}:  70%|███████   | 7/10 [00:54<00:22,  7.43s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.4183, 'hit_ratio@10': 0.6334, 'ndcg@10': 0.5562, 'compress@10': 0.3328, 'time@10': 9.6824}:  80%|████████  | 8/10 [00:54<00:15,  7.51s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3799, 'hit_ratio@10': 0.6424, 'ndcg@10': 0.5931, 'compress@10': 0.3313, 'time@10': 10.3816}:  80%|████████  | 8/10 [01:02<00:15,  7.51s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3799, 'hit_ratio@10': 0.6424, 'ndcg@10': 0.5931, 'compress@10': 0.3313, 'time@10': 10.3816}:  90%|█████████ | 9/10 [01:02<00:07,  7.67s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3476, 'hit_ratio@10': 0.6713, 'ndcg@10': 0.6151, 'compress@10': 0.3298, 'time@10': 10.3594}:  90%|█████████ | 9/10 [01:12<00:07,  7.67s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3476, 'hit_ratio@10': 0.6713, 'ndcg@10': 0.6151, 'compress@10': 0.3298, 'time@10': 10.3594}: 100%|██████████| 10/10 [01:12<00:00,  8.45s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3476, 'hit_ratio@10': 0.6713, 'ndcg@10': 0.6151, 'compress@10': 0.3298, 'time@10': 10.3594}: 100%|██████████| 10/10 [01:12<00:00,  7.29s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3475892908382495
Avg hit ratio: 0.6713055414685296
Avg ndcg: 0.6151069040302872
Avg compression ratio: 0.32979348549250737
Avg train time: 10.35936279296875
Std train time: 5.263531265189962
[0.6499999999999999, 0.15, 0.6499999999999999, 0.6499999999999999, 0.6499999999999999, 0.15, 0.6499999999999999, 0.15, 0.15, 0.15]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.058, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8336, 'compress@10': 0.6684, 'time@10': 7.9185}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.058, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8336, 'compress@10': 0.6684, 'time@10': 7.9185}:  10%|█         | 1/10 [00:03<00:35,  3.99s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.056, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.846, 'compress@10': 0.4229, 'time@10': 7.5601}:  10%|█         | 1/10 [00:11<00:35,  3.99s/it] {'epoch': 1, 'num_users': 7.0, 'loss': 0.056, 'hit_ratio@10': 0.7716, 'ndcg@10': 0.846, 'compress@10': 0.4229, 'time@10': 7.5601}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0496, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.8041, 'compress@10': 0.5153, 'time@10': 5.9812}:  20%|██        | 2/10 [00:12<00:47,  5.90s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0496, 'hit_ratio@10': 0.7525, 'ndcg@10': 0.8041, 'compress@10': 0.5153, 'time@10': 5.9812}:  30%|███       | 3/10 [00:12<00:27,  3.87s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0501, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8141, 'compress@10': 0.5521, 'time@10': 5.9939}:  30%|███       | 3/10 [00:18<00:27,  3.87s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0501, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8141, 'compress@10': 0.5521, 'time@10': 5.9939}:  40%|████      | 4/10 [00:18<00:28,  4.74s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0577, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8091, 'compress@10': 0.5731, 'time@10': 8.8964}:  40%|████      | 4/10 [00:29<00:28,  4.74s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0577, 'hit_ratio@10': 0.7941, 'ndcg@10': 0.8091, 'compress@10': 0.5731, 'time@10': 8.8964}:  50%|█████     | 5/10 [00:29<00:33,  6.77s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.061, 'hit_ratio@10': 0.784, 'ndcg@10': 0.8096, 'compress@10': 0.5057, 'time@10': 9.0423}:  50%|█████     | 5/10 [00:38<00:33,  6.77s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.061, 'hit_ratio@10': 0.784, 'ndcg@10': 0.8096, 'compress@10': 0.5057, 'time@10': 9.0423}:  60%|██████    | 6/10 [00:38<00:31,  7.80s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0588, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8181, 'compress@10': 0.5283, 'time@10': 9.2551}:  60%|██████    | 6/10 [00:44<00:31,  7.80s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0588, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8181, 'compress@10': 0.5283, 'time@10': 9.2551}:  70%|███████   | 7/10 [00:44<00:20,  6.99s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0561, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8251, 'compress@10': 0.4841, 'time@10': 9.0436}:  70%|███████   | 7/10 [00:51<00:20,  6.99s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0561, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8251, 'compress@10': 0.4841, 'time@10': 9.0436}:  80%|████████  | 8/10 [00:51<00:14,  7.18s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0539, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8352, 'compress@10': 0.4496, 'time@10': 9.6202}:  80%|████████  | 8/10 [00:58<00:14,  7.18s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0539, 'hit_ratio@10': 0.8103, 'ndcg@10': 0.8352, 'compress@10': 0.4496, 'time@10': 9.6202}:  90%|█████████ | 9/10 [00:58<00:07,  7.17s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0532, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8364, 'compress@10': 0.4216, 'time@10': 9.6663}:  90%|█████████ | 9/10 [01:09<00:07,  7.17s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0532, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8364, 'compress@10': 0.4216, 'time@10': 9.6663}: 100%|██████████| 10/10 [01:09<00:00,  8.08s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0532, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.8364, 'compress@10': 0.4216, 'time@10': 9.6663}: 100%|██████████| 10/10 [01:09<00:00,  6.91s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.05317079084578482
Avg hit ratio: 0.8224159519032185
Avg ndcg: 0.8363631796196229
Avg compression ratio: 0.4216126227631266
Avg train time: 9.666299486160279
Std train time: 4.613959306397525
[0.7666666666666666, 0.43333333333333335, 0.43333333333333324, 0.7666666666666666, 0.7666666666666666, 0.43333333333333335, 0.43333333333333324, 0.1, 0.1, 0.1]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.7789, 'time@10': 7.9321}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8448, 'compress@10': 0.7789, 'time@10': 7.9321}:  10%|█         | 1/10 [00:04<00:36,  4.00s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8482, 'compress@10': 0.6153, 'time@10': 7.4916}:  10%|█         | 1/10 [00:11<00:36,  4.00s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0507, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8482, 'compress@10': 0.6153, 'time@10': 7.4916}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.849, 'compress@10': 0.5816, 'time@10': 6.1097}:  20%|██        | 2/10 [00:12<00:46,  5.83s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.849, 'compress@10': 0.5816, 'time@10': 6.1097}:  30%|███       | 3/10 [00:12<00:27,  3.95s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0392, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8475, 'compress@10': 0.63, 'time@10': 6.0344}:  30%|███       | 3/10 [00:18<00:27,  3.95s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.0392, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8475, 'compress@10': 0.63, 'time@10': 6.0344}:  40%|████      | 4/10 [00:18<00:28,  4.70s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0485, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8366, 'compress@10': 0.6582, 'time@10': 8.4031}:  40%|████      | 4/10 [00:27<00:28,  4.70s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0485, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8366, 'compress@10': 0.6582, 'time@10': 8.4031}:  50%|█████     | 5/10 [00:27<00:31,  6.24s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0529, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8331, 'compress@10': 0.6228, 'time@10': 8.7587}:  50%|█████     | 5/10 [00:38<00:31,  6.24s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0529, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8331, 'compress@10': 0.6228, 'time@10': 8.7587}:  60%|██████    | 6/10 [00:38<00:30,  7.71s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0513, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8359, 'compress@10': 0.599, 'time@10': 9.1127}:  60%|██████    | 6/10 [00:43<00:30,  7.71s/it] {'epoch': 2, 'num_users': 6.2857, 'loss': 0.0513, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8359, 'compress@10': 0.599, 'time@10': 9.1127}:  70%|███████   | 7/10 [00:43<00:21,  7.04s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8421, 'compress@10': 0.5398, 'time@10': 8.8918}:  70%|███████   | 7/10 [00:51<00:21,  7.04s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0499, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.8421, 'compress@10': 0.5398, 'time@10': 8.8918}:  80%|████████  | 8/10 [00:51<00:14,  7.15s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0482, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8504, 'compress@10': 0.4938, 'time@10': 9.4486}:  80%|████████  | 8/10 [00:58<00:14,  7.15s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0482, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8504, 'compress@10': 0.4938, 'time@10': 9.4486}:  90%|█████████ | 9/10 [00:58<00:07,  7.10s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0479, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8503, 'compress@10': 0.4565, 'time@10': 9.5035}:  90%|█████████ | 9/10 [01:08<00:07,  7.10s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0479, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8503, 'compress@10': 0.4565, 'time@10': 9.5035}: 100%|██████████| 10/10 [01:08<00:00,  8.00s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0479, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.8503, 'compress@10': 0.4565, 'time@10': 9.5035}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.0478561951537803
Avg hit ratio: 0.8325362526550982
Avg ndcg: 0.8503008283321627
Avg compression ratio: 0.45649845153022844
Avg train time: 9.503499031066895
Std train time: 3.9813744311196007
[0.825, 0.575, 0.32499999999999996, 0.825, 0.825, 0.575, 0.32499999999999996, 0.07500000000000001, 0.07500000000000001, 0.07500000000000001]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.8342, 'time@10': 7.6658}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.8342, 'time@10': 7.6658}:  10%|█         | 1/10 [00:03<00:34,  3.87s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.798, 'ndcg@10': 0.849, 'compress@10': 0.7115, 'time@10': 7.2947}:  10%|█         | 1/10 [00:10<00:34,  3.87s/it]  {'epoch': 3, 'num_users': 7.0, 'loss': 0.0494, 'hit_ratio@10': 0.798, 'ndcg@10': 0.849, 'compress@10': 0.7115, 'time@10': 7.2947}:  20%|██        | 2/10 [00:10<00:45,  5.69s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8517, 'compress@10': 0.6148, 'time@10': 6.0728}:  20%|██        | 2/10 [00:12<00:45,  5.69s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8517, 'compress@10': 0.6148, 'time@10': 6.0728}:  30%|███       | 3/10 [00:12<00:27,  3.93s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0374, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8503, 'compress@10': 0.6689, 'time@10': 6.0235}:  30%|███       | 3/10 [00:18<00:27,  3.93s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0374, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8503, 'compress@10': 0.6689, 'time@10': 6.0235}:  40%|████      | 4/10 [00:18<00:28,  4.71s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8379, 'compress@10': 0.7008, 'time@10': 7.9701}:  40%|████      | 4/10 [00:26<00:28,  4.71s/it]   {'epoch': 3, 'num_users': 5.8, 'loss': 0.047, 'hit_ratio@10': 0.78, 'ndcg@10': 0.8379, 'compress@10': 0.7008, 'time@10': 7.9701}:  50%|█████     | 5/10 [00:26<00:29,  5.87s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.051, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8349, 'compress@10': 0.6814, 'time@10': 8.3974}:  50%|█████     | 5/10 [00:37<00:29,  5.87s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.051, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8349, 'compress@10': 0.6814, 'time@10': 8.3974}:  60%|██████    | 6/10 [00:37<00:29,  7.47s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0503, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8346, 'compress@10': 0.6344, 'time@10': 8.7812}:  60%|██████    | 6/10 [00:42<00:29,  7.47s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0503, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8346, 'compress@10': 0.6344, 'time@10': 8.7812}:  70%|███████   | 7/10 [00:42<00:20,  6.85s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8388, 'compress@10': 0.5677, 'time@10': 8.5729}:  70%|███████   | 7/10 [00:49<00:20,  6.85s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8388, 'compress@10': 0.5677, 'time@10': 8.5729}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8464, 'compress@10': 0.5159, 'time@10': 9.129}:  80%|████████  | 8/10 [00:56<00:13,  6.94s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0495, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.8464, 'compress@10': 0.5159, 'time@10': 9.129}:  90%|█████████ | 9/10 [00:56<00:06,  6.91s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8463, 'compress@10': 0.4739, 'time@10': 9.1859}:  90%|█████████ | 9/10 [01:06<00:06,  6.91s/it]  {'epoch': 3, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8463, 'compress@10': 0.4739, 'time@10': 9.1859}: 100%|██████████| 10/10 [01:06<00:00,  7.78s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8205, 'ndcg@10': 0.8463, 'compress@10': 0.4739, 'time@10': 9.1859}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.04939997466601079
Avg hit ratio: 0.820472760591606
Avg ndcg: 0.8463245079755332
Avg compression ratio: 0.47394108699117465
Avg train time: 9.185866856575013
Std train time: 3.488602762253754
[0.6599999999999999, 0.6599999999999999, 0.25999999999999995, 0.86, 0.86, 0.6599999999999999, 0.25999999999999995, 0.26, 0.06000000000000001, 0.06000000000000001]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8524, 'compress@10': 0.6779, 'time@10': 8.486}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8524, 'compress@10': 0.6779, 'time@10': 8.486}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.852, 'compress@10': 0.6744, 'time@10': 7.7429}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.852, 'compress@10': 0.6744, 'time@10': 7.7429}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8537, 'compress@10': 0.5715, 'time@10': 6.4756}:  20%|██        | 2/10 [00:13<00:47,  5.90s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0324, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8537, 'compress@10': 0.5715, 'time@10': 6.4756}:  30%|███       | 3/10 [00:13<00:28,  4.12s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0361, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8516, 'compress@10': 0.6449, 'time@10': 6.3066}:  30%|███       | 3/10 [00:19<00:28,  4.12s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0361, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8516, 'compress@10': 0.6449, 'time@10': 6.3066}:  40%|████      | 4/10 [00:19<00:28,  4.80s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.839, 'compress@10': 0.6885, 'time@10': 7.6252}:  40%|████      | 4/10 [00:25<00:28,  4.80s/it] {'epoch': 4, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.839, 'compress@10': 0.6885, 'time@10': 7.6252}:  50%|█████     | 5/10 [00:25<00:27,  5.41s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0495, 'hit_ratio@10': 0.7924, 'ndcg@10': 0.8376, 'compress@10': 0.685, 'time@10': 8.0939}:  50%|█████     | 5/10 [00:36<00:27,  5.41s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0495, 'hit_ratio@10': 0.7924, 'ndcg@10': 0.8376, 'compress@10': 0.685, 'time@10': 8.0939}:  60%|██████    | 6/10 [00:36<00:28,  7.13s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0494, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8376, 'compress@10': 0.6285, 'time@10': 8.5059}:  60%|██████    | 6/10 [00:41<00:28,  7.13s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0494, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.8376, 'compress@10': 0.6285, 'time@10': 8.5059}:  70%|███████   | 7/10 [00:41<00:19,  6.61s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8472, 'compress@10': 0.5851, 'time@10': 8.3835}:  70%|███████   | 7/10 [00:49<00:19,  6.61s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0506, 'hit_ratio@10': 0.8286, 'ndcg@10': 0.8472, 'compress@10': 0.5851, 'time@10': 8.3835}:  80%|████████  | 8/10 [00:49<00:13,  6.91s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8557, 'compress@10': 0.5297, 'time@10': 8.9416}:  80%|████████  | 8/10 [00:55<00:13,  6.91s/it] {'epoch': 4, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8223, 'ndcg@10': 0.8557, 'compress@10': 0.5297, 'time@10': 8.9416}:  90%|█████████ | 9/10 [00:55<00:06,  6.86s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8554, 'compress@10': 0.4849, 'time@10': 9.0216}:  90%|█████████ | 9/10 [01:05<00:06,  6.86s/it] {'epoch': 4, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8554, 'compress@10': 0.4849, 'time@10': 9.0216}: 100%|██████████| 10/10 [01:05<00:00,  7.76s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0493, 'hit_ratio@10': 0.8332, 'ndcg@10': 0.8554, 'compress@10': 0.4849, 'time@10': 9.0216}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.049312710546529165
Avg hit ratio: 0.8332223765670286
Avg ndcg: 0.8553755843034192
Avg compression ratio: 0.48488744823293783
Avg train time: 9.021573543548584
Std train time: 2.8882102749304095
[0.5499999999999999, 0.7166666666666666, 0.21666666666666662, 0.7166666666666667, 0.8833333333333333, 0.7166666666666666, 0.3833333333333333, 0.38333333333333336, 0.05000000000000001, 0.05000000000000001]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.5737, 'time@10': 8.2557}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.5737, 'time@10': 8.2557}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8588, 'compress@10': 0.6497, 'time@10': 7.5457}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8588, 'compress@10': 0.6497, 'time@10': 7.5457}:  20%|██        | 2/10 [00:11<00:46,  5.76s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8583, 'compress@10': 0.5427, 'time@10': 6.4146}:  20%|██        | 2/10 [00:13<00:46,  5.76s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0322, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8583, 'compress@10': 0.5427, 'time@10': 6.4146}:  30%|███       | 3/10 [00:13<00:28,  4.09s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0362, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8555, 'compress@10': 0.5887, 'time@10': 6.3123}:  30%|███       | 3/10 [00:19<00:28,  4.09s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0362, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8555, 'compress@10': 0.5887, 'time@10': 6.3123}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0455, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8419, 'compress@10': 0.6481, 'time@10': 7.6472}:  40%|████      | 4/10 [00:25<00:29,  4.86s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0455, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8419, 'compress@10': 0.6481, 'time@10': 7.6472}:  50%|█████     | 5/10 [00:25<00:27,  5.46s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.84, 'compress@10': 0.6606, 'time@10': 8.095}:  50%|█████     | 5/10 [00:36<00:27,  5.46s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.8081, 'ndcg@10': 0.84, 'compress@10': 0.6606, 'time@10': 8.095}:  60%|██████    | 6/10 [00:36<00:28,  7.13s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0479, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8399, 'compress@10': 0.6245, 'time@10': 8.5356}:  60%|██████    | 6/10 [00:41<00:28,  7.13s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0479, 'hit_ratio@10': 0.8298, 'ndcg@10': 0.8399, 'compress@10': 0.6245, 'time@10': 8.5356}:  70%|███████   | 7/10 [00:41<00:19,  6.65s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0487, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8501, 'compress@10': 0.5965, 'time@10': 8.452}:  70%|███████   | 7/10 [00:49<00:19,  6.65s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.0487, 'hit_ratio@10': 0.8403, 'ndcg@10': 0.8501, 'compress@10': 0.5965, 'time@10': 8.452}:  80%|████████  | 8/10 [00:49<00:14,  7.05s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0476, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8564, 'compress@10': 0.5388, 'time@10': 8.9582}:  80%|████████  | 8/10 [00:56<00:14,  7.05s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0476, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.8564, 'compress@10': 0.5388, 'time@10': 8.9582}:  90%|█████████ | 9/10 [00:56<00:06,  6.89s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0474, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8554, 'compress@10': 0.4921, 'time@10': 9.0144}:  90%|█████████ | 9/10 [01:05<00:06,  6.89s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0474, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8554, 'compress@10': 0.4921, 'time@10': 9.0144}: 100%|██████████| 10/10 [01:05<00:00,  7.71s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0474, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.8554, 'compress@10': 0.4921, 'time@10': 9.0144}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04736334768778794
Avg hit ratio: 0.8368731702178221
Avg ndcg: 0.8554405606982927
Avg compression ratio: 0.49211523038875427
Avg train time: 9.014447474479676
Std train time: 2.788167563966462
[0.47142857142857136, 0.757142857142857, 0.18571428571428567, 0.7571428571428571, 0.9, 0.757142857142857, 0.32857142857142857, 0.4714285714285715, 0.042857142857142864, 0.042857142857142864]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8584, 'compress@10': 0.4992, 'time@10': 8.3452}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8584, 'compress@10': 0.4992, 'time@10': 8.3452}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8618, 'compress@10': 0.6321, 'time@10': 7.5084}:  10%|█         | 1/10 [00:10<00:37,  4.21s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8618, 'compress@10': 0.6321, 'time@10': 7.5084}:  20%|██        | 2/10 [00:10<00:45,  5.68s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8603, 'compress@10': 0.5221, 'time@10': 6.3859}:  20%|██        | 2/10 [00:13<00:45,  5.68s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8603, 'compress@10': 0.5221, 'time@10': 6.3859}:  30%|███       | 3/10 [00:13<00:28,  4.05s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8565, 'compress@10': 0.583, 'time@10': 6.2525}:  30%|███       | 3/10 [00:18<00:28,  4.05s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8565, 'compress@10': 0.583, 'time@10': 6.2525}:  40%|████      | 4/10 [00:18<00:28,  4.77s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0446, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.843, 'compress@10': 0.6468, 'time@10': 7.494}:  40%|████      | 4/10 [00:25<00:28,  4.77s/it] {'epoch': 6, 'num_users': 5.8, 'loss': 0.0446, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.843, 'compress@10': 0.6468, 'time@10': 7.494}:  50%|█████     | 5/10 [00:25<00:26,  5.31s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.047, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8419, 'compress@10': 0.6661, 'time@10': 7.929}:  50%|█████     | 5/10 [00:35<00:26,  5.31s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.047, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8419, 'compress@10': 0.6661, 'time@10': 7.929}:  60%|██████    | 6/10 [00:35<00:27,  6.96s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0463, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8431, 'compress@10': 0.6217, 'time@10': 8.3413}:  60%|██████    | 6/10 [00:40<00:27,  6.96s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0463, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.8431, 'compress@10': 0.6217, 'time@10': 8.3413}:  70%|███████   | 7/10 [00:40<00:19,  6.46s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0463, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8502, 'compress@10': 0.6048, 'time@10': 8.2769}:  70%|███████   | 7/10 [00:48<00:19,  6.46s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0463, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.8502, 'compress@10': 0.6048, 'time@10': 8.2769}:  80%|████████  | 8/10 [00:48<00:13,  6.91s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0454, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8598, 'compress@10': 0.5454, 'time@10': 8.7913}:  80%|████████  | 8/10 [00:55<00:13,  6.91s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0454, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.8598, 'compress@10': 0.5454, 'time@10': 8.7913}:  90%|█████████ | 9/10 [00:55<00:06,  6.78s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0447, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8593, 'compress@10': 0.4973, 'time@10': 8.8406}:  90%|█████████ | 9/10 [01:04<00:06,  6.78s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0447, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8593, 'compress@10': 0.4973, 'time@10': 8.8406}: 100%|██████████| 10/10 [01:04<00:00,  7.56s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0447, 'hit_ratio@10': 0.8562, 'ndcg@10': 0.8593, 'compress@10': 0.4973, 'time@10': 8.8406}: 100%|██████████| 10/10 [01:04<00:00,  6.44s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04473780750658253
Avg hit ratio: 0.8561588845035365
Avg ndcg: 0.8592914770500031
Avg compression ratio: 0.49733546918625143
Avg train time: 8.840573501586913
Std train time: 2.6891745282936776
[0.4124999999999999, 0.7874999999999999, 0.16249999999999995, 0.7875, 0.9125, 0.7874999999999999, 0.2875, 0.5375000000000001, 0.037500000000000006, 0.037500000000000006]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.4434, 'time@10': 8.3728}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 0.4434, 'time@10': 8.3728}:  10%|█         | 1/10 [00:04<00:38,  4.22s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8583, 'compress@10': 0.6189, 'time@10': 7.5101}:  10%|█         | 1/10 [00:10<00:38,  4.22s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0449, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8583, 'compress@10': 0.6189, 'time@10': 7.5101}:  20%|██        | 2/10 [00:10<00:45,  5.67s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8579, 'compress@10': 0.5066, 'time@10': 6.4753}:  20%|██        | 2/10 [00:13<00:45,  5.67s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0301, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8579, 'compress@10': 0.5066, 'time@10': 6.4753}:  30%|███       | 3/10 [00:13<00:28,  4.10s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.86, 'compress@10': 0.5787, 'time@10': 6.3186}:  30%|███       | 3/10 [00:19<00:28,  4.10s/it]  {'epoch': 7, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.86, 'compress@10': 0.5787, 'time@10': 6.3186}:  40%|████      | 4/10 [00:19<00:28,  4.81s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0446, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8459, 'compress@10': 0.6458, 'time@10': 7.55}:  40%|████      | 4/10 [00:25<00:28,  4.81s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0446, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8459, 'compress@10': 0.6458, 'time@10': 7.55}:  50%|█████     | 5/10 [00:25<00:26,  5.34s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0462, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.8457, 'compress@10': 0.6702, 'time@10': 7.9491}:  50%|█████     | 5/10 [00:35<00:26,  5.34s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0462, 'hit_ratio@10': 0.8409, 'ndcg@10': 0.8457, 'compress@10': 0.6702, 'time@10': 7.9491}:  60%|██████    | 6/10 [00:35<00:27,  6.92s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0452, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8469, 'compress@10': 0.6196, 'time@10': 8.3484}:  60%|██████    | 6/10 [00:40<00:27,  6.92s/it] {'epoch': 7, 'num_users': 6.2857, 'loss': 0.0452, 'hit_ratio@10': 0.858, 'ndcg@10': 0.8469, 'compress@10': 0.6196, 'time@10': 8.3484}:  70%|███████   | 7/10 [00:40<00:19,  6.42s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0449, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8543, 'compress@10': 0.611, 'time@10': 8.2761}:  70%|███████   | 7/10 [00:48<00:19,  6.42s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0449, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.8543, 'compress@10': 0.611, 'time@10': 8.2761}:  80%|████████  | 8/10 [00:48<00:13,  6.86s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0451, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8632, 'compress@10': 0.5504, 'time@10': 8.823}:  80%|████████  | 8/10 [00:55<00:13,  6.86s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0451, 'hit_ratio@10': 0.8578, 'ndcg@10': 0.8632, 'compress@10': 0.5504, 'time@10': 8.823}:  90%|█████████ | 9/10 [00:55<00:06,  6.79s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0445, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8635, 'compress@10': 0.5013, 'time@10': 8.8729}:  90%|█████████ | 9/10 [01:04<00:06,  6.79s/it]  {'epoch': 7, 'num_users': 6.3, 'loss': 0.0445, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8635, 'compress@10': 0.5013, 'time@10': 8.8729}: 100%|██████████| 10/10 [01:04<00:00,  7.58s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0445, 'hit_ratio@10': 0.8675, 'ndcg@10': 0.8635, 'compress@10': 0.5013, 'time@10': 8.8729}: 100%|██████████| 10/10 [01:04<00:00,  6.45s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04447207624154871
Avg hit ratio: 0.8674510690215274
Avg ndcg: 0.8635291791296483
Avg compression ratio: 0.5012557527049114
Avg train time: 8.872912073135376
Std train time: 2.684511992412185
[0.47777777777777775, 0.6999999999999998, 0.1444444444444444, 0.8111111111111111, 0.9222222222222222, 0.811111111111111, 0.25555555555555554, 0.47777777777777786, 0.14444444444444446, 0.03333333333333334]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8545, 'compress@10': 0.5053, 'time@10': 8.2949}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8545, 'compress@10': 0.5053, 'time@10': 8.2949}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0437, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8592, 'compress@10': 0.6075, 'time@10': 7.4945}:  10%|█         | 1/10 [00:10<00:37,  4.18s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0437, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8592, 'compress@10': 0.6075, 'time@10': 7.4945}:  20%|██        | 2/10 [00:10<00:45,  5.68s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8585, 'compress@10': 0.4939, 'time@10': 6.5581}:  20%|██        | 2/10 [00:13<00:45,  5.68s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0292, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8585, 'compress@10': 0.4939, 'time@10': 6.5581}:  30%|███       | 3/10 [00:13<00:29,  4.17s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8626, 'compress@10': 0.5749, 'time@10': 6.3688}:  30%|███       | 3/10 [00:19<00:29,  4.17s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.8626, 'compress@10': 0.5749, 'time@10': 6.3688}:  40%|████      | 4/10 [00:19<00:28,  4.83s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0432, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8475, 'compress@10': 0.6446, 'time@10': 7.5559}:  40%|████      | 4/10 [00:25<00:28,  4.83s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0432, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.8475, 'compress@10': 0.6446, 'time@10': 7.5559}:  50%|█████     | 5/10 [00:25<00:26,  5.32s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0444, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8487, 'compress@10': 0.6731, 'time@10': 7.9847}:  50%|█████     | 5/10 [00:35<00:26,  5.32s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0444, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8487, 'compress@10': 0.6731, 'time@10': 7.9847}:  60%|██████    | 6/10 [00:35<00:27,  6.97s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0438, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8509, 'compress@10': 0.6177, 'time@10': 8.3696}:  60%|██████    | 6/10 [00:40<00:27,  6.97s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0438, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.8509, 'compress@10': 0.6177, 'time@10': 8.3696}:  70%|███████   | 7/10 [00:40<00:19,  6.45s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0435, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8581, 'compress@10': 0.6021, 'time@10': 8.297}:  70%|███████   | 7/10 [00:48<00:19,  6.45s/it]  {'epoch': 8, 'num_users': 6.125, 'loss': 0.0435, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.8581, 'compress@10': 0.6021, 'time@10': 8.297}:  80%|████████  | 8/10 [00:48<00:13,  6.89s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0443, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8679, 'compress@10': 0.5539, 'time@10': 8.9275}:  80%|████████  | 8/10 [00:55<00:13,  6.89s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0443, 'hit_ratio@10': 0.871, 'ndcg@10': 0.8679, 'compress@10': 0.5539, 'time@10': 8.9275}:  90%|█████████ | 9/10 [00:55<00:06,  6.93s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0432, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.8684, 'compress@10': 0.5041, 'time@10': 8.987}:  90%|█████████ | 9/10 [01:05<00:06,  6.93s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0432, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.8684, 'compress@10': 0.5041, 'time@10': 8.987}: 100%|██████████| 10/10 [01:05<00:00,  7.74s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0432, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.8684, 'compress@10': 0.5041, 'time@10': 8.987}: 100%|██████████| 10/10 [01:05<00:00,  6.53s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.043181680332562825
Avg hit ratio: 0.8793681197127716
Avg ndcg: 0.8684325638564255
Avg compression ratio: 0.5040759543231867
Avg train time: 8.987004017829895
Std train time: 2.7591709635924557
[0.53, 0.6299999999999999, 0.12999999999999995, 0.83, 0.9299999999999999, 0.8299999999999998, 0.22999999999999998, 0.43000000000000005, 0.23, 0.030000000000000006]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.5547, 'time@10': 8.4104}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0435, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.5547, 'time@10': 8.4104}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0415, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8649, 'compress@10': 0.5983, 'time@10': 7.633}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it] {'epoch': 9, 'num_users': 7.0, 'loss': 0.0415, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8649, 'compress@10': 0.5983, 'time@10': 7.633}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8623, 'compress@10': 0.4837, 'time@10': 6.8064}:  20%|██        | 2/10 [00:13<00:46,  5.80s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8623, 'compress@10': 0.4837, 'time@10': 6.8064}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8649, 'compress@10': 0.5718, 'time@10': 6.4055}:  30%|███       | 3/10 [00:18<00:30,  4.35s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8649, 'compress@10': 0.5718, 'time@10': 6.4055}:  40%|████      | 4/10 [00:18<00:28,  4.70s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0401, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8501, 'compress@10': 0.6437, 'time@10': 7.5735}:  40%|████      | 4/10 [00:25<00:28,  4.70s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0401, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8501, 'compress@10': 0.6437, 'time@10': 7.5735}:  50%|█████     | 5/10 [00:25<00:26,  5.23s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0412, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8511, 'compress@10': 0.6754, 'time@10': 7.9393}:  50%|█████     | 5/10 [00:34<00:26,  5.23s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0412, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8511, 'compress@10': 0.6754, 'time@10': 7.9393}:  60%|██████    | 6/10 [00:34<00:27,  6.78s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0405, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8521, 'compress@10': 0.6161, 'time@10': 8.4035}:  60%|██████    | 6/10 [00:40<00:27,  6.78s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0405, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8521, 'compress@10': 0.6161, 'time@10': 8.4035}:  70%|███████   | 7/10 [00:40<00:19,  6.41s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0406, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8602, 'compress@10': 0.5949, 'time@10': 8.316}:  70%|███████   | 7/10 [00:48<00:19,  6.41s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0406, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8602, 'compress@10': 0.5949, 'time@10': 8.316}:  80%|████████  | 8/10 [00:48<00:13,  6.83s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0401, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8662, 'compress@10': 0.5568, 'time@10': 8.9286}:  80%|████████  | 8/10 [00:55<00:13,  6.83s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0401, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8662, 'compress@10': 0.5568, 'time@10': 8.9286}:  90%|█████████ | 9/10 [00:55<00:06,  6.87s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0398, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8684, 'compress@10': 0.5063, 'time@10': 8.9866}:  90%|█████████ | 9/10 [01:04<00:06,  6.87s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0398, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8684, 'compress@10': 0.5063, 'time@10': 8.9866}: 100%|██████████| 10/10 [01:04<00:00,  7.70s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0398, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8684, 'compress@10': 0.5063, 'time@10': 8.9866}: 100%|██████████| 10/10 [01:04<00:00,  6.48s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.039805142209940504
Avg hit ratio: 0.8664474847921367
Avg ndcg: 0.8683793445537974
Avg compression ratio: 0.5063316878622692
Avg train time: 8.986566281318664
Std train time: 2.7447203668063365
[0.5727272727272728, 0.5727272727272726, 0.11818181818181814, 0.8454545454545455, 0.9363636363636363, 0.8454545454545453, 0.20909090909090908, 0.48181818181818187, 0.2090909090909091, 0.02727272727272728]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0452, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8474, 'compress@10': 0.5952, 'time@10': 8.3123}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0452, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8474, 'compress@10': 0.5952, 'time@10': 8.3123}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8638, 'compress@10': 0.5909, 'time@10': 7.6381}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0405, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8638, 'compress@10': 0.5909, 'time@10': 7.6381}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.027, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8616, 'compress@10': 0.4753, 'time@10': 6.8679}:  20%|██        | 2/10 [00:13<00:46,  5.85s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.027, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8616, 'compress@10': 0.4753, 'time@10': 6.8679}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8647, 'compress@10': 0.5692, 'time@10': 6.4368}:  30%|███       | 3/10 [00:19<00:30,  4.41s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0304, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8647, 'compress@10': 0.5692, 'time@10': 6.4368}:  40%|████      | 4/10 [00:19<00:28,  4.72s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0383, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8511, 'compress@10': 0.6429, 'time@10': 7.5306}:  40%|████      | 4/10 [00:25<00:28,  4.72s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0383, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8511, 'compress@10': 0.6429, 'time@10': 7.5306}:  50%|█████     | 5/10 [00:25<00:25,  5.17s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0392, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.853, 'compress@10': 0.6772, 'time@10': 7.8443}:  50%|█████     | 5/10 [00:34<00:25,  5.17s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0392, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.853, 'compress@10': 0.6772, 'time@10': 7.8443}:  60%|██████    | 6/10 [00:34<00:26,  6.63s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0397, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8585, 'compress@10': 0.6149, 'time@10': 8.3156}:  60%|██████    | 6/10 [00:40<00:26,  6.63s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0397, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.8585, 'compress@10': 0.6149, 'time@10': 8.3156}:  70%|███████   | 7/10 [00:40<00:18,  6.29s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0397, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.865, 'compress@10': 0.6001, 'time@10': 8.2312}:  70%|███████   | 7/10 [00:47<00:18,  6.29s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.0397, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.865, 'compress@10': 0.6001, 'time@10': 8.2312}:  80%|████████  | 8/10 [00:47<00:13,  6.73s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.038, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8714, 'compress@10': 0.5592, 'time@10': 8.8366}:  80%|████████  | 8/10 [00:54<00:13,  6.73s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.038, 'hit_ratio@10': 0.8481, 'ndcg@10': 0.8714, 'compress@10': 0.5592, 'time@10': 8.8366}:  90%|█████████ | 9/10 [00:54<00:06,  6.78s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0374, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8725, 'compress@10': 0.5082, 'time@10': 8.9181}:  90%|█████████ | 9/10 [01:04<00:06,  6.78s/it]  {'epoch': 10, 'num_users': 6.3, 'loss': 0.0374, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8725, 'compress@10': 0.5082, 'time@10': 8.9181}: 100%|██████████| 10/10 [01:04<00:00,  7.68s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0374, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.8725, 'compress@10': 0.5082, 'time@10': 8.9181}: 100%|██████████| 10/10 [01:04<00:00,  6.44s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03737690114867812
Avg hit ratio: 0.8587331990778511
Avg ndcg: 0.8724884516235178
Avg compression ratio: 0.5081792710810566
Avg train time: 8.918108415603637
Std train time: 2.6512971042378872
[0.6083333333333334, 0.5249999999999999, 0.1083333333333333, 0.8583333333333334, 0.9416666666666667, 0.8583333333333333, 0.27499999999999997, 0.4416666666666667, 0.19166666666666668, 0.025000000000000005]
[10, 10, 20, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.6289, 'time@10': 8.2294}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.6289, 'time@10': 8.2294}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8602, 'compress@10': 0.5846, 'time@10': 7.609}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it] {'epoch': 11, 'num_users': 7.0, 'loss': 0.0401, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8602, 'compress@10': 0.5846, 'time@10': 7.609}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8592, 'compress@10': 0.4683, 'time@10': 6.9759}:  20%|██        | 2/10 [00:14<00:46,  5.84s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8592, 'compress@10': 0.4683, 'time@10': 6.9759}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8689, 'compress@10': 0.5671, 'time@10': 6.6691}:  30%|███       | 3/10 [00:19<00:31,  4.49s/it]  {'epoch': 11, 'num_users': 5.0, 'loss': 0.031, 'hit_ratio@10': 0.791, 'ndcg@10': 0.8689, 'compress@10': 0.5671, 'time@10': 6.6691}:  40%|████      | 4/10 [00:19<00:30,  5.01s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0382, 'hit_ratio@10': 0.8048, 'ndcg@10': 0.8552, 'compress@10': 0.6422, 'time@10': 7.6713}:  40%|████      | 4/10 [00:25<00:30,  5.01s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0382, 'hit_ratio@10': 0.8048, 'ndcg@10': 0.8552, 'compress@10': 0.6422, 'time@10': 7.6713}:  50%|█████     | 5/10 [00:25<00:26,  5.32s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0388, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.857, 'compress@10': 0.6788, 'time@10': 7.9499}:  50%|█████     | 5/10 [00:35<00:26,  5.32s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0388, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.857, 'compress@10': 0.6788, 'time@10': 7.9499}:  60%|██████    | 6/10 [00:35<00:26,  6.70s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0394, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8541, 'compress@10': 0.6252, 'time@10': 8.3504}:  60%|██████    | 6/10 [00:40<00:26,  6.70s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0394, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8541, 'compress@10': 0.6252, 'time@10': 8.3504}:  70%|███████   | 7/10 [00:40<00:18,  6.28s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0393, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8577, 'compress@10': 0.6043, 'time@10': 8.2981}:  70%|███████   | 7/10 [00:48<00:18,  6.28s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0393, 'hit_ratio@10': 0.8547, 'ndcg@10': 0.8577, 'compress@10': 0.6043, 'time@10': 8.2981}:  80%|████████  | 8/10 [00:48<00:13,  6.82s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0384, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8647, 'compress@10': 0.561, 'time@10': 8.8929}:  80%|████████  | 8/10 [00:55<00:13,  6.82s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0384, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8647, 'compress@10': 0.561, 'time@10': 8.8929}:  90%|█████████ | 9/10 [00:55<00:06,  6.83s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0374, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8691, 'compress@10': 0.5096, 'time@10': 8.9625}:  90%|█████████ | 9/10 [01:04<00:06,  6.83s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.0374, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8691, 'compress@10': 0.5096, 'time@10': 8.9625}: 100%|██████████| 10/10 [01:04<00:00,  7.69s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0374, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8691, 'compress@10': 0.5096, 'time@10': 8.9625}: 100%|██████████| 10/10 [01:04<00:00,  6.50s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03739549973467408
Avg hit ratio: 0.8563839927286446
Avg ndcg: 0.8691003418241021
Avg compression ratio: 0.5096192378774866
Avg train time: 8.962493395805359
Std train time: 2.439598337054287
[0.6384615384615385, 0.48461538461538456, 0.09999999999999996, 0.8692307692307693, 0.9461538461538461, 0.8692307692307691, 0.33076923076923076, 0.40769230769230774, 0.17692307692307693, 0.02307692307692308]
[10, 10, 20, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8284, 'compress@10': 0.6575, 'time@10': 8.2827}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8284, 'compress@10': 0.6575, 'time@10': 8.2827}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0432, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8544, 'compress@10': 0.5794, 'time@10': 7.6247}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0432, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8544, 'compress@10': 0.5794, 'time@10': 7.6247}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8553, 'compress@10': 0.4624, 'time@10': 6.8028}:  20%|██        | 2/10 [00:13<00:46,  5.84s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0288, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8553, 'compress@10': 0.4624, 'time@10': 6.8028}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8652, 'compress@10': 0.5653, 'time@10': 6.5444}:  30%|███       | 3/10 [00:19<00:30,  4.37s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8652, 'compress@10': 0.5653, 'time@10': 6.5444}:  40%|████      | 4/10 [00:19<00:29,  4.94s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0355, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8541, 'compress@10': 0.6417, 'time@10': 7.559}:  40%|████      | 4/10 [00:25<00:29,  4.94s/it] {'epoch': 12, 'num_users': 5.8, 'loss': 0.0355, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8541, 'compress@10': 0.6417, 'time@10': 7.559}:  50%|█████     | 5/10 [00:25<00:26,  5.26s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0355, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8567, 'compress@10': 0.6801, 'time@10': 7.7705}:  50%|█████     | 5/10 [00:34<00:26,  5.26s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0355, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.8567, 'compress@10': 0.6801, 'time@10': 7.7705}:  60%|██████    | 6/10 [00:34<00:25,  6.49s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.036, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.8612, 'compress@10': 0.634, 'time@10': 8.2117}:  60%|██████    | 6/10 [00:39<00:25,  6.49s/it]  {'epoch': 12, 'num_users': 6.2857, 'loss': 0.036, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.8612, 'compress@10': 0.634, 'time@10': 8.2117}:  70%|███████   | 7/10 [00:39<00:18,  6.15s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.036, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8635, 'compress@10': 0.6078, 'time@10': 8.1707}:  70%|███████   | 7/10 [00:47<00:18,  6.15s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.036, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.8635, 'compress@10': 0.6078, 'time@10': 8.1707}:  80%|████████  | 8/10 [00:47<00:13,  6.72s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.036, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8722, 'compress@10': 0.5626, 'time@10': 8.7618}:  80%|████████  | 8/10 [00:54<00:13,  6.72s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.036, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.8722, 'compress@10': 0.5626, 'time@10': 8.7618}:  90%|█████████ | 9/10 [00:54<00:06,  6.74s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0348, 'hit_ratio@10': 0.883, 'ndcg@10': 0.8767, 'compress@10': 0.5108, 'time@10': 8.8163}:  90%|█████████ | 9/10 [01:03<00:06,  6.74s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0348, 'hit_ratio@10': 0.883, 'ndcg@10': 0.8767, 'compress@10': 0.5108, 'time@10': 8.8163}: 100%|██████████| 10/10 [01:03<00:00,  7.54s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0348, 'hit_ratio@10': 0.883, 'ndcg@10': 0.8767, 'compress@10': 0.5108, 'time@10': 8.8163}: 100%|██████████| 10/10 [01:03<00:00,  6.38s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.034816521692476635
Avg hit ratio: 0.8830122299884609
Avg ndcg: 0.8767491405250091
Avg compression ratio: 0.5108425213126532
Avg train time: 8.816277599334716
Std train time: 2.476718422963101
[0.6642857142857144, 0.5214285714285714, 0.09285714285714282, 0.8071428571428572, 0.95, 0.807142857142857, 0.37857142857142856, 0.45000000000000007, 0.16428571428571428, 0.021428571428571432]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0393, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.6819, 'time@10': 8.124}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0393, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8547, 'compress@10': 0.6819, 'time@10': 8.124}:  10%|█         | 1/10 [00:04<00:36,  4.10s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8724, 'compress@10': 0.6094, 'time@10': 7.5003}:  10%|█         | 1/10 [00:11<00:36,  4.10s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8724, 'compress@10': 0.6094, 'time@10': 7.5003}:  20%|██        | 2/10 [00:11<00:46,  5.75s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8673, 'compress@10': 0.4804, 'time@10': 6.8696}:  20%|██        | 2/10 [00:13<00:46,  5.75s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0237, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8673, 'compress@10': 0.4804, 'time@10': 6.8696}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8742, 'compress@10': 0.5638, 'time@10': 6.6735}:  30%|███       | 3/10 [00:19<00:30,  4.42s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8742, 'compress@10': 0.5638, 'time@10': 6.6735}:  40%|████      | 4/10 [00:19<00:30,  5.09s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0335, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8627, 'compress@10': 0.6413, 'time@10': 7.6445}:  40%|████      | 4/10 [00:25<00:30,  5.09s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0335, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8627, 'compress@10': 0.6413, 'time@10': 7.6445}:  50%|█████     | 5/10 [00:25<00:26,  5.35s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0336, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8645, 'compress@10': 0.6696, 'time@10': 7.8989}:  50%|█████     | 5/10 [00:34<00:26,  5.35s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0336, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8645, 'compress@10': 0.6696, 'time@10': 7.8989}:  60%|██████    | 6/10 [00:34<00:26,  6.66s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0331, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8637, 'compress@10': 0.6316, 'time@10': 8.3396}:  60%|██████    | 6/10 [00:40<00:26,  6.66s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0331, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8637, 'compress@10': 0.6316, 'time@10': 8.3396}:  70%|███████   | 7/10 [00:40<00:18,  6.29s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0332, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8673, 'compress@10': 0.6109, 'time@10': 8.2632}:  70%|███████   | 7/10 [00:48<00:18,  6.29s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0332, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.8673, 'compress@10': 0.6109, 'time@10': 8.2632}:  80%|████████  | 8/10 [00:48<00:13,  6.76s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8826, 'compress@10': 0.5639, 'time@10': 8.8304}:  80%|████████  | 8/10 [00:54<00:13,  6.76s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0334, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8826, 'compress@10': 0.5639, 'time@10': 8.8304}:  90%|█████████ | 9/10 [00:54<00:06,  6.75s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8862, 'compress@10': 0.5119, 'time@10': 8.9068}:  90%|█████████ | 9/10 [01:04<00:06,  6.75s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8862, 'compress@10': 0.5119, 'time@10': 8.9068}: 100%|██████████| 10/10 [01:04<00:00,  7.64s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8862, 'compress@10': 0.5119, 'time@10': 8.9068}: 100%|██████████| 10/10 [01:04<00:00,  6.46s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.033158907719433695
Avg hit ratio: 0.8763075136521655
Avg ndcg: 0.8862027563980686
Avg compression ratio: 0.5118673002836459
Avg train time: 8.906839823722839
Std train time: 2.3790670741330167
[0.6866666666666668, 0.4866666666666666, 0.08666666666666663, 0.8200000000000001, 0.9533333333333333, 0.82, 0.35333333333333333, 0.42000000000000004, 0.22, 0.020000000000000004]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0423, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8622, 'compress@10': 0.7031, 'time@10': 8.2753}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0423, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8622, 'compress@10': 0.7031, 'time@10': 8.2753}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8782, 'compress@10': 0.6032, 'time@10': 7.6002}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0361, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8782, 'compress@10': 0.6032, 'time@10': 7.6002}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8712, 'compress@10': 0.4745, 'time@10': 6.8341}:  20%|██        | 2/10 [00:13<00:46,  5.81s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8712, 'compress@10': 0.4745, 'time@10': 6.8341}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8991, 'compress@10': 0.5625, 'time@10': 6.6657}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0287, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8991, 'compress@10': 0.5625, 'time@10': 6.6657}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0346, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8831, 'compress@10': 0.6408, 'time@10': 7.7111}:  40%|████      | 4/10 [00:26<00:30,  5.10s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0346, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8831, 'compress@10': 0.6408, 'time@10': 7.7111}:  50%|█████     | 5/10 [00:26<00:27,  5.42s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0347, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.882, 'compress@10': 0.6714, 'time@10': 7.9626}:  50%|█████     | 5/10 [00:35<00:27,  5.42s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0347, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.882, 'compress@10': 0.6714, 'time@10': 7.9626}:  60%|██████    | 6/10 [00:35<00:26,  6.72s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0339, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8853, 'compress@10': 0.6296, 'time@10': 8.3936}:  60%|██████    | 6/10 [00:40<00:26,  6.72s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0339, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8853, 'compress@10': 0.6296, 'time@10': 8.3936}:  70%|███████   | 7/10 [00:40<00:18,  6.33s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0333, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8861, 'compress@10': 0.6055, 'time@10': 8.3141}:  70%|███████   | 7/10 [00:48<00:18,  6.33s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0333, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8861, 'compress@10': 0.6055, 'time@10': 8.3141}:  80%|████████  | 8/10 [00:48<00:13,  6.80s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0355, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9104, 'compress@10': 0.5651, 'time@10': 8.9614}:  80%|████████  | 8/10 [00:55<00:13,  6.80s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0355, 'hit_ratio@10': 0.8685, 'ndcg@10': 0.9104, 'compress@10': 0.5651, 'time@10': 8.9614}:  90%|█████████ | 9/10 [00:55<00:06,  6.90s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0345, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9116, 'compress@10': 0.5129, 'time@10': 9.0183}:  90%|█████████ | 9/10 [01:05<00:06,  6.90s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0345, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9116, 'compress@10': 0.5129, 'time@10': 9.0183}: 100%|██████████| 10/10 [01:05<00:00,  7.72s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0345, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.9116, 'compress@10': 0.5129, 'time@10': 9.0183}: 100%|██████████| 10/10 [01:05<00:00,  6.53s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.03447625946683634
Avg hit ratio: 0.8793484493246803
Avg ndcg: 0.9116301230572759
Avg compression ratio: 0.5128536343835489
Avg train time: 9.018326497077942
Std train time: 2.591189195069301
[0.70625, 0.45624999999999993, 0.08124999999999996, 0.83125, 0.9562499999999999, 0.8312499999999999, 0.33125, 0.39375000000000004, 0.26875, 0.018750000000000003]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8621, 'compress@10': 0.7217, 'time@10': 8.2625}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8621, 'compress@10': 0.7217, 'time@10': 8.2625}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8826, 'compress@10': 0.5977, 'time@10': 7.6731}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8826, 'compress@10': 0.5977, 'time@10': 7.6731}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8741, 'compress@10': 0.4693, 'time@10': 6.9672}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8741, 'compress@10': 0.4693, 'time@10': 6.9672}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8854, 'compress@10': 0.5613, 'time@10': 6.7469}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0236, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8854, 'compress@10': 0.5613, 'time@10': 6.7469}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8735, 'compress@10': 0.6405, 'time@10': 7.7713}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0299, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8735, 'compress@10': 0.6405, 'time@10': 7.7713}:  50%|█████     | 5/10 [00:26<00:27,  5.44s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0303, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.877, 'compress@10': 0.6729, 'time@10': 8.0765}:  50%|█████     | 5/10 [00:35<00:27,  5.44s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0303, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.877, 'compress@10': 0.6729, 'time@10': 8.0765}:  60%|██████    | 6/10 [00:35<00:27,  6.87s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0298, 'hit_ratio@10': 0.879, 'ndcg@10': 0.879, 'compress@10': 0.6279, 'time@10': 8.5282}:  60%|██████    | 6/10 [00:41<00:27,  6.87s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0298, 'hit_ratio@10': 0.879, 'ndcg@10': 0.879, 'compress@10': 0.6279, 'time@10': 8.5282}:  70%|███████   | 7/10 [00:41<00:19,  6.47s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8819, 'compress@10': 0.6008, 'time@10': 8.4375}:  70%|███████   | 7/10 [00:49<00:19,  6.47s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0289, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8819, 'compress@10': 0.6008, 'time@10': 8.4375}:  80%|████████  | 8/10 [00:49<00:13,  6.91s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8908, 'compress@10': 0.5662, 'time@10': 9.0342}:  80%|████████  | 8/10 [00:56<00:13,  6.91s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8908, 'compress@10': 0.5662, 'time@10': 9.0342}:  90%|█████████ | 9/10 [00:56<00:06,  6.92s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.8959, 'compress@10': 0.5137, 'time@10': 9.0845}:  90%|█████████ | 9/10 [01:05<00:06,  6.92s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.8959, 'compress@10': 0.5137, 'time@10': 9.0845}: 100%|██████████| 10/10 [01:05<00:00,  7.74s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0307, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.8959, 'compress@10': 0.5137, 'time@10': 9.0845}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.030708866418583947
Avg hit ratio: 0.8872849572611882
Avg ndcg: 0.8959398327786996
Avg compression ratio: 0.5137147356180106
Avg train time: 9.084475445747376
Std train time: 2.508921862675815
[0.723529411764706, 0.488235294117647, 0.07647058823529408, 0.7823529411764706, 0.9588235294117646, 0.8411764705882352, 0.31176470588235294, 0.37058823529411766, 0.31176470588235294, 0.017647058823529415]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8594, 'compress@10': 0.7381, 'time@10': 8.4383}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8594, 'compress@10': 0.7381, 'time@10': 8.4383}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8859, 'compress@10': 0.6214, 'time@10': 7.7466}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0345, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8859, 'compress@10': 0.6214, 'time@10': 7.7466}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8763, 'compress@10': 0.4837, 'time@10': 7.0524}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8763, 'compress@10': 0.4837, 'time@10': 7.0524}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8882, 'compress@10': 0.5603, 'time@10': 6.9051}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8882, 'compress@10': 0.5603, 'time@10': 6.9051}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0285, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8757, 'compress@10': 0.6402, 'time@10': 7.8687}:  40%|████      | 4/10 [00:26<00:31,  5.31s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0285, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8757, 'compress@10': 0.6402, 'time@10': 7.8687}:  50%|█████     | 5/10 [00:26<00:27,  5.52s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0281, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8818, 'compress@10': 0.6743, 'time@10': 8.1469}:  50%|█████     | 5/10 [00:36<00:27,  5.52s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0281, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8818, 'compress@10': 0.6743, 'time@10': 8.1469}:  60%|██████    | 6/10 [00:36<00:27,  6.90s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0276, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8866, 'compress@10': 0.6264, 'time@10': 8.5446}:  60%|██████    | 6/10 [00:41<00:27,  6.90s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0276, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8866, 'compress@10': 0.6264, 'time@10': 8.5446}:  70%|███████   | 7/10 [00:41<00:19,  6.44s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0263, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.8909, 'compress@10': 0.5967, 'time@10': 8.4701}:  70%|███████   | 7/10 [00:49<00:19,  6.44s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0263, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.8909, 'compress@10': 0.5967, 'time@10': 8.4701}:  80%|████████  | 8/10 [00:49<00:13,  6.93s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0272, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.8948, 'compress@10': 0.5672, 'time@10': 9.0755}:  80%|████████  | 8/10 [00:56<00:13,  6.93s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0272, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.8948, 'compress@10': 0.5672, 'time@10': 9.0755}:  90%|█████████ | 9/10 [00:56<00:06,  6.95s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8999, 'compress@10': 0.5145, 'time@10': 9.0915}:  90%|█████████ | 9/10 [01:05<00:06,  6.95s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8999, 'compress@10': 0.5145, 'time@10': 9.0915}: 100%|██████████| 10/10 [01:05<00:00,  7.67s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0262, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.8999, 'compress@10': 0.5145, 'time@10': 9.0915}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.026173456138366014
Avg hit ratio: 0.8808563858326167
Avg ndcg: 0.8999488791760178
Avg compression ratio: 0.5144950942776686
Avg train time: 9.091543126106263
Std train time: 2.4158532579887226
[0.7388888888888889, 0.5166666666666666, 0.07222222222222219, 0.7388888888888889, 0.961111111111111, 0.8499999999999999, 0.29444444444444445, 0.35000000000000003, 0.35, 0.01666666666666667]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8762, 'compress@10': 0.7526, 'time@10': 7.9968}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.039, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8762, 'compress@10': 0.7526, 'time@10': 7.9968}:  10%|█         | 1/10 [00:04<00:36,  4.04s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0326, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8955, 'compress@10': 0.6424, 'time@10': 7.4926}:  10%|█         | 1/10 [00:11<00:36,  4.04s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0326, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8955, 'compress@10': 0.6424, 'time@10': 7.4926}:  20%|██        | 2/10 [00:11<00:46,  5.79s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8827, 'compress@10': 0.4965, 'time@10': 6.7849}:  20%|██        | 2/10 [00:13<00:46,  5.79s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8827, 'compress@10': 0.4965, 'time@10': 6.7849}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.903, 'compress@10': 0.5595, 'time@10': 6.8135}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0277, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.903, 'compress@10': 0.5595, 'time@10': 6.8135}:  40%|████      | 4/10 [00:20<00:32,  5.40s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8891, 'compress@10': 0.6399, 'time@10': 7.7668}:  40%|████      | 4/10 [00:26<00:32,  5.40s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8891, 'compress@10': 0.6399, 'time@10': 7.7668}:  50%|█████     | 5/10 [00:26<00:27,  5.55s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0321, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8909, 'compress@10': 0.6755, 'time@10': 8.0577}:  50%|█████     | 5/10 [00:36<00:27,  5.55s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0321, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8909, 'compress@10': 0.6755, 'time@10': 8.0577}:  60%|██████    | 6/10 [00:36<00:27,  6.91s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0313, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8922, 'compress@10': 0.6251, 'time@10': 8.4768}:  60%|██████    | 6/10 [00:41<00:27,  6.91s/it] {'epoch': 17, 'num_users': 6.2857, 'loss': 0.0313, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8922, 'compress@10': 0.6251, 'time@10': 8.4768}:  70%|███████   | 7/10 [00:41<00:19,  6.46s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0292, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8958, 'compress@10': 0.593, 'time@10': 8.3976}:  70%|███████   | 7/10 [00:49<00:19,  6.46s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0292, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.8958, 'compress@10': 0.593, 'time@10': 8.3976}:  80%|████████  | 8/10 [00:49<00:13,  6.91s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0307, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9149, 'compress@10': 0.5681, 'time@10': 9.0242}:  80%|████████  | 8/10 [00:56<00:13,  6.91s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0307, 'hit_ratio@10': 0.8741, 'ndcg@10': 0.9149, 'compress@10': 0.5681, 'time@10': 9.0242}:  90%|█████████ | 9/10 [00:56<00:06,  6.96s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9208, 'compress@10': 0.5152, 'time@10': 9.0587}:  90%|█████████ | 9/10 [01:05<00:06,  6.96s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9208, 'compress@10': 0.5152, 'time@10': 9.0587}: 100%|██████████| 10/10 [01:05<00:00,  7.71s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9208, 'compress@10': 0.5152, 'time@10': 9.0587}: 100%|██████████| 10/10 [01:05<00:00,  6.60s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.030364899093831766
Avg hit ratio: 0.8844278144040454
Avg ndcg: 0.9208468945609664
Avg compression ratio: 0.5151879423926689
Avg train time: 9.058705401420593
Std train time: 2.456342479422364
[0.7526315789473684, 0.4894736842105263, 0.06842105263157891, 0.7526315789473684, 0.963157894736842, 0.8578947368421052, 0.27894736842105267, 0.3315789473684211, 0.38421052631578945, 0.01578947368421053]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8781, 'compress@10': 0.7656, 'time@10': 8.1362}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8781, 'compress@10': 0.7656, 'time@10': 8.1362}:  10%|█         | 1/10 [00:04<00:36,  4.10s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9027, 'compress@10': 0.6358, 'time@10': 7.5132}:  10%|█         | 1/10 [00:11<00:36,  4.10s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0317, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9027, 'compress@10': 0.6358, 'time@10': 7.5132}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8875, 'compress@10': 0.491, 'time@10': 6.8338}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8875, 'compress@10': 0.491, 'time@10': 6.8338}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9044, 'compress@10': 0.5586, 'time@10': 6.8038}:  30%|███       | 3/10 [00:20<00:30,  4.40s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9044, 'compress@10': 0.5586, 'time@10': 6.8038}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0305, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8904, 'compress@10': 0.6397, 'time@10': 7.7876}:  40%|████      | 4/10 [00:26<00:31,  5.33s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0305, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8904, 'compress@10': 0.6397, 'time@10': 7.7876}:  50%|█████     | 5/10 [00:26<00:27,  5.53s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.03, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8966, 'compress@10': 0.6766, 'time@10': 8.0485}:  50%|█████     | 5/10 [00:35<00:27,  5.53s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.03, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8966, 'compress@10': 0.6766, 'time@10': 8.0485}:  60%|██████    | 6/10 [00:35<00:27,  6.84s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8976, 'compress@10': 0.6239, 'time@10': 8.451}:  60%|██████    | 6/10 [00:41<00:27,  6.84s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8976, 'compress@10': 0.6239, 'time@10': 8.451}:  70%|███████   | 7/10 [00:41<00:19,  6.39s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.028, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9028, 'compress@10': 0.5897, 'time@10': 8.3436}:  70%|███████   | 7/10 [00:48<00:19,  6.39s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.028, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9028, 'compress@10': 0.5897, 'time@10': 8.3436}:  80%|████████  | 8/10 [00:48<00:13,  6.79s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0283, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9043, 'compress@10': 0.5689, 'time@10': 8.9878}:  80%|████████  | 8/10 [00:56<00:13,  6.79s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0283, 'hit_ratio@10': 0.8709, 'ndcg@10': 0.9043, 'compress@10': 0.5689, 'time@10': 8.9878}:  90%|█████████ | 9/10 [00:56<00:06,  6.89s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9083, 'compress@10': 0.5158, 'time@10': 9.0062}:  90%|█████████ | 9/10 [01:05<00:06,  6.89s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9083, 'compress@10': 0.5158, 'time@10': 9.0062}: 100%|██████████| 10/10 [01:05<00:00,  7.60s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9083, 'compress@10': 0.5158, 'time@10': 9.0062}: 100%|██████████| 10/10 [01:05<00:00,  6.53s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.02765743848662191
Avg hit ratio: 0.8815706715469025
Avg ndcg: 0.9082788945301461
Avg compression ratio: 0.5157919925621898
Avg train time: 9.006234073638916
Std train time: 2.496376568842543
[0.765, 0.46499999999999997, 0.06499999999999996, 0.765, 0.9649999999999999, 0.8649999999999999, 0.265, 0.31500000000000006, 0.415, 0.015000000000000003]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8812, 'compress@10': 0.7774, 'time@10': 8.0513}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8812, 'compress@10': 0.7774, 'time@10': 8.0513}:  10%|█         | 1/10 [00:04<00:36,  4.06s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9043, 'compress@10': 0.6298, 'time@10': 7.5678}:  10%|█         | 1/10 [00:11<00:36,  4.06s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9043, 'compress@10': 0.6298, 'time@10': 7.5678}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8886, 'compress@10': 0.4861, 'time@10': 6.8096}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8886, 'compress@10': 0.4861, 'time@10': 6.8096}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8984, 'compress@10': 0.5579, 'time@10': 6.7591}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8984, 'compress@10': 0.5579, 'time@10': 6.7591}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8853, 'compress@10': 0.6395, 'time@10': 7.6832}:  40%|████      | 4/10 [00:26<00:31,  5.30s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0248, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8853, 'compress@10': 0.6395, 'time@10': 7.6832}:  50%|█████     | 5/10 [00:26<00:27,  5.45s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0235, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8935, 'compress@10': 0.6775, 'time@10': 7.9396}:  50%|█████     | 5/10 [00:35<00:27,  5.45s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0235, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8935, 'compress@10': 0.6775, 'time@10': 7.9396}:  60%|██████    | 6/10 [00:35<00:26,  6.75s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0233, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8959, 'compress@10': 0.6228, 'time@10': 8.3569}:  60%|██████    | 6/10 [00:40<00:26,  6.75s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0233, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8959, 'compress@10': 0.6228, 'time@10': 8.3569}:  70%|███████   | 7/10 [00:40<00:18,  6.33s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0233, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.8975, 'compress@10': 0.5868, 'time@10': 8.2849}:  70%|███████   | 7/10 [00:48<00:18,  6.33s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0233, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.8975, 'compress@10': 0.5868, 'time@10': 8.2849}:  80%|████████  | 8/10 [00:48<00:13,  6.80s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.904, 'compress@10': 0.5695, 'time@10': 8.955}:  80%|████████  | 8/10 [00:56<00:13,  6.80s/it] {'epoch': 19, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.904, 'compress@10': 0.5695, 'time@10': 8.955}:  90%|█████████ | 9/10 [00:56<00:06,  6.93s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9093, 'compress@10': 0.5163, 'time@10': 9.0073}:  90%|█████████ | 9/10 [01:05<00:06,  6.93s/it] {'epoch': 19, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9093, 'compress@10': 0.5163, 'time@10': 9.0073}: 100%|██████████| 10/10 [01:05<00:00,  7.73s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8837, 'ndcg@10': 0.9093, 'compress@10': 0.5163, 'time@10': 9.0073}: 100%|██████████| 10/10 [01:05<00:00,  6.55s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.02246394756544958
Avg hit ratio: 0.8837135286897595
Avg ndcg: 0.9093499442241635
Avg compression ratio: 0.5163332024372557
Avg train time: 9.007270359992981
Std train time: 2.5135841954103886
[0.7761904761904762, 0.49047619047619045, 0.061904761904761865, 0.7285714285714285, 0.9666666666666666, 0.8238095238095237, 0.2523809523809524, 0.34761904761904766, 0.44285714285714284, 0.014285714285714289]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8819, 'compress@10': 0.788, 'time@10': 7.9816}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8819, 'compress@10': 0.788, 'time@10': 7.9816}:  10%|█         | 1/10 [00:04<00:36,  4.03s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9085, 'compress@10': 0.6474, 'time@10': 7.5042}:  10%|█         | 1/10 [00:11<00:36,  4.03s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9085, 'compress@10': 0.6474, 'time@10': 7.5042}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.8914, 'compress@10': 0.4969, 'time@10': 6.8226}:  20%|██        | 2/10 [00:13<00:46,  5.81s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.8914, 'compress@10': 0.4969, 'time@10': 6.8226}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.9016, 'compress@10': 0.5573, 'time@10': 6.7772}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.9016, 'compress@10': 0.5573, 'time@10': 6.7772}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0261, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8899, 'compress@10': 0.6393, 'time@10': 7.6974}:  40%|████      | 4/10 [00:26<00:31,  5.31s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0261, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8899, 'compress@10': 0.6393, 'time@10': 7.6974}:  50%|█████     | 5/10 [00:26<00:27,  5.46s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0268, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.8969, 'compress@10': 0.6707, 'time@10': 7.9557}:  50%|█████     | 5/10 [00:35<00:27,  5.46s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0268, 'hit_ratio@10': 0.8453, 'ndcg@10': 0.8969, 'compress@10': 0.6707, 'time@10': 7.9557}:  60%|██████    | 6/10 [00:35<00:27,  6.76s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0263, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8987, 'compress@10': 0.6152, 'time@10': 8.3554}:  60%|██████    | 6/10 [00:40<00:27,  6.76s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0263, 'hit_ratio@10': 0.8617, 'ndcg@10': 0.8987, 'compress@10': 0.6152, 'time@10': 8.3554}:  70%|███████   | 7/10 [00:40<00:18,  6.32s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9038, 'compress@10': 0.5841, 'time@10': 8.2765}:  70%|███████   | 7/10 [00:48<00:18,  6.32s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0251, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9038, 'compress@10': 0.5841, 'time@10': 8.2765}:  80%|████████  | 8/10 [00:48<00:13,  6.78s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0247, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.9083, 'compress@10': 0.5702, 'time@10': 8.9249}:  80%|████████  | 8/10 [00:55<00:13,  6.78s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0247, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.9083, 'compress@10': 0.5702, 'time@10': 8.9249}:  90%|█████████ | 9/10 [00:55<00:06,  6.88s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9123, 'compress@10': 0.5168, 'time@10': 8.9575}:  90%|█████████ | 9/10 [01:05<00:06,  6.88s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9123, 'compress@10': 0.5168, 'time@10': 8.9575}: 100%|██████████| 10/10 [01:05<00:00,  7.62s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.9123, 'compress@10': 0.5168, 'time@10': 8.9575}: 100%|██████████| 10/10 [01:05<00:00,  6.51s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.024396086389026593
Avg hit ratio: 0.8695071794834105
Avg ndcg: 0.9123088721362066
Avg compression ratio: 0.5168078637186109
Avg train time: 8.957487154006959
Std train time: 2.4419383908442085
[0.7863636363636364, 0.46818181818181814, 0.059090909090909055, 0.7409090909090909, 0.968181818181818, 0.8318181818181817, 0.2863636363636364, 0.33181818181818185, 0.42272727272727273, 0.01363636363636364]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8857, 'compress@10': 0.7976, 'time@10': 8.068}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8857, 'compress@10': 0.7976, 'time@10': 8.068}:  10%|█         | 1/10 [00:04<00:36,  4.07s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9154, 'compress@10': 0.6415, 'time@10': 7.5861}:  10%|█         | 1/10 [00:11<00:36,  4.07s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.027, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9154, 'compress@10': 0.6415, 'time@10': 7.5861}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.896, 'compress@10': 0.4921, 'time@10': 6.8733}:  20%|██        | 2/10 [00:13<00:47,  5.88s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.896, 'compress@10': 0.4921, 'time@10': 6.8733}:  30%|███       | 3/10 [00:13<00:31,  4.45s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.7952, 'ndcg@10': 0.9034, 'compress@10': 0.5566, 'time@10': 6.8167}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.7952, 'ndcg@10': 0.9034, 'compress@10': 0.5566, 'time@10': 6.8167}:  40%|████      | 4/10 [00:20<00:32,  5.33s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0234, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.894, 'compress@10': 0.6391, 'time@10': 7.712}:  40%|████      | 4/10 [00:26<00:32,  5.33s/it]  {'epoch': 21, 'num_users': 5.8, 'loss': 0.0234, 'hit_ratio@10': 0.8162, 'ndcg@10': 0.894, 'compress@10': 0.6391, 'time@10': 7.712}:  50%|█████     | 5/10 [00:26<00:27,  5.47s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.9032, 'compress@10': 0.6718, 'time@10': 8.0202}:  50%|█████     | 5/10 [00:35<00:27,  5.47s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8357, 'ndcg@10': 0.9032, 'compress@10': 0.6718, 'time@10': 8.0202}:  60%|██████    | 6/10 [00:35<00:27,  6.87s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0239, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.9042, 'compress@10': 0.6208, 'time@10': 8.4641}:  60%|██████    | 6/10 [00:41<00:27,  6.87s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0239, 'hit_ratio@10': 0.8534, 'ndcg@10': 0.9042, 'compress@10': 0.6208, 'time@10': 8.4641}:  70%|███████   | 7/10 [00:41<00:19,  6.46s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9082, 'compress@10': 0.5871, 'time@10': 8.3667}:  70%|███████   | 7/10 [00:49<00:19,  6.46s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0231, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9082, 'compress@10': 0.5871, 'time@10': 8.3667}:  80%|████████  | 8/10 [00:49<00:13,  6.86s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0219, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.9126, 'compress@10': 0.5707, 'time@10': 8.9898}:  80%|████████  | 8/10 [00:56<00:13,  6.86s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0219, 'hit_ratio@10': 0.8511, 'ndcg@10': 0.9126, 'compress@10': 0.5707, 'time@10': 8.9898}:  90%|█████████ | 9/10 [00:56<00:06,  6.91s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9153, 'compress@10': 0.5172, 'time@10': 9.0209}:  90%|█████████ | 9/10 [01:05<00:06,  6.91s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9153, 'compress@10': 0.5172, 'time@10': 9.0209}: 100%|██████████| 10/10 [01:05<00:00,  7.66s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.9153, 'compress@10': 0.5172, 'time@10': 9.0209}: 100%|██████████| 10/10 [01:05<00:00,  6.56s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.022446602375303926
Avg hit ratio: 0.8637135286897596
Avg ndcg: 0.9153081122736998
Avg compression ratio: 0.5172054502972638
Avg train time: 9.020862078666687
Std train time: 2.434628045241306
[0.7956521739130434, 0.4478260869565217, 0.05652173913043475, 0.708695652173913, 0.9695652173913042, 0.8391304347826085, 0.3173913043478261, 0.3173913043478261, 0.4043478260869565, 0.05652173913043478]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8886, 'compress@10': 0.8064, 'time@10': 8.1366}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8886, 'compress@10': 0.8064, 'time@10': 8.1366}:  10%|█         | 1/10 [00:04<00:36,  4.11s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9185, 'compress@10': 0.636, 'time@10': 7.5173}:  10%|█         | 1/10 [00:11<00:36,  4.11s/it] {'epoch': 22, 'num_users': 7.0, 'loss': 0.0251, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9185, 'compress@10': 0.636, 'time@10': 7.5173}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.8981, 'compress@10': 0.4878, 'time@10': 6.8314}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.8981, 'compress@10': 0.4878, 'time@10': 6.8314}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.9144, 'compress@10': 0.5456, 'time@10': 6.7583}:  30%|███       | 3/10 [00:20<00:30,  4.40s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8041, 'ndcg@10': 0.9144, 'compress@10': 0.5456, 'time@10': 6.7583}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0232, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.9035, 'compress@10': 0.6305, 'time@10': 7.6671}:  40%|████      | 4/10 [00:26<00:31,  5.26s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0232, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.9035, 'compress@10': 0.6305, 'time@10': 7.6671}:  50%|█████     | 5/10 [00:26<00:27,  5.41s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0211, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9112, 'compress@10': 0.6659, 'time@10': 7.9849}:  50%|█████     | 5/10 [00:35<00:27,  5.41s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0211, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.9112, 'compress@10': 0.6659, 'time@10': 7.9849}:  60%|██████    | 6/10 [00:35<00:27,  6.84s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.912, 'compress@10': 0.62, 'time@10': 8.4086}:  60%|██████    | 6/10 [00:41<00:27,  6.84s/it]   {'epoch': 22, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8649, 'ndcg@10': 0.912, 'compress@10': 0.62, 'time@10': 8.4086}:  70%|███████   | 7/10 [00:41<00:19,  6.41s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0204, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9151, 'compress@10': 0.5846, 'time@10': 8.3278}:  70%|███████   | 7/10 [00:48<00:19,  6.41s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0204, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9151, 'compress@10': 0.5846, 'time@10': 8.3278}:  80%|████████  | 8/10 [00:48<00:13,  6.85s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.92, 'compress@10': 0.5665, 'time@10': 9.0022}:  80%|████████  | 8/10 [00:56<00:13,  6.85s/it] {'epoch': 22, 'num_users': 6.3333, 'loss': 0.0198, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.92, 'compress@10': 0.5665, 'time@10': 9.0022}:  90%|█████████ | 9/10 [00:56<00:06,  6.97s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9249, 'compress@10': 0.5176, 'time@10': 9.0507}:  90%|█████████ | 9/10 [01:05<00:06,  6.97s/it] {'epoch': 22, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9249, 'compress@10': 0.5176, 'time@10': 9.0507}: 100%|██████████| 10/10 [01:05<00:00,  7.76s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9249, 'compress@10': 0.5176, 'time@10': 9.0507}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.01846879544276974
Avg hit ratio: 0.8803008302770612
Avg ndcg: 0.9248774339510358
Avg compression ratio: 0.5176200639885898
Avg train time: 9.050718736648559
Std train time: 2.531079658680223
[0.8041666666666666, 0.4708333333333333, 0.054166666666666634, 0.7208333333333332, 0.9708333333333332, 0.8041666666666665, 0.3458333333333333, 0.30416666666666664, 0.3875, 0.05416666666666667]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0312, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8909, 'compress@10': 0.8145, 'time@10': 7.9149}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0312, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8909, 'compress@10': 0.8145, 'time@10': 7.9149}:  10%|█         | 1/10 [00:03<00:35,  3.99s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9191, 'compress@10': 0.6512, 'time@10': 7.4467}:  10%|█         | 1/10 [00:11<00:35,  3.99s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0245, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9191, 'compress@10': 0.6512, 'time@10': 7.4467}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.8985, 'compress@10': 0.4972, 'time@10': 6.7467}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.7507, 'ndcg@10': 0.8985, 'compress@10': 0.4972, 'time@10': 6.7467}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.7952, 'ndcg@10': 0.9105, 'compress@10': 0.5556, 'time@10': 6.7161}:  30%|███       | 3/10 [00:20<00:30,  4.37s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.7952, 'ndcg@10': 0.9105, 'compress@10': 0.5556, 'time@10': 6.7161}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.9013, 'compress@10': 0.6388, 'time@10': 7.6268}:  40%|████      | 4/10 [00:26<00:31,  5.28s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.9013, 'compress@10': 0.6388, 'time@10': 7.6268}:  50%|█████     | 5/10 [00:26<00:27,  5.42s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9076, 'compress@10': 0.6671, 'time@10': 8.0203}:  50%|█████     | 5/10 [00:36<00:27,  5.42s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0205, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9076, 'compress@10': 0.6671, 'time@10': 8.0203}:  60%|██████    | 6/10 [00:36<00:27,  6.99s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0205, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.91, 'compress@10': 0.6249, 'time@10': 8.427}:  60%|██████    | 6/10 [00:41<00:27,  6.99s/it]   {'epoch': 23, 'num_users': 6.2857, 'loss': 0.0205, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.91, 'compress@10': 0.6249, 'time@10': 8.427}:  70%|███████   | 7/10 [00:41<00:19,  6.49s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9136, 'compress@10': 0.5873, 'time@10': 8.3503}:  70%|███████   | 7/10 [00:49<00:19,  6.49s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0198, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9136, 'compress@10': 0.5873, 'time@10': 8.3503}:  80%|████████  | 8/10 [00:49<00:13,  6.92s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9199, 'compress@10': 0.567, 'time@10': 8.9923}:  80%|████████  | 8/10 [00:56<00:13,  6.92s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0201, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9199, 'compress@10': 0.567, 'time@10': 8.9923}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9208, 'compress@10': 0.5179, 'time@10': 9.011}:  90%|█████████ | 9/10 [01:05<00:06,  6.98s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9208, 'compress@10': 0.5179, 'time@10': 9.011}: 100%|██████████| 10/10 [01:05<00:00,  7.67s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0212, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9208, 'compress@10': 0.5179, 'time@10': 9.011}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.021167995570518867
Avg hit ratio: 0.8765071794834103
Avg ndcg: 0.9207870071499068
Avg compression ratio: 0.5179086260006611
Avg train time: 9.011017966270447
Std train time: 2.4820956976853954
[0.8119999999999999, 0.452, 0.05199999999999997, 0.6919999999999998, 0.9719999999999999, 0.8119999999999998, 0.332, 0.292, 0.41200000000000003, 0.092]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0306, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8932, 'compress@10': 0.8219, 'time@10': 8.0319}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0306, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8932, 'compress@10': 0.8219, 'time@10': 8.0319}:  10%|█         | 1/10 [00:04<00:36,  4.05s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9218, 'compress@10': 0.6458, 'time@10': 7.5004}:  10%|█         | 1/10 [00:11<00:36,  4.05s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9218, 'compress@10': 0.6458, 'time@10': 7.5004}:  20%|██        | 2/10 [00:11<00:46,  5.79s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9002, 'compress@10': 0.493, 'time@10': 6.8184}:  20%|██        | 2/10 [00:13<00:46,  5.79s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.9002, 'compress@10': 0.493, 'time@10': 6.8184}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9301, 'compress@10': 0.5455, 'time@10': 6.7989}:  30%|███       | 3/10 [00:20<00:30,  4.41s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.9301, 'compress@10': 0.5455, 'time@10': 6.7989}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0215, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.9186, 'compress@10': 0.6309, 'time@10': 7.6932}:  40%|████      | 4/10 [00:26<00:32,  5.34s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0215, 'hit_ratio@10': 0.8559, 'ndcg@10': 0.9186, 'compress@10': 0.6309, 'time@10': 7.6932}:  50%|█████     | 5/10 [00:26<00:27,  5.46s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0225, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9257, 'compress@10': 0.6618, 'time@10': 8.0671}:  50%|█████     | 5/10 [00:36<00:27,  5.46s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0225, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9257, 'compress@10': 0.6618, 'time@10': 8.0671}:  60%|██████    | 6/10 [00:36<00:27,  7.00s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0229, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9229, 'compress@10': 0.6185, 'time@10': 8.4989}:  60%|██████    | 6/10 [00:41<00:27,  7.00s/it] {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0229, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9229, 'compress@10': 0.6185, 'time@10': 8.4989}:  70%|███████   | 7/10 [00:41<00:19,  6.53s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.926, 'compress@10': 0.5802, 'time@10': 8.3945}:  70%|███████   | 7/10 [00:49<00:19,  6.53s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0219, 'hit_ratio@10': 0.8958, 'ndcg@10': 0.926, 'compress@10': 0.5802, 'time@10': 8.3945}:  80%|████████  | 8/10 [00:49<00:13,  6.90s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0224, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9415, 'compress@10': 0.5634, 'time@10': 9.03}:  80%|████████  | 8/10 [00:56<00:13,  6.90s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0224, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9415, 'compress@10': 0.5634, 'time@10': 9.03}:  90%|█████████ | 9/10 [00:56<00:06,  6.97s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0215, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9442, 'compress@10': 0.5183, 'time@10': 9.064}:  90%|█████████ | 9/10 [01:06<00:06,  6.97s/it]  {'epoch': 24, 'num_users': 6.3, 'loss': 0.0215, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9442, 'compress@10': 0.5183, 'time@10': 9.064}: 100%|██████████| 10/10 [01:06<00:00,  7.72s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0215, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9442, 'compress@10': 0.5183, 'time@10': 9.064}: 100%|██████████| 10/10 [01:06<00:00,  6.60s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.021478532064472453
Avg hit ratio: 0.8972214651976961
Avg ndcg: 0.9442384300299727
Avg compression ratio: 0.5183101558485673
Avg train time: 9.063986587524415
Std train time: 2.4733898098988742
[0.8192307692307692, 0.4346153846153846, 0.04999999999999997, 0.7038461538461537, 0.973076923076923, 0.8192307692307691, 0.31923076923076926, 0.28076923076923077, 0.4346153846153846, 0.08846153846153847]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.899, 'compress@10': 0.8287, 'time@10': 7.9703}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.028, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.899, 'compress@10': 0.8287, 'time@10': 7.9703}:  10%|█         | 1/10 [00:04<00:36,  4.02s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9257, 'compress@10': 0.6408, 'time@10': 7.4608}:  10%|█         | 1/10 [00:11<00:36,  4.02s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9257, 'compress@10': 0.6408, 'time@10': 7.4608}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9028, 'compress@10': 0.4891, 'time@10': 6.7083}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9028, 'compress@10': 0.4891, 'time@10': 6.7083}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9167, 'compress@10': 0.5454, 'time@10': 6.7266}:  30%|███       | 3/10 [00:20<00:30,  4.34s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9167, 'compress@10': 0.5454, 'time@10': 6.7266}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9101, 'compress@10': 0.6311, 'time@10': 7.6172}:  40%|████      | 4/10 [00:26<00:31,  5.32s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9101, 'compress@10': 0.6311, 'time@10': 7.6172}:  50%|█████     | 5/10 [00:26<00:27,  5.43s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9187, 'compress@10': 0.6631, 'time@10': 7.9604}:  50%|█████     | 5/10 [00:35<00:27,  5.43s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9187, 'compress@10': 0.6631, 'time@10': 7.9604}:  60%|██████    | 6/10 [00:35<00:27,  6.89s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9207, 'compress@10': 0.6179, 'time@10': 8.3938}:  60%|██████    | 6/10 [00:41<00:27,  6.89s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9207, 'compress@10': 0.6179, 'time@10': 8.3938}:  70%|███████   | 7/10 [00:41<00:19,  6.44s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9237, 'compress@10': 0.5783, 'time@10': 8.3044}:  70%|███████   | 7/10 [00:49<00:19,  6.44s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9237, 'compress@10': 0.5783, 'time@10': 8.3044}:  80%|████████  | 8/10 [00:49<00:13,  6.85s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9467, 'compress@10': 0.5641, 'time@10': 8.9476}:  80%|████████  | 8/10 [00:56<00:13,  6.85s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9467, 'compress@10': 0.5641, 'time@10': 8.9476}:  90%|█████████ | 9/10 [00:56<00:06,  6.93s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9466, 'compress@10': 0.5186, 'time@10': 8.9791}:  90%|█████████ | 9/10 [01:05<00:06,  6.93s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9466, 'compress@10': 0.5186, 'time@10': 8.9791}: 100%|██████████| 10/10 [01:05<00:00,  7.66s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9466, 'compress@10': 0.5186, 'time@10': 8.9791}: 100%|██████████| 10/10 [01:05<00:00,  6.55s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.01834504239934372
Avg hit ratio: 0.8954211310289409
Avg ndcg: 0.9466183503326683
Avg compression ratio: 0.5186299898384968
Avg train time: 8.979051995277405
Std train time: 2.4805208326198627
[0.825925925925926, 0.4185185185185185, 0.04814814814814812, 0.6777777777777776, 0.974074074074074, 0.7888888888888888, 0.3444444444444445, 0.27037037037037037, 0.45555555555555555, 0.12222222222222223]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.899, 'compress@10': 0.8351, 'time@10': 8.2364}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.899, 'compress@10': 0.8351, 'time@10': 8.2364}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9271, 'compress@10': 0.6362, 'time@10': 7.6138}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0204, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9271, 'compress@10': 0.6362, 'time@10': 7.6138}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9038, 'compress@10': 0.4855, 'time@10': 6.9077}:  20%|██        | 2/10 [00:13<00:46,  5.85s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9038, 'compress@10': 0.4855, 'time@10': 6.9077}:  30%|███       | 3/10 [00:13<00:31,  4.45s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9262, 'compress@10': 0.5364, 'time@10': 6.8342}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0172, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9262, 'compress@10': 0.5364, 'time@10': 6.8342}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.918, 'compress@10': 0.6241, 'time@10': 7.6663}:  40%|████      | 4/10 [00:26<00:31,  5.32s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.918, 'compress@10': 0.6241, 'time@10': 7.6663}:  50%|█████     | 5/10 [00:26<00:26,  5.39s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9244, 'compress@10': 0.6523, 'time@10': 8.0372}:  50%|█████     | 5/10 [00:36<00:26,  5.39s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9244, 'compress@10': 0.6523, 'time@10': 8.0372}:  60%|██████    | 6/10 [00:36<00:27,  6.94s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9272, 'compress@10': 0.6121, 'time@10': 8.4798}:  60%|██████    | 6/10 [00:41<00:27,  6.94s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0183, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9272, 'compress@10': 0.6121, 'time@10': 8.4798}:  70%|███████   | 7/10 [00:41<00:19,  6.50s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0178, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9294, 'compress@10': 0.572, 'time@10': 8.377}:  70%|███████   | 7/10 [00:49<00:19,  6.50s/it]   {'epoch': 26, 'num_users': 6.125, 'loss': 0.0178, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9294, 'compress@10': 0.572, 'time@10': 8.377}:  80%|████████  | 8/10 [00:49<00:13,  6.88s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9269, 'compress@10': 0.5608, 'time@10': 9.0229}:  80%|████████  | 8/10 [00:56<00:13,  6.88s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9269, 'compress@10': 0.5608, 'time@10': 9.0229}:  90%|█████████ | 9/10 [00:56<00:06,  6.96s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9309, 'compress@10': 0.5189, 'time@10': 9.0808}:  90%|█████████ | 9/10 [01:06<00:06,  6.96s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9309, 'compress@10': 0.5189, 'time@10': 9.0808}: 100%|██████████| 10/10 [01:06<00:00,  7.79s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0188, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9309, 'compress@10': 0.5189, 'time@10': 9.0808}: 100%|██████████| 10/10 [01:06<00:00,  6.62s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.018834350198316883
Avg hit ratio: 0.8961354167432265
Avg ndcg: 0.9308801374311377
Avg compression ratio: 0.5189096916438602
Avg train time: 9.080841732025146
Std train time: 2.4690709373499304
[0.8321428571428572, 0.4035714285714286, 0.0464285714285714, 0.6892857142857141, 0.9749999999999999, 0.7607142857142856, 0.3678571428571429, 0.26071428571428573, 0.475, 0.11785714285714287]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.899, 'compress@10': 0.841, 'time@10': 8.0655}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0269, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.899, 'compress@10': 0.841, 'time@10': 8.0655}:  10%|█         | 1/10 [00:04<00:36,  4.07s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9263, 'compress@10': 0.6319, 'time@10': 7.457}:  10%|█         | 1/10 [00:10<00:36,  4.07s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9263, 'compress@10': 0.6319, 'time@10': 7.457}:  20%|██        | 2/10 [00:10<00:45,  5.73s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9033, 'compress@10': 0.4821, 'time@10': 6.7314}:  20%|██        | 2/10 [00:13<00:45,  5.73s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9033, 'compress@10': 0.4821, 'time@10': 6.7314}:  30%|███       | 3/10 [00:13<00:30,  4.33s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9406, 'compress@10': 0.5367, 'time@10': 6.7498}:  30%|███       | 3/10 [00:20<00:30,  4.33s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0182, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9406, 'compress@10': 0.5367, 'time@10': 6.7498}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9311, 'compress@10': 0.6245, 'time@10': 7.6603}:  40%|████      | 4/10 [00:26<00:31,  5.32s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9311, 'compress@10': 0.6245, 'time@10': 7.6603}:  50%|█████     | 5/10 [00:26<00:27,  5.46s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0213, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9399, 'compress@10': 0.6481, 'time@10': 8.0213}:  50%|█████     | 5/10 [00:36<00:27,  5.46s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0213, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9399, 'compress@10': 0.6481, 'time@10': 8.0213}:  60%|██████    | 6/10 [00:36<00:27,  6.95s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0219, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9358, 'compress@10': 0.6116, 'time@10': 8.4611}:  60%|██████    | 6/10 [00:41<00:27,  6.95s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0219, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9358, 'compress@10': 0.6116, 'time@10': 8.4611}:  70%|███████   | 7/10 [00:41<00:19,  6.51s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0208, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9378, 'compress@10': 0.5704, 'time@10': 8.3643}:  70%|███████   | 7/10 [00:49<00:19,  6.51s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0208, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9378, 'compress@10': 0.5704, 'time@10': 8.3643}:  80%|████████  | 8/10 [00:49<00:13,  6.89s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0194, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9398, 'compress@10': 0.5615, 'time@10': 8.9729}:  80%|████████  | 8/10 [00:56<00:13,  6.89s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0194, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.9398, 'compress@10': 0.5615, 'time@10': 8.9729}:  90%|█████████ | 9/10 [00:56<00:06,  6.91s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9427, 'compress@10': 0.5191, 'time@10': 8.9839}:  90%|█████████ | 9/10 [01:05<00:06,  6.91s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9427, 'compress@10': 0.5191, 'time@10': 8.9839}: 100%|██████████| 10/10 [01:05<00:00,  7.59s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.019, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9427, 'compress@10': 0.5191, 'time@10': 8.9839}: 100%|██████████| 10/10 [01:05<00:00,  6.54s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.018999658693045242
Avg hit ratio: 0.8828532866869029
Avg ndcg: 0.9427317102730258
Avg compression ratio: 0.5191218927009008
Avg train time: 8.983872628211975
Std train time: 2.44376148176453
[0.8379310344827586, 0.3896551724137931, 0.04482758620689652, 0.6999999999999997, 0.9758620689655171, 0.7689655172413792, 0.3896551724137931, 0.2517241379310345, 0.4586206896551724, 0.11379310344827587]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.899, 'compress@10': 0.8464, 'time@10': 8.0921}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0228, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.899, 'compress@10': 0.8464, 'time@10': 8.0921}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9277, 'compress@10': 0.6279, 'time@10': 7.4369}:  10%|█         | 1/10 [00:10<00:36,  4.08s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9277, 'compress@10': 0.6279, 'time@10': 7.4369}:  20%|██        | 2/10 [00:10<00:45,  5.69s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9042, 'compress@10': 0.479, 'time@10': 6.6939}:  20%|██        | 2/10 [00:13<00:45,  5.69s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9042, 'compress@10': 0.479, 'time@10': 6.6939}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9187, 'compress@10': 0.5369, 'time@10': 6.6947}:  30%|███       | 3/10 [00:20<00:30,  4.30s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9187, 'compress@10': 0.5369, 'time@10': 6.6947}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.9142, 'compress@10': 0.6248, 'time@10': 7.5656}:  40%|████      | 4/10 [00:25<00:31,  5.26s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.9142, 'compress@10': 0.6248, 'time@10': 7.5656}:  50%|█████     | 5/10 [00:25<00:26,  5.37s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.9229, 'compress@10': 0.6497, 'time@10': 7.9571}:  50%|█████     | 5/10 [00:35<00:26,  5.37s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.9229, 'compress@10': 0.6497, 'time@10': 7.9571}:  60%|██████    | 6/10 [00:35<00:27,  6.93s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.867, 'ndcg@10': 0.9238, 'compress@10': 0.616, 'time@10': 8.3946}:  60%|██████    | 6/10 [00:41<00:27,  6.93s/it]  {'epoch': 28, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.867, 'ndcg@10': 0.9238, 'compress@10': 0.616, 'time@10': 8.3946}:  70%|███████   | 7/10 [00:41<00:19,  6.47s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9286, 'compress@10': 0.5732, 'time@10': 8.2936}:  70%|███████   | 7/10 [00:48<00:19,  6.47s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.8801, 'ndcg@10': 0.9286, 'compress@10': 0.5732, 'time@10': 8.2936}:  80%|████████  | 8/10 [00:48<00:13,  6.84s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9326, 'compress@10': 0.5622, 'time@10': 8.9348}:  80%|████████  | 8/10 [00:56<00:13,  6.84s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9326, 'compress@10': 0.5622, 'time@10': 8.9348}:  90%|█████████ | 9/10 [00:56<00:06,  6.91s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.932, 'compress@10': 0.5193, 'time@10': 8.9768}:  90%|█████████ | 9/10 [01:05<00:06,  6.91s/it]    {'epoch': 28, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.932, 'compress@10': 0.5193, 'time@10': 8.9768}: 100%|██████████| 10/10 [01:05<00:00,  7.68s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8846, 'ndcg@10': 0.932, 'compress@10': 0.5193, 'time@10': 8.9768}: 100%|██████████| 10/10 [01:05<00:00,  6.54s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.014081960837315916
Avg hit ratio: 0.88462748023529
Avg ndcg: 0.9320446179541342
Avg compression ratio: 0.519340366898342
Avg train time: 8.976821780204773
Std train time: 2.496244651225153
[0.8433333333333334, 0.37666666666666665, 0.04333333333333331, 0.6766666666666664, 0.9766666666666665, 0.7433333333333332, 0.41, 0.24333333333333335, 0.4766666666666666, 0.14333333333333334]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.899, 'compress@10': 0.8516, 'time@10': 7.9474}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.899, 'compress@10': 0.8516, 'time@10': 7.9474}:  10%|█         | 1/10 [00:04<00:36,  4.01s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9253, 'compress@10': 0.6242, 'time@10': 7.3343}:  10%|█         | 1/10 [00:10<00:36,  4.01s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9253, 'compress@10': 0.6242, 'time@10': 7.3343}:  20%|██        | 2/10 [00:10<00:44,  5.62s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9026, 'compress@10': 0.4761, 'time@10': 6.6533}:  20%|██        | 2/10 [00:13<00:44,  5.62s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9026, 'compress@10': 0.4761, 'time@10': 6.6533}:  30%|███       | 3/10 [00:13<00:29,  4.28s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9399, 'compress@10': 0.5291, 'time@10': 6.6856}:  30%|███       | 3/10 [00:20<00:29,  4.28s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.9399, 'compress@10': 0.5291, 'time@10': 6.6856}:  40%|████      | 4/10 [00:20<00:31,  5.28s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9321, 'compress@10': 0.6187, 'time@10': 7.5636}:  40%|████      | 4/10 [00:25<00:31,  5.28s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9321, 'compress@10': 0.6187, 'time@10': 7.5636}:  50%|█████     | 5/10 [00:25<00:26,  5.39s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9376, 'compress@10': 0.6404, 'time@10': 8.0023}:  50%|█████     | 5/10 [00:36<00:26,  5.39s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0153, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9376, 'compress@10': 0.6404, 'time@10': 8.0023}:  60%|██████    | 6/10 [00:36<00:28,  7.04s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9395, 'compress@10': 0.6109, 'time@10': 8.4439}:  60%|██████    | 6/10 [00:41<00:28,  7.04s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9395, 'compress@10': 0.6109, 'time@10': 8.4439}:  70%|███████   | 7/10 [00:41<00:19,  6.56s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9401, 'compress@10': 0.5677, 'time@10': 8.356}:  70%|███████   | 7/10 [00:49<00:19,  6.56s/it]  {'epoch': 29, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9401, 'compress@10': 0.5677, 'time@10': 8.356}:  80%|████████  | 8/10 [00:49<00:13,  6.95s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9444, 'compress@10': 0.5592, 'time@10': 8.9825}:  80%|████████  | 8/10 [00:56<00:13,  6.95s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9444, 'compress@10': 0.5592, 'time@10': 8.9825}:  90%|█████████ | 9/10 [00:56<00:06,  6.97s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9476, 'compress@10': 0.5196, 'time@10': 9.0261}:  90%|█████████ | 9/10 [01:05<00:06,  6.97s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9476, 'compress@10': 0.5196, 'time@10': 9.0261}: 100%|██████████| 10/10 [01:05<00:00,  7.74s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9476, 'compress@10': 0.5196, 'time@10': 9.0261}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.014411963906891345
Avg hit ratio: 0.8942818581154744
Avg ndcg: 0.9475888139797961
Avg compression ratio: 0.5195689726989994
Avg train time: 9.02605574131012
Std train time: 2.4857672915133695
[0.8483870967741935, 0.36451612903225805, 0.04193548387096772, 0.6870967741935482, 0.9774193548387095, 0.7193548387096773, 0.39677419354838706, 0.267741935483871, 0.4935483870967742, 0.13870967741935483]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9017, 'compress@10': 0.8564, 'time@10': 7.9957}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9017, 'compress@10': 0.8564, 'time@10': 7.9957}:  10%|█         | 1/10 [00:04<00:36,  4.03s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9323, 'compress@10': 0.6207, 'time@10': 7.414}:  10%|█         | 1/10 [00:10<00:36,  4.03s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9323, 'compress@10': 0.6207, 'time@10': 7.414}:  20%|██        | 2/10 [00:10<00:45,  5.70s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9073, 'compress@10': 0.4734, 'time@10': 6.704}:  20%|██        | 2/10 [00:13<00:45,  5.70s/it] {'epoch': 30, 'num_users': 5.0, 'loss': 0.0108, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9073, 'compress@10': 0.4734, 'time@10': 6.704}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.921, 'compress@10': 0.5296, 'time@10': 6.7337}:  30%|███       | 3/10 [00:20<00:30,  4.32s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.921, 'compress@10': 0.5296, 'time@10': 6.7337}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9179, 'compress@10': 0.6193, 'time@10': 7.6668}:  40%|████      | 4/10 [00:26<00:31,  5.32s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9179, 'compress@10': 0.6193, 'time@10': 7.6668}:  50%|█████     | 5/10 [00:26<00:27,  5.47s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9312, 'compress@10': 0.637, 'time@10': 8.0888}:  50%|█████     | 5/10 [00:36<00:27,  5.47s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0145, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.9312, 'compress@10': 0.637, 'time@10': 8.0888}:  60%|██████    | 6/10 [00:36<00:28,  7.09s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9322, 'compress@10': 0.6061, 'time@10': 8.5106}:  60%|██████    | 6/10 [00:41<00:28,  7.09s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9322, 'compress@10': 0.6061, 'time@10': 8.5106}:  70%|███████   | 7/10 [00:41<00:19,  6.59s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0162, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9338, 'compress@10': 0.5664, 'time@10': 8.4069}:  70%|███████   | 7/10 [00:49<00:19,  6.59s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0162, 'hit_ratio@10': 0.8886, 'ndcg@10': 0.9338, 'compress@10': 0.5664, 'time@10': 8.4069}:  80%|████████  | 8/10 [00:49<00:13,  6.95s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0179, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.94, 'compress@10': 0.5599, 'time@10': 9.0122}:  80%|████████  | 8/10 [00:56<00:13,  6.95s/it] {'epoch': 30, 'num_users': 6.3333, 'loss': 0.0179, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.94, 'compress@10': 0.5599, 'time@10': 9.0122}:  90%|█████████ | 9/10 [00:56<00:06,  6.95s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.941, 'compress@10': 0.5198, 'time@10': 9.0253}:  90%|█████████ | 9/10 [01:05<00:06,  6.95s/it]  {'epoch': 30, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.941, 'compress@10': 0.5198, 'time@10': 9.0253}: 100%|██████████| 10/10 [01:05<00:00,  7.64s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.941, 'compress@10': 0.5198, 'time@10': 9.0253}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.01942431517398446
Avg hit ratio: 0.8828532866869029
Avg ndcg: 0.9409749818731686
Avg compression ratio: 0.5197767209772246
Avg train time: 9.025303506851197
Std train time: 2.4686092886960003
[0.821875, 0.35312499999999997, 0.040624999999999974, 0.6656249999999998, 0.9781249999999998, 0.7281249999999999, 0.41562499999999997, 0.259375, 0.509375, 0.165625]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9017, 'compress@10': 0.8312, 'time@10': 8.0815}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9017, 'compress@10': 0.8312, 'time@10': 8.0815}:  10%|█         | 1/10 [00:04<00:36,  4.11s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9328, 'compress@10': 0.6026, 'time@10': 7.5111}:  10%|█         | 1/10 [00:11<00:36,  4.11s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9328, 'compress@10': 0.6026, 'time@10': 7.5111}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9076, 'compress@10': 0.461, 'time@10': 6.7468}:  20%|██        | 2/10 [00:13<00:46,  5.80s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9076, 'compress@10': 0.461, 'time@10': 6.7468}:  30%|███       | 3/10 [00:13<00:30,  4.36s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9212, 'compress@10': 0.5151, 'time@10': 6.7433}:  30%|███       | 3/10 [00:20<00:30,  4.36s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9212, 'compress@10': 0.5151, 'time@10': 6.7433}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.919, 'compress@10': 0.6078, 'time@10': 7.6103}:  40%|████      | 4/10 [00:26<00:31,  5.31s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.0129, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.919, 'compress@10': 0.6078, 'time@10': 7.6103}:  50%|█████     | 5/10 [00:26<00:27,  5.41s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9268, 'compress@10': 0.6289, 'time@10': 8.0286}:  50%|█████     | 5/10 [00:36<00:27,  5.41s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0132, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9268, 'compress@10': 0.6289, 'time@10': 8.0286}:  60%|██████    | 6/10 [00:36<00:28,  7.02s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9275, 'compress@10': 0.6017, 'time@10': 8.4957}:  60%|██████    | 6/10 [00:41<00:28,  7.02s/it] {'epoch': 31, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9275, 'compress@10': 0.6017, 'time@10': 8.4957}:  70%|███████   | 7/10 [00:41<00:19,  6.58s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.932, 'compress@10': 0.5616, 'time@10': 8.4006}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0128, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.932, 'compress@10': 0.5616, 'time@10': 8.4006}:  80%|████████  | 8/10 [00:49<00:13,  6.97s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9328, 'compress@10': 0.5573, 'time@10': 9.0151}:  80%|████████  | 8/10 [00:56<00:13,  6.97s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0138, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9328, 'compress@10': 0.5573, 'time@10': 9.0151}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9367, 'compress@10': 0.5201, 'time@10': 9.0603}:  90%|█████████ | 9/10 [01:06<00:06,  6.98s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9367, 'compress@10': 0.5201, 'time@10': 9.0603}: 100%|██████████| 10/10 [01:06<00:00,  7.76s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9367, 'compress@10': 0.5201, 'time@10': 9.0603}: 100%|██████████| 10/10 [01:06<00:00,  6.62s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.01338418614745801
Avg hit ratio: 0.8964247152583316
Avg ndcg: 0.9367036108060992
Avg compression ratio: 0.5200701074314699
Avg train time: 9.060291957855224
Std train time: 2.4795598301507225
[0.8272727272727273, 0.3424242424242424, 0.03939393939393937, 0.6454545454545453, 0.9787878787878785, 0.7363636363636363, 0.4333333333333333, 0.2515151515151515, 0.5242424242424243, 0.1606060606060606]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9087, 'compress@10': 0.8364, 'time@10': 8.1327}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9087, 'compress@10': 0.8364, 'time@10': 8.1327}:  10%|█         | 1/10 [00:04<00:36,  4.10s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9333, 'compress@10': 0.6, 'time@10': 7.4686}:  10%|█         | 1/10 [00:10<00:36,  4.10s/it]   {'epoch': 32, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9333, 'compress@10': 0.6, 'time@10': 7.4686}:  20%|██        | 2/10 [00:10<00:45,  5.71s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9079, 'compress@10': 0.4589, 'time@10': 6.7531}:  20%|██        | 2/10 [00:13<00:45,  5.71s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9079, 'compress@10': 0.4589, 'time@10': 6.7531}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.951, 'compress@10': 0.5087, 'time@10': 6.7526}:  30%|███       | 3/10 [00:20<00:30,  4.34s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.951, 'compress@10': 0.5087, 'time@10': 6.7526}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9431, 'compress@10': 0.6028, 'time@10': 7.641}:  40%|████      | 4/10 [00:26<00:31,  5.30s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0191, 'hit_ratio@10': 0.8729, 'ndcg@10': 0.9431, 'compress@10': 0.6028, 'time@10': 7.641}:  50%|█████     | 5/10 [00:26<00:27,  5.42s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.948, 'compress@10': 0.626, 'time@10': 8.0292}:  50%|█████     | 5/10 [00:36<00:27,  5.42s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.948, 'compress@10': 0.626, 'time@10': 8.0292}:  60%|██████    | 6/10 [00:36<00:27,  6.98s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9483, 'compress@10': 0.6017, 'time@10': 8.4514}:  60%|██████    | 6/10 [00:41<00:27,  6.98s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0163, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9483, 'compress@10': 0.6017, 'time@10': 8.4514}:  70%|███████   | 7/10 [00:41<00:19,  6.51s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9496, 'compress@10': 0.5606, 'time@10': 8.34}:  70%|███████   | 7/10 [00:49<00:19,  6.51s/it]   {'epoch': 32, 'num_users': 6.125, 'loss': 0.0156, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9496, 'compress@10': 0.5606, 'time@10': 8.34}:  80%|████████  | 8/10 [00:49<00:13,  6.85s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9512, 'compress@10': 0.5581, 'time@10': 8.9443}:  80%|████████  | 8/10 [00:56<00:13,  6.85s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9512, 'compress@10': 0.5581, 'time@10': 8.9443}:  90%|█████████ | 9/10 [00:56<00:06,  6.88s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9537, 'compress@10': 0.5203, 'time@10': 9.0033}:  90%|█████████ | 9/10 [01:05<00:06,  6.88s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9537, 'compress@10': 0.5203, 'time@10': 9.0033}: 100%|██████████| 10/10 [01:05<00:00,  7.71s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.9537, 'compress@10': 0.5203, 'time@10': 9.0033}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.014135281369936628
Avg hit ratio: 0.9050755089091252
Avg ndcg: 0.9536859450214182
Avg compression ratio: 0.5202564490788157
Avg train time: 9.003257584571838
Std train time: 2.4298734207092347
[0.8323529411764706, 0.36176470588235293, 0.038235294117647034, 0.6558823529411762, 0.9794117647058821, 0.7147058823529412, 0.44999999999999996, 0.24411764705882355, 0.5088235294117648, 0.15588235294117647]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9134, 'compress@10': 0.8412, 'time@10': 8.3363}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9134, 'compress@10': 0.8412, 'time@10': 8.3363}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.94, 'compress@10': 0.6118, 'time@10': 7.6831}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]  {'epoch': 33, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.94, 'compress@10': 0.6118, 'time@10': 7.6831}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9123, 'compress@10': 0.4664, 'time@10': 6.8689}:  20%|██        | 2/10 [00:13<00:47,  5.89s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9123, 'compress@10': 0.4664, 'time@10': 6.8689}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9229, 'compress@10': 0.5168, 'time@10': 6.8357}:  30%|███       | 3/10 [00:20<00:30,  4.41s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.9229, 'compress@10': 0.5168, 'time@10': 6.8357}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9228, 'compress@10': 0.6094, 'time@10': 7.7071}:  40%|████      | 4/10 [00:26<00:32,  5.34s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8443, 'ndcg@10': 0.9228, 'compress@10': 0.6094, 'time@10': 7.7071}:  50%|█████     | 5/10 [00:26<00:27,  5.45s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9353, 'compress@10': 0.628, 'time@10': 8.0966}:  50%|█████     | 5/10 [00:36<00:27,  5.45s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.9353, 'compress@10': 0.628, 'time@10': 8.0966}:  60%|██████    | 6/10 [00:36<00:28,  7.02s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9361, 'compress@10': 0.6057, 'time@10': 8.5455}:  60%|██████    | 6/10 [00:42<00:28,  7.02s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9361, 'compress@10': 0.6057, 'time@10': 8.5455}:  70%|███████   | 7/10 [00:42<00:19,  6.58s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.015, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9387, 'compress@10': 0.5632, 'time@10': 8.4364}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it]  {'epoch': 33, 'num_users': 6.125, 'loss': 0.015, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9387, 'compress@10': 0.5632, 'time@10': 8.4364}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9414, 'compress@10': 0.5587, 'time@10': 9.0647}:  80%|████████  | 8/10 [00:56<00:13,  6.94s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9414, 'compress@10': 0.5587, 'time@10': 9.0647}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9418, 'compress@10': 0.5204, 'time@10': 9.0966}:  90%|█████████ | 9/10 [01:06<00:06,  6.98s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9418, 'compress@10': 0.5204, 'time@10': 9.0966}: 100%|██████████| 10/10 [01:06<00:00,  7.76s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0165, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9418, 'compress@10': 0.5204, 'time@10': 9.0966}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.016455442169643078
Avg hit ratio: 0.8907897946234108
Avg ndcg: 0.9417628052983954
Avg compression ratio: 0.5203817194067918
Avg train time: 9.096641421318054
Std train time: 2.49451778162999
[0.8371428571428572, 0.3514285714285714, 0.037142857142857116, 0.6657142857142855, 0.9799999999999998, 0.7228571428571429, 0.4371428571428571, 0.23714285714285716, 0.4942857142857144, 0.18]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9169, 'compress@10': 0.8457, 'time@10': 8.1429}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0171, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9169, 'compress@10': 0.8457, 'time@10': 8.1429}:  10%|█         | 1/10 [00:04<00:36,  4.11s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9418, 'compress@10': 0.609, 'time@10': 7.413}:  10%|█         | 1/10 [00:10<00:36,  4.11s/it]  {'epoch': 34, 'num_users': 7.0, 'loss': 0.0118, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9418, 'compress@10': 0.609, 'time@10': 7.413}:  20%|██        | 2/10 [00:10<00:45,  5.64s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9136, 'compress@10': 0.4643, 'time@10': 6.6702}:  20%|██        | 2/10 [00:13<00:45,  5.64s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9136, 'compress@10': 0.4643, 'time@10': 6.6702}:  30%|███       | 3/10 [00:13<00:29,  4.27s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9257, 'compress@10': 0.5176, 'time@10': 6.7313}:  30%|███       | 3/10 [00:20<00:29,  4.27s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9257, 'compress@10': 0.5176, 'time@10': 6.7313}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9254, 'compress@10': 0.6102, 'time@10': 7.6163}:  40%|████      | 4/10 [00:26<00:31,  5.33s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9254, 'compress@10': 0.6102, 'time@10': 7.6163}:  50%|█████     | 5/10 [00:26<00:27,  5.43s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9337, 'compress@10': 0.63, 'time@10': 8.0435}:  50%|█████     | 5/10 [00:36<00:27,  5.43s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.8602, 'ndcg@10': 0.9337, 'compress@10': 0.63, 'time@10': 8.0435}:  60%|██████    | 6/10 [00:36<00:28,  7.06s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9358, 'compress@10': 0.6056, 'time@10': 8.4878}:  60%|██████    | 6/10 [00:41<00:28,  7.06s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9358, 'compress@10': 0.6056, 'time@10': 8.4878}:  70%|███████   | 7/10 [00:41<00:19,  6.58s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.939, 'compress@10': 0.5623, 'time@10': 8.3873}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it]  {'epoch': 34, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.939, 'compress@10': 0.5623, 'time@10': 8.3873}:  80%|████████  | 8/10 [00:49<00:13,  6.95s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.946, 'compress@10': 0.5563, 'time@10': 9.0131}:  80%|████████  | 8/10 [00:56<00:13,  6.95s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.946, 'compress@10': 0.5563, 'time@10': 9.0131}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9481, 'compress@10': 0.5206, 'time@10': 9.0581}:  90%|█████████ | 9/10 [01:06<00:06,  6.98s/it]  {'epoch': 34, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9481, 'compress@10': 0.5206, 'time@10': 9.0581}: 100%|██████████| 10/10 [01:06<00:00,  7.76s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9481, 'compress@10': 0.5206, 'time@10': 9.0581}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.012469194400665257
Avg hit ratio: 0.8812818581154744
Avg ndcg: 0.9481071377688994
Avg compression ratio: 0.5205765031341981
Avg train time: 9.058145332336426
Std train time: 2.505934967285136
[0.8416666666666667, 0.3416666666666667, 0.03611111111111109, 0.6749999999999998, 0.9805555555555553, 0.7027777777777778, 0.425, 0.23055555555555557, 0.5083333333333334, 0.20277777777777778]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.85, 'time@10': 7.8838}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.85, 'time@10': 7.8838}:  10%|█         | 1/10 [00:03<00:35,  3.98s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9465, 'compress@10': 0.6064, 'time@10': 7.3556}:  10%|█         | 1/10 [00:10<00:35,  3.98s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9465, 'compress@10': 0.6064, 'time@10': 7.3556}:  20%|██        | 2/10 [00:10<00:45,  5.68s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9167, 'compress@10': 0.4622, 'time@10': 6.6552}:  20%|██        | 2/10 [00:13<00:45,  5.68s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9167, 'compress@10': 0.4622, 'time@10': 6.6552}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9309, 'compress@10': 0.5183, 'time@10': 6.7108}:  30%|███       | 3/10 [00:20<00:30,  4.30s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0121, 'hit_ratio@10': 0.8164, 'ndcg@10': 0.9309, 'compress@10': 0.5183, 'time@10': 6.7108}:  40%|████      | 4/10 [00:20<00:32,  5.33s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.9297, 'compress@10': 0.6108, 'time@10': 7.6288}:  40%|████      | 4/10 [00:26<00:32,  5.33s/it] {'epoch': 35, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8451, 'ndcg@10': 0.9297, 'compress@10': 0.6108, 'time@10': 7.6288}:  50%|█████     | 5/10 [00:26<00:27,  5.46s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.937, 'compress@10': 0.6273, 'time@10': 8.0198}:  50%|█████     | 5/10 [00:36<00:27,  5.46s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.937, 'compress@10': 0.6273, 'time@10': 8.0198}:  60%|██████    | 6/10 [00:36<00:28,  7.01s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9394, 'compress@10': 0.6017, 'time@10': 8.448}:  60%|██████    | 6/10 [00:41<00:28,  7.01s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9394, 'compress@10': 0.6017, 'time@10': 8.448}:  70%|███████   | 7/10 [00:41<00:19,  6.53s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9433, 'compress@10': 0.558, 'time@10': 8.3382}:  70%|███████   | 7/10 [00:49<00:19,  6.53s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0114, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9433, 'compress@10': 0.558, 'time@10': 8.3382}:  80%|████████  | 8/10 [00:49<00:13,  6.88s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9405, 'compress@10': 0.5541, 'time@10': 8.9746}:  80%|████████  | 8/10 [00:56<00:13,  6.88s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.8728, 'ndcg@10': 0.9405, 'compress@10': 0.5541, 'time@10': 8.9746}:  90%|█████████ | 9/10 [00:56<00:06,  6.94s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9441, 'compress@10': 0.5207, 'time@10': 9.0365}:  90%|█████████ | 9/10 [01:05<00:06,  6.94s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9441, 'compress@10': 0.5207, 'time@10': 9.0365}: 100%|██████████| 10/10 [01:05<00:00,  7.77s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9441, 'compress@10': 0.5207, 'time@10': 9.0365}: 100%|██████████| 10/10 [01:05<00:00,  6.60s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.013693988532664157
Avg hit ratio: 0.8832818581154743
Avg ndcg: 0.9441108854683975
Avg compression ratio: 0.5207432713170699
Avg train time: 9.036457467079163
Std train time: 2.5071722686946134
[0.845945945945946, 0.35945945945945945, 0.03513513513513511, 0.6837837837837836, 0.9810810810810808, 0.6837837837837838, 0.4135135135135135, 0.22432432432432434, 0.5216216216216217, 0.1972972972972973]
[10, 10, 21, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.854, 'time@10': 8.0175}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.854, 'time@10': 8.0175}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9441, 'compress@10': 0.6171, 'time@10': 7.4808}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9441, 'compress@10': 0.6171, 'time@10': 7.4808}:  20%|██        | 2/10 [00:11<00:47,  5.89s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9151, 'compress@10': 0.469, 'time@10': 6.6855}:  20%|██        | 2/10 [00:13<00:47,  5.89s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9151, 'compress@10': 0.469, 'time@10': 6.6855}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9269, 'compress@10': 0.5256, 'time@10': 6.6838}:  30%|███       | 3/10 [00:20<00:30,  4.38s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9269, 'compress@10': 0.5256, 'time@10': 6.6838}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9276, 'compress@10': 0.6167, 'time@10': 7.5408}:  40%|████      | 4/10 [00:26<00:31,  5.30s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8427, 'ndcg@10': 0.9276, 'compress@10': 0.6167, 'time@10': 7.5408}:  50%|█████     | 5/10 [00:26<00:26,  5.38s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9397, 'compress@10': 0.6291, 'time@10': 7.9387}:  50%|█████     | 5/10 [00:36<00:26,  5.38s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9397, 'compress@10': 0.6291, 'time@10': 7.9387}:  60%|██████    | 6/10 [00:36<00:27,  6.94s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.937, 'compress@10': 0.6016, 'time@10': 8.3733}:  60%|██████    | 6/10 [00:41<00:27,  6.94s/it] {'epoch': 36, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.937, 'compress@10': 0.6016, 'time@10': 8.3733}:  70%|███████   | 7/10 [00:41<00:19,  6.48s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9364, 'compress@10': 0.5572, 'time@10': 8.2739}:  70%|███████   | 7/10 [00:49<00:19,  6.48s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9364, 'compress@10': 0.5572, 'time@10': 8.2739}:  80%|████████  | 8/10 [00:49<00:13,  6.84s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9375, 'compress@10': 0.5548, 'time@10': 8.9153}:  80%|████████  | 8/10 [00:56<00:13,  6.84s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9375, 'compress@10': 0.5548, 'time@10': 8.9153}:  90%|█████████ | 9/10 [00:56<00:06,  6.91s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9389, 'compress@10': 0.5209, 'time@10': 8.9626}:  90%|█████████ | 9/10 [01:05<00:06,  6.91s/it]     {'epoch': 36, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9389, 'compress@10': 0.5209, 'time@10': 8.9626}: 100%|██████████| 10/10 [01:05<00:00,  7.69s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9389, 'compress@10': 0.5209, 'time@10': 8.9626}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.014643671585281579
Avg hit ratio: 0.8899925596003694
Avg ndcg: 0.938911337315238
Avg compression ratio: 0.5208765074349493
Avg train time: 8.962568783760071
Std train time: 2.4923830594845833
[0.85, 0.35, 0.03421052631578945, 0.6657894736842103, 0.9552631578947366, 0.6921052631578948, 0.42894736842105263, 0.21842105263157896, 0.5342105263157896, 0.21842105263157896]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8579, 'time@10': 8.1988}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8579, 'time@10': 8.1988}:  10%|█         | 1/10 [00:04<00:37,  4.14s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9453, 'compress@10': 0.6144, 'time@10': 7.5083}:  10%|█         | 1/10 [00:10<00:37,  4.14s/it]  {'epoch': 37, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9453, 'compress@10': 0.6144, 'time@10': 7.5083}:  20%|██        | 2/10 [00:10<00:45,  5.74s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9159, 'compress@10': 0.467, 'time@10': 6.8433}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9159, 'compress@10': 0.467, 'time@10': 6.8433}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9414, 'compress@10': 0.5197, 'time@10': 6.8189}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8304, 'ndcg@10': 0.9414, 'compress@10': 0.5197, 'time@10': 6.8189}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9395, 'compress@10': 0.607, 'time@10': 7.7259}:  40%|████      | 4/10 [00:26<00:32,  5.34s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.9395, 'compress@10': 0.607, 'time@10': 7.7259}:  50%|█████     | 5/10 [00:26<00:27,  5.47s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9437, 'compress@10': 0.6223, 'time@10': 8.118}:  50%|█████     | 5/10 [00:36<00:27,  5.47s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0133, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9437, 'compress@10': 0.6223, 'time@10': 8.118}:  60%|██████    | 6/10 [00:36<00:28,  7.05s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9445, 'compress@10': 0.5979, 'time@10': 8.5109}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9445, 'compress@10': 0.5979, 'time@10': 8.5109}:  70%|███████   | 7/10 [00:41<00:19,  6.54s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9444, 'compress@10': 0.5533, 'time@10': 8.3863}:  70%|███████   | 7/10 [00:49<00:19,  6.54s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9444, 'compress@10': 0.5533, 'time@10': 8.3863}:  80%|████████  | 8/10 [00:49<00:13,  6.86s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9475, 'compress@10': 0.5527, 'time@10': 9.0446}:  80%|████████  | 8/10 [00:56<00:13,  6.86s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9475, 'compress@10': 0.5527, 'time@10': 9.0446}:  90%|█████████ | 9/10 [00:56<00:06,  6.97s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9503, 'compress@10': 0.521, 'time@10': 9.1087}:  90%|█████████ | 9/10 [01:06<00:06,  6.97s/it]    {'epoch': 37, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9503, 'compress@10': 0.521, 'time@10': 9.1087}: 100%|██████████| 10/10 [01:06<00:00,  7.82s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9503, 'compress@10': 0.521, 'time@10': 9.1087}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.012905976773080374
Avg hit ratio: 0.8966049238443127
Avg ndcg: 0.9503432158392944
Avg compression ratio: 0.5210093436716992
Avg train time: 9.108734393119812
Std train time: 2.5218725416786723
[0.8538461538461538, 0.341025641025641, 0.033333333333333305, 0.6743589743589741, 0.9307692307692306, 0.7000000000000001, 0.41794871794871796, 0.23846153846153847, 0.5461538461538462, 0.21282051282051284]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8615, 'time@10': 8.0121}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8615, 'time@10': 8.0121}:  10%|█         | 1/10 [00:04<00:36,  4.05s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 0.6119, 'time@10': 7.4512}:  10%|█         | 1/10 [00:10<00:36,  4.05s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 0.6119, 'time@10': 7.4512}:  20%|██        | 2/10 [00:10<00:45,  5.74s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9159, 'compress@10': 0.4651, 'time@10': 6.798}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9159, 'compress@10': 0.4651, 'time@10': 6.798}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.928, 'compress@10': 0.5203, 'time@10': 6.7991}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.928, 'compress@10': 0.5203, 'time@10': 6.7991}:  40%|████      | 4/10 [00:20<00:32,  5.36s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9291, 'compress@10': 0.6027, 'time@10': 7.638}:  40%|████      | 4/10 [00:26<00:32,  5.36s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9291, 'compress@10': 0.6027, 'time@10': 7.638}:  50%|█████     | 5/10 [00:26<00:27,  5.42s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0081, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9368, 'compress@10': 0.62, 'time@10': 8.0199}:  50%|█████     | 5/10 [00:36<00:27,  5.42s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0081, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9368, 'compress@10': 0.62, 'time@10': 8.0199}:  60%|██████    | 6/10 [00:36<00:27,  6.97s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9388, 'compress@10': 0.5945, 'time@10': 8.4481}:  60%|██████    | 6/10 [00:41<00:27,  6.97s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9388, 'compress@10': 0.5945, 'time@10': 8.4481}:  70%|███████   | 7/10 [00:41<00:19,  6.50s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9426, 'compress@10': 0.5527, 'time@10': 8.3488}:  70%|███████   | 7/10 [00:49<00:19,  6.50s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.0078, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9426, 'compress@10': 0.5527, 'time@10': 8.3488}:  80%|████████  | 8/10 [00:49<00:13,  6.88s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9347, 'compress@10': 0.5534, 'time@10': 8.9724}:  80%|████████  | 8/10 [00:56<00:13,  6.88s/it] {'epoch': 38, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9347, 'compress@10': 0.5534, 'time@10': 8.9724}:  90%|█████████ | 9/10 [00:56<00:06,  6.93s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9382, 'compress@10': 0.5211, 'time@10': 9.0301}:  90%|█████████ | 9/10 [01:05<00:06,  6.93s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9382, 'compress@10': 0.5211, 'time@10': 9.0301}: 100%|██████████| 10/10 [01:05<00:00,  7.75s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.9077, 'ndcg@10': 0.9382, 'compress@10': 0.5211, 'time@10': 9.0301}: 100%|██████████| 10/10 [01:05<00:00,  6.60s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.012524220327993048
Avg hit ratio: 0.9076878731530684
Avg ndcg: 0.9381751277868965
Avg compression ratio: 0.5211322308514906
Avg train time: 9.030119466781617
Std train time: 2.4121931791435847
[0.8574999999999999, 0.33249999999999996, 0.03249999999999997, 0.6574999999999998, 0.9324999999999998, 0.6825000000000001, 0.4325, 0.2325, 0.5575000000000001, 0.2325]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.865, 'time@10': 7.8545}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.865, 'time@10': 7.8545}:  10%|█         | 1/10 [00:03<00:35,  3.97s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9453, 'compress@10': 0.6095, 'time@10': 7.3714}:  10%|█         | 1/10 [00:10<00:35,  3.97s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9453, 'compress@10': 0.6095, 'time@10': 7.3714}:  20%|██        | 2/10 [00:10<00:45,  5.71s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9159, 'compress@10': 0.4632, 'time@10': 6.7941}:  20%|██        | 2/10 [00:13<00:45,  5.71s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9159, 'compress@10': 0.4632, 'time@10': 6.7941}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9275, 'compress@10': 0.5149, 'time@10': 6.8143}:  30%|███       | 3/10 [00:20<00:30,  4.40s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9275, 'compress@10': 0.5149, 'time@10': 6.8143}:  40%|████      | 4/10 [00:20<00:32,  5.39s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0075, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9308, 'compress@10': 0.5987, 'time@10': 7.6786}:  40%|████      | 4/10 [00:26<00:32,  5.39s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0075, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9308, 'compress@10': 0.5987, 'time@10': 7.6786}:  50%|█████     | 5/10 [00:26<00:27,  5.47s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9404, 'compress@10': 0.6138, 'time@10': 8.0885}:  50%|█████     | 5/10 [00:36<00:27,  5.47s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9404, 'compress@10': 0.6138, 'time@10': 8.0885}:  60%|██████    | 6/10 [00:36<00:28,  7.07s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.942, 'compress@10': 0.5911, 'time@10': 8.534}:  60%|██████    | 6/10 [00:42<00:28,  7.07s/it]  {'epoch': 39, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.942, 'compress@10': 0.5911, 'time@10': 8.534}:  70%|███████   | 7/10 [00:42<00:19,  6.61s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9436, 'compress@10': 0.5491, 'time@10': 8.4562}:  70%|███████   | 7/10 [00:50<00:19,  6.61s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9436, 'compress@10': 0.5491, 'time@10': 8.4562}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9464, 'compress@10': 0.5514, 'time@10': 9.1447}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9464, 'compress@10': 0.5514, 'time@10': 9.1447}:  90%|█████████ | 9/10 [00:57<00:07,  7.15s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9494, 'compress@10': 0.5213, 'time@10': 9.1909}:  90%|█████████ | 9/10 [01:07<00:07,  7.15s/it] {'epoch': 39, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9494, 'compress@10': 0.5213, 'time@10': 9.1909}: 100%|██████████| 10/10 [01:07<00:00,  7.92s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9494, 'compress@10': 0.5213, 'time@10': 9.1909}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.009390870020948114
Avg hit ratio: 0.9101763524157412
Avg ndcg: 0.9494233698526637
Avg compression ratio: 0.5212567218187154
Avg train time: 9.19093589782715
Std train time: 2.5582415787932757
[0.8609756097560974, 0.324390243902439, 0.031707317073170704, 0.6414634146341461, 0.9341463414634145, 0.6902439024390244, 0.44634146341463415, 0.25121951219512195, 0.5439024390243904, 0.22682926829268293]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8683, 'time@10': 8.1402}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8683, 'time@10': 8.1402}:  10%|█         | 1/10 [00:04<00:36,  4.11s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.893, 'ndcg@10': 0.946, 'compress@10': 0.6072, 'time@10': 7.5325}:  10%|█         | 1/10 [00:11<00:36,  4.11s/it]  {'epoch': 40, 'num_users': 7.0, 'loss': 0.0123, 'hit_ratio@10': 0.893, 'ndcg@10': 0.946, 'compress@10': 0.6072, 'time@10': 7.5325}:  20%|██        | 2/10 [00:11<00:46,  5.79s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9164, 'compress@10': 0.4615, 'time@10': 6.8138}:  20%|██        | 2/10 [00:13<00:46,  5.79s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9164, 'compress@10': 0.4615, 'time@10': 6.8138}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.953, 'compress@10': 0.5097, 'time@10': 6.8083}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it]  {'epoch': 40, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.953, 'compress@10': 0.5097, 'time@10': 6.8083}:  40%|████      | 4/10 [00:20<00:32,  5.35s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9515, 'compress@10': 0.5948, 'time@10': 7.6593}:  40%|████      | 4/10 [00:26<00:32,  5.35s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9515, 'compress@10': 0.5948, 'time@10': 7.6593}:  50%|█████     | 5/10 [00:26<00:27,  5.43s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9556, 'compress@10': 0.6119, 'time@10': 8.0807}:  50%|█████     | 5/10 [00:36<00:27,  5.43s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9556, 'compress@10': 0.6119, 'time@10': 8.0807}:  60%|██████    | 6/10 [00:36<00:28,  7.06s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9539, 'compress@10': 0.5914, 'time@10': 8.4737}:  60%|██████    | 6/10 [00:41<00:28,  7.06s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9539, 'compress@10': 0.5914, 'time@10': 8.4737}:  70%|███████   | 7/10 [00:41<00:19,  6.53s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9515, 'compress@10': 0.5516, 'time@10': 8.3836}:  70%|███████   | 7/10 [00:49<00:19,  6.53s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 0.0141, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9515, 'compress@10': 0.5516, 'time@10': 8.3836}:  80%|████████  | 8/10 [00:49<00:13,  6.93s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9528, 'compress@10': 0.5522, 'time@10': 9.0125}:  80%|████████  | 8/10 [00:56<00:13,  6.93s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.89, 'ndcg@10': 0.9528, 'compress@10': 0.5522, 'time@10': 9.0125}:  90%|█████████ | 9/10 [00:56<00:06,  6.97s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9551, 'compress@10': 0.5214, 'time@10': 9.0882}:  90%|█████████ | 9/10 [01:06<00:06,  6.97s/it] {'epoch': 40, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9551, 'compress@10': 0.5214, 'time@10': 9.0882}: 100%|██████████| 10/10 [01:06<00:00,  7.85s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9551, 'compress@10': 0.5214, 'time@10': 9.0882}: 100%|██████████| 10/10 [01:06<00:00,  6.65s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.013149739897268888
Avg hit ratio: 0.8987477809871697
Avg ndcg: 0.9550611389730197
Avg compression ratio: 0.5213769412705239
Avg train time: 9.088185429573059
Std train time: 2.440992485220696
[0.8642857142857142, 0.3166666666666666, 0.030952380952380926, 0.6499999999999998, 0.9357142857142855, 0.6738095238095239, 0.45952380952380956, 0.26904761904761904, 0.5309523809523811, 0.22142857142857145]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8714, 'time@10': 7.691}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8714, 'time@10': 7.691}:  10%|█         | 1/10 [00:03<00:34,  3.88s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9467, 'compress@10': 0.6051, 'time@10': 7.2417}:  10%|█         | 1/10 [00:10<00:34,  3.88s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9467, 'compress@10': 0.6051, 'time@10': 7.2417}:  20%|██        | 2/10 [00:10<00:44,  5.62s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9169, 'compress@10': 0.4598, 'time@10': 6.7092}:  20%|██        | 2/10 [00:13<00:44,  5.62s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9169, 'compress@10': 0.4598, 'time@10': 6.7092}:  30%|███       | 3/10 [00:13<00:30,  4.36s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9326, 'compress@10': 0.5105, 'time@10': 6.7541}:  30%|███       | 3/10 [00:20<00:30,  4.36s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9326, 'compress@10': 0.5105, 'time@10': 6.7541}:  40%|████      | 4/10 [00:20<00:32,  5.37s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9362, 'compress@10': 0.5958, 'time@10': 7.6358}:  40%|████      | 4/10 [00:26<00:32,  5.37s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9362, 'compress@10': 0.5958, 'time@10': 7.6358}:  50%|█████     | 5/10 [00:26<00:27,  5.46s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9421, 'compress@10': 0.61, 'time@10': 8.042}:  50%|█████     | 5/10 [00:36<00:27,  5.46s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9421, 'compress@10': 0.61, 'time@10': 8.042}:  60%|██████    | 6/10 [00:36<00:28,  7.04s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9438, 'compress@10': 0.5916, 'time@10': 8.4767}:  60%|██████    | 6/10 [00:41<00:28,  7.04s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.012, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9438, 'compress@10': 0.5916, 'time@10': 8.4767}:  70%|███████   | 7/10 [00:41<00:19,  6.56s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9472, 'compress@10': 0.5539, 'time@10': 8.3676}:  70%|███████   | 7/10 [00:49<00:19,  6.56s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9472, 'compress@10': 0.5539, 'time@10': 8.3676}:  80%|████████  | 8/10 [00:49<00:13,  6.91s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9496, 'compress@10': 0.5528, 'time@10': 8.9965}:  80%|████████  | 8/10 [00:56<00:13,  6.91s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0127, 'hit_ratio@10': 0.8784, 'ndcg@10': 0.9496, 'compress@10': 0.5528, 'time@10': 8.9965}:  90%|█████████ | 9/10 [00:56<00:06,  6.95s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9553, 'compress@10': 0.5215, 'time@10': 9.0504}:  90%|█████████ | 9/10 [01:06<00:06,  6.95s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9553, 'compress@10': 0.5215, 'time@10': 9.0504}: 100%|██████████| 10/10 [01:06<00:00,  7.76s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9553, 'compress@10': 0.5215, 'time@10': 9.0504}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.014066588626879312
Avg hit ratio: 0.8883227937879891
Avg ndcg: 0.9552914954835654
Avg compression ratio: 0.5214599584828173
Avg train time: 9.050351309776307
Std train time: 2.4488483863505315
[0.8674418604651162, 0.30930232558139525, 0.03023255813953486, 0.6581395348837208, 0.9139534883720928, 0.6813953488372093, 0.4488372093023256, 0.2627906976744186, 0.5418604651162792, 0.23953488372093024]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8744, 'time@10': 7.9324}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8744, 'time@10': 7.9324}:  10%|█         | 1/10 [00:04<00:36,  4.00s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9453, 'compress@10': 0.603, 'time@10': 7.3516}:  10%|█         | 1/10 [00:10<00:36,  4.00s/it]  {'epoch': 42, 'num_users': 7.0, 'loss': 0.008, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9453, 'compress@10': 0.603, 'time@10': 7.3516}:  20%|██        | 2/10 [00:10<00:45,  5.65s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9159, 'compress@10': 0.4583, 'time@10': 6.7404}:  20%|██        | 2/10 [00:13<00:45,  5.65s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0053, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9159, 'compress@10': 0.4583, 'time@10': 6.7404}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9275, 'compress@10': 0.5113, 'time@10': 6.7565}:  30%|███       | 3/10 [00:20<00:30,  4.35s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9275, 'compress@10': 0.5113, 'time@10': 6.7565}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0068, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9331, 'compress@10': 0.5922, 'time@10': 7.8104}:  40%|████      | 4/10 [00:26<00:31,  5.33s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0068, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9331, 'compress@10': 0.5922, 'time@10': 7.8104}:  50%|█████     | 5/10 [00:26<00:27,  5.59s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0064, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9401, 'compress@10': 0.6082, 'time@10': 8.217}:  50%|█████     | 5/10 [00:36<00:27,  5.59s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0064, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9401, 'compress@10': 0.6082, 'time@10': 8.217}:  60%|██████    | 6/10 [00:36<00:28,  7.19s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.942, 'compress@10': 0.5886, 'time@10': 8.6151}:  60%|██████    | 6/10 [00:42<00:28,  7.19s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0073, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.942, 'compress@10': 0.5886, 'time@10': 8.6151}:  70%|███████   | 7/10 [00:42<00:19,  6.65s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0077, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9445, 'compress@10': 0.5505, 'time@10': 8.4847}:  70%|███████   | 7/10 [00:49<00:19,  6.65s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0077, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9445, 'compress@10': 0.5505, 'time@10': 8.4847}:  80%|████████  | 8/10 [00:49<00:13,  6.95s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9372, 'compress@10': 0.551, 'time@10': 9.1057}:  80%|████████  | 8/10 [00:57<00:13,  6.95s/it]  {'epoch': 42, 'num_users': 6.3333, 'loss': 0.01, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9372, 'compress@10': 0.551, 'time@10': 9.1057}:  90%|█████████ | 9/10 [00:57<00:06,  6.99s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9407, 'compress@10': 0.5216, 'time@10': 9.1635}:  90%|█████████ | 9/10 [01:06<00:06,  6.99s/it] {'epoch': 42, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9407, 'compress@10': 0.5216, 'time@10': 9.1635}: 100%|██████████| 10/10 [01:06<00:00,  7.83s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9407, 'compress@10': 0.5216, 'time@10': 9.1635}: 100%|██████████| 10/10 [01:06<00:00,  6.67s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.010199217820392122
Avg hit ratio: 0.8969966289134371
Avg ndcg: 0.9407159339094097
Avg compression ratio: 0.5215742303341581
Avg train time: 9.163539576530457
Std train time: 2.564600774354445
[0.8704545454545454, 0.3022727272727272, 0.02954545454545452, 0.6431818181818181, 0.9159090909090907, 0.6659090909090909, 0.4613636363636364, 0.25681818181818183, 0.5522727272727274, 0.25681818181818183]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8773, 'time@10': 8.0031}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.8773, 'time@10': 8.0031}:  10%|█         | 1/10 [00:04<00:36,  4.06s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 0.601, 'time@10': 7.375}:  10%|█         | 1/10 [00:10<00:36,  4.06s/it]  {'epoch': 43, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 0.601, 'time@10': 7.375}:  20%|██        | 2/10 [00:10<00:45,  5.66s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9159, 'compress@10': 0.4567, 'time@10': 6.7456}:  20%|██        | 2/10 [00:13<00:45,  5.66s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9159, 'compress@10': 0.4567, 'time@10': 6.7456}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9305, 'compress@10': 0.5065, 'time@10': 6.7071}:  30%|███       | 3/10 [00:20<00:30,  4.35s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9305, 'compress@10': 0.5065, 'time@10': 6.7071}:  40%|████      | 4/10 [00:20<00:31,  5.25s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9355, 'compress@10': 0.5887, 'time@10': 7.8222}:  40%|████      | 4/10 [00:26<00:31,  5.25s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9355, 'compress@10': 0.5887, 'time@10': 7.8222}:  50%|█████     | 5/10 [00:26<00:27,  5.58s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9443, 'compress@10': 0.6028, 'time@10': 8.1988}:  50%|█████     | 5/10 [00:36<00:27,  5.58s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9443, 'compress@10': 0.6028, 'time@10': 8.1988}:  60%|██████    | 6/10 [00:36<00:28,  7.12s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0109, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9444, 'compress@10': 0.5857, 'time@10': 8.5795}:  60%|██████    | 6/10 [00:42<00:28,  7.12s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0109, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9444, 'compress@10': 0.5857, 'time@10': 8.5795}:  70%|███████   | 7/10 [00:42<00:19,  6.58s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9462, 'compress@10': 0.5473, 'time@10': 8.4524}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0108, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9462, 'compress@10': 0.5473, 'time@10': 8.4524}:  80%|████████  | 8/10 [00:49<00:13,  6.91s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9485, 'compress@10': 0.5492, 'time@10': 9.0752}:  80%|████████  | 8/10 [00:56<00:13,  6.91s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9485, 'compress@10': 0.5492, 'time@10': 9.0752}:  90%|█████████ | 9/10 [00:56<00:06,  6.96s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0098, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9514, 'compress@10': 0.5217, 'time@10': 9.112}:  90%|█████████ | 9/10 [01:06<00:06,  6.96s/it]    {'epoch': 43, 'num_users': 6.3, 'loss': 0.0098, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9514, 'compress@10': 0.5217, 'time@10': 9.112}: 100%|██████████| 10/10 [01:06<00:00,  7.73s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0098, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9514, 'compress@10': 0.5217, 'time@10': 9.112}: 100%|██████████| 10/10 [01:06<00:00,  6.62s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.009756139741232184
Avg hit ratio: 0.8934021588673542
Avg ndcg: 0.9513572815499204
Avg compression ratio: 0.521678969134326
Avg train time: 9.112030005455017
Std train time: 2.595142306503094
[0.8733333333333333, 0.29555555555555546, 0.028888888888888863, 0.651111111111111, 0.9177777777777776, 0.6733333333333333, 0.4733333333333334, 0.2511111111111111, 0.54, 0.2511111111111111]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9255, 'compress@10': 0.88, 'time@10': 8.1723}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9255, 'compress@10': 0.88, 'time@10': 8.1723}:  10%|█         | 1/10 [00:04<00:37,  4.12s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9558, 'compress@10': 0.5991, 'time@10': 7.5137}:  10%|█         | 1/10 [00:11<00:37,  4.12s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9558, 'compress@10': 0.5991, 'time@10': 7.5137}:  20%|██        | 2/10 [00:11<00:46,  5.75s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9229, 'compress@10': 0.4553, 'time@10': 6.8647}:  20%|██        | 2/10 [00:13<00:46,  5.75s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9229, 'compress@10': 0.4553, 'time@10': 6.8647}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9333, 'compress@10': 0.5074, 'time@10': 6.8307}:  30%|███       | 3/10 [00:20<00:30,  4.41s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9333, 'compress@10': 0.5074, 'time@10': 6.8307}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9379, 'compress@10': 0.5898, 'time@10': 7.8968}:  40%|████      | 4/10 [00:26<00:32,  5.34s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0085, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9379, 'compress@10': 0.5898, 'time@10': 7.8968}:  50%|█████     | 5/10 [00:26<00:28,  5.62s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9438, 'compress@10': 0.6049, 'time@10': 8.2582}:  50%|█████     | 5/10 [00:36<00:28,  5.62s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9438, 'compress@10': 0.6049, 'time@10': 8.2582}:  60%|██████    | 6/10 [00:36<00:28,  7.14s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9457, 'compress@10': 0.5891, 'time@10': 8.64}:  60%|██████    | 6/10 [00:42<00:28,  7.14s/it]  {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9457, 'compress@10': 0.5891, 'time@10': 8.64}:  70%|███████   | 7/10 [00:42<00:19,  6.61s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0079, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9486, 'compress@10': 0.5495, 'time@10': 8.5196}:  70%|███████   | 7/10 [00:50<00:19,  6.61s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0079, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9486, 'compress@10': 0.5495, 'time@10': 8.5196}:  80%|████████  | 8/10 [00:50<00:13,  6.96s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0076, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9505, 'compress@10': 0.5499, 'time@10': 9.1246}:  80%|████████  | 8/10 [00:57<00:13,  6.96s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0076, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9505, 'compress@10': 0.5499, 'time@10': 9.1246}:  90%|█████████ | 9/10 [00:57<00:06,  6.98s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9552, 'compress@10': 0.5218, 'time@10': 9.1641}:  90%|█████████ | 9/10 [01:06<00:06,  6.98s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9552, 'compress@10': 0.5218, 'time@10': 9.1641}: 100%|██████████| 10/10 [01:06<00:00,  7.77s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9552, 'compress@10': 0.5218, 'time@10': 9.1641}: 100%|██████████| 10/10 [01:06<00:00,  6.66s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.010134259180768804
Avg hit ratio: 0.8901763524157411
Avg ndcg: 0.9552118624507878
Avg compression ratio: 0.5217635033037542
Avg train time: 9.164125418663025
Std train time: 2.519794631147119
[0.8760869565217391, 0.31086956521739123, 0.028260869565217367, 0.6369565217391303, 0.9195652173913041, 0.6804347826086956, 0.4630434782608696, 0.24565217391304348, 0.5282608695652175, 0.2673913043478261]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.8826, 'time@10': 8.003}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.8826, 'time@10': 8.003}:  10%|█         | 1/10 [00:04<00:36,  4.04s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9513, 'compress@10': 0.6079, 'time@10': 7.4389}:  10%|█         | 1/10 [00:10<00:36,  4.04s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9513, 'compress@10': 0.6079, 'time@10': 7.4389}:  20%|██        | 2/10 [00:10<00:45,  5.73s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9199, 'compress@10': 0.4609, 'time@10': 6.8042}:  20%|██        | 2/10 [00:13<00:45,  5.73s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9199, 'compress@10': 0.4609, 'time@10': 6.8042}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.931, 'compress@10': 0.5082, 'time@10': 6.8472}:  30%|███       | 3/10 [00:20<00:30,  4.39s/it] {'epoch': 45, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.931, 'compress@10': 0.5082, 'time@10': 6.8472}:  40%|████      | 4/10 [00:20<00:32,  5.43s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9362, 'compress@10': 0.5908, 'time@10': 7.901}:  40%|████      | 4/10 [00:26<00:32,  5.43s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9362, 'compress@10': 0.5908, 'time@10': 7.901}:  50%|█████     | 5/10 [00:26<00:28,  5.67s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9434, 'compress@10': 0.6069, 'time@10': 8.3061}:  50%|█████     | 5/10 [00:37<00:28,  5.67s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9434, 'compress@10': 0.6069, 'time@10': 8.3061}:  60%|██████    | 6/10 [00:37<00:29,  7.27s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9455, 'compress@10': 0.5894, 'time@10': 8.7206}:  60%|██████    | 6/10 [00:42<00:29,  7.27s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9455, 'compress@10': 0.5894, 'time@10': 8.7206}:  70%|███████   | 7/10 [00:42<00:20,  6.74s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9484, 'compress@10': 0.5491, 'time@10': 8.5902}:  70%|███████   | 7/10 [00:50<00:20,  6.74s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9484, 'compress@10': 0.5491, 'time@10': 8.5902}:  80%|████████  | 8/10 [00:50<00:14,  7.05s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9522, 'compress@10': 0.5483, 'time@10': 9.1981}:  80%|████████  | 8/10 [00:57<00:14,  7.05s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9522, 'compress@10': 0.5483, 'time@10': 9.1981}:  90%|█████████ | 9/10 [00:57<00:07,  7.06s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9544, 'compress@10': 0.5219, 'time@10': 9.2215}:  90%|█████████ | 9/10 [01:07<00:07,  7.06s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9544, 'compress@10': 0.5219, 'time@10': 9.2215}: 100%|██████████| 10/10 [01:07<00:00,  7.80s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9544, 'compress@10': 0.5219, 'time@10': 9.2215}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.010489276139218956
Avg hit ratio: 0.891259301724497
Avg ndcg: 0.9544314289454625
Avg compression ratio: 0.5218894113955861
Avg train time: 9.221500635147095
Std train time: 2.549953415623808
[0.8787234042553191, 0.3042553191489361, 0.027659574468085084, 0.6234042553191488, 0.9212765957446807, 0.6872340425531914, 0.45319148936170217, 0.2404255319148936, 0.5382978723404256, 0.28297872340425534]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.8851, 'time@10': 7.7097}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9276, 'compress@10': 0.8851, 'time@10': 7.7097}:  10%|█         | 1/10 [00:03<00:35,  3.89s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0055, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9477, 'compress@10': 0.6059, 'time@10': 7.2548}:  10%|█         | 1/10 [00:10<00:35,  3.89s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0055, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9477, 'compress@10': 0.6059, 'time@10': 7.2548}:  20%|██        | 2/10 [00:10<00:44,  5.62s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9175, 'compress@10': 0.4595, 'time@10': 6.6469}:  20%|██        | 2/10 [00:13<00:44,  5.62s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9175, 'compress@10': 0.4595, 'time@10': 6.6469}:  30%|███       | 3/10 [00:13<00:30,  4.31s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9686, 'compress@10': 0.5038, 'time@10': 6.6435}:  30%|███       | 3/10 [00:20<00:30,  4.31s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8457, 'ndcg@10': 0.9686, 'compress@10': 0.5038, 'time@10': 6.6435}:  40%|████      | 4/10 [00:20<00:31,  5.26s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9667, 'compress@10': 0.5876, 'time@10': 7.7632}:  40%|████      | 4/10 [00:26<00:31,  5.26s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9667, 'compress@10': 0.5876, 'time@10': 7.7632}:  50%|█████     | 5/10 [00:26<00:27,  5.59s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9682, 'compress@10': 0.6054, 'time@10': 8.1359}:  50%|█████     | 5/10 [00:36<00:27,  5.59s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.01, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9682, 'compress@10': 0.6054, 'time@10': 8.1359}:  60%|██████    | 6/10 [00:36<00:28,  7.11s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9689, 'compress@10': 0.5868, 'time@10': 8.5294}:  60%|██████    | 6/10 [00:41<00:28,  7.11s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9689, 'compress@10': 0.5868, 'time@10': 8.5294}:  70%|███████   | 7/10 [00:41<00:19,  6.58s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.969, 'compress@10': 0.5462, 'time@10': 8.4088}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.969, 'compress@10': 0.5462, 'time@10': 8.4088}:  80%|████████  | 8/10 [00:49<00:13,  6.90s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.959, 'compress@10': 0.5468, 'time@10': 9.0225}:  80%|████████  | 8/10 [00:56<00:13,  6.90s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.959, 'compress@10': 0.5468, 'time@10': 9.0225}:  90%|█████████ | 9/10 [00:56<00:06,  6.93s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9608, 'compress@10': 0.522, 'time@10': 9.0744}:  90%|█████████ | 9/10 [01:06<00:06,  6.93s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9608, 'compress@10': 0.522, 'time@10': 9.0744}: 100%|██████████| 10/10 [01:06<00:00,  7.75s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.8999, 'ndcg@10': 0.9608, 'compress@10': 0.522, 'time@10': 9.0744}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.013128963548895308
Avg hit ratio: 0.8998537717705799
Avg ndcg: 0.960812196796455
Avg compression ratio: 0.5220195811643455
Avg train time: 9.074435448646545
Std train time: 2.5798022568691805
[0.88125, 0.2979166666666666, 0.02708333333333331, 0.6312499999999999, 0.9229166666666665, 0.6729166666666666, 0.46458333333333335, 0.23541666666666666, 0.5479166666666667, 0.27708333333333335]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9302, 'compress@10': 0.8875, 'time@10': 7.8887}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9302, 'compress@10': 0.8875, 'time@10': 7.8887}:  10%|█         | 1/10 [00:03<00:35,  3.98s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.949, 'compress@10': 0.604, 'time@10': 7.3799}:  10%|█         | 1/10 [00:10<00:35,  3.98s/it]  {'epoch': 47, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.949, 'compress@10': 0.604, 'time@10': 7.3799}:  20%|██        | 2/10 [00:10<00:45,  5.70s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9184, 'compress@10': 0.458, 'time@10': 6.8418}:  20%|██        | 2/10 [00:13<00:45,  5.70s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9184, 'compress@10': 0.458, 'time@10': 6.8418}:  30%|███       | 3/10 [00:13<00:31,  4.43s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9298, 'compress@10': 0.5046, 'time@10': 6.8592}:  30%|███       | 3/10 [00:20<00:31,  4.43s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9298, 'compress@10': 0.5046, 'time@10': 6.8592}:  40%|████      | 4/10 [00:20<00:32,  5.42s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9359, 'compress@10': 0.5886, 'time@10': 7.9014}:  40%|████      | 4/10 [00:26<00:32,  5.42s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9359, 'compress@10': 0.5886, 'time@10': 7.9014}:  50%|█████     | 5/10 [00:26<00:28,  5.66s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9427, 'compress@10': 0.6039, 'time@10': 8.3196}:  50%|█████     | 5/10 [00:37<00:28,  5.66s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9427, 'compress@10': 0.6039, 'time@10': 8.3196}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9463, 'compress@10': 0.587, 'time@10': 8.6984}:  60%|██████    | 6/10 [00:42<00:29,  7.29s/it] {'epoch': 47, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9463, 'compress@10': 0.587, 'time@10': 8.6984}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9492, 'compress@10': 0.5458, 'time@10': 8.5641}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9492, 'compress@10': 0.5458, 'time@10': 8.5641}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.951, 'compress@10': 0.5475, 'time@10': 9.1792}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.951, 'compress@10': 0.5475, 'time@10': 9.1792}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.952, 'compress@10': 0.5221, 'time@10': 9.2217}:  90%|█████████ | 9/10 [01:07<00:07,  7.04s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.952, 'compress@10': 0.5221, 'time@10': 9.2217}: 100%|██████████| 10/10 [01:07<00:00,  7.84s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.952, 'compress@10': 0.5221, 'time@10': 9.2217}: 100%|██████████| 10/10 [01:07<00:00,  6.72s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.012571903924149854
Avg hit ratio: 0.896259301724497
Avg ndcg: 0.9520144564928781
Avg compression ratio: 0.5220772352690473
Avg train time: 9.221718215942383
Std train time: 2.5233300552042377
[0.863265306122449, 0.31224489795918364, 0.026530612244897937, 0.6183673469387754, 0.9244897959183672, 0.6795918367346938, 0.4755102040816327, 0.23061224489795917, 0.536734693877551, 0.29183673469387755]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.8704, 'time@10': 7.8941}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.8704, 'time@10': 7.8941}:  10%|█         | 1/10 [00:03<00:35,  3.98s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9603, 'compress@10': 0.6024, 'time@10': 7.34}:  10%|█         | 1/10 [00:10<00:35,  3.98s/it]  {'epoch': 48, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9603, 'compress@10': 0.6024, 'time@10': 7.34}:  20%|██        | 2/10 [00:10<00:45,  5.65s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9259, 'compress@10': 0.4568, 'time@10': 6.6964}:  20%|██        | 2/10 [00:13<00:45,  5.65s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9259, 'compress@10': 0.4568, 'time@10': 6.6964}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9355, 'compress@10': 0.5006, 'time@10': 6.7512}:  30%|███       | 3/10 [00:20<00:30,  4.32s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9355, 'compress@10': 0.5006, 'time@10': 6.7512}:  40%|████      | 4/10 [00:20<00:32,  5.36s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0077, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9409, 'compress@10': 0.5857, 'time@10': 7.5833}:  40%|████      | 4/10 [00:25<00:32,  5.36s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0077, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.9409, 'compress@10': 0.5857, 'time@10': 7.5833}:  50%|█████     | 5/10 [00:25<00:27,  5.41s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0072, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9468, 'compress@10': 0.6025, 'time@10': 7.978}:  50%|█████     | 5/10 [00:35<00:27,  5.41s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0072, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9468, 'compress@10': 0.6025, 'time@10': 7.978}:  60%|██████    | 6/10 [00:35<00:27,  6.97s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9482, 'compress@10': 0.5874, 'time@10': 8.4105}:  60%|██████    | 6/10 [00:41<00:27,  6.97s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9482, 'compress@10': 0.5874, 'time@10': 8.4105}:  70%|███████   | 7/10 [00:41<00:19,  6.50s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0077, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9506, 'compress@10': 0.5455, 'time@10': 8.3148}:  70%|███████   | 7/10 [00:49<00:19,  6.50s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0077, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9506, 'compress@10': 0.5455, 'time@10': 8.3148}:  80%|████████  | 8/10 [00:49<00:13,  6.88s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0078, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.952, 'compress@10': 0.546, 'time@10': 8.9524}:  80%|████████  | 8/10 [00:56<00:13,  6.88s/it] {'epoch': 48, 'num_users': 6.3333, 'loss': 0.0078, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.952, 'compress@10': 0.546, 'time@10': 8.9524}:  90%|█████████ | 9/10 [00:56<00:06,  6.93s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0087, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9592, 'compress@10': 0.5222, 'time@10': 9.0167}:  90%|█████████ | 9/10 [01:05<00:06,  6.93s/it] {'epoch': 48, 'num_users': 6.3, 'loss': 0.0087, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9592, 'compress@10': 0.5222, 'time@10': 9.0167}: 100%|██████████| 10/10 [01:05<00:00,  7.77s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0087, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9592, 'compress@10': 0.5222, 'time@10': 9.0167}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.008656996450379716
Avg hit ratio: 0.8926878731530683
Avg ndcg: 0.9591517167410227
Avg compression ratio: 0.5222164741578583
Avg train time: 9.016660809516907
Std train time: 2.442716594188378
[0.866, 0.32599999999999996, 0.025999999999999978, 0.6059999999999999, 0.9259999999999998, 0.6659999999999999, 0.48600000000000004, 0.22599999999999998, 0.526, 0.306]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.873, 'time@10': 7.9969}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.873, 'time@10': 7.9969}:  10%|█         | 1/10 [00:04<00:36,  4.04s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0055, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9506, 'compress@10': 0.6104, 'time@10': 7.4467}:  10%|█         | 1/10 [00:10<00:36,  4.04s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0055, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9506, 'compress@10': 0.6104, 'time@10': 7.4467}:  20%|██        | 2/10 [00:10<00:45,  5.74s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9195, 'compress@10': 0.462, 'time@10': 6.7186}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9195, 'compress@10': 0.462, 'time@10': 6.7186}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9453, 'compress@10': 0.5015, 'time@10': 6.7587}:  30%|███       | 3/10 [00:20<00:30,  4.34s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9453, 'compress@10': 0.5015, 'time@10': 6.7587}:  40%|████      | 4/10 [00:20<00:32,  5.36s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9492, 'compress@10': 0.5867, 'time@10': 7.593}:  40%|████      | 4/10 [00:26<00:32,  5.36s/it] {'epoch': 49, 'num_users': 5.8, 'loss': 0.0088, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9492, 'compress@10': 0.5867, 'time@10': 7.593}:  50%|█████     | 5/10 [00:26<00:27,  5.41s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9538, 'compress@10': 0.6011, 'time@10': 8.0313}:  50%|█████     | 5/10 [00:36<00:27,  5.41s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9538, 'compress@10': 0.6011, 'time@10': 8.0313}:  60%|██████    | 6/10 [00:36<00:28,  7.06s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0083, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9547, 'compress@10': 0.5876, 'time@10': 8.4745}:  60%|██████    | 6/10 [00:41<00:28,  7.06s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0083, 'hit_ratio@10': 0.8877, 'ndcg@10': 0.9547, 'compress@10': 0.5876, 'time@10': 8.4745}:  70%|███████   | 7/10 [00:41<00:19,  6.58s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9545, 'compress@10': 0.5452, 'time@10': 8.3579}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0085, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9545, 'compress@10': 0.5452, 'time@10': 8.3579}:  80%|████████  | 8/10 [00:49<00:13,  6.90s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9441, 'compress@10': 0.5446, 'time@10': 9.0009}:  80%|████████  | 8/10 [00:56<00:13,  6.90s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9441, 'compress@10': 0.5446, 'time@10': 9.0009}:  90%|█████████ | 9/10 [00:56<00:06,  6.96s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9473, 'compress@10': 0.5223, 'time@10': 9.0547}:  90%|█████████ | 9/10 [01:06<00:06,  6.96s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9473, 'compress@10': 0.5223, 'time@10': 9.0547}: 100%|██████████| 10/10 [01:06<00:00,  7.77s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9473, 'compress@10': 0.5223, 'time@10': 9.0547}: 100%|██████████| 10/10 [01:06<00:00,  6.62s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.010918501875235001
Avg hit ratio: 0.8934021588673542
Avg ndcg: 0.947337469486817
Avg compression ratio: 0.5222874526146084
Avg train time: 9.054666829109191
Std train time: 2.500782107546654
[0.8490196078431372, 0.3196078431372549, 0.02549019607843135, 0.6137254901960784, 0.9274509803921567, 0.6725490196078431, 0.47647058823529415, 0.24117647058823527, 0.5352941176470588, 0.3]
[10, 10, 22, 11, 6, 10, 10, 10, 9, 10]
