  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1798, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5175, 'compress@10': 0.9052, 'time@10': 9.1483}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1798, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.5175, 'compress@10': 0.9052, 'time@10': 9.1483}:  10%|█         | 1/10 [00:04<00:41,  4.61s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1277, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.6516, 'compress@10': 0.9042, 'time@10': 8.003}:  10%|█         | 1/10 [00:11<00:41,  4.61s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.1277, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.6516, 'compress@10': 0.9042, 'time@10': 8.003}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7632, 'hit_ratio@10': 0.4335, 'ndcg@10': 0.4344, 'compress@10': 0.9076, 'time@10': 6.2595}:  20%|██        | 2/10 [00:12<00:47,  5.96s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7632, 'hit_ratio@10': 0.4335, 'ndcg@10': 0.4344, 'compress@10': 0.9076, 'time@10': 6.2595}:  30%|███       | 3/10 [00:12<00:27,  3.90s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5994, 'hit_ratio@10': 0.5126, 'ndcg@10': 0.4792, 'compress@10': 0.9066, 'time@10': 6.2302}:  30%|███       | 3/10 [00:19<00:27,  3.90s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5994, 'hit_ratio@10': 0.5126, 'ndcg@10': 0.4792, 'compress@10': 0.9066, 'time@10': 6.2302}:  40%|████      | 4/10 [00:19<00:28,  4.80s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4982, 'hit_ratio@10': 0.5741, 'ndcg@10': 0.5364, 'compress@10': 0.9057, 'time@10': 9.3101}:  40%|████      | 4/10 [00:29<00:28,  4.80s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4982, 'hit_ratio@10': 0.5741, 'ndcg@10': 0.5364, 'compress@10': 0.9057, 'time@10': 9.3101}:  50%|█████     | 5/10 [00:29<00:34,  6.98s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4297, 'hit_ratio@10': 0.5969, 'ndcg@10': 0.5766, 'compress@10': 0.9051, 'time@10': 9.4749}:  50%|█████     | 5/10 [00:40<00:34,  6.98s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4297, 'hit_ratio@10': 0.5969, 'ndcg@10': 0.5766, 'compress@10': 0.9051, 'time@10': 9.4749}:  60%|██████    | 6/10 [00:40<00:32,  8.12s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3841, 'hit_ratio@10': 0.6202, 'ndcg@10': 0.5773, 'compress@10': 0.9049, 'time@10': 9.7392}:  60%|██████    | 6/10 [00:46<00:32,  8.12s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3841, 'hit_ratio@10': 0.6202, 'ndcg@10': 0.5773, 'compress@10': 0.9049, 'time@10': 9.7392}:  70%|███████   | 7/10 [00:46<00:21,  7.33s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3425, 'hit_ratio@10': 0.657, 'ndcg@10': 0.6028, 'compress@10': 0.9047, 'time@10': 9.5277}:  70%|███████   | 7/10 [00:54<00:21,  7.33s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.3425, 'hit_ratio@10': 0.657, 'ndcg@10': 0.6028, 'compress@10': 0.9047, 'time@10': 9.5277}:  80%|████████  | 8/10 [00:54<00:15,  7.57s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3101, 'hit_ratio@10': 0.6602, 'ndcg@10': 0.6366, 'compress@10': 0.9045, 'time@10': 10.3015}:  80%|████████  | 8/10 [01:02<00:15,  7.57s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3101, 'hit_ratio@10': 0.6602, 'ndcg@10': 0.6366, 'compress@10': 0.9045, 'time@10': 10.3015}:  90%|█████████ | 9/10 [01:02<00:07,  7.79s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2844, 'hit_ratio@10': 0.6873, 'ndcg@10': 0.6573, 'compress@10': 0.9042, 'time@10': 10.2547}:  90%|█████████ | 9/10 [01:12<00:07,  7.79s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2844, 'hit_ratio@10': 0.6873, 'ndcg@10': 0.6573, 'compress@10': 0.9042, 'time@10': 10.2547}: 100%|██████████| 10/10 [01:12<00:00,  8.44s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2844, 'hit_ratio@10': 0.6873, 'ndcg@10': 0.6573, 'compress@10': 0.9042, 'time@10': 10.2547}: 100%|██████████| 10/10 [01:12<00:00,  7.23s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.2843998507992603
Avg hit ratio: 0.6873438630790074
Avg ndcg: 0.657261535896236
Avg compression ratio: 0.9042398951721374
Avg train time: 10.254665398597718
Std train time: 5.100483310168963
[0.95, 0.45, 0.95, 0.95, 0.95, 0.45, 0.95, 0.45, 0.45, 0.45]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0512, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8496, 'compress@10': 0.9526, 'time@10': 7.7459}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0512, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8496, 'compress@10': 0.9526, 'time@10': 7.7459}:  10%|█         | 1/10 [00:03<00:35,  3.91s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0521, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8513, 'compress@10': 0.7102, 'time@10': 7.5021}:  10%|█         | 1/10 [00:11<00:35,  3.91s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0521, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8513, 'compress@10': 0.7102, 'time@10': 7.5021}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0421, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8158, 'compress@10': 0.7925, 'time@10': 5.9882}:  20%|██        | 2/10 [00:12<00:47,  5.90s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0421, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8158, 'compress@10': 0.7925, 'time@10': 5.9882}:  30%|███       | 3/10 [00:12<00:27,  3.90s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.044, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8226, 'compress@10': 0.8323, 'time@10': 6.0066}:  30%|███       | 3/10 [00:18<00:27,  3.90s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.044, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8226, 'compress@10': 0.8323, 'time@10': 6.0066}:  40%|████      | 4/10 [00:18<00:28,  4.77s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0526, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.815, 'compress@10': 0.856, 'time@10': 8.9082}:  40%|████      | 4/10 [00:29<00:28,  4.77s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.0526, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.815, 'compress@10': 0.856, 'time@10': 8.9082}:  50%|█████     | 5/10 [00:29<00:33,  6.76s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0568, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8151, 'compress@10': 0.7904, 'time@10': 9.1906}:  50%|█████     | 5/10 [00:39<00:33,  6.76s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0568, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8151, 'compress@10': 0.7904, 'time@10': 9.1906}:  60%|██████    | 6/10 [00:39<00:32,  8.08s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0549, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8224, 'compress@10': 0.8135, 'time@10': 9.4243}:  60%|██████    | 6/10 [00:45<00:32,  8.08s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0549, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8224, 'compress@10': 0.8135, 'time@10': 9.4243}:  70%|███████   | 7/10 [00:45<00:21,  7.22s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0528, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8292, 'compress@10': 0.77, 'time@10': 9.2696}:  70%|███████   | 7/10 [00:53<00:21,  7.22s/it]   {'epoch': 1, 'num_users': 6.125, 'loss': 0.0528, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8292, 'compress@10': 0.77, 'time@10': 9.2696}:  80%|████████  | 8/10 [00:53<00:15,  7.54s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0508, 'hit_ratio@10': 0.815, 'ndcg@10': 0.8387, 'compress@10': 0.7362, 'time@10': 9.9059}:  80%|████████  | 8/10 [01:00<00:15,  7.54s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0508, 'hit_ratio@10': 0.815, 'ndcg@10': 0.8387, 'compress@10': 0.7362, 'time@10': 9.9059}:  90%|█████████ | 9/10 [01:00<00:07,  7.54s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.839, 'compress@10': 0.7088, 'time@10': 9.9669}:  90%|█████████ | 9/10 [01:11<00:07,  7.54s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.839, 'compress@10': 0.7088, 'time@10': 9.9669}: 100%|██████████| 10/10 [01:11<00:00,  8.47s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.839, 'compress@10': 0.7088, 'time@10': 9.9669}: 100%|██████████| 10/10 [01:11<00:00,  7.15s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.050366631418311436
Avg hit ratio: 0.8266755255685647
Avg ndcg: 0.838972645708302
Avg compression ratio: 0.7088360305591118
Avg train time: 9.966879415512086
Std train time: 4.666644390879506
[0.9666666666666667, 0.6333333333333333, 0.6333333333333333, 0.9666666666666667, 0.9666666666666667, 0.6333333333333333, 0.6333333333333333, 0.30000000000000004, 0.30000000000000004, 0.30000000000000004]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0479, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.9684, 'time@10': 8.027}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0479, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.9684, 'time@10': 8.027}:  10%|█         | 1/10 [00:04<00:36,  4.05s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0499, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.85, 'compress@10': 0.8068, 'time@10': 7.6024}:  10%|█         | 1/10 [00:11<00:36,  4.05s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0499, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.85, 'compress@10': 0.8068, 'time@10': 7.6024}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8524, 'compress@10': 0.7664, 'time@10': 6.1939}:  20%|██        | 2/10 [00:12<00:47,  5.91s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0344, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8524, 'compress@10': 0.7664, 'time@10': 6.1939}:  30%|███       | 3/10 [00:12<00:28,  4.00s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0381, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8491, 'compress@10': 0.8168, 'time@10': 6.177}:  30%|███       | 3/10 [00:19<00:28,  4.00s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.0381, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8491, 'compress@10': 0.8168, 'time@10': 6.177}:  40%|████      | 4/10 [00:19<00:29,  4.85s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8369, 'compress@10': 0.8469, 'time@10': 8.4799}:  40%|████      | 4/10 [00:28<00:29,  4.85s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.8111, 'ndcg@10': 0.8369, 'compress@10': 0.8469, 'time@10': 8.4799}:  50%|█████     | 5/10 [00:28<00:31,  6.31s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0521, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8338, 'compress@10': 0.8126, 'time@10': 8.8466}:  50%|█████     | 5/10 [00:38<00:31,  6.31s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0521, 'hit_ratio@10': 0.8018, 'ndcg@10': 0.8338, 'compress@10': 0.8126, 'time@10': 8.8466}:  60%|██████    | 6/10 [00:38<00:31,  7.81s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.8351, 'compress@10': 0.7891, 'time@10': 9.2157}:  60%|██████    | 6/10 [00:44<00:31,  7.81s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.8244, 'ndcg@10': 0.8351, 'compress@10': 0.7891, 'time@10': 9.2157}:  70%|███████   | 7/10 [00:44<00:21,  7.13s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8417, 'compress@10': 0.7305, 'time@10': 9.1263}:  70%|███████   | 7/10 [00:53<00:21,  7.13s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.8417, 'compress@10': 0.7305, 'time@10': 9.1263}:  80%|████████  | 8/10 [00:53<00:15,  7.58s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.049, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8491, 'compress@10': 0.6849, 'time@10': 9.7904}:  80%|████████  | 8/10 [01:00<00:15,  7.58s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.049, 'hit_ratio@10': 0.8222, 'ndcg@10': 0.8491, 'compress@10': 0.6849, 'time@10': 9.7904}:  90%|█████████ | 9/10 [01:00<00:07,  7.58s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8498, 'compress@10': 0.648, 'time@10': 9.8581}:  90%|█████████ | 9/10 [01:11<00:07,  7.58s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8498, 'compress@10': 0.648, 'time@10': 9.8581}: 100%|██████████| 10/10 [01:11<00:00,  8.49s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0488, 'hit_ratio@10': 0.8331, 'ndcg@10': 0.8498, 'compress@10': 0.648, 'time@10': 9.8581}: 100%|██████████| 10/10 [01:11<00:00,  7.11s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04883229456872664
Avg hit ratio: 0.8331271384717904
Avg ndcg: 0.8498294082775036
Avg compression ratio: 0.6479807024850728
Avg train time: 9.858075833320617
Std train time: 4.008788785970369
[0.725, 0.725, 0.475, 0.975, 0.975, 0.725, 0.475, 0.47500000000000003, 0.22500000000000003, 0.22500000000000003]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.7395, 'time@10': 8.4455}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.7395, 'time@10': 8.4455}:  10%|█         | 1/10 [00:04<00:38,  4.26s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8465, 'compress@10': 0.7367, 'time@10': 7.8122}:  10%|█         | 1/10 [00:11<00:38,  4.26s/it] {'epoch': 3, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8465, 'compress@10': 0.7367, 'time@10': 7.8122}:  20%|██        | 2/10 [00:11<00:48,  6.00s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.85, 'compress@10': 0.6744, 'time@10': 6.4669}:  20%|██        | 2/10 [00:13<00:48,  6.00s/it]  {'epoch': 3, 'num_users': 5.0, 'loss': 0.033, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.85, 'compress@10': 0.6744, 'time@10': 6.4669}:  30%|███       | 3/10 [00:13<00:29,  4.14s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0367, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.849, 'compress@10': 0.7498, 'time@10': 6.3419}:  30%|███       | 3/10 [00:19<00:29,  4.14s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0367, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.849, 'compress@10': 0.7498, 'time@10': 6.3419}:  40%|████      | 4/10 [00:19<00:29,  4.88s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0463, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8375, 'compress@10': 0.7949, 'time@10': 8.2245}:  40%|████      | 4/10 [00:27<00:29,  4.88s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0463, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8375, 'compress@10': 0.7949, 'time@10': 8.2245}:  50%|█████     | 5/10 [00:27<00:29,  5.97s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.8357, 'compress@10': 0.7843, 'time@10': 8.6422}:  50%|█████     | 5/10 [00:38<00:29,  5.97s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.7726, 'ndcg@10': 0.8357, 'compress@10': 0.7843, 'time@10': 8.6422}:  60%|██████    | 6/10 [00:38<00:30,  7.60s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.8358, 'compress@10': 0.7431, 'time@10': 9.0807}:  60%|██████    | 6/10 [00:43<00:30,  7.60s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0502, 'hit_ratio@10': 0.7994, 'ndcg@10': 0.8358, 'compress@10': 0.7431, 'time@10': 9.0807}:  70%|███████   | 7/10 [00:43<00:21,  7.05s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0509, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8401, 'compress@10': 0.7115, 'time@10': 8.9763}:  70%|███████   | 7/10 [00:52<00:21,  7.05s/it] {'epoch': 3, 'num_users': 6.125, 'loss': 0.0509, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.8401, 'compress@10': 0.7115, 'time@10': 8.9763}:  80%|████████  | 8/10 [00:52<00:14,  7.44s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0515, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.854, 'compress@10': 0.6599, 'time@10': 9.6686}:  80%|████████  | 8/10 [00:59<00:14,  7.44s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0515, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.854, 'compress@10': 0.6599, 'time@10': 9.6686}:  90%|█████████ | 9/10 [00:59<00:07,  7.50s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8523, 'compress@10': 0.6182, 'time@10': 9.7314}:  90%|█████████ | 9/10 [01:10<00:07,  7.50s/it]  {'epoch': 3, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8523, 'compress@10': 0.6182, 'time@10': 9.7314}: 100%|██████████| 10/10 [01:10<00:00,  8.38s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8242, 'ndcg@10': 0.8523, 'compress@10': 0.6182, 'time@10': 9.7314}: 100%|██████████| 10/10 [01:10<00:00,  7.03s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.05114635782248013
Avg hit ratio: 0.8241870463058918
Avg ndcg: 0.8522961738219849
Avg compression ratio: 0.6181548185770182
Avg train time: 9.731358861923217
Std train time: 3.6264982108629473
[0.58, 0.78, 0.38, 0.78, 0.98, 0.78, 0.38, 0.5800000000000001, 0.38, 0.18000000000000002]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8543, 'compress@10': 0.6021, 'time@10': 8.527}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8543, 'compress@10': 0.6021, 'time@10': 8.527}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8603, 'compress@10': 0.6946, 'time@10': 7.836}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8603, 'compress@10': 0.6946, 'time@10': 7.836}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8592, 'compress@10': 0.6193, 'time@10': 6.5303}:  20%|██        | 2/10 [00:13<00:47,  6.00s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0325, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8592, 'compress@10': 0.6193, 'time@10': 6.5303}:  30%|███       | 3/10 [00:13<00:29,  4.17s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8528, 'compress@10': 0.6614, 'time@10': 6.4789}:  30%|███       | 3/10 [00:19<00:29,  4.17s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8528, 'compress@10': 0.6614, 'time@10': 6.4789}:  40%|████      | 4/10 [00:19<00:30,  5.04s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8389, 'compress@10': 0.7252, 'time@10': 7.8862}:  40%|████      | 4/10 [00:26<00:30,  5.04s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8389, 'compress@10': 0.7252, 'time@10': 7.8862}:  50%|█████     | 5/10 [00:26<00:28,  5.67s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0492, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.8376, 'compress@10': 0.7351, 'time@10': 8.3112}:  50%|█████     | 5/10 [00:37<00:28,  5.67s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0492, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.8376, 'compress@10': 0.7351, 'time@10': 8.3112}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0491, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8403, 'compress@10': 0.688, 'time@10': 8.7714}:  60%|██████    | 6/10 [00:42<00:29,  7.30s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0491, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8403, 'compress@10': 0.688, 'time@10': 8.7714}:  70%|███████   | 7/10 [00:42<00:20,  6.82s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0496, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.845, 'compress@10': 0.676, 'time@10': 8.7173}:  70%|███████   | 7/10 [00:51<00:20,  6.82s/it]  {'epoch': 4, 'num_users': 6.125, 'loss': 0.0496, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.845, 'compress@10': 0.676, 'time@10': 8.7173}:  80%|████████  | 8/10 [00:51<00:14,  7.32s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0483, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.8513, 'compress@10': 0.645, 'time@10': 9.4808}:  80%|████████  | 8/10 [00:59<00:14,  7.32s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0483, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.8513, 'compress@10': 0.645, 'time@10': 9.4808}:  90%|█████████ | 9/10 [00:59<00:07,  7.48s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0482, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8499, 'compress@10': 0.6004, 'time@10': 9.5825}:  90%|█████████ | 9/10 [01:09<00:07,  7.48s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.0482, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8499, 'compress@10': 0.6004, 'time@10': 9.5825}: 100%|██████████| 10/10 [01:09<00:00,  8.42s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0482, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8499, 'compress@10': 0.6004, 'time@10': 9.5825}: 100%|██████████| 10/10 [01:09<00:00,  6.97s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04823032936213654
Avg hit ratio: 0.8317144400590921
Avg ndcg: 0.8499248739263361
Avg compression ratio: 0.6004007094220977
Avg train time: 9.582461309432983
Std train time: 3.2894111021979997
[0.4833333333333333, 0.8166666666666667, 0.31666666666666665, 0.65, 0.9833333333333333, 0.8166666666666667, 0.48333333333333334, 0.65, 0.31666666666666665, 0.15000000000000002]
[10, 10, 15, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0479, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8571, 'compress@10': 0.5105, 'time@10': 8.6846}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0479, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8571, 'compress@10': 0.5105, 'time@10': 8.6846}:  10%|█         | 1/10 [00:04<00:39,  4.38s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8569, 'compress@10': 0.6665, 'time@10': 7.8599}:  10%|█         | 1/10 [00:11<00:39,  4.38s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0473, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8569, 'compress@10': 0.6665, 'time@10': 7.8599}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.857, 'compress@10': 0.5825, 'time@10': 6.7088}:  20%|██        | 2/10 [00:13<00:47,  5.96s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.857, 'compress@10': 0.5825, 'time@10': 6.7088}:  30%|███       | 3/10 [00:13<00:29,  4.26s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0365, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8508, 'compress@10': 0.6025, 'time@10': 6.6424}:  30%|███       | 3/10 [00:20<00:29,  4.26s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0365, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8508, 'compress@10': 0.6025, 'time@10': 6.6424}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8371, 'compress@10': 0.6787, 'time@10': 7.9635}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8371, 'compress@10': 0.6787, 'time@10': 7.9635}:  50%|█████     | 5/10 [00:26<00:28,  5.69s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0481, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8364, 'compress@10': 0.7024, 'time@10': 8.3329}:  50%|█████     | 5/10 [00:37<00:28,  5.69s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0481, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8364, 'compress@10': 0.7024, 'time@10': 8.3329}:  60%|██████    | 6/10 [00:37<00:28,  7.23s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.047, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8399, 'compress@10': 0.674, 'time@10': 8.7114}:  60%|██████    | 6/10 [00:42<00:28,  7.23s/it]  {'epoch': 5, 'num_users': 6.2857, 'loss': 0.047, 'hit_ratio@10': 0.84, 'ndcg@10': 0.8399, 'compress@10': 0.674, 'time@10': 8.7114}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0471, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8432, 'compress@10': 0.6723, 'time@10': 8.6035}:  70%|███████   | 7/10 [00:50<00:20,  6.67s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0471, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8432, 'compress@10': 0.6723, 'time@10': 8.6035}:  80%|████████  | 8/10 [00:50<00:14,  7.06s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0459, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8526, 'compress@10': 0.6349, 'time@10': 9.0669}:  80%|████████  | 8/10 [00:56<00:14,  7.06s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0459, 'hit_ratio@10': 0.8438, 'ndcg@10': 0.8526, 'compress@10': 0.6349, 'time@10': 9.0669}:  90%|█████████ | 9/10 [00:56<00:06,  6.86s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0451, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8531, 'compress@10': 0.5884, 'time@10': 9.134}:  90%|█████████ | 9/10 [01:06<00:06,  6.86s/it]    {'epoch': 5, 'num_users': 6.3, 'loss': 0.0451, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8531, 'compress@10': 0.5884, 'time@10': 9.134}: 100%|██████████| 10/10 [01:06<00:00,  7.76s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0451, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8531, 'compress@10': 0.5884, 'time@10': 9.134}: 100%|██████████| 10/10 [01:06<00:00,  6.67s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04514564293506286
Avg hit ratio: 0.8525874559321078
Avg ndcg: 0.8531490940900301
Avg compression ratio: 0.5883764242685111
Avg train time: 9.133998131752014
Std train time: 2.662700594855262
[0.557142857142857, 0.7, 0.2714285714285714, 0.7000000000000001, 0.9857142857142857, 0.8428571428571429, 0.41428571428571426, 0.7000000000000001, 0.2714285714285714, 0.1285714285714286]
[10, 10, 16, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8561, 'compress@10': 0.5805, 'time@10': 8.5337}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8561, 'compress@10': 0.5805, 'time@10': 8.5337}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8549, 'compress@10': 0.6451, 'time@10': 7.6387}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8549, 'compress@10': 0.6451, 'time@10': 7.6387}:  20%|██        | 2/10 [00:11<00:46,  5.76s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8556, 'compress@10': 0.5552, 'time@10': 6.5648}:  20%|██        | 2/10 [00:13<00:46,  5.76s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8556, 'compress@10': 0.5552, 'time@10': 6.5648}:  30%|███       | 3/10 [00:13<00:29,  4.16s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8481, 'compress@10': 0.5941, 'time@10': 6.4243}:  30%|███       | 3/10 [00:19<00:29,  4.16s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8481, 'compress@10': 0.5941, 'time@10': 6.4243}:  40%|████      | 4/10 [00:19<00:29,  4.90s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0445, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8354, 'compress@10': 0.6725, 'time@10': 7.7266}:  40%|████      | 4/10 [00:25<00:29,  4.90s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0445, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8354, 'compress@10': 0.6725, 'time@10': 7.7266}:  50%|█████     | 5/10 [00:25<00:27,  5.48s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0464, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8348, 'compress@10': 0.7014, 'time@10': 8.0133}:  50%|█████     | 5/10 [00:35<00:27,  5.48s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0464, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8348, 'compress@10': 0.7014, 'time@10': 8.0133}:  60%|██████    | 6/10 [00:35<00:27,  6.84s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.046, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8399, 'compress@10': 0.6638, 'time@10': 8.3855}:  60%|██████    | 6/10 [00:40<00:27,  6.84s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.046, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8399, 'compress@10': 0.6638, 'time@10': 8.3855}:  70%|███████   | 7/10 [00:40<00:19,  6.35s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0458, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8453, 'compress@10': 0.6694, 'time@10': 8.3157}:  70%|███████   | 7/10 [00:48<00:19,  6.35s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0458, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8453, 'compress@10': 0.6694, 'time@10': 8.3157}:  80%|████████  | 8/10 [00:48<00:13,  6.83s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0453, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8543, 'compress@10': 0.6275, 'time@10': 8.7673}:  80%|████████  | 8/10 [00:54<00:13,  6.83s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0453, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8543, 'compress@10': 0.6275, 'time@10': 8.7673}:  90%|█████████ | 9/10 [00:54<00:06,  6.64s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0454, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8561, 'compress@10': 0.5796, 'time@10': 8.8481}:  90%|█████████ | 9/10 [01:04<00:06,  6.64s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0454, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8561, 'compress@10': 0.5796, 'time@10': 8.8481}: 100%|██████████| 10/10 [01:04<00:00,  7.56s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0454, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8561, 'compress@10': 0.5796, 'time@10': 8.8481}: 100%|██████████| 10/10 [01:04<00:00,  6.44s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.0453903538501259
Avg hit ratio: 0.870666821011473
Avg ndcg: 0.8560670145602552
Avg compression ratio: 0.5795573892095318
Avg train time: 8.848071575164795
Std train time: 2.5789711031998226
[0.6124999999999999, 0.6124999999999999, 0.2375, 0.7375, 0.9874999999999999, 0.8625, 0.3625, 0.6125, 0.2375, 0.23750000000000002]
[10, 10, 17, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.6329, 'time@10': 8.3874}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.6329, 'time@10': 8.3874}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8561, 'compress@10': 0.6289, 'time@10': 7.6942}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8561, 'compress@10': 0.6289, 'time@10': 7.6942}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8565, 'compress@10': 0.5348, 'time@10': 6.6556}:  20%|██        | 2/10 [00:13<00:47,  5.88s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8565, 'compress@10': 0.5348, 'time@10': 6.6556}:  30%|███       | 3/10 [00:13<00:29,  4.26s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8488, 'compress@10': 0.5878, 'time@10': 6.4982}:  30%|███       | 3/10 [00:19<00:29,  4.26s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.035, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8488, 'compress@10': 0.5878, 'time@10': 6.4982}:  40%|████      | 4/10 [00:19<00:29,  4.97s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0433, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8366, 'compress@10': 0.6678, 'time@10': 7.765}:  40%|████      | 4/10 [00:26<00:29,  4.97s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0433, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.8366, 'compress@10': 0.6678, 'time@10': 7.765}:  50%|█████     | 5/10 [00:26<00:27,  5.50s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0445, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8372, 'compress@10': 0.7007, 'time@10': 8.0661}:  50%|█████     | 5/10 [00:35<00:27,  5.50s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0445, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8372, 'compress@10': 0.7007, 'time@10': 8.0661}:  60%|██████    | 6/10 [00:35<00:27,  6.90s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0435, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8409, 'compress@10': 0.6561, 'time@10': 8.4737}:  60%|██████    | 6/10 [00:41<00:27,  6.90s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0435, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8409, 'compress@10': 0.6561, 'time@10': 8.4737}:  70%|███████   | 7/10 [00:41<00:19,  6.44s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0433, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8437, 'compress@10': 0.652, 'time@10': 8.4329}:  70%|███████   | 7/10 [00:49<00:19,  6.44s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.0433, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8437, 'compress@10': 0.652, 'time@10': 8.4329}:  80%|████████  | 8/10 [00:49<00:13,  7.00s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0431, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8531, 'compress@10': 0.6084, 'time@10': 8.9299}:  80%|████████  | 8/10 [00:55<00:13,  7.00s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0431, 'hit_ratio@10': 0.857, 'ndcg@10': 0.8531, 'compress@10': 0.6084, 'time@10': 8.9299}:  90%|█████████ | 9/10 [00:55<00:06,  6.84s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0426, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.854, 'compress@10': 0.573, 'time@10': 9.0514}:  90%|█████████ | 9/10 [01:06<00:06,  6.84s/it]    {'epoch': 7, 'num_users': 6.3, 'loss': 0.0426, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.854, 'compress@10': 0.573, 'time@10': 9.0514}: 100%|██████████| 10/10 [01:06<00:00,  7.87s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0426, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.854, 'compress@10': 0.573, 'time@10': 9.0514}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04262146739763658
Avg hit ratio: 0.8644640560345144
Avg ndcg: 0.8539610564126507
Avg compression ratio: 0.5730134198214831
Avg train time: 9.05136172771454
Std train time: 2.6215942558194993
[0.6555555555555554, 0.6555555555555554, 0.2111111111111111, 0.7666666666666667, 0.9888888888888888, 0.8777777777777778, 0.3222222222222222, 0.5444444444444445, 0.2111111111111111, 0.21111111111111114]
[10, 10, 18, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8399, 'compress@10': 0.6737, 'time@10': 8.5248}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8399, 'compress@10': 0.6737, 'time@10': 8.5248}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8521, 'compress@10': 0.6702, 'time@10': 7.7177}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0442, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8521, 'compress@10': 0.6702, 'time@10': 7.7177}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8538, 'compress@10': 0.5547, 'time@10': 6.7723}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8538, 'compress@10': 0.5547, 'time@10': 6.7723}:  30%|███       | 3/10 [00:13<00:30,  4.31s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8491, 'compress@10': 0.6098, 'time@10': 6.6722}:  30%|███       | 3/10 [00:20<00:30,  4.31s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8491, 'compress@10': 0.6098, 'time@10': 6.6722}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8371, 'compress@10': 0.6856, 'time@10': 7.8949}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8371, 'compress@10': 0.6856, 'time@10': 7.8949}:  50%|█████     | 5/10 [00:26<00:28,  5.61s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0425, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8394, 'compress@10': 0.7181, 'time@10': 8.2163}:  50%|█████     | 5/10 [00:36<00:28,  5.61s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0425, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8394, 'compress@10': 0.7181, 'time@10': 8.2163}:  60%|██████    | 6/10 [00:36<00:28,  7.05s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0424, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8469, 'compress@10': 0.6654, 'time@10': 8.624}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it] {'epoch': 8, 'num_users': 6.2857, 'loss': 0.0424, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8469, 'compress@10': 0.6654, 'time@10': 8.624}:  70%|███████   | 7/10 [00:41<00:19,  6.57s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0418, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8492, 'compress@10': 0.6519, 'time@10': 8.5353}:  70%|███████   | 7/10 [00:49<00:19,  6.57s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0418, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8492, 'compress@10': 0.6519, 'time@10': 8.5353}:  80%|████████  | 8/10 [00:49<00:14,  7.01s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0417, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8589, 'compress@10': 0.6055, 'time@10': 9.0091}:  80%|████████  | 8/10 [00:56<00:14,  7.01s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0417, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8589, 'compress@10': 0.6055, 'time@10': 9.0091}:  90%|█████████ | 9/10 [00:56<00:06,  6.83s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8617, 'compress@10': 0.5678, 'time@10': 9.0741}:  90%|█████████ | 9/10 [01:06<00:06,  6.83s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8617, 'compress@10': 0.5678, 'time@10': 9.0741}: 100%|██████████| 10/10 [01:06<00:00,  7.71s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8617, 'compress@10': 0.5678, 'time@10': 9.0741}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04070468613682861
Avg hit ratio: 0.8641018626723211
Avg ndcg: 0.8616999130247743
Avg compression ratio: 0.5678204896701263
Avg train time: 9.074059700965881
Std train time: 2.524812206115985
[0.69, 0.5899999999999999, 0.19, 0.79, 0.99, 0.89, 0.38999999999999996, 0.49000000000000005, 0.19, 0.19000000000000003]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.7063, 'time@10': 8.8107}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 0.7063, 'time@10': 8.8107}:  10%|█         | 1/10 [00:04<00:40,  4.46s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8616, 'compress@10': 0.6548, 'time@10': 7.9632}:  10%|█         | 1/10 [00:11<00:40,  4.46s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0421, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8616, 'compress@10': 0.6548, 'time@10': 7.9632}:  20%|██        | 2/10 [00:11<00:48,  6.04s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8601, 'compress@10': 0.5384, 'time@10': 7.0443}:  20%|██        | 2/10 [00:14<00:48,  6.04s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0281, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8601, 'compress@10': 0.5384, 'time@10': 7.0443}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0327, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8524, 'compress@10': 0.6032, 'time@10': 6.784}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0327, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8524, 'compress@10': 0.6032, 'time@10': 6.784}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0401, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.84, 'compress@10': 0.6806, 'time@10': 8.0186}:  40%|████      | 4/10 [00:26<00:30,  5.10s/it] {'epoch': 9, 'num_users': 5.8, 'loss': 0.0401, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.84, 'compress@10': 0.6806, 'time@10': 8.0186}:  50%|█████     | 5/10 [00:26<00:28,  5.61s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0405, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8434, 'compress@10': 0.7159, 'time@10': 8.2998}:  50%|█████     | 5/10 [00:36<00:28,  5.61s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0405, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8434, 'compress@10': 0.7159, 'time@10': 8.2998}:  60%|██████    | 6/10 [00:36<00:28,  7.02s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0404, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8452, 'compress@10': 0.6728, 'time@10': 8.6771}:  60%|██████    | 6/10 [00:42<00:28,  7.02s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0404, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8452, 'compress@10': 0.6728, 'time@10': 8.6771}:  70%|███████   | 7/10 [00:42<00:19,  6.52s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0392, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8495, 'compress@10': 0.6518, 'time@10': 8.5884}:  70%|███████   | 7/10 [00:50<00:19,  6.52s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0392, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8495, 'compress@10': 0.6518, 'time@10': 8.5884}:  80%|████████  | 8/10 [00:50<00:13,  6.99s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0395, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8596, 'compress@10': 0.6031, 'time@10': 9.0284}:  80%|████████  | 8/10 [00:56<00:13,  6.99s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0395, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8596, 'compress@10': 0.6031, 'time@10': 9.0284}:  90%|█████████ | 9/10 [00:56<00:06,  6.79s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0394, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8596, 'compress@10': 0.5636, 'time@10': 9.0883}:  90%|█████████ | 9/10 [01:06<00:06,  6.79s/it]    {'epoch': 9, 'num_users': 6.3, 'loss': 0.0394, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8596, 'compress@10': 0.5636, 'time@10': 9.0883}: 100%|██████████| 10/10 [01:06<00:00,  7.68s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0394, 'hit_ratio@10': 0.865, 'ndcg@10': 0.8596, 'compress@10': 0.5636, 'time@10': 9.0883}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03938987696827762
Avg hit ratio: 0.8650189133635653
Avg ndcg: 0.8596425955539525
Avg compression ratio: 0.5635877364226276
Avg train time: 9.08827223777771
Std train time: 2.4667783844324975
[0.7181818181818181, 0.5363636363636363, 0.17272727272727273, 0.8090909090909091, 0.9909090909090909, 0.9, 0.3545454545454545, 0.4454545454545455, 0.26363636363636367, 0.17272727272727276]
[10, 10, 19, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8521, 'compress@10': 0.733, 'time@10': 8.5128}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8521, 'compress@10': 0.733, 'time@10': 8.5128}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0383, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8662, 'compress@10': 0.6422, 'time@10': 7.806}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0383, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8662, 'compress@10': 0.6422, 'time@10': 7.806}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8632, 'compress@10': 0.5251, 'time@10': 6.8843}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8632, 'compress@10': 0.5251, 'time@10': 6.8843}:  30%|███       | 3/10 [00:14<00:30,  4.41s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8599, 'compress@10': 0.5978, 'time@10': 6.6595}:  30%|███       | 3/10 [00:20<00:30,  4.41s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8599, 'compress@10': 0.5978, 'time@10': 6.6595}:  40%|████      | 4/10 [00:20<00:30,  5.05s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0385, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8476, 'compress@10': 0.6764, 'time@10': 7.8034}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0385, 'hit_ratio@10': 0.8231, 'ndcg@10': 0.8476, 'compress@10': 0.6764, 'time@10': 7.8034}:  50%|█████     | 5/10 [00:26<00:27,  5.47s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8506, 'compress@10': 0.7141, 'time@10': 8.1055}:  50%|█████     | 5/10 [00:35<00:27,  5.47s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0386, 'hit_ratio@10': 0.8377, 'ndcg@10': 0.8506, 'compress@10': 0.7141, 'time@10': 8.1055}:  60%|██████    | 6/10 [00:35<00:27,  6.90s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0376, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8578, 'compress@10': 0.6664, 'time@10': 8.5049}:  60%|██████    | 6/10 [00:41<00:27,  6.90s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0376, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8578, 'compress@10': 0.6664, 'time@10': 8.5049}:  70%|███████   | 7/10 [00:41<00:19,  6.44s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0364, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.862, 'compress@10': 0.6408, 'time@10': 8.4473}:  70%|███████   | 7/10 [00:49<00:19,  6.44s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.0364, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.862, 'compress@10': 0.6408, 'time@10': 8.4473}:  80%|████████  | 8/10 [00:49<00:13,  6.96s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0369, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8721, 'compress@10': 0.6012, 'time@10': 8.9096}:  80%|████████  | 8/10 [00:55<00:13,  6.96s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0369, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8721, 'compress@10': 0.6012, 'time@10': 8.9096}:  90%|█████████ | 9/10 [00:55<00:06,  6.77s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0353, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8765, 'compress@10': 0.5602, 'time@10': 9.0024}:  90%|█████████ | 9/10 [01:05<00:06,  6.77s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0353, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8765, 'compress@10': 0.5602, 'time@10': 9.0024}: 100%|██████████| 10/10 [01:05<00:00,  7.73s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0353, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8765, 'compress@10': 0.5602, 'time@10': 9.0024}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.0352860337119187
Avg hit ratio: 0.870656720001372
Avg ndcg: 0.8765362911976743
Avg compression ratio: 0.5602284539728106
Avg train time: 9.002448868751525
Std train time: 2.4221171447055383
[0.7416666666666666, 0.4916666666666666, 0.15833333333333333, 0.825, 0.9916666666666666, 0.9083333333333333, 0.32499999999999996, 0.4083333333333334, 0.325, 0.15833333333333335]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8428, 'compress@10': 0.7553, 'time@10': 8.4885}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8428, 'compress@10': 0.7553, 'time@10': 8.4885}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0368, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8655, 'compress@10': 0.6317, 'time@10': 7.7644}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0368, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8655, 'compress@10': 0.6317, 'time@10': 7.7644}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8627, 'compress@10': 0.514, 'time@10': 6.971}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it]  {'epoch': 11, 'num_users': 5.0, 'loss': 0.0245, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8627, 'compress@10': 0.514, 'time@10': 6.971}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8616, 'compress@10': 0.5933, 'time@10': 6.8132}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8616, 'compress@10': 0.5933, 'time@10': 6.8132}:  40%|████      | 4/10 [00:20<00:31,  5.22s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8492, 'compress@10': 0.673, 'time@10': 7.9422}:  40%|████      | 4/10 [00:26<00:31,  5.22s/it] {'epoch': 11, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8492, 'compress@10': 0.673, 'time@10': 7.9422}:  50%|█████     | 5/10 [00:26<00:27,  5.60s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0385, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8526, 'compress@10': 0.7125, 'time@10': 8.1694}:  50%|█████     | 5/10 [00:36<00:27,  5.60s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0385, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8526, 'compress@10': 0.7125, 'time@10': 8.1694}:  60%|██████    | 6/10 [00:36<00:27,  6.87s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0384, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8589, 'compress@10': 0.661, 'time@10': 8.6006}:  60%|██████    | 6/10 [00:41<00:27,  6.87s/it] {'epoch': 11, 'num_users': 6.2857, 'loss': 0.0384, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8589, 'compress@10': 0.661, 'time@10': 8.6006}:  70%|███████   | 7/10 [00:41<00:19,  6.47s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.037, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.8626, 'compress@10': 0.6316, 'time@10': 8.5301}:  70%|███████   | 7/10 [00:49<00:19,  6.47s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.037, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.8626, 'compress@10': 0.6316, 'time@10': 8.5301}:  80%|████████  | 8/10 [00:49<00:13,  6.98s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0376, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.8765, 'compress@10': 0.5996, 'time@10': 9.0033}:  80%|████████  | 8/10 [00:56<00:13,  6.98s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0376, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.8765, 'compress@10': 0.5996, 'time@10': 9.0033}:  90%|█████████ | 9/10 [00:56<00:06,  6.81s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8757, 'compress@10': 0.5574, 'time@10': 9.043}:  90%|█████████ | 9/10 [01:05<00:06,  6.81s/it]    {'epoch': 11, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8757, 'compress@10': 0.5574, 'time@10': 9.043}: 100%|██████████| 10/10 [01:05<00:00,  7.62s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8757, 'compress@10': 0.5574, 'time@10': 9.043}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03792549366372235
Avg hit ratio: 0.87921857919481
Avg ndcg: 0.8756631497608771
Avg compression ratio: 0.5574294831087114
Avg train time: 9.043028497695923
Std train time: 2.3773494942665963
[0.7615384615384615, 0.4538461538461538, 0.14615384615384613, 0.8384615384615384, 0.9923076923076922, 0.9153846153846154, 0.29999999999999993, 0.37692307692307697, 0.3769230769230769, 0.14615384615384616]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0424, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8442, 'compress@10': 0.7741, 'time@10': 8.3726}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0424, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8442, 'compress@10': 0.7741, 'time@10': 8.3726}:  10%|█         | 1/10 [00:04<00:38,  4.22s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8675, 'compress@10': 0.6228, 'time@10': 7.6402}:  10%|█         | 1/10 [00:11<00:38,  4.22s/it] {'epoch': 12, 'num_users': 7.0, 'loss': 0.036, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8675, 'compress@10': 0.6228, 'time@10': 7.6402}:  20%|██        | 2/10 [00:11<00:46,  5.82s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.864, 'compress@10': 0.5046, 'time@10': 6.9246}:  20%|██        | 2/10 [00:13<00:46,  5.82s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.864, 'compress@10': 0.5046, 'time@10': 6.9246}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8627, 'compress@10': 0.5895, 'time@10': 6.7176}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0295, 'hit_ratio@10': 0.822, 'ndcg@10': 0.8627, 'compress@10': 0.5895, 'time@10': 6.7176}:  40%|████      | 4/10 [00:20<00:30,  5.11s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0357, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8509, 'compress@10': 0.6701, 'time@10': 8.0359}:  40%|████      | 4/10 [00:26<00:30,  5.11s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0357, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8509, 'compress@10': 0.6701, 'time@10': 8.0359}:  50%|█████     | 5/10 [00:26<00:28,  5.68s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0363, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8541, 'compress@10': 0.7113, 'time@10': 8.2868}:  50%|█████     | 5/10 [00:36<00:28,  5.68s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0363, 'hit_ratio@10': 0.8498, 'ndcg@10': 0.8541, 'compress@10': 0.7113, 'time@10': 8.2868}:  60%|██████    | 6/10 [00:36<00:28,  7.01s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0362, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8571, 'compress@10': 0.6565, 'time@10': 8.6478}:  60%|██████    | 6/10 [00:41<00:28,  7.01s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0362, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.8571, 'compress@10': 0.6565, 'time@10': 8.6478}:  70%|███████   | 7/10 [00:41<00:19,  6.50s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0351, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8604, 'compress@10': 0.6238, 'time@10': 8.5488}:  70%|███████   | 7/10 [00:49<00:19,  6.50s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0351, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.8604, 'compress@10': 0.6238, 'time@10': 8.5488}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.036, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8786, 'compress@10': 0.5983, 'time@10': 8.9836}:  80%|████████  | 8/10 [00:55<00:13,  6.94s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.036, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8786, 'compress@10': 0.5983, 'time@10': 8.9836}:  90%|█████████ | 9/10 [00:55<00:06,  6.73s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0341, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8834, 'compress@10': 0.5551, 'time@10': 9.0181}:  90%|█████████ | 9/10 [01:05<00:06,  6.73s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.0341, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8834, 'compress@10': 0.5551, 'time@10': 9.0181}: 100%|██████████| 10/10 [01:05<00:00,  7.54s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0341, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8834, 'compress@10': 0.5551, 'time@10': 9.0181}: 100%|██████████| 10/10 [01:05<00:00,  6.53s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03406856102031192
Avg hit ratio: 0.8779198778961088
Avg ndcg: 0.8834318066342733
Avg compression ratio: 0.5550608859909268
Avg train time: 9.01811101436615
Std train time: 2.4709067305198773
[0.7785714285714286, 0.4214285714285714, 0.1357142857142857, 0.8499999999999999, 0.9928571428571428, 0.9214285714285714, 0.2785714285714285, 0.35000000000000003, 0.42142857142857143, 0.13571428571428573]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8456, 'compress@10': 0.7902, 'time@10': 8.2383}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0438, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8456, 'compress@10': 0.7902, 'time@10': 8.2383}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8689, 'compress@10': 0.6152, 'time@10': 7.8372}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0362, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8689, 'compress@10': 0.6152, 'time@10': 7.8372}:  20%|██        | 2/10 [00:11<00:48,  6.11s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.865, 'compress@10': 0.4965, 'time@10': 6.9386}:  20%|██        | 2/10 [00:14<00:48,  6.11s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.865, 'compress@10': 0.4965, 'time@10': 6.9386}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8637, 'compress@10': 0.5862, 'time@10': 6.6912}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8637, 'compress@10': 0.5862, 'time@10': 6.6912}:  40%|████      | 4/10 [00:20<00:30,  5.11s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0336, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.8544, 'compress@10': 0.6676, 'time@10': 7.9069}:  40%|████      | 4/10 [00:26<00:30,  5.11s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0336, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.8544, 'compress@10': 0.6676, 'time@10': 7.9069}:  50%|█████     | 5/10 [00:26<00:27,  5.58s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0332, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8598, 'compress@10': 0.7102, 'time@10': 8.1201}:  50%|█████     | 5/10 [00:35<00:27,  5.58s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0332, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.8598, 'compress@10': 0.7102, 'time@10': 8.1201}:  60%|██████    | 6/10 [00:35<00:27,  6.82s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0322, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8652, 'compress@10': 0.6526, 'time@10': 8.495}:  60%|██████    | 6/10 [00:41<00:27,  6.82s/it] {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0322, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8652, 'compress@10': 0.6526, 'time@10': 8.495}:  70%|███████   | 7/10 [00:41<00:19,  6.36s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0319, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.8639, 'compress@10': 0.6171, 'time@10': 8.4188}:  70%|███████   | 7/10 [00:49<00:19,  6.36s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0319, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.8639, 'compress@10': 0.6171, 'time@10': 8.4188}:  80%|████████  | 8/10 [00:49<00:13,  6.86s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.033, 'hit_ratio@10': 0.866, 'ndcg@10': 0.8824, 'compress@10': 0.5972, 'time@10': 8.8858}:  80%|████████  | 8/10 [00:55<00:13,  6.86s/it] {'epoch': 13, 'num_users': 6.3333, 'loss': 0.033, 'hit_ratio@10': 0.866, 'ndcg@10': 0.8824, 'compress@10': 0.5972, 'time@10': 8.8858}:  90%|█████████ | 9/10 [00:55<00:06,  6.70s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0323, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.8875, 'compress@10': 0.553, 'time@10': 8.965}:  90%|█████████ | 9/10 [01:05<00:06,  6.70s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0323, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.8875, 'compress@10': 0.553, 'time@10': 8.965}: 100%|██████████| 10/10 [01:05<00:00,  7.63s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0323, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.8875, 'compress@10': 0.553, 'time@10': 8.965}: 100%|██████████| 10/10 [01:05<00:00,  6.53s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.032258638814270005
Avg hit ratio: 0.8771011644458164
Avg ndcg: 0.8874613123592866
Avg compression ratio: 0.5530312472435063
Avg train time: 8.964992594718932
Std train time: 2.435482049280014
[0.7933333333333333, 0.39333333333333326, 0.12666666666666665, 0.8599999999999999, 0.9933333333333333, 0.9266666666666666, 0.25999999999999995, 0.3266666666666667, 0.46, 0.12666666666666668]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8506, 'compress@10': 0.8042, 'time@10': 8.3247}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8506, 'compress@10': 0.8042, 'time@10': 8.3247}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8763, 'compress@10': 0.6085, 'time@10': 7.6857}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0343, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8763, 'compress@10': 0.6085, 'time@10': 7.6857}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8699, 'compress@10': 0.4895, 'time@10': 6.9091}:  20%|██        | 2/10 [00:13<00:47,  5.90s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8699, 'compress@10': 0.4895, 'time@10': 6.9091}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8695, 'compress@10': 0.5834, 'time@10': 6.6749}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8695, 'compress@10': 0.5834, 'time@10': 6.6749}:  40%|████      | 4/10 [00:20<00:30,  5.06s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0312, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8591, 'compress@10': 0.6654, 'time@10': 7.8243}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0312, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8591, 'compress@10': 0.6654, 'time@10': 7.8243}:  50%|█████     | 5/10 [00:26<00:27,  5.49s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0309, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8644, 'compress@10': 0.7092, 'time@10': 8.0604}:  50%|█████     | 5/10 [00:35<00:27,  5.49s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0309, 'hit_ratio@10': 0.8544, 'ndcg@10': 0.8644, 'compress@10': 0.7092, 'time@10': 8.0604}:  60%|██████    | 6/10 [00:35<00:27,  6.78s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0308, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8701, 'compress@10': 0.6493, 'time@10': 8.3918}:  60%|██████    | 6/10 [00:40<00:27,  6.78s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0308, 'hit_ratio@10': 0.8695, 'ndcg@10': 0.8701, 'compress@10': 0.6493, 'time@10': 8.3918}:  70%|███████   | 7/10 [00:40<00:18,  6.27s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0298, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.8747, 'compress@10': 0.6113, 'time@10': 8.3146}:  70%|███████   | 7/10 [00:48<00:18,  6.27s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0298, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.8747, 'compress@10': 0.6113, 'time@10': 8.3146}:  80%|████████  | 8/10 [00:48<00:13,  6.76s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0305, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8854, 'compress@10': 0.5962, 'time@10': 8.7827}:  80%|████████  | 8/10 [00:54<00:13,  6.76s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0305, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8854, 'compress@10': 0.5962, 'time@10': 8.7827}:  90%|█████████ | 9/10 [00:54<00:06,  6.62s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0305, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.8873, 'compress@10': 0.5513, 'time@10': 8.8454}:  90%|█████████ | 9/10 [01:04<00:06,  6.62s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 0.0305, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.8873, 'compress@10': 0.5513, 'time@10': 8.8454}: 100%|██████████| 10/10 [01:04<00:00,  7.49s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0305, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.8873, 'compress@10': 0.5513, 'time@10': 8.8454}: 100%|██████████| 10/10 [01:04<00:00,  6.43s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.03049381842925255
Avg hit ratio: 0.8778154501601021
Avg ndcg: 0.8873477956213435
Avg compression ratio: 0.5512698824052195
Avg train time: 8.845399379730225
Std train time: 2.329484759881438
[0.80625, 0.3687499999999999, 0.11874999999999998, 0.8687499999999999, 0.9937499999999999, 0.86875, 0.24374999999999997, 0.30625, 0.49375, 0.18125000000000002]
[10, 10, 20, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8781, 'compress@10': 0.8164, 'time@10': 7.9812}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0349, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8781, 'compress@10': 0.8164, 'time@10': 7.9812}:  10%|█         | 1/10 [00:04<00:36,  4.03s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.897, 'compress@10': 0.6028, 'time@10': 7.4429}:  10%|█         | 1/10 [00:10<00:36,  4.03s/it]   {'epoch': 15, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.897, 'compress@10': 0.6028, 'time@10': 7.4429}:  20%|██        | 2/10 [00:10<00:45,  5.74s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8837, 'compress@10': 0.4834, 'time@10': 6.671}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8837, 'compress@10': 0.4834, 'time@10': 6.671}:  30%|███       | 3/10 [00:13<00:30,  4.31s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8867, 'compress@10': 0.5809, 'time@10': 6.477}:  30%|███       | 3/10 [00:19<00:30,  4.31s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0239, 'hit_ratio@10': 0.8479, 'ndcg@10': 0.8867, 'compress@10': 0.5809, 'time@10': 6.477}:  40%|████      | 4/10 [00:19<00:29,  4.95s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.874, 'compress@10': 0.6635, 'time@10': 7.7797}:  40%|████      | 4/10 [00:26<00:29,  4.95s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.8583, 'ndcg@10': 0.874, 'compress@10': 0.6635, 'time@10': 7.7797}:  50%|█████     | 5/10 [00:26<00:27,  5.52s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0306, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8783, 'compress@10': 0.6982, 'time@10': 8.1659}:  50%|█████     | 5/10 [00:36<00:27,  5.52s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0306, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8783, 'compress@10': 0.6982, 'time@10': 8.1659}:  60%|██████    | 6/10 [00:36<00:28,  7.09s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0311, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8808, 'compress@10': 0.6376, 'time@10': 8.5211}:  60%|██████    | 6/10 [00:41<00:28,  7.09s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0311, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8808, 'compress@10': 0.6376, 'time@10': 8.5211}:  70%|███████   | 7/10 [00:41<00:19,  6.53s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0301, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.883, 'compress@10': 0.5987, 'time@10': 8.4543}:  70%|███████   | 7/10 [00:49<00:19,  6.53s/it]  {'epoch': 15, 'num_users': 6.125, 'loss': 0.0301, 'hit_ratio@10': 0.8973, 'ndcg@10': 0.883, 'compress@10': 0.5987, 'time@10': 8.4543}:  80%|████████  | 8/10 [00:49<00:14,  7.01s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0303, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8896, 'compress@10': 0.5886, 'time@10': 8.9627}:  80%|████████  | 8/10 [00:56<00:14,  7.01s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0303, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8896, 'compress@10': 0.5886, 'time@10': 8.9627}:  90%|█████████ | 9/10 [00:56<00:06,  6.86s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0284, 'hit_ratio@10': 0.887, 'ndcg@10': 0.8954, 'compress@10': 0.5497, 'time@10': 9.016}:  90%|█████████ | 9/10 [01:05<00:06,  6.86s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 0.0284, 'hit_ratio@10': 0.887, 'ndcg@10': 0.8954, 'compress@10': 0.5497, 'time@10': 9.016}: 100%|██████████| 10/10 [01:05<00:00,  7.69s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0284, 'hit_ratio@10': 0.887, 'ndcg@10': 0.8954, 'compress@10': 0.5497, 'time@10': 9.016}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.028363794614468623
Avg hit ratio: 0.8870187002207377
Avg ndcg: 0.8953565404859672
Avg compression ratio: 0.5497282797706216
Avg train time: 9.016017055511474
Std train time: 2.5969300405741365
[0.8176470588235294, 0.3470588235294117, 0.11176470588235292, 0.876470588235294, 0.9941176470588234, 0.8764705882352941, 0.28823529411764703, 0.2882352941176471, 0.4647058823529412, 0.17058823529411768]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8738, 'compress@10': 0.8272, 'time@10': 8.0672}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8738, 'compress@10': 0.8272, 'time@10': 8.0672}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.893, 'compress@10': 0.5977, 'time@10': 7.5198}:  10%|█         | 1/10 [00:11<00:36,  4.08s/it] {'epoch': 16, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.893, 'compress@10': 0.5977, 'time@10': 7.5198}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.881, 'compress@10': 0.478, 'time@10': 6.7669}:  20%|██        | 2/10 [00:13<00:46,  5.80s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.881, 'compress@10': 0.478, 'time@10': 6.7669}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8929, 'compress@10': 0.5787, 'time@10': 6.4734}:  30%|███       | 3/10 [00:19<00:30,  4.37s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0249, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8929, 'compress@10': 0.5787, 'time@10': 6.4734}:  40%|████      | 4/10 [00:19<00:29,  4.87s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0293, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8815, 'compress@10': 0.6618, 'time@10': 7.7069}:  40%|████      | 4/10 [00:25<00:29,  4.87s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0293, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8815, 'compress@10': 0.6618, 'time@10': 7.7069}:  50%|█████     | 5/10 [00:25<00:27,  5.41s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0292, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8886, 'compress@10': 0.6981, 'time@10': 8.1189}:  50%|█████     | 5/10 [00:35<00:27,  5.41s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0292, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8886, 'compress@10': 0.6981, 'time@10': 8.1189}:  60%|██████    | 6/10 [00:35<00:28,  7.04s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.892, 'ndcg@10': 0.8891, 'compress@10': 0.6436, 'time@10': 8.5189}:  60%|██████    | 6/10 [00:41<00:28,  7.04s/it] {'epoch': 16, 'num_users': 6.2857, 'loss': 0.0287, 'hit_ratio@10': 0.892, 'ndcg@10': 0.8891, 'compress@10': 0.6436, 'time@10': 8.5189}:  70%|███████   | 7/10 [00:41<00:19,  6.54s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0281, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.8907, 'compress@10': 0.6017, 'time@10': 8.4198}:  70%|███████   | 7/10 [00:49<00:19,  6.54s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0281, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.8907, 'compress@10': 0.6017, 'time@10': 8.4198}:  80%|████████  | 8/10 [00:49<00:13,  6.93s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.897, 'compress@10': 0.5882, 'time@10': 8.9041}:  80%|████████  | 8/10 [00:55<00:13,  6.93s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.897, 'compress@10': 0.5882, 'time@10': 8.9041}:  90%|█████████ | 9/10 [00:55<00:06,  6.77s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0288, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.8997, 'compress@10': 0.5483, 'time@10': 8.9795}:  90%|█████████ | 9/10 [01:05<00:06,  6.77s/it]  {'epoch': 16, 'num_users': 6.3, 'loss': 0.0288, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.8997, 'compress@10': 0.5483, 'time@10': 8.9795}: 100%|██████████| 10/10 [01:05<00:00,  7.67s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0288, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.8997, 'compress@10': 0.5483, 'time@10': 8.9795}: 100%|██████████| 10/10 [01:05<00:00,  6.53s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.028846306978575043
Avg hit ratio: 0.8935675724011887
Avg ndcg: 0.8997068585601076
Avg compression ratio: 0.5483044580927381
Avg train time: 8.979473686218261
Std train time: 2.5538806094457396
[0.8277777777777777, 0.3277777777777777, 0.10555555555555554, 0.8833333333333332, 0.9944444444444444, 0.8277777777777777, 0.2722222222222222, 0.27222222222222225, 0.49444444444444446, 0.2166666666666667]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8706, 'compress@10': 0.8368, 'time@10': 8.0551}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0385, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8706, 'compress@10': 0.8368, 'time@10': 8.0551}:  10%|█         | 1/10 [00:04<00:36,  4.06s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8951, 'compress@10': 0.5931, 'time@10': 7.495}:  10%|█         | 1/10 [00:11<00:36,  4.06s/it] {'epoch': 17, 'num_users': 7.0, 'loss': 0.0323, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8951, 'compress@10': 0.5931, 'time@10': 7.495}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8824, 'compress@10': 0.4732, 'time@10': 6.9354}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0216, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8824, 'compress@10': 0.4732, 'time@10': 6.9354}:  30%|███       | 3/10 [00:13<00:31,  4.48s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8788, 'compress@10': 0.5768, 'time@10': 6.6778}:  30%|███       | 3/10 [00:19<00:31,  4.48s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8788, 'compress@10': 0.5768, 'time@10': 6.6778}:  40%|████      | 4/10 [00:19<00:30,  5.06s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8711, 'compress@10': 0.6603, 'time@10': 7.8584}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]  {'epoch': 17, 'num_users': 5.8, 'loss': 0.0295, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8711, 'compress@10': 0.6603, 'time@10': 7.8584}:  50%|█████     | 5/10 [00:26<00:27,  5.52s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0278, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8816, 'compress@10': 0.6889, 'time@10': 8.2512}:  50%|█████     | 5/10 [00:36<00:27,  5.52s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0278, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8816, 'compress@10': 0.6889, 'time@10': 8.2512}:  60%|██████    | 6/10 [00:36<00:28,  7.13s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0268, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8864, 'compress@10': 0.6335, 'time@10': 8.695}:  60%|██████    | 6/10 [00:42<00:28,  7.13s/it] {'epoch': 17, 'num_users': 6.2857, 'loss': 0.0268, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8864, 'compress@10': 0.6335, 'time@10': 8.695}:  70%|███████   | 7/10 [00:42<00:20,  6.67s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8893, 'compress@10': 0.591, 'time@10': 8.5842}:  70%|███████   | 7/10 [00:50<00:20,  6.67s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0261, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8893, 'compress@10': 0.591, 'time@10': 8.5842}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9013, 'compress@10': 0.5818, 'time@10': 9.0245}:  80%|████████  | 8/10 [00:56<00:14,  7.04s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9013, 'compress@10': 0.5818, 'time@10': 9.0245}:  90%|█████████ | 9/10 [00:56<00:06,  6.81s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9051, 'compress@10': 0.5471, 'time@10': 9.0735}:  90%|█████████ | 9/10 [01:05<00:06,  6.81s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9051, 'compress@10': 0.5471, 'time@10': 9.0735}: 100%|██████████| 10/10 [01:05<00:00,  7.66s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9051, 'compress@10': 0.5471, 'time@10': 9.0735}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02635485446886147
Avg hit ratio: 0.8906873880693915
Avg ndcg: 0.9051133708407159
Avg compression ratio: 0.5470965329799262
Avg train time: 9.073539233207702
Std train time: 2.427814895534313
[0.8368421052631578, 0.36315789473684207, 0.09999999999999999, 0.8894736842105262, 0.994736842105263, 0.7842105263157895, 0.25789473684210523, 0.2578947368421053, 0.5210526315789474, 0.20526315789473687]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0364, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8719, 'compress@10': 0.8454, 'time@10': 8.3633}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0364, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8719, 'compress@10': 0.8454, 'time@10': 8.3633}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8968, 'compress@10': 0.6146, 'time@10': 7.7826}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.8968, 'compress@10': 0.6146, 'time@10': 7.7826}:  20%|██        | 2/10 [00:11<00:47,  6.00s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8836, 'compress@10': 0.4859, 'time@10': 7.1436}:  20%|██        | 2/10 [00:14<00:47,  6.00s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.021, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8836, 'compress@10': 0.4859, 'time@10': 7.1436}:  30%|███       | 3/10 [00:14<00:32,  4.61s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8851, 'compress@10': 0.5878, 'time@10': 6.8022}:  30%|███       | 3/10 [00:20<00:32,  4.61s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8851, 'compress@10': 0.5878, 'time@10': 6.8022}:  40%|████      | 4/10 [00:20<00:30,  5.09s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0264, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8774, 'compress@10': 0.6692, 'time@10': 7.876}:  40%|████      | 4/10 [00:26<00:30,  5.09s/it]   {'epoch': 18, 'num_users': 5.8, 'loss': 0.0264, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8774, 'compress@10': 0.6692, 'time@10': 7.876}:  50%|█████     | 5/10 [00:26<00:27,  5.46s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0274, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8852, 'compress@10': 0.6892, 'time@10': 8.231}:  50%|█████     | 5/10 [00:36<00:27,  5.46s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0274, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8852, 'compress@10': 0.6892, 'time@10': 8.231}:  60%|██████    | 6/10 [00:36<00:28,  7.02s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0278, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8895, 'compress@10': 0.6318, 'time@10': 8.6085}:  60%|██████    | 6/10 [00:41<00:28,  7.02s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0278, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8895, 'compress@10': 0.6318, 'time@10': 8.6085}:  70%|███████   | 7/10 [00:41<00:19,  6.52s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0267, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8923, 'compress@10': 0.5877, 'time@10': 8.4888}:  70%|███████   | 7/10 [00:49<00:19,  6.52s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0267, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.8923, 'compress@10': 0.5877, 'time@10': 8.4888}:  80%|████████  | 8/10 [00:49<00:13,  6.89s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9076, 'compress@10': 0.5818, 'time@10': 8.9194}:  80%|████████  | 8/10 [00:55<00:13,  6.89s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0274, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9076, 'compress@10': 0.5818, 'time@10': 8.9194}:  90%|█████████ | 9/10 [00:55<00:06,  6.68s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0265, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9116, 'compress@10': 0.546, 'time@10': 8.9387}:  90%|█████████ | 9/10 [01:05<00:06,  6.68s/it]    {'epoch': 18, 'num_users': 6.3, 'loss': 0.0265, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9116, 'compress@10': 0.546, 'time@10': 8.9387}: 100%|██████████| 10/10 [01:05<00:00,  7.53s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0265, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9116, 'compress@10': 0.546, 'time@10': 8.9387}: 100%|██████████| 10/10 [01:05<00:00,  6.52s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.026512065637690162
Avg hit ratio: 0.8935445309265344
Avg ndcg: 0.9115652627092554
Avg compression ratio: 0.5459664841925939
Avg train time: 8.938679456710815
Std train time: 2.270271776069392
[0.845, 0.345, 0.09499999999999999, 0.8449999999999999, 0.9949999999999999, 0.795, 0.295, 0.24500000000000002, 0.545, 0.19500000000000003]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8826, 'compress@10': 0.8531, 'time@10': 8.3331}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8826, 'compress@10': 0.8531, 'time@10': 8.3331}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9168, 'compress@10': 0.6096, 'time@10': 7.7229}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9168, 'compress@10': 0.6096, 'time@10': 7.7229}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8969, 'compress@10': 0.4812, 'time@10': 6.9822}:  20%|██        | 2/10 [00:14<00:47,  5.94s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8969, 'compress@10': 0.4812, 'time@10': 6.9822}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8994, 'compress@10': 0.5735, 'time@10': 6.7075}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8994, 'compress@10': 0.5735, 'time@10': 6.7075}:  40%|████      | 4/10 [00:20<00:30,  5.06s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0233, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8911, 'compress@10': 0.6578, 'time@10': 7.8512}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]  {'epoch': 19, 'num_users': 5.8, 'loss': 0.0233, 'hit_ratio@10': 0.86, 'ndcg@10': 0.8911, 'compress@10': 0.6578, 'time@10': 7.8512}:  50%|█████     | 5/10 [00:26<00:27,  5.49s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8998, 'compress@10': 0.6815, 'time@10': 8.197}:  50%|█████     | 5/10 [00:36<00:27,  5.49s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.8998, 'compress@10': 0.6815, 'time@10': 8.197}:  60%|██████    | 6/10 [00:36<00:28,  7.01s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0237, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8993, 'compress@10': 0.6303, 'time@10': 8.5927}:  60%|██████    | 6/10 [00:41<00:28,  7.01s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0237, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8993, 'compress@10': 0.6303, 'time@10': 8.5927}:  70%|███████   | 7/10 [00:41<00:19,  6.52s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0229, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9026, 'compress@10': 0.5848, 'time@10': 8.4931}:  70%|███████   | 7/10 [00:49<00:19,  6.52s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0229, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9026, 'compress@10': 0.5848, 'time@10': 8.4931}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9116, 'compress@10': 0.5818, 'time@10': 8.9877}:  80%|████████  | 8/10 [00:56<00:13,  6.94s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9116, 'compress@10': 0.5818, 'time@10': 8.9877}:  90%|█████████ | 9/10 [00:56<00:06,  6.81s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9103, 'compress@10': 0.545, 'time@10': 9.0248}:  90%|█████████ | 9/10 [01:05<00:06,  6.81s/it]    {'epoch': 19, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9103, 'compress@10': 0.545, 'time@10': 9.0248}: 100%|██████████| 10/10 [01:05<00:00,  7.61s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0241, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9103, 'compress@10': 0.545, 'time@10': 9.0248}: 100%|██████████| 10/10 [01:05<00:00,  6.55s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.02410324960309162
Avg hit ratio: 0.8935445309265344
Avg ndcg: 0.9102607033557287
Avg compression ratio: 0.5449796011813961
Avg train time: 9.024785590171813
Std train time: 2.440486932879657
[0.8523809523809524, 0.32857142857142857, 0.09047619047619046, 0.8047619047619047, 0.9952380952380951, 0.8047619047619048, 0.28095238095238095, 0.23333333333333336, 0.5666666666666667, 0.23333333333333336]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8826, 'compress@10': 0.8601, 'time@10': 7.929}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0285, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8826, 'compress@10': 0.8601, 'time@10': 7.929}:  10%|█         | 1/10 [00:04<00:36,  4.01s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9182, 'compress@10': 0.6052, 'time@10': 7.5012}:  10%|█         | 1/10 [00:11<00:36,  4.01s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9182, 'compress@10': 0.6052, 'time@10': 7.5012}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8978, 'compress@10': 0.4769, 'time@10': 6.7942}:  20%|██        | 2/10 [00:13<00:46,  5.83s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8978, 'compress@10': 0.4769, 'time@10': 6.7942}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9061, 'compress@10': 0.5606, 'time@10': 6.591}:  30%|███       | 3/10 [00:19<00:30,  4.42s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0179, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9061, 'compress@10': 0.5606, 'time@10': 6.591}:  40%|████      | 4/10 [00:19<00:30,  5.05s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.8972, 'compress@10': 0.6476, 'time@10': 7.7569}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.8972, 'compress@10': 0.6476, 'time@10': 7.7569}:  50%|█████     | 5/10 [00:26<00:27,  5.48s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0202, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9066, 'compress@10': 0.6745, 'time@10': 8.1429}:  50%|█████     | 5/10 [00:36<00:27,  5.48s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0202, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9066, 'compress@10': 0.6745, 'time@10': 8.1429}:  60%|██████    | 6/10 [00:36<00:28,  7.05s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0197, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9099, 'compress@10': 0.6224, 'time@10': 8.5497}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0197, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.9099, 'compress@10': 0.6224, 'time@10': 8.5497}:  70%|███████   | 7/10 [00:41<00:19,  6.56s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0197, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9084, 'compress@10': 0.5765, 'time@10': 8.4709}:  70%|███████   | 7/10 [00:49<00:19,  6.56s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0197, 'hit_ratio@10': 0.9162, 'ndcg@10': 0.9084, 'compress@10': 0.5765, 'time@10': 8.4709}:  80%|████████  | 8/10 [00:49<00:14,  7.00s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0204, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9135, 'compress@10': 0.5768, 'time@10': 8.9065}:  80%|████████  | 8/10 [00:55<00:14,  7.00s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0204, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9135, 'compress@10': 0.5768, 'time@10': 8.9065}:  90%|█████████ | 9/10 [00:55<00:06,  6.76s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9192, 'compress@10': 0.5442, 'time@10': 8.9993}:  90%|█████████ | 9/10 [01:05<00:06,  6.76s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9192, 'compress@10': 0.5442, 'time@10': 8.9993}: 100%|██████████| 10/10 [01:05<00:00,  7.72s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9192, 'compress@10': 0.5442, 'time@10': 8.9993}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.019096445549420606
Avg hit ratio: 0.9106873880693914
Avg ndcg: 0.9191991754095351
Avg compression ratio: 0.5441677611082867
Avg train time: 8.999344515800477
Std train time: 2.39275764918516
[0.859090909090909, 0.31363636363636366, 0.08636363636363635, 0.8136363636363636, 0.9954545454545454, 0.7681818181818182, 0.2681818181818182, 0.2681818181818182, 0.5863636363636363, 0.22272727272727275]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8848, 'compress@10': 0.8665, 'time@10': 7.8443}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0282, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8848, 'compress@10': 0.8665, 'time@10': 7.8443}:  10%|█         | 1/10 [00:03<00:35,  3.96s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.918, 'compress@10': 0.6011, 'time@10': 7.5104}:  10%|█         | 1/10 [00:11<00:35,  3.96s/it] {'epoch': 21, 'num_users': 7.0, 'loss': 0.0212, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.918, 'compress@10': 0.6011, 'time@10': 7.5104}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8977, 'compress@10': 0.4731, 'time@10': 6.7488}:  20%|██        | 2/10 [00:13<00:46,  5.87s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8977, 'compress@10': 0.4731, 'time@10': 6.7488}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9007, 'compress@10': 0.5599, 'time@10': 6.5634}:  30%|███       | 3/10 [00:19<00:30,  4.40s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9007, 'compress@10': 0.5599, 'time@10': 6.5634}:  40%|████      | 4/10 [00:19<00:30,  5.05s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8942, 'compress@10': 0.647, 'time@10': 7.7138}:  40%|████      | 4/10 [00:26<00:30,  5.05s/it] {'epoch': 21, 'num_users': 5.8, 'loss': 0.0224, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8942, 'compress@10': 0.647, 'time@10': 7.7138}:  50%|█████     | 5/10 [00:26<00:27,  5.46s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0236, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9039, 'compress@10': 0.668, 'time@10': 8.1124}:  50%|█████     | 5/10 [00:36<00:27,  5.46s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0236, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9039, 'compress@10': 0.668, 'time@10': 8.1124}:  60%|██████    | 6/10 [00:36<00:28,  7.05s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9054, 'compress@10': 0.6151, 'time@10': 8.4971}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9054, 'compress@10': 0.6151, 'time@10': 8.4971}:  70%|███████   | 7/10 [00:41<00:19,  6.53s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0235, 'hit_ratio@10': 0.917, 'ndcg@10': 0.9043, 'compress@10': 0.5744, 'time@10': 8.3904}:  70%|███████   | 7/10 [00:49<00:19,  6.53s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0235, 'hit_ratio@10': 0.917, 'ndcg@10': 0.9043, 'compress@10': 0.5744, 'time@10': 8.3904}:  80%|████████  | 8/10 [00:49<00:13,  6.89s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9102, 'compress@10': 0.577, 'time@10': 8.8509}:  80%|████████  | 8/10 [00:55<00:13,  6.89s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0235, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9102, 'compress@10': 0.577, 'time@10': 8.8509}:  90%|█████████ | 9/10 [00:55<00:06,  6.71s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9163, 'compress@10': 0.5433, 'time@10': 8.9391}:  90%|█████████ | 9/10 [01:05<00:06,  6.71s/it]  {'epoch': 21, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9163, 'compress@10': 0.5433, 'time@10': 8.9391}: 100%|██████████| 10/10 [01:05<00:00,  7.65s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0247, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9163, 'compress@10': 0.5433, 'time@10': 8.9391}: 100%|██████████| 10/10 [01:05<00:00,  6.54s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.02470677817651242
Avg hit ratio: 0.9084810388630423
Avg ndcg: 0.9163303276198185
Avg compression ratio: 0.5433419233696006
Avg train time: 8.939105200767518
Std train time: 2.411765450807924
[0.8652173913043477, 0.30000000000000004, 0.0826086956521739, 0.8217391304347825, 0.9956521739130434, 0.7782608695652175, 0.2565217391304348, 0.2565217391304348, 0.5608695652173913, 0.2565217391304348]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8871, 'compress@10': 0.8723, 'time@10': 8.2723}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8871, 'compress@10': 0.8723, 'time@10': 8.2723}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.918, 'compress@10': 0.5974, 'time@10': 7.6817}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.918, 'compress@10': 0.5974, 'time@10': 7.6817}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8977, 'compress@10': 0.4695, 'time@10': 6.9055}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.8977, 'compress@10': 0.4695, 'time@10': 6.9055}:  30%|███       | 3/10 [00:14<00:31,  4.45s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8952, 'compress@10': 0.5592, 'time@10': 6.6673}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.8952, 'compress@10': 0.5592, 'time@10': 6.6673}:  40%|████      | 4/10 [00:20<00:30,  5.07s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.8911, 'compress@10': 0.6465, 'time@10': 7.7808}:  40%|████      | 4/10 [00:26<00:30,  5.07s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.8911, 'compress@10': 0.6465, 'time@10': 7.7808}:  50%|█████     | 5/10 [00:26<00:27,  5.46s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0217, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9016, 'compress@10': 0.6693, 'time@10': 8.2056}:  50%|█████     | 5/10 [00:36<00:27,  5.46s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0217, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9016, 'compress@10': 0.6693, 'time@10': 8.2056}:  60%|██████    | 6/10 [00:36<00:28,  7.13s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9036, 'compress@10': 0.6145, 'time@10': 8.6107}:  60%|██████    | 6/10 [00:42<00:28,  7.13s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9036, 'compress@10': 0.6145, 'time@10': 8.6107}:  70%|███████   | 7/10 [00:42<00:19,  6.61s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.9215, 'ndcg@10': 0.9053, 'compress@10': 0.5724, 'time@10': 8.5308}:  70%|███████   | 7/10 [00:50<00:19,  6.61s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.9215, 'ndcg@10': 0.9053, 'compress@10': 0.5724, 'time@10': 8.5308}:  80%|████████  | 8/10 [00:50<00:14,  7.06s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0208, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9108, 'compress@10': 0.5726, 'time@10': 8.9839}:  80%|████████  | 8/10 [00:56<00:14,  7.06s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0208, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9108, 'compress@10': 0.5726, 'time@10': 8.9839}:  90%|█████████ | 9/10 [00:56<00:06,  6.84s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.9149, 'ndcg@10': 0.9155, 'compress@10': 0.5426, 'time@10': 9.0786}:  90%|█████████ | 9/10 [01:06<00:06,  6.84s/it]  {'epoch': 22, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.9149, 'ndcg@10': 0.9155, 'compress@10': 0.5426, 'time@10': 9.0786}: 100%|██████████| 10/10 [01:06<00:00,  7.80s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.9149, 'ndcg@10': 0.9155, 'compress@10': 0.5426, 'time@10': 9.0786}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.020222968908836632
Avg hit ratio: 0.9149096102916137
Avg ndcg: 0.9154888700561592
Avg compression ratio: 0.5426428166958772
Avg train time: 9.0785573720932
Std train time: 2.409166305849868
[0.8708333333333332, 0.3291666666666667, 0.07916666666666665, 0.8291666666666666, 0.9958333333333332, 0.7458333333333333, 0.24583333333333335, 0.24583333333333335, 0.5791666666666666, 0.24583333333333335]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8913, 'compress@10': 0.8776, 'time@10': 8.1927}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8913, 'compress@10': 0.8776, 'time@10': 8.1927}:  10%|█         | 1/10 [00:04<00:37,  4.13s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9603, 'compress@10': 0.6142, 'time@10': 7.6214}:  10%|█         | 1/10 [00:11<00:37,  4.13s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9603, 'compress@10': 0.6142, 'time@10': 7.6214}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9259, 'compress@10': 0.4797, 'time@10': 7.0037}:  20%|██        | 2/10 [00:14<00:46,  5.87s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9259, 'compress@10': 0.4797, 'time@10': 7.0037}:  30%|███       | 3/10 [00:14<00:31,  4.52s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9251, 'compress@10': 0.5686, 'time@10': 6.7835}:  30%|███       | 3/10 [00:20<00:31,  4.52s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9251, 'compress@10': 0.5686, 'time@10': 6.7835}:  40%|████      | 4/10 [00:20<00:31,  5.17s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9159, 'compress@10': 0.6541, 'time@10': 7.893}:  40%|████      | 4/10 [00:26<00:31,  5.17s/it]  {'epoch': 23, 'num_users': 5.8, 'loss': 0.0199, 'hit_ratio@10': 0.864, 'ndcg@10': 0.9159, 'compress@10': 0.6541, 'time@10': 7.893}:  50%|█████     | 5/10 [00:26<00:27,  5.54s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9232, 'compress@10': 0.6703, 'time@10': 8.2544}:  50%|█████     | 5/10 [00:36<00:27,  5.54s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0185, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9232, 'compress@10': 0.6703, 'time@10': 8.2544}:  60%|██████    | 6/10 [00:36<00:28,  7.09s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9255, 'compress@10': 0.614, 'time@10': 8.6315}:  60%|██████    | 6/10 [00:42<00:28,  7.09s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9255, 'compress@10': 0.614, 'time@10': 8.6315}:  70%|███████   | 7/10 [00:42<00:19,  6.57s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9241, 'compress@10': 0.5706, 'time@10': 8.5474}:  70%|███████   | 7/10 [00:50<00:19,  6.57s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.9036, 'ndcg@10': 0.9241, 'compress@10': 0.5706, 'time@10': 8.5474}:  80%|████████  | 8/10 [00:50<00:14,  7.02s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.931, 'compress@10': 0.5729, 'time@10': 8.992}:  80%|████████  | 8/10 [00:56<00:14,  7.02s/it] {'epoch': 23, 'num_users': 6.3333, 'loss': 0.0186, 'hit_ratio@10': 0.8889, 'ndcg@10': 0.931, 'compress@10': 0.5729, 'time@10': 8.992}:  90%|█████████ | 9/10 [00:56<00:06,  6.80s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9335, 'compress@10': 0.5419, 'time@10': 9.0855}:  90%|█████████ | 9/10 [01:06<00:06,  6.80s/it] {'epoch': 23, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9335, 'compress@10': 0.5419, 'time@10': 9.0855}: 100%|██████████| 10/10 [01:06<00:00,  7.78s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9335, 'compress@10': 0.5419, 'time@10': 9.0855}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.018874111596487764
Avg hit ratio: 0.8977667531487565
Avg ndcg: 0.9334632852511369
Avg compression ratio: 0.5419314429349609
Avg train time: 9.085471177101136
Std train time: 2.3119380696642664
[0.8759999999999999, 0.35600000000000004, 0.07599999999999998, 0.7959999999999999, 0.9959999999999999, 0.716, 0.23600000000000002, 0.23600000000000002, 0.596, 0.276]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8993, 'compress@10': 0.8825, 'time@10': 7.9997}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0234, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8993, 'compress@10': 0.8825, 'time@10': 7.9997}:  10%|█         | 1/10 [00:04<00:36,  4.04s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9294, 'compress@10': 0.6296, 'time@10': 7.4796}:  10%|█         | 1/10 [00:11<00:36,  4.04s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9294, 'compress@10': 0.6296, 'time@10': 7.4796}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9053, 'compress@10': 0.4891, 'time@10': 6.7399}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9053, 'compress@10': 0.4891, 'time@10': 6.7399}:  30%|███       | 3/10 [00:13<00:30,  4.36s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8012, 'ndcg@10': 0.9123, 'compress@10': 0.5676, 'time@10': 6.5994}:  30%|███       | 3/10 [00:19<00:30,  4.36s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8012, 'ndcg@10': 0.9123, 'compress@10': 0.5676, 'time@10': 6.5994}:  40%|████      | 4/10 [00:19<00:30,  5.09s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.9052, 'compress@10': 0.6533, 'time@10': 7.8386}:  40%|████      | 4/10 [00:26<00:30,  5.09s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.9052, 'compress@10': 0.6533, 'time@10': 7.8386}:  50%|█████     | 5/10 [00:26<00:27,  5.58s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0177, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9155, 'compress@10': 0.6648, 'time@10': 8.2193}:  50%|█████     | 5/10 [00:36<00:27,  5.58s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0177, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9155, 'compress@10': 0.6648, 'time@10': 8.2193}:  60%|██████    | 6/10 [00:36<00:28,  7.13s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9172, 'compress@10': 0.6079, 'time@10': 8.5819}:  60%|██████    | 6/10 [00:41<00:28,  7.13s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0188, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9172, 'compress@10': 0.6079, 'time@10': 8.5819}:  70%|███████   | 7/10 [00:41<00:19,  6.57s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9177, 'compress@10': 0.5642, 'time@10': 8.4665}:  70%|███████   | 7/10 [00:49<00:19,  6.57s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9177, 'compress@10': 0.5642, 'time@10': 8.4665}:  80%|████████  | 8/10 [00:49<00:13,  6.93s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9266, 'compress@10': 0.569, 'time@10': 8.8987}:  80%|████████  | 8/10 [00:55<00:13,  6.93s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0196, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9266, 'compress@10': 0.569, 'time@10': 8.8987}:  90%|█████████ | 9/10 [00:55<00:06,  6.71s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.02, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9251, 'compress@10': 0.5413, 'time@10': 9.0004}:  90%|█████████ | 9/10 [01:05<00:06,  6.71s/it]    {'epoch': 24, 'num_users': 6.3, 'loss': 0.02, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9251, 'compress@10': 0.5413, 'time@10': 9.0004}: 100%|██████████| 10/10 [01:05<00:00,  7.71s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.02, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9251, 'compress@10': 0.5413, 'time@10': 9.0004}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.020004810727970817
Avg hit ratio: 0.8831123752685721
Avg ndcg: 0.925132882719363
Avg compression ratio: 0.5413323252026941
Avg train time: 9.000431418418884
Std train time: 2.444790470655712
[0.8423076923076922, 0.34230769230769237, 0.07307692307692307, 0.7653846153846153, 0.9961538461538461, 0.7269230769230769, 0.2653846153846154, 0.22692307692307695, 0.6115384615384615, 0.3038461538461539]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.91, 'compress@10': 0.8506, 'time@10': 7.9613}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.91, 'compress@10': 0.8506, 'time@10': 7.9613}:  10%|█         | 1/10 [00:04<00:36,  4.02s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9351, 'compress@10': 0.6071, 'time@10': 7.4623}:  10%|█         | 1/10 [00:11<00:36,  4.02s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9351, 'compress@10': 0.6071, 'time@10': 7.4623}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9091, 'compress@10': 0.4732, 'time@10': 6.7531}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9091, 'compress@10': 0.4732, 'time@10': 6.7531}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8012, 'ndcg@10': 0.9203, 'compress@10': 0.5483, 'time@10': 6.6614}:  30%|███       | 3/10 [00:20<00:30,  4.37s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8012, 'ndcg@10': 0.9203, 'compress@10': 0.5483, 'time@10': 6.6614}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.9143, 'compress@10': 0.6379, 'time@10': 7.7447}:  40%|████      | 4/10 [00:26<00:31,  5.18s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.9143, 'compress@10': 0.6379, 'time@10': 7.7447}:  50%|█████     | 5/10 [00:26<00:27,  5.50s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9225, 'compress@10': 0.6538, 'time@10': 8.1395}:  50%|█████     | 5/10 [00:36<00:27,  5.50s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9225, 'compress@10': 0.6538, 'time@10': 8.1395}:  60%|██████    | 6/10 [00:36<00:28,  7.08s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0169, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9234, 'compress@10': 0.6025, 'time@10': 8.614}:  60%|██████    | 6/10 [00:42<00:28,  7.08s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.0169, 'hit_ratio@10': 0.8689, 'ndcg@10': 0.9234, 'compress@10': 0.6025, 'time@10': 8.614}:  70%|███████   | 7/10 [00:42<00:19,  6.65s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9249, 'compress@10': 0.5583, 'time@10': 8.5138}:  70%|███████   | 7/10 [00:49<00:19,  6.65s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9249, 'compress@10': 0.5583, 'time@10': 8.5138}:  80%|████████  | 8/10 [00:49<00:14,  7.03s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0169, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9294, 'compress@10': 0.5654, 'time@10': 8.958}:  80%|████████  | 8/10 [00:56<00:14,  7.03s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0169, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.9294, 'compress@10': 0.5654, 'time@10': 8.958}:  90%|█████████ | 9/10 [00:56<00:06,  6.80s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9339, 'compress@10': 0.5409, 'time@10': 9.0838}:  90%|█████████ | 9/10 [01:06<00:06,  6.80s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9339, 'compress@10': 0.5409, 'time@10': 9.0838}: 100%|██████████| 10/10 [01:06<00:00,  7.87s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9339, 'compress@10': 0.5409, 'time@10': 9.0838}: 100%|██████████| 10/10 [01:06<00:00,  6.65s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.015428709102649346
Avg hit ratio: 0.8831123752685721
Avg ndcg: 0.9339435277787483
Avg compression ratio: 0.540866239871024
Avg train time: 9.08379144668579
Std train time: 2.396137220252902
[0.8481481481481481, 0.32962962962962966, 0.07037037037037036, 0.774074074074074, 0.9962962962962962, 0.737037037037037, 0.25555555555555554, 0.21851851851851856, 0.6259259259259259, 0.2925925925925926]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9145, 'compress@10': 0.8561, 'time@10': 8.1733}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9145, 'compress@10': 0.8561, 'time@10': 8.1733}:  10%|█         | 1/10 [00:04<00:37,  4.12s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.931, 'compress@10': 0.6037, 'time@10': 7.5381}:  10%|█         | 1/10 [00:11<00:37,  4.12s/it] {'epoch': 26, 'num_users': 7.0, 'loss': 0.0193, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.931, 'compress@10': 0.6037, 'time@10': 7.5381}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9064, 'compress@10': 0.4702, 'time@10': 6.7466}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9064, 'compress@10': 0.4702, 'time@10': 6.7466}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9081, 'compress@10': 0.5482, 'time@10': 6.6364}:  30%|███       | 3/10 [00:20<00:30,  4.34s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8173, 'ndcg@10': 0.9081, 'compress@10': 0.5482, 'time@10': 6.6364}:  40%|████      | 4/10 [00:20<00:30,  5.13s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.905, 'compress@10': 0.6378, 'time@10': 7.8307}:  40%|████      | 4/10 [00:26<00:30,  5.13s/it] {'epoch': 26, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8418, 'ndcg@10': 0.905, 'compress@10': 0.6378, 'time@10': 7.8307}:  50%|█████     | 5/10 [00:26<00:27,  5.57s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9151, 'compress@10': 0.6553, 'time@10': 8.1882}:  50%|█████     | 5/10 [00:36<00:27,  5.57s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.8645, 'ndcg@10': 0.9151, 'compress@10': 0.6553, 'time@10': 8.1882}:  60%|██████    | 6/10 [00:36<00:28,  7.08s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9202, 'compress@10': 0.6025, 'time@10': 8.5964}:  60%|██████    | 6/10 [00:41<00:28,  7.08s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.8781, 'ndcg@10': 0.9202, 'compress@10': 0.6025, 'time@10': 8.5964}:  70%|███████   | 7/10 [00:41<00:19,  6.58s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9222, 'compress@10': 0.5573, 'time@10': 8.5134}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9222, 'compress@10': 0.5573, 'time@10': 8.5134}:  80%|████████  | 8/10 [00:49<00:14,  7.03s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9265, 'compress@10': 0.5661, 'time@10': 8.9745}:  80%|████████  | 8/10 [00:56<00:14,  7.03s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9265, 'compress@10': 0.5661, 'time@10': 8.9745}:  90%|█████████ | 9/10 [00:56<00:06,  6.82s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9348, 'compress@10': 0.5403, 'time@10': 9.0585}:  90%|█████████ | 9/10 [01:06<00:06,  6.82s/it]    {'epoch': 26, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9348, 'compress@10': 0.5403, 'time@10': 9.0585}: 100%|██████████| 10/10 [01:06<00:00,  7.76s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9348, 'compress@10': 0.5403, 'time@10': 9.0585}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.01795328952244687
Avg hit ratio: 0.8867068453146552
Avg ndcg: 0.9348493298606728
Avg compression ratio: 0.5403393766885087
Avg train time: 9.058510756492614
Std train time: 2.457672715779249
[0.8535714285714285, 0.3535714285714286, 0.06785714285714285, 0.7821428571428571, 0.9964285714285713, 0.7107142857142857, 0.2464285714285714, 0.21071428571428574, 0.6035714285714285, 0.3178571428571429]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9145, 'compress@10': 0.8613, 'time@10': 8.2555}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0207, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9145, 'compress@10': 0.8613, 'time@10': 8.2555}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8506, 'ndcg@10': 1.0046, 'compress@10': 0.6178, 'time@10': 7.7376}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0255, 'hit_ratio@10': 0.8506, 'ndcg@10': 1.0046, 'compress@10': 0.6178, 'time@10': 7.7376}:  20%|██        | 2/10 [00:11<00:47,  5.99s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9554, 'compress@10': 0.4789, 'time@10': 6.9431}:  20%|██        | 2/10 [00:14<00:47,  5.99s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9554, 'compress@10': 0.4789, 'time@10': 6.9431}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9478, 'compress@10': 0.5567, 'time@10': 6.7284}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9478, 'compress@10': 0.5567, 'time@10': 6.7284}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.9391, 'compress@10': 0.6446, 'time@10': 7.824}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0188, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.9391, 'compress@10': 0.6446, 'time@10': 7.824}:  50%|█████     | 5/10 [00:26<00:27,  5.50s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0211, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.948, 'compress@10': 0.6567, 'time@10': 8.224}:  50%|█████     | 5/10 [00:36<00:27,  5.50s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0211, 'hit_ratio@10': 0.8591, 'ndcg@10': 0.948, 'compress@10': 0.6567, 'time@10': 8.224}:  60%|██████    | 6/10 [00:36<00:28,  7.12s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0217, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9461, 'compress@10': 0.6024, 'time@10': 8.6117}:  60%|██████    | 6/10 [00:42<00:28,  7.12s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0217, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9461, 'compress@10': 0.6024, 'time@10': 8.6117}:  70%|███████   | 7/10 [00:42<00:19,  6.59s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9445, 'compress@10': 0.5563, 'time@10': 8.4912}:  70%|███████   | 7/10 [00:49<00:19,  6.59s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8858, 'ndcg@10': 0.9445, 'compress@10': 0.5563, 'time@10': 8.4912}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9471, 'compress@10': 0.5628, 'time@10': 8.9207}:  80%|████████  | 8/10 [00:56<00:13,  6.94s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9471, 'compress@10': 0.5628, 'time@10': 8.9207}:  90%|█████████ | 9/10 [00:56<00:06,  6.71s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.02, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9489, 'compress@10': 0.5398, 'time@10': 9.0275}:  90%|█████████ | 9/10 [01:06<00:06,  6.71s/it]     {'epoch': 27, 'num_users': 6.3, 'loss': 0.02, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9489, 'compress@10': 0.5398, 'time@10': 9.0275}: 100%|██████████| 10/10 [01:06<00:00,  7.74s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.02, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9489, 'compress@10': 0.5398, 'time@10': 9.0275}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.020040977925620478
Avg hit ratio: 0.8863381817201852
Avg ndcg: 0.9489150810788661
Avg compression ratio: 0.539835076351629
Avg train time: 9.027470970153809
Std train time: 2.3477272678167416
[0.8241379310344827, 0.37586206896551727, 0.06551724137931034, 0.7896551724137931, 0.9965517241379309, 0.7206896551724138, 0.27241379310344827, 0.20344827586206898, 0.5827586206896551, 0.306896551724138]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9168, 'compress@10': 0.8334, 'time@10': 8.384}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9168, 'compress@10': 0.8334, 'time@10': 8.384}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9412, 'compress@10': 0.6147, 'time@10': 7.6534}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9412, 'compress@10': 0.6147, 'time@10': 7.6534}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9132, 'compress@10': 0.4761, 'time@10': 6.8335}:  20%|██        | 2/10 [00:13<00:46,  5.84s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.779, 'ndcg@10': 0.9132, 'compress@10': 0.4761, 'time@10': 6.8335}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.921, 'compress@10': 0.5564, 'time@10': 6.6415}:  30%|███       | 3/10 [00:19<00:30,  4.37s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.921, 'compress@10': 0.5564, 'time@10': 6.6415}:  40%|████      | 4/10 [00:19<00:30,  5.06s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9181, 'compress@10': 0.6444, 'time@10': 7.7795}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9181, 'compress@10': 0.6444, 'time@10': 7.7795}:  50%|█████     | 5/10 [00:26<00:27,  5.47s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0121, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9259, 'compress@10': 0.6582, 'time@10': 8.1665}:  50%|█████     | 5/10 [00:36<00:27,  5.47s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0121, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.9259, 'compress@10': 0.6582, 'time@10': 8.1665}:  60%|██████    | 6/10 [00:36<00:28,  7.06s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9262, 'compress@10': 0.6072, 'time@10': 8.557}:  60%|██████    | 6/10 [00:41<00:28,  7.06s/it] {'epoch': 28, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.9262, 'compress@10': 0.6072, 'time@10': 8.557}:  70%|███████   | 7/10 [00:41<00:19,  6.54s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9281, 'compress@10': 0.5596, 'time@10': 8.4581}:  70%|███████   | 7/10 [00:49<00:19,  6.54s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9281, 'compress@10': 0.5596, 'time@10': 8.4581}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9356, 'compress@10': 0.5635, 'time@10': 8.916}:  80%|████████  | 8/10 [00:55<00:13,  6.94s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.8841, 'ndcg@10': 0.9356, 'compress@10': 0.5635, 'time@10': 8.916}:  90%|█████████ | 9/10 [00:55<00:06,  6.75s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9409, 'compress@10': 0.5394, 'time@10': 9.0202}:  90%|█████████ | 9/10 [01:05<00:06,  6.75s/it]  {'epoch': 28, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9409, 'compress@10': 0.5394, 'time@10': 9.0202}: 100%|██████████| 10/10 [01:05<00:00,  7.75s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0146, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9409, 'compress@10': 0.5394, 'time@10': 9.0202}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01464475971598459
Avg hit ratio: 0.8934247152583316
Avg ndcg: 0.9409158618302664
Avg compression ratio: 0.5394106330889755
Avg train time: 9.02021291255951
Std train time: 2.4282660375734224
[0.83, 0.36333333333333334, 0.06333333333333332, 0.7633333333333333, 0.9966666666666666, 0.6966666666666667, 0.29666666666666663, 0.19666666666666668, 0.5966666666666666, 0.33000000000000007]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9208, 'compress@10': 0.8389, 'time@10': 8.4735}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9208, 'compress@10': 0.8389, 'time@10': 8.4735}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9428, 'compress@10': 0.6114, 'time@10': 7.7489}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9428, 'compress@10': 0.6114, 'time@10': 7.7489}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9142, 'compress@10': 0.4733, 'time@10': 6.8821}:  20%|██        | 2/10 [00:13<00:47,  5.91s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9142, 'compress@10': 0.4733, 'time@10': 6.8821}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9239, 'compress@10': 0.5479, 'time@10': 6.6998}:  30%|███       | 3/10 [00:20<00:30,  4.41s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9239, 'compress@10': 0.5479, 'time@10': 6.6998}:  40%|████      | 4/10 [00:20<00:30,  5.11s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9214, 'compress@10': 0.6377, 'time@10': 7.8064}:  40%|████      | 4/10 [00:26<00:30,  5.11s/it] {'epoch': 29, 'num_users': 5.8, 'loss': 0.013, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9214, 'compress@10': 0.6377, 'time@10': 7.8064}:  50%|█████     | 5/10 [00:26<00:27,  5.49s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9289, 'compress@10': 0.6486, 'time@10': 8.2293}:  50%|█████     | 5/10 [00:36<00:27,  5.49s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9289, 'compress@10': 0.6486, 'time@10': 8.2293}:  60%|██████    | 6/10 [00:36<00:28,  7.15s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9319, 'compress@10': 0.6024, 'time@10': 8.657}:  60%|██████    | 6/10 [00:42<00:28,  7.15s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9319, 'compress@10': 0.6024, 'time@10': 8.657}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9304, 'compress@10': 0.5545, 'time@10': 8.5267}:  70%|███████   | 7/10 [00:49<00:19,  6.66s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9304, 'compress@10': 0.5545, 'time@10': 8.5267}:  80%|████████  | 8/10 [00:49<00:13,  6.98s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9352, 'compress@10': 0.5605, 'time@10': 9.0132}:  80%|████████  | 8/10 [00:56<00:13,  6.98s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9352, 'compress@10': 0.5605, 'time@10': 9.0132}:  90%|█████████ | 9/10 [00:56<00:06,  6.83s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9365, 'compress@10': 0.539, 'time@10': 9.1107}:  90%|█████████ | 9/10 [01:06<00:06,  6.83s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9365, 'compress@10': 0.539, 'time@10': 9.1107}: 100%|██████████| 10/10 [01:06<00:00,  7.81s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9365, 'compress@10': 0.539, 'time@10': 9.1107}: 100%|██████████| 10/10 [01:06<00:00,  6.65s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.013596828683531426
Avg hit ratio: 0.8854810388630423
Avg ndcg: 0.9364965240691646
Avg compression ratio: 0.5389677557694437
Avg train time: 9.110704970359802
Std train time: 2.4968728306615606
[0.8354838709677419, 0.35161290322580646, 0.06129032258064515, 0.7709677419354839, 0.996774193548387, 0.6741935483870968, 0.28709677419354834, 0.1903225806451613, 0.6096774193548387, 0.3516129032258065]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9208, 'compress@10': 0.8441, 'time@10': 8.3181}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9208, 'compress@10': 0.8441, 'time@10': 8.3181}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.945, 'compress@10': 0.6083, 'time@10': 7.6868}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]  {'epoch': 30, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.945, 'compress@10': 0.6083, 'time@10': 7.6868}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9157, 'compress@10': 0.4707, 'time@10': 6.8472}:  20%|██        | 2/10 [00:13<00:47,  5.90s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9157, 'compress@10': 0.4707, 'time@10': 6.8472}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9242, 'compress@10': 0.5478, 'time@10': 6.6625}:  30%|███       | 3/10 [00:20<00:30,  4.40s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9242, 'compress@10': 0.5478, 'time@10': 6.6625}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9226, 'compress@10': 0.6376, 'time@10': 7.7716}:  40%|████      | 4/10 [00:26<00:30,  5.10s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9226, 'compress@10': 0.6376, 'time@10': 7.7716}:  50%|█████     | 5/10 [00:26<00:27,  5.47s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9341, 'compress@10': 0.6449, 'time@10': 8.1789}:  50%|█████     | 5/10 [00:36<00:27,  5.47s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0175, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9341, 'compress@10': 0.6449, 'time@10': 8.1789}:  60%|██████    | 6/10 [00:36<00:28,  7.10s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9365, 'compress@10': 0.5979, 'time@10': 8.6281}:  60%|██████    | 6/10 [00:42<00:28,  7.10s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0175, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.9365, 'compress@10': 0.5979, 'time@10': 8.6281}:  70%|███████   | 7/10 [00:42<00:19,  6.64s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0173, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9344, 'compress@10': 0.5498, 'time@10': 8.4916}:  70%|███████   | 7/10 [00:49<00:19,  6.64s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0173, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9344, 'compress@10': 0.5498, 'time@10': 8.4916}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9392, 'compress@10': 0.5577, 'time@10': 9.0353}:  80%|████████  | 8/10 [00:56<00:13,  6.94s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0175, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9392, 'compress@10': 0.5577, 'time@10': 9.0353}:  90%|█████████ | 9/10 [00:56<00:06,  6.87s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.944, 'compress@10': 0.5386, 'time@10': 9.1214}:  90%|█████████ | 9/10 [01:06<00:06,  6.87s/it]     {'epoch': 30, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.944, 'compress@10': 0.5386, 'time@10': 9.1214}: 100%|██████████| 10/10 [01:06<00:00,  7.82s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.944, 'compress@10': 0.5386, 'time@10': 9.1214}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.017025665270167446
Avg hit ratio: 0.8854810388630423
Avg ndcg: 0.9440085325081047
Avg compression ratio: 0.5385685882868314
Avg train time: 9.12142984867096
Std train time: 2.5785171820730395
[0.840625, 0.340625, 0.05937499999999999, 0.7781250000000001, 0.996875, 0.684375, 0.27812499999999996, 0.184375, 0.621875, 0.34062500000000007]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9208, 'compress@10': 0.849, 'time@10': 7.8549}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9208, 'compress@10': 0.849, 'time@10': 7.8549}:  10%|█         | 1/10 [00:03<00:35,  3.98s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9443, 'compress@10': 0.6054, 'time@10': 7.3751}:  10%|█         | 1/10 [00:10<00:35,  3.98s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9443, 'compress@10': 0.6054, 'time@10': 7.3751}:  20%|██        | 2/10 [00:10<00:45,  5.72s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9152, 'compress@10': 0.4682, 'time@10': 6.6527}:  20%|██        | 2/10 [00:13<00:45,  5.72s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9152, 'compress@10': 0.4682, 'time@10': 6.6527}:  30%|███       | 3/10 [00:13<00:30,  4.31s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9269, 'compress@10': 0.5477, 'time@10': 6.5127}:  30%|███       | 3/10 [00:19<00:30,  4.31s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9269, 'compress@10': 0.5477, 'time@10': 6.5127}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.926, 'compress@10': 0.6375, 'time@10': 7.7247}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.926, 'compress@10': 0.6375, 'time@10': 7.7247}:  50%|█████     | 5/10 [00:26<00:27,  5.50s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9341, 'compress@10': 0.6465, 'time@10': 8.1654}:  50%|█████     | 5/10 [00:36<00:27,  5.50s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.9341, 'compress@10': 0.6465, 'time@10': 8.1654}:  60%|██████    | 6/10 [00:36<00:28,  7.16s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9368, 'compress@10': 0.598, 'time@10': 8.5749}:  60%|██████    | 6/10 [00:41<00:28,  7.16s/it]  {'epoch': 31, 'num_users': 6.2857, 'loss': 0.0129, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9368, 'compress@10': 0.598, 'time@10': 8.5749}:  70%|███████   | 7/10 [00:41<00:19,  6.64s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9398, 'compress@10': 0.5492, 'time@10': 8.4697}:  70%|███████   | 7/10 [00:49<00:19,  6.64s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9398, 'compress@10': 0.5492, 'time@10': 8.4697}:  80%|████████  | 8/10 [00:49<00:13,  7.00s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9435, 'compress@10': 0.5585, 'time@10': 8.9246}:  80%|████████  | 8/10 [00:56<00:13,  7.00s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8883, 'ndcg@10': 0.9435, 'compress@10': 0.5585, 'time@10': 8.9246}:  90%|█████████ | 9/10 [00:56<00:06,  6.79s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.943, 'compress@10': 0.5382, 'time@10': 9.0258}:  90%|█████████ | 9/10 [01:06<00:06,  6.79s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.943, 'compress@10': 0.5382, 'time@10': 9.0258}: 100%|██████████| 10/10 [01:06<00:00,  7.77s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0137, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.943, 'compress@10': 0.5382, 'time@10': 9.0258}: 100%|██████████| 10/10 [01:06<00:00,  6.60s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.013693134747342909
Avg hit ratio: 0.8971758673320643
Avg ndcg: 0.9429962534780714
Avg compression ratio: 0.5381966921294009
Avg train time: 9.025787830352783
Std train time: 2.5002278477583113
[0.8151515151515151, 0.3303030303030303, 0.057575757575757565, 0.7848484848484849, 0.996969696969697, 0.6636363636363636, 0.29999999999999993, 0.1787878787878788, 0.6333333333333333, 0.36060606060606065]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.8249, 'time@10': 8.0017}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.8249, 'time@10': 8.0017}:  10%|█         | 1/10 [00:04<00:36,  4.04s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9438, 'compress@10': 0.5884, 'time@10': 7.4571}:  10%|█         | 1/10 [00:10<00:36,  4.04s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9438, 'compress@10': 0.5884, 'time@10': 7.4571}:  20%|██        | 2/10 [00:10<00:46,  5.75s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9149, 'compress@10': 0.4563, 'time@10': 6.7171}:  20%|██        | 2/10 [00:13<00:46,  5.75s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0075, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9149, 'compress@10': 0.4563, 'time@10': 6.7171}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9228, 'compress@10': 0.5404, 'time@10': 6.5323}:  30%|███       | 3/10 [00:19<00:30,  4.34s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9228, 'compress@10': 0.5404, 'time@10': 6.5323}:  40%|████      | 4/10 [00:19<00:29,  5.00s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9225, 'compress@10': 0.6317, 'time@10': 7.7224}:  40%|████      | 4/10 [00:25<00:29,  5.00s/it] {'epoch': 32, 'num_users': 5.8, 'loss': 0.0111, 'hit_ratio@10': 0.868, 'ndcg@10': 0.9225, 'compress@10': 0.6317, 'time@10': 7.7224}:  50%|█████     | 5/10 [00:25<00:27,  5.46s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9311, 'compress@10': 0.6383, 'time@10': 8.1427}:  50%|█████     | 5/10 [00:36<00:27,  5.46s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9311, 'compress@10': 0.6383, 'time@10': 8.1427}:  60%|██████    | 6/10 [00:36<00:28,  7.10s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9329, 'compress@10': 0.5939, 'time@10': 8.5421}:  60%|██████    | 6/10 [00:41<00:28,  7.10s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9329, 'compress@10': 0.5939, 'time@10': 8.5421}:  70%|███████   | 7/10 [00:41<00:19,  6.58s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9297, 'compress@10': 0.545, 'time@10': 8.414}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it]   {'epoch': 32, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9297, 'compress@10': 0.545, 'time@10': 8.414}:  80%|████████  | 8/10 [00:49<00:13,  6.89s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.935, 'compress@10': 0.556, 'time@10': 8.8893}:  80%|████████  | 8/10 [00:55<00:13,  6.89s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0131, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.935, 'compress@10': 0.556, 'time@10': 8.8893}:  90%|█████████ | 9/10 [00:55<00:06,  6.73s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9392, 'compress@10': 0.5379, 'time@10': 8.9771}:  90%|█████████ | 9/10 [01:05<00:06,  6.73s/it] {'epoch': 32, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9392, 'compress@10': 0.5379, 'time@10': 8.9771}: 100%|██████████| 10/10 [01:05<00:00,  7.68s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9392, 'compress@10': 0.5379, 'time@10': 8.9771}: 100%|██████████| 10/10 [01:05<00:00,  6.55s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.012159136233269117
Avg hit ratio: 0.8997667531487565
Avg ndcg: 0.9391709509776879
Avg compression ratio: 0.5378834855565472
Avg train time: 8.977074313163758
Std train time: 2.499827594698835
[0.7911764705882353, 0.3205882352941177, 0.05588235294117646, 0.7911764705882354, 0.9970588235294118, 0.6735294117647058, 0.2911764705882352, 0.20294117647058824, 0.6441176470588235, 0.35000000000000003]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.8022, 'time@10': 8.2275}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9229, 'compress@10': 0.8022, 'time@10': 8.2275}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9909, 'compress@10': 0.5723, 'time@10': 7.6656}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9909, 'compress@10': 0.5723, 'time@10': 7.6656}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9463, 'compress@10': 0.4451, 'time@10': 6.8394}:  20%|██        | 2/10 [00:13<00:47,  5.91s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9463, 'compress@10': 0.4451, 'time@10': 6.8394}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9477, 'compress@10': 0.5335, 'time@10': 6.7107}:  30%|███       | 3/10 [00:20<00:30,  4.41s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9477, 'compress@10': 0.5335, 'time@10': 6.7107}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9438, 'compress@10': 0.6262, 'time@10': 7.8113}:  40%|████      | 4/10 [00:26<00:31,  5.18s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9438, 'compress@10': 0.6262, 'time@10': 7.8113}:  50%|█████     | 5/10 [00:26<00:27,  5.53s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9484, 'compress@10': 0.6353, 'time@10': 8.2011}:  50%|█████     | 5/10 [00:36<00:27,  5.53s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9484, 'compress@10': 0.6353, 'time@10': 8.2011}:  60%|██████    | 6/10 [00:36<00:28,  7.11s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.949, 'compress@10': 0.5902, 'time@10': 8.5859}:  60%|██████    | 6/10 [00:42<00:28,  7.11s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.949, 'compress@10': 0.5902, 'time@10': 8.5859}:  70%|███████   | 7/10 [00:42<00:19,  6.58s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9522, 'compress@10': 0.5446, 'time@10': 8.4669}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0138, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9522, 'compress@10': 0.5446, 'time@10': 8.4669}:  80%|████████  | 8/10 [00:49<00:13,  6.93s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9544, 'compress@10': 0.5568, 'time@10': 8.9683}:  80%|████████  | 8/10 [00:56<00:13,  6.93s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9544, 'compress@10': 0.5568, 'time@10': 8.9683}:  90%|█████████ | 9/10 [00:56<00:06,  6.80s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9566, 'compress@10': 0.5376, 'time@10': 9.09}:  90%|█████████ | 9/10 [01:06<00:06,  6.80s/it]    {'epoch': 33, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9566, 'compress@10': 0.5376, 'time@10': 9.09}: 100%|██████████| 10/10 [01:06<00:00,  7.86s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0134, 'hit_ratio@10': 0.8979, 'ndcg@10': 0.9566, 'compress@10': 0.5376, 'time@10': 9.09}: 100%|██████████| 10/10 [01:06<00:00,  6.65s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.013415828526332513
Avg hit ratio: 0.8979131945210043
Avg ndcg: 0.9565925885240798
Avg compression ratio: 0.537623042104003
Avg train time: 9.089987659454346
Std train time: 2.452665786163915
[0.7971428571428572, 0.34, 0.05428571428571428, 0.7685714285714287, 0.9971428571428571, 0.6542857142857142, 0.28285714285714275, 0.22571428571428573, 0.6542857142857142, 0.34]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9262, 'compress@10': 0.8078, 'time@10': 8.4258}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9262, 'compress@10': 0.8078, 'time@10': 8.4258}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9667, 'compress@10': 0.5845, 'time@10': 7.7282}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9667, 'compress@10': 0.5845, 'time@10': 7.7282}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9302, 'compress@10': 0.4528, 'time@10': 6.9339}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9302, 'compress@10': 0.4528, 'time@10': 6.9339}:  30%|███       | 3/10 [00:14<00:31,  4.45s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9408, 'compress@10': 0.5338, 'time@10': 6.7278}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0135, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9408, 'compress@10': 0.5338, 'time@10': 6.7278}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9379, 'compress@10': 0.6265, 'time@10': 7.8517}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0141, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9379, 'compress@10': 0.6265, 'time@10': 7.8517}:  50%|█████     | 5/10 [00:26<00:27,  5.51s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9428, 'compress@10': 0.6324, 'time@10': 8.2456}:  50%|█████     | 5/10 [00:36<00:27,  5.51s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0151, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9428, 'compress@10': 0.6324, 'time@10': 8.2456}:  60%|██████    | 6/10 [00:36<00:28,  7.12s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9479, 'compress@10': 0.5866, 'time@10': 8.6227}:  60%|██████    | 6/10 [00:42<00:28,  7.12s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9479, 'compress@10': 0.5866, 'time@10': 8.6227}:  70%|███████   | 7/10 [00:42<00:19,  6.59s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9498, 'compress@10': 0.5442, 'time@10': 8.4914}:  70%|███████   | 7/10 [00:49<00:19,  6.59s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9498, 'compress@10': 0.5442, 'time@10': 8.4914}:  80%|████████  | 8/10 [00:49<00:13,  6.92s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9534, 'compress@10': 0.5576, 'time@10': 8.9328}:  80%|████████  | 8/10 [00:56<00:13,  6.92s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9534, 'compress@10': 0.5576, 'time@10': 8.9328}:  90%|█████████ | 9/10 [00:56<00:06,  6.71s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9542, 'compress@10': 0.5373, 'time@10': 9.0266}:  90%|█████████ | 9/10 [01:05<00:06,  6.71s/it]      {'epoch': 34, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9542, 'compress@10': 0.5373, 'time@10': 9.0266}: 100%|██████████| 10/10 [01:05<00:00,  7.70s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0158, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9542, 'compress@10': 0.5373, 'time@10': 9.0266}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.015767660256619107
Avg hit ratio: 0.8999505459641283
Avg ndcg: 0.9541756127059131
Avg compression ratio: 0.5373014768020663
Avg train time: 9.026637196540833
Std train time: 2.386224443917048
[0.775, 0.35833333333333334, 0.05277777777777777, 0.7750000000000001, 0.9694444444444444, 0.6638888888888889, 0.3027777777777777, 0.21944444444444447, 0.6638888888888889, 0.3305555555555556]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.7868, 'time@10': 8.3308}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0117, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.7868, 'time@10': 8.3308}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9434, 'compress@10': 0.5829, 'time@10': 7.6322}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9434, 'compress@10': 0.5829, 'time@10': 7.6322}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9147, 'compress@10': 0.4513, 'time@10': 6.8236}:  20%|██        | 2/10 [00:13<00:47,  5.90s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9147, 'compress@10': 0.4513, 'time@10': 6.8236}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9275, 'compress@10': 0.5343, 'time@10': 6.6038}:  30%|███       | 3/10 [00:19<00:30,  4.41s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9275, 'compress@10': 0.5343, 'time@10': 6.6038}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9297, 'compress@10': 0.6214, 'time@10': 7.8}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it]   {'epoch': 35, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9297, 'compress@10': 0.6214, 'time@10': 7.8}:  50%|█████     | 5/10 [00:26<00:27,  5.50s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9374, 'compress@10': 0.6297, 'time@10': 8.217}:  50%|█████     | 5/10 [00:36<00:27,  5.50s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9374, 'compress@10': 0.6297, 'time@10': 8.217}:  60%|██████    | 6/10 [00:36<00:28,  7.14s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.915, 'ndcg@10': 0.9385, 'compress@10': 0.587, 'time@10': 8.6082}:  60%|██████    | 6/10 [00:42<00:28,  7.14s/it] {'epoch': 35, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.915, 'ndcg@10': 0.9385, 'compress@10': 0.587, 'time@10': 8.6082}:  70%|███████   | 7/10 [00:42<00:19,  6.61s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.922, 'ndcg@10': 0.9356, 'compress@10': 0.5439, 'time@10': 8.4975}:  70%|███████   | 7/10 [00:49<00:19,  6.61s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0135, 'hit_ratio@10': 0.922, 'ndcg@10': 0.9356, 'compress@10': 0.5439, 'time@10': 8.4975}:  80%|████████  | 8/10 [00:49<00:13,  6.98s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9422, 'compress@10': 0.5583, 'time@10': 8.9829}:  80%|████████  | 8/10 [00:56<00:13,  6.98s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.9053, 'ndcg@10': 0.9422, 'compress@10': 0.5583, 'time@10': 8.9829}:  90%|█████████ | 9/10 [00:56<00:06,  6.82s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9456, 'compress@10': 0.537, 'time@10': 9.0906}:  90%|█████████ | 9/10 [01:06<00:06,  6.82s/it]    {'epoch': 35, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9456, 'compress@10': 0.537, 'time@10': 9.0906}: 100%|██████████| 10/10 [01:06<00:00,  7.83s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.9125, 'ndcg@10': 0.9456, 'compress@10': 0.537, 'time@10': 9.0906}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.013543161725372574
Avg hit ratio: 0.9124851081761098
Avg ndcg: 0.9456108368623756
Avg compression ratio: 0.5370066471208782
Avg train time: 9.090645837783814
Std train time: 2.538477581002902
[0.7540540540540541, 0.34864864864864864, 0.05135135135135135, 0.7810810810810812, 0.9702702702702702, 0.6459459459459459, 0.32162162162162156, 0.24054054054054055, 0.672972972972973, 0.32162162162162167]
[10, 10, 21, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9284, 'compress@10': 0.767, 'time@10': 8.3045}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0102, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9284, 'compress@10': 0.767, 'time@10': 8.3045}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.025, 'compress@10': 0.5683, 'time@10': 7.6312}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.9092, 'ndcg@10': 1.025, 'compress@10': 0.5683, 'time@10': 7.6312}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9691, 'compress@10': 0.4412, 'time@10': 6.7771}:  20%|██        | 2/10 [00:14<00:46,  5.84s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9691, 'compress@10': 0.4412, 'time@10': 6.7771}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9633, 'compress@10': 0.5281, 'time@10': 6.5867}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0169, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9633, 'compress@10': 0.5281, 'time@10': 6.5867}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9604, 'compress@10': 0.6167, 'time@10': 7.7426}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9604, 'compress@10': 0.6167, 'time@10': 7.7426}:  50%|█████     | 5/10 [00:26<00:27,  5.52s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0201, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9664, 'compress@10': 0.6228, 'time@10': 8.1569}:  50%|█████     | 5/10 [00:36<00:27,  5.52s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0201, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9664, 'compress@10': 0.6228, 'time@10': 8.1569}:  60%|██████    | 6/10 [00:36<00:28,  7.13s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9645, 'compress@10': 0.5837, 'time@10': 8.5841}:  60%|██████    | 6/10 [00:42<00:28,  7.13s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9645, 'compress@10': 0.5837, 'time@10': 8.5841}:  70%|███████   | 7/10 [00:42<00:19,  6.63s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9818, 'compress@10': 0.5435, 'time@10': 8.4784}:  70%|███████   | 7/10 [00:50<00:19,  6.63s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0192, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9818, 'compress@10': 0.5435, 'time@10': 8.4784}:  80%|████████  | 8/10 [00:50<00:13,  7.00s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.9034, 'ndcg@10': 0.9805, 'compress@10': 0.5589, 'time@10': 8.9875}:  80%|████████  | 8/10 [00:56<00:13,  7.00s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0187, 'hit_ratio@10': 0.9034, 'ndcg@10': 0.9805, 'compress@10': 0.5589, 'time@10': 8.9875}:  90%|█████████ | 9/10 [00:56<00:06,  6.86s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.98, 'compress@10': 0.5367, 'time@10': 9.0867}:  90%|█████████ | 9/10 [01:06<00:06,  6.86s/it]     {'epoch': 36, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.98, 'compress@10': 0.5367, 'time@10': 9.0867}: 100%|██████████| 10/10 [01:06<00:00,  7.84s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9108, 'ndcg@10': 0.98, 'compress@10': 0.5367, 'time@10': 9.0867}: 100%|██████████| 10/10 [01:06<00:00,  6.66s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.017160144616282243
Avg hit ratio: 0.9107672382324334
Avg ndcg: 0.9800492968626152
Avg compression ratio: 0.536743667864038
Avg train time: 9.086652565002442
Std train time: 2.5579794738502084
[0.7342105263157895, 0.3657894736842105, 0.049999999999999996, 0.786842105263158, 0.9447368421052631, 0.6552631578947368, 0.313157894736842, 0.2605263157894737, 0.6815789473684211, 0.31315789473684214]
[10, 10, 22, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.7482, 'time@10': 8.3039}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.7482, 'time@10': 8.3039}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9478, 'compress@10': 0.5672, 'time@10': 7.5928}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9478, 'compress@10': 0.5672, 'time@10': 7.5928}:  20%|██        | 2/10 [00:11<00:46,  5.79s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9176, 'compress@10': 0.4401, 'time@10': 6.8479}:  20%|██        | 2/10 [00:13<00:46,  5.79s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9176, 'compress@10': 0.4401, 'time@10': 6.8479}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9274, 'compress@10': 0.5287, 'time@10': 6.6344}:  30%|███       | 3/10 [00:19<00:30,  4.39s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9274, 'compress@10': 0.5287, 'time@10': 6.6344}:  40%|████      | 4/10 [00:19<00:30,  5.04s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9312, 'compress@10': 0.6121, 'time@10': 7.826}:  40%|████      | 4/10 [00:26<00:30,  5.04s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9312, 'compress@10': 0.6121, 'time@10': 7.826}:  50%|█████     | 5/10 [00:26<00:27,  5.50s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9383, 'compress@10': 0.6206, 'time@10': 8.201}:  50%|█████     | 5/10 [00:36<00:27,  5.50s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9383, 'compress@10': 0.6206, 'time@10': 8.201}:  60%|██████    | 6/10 [00:36<00:28,  7.07s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9405, 'compress@10': 0.5806, 'time@10': 8.6284}:  60%|██████    | 6/10 [00:41<00:28,  7.07s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9405, 'compress@10': 0.5806, 'time@10': 8.6284}:  70%|███████   | 7/10 [00:41<00:19,  6.60s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.015, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9694, 'compress@10': 0.5432, 'time@10': 8.5339}:  70%|███████   | 7/10 [00:49<00:19,  6.60s/it]  {'epoch': 37, 'num_users': 6.125, 'loss': 0.015, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9694, 'compress@10': 0.5432, 'time@10': 8.5339}:  80%|████████  | 8/10 [00:49<00:14,  7.02s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9689, 'compress@10': 0.5596, 'time@10': 8.9774}:  80%|████████  | 8/10 [00:56<00:14,  7.02s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0145, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9689, 'compress@10': 0.5596, 'time@10': 8.9774}:  90%|█████████ | 9/10 [00:56<00:06,  6.79s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9668, 'compress@10': 0.5365, 'time@10': 9.0676}:  90%|█████████ | 9/10 [01:06<00:06,  6.79s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9668, 'compress@10': 0.5365, 'time@10': 9.0676}: 100%|██████████| 10/10 [01:06<00:00,  7.76s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9668, 'compress@10': 0.5365, 'time@10': 9.0676}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.016096212607301087
Avg hit ratio: 0.8856878731530685
Avg ndcg: 0.9668118345293454
Avg compression ratio: 0.5365089910771672
Avg train time: 9.067567062377929
Std train time: 2.461106528311897
[0.7410256410256411, 0.35641025641025637, 0.04871794871794871, 0.7666666666666668, 0.9461538461538461, 0.6384615384615384, 0.3307692307692307, 0.2794871794871795, 0.6641025641025641, 0.3307692307692308]
[10, 10, 22, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9284, 'compress@10': 0.7546, 'time@10': 8.0729}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9284, 'compress@10': 0.7546, 'time@10': 8.0729}:  10%|█         | 1/10 [00:04<00:36,  4.09s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9491, 'compress@10': 0.5659, 'time@10': 7.5009}:  10%|█         | 1/10 [00:11<00:36,  4.09s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9491, 'compress@10': 0.5659, 'time@10': 7.5009}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9184, 'compress@10': 0.4388, 'time@10': 6.8141}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9184, 'compress@10': 0.4388, 'time@10': 6.8141}:  30%|███       | 3/10 [00:13<00:30,  4.40s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9286, 'compress@10': 0.5229, 'time@10': 6.6315}:  30%|███       | 3/10 [00:19<00:30,  4.40s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9286, 'compress@10': 0.5229, 'time@10': 6.6315}:  40%|████      | 4/10 [00:19<00:30,  5.08s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9331, 'compress@10': 0.6077, 'time@10': 7.7272}:  40%|████      | 4/10 [00:26<00:30,  5.08s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9331, 'compress@10': 0.6077, 'time@10': 7.7272}:  50%|█████     | 5/10 [00:26<00:27,  5.44s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.94, 'compress@10': 0.6142, 'time@10': 8.1598}:  50%|█████     | 5/10 [00:36<00:27,  5.44s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0089, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.94, 'compress@10': 0.6142, 'time@10': 8.1598}:  60%|██████    | 6/10 [00:36<00:28,  7.12s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9401, 'compress@10': 0.5775, 'time@10': 8.5947}:  60%|██████    | 6/10 [00:42<00:28,  7.12s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9401, 'compress@10': 0.5775, 'time@10': 8.5947}:  70%|███████   | 7/10 [00:42<00:19,  6.63s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9434, 'compress@10': 0.5428, 'time@10': 8.4957}:  70%|███████   | 7/10 [00:49<00:19,  6.63s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9434, 'compress@10': 0.5428, 'time@10': 8.4957}:  80%|████████  | 8/10 [00:49<00:14,  7.02s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9459, 'compress@10': 0.5574, 'time@10': 8.9242}:  80%|████████  | 8/10 [00:56<00:14,  7.02s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9459, 'compress@10': 0.5574, 'time@10': 8.9242}:  90%|█████████ | 9/10 [00:56<00:06,  6.77s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9491, 'compress@10': 0.5362, 'time@10': 9.0287}:  90%|█████████ | 9/10 [01:06<00:06,  6.77s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9491, 'compress@10': 0.5362, 'time@10': 9.0287}: 100%|██████████| 10/10 [01:06<00:00,  7.77s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9491, 'compress@10': 0.5362, 'time@10': 9.0287}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.009279084094953424
Avg hit ratio: 0.8885450160102113
Avg ndcg: 0.9490582131618804
Avg compression ratio: 0.5362429716322612
Avg train time: 9.028742289543152
Std train time: 2.3707352005954245
[0.7475, 0.3475, 0.047499999999999994, 0.7725000000000002, 0.9475, 0.6224999999999999, 0.3474999999999999, 0.2725, 0.6725, 0.32250000000000006]
[10, 10, 22, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9284, 'compress@10': 0.7608, 'time@10': 8.3339}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9284, 'compress@10': 0.7608, 'time@10': 8.3339}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9487, 'compress@10': 0.5647, 'time@10': 7.6825}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9487, 'compress@10': 0.5647, 'time@10': 7.6825}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9182, 'compress@10': 0.4376, 'time@10': 6.9396}:  20%|██        | 2/10 [00:14<00:47,  5.90s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.7275, 'ndcg@10': 0.9182, 'compress@10': 0.4376, 'time@10': 6.9396}:  30%|███       | 3/10 [00:14<00:31,  4.47s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.7867, 'ndcg@10': 0.9372, 'compress@10': 0.5234, 'time@10': 6.6944}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.7867, 'ndcg@10': 0.9372, 'compress@10': 0.5234, 'time@10': 6.6944}:  40%|████      | 4/10 [00:20<00:30,  5.07s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.9401, 'compress@10': 0.6084, 'time@10': 7.8934}:  40%|████      | 4/10 [00:26<00:30,  5.07s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8213, 'ndcg@10': 0.9401, 'compress@10': 0.6084, 'time@10': 7.8934}:  50%|█████     | 5/10 [00:26<00:27,  5.54s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9461, 'compress@10': 0.6122, 'time@10': 8.2696}:  50%|█████     | 5/10 [00:36<00:27,  5.54s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9461, 'compress@10': 0.6122, 'time@10': 8.2696}:  60%|██████    | 6/10 [00:36<00:28,  7.12s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9475, 'compress@10': 0.5781, 'time@10': 8.6506}:  60%|██████    | 6/10 [00:42<00:28,  7.12s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9475, 'compress@10': 0.5781, 'time@10': 8.6506}:  70%|███████   | 7/10 [00:42<00:19,  6.59s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9498, 'compress@10': 0.5425, 'time@10': 8.5124}:  70%|███████   | 7/10 [00:49<00:19,  6.59s/it]  {'epoch': 39, 'num_users': 6.125, 'loss': 0.0096, 'hit_ratio@10': 0.877, 'ndcg@10': 0.9498, 'compress@10': 0.5425, 'time@10': 8.5124}:  80%|████████  | 8/10 [00:49<00:13,  6.91s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9523, 'compress@10': 0.558, 'time@10': 8.9636}:  80%|████████  | 8/10 [00:56<00:13,  6.91s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9523, 'compress@10': 0.558, 'time@10': 8.9636}:  90%|█████████ | 9/10 [00:56<00:06,  6.72s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9548, 'compress@10': 0.536, 'time@10': 9.0416}:  90%|█████████ | 9/10 [01:05<00:06,  6.72s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9548, 'compress@10': 0.536, 'time@10': 9.0416}: 100%|██████████| 10/10 [01:05<00:00,  7.67s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0101, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.9548, 'compress@10': 0.536, 'time@10': 9.0416}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.010082378442444006
Avg hit ratio: 0.8707441967577791
Avg ndcg: 0.95483072798474
Avg compression ratio: 0.5359592031322412
Avg train time: 9.041609811782838
Std train time: 2.4545989828491974
[0.7536585365853659, 0.36341463414634145, 0.04634146341463414, 0.778048780487805, 0.948780487804878, 0.6073170731707317, 0.33902439024390235, 0.2658536585365854, 0.6804878048780487, 0.31463414634146347]
[10, 10, 22, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9285, 'compress@10': 0.7666, 'time@10': 8.4024}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9285, 'compress@10': 0.7666, 'time@10': 8.4024}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9475, 'compress@10': 0.5753, 'time@10': 7.6343}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9475, 'compress@10': 0.5753, 'time@10': 7.6343}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9174, 'compress@10': 0.4444, 'time@10': 7.0436}:  20%|██        | 2/10 [00:14<00:46,  5.81s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9174, 'compress@10': 0.4444, 'time@10': 7.0436}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9276, 'compress@10': 0.5298, 'time@10': 6.831}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0082, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9276, 'compress@10': 0.5298, 'time@10': 6.831}:  40%|████      | 4/10 [00:20<00:31,  5.20s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9329, 'compress@10': 0.6138, 'time@10': 8.0223}:  40%|████      | 4/10 [00:26<00:31,  5.20s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9329, 'compress@10': 0.6138, 'time@10': 8.0223}:  50%|█████     | 5/10 [00:26<00:28,  5.65s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9423, 'compress@10': 0.6142, 'time@10': 8.3883}:  50%|█████     | 5/10 [00:37<00:28,  5.65s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0108, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9423, 'compress@10': 0.6142, 'time@10': 8.3883}:  60%|██████    | 6/10 [00:37<00:28,  7.21s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0109, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9438, 'compress@10': 0.5786, 'time@10': 8.7745}:  60%|██████    | 6/10 [00:42<00:28,  7.21s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0109, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9438, 'compress@10': 0.5786, 'time@10': 8.7745}:  70%|███████   | 7/10 [00:42<00:20,  6.68s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9505, 'compress@10': 0.5422, 'time@10': 8.6402}:  70%|███████   | 7/10 [00:50<00:20,  6.68s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9505, 'compress@10': 0.5422, 'time@10': 8.6402}:  80%|████████  | 8/10 [00:50<00:14,  7.02s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9559, 'compress@10': 0.5585, 'time@10': 9.063}:  80%|████████  | 8/10 [00:56<00:14,  7.02s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9559, 'compress@10': 0.5585, 'time@10': 9.063}:  90%|█████████ | 9/10 [00:56<00:06,  6.78s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9606, 'compress@10': 0.5357, 'time@10': 9.1899}:  90%|█████████ | 9/10 [01:07<00:06,  6.78s/it]  {'epoch': 40, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9606, 'compress@10': 0.5357, 'time@10': 9.1899}: 100%|██████████| 10/10 [01:07<00:00,  7.89s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9606, 'compress@10': 0.5357, 'time@10': 9.1899}: 100%|██████████| 10/10 [01:07<00:00,  6.70s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.014327927915423925
Avg hit ratio: 0.8968501875411892
Avg ndcg: 0.9605797337237192
Avg compression ratio: 0.5357052460417759
Avg train time: 9.189858388900756
Std train time: 2.4043898934011647
[0.7357142857142858, 0.3547619047619048, 0.04523809523809523, 0.7833333333333334, 0.9261904761904761, 0.6166666666666667, 0.3309523809523809, 0.2833333333333333, 0.688095238095238, 0.330952380952381]
[10, 10, 22, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.7496, 'time@10': 8.3226}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.7496, 'time@10': 8.3226}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9824, 'compress@10': 0.5626, 'time@10': 7.6102}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.0161, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9824, 'compress@10': 0.5626, 'time@10': 7.6102}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9407, 'compress@10': 0.4356, 'time@10': 6.9272}:  20%|██        | 2/10 [00:13<00:46,  5.81s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9407, 'compress@10': 0.4356, 'time@10': 6.9272}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9451, 'compress@10': 0.5245, 'time@10': 6.7065}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9451, 'compress@10': 0.5245, 'time@10': 6.7065}:  40%|████      | 4/10 [00:20<00:30,  5.09s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9473, 'compress@10': 0.6051, 'time@10': 7.8196}:  40%|████      | 4/10 [00:26<00:30,  5.09s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9473, 'compress@10': 0.6051, 'time@10': 7.8196}:  50%|█████     | 5/10 [00:26<00:27,  5.48s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9521, 'compress@10': 0.6085, 'time@10': 8.2897}:  50%|█████     | 5/10 [00:36<00:27,  5.48s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0085, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9521, 'compress@10': 0.6085, 'time@10': 8.2897}:  60%|██████    | 6/10 [00:36<00:29,  7.25s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9575, 'compress@10': 0.5726, 'time@10': 8.7046}:  60%|██████    | 6/10 [00:42<00:29,  7.25s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9575, 'compress@10': 0.5726, 'time@10': 8.7046}:  70%|███████   | 7/10 [00:42<00:20,  6.72s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9592, 'compress@10': 0.539, 'time@10': 8.5794}:  70%|███████   | 7/10 [00:50<00:20,  6.72s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9592, 'compress@10': 0.539, 'time@10': 8.5794}:  80%|████████  | 8/10 [00:50<00:14,  7.05s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0107, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9615, 'compress@10': 0.5566, 'time@10': 8.9793}:  80%|████████  | 8/10 [00:56<00:14,  7.05s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0107, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9615, 'compress@10': 0.5566, 'time@10': 8.9793}:  90%|█████████ | 9/10 [00:56<00:06,  6.76s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9631, 'compress@10': 0.5355, 'time@10': 9.0721}:  90%|█████████ | 9/10 [01:06<00:06,  6.76s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9631, 'compress@10': 0.5355, 'time@10': 9.0721}: 100%|██████████| 10/10 [01:06<00:00,  7.74s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9631, 'compress@10': 0.5355, 'time@10': 9.0721}: 100%|██████████| 10/10 [01:06<00:00,  6.63s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.009875341988473734
Avg hit ratio: 0.8853192095585983
Avg ndcg: 0.9631174750394198
Avg compression ratio: 0.5355401013117123
Avg train time: 9.072126936912536
Std train time: 2.370839516982758
[0.7418604651162791, 0.3697674418604651, 0.0441860465116279, 0.7651162790697675, 0.927906976744186, 0.6023255813953489, 0.3465116279069767, 0.27674418604651163, 0.6953488372093022, 0.3232558139534884]
[10, 10, 22, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.7554, 'time@10': 8.1316}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9335, 'compress@10': 0.7554, 'time@10': 8.1316}:  10%|█         | 1/10 [00:04<00:36,  4.10s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9459, 'compress@10': 0.5728, 'time@10': 7.5278}:  10%|█         | 1/10 [00:11<00:36,  4.10s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9459, 'compress@10': 0.5728, 'time@10': 7.5278}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.7597, 'ndcg@10': 0.9163, 'compress@10': 0.4421, 'time@10': 6.8197}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.7597, 'ndcg@10': 0.9163, 'compress@10': 0.4421, 'time@10': 6.8197}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8019, 'ndcg@10': 0.9274, 'compress@10': 0.5249, 'time@10': 6.597}:  30%|███       | 3/10 [00:19<00:30,  4.39s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8019, 'ndcg@10': 0.9274, 'compress@10': 0.5249, 'time@10': 6.597}:  40%|████      | 4/10 [00:19<00:30,  5.01s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.933, 'compress@10': 0.6058, 'time@10': 7.7884}:  40%|████      | 4/10 [00:26<00:30,  5.01s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.933, 'compress@10': 0.6058, 'time@10': 7.7884}:  50%|█████     | 5/10 [00:26<00:27,  5.48s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9398, 'compress@10': 0.6067, 'time@10': 8.166}:  50%|█████     | 5/10 [00:36<00:27,  5.48s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9398, 'compress@10': 0.6067, 'time@10': 8.166}:  60%|██████    | 6/10 [00:36<00:28,  7.05s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0109, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9405, 'compress@10': 0.5733, 'time@10': 8.5597}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0109, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9405, 'compress@10': 0.5733, 'time@10': 8.5597}:  70%|███████   | 7/10 [00:41<00:19,  6.54s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9469, 'compress@10': 0.5388, 'time@10': 8.4513}:  70%|███████   | 7/10 [00:49<00:19,  6.54s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9469, 'compress@10': 0.5388, 'time@10': 8.4513}:  80%|████████  | 8/10 [00:49<00:13,  6.92s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9492, 'compress@10': 0.5572, 'time@10': 8.9004}:  80%|████████  | 8/10 [00:55<00:13,  6.92s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9492, 'compress@10': 0.5572, 'time@10': 8.9004}:  90%|█████████ | 9/10 [00:55<00:06,  6.72s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9517, 'compress@10': 0.5353, 'time@10': 8.9962}:  90%|█████████ | 9/10 [01:05<00:06,  6.72s/it]    {'epoch': 42, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9517, 'compress@10': 0.5353, 'time@10': 8.9962}: 100%|██████████| 10/10 [01:05<00:00,  7.70s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.9517, 'compress@10': 0.5353, 'time@10': 8.9962}: 100%|██████████| 10/10 [01:05<00:00,  6.56s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.012012338665756092
Avg hit ratio: 0.8803422510332528
Avg ndcg: 0.9516580243196258
Avg compression ratio: 0.5353006374552608
Avg train time: 8.996248078346252
Std train time: 2.4395620409159755
[0.7250000000000001, 0.3840909090909091, 0.043181818181818175, 0.7477272727272728, 0.9295454545454545, 0.6113636363636364, 0.36136363636363633, 0.2931818181818182, 0.6795454545454545, 0.3159090909090909]
[10, 10, 22, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9358, 'compress@10': 0.7395, 'time@10': 8.2245}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9358, 'compress@10': 0.7395, 'time@10': 8.2245}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9979, 'compress@10': 0.5717, 'time@10': 7.5614}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9979, 'compress@10': 0.5717, 'time@10': 7.5614}:  20%|██        | 2/10 [00:11<00:46,  5.79s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.951, 'compress@10': 0.4411, 'time@10': 6.8849}:  20%|██        | 2/10 [00:13<00:46,  5.79s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.951, 'compress@10': 0.4411, 'time@10': 6.8849}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.9658, 'compress@10': 0.52, 'time@10': 6.7024}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.0195, 'hit_ratio@10': 0.8143, 'ndcg@10': 0.9658, 'compress@10': 0.52, 'time@10': 6.7024}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.9645, 'compress@10': 0.6022, 'time@10': 7.8944}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8475, 'ndcg@10': 0.9645, 'compress@10': 0.6022, 'time@10': 7.8944}:  50%|█████     | 5/10 [00:26<00:27,  5.57s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9664, 'compress@10': 0.6052, 'time@10': 8.3022}:  50%|█████     | 5/10 [00:36<00:27,  5.57s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.9664, 'compress@10': 0.6052, 'time@10': 8.3022}:  60%|██████    | 6/10 [00:36<00:28,  7.21s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9649, 'compress@10': 0.574, 'time@10': 8.6571}:  60%|██████    | 6/10 [00:42<00:28,  7.21s/it]  {'epoch': 43, 'num_users': 6.2857, 'loss': 0.015, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.9649, 'compress@10': 0.574, 'time@10': 8.6571}:  70%|███████   | 7/10 [00:42<00:19,  6.63s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0148, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9644, 'compress@10': 0.5414, 'time@10': 8.5372}:  70%|███████   | 7/10 [00:49<00:19,  6.63s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0148, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.9644, 'compress@10': 0.5414, 'time@10': 8.5372}:  80%|████████  | 8/10 [00:49<00:13,  6.98s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.964, 'compress@10': 0.5578, 'time@10': 9.0185}:  80%|████████  | 8/10 [00:56<00:13,  6.98s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.964, 'compress@10': 0.5578, 'time@10': 9.0185}:  90%|█████████ | 9/10 [00:56<00:06,  6.82s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9664, 'compress@10': 0.5351, 'time@10': 9.0937}:  90%|█████████ | 9/10 [01:06<00:06,  6.82s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9664, 'compress@10': 0.5351, 'time@10': 9.0937}: 100%|██████████| 10/10 [01:06<00:00,  7.75s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9664, 'compress@10': 0.5351, 'time@10': 9.0937}: 100%|██████████| 10/10 [01:06<00:00,  6.63s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.014980385848417968
Avg hit ratio: 0.8866612474490234
Avg ndcg: 0.9663552471602517
Avg compression ratio: 0.5351403305150223
Avg train time: 9.093713521957397
Std train time: 2.464119334217671
[0.708888888888889, 0.3977777777777778, 0.04222222222222222, 0.7533333333333334, 0.931111111111111, 0.5977777777777779, 0.3533333333333333, 0.30888888888888894, 0.6644444444444444, 0.33111111111111113]
[10, 10, 22, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9115, 'compress@10': 0.7242, 'time@10': 8.4613}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9115, 'compress@10': 0.7242, 'time@10': 8.4613}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9782, 'compress@10': 0.5707, 'time@10': 7.6219}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it] {'epoch': 44, 'num_users': 7.0, 'loss': 0.0178, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9782, 'compress@10': 0.5707, 'time@10': 7.6219}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9378, 'compress@10': 0.4402, 'time@10': 6.8954}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9378, 'compress@10': 0.4402, 'time@10': 6.8954}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9425, 'compress@10': 0.5206, 'time@10': 6.6576}:  30%|███       | 3/10 [00:19<00:30,  4.39s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.9425, 'compress@10': 0.5206, 'time@10': 6.6576}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9449, 'compress@10': 0.603, 'time@10': 7.9798}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.9449, 'compress@10': 0.603, 'time@10': 7.9798}:  50%|█████     | 5/10 [00:26<00:28,  5.62s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9502, 'compress@10': 0.6036, 'time@10': 8.4071}:  50%|█████     | 5/10 [00:37<00:28,  5.62s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0109, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9502, 'compress@10': 0.6036, 'time@10': 8.4071}:  60%|██████    | 6/10 [00:37<00:29,  7.31s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.951, 'compress@10': 0.5716, 'time@10': 8.78}:  60%|██████    | 6/10 [00:42<00:29,  7.31s/it]   {'epoch': 44, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.951, 'compress@10': 0.5716, 'time@10': 8.78}:  70%|███████   | 7/10 [00:42<00:20,  6.73s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0148, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9764, 'compress@10': 0.5412, 'time@10': 8.6658}:  70%|███████   | 7/10 [00:50<00:20,  6.73s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0148, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9764, 'compress@10': 0.5412, 'time@10': 8.6658}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9752, 'compress@10': 0.556, 'time@10': 9.0898}:  80%|████████  | 8/10 [00:56<00:14,  7.11s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0148, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.9752, 'compress@10': 0.556, 'time@10': 9.0898}:  90%|█████████ | 9/10 [00:56<00:06,  6.85s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9754, 'compress@10': 0.535, 'time@10': 9.1719}:  90%|█████████ | 9/10 [01:06<00:06,  6.85s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9754, 'compress@10': 0.535, 'time@10': 9.1719}: 100%|██████████| 10/10 [01:06<00:00,  7.80s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0135, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9754, 'compress@10': 0.535, 'time@10': 9.1719}: 100%|██████████| 10/10 [01:06<00:00,  6.68s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.013529183934947614
Avg hit ratio: 0.8794620667014555
Avg ndcg: 0.9754499378453986
Avg compression ratio: 0.5349947374473463
Avg train time: 9.17186074256897
Std train time: 2.565606386715388
[0.7152173913043479, 0.4108695652173913, 0.041304347826086954, 0.7586956521739131, 0.9108695652173912, 0.5847826086956522, 0.3456521739130434, 0.3239130434782609, 0.6717391304347825, 0.3239130434782609]
[10, 10, 22, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9313, 'compress@10': 0.7302, 'time@10': 8.4256}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9313, 'compress@10': 0.7302, 'time@10': 8.4256}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9495, 'compress@10': 0.58, 'time@10': 7.6971}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]   {'epoch': 45, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9495, 'compress@10': 0.58, 'time@10': 7.6971}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9187, 'compress@10': 0.4461, 'time@10': 6.9502}:  20%|██        | 2/10 [00:14<00:46,  5.87s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.7382, 'ndcg@10': 0.9187, 'compress@10': 0.4461, 'time@10': 6.9502}:  30%|███       | 3/10 [00:14<00:31,  4.45s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9296, 'compress@10': 0.5264, 'time@10': 6.7343}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0054, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9296, 'compress@10': 0.5264, 'time@10': 6.7343}:  40%|████      | 4/10 [00:20<00:30,  5.11s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0066, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.9349, 'compress@10': 0.6037, 'time@10': 7.8243}:  40%|████      | 4/10 [00:26<00:30,  5.11s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0066, 'hit_ratio@10': 0.8246, 'ndcg@10': 0.9349, 'compress@10': 0.6037, 'time@10': 7.8243}:  50%|█████     | 5/10 [00:26<00:27,  5.48s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9497, 'compress@10': 0.602, 'time@10': 8.2161}:  50%|█████     | 5/10 [00:36<00:27,  5.48s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9497, 'compress@10': 0.602, 'time@10': 8.2161}:  60%|██████    | 6/10 [00:36<00:28,  7.09s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9503, 'compress@10': 0.5692, 'time@10': 8.6117}:  60%|██████    | 6/10 [00:42<00:28,  7.09s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0106, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.9503, 'compress@10': 0.5692, 'time@10': 8.6117}:  70%|███████   | 7/10 [00:42<00:19,  6.58s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9522, 'compress@10': 0.5409, 'time@10': 8.5155}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9522, 'compress@10': 0.5409, 'time@10': 8.5155}:  80%|████████  | 8/10 [00:49<00:13,  6.99s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9639, 'compress@10': 0.5565, 'time@10': 8.9822}:  80%|████████  | 8/10 [00:56<00:13,  6.99s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.859, 'ndcg@10': 0.9639, 'compress@10': 0.5565, 'time@10': 8.9822}:  90%|█████████ | 9/10 [00:56<00:06,  6.81s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9654, 'compress@10': 0.5348, 'time@10': 9.0837}:  90%|█████████ | 9/10 [01:06<00:06,  6.81s/it]  {'epoch': 45, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9654, 'compress@10': 0.5348, 'time@10': 9.0837}: 100%|██████████| 10/10 [01:06<00:00,  7.81s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9654, 'compress@10': 0.5348, 'time@10': 9.0837}: 100%|██████████| 10/10 [01:06<00:00,  6.63s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.012193978805877307
Avg hit ratio: 0.8708112730506619
Avg ndcg: 0.9654358068632118
Avg compression ratio: 0.5347741175655188
Avg train time: 9.08369846343994
Std train time: 2.3882793627969363
[0.721276595744681, 0.4021276595744681, 0.04042553191489361, 0.7425531914893617, 0.9127659574468083, 0.5936170212765958, 0.33829787234042547, 0.3170212765957447, 0.6787234042553191, 0.3382978723404255]
[10, 10, 22, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9209, 'compress@10': 0.7359, 'time@10': 8.2307}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9209, 'compress@10': 0.7359, 'time@10': 8.2307}:  10%|█         | 1/10 [00:04<00:37,  4.15s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9443, 'compress@10': 0.5787, 'time@10': 7.7085}:  10%|█         | 1/10 [00:11<00:37,  4.15s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9443, 'compress@10': 0.5787, 'time@10': 7.7085}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0035, 'hit_ratio@10': 0.7597, 'ndcg@10': 0.9153, 'compress@10': 0.445, 'time@10': 6.9552}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.0035, 'hit_ratio@10': 0.7597, 'ndcg@10': 0.9153, 'compress@10': 0.445, 'time@10': 6.9552}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.8019, 'ndcg@10': 0.9266, 'compress@10': 0.5217, 'time@10': 6.7359}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0049, 'hit_ratio@10': 0.8019, 'ndcg@10': 0.9266, 'compress@10': 0.5217, 'time@10': 6.7359}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.006, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.9334, 'compress@10': 0.6002, 'time@10': 7.9577}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.006, 'hit_ratio@10': 0.8375, 'ndcg@10': 0.9334, 'compress@10': 0.6002, 'time@10': 7.9577}:  50%|█████     | 5/10 [00:26<00:28,  5.61s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0052, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9406, 'compress@10': 0.6006, 'time@10': 8.3761}:  50%|█████     | 5/10 [00:37<00:28,  5.61s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0052, 'hit_ratio@10': 0.8609, 'ndcg@10': 0.9406, 'compress@10': 0.6006, 'time@10': 8.3761}:  60%|██████    | 6/10 [00:37<00:29,  7.28s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0071, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9392, 'compress@10': 0.5669, 'time@10': 8.7619}:  60%|██████    | 6/10 [00:42<00:29,  7.28s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0071, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9392, 'compress@10': 0.5669, 'time@10': 8.7619}:  70%|███████   | 7/10 [00:42<00:20,  6.72s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0067, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9432, 'compress@10': 0.5381, 'time@10': 8.6373}:  70%|███████   | 7/10 [00:50<00:20,  6.72s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0067, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9432, 'compress@10': 0.5381, 'time@10': 8.6373}:  80%|████████  | 8/10 [00:50<00:14,  7.06s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0091, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.956, 'compress@10': 0.5548, 'time@10': 9.0414}:  80%|████████  | 8/10 [00:56<00:14,  7.06s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0091, 'hit_ratio@10': 0.8679, 'ndcg@10': 0.956, 'compress@10': 0.5548, 'time@10': 9.0414}:  90%|█████████ | 9/10 [00:56<00:06,  6.79s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0097, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9585, 'compress@10': 0.5346, 'time@10': 9.1416}:  90%|█████████ | 9/10 [01:06<00:06,  6.79s/it]  {'epoch': 46, 'num_users': 6.3, 'loss': 0.0097, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9585, 'compress@10': 0.5346, 'time@10': 9.1416}: 100%|██████████| 10/10 [01:06<00:00,  7.80s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0097, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9585, 'compress@10': 0.5346, 'time@10': 9.1416}: 100%|██████████| 10/10 [01:06<00:00,  6.68s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.009662430150618394
Avg hit ratio: 0.8788501875411893
Avg ndcg: 0.9584980464621126
Avg compression ratio: 0.5346276933178485
Avg train time: 9.141635513305664
Std train time: 2.4375331344720683
[0.7270833333333334, 0.39375000000000004, 0.03958333333333333, 0.7270833333333333, 0.9145833333333332, 0.58125, 0.35208333333333325, 0.3104166666666667, 0.6854166666666666, 0.3520833333333333]
[10, 10, 22, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9227, 'compress@10': 0.7414, 'time@10': 8.252}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9227, 'compress@10': 0.7414, 'time@10': 8.252}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9475, 'compress@10': 0.5774, 'time@10': 7.6122}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.009, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9475, 'compress@10': 0.5774, 'time@10': 7.6122}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9173, 'compress@10': 0.4438, 'time@10': 6.9202}:  20%|██        | 2/10 [00:13<00:46,  5.84s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9173, 'compress@10': 0.4438, 'time@10': 6.9202}:  30%|███       | 3/10 [00:13<00:31,  4.45s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9365, 'compress@10': 0.5171, 'time@10': 6.714}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it]  {'epoch': 47, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9365, 'compress@10': 0.5171, 'time@10': 6.714}:  40%|████      | 4/10 [00:20<00:30,  5.12s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9421, 'compress@10': 0.5969, 'time@10': 7.8345}:  40%|████      | 4/10 [00:26<00:30,  5.12s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0097, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9421, 'compress@10': 0.5969, 'time@10': 7.8345}:  50%|█████     | 5/10 [00:26<00:27,  5.51s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9475, 'compress@10': 0.5959, 'time@10': 8.2723}:  50%|█████     | 5/10 [00:36<00:27,  5.51s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9475, 'compress@10': 0.5959, 'time@10': 8.2723}:  60%|██████    | 6/10 [00:36<00:28,  7.20s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.949, 'compress@10': 0.5647, 'time@10': 8.668}:  60%|██████    | 6/10 [00:42<00:28,  7.20s/it] {'epoch': 47, 'num_users': 6.2857, 'loss': 0.0092, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.949, 'compress@10': 0.5647, 'time@10': 8.668}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9706, 'compress@10': 0.5354, 'time@10': 8.5643}:  70%|███████   | 7/10 [00:50<00:19,  6.66s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.9096, 'ndcg@10': 0.9706, 'compress@10': 0.5354, 'time@10': 8.5643}:  80%|████████  | 8/10 [00:50<00:14,  7.05s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9694, 'compress@10': 0.5531, 'time@10': 9.0539}:  80%|████████  | 8/10 [00:56<00:14,  7.05s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8975, 'ndcg@10': 0.9694, 'compress@10': 0.5531, 'time@10': 9.0539}:  90%|█████████ | 9/10 [00:56<00:06,  6.89s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.969, 'compress@10': 0.5345, 'time@10': 9.1702}:  90%|█████████ | 9/10 [01:07<00:06,  6.89s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.969, 'compress@10': 0.5345, 'time@10': 9.1702}: 100%|██████████| 10/10 [01:07<00:00,  7.93s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.969, 'compress@10': 0.5345, 'time@10': 9.1702}: 100%|██████████| 10/10 [01:07<00:00,  6.70s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.011951151022932205
Avg hit ratio: 0.9054426094561917
Avg ndcg: 0.968959897236369
Avg compression ratio: 0.5344522773704388
Avg train time: 9.170207595825195
Std train time: 2.464229548170047
[0.7122448979591838, 0.38571428571428573, 0.03877551020408163, 0.7326530612244898, 0.8959183673469386, 0.589795918367347, 0.3448979591836734, 0.32448979591836735, 0.6918367346938774, 0.3653061224489796]
[10, 10, 22, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9336, 'compress@10': 0.7274, 'time@10': 8.2099}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0066, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9336, 'compress@10': 0.7274, 'time@10': 8.2099}:  10%|█         | 1/10 [00:04<00:37,  4.14s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9473, 'compress@10': 0.5665, 'time@10': 7.6757}:  10%|█         | 1/10 [00:11<00:37,  4.14s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9473, 'compress@10': 0.5665, 'time@10': 7.6757}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9172, 'compress@10': 0.4363, 'time@10': 6.9234}:  20%|██        | 2/10 [00:14<00:47,  5.93s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9172, 'compress@10': 0.4363, 'time@10': 6.9234}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9296, 'compress@10': 0.5128, 'time@10': 6.6984}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9296, 'compress@10': 0.5128, 'time@10': 6.6984}:  40%|████      | 4/10 [00:20<00:30,  5.10s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9351, 'compress@10': 0.5898, 'time@10': 7.8538}:  40%|████      | 4/10 [00:26<00:30,  5.10s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0089, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9351, 'compress@10': 0.5898, 'time@10': 7.8538}:  50%|█████     | 5/10 [00:26<00:27,  5.52s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9422, 'compress@10': 0.5913, 'time@10': 8.2385}:  50%|█████     | 5/10 [00:36<00:27,  5.52s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9422, 'compress@10': 0.5913, 'time@10': 8.2385}:  60%|██████    | 6/10 [00:36<00:28,  7.11s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9445, 'compress@10': 0.5599, 'time@10': 8.6429}:  60%|██████    | 6/10 [00:42<00:28,  7.11s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.9127, 'ndcg@10': 0.9445, 'compress@10': 0.5599, 'time@10': 8.6429}:  70%|███████   | 7/10 [00:42<00:19,  6.61s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9505, 'compress@10': 0.5329, 'time@10': 8.5264}:  70%|███████   | 7/10 [00:49<00:19,  6.61s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0101, 'hit_ratio@10': 0.9201, 'ndcg@10': 0.9505, 'compress@10': 0.5329, 'time@10': 8.5264}:  80%|████████  | 8/10 [00:49<00:13,  6.97s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0096, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9521, 'compress@10': 0.5515, 'time@10': 8.9477}:  80%|████████  | 8/10 [00:56<00:13,  6.97s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0096, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9521, 'compress@10': 0.5515, 'time@10': 8.9477}:  90%|█████████ | 9/10 [00:56<00:06,  6.73s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0091, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9546, 'compress@10': 0.5343, 'time@10': 9.0734}:  90%|█████████ | 9/10 [01:06<00:06,  6.73s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0091, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9546, 'compress@10': 0.5343, 'time@10': 9.0734}: 100%|██████████| 10/10 [01:06<00:00,  7.81s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0091, 'hit_ratio@10': 0.9166, 'ndcg@10': 0.9546, 'compress@10': 0.5343, 'time@10': 9.0734}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.009088596361078078
Avg hit ratio: 0.9166279653189671
Avg ndcg: 0.9546202634924226
Avg compression ratio: 0.5343356644090772
Avg train time: 9.07337532043457
Std train time: 2.3987405126474006
[0.6980000000000001, 0.398, 0.038, 0.738, 0.8979999999999999, 0.5780000000000001, 0.35799999999999993, 0.338, 0.6779999999999998, 0.358]
[10, 10, 22, 10, 6, 10, 10, 10, 8, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9336, 'compress@10': 0.7139, 'time@10': 8.2643}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0076, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9336, 'compress@10': 0.7139, 'time@10': 8.2643}:  10%|█         | 1/10 [00:04<00:37,  4.17s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9974, 'compress@10': 0.5657, 'time@10': 7.7357}:  10%|█         | 1/10 [00:11<00:37,  4.17s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9974, 'compress@10': 0.5657, 'time@10': 7.7357}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9506, 'compress@10': 0.4356, 'time@10': 7.0276}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9506, 'compress@10': 0.4356, 'time@10': 7.0276}:  30%|███       | 3/10 [00:14<00:31,  4.55s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.867, 'ndcg@10': 0.9536, 'compress@10': 0.5135, 'time@10': 6.7992}:  30%|███       | 3/10 [00:20<00:31,  4.55s/it]  {'epoch': 49, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.867, 'ndcg@10': 0.9536, 'compress@10': 0.5135, 'time@10': 6.7992}:  40%|████      | 4/10 [00:20<00:31,  5.18s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9551, 'compress@10': 0.5908, 'time@10': 7.8712}:  40%|████      | 4/10 [00:26<00:31,  5.18s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9551, 'compress@10': 0.5908, 'time@10': 7.8712}:  50%|█████     | 5/10 [00:26<00:27,  5.52s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9655, 'compress@10': 0.5902, 'time@10': 8.2529}:  50%|█████     | 5/10 [00:36<00:27,  5.52s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9655, 'compress@10': 0.5902, 'time@10': 8.2529}:  60%|██████    | 6/10 [00:36<00:28,  7.11s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9657, 'compress@10': 0.5607, 'time@10': 8.6532}:  60%|██████    | 6/10 [00:42<00:28,  7.11s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0159, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9657, 'compress@10': 0.5607, 'time@10': 8.6532}:  70%|███████   | 7/10 [00:42<00:19,  6.60s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9169, 'ndcg@10': 0.9588, 'compress@10': 0.5353, 'time@10': 8.514}:  70%|███████   | 7/10 [00:49<00:19,  6.60s/it]  {'epoch': 49, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9169, 'ndcg@10': 0.9588, 'compress@10': 0.5353, 'time@10': 8.514}:  80%|████████  | 8/10 [00:49<00:13,  6.91s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9618, 'compress@10': 0.5521, 'time@10': 8.9223}:  80%|████████  | 8/10 [00:55<00:13,  6.91s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.9039, 'ndcg@10': 0.9618, 'compress@10': 0.5521, 'time@10': 8.9223}:  90%|█████████ | 9/10 [00:55<00:06,  6.67s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9644, 'compress@10': 0.5342, 'time@10': 8.9907}:  90%|█████████ | 9/10 [01:05<00:06,  6.67s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9644, 'compress@10': 0.5342, 'time@10': 8.9907}: 100%|██████████| 10/10 [01:05<00:00,  7.59s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0172, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9644, 'compress@10': 0.5342, 'time@10': 8.9907}: 100%|██████████| 10/10 [01:05<00:00,  6.56s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.017168128304119776
Avg hit ratio: 0.9112362602498425
Avg ndcg: 0.9643847305900438
Avg compression ratio: 0.5341875627631425
Avg train time: 8.99065396785736
Std train time: 2.2755337636784274
[0.6843137254901961, 0.4098039215686275, 0.03725490196078431, 0.7235294117647059, 0.880392156862745, 0.5862745098039216, 0.35098039215686266, 0.3509803921568628, 0.6843137254901959, 0.3705882352941176]
[10, 10, 22, 10, 6, 10, 10, 10, 8, 10]
