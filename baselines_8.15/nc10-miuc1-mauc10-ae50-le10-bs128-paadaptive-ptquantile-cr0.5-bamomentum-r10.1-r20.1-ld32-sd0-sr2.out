  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2412, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.4549, 'compress@10': 0.5263, 'time@10': 9.7826}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.2412, 'hit_ratio@10': 0.4211, 'ndcg@10': 0.4549, 'compress@10': 0.5263, 'time@10': 9.7826}:  10%|█         | 1/10 [00:05<00:45,  5.06s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1727, 'hit_ratio@10': 0.5492, 'ndcg@10': 0.5231, 'compress@10': 0.5212, 'time@10': 8.5998}:  10%|█         | 1/10 [00:12<00:45,  5.06s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1727, 'hit_ratio@10': 0.5492, 'ndcg@10': 0.5231, 'compress@10': 0.5212, 'time@10': 8.5998}:  20%|██        | 2/10 [00:12<00:51,  6.47s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.832, 'hit_ratio@10': 0.4614, 'ndcg@10': 0.3487, 'compress@10': 0.538, 'time@10': 6.69}:  20%|██        | 2/10 [00:13<00:51,  6.47s/it]    {'epoch': 0, 'num_users': 5.0, 'loss': 0.832, 'hit_ratio@10': 0.4614, 'ndcg@10': 0.3487, 'compress@10': 0.538, 'time@10': 6.69}:  30%|███       | 3/10 [00:13<00:29,  4.19s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6628, 'hit_ratio@10': 0.5068, 'ndcg@10': 0.3966, 'compress@10': 0.5329, 'time@10': 6.6215}:  30%|███       | 3/10 [00:20<00:29,  4.19s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6628, 'hit_ratio@10': 0.5068, 'ndcg@10': 0.3966, 'compress@10': 0.5329, 'time@10': 6.6215}:  40%|████      | 4/10 [00:20<00:30,  5.08s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5496, 'hit_ratio@10': 0.5694, 'ndcg@10': 0.4651, 'compress@10': 0.5283, 'time@10': 10.0859}:  40%|████      | 4/10 [00:32<00:30,  5.08s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5496, 'hit_ratio@10': 0.5694, 'ndcg@10': 0.4651, 'compress@10': 0.5283, 'time@10': 10.0859}:  50%|█████     | 5/10 [00:32<00:37,  7.58s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4737, 'hit_ratio@10': 0.5893, 'ndcg@10': 0.511, 'compress@10': 0.5255, 'time@10': 10.1858}:  50%|█████     | 5/10 [00:43<00:37,  7.58s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4737, 'hit_ratio@10': 0.5893, 'ndcg@10': 0.511, 'compress@10': 0.5255, 'time@10': 10.1858}:  60%|██████    | 6/10 [00:43<00:34,  8.65s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4268, 'hit_ratio@10': 0.5851, 'ndcg@10': 0.5138, 'compress@10': 0.5247, 'time@10': 10.378}:  60%|██████    | 6/10 [00:48<00:34,  8.65s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4268, 'hit_ratio@10': 0.5851, 'ndcg@10': 0.5138, 'compress@10': 0.5247, 'time@10': 10.378}:  70%|███████   | 7/10 [00:48<00:23,  7.72s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3817, 'hit_ratio@10': 0.6227, 'ndcg@10': 0.538, 'compress@10': 0.5234, 'time@10': 10.131}:  70%|███████   | 7/10 [00:57<00:23,  7.72s/it]  {'epoch': 0, 'num_users': 6.125, 'loss': 0.3817, 'hit_ratio@10': 0.6227, 'ndcg@10': 0.538, 'compress@10': 0.5234, 'time@10': 10.131}:  80%|████████  | 8/10 [00:57<00:15,  7.95s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3482, 'hit_ratio@10': 0.6424, 'ndcg@10': 0.5768, 'compress@10': 0.5224, 'time@10': 10.8682}:  80%|████████  | 8/10 [01:05<00:15,  7.95s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3482, 'hit_ratio@10': 0.6424, 'ndcg@10': 0.5768, 'compress@10': 0.5224, 'time@10': 10.8682}:  90%|█████████ | 9/10 [01:05<00:08,  8.10s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3193, 'hit_ratio@10': 0.6713, 'ndcg@10': 0.5971, 'compress@10': 0.5213, 'time@10': 10.8283}:  90%|█████████ | 9/10 [01:16<00:08,  8.10s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3193, 'hit_ratio@10': 0.6713, 'ndcg@10': 0.5971, 'compress@10': 0.5213, 'time@10': 10.8283}: 100%|██████████| 10/10 [01:16<00:00,  8.84s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3193, 'hit_ratio@10': 0.6713, 'ndcg@10': 0.5971, 'compress@10': 0.5213, 'time@10': 10.8283}: 100%|██████████| 10/10 [01:16<00:00,  7.64s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.31930845749547465
Avg hit ratio: 0.6713464771410442
Avg ndcg: 0.5971314722136537
Avg compression ratio: 0.5212749006657823
Avg train time: 10.828254508972169
Std train time: 5.561656075211378
[0.75, 0.75, 0.75, 0.75, 0.25, 0.25, 0.75, 0.25, 0.25, 0.25]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0606, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8098, 'compress@10': 0.7632, 'time@10': 8.5877}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0606, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8098, 'compress@10': 0.7632, 'time@10': 8.5877}:  10%|█         | 1/10 [00:04<00:38,  4.33s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0577, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.833, 'compress@10': 0.7606, 'time@10': 7.9431}:  10%|█         | 1/10 [00:11<00:38,  4.33s/it] {'epoch': 1, 'num_users': 7.0, 'loss': 0.0577, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.833, 'compress@10': 0.7606, 'time@10': 7.9431}:  20%|██        | 2/10 [00:11<00:48,  6.10s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0527, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.8095, 'compress@10': 0.769, 'time@10': 6.3285}:  20%|██        | 2/10 [00:13<00:48,  6.10s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0527, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.8095, 'compress@10': 0.769, 'time@10': 6.3285}:  30%|███       | 3/10 [00:13<00:28,  4.04s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0523, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8182, 'compress@10': 0.7665, 'time@10': 6.3229}:  30%|███       | 3/10 [00:19<00:28,  4.04s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0523, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8182, 'compress@10': 0.7665, 'time@10': 6.3229}:  40%|████      | 4/10 [00:19<00:29,  4.95s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0593, 'hit_ratio@10': 0.7836, 'ndcg@10': 0.809, 'compress@10': 0.6662, 'time@10': 9.3296}:  40%|████      | 4/10 [00:30<00:29,  4.95s/it] {'epoch': 1, 'num_users': 5.8, 'loss': 0.0593, 'hit_ratio@10': 0.7836, 'ndcg@10': 0.809, 'compress@10': 0.6662, 'time@10': 9.3296}:  50%|█████     | 5/10 [00:30<00:35,  7.03s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0624, 'hit_ratio@10': 0.7753, 'ndcg@10': 0.8098, 'compress@10': 0.5996, 'time@10': 9.5443}:  50%|█████     | 5/10 [00:40<00:35,  7.03s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0624, 'hit_ratio@10': 0.7753, 'ndcg@10': 0.8098, 'compress@10': 0.5996, 'time@10': 9.5443}:  60%|██████    | 6/10 [00:40<00:33,  8.26s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0601, 'hit_ratio@10': 0.8016, 'ndcg@10': 0.8192, 'compress@10': 0.6225, 'time@10': 9.8288}:  60%|██████    | 6/10 [00:46<00:33,  8.26s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0601, 'hit_ratio@10': 0.8016, 'ndcg@10': 0.8192, 'compress@10': 0.6225, 'time@10': 9.8288}:  70%|███████   | 7/10 [00:46<00:22,  7.46s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0573, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8264, 'compress@10': 0.5786, 'time@10': 9.6275}:  70%|███████   | 7/10 [00:55<00:22,  7.46s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0573, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.8264, 'compress@10': 0.5786, 'time@10': 9.6275}:  80%|████████  | 8/10 [00:55<00:15,  7.71s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0551, 'hit_ratio@10': 0.8076, 'ndcg@10': 0.8367, 'compress@10': 0.5445, 'time@10': 10.203}:  80%|████████  | 8/10 [01:02<00:15,  7.71s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0551, 'hit_ratio@10': 0.8076, 'ndcg@10': 0.8367, 'compress@10': 0.5445, 'time@10': 10.203}:  90%|█████████ | 9/10 [01:02<00:07,  7.63s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0541, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8377, 'compress@10': 0.5167, 'time@10': 10.1966}:  90%|█████████ | 9/10 [01:12<00:07,  7.63s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.0541, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8377, 'compress@10': 0.5167, 'time@10': 10.1966}: 100%|██████████| 10/10 [01:12<00:00,  8.41s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0541, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8377, 'compress@10': 0.5167, 'time@10': 10.1966}: 100%|██████████| 10/10 [01:12<00:00,  7.26s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.0541408497325838
Avg hit ratio: 0.8200472883087484
Avg ndcg: 0.837726605955765
Avg compression ratio: 0.5167406939121076
Avg train time: 10.196591901779176
Std train time: 4.776848723754628
[0.8333333333333334, 0.8333333333333334, 0.5, 0.8333333333333334, 0.5, 0.5, 0.5, 0.16666666666666669, 0.16666666666666669, 0.16666666666666669]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8456, 'compress@10': 0.8421, 'time@10': 8.8035}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8456, 'compress@10': 0.8421, 'time@10': 8.8035}:  10%|█         | 1/10 [00:04<00:39,  4.44s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8446, 'compress@10': 0.8404, 'time@10': 8.0406}:  10%|█         | 1/10 [00:11<00:39,  4.44s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0505, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8446, 'compress@10': 0.8404, 'time@10': 8.0406}:  20%|██        | 2/10 [00:11<00:49,  6.13s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8466, 'compress@10': 0.7507, 'time@10': 6.5185}:  20%|██        | 2/10 [00:13<00:49,  6.13s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8466, 'compress@10': 0.7507, 'time@10': 6.5185}:  30%|███       | 3/10 [00:13<00:28,  4.14s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0392, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8462, 'compress@10': 0.7729, 'time@10': 6.4499}:  30%|███       | 3/10 [00:19<00:28,  4.14s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0392, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8462, 'compress@10': 0.7729, 'time@10': 6.4499}:  40%|████      | 4/10 [00:19<00:29,  4.99s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0485, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8343, 'compress@10': 0.7203, 'time@10': 9.0269}:  40%|████      | 4/10 [00:29<00:29,  4.99s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0485, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8343, 'compress@10': 0.7203, 'time@10': 9.0269}:  50%|█████     | 5/10 [00:29<00:33,  6.69s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.053, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8323, 'compress@10': 0.6854, 'time@10': 9.2979}:  50%|█████     | 5/10 [00:40<00:33,  6.69s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.053, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8323, 'compress@10': 0.6854, 'time@10': 9.2979}:  60%|██████    | 6/10 [00:40<00:32,  8.05s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0514, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8376, 'compress@10': 0.6618, 'time@10': 9.6136}:  60%|██████    | 6/10 [00:45<00:32,  8.05s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0514, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8376, 'compress@10': 0.6618, 'time@10': 9.6136}:  70%|███████   | 7/10 [00:45<00:21,  7.31s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8436, 'compress@10': 0.6029, 'time@10': 9.4159}:  70%|███████   | 7/10 [00:54<00:21,  7.31s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0505, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8436, 'compress@10': 0.6029, 'time@10': 9.4159}:  80%|████████  | 8/10 [00:54<00:15,  7.55s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8521, 'compress@10': 0.5571, 'time@10': 9.9684}:  80%|████████  | 8/10 [01:01<00:15,  7.55s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0494, 'hit_ratio@10': 0.8204, 'ndcg@10': 0.8521, 'compress@10': 0.5571, 'time@10': 9.9684}:  90%|█████████ | 9/10 [01:01<00:07,  7.45s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8523, 'compress@10': 0.5199, 'time@10': 9.9572}:  90%|█████████ | 9/10 [01:11<00:07,  7.45s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8523, 'compress@10': 0.5199, 'time@10': 9.9572}: 100%|██████████| 10/10 [01:11<00:00,  8.21s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0489, 'hit_ratio@10': 0.8315, 'ndcg@10': 0.8523, 'compress@10': 0.5199, 'time@10': 9.9572}: 100%|██████████| 10/10 [01:11<00:00,  7.12s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04888071595107449
Avg hit ratio: 0.8315326684257075
Avg ndcg: 0.8523108284845746
Avg compression ratio: 0.5199171625165354
Avg train time: 9.95723295211792
Std train time: 4.224971589701486
[0.875, 0.875, 0.375, 0.875, 0.625, 0.625, 0.375, 0.125, 0.125, 0.125]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.8816, 'time@10': 8.8011}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8484, 'compress@10': 0.8816, 'time@10': 8.8011}:  10%|█         | 1/10 [00:04<00:39,  4.44s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8511, 'compress@10': 0.8803, 'time@10': 7.9464}:  10%|█         | 1/10 [00:11<00:39,  4.44s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0493, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8511, 'compress@10': 0.8803, 'time@10': 7.9464}:  20%|██        | 2/10 [00:11<00:48,  6.02s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8531, 'compress@10': 0.7416, 'time@10': 6.4945}:  20%|██        | 2/10 [00:13<00:48,  6.02s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8531, 'compress@10': 0.7416, 'time@10': 6.4945}:  30%|███       | 3/10 [00:13<00:28,  4.11s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0374, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8494, 'compress@10': 0.7761, 'time@10': 6.4726}:  30%|███       | 3/10 [00:19<00:28,  4.11s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0374, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8494, 'compress@10': 0.7761, 'time@10': 6.4726}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0469, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8379, 'compress@10': 0.7474, 'time@10': 8.5069}:  40%|████      | 4/10 [00:28<00:30,  5.03s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0469, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8379, 'compress@10': 0.7474, 'time@10': 8.5069}:  50%|█████     | 5/10 [00:28<00:31,  6.23s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0509, 'hit_ratio@10': 0.7854, 'ndcg@10': 0.835, 'compress@10': 0.7284, 'time@10': 8.9103}:  50%|█████     | 5/10 [00:39<00:31,  6.23s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0509, 'hit_ratio@10': 0.7854, 'ndcg@10': 0.835, 'compress@10': 0.7284, 'time@10': 8.9103}:  60%|██████    | 6/10 [00:39<00:31,  7.84s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0503, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8357, 'compress@10': 0.6815, 'time@10': 9.3332}:  60%|██████    | 6/10 [00:45<00:31,  7.84s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0503, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.8357, 'compress@10': 0.6815, 'time@10': 9.3332}:  70%|███████   | 7/10 [00:45<00:21,  7.23s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0512, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8429, 'compress@10': 0.615, 'time@10': 9.1589}:  70%|███████   | 7/10 [00:53<00:21,  7.23s/it]  {'epoch': 3, 'num_users': 6.125, 'loss': 0.0512, 'hit_ratio@10': 0.8233, 'ndcg@10': 0.8429, 'compress@10': 0.615, 'time@10': 9.1589}:  80%|████████  | 8/10 [00:53<00:14,  7.47s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0498, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8502, 'compress@10': 0.5634, 'time@10': 9.7098}:  80%|████████  | 8/10 [01:00<00:14,  7.47s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0498, 'hit_ratio@10': 0.8144, 'ndcg@10': 0.8502, 'compress@10': 0.5634, 'time@10': 9.7098}:  90%|█████████ | 9/10 [01:00<00:07,  7.35s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8492, 'compress@10': 0.5215, 'time@10': 9.6781}:  90%|█████████ | 9/10 [01:09<00:07,  7.35s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8492, 'compress@10': 0.5215, 'time@10': 9.6781}: 100%|██████████| 10/10 [01:09<00:00,  7.99s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0496, 'hit_ratio@10': 0.8261, 'ndcg@10': 0.8492, 'compress@10': 0.5215, 'time@10': 9.6781}: 100%|██████████| 10/10 [01:09<00:00,  6.96s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.049561235784697996
Avg hit ratio: 0.8261430114876636
Avg ndcg: 0.8491790212570522
Avg compression ratio: 0.5215052988611116
Avg train time: 9.678136205673217
Std train time: 3.6457956836450975
[0.7, 0.9, 0.3, 0.9, 0.7, 0.7, 0.3, 0.3, 0.1, 0.1]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8561, 'compress@10': 0.7158, 'time@10': 8.7039}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8561, 'compress@10': 0.7158, 'time@10': 8.7039}:  10%|█         | 1/10 [00:04<00:39,  4.39s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8689, 'compress@10': 0.8095, 'time@10': 7.8696}:  10%|█         | 1/10 [00:11<00:39,  4.39s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8689, 'compress@10': 0.8095, 'time@10': 7.8696}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.865, 'compress@10': 0.673, 'time@10': 6.5761}:  20%|██        | 2/10 [00:13<00:47,  5.97s/it]  {'epoch': 4, 'num_users': 5.0, 'loss': 0.0336, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.865, 'compress@10': 0.673, 'time@10': 6.5761}:  30%|███       | 3/10 [00:13<00:29,  4.17s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0387, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8538, 'compress@10': 0.7306, 'time@10': 6.5028}:  30%|███       | 3/10 [00:19<00:29,  4.17s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0387, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8538, 'compress@10': 0.7306, 'time@10': 6.5028}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0478, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8397, 'compress@10': 0.7257, 'time@10': 8.1168}:  40%|████      | 4/10 [00:27<00:30,  5.02s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0478, 'hit_ratio@10': 0.7896, 'ndcg@10': 0.8397, 'compress@10': 0.7257, 'time@10': 8.1168}:  50%|█████     | 5/10 [00:27<00:29,  5.85s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0509, 'hit_ratio@10': 0.7951, 'ndcg@10': 0.8373, 'compress@10': 0.7225, 'time@10': 8.5354}:  50%|█████     | 5/10 [00:37<00:29,  5.85s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0509, 'hit_ratio@10': 0.7951, 'ndcg@10': 0.8373, 'compress@10': 0.7225, 'time@10': 8.5354}:  60%|██████    | 6/10 [00:37<00:29,  7.49s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0503, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8382, 'compress@10': 0.6662, 'time@10': 9.0082}:  60%|██████    | 6/10 [00:43<00:29,  7.49s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0503, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8382, 'compress@10': 0.6662, 'time@10': 9.0082}:  70%|███████   | 7/10 [00:43<00:20,  6.99s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8435, 'compress@10': 0.6229, 'time@10': 8.911}:  70%|███████   | 7/10 [00:52<00:20,  6.99s/it]  {'epoch': 4, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8435, 'compress@10': 0.6229, 'time@10': 8.911}:  80%|████████  | 8/10 [00:52<00:14,  7.40s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8528, 'compress@10': 0.5677, 'time@10': 9.4139}:  80%|████████  | 8/10 [00:58<00:14,  7.40s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0502, 'hit_ratio@10': 0.8177, 'ndcg@10': 0.8528, 'compress@10': 0.5677, 'time@10': 9.4139}:  90%|█████████ | 9/10 [00:58<00:07,  7.20s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8529, 'compress@10': 0.5229, 'time@10': 9.4364}:  90%|█████████ | 9/10 [01:08<00:07,  7.20s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8529, 'compress@10': 0.5229, 'time@10': 9.4364}: 100%|██████████| 10/10 [01:08<00:00,  7.96s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0494, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.8529, 'compress@10': 0.5229, 'time@10': 9.4364}: 100%|██████████| 10/10 [01:08<00:00,  6.85s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04935140794289551
Avg hit ratio: 0.8290795194241714
Avg ndcg: 0.8528572661467857
Avg compression ratio: 0.5229395201193336
Avg train time: 9.436360859870911
Std train time: 3.1148174544645104
[0.5833333333333333, 0.9166666666666667, 0.25, 0.9166666666666667, 0.75, 0.75, 0.25, 0.41666666666666663, 0.08333333333333334, 0.08333333333333334]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8454, 'compress@10': 0.6053, 'time@10': 8.979}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8454, 'compress@10': 0.6053, 'time@10': 8.979}:  10%|█         | 1/10 [00:04<00:40,  4.53s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8609, 'compress@10': 0.7623, 'time@10': 8.0271}:  10%|█         | 1/10 [00:11<00:40,  4.53s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.049, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8609, 'compress@10': 0.7623, 'time@10': 8.0271}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8596, 'compress@10': 0.6272, 'time@10': 6.8563}:  20%|██        | 2/10 [00:13<00:48,  6.05s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8596, 'compress@10': 0.6272, 'time@10': 6.8563}:  30%|███       | 3/10 [00:13<00:30,  4.33s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8503, 'compress@10': 0.7003, 'time@10': 6.7517}:  30%|███       | 3/10 [00:20<00:30,  4.33s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0378, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8503, 'compress@10': 0.7003, 'time@10': 6.7517}:  40%|████      | 4/10 [00:20<00:31,  5.19s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0465, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8368, 'compress@10': 0.7113, 'time@10': 8.228}:  40%|████      | 4/10 [00:27<00:31,  5.19s/it] {'epoch': 5, 'num_users': 5.8, 'loss': 0.0465, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8368, 'compress@10': 0.7113, 'time@10': 8.228}:  50%|█████     | 5/10 [00:27<00:29,  5.88s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.049, 'hit_ratio@10': 0.7928, 'ndcg@10': 0.8355, 'compress@10': 0.7187, 'time@10': 8.6574}:  50%|█████     | 5/10 [00:38<00:29,  5.88s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.049, 'hit_ratio@10': 0.7928, 'ndcg@10': 0.8355, 'compress@10': 0.7187, 'time@10': 8.6574}:  60%|██████    | 6/10 [00:38<00:30,  7.57s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8364, 'compress@10': 0.656, 'time@10': 8.9958}:  60%|██████    | 6/10 [00:43<00:30,  7.57s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.8167, 'ndcg@10': 0.8364, 'compress@10': 0.656, 'time@10': 8.9958}:  70%|███████   | 7/10 [00:43<00:20,  6.91s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0481, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8435, 'compress@10': 0.6282, 'time@10': 8.8771}:  70%|███████   | 7/10 [00:52<00:20,  6.91s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0481, 'hit_ratio@10': 0.8289, 'ndcg@10': 0.8435, 'compress@10': 0.6282, 'time@10': 8.8771}:  80%|████████  | 8/10 [00:52<00:14,  7.28s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0492, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8431, 'compress@10': 0.5705, 'time@10': 9.3392}:  80%|████████  | 8/10 [00:58<00:14,  7.28s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0492, 'hit_ratio@10': 0.8193, 'ndcg@10': 0.8431, 'compress@10': 0.5705, 'time@10': 9.3392}:  90%|█████████ | 9/10 [00:58<00:07,  7.06s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0482, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8448, 'compress@10': 0.5239, 'time@10': 9.3142}:  90%|█████████ | 9/10 [01:07<00:07,  7.06s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0482, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8448, 'compress@10': 0.5239, 'time@10': 9.3142}: 100%|██████████| 10/10 [01:07<00:00,  7.69s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0482, 'hit_ratio@10': 0.8306, 'ndcg@10': 0.8448, 'compress@10': 0.5239, 'time@10': 9.3142}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.048202760774582985
Avg hit ratio: 0.8305874559321079
Avg ndcg: 0.8447527565597597
Avg compression ratio: 0.5238950352235368
Avg train time: 9.314204931259155
Std train time: 2.833992077029669
[0.49999999999999994, 0.9285714285714286, 0.2142857142857143, 0.9285714285714286, 0.7857142857142857, 0.7857142857142857, 0.2142857142857143, 0.3571428571428571, 0.2142857142857143, 0.07142857142857144]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.5263, 'time@10': 8.4695}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.5263, 'time@10': 8.4695}:  10%|█         | 1/10 [00:04<00:38,  4.27s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8624, 'compress@10': 0.7286, 'time@10': 7.5807}:  10%|█         | 1/10 [00:11<00:38,  4.27s/it] {'epoch': 6, 'num_users': 7.0, 'loss': 0.046, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8624, 'compress@10': 0.7286, 'time@10': 7.5807}:  20%|██        | 2/10 [00:11<00:45,  5.72s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8607, 'compress@10': 0.5946, 'time@10': 6.5307}:  20%|██        | 2/10 [00:13<00:45,  5.72s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8607, 'compress@10': 0.5946, 'time@10': 6.5307}:  30%|███       | 3/10 [00:13<00:28,  4.13s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0355, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8564, 'compress@10': 0.6787, 'time@10': 6.366}:  30%|███       | 3/10 [00:19<00:28,  4.13s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0355, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8564, 'compress@10': 0.6787, 'time@10': 6.366}:  40%|████      | 4/10 [00:19<00:29,  4.84s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8415, 'compress@10': 0.701, 'time@10': 7.7967}:  40%|████      | 4/10 [00:25<00:29,  4.84s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.8254, 'ndcg@10': 0.8415, 'compress@10': 0.701, 'time@10': 7.7967}:  50%|█████     | 5/10 [00:25<00:27,  5.54s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0464, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8407, 'compress@10': 0.7159, 'time@10': 8.1573}:  50%|█████     | 5/10 [00:35<00:27,  5.54s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0464, 'hit_ratio@10': 0.8285, 'ndcg@10': 0.8407, 'compress@10': 0.7159, 'time@10': 8.1573}:  60%|██████    | 6/10 [00:35<00:28,  7.06s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0457, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8424, 'compress@10': 0.6487, 'time@10': 8.573}:  60%|██████    | 6/10 [00:41<00:28,  7.06s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.0457, 'hit_ratio@10': 0.8473, 'ndcg@10': 0.8424, 'compress@10': 0.6487, 'time@10': 8.573}:  70%|███████   | 7/10 [00:41<00:19,  6.57s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0451, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8506, 'compress@10': 0.6146, 'time@10': 8.4946}:  70%|███████   | 7/10 [00:49<00:19,  6.57s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0451, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.8506, 'compress@10': 0.6146, 'time@10': 8.4946}:  80%|████████  | 8/10 [00:49<00:14,  7.02s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0434, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8573, 'compress@10': 0.5726, 'time@10': 9.1043}:  80%|████████  | 8/10 [00:56<00:14,  7.02s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0434, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8573, 'compress@10': 0.5726, 'time@10': 9.1043}:  90%|█████████ | 9/10 [00:56<00:07,  7.02s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8584, 'compress@10': 0.5246, 'time@10': 9.1034}:  90%|█████████ | 9/10 [01:05<00:07,  7.02s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8584, 'compress@10': 0.5246, 'time@10': 9.1034}: 100%|██████████| 10/10 [01:05<00:00,  7.67s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0428, 'hit_ratio@10': 0.8549, 'ndcg@10': 0.8584, 'compress@10': 0.5246, 'time@10': 9.1034}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04275309020399864
Avg hit ratio: 0.8548731702178222
Avg ndcg: 0.8584063401020939
Avg compression ratio: 0.524578264382807
Avg train time: 9.103376364707946
Std train time: 2.961738989314799
[0.5625, 0.9375, 0.1875, 0.9375, 0.8125, 0.8125, 0.1875, 0.31249999999999994, 0.1875, 0.06250000000000001]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8399, 'compress@10': 0.5855, 'time@10': 8.5482}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0495, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8399, 'compress@10': 0.5855, 'time@10': 8.5482}:  10%|█         | 1/10 [00:04<00:38,  4.31s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8498, 'compress@10': 0.7625, 'time@10': 7.6637}:  10%|█         | 1/10 [00:11<00:38,  4.31s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8498, 'compress@10': 0.7625, 'time@10': 7.6637}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8523, 'compress@10': 0.6095, 'time@10': 6.6265}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0305, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8523, 'compress@10': 0.6095, 'time@10': 6.6265}:  30%|███       | 3/10 [00:13<00:29,  4.20s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0357, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.854, 'compress@10': 0.6921, 'time@10': 6.4253}:  30%|███       | 3/10 [00:19<00:29,  4.20s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0357, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.854, 'compress@10': 0.6921, 'time@10': 6.4253}:  40%|████      | 4/10 [00:19<00:29,  4.85s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0438, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8405, 'compress@10': 0.7169, 'time@10': 7.799}:  40%|████      | 4/10 [00:25<00:29,  4.85s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0438, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8405, 'compress@10': 0.7169, 'time@10': 7.799}:  50%|█████     | 5/10 [00:25<00:27,  5.51s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0453, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8414, 'compress@10': 0.7335, 'time@10': 8.2129}:  50%|█████     | 5/10 [00:36<00:27,  5.51s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0453, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.8414, 'compress@10': 0.7335, 'time@10': 8.2129}:  60%|██████    | 6/10 [00:36<00:28,  7.15s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0447, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8456, 'compress@10': 0.6602, 'time@10': 8.6059}:  60%|██████    | 6/10 [00:41<00:28,  7.15s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0447, 'hit_ratio@10': 0.8551, 'ndcg@10': 0.8456, 'compress@10': 0.6602, 'time@10': 8.6059}:  70%|███████   | 7/10 [00:41<00:19,  6.61s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0443, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8551, 'compress@10': 0.6192, 'time@10': 8.5069}:  70%|███████   | 7/10 [00:49<00:19,  6.61s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0443, 'hit_ratio@10': 0.8625, 'ndcg@10': 0.8551, 'compress@10': 0.6192, 'time@10': 8.5069}:  80%|████████  | 8/10 [00:49<00:14,  7.01s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0436, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8644, 'compress@10': 0.5738, 'time@10': 9.0694}:  80%|████████  | 8/10 [00:56<00:14,  7.01s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0436, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.8644, 'compress@10': 0.5738, 'time@10': 9.0694}:  90%|█████████ | 9/10 [00:56<00:06,  6.95s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0426, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8648, 'compress@10': 0.5248, 'time@10': 9.0729}:  90%|█████████ | 9/10 [01:05<00:06,  6.95s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0426, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8648, 'compress@10': 0.5248, 'time@10': 9.0729}: 100%|██████████| 10/10 [01:05<00:00,  7.63s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0426, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8648, 'compress@10': 0.5248, 'time@10': 9.0729}: 100%|██████████| 10/10 [01:05<00:00,  6.56s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.042643212302851126
Avg hit ratio: 0.8654510690215274
Avg ndcg: 0.8648364834249677
Avg compression ratio: 0.5247898376061252
Avg train time: 9.072856378555297
Std train time: 2.8497164231909133
[0.6111111111111112, 0.9444444444444444, 0.16666666666666666, 0.9444444444444444, 0.8333333333333334, 0.8333333333333334, 0.16666666666666666, 0.27777777777777773, 0.16666666666666666, 0.055555555555555566]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.862, 'compress@10': 0.6316, 'time@10': 8.5164}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0453, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.862, 'compress@10': 0.6316, 'time@10': 8.5164}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8654, 'compress@10': 0.7889, 'time@10': 7.5854}:  10%|█         | 1/10 [00:10<00:38,  4.30s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8654, 'compress@10': 0.7889, 'time@10': 7.5854}:  20%|██        | 2/10 [00:10<00:45,  5.70s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8627, 'compress@10': 0.6212, 'time@10': 6.736}:  20%|██        | 2/10 [00:13<00:45,  5.70s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8627, 'compress@10': 0.6212, 'time@10': 6.736}:  30%|███       | 3/10 [00:13<00:29,  4.27s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8641, 'compress@10': 0.7025, 'time@10': 6.4765}:  30%|███       | 3/10 [00:19<00:29,  4.27s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0329, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8641, 'compress@10': 0.7025, 'time@10': 6.4765}:  40%|████      | 4/10 [00:19<00:29,  4.85s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0409, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.85, 'compress@10': 0.7293, 'time@10': 7.8864}:  40%|████      | 4/10 [00:26<00:29,  4.85s/it]  {'epoch': 8, 'num_users': 5.8, 'loss': 0.0409, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.85, 'compress@10': 0.7293, 'time@10': 7.8864}:  50%|█████     | 5/10 [00:26<00:27,  5.55s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0422, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8497, 'compress@10': 0.7473, 'time@10': 8.2676}:  50%|█████     | 5/10 [00:36<00:27,  5.55s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0422, 'hit_ratio@10': 0.843, 'ndcg@10': 0.8497, 'compress@10': 0.7473, 'time@10': 8.2676}:  60%|██████    | 6/10 [00:36<00:28,  7.14s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0415, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8491, 'compress@10': 0.6691, 'time@10': 8.6634}:  60%|██████    | 6/10 [00:41<00:28,  7.14s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0415, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8491, 'compress@10': 0.6691, 'time@10': 8.6634}:  70%|███████   | 7/10 [00:41<00:19,  6.62s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0414, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8588, 'compress@10': 0.6228, 'time@10': 8.5817}:  70%|███████   | 7/10 [00:49<00:19,  6.62s/it] {'epoch': 8, 'num_users': 6.125, 'loss': 0.0414, 'hit_ratio@10': 0.8665, 'ndcg@10': 0.8588, 'compress@10': 0.6228, 'time@10': 8.5817}:  80%|████████  | 8/10 [00:49<00:14,  7.07s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0433, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8762, 'compress@10': 0.5747, 'time@10': 9.1426}:  80%|████████  | 8/10 [00:56<00:14,  7.07s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0433, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8762, 'compress@10': 0.5747, 'time@10': 9.1426}:  90%|█████████ | 9/10 [00:56<00:07,  7.01s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0417, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8777, 'compress@10': 0.525, 'time@10': 9.1338}:  90%|█████████ | 9/10 [01:05<00:07,  7.01s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0417, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8777, 'compress@10': 0.525, 'time@10': 9.1338}: 100%|██████████| 10/10 [01:05<00:00,  7.65s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0417, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8777, 'compress@10': 0.525, 'time@10': 9.1338}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04168186242493655
Avg hit ratio: 0.8658125641572161
Avg ndcg: 0.87771711143314
Avg compression ratio: 0.5249550520559209
Avg train time: 9.133782434463502
Std train time: 2.83908668814198
[0.65, 0.85, 0.15, 0.95, 0.8500000000000001, 0.8500000000000001, 0.15, 0.24999999999999997, 0.25, 0.05000000000000001]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8431, 'compress@10': 0.6684, 'time@10': 8.531}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8431, 'compress@10': 0.6684, 'time@10': 8.531}:  10%|█         | 1/10 [00:04<00:38,  4.30s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8613, 'compress@10': 0.7616, 'time@10': 7.7389}:  10%|█         | 1/10 [00:11<00:38,  4.30s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0414, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8613, 'compress@10': 0.7616, 'time@10': 7.7389}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8599, 'compress@10': 0.5982, 'time@10': 6.9386}:  20%|██        | 2/10 [00:13<00:47,  5.88s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8599, 'compress@10': 0.5982, 'time@10': 6.9386}:  30%|███       | 3/10 [00:13<00:31,  4.43s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8641, 'compress@10': 0.6866, 'time@10': 6.6414}:  30%|███       | 3/10 [00:19<00:31,  4.43s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8641, 'compress@10': 0.6866, 'time@10': 6.6414}:  40%|████      | 4/10 [00:19<00:29,  4.97s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0391, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8514, 'compress@10': 0.7199, 'time@10': 7.9506}:  40%|████      | 4/10 [00:26<00:29,  4.97s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0391, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8514, 'compress@10': 0.7199, 'time@10': 7.9506}:  50%|█████     | 5/10 [00:26<00:27,  5.57s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0398, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8521, 'compress@10': 0.7421, 'time@10': 8.3043}:  50%|█████     | 5/10 [00:36<00:27,  5.57s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0398, 'hit_ratio@10': 0.8393, 'ndcg@10': 0.8521, 'compress@10': 0.7421, 'time@10': 8.3043}:  60%|██████    | 6/10 [00:36<00:28,  7.11s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0398, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8575, 'compress@10': 0.6624, 'time@10': 8.6706}:  60%|██████    | 6/10 [00:41<00:28,  7.11s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0398, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8575, 'compress@10': 0.6624, 'time@10': 8.6706}:  70%|███████   | 7/10 [00:41<00:19,  6.57s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0395, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8637, 'compress@10': 0.6135, 'time@10': 8.5846}:  70%|███████   | 7/10 [00:50<00:19,  6.57s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0395, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8637, 'compress@10': 0.6135, 'time@10': 8.5846}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0405, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8642, 'compress@10': 0.5755, 'time@10': 9.2701}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0405, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8642, 'compress@10': 0.5755, 'time@10': 9.2701}:  90%|█████████ | 9/10 [00:57<00:07,  7.15s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0399, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.866, 'compress@10': 0.5251, 'time@10': 9.2444}:  90%|█████████ | 9/10 [01:06<00:07,  7.15s/it]    {'epoch': 9, 'num_users': 6.3, 'loss': 0.0399, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.866, 'compress@10': 0.5251, 'time@10': 9.2444}: 100%|██████████| 10/10 [01:06<00:00,  7.74s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0399, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.866, 'compress@10': 0.5251, 'time@10': 9.2444}: 100%|██████████| 10/10 [01:06<00:00,  6.65s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.039869426310524404
Avg hit ratio: 0.8664474847921367
Avg ndcg: 0.865964394351051
Avg compression ratio: 0.5251213409330744
Avg train time: 9.244351792335511
Std train time: 2.900596275399909
[0.6818181818181819, 0.7727272727272727, 0.13636363636363635, 0.9545454545454545, 0.8636363636363638, 0.8636363636363638, 0.13636363636363635, 0.22727272727272724, 0.3181818181818182, 0.04545454545454546]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.6986, 'time@10': 8.5576}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 0.6986, 'time@10': 8.5576}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8738, 'compress@10': 0.7393, 'time@10': 7.7803}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0386, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8738, 'compress@10': 0.7393, 'time@10': 7.7803}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8682, 'compress@10': 0.5794, 'time@10': 6.9449}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0257, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8682, 'compress@10': 0.5794, 'time@10': 6.9449}:  30%|███       | 3/10 [00:14<00:31,  4.44s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8716, 'compress@10': 0.6736, 'time@10': 6.6011}:  30%|███       | 3/10 [00:19<00:31,  4.44s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8716, 'compress@10': 0.6736, 'time@10': 6.6011}:  40%|████      | 4/10 [00:19<00:29,  4.90s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0366, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8579, 'compress@10': 0.7122, 'time@10': 7.9516}:  40%|████      | 4/10 [00:26<00:29,  4.90s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0366, 'hit_ratio@10': 0.8334, 'ndcg@10': 0.8579, 'compress@10': 0.7122, 'time@10': 7.9516}:  50%|█████     | 5/10 [00:26<00:27,  5.55s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0371, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8582, 'compress@10': 0.7379, 'time@10': 8.2857}:  50%|█████     | 5/10 [00:36<00:27,  5.55s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0371, 'hit_ratio@10': 0.8426, 'ndcg@10': 0.8582, 'compress@10': 0.7379, 'time@10': 8.2857}:  60%|██████    | 6/10 [00:36<00:28,  7.06s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0371, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8568, 'compress@10': 0.6569, 'time@10': 8.6614}:  60%|██████    | 6/10 [00:41<00:28,  7.06s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0371, 'hit_ratio@10': 0.8594, 'ndcg@10': 0.8568, 'compress@10': 0.6569, 'time@10': 8.6614}:  70%|███████   | 7/10 [00:41<00:19,  6.55s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0369, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8636, 'compress@10': 0.606, 'time@10': 8.583}:  70%|███████   | 7/10 [00:49<00:19,  6.55s/it]   {'epoch': 10, 'num_users': 6.125, 'loss': 0.0369, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8636, 'compress@10': 0.606, 'time@10': 8.583}:  80%|████████  | 8/10 [00:49<00:14,  7.04s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0361, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8702, 'compress@10': 0.5762, 'time@10': 9.2106}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0361, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8702, 'compress@10': 0.5762, 'time@10': 9.2106}:  90%|█████████ | 9/10 [00:57<00:07,  7.07s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0347, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8757, 'compress@10': 0.5253, 'time@10': 9.187}:  90%|█████████ | 9/10 [01:06<00:07,  7.07s/it]    {'epoch': 10, 'num_users': 6.3, 'loss': 0.0347, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8757, 'compress@10': 0.5253, 'time@10': 9.187}: 100%|██████████| 10/10 [01:06<00:00,  7.67s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0347, 'hit_ratio@10': 0.8707, 'ndcg@10': 0.8757, 'compress@10': 0.5253, 'time@10': 9.187}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.034745003933355945
Avg hit ratio: 0.870720212064864
Avg ndcg: 0.875665613632844
Avg compression ratio: 0.5252601405332169
Avg train time: 9.187002182006836
Std train time: 2.851871021086416
[0.7083333333333334, 0.7083333333333333, 0.12499999999999999, 0.9583333333333333, 0.8750000000000001, 0.8750000000000001, 0.20833333333333331, 0.20833333333333331, 0.2916666666666667, 0.04166666666666667]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8483, 'compress@10': 0.7237, 'time@10': 8.3557}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8483, 'compress@10': 0.7237, 'time@10': 8.3557}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8652, 'compress@10': 0.7207, 'time@10': 7.6007}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0367, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8652, 'compress@10': 0.7207, 'time@10': 7.6007}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8625, 'compress@10': 0.5638, 'time@10': 6.819}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.0244, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8625, 'compress@10': 0.5638, 'time@10': 6.819}:  30%|███       | 3/10 [00:13<00:30,  4.36s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8691, 'compress@10': 0.6628, 'time@10': 6.5061}:  30%|███       | 3/10 [00:19<00:30,  4.36s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8691, 'compress@10': 0.6628, 'time@10': 6.5061}:  40%|████      | 4/10 [00:19<00:29,  4.85s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0349, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8568, 'compress@10': 0.7057, 'time@10': 7.8582}:  40%|████      | 4/10 [00:26<00:29,  4.85s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0349, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8568, 'compress@10': 0.7057, 'time@10': 7.8582}:  50%|█████     | 5/10 [00:26<00:27,  5.51s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0349, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8595, 'compress@10': 0.7344, 'time@10': 8.2522}:  50%|█████     | 5/10 [00:36<00:27,  5.51s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0349, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8595, 'compress@10': 0.7344, 'time@10': 8.2522}:  60%|██████    | 6/10 [00:36<00:28,  7.12s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0352, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8646, 'compress@10': 0.6638, 'time@10': 8.633}:  60%|██████    | 6/10 [00:41<00:28,  7.12s/it] {'epoch': 11, 'num_users': 6.2857, 'loss': 0.0352, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8646, 'compress@10': 0.6638, 'time@10': 8.633}:  70%|███████   | 7/10 [00:41<00:19,  6.59s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0347, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.87, 'compress@10': 0.6097, 'time@10': 8.5095}:  70%|███████   | 7/10 [00:49<00:19,  6.59s/it]  {'epoch': 11, 'num_users': 6.125, 'loss': 0.0347, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.87, 'compress@10': 0.6097, 'time@10': 8.5095}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0355, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8845, 'compress@10': 0.5766, 'time@10': 9.1654}:  80%|████████  | 8/10 [00:56<00:13,  6.94s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0355, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.8845, 'compress@10': 0.5766, 'time@10': 9.1654}:  90%|█████████ | 9/10 [00:56<00:07,  7.03s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0354, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8863, 'compress@10': 0.5253, 'time@10': 9.1545}:  90%|█████████ | 9/10 [01:05<00:07,  7.03s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0354, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8863, 'compress@10': 0.5253, 'time@10': 9.1545}: 100%|██████████| 10/10 [01:05<00:00,  7.67s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0354, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8863, 'compress@10': 0.5253, 'time@10': 9.1545}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03544735352090568
Avg hit ratio: 0.8781550871313181
Avg ndcg: 0.8863229906083699
Avg compression ratio: 0.525281414893189
Avg train time: 9.154484033584595
Std train time: 2.9176955479127145
[0.7307692307692308, 0.6538461538461537, 0.11538461538461538, 0.9615384615384615, 0.8846153846153847, 0.8076923076923078, 0.2692307692307692, 0.1923076923076923, 0.34615384615384615, 0.038461538461538464]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8605, 'compress@10': 0.7449, 'time@10': 8.6424}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8605, 'compress@10': 0.7449, 'time@10': 8.6424}:  10%|█         | 1/10 [00:04<00:39,  4.36s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8787, 'compress@10': 0.705, 'time@10': 7.9066}:  10%|█         | 1/10 [00:11<00:39,  4.36s/it] {'epoch': 12, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8787, 'compress@10': 0.705, 'time@10': 7.9066}:  20%|██        | 2/10 [00:11<00:48,  6.03s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8715, 'compress@10': 0.5506, 'time@10': 7.0898}:  20%|██        | 2/10 [00:14<00:48,  6.03s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0238, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8715, 'compress@10': 0.5506, 'time@10': 7.0898}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.878, 'compress@10': 0.6536, 'time@10': 6.6799}:  30%|███       | 3/10 [00:19<00:31,  4.54s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0267, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.878, 'compress@10': 0.6536, 'time@10': 6.6799}:  40%|████      | 4/10 [00:19<00:29,  4.91s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0335, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8645, 'compress@10': 0.7003, 'time@10': 8.0175}:  40%|████      | 4/10 [00:26<00:29,  4.91s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0335, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8645, 'compress@10': 0.7003, 'time@10': 8.0175}:  50%|█████     | 5/10 [00:26<00:27,  5.57s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0343, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8681, 'compress@10': 0.7189, 'time@10': 8.4011}:  50%|█████     | 5/10 [00:36<00:27,  5.57s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0343, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8681, 'compress@10': 0.7189, 'time@10': 8.4011}:  60%|██████    | 6/10 [00:36<00:28,  7.19s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.034, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8677, 'compress@10': 0.6588, 'time@10': 8.7846}:  60%|██████    | 6/10 [00:42<00:28,  7.19s/it]  {'epoch': 12, 'num_users': 6.2857, 'loss': 0.034, 'hit_ratio@10': 0.879, 'ndcg@10': 0.8677, 'compress@10': 0.6588, 'time@10': 8.7846}:  70%|███████   | 7/10 [00:42<00:19,  6.67s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0334, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8728, 'compress@10': 0.6034, 'time@10': 8.6501}:  70%|███████   | 7/10 [00:50<00:19,  6.67s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0334, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8728, 'compress@10': 0.6034, 'time@10': 8.6501}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0338, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8771, 'compress@10': 0.5769, 'time@10': 9.2922}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0338, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8771, 'compress@10': 0.5769, 'time@10': 9.2922}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.8836, 'compress@10': 0.5252, 'time@10': 9.2713}:  90%|█████████ | 9/10 [01:06<00:07,  7.09s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.8836, 'compress@10': 0.5252, 'time@10': 9.2713}: 100%|██████████| 10/10 [01:06<00:00,  7.71s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0318, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.8836, 'compress@10': 0.5252, 'time@10': 9.2713}: 100%|██████████| 10/10 [01:06<00:00,  6.66s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03183991387038526
Avg hit ratio: 0.8872849572611882
Avg ndcg: 0.8835823356773636
Avg compression ratio: 0.525247515548353
Avg train time: 9.271332740783691
Std train time: 2.9019064149950085
[0.7500000000000001, 0.6071428571428571, 0.10714285714285714, 0.9642857142857142, 0.8928571428571429, 0.8214285714285715, 0.25, 0.17857142857142855, 0.39285714285714285, 0.03571428571428572]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8468, 'compress@10': 0.7632, 'time@10': 8.2982}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8468, 'compress@10': 0.7632, 'time@10': 8.2982}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8718, 'compress@10': 0.6915, 'time@10': 7.6573}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0369, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8718, 'compress@10': 0.6915, 'time@10': 7.6573}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8669, 'compress@10': 0.5392, 'time@10': 6.9735}:  20%|██        | 2/10 [00:14<00:46,  5.87s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8669, 'compress@10': 0.5392, 'time@10': 6.9735}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8722, 'compress@10': 0.6458, 'time@10': 6.686}:  30%|███       | 3/10 [00:19<00:31,  4.49s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0272, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8722, 'compress@10': 0.6458, 'time@10': 6.686}:  40%|████      | 4/10 [00:19<00:30,  5.03s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0332, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8615, 'compress@10': 0.6956, 'time@10': 7.9823}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0332, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8615, 'compress@10': 0.6956, 'time@10': 7.9823}:  50%|█████     | 5/10 [00:26<00:28,  5.60s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0326, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8658, 'compress@10': 0.7173, 'time@10': 8.3408}:  50%|█████     | 5/10 [00:36<00:28,  5.60s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0326, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8658, 'compress@10': 0.7173, 'time@10': 8.3408}:  60%|██████    | 6/10 [00:36<00:28,  7.16s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0325, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.871, 'compress@10': 0.6548, 'time@10': 8.7438}:  60%|██████    | 6/10 [00:42<00:28,  7.16s/it] {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0325, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.871, 'compress@10': 0.6548, 'time@10': 8.7438}:  70%|███████   | 7/10 [00:42<00:19,  6.65s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0319, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.8768, 'compress@10': 0.5982, 'time@10': 8.6195}:  70%|███████   | 7/10 [00:50<00:19,  6.65s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0319, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.8768, 'compress@10': 0.5982, 'time@10': 8.6195}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0307, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8824, 'compress@10': 0.5773, 'time@10': 9.2698}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0307, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.8824, 'compress@10': 0.5773, 'time@10': 9.2698}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0305, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8854, 'compress@10': 0.5253, 'time@10': 9.2381}:  90%|█████████ | 9/10 [01:06<00:07,  7.09s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0305, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8854, 'compress@10': 0.5253, 'time@10': 9.2381}: 100%|██████████| 10/10 [01:06<00:00,  7.68s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0305, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8854, 'compress@10': 0.5253, 'time@10': 9.2381}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03047095003405838
Avg hit ratio: 0.8866500366262675
Avg ndcg: 0.8854246716527424
Avg compression ratio: 0.5253466346741025
Avg train time: 9.23807864189148
Std train time: 2.833907297974053
[0.7666666666666667, 0.5666666666666667, 0.09999999999999999, 0.9666666666666666, 0.9, 0.8333333333333334, 0.3, 0.16666666666666666, 0.36666666666666664, 0.03333333333333334]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8677, 'compress@10': 0.7789, 'time@10': 8.2917}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8677, 'compress@10': 0.7789, 'time@10': 8.2917}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0342, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8846, 'compress@10': 0.6798, 'time@10': 7.7353}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0342, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8846, 'compress@10': 0.6798, 'time@10': 7.7353}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8755, 'compress@10': 0.5294, 'time@10': 7.0248}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8755, 'compress@10': 0.5294, 'time@10': 7.0248}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8816, 'compress@10': 0.639, 'time@10': 6.7083}:  30%|███       | 3/10 [00:20<00:31,  4.54s/it] {'epoch': 14, 'num_users': 5.0, 'loss': 0.0255, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8816, 'compress@10': 0.639, 'time@10': 6.7083}:  40%|████      | 4/10 [00:20<00:30,  5.04s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0313, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.869, 'compress@10': 0.6916, 'time@10': 7.9949}:  40%|████      | 4/10 [00:26<00:30,  5.04s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0313, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.869, 'compress@10': 0.6916, 'time@10': 7.9949}:  50%|█████     | 5/10 [00:26<00:28,  5.61s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0308, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.873, 'compress@10': 0.7158, 'time@10': 8.3178}:  50%|█████     | 5/10 [00:36<00:28,  5.61s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0308, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.873, 'compress@10': 0.7158, 'time@10': 8.3178}:  60%|██████    | 6/10 [00:36<00:28,  7.09s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0305, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8729, 'compress@10': 0.6604, 'time@10': 8.7135}:  60%|██████    | 6/10 [00:42<00:28,  7.09s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0305, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8729, 'compress@10': 0.6604, 'time@10': 8.7135}:  70%|███████   | 7/10 [00:42<00:19,  6.60s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.03, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8803, 'compress@10': 0.6017, 'time@10': 8.579}:  70%|███████   | 7/10 [00:49<00:19,  6.60s/it]    {'epoch': 14, 'num_users': 6.125, 'loss': 0.03, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8803, 'compress@10': 0.6017, 'time@10': 8.579}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0291, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8868, 'compress@10': 0.5776, 'time@10': 9.224}:  80%|████████  | 8/10 [00:57<00:13,  6.94s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0291, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8868, 'compress@10': 0.5776, 'time@10': 9.224}:  90%|█████████ | 9/10 [00:57<00:07,  7.03s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8925, 'compress@10': 0.5254, 'time@10': 9.2305}:  90%|█████████ | 9/10 [01:06<00:07,  7.03s/it]  {'epoch': 14, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8925, 'compress@10': 0.5254, 'time@10': 9.2305}: 100%|██████████| 10/10 [01:06<00:00,  7.74s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0283, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8925, 'compress@10': 0.5254, 'time@10': 9.2305}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.028281089993095115
Avg hit ratio: 0.8842440215886735
Avg ndcg: 0.8925038856303029
Avg compression ratio: 0.5253570322836167
Avg train time: 9.230456209182739
Std train time: 2.8040217781523844
[0.78125, 0.53125, 0.09374999999999999, 0.9687499999999999, 0.90625, 0.84375, 0.34375, 0.15625, 0.34375, 0.03125000000000001]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8731, 'compress@10': 0.7928, 'time@10': 8.2196}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8731, 'compress@10': 0.7928, 'time@10': 8.2196}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0329, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8916, 'compress@10': 0.6696, 'time@10': 7.668}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it] {'epoch': 15, 'num_users': 7.0, 'loss': 0.0329, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8916, 'compress@10': 0.6696, 'time@10': 7.668}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8801, 'compress@10': 0.5208, 'time@10': 6.9448}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8801, 'compress@10': 0.5208, 'time@10': 6.9448}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.889, 'compress@10': 0.633, 'time@10': 6.5886}:  30%|███       | 3/10 [00:19<00:31,  4.49s/it]  {'epoch': 15, 'num_users': 5.0, 'loss': 0.024, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.889, 'compress@10': 0.633, 'time@10': 6.5886}:  40%|████      | 4/10 [00:19<00:29,  4.91s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8783, 'compress@10': 0.6881, 'time@10': 7.8375}:  40%|████      | 4/10 [00:26<00:29,  4.91s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8783, 'compress@10': 0.6881, 'time@10': 7.8375}:  50%|█████     | 5/10 [00:26<00:27,  5.47s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0293, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8807, 'compress@10': 0.7146, 'time@10': 8.1623}:  50%|█████     | 5/10 [00:35<00:27,  5.47s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0293, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8807, 'compress@10': 0.7146, 'time@10': 8.1623}:  60%|██████    | 6/10 [00:35<00:27,  6.95s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8848, 'compress@10': 0.6654, 'time@10': 8.6235}:  60%|██████    | 6/10 [00:41<00:27,  6.95s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.8848, 'compress@10': 0.6654, 'time@10': 8.6235}:  70%|███████   | 7/10 [00:41<00:19,  6.55s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0287, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.8913, 'compress@10': 0.6047, 'time@10': 8.5089}:  70%|███████   | 7/10 [00:49<00:19,  6.55s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0287, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.8913, 'compress@10': 0.6047, 'time@10': 8.5089}:  80%|████████  | 8/10 [00:49<00:13,  6.93s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0295, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9046, 'compress@10': 0.5778, 'time@10': 9.1275}:  80%|████████  | 8/10 [00:56<00:13,  6.93s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0295, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9046, 'compress@10': 0.5778, 'time@10': 9.1275}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9066, 'compress@10': 0.5254, 'time@10': 9.148}:  90%|█████████ | 9/10 [01:05<00:06,  6.98s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9066, 'compress@10': 0.5254, 'time@10': 9.148}: 100%|██████████| 10/10 [01:05<00:00,  7.72s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0291, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9066, 'compress@10': 0.5254, 'time@10': 9.148}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.029137222066104355
Avg hit ratio: 0.8866500366262675
Avg ndcg: 0.9066398222757641
Avg compression ratio: 0.525365761118177
Avg train time: 9.148041009902954
Std train time: 2.772915622216137
[0.7941176470588235, 0.5, 0.08823529411764705, 0.9705882352941175, 0.9117647058823529, 0.7941176470588235, 0.38235294117647056, 0.14705882352941177, 0.38235294117647056, 0.02941176470588236]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8703, 'compress@10': 0.8049, 'time@10': 8.3465}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8703, 'compress@10': 0.8049, 'time@10': 8.3465}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8956, 'compress@10': 0.6605, 'time@10': 7.7806}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0302, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8956, 'compress@10': 0.6605, 'time@10': 7.7806}:  20%|██        | 2/10 [00:11<00:48,  6.01s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8828, 'compress@10': 0.5132, 'time@10': 7.0235}:  20%|██        | 2/10 [00:14<00:48,  6.01s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0202, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8828, 'compress@10': 0.5132, 'time@10': 7.0235}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8926, 'compress@10': 0.6278, 'time@10': 6.6466}:  30%|███       | 3/10 [00:19<00:31,  4.54s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0218, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8926, 'compress@10': 0.6278, 'time@10': 6.6466}:  40%|████      | 4/10 [00:19<00:29,  4.94s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0271, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8829, 'compress@10': 0.6849, 'time@10': 7.9312}:  40%|████      | 4/10 [00:26<00:29,  4.94s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0271, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8829, 'compress@10': 0.6849, 'time@10': 7.9312}:  50%|█████     | 5/10 [00:26<00:27,  5.53s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8913, 'compress@10': 0.7039, 'time@10': 8.3171}:  50%|█████     | 5/10 [00:36<00:27,  5.53s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0287, 'hit_ratio@10': 0.8692, 'ndcg@10': 0.8913, 'compress@10': 0.7039, 'time@10': 8.3171}:  60%|██████    | 6/10 [00:36<00:28,  7.14s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0283, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.892, 'compress@10': 0.6615, 'time@10': 8.7208}:  60%|██████    | 6/10 [00:42<00:28,  7.14s/it] {'epoch': 16, 'num_users': 6.2857, 'loss': 0.0283, 'hit_ratio@10': 0.8821, 'ndcg@10': 0.892, 'compress@10': 0.6615, 'time@10': 8.7208}:  70%|███████   | 7/10 [00:42<00:19,  6.64s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0277, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.8982, 'compress@10': 0.6002, 'time@10': 8.5984}:  70%|███████   | 7/10 [00:50<00:19,  6.64s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0277, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.8982, 'compress@10': 0.6002, 'time@10': 8.5984}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9143, 'compress@10': 0.578, 'time@10': 9.216}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it] {'epoch': 16, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.8861, 'ndcg@10': 0.9143, 'compress@10': 0.578, 'time@10': 9.216}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9183, 'compress@10': 0.5253, 'time@10': 9.1823}:  90%|█████████ | 9/10 [01:06<00:07,  7.04s/it] {'epoch': 16, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9183, 'compress@10': 0.5253, 'time@10': 9.1823}: 100%|██████████| 10/10 [01:06<00:00,  7.62s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0273, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9183, 'compress@10': 0.5253, 'time@10': 9.1823}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.02731494202005915
Avg hit ratio: 0.8952214651976961
Avg ndcg: 0.9183028389083061
Avg compression ratio: 0.5253355210820324
Avg train time: 9.182299900054932
Std train time: 2.8018184711637346
[0.8055555555555555, 0.4722222222222222, 0.08333333333333333, 0.9722222222222221, 0.9166666666666666, 0.8055555555555555, 0.3611111111111111, 0.1388888888888889, 0.41666666666666663, 0.027777777777777783]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8812, 'compress@10': 0.8158, 'time@10': 8.0713}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8812, 'compress@10': 0.8158, 'time@10': 8.0713}:  10%|█         | 1/10 [00:04<00:36,  4.07s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9029, 'compress@10': 0.6525, 'time@10': 7.5884}:  10%|█         | 1/10 [00:11<00:36,  4.07s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9029, 'compress@10': 0.6525, 'time@10': 7.5884}:  20%|██        | 2/10 [00:11<00:47,  5.88s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8877, 'compress@10': 0.5064, 'time@10': 6.8495}:  20%|██        | 2/10 [00:13<00:47,  5.88s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8877, 'compress@10': 0.5064, 'time@10': 6.8495}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8977, 'compress@10': 0.6231, 'time@10': 6.5882}:  30%|███       | 3/10 [00:19<00:31,  4.44s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0209, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8977, 'compress@10': 0.6231, 'time@10': 6.5882}:  40%|████      | 4/10 [00:19<00:29,  4.99s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8873, 'compress@10': 0.6822, 'time@10': 7.9094}:  40%|████      | 4/10 [00:26<00:29,  4.99s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0258, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8873, 'compress@10': 0.6822, 'time@10': 7.9094}:  50%|█████     | 5/10 [00:26<00:27,  5.58s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0253, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8925, 'compress@10': 0.7034, 'time@10': 8.3094}:  50%|█████     | 5/10 [00:36<00:27,  5.58s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0253, 'hit_ratio@10': 0.8595, 'ndcg@10': 0.8925, 'compress@10': 0.7034, 'time@10': 8.3094}:  60%|██████    | 6/10 [00:36<00:28,  7.20s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0254, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8953, 'compress@10': 0.6582, 'time@10': 8.7453}:  60%|██████    | 6/10 [00:42<00:28,  7.20s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0254, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8953, 'compress@10': 0.6582, 'time@10': 8.7453}:  70%|███████   | 7/10 [00:42<00:20,  6.72s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9007, 'compress@10': 0.5964, 'time@10': 8.6022}:  70%|███████   | 7/10 [00:50<00:20,  6.72s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0249, 'hit_ratio@10': 0.8825, 'ndcg@10': 0.9007, 'compress@10': 0.5964, 'time@10': 8.6022}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.867, 'ndcg@10': 0.9045, 'compress@10': 0.5782, 'time@10': 9.293}:  80%|████████  | 8/10 [00:57<00:14,  7.01s/it]  {'epoch': 17, 'num_users': 6.3333, 'loss': 0.026, 'hit_ratio@10': 0.867, 'ndcg@10': 0.9045, 'compress@10': 0.5782, 'time@10': 9.293}:  90%|█████████ | 9/10 [00:57<00:07,  7.15s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9057, 'compress@10': 0.5254, 'time@10': 9.2467}:  90%|█████████ | 9/10 [01:06<00:07,  7.15s/it] {'epoch': 17, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9057, 'compress@10': 0.5254, 'time@10': 9.2467}: 100%|██████████| 10/10 [01:06<00:00,  7.68s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9057, 'compress@10': 0.5254, 'time@10': 9.2467}: 100%|██████████| 10/10 [01:06<00:00,  6.64s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.025908441819996193
Avg hit ratio: 0.8779992429754738
Avg ndcg: 0.9057279117383856
Avg compression ratio: 0.5254079153722642
Avg train time: 9.246729302406312
Std train time: 2.9656417911353534
[0.8157894736842104, 0.4473684210526316, 0.07894736842105263, 0.9736842105263157, 0.9210526315789473, 0.763157894736842, 0.39473684210526316, 0.13157894736842105, 0.4473684210526315, 0.026315789473684216]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0335, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8812, 'compress@10': 0.8255, 'time@10': 8.2013}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0335, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8812, 'compress@10': 0.8255, 'time@10': 8.2013}:  10%|█         | 1/10 [00:04<00:37,  4.16s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0275, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9068, 'compress@10': 0.6453, 'time@10': 7.7105}:  10%|█         | 1/10 [00:11<00:37,  4.16s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0275, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9068, 'compress@10': 0.6453, 'time@10': 7.7105}:  20%|██        | 2/10 [00:11<00:47,  5.98s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8903, 'compress@10': 0.5004, 'time@10': 6.9931}:  20%|██        | 2/10 [00:14<00:47,  5.98s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8903, 'compress@10': 0.5004, 'time@10': 6.9931}:  30%|███       | 3/10 [00:14<00:31,  4.54s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8968, 'compress@10': 0.619, 'time@10': 6.6755}:  30%|███       | 3/10 [00:19<00:31,  4.54s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8968, 'compress@10': 0.619, 'time@10': 6.6755}:  40%|████      | 4/10 [00:19<00:30,  5.02s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8879, 'compress@10': 0.6797, 'time@10': 8.0881}:  40%|████      | 4/10 [00:26<00:30,  5.02s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8879, 'compress@10': 0.6797, 'time@10': 8.0881}:  50%|█████     | 5/10 [00:26<00:28,  5.70s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8959, 'compress@10': 0.6945, 'time@10': 8.4706}:  50%|█████     | 5/10 [00:37<00:28,  5.70s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8959, 'compress@10': 0.6945, 'time@10': 8.4706}:  60%|██████    | 6/10 [00:37<00:29,  7.31s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8973, 'compress@10': 0.6551, 'time@10': 8.911}:  60%|██████    | 6/10 [00:43<00:29,  7.31s/it]   {'epoch': 18, 'num_users': 6.2857, 'loss': 0.024, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8973, 'compress@10': 0.6551, 'time@10': 8.911}:  70%|███████   | 7/10 [00:43<00:20,  6.82s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9026, 'compress@10': 0.5928, 'time@10': 8.7521}:  70%|███████   | 7/10 [00:50<00:20,  6.82s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9026, 'compress@10': 0.5928, 'time@10': 8.7521}:  80%|████████  | 8/10 [00:50<00:14,  7.09s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0229, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9068, 'compress@10': 0.5784, 'time@10': 9.3933}:  80%|████████  | 8/10 [00:58<00:14,  7.09s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0229, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9068, 'compress@10': 0.5784, 'time@10': 9.3933}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9121, 'compress@10': 0.5254, 'time@10': 9.3459}:  90%|█████████ | 9/10 [01:07<00:07,  7.16s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9121, 'compress@10': 0.5254, 'time@10': 9.3459}: 100%|██████████| 10/10 [01:07<00:00,  7.71s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9121, 'compress@10': 0.5254, 'time@10': 9.3459}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.02135700095736289
Avg hit ratio: 0.8802214651976961
Avg ndcg: 0.9121112259628001
Avg compression ratio: 0.5253790245427805
Avg train time: 9.345937085151672
Std train time: 2.973879280973993
[0.8249999999999998, 0.475, 0.075, 0.9749999999999999, 0.9249999999999999, 0.725, 0.425, 0.125, 0.42499999999999993, 0.025000000000000005]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0351, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8812, 'compress@10': 0.8342, 'time@10': 8.519}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0351, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8812, 'compress@10': 0.8342, 'time@10': 8.519}:  10%|█         | 1/10 [00:04<00:38,  4.29s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9073, 'compress@10': 0.6631, 'time@10': 7.8795}:  10%|█         | 1/10 [00:11<00:38,  4.29s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0288, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9073, 'compress@10': 0.6631, 'time@10': 7.8795}:  20%|██        | 2/10 [00:11<00:48,  6.05s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8906, 'compress@10': 0.5111, 'time@10': 7.162}:  20%|██        | 2/10 [00:14<00:48,  6.05s/it] {'epoch': 19, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8906, 'compress@10': 0.5111, 'time@10': 7.162}:  30%|███       | 3/10 [00:14<00:32,  4.61s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8981, 'compress@10': 0.6273, 'time@10': 6.7797}:  30%|███       | 3/10 [00:20<00:32,  4.61s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.8981, 'compress@10': 0.6273, 'time@10': 6.7797}:  40%|████      | 4/10 [00:20<00:30,  5.03s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8894, 'compress@10': 0.6871, 'time@10': 8.0286}:  40%|████      | 4/10 [00:26<00:30,  5.03s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0251, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8894, 'compress@10': 0.6871, 'time@10': 8.0286}:  50%|█████     | 5/10 [00:26<00:27,  5.58s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0256, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8957, 'compress@10': 0.6945, 'time@10': 8.3399}:  50%|█████     | 5/10 [00:36<00:27,  5.58s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0256, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.8957, 'compress@10': 0.6945, 'time@10': 8.3399}:  60%|██████    | 6/10 [00:36<00:28,  7.06s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8996, 'compress@10': 0.6592, 'time@10': 8.7837}:  60%|██████    | 6/10 [00:42<00:28,  7.06s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0256, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.8996, 'compress@10': 0.6592, 'time@10': 8.7837}:  70%|███████   | 7/10 [00:42<00:19,  6.63s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0248, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9053, 'compress@10': 0.5956, 'time@10': 8.6479}:  70%|███████   | 7/10 [00:50<00:19,  6.63s/it]  {'epoch': 19, 'num_users': 6.125, 'loss': 0.0248, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9053, 'compress@10': 0.5956, 'time@10': 8.6479}:  80%|████████  | 8/10 [00:50<00:13,  6.99s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9101, 'compress@10': 0.5785, 'time@10': 9.2737}:  80%|████████  | 8/10 [00:57<00:13,  6.99s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.9101, 'compress@10': 0.5785, 'time@10': 9.2737}:  90%|█████████ | 9/10 [00:57<00:07,  7.05s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9127, 'compress@10': 0.5253, 'time@10': 9.2425}:  90%|█████████ | 9/10 [01:06<00:07,  7.05s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9127, 'compress@10': 0.5253, 'time@10': 9.2425}: 100%|██████████| 10/10 [01:06<00:00,  7.65s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0236, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9127, 'compress@10': 0.5253, 'time@10': 9.2425}: 100%|██████████| 10/10 [01:06<00:00,  6.63s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.0236164394892423
Avg hit ratio: 0.8769131945210044
Avg ndcg: 0.9127005564093214
Avg compression ratio: 0.5253335319202785
Avg train time: 9.242521190643311
Std train time: 2.781207458368237
[0.8333333333333331, 0.4523809523809524, 0.07142857142857142, 0.976190476190476, 0.9285714285714285, 0.738095238095238, 0.4523809523809524, 0.11904761904761904, 0.4047619047619047, 0.023809523809523815]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.8421, 'time@10': 8.1309}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0304, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.8421, 'time@10': 8.1309}:  10%|█         | 1/10 [00:04<00:36,  4.10s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9174, 'compress@10': 0.6561, 'time@10': 7.6302}:  10%|█         | 1/10 [00:11<00:36,  4.10s/it] {'epoch': 20, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9174, 'compress@10': 0.6561, 'time@10': 7.6302}:  20%|██        | 2/10 [00:11<00:47,  5.90s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8973, 'compress@10': 0.5054, 'time@10': 6.9237}:  20%|██        | 2/10 [00:14<00:47,  5.90s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.8973, 'compress@10': 0.5054, 'time@10': 6.9237}:  30%|███       | 3/10 [00:14<00:31,  4.48s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9054, 'compress@10': 0.6233, 'time@10': 6.541}:  30%|███       | 3/10 [00:19<00:31,  4.48s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9054, 'compress@10': 0.6233, 'time@10': 6.541}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8953, 'compress@10': 0.6846, 'time@10': 7.7994}:  40%|████      | 4/10 [00:25<00:29,  4.86s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8953, 'compress@10': 0.6846, 'time@10': 7.7994}:  50%|█████     | 5/10 [00:25<00:27,  5.43s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9026, 'compress@10': 0.6945, 'time@10': 8.2086}:  50%|█████     | 5/10 [00:36<00:27,  5.43s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.8482, 'ndcg@10': 0.9026, 'compress@10': 0.6945, 'time@10': 8.2086}:  60%|██████    | 6/10 [00:36<00:28,  7.08s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9033, 'compress@10': 0.6631, 'time@10': 8.6642}:  60%|██████    | 6/10 [00:41<00:28,  7.08s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8641, 'ndcg@10': 0.9033, 'compress@10': 0.6631, 'time@10': 8.6642}:  70%|███████   | 7/10 [00:41<00:19,  6.64s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9081, 'compress@10': 0.5982, 'time@10': 8.5301}:  70%|███████   | 7/10 [00:49<00:19,  6.64s/it] {'epoch': 20, 'num_users': 6.125, 'loss': 0.0206, 'hit_ratio@10': 0.8776, 'ndcg@10': 0.9081, 'compress@10': 0.5982, 'time@10': 8.5301}:  80%|████████  | 8/10 [00:49<00:13,  6.96s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9135, 'compress@10': 0.5786, 'time@10': 9.2339}:  80%|████████  | 8/10 [00:57<00:13,  6.96s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0205, 'hit_ratio@10': 0.8721, 'ndcg@10': 0.9135, 'compress@10': 0.5786, 'time@10': 9.2339}:  90%|█████████ | 9/10 [00:57<00:07,  7.12s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9192, 'compress@10': 0.5253, 'time@10': 9.2142}:  90%|█████████ | 9/10 [01:06<00:07,  7.12s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9192, 'compress@10': 0.5253, 'time@10': 9.2142}: 100%|██████████| 10/10 [01:06<00:00,  7.72s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9192, 'compress@10': 0.5253, 'time@10': 9.2142}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.018874839014507906
Avg hit ratio: 0.88262748023529
Avg ndcg: 0.9192317093666178
Avg compression ratio: 0.5253429886060155
Avg train time: 9.214248728752136
Std train time: 2.955752246382702
[0.8409090909090907, 0.4318181818181818, 0.06818181818181818, 0.9772727272727272, 0.9318181818181818, 0.7045454545454545, 0.4772727272727273, 0.11363636363636363, 0.43181818181818177, 0.02272727272727273]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0306, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.8493, 'time@10': 8.0882}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0306, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.8493, 'time@10': 8.0882}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9155, 'compress@10': 0.6497, 'time@10': 7.6659}:  10%|█         | 1/10 [00:11<00:36,  4.08s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0226, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9155, 'compress@10': 0.6497, 'time@10': 7.6659}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.896, 'compress@10': 0.5002, 'time@10': 7.0258}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]  {'epoch': 21, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.896, 'compress@10': 0.5002, 'time@10': 7.0258}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9107, 'compress@10': 0.6197, 'time@10': 6.8644}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9107, 'compress@10': 0.6197, 'time@10': 6.8644}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9018, 'compress@10': 0.6824, 'time@10': 8.1356}:  40%|████      | 4/10 [00:27<00:31,  5.30s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8624, 'ndcg@10': 0.9018, 'compress@10': 0.6824, 'time@10': 8.1356}:  50%|█████     | 5/10 [00:27<00:28,  5.78s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0191, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9092, 'compress@10': 0.6872, 'time@10': 8.4826}:  50%|█████     | 5/10 [00:37<00:28,  5.78s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0191, 'hit_ratio@10': 0.8816, 'ndcg@10': 0.9092, 'compress@10': 0.6872, 'time@10': 8.4826}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9121, 'compress@10': 0.6602, 'time@10': 8.9158}:  60%|██████    | 6/10 [00:43<00:29,  7.30s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8928, 'ndcg@10': 0.9121, 'compress@10': 0.6602, 'time@10': 8.9158}:  70%|███████   | 7/10 [00:43<00:20,  6.81s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0193, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9154, 'compress@10': 0.595, 'time@10': 8.7535}:  70%|███████   | 7/10 [00:51<00:20,  6.81s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.0193, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9154, 'compress@10': 0.595, 'time@10': 8.7535}:  80%|████████  | 8/10 [00:51<00:14,  7.08s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9219, 'compress@10': 0.5787, 'time@10': 9.4053}:  80%|████████  | 8/10 [00:58<00:14,  7.08s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9219, 'compress@10': 0.5787, 'time@10': 9.4053}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9207, 'compress@10': 0.5253, 'time@10': 9.3521}:  90%|█████████ | 9/10 [01:07<00:07,  7.16s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9207, 'compress@10': 0.5253, 'time@10': 9.3521}: 100%|██████████| 10/10 [01:07<00:00,  7.70s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0209, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9207, 'compress@10': 0.5253, 'time@10': 9.3521}: 100%|██████████| 10/10 [01:07<00:00,  6.73s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.02085295405289627
Avg hit ratio: 0.8998497024575123
Avg ndcg: 0.9207380893726362
Avg compression ratio: 0.5253210933712478
Avg train time: 9.352051496505737
Std train time: 2.815236930655586
[0.8478260869565215, 0.41304347826086957, 0.06521739130434782, 0.9782608695652173, 0.9347826086956521, 0.6739130434782608, 0.4565217391304348, 0.10869565217391304, 0.45652173913043476, 0.06521739130434782]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8871, 'compress@10': 0.8558, 'time@10': 8.3654}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0283, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8871, 'compress@10': 0.8558, 'time@10': 8.3654}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9183, 'compress@10': 0.6439, 'time@10': 7.7462}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9183, 'compress@10': 0.6439, 'time@10': 7.7462}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8979, 'compress@10': 0.4955, 'time@10': 7.0342}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8979, 'compress@10': 0.4955, 'time@10': 7.0342}:  30%|███       | 3/10 [00:14<00:31,  4.53s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9076, 'compress@10': 0.6164, 'time@10': 6.7815}:  30%|███       | 3/10 [00:20<00:31,  4.53s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0162, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9076, 'compress@10': 0.6164, 'time@10': 6.7815}:  40%|████      | 4/10 [00:20<00:30,  5.14s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9004, 'compress@10': 0.6803, 'time@10': 8.054}:  40%|████      | 4/10 [00:26<00:30,  5.14s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9004, 'compress@10': 0.6803, 'time@10': 8.054}:  50%|█████     | 5/10 [00:26<00:28,  5.67s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0217, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9105, 'compress@10': 0.6805, 'time@10': 8.4019}:  50%|█████     | 5/10 [00:37<00:28,  5.67s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0217, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9105, 'compress@10': 0.6805, 'time@10': 8.4019}:  60%|██████    | 6/10 [00:37<00:28,  7.20s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.911, 'compress@10': 0.6516, 'time@10': 8.8012}:  60%|██████    | 6/10 [00:42<00:28,  7.20s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0216, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.911, 'compress@10': 0.6516, 'time@10': 8.8012}:  70%|███████   | 7/10 [00:42<00:20,  6.69s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0212, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9128, 'compress@10': 0.5869, 'time@10': 8.6129}:  70%|███████   | 7/10 [00:50<00:20,  6.69s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0212, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.9128, 'compress@10': 0.5869, 'time@10': 8.6129}:  80%|████████  | 8/10 [00:50<00:13,  6.90s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9314, 'compress@10': 0.5741, 'time@10': 9.2747}:  80%|████████  | 8/10 [00:57<00:13,  6.90s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8895, 'ndcg@10': 0.9314, 'compress@10': 0.5741, 'time@10': 9.2747}:  90%|█████████ | 9/10 [00:57<00:07,  7.03s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9354, 'compress@10': 0.5254, 'time@10': 9.2519}:  90%|█████████ | 9/10 [01:06<00:07,  7.03s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9354, 'compress@10': 0.5254, 'time@10': 9.2519}: 100%|██████████| 10/10 [01:06<00:00,  7.66s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0214, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9354, 'compress@10': 0.5254, 'time@10': 9.2519}: 100%|██████████| 10/10 [01:06<00:00,  6.65s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.02143238250021049
Avg hit ratio: 0.8982782738860837
Avg ndcg: 0.9354172226080324
Avg compression ratio: 0.5253764066589224
Avg train time: 9.25189700126648
Std train time: 2.8435928079137973
[0.8541666666666664, 0.3958333333333333, 0.0625, 0.9374999999999999, 0.9374999999999999, 0.6874999999999999, 0.4791666666666667, 0.10416666666666666, 0.47916666666666663, 0.0625]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8909, 'compress@10': 0.8618, 'time@10': 8.0767}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8909, 'compress@10': 0.8618, 'time@10': 8.0767}:  10%|█         | 1/10 [00:04<00:36,  4.07s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9216, 'compress@10': 0.6386, 'time@10': 7.5494}:  10%|█         | 1/10 [00:11<00:36,  4.07s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9216, 'compress@10': 0.6386, 'time@10': 7.5494}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9001, 'compress@10': 0.4912, 'time@10': 6.9351}:  20%|██        | 2/10 [00:14<00:46,  5.83s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9001, 'compress@10': 0.4912, 'time@10': 6.9351}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9196, 'compress@10': 0.6033, 'time@10': 6.7587}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.0189, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9196, 'compress@10': 0.6033, 'time@10': 6.7587}:  40%|████      | 4/10 [00:20<00:31,  5.19s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9106, 'compress@10': 0.6704, 'time@10': 8.0675}:  40%|████      | 4/10 [00:26<00:31,  5.19s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0212, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9106, 'compress@10': 0.6704, 'time@10': 8.0675}:  50%|█████     | 5/10 [00:26<00:28,  5.73s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0204, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.917, 'compress@10': 0.6744, 'time@10': 8.4319}:  50%|█████     | 5/10 [00:37<00:28,  5.73s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0204, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.917, 'compress@10': 0.6744, 'time@10': 8.4319}:  60%|██████    | 6/10 [00:37<00:29,  7.28s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9205, 'compress@10': 0.6495, 'time@10': 8.84}:  60%|██████    | 6/10 [00:42<00:29,  7.28s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 0.0203, 'hit_ratio@10': 0.8925, 'ndcg@10': 0.9205, 'compress@10': 0.6495, 'time@10': 8.84}:  70%|███████   | 7/10 [00:42<00:20,  6.76s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0197, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9228, 'compress@10': 0.5845, 'time@10': 8.6841}:  70%|███████   | 7/10 [00:50<00:20,  6.76s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0197, 'hit_ratio@10': 0.9024, 'ndcg@10': 0.9228, 'compress@10': 0.5845, 'time@10': 8.6841}:  80%|████████  | 8/10 [00:50<00:14,  7.03s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.919, 'compress@10': 0.5745, 'time@10': 9.3319}:  80%|████████  | 8/10 [00:57<00:14,  7.03s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.919, 'compress@10': 0.5745, 'time@10': 9.3319}:  90%|█████████ | 9/10 [00:57<00:07,  7.12s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9234, 'compress@10': 0.5254, 'time@10': 9.3099}:  90%|█████████ | 9/10 [01:07<00:07,  7.12s/it]  {'epoch': 23, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9234, 'compress@10': 0.5254, 'time@10': 9.3099}: 100%|██████████| 10/10 [01:07<00:00,  7.74s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9234, 'compress@10': 0.5254, 'time@10': 9.3099}: 100%|██████████| 10/10 [01:07<00:00,  6.70s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.022215163629467967
Avg hit ratio: 0.8967703373781472
Avg ndcg: 0.9233624834438047
Avg compression ratio: 0.5254107164205256
Avg train time: 9.309867906570435
Std train time: 2.8293525605113707
[0.8599999999999998, 0.38, 0.06, 0.94, 0.94, 0.6599999999999999, 0.46, 0.09999999999999999, 0.49999999999999994, 0.1]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8925, 'compress@10': 0.8674, 'time@10': 7.9866}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0273, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8925, 'compress@10': 0.8674, 'time@10': 7.9866}:  10%|█         | 1/10 [00:04<00:36,  4.03s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9271, 'compress@10': 0.6337, 'time@10': 7.5151}:  10%|█         | 1/10 [00:11<00:36,  4.03s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9271, 'compress@10': 0.6337, 'time@10': 7.5151}:  20%|██        | 2/10 [00:11<00:46,  5.82s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9038, 'compress@10': 0.4872, 'time@10': 6.847}:  20%|██        | 2/10 [00:13<00:46,  5.82s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.7683, 'ndcg@10': 0.9038, 'compress@10': 0.4872, 'time@10': 6.847}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9127, 'compress@10': 0.6009, 'time@10': 6.7342}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8084, 'ndcg@10': 0.9127, 'compress@10': 0.6009, 'time@10': 6.7342}:  40%|████      | 4/10 [00:20<00:31,  5.23s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0184, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.9061, 'compress@10': 0.669, 'time@10': 7.9771}:  40%|████      | 4/10 [00:26<00:31,  5.23s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0184, 'hit_ratio@10': 0.8307, 'ndcg@10': 0.9061, 'compress@10': 0.669, 'time@10': 7.9771}:  50%|█████     | 5/10 [00:26<00:28,  5.69s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9151, 'compress@10': 0.6688, 'time@10': 8.3882}:  50%|█████     | 5/10 [00:37<00:28,  5.69s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0167, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.9151, 'compress@10': 0.6688, 'time@10': 8.3882}:  60%|██████    | 6/10 [00:37<00:29,  7.32s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0169, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9166, 'compress@10': 0.642, 'time@10': 8.7954}:  60%|██████    | 6/10 [00:42<00:29,  7.32s/it] {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0169, 'hit_ratio@10': 0.8702, 'ndcg@10': 0.9166, 'compress@10': 0.642, 'time@10': 8.7954}:  70%|███████   | 7/10 [00:42<00:20,  6.77s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9217, 'compress@10': 0.5775, 'time@10': 8.6444}:  70%|███████   | 7/10 [00:50<00:20,  6.77s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9217, 'compress@10': 0.5775, 'time@10': 8.6444}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9251, 'compress@10': 0.5705, 'time@10': 9.2979}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0154, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9251, 'compress@10': 0.5705, 'time@10': 9.2979}:  90%|█████████ | 9/10 [00:57<00:07,  7.12s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9282, 'compress@10': 0.5255, 'time@10': 9.28}:  90%|█████████ | 9/10 [01:07<00:07,  7.12s/it]      {'epoch': 24, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9282, 'compress@10': 0.5255, 'time@10': 9.28}: 100%|██████████| 10/10 [01:07<00:00,  7.76s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9282, 'compress@10': 0.5255, 'time@10': 9.28}: 100%|██████████| 10/10 [01:07<00:00,  6.71s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.016047213445489143
Avg hit ratio: 0.8811354167432265
Avg ndcg: 0.9281579630315727
Avg compression ratio: 0.5254578779467061
Avg train time: 9.28001844882965
Std train time: 2.7975413431045206
[0.8653846153846152, 0.36538461538461536, 0.05769230769230769, 0.9423076923076923, 0.9423076923076923, 0.6346153846153846, 0.4807692307692308, 0.09615384615384615, 0.4807692307692307, 0.13461538461538464]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9012, 'compress@10': 0.8725, 'time@10': 8.3204}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9012, 'compress@10': 0.8725, 'time@10': 8.3204}:  10%|█         | 1/10 [00:04<00:37,  4.20s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9277, 'compress@10': 0.6292, 'time@10': 7.7428}:  10%|█         | 1/10 [00:11<00:37,  4.20s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9277, 'compress@10': 0.6292, 'time@10': 7.7428}:  20%|██        | 2/10 [00:11<00:47,  5.96s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9042, 'compress@10': 0.4835, 'time@10': 7.0861}:  20%|██        | 2/10 [00:14<00:47,  5.96s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9042, 'compress@10': 0.4835, 'time@10': 7.0861}:  30%|███       | 3/10 [00:14<00:32,  4.58s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9162, 'compress@10': 0.5987, 'time@10': 6.8894}:  30%|███       | 3/10 [00:20<00:32,  4.58s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9162, 'compress@10': 0.5987, 'time@10': 6.8894}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0169, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9096, 'compress@10': 0.6677, 'time@10': 8.104}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0169, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9096, 'compress@10': 0.6677, 'time@10': 8.104}:  50%|█████     | 5/10 [00:27<00:28,  5.73s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9189, 'compress@10': 0.6635, 'time@10': 8.4563}:  50%|█████     | 5/10 [00:37<00:28,  5.73s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0183, 'hit_ratio@10': 0.885, 'ndcg@10': 0.9189, 'compress@10': 0.6635, 'time@10': 8.4563}:  60%|██████    | 6/10 [00:37<00:29,  7.28s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9228, 'compress@10': 0.6404, 'time@10': 8.8562}:  60%|██████    | 6/10 [00:43<00:29,  7.28s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9228, 'compress@10': 0.6404, 'time@10': 8.8562}:  70%|███████   | 7/10 [00:43<00:20,  6.75s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0166, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9276, 'compress@10': 0.5756, 'time@10': 8.6829}:  70%|███████   | 7/10 [00:50<00:20,  6.75s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0166, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9276, 'compress@10': 0.5756, 'time@10': 8.6829}:  80%|████████  | 8/10 [00:50<00:13,  6.99s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9314, 'compress@10': 0.5667, 'time@10': 9.3017}:  80%|████████  | 8/10 [00:57<00:13,  6.99s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0163, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9314, 'compress@10': 0.5667, 'time@10': 9.3017}:  90%|█████████ | 9/10 [00:57<00:07,  7.04s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9358, 'compress@10': 0.5255, 'time@10': 9.3517}:  90%|█████████ | 9/10 [01:07<00:07,  7.04s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9358, 'compress@10': 0.5255, 'time@10': 9.3517}: 100%|██████████| 10/10 [01:07<00:00,  7.91s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9358, 'compress@10': 0.5255, 'time@10': 9.3517}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.01550577817250684
Avg hit ratio: 0.9018497024575123
Avg ndcg: 0.9357799327693842
Avg compression ratio: 0.5254570568725248
Avg train time: 9.351660561561584
Std train time: 2.7044698230437954
[0.8703703703703702, 0.3518518518518518, 0.05555555555555555, 0.9444444444444444, 0.9444444444444444, 0.6481481481481481, 0.5, 0.09259259259259259, 0.4629629629629629, 0.12962962962962965]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0246, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9012, 'compress@10': 0.8772, 'time@10': 8.1002}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0246, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9012, 'compress@10': 0.8772, 'time@10': 8.1002}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9299, 'compress@10': 0.625, 'time@10': 7.5655}:  10%|█         | 1/10 [00:11<00:36,  4.08s/it] {'epoch': 26, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9299, 'compress@10': 0.625, 'time@10': 7.5655}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9056, 'compress@10': 0.4801, 'time@10': 6.9151}:  20%|██        | 2/10 [00:13<00:46,  5.84s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8635, 'ndcg@10': 0.9056, 'compress@10': 0.4801, 'time@10': 6.9151}:  30%|███       | 3/10 [00:13<00:31,  4.47s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9174, 'compress@10': 0.5967, 'time@10': 6.7697}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9174, 'compress@10': 0.5967, 'time@10': 6.7697}:  40%|████      | 4/10 [00:20<00:31,  5.22s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9119, 'compress@10': 0.6665, 'time@10': 8.0057}:  40%|████      | 4/10 [00:26<00:31,  5.22s/it] {'epoch': 26, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.8918, 'ndcg@10': 0.9119, 'compress@10': 0.6665, 'time@10': 8.0057}:  50%|█████     | 5/10 [00:26<00:28,  5.69s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9201, 'compress@10': 0.6647, 'time@10': 8.4028}:  50%|█████     | 5/10 [00:37<00:28,  5.69s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.015, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9201, 'compress@10': 0.6647, 'time@10': 8.4028}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9203, 'compress@10': 0.644, 'time@10': 8.8813}:  60%|██████    | 6/10 [00:43<00:29,  7.30s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0158, 'hit_ratio@10': 0.9107, 'ndcg@10': 0.9203, 'compress@10': 0.644, 'time@10': 8.8813}:  70%|███████   | 7/10 [00:43<00:20,  6.84s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9249, 'compress@10': 0.5784, 'time@10': 8.6884}:  70%|███████   | 7/10 [00:50<00:20,  6.84s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.9183, 'ndcg@10': 0.9249, 'compress@10': 0.5784, 'time@10': 8.6884}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9296, 'compress@10': 0.5672, 'time@10': 9.3648}:  80%|████████  | 8/10 [00:58<00:14,  7.01s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9296, 'compress@10': 0.5672, 'time@10': 9.3648}:  90%|█████████ | 9/10 [00:58<00:07,  7.14s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9323, 'compress@10': 0.5255, 'time@10': 9.3985}:  90%|█████████ | 9/10 [01:07<00:07,  7.14s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9323, 'compress@10': 0.5255, 'time@10': 9.3985}: 100%|██████████| 10/10 [01:07<00:00,  7.94s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0173, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9323, 'compress@10': 0.5255, 'time@10': 9.3985}: 100%|██████████| 10/10 [01:07<00:00,  6.78s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.01727332018564632
Avg hit ratio: 0.90662748023529
Avg ndcg: 0.932313151251041
Avg compression ratio: 0.5254592395381996
Avg train time: 9.398465871810913
Std train time: 2.8878595084930687
[0.8749999999999999, 0.33928571428571425, 0.05357142857142857, 0.9107142857142857, 0.9464285714285714, 0.625, 0.5178571428571429, 0.08928571428571427, 0.4821428571428571, 0.16071428571428573]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9039, 'compress@10': 0.8816, 'time@10': 8.1145}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.023, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9039, 'compress@10': 0.8816, 'time@10': 8.1145}:  10%|█         | 1/10 [00:04<00:36,  4.09s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9261, 'compress@10': 0.6211, 'time@10': 7.5509}:  10%|█         | 1/10 [00:11<00:36,  4.09s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9261, 'compress@10': 0.6211, 'time@10': 7.5509}:  20%|██        | 2/10 [00:11<00:46,  5.82s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9031, 'compress@10': 0.477, 'time@10': 6.9704}:  20%|██        | 2/10 [00:14<00:46,  5.82s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9031, 'compress@10': 0.477, 'time@10': 6.9704}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.918, 'compress@10': 0.5862, 'time@10': 6.872}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.918, 'compress@10': 0.5862, 'time@10': 6.872}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.914, 'compress@10': 0.6585, 'time@10': 8.1168}:  40%|████      | 4/10 [00:27<00:32,  5.34s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0163, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.914, 'compress@10': 0.6585, 'time@10': 8.1168}:  50%|█████     | 5/10 [00:27<00:28,  5.79s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9231, 'compress@10': 0.6543, 'time@10': 8.4851}:  50%|█████     | 5/10 [00:37<00:28,  5.79s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9231, 'compress@10': 0.6543, 'time@10': 8.4851}:  60%|██████    | 6/10 [00:37<00:29,  7.34s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9268, 'compress@10': 0.6375, 'time@10': 8.8971}:  60%|██████    | 6/10 [00:43<00:29,  7.34s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.9032, 'ndcg@10': 0.9268, 'compress@10': 0.6375, 'time@10': 8.8971}:  70%|███████   | 7/10 [00:43<00:20,  6.81s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.93, 'compress@10': 0.5723, 'time@10': 8.6911}:  70%|███████   | 7/10 [00:50<00:20,  6.81s/it]   {'epoch': 27, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9117, 'ndcg@10': 0.93, 'compress@10': 0.5723, 'time@10': 8.6911}:  80%|████████  | 8/10 [00:50<00:13,  6.96s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9355, 'compress@10': 0.5639, 'time@10': 9.3115}:  80%|████████  | 8/10 [00:57<00:13,  6.96s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9355, 'compress@10': 0.5639, 'time@10': 9.3115}:  90%|█████████ | 9/10 [00:57<00:07,  7.03s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9395, 'compress@10': 0.5255, 'time@10': 9.3337}:  90%|█████████ | 9/10 [01:07<00:07,  7.03s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9395, 'compress@10': 0.5255, 'time@10': 9.3337}: 100%|██████████| 10/10 [01:07<00:00,  7.81s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0148, 'hit_ratio@10': 0.9042, 'ndcg@10': 0.9395, 'compress@10': 0.5255, 'time@10': 9.3337}: 100%|██████████| 10/10 [01:07<00:00,  6.74s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.014823988075219438
Avg hit ratio: 0.9042183660519824
Avg ndcg: 0.9395196865730776
Avg compression ratio: 0.5254851768468605
Avg train time: 9.333689761161803
Std train time: 2.740365370596668
[0.8793103448275861, 0.3620689655172413, 0.05172413793103448, 0.9137931034482758, 0.9482758620689655, 0.603448275862069, 0.5, 0.08620689655172413, 0.49999999999999994, 0.15517241379310345]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9085, 'compress@10': 0.8857, 'time@10': 8.0422}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0225, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9085, 'compress@10': 0.8857, 'time@10': 8.0422}:  10%|█         | 1/10 [00:04<00:36,  4.06s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9448, 'compress@10': 0.6342, 'time@10': 7.5104}:  10%|█         | 1/10 [00:11<00:36,  4.06s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0203, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9448, 'compress@10': 0.6342, 'time@10': 7.5104}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9156, 'compress@10': 0.4852, 'time@10': 6.9214}:  20%|██        | 2/10 [00:13<00:46,  5.80s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8743, 'ndcg@10': 0.9156, 'compress@10': 0.4852, 'time@10': 6.9214}:  30%|███       | 3/10 [00:13<00:31,  4.48s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9256, 'compress@10': 0.5931, 'time@10': 6.8465}:  30%|███       | 3/10 [00:20<00:31,  4.48s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0136, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9256, 'compress@10': 0.5931, 'time@10': 6.8465}:  40%|████      | 4/10 [00:20<00:32,  5.34s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9209, 'compress@10': 0.6643, 'time@10': 8.1047}:  40%|████      | 4/10 [00:27<00:32,  5.34s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0151, 'hit_ratio@10': 0.8983, 'ndcg@10': 0.9209, 'compress@10': 0.6643, 'time@10': 8.1047}:  50%|█████     | 5/10 [00:27<00:28,  5.80s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0174, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9328, 'compress@10': 0.6557, 'time@10': 8.4791}:  50%|█████     | 5/10 [00:37<00:28,  5.80s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0174, 'hit_ratio@10': 0.9115, 'ndcg@10': 0.9328, 'compress@10': 0.6557, 'time@10': 8.4791}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9322, 'compress@10': 0.6363, 'time@10': 8.8589}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9322, 'compress@10': 0.6363, 'time@10': 8.8589}:  70%|███████   | 7/10 [00:43<00:20,  6.78s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.9251, 'ndcg@10': 0.9359, 'compress@10': 0.5708, 'time@10': 8.6391}:  70%|███████   | 7/10 [00:50<00:20,  6.78s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.9251, 'ndcg@10': 0.9359, 'compress@10': 0.5708, 'time@10': 8.6391}:  80%|████████  | 8/10 [00:50<00:13,  6.90s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9407, 'compress@10': 0.5645, 'time@10': 9.2722}:  80%|████████  | 8/10 [00:57<00:13,  6.90s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0191, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9407, 'compress@10': 0.5645, 'time@10': 9.2722}:  90%|█████████ | 9/10 [00:57<00:06,  6.99s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.945, 'compress@10': 0.5255, 'time@10': 9.3278}:  90%|█████████ | 9/10 [01:07<00:06,  6.99s/it]    {'epoch': 28, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.945, 'compress@10': 0.5255, 'time@10': 9.3278}: 100%|██████████| 10/10 [01:07<00:00,  7.88s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.9121, 'ndcg@10': 0.945, 'compress@10': 0.5255, 'time@10': 9.3278}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.019504291440683677
Avg hit ratio: 0.912075508909125
Avg ndcg: 0.944954869270456
Avg compression ratio: 0.5254901798017089
Avg train time: 9.327787518501282
Std train time: 2.7656255074541445
[0.8833333333333332, 0.3499999999999999, 0.05, 0.8833333333333333, 0.95, 0.6166666666666667, 0.48333333333333334, 0.08333333333333333, 0.5166666666666666, 0.18333333333333335]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9145, 'compress@10': 0.8895, 'time@10': 8.1051}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9145, 'compress@10': 0.8895, 'time@10': 8.1051}:  10%|█         | 1/10 [00:04<00:36,  4.09s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9394, 'compress@10': 0.6302, 'time@10': 7.6188}:  10%|█         | 1/10 [00:11<00:36,  4.09s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9394, 'compress@10': 0.6302, 'time@10': 7.6188}:  20%|██        | 2/10 [00:11<00:47,  5.91s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.912, 'compress@10': 0.4821, 'time@10': 6.9337}:  20%|██        | 2/10 [00:14<00:47,  5.91s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.912, 'compress@10': 0.4821, 'time@10': 6.9337}:  30%|███       | 3/10 [00:14<00:31,  4.50s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9254, 'compress@10': 0.5834, 'time@10': 6.8252}:  30%|███       | 3/10 [00:20<00:31,  4.50s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8092, 'ndcg@10': 0.9254, 'compress@10': 0.5834, 'time@10': 6.8252}:  40%|████      | 4/10 [00:20<00:31,  5.30s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9212, 'compress@10': 0.6569, 'time@10': 8.0346}:  40%|████      | 4/10 [00:27<00:31,  5.30s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8394, 'ndcg@10': 0.9212, 'compress@10': 0.6569, 'time@10': 8.0346}:  50%|█████     | 5/10 [00:27<00:28,  5.72s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.9294, 'compress@10': 0.6516, 'time@10': 8.4012}:  50%|█████     | 5/10 [00:37<00:28,  5.72s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8587, 'ndcg@10': 0.9294, 'compress@10': 0.6516, 'time@10': 8.4012}:  60%|██████    | 6/10 [00:37<00:29,  7.27s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9322, 'compress@10': 0.6305, 'time@10': 8.7954}:  60%|██████    | 6/10 [00:42<00:29,  7.27s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9322, 'compress@10': 0.6305, 'time@10': 8.7954}:  70%|███████   | 7/10 [00:42<00:20,  6.73s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9314, 'compress@10': 0.5654, 'time@10': 8.5907}:  70%|███████   | 7/10 [00:50<00:20,  6.73s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9314, 'compress@10': 0.5654, 'time@10': 8.5907}:  80%|████████  | 8/10 [00:50<00:13,  6.88s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9313, 'compress@10': 0.5615, 'time@10': 9.282}:  80%|████████  | 8/10 [00:57<00:13,  6.88s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8696, 'ndcg@10': 0.9313, 'compress@10': 0.5615, 'time@10': 9.282}:  90%|█████████ | 9/10 [00:57<00:07,  7.05s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9358, 'compress@10': 0.5256, 'time@10': 9.342}:  90%|█████████ | 9/10 [01:07<00:07,  7.05s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9358, 'compress@10': 0.5256, 'time@10': 9.342}: 100%|██████████| 10/10 [01:07<00:00,  7.94s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9358, 'compress@10': 0.5256, 'time@10': 9.342}: 100%|██████████| 10/10 [01:07<00:00,  6.75s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.013013610043202284
Avg hit ratio: 0.8804016737836772
Avg ndcg: 0.9357732704400418
Avg compression ratio: 0.5255711314189868
Avg train time: 9.341991782188416
Std train time: 2.8342441861605456
[0.8870967741935483, 0.33870967741935476, 0.048387096774193554, 0.8870967741935484, 0.9516129032258064, 0.5967741935483871, 0.467741935483871, 0.11290322580645161, 0.532258064516129, 0.1774193548387097]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9145, 'compress@10': 0.893, 'time@10': 7.9716}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9145, 'compress@10': 0.893, 'time@10': 7.9716}:  10%|█         | 1/10 [00:04<00:36,  4.02s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9399, 'compress@10': 0.6265, 'time@10': 7.5016}:  10%|█         | 1/10 [00:11<00:36,  4.02s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0141, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9399, 'compress@10': 0.6265, 'time@10': 7.5016}:  20%|██        | 2/10 [00:11<00:46,  5.81s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9123, 'compress@10': 0.4791, 'time@10': 6.8878}:  20%|██        | 2/10 [00:13<00:46,  5.81s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9123, 'compress@10': 0.4791, 'time@10': 6.8878}:  30%|███       | 3/10 [00:13<00:31,  4.47s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9243, 'compress@10': 0.5821, 'time@10': 6.8185}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9243, 'compress@10': 0.5821, 'time@10': 6.8185}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9213, 'compress@10': 0.6562, 'time@10': 8.0432}:  40%|████      | 4/10 [00:27<00:31,  5.33s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9213, 'compress@10': 0.6562, 'time@10': 8.0432}:  50%|█████     | 5/10 [00:27<00:28,  5.75s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.882, 'ndcg@10': 0.929, 'compress@10': 0.6478, 'time@10': 8.41}:  50%|█████     | 5/10 [00:37<00:28,  5.75s/it] {'epoch': 30, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.882, 'ndcg@10': 0.929, 'compress@10': 0.6478, 'time@10': 8.41}:  60%|██████    | 6/10 [00:37<00:29,  7.29s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9322, 'compress@10': 0.6251, 'time@10': 8.8344}:  60%|██████    | 6/10 [00:43<00:29,  7.29s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.011, 'hit_ratio@10': 0.8931, 'ndcg@10': 0.9322, 'compress@10': 0.6251, 'time@10': 8.8344}:  70%|███████   | 7/10 [00:43<00:20,  6.78s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9364, 'compress@10': 0.5643, 'time@10': 8.6825}:  70%|███████   | 7/10 [00:50<00:20,  6.78s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.9029, 'ndcg@10': 0.9364, 'compress@10': 0.5643, 'time@10': 8.6825}:  80%|████████  | 8/10 [00:50<00:14,  7.06s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9404, 'compress@10': 0.5622, 'time@10': 9.2996}:  80%|████████  | 8/10 [00:57<00:14,  7.06s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9404, 'compress@10': 0.5622, 'time@10': 9.2996}:  90%|█████████ | 9/10 [00:57<00:07,  7.09s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9458, 'compress@10': 0.5256, 'time@10': 9.364}:  90%|█████████ | 9/10 [01:07<00:07,  7.09s/it]    {'epoch': 30, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9458, 'compress@10': 0.5256, 'time@10': 9.364}: 100%|██████████| 10/10 [01:07<00:00,  7.98s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8943, 'ndcg@10': 0.9458, 'compress@10': 0.5256, 'time@10': 9.364}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.012600935353901607
Avg hit ratio: 0.8943417659495758
Avg ndcg: 0.94576736402884
Avg compression ratio: 0.5255848260820801
Avg train time: 9.364048981666565
Std train time: 2.7100338952623493
[0.8906249999999999, 0.32812499999999994, 0.04687500000000001, 0.890625, 0.9531249999999999, 0.578125, 0.453125, 0.109375, 0.546875, 0.203125]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9162, 'compress@10': 0.8964, 'time@10': 8.0172}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9162, 'compress@10': 0.8964, 'time@10': 8.0172}:  10%|█         | 1/10 [00:04<00:36,  4.04s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9492, 'compress@10': 0.6231, 'time@10': 7.6224}:  10%|█         | 1/10 [00:11<00:36,  4.04s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9492, 'compress@10': 0.6231, 'time@10': 7.6224}:  20%|██        | 2/10 [00:11<00:47,  5.94s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.7314, 'ndcg@10': 0.9185, 'compress@10': 0.4764, 'time@10': 7.0124}:  20%|██        | 2/10 [00:14<00:47,  5.94s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.7314, 'ndcg@10': 0.9185, 'compress@10': 0.4764, 'time@10': 7.0124}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.7807, 'ndcg@10': 0.9321, 'compress@10': 0.5809, 'time@10': 6.9058}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.7807, 'ndcg@10': 0.9321, 'compress@10': 0.5809, 'time@10': 6.9058}:  40%|████      | 4/10 [00:20<00:32,  5.38s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.9281, 'compress@10': 0.6556, 'time@10': 8.1508}:  40%|████      | 4/10 [00:27<00:32,  5.38s/it] {'epoch': 31, 'num_users': 5.8, 'loss': 0.014, 'hit_ratio@10': 0.8166, 'ndcg@10': 0.9281, 'compress@10': 0.6556, 'time@10': 8.1508}:  50%|█████     | 5/10 [00:27<00:29,  5.82s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.9349, 'compress@10': 0.6442, 'time@10': 8.5465}:  50%|█████     | 5/10 [00:38<00:29,  5.82s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8397, 'ndcg@10': 0.9349, 'compress@10': 0.6442, 'time@10': 8.5465}:  60%|██████    | 6/10 [00:38<00:29,  7.43s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.931, 'compress@10': 0.62, 'time@10': 9.0064}:  60%|██████    | 6/10 [00:43<00:29,  7.43s/it]   {'epoch': 31, 'num_users': 6.2857, 'loss': 0.0145, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.931, 'compress@10': 0.62, 'time@10': 9.0064}:  70%|███████   | 7/10 [00:43<00:20,  6.94s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9349, 'compress@10': 0.5594, 'time@10': 8.8416}:  70%|███████   | 7/10 [00:51<00:20,  6.94s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.8712, 'ndcg@10': 0.9349, 'compress@10': 0.5594, 'time@10': 8.8416}:  80%|████████  | 8/10 [00:51<00:14,  7.19s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.933, 'compress@10': 0.5594, 'time@10': 9.4385}:  80%|████████  | 8/10 [00:58<00:14,  7.19s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.933, 'compress@10': 0.5594, 'time@10': 9.4385}:  90%|█████████ | 9/10 [00:58<00:07,  7.17s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.937, 'compress@10': 0.5256, 'time@10': 9.4862}:  90%|█████████ | 9/10 [01:08<00:07,  7.17s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.937, 'compress@10': 0.5256, 'time@10': 9.4862}: 100%|██████████| 10/10 [01:08<00:00,  8.03s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.015, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.937, 'compress@10': 0.5256, 'time@10': 9.4862}: 100%|██████████| 10/10 [01:08<00:00,  6.88s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.014983534560999068
Avg hit ratio: 0.8747104295440458
Avg ndcg: 0.937040499189204
Avg compression ratio: 0.525615968654052
Avg train time: 9.48621861934662
Std train time: 2.7320874652227807
[0.8939393939393938, 0.3181818181818181, 0.04545454545454546, 0.8939393939393939, 0.9545454545454545, 0.5606060606060606, 0.4696969696969697, 0.10606060606060606, 0.5606060606060606, 0.19696969696969696]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9162, 'compress@10': 0.8995, 'time@10': 8.1399}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9162, 'compress@10': 0.8995, 'time@10': 8.1399}:  10%|█         | 1/10 [00:04<00:36,  4.11s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9407, 'compress@10': 0.6198, 'time@10': 7.6062}:  10%|█         | 1/10 [00:11<00:36,  4.11s/it] {'epoch': 32, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9407, 'compress@10': 0.6198, 'time@10': 7.6062}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9129, 'compress@10': 0.4738, 'time@10': 6.9752}:  20%|██        | 2/10 [00:14<00:46,  5.87s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9129, 'compress@10': 0.4738, 'time@10': 6.9752}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9252, 'compress@10': 0.5798, 'time@10': 6.8652}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9252, 'compress@10': 0.5798, 'time@10': 6.8652}:  40%|████      | 4/10 [00:20<00:31,  5.33s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9241, 'compress@10': 0.6549, 'time@10': 8.0694}:  40%|████      | 4/10 [00:27<00:31,  5.33s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9241, 'compress@10': 0.6549, 'time@10': 8.0694}:  50%|█████     | 5/10 [00:27<00:28,  5.75s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0121, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9317, 'compress@10': 0.6408, 'time@10': 8.4582}:  50%|█████     | 5/10 [00:37<00:28,  5.75s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0121, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9317, 'compress@10': 0.6408, 'time@10': 8.4582}:  60%|██████    | 6/10 [00:37<00:29,  7.35s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9345, 'compress@10': 0.6194, 'time@10': 8.8648}:  60%|██████    | 6/10 [00:43<00:29,  7.35s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0114, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9345, 'compress@10': 0.6194, 'time@10': 8.8648}:  70%|███████   | 7/10 [00:43<00:20,  6.81s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9364, 'compress@10': 0.5584, 'time@10': 8.6969}:  70%|███████   | 7/10 [00:50<00:20,  6.81s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9364, 'compress@10': 0.5584, 'time@10': 8.6969}:  80%|████████  | 8/10 [00:50<00:14,  7.05s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9397, 'compress@10': 0.5601, 'time@10': 9.3457}:  80%|████████  | 8/10 [00:58<00:14,  7.05s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9397, 'compress@10': 0.5601, 'time@10': 9.3457}:  90%|█████████ | 9/10 [00:58<00:07,  7.13s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9421, 'compress@10': 0.5256, 'time@10': 9.405}:  90%|█████████ | 9/10 [01:08<00:07,  7.13s/it]    {'epoch': 32, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9421, 'compress@10': 0.5256, 'time@10': 9.405}: 100%|██████████| 10/10 [01:08<00:00,  8.01s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9421, 'compress@10': 0.5256, 'time@10': 9.405}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.012114610235996207
Avg hit ratio: 0.9075414317808205
Avg ndcg: 0.9420974737923823
Avg compression ratio: 0.5255932566577954
Avg train time: 9.404957389831543
Std train time: 2.7528342566230504
[0.8970588235294117, 0.30882352941176466, 0.04411764705882354, 0.8676470588235294, 0.9558823529411764, 0.5735294117647058, 0.4558823529411765, 0.1323529411764706, 0.5441176470588235, 0.22058823529411764]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9162, 'compress@10': 0.9025, 'time@10': 8.0409}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0172, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9162, 'compress@10': 0.9025, 'time@10': 8.0409}:  10%|█         | 1/10 [00:04<00:36,  4.06s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9413, 'compress@10': 0.6168, 'time@10': 7.5087}:  10%|█         | 1/10 [00:11<00:36,  4.06s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9413, 'compress@10': 0.6168, 'time@10': 7.5087}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9133, 'compress@10': 0.4714, 'time@10': 6.9057}:  20%|██        | 2/10 [00:13<00:46,  5.80s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0081, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.9133, 'compress@10': 0.4714, 'time@10': 6.9057}:  30%|███       | 3/10 [00:13<00:31,  4.47s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9287, 'compress@10': 0.5717, 'time@10': 6.8197}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9287, 'compress@10': 0.5717, 'time@10': 6.8197}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9276, 'compress@10': 0.6487, 'time@10': 8.0642}:  40%|████      | 4/10 [00:27<00:31,  5.31s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9276, 'compress@10': 0.6487, 'time@10': 8.0642}:  50%|█████     | 5/10 [00:27<00:28,  5.76s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9333, 'compress@10': 0.6377, 'time@10': 8.4309}:  50%|█████     | 5/10 [00:37<00:28,  5.76s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9333, 'compress@10': 0.6377, 'time@10': 8.4309}:  60%|██████    | 6/10 [00:37<00:29,  7.30s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9358, 'compress@10': 0.6149, 'time@10': 8.8964}:  60%|██████    | 6/10 [00:43<00:29,  7.30s/it] {'epoch': 33, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9358, 'compress@10': 0.6149, 'time@10': 8.8964}:  70%|███████   | 7/10 [00:43<00:20,  6.85s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9396, 'compress@10': 0.5576, 'time@10': 8.7328}:  70%|███████   | 7/10 [00:50<00:20,  6.85s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9396, 'compress@10': 0.5576, 'time@10': 8.7328}:  80%|████████  | 8/10 [00:50<00:14,  7.10s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9431, 'compress@10': 0.5576, 'time@10': 9.4059}:  80%|████████  | 8/10 [00:58<00:14,  7.10s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0125, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9431, 'compress@10': 0.5576, 'time@10': 9.4059}:  90%|█████████ | 9/10 [00:58<00:07,  7.20s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9472, 'compress@10': 0.5257, 'time@10': 9.4583}:  90%|█████████ | 9/10 [01:08<00:07,  7.20s/it]  {'epoch': 33, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9472, 'compress@10': 0.5257, 'time@10': 9.4583}: 100%|██████████| 10/10 [01:08<00:00,  8.06s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9472, 'compress@10': 0.5257, 'time@10': 9.4583}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.013922634735109064
Avg hit ratio: 0.8978338294416393
Avg ndcg: 0.9471920622001566
Avg compression ratio: 0.5256618687470256
Avg train time: 9.45834403038025
Std train time: 2.8516076621144286
[0.8999999999999999, 0.29999999999999993, 0.042857142857142864, 0.8714285714285714, 0.9285714285714285, 0.5857142857142856, 0.4428571428571429, 0.1285714285714286, 0.557142857142857, 0.24285714285714285]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9205, 'compress@10': 0.9052, 'time@10': 8.1944}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9205, 'compress@10': 0.9052, 'time@10': 8.1944}:  10%|█         | 1/10 [00:04<00:37,  4.13s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9429, 'compress@10': 0.6139, 'time@10': 7.6076}:  10%|█         | 1/10 [00:11<00:37,  4.13s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9429, 'compress@10': 0.6139, 'time@10': 7.6076}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9143, 'compress@10': 0.4691, 'time@10': 6.8809}:  20%|██        | 2/10 [00:13<00:46,  5.86s/it] {'epoch': 34, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9143, 'compress@10': 0.4691, 'time@10': 6.8809}:  30%|███       | 3/10 [00:13<00:31,  4.44s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9263, 'compress@10': 0.5709, 'time@10': 6.8157}:  30%|███       | 3/10 [00:20<00:31,  4.44s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9263, 'compress@10': 0.5709, 'time@10': 6.8157}:  40%|████      | 4/10 [00:20<00:31,  5.32s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9269, 'compress@10': 0.6427, 'time@10': 8.0641}:  40%|████      | 4/10 [00:27<00:31,  5.32s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9269, 'compress@10': 0.6427, 'time@10': 8.0641}:  50%|█████     | 5/10 [00:27<00:28,  5.77s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0071, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9345, 'compress@10': 0.6347, 'time@10': 8.4494}:  50%|█████     | 5/10 [00:37<00:28,  5.77s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0071, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9345, 'compress@10': 0.6347, 'time@10': 8.4494}:  60%|██████    | 6/10 [00:37<00:29,  7.35s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0084, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9362, 'compress@10': 0.6105, 'time@10': 8.8114}:  60%|██████    | 6/10 [00:43<00:29,  7.35s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0084, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9362, 'compress@10': 0.6105, 'time@10': 8.8114}:  70%|███████   | 7/10 [00:43<00:20,  6.75s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9398, 'compress@10': 0.5534, 'time@10': 8.6623}:  70%|███████   | 7/10 [00:50<00:20,  6.75s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0086, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9398, 'compress@10': 0.5534, 'time@10': 8.6623}:  80%|████████  | 8/10 [00:50<00:14,  7.04s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9452, 'compress@10': 0.5552, 'time@10': 9.2841}:  80%|████████  | 8/10 [00:57<00:14,  7.04s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9452, 'compress@10': 0.5552, 'time@10': 9.2841}:  90%|█████████ | 9/10 [00:57<00:07,  7.08s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9482, 'compress@10': 0.5257, 'time@10': 9.3486}:  90%|█████████ | 9/10 [01:07<00:07,  7.08s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9482, 'compress@10': 0.5257, 'time@10': 9.3486}: 100%|██████████| 10/10 [01:07<00:00,  7.97s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0099, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9482, 'compress@10': 0.5257, 'time@10': 9.3486}: 100%|██████████| 10/10 [01:07<00:00,  6.79s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.009939825319298861
Avg hit ratio: 0.9021958096610048
Avg ndcg: 0.9482368503156519
Avg compression ratio: 0.5256815398861574
Avg train time: 9.348610067367554
Std train time: 2.729362982625918
[0.9027777777777777, 0.29166666666666663, 0.04166666666666667, 0.8472222222222222, 0.9305555555555555, 0.5694444444444444, 0.45833333333333337, 0.1527777777777778, 0.5694444444444443, 0.2361111111111111]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.9079, 'time@10': 7.9485}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.9079, 'time@10': 7.9485}:  10%|█         | 1/10 [00:04<00:36,  4.01s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9463, 'compress@10': 0.6112, 'time@10': 7.52}:  10%|█         | 1/10 [00:11<00:36,  4.01s/it]   {'epoch': 35, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9463, 'compress@10': 0.6112, 'time@10': 7.52}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9166, 'compress@10': 0.467, 'time@10': 6.9417}:  20%|██        | 2/10 [00:14<00:46,  5.85s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9166, 'compress@10': 0.467, 'time@10': 6.9417}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.929, 'compress@10': 0.5634, 'time@10': 6.8816}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.929, 'compress@10': 0.5634, 'time@10': 6.8816}:  40%|████      | 4/10 [00:20<00:32,  5.39s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9306, 'compress@10': 0.6371, 'time@10': 8.2613}:  40%|████      | 4/10 [00:27<00:32,  5.39s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9306, 'compress@10': 0.6371, 'time@10': 8.2613}:  50%|█████     | 5/10 [00:27<00:29,  5.95s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9367, 'compress@10': 0.6274, 'time@10': 8.6334}:  50%|█████     | 5/10 [00:38<00:29,  5.95s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9367, 'compress@10': 0.6274, 'time@10': 8.6334}:  60%|██████    | 6/10 [00:38<00:30,  7.50s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9388, 'compress@10': 0.6064, 'time@10': 9.046}:  60%|██████    | 6/10 [00:44<00:30,  7.50s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.9006, 'ndcg@10': 0.9388, 'compress@10': 0.6064, 'time@10': 9.046}:  70%|███████   | 7/10 [00:44<00:20,  6.95s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9422, 'compress@10': 0.5527, 'time@10': 8.8831}:  70%|███████   | 7/10 [00:51<00:20,  6.95s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.9422, 'compress@10': 0.5527, 'time@10': 8.8831}:  80%|████████  | 8/10 [00:51<00:14,  7.21s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9409, 'compress@10': 0.5559, 'time@10': 9.561}:  80%|████████  | 8/10 [00:59<00:14,  7.21s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9409, 'compress@10': 0.5559, 'time@10': 9.561}:  90%|█████████ | 9/10 [00:59<00:07,  7.31s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9419, 'compress@10': 0.5257, 'time@10': 9.5954}:  90%|█████████ | 9/10 [01:09<00:07,  7.31s/it] {'epoch': 35, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9419, 'compress@10': 0.5257, 'time@10': 9.5954}: 100%|██████████| 10/10 [01:09<00:00,  8.12s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0133, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9419, 'compress@10': 0.5257, 'time@10': 9.5954}: 100%|██████████| 10/10 [01:09<00:00,  6.93s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.013309581211649268
Avg hit ratio: 0.8996049238443126
Avg ndcg: 0.9418817769988586
Avg compression ratio: 0.525677075324259
Avg train time: 9.59540159702301
Std train time: 2.9405240535087946
[0.9054054054054053, 0.28378378378378377, 0.04054054054054054, 0.8513513513513513, 0.9324324324324323, 0.5540540540540541, 0.445945945945946, 0.14864864864864866, 0.5810810810810809, 0.25675675675675674]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.9104, 'time@10': 7.9946}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 0.9104, 'time@10': 7.9946}:  10%|█         | 1/10 [00:04<00:36,  4.03s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.893, 'ndcg@10': 0.955, 'compress@10': 0.6086, 'time@10': 7.5389}:  10%|█         | 1/10 [00:11<00:36,  4.03s/it]  {'epoch': 36, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.893, 'ndcg@10': 0.955, 'compress@10': 0.6086, 'time@10': 7.5389}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9224, 'compress@10': 0.465, 'time@10': 6.916}:  20%|██        | 2/10 [00:14<00:46,  5.85s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9224, 'compress@10': 0.465, 'time@10': 6.916}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9366, 'compress@10': 0.5629, 'time@10': 6.8655}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9366, 'compress@10': 0.5629, 'time@10': 6.8655}:  40%|████      | 4/10 [00:20<00:32,  5.38s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9375, 'compress@10': 0.6371, 'time@10': 8.2307}:  40%|████      | 4/10 [00:27<00:32,  5.38s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0116, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9375, 'compress@10': 0.6371, 'time@10': 8.2307}:  50%|█████     | 5/10 [00:27<00:29,  5.92s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9436, 'compress@10': 0.6249, 'time@10': 8.5974}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0107, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9436, 'compress@10': 0.6249, 'time@10': 8.5974}:  60%|██████    | 6/10 [00:38<00:29,  7.47s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0098, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9447, 'compress@10': 0.6025, 'time@10': 8.9566}:  60%|██████    | 6/10 [00:43<00:29,  7.47s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0098, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9447, 'compress@10': 0.6025, 'time@10': 8.9566}:  70%|███████   | 7/10 [00:43<00:20,  6.85s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9471, 'compress@10': 0.5488, 'time@10': 8.8127}:  70%|███████   | 7/10 [00:51<00:20,  6.85s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9471, 'compress@10': 0.5488, 'time@10': 8.8127}:  80%|████████  | 8/10 [00:51<00:14,  7.17s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0102, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9493, 'compress@10': 0.5537, 'time@10': 9.4343}:  80%|████████  | 8/10 [00:58<00:14,  7.17s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0102, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9493, 'compress@10': 0.5537, 'time@10': 9.4343}:  90%|█████████ | 9/10 [00:58<00:07,  7.19s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9519, 'compress@10': 0.5257, 'time@10': 9.4631}:  90%|█████████ | 9/10 [01:08<00:07,  7.19s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9519, 'compress@10': 0.5257, 'time@10': 9.4631}: 100%|██████████| 10/10 [01:08<00:00,  7.98s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9519, 'compress@10': 0.5257, 'time@10': 9.4631}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.01019481732292817
Avg hit ratio: 0.9075414317808205
Avg ndcg: 0.9519068505136093
Avg compression ratio: 0.525703289947928
Avg train time: 9.463063502311707
Std train time: 2.802766084120132
[0.9078947368421051, 0.3026315789473684, 0.03947368421052632, 0.8552631578947368, 0.9342105263157894, 0.5394736842105263, 0.43421052631578955, 0.17105263157894737, 0.5657894736842104, 0.25]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.9127, 'time@10': 8.2532}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.9127, 'time@10': 8.2532}:  10%|█         | 1/10 [00:04<00:37,  4.19s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9464, 'compress@10': 0.6189, 'time@10': 7.671}:  10%|█         | 1/10 [00:11<00:37,  4.19s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9464, 'compress@10': 0.6189, 'time@10': 7.671}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9166, 'compress@10': 0.4715, 'time@10': 7.0355}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8811, 'ndcg@10': 0.9166, 'compress@10': 0.4715, 'time@10': 7.0355}:  30%|███       | 3/10 [00:14<00:32,  4.57s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.928, 'compress@10': 0.5687, 'time@10': 6.9849}:  30%|███       | 3/10 [00:21<00:32,  4.57s/it]  {'epoch': 37, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.928, 'compress@10': 0.5687, 'time@10': 6.9849}:  40%|████      | 4/10 [00:21<00:32,  5.48s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0075, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9301, 'compress@10': 0.6421, 'time@10': 8.2336}:  40%|████      | 4/10 [00:27<00:32,  5.48s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0075, 'hit_ratio@10': 0.9064, 'ndcg@10': 0.9301, 'compress@10': 0.6421, 'time@10': 8.2336}:  50%|█████     | 5/10 [00:27<00:29,  5.90s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.9375, 'compress@10': 0.6267, 'time@10': 8.5951}:  50%|█████     | 5/10 [00:38<00:29,  5.90s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0076, 'hit_ratio@10': 0.9146, 'ndcg@10': 0.9375, 'compress@10': 0.6267, 'time@10': 8.5951}:  60%|██████    | 6/10 [00:38<00:29,  7.45s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.921, 'ndcg@10': 0.9429, 'compress@10': 0.6024, 'time@10': 8.9708}:  60%|██████    | 6/10 [00:43<00:29,  7.45s/it] {'epoch': 37, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.921, 'ndcg@10': 0.9429, 'compress@10': 0.6024, 'time@10': 8.9708}:  70%|███████   | 7/10 [00:43<00:20,  6.86s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9273, 'ndcg@10': 0.9456, 'compress@10': 0.5515, 'time@10': 8.8451}:  70%|███████   | 7/10 [00:51<00:20,  6.86s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0102, 'hit_ratio@10': 0.9273, 'ndcg@10': 0.9456, 'compress@10': 0.5515, 'time@10': 8.8451}:  80%|████████  | 8/10 [00:51<00:14,  7.22s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9505, 'compress@10': 0.5544, 'time@10': 9.4441}:  80%|████████  | 8/10 [00:59<00:14,  7.22s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0115, 'hit_ratio@10': 0.9037, 'ndcg@10': 0.9505, 'compress@10': 0.5544, 'time@10': 9.4441}:  90%|█████████ | 9/10 [00:59<00:07,  7.20s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9528, 'compress@10': 0.5257, 'time@10': 9.4772}:  90%|█████████ | 9/10 [01:08<00:07,  7.20s/it]    {'epoch': 37, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9528, 'compress@10': 0.5257, 'time@10': 9.4772}: 100%|██████████| 10/10 [01:08<00:00,  8.01s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0116, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9528, 'compress@10': 0.5257, 'time@10': 9.4772}: 100%|██████████| 10/10 [01:08<00:00,  6.89s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.01159600677193456
Avg hit ratio: 0.911033495272884
Avg ndcg: 0.9527645832547498
Avg compression ratio: 0.5257013362846421
Avg train time: 9.477239179611207
Std train time: 2.664280778516045
[0.9102564102564101, 0.2948717948717949, 0.038461538461538464, 0.8333333333333334, 0.9358974358974358, 0.5256410256410257, 0.4487179487179488, 0.16666666666666669, 0.5769230769230768, 0.2692307692307692]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.915, 'time@10': 7.9902}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.915, 'time@10': 7.9902}:  10%|█         | 1/10 [00:04<00:36,  4.03s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9459, 'compress@10': 0.6163, 'time@10': 7.4891}:  10%|█         | 1/10 [00:11<00:36,  4.03s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9459, 'compress@10': 0.6163, 'time@10': 7.4891}:  20%|██        | 2/10 [00:11<00:46,  5.79s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9163, 'compress@10': 0.4695, 'time@10': 6.8441}:  20%|██        | 2/10 [00:13<00:46,  5.79s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9163, 'compress@10': 0.4695, 'time@10': 6.8441}:  30%|███       | 3/10 [00:13<00:31,  4.43s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9366, 'compress@10': 0.5619, 'time@10': 6.815}:  30%|███       | 3/10 [00:20<00:31,  4.43s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9366, 'compress@10': 0.5619, 'time@10': 6.815}:  40%|████      | 4/10 [00:20<00:32,  5.35s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.938, 'compress@10': 0.637, 'time@10': 8.132}:  40%|████      | 4/10 [00:27<00:32,  5.35s/it]  {'epoch': 38, 'num_users': 5.8, 'loss': 0.0109, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.938, 'compress@10': 0.637, 'time@10': 8.132}:  50%|█████     | 5/10 [00:27<00:29,  5.85s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9456, 'compress@10': 0.6202, 'time@10': 8.505}:  50%|█████     | 5/10 [00:37<00:29,  5.85s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0118, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9456, 'compress@10': 0.6202, 'time@10': 8.505}:  60%|██████    | 6/10 [00:37<00:29,  7.40s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0121, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9468, 'compress@10': 0.5988, 'time@10': 8.9287}:  60%|██████    | 6/10 [00:43<00:29,  7.40s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0121, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9468, 'compress@10': 0.5988, 'time@10': 8.9287}:  70%|███████   | 7/10 [00:43<00:20,  6.87s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9471, 'compress@10': 0.5478, 'time@10': 8.7795}:  70%|███████   | 7/10 [00:51<00:20,  6.87s/it] {'epoch': 38, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9471, 'compress@10': 0.5478, 'time@10': 8.7795}:  80%|████████  | 8/10 [00:51<00:14,  7.16s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.944, 'compress@10': 0.5524, 'time@10': 9.4017}:  80%|████████  | 8/10 [00:58<00:14,  7.16s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.944, 'compress@10': 0.5524, 'time@10': 9.4017}:  90%|█████████ | 9/10 [00:58<00:07,  7.18s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9473, 'compress@10': 0.5257, 'time@10': 9.4736}:  90%|█████████ | 9/10 [01:08<00:07,  7.18s/it]  {'epoch': 38, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9473, 'compress@10': 0.5257, 'time@10': 9.4736}: 100%|██████████| 10/10 [01:08<00:00,  8.10s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9473, 'compress@10': 0.5257, 'time@10': 9.4736}: 100%|██████████| 10/10 [01:08<00:00,  6.87s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.016345370913212386
Avg hit ratio: 0.8792362602498427
Avg ndcg: 0.9473033347699407
Avg compression ratio: 0.5257130394847744
Avg train time: 9.47364408969879
Std train time: 2.810723765980217
[0.8874999999999998, 0.28750000000000003, 0.037500000000000006, 0.8375, 0.9124999999999999, 0.5375, 0.43750000000000006, 0.18750000000000003, 0.5874999999999998, 0.2875]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.8934, 'time@10': 8.4208}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0133, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.925, 'compress@10': 0.8934, 'time@10': 8.4208}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9479, 'compress@10': 0.6019, 'time@10': 7.8261}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0124, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9479, 'compress@10': 0.6019, 'time@10': 7.8261}:  20%|██        | 2/10 [00:11<00:48,  6.06s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9177, 'compress@10': 0.4596, 'time@10': 7.204}:  20%|██        | 2/10 [00:14<00:48,  6.06s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9177, 'compress@10': 0.4596, 'time@10': 7.204}:  30%|███       | 3/10 [00:14<00:32,  4.67s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9289, 'compress@10': 0.5555, 'time@10': 7.1037}:  30%|███       | 3/10 [00:21<00:32,  4.67s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9289, 'compress@10': 0.5555, 'time@10': 7.1037}:  40%|████      | 4/10 [00:21<00:33,  5.53s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9332, 'compress@10': 0.6273, 'time@10': 8.3214}:  40%|████      | 4/10 [00:28<00:33,  5.53s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9332, 'compress@10': 0.6273, 'time@10': 8.3214}:  50%|█████     | 5/10 [00:28<00:29,  5.92s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.941, 'compress@10': 0.614, 'time@10': 8.729}:  50%|█████     | 5/10 [00:38<00:29,  5.92s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.941, 'compress@10': 0.614, 'time@10': 8.729}:  60%|██████    | 6/10 [00:38<00:30,  7.58s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9424, 'compress@10': 0.592, 'time@10': 9.1676}:  60%|██████    | 6/10 [00:44<00:30,  7.58s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9424, 'compress@10': 0.592, 'time@10': 9.1676}:  70%|███████   | 7/10 [00:44<00:21,  7.05s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9459, 'compress@10': 0.5444, 'time@10': 8.9844}:  70%|███████   | 7/10 [00:52<00:21,  7.05s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9459, 'compress@10': 0.5444, 'time@10': 8.9844}:  80%|████████  | 8/10 [00:52<00:14,  7.27s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9476, 'compress@10': 0.5505, 'time@10': 9.5888}:  80%|████████  | 8/10 [00:59<00:14,  7.27s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9476, 'compress@10': 0.5505, 'time@10': 9.5888}:  90%|█████████ | 9/10 [00:59<00:07,  7.26s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9505, 'compress@10': 0.5258, 'time@10': 9.6387}:  90%|█████████ | 9/10 [01:09<00:07,  7.26s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9505, 'compress@10': 0.5258, 'time@10': 9.6387}: 100%|██████████| 10/10 [01:09<00:00,  8.15s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0094, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.9505, 'compress@10': 0.5258, 'time@10': 9.6387}: 100%|██████████| 10/10 [01:09<00:00,  6.99s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.009447049885929006
Avg hit ratio: 0.9075414317808205
Avg ndcg: 0.9504519119006574
Avg compression ratio: 0.525788981718602
Avg train time: 9.638726949691772
Std train time: 2.7252595285506303
[0.8902439024390243, 0.30487804878048785, 0.03658536585365854, 0.8414634146341463, 0.8902439024390243, 0.548780487804878, 0.426829268292683, 0.1829268292682927, 0.5975609756097559, 0.28048780487804875]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.896, 'time@10': 7.9416}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.931, 'compress@10': 0.896, 'time@10': 7.9416}:  10%|█         | 1/10 [00:04<00:36,  4.01s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.893, 'ndcg@10': 0.95, 'compress@10': 0.6117, 'time@10': 7.427}:  10%|█         | 1/10 [00:10<00:36,  4.01s/it]  {'epoch': 40, 'num_users': 7.0, 'loss': 0.0106, 'hit_ratio@10': 0.893, 'ndcg@10': 0.95, 'compress@10': 0.6117, 'time@10': 7.427}:  20%|██        | 2/10 [00:10<00:45,  5.74s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.919, 'compress@10': 0.4658, 'time@10': 6.826}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.919, 'compress@10': 0.4658, 'time@10': 6.826}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9298, 'compress@10': 0.5612, 'time@10': 6.8106}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0069, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9298, 'compress@10': 0.5612, 'time@10': 6.8106}:  40%|████      | 4/10 [00:20<00:32,  5.36s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9339, 'compress@10': 0.6274, 'time@10': 8.039}:  40%|████      | 4/10 [00:27<00:32,  5.36s/it]  {'epoch': 40, 'num_users': 5.8, 'loss': 0.008, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9339, 'compress@10': 0.6274, 'time@10': 8.039}:  50%|█████     | 5/10 [00:27<00:28,  5.78s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9409, 'compress@10': 0.616, 'time@10': 8.4311}:  50%|█████     | 5/10 [00:37<00:28,  5.78s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9409, 'compress@10': 0.616, 'time@10': 8.4311}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.943, 'compress@10': 0.5922, 'time@10': 8.8486}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0075, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.943, 'compress@10': 0.5922, 'time@10': 8.8486}:  70%|███████   | 7/10 [00:43<00:20,  6.82s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9423, 'compress@10': 0.544, 'time@10': 8.6995}:  70%|███████   | 7/10 [00:50<00:20,  6.82s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9423, 'compress@10': 0.544, 'time@10': 8.6995}:  80%|████████  | 8/10 [00:50<00:14,  7.10s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0107, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9388, 'compress@10': 0.5512, 'time@10': 9.3251}:  80%|████████  | 8/10 [00:58<00:14,  7.10s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0107, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9388, 'compress@10': 0.5512, 'time@10': 9.3251}:  90%|█████████ | 9/10 [00:58<00:07,  7.13s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9407, 'compress@10': 0.5258, 'time@10': 9.3837}:  90%|█████████ | 9/10 [01:08<00:07,  7.13s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9407, 'compress@10': 0.5258, 'time@10': 9.3837}: 100%|██████████| 10/10 [01:08<00:00,  8.00s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9407, 'compress@10': 0.5258, 'time@10': 9.3837}: 100%|██████████| 10/10 [01:08<00:00,  6.81s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.011709013839755405
Avg hit ratio: 0.8961128603522491
Avg ndcg: 0.9407136095134755
Avg compression ratio: 0.5257811404487663
Avg train time: 9.383653211593629
Std train time: 2.7302592769888476
[0.8928571428571428, 0.29761904761904767, 0.03571428571428572, 0.8214285714285714, 0.8928571428571428, 0.5357142857142857, 0.4166666666666667, 0.2023809523809524, 0.6071428571428569, 0.29761904761904756]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.8985, 'time@10': 8.0108}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.8985, 'time@10': 8.0108}:  10%|█         | 1/10 [00:04<00:36,  4.04s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0056, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9459, 'compress@10': 0.6094, 'time@10': 7.4756}:  10%|█         | 1/10 [00:11<00:36,  4.04s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0056, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9459, 'compress@10': 0.6094, 'time@10': 7.4756}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9163, 'compress@10': 0.4641, 'time@10': 6.8309}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9163, 'compress@10': 0.4641, 'time@10': 6.8309}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9329, 'compress@10': 0.555, 'time@10': 6.7725}:  30%|███       | 3/10 [00:20<00:30,  4.42s/it] {'epoch': 41, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9329, 'compress@10': 0.555, 'time@10': 6.7725}:  40%|████      | 4/10 [00:20<00:31,  5.29s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9373, 'compress@10': 0.623, 'time@10': 8.0545}:  40%|████      | 4/10 [00:27<00:31,  5.29s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9373, 'compress@10': 0.623, 'time@10': 8.0545}:  50%|█████     | 5/10 [00:27<00:28,  5.77s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0079, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9438, 'compress@10': 0.6102, 'time@10': 8.448}:  50%|█████     | 5/10 [00:37<00:28,  5.77s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0079, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9438, 'compress@10': 0.6102, 'time@10': 8.448}:  60%|██████    | 6/10 [00:37<00:29,  7.36s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9456, 'compress@10': 0.5859, 'time@10': 8.8498}:  60%|██████    | 6/10 [00:43<00:29,  7.36s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9456, 'compress@10': 0.5859, 'time@10': 8.8498}:  70%|███████   | 7/10 [00:43<00:20,  6.81s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9488, 'compress@10': 0.5408, 'time@10': 8.7055}:  70%|███████   | 7/10 [00:50<00:20,  6.81s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9488, 'compress@10': 0.5408, 'time@10': 8.7055}:  80%|████████  | 8/10 [00:50<00:14,  7.10s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0076, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9504, 'compress@10': 0.5494, 'time@10': 9.3112}:  80%|████████  | 8/10 [00:58<00:14,  7.10s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0076, 'hit_ratio@10': 0.9061, 'ndcg@10': 0.9504, 'compress@10': 0.5494, 'time@10': 9.3112}:  90%|█████████ | 9/10 [00:58<00:07,  7.11s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.007, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.953, 'compress@10': 0.5258, 'time@10': 9.3864}:  90%|█████████ | 9/10 [01:08<00:07,  7.11s/it]     {'epoch': 41, 'num_users': 6.3, 'loss': 0.007, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.953, 'compress@10': 0.5258, 'time@10': 9.3864}: 100%|██████████| 10/10 [01:08<00:00,  8.03s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.007, 'hit_ratio@10': 0.9133, 'ndcg@10': 0.953, 'compress@10': 0.5258, 'time@10': 9.3864}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.007041819889732422
Avg hit ratio: 0.9132557174951061
Avg ndcg: 0.952991506177213
Avg compression ratio: 0.525817688279308
Avg train time: 9.386369991302491
Std train time: 2.7475619520323833
[0.8953488372093023, 0.2906976744186047, 0.034883720930232565, 0.8255813953488372, 0.8953488372093023, 0.5465116279069767, 0.4069767441860465, 0.19767441860465118, 0.6162790697674416, 0.2906976744186046]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9395, 'compress@10': 0.9008, 'time@10': 8.0157}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0142, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9395, 'compress@10': 0.9008, 'time@10': 8.0157}:  10%|█         | 1/10 [00:04<00:36,  4.04s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9536, 'compress@10': 0.6072, 'time@10': 7.5251}:  10%|█         | 1/10 [00:11<00:36,  4.04s/it] {'epoch': 42, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9536, 'compress@10': 0.6072, 'time@10': 7.5251}:  20%|██        | 2/10 [00:11<00:46,  5.82s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9215, 'compress@10': 0.4624, 'time@10': 6.8669}:  20%|██        | 2/10 [00:13<00:46,  5.82s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9215, 'compress@10': 0.4624, 'time@10': 6.8669}:  30%|███       | 3/10 [00:13<00:31,  4.45s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9322, 'compress@10': 0.5547, 'time@10': 6.8834}:  30%|███       | 3/10 [00:20<00:31,  4.45s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9322, 'compress@10': 0.5547, 'time@10': 6.8834}:  40%|████      | 4/10 [00:20<00:32,  5.44s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0071, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9371, 'compress@10': 0.6233, 'time@10': 8.1681}:  40%|████      | 4/10 [00:27<00:32,  5.44s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0071, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9371, 'compress@10': 0.6233, 'time@10': 8.1681}:  50%|█████     | 5/10 [00:27<00:29,  5.89s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9435, 'compress@10': 0.6122, 'time@10': 8.5158}:  50%|█████     | 5/10 [00:37<00:29,  5.89s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9435, 'compress@10': 0.6122, 'time@10': 8.5158}:  60%|██████    | 6/10 [00:37<00:29,  7.39s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9445, 'compress@10': 0.5862, 'time@10': 8.8943}:  60%|██████    | 6/10 [00:43<00:29,  7.39s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9445, 'compress@10': 0.5862, 'time@10': 8.8943}:  70%|███████   | 7/10 [00:43<00:20,  6.81s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.946, 'compress@10': 0.5405, 'time@10': 8.7347}:  70%|███████   | 7/10 [00:51<00:20,  6.81s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.946, 'compress@10': 0.5405, 'time@10': 8.7347}:  80%|████████  | 8/10 [00:51<00:14,  7.08s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9501, 'compress@10': 0.5502, 'time@10': 9.3667}:  80%|████████  | 8/10 [00:58<00:14,  7.08s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.883, 'ndcg@10': 0.9501, 'compress@10': 0.5502, 'time@10': 9.3667}:  90%|█████████ | 9/10 [00:58<00:07,  7.13s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9507, 'compress@10': 0.5258, 'time@10': 9.4254}:  90%|█████████ | 9/10 [01:08<00:07,  7.13s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9507, 'compress@10': 0.5258, 'time@10': 9.4254}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8924, 'ndcg@10': 0.9507, 'compress@10': 0.5258, 'time@10': 9.4254}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.012978807366402167
Avg hit ratio: 0.8923985746379633
Avg ndcg: 0.9507465492693642
Avg compression ratio: 0.5258366562383812
Avg train time: 9.425386047363281
Std train time: 2.7609494811549617
[0.8977272727272727, 0.28409090909090917, 0.034090909090909095, 0.8068181818181819, 0.8749999999999999, 0.5568181818181818, 0.3977272727272727, 0.21590909090909094, 0.6249999999999998, 0.30681818181818177]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.93, 'compress@10': 0.9031, 'time@10': 7.9565}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0065, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.93, 'compress@10': 0.9031, 'time@10': 7.9565}:  10%|█         | 1/10 [00:04<00:36,  4.03s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9494, 'compress@10': 0.6051, 'time@10': 7.5014}:  10%|█         | 1/10 [00:11<00:36,  4.03s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9494, 'compress@10': 0.6051, 'time@10': 7.5014}:  20%|██        | 2/10 [00:11<00:46,  5.83s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9186, 'compress@10': 0.4608, 'time@10': 6.8844}:  20%|██        | 2/10 [00:13<00:46,  5.83s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9186, 'compress@10': 0.4608, 'time@10': 6.8844}:  30%|███       | 3/10 [00:13<00:31,  4.47s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.93, 'compress@10': 0.549, 'time@10': 6.8276}:  30%|███       | 3/10 [00:20<00:31,  4.47s/it]    {'epoch': 43, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.93, 'compress@10': 0.549, 'time@10': 6.8276}:  40%|████      | 4/10 [00:20<00:32,  5.35s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9356, 'compress@10': 0.6147, 'time@10': 8.1343}:  40%|████      | 4/10 [00:27<00:32,  5.35s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9356, 'compress@10': 0.6147, 'time@10': 8.1343}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0065, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9424, 'compress@10': 0.6067, 'time@10': 8.4745}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0065, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9424, 'compress@10': 0.6067, 'time@10': 8.4745}:  60%|██████    | 6/10 [00:37<00:29,  7.33s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0065, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9443, 'compress@10': 0.5803, 'time@10': 8.8475}:  60%|██████    | 6/10 [00:43<00:29,  7.33s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0065, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9443, 'compress@10': 0.5803, 'time@10': 8.8475}:  70%|███████   | 7/10 [00:43<00:20,  6.76s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9426, 'compress@10': 0.5375, 'time@10': 8.7435}:  70%|███████   | 7/10 [00:51<00:20,  6.76s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9426, 'compress@10': 0.5375, 'time@10': 8.7435}:  80%|████████  | 8/10 [00:51<00:14,  7.17s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9386, 'compress@10': 0.5485, 'time@10': 9.3347}:  80%|████████  | 8/10 [00:58<00:14,  7.17s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0105, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.9386, 'compress@10': 0.5485, 'time@10': 9.3347}:  90%|█████████ | 9/10 [00:58<00:07,  7.14s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9424, 'compress@10': 0.5259, 'time@10': 9.3979}:  90%|█████████ | 9/10 [01:08<00:07,  7.14s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9424, 'compress@10': 0.5259, 'time@10': 9.3979}: 100%|██████████| 10/10 [01:08<00:00,  8.03s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9424, 'compress@10': 0.5259, 'time@10': 9.3979}: 100%|██████████| 10/10 [01:08<00:00,  6.83s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.009623609088069111
Avg hit ratio: 0.884195809661005
Avg ndcg: 0.9424287560330669
Avg compression ratio: 0.5258658869378023
Avg train time: 9.397938561439513
Std train time: 2.6895294415927573
[0.8777777777777778, 0.3000000000000001, 0.03333333333333334, 0.8111111111111111, 0.8777777777777777, 0.5444444444444444, 0.3888888888888889, 0.23333333333333336, 0.6333333333333331, 0.29999999999999993]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.8842, 'time@10': 8.3676}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0148, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9219, 'compress@10': 0.8842, 'time@10': 8.3676}:  10%|█         | 1/10 [00:04<00:37,  4.22s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9448, 'compress@10': 0.6034, 'time@10': 7.7169}:  10%|█         | 1/10 [00:11<00:37,  4.22s/it] {'epoch': 44, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9448, 'compress@10': 0.6034, 'time@10': 7.7169}:  20%|██        | 2/10 [00:11<00:47,  5.92s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9156, 'compress@10': 0.4594, 'time@10': 7.0131}:  20%|██        | 2/10 [00:14<00:47,  5.92s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9156, 'compress@10': 0.4594, 'time@10': 7.0131}:  30%|███       | 3/10 [00:14<00:31,  4.51s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.944, 'compress@10': 0.549, 'time@10': 6.9388}:  30%|███       | 3/10 [00:20<00:31,  4.51s/it]  {'epoch': 44, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.944, 'compress@10': 0.549, 'time@10': 6.9388}:  40%|████      | 4/10 [00:20<00:32,  5.41s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9469, 'compress@10': 0.6153, 'time@10': 8.1981}:  40%|████      | 4/10 [00:27<00:32,  5.41s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8461, 'ndcg@10': 0.9469, 'compress@10': 0.6153, 'time@10': 8.1981}:  50%|█████     | 5/10 [00:27<00:29,  5.86s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9516, 'compress@10': 0.6051, 'time@10': 8.58}:  50%|█████     | 5/10 [00:38<00:29,  5.86s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0113, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9516, 'compress@10': 0.6051, 'time@10': 8.58}:  60%|██████    | 6/10 [00:38<00:29,  7.44s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9526, 'compress@10': 0.5777, 'time@10': 8.9481}:  60%|██████    | 6/10 [00:43<00:29,  7.44s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9526, 'compress@10': 0.5777, 'time@10': 8.9481}:  70%|███████   | 7/10 [00:43<00:20,  6.85s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9547, 'compress@10': 0.5374, 'time@10': 8.7908}:  70%|███████   | 7/10 [00:51<00:20,  6.85s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.8897, 'ndcg@10': 0.9547, 'compress@10': 0.5374, 'time@10': 8.7908}:  80%|████████  | 8/10 [00:51<00:14,  7.13s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.956, 'compress@10': 0.5492, 'time@10': 9.409}:  80%|████████  | 8/10 [00:58<00:14,  7.13s/it] {'epoch': 44, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.956, 'compress@10': 0.5492, 'time@10': 9.409}:  90%|█████████ | 9/10 [00:58<00:07,  7.16s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9554, 'compress@10': 0.5259, 'time@10': 9.4914}:  90%|█████████ | 9/10 [01:08<00:07,  7.16s/it] {'epoch': 44, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9554, 'compress@10': 0.5259, 'time@10': 9.4914}: 100%|██████████| 10/10 [01:08<00:00,  8.12s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0106, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9554, 'compress@10': 0.5259, 'time@10': 9.4914}: 100%|██████████| 10/10 [01:08<00:00,  6.90s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.01056066211254453
Avg hit ratio: 0.8923192095585983
Avg ndcg: 0.9554118680005759
Avg compression ratio: 0.5259140150909137
Avg train time: 9.491393756866454
Std train time: 2.7419144437084455
[0.8804347826086957, 0.2934782608695653, 0.03260869565217392, 0.8152173913043478, 0.8804347826086956, 0.5543478260869564, 0.3804347826086957, 0.22826086956521743, 0.6195652173913041, 0.3152173913043478]
[10, 10, 23, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9395, 'compress@10': 0.8867, 'time@10': 8.3499}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9395, 'compress@10': 0.8867, 'time@10': 8.3499}:  10%|█         | 1/10 [00:04<00:37,  4.21s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9536, 'compress@10': 0.6015, 'time@10': 7.652}:  10%|█         | 1/10 [00:11<00:37,  4.21s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9536, 'compress@10': 0.6015, 'time@10': 7.652}:  20%|██        | 2/10 [00:11<00:46,  5.85s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9215, 'compress@10': 0.4579, 'time@10': 6.885}:  20%|██        | 2/10 [00:13<00:46,  5.85s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9215, 'compress@10': 0.4579, 'time@10': 6.885}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9322, 'compress@10': 0.5489, 'time@10': 6.7992}:  30%|███       | 3/10 [00:20<00:30,  4.41s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0057, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9322, 'compress@10': 0.5489, 'time@10': 6.7992}:  40%|████      | 4/10 [00:20<00:31,  5.27s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0067, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.938, 'compress@10': 0.6157, 'time@10': 8.079}:  40%|████      | 4/10 [00:27<00:31,  5.27s/it]  {'epoch': 45, 'num_users': 5.8, 'loss': 0.0067, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.938, 'compress@10': 0.6157, 'time@10': 8.079}:  50%|█████     | 5/10 [00:27<00:28,  5.76s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0066, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9443, 'compress@10': 0.6071, 'time@10': 8.4663}:  50%|█████     | 5/10 [00:37<00:28,  5.76s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0066, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9443, 'compress@10': 0.6071, 'time@10': 8.4663}:  60%|██████    | 6/10 [00:37<00:29,  7.35s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.946, 'compress@10': 0.5783, 'time@10': 8.8556}:  60%|██████    | 6/10 [00:43<00:29,  7.35s/it] {'epoch': 45, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.946, 'compress@10': 0.5783, 'time@10': 8.8556}:  70%|███████   | 7/10 [00:43<00:20,  6.79s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9582, 'compress@10': 0.5373, 'time@10': 8.717}:  70%|███████   | 7/10 [00:50<00:20,  6.79s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0092, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9582, 'compress@10': 0.5373, 'time@10': 8.717}:  80%|████████  | 8/10 [00:50<00:14,  7.11s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0097, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9594, 'compress@10': 0.5476, 'time@10': 9.3489}:  80%|████████  | 8/10 [00:58<00:14,  7.11s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0097, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9594, 'compress@10': 0.5476, 'time@10': 9.3489}:  90%|█████████ | 9/10 [00:58<00:07,  7.15s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9612, 'compress@10': 0.5259, 'time@10': 9.4116}:  90%|█████████ | 9/10 [01:08<00:07,  7.15s/it]    {'epoch': 45, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9612, 'compress@10': 0.5259, 'time@10': 9.4116}: 100%|██████████| 10/10 [01:08<00:00,  8.04s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.009, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9612, 'compress@10': 0.5259, 'time@10': 9.4116}: 100%|██████████| 10/10 [01:08<00:00,  6.82s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.009019179641507703
Avg hit ratio: 0.8899100953752906
Avg ndcg: 0.961165425023944
Avg compression ratio: 0.525941740412535
Avg train time: 9.411566352844238
Std train time: 2.799944883714345
[0.8829787234042553, 0.28723404255319157, 0.03191489361702128, 0.7978723404255319, 0.8829787234042552, 0.5425531914893617, 0.39361702127659576, 0.24468085106382984, 0.6276595744680848, 0.3085106382978723]
[10, 10, 24, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.8891, 'time@10': 8.3739}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9289, 'compress@10': 0.8891, 'time@10': 8.3739}:  10%|█         | 1/10 [00:04<00:38,  4.22s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9483, 'compress@10': 0.5997, 'time@10': 7.7629}:  10%|█         | 1/10 [00:11<00:38,  4.22s/it]   {'epoch': 46, 'num_users': 7.0, 'loss': 0.01, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9483, 'compress@10': 0.5997, 'time@10': 7.7629}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9179, 'compress@10': 0.4565, 'time@10': 7.09}:  20%|██        | 2/10 [00:14<00:47,  5.97s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9179, 'compress@10': 0.4565, 'time@10': 7.09}:  30%|███       | 3/10 [00:14<00:31,  4.57s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9295, 'compress@10': 0.5437, 'time@10': 6.9664}:  30%|███       | 3/10 [00:20<00:31,  4.57s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9295, 'compress@10': 0.5437, 'time@10': 6.9664}:  40%|████      | 4/10 [00:20<00:32,  5.39s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9353, 'compress@10': 0.612, 'time@10': 8.2166}:  40%|████      | 4/10 [00:27<00:32,  5.39s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9353, 'compress@10': 0.612, 'time@10': 8.2166}:  50%|█████     | 5/10 [00:27<00:29,  5.84s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9428, 'compress@10': 0.6021, 'time@10': 8.5705}:  50%|█████     | 5/10 [00:37<00:29,  5.84s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.8666, 'ndcg@10': 0.9428, 'compress@10': 0.6021, 'time@10': 8.5705}:  60%|██████    | 6/10 [00:37<00:29,  7.38s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9447, 'compress@10': 0.5758, 'time@10': 8.9598}:  60%|██████    | 6/10 [00:43<00:29,  7.38s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0101, 'hit_ratio@10': 0.8799, 'ndcg@10': 0.9447, 'compress@10': 0.5758, 'time@10': 8.9598}:  70%|███████   | 7/10 [00:43<00:20,  6.83s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9469, 'compress@10': 0.5371, 'time@10': 8.8053}:  70%|███████   | 7/10 [00:51<00:20,  6.83s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 0.0098, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9469, 'compress@10': 0.5371, 'time@10': 8.8053}:  80%|████████  | 8/10 [00:51<00:14,  7.12s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9478, 'compress@10': 0.5483, 'time@10': 9.3968}:  80%|████████  | 8/10 [00:58<00:14,  7.12s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0101, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9478, 'compress@10': 0.5483, 'time@10': 9.3968}:  90%|█████████ | 9/10 [00:58<00:07,  7.12s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.949, 'compress@10': 0.5259, 'time@10': 9.4613}:  90%|█████████ | 9/10 [01:08<00:07,  7.12s/it]    {'epoch': 46, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.949, 'compress@10': 0.5259, 'time@10': 9.4613}: 100%|██████████| 10/10 [01:08<00:00,  8.03s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.949, 'compress@10': 0.5259, 'time@10': 9.4613}: 100%|██████████| 10/10 [01:08<00:00,  6.86s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.011056968686283905
Avg hit ratio: 0.8822398444792332
Avg ndcg: 0.9490406541291773
Avg compression ratio: 0.5259348930911522
Avg train time: 9.4613347530365
Std train time: 2.6818984355345283
[0.8645833333333334, 0.28125000000000006, 0.03125000000000001, 0.78125, 0.8854166666666665, 0.5520833333333333, 0.40625, 0.23958333333333337, 0.6354166666666664, 0.32291666666666663]
[10, 10, 24, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.8717, 'time@10': 8.2923}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.924, 'compress@10': 0.8717, 'time@10': 8.2923}:  10%|█         | 1/10 [00:04<00:37,  4.18s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9497, 'compress@10': 0.5881, 'time@10': 7.645}:  10%|█         | 1/10 [00:11<00:37,  4.18s/it] {'epoch': 47, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9497, 'compress@10': 0.5881, 'time@10': 7.645}:  20%|██        | 2/10 [00:11<00:46,  5.86s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9188, 'compress@10': 0.4486, 'time@10': 6.9726}:  20%|██        | 2/10 [00:14<00:46,  5.86s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9188, 'compress@10': 0.4486, 'time@10': 6.9726}:  30%|███       | 3/10 [00:14<00:31,  4.49s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.9377, 'compress@10': 0.5337, 'time@10': 6.8655}:  30%|███       | 3/10 [00:20<00:31,  4.49s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8037, 'ndcg@10': 0.9377, 'compress@10': 0.5337, 'time@10': 6.8655}:  40%|████      | 4/10 [00:20<00:31,  5.31s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.9427, 'compress@10': 0.6045, 'time@10': 8.2184}:  40%|████      | 4/10 [00:27<00:31,  5.31s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.8389, 'ndcg@10': 0.9427, 'compress@10': 0.6045, 'time@10': 8.2184}:  50%|█████     | 5/10 [00:27<00:29,  5.87s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9484, 'compress@10': 0.5974, 'time@10': 8.5683}:  50%|█████     | 5/10 [00:37<00:29,  5.87s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9484, 'compress@10': 0.5974, 'time@10': 8.5683}:  60%|██████    | 6/10 [00:37<00:29,  7.39s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9498, 'compress@10': 0.5735, 'time@10': 8.9307}:  60%|██████    | 6/10 [00:43<00:29,  7.39s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0078, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9498, 'compress@10': 0.5735, 'time@10': 8.9307}:  70%|███████   | 7/10 [00:43<00:20,  6.80s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0073, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9523, 'compress@10': 0.5345, 'time@10': 8.785}:  70%|███████   | 7/10 [00:51<00:20,  6.80s/it]   {'epoch': 47, 'num_users': 6.125, 'loss': 0.0073, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9523, 'compress@10': 0.5345, 'time@10': 8.785}:  80%|████████  | 8/10 [00:51<00:14,  7.12s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0067, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9541, 'compress@10': 0.5469, 'time@10': 9.4169}:  80%|████████  | 8/10 [00:58<00:14,  7.12s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0067, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9541, 'compress@10': 0.5469, 'time@10': 9.4169}:  90%|█████████ | 9/10 [00:58<00:07,  7.17s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0062, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9564, 'compress@10': 0.526, 'time@10': 9.4635}:  90%|█████████ | 9/10 [01:08<00:07,  7.17s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 0.0062, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9564, 'compress@10': 0.526, 'time@10': 9.4635}: 100%|██████████| 10/10 [01:08<00:00,  8.02s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0062, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9564, 'compress@10': 0.526, 'time@10': 9.4635}: 100%|██████████| 10/10 [01:08<00:00,  6.84s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.006196051184147715
Avg hit ratio: 0.8881128603522491
Avg ndcg: 0.9564110922051354
Avg compression ratio: 0.5260016121679774
Avg train time: 9.463454413414002
Std train time: 2.8216088124612515
[0.8673469387755103, 0.2959183673469388, 0.03061224489795919, 0.7857142857142857, 0.8877551020408162, 0.5408163265306122, 0.3979591836734694, 0.2551020408163266, 0.6224489795918364, 0.31632653061224486]
[10, 10, 24, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.8743, 'time@10': 8.2105}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0052, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.8743, 'time@10': 8.2105}:  10%|█         | 1/10 [00:04<00:37,  4.14s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9501, 'compress@10': 0.5965, 'time@10': 7.6927}:  10%|█         | 1/10 [00:11<00:37,  4.14s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9501, 'compress@10': 0.5965, 'time@10': 7.6927}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0028, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9191, 'compress@10': 0.454, 'time@10': 7.1115}:  20%|██        | 2/10 [00:14<00:47,  5.95s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0028, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9191, 'compress@10': 0.454, 'time@10': 7.1115}:  30%|███       | 3/10 [00:14<00:32,  4.62s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0029, 'hit_ratio@10': 0.7956, 'ndcg@10': 0.9304, 'compress@10': 0.5389, 'time@10': 7.0109}:  30%|███       | 3/10 [00:21<00:32,  4.62s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0029, 'hit_ratio@10': 0.7956, 'ndcg@10': 0.9304, 'compress@10': 0.5389, 'time@10': 7.0109}:  40%|████      | 4/10 [00:21<00:32,  5.46s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0045, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.937, 'compress@10': 0.6091, 'time@10': 8.3079}:  40%|████      | 4/10 [00:27<00:32,  5.46s/it] {'epoch': 48, 'num_users': 5.8, 'loss': 0.0045, 'hit_ratio@10': 0.8325, 'ndcg@10': 0.937, 'compress@10': 0.6091, 'time@10': 8.3079}:  50%|█████     | 5/10 [00:27<00:29,  5.94s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0053, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9434, 'compress@10': 0.5994, 'time@10': 8.6624}:  50%|█████     | 5/10 [00:38<00:29,  5.94s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0053, 'hit_ratio@10': 0.853, 'ndcg@10': 0.9434, 'compress@10': 0.5994, 'time@10': 8.6624}:  60%|██████    | 6/10 [00:38<00:29,  7.48s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0056, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9449, 'compress@10': 0.5741, 'time@10': 9.0217}:  60%|██████    | 6/10 [00:44<00:29,  7.48s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0056, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9449, 'compress@10': 0.5741, 'time@10': 9.0217}:  70%|███████   | 7/10 [00:44<00:20,  6.87s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9548, 'compress@10': 0.5369, 'time@10': 8.8117}:  70%|███████   | 7/10 [00:51<00:20,  6.87s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0082, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9548, 'compress@10': 0.5369, 'time@10': 8.8117}:  80%|████████  | 8/10 [00:51<00:14,  7.03s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9554, 'compress@10': 0.5476, 'time@10': 9.339}:  80%|████████  | 8/10 [00:58<00:14,  7.03s/it] {'epoch': 48, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.869, 'ndcg@10': 0.9554, 'compress@10': 0.5476, 'time@10': 9.339}:  90%|█████████ | 9/10 [00:58<00:06,  6.97s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9556, 'compress@10': 0.526, 'time@10': 9.3417}:  90%|█████████ | 9/10 [01:07<00:06,  6.97s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9556, 'compress@10': 0.526, 'time@10': 9.3417}: 100%|██████████| 10/10 [01:07<00:00,  7.72s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0102, 'hit_ratio@10': 0.8798, 'ndcg@10': 0.9556, 'compress@10': 0.526, 'time@10': 9.3417}: 100%|██████████| 10/10 [01:07<00:00,  6.76s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.010188203814756163
Avg hit ratio: 0.8798076888212712
Avg ndcg: 0.9555876654764708
Avg compression ratio: 0.5259947335517137
Avg train time: 9.341686630249024
Std train time: 2.60797365572085
[0.8500000000000001, 0.29000000000000004, 0.030000000000000006, 0.77, 0.8899999999999999, 0.5499999999999999, 0.39, 0.2700000000000001, 0.6299999999999997, 0.32999999999999996]
[10, 10, 24, 11, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.8579, 'time@10': 7.9713}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 0.8579, 'time@10': 7.9713}:  10%|█         | 1/10 [00:04<00:36,  4.04s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0053, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9501, 'compress@10': 0.5854, 'time@10': 7.1891}:  10%|█         | 1/10 [00:10<00:36,  4.04s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0053, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9501, 'compress@10': 0.5854, 'time@10': 7.1891}:  20%|██        | 2/10 [00:10<00:43,  5.45s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0036, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9191, 'compress@10': 0.4465, 'time@10': 6.566}:  20%|██        | 2/10 [00:13<00:43,  5.45s/it] {'epoch': 49, 'num_users': 5.0, 'loss': 0.0036, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9191, 'compress@10': 0.4465, 'time@10': 6.566}:  30%|███       | 3/10 [00:13<00:29,  4.19s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9304, 'compress@10': 0.5294, 'time@10': 6.4384}:  30%|███       | 3/10 [00:19<00:29,  4.19s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0038, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9304, 'compress@10': 0.5294, 'time@10': 6.4384}:  40%|████      | 4/10 [00:19<00:29,  4.94s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0051, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9367, 'compress@10': 0.6019, 'time@10': 7.4541}:  40%|████      | 4/10 [00:25<00:29,  4.94s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0051, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.9367, 'compress@10': 0.6019, 'time@10': 7.4541}:  50%|█████     | 5/10 [00:25<00:26,  5.25s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9442, 'compress@10': 0.595, 'time@10': 7.7203}:  50%|█████     | 5/10 [00:34<00:26,  5.25s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.9442, 'compress@10': 0.595, 'time@10': 7.7203}:  60%|██████    | 6/10 [00:34<00:26,  6.55s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9465, 'compress@10': 0.5692, 'time@10': 8.202}:  60%|██████    | 6/10 [00:39<00:26,  6.55s/it] {'epoch': 49, 'num_users': 6.2857, 'loss': 0.009, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9465, 'compress@10': 0.5692, 'time@10': 8.202}:  70%|███████   | 7/10 [00:39<00:18,  6.24s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0097, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9456, 'compress@10': 0.5344, 'time@10': 8.0386}:  70%|███████   | 7/10 [00:46<00:18,  6.24s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0097, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9456, 'compress@10': 0.5344, 'time@10': 8.0386}:  80%|████████  | 8/10 [00:46<00:12,  6.46s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9496, 'compress@10': 0.5462, 'time@10': 8.518}:  80%|████████  | 8/10 [00:52<00:12,  6.46s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0104, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9496, 'compress@10': 0.5462, 'time@10': 8.518}:  90%|█████████ | 9/10 [00:52<00:06,  6.38s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9524, 'compress@10': 0.5261, 'time@10': 8.5449}:  90%|█████████ | 9/10 [01:01<00:06,  6.38s/it]  {'epoch': 49, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9524, 'compress@10': 0.5261, 'time@10': 8.5449}: 100%|██████████| 10/10 [01:01<00:00,  7.13s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.8855, 'ndcg@10': 0.9524, 'compress@10': 0.5261, 'time@10': 8.5449}: 100%|██████████| 10/10 [01:01<00:00,  6.17s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.009510636818253638
Avg hit ratio: 0.8854656509308463
Avg ndcg: 0.952378616389705
Avg compression ratio: 0.5260804179937247
Avg train time: 8.544934582710265
Std train time: 2.3315367785160177
[0.8333333333333334, 0.2843137254901961, 0.02941176470588236, 0.7549019607843137, 0.892156862745098, 0.5588235294117646, 0.4019607843137255, 0.2843137254901962, 0.6372549019607839, 0.32352941176470584]
[10, 10, 25, 11, 6, 10, 10, 10, 9, 10]
