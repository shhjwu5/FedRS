  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 3.4786, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.918}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 3.4786, 'hit_ratio@10': 0.0, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.918}:  10%|█         | 1/10 [00:01<00:13,  1.48s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 3.5845, 'hit_ratio@10': 0.1613, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.2012}:  10%|█         | 1/10 [00:02<00:13,  1.48s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 3.5845, 'hit_ratio@10': 0.1613, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.2012}:  20%|██        | 2/10 [00:02<00:11,  1.49s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 3.2953, 'hit_ratio@10': 0.1075, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.6454}:  20%|██        | 2/10 [00:03<00:11,  1.49s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 3.2953, 'hit_ratio@10': 0.1075, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.6454}:  30%|███       | 3/10 [00:03<00:06,  1.06it/s]{'epoch': 0, 'num_users': 5.0, 'loss': 3.3735, 'hit_ratio@10': 0.1878, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.5701}:  30%|███       | 3/10 [00:04<00:06,  1.06it/s]{'epoch': 0, 'num_users': 5.0, 'loss': 3.3735, 'hit_ratio@10': 0.1878, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.5701}:  40%|████      | 4/10 [00:04<00:06,  1.11s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 3.2411, 'hit_ratio@10': 0.2142, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.1659}:  40%|████      | 4/10 [00:06<00:06,  1.11s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 3.2411, 'hit_ratio@10': 0.2142, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.1659}:  50%|█████     | 5/10 [00:06<00:07,  1.53s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 3.2732, 'hit_ratio@10': 0.26, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.1383}:  50%|█████     | 5/10 [00:08<00:07,  1.53s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 3.2732, 'hit_ratio@10': 0.26, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.1383}:  60%|██████    | 6/10 [00:08<00:06,  1.70s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 3.2909, 'hit_ratio@10': 0.2686, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.1243}:  60%|██████    | 6/10 [00:09<00:06,  1.70s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 3.2909, 'hit_ratio@10': 0.2686, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.1243}:  70%|███████   | 7/10 [00:09<00:04,  1.48s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 3.1985, 'hit_ratio@10': 0.2671, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.0509}:  70%|███████   | 7/10 [00:11<00:04,  1.48s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 3.1985, 'hit_ratio@10': 0.2671, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.0509}:  80%|████████  | 8/10 [00:11<00:03,  1.51s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 3.2899, 'hit_ratio@10': 0.2851, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.1713}:  80%|████████  | 8/10 [00:13<00:03,  1.51s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 3.2899, 'hit_ratio@10': 0.2851, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.1713}:  90%|█████████ | 9/10 [00:13<00:01,  1.53s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 3.2859, 'hit_ratio@10': 0.2838, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.1426}:  90%|█████████ | 9/10 [00:15<00:01,  1.53s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 3.2859, 'hit_ratio@10': 0.2838, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.1426}: 100%|██████████| 10/10 [00:15<00:00,  1.64s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 3.2859, 'hit_ratio@10': 0.2838, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 2.1426}: 100%|██████████| 10/10 [00:15<00:00,  1.50s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 3.285890736896021
Avg hit ratio: 0.2838482521063166
Avg ndcg: 0.0
Avg compression ratio: 1.0
Avg train time: 2.142626404762268
Std train time: 1.072268908137835
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 3.0946, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.6012}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 3.0946, 'hit_ratio@10': 0.1579, 'ndcg@10': 0.0, 'compress@10': 1.0, 'time@10': 1.6012}:  10%|█         | 1/10 [00:00<00:07,  1.23it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 3.0779, 'hit_ratio@10': 0.3209, 'ndcg@10': 0.0012, 'compress@10': 1.0, 'time@10': 1.5158}:  10%|█         | 1/10 [00:02<00:07,  1.23it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 3.0779, 'hit_ratio@10': 0.3209, 'ndcg@10': 0.0012, 'compress@10': 1.0, 'time@10': 1.5158}:  20%|██        | 2/10 [00:02<00:09,  1.19s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 2.8766, 'hit_ratio@10': 0.3092, 'ndcg@10': 0.0008, 'compress@10': 1.0, 'time@10': 1.1694}:  20%|██        | 2/10 [00:02<00:09,  1.19s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 2.8766, 'hit_ratio@10': 0.3092, 'ndcg@10': 0.0008, 'compress@10': 1.0, 'time@10': 1.1694}:  30%|███       | 3/10 [00:02<00:05,  1.32it/s]{'epoch': 1, 'num_users': 5.0, 'loss': 2.918, 'hit_ratio@10': 0.339, 'ndcg@10': 0.0006, 'compress@10': 1.0, 'time@10': 1.1646}:  30%|███       | 3/10 [00:03<00:05,  1.32it/s]  {'epoch': 1, 'num_users': 5.0, 'loss': 2.918, 'hit_ratio@10': 0.339, 'ndcg@10': 0.0006, 'compress@10': 1.0, 'time@10': 1.1646}:  40%|████      | 4/10 [00:03<00:05,  1.09it/s]{'epoch': 1, 'num_users': 5.8, 'loss': 2.7184, 'hit_ratio@10': 0.3432, 'ndcg@10': 0.0084, 'compress@10': 1.0, 'time@10': 1.825}:  40%|████      | 4/10 [00:05<00:05,  1.09it/s]{'epoch': 1, 'num_users': 5.8, 'loss': 2.7184, 'hit_ratio@10': 0.3432, 'ndcg@10': 0.0084, 'compress@10': 1.0, 'time@10': 1.825}:  50%|█████     | 5/10 [00:05<00:07,  1.40s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 2.7046, 'hit_ratio@10': 0.3675, 'ndcg@10': 0.0125, 'compress@10': 1.0, 'time@10': 1.8449}:  50%|█████     | 5/10 [00:07<00:07,  1.40s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 2.7046, 'hit_ratio@10': 0.3675, 'ndcg@10': 0.0125, 'compress@10': 1.0, 'time@10': 1.8449}:  60%|██████    | 6/10 [00:07<00:06,  1.59s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 2.735, 'hit_ratio@10': 0.3493, 'ndcg@10': 0.0108, 'compress@10': 1.0, 'time@10': 1.8777}:  60%|██████    | 6/10 [00:08<00:06,  1.59s/it] {'epoch': 1, 'num_users': 6.2857, 'loss': 2.735, 'hit_ratio@10': 0.3493, 'ndcg@10': 0.0108, 'compress@10': 1.0, 'time@10': 1.8777}:  70%|███████   | 7/10 [00:08<00:04,  1.41s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 2.6447, 'hit_ratio@10': 0.3449, 'ndcg@10': 0.0107, 'compress@10': 1.0, 'time@10': 1.8308}:  70%|███████   | 7/10 [00:10<00:04,  1.41s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 2.6447, 'hit_ratio@10': 0.3449, 'ndcg@10': 0.0107, 'compress@10': 1.0, 'time@10': 1.8308}:  80%|████████  | 8/10 [00:10<00:02,  1.45s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 2.7188, 'hit_ratio@10': 0.3574, 'ndcg@10': 0.0111, 'compress@10': 1.0, 'time@10': 1.9776}:  80%|████████  | 8/10 [00:12<00:02,  1.45s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 2.7188, 'hit_ratio@10': 0.3574, 'ndcg@10': 0.0111, 'compress@10': 1.0, 'time@10': 1.9776}:  90%|█████████ | 9/10 [00:12<00:01,  1.49s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 2.6954, 'hit_ratio@10': 0.3466, 'ndcg@10': 0.0134, 'compress@10': 1.0, 'time@10': 1.9744}:  90%|█████████ | 9/10 [00:14<00:01,  1.49s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 2.6954, 'hit_ratio@10': 0.3466, 'ndcg@10': 0.0134, 'compress@10': 1.0, 'time@10': 1.9744}: 100%|██████████| 10/10 [00:14<00:00,  1.64s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 2.6954, 'hit_ratio@10': 0.3466, 'ndcg@10': 0.0134, 'compress@10': 1.0, 'time@10': 1.9744}: 100%|██████████| 10/10 [00:14<00:00,  1.40s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 2.6954094907729433
Avg hit ratio: 0.34663688791872155
Avg ndcg: 0.013393660066786748
Avg compression ratio: 1.0
Avg train time: 1.9744364500045777
Std train time: 1.0578198361077726
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 2.4772, 'hit_ratio@10': 0.2632, 'ndcg@10': 0.033, 'compress@10': 1.0, 'time@10': 1.5862}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 2.4772, 'hit_ratio@10': 0.2632, 'ndcg@10': 0.033, 'compress@10': 1.0, 'time@10': 1.5862}:  10%|█         | 1/10 [00:00<00:07,  1.24it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 2.1783, 'hit_ratio@10': 0.4219, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 1.4603}:  10%|█         | 1/10 [00:02<00:07,  1.24it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 2.1783, 'hit_ratio@10': 0.4219, 'ndcg@10': 0.0375, 'compress@10': 1.0, 'time@10': 1.4603}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 2.1809, 'hit_ratio@10': 0.4241, 'ndcg@10': 0.025, 'compress@10': 1.0, 'time@10': 1.1516}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 2.1809, 'hit_ratio@10': 0.4241, 'ndcg@10': 0.025, 'compress@10': 1.0, 'time@10': 1.1516}:  30%|███       | 3/10 [00:02<00:05,  1.35it/s]{'epoch': 2, 'num_users': 5.0, 'loss': 2.132, 'hit_ratio@10': 0.4431, 'ndcg@10': 0.0271, 'compress@10': 1.0, 'time@10': 1.1622}:  30%|███       | 3/10 [00:03<00:05,  1.35it/s]{'epoch': 2, 'num_users': 5.0, 'loss': 2.132, 'hit_ratio@10': 0.4431, 'ndcg@10': 0.0271, 'compress@10': 1.0, 'time@10': 1.1622}:  40%|████      | 4/10 [00:03<00:05,  1.08it/s]{'epoch': 2, 'num_users': 5.8, 'loss': 1.8605, 'hit_ratio@10': 0.4465, 'ndcg@10': 0.0485, 'compress@10': 1.0, 'time@10': 1.8332}:  40%|████      | 4/10 [00:05<00:05,  1.08it/s]{'epoch': 2, 'num_users': 5.8, 'loss': 1.8605, 'hit_ratio@10': 0.4465, 'ndcg@10': 0.0485, 'compress@10': 1.0, 'time@10': 1.8332}:  50%|█████     | 5/10 [00:05<00:07,  1.41s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 1.7717, 'hit_ratio@10': 0.461, 'ndcg@10': 0.0561, 'compress@10': 1.0, 'time@10': 1.8565}:  50%|█████     | 5/10 [00:07<00:07,  1.41s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 1.7717, 'hit_ratio@10': 0.461, 'ndcg@10': 0.0561, 'compress@10': 1.0, 'time@10': 1.8565}:  60%|██████    | 6/10 [00:07<00:06,  1.61s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 1.8142, 'hit_ratio@10': 0.4408, 'ndcg@10': 0.0532, 'compress@10': 1.0, 'time@10': 1.9024}:  60%|██████    | 6/10 [00:09<00:06,  1.61s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 1.8142, 'hit_ratio@10': 0.4408, 'ndcg@10': 0.0532, 'compress@10': 1.0, 'time@10': 1.9024}:  70%|███████   | 7/10 [00:09<00:04,  1.44s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 1.7265, 'hit_ratio@10': 0.4429, 'ndcg@10': 0.0534, 'compress@10': 1.0, 'time@10': 1.854}:  70%|███████   | 7/10 [00:10<00:04,  1.44s/it]  {'epoch': 2, 'num_users': 6.125, 'loss': 1.7265, 'hit_ratio@10': 0.4429, 'ndcg@10': 0.0534, 'compress@10': 1.0, 'time@10': 1.854}:  80%|████████  | 8/10 [00:10<00:02,  1.47s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 1.7566, 'hit_ratio@10': 0.4413, 'ndcg@10': 0.0527, 'compress@10': 1.0, 'time@10': 1.985}:  80%|████████  | 8/10 [00:12<00:02,  1.47s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 1.7566, 'hit_ratio@10': 0.4413, 'ndcg@10': 0.0527, 'compress@10': 1.0, 'time@10': 1.985}:  90%|█████████ | 9/10 [00:12<00:01,  1.49s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 1.6992, 'hit_ratio@10': 0.4426, 'ndcg@10': 0.0572, 'compress@10': 1.0, 'time@10': 1.9723}:  90%|█████████ | 9/10 [00:13<00:01,  1.49s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 1.6992, 'hit_ratio@10': 0.4426, 'ndcg@10': 0.0572, 'compress@10': 1.0, 'time@10': 1.9723}: 100%|██████████| 10/10 [00:13<00:00,  1.61s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 1.6992, 'hit_ratio@10': 0.4426, 'ndcg@10': 0.0572, 'compress@10': 1.0, 'time@10': 1.9723}: 100%|██████████| 10/10 [00:13<00:00,  1.40s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 1.69921810872926
Avg hit ratio: 0.4425967558191667
Avg ndcg: 0.05724268099626502
Avg compression ratio: 1.0
Avg train time: 1.972270131111145
Std train time: 1.0533447684833976
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 1.3227, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.0766, 'compress@10': 1.0, 'time@10': 1.5425}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 1.3227, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.0766, 'compress@10': 1.0, 'time@10': 1.5425}:  10%|█         | 1/10 [00:00<00:07,  1.25it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.8777, 'hit_ratio@10': 0.5594, 'ndcg@10': 0.1744, 'compress@10': 1.0, 'time@10': 1.4717}:  10%|█         | 1/10 [00:02<00:07,  1.25it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.8777, 'hit_ratio@10': 0.5594, 'ndcg@10': 0.1744, 'compress@10': 1.0, 'time@10': 1.4717}:  20%|██        | 2/10 [00:02<00:09,  1.17s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 1.1534, 'hit_ratio@10': 0.5634, 'ndcg@10': 0.1335, 'compress@10': 1.0, 'time@10': 1.1808}:  20%|██        | 2/10 [00:02<00:09,  1.17s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 1.1534, 'hit_ratio@10': 0.5634, 'ndcg@10': 0.1335, 'compress@10': 1.0, 'time@10': 1.1808}:  30%|███       | 3/10 [00:02<00:05,  1.28it/s]{'epoch': 3, 'num_users': 5.0, 'loss': 1.0003, 'hit_ratio@10': 0.5565, 'ndcg@10': 0.1537, 'compress@10': 1.0, 'time@10': 1.1827}:  30%|███       | 3/10 [00:03<00:05,  1.28it/s]{'epoch': 3, 'num_users': 5.0, 'loss': 1.0003, 'hit_ratio@10': 0.5565, 'ndcg@10': 0.1537, 'compress@10': 1.0, 'time@10': 1.1827}:  40%|████      | 4/10 [00:03<00:05,  1.06it/s]{'epoch': 3, 'num_users': 5.8, 'loss': 0.8264, 'hit_ratio@10': 0.5652, 'ndcg@10': 0.2227, 'compress@10': 1.0, 'time@10': 1.8118}:  40%|████      | 4/10 [00:05<00:05,  1.06it/s]{'epoch': 3, 'num_users': 5.8, 'loss': 0.8264, 'hit_ratio@10': 0.5652, 'ndcg@10': 0.2227, 'compress@10': 1.0, 'time@10': 1.8118}:  50%|█████     | 5/10 [00:05<00:06,  1.39s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.7247, 'hit_ratio@10': 0.571, 'ndcg@10': 0.2516, 'compress@10': 1.0, 'time@10': 1.8374}:  50%|█████     | 5/10 [00:07<00:06,  1.39s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.7247, 'hit_ratio@10': 0.571, 'ndcg@10': 0.2516, 'compress@10': 1.0, 'time@10': 1.8374}:  60%|██████    | 6/10 [00:07<00:06,  1.59s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.728, 'hit_ratio@10': 0.5466, 'ndcg@10': 0.2366, 'compress@10': 1.0, 'time@10': 1.8869}:  60%|██████    | 6/10 [00:09<00:06,  1.59s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.728, 'hit_ratio@10': 0.5466, 'ndcg@10': 0.2366, 'compress@10': 1.0, 'time@10': 1.8869}:  70%|███████   | 7/10 [00:09<00:04,  1.43s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.6654, 'hit_ratio@10': 0.5604, 'ndcg@10': 0.2459, 'compress@10': 1.0, 'time@10': 1.8262}:  70%|███████   | 7/10 [00:10<00:04,  1.43s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.6654, 'hit_ratio@10': 0.5604, 'ndcg@10': 0.2459, 'compress@10': 1.0, 'time@10': 1.8262}:  80%|████████  | 8/10 [00:10<00:02,  1.43s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.6403, 'hit_ratio@10': 0.5616, 'ndcg@10': 0.2506, 'compress@10': 1.0, 'time@10': 1.9525}:  80%|████████  | 8/10 [00:11<00:02,  1.43s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.6403, 'hit_ratio@10': 0.5616, 'ndcg@10': 0.2506, 'compress@10': 1.0, 'time@10': 1.9525}:  90%|█████████ | 9/10 [00:11<00:01,  1.45s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.5909, 'hit_ratio@10': 0.5645, 'ndcg@10': 0.2692, 'compress@10': 1.0, 'time@10': 1.9404}:  90%|█████████ | 9/10 [00:13<00:01,  1.45s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.5909, 'hit_ratio@10': 0.5645, 'ndcg@10': 0.2692, 'compress@10': 1.0, 'time@10': 1.9404}: 100%|██████████| 10/10 [00:13<00:00,  1.57s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.5909, 'hit_ratio@10': 0.5645, 'ndcg@10': 0.2692, 'compress@10': 1.0, 'time@10': 1.9404}: 100%|██████████| 10/10 [00:13<00:00,  1.38s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.5908937427954325
Avg hit ratio: 0.5645468877472273
Avg ndcg: 0.2691593156655827
Avg compression ratio: 1.0
Avg train time: 1.9403693914413451
Std train time: 0.9961646157014884
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.2002, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.4082, 'compress@10': 1.0, 'time@10': 1.6429}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.2002, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.4082, 'compress@10': 1.0, 'time@10': 1.6429}:  10%|█         | 1/10 [00:00<00:07,  1.20it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1152, 'hit_ratio@10': 0.7088, 'ndcg@10': 0.6354, 'compress@10': 1.0, 'time@10': 1.4975}:  10%|█         | 1/10 [00:02<00:07,  1.20it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.1152, 'hit_ratio@10': 0.7088, 'ndcg@10': 0.6354, 'compress@10': 1.0, 'time@10': 1.4975}:  20%|██        | 2/10 [00:02<00:09,  1.15s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.367, 'hit_ratio@10': 0.663, 'ndcg@10': 0.4581, 'compress@10': 1.0, 'time@10': 1.1679}:  20%|██        | 2/10 [00:02<00:09,  1.15s/it]  {'epoch': 4, 'num_users': 5.0, 'loss': 0.367, 'hit_ratio@10': 0.663, 'ndcg@10': 0.4581, 'compress@10': 1.0, 'time@10': 1.1679}:  30%|███       | 3/10 [00:02<00:05,  1.33it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.2857, 'hit_ratio@10': 0.6937, 'ndcg@10': 0.5424, 'compress@10': 1.0, 'time@10': 1.1785}:  30%|███       | 3/10 [00:03<00:05,  1.33it/s]{'epoch': 4, 'num_users': 5.0, 'loss': 0.2857, 'hit_ratio@10': 0.6937, 'ndcg@10': 0.5424, 'compress@10': 1.0, 'time@10': 1.1785}:  40%|████      | 4/10 [00:03<00:05,  1.06it/s]{'epoch': 4, 'num_users': 5.8, 'loss': 0.235, 'hit_ratio@10': 0.731, 'ndcg@10': 0.6054, 'compress@10': 1.0, 'time@10': 1.8723}:  40%|████      | 4/10 [00:06<00:05,  1.06it/s]  {'epoch': 4, 'num_users': 5.8, 'loss': 0.235, 'hit_ratio@10': 0.731, 'ndcg@10': 0.6054, 'compress@10': 1.0, 'time@10': 1.8723}:  50%|█████     | 5/10 [00:06<00:07,  1.45s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.2001, 'hit_ratio@10': 0.7647, 'ndcg@10': 0.6525, 'compress@10': 1.0, 'time@10': 1.8979}:  50%|█████     | 5/10 [00:08<00:07,  1.45s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.2001, 'hit_ratio@10': 0.7647, 'ndcg@10': 0.6525, 'compress@10': 1.0, 'time@10': 1.8979}:  60%|██████    | 6/10 [00:08<00:06,  1.65s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.1807, 'hit_ratio@10': 0.7697, 'ndcg@10': 0.6539, 'compress@10': 1.0, 'time@10': 1.9611}:  60%|██████    | 6/10 [00:09<00:06,  1.65s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.1807, 'hit_ratio@10': 0.7697, 'ndcg@10': 0.6539, 'compress@10': 1.0, 'time@10': 1.9611}:  70%|███████   | 7/10 [00:09<00:04,  1.50s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.1597, 'hit_ratio@10': 0.7878, 'ndcg@10': 0.6759, 'compress@10': 1.0, 'time@10': 1.911}:  70%|███████   | 7/10 [00:10<00:04,  1.50s/it]  {'epoch': 4, 'num_users': 6.125, 'loss': 0.1597, 'hit_ratio@10': 0.7878, 'ndcg@10': 0.6759, 'compress@10': 1.0, 'time@10': 1.911}:  80%|████████  | 8/10 [00:10<00:03,  1.52s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.1445, 'hit_ratio@10': 0.7828, 'ndcg@10': 0.702, 'compress@10': 1.0, 'time@10': 2.0429}:  80%|████████  | 8/10 [00:12<00:03,  1.52s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.1445, 'hit_ratio@10': 0.7828, 'ndcg@10': 0.702, 'compress@10': 1.0, 'time@10': 2.0429}:  90%|█████████ | 9/10 [00:12<00:01,  1.54s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.1307, 'hit_ratio@10': 0.8, 'ndcg@10': 0.7273, 'compress@10': 1.0, 'time@10': 2.0262}:  90%|█████████ | 9/10 [00:14<00:01,  1.54s/it]     {'epoch': 4, 'num_users': 6.3, 'loss': 0.1307, 'hit_ratio@10': 0.8, 'ndcg@10': 0.7273, 'compress@10': 1.0, 'time@10': 2.0262}: 100%|██████████| 10/10 [00:14<00:00,  1.65s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.1307, 'hit_ratio@10': 0.8, 'ndcg@10': 0.7273, 'compress@10': 1.0, 'time@10': 2.0262}: 100%|██████████| 10/10 [00:14<00:00,  1.43s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.13066281978222719
Avg hit ratio: 0.799982154800491
Avg ndcg: 0.7272714505635818
Avg compression ratio: 1.0
Avg train time: 2.0262186527252197
Std train time: 1.0921307230131305
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9127, 'compress@10': 1.0, 'time@10': 1.7045}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9127, 'compress@10': 1.0, 'time@10': 1.7045}:  10%|█         | 1/10 [00:00<00:07,  1.15it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9277, 'compress@10': 1.0, 'time@10': 1.5015}:  10%|█         | 1/10 [00:02<00:07,  1.15it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9277, 'compress@10': 1.0, 'time@10': 1.5015}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0626, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.7596, 'compress@10': 1.0, 'time@10': 1.1663}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0626, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.7596, 'compress@10': 1.0, 'time@10': 1.1663}:  30%|███       | 3/10 [00:02<00:05,  1.36it/s]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0495, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.803, 'compress@10': 1.0, 'time@10': 1.174}:  30%|███       | 3/10 [00:03<00:05,  1.36it/s]  {'epoch': 5, 'num_users': 5.0, 'loss': 0.0495, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.803, 'compress@10': 1.0, 'time@10': 1.174}:  40%|████      | 4/10 [00:03<00:05,  1.08it/s]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0436, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8247, 'compress@10': 1.0, 'time@10': 1.8323}:  40%|████      | 4/10 [00:05<00:05,  1.08it/s]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0436, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8247, 'compress@10': 1.0, 'time@10': 1.8323}:  50%|█████     | 5/10 [00:05<00:07,  1.40s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0375, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8466, 'compress@10': 1.0, 'time@10': 1.8607}:  50%|█████     | 5/10 [00:07<00:07,  1.40s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0375, 'hit_ratio@10': 0.8824, 'ndcg@10': 0.8466, 'compress@10': 1.0, 'time@10': 1.8607}:  60%|██████    | 6/10 [00:07<00:06,  1.61s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0331, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.8597, 'compress@10': 1.0, 'time@10': 1.8954}:  60%|██████    | 6/10 [00:08<00:06,  1.61s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0331, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.8597, 'compress@10': 1.0, 'time@10': 1.8954}:  70%|███████   | 7/10 [00:08<00:04,  1.43s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0294, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.8726, 'compress@10': 1.0, 'time@10': 1.844}:  70%|███████   | 7/10 [00:10<00:04,  1.43s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.0294, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.8726, 'compress@10': 1.0, 'time@10': 1.844}:  80%|████████  | 8/10 [00:10<00:02,  1.45s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.027, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.8824, 'compress@10': 1.0, 'time@10': 1.9834}:  80%|████████  | 8/10 [00:12<00:02,  1.45s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.027, 'hit_ratio@10': 0.8822, 'ndcg@10': 0.8824, 'compress@10': 1.0, 'time@10': 1.9834}:  90%|█████████ | 9/10 [00:12<00:01,  1.49s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0245, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 1.9765}:  90%|█████████ | 9/10 [00:13<00:01,  1.49s/it]  {'epoch': 5, 'num_users': 6.3, 'loss': 0.0245, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 1.9765}: 100%|██████████| 10/10 [00:13<00:00,  1.63s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0245, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.8913, 'compress@10': 1.0, 'time@10': 1.9765}: 100%|██████████| 10/10 [00:13<00:00,  1.40s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.02449489604490922
Avg hit ratio: 0.891744196757779
Avg ndcg: 0.8912541509186618
Avg compression ratio: 1.0
Avg train time: 1.9765474796295166
Std train time: 1.0513038915966089
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0049, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 1.5653}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0049, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 1.5653}:  10%|█         | 1/10 [00:00<00:07,  1.26it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9494, 'compress@10': 1.0, 'time@10': 1.4197}:  10%|█         | 1/10 [00:02<00:07,  1.26it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9494, 'compress@10': 1.0, 'time@10': 1.4197}:  20%|██        | 2/10 [00:02<00:08,  1.09s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9049, 'compress@10': 1.0, 'time@10': 1.0982}:  20%|██        | 2/10 [00:02<00:08,  1.09s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0079, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9049, 'compress@10': 1.0, 'time@10': 1.0982}:  30%|███       | 3/10 [00:02<00:04,  1.43it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9168, 'compress@10': 1.0, 'time@10': 1.1237}:  30%|███       | 3/10 [00:03<00:04,  1.43it/s]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0078, 'hit_ratio@10': 0.8224, 'ndcg@10': 0.9168, 'compress@10': 1.0, 'time@10': 1.1237}:  40%|████      | 4/10 [00:03<00:05,  1.10it/s]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9206, 'compress@10': 1.0, 'time@10': 1.7675}:  40%|████      | 4/10 [00:05<00:05,  1.10it/s]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9206, 'compress@10': 1.0, 'time@10': 1.7675}:  50%|█████     | 5/10 [00:05<00:06,  1.37s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9285, 'compress@10': 1.0, 'time@10': 1.8004}:  50%|█████     | 5/10 [00:07<00:06,  1.37s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9285, 'compress@10': 1.0, 'time@10': 1.8004}:  60%|██████    | 6/10 [00:07<00:06,  1.58s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.932, 'compress@10': 1.0, 'time@10': 1.8609}:  60%|██████    | 6/10 [00:08<00:06,  1.58s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.8836, 'ndcg@10': 0.932, 'compress@10': 1.0, 'time@10': 1.8609}:  70%|███████   | 7/10 [00:08<00:04,  1.43s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0071, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9366, 'compress@10': 1.0, 'time@10': 1.814}:  70%|███████   | 7/10 [00:10<00:04,  1.43s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0071, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9366, 'compress@10': 1.0, 'time@10': 1.814}:  80%|████████  | 8/10 [00:10<00:03,  1.54s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.007, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9394, 'compress@10': 1.0, 'time@10': 1.9666}:  80%|████████  | 8/10 [00:12<00:03,  1.54s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.007, 'hit_ratio@10': 0.8809, 'ndcg@10': 0.9394, 'compress@10': 1.0, 'time@10': 1.9666}:  90%|█████████ | 9/10 [00:12<00:01,  1.56s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0065, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9427, 'compress@10': 1.0, 'time@10': 1.9531}:  90%|█████████ | 9/10 [00:14<00:01,  1.56s/it]  {'epoch': 6, 'num_users': 6.3, 'loss': 0.0065, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9427, 'compress@10': 1.0, 'time@10': 1.9531}: 100%|██████████| 10/10 [00:14<00:00,  1.65s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0065, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9427, 'compress@10': 1.0, 'time@10': 1.9531}: 100%|██████████| 10/10 [00:14<00:00,  1.41s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.006522798961349328
Avg hit ratio: 0.8905219745355568
Avg ndcg: 0.9426988494519819
Avg compression ratio: 1.0
Avg train time: 1.9531190395355225
Std train time: 1.0470411088875802
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0035, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9513, 'compress@10': 1.0, 'time@10': 1.5794}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0035, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9513, 'compress@10': 1.0, 'time@10': 1.5794}:  10%|█         | 1/10 [00:00<00:07,  1.24it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9591, 'compress@10': 1.0, 'time@10': 1.476}:  10%|█         | 1/10 [00:02<00:07,  1.24it/s]  {'epoch': 7, 'num_users': 7.0, 'loss': 0.006, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9591, 'compress@10': 1.0, 'time@10': 1.476}:  20%|██        | 2/10 [00:02<00:09,  1.15s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9251, 'compress@10': 1.0, 'time@10': 1.1597}:  20%|██        | 2/10 [00:02<00:09,  1.15s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.9251, 'compress@10': 1.0, 'time@10': 1.1597}:  30%|███       | 3/10 [00:02<00:05,  1.33it/s]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.9351, 'compress@10': 1.0, 'time@10': 1.1872}:  30%|███       | 3/10 [00:03<00:05,  1.33it/s]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.8343, 'ndcg@10': 0.9351, 'compress@10': 1.0, 'time@10': 1.1872}:  40%|████      | 4/10 [00:03<00:05,  1.04it/s]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9411, 'compress@10': 1.0, 'time@10': 1.8534}:  40%|████      | 4/10 [00:06<00:05,  1.04it/s]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0073, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9411, 'compress@10': 1.0, 'time@10': 1.8534}:  50%|█████     | 5/10 [00:06<00:07,  1.44s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 1.911}:  50%|█████     | 5/10 [00:08<00:07,  1.44s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.007, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 1.911}:  60%|██████    | 6/10 [00:08<00:06,  1.70s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0064, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 1.942}:  60%|██████    | 6/10 [00:09<00:06,  1.70s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0064, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 1.942}:  70%|███████   | 7/10 [00:09<00:04,  1.50s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0059, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9529, 'compress@10': 1.0, 'time@10': 1.8807}:  70%|███████   | 7/10 [00:10<00:04,  1.50s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0059, 'hit_ratio@10': 0.9005, 'ndcg@10': 0.9529, 'compress@10': 1.0, 'time@10': 1.8807}:  80%|████████  | 8/10 [00:10<00:02,  1.49s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0063, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.955, 'compress@10': 1.0, 'time@10': 2.0038}:  80%|████████  | 8/10 [00:12<00:02,  1.49s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0063, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.955, 'compress@10': 1.0, 'time@10': 2.0038}:  90%|█████████ | 9/10 [00:12<00:01,  1.49s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9571, 'compress@10': 1.0, 'time@10': 2.0033}:  90%|█████████ | 9/10 [00:14<00:01,  1.49s/it]  {'epoch': 7, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9571, 'compress@10': 1.0, 'time@10': 2.0033}: 100%|██████████| 10/10 [00:14<00:00,  1.65s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9571, 'compress@10': 1.0, 'time@10': 2.0033}: 100%|██████████| 10/10 [00:14<00:00,  1.43s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.005929085437062679
Avg hit ratio: 0.8867104295440459
Avg ndcg: 0.9571475614553441
Avg compression ratio: 1.0
Avg train time: 2.0033185720443725
Std train time: 1.0462997052890683
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0029, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9906, 'compress@10': 1.0, 'time@10': 1.5806}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0029, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9906, 'compress@10': 1.0, 'time@10': 1.5806}:  10%|█         | 1/10 [00:00<00:07,  1.24it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9834, 'compress@10': 1.0, 'time@10': 1.5048}:  10%|█         | 1/10 [00:02<00:07,  1.24it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0068, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9834, 'compress@10': 1.0, 'time@10': 1.5048}:  20%|██        | 2/10 [00:02<00:09,  1.18s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9413, 'compress@10': 1.0, 'time@10': 1.1815}:  20%|██        | 2/10 [00:02<00:09,  1.18s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9413, 'compress@10': 1.0, 'time@10': 1.1815}:  30%|███       | 3/10 [00:02<00:05,  1.29it/s]{'epoch': 8, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9503, 'compress@10': 1.0, 'time@10': 1.1883}:  30%|███       | 3/10 [00:03<00:05,  1.29it/s] {'epoch': 8, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.9503, 'compress@10': 1.0, 'time@10': 1.1883}:  40%|████      | 4/10 [00:03<00:05,  1.05it/s]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9615, 'compress@10': 1.0, 'time@10': 1.8607}:  40%|████      | 4/10 [00:06<00:05,  1.05it/s]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.9615, 'compress@10': 1.0, 'time@10': 1.8607}:  50%|█████     | 5/10 [00:06<00:07,  1.43s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9655, 'compress@10': 1.0, 'time@10': 1.8911}:  50%|█████     | 5/10 [00:08<00:07,  1.43s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9655, 'compress@10': 1.0, 'time@10': 1.8911}:  60%|██████    | 6/10 [00:08<00:06,  1.65s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9655, 'compress@10': 1.0, 'time@10': 1.932}:  60%|██████    | 6/10 [00:09<00:06,  1.65s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9655, 'compress@10': 1.0, 'time@10': 1.932}:  70%|███████   | 7/10 [00:09<00:04,  1.47s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9676, 'compress@10': 1.0, 'time@10': 1.8772}:  70%|███████   | 7/10 [00:10<00:04,  1.47s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0083, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9676, 'compress@10': 1.0, 'time@10': 1.8772}:  80%|████████  | 8/10 [00:10<00:02,  1.48s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9688, 'compress@10': 1.0, 'time@10': 2.029}:  80%|████████  | 8/10 [00:12<00:02,  1.48s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0082, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9688, 'compress@10': 1.0, 'time@10': 2.029}:  90%|█████████ | 9/10 [00:12<00:01,  1.53s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0079, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.9705, 'compress@10': 1.0, 'time@10': 2.0117}:  90%|█████████ | 9/10 [00:14<00:01,  1.53s/it]  {'epoch': 8, 'num_users': 6.3, 'loss': 0.0079, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.9705, 'compress@10': 1.0, 'time@10': 2.0117}: 100%|██████████| 10/10 [00:14<00:00,  1.64s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0079, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.9705, 'compress@10': 1.0, 'time@10': 2.0117}: 100%|██████████| 10/10 [00:14<00:00,  1.42s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.007929646149997808
Avg hit ratio: 0.8838302452122486
Avg ndcg: 0.9705180683498945
Avg compression ratio: 1.0
Avg train time: 2.011728358268738
Std train time: 1.0785910392160536
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0034, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9797, 'compress@10': 1.0, 'time@10': 1.6473}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0034, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9797, 'compress@10': 1.0, 'time@10': 1.6473}:  10%|█         | 1/10 [00:00<00:07,  1.19it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9887, 'compress@10': 1.0, 'time@10': 1.5229}:  10%|█         | 1/10 [00:02<00:07,  1.19it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9887, 'compress@10': 1.0, 'time@10': 1.5229}:  20%|██        | 2/10 [00:02<00:09,  1.18s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9448, 'compress@10': 1.0, 'time@10': 1.1745}:  20%|██        | 2/10 [00:02<00:09,  1.18s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9448, 'compress@10': 1.0, 'time@10': 1.1745}:  30%|███       | 3/10 [00:02<00:05,  1.32it/s]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.7914, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 1.1651}:  30%|███       | 3/10 [00:03<00:05,  1.32it/s]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0118, 'hit_ratio@10': 0.7914, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 1.1651}:  40%|████      | 4/10 [00:03<00:05,  1.10it/s]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.978, 'compress@10': 1.0, 'time@10': 1.8636}:  40%|████      | 4/10 [00:06<00:05,  1.10it/s] {'epoch': 9, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8291, 'ndcg@10': 0.978, 'compress@10': 1.0, 'time@10': 1.8636}:  50%|█████     | 5/10 [00:06<00:07,  1.43s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9851, 'compress@10': 1.0, 'time@10': 1.8824}:  50%|█████     | 5/10 [00:07<00:07,  1.43s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9851, 'compress@10': 1.0, 'time@10': 1.8824}:  60%|██████    | 6/10 [00:07<00:06,  1.62s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9822, 'compress@10': 1.0, 'time@10': 1.9187}:  60%|██████    | 6/10 [00:09<00:06,  1.62s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0181, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9822, 'compress@10': 1.0, 'time@10': 1.9187}:  70%|███████   | 7/10 [00:09<00:04,  1.44s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9837, 'compress@10': 1.0, 'time@10': 1.862}:  70%|███████   | 7/10 [00:10<00:04,  1.44s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0176, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9837, 'compress@10': 1.0, 'time@10': 1.862}:  80%|████████  | 8/10 [00:10<00:02,  1.46s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9842, 'compress@10': 1.0, 'time@10': 2.0005}:  80%|████████  | 8/10 [00:12<00:02,  1.46s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8385, 'ndcg@10': 0.9842, 'compress@10': 1.0, 'time@10': 2.0005}:  90%|█████████ | 9/10 [00:12<00:01,  1.49s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9875, 'compress@10': 1.0, 'time@10': 1.9965}:  90%|█████████ | 9/10 [00:14<00:01,  1.49s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9875, 'compress@10': 1.0, 'time@10': 1.9965}: 100%|██████████| 10/10 [00:14<00:00,  1.64s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8524, 'ndcg@10': 0.9875, 'compress@10': 1.0, 'time@10': 1.9965}: 100%|██████████| 10/10 [00:14<00:00,  1.41s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.019400803435680847
Avg hit ratio: 0.852401673783677
Avg ndcg: 0.9875220719962682
Avg compression ratio: 1.0
Avg train time: 1.9964857578277588
Std train time: 1.1021729216045302
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9742, 'compress@10': 1.0, 'time@10': 1.6461}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0041, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9742, 'compress@10': 1.0, 'time@10': 1.6461}:  10%|█         | 1/10 [00:00<00:07,  1.19it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8345, 'ndcg@10': 1.0095, 'compress@10': 1.0, 'time@10': 1.475}:  10%|█         | 1/10 [00:02<00:07,  1.19it/s] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.8345, 'ndcg@10': 1.0095, 'compress@10': 1.0, 'time@10': 1.475}:  20%|██        | 2/10 [00:02<00:08,  1.12s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.976, 'compress@10': 1.0, 'time@10': 1.1599}:  20%|██        | 2/10 [00:02<00:08,  1.12s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0173, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.976, 'compress@10': 1.0, 'time@10': 1.1599}:  30%|███       | 3/10 [00:02<00:05,  1.36it/s]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.7744, 'ndcg@10': 0.9816, 'compress@10': 1.0, 'time@10': 1.1606}:  30%|███       | 3/10 [00:03<00:05,  1.36it/s]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.7744, 'ndcg@10': 0.9816, 'compress@10': 1.0, 'time@10': 1.1606}:  40%|████      | 4/10 [00:03<00:05,  1.09it/s]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0528, 'hit_ratio@10': 0.8155, 'ndcg@10': 1.6866, 'compress@10': 1.0, 'time@10': 1.8016}:  40%|████      | 4/10 [00:05<00:05,  1.09it/s]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0528, 'hit_ratio@10': 0.8155, 'ndcg@10': 1.6866, 'compress@10': 1.0, 'time@10': 1.8016}:  50%|█████     | 5/10 [00:05<00:06,  1.38s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0603, 'hit_ratio@10': 0.8351, 'ndcg@10': 1.585, 'compress@10': 1.0, 'time@10': 1.827}:  50%|█████     | 5/10 [00:07<00:06,  1.38s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0603, 'hit_ratio@10': 0.8351, 'ndcg@10': 1.585, 'compress@10': 1.0, 'time@10': 1.827}:  60%|██████    | 6/10 [00:07<00:06,  1.58s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0522, 'hit_ratio@10': 0.853, 'ndcg@10': 1.4967, 'compress@10': 1.0, 'time@10': 1.89}:  60%|██████    | 6/10 [00:08<00:06,  1.58s/it] {'epoch': 10, 'num_users': 6.2857, 'loss': 0.0522, 'hit_ratio@10': 0.853, 'ndcg@10': 1.4967, 'compress@10': 1.0, 'time@10': 1.89}:  70%|███████   | 7/10 [00:08<00:04,  1.44s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0481, 'hit_ratio@10': 0.8642, 'ndcg@10': 1.4369, 'compress@10': 1.0, 'time@10': 1.8313}:  70%|███████   | 7/10 [00:10<00:04,  1.44s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0481, 'hit_ratio@10': 0.8642, 'ndcg@10': 1.4369, 'compress@10': 1.0, 'time@10': 1.8313}:  80%|████████  | 8/10 [00:10<00:02,  1.44s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0468, 'hit_ratio@10': 0.838, 'ndcg@10': 1.3878, 'compress@10': 1.0, 'time@10': 1.9747}:  80%|████████  | 8/10 [00:11<00:02,  1.44s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0468, 'hit_ratio@10': 0.838, 'ndcg@10': 1.3878, 'compress@10': 1.0, 'time@10': 1.9747}:  90%|█████████ | 9/10 [00:11<00:01,  1.48s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0479, 'hit_ratio@10': 0.852, 'ndcg@10': 1.3511, 'compress@10': 1.0, 'time@10': 1.9649}:  90%|█████████ | 9/10 [00:13<00:01,  1.48s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0479, 'hit_ratio@10': 0.852, 'ndcg@10': 1.3511, 'compress@10': 1.0, 'time@10': 1.9649}: 100%|██████████| 10/10 [00:13<00:00,  1.61s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0479, 'hit_ratio@10': 0.852, 'ndcg@10': 1.3511, 'compress@10': 1.0, 'time@10': 1.9649}: 100%|██████████| 10/10 [00:13<00:00,  1.39s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.04787608595650876
Avg hit ratio: 0.851953645109842
Avg ndcg: 1.351142982783675
Avg compression ratio: 1.0
Avg train time: 1.9649036884307862
Std train time: 1.0363974128530793
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9827, 'compress@10': 1.0, 'time@10': 1.5998}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9827, 'compress@10': 1.0, 'time@10': 1.5998}:  10%|█         | 1/10 [00:00<00:07,  1.23it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0513, 'hit_ratio@10': 0.8608, 'ndcg@10': 1.0855, 'compress@10': 1.0, 'time@10': 1.4588}:  10%|█         | 1/10 [00:02<00:07,  1.23it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0513, 'hit_ratio@10': 0.8608, 'ndcg@10': 1.0855, 'compress@10': 1.0, 'time@10': 1.4588}:  20%|██        | 2/10 [00:02<00:08,  1.12s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.053, 'hit_ratio@10': 0.7643, 'ndcg@10': 1.1162, 'compress@10': 1.0, 'time@10': 1.1345}:  20%|██        | 2/10 [00:02<00:08,  1.12s/it] {'epoch': 11, 'num_users': 5.0, 'loss': 0.053, 'hit_ratio@10': 0.7643, 'ndcg@10': 1.1162, 'compress@10': 1.0, 'time@10': 1.1345}:  30%|███       | 3/10 [00:02<00:05,  1.38it/s]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0512, 'hit_ratio@10': 0.7965, 'ndcg@10': 1.0807, 'compress@10': 1.0, 'time@10': 1.1388}:  30%|███       | 3/10 [00:03<00:05,  1.38it/s]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0512, 'hit_ratio@10': 0.7965, 'ndcg@10': 1.0807, 'compress@10': 1.0, 'time@10': 1.1388}:  40%|████      | 4/10 [00:03<00:05,  1.11it/s]{'epoch': 11, 'num_users': 5.8, 'loss': 0.1343, 'hit_ratio@10': 0.8292, 'ndcg@10': 1.2655, 'compress@10': 1.0, 'time@10': 1.8047}:  40%|████      | 4/10 [00:05<00:05,  1.11it/s]{'epoch': 11, 'num_users': 5.8, 'loss': 0.1343, 'hit_ratio@10': 0.8292, 'ndcg@10': 1.2655, 'compress@10': 1.0, 'time@10': 1.8047}:  50%|█████     | 5/10 [00:05<00:06,  1.39s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.1701, 'hit_ratio@10': 0.8317, 'ndcg@10': 1.2497, 'compress@10': 1.0, 'time@10': 1.832}:  50%|█████     | 5/10 [00:07<00:06,  1.39s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.1701, 'hit_ratio@10': 0.8317, 'ndcg@10': 1.2497, 'compress@10': 1.0, 'time@10': 1.832}:  60%|██████    | 6/10 [00:07<00:06,  1.59s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.1492, 'hit_ratio@10': 0.85, 'ndcg@10': 1.2227, 'compress@10': 1.0, 'time@10': 1.8903}:  60%|██████    | 6/10 [00:08<00:06,  1.59s/it] {'epoch': 11, 'num_users': 6.2857, 'loss': 0.1492, 'hit_ratio@10': 0.85, 'ndcg@10': 1.2227, 'compress@10': 1.0, 'time@10': 1.8903}:  70%|███████   | 7/10 [00:08<00:04,  1.44s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.138, 'hit_ratio@10': 0.8616, 'ndcg@10': 1.2009, 'compress@10': 1.0, 'time@10': 1.8419}:  70%|███████   | 7/10 [00:10<00:04,  1.44s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.138, 'hit_ratio@10': 0.8616, 'ndcg@10': 1.2009, 'compress@10': 1.0, 'time@10': 1.8419}:  80%|████████  | 8/10 [00:10<00:02,  1.47s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.146, 'hit_ratio@10': 0.8389, 'ndcg@10': 1.177, 'compress@10': 1.0, 'time@10': 1.9762}:  80%|████████  | 8/10 [00:12<00:02,  1.47s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.146, 'hit_ratio@10': 0.8389, 'ndcg@10': 1.177, 'compress@10': 1.0, 'time@10': 1.9762}:  90%|█████████ | 9/10 [00:12<00:01,  1.49s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.1446, 'hit_ratio@10': 0.8459, 'ndcg@10': 1.1677, 'compress@10': 1.0, 'time@10': 1.9688}:  90%|█████████ | 9/10 [00:13<00:01,  1.49s/it] {'epoch': 11, 'num_users': 6.3, 'loss': 0.1446, 'hit_ratio@10': 0.8459, 'ndcg@10': 1.1677, 'compress@10': 1.0, 'time@10': 1.9688}: 100%|██████████| 10/10 [00:13<00:00,  1.62s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.1446, 'hit_ratio@10': 0.8459, 'ndcg@10': 1.1677, 'compress@10': 1.0, 'time@10': 1.9688}: 100%|██████████| 10/10 [00:13<00:00,  1.39s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.1445615304926058
Avg hit ratio: 0.8459383037260796
Avg ndcg: 1.167658643896353
Avg compression ratio: 1.0
Avg train time: 1.9688137531280518
Std train time: 1.0554352705315813
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9573, 'compress@10': 1.0, 'time@10': 1.8274}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9573, 'compress@10': 1.0, 'time@10': 1.8274}:  10%|█         | 1/10 [00:00<00:08,  1.04it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.2078, 'hit_ratio@10': 0.9092, 'ndcg@10': 5.3206, 'compress@10': 1.0, 'time@10': 1.5952}:  10%|█         | 1/10 [00:02<00:08,  1.04it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.2078, 'hit_ratio@10': 0.9092, 'ndcg@10': 5.3206, 'compress@10': 1.0, 'time@10': 1.5952}:  20%|██        | 2/10 [00:02<00:09,  1.21s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.1637, 'hit_ratio@10': 0.8442, 'ndcg@10': 3.8448, 'compress@10': 1.0, 'time@10': 1.2324}:  20%|██        | 2/10 [00:02<00:09,  1.21s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.1637, 'hit_ratio@10': 0.8442, 'ndcg@10': 3.8448, 'compress@10': 1.0, 'time@10': 1.2324}:  30%|███       | 3/10 [00:02<00:05,  1.28it/s]{'epoch': 12, 'num_users': 5.0, 'loss': 0.1773, 'hit_ratio@10': 0.8207, 'ndcg@10': 3.1268, 'compress@10': 1.0, 'time@10': 1.2193}:  30%|███       | 3/10 [00:03<00:05,  1.28it/s]{'epoch': 12, 'num_users': 5.0, 'loss': 0.1773, 'hit_ratio@10': 0.8207, 'ndcg@10': 3.1268, 'compress@10': 1.0, 'time@10': 1.2193}:  40%|████      | 4/10 [00:03<00:05,  1.06it/s]/slstore/shihongjian/Federated-Recommendation-Neural-Collaborative-Filtering/metrics.py:20: RuntimeWarning: overflow encountered in power
  dcg_numerator = np.power(2, predicted_recommendation_best_10) - 1
{'epoch': 12, 'num_users': 5.8, 'loss': 0.476, 'hit_ratio@10': 0.8405, 'ndcg@10': 113546.9248, 'compress@10': 1.0, 'time@10': 1.8569}:  40%|████      | 4/10 [00:06<00:05,  1.06it/s]{'epoch': 12, 'num_users': 5.8, 'loss': 0.476, 'hit_ratio@10': 0.8405, 'ndcg@10': 113546.9248, 'compress@10': 1.0, 'time@10': 1.8569}:  50%|█████     | 5/10 [00:06<00:07,  1.40s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.5506, 'hit_ratio@10': 0.8301, 'ndcg@10': 94624.0191, 'compress@10': 1.0, 'time@10': 1.8907}:  50%|█████     | 5/10 [00:08<00:07,  1.40s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.5506, 'hit_ratio@10': 0.8301, 'ndcg@10': 94624.0191, 'compress@10': 1.0, 'time@10': 1.8907}:  60%|██████    | 6/10 [00:08<00:06,  1.63s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.5064, 'hit_ratio@10': 0.8486, 'ndcg@10': 81109.9551, 'compress@10': 1.0, 'time@10': 1.9274}:  60%|██████    | 6/10 [00:09<00:06,  1.63s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.5064, 'hit_ratio@10': 0.8486, 'ndcg@10': 81109.9551, 'compress@10': 1.0, 'time@10': 1.9274}:  70%|███████   | 7/10 [00:09<00:04,  1.45s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.4897, 'hit_ratio@10': 0.8604, 'ndcg@10': 70977.4805, 'compress@10': 1.0, 'time@10': 1.875}:  70%|███████   | 7/10 [00:10<00:04,  1.45s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.4897, 'hit_ratio@10': 0.8604, 'ndcg@10': 70977.4805, 'compress@10': 1.0, 'time@10': 1.875}:  80%|████████  | 8/10 [00:10<00:02,  1.48s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.4826, 'hit_ratio@10': 0.841, 'ndcg@10': 63237.6144, 'compress@10': 1.0, 'time@10': 2.0229}:  80%|████████  | 8/10 [00:12<00:02,  1.48s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.4826, 'hit_ratio@10': 0.841, 'ndcg@10': 63237.6144, 'compress@10': 1.0, 'time@10': 2.0229}:  90%|█████████ | 9/10 [00:12<00:01,  1.52s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.4863, 'hit_ratio@10': 0.8455, 'ndcg@10': 56914.7284, 'compress@10': 1.0, 'time@10': 2.009}:  90%|█████████ | 9/10 [00:14<00:01,  1.52s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.4863, 'hit_ratio@10': 0.8455, 'ndcg@10': 56914.7284, 'compress@10': 1.0, 'time@10': 2.009}: 100%|██████████| 10/10 [00:14<00:00,  1.64s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.4863, 'hit_ratio@10': 0.8455, 'ndcg@10': 56914.7284, 'compress@10': 1.0, 'time@10': 2.009}: 100%|██████████| 10/10 [00:14<00:00,  1.42s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.48628444477828114
Avg hit ratio: 0.8455334719986671
Avg ndcg: 56914.728392983416
Avg compression ratio: 1.0
Avg train time: 2.009015917778015
Std train time: 1.0424989498992483
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.3362, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.956, 'compress@10': 1.0, 'time@10': 1.6197}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.3362, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.956, 'compress@10': 1.0, 'time@10': 1.6197}:  10%|█         | 1/10 [00:00<00:07,  1.21it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 1.2342, 'hit_ratio@10': 0.8608, 'ndcg@10': 257857751493.4961, 'compress@10': 1.0, 'time@10': 1.4986}:  10%|█         | 1/10 [00:02<00:07,  1.21it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 1.2342, 'hit_ratio@10': 0.8608, 'ndcg@10': 257857751493.4961, 'compress@10': 1.0, 'time@10': 1.4986}:  20%|██        | 2/10 [00:02<00:09,  1.16s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.8658, 'hit_ratio@10': 0.8119, 'ndcg@10': 171905167662.6699, 'compress@10': 1.0, 'time@10': 1.1561}:  20%|██        | 2/10 [00:02<00:09,  1.16s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.8658, 'hit_ratio@10': 0.8119, 'ndcg@10': 171905167662.6699, 'compress@10': 1.0, 'time@10': 1.1561}:  30%|███       | 3/10 [00:02<00:05,  1.33it/s]{'epoch': 13, 'num_users': 5.0, 'loss': 1.0031, 'hit_ratio@10': 0.8054, 'ndcg@10': 128928935886.4182, 'compress@10': 1.0, 'time@10': 1.1565}:  30%|███       | 3/10 [00:03<00:05,  1.33it/s]{'epoch': 13, 'num_users': 5.0, 'loss': 1.0031, 'hit_ratio@10': 0.8054, 'ndcg@10': 128928935886.4182, 'compress@10': 1.0, 'time@10': 1.1565}:  40%|████      | 4/10 [00:03<00:05,  1.09it/s]{'epoch': 13, 'num_users': 5.8, 'loss': 1.4222, 'hit_ratio@10': 0.8123, 'ndcg@10': 103143149769.275, 'compress@10': 1.0, 'time@10': 1.8249}:  40%|████      | 4/10 [00:05<00:05,  1.09it/s] {'epoch': 13, 'num_users': 5.8, 'loss': 1.4222, 'hit_ratio@10': 0.8123, 'ndcg@10': 103143149769.275, 'compress@10': 1.0, 'time@10': 1.8249}:  50%|█████     | 5/10 [00:05<00:07,  1.40s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 2.0219, 'hit_ratio@10': 0.7843, 'ndcg@10': 85972957964.3684, 'compress@10': 1.0, 'time@10': 1.8625}:  50%|█████     | 5/10 [00:07<00:07,  1.40s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 2.0219, 'hit_ratio@10': 0.7843, 'ndcg@10': 85972957964.3684, 'compress@10': 1.0, 'time@10': 1.8625}:  60%|██████    | 6/10 [00:07<00:06,  1.63s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 1.8796, 'hit_ratio@10': 0.8037, 'ndcg@10': 73691121152.6861, 'compress@10': 1.0, 'time@10': 1.8866}:  60%|██████    | 6/10 [00:09<00:06,  1.63s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 1.8796, 'hit_ratio@10': 0.8037, 'ndcg@10': 73691121152.6861, 'compress@10': 1.0, 'time@10': 1.8866}:  70%|███████   | 7/10 [00:09<00:04,  1.43s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 1.7528, 'hit_ratio@10': 0.8247, 'ndcg@10': 64479741118.4198, 'compress@10': 1.0, 'time@10': 1.8366}:  70%|███████   | 7/10 [00:10<00:04,  1.43s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 1.7528, 'hit_ratio@10': 0.8247, 'ndcg@10': 64479741118.4198, 'compress@10': 1.0, 'time@10': 1.8366}:  80%|████████  | 8/10 [00:10<00:02,  1.45s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 1.7218, 'hit_ratio@10': 0.7997, 'ndcg@10': 57316220897.5998, 'compress@10': 1.0, 'time@10': 1.9676}:  80%|████████  | 8/10 [00:12<00:02,  1.45s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 1.7218, 'hit_ratio@10': 0.7997, 'ndcg@10': 57316220897.5998, 'compress@10': 1.0, 'time@10': 1.9676}:  90%|█████████ | 9/10 [00:12<00:01,  1.48s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 1.7633, 'hit_ratio@10': 0.8084, 'ndcg@10': 51584599094.4806, 'compress@10': 1.0, 'time@10': 1.956}:  90%|█████████ | 9/10 [00:13<00:01,  1.48s/it]    {'epoch': 13, 'num_users': 6.3, 'loss': 1.7633, 'hit_ratio@10': 0.8084, 'ndcg@10': 51584599094.4806, 'compress@10': 1.0, 'time@10': 1.956}: 100%|██████████| 10/10 [00:13<00:00,  1.60s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 1.7633, 'hit_ratio@10': 0.8084, 'ndcg@10': 51584599094.4806, 'compress@10': 1.0, 'time@10': 1.956}: 100%|██████████| 10/10 [00:13<00:00,  1.39s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 1.7633397540974607
Avg hit ratio: 0.8083798621676381
Avg ndcg: 51584599094.480606
Avg compression ratio: 1.0
Avg train time: 1.9559582948684693
Std train time: 1.0545376863378635
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.7601, 'hit_ratio@10': 0.7895, 'ndcg@10': 78124.8172, 'compress@10': 1.0, 'time@10': 1.6822}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.7601, 'hit_ratio@10': 0.7895, 'ndcg@10': 78124.8172, 'compress@10': 1.0, 'time@10': 1.6822}:  10%|█         | 1/10 [00:00<00:07,  1.17it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 2.89, 'hit_ratio@10': 0.798, 'ndcg@10': 39074.1328, 'compress@10': 1.0, 'time@10': 1.5216}:  10%|█         | 1/10 [00:02<00:07,  1.17it/s]   {'epoch': 14, 'num_users': 7.0, 'loss': 2.89, 'hit_ratio@10': 0.798, 'ndcg@10': 39074.1328, 'compress@10': 1.0, 'time@10': 1.5216}:  20%|██        | 2/10 [00:02<00:09,  1.16s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 2.0236, 'hit_ratio@10': 0.7225, 'ndcg@10': 26049.8612, 'compress@10': 1.0, 'time@10': 1.175}:  20%|██        | 2/10 [00:02<00:09,  1.16s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 2.0236, 'hit_ratio@10': 0.7225, 'ndcg@10': 26049.8612, 'compress@10': 1.0, 'time@10': 1.175}:  30%|███       | 3/10 [00:02<00:05,  1.34it/s]{'epoch': 14, 'num_users': 5.0, 'loss': 2.4851, 'hit_ratio@10': 0.7293, 'ndcg@10': 72085208.8671, 'compress@10': 1.0, 'time@10': 1.1808}:  30%|███       | 3/10 [00:03<00:05,  1.34it/s]{'epoch': 14, 'num_users': 5.0, 'loss': 2.4851, 'hit_ratio@10': 0.7293, 'ndcg@10': 72085208.8671, 'compress@10': 1.0, 'time@10': 1.1808}:  40%|████      | 4/10 [00:03<00:05,  1.07it/s]{'epoch': 14, 'num_users': 5.8, 'loss': 3.794, 'hit_ratio@10': 0.7235, 'ndcg@10': 1102182294331239.6, 'compress@10': 1.0, 'time@10': 1.8321}:  40%|████      | 4/10 [00:05<00:05,  1.07it/s]{'epoch': 14, 'num_users': 5.8, 'loss': 3.794, 'hit_ratio@10': 0.7235, 'ndcg@10': 1102182294331239.6, 'compress@10': 1.0, 'time@10': 1.8321}:  50%|█████     | 5/10 [00:05<00:07,  1.41s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 4.8578, 'hit_ratio@10': 0.7066, 'ndcg@10': 918485263532015.1, 'compress@10': 1.0, 'time@10': 1.8491}:  50%|█████     | 5/10 [00:07<00:07,  1.41s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 4.8578, 'hit_ratio@10': 0.7066, 'ndcg@10': 918485263532015.1, 'compress@10': 1.0, 'time@10': 1.8491}:  60%|██████    | 6/10 [00:07<00:06,  1.59s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 4.3553, 'hit_ratio@10': 0.7314, 'ndcg@10': 787273083027459.2, 'compress@10': 1.0, 'time@10': 1.8995}:  60%|██████    | 6/10 [00:09<00:06,  1.59s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 4.3553, 'hit_ratio@10': 0.7314, 'ndcg@10': 787273083027459.2, 'compress@10': 1.0, 'time@10': 1.8995}:  70%|███████   | 7/10 [00:09<00:04,  1.44s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 4.2948, 'hit_ratio@10': 0.7542, 'ndcg@10': 688863947649455.1, 'compress@10': 1.0, 'time@10': 1.8487}:  70%|███████   | 7/10 [00:10<00:04,  1.44s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 4.2948, 'hit_ratio@10': 0.7542, 'ndcg@10': 688863947649455.1, 'compress@10': 1.0, 'time@10': 1.8487}:  80%|████████  | 8/10 [00:10<00:02,  1.46s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 4.8686, 'hit_ratio@10': 0.7403, 'ndcg@10': 2710887743033396.0, 'compress@10': 1.0, 'time@10': 1.9959}:  80%|████████  | 8/10 [00:12<00:02,  1.46s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 4.8686, 'hit_ratio@10': 0.7403, 'ndcg@10': 2710887743033396.0, 'compress@10': 1.0, 'time@10': 1.9959}:  90%|█████████ | 9/10 [00:12<00:01,  1.50s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 4.6641, 'hit_ratio@10': 0.7503, 'ndcg@10': 2439798968820482.5, 'compress@10': 1.0, 'time@10': 1.9881}:  90%|█████████ | 9/10 [00:14<00:01,  1.50s/it]   {'epoch': 14, 'num_users': 6.3, 'loss': 4.6641, 'hit_ratio@10': 0.7503, 'ndcg@10': 2439798968820482.5, 'compress@10': 1.0, 'time@10': 1.9881}: 100%|██████████| 10/10 [00:14<00:00,  1.64s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 4.6641, 'hit_ratio@10': 0.7503, 'ndcg@10': 2439798968820482.5, 'compress@10': 1.0, 'time@10': 1.9881}: 100%|██████████| 10/10 [00:14<00:00,  1.41s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 4.664062777155616
Avg hit ratio: 0.750334232453078
Avg ndcg: 2439798968820482.5
Avg compression ratio: 1.0
Avg train time: 1.988093376159668
Std train time: 1.0527196145069102
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.5891, 'hit_ratio@10': 0.8947, 'ndcg@10': 106.7985, 'compress@10': 1.0, 'time@10': 1.5963}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.5891, 'hit_ratio@10': 0.8947, 'ndcg@10': 106.7985, 'compress@10': 1.0, 'time@10': 1.5963}:  10%|█         | 1/10 [00:00<00:07,  1.23it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 3.779, 'hit_ratio@10': 0.6893, 'ndcg@10': 3055200.1801, 'compress@10': 1.0, 'time@10': 1.4925}:  10%|█         | 1/10 [00:02<00:07,  1.23it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 3.779, 'hit_ratio@10': 0.6893, 'ndcg@10': 3055200.1801, 'compress@10': 1.0, 'time@10': 1.4925}:  20%|██        | 2/10 [00:02<00:09,  1.16s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 2.6432, 'hit_ratio@10': 0.65, 'ndcg@10': 2036800.5865, 'compress@10': 1.0, 'time@10': 1.1669}:  20%|██        | 2/10 [00:02<00:09,  1.16s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 2.6432, 'hit_ratio@10': 0.65, 'ndcg@10': 2036800.5865, 'compress@10': 1.0, 'time@10': 1.1669}:  30%|███       | 3/10 [00:02<00:05,  1.33it/s]{'epoch': 15, 'num_users': 5.0, 'loss': 4.6246, 'hit_ratio@10': 0.6482, 'ndcg@10': 4462889074.3937, 'compress@10': 1.0, 'time@10': 1.1843}:  30%|███       | 3/10 [00:03<00:05,  1.33it/s]{'epoch': 15, 'num_users': 5.0, 'loss': 4.6246, 'hit_ratio@10': 0.6482, 'ndcg@10': 4462889074.3937, 'compress@10': 1.0, 'time@10': 1.1843}:  40%|████      | 4/10 [00:03<00:05,  1.05it/s]{'epoch': 15, 'num_users': 5.8, 'loss': 8.2693, 'hit_ratio@10': 0.6826, 'ndcg@10': 7920969892133175.0, 'compress@10': 1.0, 'time@10': 1.8491}:  40%|████      | 4/10 [00:06<00:05,  1.05it/s]{'epoch': 15, 'num_users': 5.8, 'loss': 8.2693, 'hit_ratio@10': 0.6826, 'ndcg@10': 7920969892133175.0, 'compress@10': 1.0, 'time@10': 1.8491}:  50%|█████     | 5/10 [00:06<00:07,  1.43s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 11.6408, 'hit_ratio@10': 0.6466, 'ndcg@10': 6600898512467224.0, 'compress@10': 1.0, 'time@10': 1.8561}:  50%|█████     | 5/10 [00:07<00:07,  1.43s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 11.6408, 'hit_ratio@10': 0.6466, 'ndcg@10': 6600898512467224.0, 'compress@10': 1.0, 'time@10': 1.8561}:  60%|██████    | 6/10 [00:07<00:06,  1.59s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 12.085, 'hit_ratio@10': 0.6399, 'ndcg@10': 5657913010686195.0, 'compress@10': 1.0, 'time@10': 1.8868}:  60%|██████    | 6/10 [00:08<00:06,  1.59s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 12.085, 'hit_ratio@10': 0.6399, 'ndcg@10': 5657913010686195.0, 'compress@10': 1.0, 'time@10': 1.8868}:  70%|███████   | 7/10 [00:08<00:04,  1.41s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 12.0798, 'hit_ratio@10': 0.6385, 'ndcg@10': 2.4355454191074745e+22, 'compress@10': 1.0, 'time@10': 1.8449}:  70%|███████   | 7/10 [00:10<00:04,  1.41s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 12.0798, 'hit_ratio@10': 0.6385, 'ndcg@10': 2.4355454191074745e+22, 'compress@10': 1.0, 'time@10': 1.8449}:  80%|████████  | 8/10 [00:10<00:02,  1.46s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 11.9413, 'hit_ratio@10': 0.6311, 'ndcg@10': 2.16492926144917e+22, 'compress@10': 1.0, 'time@10': 1.9675}:  80%|████████  | 8/10 [00:12<00:02,  1.46s/it] {'epoch': 15, 'num_users': 6.3333, 'loss': 11.9413, 'hit_ratio@10': 0.6311, 'ndcg@10': 2.16492926144917e+22, 'compress@10': 1.0, 'time@10': 1.9675}:  90%|█████████ | 9/10 [00:12<00:01,  1.47s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 11.7366, 'hit_ratio@10': 0.6339, 'ndcg@10': 1.948436335609452e+22, 'compress@10': 1.0, 'time@10': 1.9724}:  90%|█████████ | 9/10 [00:14<00:01,  1.47s/it]  {'epoch': 15, 'num_users': 6.3, 'loss': 11.7366, 'hit_ratio@10': 0.6339, 'ndcg@10': 1.948436335609452e+22, 'compress@10': 1.0, 'time@10': 1.9724}: 100%|██████████| 10/10 [00:14<00:00,  1.64s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 11.7366, 'hit_ratio@10': 0.6339, 'ndcg@10': 1.948436335609452e+22, 'compress@10': 1.0, 'time@10': 1.9724}: 100%|██████████| 10/10 [00:14<00:00,  1.40s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 11.736606528697552
Avg hit ratio: 0.6338651099890489
Avg ndcg: 1.948436335609452e+22
Avg compression ratio: 1.0
Avg train time: 1.972439694404602
Std train time: 1.035699673210365
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 3.5589, 'hit_ratio@10': 0.6316, 'ndcg@10': 38.6324, 'compress@10': 1.0, 'time@10': 1.7092}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 3.5589, 'hit_ratio@10': 0.6316, 'ndcg@10': 38.6324, 'compress@10': 1.0, 'time@10': 1.7092}:  10%|█         | 1/10 [00:00<00:07,  1.15it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 15.6617, 'hit_ratio@10': 0.4932, 'ndcg@10': 253130966.3582, 'compress@10': 1.0, 'time@10': 1.5785}:  10%|█         | 1/10 [00:02<00:07,  1.15it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 15.6617, 'hit_ratio@10': 0.4932, 'ndcg@10': 253130966.3582, 'compress@10': 1.0, 'time@10': 1.5785}:  20%|██        | 2/10 [00:02<00:09,  1.22s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 10.63, 'hit_ratio@10': 0.5193, 'ndcg@10': 168753978.0216, 'compress@10': 1.0, 'time@10': 1.2212}:  20%|██        | 2/10 [00:02<00:09,  1.22s/it]  {'epoch': 16, 'num_users': 5.0, 'loss': 10.63, 'hit_ratio@10': 0.5193, 'ndcg@10': 168753978.0216, 'compress@10': 1.0, 'time@10': 1.2212}:  30%|███       | 3/10 [00:02<00:05,  1.27it/s]{'epoch': 16, 'num_users': 5.0, 'loss': 13.5452, 'hit_ratio@10': 0.4966, 'ndcg@10': 4.9522649030271e+18, 'compress@10': 1.0, 'time@10': 1.2124}:  30%|███       | 3/10 [00:03<00:05,  1.27it/s]{'epoch': 16, 'num_users': 5.0, 'loss': 13.5452, 'hit_ratio@10': 0.4966, 'ndcg@10': 4.9522649030271e+18, 'compress@10': 1.0, 'time@10': 1.2124}:  40%|████      | 4/10 [00:03<00:05,  1.05it/s]{'epoch': 16, 'num_users': 5.8, 'loss': 22.9834, 'hit_ratio@10': 0.4773, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8669}:  40%|████      | 4/10 [00:06<00:05,  1.05it/s]                {'epoch': 16, 'num_users': 5.8, 'loss': 22.9834, 'hit_ratio@10': 0.4773, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8669}:  50%|█████     | 5/10 [00:06<00:07,  1.42s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 32.5714, 'hit_ratio@10': 0.4755, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8889}:  50%|█████     | 5/10 [00:08<00:07,  1.42s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 32.5714, 'hit_ratio@10': 0.4755, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8889}:  60%|██████    | 6/10 [00:08<00:06,  1.62s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 31.9552, 'hit_ratio@10': 0.4704, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9237}:  60%|██████    | 6/10 [00:09<00:06,  1.62s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 31.9552, 'hit_ratio@10': 0.4704, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9237}:  70%|███████   | 7/10 [00:09<00:04,  1.45s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 32.27, 'hit_ratio@10': 0.4652, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8605}:  70%|███████   | 7/10 [00:10<00:04,  1.45s/it]   {'epoch': 16, 'num_users': 6.125, 'loss': 32.27, 'hit_ratio@10': 0.4652, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8605}:  80%|████████  | 8/10 [00:10<00:02,  1.44s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 38.0903, 'hit_ratio@10': 0.4484, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9964}:  80%|████████  | 8/10 [00:12<00:02,  1.44s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 38.0903, 'hit_ratio@10': 0.4484, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9964}:  90%|█████████ | 9/10 [00:12<00:01,  1.48s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 36.5308, 'hit_ratio@10': 0.4445, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9841}:  90%|█████████ | 9/10 [00:14<00:01,  1.48s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 36.5308, 'hit_ratio@10': 0.4445, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9841}: 100%|██████████| 10/10 [00:14<00:00,  1.61s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 36.5308, 'hit_ratio@10': 0.4445, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9841}: 100%|██████████| 10/10 [00:14<00:00,  1.41s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 36.530759702656965
Avg hit ratio: 0.4445032375660559
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9840970516204834
Std train time: 1.0488791116490832
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 25.1806, 'hit_ratio@10': 0.4211, 'ndcg@10': 1.3020609266733726e+30, 'compress@10': 1.0, 'time@10': 1.6147}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 25.1806, 'hit_ratio@10': 0.4211, 'ndcg@10': 1.3020609266733726e+30, 'compress@10': 1.0, 'time@10': 1.6147}:  10%|█         | 1/10 [00:00<00:07,  1.22it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 60.9742, 'hit_ratio@10': 0.3718, 'ndcg@10': 6.510304633373675e+29, 'compress@10': 1.0, 'time@10': 1.4939}:  10%|█         | 1/10 [00:02<00:07,  1.22it/s] {'epoch': 17, 'num_users': 7.0, 'loss': 60.9742, 'hit_ratio@10': 0.3718, 'ndcg@10': 6.510304633373675e+29, 'compress@10': 1.0, 'time@10': 1.4939}:  20%|██        | 2/10 [00:02<00:09,  1.15s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 41.0679, 'hit_ratio@10': 0.4384, 'ndcg@10': 4.340203088915783e+29, 'compress@10': 1.0, 'time@10': 1.1584}:  20%|██        | 2/10 [00:02<00:09,  1.15s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 41.0679, 'hit_ratio@10': 0.4384, 'ndcg@10': 4.340203088915783e+29, 'compress@10': 1.0, 'time@10': 1.1584}:  30%|███       | 3/10 [00:02<00:05,  1.34it/s]{'epoch': 17, 'num_users': 5.0, 'loss': 54.9542, 'hit_ratio@10': 0.3734, 'ndcg@10': 3.2551523166868494e+29, 'compress@10': 1.0, 'time@10': 1.1596}:  30%|███       | 3/10 [00:03<00:05,  1.34it/s]{'epoch': 17, 'num_users': 5.0, 'loss': 54.9542, 'hit_ratio@10': 0.3734, 'ndcg@10': 3.2551523166868494e+29, 'compress@10': 1.0, 'time@10': 1.1596}:  40%|████      | 4/10 [00:03<00:05,  1.09it/s]{'epoch': 17, 'num_users': 5.8, 'loss': 63.0847, 'hit_ratio@10': 0.3867, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8431}:  40%|████      | 4/10 [00:05<00:05,  1.09it/s]                   {'epoch': 17, 'num_users': 5.8, 'loss': 63.0847, 'hit_ratio@10': 0.3867, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8431}:  50%|█████     | 5/10 [00:05<00:07,  1.42s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 79.392, 'hit_ratio@10': 0.3815, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8638}:  50%|█████     | 5/10 [00:07<00:07,  1.42s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 79.392, 'hit_ratio@10': 0.3815, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8638}:  60%|██████    | 6/10 [00:07<00:06,  1.61s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 76.4649, 'hit_ratio@10': 0.3842, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9016}:  60%|██████    | 6/10 [00:09<00:06,  1.61s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 76.4649, 'hit_ratio@10': 0.3842, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9016}:  70%|███████   | 7/10 [00:09<00:04,  1.44s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 82.1193, 'hit_ratio@10': 0.404, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8551}:  70%|███████   | 7/10 [00:10<00:04,  1.44s/it]  {'epoch': 17, 'num_users': 6.125, 'loss': 82.1193, 'hit_ratio@10': 0.404, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8551}:  80%|████████  | 8/10 [00:10<00:02,  1.47s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 89.0799, 'hit_ratio@10': 0.394, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9805}:  80%|████████  | 8/10 [00:12<00:02,  1.47s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 89.0799, 'hit_ratio@10': 0.394, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9805}:  90%|█████████ | 9/10 [00:12<00:01,  1.48s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 86.4498, 'hit_ratio@10': 0.4001, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9664}:  90%|█████████ | 9/10 [00:13<00:01,  1.48s/it]  {'epoch': 17, 'num_users': 6.3, 'loss': 86.4498, 'hit_ratio@10': 0.4001, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9664}: 100%|██████████| 10/10 [00:13<00:00,  1.60s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 86.4498, 'hit_ratio@10': 0.4001, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9664}: 100%|██████████| 10/10 [00:13<00:00,  1.39s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 86.44979391328756
Avg hit ratio: 0.40008771439841045
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9664282321929931
Std train time: 1.0673263278350673
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 70.0154, 'hit_ratio@10': 0.4211, 'ndcg@10': 2.699670294809499e+27, 'compress@10': 1.0, 'time@10': 1.6621}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 70.0154, 'hit_ratio@10': 0.4211, 'ndcg@10': 2.699670294809499e+27, 'compress@10': 1.0, 'time@10': 1.6621}:  10%|█         | 1/10 [00:00<00:07,  1.18it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 271.3217, 'hit_ratio@10': 0.3073, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4812}:  10%|█         | 1/10 [00:02<00:07,  1.18it/s]                 {'epoch': 18, 'num_users': 7.0, 'loss': 271.3217, 'hit_ratio@10': 0.3073, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4812}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 181.8117, 'hit_ratio@10': 0.3953, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1617}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 181.8117, 'hit_ratio@10': 0.3953, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1617}:  30%|███       | 3/10 [00:02<00:05,  1.35it/s]{'epoch': 18, 'num_users': 5.0, 'loss': 343.8007, 'hit_ratio@10': 0.3769, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.175}:  30%|███       | 3/10 [00:03<00:05,  1.35it/s] {'epoch': 18, 'num_users': 5.0, 'loss': 343.8007, 'hit_ratio@10': 0.3769, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.175}:  40%|████      | 4/10 [00:03<00:05,  1.07it/s]{'epoch': 18, 'num_users': 5.8, 'loss': 311.486, 'hit_ratio@10': 0.3735, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8718}:  40%|████      | 4/10 [00:06<00:05,  1.07it/s]{'epoch': 18, 'num_users': 5.8, 'loss': 311.486, 'hit_ratio@10': 0.3735, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8718}:  50%|█████     | 5/10 [00:06<00:07,  1.44s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 359.5786, 'hit_ratio@10': 0.3816, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8863}:  50%|█████     | 5/10 [00:07<00:07,  1.44s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 359.5786, 'hit_ratio@10': 0.3816, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8863}:  60%|██████    | 6/10 [00:07<00:06,  1.62s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 383.4768, 'hit_ratio@10': 0.3842, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9226}:  60%|██████    | 6/10 [00:09<00:06,  1.62s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 383.4768, 'hit_ratio@10': 0.3842, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9226}:  70%|███████   | 7/10 [00:09<00:04,  1.45s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 346.6145, 'hit_ratio@10': 0.3826, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8657}:  70%|███████   | 7/10 [00:10<00:04,  1.45s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 346.6145, 'hit_ratio@10': 0.3826, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8657}:  80%|████████  | 8/10 [00:10<00:02,  1.46s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 356.3533, 'hit_ratio@10': 0.3782, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0088}:  80%|████████  | 8/10 [00:12<00:02,  1.46s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 356.3533, 'hit_ratio@10': 0.3782, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0088}:  90%|█████████ | 9/10 [00:12<00:01,  1.50s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 331.5864, 'hit_ratio@10': 0.3654, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9925}:  90%|█████████ | 9/10 [00:14<00:01,  1.50s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 331.5864, 'hit_ratio@10': 0.3654, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9925}: 100%|██████████| 10/10 [00:14<00:00,  1.61s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 331.5864, 'hit_ratio@10': 0.3654, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9925}: 100%|██████████| 10/10 [00:14<00:00,  1.40s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 331.58636988486364
Avg hit ratio: 0.3653966098040801
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9924978733062744
Std train time: 1.101462043684619
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 99.7167, 'hit_ratio@10': 0.3684, 'ndcg@10': 109193529710230.86, 'compress@10': 1.0, 'time@10': 1.522}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 99.7167, 'hit_ratio@10': 0.3684, 'ndcg@10': 109193529710230.86, 'compress@10': 1.0, 'time@10': 1.522}:  10%|█         | 1/10 [00:00<00:06,  1.29it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 1139.2823, 'hit_ratio@10': 0.3455, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4018}:  10%|█         | 1/10 [00:02<00:06,  1.29it/s]            {'epoch': 19, 'num_users': 7.0, 'loss': 1139.2823, 'hit_ratio@10': 0.3455, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4018}:  20%|██        | 2/10 [00:02<00:08,  1.08s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 763.166, 'hit_ratio@10': 0.278, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.0959}:  20%|██        | 2/10 [00:02<00:08,  1.08s/it]   {'epoch': 19, 'num_users': 5.0, 'loss': 763.166, 'hit_ratio@10': 0.278, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.0959}:  30%|███       | 3/10 [00:02<00:04,  1.42it/s]{'epoch': 19, 'num_users': 5.0, 'loss': 1232.4157, 'hit_ratio@10': 0.3156, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.114}:  30%|███       | 3/10 [00:03<00:04,  1.42it/s]{'epoch': 19, 'num_users': 5.0, 'loss': 1232.4157, 'hit_ratio@10': 0.3156, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.114}:  40%|████      | 4/10 [00:03<00:05,  1.11it/s]{'epoch': 19, 'num_users': 5.8, 'loss': 1068.0764, 'hit_ratio@10': 0.3325, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7949}:  40%|████      | 4/10 [00:05<00:05,  1.11it/s]{'epoch': 19, 'num_users': 5.8, 'loss': 1068.0764, 'hit_ratio@10': 0.3325, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7949}:  50%|█████     | 5/10 [00:05<00:06,  1.39s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 1058.2545, 'hit_ratio@10': 0.3437, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8307}:  50%|█████     | 5/10 [00:07<00:06,  1.39s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 1058.2545, 'hit_ratio@10': 0.3437, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8307}:  60%|██████    | 6/10 [00:07<00:06,  1.61s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 1103.2784, 'hit_ratio@10': 0.3346, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8637}:  60%|██████    | 6/10 [00:08<00:06,  1.61s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 1103.2784, 'hit_ratio@10': 0.3346, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8637}:  70%|███████   | 7/10 [00:08<00:04,  1.42s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 1012.1653, 'hit_ratio@10': 0.3535, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8211}:  70%|███████   | 7/10 [00:10<00:04,  1.42s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 1012.1653, 'hit_ratio@10': 0.3535, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8211}:  80%|████████  | 8/10 [00:10<00:02,  1.46s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 1077.0232, 'hit_ratio@10': 0.365, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9558}:  80%|████████  | 8/10 [00:11<00:02,  1.46s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 1077.0232, 'hit_ratio@10': 0.365, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9558}:  90%|█████████ | 9/10 [00:11<00:01,  1.48s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 1006.2861, 'hit_ratio@10': 0.3717, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9439}:  90%|█████████ | 9/10 [00:13<00:01,  1.48s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 1006.2861, 'hit_ratio@10': 0.3717, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9439}: 100%|██████████| 10/10 [00:13<00:00,  1.60s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 1006.2861, 'hit_ratio@10': 0.3717, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9439}: 100%|██████████| 10/10 [00:13<00:00,  1.38s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 1006.2861267325385
Avg hit ratio: 0.37171055938967656
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9438818454742433
Std train time: 1.0663821133173503
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 82.244, 'hit_ratio@10': 0.2632, 'ndcg@10': 2.5950110279935693e+18, 'compress@10': 1.0, 'time@10': 1.6822}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 82.244, 'hit_ratio@10': 0.2632, 'ndcg@10': 2.5950110279935693e+18, 'compress@10': 1.0, 'time@10': 1.6822}:  10%|█         | 1/10 [00:00<00:07,  1.17it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 3067.0047, 'hit_ratio@10': 0.2767, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5293}:  10%|█         | 1/10 [00:02<00:07,  1.17it/s]                {'epoch': 20, 'num_users': 7.0, 'loss': 3067.0047, 'hit_ratio@10': 0.2767, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5293}:  20%|██        | 2/10 [00:02<00:09,  1.17s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 2053.4715, 'hit_ratio@10': 0.4226, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1934}:  20%|██        | 2/10 [00:02<00:09,  1.17s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 2053.4715, 'hit_ratio@10': 0.4226, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1934}:  30%|███       | 3/10 [00:02<00:05,  1.31it/s]{'epoch': 20, 'num_users': 5.0, 'loss': 3137.5215, 'hit_ratio@10': 0.433, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1837}:  30%|███       | 3/10 [00:03<00:05,  1.31it/s] {'epoch': 20, 'num_users': 5.0, 'loss': 3137.5215, 'hit_ratio@10': 0.433, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1837}:  40%|████      | 4/10 [00:03<00:05,  1.08it/s]{'epoch': 20, 'num_users': 5.8, 'loss': 2726.6154, 'hit_ratio@10': 0.4224, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8722}:  40%|████      | 4/10 [00:06<00:05,  1.08it/s]{'epoch': 20, 'num_users': 5.8, 'loss': 2726.6154, 'hit_ratio@10': 0.4224, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8722}:  50%|█████     | 5/10 [00:06<00:07,  1.43s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 2502.271, 'hit_ratio@10': 0.4298, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8895}:  50%|█████     | 5/10 [00:08<00:07,  1.43s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 2502.271, 'hit_ratio@10': 0.4298, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8895}:  60%|██████    | 6/10 [00:08<00:06,  1.62s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 2416.9797, 'hit_ratio@10': 0.397, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9239}:  60%|██████    | 6/10 [00:09<00:06,  1.62s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 2416.9797, 'hit_ratio@10': 0.397, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9239}:  70%|███████   | 7/10 [00:09<00:04,  1.44s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 2533.8386, 'hit_ratio@10': 0.4009, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8629}:  70%|███████   | 7/10 [00:10<00:04,  1.44s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 2533.8386, 'hit_ratio@10': 0.4009, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8629}:  80%|████████  | 8/10 [00:10<00:02,  1.45s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 3046.3841, 'hit_ratio@10': 0.3945, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9898}:  80%|████████  | 8/10 [00:12<00:02,  1.45s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 3046.3841, 'hit_ratio@10': 0.3945, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9898}:  90%|█████████ | 9/10 [00:12<00:01,  1.47s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 2797.8213, 'hit_ratio@10': 0.3937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9899}:  90%|█████████ | 9/10 [00:14<00:01,  1.47s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 2797.8213, 'hit_ratio@10': 0.3937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9899}: 100%|██████████| 10/10 [00:14<00:00,  1.63s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 2797.8213, 'hit_ratio@10': 0.3937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9899}: 100%|██████████| 10/10 [00:14<00:00,  1.41s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 2797.821270261816
Avg hit ratio: 0.39365107784123066
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9899244546890258
Std train time: 1.078659347838318
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 1911.4129, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8313}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 1911.4129, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8313}:  10%|█         | 1/10 [00:00<00:08,  1.06it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 7414.8743, 'hit_ratio@10': 0.337, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5809}:  10%|█         | 1/10 [00:02<00:08,  1.06it/s] {'epoch': 21, 'num_users': 7.0, 'loss': 7414.8743, 'hit_ratio@10': 0.337, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5809}:  20%|██        | 2/10 [00:02<00:09,  1.18s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 4965.804, 'hit_ratio@10': 0.3675, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2426}:  20%|██        | 2/10 [00:02<00:09,  1.18s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 4965.804, 'hit_ratio@10': 0.3675, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2426}:  30%|███       | 3/10 [00:02<00:05,  1.29it/s]{'epoch': 21, 'num_users': 5.0, 'loss': 6873.9216, 'hit_ratio@10': 0.3471, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2364}:  30%|███       | 3/10 [00:03<00:05,  1.29it/s]{'epoch': 21, 'num_users': 5.0, 'loss': 6873.9216, 'hit_ratio@10': 0.3471, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2364}:  40%|████      | 4/10 [00:03<00:05,  1.05it/s]{'epoch': 21, 'num_users': 5.8, 'loss': 6184.3147, 'hit_ratio@10': 0.3497, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8565}:  40%|████      | 4/10 [00:06<00:05,  1.05it/s]{'epoch': 21, 'num_users': 5.8, 'loss': 6184.3147, 'hit_ratio@10': 0.3497, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8565}:  50%|█████     | 5/10 [00:06<00:07,  1.41s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 5731.7783, 'hit_ratio@10': 0.3432, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8761}:  50%|█████     | 5/10 [00:08<00:07,  1.41s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 5731.7783, 'hit_ratio@10': 0.3432, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8761}:  60%|██████    | 6/10 [00:08<00:06,  1.60s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 6675.8129, 'hit_ratio@10': 0.3342, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9277}:  60%|██████    | 6/10 [00:09<00:06,  1.60s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 6675.8129, 'hit_ratio@10': 0.3342, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9277}:  70%|███████   | 7/10 [00:09<00:04,  1.45s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 6507.9805, 'hit_ratio@10': 0.3567, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8688}:  70%|███████   | 7/10 [00:10<00:04,  1.45s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 6507.9805, 'hit_ratio@10': 0.3567, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8688}:  80%|████████  | 8/10 [00:10<00:02,  1.46s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 8334.5518, 'hit_ratio@10': 0.3266, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0154}:  80%|████████  | 8/10 [00:12<00:02,  1.46s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 8334.5518, 'hit_ratio@10': 0.3266, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0154}:  90%|█████████ | 9/10 [00:12<00:01,  1.50s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 7772.6793, 'hit_ratio@10': 0.3144, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9959}:  90%|█████████ | 9/10 [00:14<00:01,  1.50s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 7772.6793, 'hit_ratio@10': 0.3144, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9959}: 100%|██████████| 10/10 [00:14<00:00,  1.61s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 7772.6793, 'hit_ratio@10': 0.3144, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9959}: 100%|██████████| 10/10 [00:14<00:00,  1.41s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 7772.679251434532
Avg hit ratio: 0.314396604904245
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9958921194076538
Std train time: 1.0199100970898114
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 32492.4416, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6111}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 32492.4416, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6111}:  10%|█         | 1/10 [00:00<00:07,  1.22it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 35190.0084, 'hit_ratio@10': 0.281, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4645}:  10%|█         | 1/10 [00:02<00:07,  1.22it/s] {'epoch': 22, 'num_users': 7.0, 'loss': 35190.0084, 'hit_ratio@10': 0.281, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4645}:  20%|██        | 2/10 [00:02<00:08,  1.12s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 23574.1394, 'hit_ratio@10': 0.2349, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1517}:  20%|██        | 2/10 [00:02<00:08,  1.12s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 23574.1394, 'hit_ratio@10': 0.2349, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1517}:  30%|███       | 3/10 [00:02<00:05,  1.36it/s]{'epoch': 22, 'num_users': 5.0, 'loss': 28453.211, 'hit_ratio@10': 0.2298, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.158}:  30%|███       | 3/10 [00:03<00:05,  1.36it/s]  {'epoch': 22, 'num_users': 5.0, 'loss': 28453.211, 'hit_ratio@10': 0.2298, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.158}:  40%|████      | 4/10 [00:03<00:05,  1.09it/s]{'epoch': 22, 'num_users': 5.8, 'loss': 24351.5465, 'hit_ratio@10': 0.2598, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8266}:  40%|████      | 4/10 [00:05<00:05,  1.09it/s]{'epoch': 22, 'num_users': 5.8, 'loss': 24351.5465, 'hit_ratio@10': 0.2598, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8266}:  50%|█████     | 5/10 [00:05<00:07,  1.40s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 23552.9435, 'hit_ratio@10': 0.2943, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8338}:  50%|█████     | 5/10 [00:07<00:07,  1.40s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 23552.9435, 'hit_ratio@10': 0.2943, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8338}:  60%|██████    | 6/10 [00:07<00:06,  1.57s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 24489.9763, 'hit_ratio@10': 0.2923, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8857}:  60%|██████    | 6/10 [00:08<00:06,  1.57s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 24489.9763, 'hit_ratio@10': 0.2923, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8857}:  70%|███████   | 7/10 [00:08<00:04,  1.42s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 23563.867, 'hit_ratio@10': 0.3057, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8404}:  70%|███████   | 7/10 [00:10<00:04,  1.42s/it]  {'epoch': 22, 'num_users': 6.125, 'loss': 23563.867, 'hit_ratio@10': 0.3057, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8404}:  80%|████████  | 8/10 [00:10<00:02,  1.46s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 25790.5454, 'hit_ratio@10': 0.3067, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.984}:  80%|████████  | 8/10 [00:12<00:02,  1.46s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 25790.5454, 'hit_ratio@10': 0.3067, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.984}:  90%|█████████ | 9/10 [00:12<00:01,  1.50s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 23795.6836, 'hit_ratio@10': 0.3056, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.978}:  90%|█████████ | 9/10 [00:13<00:01,  1.50s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 23795.6836, 'hit_ratio@10': 0.3056, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.978}: 100%|██████████| 10/10 [00:13<00:00,  1.64s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 23795.6836, 'hit_ratio@10': 0.3056, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.978}: 100%|██████████| 10/10 [00:13<00:00,  1.40s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 23795.68357292793
Avg hit ratio: 0.30555192232781364
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9780333280563354
Std train time: 1.0624144664707094
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 13961.4159, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6469}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 13961.4159, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6469}:  10%|█         | 1/10 [00:00<00:07,  1.19it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 18385.3427, 'hit_ratio@10': 0.3149, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4919}:  10%|█         | 1/10 [00:02<00:07,  1.19it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 18385.3427, 'hit_ratio@10': 0.3149, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4919}:  20%|██        | 2/10 [00:02<00:09,  1.14s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 12345.6577, 'hit_ratio@10': 0.3528, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1706}:  20%|██        | 2/10 [00:02<00:09,  1.14s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 12345.6577, 'hit_ratio@10': 0.3528, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1706}:  30%|███       | 3/10 [00:02<00:05,  1.33it/s]{'epoch': 23, 'num_users': 5.0, 'loss': 35115.4126, 'hit_ratio@10': 0.3003, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1846}:  30%|███       | 3/10 [00:03<00:05,  1.33it/s]{'epoch': 23, 'num_users': 5.0, 'loss': 35115.4126, 'hit_ratio@10': 0.3003, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1846}:  40%|████      | 4/10 [00:03<00:05,  1.06it/s]{'epoch': 23, 'num_users': 5.8, 'loss': 30158.0703, 'hit_ratio@10': 0.2923, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.892}:  40%|████      | 4/10 [00:06<00:05,  1.06it/s] {'epoch': 23, 'num_users': 5.8, 'loss': 30158.0703, 'hit_ratio@10': 0.2923, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.892}:  50%|█████     | 5/10 [00:06<00:07,  1.46s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 26970.9282, 'hit_ratio@10': 0.3213, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9094}:  50%|█████     | 5/10 [00:08<00:07,  1.46s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 26970.9282, 'hit_ratio@10': 0.3213, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9094}:  60%|██████    | 6/10 [00:08<00:06,  1.66s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 57161.0458, 'hit_ratio@10': 0.3097, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.962}:  60%|██████    | 6/10 [00:09<00:06,  1.66s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 57161.0458, 'hit_ratio@10': 0.3097, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.962}:  70%|███████   | 7/10 [00:09<00:04,  1.49s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 51789.2408, 'hit_ratio@10': 0.3281, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.909}:  70%|███████   | 7/10 [00:10<00:04,  1.49s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 51789.2408, 'hit_ratio@10': 0.3281, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.909}:  80%|████████  | 8/10 [00:10<00:03,  1.51s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 46783.9748, 'hit_ratio@10': 0.3266, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0508}:  80%|████████  | 8/10 [00:12<00:03,  1.51s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 46783.9748, 'hit_ratio@10': 0.3266, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0508}:  90%|█████████ | 9/10 [00:12<00:01,  1.54s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 43902.2336, 'hit_ratio@10': 0.3258, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0314}:  90%|█████████ | 9/10 [00:14<00:01,  1.54s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 43902.2336, 'hit_ratio@10': 0.3258, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0314}: 100%|██████████| 10/10 [00:14<00:00,  1.64s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 43902.2336, 'hit_ratio@10': 0.3258, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0314}: 100%|██████████| 10/10 [00:14<00:00,  1.43s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 43902.233565642215
Avg hit ratio: 0.3257586782204779
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.031445932388306
Std train time: 1.1153586442581824
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 181895.7479, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5456}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 181895.7479, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5456}:  10%|█         | 1/10 [00:00<00:07,  1.27it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 162825.6691, 'hit_ratio@10': 0.2971, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4256}:  10%|█         | 1/10 [00:02<00:07,  1.27it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 162825.6691, 'hit_ratio@10': 0.2971, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4256}:  20%|██        | 2/10 [00:02<00:08,  1.10s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 130117.7101, 'hit_ratio@10': 0.2933, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1095}:  20%|██        | 2/10 [00:02<00:08,  1.10s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 130117.7101, 'hit_ratio@10': 0.2933, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1095}:  30%|███       | 3/10 [00:02<00:05,  1.39it/s]{'epoch': 24, 'num_users': 5.0, 'loss': 124552.5933, 'hit_ratio@10': 0.3003, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1339}:  30%|███       | 3/10 [00:03<00:05,  1.39it/s]{'epoch': 24, 'num_users': 5.0, 'loss': 124552.5933, 'hit_ratio@10': 0.3003, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1339}:  40%|████      | 4/10 [00:03<00:05,  1.08it/s]{'epoch': 24, 'num_users': 5.8, 'loss': 103480.3811, 'hit_ratio@10': 0.3163, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8062}:  40%|████      | 4/10 [00:05<00:05,  1.08it/s]{'epoch': 24, 'num_users': 5.8, 'loss': 103480.3811, 'hit_ratio@10': 0.3163, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8062}:  50%|█████     | 5/10 [00:05<00:07,  1.41s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 94043.6467, 'hit_ratio@10': 0.3154, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.855}:  50%|█████     | 5/10 [00:07<00:07,  1.41s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 94043.6467, 'hit_ratio@10': 0.3154, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.855}:  60%|██████    | 6/10 [00:07<00:06,  1.65s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 88537.6739, 'hit_ratio@10': 0.3218, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8954}:  60%|██████    | 6/10 [00:09<00:06,  1.65s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 88537.6739, 'hit_ratio@10': 0.3218, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8954}:  70%|███████   | 7/10 [00:09<00:04,  1.46s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 80947.8674, 'hit_ratio@10': 0.3423, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8544}:  70%|███████   | 7/10 [00:10<00:04,  1.46s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 80947.8674, 'hit_ratio@10': 0.3423, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8544}:  80%|████████  | 8/10 [00:10<00:03,  1.50s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 76893.9953, 'hit_ratio@10': 0.3392, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0101}:  80%|████████  | 8/10 [00:12<00:03,  1.50s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 76893.9953, 'hit_ratio@10': 0.3392, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0101}:  90%|█████████ | 9/10 [00:12<00:01,  1.55s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 77029.7823, 'hit_ratio@10': 0.353, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9946}:  90%|█████████ | 9/10 [00:14<00:01,  1.55s/it]    {'epoch': 24, 'num_users': 6.3, 'loss': 77029.7823, 'hit_ratio@10': 0.353, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9946}: 100%|██████████| 10/10 [00:14<00:00,  1.65s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 77029.7823, 'hit_ratio@10': 0.353, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9946}: 100%|██████████| 10/10 [00:14<00:00,  1.42s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 77029.78231251983
Avg hit ratio: 0.3529754199771178
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9945884227752686
Std train time: 1.0805814590528189
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 170752.6213, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.685}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 170752.6213, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.685}:  10%|█         | 1/10 [00:00<00:07,  1.16it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 212400.4123, 'hit_ratio@10': 0.2929, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5265}:  10%|█         | 1/10 [00:02<00:07,  1.16it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 212400.4123, 'hit_ratio@10': 0.2929, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5265}:  20%|██        | 2/10 [00:02<00:09,  1.17s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 142216.3303, 'hit_ratio@10': 0.3381, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2039}:  20%|██        | 2/10 [00:02<00:09,  1.17s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 142216.3303, 'hit_ratio@10': 0.3381, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2039}:  30%|███       | 3/10 [00:02<00:05,  1.30it/s]{'epoch': 25, 'num_users': 5.0, 'loss': 152693.2118, 'hit_ratio@10': 0.325, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1998}:  30%|███       | 3/10 [00:03<00:05,  1.30it/s] {'epoch': 25, 'num_users': 5.0, 'loss': 152693.2118, 'hit_ratio@10': 0.325, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1998}:  40%|████      | 4/10 [00:03<00:05,  1.06it/s]{'epoch': 25, 'num_users': 5.8, 'loss': 130859.5169, 'hit_ratio@10': 0.344, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8775}:  40%|████      | 4/10 [00:06<00:05,  1.06it/s]{'epoch': 25, 'num_users': 5.8, 'loss': 130859.5169, 'hit_ratio@10': 0.344, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8775}:  50%|█████     | 5/10 [00:06<00:07,  1.43s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 125468.1692, 'hit_ratio@10': 0.3533, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8872}:  50%|█████     | 5/10 [00:08<00:07,  1.43s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 125468.1692, 'hit_ratio@10': 0.3533, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8872}:  60%|██████    | 6/10 [00:08<00:06,  1.61s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 523283.0856, 'hit_ratio@10': 0.3371, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9373}:  60%|██████    | 6/10 [00:09<00:06,  1.61s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 523283.0856, 'hit_ratio@10': 0.3371, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9373}:  70%|███████   | 7/10 [00:09<00:04,  1.45s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 524035.6194, 'hit_ratio@10': 0.3521, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8798}:  70%|███████   | 7/10 [00:10<00:04,  1.45s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 524035.6194, 'hit_ratio@10': 0.3521, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8798}:  80%|████████  | 8/10 [00:10<00:02,  1.47s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 474019.0697, 'hit_ratio@10': 0.3416, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0295}:  80%|████████  | 8/10 [00:12<00:02,  1.47s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 474019.0697, 'hit_ratio@10': 0.3416, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0295}:  90%|█████████ | 9/10 [00:12<00:01,  1.52s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 439982.5159, 'hit_ratio@10': 0.3483, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0161}:  90%|█████████ | 9/10 [00:14<00:01,  1.52s/it]   {'epoch': 25, 'num_users': 6.3, 'loss': 439982.5159, 'hit_ratio@10': 0.3483, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0161}: 100%|██████████| 10/10 [00:14<00:00,  1.64s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 439982.5159, 'hit_ratio@10': 0.3483, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0161}: 100%|██████████| 10/10 [00:14<00:00,  1.42s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 439982.51586777426
Avg hit ratio: 0.348340087756047
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.0161266326904297
Std train time: 1.0856199906654862
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 2782451.0197, 'hit_ratio@10': 0.4737, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5021}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 2782451.0197, 'hit_ratio@10': 0.4737, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5021}:  10%|█         | 1/10 [00:00<00:06,  1.30it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 1526324.5526, 'hit_ratio@10': 0.3981, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4335}:  10%|█         | 1/10 [00:02<00:06,  1.30it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 1526324.5526, 'hit_ratio@10': 0.3981, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4335}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 1055888.6364, 'hit_ratio@10': 0.3607, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1139}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 1055888.6364, 'hit_ratio@10': 0.3607, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1139}:  30%|███       | 3/10 [00:02<00:05,  1.37it/s]{'epoch': 26, 'num_users': 5.0, 'loss': 857324.7157, 'hit_ratio@10': 0.333, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1605}:  30%|███       | 3/10 [00:03<00:05,  1.37it/s]  {'epoch': 26, 'num_users': 5.0, 'loss': 857324.7157, 'hit_ratio@10': 0.333, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1605}:  40%|████      | 4/10 [00:03<00:05,  1.04it/s]{'epoch': 26, 'num_users': 5.8, 'loss': 704756.5568, 'hit_ratio@10': 0.3344, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8248}:  40%|████      | 4/10 [00:05<00:05,  1.04it/s]{'epoch': 26, 'num_users': 5.8, 'loss': 704756.5568, 'hit_ratio@10': 0.3344, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8248}:  50%|█████     | 5/10 [00:05<00:07,  1.43s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 603097.0685, 'hit_ratio@10': 0.3453, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8609}:  50%|█████     | 5/10 [00:08<00:07,  1.43s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 603097.0685, 'hit_ratio@10': 0.3453, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8609}:  60%|██████    | 6/10 [00:08<00:06,  1.64s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 746145.9123, 'hit_ratio@10': 0.3531, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9106}:  60%|██████    | 6/10 [00:09<00:06,  1.64s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 746145.9123, 'hit_ratio@10': 0.3531, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9106}:  70%|███████   | 7/10 [00:09<00:04,  1.47s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 671342.3498, 'hit_ratio@10': 0.3447, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8606}:  70%|███████   | 7/10 [00:10<00:04,  1.47s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 671342.3498, 'hit_ratio@10': 0.3447, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8606}:  80%|████████  | 8/10 [00:10<00:02,  1.49s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 663148.9698, 'hit_ratio@10': 0.3382, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0125}:  80%|████████  | 8/10 [00:12<00:02,  1.49s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 663148.9698, 'hit_ratio@10': 0.3382, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0125}:  90%|█████████ | 9/10 [00:12<00:01,  1.54s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 649447.241, 'hit_ratio@10': 0.343, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9949}:  90%|█████████ | 9/10 [00:14<00:01,  1.54s/it]     {'epoch': 26, 'num_users': 6.3, 'loss': 649447.241, 'hit_ratio@10': 0.343, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9949}: 100%|██████████| 10/10 [00:14<00:00,  1.63s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 649447.241, 'hit_ratio@10': 0.343, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9949}: 100%|██████████| 10/10 [00:14<00:00,  1.42s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 649447.2409977705
Avg hit ratio: 0.34297713491940995
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.994868850708008
Std train time: 1.0699034444802678
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 1653558.6546, 'hit_ratio@10': 0.5263, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7142}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 1653558.6546, 'hit_ratio@10': 0.5263, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7142}:  10%|█         | 1/10 [00:00<00:07,  1.15it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 1408107.6731, 'hit_ratio@10': 0.3761, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5101}:  10%|█         | 1/10 [00:02<00:07,  1.15it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 1408107.6731, 'hit_ratio@10': 0.3761, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5101}:  20%|██        | 2/10 [00:02<00:09,  1.14s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 942941.2119, 'hit_ratio@10': 0.3459, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1811}:  20%|██        | 2/10 [00:02<00:09,  1.14s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 942941.2119, 'hit_ratio@10': 0.3459, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1811}:  30%|███       | 3/10 [00:02<00:05,  1.35it/s]{'epoch': 27, 'num_users': 5.0, 'loss': 1276991.7337, 'hit_ratio@10': 0.3577, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.171}:  30%|███       | 3/10 [00:03<00:05,  1.35it/s]{'epoch': 27, 'num_users': 5.0, 'loss': 1276991.7337, 'hit_ratio@10': 0.3577, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.171}:  40%|████      | 4/10 [00:03<00:05,  1.10it/s]{'epoch': 27, 'num_users': 5.8, 'loss': 1079932.8531, 'hit_ratio@10': 0.3341, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8418}:  40%|████      | 4/10 [00:05<00:05,  1.10it/s]{'epoch': 27, 'num_users': 5.8, 'loss': 1079932.8531, 'hit_ratio@10': 0.3341, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8418}:  50%|█████     | 5/10 [00:05<00:07,  1.40s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 1023408.6839, 'hit_ratio@10': 0.3266, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8741}:  50%|█████     | 5/10 [00:07<00:07,  1.40s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 1023408.6839, 'hit_ratio@10': 0.3266, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8741}:  60%|██████    | 6/10 [00:07<00:06,  1.62s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 1003744.3279, 'hit_ratio@10': 0.3199, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9226}:  60%|██████    | 6/10 [00:09<00:06,  1.62s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 1003744.3279, 'hit_ratio@10': 0.3199, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9226}:  70%|███████   | 7/10 [00:09<00:04,  1.46s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 1011542.2503, 'hit_ratio@10': 0.3121, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8841}:  70%|███████   | 7/10 [00:10<00:04,  1.46s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 1011542.2503, 'hit_ratio@10': 0.3121, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8841}:  80%|████████  | 8/10 [00:10<00:03,  1.52s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 1002280.6819, 'hit_ratio@10': 0.306, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0069}:  80%|████████  | 8/10 [00:12<00:03,  1.52s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 1002280.6819, 'hit_ratio@10': 0.306, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0069}:  90%|█████████ | 9/10 [00:12<00:01,  1.52s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 920611.3412, 'hit_ratio@10': 0.3027, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9963}:  90%|█████████ | 9/10 [00:14<00:01,  1.52s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 920611.3412, 'hit_ratio@10': 0.3027, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9963}: 100%|██████████| 10/10 [00:14<00:00,  1.64s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 920611.3412, 'hit_ratio@10': 0.3027, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9963}: 100%|██████████| 10/10 [00:14<00:00,  1.42s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 920611.3411769497
Avg hit ratio: 0.3026595545559892
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9962615966796875
Std train time: 1.0507794757526296
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 3577227.6316, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5625}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 3577227.6316, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5625}:  10%|█         | 1/10 [00:00<00:07,  1.26it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 5471293.7997, 'hit_ratio@10': 0.3396, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4623}:  10%|█         | 1/10 [00:02<00:07,  1.26it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 5471293.7997, 'hit_ratio@10': 0.3396, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4623}:  20%|██        | 2/10 [00:02<00:09,  1.14s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 10642551.6045, 'hit_ratio@10': 0.2264, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1318}:  20%|██        | 2/10 [00:02<00:09,  1.14s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 10642551.6045, 'hit_ratio@10': 0.2264, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1318}:  30%|███       | 3/10 [00:02<00:05,  1.37it/s]{'epoch': 28, 'num_users': 5.0, 'loss': 8973470.9908, 'hit_ratio@10': 0.2948, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1565}:  30%|███       | 3/10 [00:03<00:05,  1.37it/s] {'epoch': 28, 'num_users': 5.0, 'loss': 8973470.9908, 'hit_ratio@10': 0.2948, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1565}:  40%|████      | 4/10 [00:03<00:05,  1.07it/s]{'epoch': 28, 'num_users': 5.8, 'loss': 7778034.6111, 'hit_ratio@10': 0.3078, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8226}:  40%|████      | 4/10 [00:05<00:05,  1.07it/s]{'epoch': 28, 'num_users': 5.8, 'loss': 7778034.6111, 'hit_ratio@10': 0.3078, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8226}:  50%|█████     | 5/10 [00:05<00:07,  1.41s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 6668491.1915, 'hit_ratio@10': 0.3232, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8506}:  50%|█████     | 5/10 [00:07<00:07,  1.41s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 6668491.1915, 'hit_ratio@10': 0.3232, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8506}:  60%|██████    | 6/10 [00:07<00:06,  1.61s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 8111420.5641, 'hit_ratio@10': 0.3342, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8993}:  60%|██████    | 6/10 [00:09<00:06,  1.61s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 8111420.5641, 'hit_ratio@10': 0.3342, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8993}:  70%|███████   | 7/10 [00:09<00:04,  1.45s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 7547722.7463, 'hit_ratio@10': 0.3281, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8483}:  70%|███████   | 7/10 [00:10<00:04,  1.45s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 7547722.7463, 'hit_ratio@10': 0.3281, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8483}:  80%|████████  | 8/10 [00:10<00:02,  1.47s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 7677127.4772, 'hit_ratio@10': 0.3297, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9815}:  80%|████████  | 8/10 [00:12<00:02,  1.47s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 7677127.4772, 'hit_ratio@10': 0.3297, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9815}:  90%|█████████ | 9/10 [00:12<00:01,  1.49s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 7282645.5096, 'hit_ratio@10': 0.3218, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9691}:  90%|█████████ | 9/10 [00:13<00:01,  1.49s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 7282645.5096, 'hit_ratio@10': 0.3218, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9691}: 100%|██████████| 10/10 [00:13<00:00,  1.61s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 7282645.5096, 'hit_ratio@10': 0.3218, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9691}: 100%|██████████| 10/10 [00:13<00:00,  1.40s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 7282645.509628065
Avg hit ratio: 0.32176885762794083
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9691376209259033
Std train time: 1.054396152758295
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 74824000.8421, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.635}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 74824000.8421, 'hit_ratio@10': 0.1053, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.635}:  10%|█         | 1/10 [00:00<00:07,  1.20it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 55867187.7194, 'hit_ratio@10': 0.1817, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4834}:  10%|█         | 1/10 [00:02<00:07,  1.20it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 55867187.7194, 'hit_ratio@10': 0.1817, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4834}:  20%|██        | 2/10 [00:02<00:09,  1.14s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 37402720.9112, 'hit_ratio@10': 0.2163, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1703}:  20%|██        | 2/10 [00:02<00:09,  1.14s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 37402720.9112, 'hit_ratio@10': 0.2163, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1703}:  30%|███       | 3/10 [00:02<00:05,  1.34it/s]{'epoch': 29, 'num_users': 5.0, 'loss': 30895646.103, 'hit_ratio@10': 0.198, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.174}:  30%|███       | 3/10 [00:03<00:05,  1.34it/s]   {'epoch': 29, 'num_users': 5.0, 'loss': 30895646.103, 'hit_ratio@10': 0.198, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.174}:  40%|████      | 4/10 [00:03<00:05,  1.08it/s]{'epoch': 29, 'num_users': 5.8, 'loss': 26216225.8394, 'hit_ratio@10': 0.2104, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8313}:  40%|████      | 4/10 [00:05<00:05,  1.08it/s]{'epoch': 29, 'num_users': 5.8, 'loss': 26216225.8394, 'hit_ratio@10': 0.2104, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8313}:  50%|█████     | 5/10 [00:05<00:07,  1.40s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 23320219.3449, 'hit_ratio@10': 0.2124, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8535}:  50%|█████     | 5/10 [00:07<00:07,  1.40s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 23320219.3449, 'hit_ratio@10': 0.2124, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8535}:  60%|██████    | 6/10 [00:07<00:06,  1.60s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 30312907.6099, 'hit_ratio@10': 0.2106, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8948}:  60%|██████    | 6/10 [00:08<00:06,  1.60s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 30312907.6099, 'hit_ratio@10': 0.2106, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8948}:  70%|███████   | 7/10 [00:08<00:04,  1.43s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 27279272.2896, 'hit_ratio@10': 0.2307, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8541}:  70%|███████   | 7/10 [00:10<00:04,  1.43s/it] {'epoch': 29, 'num_users': 6.125, 'loss': 27279272.2896, 'hit_ratio@10': 0.2307, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8541}:  80%|████████  | 8/10 [00:10<00:02,  1.48s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 26007749.2098, 'hit_ratio@10': 0.24, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9837}:  80%|████████  | 8/10 [00:12<00:02,  1.48s/it] {'epoch': 29, 'num_users': 6.3333, 'loss': 26007749.2098, 'hit_ratio@10': 0.24, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9837}:  90%|█████████ | 9/10 [00:12<00:01,  1.49s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 24224675.4502, 'hit_ratio@10': 0.2592, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9749}:  90%|█████████ | 9/10 [00:14<00:01,  1.49s/it] {'epoch': 29, 'num_users': 6.3, 'loss': 24224675.4502, 'hit_ratio@10': 0.2592, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9749}: 100%|██████████| 10/10 [00:14<00:00,  1.62s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 24224675.4502, 'hit_ratio@10': 0.2592, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9749}: 100%|██████████| 10/10 [00:14<00:00,  1.40s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 24224675.450170234
Avg hit ratio: 0.2591653792349887
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9749035120010376
Std train time: 1.0329706604682876
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 603922275.3684, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5355}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 603922275.3684, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5355}:  10%|█         | 1/10 [00:00<00:07,  1.28it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 366181118.0713, 'hit_ratio@10': 0.3778, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.435}:  10%|█         | 1/10 [00:02<00:07,  1.28it/s] {'epoch': 30, 'num_users': 7.0, 'loss': 366181118.0713, 'hit_ratio@10': 0.3778, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.435}:  20%|██        | 2/10 [00:02<00:08,  1.12s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 244126471.8734, 'hit_ratio@10': 0.2995, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1202}:  20%|██        | 2/10 [00:02<00:08,  1.12s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 244126471.8734, 'hit_ratio@10': 0.2995, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1202}:  30%|███       | 3/10 [00:02<00:05,  1.37it/s]{'epoch': 30, 'num_users': 5.0, 'loss': 260736946.405, 'hit_ratio@10': 0.3317, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1476}:  30%|███       | 3/10 [00:03<00:05,  1.37it/s] {'epoch': 30, 'num_users': 5.0, 'loss': 260736946.405, 'hit_ratio@10': 0.3317, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1476}:  40%|████      | 4/10 [00:03<00:05,  1.07it/s]{'epoch': 30, 'num_users': 5.8, 'loss': 211905606.288, 'hit_ratio@10': 0.3454, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8071}:  40%|████      | 4/10 [00:05<00:05,  1.07it/s]{'epoch': 30, 'num_users': 5.8, 'loss': 211905606.288, 'hit_ratio@10': 0.3454, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8071}:  50%|█████     | 5/10 [00:05<00:07,  1.40s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 178983884.84, 'hit_ratio@10': 0.3545, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8542}:  50%|█████     | 5/10 [00:07<00:07,  1.40s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 178983884.84, 'hit_ratio@10': 0.3545, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8542}:  60%|██████    | 6/10 [00:07<00:06,  1.64s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 168855928.1657, 'hit_ratio@10': 0.3553, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8939}:  60%|██████    | 6/10 [00:09<00:06,  1.64s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 168855928.1657, 'hit_ratio@10': 0.3553, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8939}:  70%|███████   | 7/10 [00:09<00:04,  1.46s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 165589887.1164, 'hit_ratio@10': 0.3323, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8429}:  70%|███████   | 7/10 [00:10<00:04,  1.46s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 165589887.1164, 'hit_ratio@10': 0.3323, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8429}:  80%|████████  | 8/10 [00:10<00:02,  1.48s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 157546718.1067, 'hit_ratio@10': 0.3239, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9783}:  80%|████████  | 8/10 [00:12<00:02,  1.48s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 157546718.1067, 'hit_ratio@10': 0.3239, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9783}:  90%|█████████ | 9/10 [00:12<00:01,  1.50s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 149533519.6687, 'hit_ratio@10': 0.3302, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9698}:  90%|█████████ | 9/10 [00:14<00:01,  1.50s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 149533519.6687, 'hit_ratio@10': 0.3302, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9698}: 100%|██████████| 10/10 [00:14<00:00,  1.63s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 149533519.6687, 'hit_ratio@10': 0.3302, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9698}: 100%|██████████| 10/10 [00:14<00:00,  1.40s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 149533519.66874263
Avg hit ratio: 0.33018814631887633
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.969799780845642
Std train time: 1.0454257132874722
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 3861687.8988, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6489}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 3861687.8988, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6489}:  10%|█         | 1/10 [00:00<00:07,  1.19it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 304649785.0462, 'hit_ratio@10': 0.3514, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4831}:  10%|█         | 1/10 [00:02<00:07,  1.19it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 304649785.0462, 'hit_ratio@10': 0.3514, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4831}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 203100181.8664, 'hit_ratio@10': 0.3295, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1515}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 203100181.8664, 'hit_ratio@10': 0.3295, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1515}:  30%|███       | 3/10 [00:02<00:05,  1.37it/s]{'epoch': 31, 'num_users': 5.0, 'loss': 275949555.3998, 'hit_ratio@10': 0.3186, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1567}:  30%|███       | 3/10 [00:03<00:05,  1.37it/s]{'epoch': 31, 'num_users': 5.0, 'loss': 275949555.3998, 'hit_ratio@10': 0.3186, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1567}:  40%|████      | 4/10 [00:03<00:05,  1.09it/s]{'epoch': 31, 'num_users': 5.8, 'loss': 235607272.3839, 'hit_ratio@10': 0.3349, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8619}:  40%|████      | 4/10 [00:05<00:05,  1.09it/s]{'epoch': 31, 'num_users': 5.8, 'loss': 235607272.3839, 'hit_ratio@10': 0.3349, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8619}:  50%|█████     | 5/10 [00:05<00:07,  1.43s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 236513791.0162, 'hit_ratio@10': 0.3235, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8963}:  50%|█████     | 5/10 [00:08<00:07,  1.43s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 236513791.0162, 'hit_ratio@10': 0.3235, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8963}:  60%|██████    | 6/10 [00:08<00:06,  1.66s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 231042920.8024, 'hit_ratio@10': 0.3287, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9421}:  60%|██████    | 6/10 [00:09<00:06,  1.66s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 231042920.8024, 'hit_ratio@10': 0.3287, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9421}:  70%|███████   | 7/10 [00:09<00:04,  1.49s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 202267144.5293, 'hit_ratio@10': 0.3305, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8805}:  70%|███████   | 7/10 [00:10<00:04,  1.49s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 202267144.5293, 'hit_ratio@10': 0.3305, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8805}:  80%|████████  | 8/10 [00:10<00:02,  1.48s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 223327035.2483, 'hit_ratio@10': 0.3255, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0252}:  80%|████████  | 8/10 [00:12<00:02,  1.48s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 223327035.2483, 'hit_ratio@10': 0.3255, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0252}:  90%|█████████ | 9/10 [00:12<00:01,  1.52s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 202453720.012, 'hit_ratio@10': 0.3225, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0075}:  90%|█████████ | 9/10 [00:14<00:01,  1.52s/it]    {'epoch': 31, 'num_users': 6.3, 'loss': 202453720.012, 'hit_ratio@10': 0.3225, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0075}: 100%|██████████| 10/10 [00:14<00:00,  1.63s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 202453720.012, 'hit_ratio@10': 0.3225, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0075}: 100%|██████████| 10/10 [00:14<00:00,  1.41s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 202453720.0119684
Avg hit ratio: 0.3225007459998971
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.007490062713623
Std train time: 1.1195979864134404
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 46712517.6316, 'hit_ratio@10': 0.4737, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5637}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 46712517.6316, 'hit_ratio@10': 0.4737, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5637}:  10%|█         | 1/10 [00:00<00:07,  1.26it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 687895215.2029, 'hit_ratio@10': 0.4304, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4617}:  10%|█         | 1/10 [00:02<00:07,  1.26it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 687895215.2029, 'hit_ratio@10': 0.4304, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4617}:  20%|██        | 2/10 [00:02<00:09,  1.14s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 526081511.8495, 'hit_ratio@10': 0.4298, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1696}:  20%|██        | 2/10 [00:02<00:09,  1.14s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 526081511.8495, 'hit_ratio@10': 0.4298, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1696}:  30%|███       | 3/10 [00:02<00:05,  1.32it/s]{'epoch': 32, 'num_users': 5.0, 'loss': 557362311.8872, 'hit_ratio@10': 0.4027, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1832}:  30%|███       | 3/10 [00:03<00:05,  1.32it/s]{'epoch': 32, 'num_users': 5.0, 'loss': 557362311.8872, 'hit_ratio@10': 0.4027, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1832}:  40%|████      | 4/10 [00:03<00:05,  1.05it/s]{'epoch': 32, 'num_users': 5.8, 'loss': 498028578.5177, 'hit_ratio@10': 0.3902, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8526}:  40%|████      | 4/10 [00:05<00:05,  1.05it/s]{'epoch': 32, 'num_users': 5.8, 'loss': 498028578.5177, 'hit_ratio@10': 0.3902, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8526}:  50%|█████     | 5/10 [00:05<00:07,  1.43s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 558422119.1944, 'hit_ratio@10': 0.3918, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8691}:  50%|█████     | 5/10 [00:07<00:07,  1.43s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 558422119.1944, 'hit_ratio@10': 0.3918, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8691}:  60%|██████    | 6/10 [00:07<00:06,  1.61s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 1331833324.2009, 'hit_ratio@10': 0.3873, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9143}:  60%|██████    | 6/10 [00:09<00:06,  1.61s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 1331833324.2009, 'hit_ratio@10': 0.3873, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9143}:  70%|███████   | 7/10 [00:09<00:04,  1.45s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 1165415083.1755, 'hit_ratio@10': 0.3853, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.869}:  70%|███████   | 7/10 [00:10<00:04,  1.45s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 1165415083.1755, 'hit_ratio@10': 0.3853, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.869}:  80%|████████  | 8/10 [00:10<00:02,  1.49s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 1692049433.7814, 'hit_ratio@10': 0.3647, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.012}:  80%|████████  | 8/10 [00:12<00:02,  1.49s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 1692049433.7814, 'hit_ratio@10': 0.3647, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.012}:  90%|█████████ | 9/10 [00:12<00:01,  1.52s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 1651772879.8215, 'hit_ratio@10': 0.3555, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0002}:  90%|█████████ | 9/10 [00:14<00:01,  1.52s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 1651772879.8215, 'hit_ratio@10': 0.3555, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0002}: 100%|██████████| 10/10 [00:14<00:00,  1.64s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 1651772879.8215, 'hit_ratio@10': 0.3555, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0002}: 100%|██████████| 10/10 [00:14<00:00,  1.42s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 1651772879.8214731
Avg hit ratio: 0.3554936828875708
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.0001771211624146
Std train time: 1.057819218794193
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 98361964005.0526, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5973}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 98361964005.0526, 'hit_ratio@10': 0.1579, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5973}:  10%|█         | 1/10 [00:00<00:07,  1.23it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 52152259577.7521, 'hit_ratio@10': 0.2402, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5077}:  10%|█         | 1/10 [00:02<00:07,  1.23it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 52152259577.7521, 'hit_ratio@10': 0.2402, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5077}:  20%|██        | 2/10 [00:02<00:09,  1.18s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 34946858147.4538, 'hit_ratio@10': 0.2078, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.176}:  20%|██        | 2/10 [00:02<00:09,  1.18s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 34946858147.4538, 'hit_ratio@10': 0.2078, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.176}:  30%|███       | 3/10 [00:02<00:05,  1.31it/s]{'epoch': 33, 'num_users': 5.0, 'loss': 26210607654.8588, 'hit_ratio@10': 0.2451, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1746}:  30%|███       | 3/10 [00:03<00:05,  1.31it/s]{'epoch': 33, 'num_users': 5.0, 'loss': 26210607654.8588, 'hit_ratio@10': 0.2451, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1746}:  40%|████      | 4/10 [00:03<00:05,  1.07it/s]{'epoch': 33, 'num_users': 5.8, 'loss': 21309430092.399, 'hit_ratio@10': 0.2601, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8306}:  40%|████      | 4/10 [00:05<00:05,  1.07it/s] {'epoch': 33, 'num_users': 5.8, 'loss': 21309430092.399, 'hit_ratio@10': 0.2601, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8306}:  50%|█████     | 5/10 [00:05<00:07,  1.40s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 17784095095.2395, 'hit_ratio@10': 0.276, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.839}:  50%|█████     | 5/10 [00:07<00:07,  1.40s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 17784095095.2395, 'hit_ratio@10': 0.276, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.839}:  60%|██████    | 6/10 [00:07<00:06,  1.57s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 15470567479.3024, 'hit_ratio@10': 0.2709, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8754}:  60%|██████    | 6/10 [00:08<00:06,  1.57s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 15470567479.3024, 'hit_ratio@10': 0.2709, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8754}:  70%|███████   | 7/10 [00:08<00:04,  1.41s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 17516512498.2182, 'hit_ratio@10': 0.2906, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8198}:  70%|███████   | 7/10 [00:10<00:04,  1.41s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 17516512498.2182, 'hit_ratio@10': 0.2906, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8198}:  80%|████████  | 8/10 [00:10<00:02,  1.42s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 16290601723.6733, 'hit_ratio@10': 0.2805, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9516}:  80%|████████  | 8/10 [00:11<00:02,  1.42s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 16290601723.6733, 'hit_ratio@10': 0.2805, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9516}:  90%|█████████ | 9/10 [00:11<00:01,  1.45s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 15169571808.7787, 'hit_ratio@10': 0.2934, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9428}:  90%|█████████ | 9/10 [00:13<00:01,  1.45s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 15169571808.7787, 'hit_ratio@10': 0.2934, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9428}: 100%|██████████| 10/10 [00:13<00:00,  1.58s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 15169571808.7787, 'hit_ratio@10': 0.2934, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9428}: 100%|██████████| 10/10 [00:13<00:00,  1.38s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 15169571808.778683
Avg hit ratio: 0.2933693275221289
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9427998781204223
Std train time: 1.0378320749782173
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 30030924368.8421, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4804}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 30030924368.8421, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4804}:  10%|█         | 1/10 [00:00<00:06,  1.33it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 29126276417.1952, 'hit_ratio@10': 0.3294, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4101}:  10%|█         | 1/10 [00:02<00:06,  1.33it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 29126276417.1952, 'hit_ratio@10': 0.3294, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4101}:  20%|██        | 2/10 [00:02<00:08,  1.11s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 19417827958.3147, 'hit_ratio@10': 0.3624, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1219}:  20%|██        | 2/10 [00:02<00:08,  1.11s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 19417827958.3147, 'hit_ratio@10': 0.3624, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1219}:  30%|███       | 3/10 [00:02<00:05,  1.36it/s]{'epoch': 34, 'num_users': 5.0, 'loss': 54552789702.4503, 'hit_ratio@10': 0.37, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.125}:  30%|███       | 3/10 [00:03<00:05,  1.36it/s]   {'epoch': 34, 'num_users': 5.0, 'loss': 54552789702.4503, 'hit_ratio@10': 0.37, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.125}:  40%|████      | 4/10 [00:03<00:05,  1.11it/s]{'epoch': 34, 'num_users': 5.8, 'loss': 43967242710.8242, 'hit_ratio@10': 0.368, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7955}:  40%|████      | 4/10 [00:05<00:05,  1.11it/s]{'epoch': 34, 'num_users': 5.8, 'loss': 43967242710.8242, 'hit_ratio@10': 0.368, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7955}:  50%|█████     | 5/10 [00:05<00:06,  1.39s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 38773950510.2795, 'hit_ratio@10': 0.34, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8157}:  50%|█████     | 5/10 [00:07<00:06,  1.39s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 38773950510.2795, 'hit_ratio@10': 0.34, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8157}:  60%|██████    | 6/10 [00:07<00:06,  1.57s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 37552622117.4738, 'hit_ratio@10': 0.3315, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8659}:  60%|██████    | 6/10 [00:08<00:06,  1.57s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 37552622117.4738, 'hit_ratio@10': 0.3315, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8659}:  70%|███████   | 7/10 [00:08<00:04,  1.42s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 32870889893.9985, 'hit_ratio@10': 0.3365, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8237}:  70%|███████   | 7/10 [00:10<00:04,  1.42s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 32870889893.9985, 'hit_ratio@10': 0.3365, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8237}:  80%|████████  | 8/10 [00:10<00:02,  1.46s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 31099196668.6781, 'hit_ratio@10': 0.3213, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9766}:  80%|████████  | 8/10 [00:12<00:02,  1.46s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 31099196668.6781, 'hit_ratio@10': 0.3213, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9766}:  90%|█████████ | 9/10 [00:12<00:01,  1.51s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 28578655822.3193, 'hit_ratio@10': 0.321, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9779}:  90%|█████████ | 9/10 [00:14<00:01,  1.51s/it]    {'epoch': 34, 'num_users': 6.3, 'loss': 28578655822.3193, 'hit_ratio@10': 0.321, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9779}: 100%|██████████| 10/10 [00:14<00:00,  1.66s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 28578655822.3193, 'hit_ratio@10': 0.321, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9779}: 100%|██████████| 10/10 [00:14<00:00,  1.40s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 28578655822.319336
Avg hit ratio: 0.32097825943157016
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9778807878494262
Std train time: 1.0676500170081287
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 3834579.0724, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.761}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 3834579.0724, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.761}:  10%|█         | 1/10 [00:00<00:08,  1.09it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 23665114989.6652, 'hit_ratio@10': 0.2869, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5369}:  10%|█         | 1/10 [00:02<00:08,  1.09it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 23665114989.6652, 'hit_ratio@10': 0.2869, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5369}:  20%|██        | 2/10 [00:02<00:09,  1.16s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 15776989946.3006, 'hit_ratio@10': 0.2865, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1798}:  20%|██        | 2/10 [00:02<00:09,  1.16s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 15776989946.3006, 'hit_ratio@10': 0.2865, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1798}:  30%|███       | 3/10 [00:02<00:05,  1.35it/s]{'epoch': 35, 'num_users': 5.0, 'loss': 37186381737.4398, 'hit_ratio@10': 0.2506, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1816}:  30%|███       | 3/10 [00:03<00:05,  1.35it/s]{'epoch': 35, 'num_users': 5.0, 'loss': 37186381737.4398, 'hit_ratio@10': 0.2506, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1816}:  40%|████      | 4/10 [00:03<00:05,  1.08it/s]{'epoch': 35, 'num_users': 5.8, 'loss': 42272890073.4718, 'hit_ratio@10': 0.2765, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8083}:  40%|████      | 4/10 [00:05<00:05,  1.08it/s]{'epoch': 35, 'num_users': 5.8, 'loss': 42272890073.4718, 'hit_ratio@10': 0.2765, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8083}:  50%|█████     | 5/10 [00:05<00:06,  1.37s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 35227953351.3137, 'hit_ratio@10': 0.2934, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8352}:  50%|█████     | 5/10 [00:07<00:06,  1.37s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 35227953351.3137, 'hit_ratio@10': 0.2934, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8352}:  60%|██████    | 6/10 [00:07<00:06,  1.58s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 31079273924.6232, 'hit_ratio@10': 0.3029, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8803}:  60%|██████    | 6/10 [00:08<00:06,  1.58s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 31079273924.6232, 'hit_ratio@10': 0.3029, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8803}:  70%|███████   | 7/10 [00:08<00:04,  1.42s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 27196871041.6558, 'hit_ratio@10': 0.315, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8311}:  70%|███████   | 7/10 [00:10<00:04,  1.42s/it]  {'epoch': 35, 'num_users': 6.125, 'loss': 27196871041.6558, 'hit_ratio@10': 0.315, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8311}:  80%|████████  | 8/10 [00:10<00:02,  1.45s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 25360166522.7954, 'hit_ratio@10': 0.3181, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9696}:  80%|████████  | 8/10 [00:11<00:02,  1.45s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 25360166522.7954, 'hit_ratio@10': 0.3181, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9696}:  90%|█████████ | 9/10 [00:11<00:01,  1.48s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 29734933172.3341, 'hit_ratio@10': 0.3204, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9602}:  90%|█████████ | 9/10 [00:13<00:01,  1.48s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 29734933172.3341, 'hit_ratio@10': 0.3204, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9602}: 100%|██████████| 10/10 [00:13<00:00,  1.61s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 29734933172.3341, 'hit_ratio@10': 0.3204, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9602}: 100%|██████████| 10/10 [00:13<00:00,  1.39s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 29734933172.334064
Avg hit ratio: 0.3203969429928683
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9601834058761596
Std train time: 1.0175570218876517
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 342066848390.7368, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7252}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 342066848390.7368, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7252}:  10%|█         | 1/10 [00:00<00:07,  1.14it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 332870526308.4006, 'hit_ratio@10': 0.18, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.537}:  10%|█         | 1/10 [00:02<00:07,  1.14it/s]   {'epoch': 36, 'num_users': 7.0, 'loss': 332870526308.4006, 'hit_ratio@10': 0.18, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.537}:  20%|██        | 2/10 [00:02<00:09,  1.17s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 221979797215.3147, 'hit_ratio@10': 0.12, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2177}:  20%|██        | 2/10 [00:02<00:09,  1.17s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 221979797215.3147, 'hit_ratio@10': 0.12, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2177}:  30%|███       | 3/10 [00:02<00:05,  1.29it/s]{'epoch': 36, 'num_users': 5.0, 'loss': 166572347534.4146, 'hit_ratio@10': 0.1525, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2037}:  30%|███       | 3/10 [00:03<00:05,  1.29it/s]{'epoch': 36, 'num_users': 5.0, 'loss': 166572347534.4146, 'hit_ratio@10': 0.1525, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2037}:  40%|████      | 4/10 [00:03<00:05,  1.07it/s]{'epoch': 36, 'num_users': 5.8, 'loss': 133263121193.4777, 'hit_ratio@10': 0.194, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8679}:  40%|████      | 4/10 [00:06<00:05,  1.07it/s] {'epoch': 36, 'num_users': 5.8, 'loss': 133263121193.4777, 'hit_ratio@10': 0.194, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8679}:  50%|█████     | 5/10 [00:06<00:07,  1.42s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 136039194456.6092, 'hit_ratio@10': 0.2246, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8829}:  50%|█████     | 5/10 [00:07<00:07,  1.42s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 136039194456.6092, 'hit_ratio@10': 0.2246, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8829}:  60%|██████    | 6/10 [00:07<00:06,  1.61s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 400307604073.2079, 'hit_ratio@10': 0.2268, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9364}:  60%|██████    | 6/10 [00:09<00:06,  1.61s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 400307604073.2079, 'hit_ratio@10': 0.2268, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9364}:  70%|███████   | 7/10 [00:09<00:04,  1.46s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 372938487795.8283, 'hit_ratio@10': 0.2449, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8744}:  70%|███████   | 7/10 [00:10<00:04,  1.46s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 372938487795.8283, 'hit_ratio@10': 0.2449, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8744}:  80%|████████  | 8/10 [00:10<00:02,  1.46s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 672823918061.0537, 'hit_ratio@10': 0.2526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0311}:  80%|████████  | 8/10 [00:12<00:02,  1.46s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 672823918061.0537, 'hit_ratio@10': 0.2526, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0311}:  90%|█████████ | 9/10 [00:12<00:01,  1.52s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 620404347196.3302, 'hit_ratio@10': 0.2501, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.026}:  90%|█████████ | 9/10 [00:14<00:01,  1.52s/it]    {'epoch': 36, 'num_users': 6.3, 'loss': 620404347196.3302, 'hit_ratio@10': 0.2501, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.026}: 100%|██████████| 10/10 [00:14<00:00,  1.67s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 620404347196.3302, 'hit_ratio@10': 0.2501, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.026}: 100%|██████████| 10/10 [00:14<00:00,  1.42s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 620404347196.3303
Avg hit ratio: 0.25006968790500195
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.0259575843811035
Std train time: 1.0780924448389504
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 2298720257724.6313, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6024}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 2298720257724.6313, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6024}:  10%|█         | 1/10 [00:00<00:07,  1.23it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 1644934204320.3801, 'hit_ratio@10': 0.2827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4718}:  10%|█         | 1/10 [00:02<00:07,  1.23it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 1644934204320.3801, 'hit_ratio@10': 0.2827, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4718}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 1199026946471.8723, 'hit_ratio@10': 0.2837, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1794}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 1199026946471.8723, 'hit_ratio@10': 0.2837, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1794}:  30%|███       | 3/10 [00:02<00:05,  1.32it/s]{'epoch': 37, 'num_users': 5.0, 'loss': 899284347874.6941, 'hit_ratio@10': 0.2663, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2196}:  30%|███       | 3/10 [00:03<00:05,  1.32it/s] {'epoch': 37, 'num_users': 5.0, 'loss': 899284347874.6941, 'hit_ratio@10': 0.2663, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2196}:  40%|████      | 4/10 [00:03<00:05,  1.01it/s]{'epoch': 37, 'num_users': 5.8, 'loss': 890900096361.5793, 'hit_ratio@10': 0.2971, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8663}:  40%|████      | 4/10 [00:06<00:05,  1.01it/s]{'epoch': 37, 'num_users': 5.8, 'loss': 890900096361.5793, 'hit_ratio@10': 0.2971, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8663}:  50%|█████     | 5/10 [00:06<00:07,  1.44s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 845866503768.9308, 'hit_ratio@10': 0.2735, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9013}:  50%|█████     | 5/10 [00:08<00:07,  1.44s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 845866503768.9308, 'hit_ratio@10': 0.2735, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9013}:  60%|██████    | 6/10 [00:08<00:06,  1.67s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 729760187885.1407, 'hit_ratio@10': 0.2916, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9359}:  60%|██████    | 6/10 [00:09<00:06,  1.67s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 729760187885.1407, 'hit_ratio@10': 0.2916, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9359}:  70%|███████   | 7/10 [00:09<00:04,  1.48s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 719307230511.4982, 'hit_ratio@10': 0.2837, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8876}:  70%|███████   | 7/10 [00:10<00:04,  1.48s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 719307230511.4982, 'hit_ratio@10': 0.2837, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8876}:  80%|████████  | 8/10 [00:10<00:03,  1.51s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 689708980997.0396, 'hit_ratio@10': 0.2903, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0289}:  80%|████████  | 8/10 [00:12<00:03,  1.51s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 689708980997.0396, 'hit_ratio@10': 0.2903, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0289}:  90%|█████████ | 9/10 [00:12<00:01,  1.53s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 652822244284.3903, 'hit_ratio@10': 0.3044, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0092}:  90%|█████████ | 9/10 [00:14<00:01,  1.53s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 652822244284.3903, 'hit_ratio@10': 0.3044, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0092}: 100%|██████████| 10/10 [00:14<00:00,  1.63s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 652822244284.3903, 'hit_ratio@10': 0.3044, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0092}: 100%|██████████| 10/10 [00:14<00:00,  1.43s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 652822244284.3904
Avg hit ratio: 0.3044167334269202
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.0091940641403196
Std train time: 1.0306181266345424
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 14081722886251.79, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6127}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 14081722886251.79, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6127}:  10%|█         | 1/10 [00:00<00:07,  1.22it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 7900594021033.508, 'hit_ratio@10': 0.3879, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5122}:  10%|█         | 1/10 [00:02<00:07,  1.22it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 7900594021033.508, 'hit_ratio@10': 0.3879, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5122}:  20%|██        | 2/10 [00:02<00:09,  1.19s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 5267123519447.862, 'hit_ratio@10': 0.3539, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1832}:  20%|██        | 2/10 [00:02<00:09,  1.19s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 5267123519447.862, 'hit_ratio@10': 0.3539, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1832}:  30%|███       | 3/10 [00:02<00:05,  1.30it/s]{'epoch': 38, 'num_users': 5.0, 'loss': 7265515961752.754, 'hit_ratio@10': 0.3547, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1804}:  30%|███       | 3/10 [00:03<00:05,  1.30it/s]{'epoch': 38, 'num_users': 5.0, 'loss': 7265515961752.754, 'hit_ratio@10': 0.3547, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1804}:  40%|████      | 4/10 [00:03<00:05,  1.07it/s]{'epoch': 38, 'num_users': 5.8, 'loss': 5855062204722.523, 'hit_ratio@10': 0.3477, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8364}:  40%|████      | 4/10 [00:05<00:05,  1.07it/s]{'epoch': 38, 'num_users': 5.8, 'loss': 5855062204722.523, 'hit_ratio@10': 0.3477, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8364}:  50%|█████     | 5/10 [00:05<00:07,  1.41s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 5047819388682.813, 'hit_ratio@10': 0.3491, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8665}:  50%|█████     | 5/10 [00:08<00:07,  1.41s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 5047819388682.813, 'hit_ratio@10': 0.3491, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8665}:  60%|██████    | 6/10 [00:08<00:06,  1.62s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 4627162347649.224, 'hit_ratio@10': 0.3678, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9128}:  60%|██████    | 6/10 [00:09<00:06,  1.62s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 4627162347649.224, 'hit_ratio@10': 0.3678, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9128}:  70%|███████   | 7/10 [00:09<00:04,  1.45s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 4393227991233.5273, 'hit_ratio@10': 0.3361, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8483}:  70%|███████   | 7/10 [00:10<00:04,  1.45s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 4393227991233.5273, 'hit_ratio@10': 0.3361, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8483}:  80%|████████  | 8/10 [00:10<00:02,  1.44s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 3905269770774.1323, 'hit_ratio@10': 0.3241, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9863}:  80%|████████  | 8/10 [00:12<00:02,  1.44s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 3905269770774.1323, 'hit_ratio@10': 0.3241, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9863}:  90%|█████████ | 9/10 [00:12<00:01,  1.48s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 3679556257099.7734, 'hit_ratio@10': 0.3258, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9724}:  90%|█████████ | 9/10 [00:13<00:01,  1.48s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 3679556257099.7734, 'hit_ratio@10': 0.3258, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9724}: 100%|██████████| 10/10 [00:13<00:00,  1.60s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 3679556257099.7734, 'hit_ratio@10': 0.3258, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9724}: 100%|██████████| 10/10 [00:13<00:00,  1.40s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 3679556257099.7734
Avg hit ratio: 0.3258070273435299
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.97236909866333
Std train time: 1.0496021944549327
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 679381872640.0, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7426}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 679381872640.0, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7426}:  10%|█         | 1/10 [00:00<00:07,  1.13it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 7408576898675.613, 'hit_ratio@10': 0.2445, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5808}:  10%|█         | 1/10 [00:02<00:07,  1.13it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 7408576898675.613, 'hit_ratio@10': 0.2445, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5808}:  20%|██        | 2/10 [00:02<00:09,  1.21s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 4939073768163.552, 'hit_ratio@10': 0.3058, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.232}:  20%|██        | 2/10 [00:02<00:09,  1.21s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 4939073768163.552, 'hit_ratio@10': 0.3058, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.232}:  30%|███       | 3/10 [00:02<00:05,  1.27it/s]{'epoch': 39, 'num_users': 5.0, 'loss': 5855827173711.235, 'hit_ratio@10': 0.3097, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2363}:  30%|███       | 3/10 [00:03<00:05,  1.27it/s]{'epoch': 39, 'num_users': 5.0, 'loss': 5855827173711.235, 'hit_ratio@10': 0.3097, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2363}:  40%|████      | 4/10 [00:03<00:05,  1.03it/s]{'epoch': 39, 'num_users': 5.8, 'loss': 6298416428095.389, 'hit_ratio@10': 0.3278, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.891}:  40%|████      | 4/10 [00:06<00:05,  1.03it/s] {'epoch': 39, 'num_users': 5.8, 'loss': 6298416428095.389, 'hit_ratio@10': 0.3278, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.891}:  50%|█████     | 5/10 [00:06<00:07,  1.44s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 6394082584996.706, 'hit_ratio@10': 0.3324, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8942}:  50%|█████     | 5/10 [00:08<00:07,  1.44s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 6394082584996.706, 'hit_ratio@10': 0.3324, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8942}:  60%|██████    | 6/10 [00:08<00:06,  1.61s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 5717509210847.096, 'hit_ratio@10': 0.3306, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9264}:  60%|██████    | 6/10 [00:09<00:06,  1.61s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 5717509210847.096, 'hit_ratio@10': 0.3306, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9264}:  70%|███████   | 7/10 [00:09<00:04,  1.43s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 9460092848829.723, 'hit_ratio@10': 0.3322, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8723}:  70%|███████   | 7/10 [00:10<00:04,  1.43s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 9460092848829.723, 'hit_ratio@10': 0.3322, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8723}:  80%|████████  | 8/10 [00:10<00:02,  1.46s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 12196702298917.799, 'hit_ratio@10': 0.3397, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0354}:  80%|████████  | 8/10 [00:12<00:02,  1.46s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 12196702298917.799, 'hit_ratio@10': 0.3397, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0354}:  90%|█████████ | 9/10 [00:12<00:01,  1.53s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 11552202374994.893, 'hit_ratio@10': 0.3262, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0324}:  90%|█████████ | 9/10 [00:14<00:01,  1.53s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 11552202374994.893, 'hit_ratio@10': 0.3262, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0324}: 100%|██████████| 10/10 [00:14<00:00,  1.68s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 11552202374994.893, 'hit_ratio@10': 0.3262, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0324}: 100%|██████████| 10/10 [00:14<00:00,  1.44s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 11552202374994.893
Avg hit ratio: 0.3261922499307898
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.0324371337890623
Std train time: 1.0712955475318462
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 86094292202981.05, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6905}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 86094292202981.05, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6905}:  10%|█         | 1/10 [00:00<00:07,  1.15it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 48419308507824.46, 'hit_ratio@10': 0.2122, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5386}:  10%|█         | 1/10 [00:02<00:07,  1.15it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 48419308507824.46, 'hit_ratio@10': 0.2122, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5386}:  20%|██        | 2/10 [00:02<00:09,  1.18s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 32289688962409.45, 'hit_ratio@10': 0.1891, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2016}:  20%|██        | 2/10 [00:02<00:09,  1.18s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 32289688962409.45, 'hit_ratio@10': 0.1891, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2016}:  30%|███       | 3/10 [00:02<00:05,  1.30it/s]{'epoch': 40, 'num_users': 5.0, 'loss': 24222600031532.23, 'hit_ratio@10': 0.2222, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1892}:  30%|███       | 3/10 [00:03<00:05,  1.30it/s]{'epoch': 40, 'num_users': 5.0, 'loss': 24222600031532.23, 'hit_ratio@10': 0.2222, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1892}:  40%|████      | 4/10 [00:03<00:05,  1.08it/s]{'epoch': 40, 'num_users': 5.8, 'loss': 21598755431567.67, 'hit_ratio@10': 0.2297, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8901}:  40%|████      | 4/10 [00:06<00:05,  1.08it/s]{'epoch': 40, 'num_users': 5.8, 'loss': 21598755431567.67, 'hit_ratio@10': 0.2297, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8901}:  50%|█████     | 5/10 [00:06<00:07,  1.44s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 19716888818394.332, 'hit_ratio@10': 0.2396, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9228}:  50%|█████     | 5/10 [00:08<00:07,  1.44s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 19716888818394.332, 'hit_ratio@10': 0.2396, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9228}:  60%|██████    | 6/10 [00:08<00:06,  1.67s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 32765626694012.242, 'hit_ratio@10': 0.2511, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9655}:  60%|██████    | 6/10 [00:09<00:06,  1.67s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 32765626694012.242, 'hit_ratio@10': 0.2511, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9655}:  70%|███████   | 7/10 [00:09<00:04,  1.49s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 36045844439979.8, 'hit_ratio@10': 0.2733, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9124}:  70%|███████   | 7/10 [00:10<00:04,  1.49s/it]   {'epoch': 40, 'num_users': 6.125, 'loss': 36045844439979.8, 'hit_ratio@10': 0.2733, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9124}:  80%|████████  | 8/10 [00:10<00:03,  1.51s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 36147173653490.914, 'hit_ratio@10': 0.2715, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0333}:  80%|████████  | 8/10 [00:12<00:03,  1.51s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 36147173653490.914, 'hit_ratio@10': 0.2715, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0333}:  90%|█████████ | 9/10 [00:12<00:01,  1.51s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 34586507954471.426, 'hit_ratio@10': 0.2943, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0175}:  90%|█████████ | 9/10 [00:14<00:01,  1.51s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 34586507954471.426, 'hit_ratio@10': 0.2943, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0175}: 100%|██████████| 10/10 [00:14<00:00,  1.63s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 34586507954471.426, 'hit_ratio@10': 0.2943, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0175}: 100%|██████████| 10/10 [00:14<00:00,  1.43s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 34586507954471.426
Avg hit ratio: 0.2943337106206376
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.017496418952942
Std train time: 1.0905023351932657
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 78048249581783.58, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5738}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 78048249581783.58, 'hit_ratio@10': 0.2105, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5738}:  10%|█         | 1/10 [00:00<00:07,  1.25it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 141002707237896.7, 'hit_ratio@10': 0.2504, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4541}:  10%|█         | 1/10 [00:02<00:07,  1.25it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 141002707237896.7, 'hit_ratio@10': 0.2504, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4541}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 103227378698635.89, 'hit_ratio@10': 0.3098, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.154}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 103227378698635.89, 'hit_ratio@10': 0.3098, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.154}:  30%|███       | 3/10 [00:02<00:05,  1.34it/s]{'epoch': 41, 'num_users': 5.0, 'loss': 90968284776930.06, 'hit_ratio@10': 0.2949, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1427}:  30%|███       | 3/10 [00:03<00:05,  1.34it/s]{'epoch': 41, 'num_users': 5.0, 'loss': 90968284776930.06, 'hit_ratio@10': 0.2949, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1427}:  40%|████      | 4/10 [00:03<00:05,  1.12it/s]{'epoch': 41, 'num_users': 5.8, 'loss': 108464753146782.33, 'hit_ratio@10': 0.3079, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8176}:  40%|████      | 4/10 [00:05<00:05,  1.12it/s]{'epoch': 41, 'num_users': 5.8, 'loss': 108464753146782.33, 'hit_ratio@10': 0.3079, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8176}:  50%|█████     | 5/10 [00:05<00:06,  1.40s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 110163583564161.08, 'hit_ratio@10': 0.301, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8704}:  50%|█████     | 5/10 [00:08<00:06,  1.40s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 110163583564161.08, 'hit_ratio@10': 0.301, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8704}:  60%|██████    | 6/10 [00:08<00:06,  1.65s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 97728716610954.42, 'hit_ratio@10': 0.3266, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9101}:  60%|██████    | 6/10 [00:09<00:06,  1.65s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 97728716610954.42, 'hit_ratio@10': 0.3266, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9101}:  70%|███████   | 7/10 [00:09<00:04,  1.47s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 85523691659826.27, 'hit_ratio@10': 0.3358, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8647}:  70%|███████   | 7/10 [00:10<00:04,  1.47s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 85523691659826.27, 'hit_ratio@10': 0.3358, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8647}:  80%|████████  | 8/10 [00:10<00:02,  1.50s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 76054585040121.48, 'hit_ratio@10': 0.327, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9809}:  80%|████████  | 8/10 [00:12<00:02,  1.50s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 76054585040121.48, 'hit_ratio@10': 0.327, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9809}:  90%|█████████ | 9/10 [00:12<00:01,  1.49s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 75155457161747.73, 'hit_ratio@10': 0.3284, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9657}:  90%|█████████ | 9/10 [00:13<00:01,  1.49s/it]  {'epoch': 41, 'num_users': 6.3, 'loss': 75155457161747.73, 'hit_ratio@10': 0.3284, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9657}: 100%|██████████| 10/10 [00:13<00:00,  1.60s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 75155457161747.73, 'hit_ratio@10': 0.3284, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9657}: 100%|██████████| 10/10 [00:13<00:00,  1.40s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 75155457161747.75
Avg hit ratio: 0.3284138939724678
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9656731128692626
Std train time: 1.0460042206180304
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 1.1065539740386142e+16, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6377}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 1.1065539740386142e+16, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6377}:  10%|█         | 1/10 [00:00<00:07,  1.20it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 5819721992244490.0, 'hit_ratio@10': 0.2929, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4647}:  10%|█         | 1/10 [00:02<00:07,  1.20it/s]    {'epoch': 42, 'num_users': 7.0, 'loss': 5819721992244490.0, 'hit_ratio@10': 0.2929, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4647}:  20%|██        | 2/10 [00:02<00:08,  1.11s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 3879825690588581.5, 'hit_ratio@10': 0.2429, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1414}:  20%|██        | 2/10 [00:02<00:08,  1.11s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 3879825690588581.5, 'hit_ratio@10': 0.2429, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1414}:  30%|███       | 3/10 [00:02<00:05,  1.38it/s]{'epoch': 42, 'num_users': 5.0, 'loss': 3241737169935566.5, 'hit_ratio@10': 0.2357, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1452}:  30%|███       | 3/10 [00:03<00:05,  1.38it/s]{'epoch': 42, 'num_users': 5.0, 'loss': 3241737169935566.5, 'hit_ratio@10': 0.2357, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1452}:  40%|████      | 4/10 [00:03<00:05,  1.11it/s]{'epoch': 42, 'num_users': 5.8, 'loss': 2653417687796549.0, 'hit_ratio@10': 0.2646, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8233}:  40%|████      | 4/10 [00:05<00:05,  1.11it/s]{'epoch': 42, 'num_users': 5.8, 'loss': 2653417687796549.0, 'hit_ratio@10': 0.2646, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8233}:  50%|█████     | 5/10 [00:05<00:07,  1.40s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 2256428583183541.5, 'hit_ratio@10': 0.2464, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.859}:  50%|█████     | 5/10 [00:07<00:07,  1.40s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 2256428583183541.5, 'hit_ratio@10': 0.2464, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.859}:  60%|██████    | 6/10 [00:07<00:06,  1.62s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 2118003449611835.2, 'hit_ratio@10': 0.2512, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9237}:  60%|██████    | 6/10 [00:09<00:06,  1.62s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 2118003449611835.2, 'hit_ratio@10': 0.2512, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9237}:  70%|███████   | 7/10 [00:09<00:04,  1.48s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 1926733366685629.0, 'hit_ratio@10': 0.2662, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8624}:  70%|███████   | 7/10 [00:10<00:04,  1.48s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 1926733366685629.0, 'hit_ratio@10': 0.2662, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8624}:  80%|████████  | 8/10 [00:10<00:02,  1.47s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 1855960594421173.8, 'hit_ratio@10': 0.262, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9955}:  80%|████████  | 8/10 [00:12<00:02,  1.47s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 1855960594421173.8, 'hit_ratio@10': 0.262, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9955}:  90%|█████████ | 9/10 [00:12<00:01,  1.49s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 1702909155259423.0, 'hit_ratio@10': 0.2654, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9872}:  90%|█████████ | 9/10 [00:14<00:01,  1.49s/it]  {'epoch': 42, 'num_users': 6.3, 'loss': 1702909155259423.0, 'hit_ratio@10': 0.2654, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9872}: 100%|██████████| 10/10 [00:14<00:00,  1.63s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 1702909155259423.0, 'hit_ratio@10': 0.2654, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9872}: 100%|██████████| 10/10 [00:14<00:00,  1.40s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 1702909155259422.8
Avg hit ratio: 0.265389149805109
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9872313022613526
Std train time: 1.0764668179481527
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 802770356259355.0, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6169}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 802770356259355.0, 'hit_ratio@10': 0.2632, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6169}:  10%|█         | 1/10 [00:00<00:07,  1.22it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 527228955936806.25, 'hit_ratio@10': 0.2767, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4943}:  10%|█         | 1/10 [00:02<00:07,  1.22it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 527228955936806.25, 'hit_ratio@10': 0.2767, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4943}:  20%|██        | 2/10 [00:02<00:09,  1.15s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 351495466640653.3, 'hit_ratio@10': 0.2797, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1788}:  20%|██        | 2/10 [00:02<00:09,  1.15s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 351495466640653.3, 'hit_ratio@10': 0.2797, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1788}:  30%|███       | 3/10 [00:02<00:05,  1.32it/s]{'epoch': 43, 'num_users': 5.0, 'loss': 1733329318734794.0, 'hit_ratio@10': 0.2991, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1598}:  30%|███       | 3/10 [00:03<00:05,  1.32it/s]{'epoch': 43, 'num_users': 5.0, 'loss': 1733329318734794.0, 'hit_ratio@10': 0.2991, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1598}:  40%|████      | 4/10 [00:03<00:05,  1.11it/s]{'epoch': 43, 'num_users': 5.8, 'loss': 1386787222576568.2, 'hit_ratio@10': 0.3233, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8976}:  40%|████      | 4/10 [00:06<00:05,  1.11it/s]{'epoch': 43, 'num_users': 5.8, 'loss': 1386787222576568.2, 'hit_ratio@10': 0.3233, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8976}:  50%|█████     | 5/10 [00:06<00:07,  1.46s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 1669391078242743.0, 'hit_ratio@10': 0.3175, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9406}:  50%|█████     | 5/10 [00:08<00:07,  1.46s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 1669391078242743.0, 'hit_ratio@10': 0.3175, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9406}:  60%|██████    | 6/10 [00:08<00:06,  1.70s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 2800895339575684.0, 'hit_ratio@10': 0.3065, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9841}:  60%|██████    | 6/10 [00:09<00:06,  1.70s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 2800895339575684.0, 'hit_ratio@10': 0.3065, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9841}:  70%|███████   | 7/10 [00:09<00:04,  1.52s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 3772511564236986.0, 'hit_ratio@10': 0.3003, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9173}:  70%|███████   | 7/10 [00:10<00:04,  1.52s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 3772511564236986.0, 'hit_ratio@10': 0.3003, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9173}:  80%|████████  | 8/10 [00:10<00:03,  1.50s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 3425144043449532.0, 'hit_ratio@10': 0.2955, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0423}:  80%|████████  | 8/10 [00:12<00:03,  1.50s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 3425144043449532.0, 'hit_ratio@10': 0.2955, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0423}:  90%|█████████ | 9/10 [00:12<00:01,  1.51s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 3286198462097177.0, 'hit_ratio@10': 0.2978, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0238}:  90%|█████████ | 9/10 [00:14<00:01,  1.51s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 3286198462097177.0, 'hit_ratio@10': 0.2978, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0238}: 100%|██████████| 10/10 [00:14<00:00,  1.62s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 3286198462097177.0, 'hit_ratio@10': 0.2978, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0238}: 100%|██████████| 10/10 [00:14<00:00,  1.43s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 3286198462097177.0
Avg hit ratio: 0.29776940395955676
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.023833966255188
Std train time: 1.1426258634880537
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 4740243682464822.0, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6121}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 4740243682464822.0, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6121}:  10%|█         | 1/10 [00:00<00:07,  1.22it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 7356586266852263.0, 'hit_ratio@10': 0.3616, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4749}:  10%|█         | 1/10 [00:02<00:07,  1.22it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 7356586266852263.0, 'hit_ratio@10': 0.3616, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4749}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 4904396073715092.0, 'hit_ratio@10': 0.3363, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1668}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 4904396073715092.0, 'hit_ratio@10': 0.3363, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1668}:  30%|███       | 3/10 [00:02<00:05,  1.34it/s]{'epoch': 44, 'num_users': 5.0, 'loss': 4879916723253149.0, 'hit_ratio@10': 0.3237, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1785}:  30%|███       | 3/10 [00:03<00:05,  1.34it/s]{'epoch': 44, 'num_users': 5.0, 'loss': 4879916723253149.0, 'hit_ratio@10': 0.3237, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1785}:  40%|████      | 4/10 [00:03<00:05,  1.07it/s]{'epoch': 44, 'num_users': 5.8, 'loss': 4617370569550384.0, 'hit_ratio@10': 0.3389, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8329}:  40%|████      | 4/10 [00:05<00:05,  1.07it/s]{'epoch': 44, 'num_users': 5.8, 'loss': 4617370569550384.0, 'hit_ratio@10': 0.3389, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8329}:  50%|█████     | 5/10 [00:05<00:07,  1.41s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 3934047507729632.0, 'hit_ratio@10': 0.3454, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8592}:  50%|█████     | 5/10 [00:07<00:07,  1.41s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 3934047507729632.0, 'hit_ratio@10': 0.3454, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8592}:  60%|██████    | 6/10 [00:07<00:06,  1.61s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 4719774866412683.0, 'hit_ratio@10': 0.3246, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9048}:  60%|██████    | 6/10 [00:09<00:06,  1.61s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 4719774866412683.0, 'hit_ratio@10': 0.3246, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9048}:  70%|███████   | 7/10 [00:09<00:04,  1.45s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 4839568497303473.0, 'hit_ratio@10': 0.2983, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8529}:  70%|███████   | 7/10 [00:10<00:04,  1.45s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 4839568497303473.0, 'hit_ratio@10': 0.2983, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8529}:  80%|████████  | 8/10 [00:10<00:02,  1.46s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 4379390784470450.0, 'hit_ratio@10': 0.2969, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0012}:  80%|████████  | 8/10 [00:12<00:02,  1.46s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 4379390784470450.0, 'hit_ratio@10': 0.2969, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0012}:  90%|█████████ | 9/10 [00:12<00:01,  1.51s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 4146219871713605.5, 'hit_ratio@10': 0.2945, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9907}:  90%|█████████ | 9/10 [00:14<00:01,  1.51s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 4146219871713605.5, 'hit_ratio@10': 0.2945, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9907}: 100%|██████████| 10/10 [00:14<00:00,  1.63s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 4146219871713605.5, 'hit_ratio@10': 0.2945, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9907}: 100%|██████████| 10/10 [00:14<00:00,  1.41s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 4146219871713605.5
Avg hit ratio: 0.294519338424262
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9906722784042359
Std train time: 1.049996960093562
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 1418707315692598.0, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5921}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 1418707315692598.0, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5921}:  10%|█         | 1/10 [00:00<00:07,  1.23it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 1.6087353921933388e+16, 'hit_ratio@10': 0.4202, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4487}:  10%|█         | 1/10 [00:02<00:07,  1.23it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 1.6087353921933388e+16, 'hit_ratio@10': 0.4202, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4487}:  20%|██        | 2/10 [00:02<00:08,  1.11s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 2.4716952889033924e+16, 'hit_ratio@10': 0.3754, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1367}:  20%|██        | 2/10 [00:02<00:08,  1.11s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 2.4716952889033924e+16, 'hit_ratio@10': 0.3754, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1367}:  30%|███       | 3/10 [00:02<00:05,  1.37it/s]{'epoch': 45, 'num_users': 5.0, 'loss': 2.0127610940001464e+16, 'hit_ratio@10': 0.3708, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1447}:  30%|███       | 3/10 [00:03<00:05,  1.37it/s]{'epoch': 45, 'num_users': 5.0, 'loss': 2.0127610940001464e+16, 'hit_ratio@10': 0.3708, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1447}:  40%|████      | 4/10 [00:03<00:05,  1.10it/s]{'epoch': 45, 'num_users': 5.8, 'loss': 1.6187565181992026e+16, 'hit_ratio@10': 0.3847, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7979}:  40%|████      | 4/10 [00:05<00:05,  1.10it/s]{'epoch': 45, 'num_users': 5.8, 'loss': 1.6187565181992026e+16, 'hit_ratio@10': 0.3847, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7979}:  50%|█████     | 5/10 [00:05<00:06,  1.38s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 1.690459348239848e+16, 'hit_ratio@10': 0.3798, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8307}:  50%|█████     | 5/10 [00:07<00:06,  1.38s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 1.690459348239848e+16, 'hit_ratio@10': 0.3798, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8307}:  60%|██████    | 6/10 [00:07<00:06,  1.59s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 2.078574381401023e+16, 'hit_ratio@10': 0.3655, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8775}:  60%|██████    | 6/10 [00:08<00:06,  1.59s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 2.078574381401023e+16, 'hit_ratio@10': 0.3655, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8775}:  70%|███████   | 7/10 [00:08<00:04,  1.43s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 2.023800942064268e+16, 'hit_ratio@10': 0.3663, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8234}:  70%|███████   | 7/10 [00:10<00:04,  1.43s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 2.023800942064268e+16, 'hit_ratio@10': 0.3663, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8234}:  80%|████████  | 8/10 [00:10<00:02,  1.44s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 2.397019137515335e+16, 'hit_ratio@10': 0.3605, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.973}:  80%|████████  | 8/10 [00:11<00:02,  1.44s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 2.397019137515335e+16, 'hit_ratio@10': 0.3605, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.973}:  90%|█████████ | 9/10 [00:11<00:01,  1.49s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 2.2985823798441716e+16, 'hit_ratio@10': 0.3563, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9733}:  90%|█████████ | 9/10 [00:13<00:01,  1.49s/it] {'epoch': 45, 'num_users': 6.3, 'loss': 2.2985823798441716e+16, 'hit_ratio@10': 0.3563, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9733}: 100%|██████████| 10/10 [00:13<00:00,  1.65s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 2.2985823798441716e+16, 'hit_ratio@10': 0.3563, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9733}: 100%|██████████| 10/10 [00:13<00:00,  1.40s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 2.2985823798441716e+16
Avg hit ratio: 0.3562716272597427
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.973321557044983
Std train time: 1.0516655286956527
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 3.415273437175687e+17, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7207}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 3.415273437175687e+17, 'hit_ratio@10': 0.3684, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.7207}:  10%|█         | 1/10 [00:00<00:07,  1.14it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 1.9726756158650806e+17, 'hit_ratio@10': 0.3778, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.592}:  10%|█         | 1/10 [00:02<00:07,  1.14it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 1.9726756158650806e+17, 'hit_ratio@10': 0.3778, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.592}:  20%|██        | 2/10 [00:02<00:09,  1.23s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 1.3222246262427941e+17, 'hit_ratio@10': 0.2995, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2298}:  20%|██        | 2/10 [00:02<00:09,  1.23s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 1.3222246262427941e+17, 'hit_ratio@10': 0.2995, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2298}:  30%|███       | 3/10 [00:02<00:05,  1.27it/s]{'epoch': 46, 'num_users': 5.0, 'loss': 5.114327199867384e+17, 'hit_ratio@10': 0.2871, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2241}:  30%|███       | 3/10 [00:03<00:05,  1.27it/s] {'epoch': 46, 'num_users': 5.0, 'loss': 5.114327199867384e+17, 'hit_ratio@10': 0.2871, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.2241}:  40%|████      | 4/10 [00:03<00:05,  1.04it/s]{'epoch': 46, 'num_users': 5.8, 'loss': 4.190756642977978e+17, 'hit_ratio@10': 0.2937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.885}:  40%|████      | 4/10 [00:06<00:05,  1.04it/s] {'epoch': 46, 'num_users': 5.8, 'loss': 4.190756642977978e+17, 'hit_ratio@10': 0.2937, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.885}:  50%|█████     | 5/10 [00:06<00:07,  1.44s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 3.492435715689795e+17, 'hit_ratio@10': 0.304, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.901}:  50%|█████     | 5/10 [00:08<00:07,  1.44s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 3.492435715689795e+17, 'hit_ratio@10': 0.304, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.901}:  60%|██████    | 6/10 [00:08<00:06,  1.63s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 3.139967363347814e+17, 'hit_ratio@10': 0.3177, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9323}:  60%|██████    | 6/10 [00:09<00:06,  1.63s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 3.139967363347814e+17, 'hit_ratio@10': 0.3177, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9323}:  70%|███████   | 7/10 [00:09<00:04,  1.45s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 2.978476115983643e+17, 'hit_ratio@10': 0.3208, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8727}:  70%|███████   | 7/10 [00:10<00:04,  1.45s/it] {'epoch': 46, 'num_users': 6.125, 'loss': 2.978476115983643e+17, 'hit_ratio@10': 0.3208, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8727}:  80%|████████  | 8/10 [00:10<00:02,  1.45s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 2.708191484629145e+17, 'hit_ratio@10': 0.3011, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0033}:  80%|████████  | 8/10 [00:12<00:02,  1.45s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 2.708191484629145e+17, 'hit_ratio@10': 0.3011, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0033}:  90%|█████████ | 9/10 [00:12<00:01,  1.48s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 2.619470712647873e+17, 'hit_ratio@10': 0.3005, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9904}:  90%|█████████ | 9/10 [00:14<00:01,  1.48s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 2.619470712647873e+17, 'hit_ratio@10': 0.3005, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9904}: 100%|██████████| 10/10 [00:14<00:00,  1.61s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 2.619470712647873e+17, 'hit_ratio@10': 0.3005, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9904}: 100%|██████████| 10/10 [00:14<00:00,  1.41s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 2.619470712647873e+17
Avg hit ratio: 0.30050993564066564
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9903507947921752
Std train time: 1.0511014794225715
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 7.545390543410575e+17, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5688}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 7.545390543410575e+17, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5688}:  10%|█         | 1/10 [00:00<00:07,  1.24it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 4.502082008096029e+17, 'hit_ratio@10': 0.3396, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4554}:  10%|█         | 1/10 [00:02<00:07,  1.24it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 4.502082008096029e+17, 'hit_ratio@10': 0.3396, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4554}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 3.00151528494862e+17, 'hit_ratio@10': 0.3216, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1483}:  20%|██        | 2/10 [00:02<00:09,  1.13s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 3.00151528494862e+17, 'hit_ratio@10': 0.3216, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1483}:  30%|███       | 3/10 [00:02<00:05,  1.34it/s]{'epoch': 47, 'num_users': 5.0, 'loss': 3.2374230434875034e+17, 'hit_ratio@10': 0.3126, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1644}:  30%|███       | 3/10 [00:03<00:05,  1.34it/s]{'epoch': 47, 'num_users': 5.0, 'loss': 3.2374230434875034e+17, 'hit_ratio@10': 0.3126, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1644}:  40%|████      | 4/10 [00:03<00:05,  1.07it/s]{'epoch': 47, 'num_users': 5.8, 'loss': 9.085953289984356e+17, 'hit_ratio@10': 0.3221, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8429}:  40%|████      | 4/10 [00:05<00:05,  1.07it/s] {'epoch': 47, 'num_users': 5.8, 'loss': 9.085953289984356e+17, 'hit_ratio@10': 0.3221, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8429}:  50%|█████     | 5/10 [00:05<00:07,  1.43s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 7.977681832195968e+17, 'hit_ratio@10': 0.3129, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8771}:  50%|█████     | 5/10 [00:08<00:07,  1.43s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 7.977681832195968e+17, 'hit_ratio@10': 0.3129, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8771}:  60%|██████    | 6/10 [00:08<00:06,  1.65s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 8.905982363432387e+17, 'hit_ratio@10': 0.3025, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.93}:  60%|██████    | 6/10 [00:09<00:06,  1.65s/it]  {'epoch': 47, 'num_users': 6.2857, 'loss': 8.905982363432387e+17, 'hit_ratio@10': 0.3025, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.93}:  70%|███████   | 7/10 [00:09<00:04,  1.48s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 8.389173332460035e+17, 'hit_ratio@10': 0.2897, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8806}:  70%|███████   | 7/10 [00:10<00:04,  1.48s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 8.389173332460035e+17, 'hit_ratio@10': 0.2897, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8806}:  80%|████████  | 8/10 [00:10<00:03,  1.50s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 7.469666677337902e+17, 'hit_ratio@10': 0.2956, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0151}:  80%|████████  | 8/10 [00:12<00:03,  1.50s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 7.469666677337902e+17, 'hit_ratio@10': 0.2956, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0151}:  90%|█████████ | 9/10 [00:12<00:01,  1.52s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 7.102518175341207e+17, 'hit_ratio@10': 0.291, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0028}:  90%|█████████ | 9/10 [00:14<00:01,  1.52s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 7.102518175341207e+17, 'hit_ratio@10': 0.291, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0028}: 100%|██████████| 10/10 [00:14<00:00,  1.64s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 7.102518175341207e+17, 'hit_ratio@10': 0.291, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.0028}: 100%|██████████| 10/10 [00:14<00:00,  1.42s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 7.102518175341208e+17
Avg hit ratio: 0.29100695286603606
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 2.0027605295181274
Std train time: 1.0680561182614783
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 5.0101261207173446e+17, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6741}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 5.0101261207173446e+17, 'hit_ratio@10': 0.3158, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6741}:  10%|█         | 1/10 [00:00<00:07,  1.18it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 1.7765915441383265e+18, 'hit_ratio@10': 0.3353, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5175}:  10%|█         | 1/10 [00:02<00:07,  1.18it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 1.7765915441383265e+18, 'hit_ratio@10': 0.3353, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.5175}:  20%|██        | 2/10 [00:02<00:09,  1.16s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 1.1844051982557304e+18, 'hit_ratio@10': 0.414, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1743}:  20%|██        | 2/10 [00:02<00:09,  1.16s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 1.1844051982557304e+18, 'hit_ratio@10': 0.414, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1743}:  30%|███       | 3/10 [00:02<00:05,  1.34it/s]{'epoch': 48, 'num_users': 5.0, 'loss': 9.166735892574522e+17, 'hit_ratio@10': 0.373, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1627}:  30%|███       | 3/10 [00:03<00:05,  1.34it/s] {'epoch': 48, 'num_users': 5.0, 'loss': 9.166735892574522e+17, 'hit_ratio@10': 0.373, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1627}:  40%|████      | 4/10 [00:03<00:05,  1.11it/s]{'epoch': 48, 'num_users': 5.8, 'loss': 1.0878454667951214e+18, 'hit_ratio@10': 0.3864, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8402}:  40%|████      | 4/10 [00:05<00:05,  1.11it/s]{'epoch': 48, 'num_users': 5.8, 'loss': 1.0878454667951214e+18, 'hit_ratio@10': 0.3864, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8402}:  50%|█████     | 5/10 [00:05<00:07,  1.40s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 9.157898128664762e+17, 'hit_ratio@10': 0.359, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8719}:  50%|█████     | 5/10 [00:07<00:07,  1.40s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 9.157898128664762e+17, 'hit_ratio@10': 0.359, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8719}:  60%|██████    | 6/10 [00:07<00:06,  1.62s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 8.775315928248769e+17, 'hit_ratio@10': 0.3706, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.923}:  60%|██████    | 6/10 [00:09<00:06,  1.62s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 8.775315928248769e+17, 'hit_ratio@10': 0.3706, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.923}:  70%|███████   | 7/10 [00:09<00:04,  1.46s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 8.744793379093659e+17, 'hit_ratio@10': 0.3814, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8787}:  70%|███████   | 7/10 [00:10<00:04,  1.46s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 8.744793379093659e+17, 'hit_ratio@10': 0.3814, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8787}:  80%|████████  | 8/10 [00:10<00:03,  1.50s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 9.046940133784847e+17, 'hit_ratio@10': 0.3708, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.005}:  80%|████████  | 8/10 [00:12<00:03,  1.50s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 9.046940133784847e+17, 'hit_ratio@10': 0.3708, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 2.005}:  90%|█████████ | 9/10 [00:12<00:01,  1.51s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 1.00617018641757e+18, 'hit_ratio@10': 0.361, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.996}:  90%|█████████ | 9/10 [00:14<00:01,  1.51s/it]     {'epoch': 48, 'num_users': 6.3, 'loss': 1.00617018641757e+18, 'hit_ratio@10': 0.361, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.996}: 100%|██████████| 10/10 [00:14<00:00,  1.64s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 1.00617018641757e+18, 'hit_ratio@10': 0.361, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.996}: 100%|██████████| 10/10 [00:14<00:00,  1.41s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 1.00617018641757e+18
Avg hit ratio: 0.36098633925968393
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9959733724594115
Std train time: 1.0650314625302264
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 5.061922247451607e+17, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6166}:   0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 5.061922247451607e+17, 'hit_ratio@10': 0.4211, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.6166}:  10%|█         | 1/10 [00:00<00:07,  1.22it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 5.3650341574272826e+17, 'hit_ratio@10': 0.3557, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4805}:  10%|█         | 1/10 [00:02<00:07,  1.22it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 5.3650341574272826e+17, 'hit_ratio@10': 0.3557, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.4805}:  20%|██        | 2/10 [00:02<00:09,  1.14s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 4.18137268902349e+17, 'hit_ratio@10': 0.3324, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1591}:  20%|██        | 2/10 [00:02<00:09,  1.14s/it]  {'epoch': 49, 'num_users': 5.0, 'loss': 4.18137268902349e+17, 'hit_ratio@10': 0.3324, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1591}:  30%|███       | 3/10 [00:02<00:05,  1.35it/s]{'epoch': 49, 'num_users': 5.0, 'loss': 3.692246411595482e+17, 'hit_ratio@10': 0.3118, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1764}:  30%|███       | 3/10 [00:03<00:05,  1.35it/s]{'epoch': 49, 'num_users': 5.0, 'loss': 3.692246411595482e+17, 'hit_ratio@10': 0.3118, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.1764}:  40%|████      | 4/10 [00:03<00:05,  1.06it/s]{'epoch': 49, 'num_users': 5.8, 'loss': 3.409981293925688e+17, 'hit_ratio@10': 0.3094, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8119}:  40%|████      | 4/10 [00:05<00:05,  1.06it/s]{'epoch': 49, 'num_users': 5.8, 'loss': 3.409981293925688e+17, 'hit_ratio@10': 0.3094, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8119}:  50%|█████     | 5/10 [00:05<00:06,  1.39s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 1.0416007391632884e+18, 'hit_ratio@10': 0.2912, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8557}:  50%|█████     | 5/10 [00:07<00:06,  1.39s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 1.0416007391632884e+18, 'hit_ratio@10': 0.2912, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8557}:  60%|██████    | 6/10 [00:07<00:06,  1.63s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 1.205754042692474e+18, 'hit_ratio@10': 0.301, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9}:  60%|██████    | 6/10 [00:09<00:06,  1.63s/it]     {'epoch': 49, 'num_users': 6.2857, 'loss': 1.205754042692474e+18, 'hit_ratio@10': 0.301, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9}:  70%|███████   | 7/10 [00:09<00:04,  1.46s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 1.4425211481895892e+18, 'hit_ratio@10': 0.317, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8571}:  70%|███████   | 7/10 [00:10<00:04,  1.46s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 1.4425211481895892e+18, 'hit_ratio@10': 0.317, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.8571}:  80%|████████  | 8/10 [00:10<00:02,  1.49s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 1.6817426322754202e+18, 'hit_ratio@10': 0.3198, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9888}:  80%|████████  | 8/10 [00:12<00:02,  1.49s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 1.6817426322754202e+18, 'hit_ratio@10': 0.3198, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9888}:  90%|█████████ | 9/10 [00:12<00:01,  1.51s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 2.567555806610978e+18, 'hit_ratio@10': 0.306, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9894}:  90%|█████████ | 9/10 [00:14<00:01,  1.51s/it]     {'epoch': 49, 'num_users': 6.3, 'loss': 2.567555806610978e+18, 'hit_ratio@10': 0.306, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9894}: 100%|██████████| 10/10 [00:14<00:00,  1.66s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 2.567555806610978e+18, 'hit_ratio@10': 0.306, 'ndcg@10': inf, 'compress@10': 1.0, 'time@10': 1.9894}: 100%|██████████| 10/10 [00:14<00:00,  1.42s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 2.567555806610978e+18
Avg hit ratio: 0.30603362511851473
Avg ndcg: inf
Avg compression ratio: 1.0
Avg train time: 1.9893914699554442
Std train time: 1.0112961767117845
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
