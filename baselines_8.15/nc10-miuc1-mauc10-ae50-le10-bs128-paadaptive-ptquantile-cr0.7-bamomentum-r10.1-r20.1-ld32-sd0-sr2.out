  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1904, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5289, 'compress@10': 0.7158, 'time@10': 9.3849}:   0%|          | 0/10 [00:05<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1904, 'hit_ratio@10': 0.4737, 'ndcg@10': 0.5289, 'compress@10': 0.7158, 'time@10': 9.3849}:  10%|█         | 1/10 [00:05<00:46,  5.13s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1369, 'hit_ratio@10': 0.6078, 'ndcg@10': 0.6274, 'compress@10': 0.7127, 'time@10': 8.2111}:  10%|█         | 1/10 [00:12<00:46,  5.13s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1369, 'hit_ratio@10': 0.6078, 'ndcg@10': 0.6274, 'compress@10': 0.7127, 'time@10': 8.2111}:  20%|██        | 2/10 [00:12<00:50,  6.27s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.869, 'hit_ratio@10': 0.5004, 'ndcg@10': 0.4183, 'compress@10': 0.7228, 'time@10': 6.4047}:  20%|██        | 2/10 [00:13<00:50,  6.27s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.869, 'hit_ratio@10': 0.5004, 'ndcg@10': 0.4183, 'compress@10': 0.7228, 'time@10': 6.4047}:  30%|███       | 3/10 [00:13<00:28,  4.06s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6808, 'hit_ratio@10': 0.5718, 'ndcg@10': 0.4625, 'compress@10': 0.7197, 'time@10': 6.3527}:  30%|███       | 3/10 [00:19<00:28,  4.06s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6808, 'hit_ratio@10': 0.5718, 'ndcg@10': 0.4625, 'compress@10': 0.7197, 'time@10': 6.3527}:  40%|████      | 4/10 [00:19<00:29,  4.92s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5635, 'hit_ratio@10': 0.6214, 'ndcg@10': 0.5198, 'compress@10': 0.717, 'time@10': 9.7603}:  40%|████      | 4/10 [00:31<00:29,  4.92s/it] {'epoch': 0, 'num_users': 5.8, 'loss': 0.5635, 'hit_ratio@10': 0.6214, 'ndcg@10': 0.5198, 'compress@10': 0.717, 'time@10': 9.7603}:  50%|█████     | 5/10 [00:31<00:36,  7.38s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4843, 'hit_ratio@10': 0.6364, 'ndcg@10': 0.5604, 'compress@10': 0.7153, 'time@10': 9.8624}:  50%|█████     | 5/10 [00:42<00:36,  7.38s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4843, 'hit_ratio@10': 0.6364, 'ndcg@10': 0.5604, 'compress@10': 0.7153, 'time@10': 9.8624}:  60%|██████    | 6/10 [00:42<00:33,  8.41s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4334, 'hit_ratio@10': 0.6426, 'ndcg@10': 0.5606, 'compress@10': 0.7148, 'time@10': 10.0781}:  60%|██████    | 6/10 [00:47<00:33,  8.41s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.4334, 'hit_ratio@10': 0.6426, 'ndcg@10': 0.5606, 'compress@10': 0.7148, 'time@10': 10.0781}:  70%|███████   | 7/10 [00:47<00:22,  7.53s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3863, 'hit_ratio@10': 0.673, 'ndcg@10': 0.5858, 'compress@10': 0.714, 'time@10': 9.8003}:  70%|███████   | 7/10 [00:55<00:22,  7.53s/it]    {'epoch': 0, 'num_users': 6.125, 'loss': 0.3863, 'hit_ratio@10': 0.673, 'ndcg@10': 0.5858, 'compress@10': 0.714, 'time@10': 9.8003}:  80%|████████  | 8/10 [00:55<00:15,  7.65s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3492, 'hit_ratio@10': 0.6871, 'ndcg@10': 0.6213, 'compress@10': 0.7134, 'time@10': 10.4594}:  80%|████████  | 8/10 [01:03<00:15,  7.65s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3492, 'hit_ratio@10': 0.6871, 'ndcg@10': 0.6213, 'compress@10': 0.7134, 'time@10': 10.4594}:  90%|█████████ | 9/10 [01:03<00:07,  7.73s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3197, 'hit_ratio@10': 0.7116, 'ndcg@10': 0.6428, 'compress@10': 0.7128, 'time@10': 10.4036}:  90%|█████████ | 9/10 [01:13<00:07,  7.73s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.3197, 'hit_ratio@10': 0.7116, 'ndcg@10': 0.6428, 'compress@10': 0.7128, 'time@10': 10.4036}: 100%|██████████| 10/10 [01:13<00:00,  8.41s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.3197, 'hit_ratio@10': 0.7116, 'ndcg@10': 0.6428, 'compress@10': 0.7128, 'time@10': 10.4036}: 100%|██████████| 10/10 [01:13<00:00,  7.35s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.3196921202353556
Avg hit ratio: 0.7115691844469434
Avg ndcg: 0.6427633140589417
Avg compression ratio: 0.7127562770723295
Avg train time: 10.403587770462035
Std train time: 5.410730611514765
[0.85, 0.35, 0.85, 0.85, 0.85, 0.35, 0.85, 0.35, 0.35, 0.35]
[10, 10, 11, 10, 9, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0552, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8311, 'compress@10': 0.8579, 'time@10': 8.3966}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0552, 'hit_ratio@10': 0.7368, 'ndcg@10': 0.8311, 'compress@10': 0.8579, 'time@10': 8.3966}:  10%|█         | 1/10 [00:04<00:38,  4.25s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0542, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8442, 'compress@10': 0.6144, 'time@10': 7.6546}:  10%|█         | 1/10 [00:11<00:38,  4.25s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0542, 'hit_ratio@10': 0.7555, 'ndcg@10': 0.8442, 'compress@10': 0.6144, 'time@10': 7.6546}:  20%|██        | 2/10 [00:11<00:46,  5.84s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0447, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.7994, 'compress@10': 0.7001, 'time@10': 6.0927}:  20%|██        | 2/10 [00:12<00:46,  5.84s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0447, 'hit_ratio@10': 0.7418, 'ndcg@10': 0.7994, 'compress@10': 0.7001, 'time@10': 6.0927}:  30%|███       | 3/10 [00:12<00:27,  3.87s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.046, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8103, 'compress@10': 0.7389, 'time@10': 6.1222}:  30%|███       | 3/10 [00:18<00:27,  3.87s/it] {'epoch': 1, 'num_users': 5.0, 'loss': 0.046, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8103, 'compress@10': 0.7389, 'time@10': 6.1222}:  40%|████      | 4/10 [00:18<00:28,  4.81s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0541, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8052, 'compress@10': 0.7617, 'time@10': 9.0479}:  40%|████      | 4/10 [00:29<00:28,  4.81s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0541, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8052, 'compress@10': 0.7617, 'time@10': 9.0479}:  50%|█████     | 5/10 [00:29<00:34,  6.83s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0579, 'hit_ratio@10': 0.7786, 'ndcg@10': 0.8067, 'compress@10': 0.6955, 'time@10': 9.2505}:  50%|█████     | 5/10 [00:39<00:34,  6.83s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0579, 'hit_ratio@10': 0.7786, 'ndcg@10': 0.8067, 'compress@10': 0.6955, 'time@10': 9.2505}:  60%|██████    | 6/10 [00:39<00:32,  8.01s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0558, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.8158, 'compress@10': 0.7184, 'time@10': 9.5409}:  60%|██████    | 6/10 [00:45<00:32,  8.01s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0558, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.8158, 'compress@10': 0.7184, 'time@10': 9.5409}:  70%|███████   | 7/10 [00:45<00:21,  7.25s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0535, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8232, 'compress@10': 0.6747, 'time@10': 9.3463}:  70%|███████   | 7/10 [00:53<00:21,  7.25s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0535, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8232, 'compress@10': 0.6747, 'time@10': 9.3463}:  80%|████████  | 8/10 [00:53<00:14,  7.49s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0515, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8332, 'compress@10': 0.6407, 'time@10': 9.8921}:  80%|████████  | 8/10 [01:00<00:14,  7.49s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0515, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8332, 'compress@10': 0.6407, 'time@10': 9.8921}:  90%|█████████ | 9/10 [01:00<00:07,  7.39s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.051, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8346, 'compress@10': 0.6131, 'time@10': 9.8814}:  90%|█████████ | 9/10 [01:10<00:07,  7.39s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.051, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8346, 'compress@10': 0.6131, 'time@10': 9.8814}: 100%|██████████| 10/10 [01:10<00:00,  8.14s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.051, 'hit_ratio@10': 0.8192, 'ndcg@10': 0.8346, 'compress@10': 0.6131, 'time@10': 9.8814}: 100%|██████████| 10/10 [01:10<00:00,  7.04s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.0510144582736425
Avg hit ratio: 0.8191901454516056
Avg ndcg: 0.8345578664228267
Avg compression ratio: 0.6130940378971208
Avg train time: 9.881438517570496
Std train time: 4.639964207371778
[0.9, 0.5666666666666667, 0.5666666666666667, 0.9, 0.9, 0.5666666666666667, 0.5666666666666667, 0.23333333333333334, 0.23333333333333334, 0.23333333333333334]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8463, 'compress@10': 0.9052, 'time@10': 8.4788}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8463, 'compress@10': 0.9052, 'time@10': 8.4788}:  10%|█         | 1/10 [00:04<00:38,  4.28s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8489, 'compress@10': 0.7429, 'time@10': 7.7785}:  10%|█         | 1/10 [00:11<00:38,  4.28s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8489, 'compress@10': 0.7429, 'time@10': 7.7785}:  20%|██        | 2/10 [00:11<00:47,  5.95s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0347, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8517, 'compress@10': 0.7048, 'time@10': 6.3026}:  20%|██        | 2/10 [00:13<00:47,  5.95s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0347, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8517, 'compress@10': 0.7048, 'time@10': 6.3026}:  30%|███       | 3/10 [00:13<00:28,  4.01s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8494, 'compress@10': 0.7545, 'time@10': 6.2733}:  30%|███       | 3/10 [00:19<00:28,  4.01s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0383, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.8494, 'compress@10': 0.7545, 'time@10': 6.2733}:  40%|████      | 4/10 [00:19<00:29,  4.89s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.78, 'ndcg@10': 0.837, 'compress@10': 0.784, 'time@10': 8.6605}:  40%|████      | 4/10 [00:28<00:29,  4.89s/it]    {'epoch': 2, 'num_users': 5.8, 'loss': 0.0477, 'hit_ratio@10': 0.78, 'ndcg@10': 0.837, 'compress@10': 0.784, 'time@10': 8.6605}:  50%|█████     | 5/10 [00:28<00:32,  6.42s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.052, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8344, 'compress@10': 0.7494, 'time@10': 8.9227}:  50%|█████     | 5/10 [00:38<00:32,  6.42s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.052, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8344, 'compress@10': 0.7494, 'time@10': 8.9227}:  60%|██████    | 6/10 [00:38<00:30,  7.73s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0505, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8373, 'compress@10': 0.7258, 'time@10': 9.2848}:  60%|██████    | 6/10 [00:44<00:30,  7.73s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0505, 'hit_ratio@10': 0.8023, 'ndcg@10': 0.8373, 'compress@10': 0.7258, 'time@10': 9.2848}:  70%|███████   | 7/10 [00:44<00:21,  7.09s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8418, 'compress@10': 0.6669, 'time@10': 9.1036}:  70%|███████   | 7/10 [00:52<00:21,  7.09s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0507, 'hit_ratio@10': 0.8163, 'ndcg@10': 0.8418, 'compress@10': 0.6669, 'time@10': 9.1036}:  80%|████████  | 8/10 [00:52<00:14,  7.34s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.049, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8493, 'compress@10': 0.6212, 'time@10': 9.6369}:  80%|████████  | 8/10 [00:59<00:14,  7.34s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.049, 'hit_ratio@10': 0.8049, 'ndcg@10': 0.8493, 'compress@10': 0.6212, 'time@10': 9.6369}:  90%|█████████ | 9/10 [00:59<00:07,  7.23s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8497, 'compress@10': 0.5842, 'time@10': 9.5801}:  90%|█████████ | 9/10 [01:08<00:07,  7.23s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8497, 'compress@10': 0.5842, 'time@10': 9.5801}: 100%|██████████| 10/10 [01:08<00:00,  7.81s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8497, 'compress@10': 0.5842, 'time@10': 9.5801}: 100%|██████████| 10/10 [01:08<00:00,  6.85s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.048731098530148086
Avg hit ratio: 0.8176156177344632
Avg ndcg: 0.8496694124508501
Avg compression ratio: 0.5841532568835155
Avg train time: 9.58010139465332
Std train time: 3.9776731772896516
[0.675, 0.675, 0.425, 0.925, 0.925, 0.675, 0.425, 0.425, 0.175, 0.175]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.6921, 'time@10': 8.4039}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 0.6921, 'time@10': 8.4039}:  10%|█         | 1/10 [00:04<00:38,  4.24s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8484, 'compress@10': 0.6888, 'time@10': 7.7726}:  10%|█         | 1/10 [00:11<00:38,  4.24s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0489, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8484, 'compress@10': 0.6888, 'time@10': 7.7726}:  20%|██        | 2/10 [00:11<00:47,  5.97s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8513, 'compress@10': 0.6282, 'time@10': 6.4227}:  20%|██        | 2/10 [00:13<00:47,  5.97s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8513, 'compress@10': 0.6282, 'time@10': 6.4227}:  30%|███       | 3/10 [00:13<00:28,  4.11s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.7642, 'ndcg@10': 0.8479, 'compress@10': 0.7031, 'time@10': 6.3685}:  30%|███       | 3/10 [00:19<00:28,  4.11s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.037, 'hit_ratio@10': 0.7642, 'ndcg@10': 0.8479, 'compress@10': 0.7031, 'time@10': 6.3685}:  40%|████      | 4/10 [00:19<00:29,  4.95s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.7754, 'ndcg@10': 0.8372, 'compress@10': 0.7478, 'time@10': 8.2725}:  40%|████      | 4/10 [00:27<00:29,  4.95s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0464, 'hit_ratio@10': 0.7754, 'ndcg@10': 0.8372, 'compress@10': 0.7478, 'time@10': 8.2725}:  50%|█████     | 5/10 [00:27<00:30,  6.04s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8353, 'compress@10': 0.7368, 'time@10': 8.6334}:  50%|█████     | 5/10 [00:38<00:30,  6.04s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0502, 'hit_ratio@10': 0.7795, 'ndcg@10': 0.8353, 'compress@10': 0.7368, 'time@10': 8.6334}:  60%|██████    | 6/10 [00:38<00:30,  7.55s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0498, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8353, 'compress@10': 0.6956, 'time@10': 9.0131}:  60%|██████    | 6/10 [00:43<00:30,  7.55s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0498, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8353, 'compress@10': 0.6956, 'time@10': 9.0131}:  70%|███████   | 7/10 [00:43<00:20,  6.94s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.8418, 'compress@10': 0.6638, 'time@10': 8.8839}:  70%|███████   | 7/10 [00:51<00:20,  6.94s/it]  {'epoch': 3, 'num_users': 6.125, 'loss': 0.051, 'hit_ratio@10': 0.8225, 'ndcg@10': 0.8418, 'compress@10': 0.6638, 'time@10': 8.8839}:  80%|████████  | 8/10 [00:51<00:14,  7.28s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8495, 'compress@10': 0.6121, 'time@10': 9.3958}:  80%|████████  | 8/10 [00:58<00:14,  7.28s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.82, 'ndcg@10': 0.8495, 'compress@10': 0.6121, 'time@10': 9.3958}:  90%|█████████ | 9/10 [00:58<00:07,  7.12s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8489, 'compress@10': 0.5703, 'time@10': 9.3786}:  90%|█████████ | 9/10 [01:07<00:07,  7.12s/it] {'epoch': 3, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8489, 'compress@10': 0.5703, 'time@10': 9.3786}: 100%|██████████| 10/10 [01:07<00:00,  7.78s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0501, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8489, 'compress@10': 0.5703, 'time@10': 9.3786}: 100%|██████████| 10/10 [01:07<00:00,  6.77s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.050140365543906905
Avg hit ratio: 0.8311430114876635
Avg ndcg: 0.8489095366872654
Avg compression ratio: 0.5702829414873405
Avg train time: 9.378638792037965
Std train time: 3.3773030124551737
[0.54, 0.74, 0.33999999999999997, 0.9400000000000001, 0.9400000000000001, 0.74, 0.33999999999999997, 0.54, 0.13999999999999999, 0.13999999999999999]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8598, 'compress@10': 0.5642, 'time@10': 8.3833}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0476, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8598, 'compress@10': 0.5642, 'time@10': 8.3833}:  10%|█         | 1/10 [00:04<00:38,  4.23s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8542, 'compress@10': 0.6563, 'time@10': 7.6855}:  10%|█         | 1/10 [00:11<00:38,  4.23s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8542, 'compress@10': 0.6563, 'time@10': 7.6855}:  20%|██        | 2/10 [00:11<00:46,  5.87s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8552, 'compress@10': 0.5823, 'time@10': 6.3645}:  20%|██        | 2/10 [00:13<00:46,  5.87s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0328, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8552, 'compress@10': 0.5823, 'time@10': 6.3645}:  30%|███       | 3/10 [00:13<00:28,  4.06s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.853, 'compress@10': 0.6723, 'time@10': 6.3271}:  30%|███       | 3/10 [00:19<00:28,  4.06s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.7651, 'ndcg@10': 0.853, 'compress@10': 0.6723, 'time@10': 6.3271}:  40%|████      | 4/10 [00:19<00:29,  4.92s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8396, 'compress@10': 0.726, 'time@10': 7.7611}:  40%|████      | 4/10 [00:26<00:29,  4.92s/it] {'epoch': 4, 'num_users': 5.8, 'loss': 0.0457, 'hit_ratio@10': 0.776, 'ndcg@10': 0.8396, 'compress@10': 0.726, 'time@10': 7.7611}:  50%|█████     | 5/10 [00:26<00:27,  5.60s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0489, 'hit_ratio@10': 0.7837, 'ndcg@10': 0.8376, 'compress@10': 0.7293, 'time@10': 8.1857}:  50%|█████     | 5/10 [00:36<00:27,  5.60s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0489, 'hit_ratio@10': 0.7837, 'ndcg@10': 0.8376, 'compress@10': 0.7293, 'time@10': 8.1857}:  60%|██████    | 6/10 [00:36<00:28,  7.21s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0485, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.8377, 'compress@10': 0.6775, 'time@10': 8.5824}:  60%|██████    | 6/10 [00:42<00:28,  7.21s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0485, 'hit_ratio@10': 0.8089, 'ndcg@10': 0.8377, 'compress@10': 0.6775, 'time@10': 8.5824}:  70%|███████   | 7/10 [00:42<00:19,  6.66s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0495, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8454, 'compress@10': 0.6619, 'time@10': 8.4948}:  70%|███████   | 7/10 [00:49<00:19,  6.66s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0495, 'hit_ratio@10': 0.8221, 'ndcg@10': 0.8454, 'compress@10': 0.6619, 'time@10': 8.4948}:  80%|████████  | 8/10 [00:49<00:14,  7.06s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0483, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8524, 'compress@10': 0.6067, 'time@10': 9.045}:  80%|████████  | 8/10 [00:56<00:14,  7.06s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0483, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8524, 'compress@10': 0.6067, 'time@10': 9.045}:  90%|█████████ | 9/10 [00:56<00:06,  6.97s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.048, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8515, 'compress@10': 0.562, 'time@10': 9.0731}:  90%|█████████ | 9/10 [01:06<00:06,  6.97s/it]    {'epoch': 4, 'num_users': 6.3, 'loss': 0.048, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8515, 'compress@10': 0.562, 'time@10': 9.0731}: 100%|██████████| 10/10 [01:06<00:00,  7.71s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.048, 'hit_ratio@10': 0.8251, 'ndcg@10': 0.8515, 'compress@10': 0.562, 'time@10': 9.0731}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04804478346615394
Avg hit ratio: 0.8251394272582727
Avg ndcg: 0.8515044432472034
Avg compression ratio: 0.5619633447325443
Avg train time: 9.073072528839111
Std train time: 2.9479653764252496
[0.6166666666666667, 0.7833333333333333, 0.2833333333333333, 0.7833333333333334, 0.9500000000000001, 0.7833333333333333, 0.2833333333333333, 0.6166666666666667, 0.11666666666666665, 0.11666666666666665]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 0.6368, 'time@10': 8.5728}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0469, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 0.6368, 'time@10': 8.5728}:  10%|█         | 1/10 [00:04<00:38,  4.32s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8565, 'compress@10': 0.7136, 'time@10': 7.7975}:  10%|█         | 1/10 [00:11<00:38,  4.32s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0465, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8565, 'compress@10': 0.7136, 'time@10': 7.7975}:  20%|██        | 2/10 [00:11<00:47,  5.93s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8567, 'compress@10': 0.6043, 'time@10': 6.5797}:  20%|██        | 2/10 [00:13<00:47,  5.93s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0312, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8567, 'compress@10': 0.6043, 'time@10': 6.5797}:  30%|███       | 3/10 [00:13<00:29,  4.19s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8548, 'compress@10': 0.651, 'time@10': 6.5222}:  30%|███       | 3/10 [00:19<00:29,  4.19s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0358, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8548, 'compress@10': 0.651, 'time@10': 6.5222}:  40%|████      | 4/10 [00:19<00:30,  5.06s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0449, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8411, 'compress@10': 0.711, 'time@10': 7.8963}:  40%|████      | 4/10 [00:26<00:30,  5.06s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0449, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8411, 'compress@10': 0.711, 'time@10': 7.8963}:  50%|█████     | 5/10 [00:26<00:28,  5.66s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0475, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8397, 'compress@10': 0.7238, 'time@10': 8.2962}:  50%|█████     | 5/10 [00:36<00:28,  5.66s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0475, 'hit_ratio@10': 0.8189, 'ndcg@10': 0.8397, 'compress@10': 0.7238, 'time@10': 8.2962}:  60%|██████    | 6/10 [00:36<00:28,  7.25s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0472, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8396, 'compress@10': 0.665, 'time@10': 8.7015}:  60%|██████    | 6/10 [00:42<00:28,  7.25s/it]  {'epoch': 5, 'num_users': 6.2857, 'loss': 0.0472, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8396, 'compress@10': 0.665, 'time@10': 8.7015}:  70%|███████   | 7/10 [00:42<00:20,  6.71s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0475, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8465, 'compress@10': 0.6603, 'time@10': 8.5641}:  70%|███████   | 7/10 [00:50<00:20,  6.71s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0475, 'hit_ratio@10': 0.852, 'ndcg@10': 0.8465, 'compress@10': 0.6603, 'time@10': 8.5641}:  80%|████████  | 8/10 [00:50<00:14,  7.01s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0466, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8566, 'compress@10': 0.6027, 'time@10': 9.0731}:  80%|████████  | 8/10 [00:56<00:14,  7.01s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0466, 'hit_ratio@10': 0.8399, 'ndcg@10': 0.8566, 'compress@10': 0.6027, 'time@10': 9.0731}:  90%|█████████ | 9/10 [00:56<00:06,  6.88s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0461, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.856, 'compress@10': 0.5561, 'time@10': 9.0562}:  90%|█████████ | 9/10 [01:05<00:06,  6.88s/it]    {'epoch': 5, 'num_users': 6.3, 'loss': 0.0461, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.856, 'compress@10': 0.5561, 'time@10': 9.0562}: 100%|██████████| 10/10 [01:05<00:00,  7.52s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0461, 'hit_ratio@10': 0.8491, 'ndcg@10': 0.856, 'compress@10': 0.5561, 'time@10': 9.0562}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.04605518568310625
Avg hit ratio: 0.8490795194241715
Avg ndcg: 0.8559939828187488
Avg compression ratio: 0.5561324560519717
Avg train time: 9.056185913085937
Std train time: 2.8167947372224194
[0.6714285714285715, 0.6714285714285714, 0.24285714285714285, 0.8142857142857144, 0.9571428571428572, 0.8142857142857143, 0.24285714285714285, 0.6714285714285715, 0.09999999999999999, 0.09999999999999999]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.6887, 'time@10': 8.0287}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0466, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.6887, 'time@10': 8.0287}:  10%|█         | 1/10 [00:04<00:36,  4.05s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8625, 'compress@10': 0.6854, 'time@10': 7.4874}:  10%|█         | 1/10 [00:11<00:36,  4.05s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0451, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8625, 'compress@10': 0.6854, 'time@10': 7.4874}:  20%|██        | 2/10 [00:11<00:46,  5.78s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8607, 'compress@10': 0.5739, 'time@10': 6.4424}:  20%|██        | 2/10 [00:13<00:46,  5.78s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0302, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8607, 'compress@10': 0.5739, 'time@10': 6.4424}:  30%|███       | 3/10 [00:13<00:29,  4.15s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8578, 'compress@10': 0.6357, 'time@10': 6.3307}:  30%|███       | 3/10 [00:19<00:29,  4.15s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0356, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8578, 'compress@10': 0.6357, 'time@10': 6.3307}:  40%|████      | 4/10 [00:19<00:29,  4.89s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8436, 'compress@10': 0.7001, 'time@10': 7.6982}:  40%|████      | 4/10 [00:25<00:29,  4.89s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0441, 'hit_ratio@10': 0.8182, 'ndcg@10': 0.8436, 'compress@10': 0.7001, 'time@10': 7.6982}:  50%|█████     | 5/10 [00:25<00:27,  5.52s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.046, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8424, 'compress@10': 0.7198, 'time@10': 8.1113}:  50%|█████     | 5/10 [00:36<00:27,  5.52s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.046, 'hit_ratio@10': 0.8226, 'ndcg@10': 0.8424, 'compress@10': 0.7198, 'time@10': 8.1113}:  60%|██████    | 6/10 [00:36<00:28,  7.11s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0453, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8459, 'compress@10': 0.656, 'time@10': 8.5059}:  60%|██████    | 6/10 [00:41<00:28,  7.11s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0453, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8459, 'compress@10': 0.656, 'time@10': 8.5059}:  70%|███████   | 7/10 [00:41<00:19,  6.58s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0451, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8534, 'compress@10': 0.6591, 'time@10': 8.3914}:  70%|███████   | 7/10 [00:49<00:19,  6.58s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0451, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8534, 'compress@10': 0.6591, 'time@10': 8.3914}:  80%|████████  | 8/10 [00:49<00:13,  6.91s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0465, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8653, 'compress@10': 0.5999, 'time@10': 8.912}:  80%|████████  | 8/10 [00:55<00:13,  6.91s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0465, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8653, 'compress@10': 0.5999, 'time@10': 8.912}:  90%|█████████ | 9/10 [00:55<00:06,  6.81s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.046, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8646, 'compress@10': 0.5519, 'time@10': 8.9116}:  90%|█████████ | 9/10 [01:04<00:06,  6.81s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.046, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8646, 'compress@10': 0.5519, 'time@10': 8.9116}: 100%|██████████| 10/10 [01:04<00:00,  7.47s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.046, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8646, 'compress@10': 0.5519, 'time@10': 8.9116}: 100%|██████████| 10/10 [01:04<00:00,  6.47s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.046002635666026165
Avg hit ratio: 0.8564316117762637
Avg ndcg: 0.864638359309092
Avg compression ratio: 0.5519223390512643
Avg train time: 8.911613726615906
Std train time: 2.767655721272956
[0.7125, 0.5874999999999999, 0.2125, 0.8375000000000001, 0.9625, 0.8375, 0.2125, 0.5875, 0.2125, 0.0875]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.045, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.862, 'compress@10': 0.7276, 'time@10': 8.094}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.045, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.862, 'compress@10': 0.7276, 'time@10': 8.094}:  10%|█         | 1/10 [00:04<00:36,  4.08s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8621, 'compress@10': 0.6642, 'time@10': 7.4824}:  10%|█         | 1/10 [00:10<00:36,  4.08s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8621, 'compress@10': 0.6642, 'time@10': 7.4824}:  20%|██        | 2/10 [00:10<00:45,  5.75s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8604, 'compress@10': 0.5511, 'time@10': 6.5412}:  20%|██        | 2/10 [00:13<00:45,  5.75s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8604, 'compress@10': 0.5511, 'time@10': 6.5412}:  30%|███       | 3/10 [00:13<00:29,  4.21s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8612, 'compress@10': 0.6242, 'time@10': 6.4054}:  30%|███       | 3/10 [00:19<00:29,  4.21s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0348, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8612, 'compress@10': 0.6242, 'time@10': 6.4054}:  40%|████      | 4/10 [00:19<00:29,  4.93s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0429, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8464, 'compress@10': 0.692, 'time@10': 7.7666}:  40%|████      | 4/10 [00:26<00:29,  4.93s/it] {'epoch': 7, 'num_users': 5.8, 'loss': 0.0429, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8464, 'compress@10': 0.692, 'time@10': 7.7666}:  50%|█████     | 5/10 [00:26<00:27,  5.55s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0442, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8471, 'compress@10': 0.7168, 'time@10': 8.1496}:  50%|█████     | 5/10 [00:36<00:27,  5.55s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0442, 'hit_ratio@10': 0.8538, 'ndcg@10': 0.8471, 'compress@10': 0.7168, 'time@10': 8.1496}:  60%|██████    | 6/10 [00:36<00:28,  7.10s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0431, 'hit_ratio@10': 0.869, 'ndcg@10': 0.8491, 'compress@10': 0.6493, 'time@10': 8.5355}:  60%|██████    | 6/10 [00:41<00:28,  7.10s/it] {'epoch': 7, 'num_users': 6.2857, 'loss': 0.0431, 'hit_ratio@10': 0.869, 'ndcg@10': 0.8491, 'compress@10': 0.6493, 'time@10': 8.5355}:  70%|███████   | 7/10 [00:41<00:19,  6.56s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0432, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8561, 'compress@10': 0.643, 'time@10': 8.425}:  70%|███████   | 7/10 [00:49<00:19,  6.56s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.0432, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8561, 'compress@10': 0.643, 'time@10': 8.425}:  80%|████████  | 8/10 [00:49<00:13,  6.92s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0436, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.862, 'compress@10': 0.5977, 'time@10': 8.9755}:  80%|████████  | 8/10 [00:56<00:13,  6.92s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0436, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.862, 'compress@10': 0.5977, 'time@10': 8.9755}:  90%|█████████ | 9/10 [00:56<00:06,  6.86s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0426, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.862, 'compress@10': 0.5488, 'time@10': 8.952}:  90%|█████████ | 9/10 [01:04<00:06,  6.86s/it]    {'epoch': 7, 'num_users': 6.3, 'loss': 0.0426, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.862, 'compress@10': 0.5488, 'time@10': 8.952}: 100%|██████████| 10/10 [01:04<00:00,  7.45s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0426, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.862, 'compress@10': 0.5488, 'time@10': 8.952}: 100%|██████████| 10/10 [01:04<00:00,  6.48s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.0426170698710398
Avg hit ratio: 0.8751617705064223
Avg ndcg: 0.8620292569793457
Avg compression ratio: 0.548758287387402
Avg train time: 8.952042651176452
Std train time: 2.7668498792218266
[0.7444444444444445, 0.5222222222222221, 0.18888888888888888, 0.8555555555555556, 0.9666666666666667, 0.8555555555555556, 0.18888888888888888, 0.5222222222222223, 0.3, 0.07777777777777778]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0448, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.7579, 'time@10': 7.7599}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0448, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 0.7579, 'time@10': 7.7599}:  10%|█         | 1/10 [00:03<00:35,  3.92s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8597, 'compress@10': 0.6478, 'time@10': 7.3009}:  10%|█         | 1/10 [00:10<00:35,  3.92s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8597, 'compress@10': 0.6478, 'time@10': 7.3009}:  20%|██        | 2/10 [00:10<00:45,  5.66s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.028, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8589, 'compress@10': 0.5334, 'time@10': 6.4421}:  20%|██        | 2/10 [00:13<00:45,  5.66s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.028, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8589, 'compress@10': 0.5334, 'time@10': 6.4421}:  30%|███       | 3/10 [00:13<00:29,  4.17s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8607, 'compress@10': 0.6152, 'time@10': 6.3098}:  30%|███       | 3/10 [00:19<00:29,  4.17s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8607, 'compress@10': 0.6152, 'time@10': 6.3098}:  40%|████      | 4/10 [00:19<00:29,  4.87s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0418, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8463, 'compress@10': 0.6857, 'time@10': 7.5682}:  40%|████      | 4/10 [00:25<00:29,  4.87s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0418, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8463, 'compress@10': 0.6857, 'time@10': 7.5682}:  50%|█████     | 5/10 [00:25<00:27,  5.40s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0425, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8472, 'compress@10': 0.7145, 'time@10': 7.9761}:  50%|█████     | 5/10 [00:35<00:27,  5.40s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0425, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8472, 'compress@10': 0.7145, 'time@10': 7.9761}:  60%|██████    | 6/10 [00:35<00:27,  6.98s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.042, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8527, 'compress@10': 0.6441, 'time@10': 8.3943}:  60%|██████    | 6/10 [00:41<00:27,  6.98s/it] {'epoch': 8, 'num_users': 6.2857, 'loss': 0.042, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.8527, 'compress@10': 0.6441, 'time@10': 8.3943}:  70%|███████   | 7/10 [00:41<00:19,  6.49s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0423, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8565, 'compress@10': 0.6305, 'time@10': 8.3144}:  70%|███████   | 7/10 [00:48<00:19,  6.49s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0423, 'hit_ratio@10': 0.8644, 'ndcg@10': 0.8565, 'compress@10': 0.6305, 'time@10': 8.3144}:  80%|████████  | 8/10 [00:48<00:13,  6.91s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0409, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.8638, 'compress@10': 0.596, 'time@10': 8.9401}:  80%|████████  | 8/10 [00:55<00:13,  6.91s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0409, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.8638, 'compress@10': 0.596, 'time@10': 8.9401}:  90%|█████████ | 9/10 [00:55<00:06,  6.94s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8661, 'compress@10': 0.5463, 'time@10': 8.9075}:  90%|█████████ | 9/10 [01:04<00:06,  6.94s/it]  {'epoch': 8, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8661, 'compress@10': 0.5463, 'time@10': 8.9075}: 100%|██████████| 10/10 [01:04<00:00,  7.47s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8661, 'compress@10': 0.5463, 'time@10': 8.9075}: 100%|██████████| 10/10 [01:04<00:00,  6.45s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04017165537553457
Avg hit ratio: 0.8583875769580354
Avg ndcg: 0.8661270115044891
Avg compression ratio: 0.5462999232729095
Avg train time: 8.907540607452393
Std train time: 2.787607819192352
[0.77, 0.4699999999999999, 0.16999999999999998, 0.8700000000000001, 0.97, 0.8700000000000001, 0.16999999999999998, 0.5700000000000001, 0.27, 0.07]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8444, 'compress@10': 0.7821, 'time@10': 7.9645}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8444, 'compress@10': 0.7821, 'time@10': 7.9645}:  10%|█         | 1/10 [00:04<00:36,  4.02s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8644, 'compress@10': 0.6346, 'time@10': 7.4836}:  10%|█         | 1/10 [00:11<00:36,  4.02s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0418, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8644, 'compress@10': 0.6346, 'time@10': 7.4836}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.862, 'compress@10': 0.5193, 'time@10': 6.6483}:  20%|██        | 2/10 [00:13<00:46,  5.80s/it] {'epoch': 9, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.862, 'compress@10': 0.5193, 'time@10': 6.6483}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8692, 'compress@10': 0.6081, 'time@10': 6.4234}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.032, 'hit_ratio@10': 0.8348, 'ndcg@10': 0.8692, 'compress@10': 0.6081, 'time@10': 6.4234}:  40%|████      | 4/10 [00:19<00:29,  4.89s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0395, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8534, 'compress@10': 0.6806, 'time@10': 7.6944}:  40%|████      | 4/10 [00:25<00:29,  4.89s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0395, 'hit_ratio@10': 0.8358, 'ndcg@10': 0.8534, 'compress@10': 0.6806, 'time@10': 7.6944}:  50%|█████     | 5/10 [00:25<00:27,  5.44s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0397, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8554, 'compress@10': 0.7126, 'time@10': 8.0872}:  50%|█████     | 5/10 [00:35<00:27,  5.44s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0397, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8554, 'compress@10': 0.7126, 'time@10': 8.0872}:  60%|██████    | 6/10 [00:35<00:28,  7.02s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0392, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8539, 'compress@10': 0.6399, 'time@10': 8.4434}:  60%|██████    | 6/10 [00:41<00:28,  7.02s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0392, 'hit_ratio@10': 0.8611, 'ndcg@10': 0.8539, 'compress@10': 0.6399, 'time@10': 8.4434}:  70%|███████   | 7/10 [00:41<00:19,  6.47s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0394, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8569, 'compress@10': 0.6327, 'time@10': 8.3561}:  70%|███████   | 7/10 [00:48<00:19,  6.47s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0394, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.8569, 'compress@10': 0.6327, 'time@10': 8.3561}:  80%|████████  | 8/10 [00:48<00:13,  6.89s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0384, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8657, 'compress@10': 0.5947, 'time@10': 8.97}:  80%|████████  | 8/10 [00:55<00:13,  6.89s/it] {'epoch': 9, 'num_users': 6.3333, 'loss': 0.0384, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8657, 'compress@10': 0.5947, 'time@10': 8.97}:  90%|█████████ | 9/10 [00:55<00:06,  6.91s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8667, 'compress@10': 0.5443, 'time@10': 8.9475}:  90%|█████████ | 9/10 [01:04<00:06,  6.91s/it] {'epoch': 9, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8667, 'compress@10': 0.5443, 'time@10': 8.9475}: 100%|██████████| 10/10 [01:04<00:00,  7.49s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0379, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.8667, 'compress@10': 0.5443, 'time@10': 8.9475}: 100%|██████████| 10/10 [01:04<00:00,  6.48s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03787632162795342
Avg hit ratio: 0.8668161483866067
Avg ndcg: 0.8666798891156076
Avg compression ratio: 0.5443344901254096
Avg train time: 8.947532105445863
Std train time: 2.740930596258819
[0.7909090909090909, 0.4272727272727272, 0.15454545454545454, 0.881818181818182, 0.9727272727272727, 0.881818181818182, 0.15454545454545454, 0.6090909090909091, 0.24545454545454548, 0.06363636363636364]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8786, 'compress@10': 0.8019, 'time@10': 8.035}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8786, 'compress@10': 0.8019, 'time@10': 8.035}:  10%|█         | 1/10 [00:04<00:36,  4.05s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8853, 'compress@10': 0.6238, 'time@10': 7.4865}:  10%|█         | 1/10 [00:11<00:36,  4.05s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8853, 'compress@10': 0.6238, 'time@10': 7.4865}:  20%|██        | 2/10 [00:11<00:46,  5.77s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8759, 'compress@10': 0.5077, 'time@10': 6.763}:  20%|██        | 2/10 [00:13<00:46,  5.77s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0254, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8759, 'compress@10': 0.5077, 'time@10': 6.763}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8808, 'compress@10': 0.6022, 'time@10': 6.5063}:  30%|███       | 3/10 [00:19<00:30,  4.37s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8808, 'compress@10': 0.6022, 'time@10': 6.5063}:  40%|████      | 4/10 [00:19<00:29,  4.92s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0359, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8634, 'compress@10': 0.6765, 'time@10': 7.726}:  40%|████      | 4/10 [00:25<00:29,  4.92s/it] {'epoch': 10, 'num_users': 5.8, 'loss': 0.0359, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8634, 'compress@10': 0.6765, 'time@10': 7.726}:  50%|█████     | 5/10 [00:25<00:27,  5.44s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0361, 'hit_ratio@10': 0.843, 'ndcg@10': 0.864, 'compress@10': 0.7111, 'time@10': 8.0943}:  50%|█████     | 5/10 [00:35<00:27,  5.44s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0361, 'hit_ratio@10': 0.843, 'ndcg@10': 0.864, 'compress@10': 0.7111, 'time@10': 8.0943}:  60%|██████    | 6/10 [00:35<00:27,  6.98s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.037, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8692, 'compress@10': 0.6364, 'time@10': 8.4707}:  60%|██████    | 6/10 [00:41<00:27,  6.98s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.037, 'hit_ratio@10': 0.8597, 'ndcg@10': 0.8692, 'compress@10': 0.6364, 'time@10': 8.4707}:  70%|███████   | 7/10 [00:41<00:19,  6.47s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0373, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.87, 'compress@10': 0.6344, 'time@10': 8.3926}:  70%|███████   | 7/10 [00:49<00:19,  6.47s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.0373, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.87, 'compress@10': 0.6344, 'time@10': 8.3926}:  80%|████████  | 8/10 [00:49<00:13,  6.92s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0376, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.886, 'compress@10': 0.5936, 'time@10': 8.9606}:  80%|████████  | 8/10 [00:55<00:13,  6.92s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0376, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.886, 'compress@10': 0.5936, 'time@10': 8.9606}:  90%|█████████ | 9/10 [00:55<00:06,  6.88s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8878, 'compress@10': 0.5427, 'time@10': 8.9418}:  90%|█████████ | 9/10 [01:04<00:06,  6.88s/it]  {'epoch': 10, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8878, 'compress@10': 0.5427, 'time@10': 8.9418}: 100%|██████████| 10/10 [01:04<00:00,  7.47s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0367, 'hit_ratio@10': 0.8738, 'ndcg@10': 0.8878, 'compress@10': 0.5427, 'time@10': 8.9418}: 100%|██████████| 10/10 [01:04<00:00,  6.47s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.036675297460841784
Avg hit ratio: 0.8737995771442291
Avg ndcg: 0.8878169209554032
Avg compression ratio: 0.5427259252445126
Avg train time: 8.941814041137695
Std train time: 2.6058610013709167
[0.8083333333333333, 0.3916666666666666, 0.14166666666666666, 0.8083333333333335, 0.975, 0.8083333333333335, 0.22499999999999998, 0.6416666666666667, 0.30833333333333335, 0.05833333333333334]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.844, 'compress@10': 0.8184, 'time@10': 8.0442}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.844, 'compress@10': 0.8184, 'time@10': 8.0442}:  10%|█         | 1/10 [00:04<00:36,  4.06s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8722, 'compress@10': 0.6149, 'time@10': 7.5159}:  10%|█         | 1/10 [00:11<00:36,  4.06s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0375, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8722, 'compress@10': 0.6149, 'time@10': 7.5159}:  20%|██        | 2/10 [00:11<00:46,  5.80s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8672, 'compress@10': 0.498, 'time@10': 6.7275}:  20%|██        | 2/10 [00:13<00:46,  5.80s/it]  {'epoch': 11, 'num_users': 5.0, 'loss': 0.025, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8672, 'compress@10': 0.498, 'time@10': 6.7275}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8721, 'compress@10': 0.5773, 'time@10': 6.4943}:  30%|███       | 3/10 [00:19<00:30,  4.35s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8721, 'compress@10': 0.5773, 'time@10': 6.4943}:  40%|████      | 4/10 [00:19<00:29,  4.93s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0349, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8598, 'compress@10': 0.6569, 'time@10': 7.7509}:  40%|████      | 4/10 [00:25<00:29,  4.93s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0349, 'hit_ratio@10': 0.8439, 'ndcg@10': 0.8598, 'compress@10': 0.6569, 'time@10': 7.7509}:  50%|█████     | 5/10 [00:25<00:27,  5.47s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0346, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8617, 'compress@10': 0.6829, 'time@10': 8.1004}:  50%|█████     | 5/10 [00:35<00:27,  5.47s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0346, 'hit_ratio@10': 0.8588, 'ndcg@10': 0.8617, 'compress@10': 0.6829, 'time@10': 8.1004}:  60%|██████    | 6/10 [00:35<00:27,  6.97s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8605, 'compress@10': 0.6219, 'time@10': 8.4946}:  60%|██████    | 6/10 [00:41<00:27,  6.97s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0345, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.8605, 'compress@10': 0.6219, 'time@10': 8.4946}:  70%|███████   | 7/10 [00:41<00:19,  6.48s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0347, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.8609, 'compress@10': 0.6256, 'time@10': 8.3983}:  70%|███████   | 7/10 [00:49<00:19,  6.48s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0347, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.8609, 'compress@10': 0.6256, 'time@10': 8.3983}:  80%|████████  | 8/10 [00:49<00:13,  6.89s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0356, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8826, 'compress@10': 0.5926, 'time@10': 9.0533}:  80%|████████  | 8/10 [00:56<00:13,  6.89s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0356, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8826, 'compress@10': 0.5926, 'time@10': 9.0533}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0352, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8838, 'compress@10': 0.5413, 'time@10': 9.0088}:  90%|█████████ | 9/10 [01:04<00:06,  6.98s/it]   {'epoch': 11, 'num_users': 6.3, 'loss': 0.0352, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8838, 'compress@10': 0.5413, 'time@10': 9.0088}: 100%|██████████| 10/10 [01:04<00:00,  7.50s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0352, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.8838, 'compress@10': 0.5413, 'time@10': 9.0088}: 100%|██████████| 10/10 [01:04<00:00,  6.49s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03521657773145228
Avg hit ratio: 0.8724408014170324
Avg ndcg: 0.8837674572241632
Avg compression ratio: 0.5412967589907127
Avg train time: 9.0088121175766
Std train time: 2.7981627968217393
[0.823076923076923, 0.3615384615384615, 0.13076923076923078, 0.8230769230769232, 0.9769230769230769, 0.7461538461538463, 0.20769230769230768, 0.6692307692307693, 0.36153846153846153, 0.053846153846153856]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8696, 'compress@10': 0.8324, 'time@10': 7.8259}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8696, 'compress@10': 0.8324, 'time@10': 7.8259}:  10%|█         | 1/10 [00:03<00:35,  3.95s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.885, 'compress@10': 0.6073, 'time@10': 7.3902}:  10%|█         | 1/10 [00:10<00:35,  3.95s/it] {'epoch': 12, 'num_users': 7.0, 'loss': 0.0331, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.885, 'compress@10': 0.6073, 'time@10': 7.3902}:  20%|██        | 2/10 [00:10<00:45,  5.74s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8757, 'compress@10': 0.4898, 'time@10': 6.8031}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0221, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8757, 'compress@10': 0.4898, 'time@10': 6.8031}:  30%|███       | 3/10 [00:13<00:30,  4.42s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8772, 'compress@10': 0.5747, 'time@10': 6.5538}:  30%|███       | 3/10 [00:19<00:30,  4.42s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0258, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8772, 'compress@10': 0.5747, 'time@10': 6.5538}:  40%|████      | 4/10 [00:19<00:29,  4.98s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0326, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8643, 'compress@10': 0.6552, 'time@10': 7.7334}:  40%|████      | 4/10 [00:25<00:29,  4.98s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0326, 'hit_ratio@10': 0.8374, 'ndcg@10': 0.8643, 'compress@10': 0.6552, 'time@10': 7.7334}:  50%|█████     | 5/10 [00:25<00:27,  5.44s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0325, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8675, 'compress@10': 0.6713, 'time@10': 8.0461}:  50%|█████     | 5/10 [00:35<00:27,  5.44s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0325, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8675, 'compress@10': 0.6713, 'time@10': 8.0461}:  60%|██████    | 6/10 [00:35<00:27,  6.87s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0326, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.873, 'compress@10': 0.6096, 'time@10': 8.4445}:  60%|██████    | 6/10 [00:40<00:27,  6.87s/it] {'epoch': 12, 'num_users': 6.2857, 'loss': 0.0326, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.873, 'compress@10': 0.6096, 'time@10': 8.4445}:  70%|███████   | 7/10 [00:40<00:19,  6.41s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0318, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8762, 'compress@10': 0.6183, 'time@10': 8.356}:  70%|███████   | 7/10 [00:48<00:19,  6.41s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0318, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8762, 'compress@10': 0.6183, 'time@10': 8.356}:  80%|████████  | 8/10 [00:48<00:13,  6.84s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0333, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.891, 'compress@10': 0.5918, 'time@10': 9.0038}:  80%|████████  | 8/10 [00:55<00:13,  6.84s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0333, 'hit_ratio@10': 0.8724, 'ndcg@10': 0.891, 'compress@10': 0.5918, 'time@10': 9.0038}:  90%|█████████ | 9/10 [00:55<00:06,  6.93s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8953, 'compress@10': 0.5401, 'time@10': 8.9715}:  90%|█████████ | 9/10 [01:04<00:06,  6.93s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8953, 'compress@10': 0.5401, 'time@10': 8.9715}: 100%|██████████| 10/10 [01:04<00:00,  7.48s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8953, 'compress@10': 0.5401, 'time@10': 8.9715}: 100%|██████████| 10/10 [01:04<00:00,  6.46s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03163686437367605
Avg hit ratio: 0.8828789422235941
Avg ndcg: 0.8952802553145004
Avg compression ratio: 0.5401207751628017
Avg train time: 8.971458673477173
Std train time: 2.671682580458676
[0.8357142857142856, 0.33571428571428563, 0.12142857142857144, 0.8357142857142857, 0.9785714285714285, 0.692857142857143, 0.2642857142857143, 0.6214285714285714, 0.40714285714285714, 0.05000000000000001]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8707, 'compress@10': 0.8443, 'time@10': 7.9334}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0388, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8707, 'compress@10': 0.8443, 'time@10': 7.9334}:  10%|█         | 1/10 [00:04<00:36,  4.00s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8825, 'compress@10': 0.6007, 'time@10': 7.3987}:  10%|█         | 1/10 [00:10<00:36,  4.00s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0339, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8825, 'compress@10': 0.6007, 'time@10': 7.3987}:  20%|██        | 2/10 [00:10<00:45,  5.71s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0226, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.874, 'compress@10': 0.4828, 'time@10': 6.7692}:  20%|██        | 2/10 [00:13<00:45,  5.71s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0226, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.874, 'compress@10': 0.4828, 'time@10': 6.7692}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8759, 'compress@10': 0.5725, 'time@10': 6.5315}:  30%|███       | 3/10 [00:19<00:30,  4.38s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8759, 'compress@10': 0.5725, 'time@10': 6.5315}:  40%|████      | 4/10 [00:19<00:29,  4.96s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8639, 'compress@10': 0.6538, 'time@10': 7.653}:  40%|████      | 4/10 [00:25<00:29,  4.96s/it] {'epoch': 13, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8639, 'compress@10': 0.6538, 'time@10': 7.653}:  50%|█████     | 5/10 [00:25<00:26,  5.37s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0317, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8677, 'compress@10': 0.6614, 'time@10': 8.0752}:  50%|█████     | 5/10 [00:35<00:26,  5.37s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0317, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.8677, 'compress@10': 0.6614, 'time@10': 8.0752}:  60%|██████    | 6/10 [00:35<00:28,  7.02s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0311, 'hit_ratio@10': 0.879, 'ndcg@10': 0.871, 'compress@10': 0.6089, 'time@10': 8.4921}:  60%|██████    | 6/10 [00:41<00:28,  7.02s/it]  {'epoch': 13, 'num_users': 6.2857, 'loss': 0.0311, 'hit_ratio@10': 0.879, 'ndcg@10': 0.871, 'compress@10': 0.6089, 'time@10': 8.4921}:  70%|███████   | 7/10 [00:41<00:19,  6.54s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0296, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8765, 'compress@10': 0.6118, 'time@10': 8.4115}:  70%|███████   | 7/10 [00:49<00:19,  6.54s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0296, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.8765, 'compress@10': 0.6118, 'time@10': 8.4115}:  80%|████████  | 8/10 [00:49<00:13,  6.96s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0296, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8821, 'compress@10': 0.591, 'time@10': 9.0592}:  80%|████████  | 8/10 [00:56<00:13,  6.96s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0296, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.8821, 'compress@10': 0.591, 'time@10': 9.0592}:  90%|█████████ | 9/10 [00:56<00:07,  7.02s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.8843, 'compress@10': 0.539, 'time@10': 9.0141}:  90%|█████████ | 9/10 [01:05<00:07,  7.02s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.8843, 'compress@10': 0.539, 'time@10': 9.0141}: 100%|██████████| 10/10 [01:05<00:00,  7.53s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0298, 'hit_ratio@10': 0.8873, 'ndcg@10': 0.8843, 'compress@10': 0.539, 'time@10': 9.0141}: 100%|██████████| 10/10 [01:05<00:00,  6.51s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.029783766554467704
Avg hit ratio: 0.8872849572611882
Avg ndcg: 0.8842903906771935
Avg compression ratio: 0.5390320938421201
Avg train time: 9.014097213745117
Std train time: 2.686717235232589
[0.8466666666666666, 0.31333333333333324, 0.11333333333333334, 0.8466666666666667, 0.98, 0.6466666666666667, 0.24666666666666667, 0.58, 0.44666666666666666, 0.11333333333333334]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8467, 'compress@10': 0.8547, 'time@10': 7.826}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8467, 'compress@10': 0.8547, 'time@10': 7.826}:  10%|█         | 1/10 [00:03<00:35,  3.95s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8732, 'compress@10': 0.5951, 'time@10': 7.4088}:  10%|█         | 1/10 [00:10<00:35,  3.95s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0379, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8732, 'compress@10': 0.5951, 'time@10': 7.4088}:  20%|██        | 2/10 [00:10<00:46,  5.76s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8678, 'compress@10': 0.4767, 'time@10': 6.7369}:  20%|██        | 2/10 [00:13<00:46,  5.76s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8678, 'compress@10': 0.4767, 'time@10': 6.7369}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8726, 'compress@10': 0.5706, 'time@10': 6.4859}:  30%|███       | 3/10 [00:19<00:30,  4.38s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8726, 'compress@10': 0.5706, 'time@10': 6.4859}:  40%|████      | 4/10 [00:19<00:29,  4.93s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.033, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8631, 'compress@10': 0.6525, 'time@10': 7.669}:  40%|████      | 4/10 [00:25<00:29,  4.93s/it]  {'epoch': 14, 'num_users': 5.8, 'loss': 0.033, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8631, 'compress@10': 0.6525, 'time@10': 7.669}:  50%|█████     | 5/10 [00:25<00:27,  5.40s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0322, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8676, 'compress@10': 0.6529, 'time@10': 8.0744}:  50%|█████     | 5/10 [00:35<00:27,  5.40s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0322, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8676, 'compress@10': 0.6529, 'time@10': 8.0744}:  60%|██████    | 6/10 [00:35<00:28,  7.01s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0315, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.874, 'compress@10': 0.5991, 'time@10': 8.4555}:  60%|██████    | 6/10 [00:41<00:28,  7.01s/it] {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0315, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.874, 'compress@10': 0.5991, 'time@10': 8.4555}:  70%|███████   | 7/10 [00:41<00:19,  6.49s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0302, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8792, 'compress@10': 0.5983, 'time@10': 8.3774}:  70%|███████   | 7/10 [00:49<00:19,  6.49s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0302, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8792, 'compress@10': 0.5983, 'time@10': 8.3774}:  80%|████████  | 8/10 [00:49<00:13,  6.93s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8861, 'compress@10': 0.5832, 'time@10': 9.0341}:  80%|████████  | 8/10 [00:56<00:13,  6.93s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.029, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8861, 'compress@10': 0.5832, 'time@10': 9.0341}:  90%|█████████ | 9/10 [00:56<00:07,  7.01s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0274, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8918, 'compress@10': 0.5382, 'time@10': 9.0644}:  90%|█████████ | 9/10 [01:05<00:07,  7.01s/it]  {'epoch': 14, 'num_users': 6.3, 'loss': 0.0274, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8918, 'compress@10': 0.5382, 'time@10': 9.0644}: 100%|██████████| 10/10 [01:05<00:00,  7.74s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0274, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.8918, 'compress@10': 0.5382, 'time@10': 9.0644}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.02735737360344087
Avg hit ratio: 0.8842440215886735
Avg ndcg: 0.8918267028738216
Avg compression ratio: 0.5382013461079749
Avg train time: 9.064411377906799
Std train time: 2.7260843050274577
[0.85625, 0.3562499999999999, 0.10625000000000001, 0.85625, 0.98125, 0.6687500000000001, 0.23125, 0.54375, 0.41875, 0.10625000000000001]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0382, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8729, 'compress@10': 0.8638, 'time@10': 7.551}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0382, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8729, 'compress@10': 0.8638, 'time@10': 7.551}:  10%|█         | 1/10 [00:03<00:34,  3.81s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0318, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8913, 'compress@10': 0.6204, 'time@10': 7.2892}:  10%|█         | 1/10 [00:10<00:34,  3.81s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0318, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8913, 'compress@10': 0.6204, 'time@10': 7.2892}:  20%|██        | 2/10 [00:10<00:45,  5.73s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8799, 'compress@10': 0.4916, 'time@10': 6.7256}:  20%|██        | 2/10 [00:13<00:45,  5.73s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0212, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8799, 'compress@10': 0.4916, 'time@10': 6.7256}:  30%|███       | 3/10 [00:13<00:30,  4.41s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8833, 'compress@10': 0.584, 'time@10': 6.4731}:  30%|███       | 3/10 [00:19<00:30,  4.41s/it] {'epoch': 15, 'num_users': 5.0, 'loss': 0.0241, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8833, 'compress@10': 0.584, 'time@10': 6.4731}:  40%|████      | 4/10 [00:19<00:29,  4.94s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8735, 'compress@10': 0.6635, 'time@10': 7.7257}:  40%|████      | 4/10 [00:25<00:29,  4.94s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8735, 'compress@10': 0.6635, 'time@10': 7.7257}:  50%|█████     | 5/10 [00:25<00:27,  5.47s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0307, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8781, 'compress@10': 0.6656, 'time@10': 8.1078}:  50%|█████     | 5/10 [00:35<00:27,  5.47s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0307, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8781, 'compress@10': 0.6656, 'time@10': 8.1078}:  60%|██████    | 6/10 [00:35<00:28,  7.03s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0304, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8816, 'compress@10': 0.608, 'time@10': 8.4877}:  60%|██████    | 6/10 [00:41<00:28,  7.03s/it] {'epoch': 15, 'num_users': 6.2857, 'loss': 0.0304, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8816, 'compress@10': 0.608, 'time@10': 8.4877}:  70%|███████   | 7/10 [00:41<00:19,  6.50s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0296, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8832, 'compress@10': 0.6016, 'time@10': 8.411}:  70%|███████   | 7/10 [00:49<00:19,  6.50s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0296, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8832, 'compress@10': 0.6016, 'time@10': 8.411}:  80%|████████  | 8/10 [00:49<00:13,  6.95s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0286, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8907, 'compress@10': 0.5831, 'time@10': 9.0221}:  80%|████████  | 8/10 [00:56<00:13,  6.95s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0286, 'hit_ratio@10': 0.8739, 'ndcg@10': 0.8907, 'compress@10': 0.5831, 'time@10': 9.0221}:  90%|█████████ | 9/10 [00:56<00:06,  6.96s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0295, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.891, 'compress@10': 0.5375, 'time@10': 8.9883}:  90%|█████████ | 9/10 [01:04<00:06,  6.96s/it]    {'epoch': 15, 'num_users': 6.3, 'loss': 0.0295, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.891, 'compress@10': 0.5375, 'time@10': 8.9883}: 100%|██████████| 10/10 [01:04<00:00,  7.51s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0295, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.891, 'compress@10': 0.5375, 'time@10': 8.9883}: 100%|██████████| 10/10 [01:04<00:00,  6.50s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.02947574428157749
Avg hit ratio: 0.8842440215886735
Avg ndcg: 0.8910294630682005
Avg compression ratio: 0.5374550730533039
Avg train time: 8.988264012336732
Std train time: 2.6823688223688613
[0.8647058823529411, 0.33529411764705874, 0.1, 0.8647058823529411, 0.9823529411764705, 0.6882352941176472, 0.21764705882352942, 0.5117647058823529, 0.3941176470588235, 0.15882352941176472]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8701, 'compress@10': 0.8718, 'time@10': 7.6813}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0321, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8701, 'compress@10': 0.8718, 'time@10': 7.6813}:  10%|█         | 1/10 [00:03<00:34,  3.88s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0281, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8897, 'compress@10': 0.6143, 'time@10': 7.2914}:  10%|█         | 1/10 [00:10<00:34,  3.88s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0281, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8897, 'compress@10': 0.6143, 'time@10': 7.2914}:  20%|██        | 2/10 [00:10<00:45,  5.68s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8789, 'compress@10': 0.4857, 'time@10': 6.5524}:  20%|██        | 2/10 [00:13<00:45,  5.68s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0188, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8789, 'compress@10': 0.4857, 'time@10': 6.5524}:  30%|███       | 3/10 [00:13<00:29,  4.26s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8853, 'compress@10': 0.5817, 'time@10': 6.3549}:  30%|███       | 3/10 [00:19<00:29,  4.26s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0217, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8853, 'compress@10': 0.5817, 'time@10': 6.3549}:  40%|████      | 4/10 [00:19<00:29,  4.87s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0268, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8769, 'compress@10': 0.6619, 'time@10': 7.6373}:  40%|████      | 4/10 [00:25<00:29,  4.87s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0268, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8769, 'compress@10': 0.6619, 'time@10': 7.6373}:  50%|█████     | 5/10 [00:25<00:27,  5.43s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0273, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8838, 'compress@10': 0.6674, 'time@10': 8.0709}:  50%|█████     | 5/10 [00:35<00:27,  5.43s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0273, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8838, 'compress@10': 0.6674, 'time@10': 8.0709}:  60%|██████    | 6/10 [00:35<00:28,  7.08s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8853, 'compress@10': 0.6076, 'time@10': 8.4663}:  60%|██████    | 6/10 [00:41<00:28,  7.08s/it] {'epoch': 16, 'num_users': 6.2857, 'loss': 0.0271, 'hit_ratio@10': 0.877, 'ndcg@10': 0.8853, 'compress@10': 0.6076, 'time@10': 8.4663}:  70%|███████   | 7/10 [00:41<00:19,  6.55s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0262, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.8904, 'compress@10': 0.5974, 'time@10': 8.3866}:  70%|███████   | 7/10 [00:49<00:19,  6.55s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0262, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.8904, 'compress@10': 0.5974, 'time@10': 8.3866}:  80%|████████  | 8/10 [00:49<00:13,  6.97s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9042, 'compress@10': 0.5767, 'time@10': 9.0139}:  80%|████████  | 8/10 [00:56<00:13,  6.97s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0268, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.9042, 'compress@10': 0.5767, 'time@10': 9.0139}:  90%|█████████ | 9/10 [00:56<00:06,  6.99s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0258, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9081, 'compress@10': 0.5369, 'time@10': 9.0789}:  90%|█████████ | 9/10 [01:05<00:06,  6.99s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0258, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9081, 'compress@10': 0.5369, 'time@10': 9.0789}: 100%|██████████| 10/10 [01:05<00:00,  7.84s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0258, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9081, 'compress@10': 0.5369, 'time@10': 9.0789}: 100%|██████████| 10/10 [01:05<00:00,  6.60s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.02579017260215453
Avg hit ratio: 0.8859357509119817
Avg ndcg: 0.908110756570766
Avg compression ratio: 0.5368524726679949
Avg train time: 9.078909230232238
Std train time: 2.7966438852000337
[0.8722222222222221, 0.3166666666666666, 0.09444444444444446, 0.8722222222222221, 0.9833333333333333, 0.7055555555555557, 0.20555555555555555, 0.4833333333333333, 0.42777777777777776, 0.15000000000000002]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8796, 'compress@10': 0.8789, 'time@10': 7.8127}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0372, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8796, 'compress@10': 0.8789, 'time@10': 7.8127}:  10%|█         | 1/10 [00:03<00:35,  3.94s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8987, 'compress@10': 0.6088, 'time@10': 7.392}:  10%|█         | 1/10 [00:10<00:35,  3.94s/it]   {'epoch': 17, 'num_users': 7.0, 'loss': 0.03, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8987, 'compress@10': 0.6088, 'time@10': 7.392}:  20%|██        | 2/10 [00:10<00:45,  5.75s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8848, 'compress@10': 0.4805, 'time@10': 6.6901}:  20%|██        | 2/10 [00:13<00:45,  5.75s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.02, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8848, 'compress@10': 0.4805, 'time@10': 6.6901}:  30%|███       | 3/10 [00:13<00:30,  4.35s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8895, 'compress@10': 0.5796, 'time@10': 6.4168}:  30%|███       | 3/10 [00:19<00:30,  4.35s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0224, 'hit_ratio@10': 0.8318, 'ndcg@10': 0.8895, 'compress@10': 0.5796, 'time@10': 6.4168}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0269, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8816, 'compress@10': 0.6604, 'time@10': 7.665}:  40%|████      | 4/10 [00:25<00:29,  4.86s/it] {'epoch': 17, 'num_users': 5.8, 'loss': 0.0269, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8816, 'compress@10': 0.6604, 'time@10': 7.665}:  50%|█████     | 5/10 [00:25<00:27,  5.40s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0252, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8903, 'compress@10': 0.669, 'time@10': 8.0872}:  50%|█████     | 5/10 [00:35<00:27,  5.40s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0252, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.8903, 'compress@10': 0.669, 'time@10': 8.0872}:  60%|██████    | 6/10 [00:35<00:28,  7.05s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0251, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8927, 'compress@10': 0.6073, 'time@10': 8.4917}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0251, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.8927, 'compress@10': 0.6073, 'time@10': 8.4917}:  70%|███████   | 7/10 [00:41<00:19,  6.54s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0246, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8951, 'compress@10': 0.5937, 'time@10': 8.4281}:  70%|███████   | 7/10 [00:49<00:19,  6.54s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0246, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.8951, 'compress@10': 0.5937, 'time@10': 8.4281}:  80%|████████  | 8/10 [00:49<00:14,  7.01s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0255, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9017, 'compress@10': 0.5771, 'time@10': 9.0212}:  80%|████████  | 8/10 [00:56<00:14,  7.01s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0255, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9017, 'compress@10': 0.5771, 'time@10': 9.0212}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9056, 'compress@10': 0.5363, 'time@10': 9.0816}:  90%|█████████ | 9/10 [01:05<00:06,  6.98s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9056, 'compress@10': 0.5363, 'time@10': 9.0816}: 100%|██████████| 10/10 [01:05<00:00,  7.81s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0253, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9056, 'compress@10': 0.5363, 'time@10': 9.0816}: 100%|██████████| 10/10 [01:05<00:00,  6.60s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.025257186586457248
Avg hit ratio: 0.8805670873175118
Avg ndcg: 0.9056150759515947
Avg compression ratio: 0.536284904049309
Avg train time: 9.081574010849
Std train time: 2.7104960138568064
[0.8789473684210526, 0.29999999999999993, 0.08947368421052633, 0.8789473684210526, 0.9842105263157894, 0.6684210526315791, 0.24736842105263157, 0.45789473684210524, 0.45789473684210524, 0.14210526315789476]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8796, 'compress@10': 0.8853, 'time@10': 7.8884}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0371, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8796, 'compress@10': 0.8853, 'time@10': 7.8884}:  10%|█         | 1/10 [00:03<00:35,  3.99s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9001, 'compress@10': 0.6039, 'time@10': 7.3989}:  10%|█         | 1/10 [00:10<00:35,  3.99s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9001, 'compress@10': 0.6039, 'time@10': 7.3989}:  20%|██        | 2/10 [00:10<00:45,  5.73s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8858, 'compress@10': 0.4758, 'time@10': 6.6718}:  20%|██        | 2/10 [00:13<00:45,  5.73s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8858, 'compress@10': 0.4758, 'time@10': 6.6718}:  30%|███       | 3/10 [00:13<00:30,  4.32s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8892, 'compress@10': 0.5777, 'time@10': 6.4704}:  30%|███       | 3/10 [00:19<00:30,  4.32s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8892, 'compress@10': 0.5777, 'time@10': 6.4704}:  40%|████      | 4/10 [00:19<00:29,  4.95s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8824, 'compress@10': 0.659, 'time@10': 7.6896}:  40%|████      | 4/10 [00:25<00:29,  4.95s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.8447, 'ndcg@10': 0.8824, 'compress@10': 0.659, 'time@10': 7.6896}:  50%|█████     | 5/10 [00:25<00:27,  5.45s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.026, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8893, 'compress@10': 0.6618, 'time@10': 8.0894}:  50%|█████     | 5/10 [00:35<00:27,  5.45s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.026, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.8893, 'compress@10': 0.6618, 'time@10': 8.0894}:  60%|██████    | 6/10 [00:35<00:28,  7.04s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0268, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8917, 'compress@10': 0.6069, 'time@10': 8.484}:  60%|██████    | 6/10 [00:41<00:28,  7.04s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0268, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.8917, 'compress@10': 0.6069, 'time@10': 8.484}:  70%|███████   | 7/10 [00:41<00:19,  6.53s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0264, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.8915, 'compress@10': 0.5902, 'time@10': 8.4041}:  70%|███████   | 7/10 [00:49<00:19,  6.53s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0264, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.8915, 'compress@10': 0.5902, 'time@10': 8.4041}:  80%|████████  | 8/10 [00:49<00:13,  6.96s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0296, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9145, 'compress@10': 0.5772, 'time@10': 9.053}:  80%|████████  | 8/10 [00:56<00:13,  6.96s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0296, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9145, 'compress@10': 0.5772, 'time@10': 9.053}:  90%|█████████ | 9/10 [00:56<00:07,  7.02s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0288, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9171, 'compress@10': 0.5357, 'time@10': 9.1214}:  90%|█████████ | 9/10 [01:06<00:07,  7.02s/it]  {'epoch': 18, 'num_users': 6.3, 'loss': 0.0288, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9171, 'compress@10': 0.5357, 'time@10': 9.1214}: 100%|██████████| 10/10 [01:06<00:00,  7.87s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0288, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9171, 'compress@10': 0.5357, 'time@10': 9.1214}: 100%|██████████| 10/10 [01:06<00:00,  6.63s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.028825593050472647
Avg hit ratio: 0.8853008302770611
Avg ndcg: 0.9170626996943041
Avg compression ratio: 0.5356846554485107
Avg train time: 9.12139596939087
Std train time: 2.7620734646320453
[0.885, 0.2849999999999999, 0.08500000000000002, 0.885, 0.985, 0.6350000000000002, 0.285, 0.435, 0.485, 0.13500000000000004]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0327, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8849, 'compress@10': 0.891, 'time@10': 7.6477}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0327, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8849, 'compress@10': 0.891, 'time@10': 7.6477}:  10%|█         | 1/10 [00:03<00:34,  3.86s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9041, 'compress@10': 0.5996, 'time@10': 7.2021}:  10%|█         | 1/10 [00:10<00:34,  3.86s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9041, 'compress@10': 0.5996, 'time@10': 7.2021}:  20%|██        | 2/10 [00:10<00:44,  5.59s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8884, 'compress@10': 0.4716, 'time@10': 6.5467}:  20%|██        | 2/10 [00:13<00:44,  5.59s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0181, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8884, 'compress@10': 0.4716, 'time@10': 6.5467}:  30%|███       | 3/10 [00:13<00:29,  4.25s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8948, 'compress@10': 0.576, 'time@10': 6.3412}:  30%|███       | 3/10 [00:19<00:29,  4.25s/it]  {'epoch': 19, 'num_users': 5.0, 'loss': 0.0204, 'hit_ratio@10': 0.839, 'ndcg@10': 0.8948, 'compress@10': 0.576, 'time@10': 6.3412}:  40%|████      | 4/10 [00:19<00:29,  4.85s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8871, 'compress@10': 0.6578, 'time@10': 7.5648}:  40%|████      | 4/10 [00:25<00:29,  4.85s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8552, 'ndcg@10': 0.8871, 'compress@10': 0.6578, 'time@10': 7.5648}:  50%|█████     | 5/10 [00:25<00:26,  5.36s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0254, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8984, 'compress@10': 0.6554, 'time@10': 7.9998}:  50%|█████     | 5/10 [00:35<00:26,  5.36s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0254, 'hit_ratio@10': 0.8719, 'ndcg@10': 0.8984, 'compress@10': 0.6554, 'time@10': 7.9998}:  60%|██████    | 6/10 [00:35<00:28,  7.01s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0251, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.899, 'compress@10': 0.6066, 'time@10': 8.4493}:  60%|██████    | 6/10 [00:41<00:28,  7.01s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0251, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.899, 'compress@10': 0.6066, 'time@10': 8.4493}:  70%|███████   | 7/10 [00:41<00:19,  6.55s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0242, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9026, 'compress@10': 0.5871, 'time@10': 8.3821}:  70%|███████   | 7/10 [00:49<00:19,  6.55s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0242, 'hit_ratio@10': 0.8954, 'ndcg@10': 0.9026, 'compress@10': 0.5871, 'time@10': 8.3821}:  80%|████████  | 8/10 [00:49<00:13,  7.00s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0251, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.9034, 'compress@10': 0.5774, 'time@10': 9.0221}:  80%|████████  | 8/10 [00:56<00:13,  7.00s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0251, 'hit_ratio@10': 0.8752, 'ndcg@10': 0.9034, 'compress@10': 0.5774, 'time@10': 9.0221}:  90%|█████████ | 9/10 [00:56<00:07,  7.03s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.909, 'compress@10': 0.5351, 'time@10': 9.0701}:  90%|█████████ | 9/10 [01:05<00:07,  7.03s/it]    {'epoch': 19, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.909, 'compress@10': 0.5351, 'time@10': 9.0701}: 100%|██████████| 10/10 [01:05<00:00,  7.81s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0244, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.909, 'compress@10': 0.5351, 'time@10': 9.0701}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.024400241435601773
Avg hit ratio: 0.885447271649309
Avg ndcg: 0.9089768402905595
Avg compression ratio: 0.535144262379469
Avg train time: 9.07012939453125
Std train time: 2.7845959610927924
[0.8904761904761905, 0.27142857142857135, 0.08095238095238097, 0.8904761904761905, 0.9857142857142857, 0.6523809523809526, 0.2714285714285714, 0.41428571428571426, 0.5095238095238095, 0.12857142857142861]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.8962, 'time@10': 7.7063}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8849, 'compress@10': 0.8962, 'time@10': 7.7063}:  10%|█         | 1/10 [00:03<00:35,  3.90s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9018, 'compress@10': 0.5956, 'time@10': 7.283}:  10%|█         | 1/10 [00:10<00:35,  3.90s/it] {'epoch': 20, 'num_users': 7.0, 'loss': 0.0277, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9018, 'compress@10': 0.5956, 'time@10': 7.283}:  20%|██        | 2/10 [00:10<00:45,  5.66s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8869, 'compress@10': 0.4678, 'time@10': 6.6108}:  20%|██        | 2/10 [00:13<00:45,  5.66s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8869, 'compress@10': 0.4678, 'time@10': 6.6108}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8967, 'compress@10': 0.5745, 'time@10': 6.4002}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.8967, 'compress@10': 0.5745, 'time@10': 6.4002}:  40%|████      | 4/10 [00:19<00:29,  4.89s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0236, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.889, 'compress@10': 0.6568, 'time@10': 7.6184}:  40%|████      | 4/10 [00:25<00:29,  4.89s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.0236, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.889, 'compress@10': 0.6568, 'time@10': 7.6184}:  50%|█████     | 5/10 [00:25<00:26,  5.39s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.898, 'compress@10': 0.6573, 'time@10': 8.0308}:  50%|█████     | 5/10 [00:35<00:26,  5.39s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0223, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.898, 'compress@10': 0.6573, 'time@10': 8.0308}:  60%|██████    | 6/10 [00:35<00:28,  7.00s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.022, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9022, 'compress@10': 0.6064, 'time@10': 8.4451}:  60%|██████    | 6/10 [00:41<00:28,  7.00s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 0.022, 'hit_ratio@10': 0.892, 'ndcg@10': 0.9022, 'compress@10': 0.6064, 'time@10': 8.4451}:  70%|███████   | 7/10 [00:41<00:19,  6.51s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9057, 'compress@10': 0.5844, 'time@10': 8.3692}:  70%|███████   | 7/10 [00:49<00:19,  6.51s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0214, 'hit_ratio@10': 0.9019, 'ndcg@10': 0.9057, 'compress@10': 0.5844, 'time@10': 8.3692}:  80%|████████  | 8/10 [00:49<00:13,  6.95s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9111, 'compress@10': 0.5777, 'time@10': 9.0129}:  80%|████████  | 8/10 [00:56<00:13,  6.95s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0206, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9111, 'compress@10': 0.5777, 'time@10': 9.0129}:  90%|█████████ | 9/10 [00:56<00:07,  7.00s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9109, 'compress@10': 0.5347, 'time@10': 9.0462}:  90%|█████████ | 9/10 [01:05<00:07,  7.00s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9109, 'compress@10': 0.5347, 'time@10': 9.0462}: 100%|██████████| 10/10 [01:05<00:00,  7.74s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9109, 'compress@10': 0.5347, 'time@10': 9.0462}: 100%|██████████| 10/10 [01:05<00:00,  6.56s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.021816040388264034
Avg hit ratio: 0.887853286686903
Avg ndcg: 0.9108812375133857
Avg compression ratio: 0.5347408711873904
Avg train time: 9.046173214912415
Std train time: 2.7540124299433284
[0.8954545454545455, 0.30454545454545445, 0.07727272727272728, 0.8954545454545455, 0.9863636363636363, 0.6227272727272729, 0.2590909090909091, 0.39545454545454545, 0.48636363636363633, 0.1681818181818182]
[10, 10, 22, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8871, 'compress@10': 0.9009, 'time@10': 7.91}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.029, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8871, 'compress@10': 0.9009, 'time@10': 7.91}:  10%|█         | 1/10 [00:03<00:35,  3.99s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9095, 'compress@10': 0.614, 'time@10': 7.3673}:  10%|█         | 1/10 [00:10<00:35,  3.99s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0249, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9095, 'compress@10': 0.614, 'time@10': 7.3673}:  20%|██        | 2/10 [00:10<00:45,  5.68s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.892, 'compress@10': 0.479, 'time@10': 6.5897}:  20%|██        | 2/10 [00:13<00:45,  5.68s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.892, 'compress@10': 0.479, 'time@10': 6.5897}:  30%|███       | 3/10 [00:13<00:29,  4.25s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9042, 'compress@10': 0.584, 'time@10': 6.361}:  30%|███       | 3/10 [00:19<00:29,  4.25s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8521, 'ndcg@10': 0.9042, 'compress@10': 0.584, 'time@10': 6.361}:  40%|████      | 4/10 [00:19<00:28,  4.83s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8959, 'compress@10': 0.6646, 'time@10': 7.6477}:  40%|████      | 4/10 [00:25<00:28,  4.83s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.8959, 'compress@10': 0.6646, 'time@10': 7.6477}:  50%|█████     | 5/10 [00:25<00:27,  5.41s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0208, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9049, 'compress@10': 0.659, 'time@10': 8.0605}:  50%|█████     | 5/10 [00:35<00:27,  5.41s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0208, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9049, 'compress@10': 0.659, 'time@10': 8.0605}:  60%|██████    | 6/10 [00:35<00:28,  7.02s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.022, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9049, 'compress@10': 0.6061, 'time@10': 8.4848}:  60%|██████    | 6/10 [00:41<00:28,  7.02s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.022, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9049, 'compress@10': 0.6061, 'time@10': 8.4848}:  70%|███████   | 7/10 [00:41<00:19,  6.54s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0221, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9047, 'compress@10': 0.5819, 'time@10': 8.3986}:  70%|███████   | 7/10 [00:49<00:19,  6.54s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0221, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9047, 'compress@10': 0.5819, 'time@10': 8.3986}:  80%|████████  | 8/10 [00:49<00:13,  6.96s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0227, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.913, 'compress@10': 0.5729, 'time@10': 9.0263}:  80%|████████  | 8/10 [00:56<00:13,  6.96s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0227, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.913, 'compress@10': 0.5729, 'time@10': 9.0263}:  90%|█████████ | 9/10 [00:56<00:06,  6.99s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9178, 'compress@10': 0.5344, 'time@10': 9.059}:  90%|█████████ | 9/10 [01:05<00:06,  6.99s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9178, 'compress@10': 0.5344, 'time@10': 9.059}: 100%|██████████| 10/10 [01:05<00:00,  7.73s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8986, 'ndcg@10': 0.9178, 'compress@10': 0.5344, 'time@10': 9.059}: 100%|██████████| 10/10 [01:05<00:00,  6.56s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.021930388460008127
Avg hit ratio: 0.8986469374805537
Avg ndcg: 0.9178060870625965
Avg compression ratio: 0.5343516210565712
Avg train time: 9.058965516090392
Std train time: 2.8197803244387276
[0.9, 0.2913043478260869, 0.07391304347826089, 0.9, 0.9869565217391304, 0.5956521739130437, 0.29130434782608694, 0.3782608695652174, 0.508695652173913, 0.16086956521739132]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8871, 'compress@10': 0.9052, 'time@10': 7.603}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8871, 'compress@10': 0.9052, 'time@10': 7.603}:  10%|█         | 1/10 [00:03<00:34,  3.84s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9156, 'compress@10': 0.6097, 'time@10': 7.2541}:  10%|█         | 1/10 [00:10<00:34,  3.84s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9156, 'compress@10': 0.6097, 'time@10': 7.2541}:  20%|██        | 2/10 [00:10<00:45,  5.66s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8961, 'compress@10': 0.4752, 'time@10': 6.6518}:  20%|██        | 2/10 [00:13<00:45,  5.66s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8961, 'compress@10': 0.4752, 'time@10': 6.6518}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9059, 'compress@10': 0.5823, 'time@10': 6.4098}:  30%|███       | 3/10 [00:19<00:30,  4.34s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9059, 'compress@10': 0.5823, 'time@10': 6.4098}:  40%|████      | 4/10 [00:19<00:29,  4.88s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8977, 'compress@10': 0.6633, 'time@10': 7.5868}:  40%|████      | 4/10 [00:25<00:29,  4.88s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0201, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.8977, 'compress@10': 0.6633, 'time@10': 7.5868}:  50%|█████     | 5/10 [00:25<00:26,  5.35s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0216, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9082, 'compress@10': 0.6535, 'time@10': 7.9846}:  50%|█████     | 5/10 [00:35<00:26,  5.35s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0216, 'hit_ratio@10': 0.879, 'ndcg@10': 0.9082, 'compress@10': 0.6535, 'time@10': 7.9846}:  60%|██████    | 6/10 [00:35<00:27,  6.94s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0213, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9095, 'compress@10': 0.6058, 'time@10': 8.4197}:  60%|██████    | 6/10 [00:41<00:27,  6.94s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0213, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9095, 'compress@10': 0.6058, 'time@10': 8.4197}:  70%|███████   | 7/10 [00:41<00:19,  6.48s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0202, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.915, 'compress@10': 0.5796, 'time@10': 8.3417}:  70%|███████   | 7/10 [00:48<00:19,  6.48s/it]  {'epoch': 22, 'num_users': 6.125, 'loss': 0.0202, 'hit_ratio@10': 0.9007, 'ndcg@10': 0.915, 'compress@10': 0.5796, 'time@10': 8.3417}:  80%|████████  | 8/10 [00:48<00:13,  6.91s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0208, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.9191, 'compress@10': 0.5733, 'time@10': 9.0014}:  80%|████████  | 8/10 [00:56<00:13,  6.91s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0208, 'hit_ratio@10': 0.8832, 'ndcg@10': 0.9191, 'compress@10': 0.5733, 'time@10': 9.0014}:  90%|█████████ | 9/10 [00:56<00:06,  6.99s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9231, 'compress@10': 0.5339, 'time@10': 9.0559}:  90%|█████████ | 9/10 [01:05<00:06,  6.99s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9231, 'compress@10': 0.5339, 'time@10': 9.0559}: 100%|██████████| 10/10 [01:05<00:00,  7.79s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0202, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9231, 'compress@10': 0.5339, 'time@10': 9.0559}: 100%|██████████| 10/10 [01:05<00:00,  6.56s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.020209733261908485
Avg hit ratio: 0.892563988171798
Avg ndcg: 0.9230659178634697
Avg compression ratio: 0.5339386600759852
Avg train time: 9.055859184265136
Std train time: 2.747217279931463
[0.9041666666666667, 0.2791666666666666, 0.07083333333333335, 0.9041666666666667, 0.9874999999999999, 0.6125000000000003, 0.2791666666666667, 0.3625, 0.5291666666666666, 0.15416666666666667]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8845, 'compress@10': 0.9092, 'time@10': 7.5861}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8845, 'compress@10': 0.9092, 'time@10': 7.5861}:  10%|█         | 1/10 [00:03<00:34,  3.83s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9191, 'compress@10': 0.6058, 'time@10': 7.2791}:  10%|█         | 1/10 [00:10<00:34,  3.83s/it] {'epoch': 23, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9191, 'compress@10': 0.6058, 'time@10': 7.2791}:  20%|██        | 2/10 [00:10<00:45,  5.70s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.8984, 'compress@10': 0.4717, 'time@10': 6.6974}:  20%|██        | 2/10 [00:13<00:45,  5.70s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.8984, 'compress@10': 0.4717, 'time@10': 6.6974}:  30%|███       | 3/10 [00:13<00:30,  4.38s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9106, 'compress@10': 0.5807, 'time@10': 6.4625}:  30%|███       | 3/10 [00:19<00:30,  4.38s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9106, 'compress@10': 0.5807, 'time@10': 6.4625}:  40%|████      | 4/10 [00:19<00:29,  4.94s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0189, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.9021, 'compress@10': 0.6621, 'time@10': 7.635}:  40%|████      | 4/10 [00:25<00:29,  4.94s/it] {'epoch': 23, 'num_users': 5.8, 'loss': 0.0189, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.9021, 'compress@10': 0.6621, 'time@10': 7.635}:  50%|█████     | 5/10 [00:25<00:26,  5.39s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9113, 'compress@10': 0.6553, 'time@10': 8.0337}:  50%|█████     | 5/10 [00:35<00:26,  5.39s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0179, 'hit_ratio@10': 0.8603, 'ndcg@10': 0.9113, 'compress@10': 0.6553, 'time@10': 8.0337}:  60%|██████    | 6/10 [00:35<00:27,  6.98s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9152, 'compress@10': 0.6057, 'time@10': 8.4417}:  60%|██████    | 6/10 [00:41<00:27,  6.98s/it] {'epoch': 23, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9152, 'compress@10': 0.6057, 'time@10': 8.4417}:  70%|███████   | 7/10 [00:41<00:19,  6.49s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9136, 'compress@10': 0.5775, 'time@10': 8.3765}:  70%|███████   | 7/10 [00:49<00:19,  6.49s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9136, 'compress@10': 0.5775, 'time@10': 8.3765}:  80%|████████  | 8/10 [00:49<00:13,  6.96s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9188, 'compress@10': 0.5737, 'time@10': 9.0509}:  80%|████████  | 8/10 [00:56<00:13,  6.96s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8643, 'ndcg@10': 0.9188, 'compress@10': 0.5737, 'time@10': 9.0509}:  90%|█████████ | 9/10 [00:56<00:07,  7.05s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9195, 'compress@10': 0.5336, 'time@10': 9.1219}:  90%|█████████ | 9/10 [01:06<00:07,  7.05s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9195, 'compress@10': 0.5336, 'time@10': 9.1219}: 100%|██████████| 10/10 [01:06<00:00,  7.90s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0196, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.9195, 'compress@10': 0.5336, 'time@10': 9.1219}: 100%|██████████| 10/10 [01:06<00:00,  6.62s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.0195656408717228
Avg hit ratio: 0.8733321965715855
Avg ndcg: 0.9195160294019104
Avg compression ratio: 0.5336342226567157
Avg train time: 9.12185332775116
Std train time: 2.74898676167566
[0.908, 0.26799999999999996, 0.068, 0.908, 0.988, 0.5880000000000003, 0.268, 0.388, 0.5079999999999999, 0.188]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8863, 'compress@10': 0.9128, 'time@10': 7.6037}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0263, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8863, 'compress@10': 0.9128, 'time@10': 7.6037}:  10%|█         | 1/10 [00:03<00:34,  3.84s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9198, 'compress@10': 0.6022, 'time@10': 7.2914}:  10%|█         | 1/10 [00:10<00:34,  3.84s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9198, 'compress@10': 0.6022, 'time@10': 7.2914}:  20%|██        | 2/10 [00:10<00:45,  5.71s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8989, 'compress@10': 0.4685, 'time@10': 6.6921}:  20%|██        | 2/10 [00:13<00:45,  5.71s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8989, 'compress@10': 0.4685, 'time@10': 6.6921}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9117, 'compress@10': 0.5792, 'time@10': 6.4484}:  30%|███       | 3/10 [00:19<00:30,  4.37s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9117, 'compress@10': 0.5792, 'time@10': 6.4484}:  40%|████      | 4/10 [00:19<00:29,  4.92s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.904, 'compress@10': 0.661, 'time@10': 7.6215}:  40%|████      | 4/10 [00:25<00:29,  4.92s/it]  {'epoch': 24, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.904, 'compress@10': 0.661, 'time@10': 7.6215}:  50%|█████     | 5/10 [00:25<00:26,  5.38s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.913, 'compress@10': 0.6504, 'time@10': 8.0411}:  50%|█████     | 5/10 [00:35<00:26,  5.38s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0176, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.913, 'compress@10': 0.6504, 'time@10': 8.0411}:  60%|██████    | 6/10 [00:35<00:28,  7.01s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9126, 'compress@10': 0.5999, 'time@10': 8.4593}:  60%|██████    | 6/10 [00:41<00:28,  7.01s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9126, 'compress@10': 0.5999, 'time@10': 8.4593}:  70%|███████   | 7/10 [00:41<00:19,  6.52s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0186, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9141, 'compress@10': 0.5756, 'time@10': 8.3609}:  70%|███████   | 7/10 [00:48<00:19,  6.52s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0186, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9141, 'compress@10': 0.5756, 'time@10': 8.3609}:  80%|████████  | 8/10 [00:48<00:13,  6.90s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9194, 'compress@10': 0.5697, 'time@10': 9.0179}:  80%|████████  | 8/10 [00:56<00:13,  6.90s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9194, 'compress@10': 0.5697, 'time@10': 9.0179}:  90%|█████████ | 9/10 [00:56<00:06,  6.99s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9249, 'compress@10': 0.5334, 'time@10': 9.0712}:  90%|█████████ | 9/10 [01:05<00:06,  6.99s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9249, 'compress@10': 0.5334, 'time@10': 9.0712}: 100%|██████████| 10/10 [01:05<00:00,  7.79s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9249, 'compress@10': 0.5334, 'time@10': 9.0712}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.0163205553591293
Avg hit ratio: 0.8981958096610049
Avg ndcg: 0.9249400580787119
Avg compression ratio: 0.5333525672711549
Avg train time: 9.07120521068573
Std train time: 2.7404043235415974
[0.9115384615384615, 0.25769230769230766, 0.06538461538461539, 0.9115384615384615, 0.9884615384615385, 0.5653846153846157, 0.29615384615384616, 0.4115384615384616, 0.48846153846153834, 0.18076923076923077]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8957, 'compress@10': 0.9162, 'time@10': 7.4966}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.024, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8957, 'compress@10': 0.9162, 'time@10': 7.4966}:  10%|█         | 1/10 [00:03<00:34,  3.78s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9297, 'compress@10': 0.5989, 'time@10': 7.1706}:  10%|█         | 1/10 [00:10<00:34,  3.78s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9297, 'compress@10': 0.5989, 'time@10': 7.1706}:  20%|██        | 2/10 [00:10<00:44,  5.61s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9055, 'compress@10': 0.4656, 'time@10': 6.5859}:  20%|██        | 2/10 [00:13<00:44,  5.61s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9055, 'compress@10': 0.4656, 'time@10': 6.5859}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.917, 'compress@10': 0.5779, 'time@10': 6.3476}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.917, 'compress@10': 0.5779, 'time@10': 6.3476}:  40%|████      | 4/10 [00:19<00:29,  4.85s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9103, 'compress@10': 0.66, 'time@10': 7.5969}:  40%|████      | 4/10 [00:25<00:29,  4.85s/it] {'epoch': 25, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9103, 'compress@10': 0.66, 'time@10': 7.5969}:  50%|█████     | 5/10 [00:25<00:26,  5.39s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9229, 'compress@10': 0.6459, 'time@10': 8.0407}:  50%|█████     | 5/10 [00:35<00:26,  5.39s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9229, 'compress@10': 0.6459, 'time@10': 8.0407}:  60%|██████    | 6/10 [00:35<00:28,  7.06s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9231, 'compress@10': 0.5999, 'time@10': 8.5033}:  60%|██████    | 6/10 [00:41<00:28,  7.06s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0185, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9231, 'compress@10': 0.5999, 'time@10': 8.5033}:  70%|███████   | 7/10 [00:41<00:19,  6.61s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9271, 'compress@10': 0.5785, 'time@10': 8.3881}:  70%|███████   | 7/10 [00:49<00:19,  6.61s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9271, 'compress@10': 0.5785, 'time@10': 8.3881}:  80%|████████  | 8/10 [00:49<00:13,  6.93s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9323, 'compress@10': 0.5701, 'time@10': 9.0205}:  80%|████████  | 8/10 [00:56<00:13,  6.93s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9323, 'compress@10': 0.5701, 'time@10': 9.0205}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9331, 'compress@10': 0.533, 'time@10': 9.0783}:  90%|█████████ | 9/10 [01:05<00:06,  6.98s/it]    {'epoch': 25, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9331, 'compress@10': 0.533, 'time@10': 9.0783}: 100%|██████████| 10/10 [01:05<00:00,  7.80s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0194, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9331, 'compress@10': 0.533, 'time@10': 9.0783}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.019379591689821538
Avg hit ratio: 0.8839100953752906
Avg ndcg: 0.9330772364469881
Avg compression ratio: 0.5330262854814715
Avg train time: 9.078254055976867
Std train time: 2.8089295173479405
[0.9148148148148147, 0.24814814814814812, 0.06296296296296297, 0.8777777777777778, 0.9888888888888889, 0.5814814814814818, 0.2851851851851852, 0.3962962962962963, 0.5074074074074073, 0.2111111111111111]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9018, 'compress@10': 0.9193, 'time@10': 7.5529}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9018, 'compress@10': 0.9193, 'time@10': 7.5529}:  10%|█         | 1/10 [00:03<00:34,  3.81s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9335, 'compress@10': 0.5958, 'time@10': 7.1786}:  10%|█         | 1/10 [00:10<00:34,  3.81s/it] {'epoch': 26, 'num_users': 7.0, 'loss': 0.017, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9335, 'compress@10': 0.5958, 'time@10': 7.1786}:  20%|██        | 2/10 [00:10<00:44,  5.59s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.908, 'compress@10': 0.4628, 'time@10': 6.5925}:  20%|██        | 2/10 [00:13<00:44,  5.59s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.908, 'compress@10': 0.4628, 'time@10': 6.5925}:  30%|███       | 3/10 [00:13<00:30,  4.29s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9188, 'compress@10': 0.5677, 'time@10': 6.3772}:  30%|███       | 3/10 [00:19<00:30,  4.29s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0132, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9188, 'compress@10': 0.5677, 'time@10': 6.3772}:  40%|████      | 4/10 [00:19<00:29,  4.88s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9119, 'compress@10': 0.6519, 'time@10': 7.5871}:  40%|████      | 4/10 [00:25<00:29,  4.88s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0154, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9119, 'compress@10': 0.6519, 'time@10': 7.5871}:  50%|█████     | 5/10 [00:25<00:26,  5.37s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9212, 'compress@10': 0.6418, 'time@10': 8.0157}:  50%|█████     | 5/10 [00:35<00:26,  5.37s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8656, 'ndcg@10': 0.9212, 'compress@10': 0.6418, 'time@10': 8.0157}:  60%|██████    | 6/10 [00:35<00:28,  7.01s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9238, 'compress@10': 0.5949, 'time@10': 8.4221}:  60%|██████    | 6/10 [00:41<00:28,  7.01s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9238, 'compress@10': 0.5949, 'time@10': 8.4221}:  70%|███████   | 7/10 [00:41<00:19,  6.51s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9264, 'compress@10': 0.5722, 'time@10': 8.3435}:  70%|███████   | 7/10 [00:48<00:19,  6.51s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9264, 'compress@10': 0.5722, 'time@10': 8.3435}:  80%|████████  | 8/10 [00:48<00:13,  6.93s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9487, 'compress@10': 0.5666, 'time@10': 8.9911}:  80%|████████  | 8/10 [00:56<00:13,  6.93s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8742, 'ndcg@10': 0.9487, 'compress@10': 0.5666, 'time@10': 8.9911}:  90%|█████████ | 9/10 [00:56<00:06,  6.99s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9507, 'compress@10': 0.5328, 'time@10': 9.0337}:  90%|█████████ | 9/10 [01:05<00:06,  6.99s/it]    {'epoch': 26, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9507, 'compress@10': 0.5328, 'time@10': 9.0337}: 100%|██████████| 10/10 [01:05<00:00,  7.75s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8845, 'ndcg@10': 0.9507, 'compress@10': 0.5328, 'time@10': 9.0337}: 100%|██████████| 10/10 [01:05<00:00,  6.55s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.017045702059526747
Avg hit ratio: 0.8845450160102113
Avg ndcg: 0.9506535233991444
Avg compression ratio: 0.5328365657278953
Avg train time: 9.03368968963623
Std train time: 2.744531045168617
[0.9178571428571428, 0.23928571428571427, 0.06071428571428572, 0.8821428571428571, 0.9892857142857143, 0.560714285714286, 0.275, 0.41785714285714287, 0.5249999999999999, 0.20357142857142857]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9018, 'compress@10': 0.9222, 'time@10': 7.5586}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9018, 'compress@10': 0.9222, 'time@10': 7.5586}:  10%|█         | 1/10 [00:03<00:34,  3.82s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9343, 'compress@10': 0.593, 'time@10': 7.1763}:  10%|█         | 1/10 [00:10<00:34,  3.82s/it]  {'epoch': 27, 'num_users': 7.0, 'loss': 0.016, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9343, 'compress@10': 0.593, 'time@10': 7.1763}:  20%|██        | 2/10 [00:10<00:44,  5.59s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9086, 'compress@10': 0.4603, 'time@10': 6.6}:  20%|██        | 2/10 [00:13<00:44,  5.59s/it] {'epoch': 27, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9086, 'compress@10': 0.4603, 'time@10': 6.6}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9192, 'compress@10': 0.5668, 'time@10': 6.3733}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9192, 'compress@10': 0.5668, 'time@10': 6.3733}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9125, 'compress@10': 0.6513, 'time@10': 7.5973}:  40%|████      | 4/10 [00:25<00:29,  4.86s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8477, 'ndcg@10': 0.9125, 'compress@10': 0.6513, 'time@10': 7.5973}:  50%|█████     | 5/10 [00:25<00:26,  5.37s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9218, 'compress@10': 0.6379, 'time@10': 8.0479}:  50%|█████     | 5/10 [00:35<00:26,  5.37s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.8694, 'ndcg@10': 0.9218, 'compress@10': 0.6379, 'time@10': 8.0479}:  60%|██████    | 6/10 [00:35<00:28,  7.06s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9224, 'compress@10': 0.5902, 'time@10': 8.4726}:  60%|██████    | 6/10 [00:41<00:28,  7.06s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0155, 'hit_ratio@10': 0.8823, 'ndcg@10': 0.9224, 'compress@10': 0.5902, 'time@10': 8.4726}:  70%|███████   | 7/10 [00:41<00:19,  6.57s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9258, 'compress@10': 0.5707, 'time@10': 8.4114}:  70%|███████   | 7/10 [00:49<00:19,  6.57s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9258, 'compress@10': 0.5707, 'time@10': 8.4114}:  80%|████████  | 8/10 [00:49<00:14,  7.03s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0194, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9175, 'compress@10': 0.5671, 'time@10': 9.0864}:  80%|████████  | 8/10 [00:56<00:14,  7.03s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0194, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.9175, 'compress@10': 0.5671, 'time@10': 9.0864}:  90%|█████████ | 9/10 [00:56<00:07,  7.11s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9217, 'compress@10': 0.5326, 'time@10': 9.1233}:  90%|█████████ | 9/10 [01:06<00:07,  7.11s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9217, 'compress@10': 0.5326, 'time@10': 9.1233}: 100%|██████████| 10/10 [01:06<00:00,  7.84s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0204, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9217, 'compress@10': 0.5326, 'time@10': 9.1233}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.020429190505457877
Avg hit ratio: 0.8839100953752906
Avg ndcg: 0.9217206947440516
Avg compression ratio: 0.5325926839271722
Avg train time: 9.123251914978027
Std train time: 2.8225176402754197
[0.9206896551724137, 0.23103448275862068, 0.05862068965517242, 0.8517241379310344, 0.9896551724137932, 0.5413793103448279, 0.30000000000000004, 0.403448275862069, 0.5413793103448274, 0.23103448275862068]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9024, 'compress@10': 0.9248, 'time@10': 7.4768}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9024, 'compress@10': 0.9248, 'time@10': 7.4768}:  10%|█         | 1/10 [00:03<00:33,  3.77s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9301, 'compress@10': 0.5903, 'time@10': 7.1167}:  10%|█         | 1/10 [00:10<00:33,  3.77s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0166, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9301, 'compress@10': 0.5903, 'time@10': 7.1167}:  20%|██        | 2/10 [00:10<00:44,  5.55s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9058, 'compress@10': 0.4579, 'time@10': 6.5957}:  20%|██        | 2/10 [00:13<00:44,  5.55s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9058, 'compress@10': 0.4579, 'time@10': 6.5957}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9171, 'compress@10': 0.5577, 'time@10': 6.3499}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9171, 'compress@10': 0.5577, 'time@10': 6.3499}:  40%|████      | 4/10 [00:19<00:28,  4.83s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9123, 'compress@10': 0.6441, 'time@10': 7.524}:  40%|████      | 4/10 [00:25<00:28,  4.83s/it] {'epoch': 28, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9123, 'compress@10': 0.6441, 'time@10': 7.524}:  50%|█████     | 5/10 [00:25<00:26,  5.31s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0174, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.929, 'compress@10': 0.6287, 'time@10': 7.9786}:  50%|█████     | 5/10 [00:35<00:26,  5.31s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0174, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.929, 'compress@10': 0.6287, 'time@10': 7.9786}:  60%|██████    | 6/10 [00:35<00:28,  7.00s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9312, 'compress@10': 0.5857, 'time@10': 8.3799}:  60%|██████    | 6/10 [00:40<00:28,  7.00s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0166, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9312, 'compress@10': 0.5857, 'time@10': 8.3799}:  70%|███████   | 7/10 [00:40<00:19,  6.49s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9322, 'compress@10': 0.5651, 'time@10': 8.3243}:  70%|███████   | 7/10 [00:48<00:19,  6.49s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0164, 'hit_ratio@10': 0.9113, 'ndcg@10': 0.9322, 'compress@10': 0.5651, 'time@10': 8.3243}:  80%|████████  | 8/10 [00:48<00:13,  6.96s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9348, 'compress@10': 0.5639, 'time@10': 8.9927}:  80%|████████  | 8/10 [00:56<00:13,  6.96s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9348, 'compress@10': 0.5639, 'time@10': 8.9927}:  90%|█████████ | 9/10 [00:56<00:07,  7.04s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9381, 'compress@10': 0.5324, 'time@10': 9.0517}:  90%|█████████ | 9/10 [01:05<00:07,  7.04s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9381, 'compress@10': 0.5324, 'time@10': 9.0517}: 100%|██████████| 10/10 [01:05<00:00,  7.83s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9381, 'compress@10': 0.5324, 'time@10': 9.0517}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01548737508487875
Avg hit ratio: 0.8981958096610049
Avg ndcg: 0.938138346699047
Avg compression ratio: 0.5323717539115969
Avg train time: 9.051698422431945
Std train time: 2.753149040646328
[0.9233333333333333, 0.22333333333333333, 0.05666666666666667, 0.8566666666666666, 0.9900000000000001, 0.556666666666667, 0.29000000000000004, 0.42333333333333334, 0.5233333333333332, 0.22333333333333333]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9084, 'compress@10': 0.9274, 'time@10': 7.7329}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0196, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9084, 'compress@10': 0.9274, 'time@10': 7.7329}:  10%|█         | 1/10 [00:03<00:35,  3.90s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9459, 'compress@10': 0.5879, 'time@10': 7.3562}:  10%|█         | 1/10 [00:10<00:35,  3.90s/it] {'epoch': 29, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9459, 'compress@10': 0.5879, 'time@10': 7.3562}:  20%|██        | 2/10 [00:10<00:45,  5.74s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9163, 'compress@10': 0.4557, 'time@10': 6.7007}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0116, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9163, 'compress@10': 0.4557, 'time@10': 6.7007}:  30%|███       | 3/10 [00:13<00:30,  4.36s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9264, 'compress@10': 0.5572, 'time@10': 6.4251}:  30%|███       | 3/10 [00:19<00:30,  4.36s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9264, 'compress@10': 0.5572, 'time@10': 6.4251}:  40%|████      | 4/10 [00:19<00:29,  4.87s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9211, 'compress@10': 0.6438, 'time@10': 7.5837}:  40%|████      | 4/10 [00:25<00:29,  4.87s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0143, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9211, 'compress@10': 0.6438, 'time@10': 7.5837}:  50%|█████     | 5/10 [00:25<00:26,  5.33s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9298, 'compress@10': 0.6309, 'time@10': 8.046}:  50%|█████     | 5/10 [00:35<00:26,  5.33s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.013, 'hit_ratio@10': 0.8636, 'ndcg@10': 0.9298, 'compress@10': 0.6309, 'time@10': 8.046}:  60%|██████    | 6/10 [00:35<00:28,  7.05s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9319, 'compress@10': 0.5863, 'time@10': 8.4561}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.9319, 'compress@10': 0.5863, 'time@10': 8.4561}:  70%|███████   | 7/10 [00:41<00:19,  6.54s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9346, 'compress@10': 0.568, 'time@10': 8.3735}:  70%|███████   | 7/10 [00:49<00:19,  6.54s/it]  {'epoch': 29, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.9346, 'compress@10': 0.568, 'time@10': 8.3735}:  80%|████████  | 8/10 [00:49<00:13,  6.95s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9472, 'compress@10': 0.5645, 'time@10': 9.0059}:  80%|████████  | 8/10 [00:56<00:13,  6.95s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8761, 'ndcg@10': 0.9472, 'compress@10': 0.5645, 'time@10': 9.0059}:  90%|█████████ | 9/10 [00:56<00:06,  6.99s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.953, 'compress@10': 0.5322, 'time@10': 9.0664}:  90%|█████████ | 9/10 [01:05<00:06,  6.99s/it]    {'epoch': 29, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.953, 'compress@10': 0.5322, 'time@10': 9.0664}: 100%|██████████| 10/10 [01:05<00:00,  7.81s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.8862, 'ndcg@10': 0.953, 'compress@10': 0.5322, 'time@10': 9.0664}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.0160561617875151
Avg hit ratio: 0.8861763524157412
Avg ndcg: 0.952953180417403
Avg compression ratio: 0.5321806503849045
Avg train time: 9.066433882713318
Std train time: 2.7130331682731477
[0.9258064516129032, 0.2161290322580645, 0.054838709677419356, 0.8612903225806451, 0.9903225806451614, 0.5387096774193552, 0.28064516129032263, 0.4096774193548387, 0.5387096774193547, 0.24838709677419354]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.9297, 'time@10': 7.5283}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.9297, 'time@10': 7.5283}:  10%|█         | 1/10 [00:03<00:34,  3.81s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9412, 'compress@10': 0.5856, 'time@10': 7.1867}:  10%|█         | 1/10 [00:10<00:34,  3.81s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9412, 'compress@10': 0.5856, 'time@10': 7.1867}:  20%|██        | 2/10 [00:10<00:44,  5.62s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9132, 'compress@10': 0.4537, 'time@10': 6.5937}:  20%|██        | 2/10 [00:13<00:44,  5.62s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0084, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9132, 'compress@10': 0.4537, 'time@10': 6.5937}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9245, 'compress@10': 0.5568, 'time@10': 6.3939}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9245, 'compress@10': 0.5568, 'time@10': 6.3939}:  40%|████      | 4/10 [00:19<00:29,  4.91s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9214, 'compress@10': 0.6435, 'time@10': 7.6051}:  40%|████      | 4/10 [00:25<00:29,  4.91s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0121, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9214, 'compress@10': 0.6435, 'time@10': 7.6051}:  50%|█████     | 5/10 [00:25<00:26,  5.40s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.93, 'compress@10': 0.6278, 'time@10': 8.0265}:  50%|█████     | 5/10 [00:35<00:26,  5.40s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.93, 'compress@10': 0.6278, 'time@10': 8.0265}:  60%|██████    | 6/10 [00:35<00:28,  7.02s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9282, 'compress@10': 0.5823, 'time@10': 8.4318}:  60%|██████    | 6/10 [00:41<00:28,  7.02s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9282, 'compress@10': 0.5823, 'time@10': 8.4318}:  70%|███████   | 7/10 [00:41<00:19,  6.51s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9323, 'compress@10': 0.5628, 'time@10': 8.334}:  70%|███████   | 7/10 [00:48<00:19,  6.51s/it]  {'epoch': 30, 'num_users': 6.125, 'loss': 0.0127, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9323, 'compress@10': 0.5628, 'time@10': 8.334}:  80%|████████  | 8/10 [00:48<00:13,  6.89s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9307, 'compress@10': 0.5616, 'time@10': 9.0053}:  80%|████████  | 8/10 [00:56<00:13,  6.89s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0151, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.9307, 'compress@10': 0.5616, 'time@10': 9.0053}:  90%|█████████ | 9/10 [00:56<00:06,  6.99s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9332, 'compress@10': 0.532, 'time@10': 9.0749}:  90%|█████████ | 9/10 [01:05<00:06,  6.99s/it]    {'epoch': 30, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9332, 'compress@10': 0.532, 'time@10': 9.0749}: 100%|██████████| 10/10 [01:05<00:00,  7.84s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9332, 'compress@10': 0.532, 'time@10': 9.0749}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.016300241892522476
Avg hit ratio: 0.8826842889236778
Avg ndcg: 0.9331759572429137
Avg compression ratio: 0.5320001251833555
Avg train time: 9.074894261360168
Std train time: 2.7894560692199444
[0.928125, 0.209375, 0.053125, 0.834375, 0.9906250000000001, 0.5218750000000003, 0.30312500000000003, 0.396875, 0.5531249999999999, 0.271875]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.9319, 'time@10': 7.5106}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.9319, 'time@10': 7.5106}:  10%|█         | 1/10 [00:03<00:34,  3.79s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9395, 'compress@10': 0.5834, 'time@10': 7.0962}:  10%|█         | 1/10 [00:10<00:34,  3.79s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9395, 'compress@10': 0.5834, 'time@10': 7.0962}:  20%|██        | 2/10 [00:10<00:44,  5.51s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.912, 'compress@10': 0.4517, 'time@10': 6.5822}:  20%|██        | 2/10 [00:13<00:44,  5.51s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.912, 'compress@10': 0.4517, 'time@10': 6.5822}:  30%|███       | 3/10 [00:13<00:29,  4.28s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9218, 'compress@10': 0.5489, 'time@10': 6.3634}:  30%|███       | 3/10 [00:19<00:29,  4.28s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0111, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9218, 'compress@10': 0.5489, 'time@10': 6.3634}:  40%|████      | 4/10 [00:19<00:29,  4.86s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9197, 'compress@10': 0.6372, 'time@10': 7.5433}:  40%|████      | 4/10 [00:25<00:29,  4.86s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0125, 'hit_ratio@10': 0.8517, 'ndcg@10': 0.9197, 'compress@10': 0.6372, 'time@10': 7.5433}:  50%|█████     | 5/10 [00:25<00:26,  5.33s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.93, 'compress@10': 0.6198, 'time@10': 7.9552}:  50%|█████     | 5/10 [00:35<00:26,  5.33s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8727, 'ndcg@10': 0.93, 'compress@10': 0.6198, 'time@10': 7.9552}:  60%|██████    | 6/10 [00:35<00:27,  6.94s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.933, 'compress@10': 0.5785, 'time@10': 8.3831}:  60%|██████    | 6/10 [00:40<00:27,  6.94s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.933, 'compress@10': 0.5785, 'time@10': 8.3831}:  70%|███████   | 7/10 [00:40<00:19,  6.47s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.932, 'compress@10': 0.558, 'time@10': 8.2947}:  70%|███████   | 7/10 [00:48<00:19,  6.47s/it]  {'epoch': 31, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.932, 'compress@10': 0.558, 'time@10': 8.2947}:  80%|████████  | 8/10 [00:48<00:13,  6.87s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9405, 'compress@10': 0.5589, 'time@10': 8.9491}:  80%|████████  | 8/10 [00:55<00:13,  6.87s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9405, 'compress@10': 0.5589, 'time@10': 8.9491}:  90%|█████████ | 9/10 [00:55<00:06,  6.95s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9441, 'compress@10': 0.5318, 'time@10': 9.0327}:  90%|█████████ | 9/10 [01:05<00:06,  6.95s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9441, 'compress@10': 0.5318, 'time@10': 9.0327}: 100%|██████████| 10/10 [01:05<00:00,  7.83s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0144, 'hit_ratio@10': 0.8888, 'ndcg@10': 0.9441, 'compress@10': 0.5318, 'time@10': 9.0327}: 100%|██████████| 10/10 [01:05<00:00,  6.55s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.014400316587554673
Avg hit ratio: 0.8887672382324334
Avg ndcg: 0.9440640506238569
Avg compression ratio: 0.5318166277533594
Avg train time: 9.032650828361511
Std train time: 2.73912130883219
[0.9, 0.20303030303030303, 0.051515151515151514, 0.8393939393939394, 0.990909090909091, 0.5363636363636367, 0.29393939393939394, 0.4151515151515151, 0.5666666666666665, 0.2636363636363636]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.9052, 'time@10': 7.5986}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9147, 'compress@10': 0.9052, 'time@10': 7.5986}:  10%|█         | 1/10 [00:03<00:34,  3.84s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9512, 'compress@10': 0.567, 'time@10': 7.2111}:  10%|█         | 1/10 [00:10<00:34,  3.84s/it]  {'epoch': 32, 'num_users': 7.0, 'loss': 0.0158, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9512, 'compress@10': 0.567, 'time@10': 7.2111}:  20%|██        | 2/10 [00:10<00:44,  5.61s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9199, 'compress@10': 0.4403, 'time@10': 6.6823}:  20%|██        | 2/10 [00:13<00:44,  5.61s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9199, 'compress@10': 0.4403, 'time@10': 6.6823}:  30%|███       | 3/10 [00:13<00:30,  4.36s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9301, 'compress@10': 0.5415, 'time@10': 6.4018}:  30%|███       | 3/10 [00:19<00:30,  4.36s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9301, 'compress@10': 0.5415, 'time@10': 6.4018}:  40%|████      | 4/10 [00:19<00:29,  4.85s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9277, 'compress@10': 0.6314, 'time@10': 7.5928}:  40%|████      | 4/10 [00:25<00:29,  4.85s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8452, 'ndcg@10': 0.9277, 'compress@10': 0.6314, 'time@10': 7.5928}:  50%|█████     | 5/10 [00:25<00:26,  5.34s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9356, 'compress@10': 0.6173, 'time@10': 8.0258}:  50%|█████     | 5/10 [00:35<00:26,  5.34s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.9356, 'compress@10': 0.6173, 'time@10': 8.0258}:  60%|██████    | 6/10 [00:35<00:28,  7.00s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9378, 'compress@10': 0.5752, 'time@10': 8.4154}:  60%|██████    | 6/10 [00:41<00:28,  7.00s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9378, 'compress@10': 0.5752, 'time@10': 8.4154}:  70%|███████   | 7/10 [00:41<00:19,  6.48s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.936, 'compress@10': 0.5572, 'time@10': 8.3505}:  70%|███████   | 7/10 [00:48<00:19,  6.48s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.936, 'compress@10': 0.5572, 'time@10': 8.3505}:  80%|████████  | 8/10 [00:48<00:13,  6.94s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.933, 'compress@10': 0.5597, 'time@10': 8.9999}:  80%|████████  | 8/10 [00:56<00:13,  6.94s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8722, 'ndcg@10': 0.933, 'compress@10': 0.5597, 'time@10': 8.9999}:  90%|█████████ | 9/10 [00:56<00:07,  7.00s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9354, 'compress@10': 0.5317, 'time@10': 9.0704}:  90%|█████████ | 9/10 [01:05<00:07,  7.00s/it]  {'epoch': 32, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9354, 'compress@10': 0.5317, 'time@10': 9.0704}: 100%|██████████| 10/10 [01:05<00:00,  7.85s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8827, 'ndcg@10': 0.9354, 'compress@10': 0.5317, 'time@10': 9.0704}: 100%|██████████| 10/10 [01:05<00:00,  6.58s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.015069945253824846
Avg hit ratio: 0.8826842889236778
Avg ndcg: 0.9353765106113017
Avg compression ratio: 0.5317330357888524
Avg train time: 9.070373487472533
Std train time: 2.7264844093768312
[0.9029411764705882, 0.19705882352941176, 0.049999999999999996, 0.8441176470588235, 0.9911764705882353, 0.520588235294118, 0.2852941176470588, 0.4029411764705882, 0.5794117647058822, 0.2852941176470588]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.908, 'time@10': 7.4704}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0154, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9196, 'compress@10': 0.908, 'time@10': 7.4704}:  10%|█         | 1/10 [00:03<00:34,  3.79s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9425, 'compress@10': 0.5655, 'time@10': 7.2109}:  10%|█         | 1/10 [00:10<00:34,  3.79s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0146, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9425, 'compress@10': 0.5655, 'time@10': 7.2109}:  20%|██        | 2/10 [00:10<00:45,  5.67s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9141, 'compress@10': 0.4389, 'time@10': 6.6279}:  20%|██        | 2/10 [00:13<00:45,  5.67s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9141, 'compress@10': 0.4389, 'time@10': 6.6279}:  30%|███       | 3/10 [00:13<00:30,  4.34s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9257, 'compress@10': 0.5416, 'time@10': 6.3887}:  30%|███       | 3/10 [00:19<00:30,  4.34s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9257, 'compress@10': 0.5416, 'time@10': 6.3887}:  40%|████      | 4/10 [00:19<00:29,  4.89s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9252, 'compress@10': 0.6315, 'time@10': 7.5637}:  40%|████      | 4/10 [00:25<00:29,  4.89s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0122, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9252, 'compress@10': 0.6315, 'time@10': 7.5637}:  50%|█████     | 5/10 [00:25<00:26,  5.35s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9336, 'compress@10': 0.6148, 'time@10': 8.0387}:  50%|█████     | 5/10 [00:35<00:26,  5.35s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.011, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9336, 'compress@10': 0.6148, 'time@10': 8.0387}:  60%|██████    | 6/10 [00:35<00:28,  7.08s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9351, 'compress@10': 0.5718, 'time@10': 8.416}:  60%|██████    | 6/10 [00:41<00:28,  7.08s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9351, 'compress@10': 0.5718, 'time@10': 8.416}:  70%|███████   | 7/10 [00:41<00:19,  6.52s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9387, 'compress@10': 0.5529, 'time@10': 8.3256}:  70%|███████   | 7/10 [00:48<00:19,  6.52s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9387, 'compress@10': 0.5529, 'time@10': 8.3256}:  80%|████████  | 8/10 [00:48<00:13,  6.91s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9435, 'compress@10': 0.5571, 'time@10': 8.9532}:  80%|████████  | 8/10 [00:56<00:13,  6.91s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9435, 'compress@10': 0.5571, 'time@10': 8.9532}:  90%|█████████ | 9/10 [00:56<00:06,  6.94s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9459, 'compress@10': 0.5316, 'time@10': 9.0458}:  90%|█████████ | 9/10 [01:05<00:06,  6.94s/it]  {'epoch': 33, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9459, 'compress@10': 0.5316, 'time@10': 9.0458}: 100%|██████████| 10/10 [01:05<00:00,  7.86s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0123, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9459, 'compress@10': 0.5316, 'time@10': 9.0458}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.012311338090571926
Avg hit ratio: 0.9028307302959255
Avg ndcg: 0.9459374381365754
Avg compression ratio: 0.5315813290245185
Avg train time: 9.045780611038207
Std train time: 2.698315697993061
[0.9057142857142857, 0.19142857142857142, 0.04857142857142857, 0.8485714285714285, 0.9914285714285714, 0.5057142857142861, 0.3057142857142857, 0.3914285714285714, 0.5914285714285713, 0.27714285714285714]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.9107, 'time@10': 7.6868}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0151, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9229, 'compress@10': 0.9107, 'time@10': 7.6868}:  10%|█         | 1/10 [00:03<00:34,  3.88s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 0.5641, 'time@10': 7.1748}:  10%|█         | 1/10 [00:10<00:34,  3.88s/it] {'epoch': 34, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 0.5641, 'time@10': 7.1748}:  20%|██        | 2/10 [00:10<00:44,  5.54s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9159, 'compress@10': 0.4376, 'time@10': 6.649}:  20%|██        | 2/10 [00:13<00:44,  5.54s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9159, 'compress@10': 0.4376, 'time@10': 6.649}:  30%|███       | 3/10 [00:13<00:30,  4.31s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9267, 'compress@10': 0.5417, 'time@10': 6.3762}:  30%|███       | 3/10 [00:19<00:30,  4.31s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9267, 'compress@10': 0.5417, 'time@10': 6.3762}:  40%|████      | 4/10 [00:19<00:28,  4.81s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9263, 'compress@10': 0.6316, 'time@10': 7.4987}:  40%|████      | 4/10 [00:25<00:28,  4.81s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9263, 'compress@10': 0.6316, 'time@10': 7.4987}:  50%|█████     | 5/10 [00:25<00:26,  5.25s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9336, 'compress@10': 0.6125, 'time@10': 7.9863}:  50%|█████     | 5/10 [00:35<00:26,  5.25s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0115, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9336, 'compress@10': 0.6125, 'time@10': 7.9863}:  60%|██████    | 6/10 [00:35<00:28,  7.02s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9356, 'compress@10': 0.5726, 'time@10': 8.4264}:  60%|██████    | 6/10 [00:41<00:28,  7.02s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9356, 'compress@10': 0.5726, 'time@10': 8.4264}:  70%|███████   | 7/10 [00:41<00:19,  6.55s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9371, 'compress@10': 0.5522, 'time@10': 8.3549}:  70%|███████   | 7/10 [00:48<00:19,  6.55s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.9138, 'ndcg@10': 0.9371, 'compress@10': 0.5522, 'time@10': 8.3549}:  80%|████████  | 8/10 [00:48<00:13,  6.98s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9357, 'compress@10': 0.5578, 'time@10': 8.9619}:  80%|████████  | 8/10 [00:55<00:13,  6.98s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.898, 'ndcg@10': 0.9357, 'compress@10': 0.5578, 'time@10': 8.9619}:  90%|█████████ | 9/10 [00:55<00:06,  6.97s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9394, 'compress@10': 0.5314, 'time@10': 9.0301}:  90%|█████████ | 9/10 [01:05<00:06,  6.97s/it]  {'epoch': 34, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9394, 'compress@10': 0.5314, 'time@10': 9.0301}: 100%|██████████| 10/10 [01:05<00:00,  7.80s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.9059, 'ndcg@10': 0.9394, 'compress@10': 0.5314, 'time@10': 9.0301}: 100%|██████████| 10/10 [01:05<00:00,  6.56s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.01555368113425137
Avg hit ratio: 0.9059100953752907
Avg ndcg: 0.9394369385349073
Avg compression ratio: 0.5313899246117203
Avg train time: 9.030078530311584
Std train time: 2.6604732784356457
[0.8805555555555555, 0.18611111111111112, 0.04722222222222222, 0.8527777777777777, 0.9916666666666667, 0.49166666666666703, 0.325, 0.38055555555555554, 0.6027777777777776, 0.2972222222222222]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9127, 'compress@10': 0.8868, 'time@10': 7.5759}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9127, 'compress@10': 0.8868, 'time@10': 7.5759}:  10%|█         | 1/10 [00:03<00:34,  3.82s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9396, 'compress@10': 0.5496, 'time@10': 7.159}:  10%|█         | 1/10 [00:10<00:34,  3.82s/it]  {'epoch': 35, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9396, 'compress@10': 0.5496, 'time@10': 7.159}:  20%|██        | 2/10 [00:10<00:44,  5.56s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9121, 'compress@10': 0.4275, 'time@10': 6.5823}:  20%|██        | 2/10 [00:13<00:44,  5.56s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.005, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9121, 'compress@10': 0.4275, 'time@10': 6.5823}:  30%|███       | 3/10 [00:13<00:29,  4.28s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9225, 'compress@10': 0.5351, 'time@10': 6.3489}:  30%|███       | 3/10 [00:19<00:29,  4.28s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9225, 'compress@10': 0.5351, 'time@10': 6.3489}:  40%|████      | 4/10 [00:19<00:29,  4.84s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9241, 'compress@10': 0.6265, 'time@10': 7.5233}:  40%|████      | 4/10 [00:25<00:29,  4.84s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9241, 'compress@10': 0.6265, 'time@10': 7.5233}:  50%|█████     | 5/10 [00:25<00:26,  5.31s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9342, 'compress@10': 0.6059, 'time@10': 7.9817}:  50%|█████     | 5/10 [00:35<00:26,  5.31s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.012, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9342, 'compress@10': 0.6059, 'time@10': 7.9817}:  60%|██████    | 6/10 [00:35<00:28,  7.01s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9368, 'compress@10': 0.5696, 'time@10': 8.3821}:  60%|██████    | 6/10 [00:40<00:28,  7.01s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9368, 'compress@10': 0.5696, 'time@10': 8.3821}:  70%|███████   | 7/10 [00:40<00:19,  6.49s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9388, 'compress@10': 0.5482, 'time@10': 8.314}:  70%|███████   | 7/10 [00:48<00:19,  6.49s/it]   {'epoch': 35, 'num_users': 6.125, 'loss': 0.012, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9388, 'compress@10': 0.5482, 'time@10': 8.314}:  80%|████████  | 8/10 [00:48<00:13,  6.93s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9416, 'compress@10': 0.5555, 'time@10': 8.9509}:  80%|████████  | 8/10 [00:55<00:13,  6.93s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.903, 'ndcg@10': 0.9416, 'compress@10': 0.5555, 'time@10': 8.9509}:  90%|█████████ | 9/10 [00:55<00:06,  6.97s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0104, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.945, 'compress@10': 0.5313, 'time@10': 9.0249}:  90%|█████████ | 9/10 [01:05<00:06,  6.97s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0104, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.945, 'compress@10': 0.5313, 'time@10': 9.0249}: 100%|██████████| 10/10 [01:05<00:00,  7.82s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0104, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.945, 'compress@10': 0.5313, 'time@10': 9.0249}: 100%|██████████| 10/10 [01:05<00:00,  6.56s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.010443890191797195
Avg hit ratio: 0.9103985746379634
Avg ndcg: 0.9450315589647337
Avg compression ratio: 0.5312907770885292
Avg train time: 9.024855542182923
Std train time: 2.7124208072600338
[0.8837837837837837, 0.1810810810810811, 0.04594594594594594, 0.8567567567567568, 0.991891891891892, 0.5054054054054058, 0.3162162162162162, 0.3972972972972973, 0.5864864864864864, 0.2891891891891892]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8944, 'compress@10': 0.8899, 'time@10': 7.6672}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8944, 'compress@10': 0.8899, 'time@10': 7.6672}:  10%|█         | 1/10 [00:03<00:34,  3.87s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9347, 'compress@10': 0.5487, 'time@10': 7.1977}:  10%|█         | 1/10 [00:10<00:34,  3.87s/it] {'epoch': 36, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9347, 'compress@10': 0.5487, 'time@10': 7.1977}:  20%|██        | 2/10 [00:10<00:44,  5.57s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9088, 'compress@10': 0.4265, 'time@10': 6.5466}:  20%|██        | 2/10 [00:13<00:44,  5.57s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9088, 'compress@10': 0.4265, 'time@10': 6.5466}:  30%|███       | 3/10 [00:13<00:29,  4.24s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9222, 'compress@10': 0.5354, 'time@10': 6.2897}:  30%|███       | 3/10 [00:18<00:29,  4.24s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9222, 'compress@10': 0.5354, 'time@10': 6.2897}:  40%|████      | 4/10 [00:18<00:28,  4.76s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9252, 'compress@10': 0.6267, 'time@10': 7.4568}:  40%|████      | 4/10 [00:24<00:28,  4.76s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0139, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9252, 'compress@10': 0.6267, 'time@10': 7.4568}:  50%|█████     | 5/10 [00:24<00:26,  5.24s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9336, 'compress@10': 0.6083, 'time@10': 7.9102}:  50%|█████     | 5/10 [00:35<00:26,  5.24s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9336, 'compress@10': 0.6083, 'time@10': 7.9102}:  60%|██████    | 6/10 [00:35<00:27,  6.94s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9361, 'compress@10': 0.5705, 'time@10': 8.333}:  60%|██████    | 6/10 [00:40<00:27,  6.94s/it] {'epoch': 36, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9361, 'compress@10': 0.5705, 'time@10': 8.333}:  70%|███████   | 7/10 [00:40<00:19,  6.46s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9397, 'compress@10': 0.551, 'time@10': 8.2569}:  70%|███████   | 7/10 [00:48<00:19,  6.46s/it]  {'epoch': 36, 'num_users': 6.125, 'loss': 0.011, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9397, 'compress@10': 0.551, 'time@10': 8.2569}:  80%|████████  | 8/10 [00:48<00:13,  6.87s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9467, 'compress@10': 0.5563, 'time@10': 8.8998}:  80%|████████  | 8/10 [00:55<00:13,  6.87s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8751, 'ndcg@10': 0.9467, 'compress@10': 0.5563, 'time@10': 8.8998}:  90%|█████████ | 9/10 [00:55<00:06,  6.93s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9476, 'compress@10': 0.5312, 'time@10': 8.9719}:  90%|█████████ | 9/10 [01:05<00:06,  6.93s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9476, 'compress@10': 0.5312, 'time@10': 8.9719}: 100%|██████████| 10/10 [01:05<00:00,  7.78s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.8853, 'ndcg@10': 0.9476, 'compress@10': 0.5312, 'time@10': 8.9719}: 100%|██████████| 10/10 [01:05<00:00,  6.51s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.014159841585843467
Avg hit ratio: 0.8853192095585983
Avg ndcg: 0.9476028983381198
Avg compression ratio: 0.5311640804028919
Avg train time: 8.971878623962402
Std train time: 2.7431579491734785
[0.8868421052631579, 0.20263157894736844, 0.04473684210526315, 0.8605263157894737, 0.9657894736842106, 0.4921052631578951, 0.3078947368421053, 0.3868421052631579, 0.5973684210526314, 0.3078947368421053]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9064, 'compress@10': 0.8928, 'time@10': 7.6241}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9064, 'compress@10': 0.8928, 'time@10': 7.6241}:  10%|█         | 1/10 [00:03<00:34,  3.86s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9353, 'compress@10': 0.5606, 'time@10': 7.1291}:  10%|█         | 1/10 [00:10<00:34,  3.86s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9353, 'compress@10': 0.5606, 'time@10': 7.1291}:  20%|██        | 2/10 [00:10<00:44,  5.51s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9093, 'compress@10': 0.4341, 'time@10': 6.5656}:  20%|██        | 2/10 [00:13<00:44,  5.51s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9093, 'compress@10': 0.4341, 'time@10': 6.5656}:  30%|███       | 3/10 [00:13<00:29,  4.26s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9225, 'compress@10': 0.542, 'time@10': 6.348}:  30%|███       | 3/10 [00:19<00:29,  4.26s/it]  {'epoch': 37, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9225, 'compress@10': 0.542, 'time@10': 6.348}:  40%|████      | 4/10 [00:19<00:29,  4.84s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9251, 'compress@10': 0.6269, 'time@10': 7.4896}:  40%|████      | 4/10 [00:25<00:29,  4.84s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9251, 'compress@10': 0.6269, 'time@10': 7.4896}:  50%|█████     | 5/10 [00:25<00:26,  5.28s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9343, 'compress@10': 0.6063, 'time@10': 7.9353}:  50%|█████     | 5/10 [00:35<00:26,  5.28s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0103, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9343, 'compress@10': 0.6063, 'time@10': 7.9353}:  60%|██████    | 6/10 [00:35<00:27,  6.95s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0109, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9361, 'compress@10': 0.5676, 'time@10': 8.3683}:  60%|██████    | 6/10 [00:40<00:27,  6.95s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0109, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9361, 'compress@10': 0.5676, 'time@10': 8.3683}:  70%|███████   | 7/10 [00:40<00:19,  6.49s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9397, 'compress@10': 0.5472, 'time@10': 8.3082}:  70%|███████   | 7/10 [00:48<00:19,  6.49s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9397, 'compress@10': 0.5472, 'time@10': 8.3082}:  80%|████████  | 8/10 [00:48<00:13,  6.95s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9363, 'compress@10': 0.5541, 'time@10': 8.9323}:  80%|████████  | 8/10 [00:55<00:13,  6.95s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9363, 'compress@10': 0.5541, 'time@10': 8.9323}:  90%|█████████ | 9/10 [00:55<00:06,  6.97s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.94, 'compress@10': 0.531, 'time@10': 9.0083}:  90%|█████████ | 9/10 [01:05<00:06,  6.97s/it]      {'epoch': 37, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.94, 'compress@10': 0.531, 'time@10': 9.0083}: 100%|██████████| 10/10 [01:05<00:00,  7.82s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.94, 'compress@10': 0.531, 'time@10': 9.0083}: 100%|██████████| 10/10 [01:05<00:00,  6.55s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.012513709883090907
Avg hit ratio: 0.8881763524157412
Avg ndcg: 0.9400019376358438
Avg compression ratio: 0.531012111416982
Avg train time: 9.008263206481933
Std train time: 2.67628697093148
[0.8897435897435897, 0.19743589743589746, 0.04358974358974358, 0.8641025641025641, 0.9666666666666668, 0.47948717948717984, 0.32564102564102565, 0.3769230769230769, 0.6076923076923075, 0.3]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9161, 'compress@10': 0.8955, 'time@10': 7.7214}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0135, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9161, 'compress@10': 0.8955, 'time@10': 7.7214}:  10%|█         | 1/10 [00:03<00:35,  3.90s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9419, 'compress@10': 0.5594, 'time@10': 7.2909}:  10%|█         | 1/10 [00:10<00:35,  3.90s/it] {'epoch': 38, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9419, 'compress@10': 0.5594, 'time@10': 7.2909}:  20%|██        | 2/10 [00:10<00:45,  5.66s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9137, 'compress@10': 0.433, 'time@10': 6.6381}:  20%|██        | 2/10 [00:13<00:45,  5.66s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0061, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9137, 'compress@10': 0.433, 'time@10': 6.6381}:  30%|███       | 3/10 [00:13<00:30,  4.31s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9259, 'compress@10': 0.542, 'time@10': 6.4093}:  30%|███       | 3/10 [00:19<00:30,  4.31s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9259, 'compress@10': 0.542, 'time@10': 6.4093}:  40%|████      | 4/10 [00:19<00:29,  4.88s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9284, 'compress@10': 0.6271, 'time@10': 7.5234}:  40%|████      | 4/10 [00:25<00:29,  4.88s/it] {'epoch': 38, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9284, 'compress@10': 0.6271, 'time@10': 7.5234}:  50%|█████     | 5/10 [00:25<00:26,  5.30s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9363, 'compress@10': 0.6044, 'time@10': 7.9537}:  50%|█████     | 5/10 [00:35<00:26,  5.30s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9363, 'compress@10': 0.6044, 'time@10': 7.9537}:  60%|██████    | 6/10 [00:35<00:27,  6.94s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9391, 'compress@10': 0.5684, 'time@10': 8.3765}:  60%|██████    | 6/10 [00:40<00:27,  6.94s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0077, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9391, 'compress@10': 0.5684, 'time@10': 8.3765}:  70%|███████   | 7/10 [00:40<00:19,  6.47s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.008, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9424, 'compress@10': 0.5467, 'time@10': 8.3143}:  70%|███████   | 7/10 [00:48<00:19,  6.47s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.008, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9424, 'compress@10': 0.5467, 'time@10': 8.3143}:  80%|████████  | 8/10 [00:48<00:13,  6.93s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9424, 'compress@10': 0.5547, 'time@10': 8.966}:  80%|████████  | 8/10 [00:55<00:13,  6.93s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9424, 'compress@10': 0.5547, 'time@10': 8.966}:  90%|█████████ | 9/10 [00:55<00:06,  6.99s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.944, 'compress@10': 0.5309, 'time@10': 9.036}:  90%|█████████ | 9/10 [01:05<00:06,  6.99s/it]    {'epoch': 38, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.944, 'compress@10': 0.5309, 'time@10': 9.036}: 100%|██████████| 10/10 [01:05<00:00,  7.83s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0111, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.944, 'compress@10': 0.5309, 'time@10': 9.036}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.011083012650283943
Avg hit ratio: 0.9075414317808205
Avg ndcg: 0.9440199486725849
Avg compression ratio: 0.53085526172583
Avg train time: 9.035996270179748
Std train time: 2.6959593823086228
[0.8925, 0.19250000000000003, 0.04249999999999999, 0.8675, 0.9675000000000001, 0.46750000000000036, 0.3175, 0.3675, 0.6174999999999998, 0.3175]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9305, 'compress@10': 0.8981, 'time@10': 7.5779}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9305, 'compress@10': 0.8981, 'time@10': 7.5779}:  10%|█         | 1/10 [00:03<00:34,  3.82s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9502, 'compress@10': 0.5584, 'time@10': 7.1065}:  10%|█         | 1/10 [00:10<00:34,  3.82s/it] {'epoch': 39, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9502, 'compress@10': 0.5584, 'time@10': 7.1065}:  20%|██        | 2/10 [00:10<00:43,  5.50s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9192, 'compress@10': 0.432, 'time@10': 6.5655}:  20%|██        | 2/10 [00:13<00:43,  5.50s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0055, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9192, 'compress@10': 0.432, 'time@10': 6.5655}:  30%|███       | 3/10 [00:13<00:29,  4.26s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9293, 'compress@10': 0.5421, 'time@10': 6.3515}:  30%|███       | 3/10 [00:19<00:29,  4.26s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9293, 'compress@10': 0.5421, 'time@10': 6.3515}:  40%|████      | 4/10 [00:19<00:29,  4.85s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.009, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9319, 'compress@10': 0.6273, 'time@10': 7.4964}:  40%|████      | 4/10 [00:25<00:29,  4.85s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.009, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9319, 'compress@10': 0.6273, 'time@10': 7.4964}:  50%|█████     | 5/10 [00:25<00:26,  5.29s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9443, 'compress@10': 0.6026, 'time@10': 7.927}:  50%|█████     | 5/10 [00:35<00:26,  5.29s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0127, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9443, 'compress@10': 0.6026, 'time@10': 7.927}:  60%|██████    | 6/10 [00:35<00:27,  6.93s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9459, 'compress@10': 0.5658, 'time@10': 8.3666}:  60%|██████    | 6/10 [00:40<00:27,  6.93s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9459, 'compress@10': 0.5658, 'time@10': 8.3666}:  70%|███████   | 7/10 [00:40<00:19,  6.48s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9483, 'compress@10': 0.5433, 'time@10': 8.2796}:  70%|███████   | 7/10 [00:48<00:19,  6.48s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9483, 'compress@10': 0.5433, 'time@10': 8.2796}:  80%|████████  | 8/10 [00:48<00:13,  6.87s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0119, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9502, 'compress@10': 0.5527, 'time@10': 9.0017}:  80%|████████  | 8/10 [00:55<00:13,  6.87s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0119, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9502, 'compress@10': 0.5527, 'time@10': 9.0017}:  90%|█████████ | 9/10 [00:55<00:07,  7.05s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9528, 'compress@10': 0.5307, 'time@10': 9.0944}:  90%|█████████ | 9/10 [01:05<00:07,  7.05s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9528, 'compress@10': 0.5307, 'time@10': 9.0944}: 100%|██████████| 10/10 [01:05<00:00,  7.95s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0109, 'hit_ratio@10': 0.8904, 'ndcg@10': 0.9528, 'compress@10': 0.5307, 'time@10': 9.0944}: 100%|██████████| 10/10 [01:05<00:00,  6.59s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.010916153299813543
Avg hit ratio: 0.8903985746379635
Avg ndcg: 0.9527942837863197
Avg compression ratio: 0.5307487796673975
Avg train time: 9.094429969787598
Std train time: 2.8529724590623715
[0.8707317073170732, 0.18780487804878052, 0.04146341463414633, 0.8707317073170732, 0.9682926829268294, 0.48048780487804915, 0.3097560975609756, 0.3829268292682927, 0.6268292682926827, 0.3097560975609756]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9051, 'compress@10': 0.8775, 'time@10': 7.8179}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0227, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9051, 'compress@10': 0.8775, 'time@10': 7.8179}:  10%|█         | 1/10 [00:03<00:35,  3.96s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9359, 'compress@10': 0.5458, 'time@10': 7.3025}:  10%|█         | 1/10 [00:10<00:35,  3.96s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9359, 'compress@10': 0.5458, 'time@10': 7.3025}:  20%|██        | 2/10 [00:10<00:45,  5.64s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9097, 'compress@10': 0.4233, 'time@10': 6.7373}:  20%|██        | 2/10 [00:13<00:45,  5.64s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9097, 'compress@10': 0.4233, 'time@10': 6.7373}:  30%|███       | 3/10 [00:13<00:30,  4.36s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9228, 'compress@10': 0.5363, 'time@10': 6.4345}:  30%|███       | 3/10 [00:19<00:30,  4.36s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0107, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9228, 'compress@10': 0.5363, 'time@10': 6.4345}:  40%|████      | 4/10 [00:19<00:29,  4.84s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9274, 'compress@10': 0.6228, 'time@10': 7.5975}:  40%|████      | 4/10 [00:25<00:29,  4.84s/it] {'epoch': 40, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9274, 'compress@10': 0.6228, 'time@10': 7.5975}:  50%|█████     | 5/10 [00:25<00:26,  5.31s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9356, 'compress@10': 0.601, 'time@10': 8.0203}:  50%|█████     | 5/10 [00:35<00:26,  5.31s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0094, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9356, 'compress@10': 0.601, 'time@10': 8.0203}:  60%|██████    | 6/10 [00:35<00:27,  6.97s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9454, 'compress@10': 0.5634, 'time@10': 8.4213}:  60%|██████    | 6/10 [00:40<00:27,  6.97s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8834, 'ndcg@10': 0.9454, 'compress@10': 0.5634, 'time@10': 8.4213}:  70%|███████   | 7/10 [00:40<00:19,  6.47s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9477, 'compress@10': 0.543, 'time@10': 8.3392}:  70%|███████   | 7/10 [00:48<00:19,  6.47s/it]  {'epoch': 40, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9477, 'compress@10': 0.543, 'time@10': 8.3392}:  80%|████████  | 8/10 [00:48<00:13,  6.89s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9478, 'compress@10': 0.5535, 'time@10': 8.9569}:  80%|████████  | 8/10 [00:55<00:13,  6.89s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0152, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9478, 'compress@10': 0.5535, 'time@10': 8.9569}:  90%|█████████ | 9/10 [00:55<00:06,  6.93s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9478, 'compress@10': 0.5307, 'time@10': 9.0507}:  90%|█████████ | 9/10 [01:05<00:06,  6.93s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9478, 'compress@10': 0.5307, 'time@10': 9.0507}: 100%|██████████| 10/10 [01:05<00:00,  7.85s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0163, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9478, 'compress@10': 0.5307, 'time@10': 9.0507}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.016286105541086525
Avg hit ratio: 0.8846842889236777
Avg ndcg: 0.9478127086052659
Avg compression ratio: 0.53070708097719
Avg train time: 9.050679779052734
Std train time: 2.6712758428322356
[0.8738095238095238, 0.18333333333333335, 0.040476190476190464, 0.85, 0.9690476190476192, 0.46904761904761944, 0.3261904761904762, 0.3738095238095238, 0.6357142857142855, 0.3261904761904762]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.927, 'compress@10': 0.8804, 'time@10': 7.4357}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.927, 'compress@10': 0.8804, 'time@10': 7.4357}:  10%|█         | 1/10 [00:03<00:33,  3.76s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9468, 'compress@10': 0.5451, 'time@10': 7.1519}:  10%|█         | 1/10 [00:10<00:33,  3.76s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9468, 'compress@10': 0.5451, 'time@10': 7.1519}:  20%|██        | 2/10 [00:10<00:44,  5.61s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9169, 'compress@10': 0.4226, 'time@10': 6.5723}:  20%|██        | 2/10 [00:13<00:44,  5.61s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0072, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9169, 'compress@10': 0.4226, 'time@10': 6.5723}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9281, 'compress@10': 0.5308, 'time@10': 6.3936}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.9281, 'compress@10': 0.5308, 'time@10': 6.3936}:  40%|████      | 4/10 [00:19<00:29,  4.93s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9317, 'compress@10': 0.6185, 'time@10': 7.5358}:  40%|████      | 4/10 [00:25<00:29,  4.93s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9317, 'compress@10': 0.6185, 'time@10': 7.5358}:  50%|█████     | 5/10 [00:25<00:26,  5.35s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9398, 'compress@10': 0.5956, 'time@10': 7.9976}:  50%|█████     | 5/10 [00:35<00:26,  5.35s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8669, 'ndcg@10': 0.9398, 'compress@10': 0.5956, 'time@10': 7.9976}:  60%|██████    | 6/10 [00:35<00:28,  7.05s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0098, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9416, 'compress@10': 0.561, 'time@10': 8.4396}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it] {'epoch': 41, 'num_users': 6.2857, 'loss': 0.0098, 'hit_ratio@10': 0.8802, 'ndcg@10': 0.9416, 'compress@10': 0.561, 'time@10': 8.4396}:  70%|███████   | 7/10 [00:41<00:19,  6.57s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9444, 'compress@10': 0.5398, 'time@10': 8.3482}:  70%|███████   | 7/10 [00:49<00:19,  6.57s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9444, 'compress@10': 0.5398, 'time@10': 8.3482}:  80%|████████  | 8/10 [00:49<00:13,  6.94s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9435, 'compress@10': 0.5516, 'time@10': 8.963}:  80%|████████  | 8/10 [00:56<00:13,  6.94s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0116, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.9435, 'compress@10': 0.5516, 'time@10': 8.963}:  90%|█████████ | 9/10 [00:56<00:06,  6.95s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9468, 'compress@10': 0.5306, 'time@10': 9.0657}:  90%|█████████ | 9/10 [01:06<00:06,  6.95s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9468, 'compress@10': 0.5306, 'time@10': 9.0657}: 100%|██████████| 10/10 [01:06<00:00,  7.90s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0107, 'hit_ratio@10': 0.891, 'ndcg@10': 0.9468, 'compress@10': 0.5306, 'time@10': 9.0657}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.010738024554833055
Avg hit ratio: 0.891033495272884
Avg ndcg: 0.9467829500526518
Avg compression ratio: 0.530598800060529
Avg train time: 9.065722179412841
Std train time: 2.6811358173230224
[0.8767441860465116, 0.17906976744186048, 0.03953488372093022, 0.8534883720930232, 0.9697674418604653, 0.45813953488372133, 0.3418604651162791, 0.36511627906976746, 0.6441860465116277, 0.3186046511627907]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9305, 'compress@10': 0.8832, 'time@10': 7.5641}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9305, 'compress@10': 0.8832, 'time@10': 7.5641}:  10%|█         | 1/10 [00:03<00:34,  3.82s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9512, 'compress@10': 0.5444, 'time@10': 7.1099}:  10%|█         | 1/10 [00:10<00:34,  3.82s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9512, 'compress@10': 0.5444, 'time@10': 7.1099}:  20%|██        | 2/10 [00:10<00:44,  5.51s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9198, 'compress@10': 0.4218, 'time@10': 6.5965}:  20%|██        | 2/10 [00:13<00:44,  5.51s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0064, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9198, 'compress@10': 0.4218, 'time@10': 6.5965}:  30%|███       | 3/10 [00:13<00:29,  4.28s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9285, 'compress@10': 0.5311, 'time@10': 6.3175}:  30%|███       | 3/10 [00:18<00:29,  4.28s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9285, 'compress@10': 0.5311, 'time@10': 6.3175}:  40%|████      | 4/10 [00:18<00:28,  4.77s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9325, 'compress@10': 0.6189, 'time@10': 7.4967}:  40%|████      | 4/10 [00:24<00:28,  4.77s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9325, 'compress@10': 0.6189, 'time@10': 7.4967}:  50%|█████     | 5/10 [00:24<00:26,  5.27s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9399, 'compress@10': 0.5941, 'time@10': 7.9673}:  50%|█████     | 5/10 [00:35<00:26,  5.27s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9399, 'compress@10': 0.5941, 'time@10': 7.9673}:  60%|██████    | 6/10 [00:35<00:27,  7.00s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0083, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9421, 'compress@10': 0.5619, 'time@10': 8.4123}:  60%|██████    | 6/10 [00:40<00:27,  7.00s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0083, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9421, 'compress@10': 0.5619, 'time@10': 8.4123}:  70%|███████   | 7/10 [00:40<00:19,  6.53s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0081, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9451, 'compress@10': 0.5395, 'time@10': 8.3184}:  70%|███████   | 7/10 [00:48<00:19,  6.53s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0081, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9451, 'compress@10': 0.5395, 'time@10': 8.3184}:  80%|████████  | 8/10 [00:48<00:13,  6.90s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0102, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9602, 'compress@10': 0.5523, 'time@10': 8.9337}:  80%|████████  | 8/10 [00:55<00:13,  6.90s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0102, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9602, 'compress@10': 0.5523, 'time@10': 8.9337}:  90%|█████████ | 9/10 [00:55<00:06,  6.92s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9591, 'compress@10': 0.5305, 'time@10': 9.0011}:  90%|█████████ | 9/10 [01:05<00:06,  6.92s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9591, 'compress@10': 0.5305, 'time@10': 9.0011}: 100%|██████████| 10/10 [01:05<00:00,  7.76s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.8936, 'ndcg@10': 0.9591, 'compress@10': 0.5305, 'time@10': 9.0011}: 100%|██████████| 10/10 [01:05<00:00,  6.52s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.011815659078838909
Avg hit ratio: 0.8936243810895764
Avg ndcg: 0.9591405697991237
Avg compression ratio: 0.530466378037958
Avg train time: 9.001147699356078
Std train time: 2.7177623135101308
[0.8568181818181818, 0.19772727272727275, 0.03863636363636362, 0.8568181818181818, 0.9704545454545456, 0.44772727272727314, 0.3340909090909091, 0.3568181818181818, 0.6522727272727271, 0.3340909090909091]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.92, 'compress@10': 0.8643, 'time@10': 7.6879}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.92, 'compress@10': 0.8643, 'time@10': 7.6879}:  10%|█         | 1/10 [00:03<00:35,  3.89s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9481, 'compress@10': 0.544, 'time@10': 7.3102}:  10%|█         | 1/10 [00:10<00:35,  3.89s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.013, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9481, 'compress@10': 0.544, 'time@10': 7.3102}:  20%|██        | 2/10 [00:10<00:45,  5.70s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9178, 'compress@10': 0.4213, 'time@10': 6.7047}:  20%|██        | 2/10 [00:13<00:45,  5.70s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9178, 'compress@10': 0.4213, 'time@10': 6.7047}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9289, 'compress@10': 0.5315, 'time@10': 6.4179}:  30%|███       | 3/10 [00:19<00:30,  4.37s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9289, 'compress@10': 0.5315, 'time@10': 6.4179}:  40%|████      | 4/10 [00:19<00:29,  4.85s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9328, 'compress@10': 0.6194, 'time@10': 7.5978}:  40%|████      | 4/10 [00:25<00:29,  4.85s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9328, 'compress@10': 0.6194, 'time@10': 7.5978}:  50%|█████     | 5/10 [00:25<00:26,  5.34s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9399, 'compress@10': 0.5928, 'time@10': 8.0329}:  50%|█████     | 5/10 [00:35<00:26,  5.34s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9399, 'compress@10': 0.5928, 'time@10': 8.0329}:  60%|██████    | 6/10 [00:35<00:28,  7.01s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9424, 'compress@10': 0.5597, 'time@10': 8.426}:  60%|██████    | 6/10 [00:41<00:28,  7.01s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0134, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9424, 'compress@10': 0.5597, 'time@10': 8.426}:  70%|███████   | 7/10 [00:41<00:19,  6.49s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9451, 'compress@10': 0.5366, 'time@10': 8.3341}:  70%|███████   | 7/10 [00:48<00:19,  6.49s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0129, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9451, 'compress@10': 0.5366, 'time@10': 8.3341}:  80%|████████  | 8/10 [00:48<00:13,  6.88s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9445, 'compress@10': 0.5506, 'time@10': 8.999}:  80%|████████  | 8/10 [00:56<00:13,  6.88s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0155, 'hit_ratio@10': 0.8711, 'ndcg@10': 0.9445, 'compress@10': 0.5506, 'time@10': 8.999}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9477, 'compress@10': 0.5304, 'time@10': 9.0931}:  90%|█████████ | 9/10 [01:06<00:06,  6.98s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9477, 'compress@10': 0.5304, 'time@10': 9.0931}: 100%|██████████| 10/10 [01:06<00:00,  7.91s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0141, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9477, 'compress@10': 0.5304, 'time@10': 9.0931}: 100%|██████████| 10/10 [01:06<00:00,  6.60s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.014130383003247166
Avg hit ratio: 0.8816878731530684
Avg ndcg: 0.947679431865373
Avg compression ratio: 0.5304236959001913
Avg train time: 9.093068838119507
Std train time: 2.767467205431439
[0.86, 0.19333333333333336, 0.037777777777777764, 0.86, 0.9711111111111113, 0.4600000000000004, 0.32666666666666666, 0.34888888888888886, 0.6599999999999998, 0.32666666666666666]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9378, 'compress@10': 0.8674, 'time@10': 7.7696}:   0%|          | 0/10 [00:03<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0059, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9378, 'compress@10': 0.8674, 'time@10': 7.7696}:  10%|█         | 1/10 [00:03<00:35,  3.92s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0046, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9528, 'compress@10': 0.5434, 'time@10': 7.1773}:  10%|█         | 1/10 [00:10<00:35,  3.92s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0046, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9528, 'compress@10': 0.5434, 'time@10': 7.1773}:  20%|██        | 2/10 [00:10<00:44,  5.51s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0031, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9209, 'compress@10': 0.4207, 'time@10': 6.5647}:  20%|██        | 2/10 [00:13<00:44,  5.51s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0031, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9209, 'compress@10': 0.4207, 'time@10': 6.5647}:  30%|███       | 3/10 [00:13<00:29,  4.24s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.931, 'compress@10': 0.5317, 'time@10': 6.2995}:  30%|███       | 3/10 [00:18<00:29,  4.24s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.931, 'compress@10': 0.5317, 'time@10': 6.2995}:  40%|████      | 4/10 [00:18<00:28,  4.75s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0069, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9352, 'compress@10': 0.6197, 'time@10': 7.4643}:  40%|████      | 4/10 [00:24<00:28,  4.75s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0069, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9352, 'compress@10': 0.6197, 'time@10': 7.4643}:  50%|█████     | 5/10 [00:24<00:26,  5.24s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.942, 'compress@10': 0.5951, 'time@10': 7.8994}:  50%|█████     | 5/10 [00:35<00:26,  5.24s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0077, 'hit_ratio@10': 0.8686, 'ndcg@10': 0.942, 'compress@10': 0.5951, 'time@10': 7.8994}:  60%|██████    | 6/10 [00:35<00:27,  6.89s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9442, 'compress@10': 0.5606, 'time@10': 8.3154}:  60%|██████    | 6/10 [00:40<00:27,  6.89s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9442, 'compress@10': 0.5606, 'time@10': 8.3154}:  70%|███████   | 7/10 [00:40<00:19,  6.42s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0074, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9467, 'compress@10': 0.5365, 'time@10': 8.2522}:  70%|███████   | 7/10 [00:48<00:19,  6.42s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0074, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9467, 'compress@10': 0.5365, 'time@10': 8.2522}:  80%|████████  | 8/10 [00:48<00:13,  6.87s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9528, 'compress@10': 0.5513, 'time@10': 8.916}:  80%|████████  | 8/10 [00:55<00:13,  6.87s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0089, 'hit_ratio@10': 0.8762, 'ndcg@10': 0.9528, 'compress@10': 0.5513, 'time@10': 8.916}:  90%|█████████ | 9/10 [00:55<00:06,  6.96s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.956, 'compress@10': 0.5303, 'time@10': 9.0241}:  90%|█████████ | 9/10 [01:05<00:06,  6.96s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.956, 'compress@10': 0.5303, 'time@10': 9.0241}: 100%|██████████| 10/10 [01:05<00:00,  7.91s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0093, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.956, 'compress@10': 0.5303, 'time@10': 9.0241}: 100%|██████████| 10/10 [01:05<00:00,  6.55s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.009299349746919072
Avg hit ratio: 0.8863227937879892
Avg ndcg: 0.9559785353785735
Avg compression ratio: 0.5303396555064307
Avg train time: 9.02411708831787
Std train time: 2.7727352430432735
[0.841304347826087, 0.18913043478260871, 0.03695652173913042, 0.8630434782608696, 0.9717391304347828, 0.471739130434783, 0.31956521739130433, 0.34130434782608693, 0.6673913043478259, 0.34130434782608693]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9252, 'compress@10': 0.8496, 'time@10': 8.0212}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9252, 'compress@10': 0.8496, 'time@10': 8.0212}:  10%|█         | 1/10 [00:04<00:36,  4.05s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9458, 'compress@10': 0.5325, 'time@10': 7.3847}:  10%|█         | 1/10 [00:10<00:36,  4.05s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9458, 'compress@10': 0.5325, 'time@10': 7.3847}:  20%|██        | 2/10 [00:10<00:45,  5.66s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9163, 'compress@10': 0.4132, 'time@10': 6.6783}:  20%|██        | 2/10 [00:13<00:45,  5.66s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9163, 'compress@10': 0.4132, 'time@10': 6.6783}:  30%|███       | 3/10 [00:13<00:30,  4.29s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9278, 'compress@10': 0.5269, 'time@10': 6.3722}:  30%|███       | 3/10 [00:18<00:30,  4.29s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9278, 'compress@10': 0.5269, 'time@10': 6.3722}:  40%|████      | 4/10 [00:18<00:28,  4.76s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9339, 'compress@10': 0.6159, 'time@10': 7.5624}:  40%|████      | 4/10 [00:25<00:28,  4.76s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0102, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9339, 'compress@10': 0.6159, 'time@10': 7.5624}:  50%|█████     | 5/10 [00:25<00:26,  5.28s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9411, 'compress@10': 0.5939, 'time@10': 8.0078}:  50%|█████     | 5/10 [00:35<00:26,  5.28s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0091, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9411, 'compress@10': 0.5939, 'time@10': 8.0078}:  60%|██████    | 6/10 [00:35<00:27,  6.98s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9434, 'compress@10': 0.5586, 'time@10': 8.4113}:  60%|██████    | 6/10 [00:40<00:27,  6.98s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0082, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9434, 'compress@10': 0.5586, 'time@10': 8.4113}:  70%|███████   | 7/10 [00:40<00:19,  6.49s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0084, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9459, 'compress@10': 0.5338, 'time@10': 8.3222}:  70%|███████   | 7/10 [00:48<00:19,  6.49s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0084, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9459, 'compress@10': 0.5338, 'time@10': 8.3222}:  80%|████████  | 8/10 [00:48<00:13,  6.89s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0103, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.944, 'compress@10': 0.5497, 'time@10': 8.9823}:  80%|████████  | 8/10 [00:55<00:13,  6.89s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0103, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.944, 'compress@10': 0.5497, 'time@10': 8.9823}:  90%|█████████ | 9/10 [00:55<00:06,  6.97s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9445, 'compress@10': 0.5303, 'time@10': 9.0606}:  90%|█████████ | 9/10 [01:05<00:06,  6.97s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9445, 'compress@10': 0.5303, 'time@10': 9.0606}: 100%|██████████| 10/10 [01:05<00:00,  7.85s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.011, 'hit_ratio@10': 0.8971, 'ndcg@10': 0.9445, 'compress@10': 0.5303, 'time@10': 9.0606}: 100%|██████████| 10/10 [01:05<00:00,  6.56s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.010988503234665966
Avg hit ratio: 0.8971164445816399
Avg ndcg: 0.944485604687855
Avg compression ratio: 0.5303254835869678
Avg train time: 9.060613322257996
Std train time: 2.8002237588875745
[0.8446808510638298, 0.20638297872340428, 0.03617021276595744, 0.8659574468085106, 0.9510638297872342, 0.46170212765957486, 0.3127659574468085, 0.33404255319148934, 0.6744680851063828, 0.35531914893617017]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9411, 'compress@10': 0.8528, 'time@10': 8.2052}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0113, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9411, 'compress@10': 0.8528, 'time@10': 8.2052}:  10%|█         | 1/10 [00:04<00:37,  4.14s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9638, 'compress@10': 0.5424, 'time@10': 7.5075}:  10%|█         | 1/10 [00:10<00:37,  4.14s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0175, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9638, 'compress@10': 0.5424, 'time@10': 7.5075}:  20%|██        | 2/10 [00:10<00:45,  5.73s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9283, 'compress@10': 0.4196, 'time@10': 6.7916}:  20%|██        | 2/10 [00:13<00:45,  5.73s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9283, 'compress@10': 0.4196, 'time@10': 6.7916}:  30%|███       | 3/10 [00:13<00:30,  4.36s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9368, 'compress@10': 0.5324, 'time@10': 6.4823}:  30%|███       | 3/10 [00:19<00:30,  4.36s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9368, 'compress@10': 0.5324, 'time@10': 6.4823}:  40%|████      | 4/10 [00:19<00:29,  4.84s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9407, 'compress@10': 0.6163, 'time@10': 7.605}:  40%|████      | 4/10 [00:25<00:29,  4.84s/it] {'epoch': 46, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9407, 'compress@10': 0.6163, 'time@10': 7.605}:  50%|█████     | 5/10 [00:25<00:26,  5.29s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9536, 'compress@10': 0.5925, 'time@10': 8.0495}:  50%|█████     | 5/10 [00:35<00:26,  5.29s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9536, 'compress@10': 0.5925, 'time@10': 8.0495}:  60%|██████    | 6/10 [00:35<00:27,  7.00s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9566, 'compress@10': 0.5565, 'time@10': 8.4594}:  60%|██████    | 6/10 [00:41<00:27,  7.00s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0157, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9566, 'compress@10': 0.5565, 'time@10': 8.4594}:  70%|███████   | 7/10 [00:41<00:19,  6.51s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9552, 'compress@10': 0.5311, 'time@10': 8.3885}:  70%|███████   | 7/10 [00:49<00:19,  6.51s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0151, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9552, 'compress@10': 0.5311, 'time@10': 8.3885}:  80%|████████  | 8/10 [00:49<00:13,  6.96s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9654, 'compress@10': 0.548, 'time@10': 9.0406}:  80%|████████  | 8/10 [00:56<00:13,  6.96s/it] {'epoch': 46, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8812, 'ndcg@10': 0.9654, 'compress@10': 0.548, 'time@10': 9.0406}:  90%|█████████ | 9/10 [00:56<00:07,  7.02s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9665, 'compress@10': 0.5302, 'time@10': 9.1265}:  90%|█████████ | 9/10 [01:06<00:07,  7.02s/it] {'epoch': 46, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9665, 'compress@10': 0.5302, 'time@10': 9.1265}: 100%|██████████| 10/10 [01:06<00:00,  7.92s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0147, 'hit_ratio@10': 0.8908, 'ndcg@10': 0.9665, 'compress@10': 0.5302, 'time@10': 9.1265}: 100%|██████████| 10/10 [01:06<00:00,  6.62s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.014701840352223109
Avg hit ratio: 0.8907672382324335
Avg ndcg: 0.9664622429508333
Avg compression ratio: 0.5302188712515823
Avg train time: 9.12649359703064
Std train time: 2.737735981819568
[0.8270833333333334, 0.22291666666666668, 0.03541666666666666, 0.86875, 0.9312500000000002, 0.47291666666666704, 0.32708333333333334, 0.32708333333333334, 0.6812499999999998, 0.34791666666666665]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0069, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9356, 'compress@10': 0.8362, 'time@10': 8.1225}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0069, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9356, 'compress@10': 0.8362, 'time@10': 8.1225}:  10%|█         | 1/10 [00:04<00:36,  4.10s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9725, 'compress@10': 0.5421, 'time@10': 7.4899}:  10%|█         | 1/10 [00:10<00:36,  4.10s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9725, 'compress@10': 0.5421, 'time@10': 7.4899}:  20%|██        | 2/10 [00:10<00:45,  5.74s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.934, 'compress@10': 0.4191, 'time@10': 6.8174}:  20%|██        | 2/10 [00:13<00:45,  5.74s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.934, 'compress@10': 0.4191, 'time@10': 6.8174}:  30%|███       | 3/10 [00:13<00:30,  4.39s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9416, 'compress@10': 0.5327, 'time@10': 6.473}:  30%|███       | 3/10 [00:19<00:30,  4.39s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0093, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9416, 'compress@10': 0.5327, 'time@10': 6.473}:  40%|████      | 4/10 [00:19<00:28,  4.82s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9451, 'compress@10': 0.6127, 'time@10': 7.6129}:  40%|████      | 4/10 [00:25<00:28,  4.82s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0095, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9451, 'compress@10': 0.6127, 'time@10': 7.6129}:  50%|█████     | 5/10 [00:25<00:26,  5.29s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.008, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9504, 'compress@10': 0.5913, 'time@10': 8.0155}:  50%|█████     | 5/10 [00:35<00:26,  5.29s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.008, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9504, 'compress@10': 0.5913, 'time@10': 8.0155}:  60%|██████    | 6/10 [00:35<00:27,  6.91s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9507, 'compress@10': 0.5574, 'time@10': 8.4444}:  60%|██████    | 6/10 [00:40<00:27,  6.91s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0087, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9507, 'compress@10': 0.5574, 'time@10': 8.4444}:  70%|███████   | 7/10 [00:40<00:19,  6.46s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9517, 'compress@10': 0.531, 'time@10': 8.3595}:  70%|███████   | 7/10 [00:48<00:19,  6.46s/it]   {'epoch': 47, 'num_users': 6.125, 'loss': 0.009, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9517, 'compress@10': 0.531, 'time@10': 8.3595}:  80%|████████  | 8/10 [00:48<00:13,  6.89s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9471, 'compress@10': 0.5487, 'time@10': 8.999}:  80%|████████  | 8/10 [00:55<00:13,  6.89s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0108, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9471, 'compress@10': 0.5487, 'time@10': 8.999}:  90%|█████████ | 9/10 [00:55<00:06,  6.95s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9476, 'compress@10': 0.5301, 'time@10': 9.0816}:  90%|█████████ | 9/10 [01:05<00:06,  6.95s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9476, 'compress@10': 0.5301, 'time@10': 9.0816}: 100%|██████████| 10/10 [01:05<00:00,  7.85s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.012, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9476, 'compress@10': 0.5301, 'time@10': 9.0816}: 100%|██████████| 10/10 [01:05<00:00,  6.57s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.012018991848214184
Avg hit ratio: 0.8885450160102113
Avg ndcg: 0.9475834570151193
Avg compression ratio: 0.5301451404626503
Avg train time: 9.081645607948303
Std train time: 2.7198161903722786
[0.8102040816326531, 0.23877551020408164, 0.0346938775510204, 0.8510204081632653, 0.912244897959184, 0.46326530612244937, 0.3408163265306122, 0.3408163265306122, 0.6877551020408161, 0.36122448979591837]
[10, 10, 23, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9312, 'compress@10': 0.8202, 'time@10': 8.1004}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0109, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9312, 'compress@10': 0.8202, 'time@10': 8.1004}:  10%|█         | 1/10 [00:04<00:36,  4.11s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9489, 'compress@10': 0.5418, 'time@10': 7.4785}:  10%|█         | 1/10 [00:11<00:36,  4.11s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0088, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9489, 'compress@10': 0.5418, 'time@10': 7.4785}:  20%|██        | 2/10 [00:11<00:45,  5.75s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9183, 'compress@10': 0.4187, 'time@10': 6.675}:  20%|██        | 2/10 [00:13<00:45,  5.75s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.0059, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9183, 'compress@10': 0.4187, 'time@10': 6.675}:  30%|███       | 3/10 [00:13<00:30,  4.30s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9298, 'compress@10': 0.5281, 'time@10': 6.5052}:  30%|███       | 3/10 [00:19<00:30,  4.30s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9298, 'compress@10': 0.5281, 'time@10': 6.5052}:  40%|████      | 4/10 [00:19<00:29,  4.98s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9362, 'compress@10': 0.6053, 'time@10': 7.6407}:  40%|████      | 4/10 [00:25<00:29,  4.98s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0092, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9362, 'compress@10': 0.6053, 'time@10': 7.6407}:  50%|█████     | 5/10 [00:25<00:26,  5.39s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9423, 'compress@10': 0.5836, 'time@10': 8.0708}:  50%|█████     | 5/10 [00:35<00:26,  5.39s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9423, 'compress@10': 0.5836, 'time@10': 8.0708}:  60%|██████    | 6/10 [00:35<00:28,  7.05s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.01, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9448, 'compress@10': 0.5527, 'time@10': 8.4784}:  60%|██████    | 6/10 [00:41<00:28,  7.05s/it]  {'epoch': 48, 'num_users': 6.2857, 'loss': 0.01, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9448, 'compress@10': 0.5527, 'time@10': 8.4784}:  70%|███████   | 7/10 [00:41<00:19,  6.54s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9473, 'compress@10': 0.5286, 'time@10': 8.3938}:  70%|███████   | 7/10 [00:49<00:19,  6.54s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0094, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9473, 'compress@10': 0.5286, 'time@10': 8.3938}:  80%|████████  | 8/10 [00:49<00:13,  6.95s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9492, 'compress@10': 0.5472, 'time@10': 9.015}:  80%|████████  | 8/10 [00:56<00:13,  6.95s/it] {'epoch': 48, 'num_users': 6.3333, 'loss': 0.0094, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9492, 'compress@10': 0.5472, 'time@10': 9.015}:  90%|█████████ | 9/10 [00:56<00:06,  6.98s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.952, 'compress@10': 0.5301, 'time@10': 9.0931}:  90%|█████████ | 9/10 [01:06<00:06,  6.98s/it]  {'epoch': 48, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.952, 'compress@10': 0.5301, 'time@10': 9.0931}: 100%|██████████| 10/10 [01:06<00:00,  7.86s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0086, 'hit_ratio@10': 0.9051, 'ndcg@10': 0.952, 'compress@10': 0.5301, 'time@10': 9.0931}: 100%|██████████| 10/10 [01:06<00:00,  6.62s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.008572813395739034
Avg hit ratio: 0.9050529525181478
Avg ndcg: 0.9520167145878855
Avg compression ratio: 0.5300888695561257
Avg train time: 9.093137097358703
Std train time: 2.6841031315582167
[0.8140000000000001, 0.234, 0.033999999999999996, 0.854, 0.9140000000000003, 0.47400000000000037, 0.33399999999999996, 0.33399999999999996, 0.6939999999999998, 0.354]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.939, 'compress@10': 0.8238, 'time@10': 7.9354}:   0%|          | 0/10 [00:04<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.939, 'compress@10': 0.8238, 'time@10': 7.9354}:  10%|█         | 1/10 [00:04<00:36,  4.02s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9649, 'compress@10': 0.5412, 'time@10': 7.377}:  10%|█         | 1/10 [00:10<00:36,  4.02s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9649, 'compress@10': 0.5412, 'time@10': 7.377}:  20%|██        | 2/10 [00:10<00:45,  5.69s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.929, 'compress@10': 0.4182, 'time@10': 6.7553}:  20%|██        | 2/10 [00:13<00:45,  5.69s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.929, 'compress@10': 0.4182, 'time@10': 6.7553}:  30%|███       | 3/10 [00:13<00:30,  4.37s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9378, 'compress@10': 0.5284, 'time@10': 6.5569}:  30%|███       | 3/10 [00:19<00:30,  4.37s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9378, 'compress@10': 0.5284, 'time@10': 6.5569}:  40%|████      | 4/10 [00:19<00:30,  5.01s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9425, 'compress@10': 0.6059, 'time@10': 7.6694}:  40%|████      | 4/10 [00:25<00:30,  5.01s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0101, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9425, 'compress@10': 0.6059, 'time@10': 7.6694}:  50%|█████     | 5/10 [00:25<00:27,  5.40s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9484, 'compress@10': 0.5858, 'time@10': 8.0764}:  50%|█████     | 5/10 [00:35<00:27,  5.40s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0098, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9484, 'compress@10': 0.5858, 'time@10': 8.0764}:  60%|██████    | 6/10 [00:35<00:28,  7.02s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9497, 'compress@10': 0.5537, 'time@10': 8.4616}:  60%|██████    | 6/10 [00:41<00:28,  7.02s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9497, 'compress@10': 0.5537, 'time@10': 8.4616}:  70%|███████   | 7/10 [00:41<00:19,  6.49s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9505, 'compress@10': 0.5286, 'time@10': 8.3755}:  70%|███████   | 7/10 [00:49<00:19,  6.49s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9505, 'compress@10': 0.5286, 'time@10': 8.3755}:  80%|████████  | 8/10 [00:49<00:13,  6.91s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9518, 'compress@10': 0.5479, 'time@10': 8.9961}:  80%|████████  | 8/10 [00:56<00:13,  6.91s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.011, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9518, 'compress@10': 0.5479, 'time@10': 8.9961}:  90%|█████████ | 9/10 [00:56<00:06,  6.95s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9522, 'compress@10': 0.53, 'time@10': 9.0831}:  90%|█████████ | 9/10 [01:06<00:06,  6.95s/it]    {'epoch': 49, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9522, 'compress@10': 0.53, 'time@10': 9.0831}: 100%|██████████| 10/10 [01:06<00:00,  7.86s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8828, 'ndcg@10': 0.9522, 'compress@10': 0.53, 'time@10': 9.0831}: 100%|██████████| 10/10 [01:06<00:00,  6.61s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.012633442185322427
Avg hit ratio: 0.8828307302959256
Avg ndcg: 0.9522327803821652
Avg compression ratio: 0.5300189254598706
Avg train time: 9.083070278167725
Std train time: 2.611411278227765
[0.7980392156862746, 0.24901960784313726, 0.033333333333333326, 0.8568627450980392, 0.8960784313725493, 0.4647058823529415, 0.34705882352941175, 0.3274509803921568, 0.6999999999999998, 0.36666666666666664]
[10, 10, 24, 10, 6, 10, 10, 10, 9, 10]
