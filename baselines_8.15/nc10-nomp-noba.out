  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1442, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5116, 'compress@10': 1.0, 'time@10': 3.9637}:   0%|          | 0/10 [00:02<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1442, 'hit_ratio@10': 0.5789, 'ndcg@10': 0.5116, 'compress@10': 1.0, 'time@10': 3.9637}:  10%|█         | 1/10 [00:02<00:18,  2.02s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1045, 'hit_ratio@10': 0.6927, 'ndcg@10': 0.6643, 'compress@10': 1.0, 'time@10': 3.2237}:  10%|█         | 1/10 [00:04<00:18,  2.02s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1045, 'hit_ratio@10': 0.6927, 'ndcg@10': 0.6643, 'compress@10': 1.0, 'time@10': 3.2237}:  20%|██        | 2/10 [00:04<00:18,  2.31s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7422, 'hit_ratio@10': 0.6523, 'ndcg@10': 0.4429, 'compress@10': 1.0, 'time@10': 2.4727}:  20%|██        | 2/10 [00:05<00:18,  2.31s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7422, 'hit_ratio@10': 0.6523, 'ndcg@10': 0.4429, 'compress@10': 1.0, 'time@10': 2.4727}:  30%|███       | 3/10 [00:05<00:10,  1.50s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.576, 'hit_ratio@10': 0.7035, 'ndcg@10': 0.5175, 'compress@10': 1.0, 'time@10': 2.4057}:  30%|███       | 3/10 [00:07<00:10,  1.50s/it] {'epoch': 0, 'num_users': 5.0, 'loss': 0.576, 'hit_ratio@10': 0.7035, 'ndcg@10': 0.5175, 'compress@10': 1.0, 'time@10': 2.4057}:  40%|████      | 4/10 [00:07<00:10,  1.79s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4792, 'hit_ratio@10': 0.7268, 'ndcg@10': 0.569, 'compress@10': 1.0, 'time@10': 3.5699}:  40%|████      | 4/10 [00:11<00:10,  1.79s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4792, 'hit_ratio@10': 0.7268, 'ndcg@10': 0.569, 'compress@10': 1.0, 'time@10': 3.5699}:  50%|█████     | 5/10 [00:11<00:13,  2.64s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4134, 'hit_ratio@10': 0.7168, 'ndcg@10': 0.61, 'compress@10': 1.0, 'time@10': 3.5836}:  50%|█████     | 5/10 [00:15<00:13,  2.64s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4134, 'hit_ratio@10': 0.7168, 'ndcg@10': 0.61, 'compress@10': 1.0, 'time@10': 3.5836}:  60%|██████    | 6/10 [00:15<00:12,  3.00s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3665, 'hit_ratio@10': 0.7287, 'ndcg@10': 0.6132, 'compress@10': 1.0, 'time@10': 3.6368}:  60%|██████    | 6/10 [00:17<00:12,  3.00s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3665, 'hit_ratio@10': 0.7287, 'ndcg@10': 0.6132, 'compress@10': 1.0, 'time@10': 3.6368}:  70%|███████   | 7/10 [00:17<00:08,  2.68s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3262, 'hit_ratio@10': 0.7519, 'ndcg@10': 0.6374, 'compress@10': 1.0, 'time@10': 3.5299}:  70%|███████   | 7/10 [00:19<00:08,  2.68s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3262, 'hit_ratio@10': 0.7519, 'ndcg@10': 0.6374, 'compress@10': 1.0, 'time@10': 3.5299}:  80%|████████  | 8/10 [00:19<00:05,  2.72s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2947, 'hit_ratio@10': 0.7477, 'ndcg@10': 0.6685, 'compress@10': 1.0, 'time@10': 3.7755}:  80%|████████  | 8/10 [00:22<00:05,  2.72s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2947, 'hit_ratio@10': 0.7477, 'ndcg@10': 0.6685, 'compress@10': 1.0, 'time@10': 3.7755}:  90%|█████████ | 9/10 [00:22<00:02,  2.78s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2703, 'hit_ratio@10': 0.7661, 'ndcg@10': 0.6867, 'compress@10': 1.0, 'time@10': 3.7611}:  90%|█████████ | 9/10 [00:26<00:02,  2.78s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2703, 'hit_ratio@10': 0.7661, 'ndcg@10': 0.6867, 'compress@10': 1.0, 'time@10': 3.7611}: 100%|██████████| 10/10 [00:26<00:00,  3.06s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2703, 'hit_ratio@10': 0.7661, 'ndcg@10': 0.6867, 'compress@10': 1.0, 'time@10': 3.7611}: 100%|██████████| 10/10 [00:26<00:00,  2.66s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.2703377089438983
Avg hit ratio: 0.7661026686951984
Avg ndcg: 0.6867243489602177
Avg compression ratio: 1.0
Avg train time: 3.761111092567444
Std train time: 1.9174297125605673
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8394, 'compress@10': 1.0, 'time@10': 3.0006}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0501, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8394, 'compress@10': 1.0, 'time@10': 3.0006}:  10%|█         | 1/10 [00:01<00:13,  1.54s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0514, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 2.786}:  10%|█         | 1/10 [00:04<00:13,  1.54s/it] {'epoch': 1, 'num_users': 7.0, 'loss': 0.0514, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8477, 'compress@10': 1.0, 'time@10': 2.786}:  20%|██        | 2/10 [00:04<00:17,  2.17s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0406, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8129, 'compress@10': 1.0, 'time@10': 2.1833}:  20%|██        | 2/10 [00:04<00:17,  2.17s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0406, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8129, 'compress@10': 1.0, 'time@10': 2.1833}:  30%|███       | 3/10 [00:04<00:09,  1.42s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0428, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8204, 'compress@10': 1.0, 'time@10': 2.1931}:  30%|███       | 3/10 [00:06<00:09,  1.42s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0428, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8204, 'compress@10': 1.0, 'time@10': 2.1931}:  40%|████      | 4/10 [00:06<00:10,  1.75s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0513, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8138, 'compress@10': 1.0, 'time@10': 3.4206}:  40%|████      | 4/10 [00:11<00:10,  1.75s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0513, 'hit_ratio@10': 0.8022, 'ndcg@10': 0.8138, 'compress@10': 1.0, 'time@10': 3.4206}:  50%|█████     | 5/10 [00:11<00:13,  2.64s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0557, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8127, 'compress@10': 1.0, 'time@10': 3.4591}:  50%|█████     | 5/10 [00:14<00:13,  2.64s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0557, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8127, 'compress@10': 1.0, 'time@10': 3.4591}:  60%|██████    | 6/10 [00:14<00:11,  2.99s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0537, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8207, 'compress@10': 1.0, 'time@10': 3.5468}:  60%|██████    | 6/10 [00:16<00:11,  2.99s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0537, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.8207, 'compress@10': 1.0, 'time@10': 3.5468}:  70%|███████   | 7/10 [00:16<00:08,  2.69s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0521, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8279, 'compress@10': 1.0, 'time@10': 3.4523}:  70%|███████   | 7/10 [00:19<00:08,  2.69s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0521, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8279, 'compress@10': 1.0, 'time@10': 3.4523}:  80%|████████  | 8/10 [00:19<00:05,  2.74s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0501, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8382, 'compress@10': 1.0, 'time@10': 3.7119}:  80%|████████  | 8/10 [00:22<00:05,  2.74s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0501, 'hit_ratio@10': 0.814, 'ndcg@10': 0.8382, 'compress@10': 1.0, 'time@10': 3.7119}:  90%|█████████ | 9/10 [00:22<00:02,  2.80s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0498, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.839, 'compress@10': 1.0, 'time@10': 3.6832}:  90%|█████████ | 9/10 [00:26<00:02,  2.80s/it]   {'epoch': 1, 'num_users': 6.3, 'loss': 0.0498, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.839, 'compress@10': 1.0, 'time@10': 3.6832}: 100%|██████████| 10/10 [00:26<00:00,  3.00s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0498, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.839, 'compress@10': 1.0, 'time@10': 3.6832}: 100%|██████████| 10/10 [00:26<00:00,  2.61s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.04984604599537755
Avg hit ratio: 0.8258183827114218
Avg ndcg: 0.8389733564340924
Avg compression ratio: 1.0
Avg train time: 3.683160090446472
Std train time: 1.9544895835759446
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 3.0767}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 3.0767}:  10%|█         | 1/10 [00:01<00:14,  1.58s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 2.7751}:  10%|█         | 1/10 [00:04<00:14,  1.58s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 2.7751}:  20%|██        | 2/10 [00:04<00:17,  2.13s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8512, 'compress@10': 1.0, 'time@10': 2.1711}:  20%|██        | 2/10 [00:04<00:17,  2.13s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0345, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8512, 'compress@10': 1.0, 'time@10': 2.1711}:  30%|███       | 3/10 [00:04<00:09,  1.39s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0385, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8487, 'compress@10': 1.0, 'time@10': 2.185}:  30%|███       | 3/10 [00:06<00:09,  1.39s/it]  {'epoch': 2, 'num_users': 5.0, 'loss': 0.0385, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8487, 'compress@10': 1.0, 'time@10': 2.185}:  40%|████      | 4/10 [00:06<00:10,  1.74s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.8373, 'compress@10': 1.0, 'time@10': 3.423}:  40%|████      | 4/10 [00:11<00:10,  1.74s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0471, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.8373, 'compress@10': 1.0, 'time@10': 3.423}:  50%|█████     | 5/10 [00:11<00:13,  2.63s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0517, 'hit_ratio@10': 0.7706, 'ndcg@10': 0.8338, 'compress@10': 1.0, 'time@10': 3.4777}:  50%|█████     | 5/10 [00:14<00:13,  2.63s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0517, 'hit_ratio@10': 0.7706, 'ndcg@10': 0.8338, 'compress@10': 1.0, 'time@10': 3.4777}:  60%|██████    | 6/10 [00:14<00:12,  3.03s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.7976, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 3.5639}:  60%|██████    | 6/10 [00:16<00:12,  3.03s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0507, 'hit_ratio@10': 0.7976, 'ndcg@10': 0.8355, 'compress@10': 1.0, 'time@10': 3.5639}:  70%|███████   | 7/10 [00:16<00:08,  2.72s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0522, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8381, 'compress@10': 1.0, 'time@10': 3.4656}:  70%|███████   | 7/10 [00:19<00:08,  2.72s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0522, 'hit_ratio@10': 0.8122, 'ndcg@10': 0.8381, 'compress@10': 1.0, 'time@10': 3.4656}:  80%|████████  | 8/10 [00:19<00:05,  2.75s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0531, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.837, 'compress@10': 1.0, 'time@10': 3.7076}:  80%|████████  | 8/10 [00:22<00:05,  2.75s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0531, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.837, 'compress@10': 1.0, 'time@10': 3.7076}:  90%|█████████ | 9/10 [00:22<00:02,  2.78s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0525, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8376, 'compress@10': 1.0, 'time@10': 3.6995}:  90%|█████████ | 9/10 [00:26<00:02,  2.78s/it]   {'epoch': 2, 'num_users': 6.3, 'loss': 0.0525, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8376, 'compress@10': 1.0, 'time@10': 3.6995}: 100%|██████████| 10/10 [00:26<00:00,  3.05s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0525, 'hit_ratio@10': 0.823, 'ndcg@10': 0.8376, 'compress@10': 1.0, 'time@10': 3.6995}: 100%|██████████| 10/10 [00:26<00:00,  2.63s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.05254534889682401
Avg hit ratio: 0.8229612398542789
Avg ndcg: 0.8376102457638941
Avg compression ratio: 1.0
Avg train time: 3.6994638442993164
Std train time: 1.9542357067191582
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 2.9879}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 2.9879}:  10%|█         | 1/10 [00:01<00:13,  1.53s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8611, 'compress@10': 1.0, 'time@10': 2.7464}:  10%|█         | 1/10 [00:04<00:13,  1.53s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8611, 'compress@10': 1.0, 'time@10': 2.7464}:  20%|██        | 2/10 [00:04<00:17,  2.13s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 2.1506}:  20%|██        | 2/10 [00:04<00:17,  2.13s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8576, 'compress@10': 1.0, 'time@10': 2.1506}:  30%|███       | 3/10 [00:04<00:09,  1.39s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0381, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8509, 'compress@10': 1.0, 'time@10': 2.17}:  30%|███       | 3/10 [00:06<00:09,  1.39s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0381, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8509, 'compress@10': 1.0, 'time@10': 2.17}:  40%|████      | 4/10 [00:06<00:10,  1.74s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 3.3897}:  40%|████      | 4/10 [00:11<00:10,  1.74s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 3.3897}:  50%|█████     | 5/10 [00:11<00:13,  2.62s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0499, 'hit_ratio@10': 0.7813, 'ndcg@10': 0.8361, 'compress@10': 1.0, 'time@10': 3.4315}:  50%|█████     | 5/10 [00:14<00:13,  2.62s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0499, 'hit_ratio@10': 0.7813, 'ndcg@10': 0.8361, 'compress@10': 1.0, 'time@10': 3.4315}:  60%|██████    | 6/10 [00:14<00:11,  2.98s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.05, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8359, 'compress@10': 1.0, 'time@10': 3.5098}:  60%|██████    | 6/10 [00:16<00:11,  2.98s/it]  {'epoch': 3, 'num_users': 6.2857, 'loss': 0.05, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.8359, 'compress@10': 1.0, 'time@10': 3.5098}:  70%|███████   | 7/10 [00:16<00:08,  2.67s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8411, 'compress@10': 1.0, 'time@10': 3.4165}:  70%|███████   | 7/10 [00:19<00:08,  2.67s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8239, 'ndcg@10': 0.8411, 'compress@10': 1.0, 'time@10': 3.4165}:  80%|████████  | 8/10 [00:19<00:05,  2.71s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0509, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 3.6679}:  80%|████████  | 8/10 [00:22<00:05,  2.71s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0509, 'hit_ratio@10': 0.8212, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 3.6679}:  90%|█████████ | 9/10 [00:22<00:02,  2.76s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0505, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 3.6551}:  90%|█████████ | 9/10 [00:25<00:02,  2.76s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0505, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 3.6551}: 100%|██████████| 10/10 [00:25<00:00,  3.01s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0505, 'hit_ratio@10': 0.8323, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 3.6551}: 100%|██████████| 10/10 [00:25<00:00,  2.60s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.05054201647100487
Avg hit ratio: 0.8322699956146475
Avg ndcg: 0.8507695098799151
Avg compression ratio: 1.0
Avg train time: 3.6551145553588866
Std train time: 1.9330242519689056
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 2.9862}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 2.9862}:  10%|█         | 1/10 [00:01<00:13,  1.53s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 2.7555}:  10%|█         | 1/10 [00:04<00:13,  1.53s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.048, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 2.7555}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 2.1644}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 2.1644}:  30%|███       | 3/10 [00:04<00:09,  1.40s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8513, 'compress@10': 1.0, 'time@10': 2.1916}:  30%|███       | 3/10 [00:06<00:09,  1.40s/it] {'epoch': 4, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.782, 'ndcg@10': 0.8513, 'compress@10': 1.0, 'time@10': 2.1916}:  40%|████      | 4/10 [00:06<00:10,  1.76s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0446, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8423, 'compress@10': 1.0, 'time@10': 3.3854}:  40%|████      | 4/10 [00:11<00:10,  1.76s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0446, 'hit_ratio@10': 0.7936, 'ndcg@10': 0.8423, 'compress@10': 1.0, 'time@10': 3.3854}:  50%|█████     | 5/10 [00:11<00:13,  2.61s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0481, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.8394, 'compress@10': 1.0, 'time@10': 3.3755}:  50%|█████     | 5/10 [00:14<00:13,  2.61s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0481, 'hit_ratio@10': 0.7947, 'ndcg@10': 0.8394, 'compress@10': 1.0, 'time@10': 3.3755}:  60%|██████    | 6/10 [00:14<00:11,  2.87s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0477, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8438, 'compress@10': 1.0, 'time@10': 3.3991}:  60%|██████    | 6/10 [00:16<00:11,  2.87s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0477, 'hit_ratio@10': 0.8183, 'ndcg@10': 0.8438, 'compress@10': 1.0, 'time@10': 3.3991}:  70%|███████   | 7/10 [00:16<00:07,  2.53s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0488, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8513, 'compress@10': 1.0, 'time@10': 3.3229}:  70%|███████   | 7/10 [00:19<00:07,  2.53s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0488, 'hit_ratio@10': 0.8339, 'ndcg@10': 0.8513, 'compress@10': 1.0, 'time@10': 3.3229}:  80%|████████  | 8/10 [00:19<00:05,  2.62s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0492, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.853, 'compress@10': 1.0, 'time@10': 3.5851}:  80%|████████  | 8/10 [00:21<00:05,  2.62s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0492, 'hit_ratio@10': 0.8206, 'ndcg@10': 0.853, 'compress@10': 1.0, 'time@10': 3.5851}:  90%|█████████ | 9/10 [00:21<00:02,  2.70s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8525, 'compress@10': 1.0, 'time@10': 3.5825}:  90%|█████████ | 9/10 [00:25<00:02,  2.70s/it]  {'epoch': 4, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8525, 'compress@10': 1.0, 'time@10': 3.5825}: 100%|██████████| 10/10 [00:25<00:00,  2.99s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0486, 'hit_ratio@10': 0.8317, 'ndcg@10': 0.8525, 'compress@10': 1.0, 'time@10': 3.5825}: 100%|██████████| 10/10 [00:25<00:00,  2.56s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.04863478900260061
Avg hit ratio: 0.8317144400590921
Avg ndcg: 0.8525251634111468
Avg compression ratio: 1.0
Avg train time: 3.582478904724121
Std train time: 1.8978241788083134
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 3.0254}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0475, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 3.0254}:  10%|█         | 1/10 [00:01<00:13,  1.55s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.798, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 2.7368}:  10%|█         | 1/10 [00:04<00:13,  1.55s/it]  {'epoch': 5, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.798, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 2.7368}:  20%|██        | 2/10 [00:04<00:16,  2.10s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8542, 'compress@10': 1.0, 'time@10': 2.1293}:  20%|██        | 2/10 [00:04<00:16,  2.10s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0317, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8542, 'compress@10': 1.0, 'time@10': 2.1293}:  30%|███       | 3/10 [00:04<00:09,  1.37s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0374, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8465, 'compress@10': 1.0, 'time@10': 2.15}:  30%|███       | 3/10 [00:06<00:09,  1.37s/it]  {'epoch': 5, 'num_users': 5.0, 'loss': 0.0374, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8465, 'compress@10': 1.0, 'time@10': 2.15}:  40%|████      | 4/10 [00:06<00:10,  1.71s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0435, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8396, 'compress@10': 1.0, 'time@10': 3.3834}:  40%|████      | 4/10 [00:10<00:10,  1.71s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0435, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8396, 'compress@10': 1.0, 'time@10': 3.3834}:  50%|█████     | 5/10 [00:10<00:13,  2.61s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0463, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.4316}:  50%|█████     | 5/10 [00:14<00:13,  2.61s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0463, 'hit_ratio@10': 0.8109, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 3.4316}:  60%|██████    | 6/10 [00:14<00:11,  2.98s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0458, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8378, 'compress@10': 1.0, 'time@10': 3.5071}:  60%|██████    | 6/10 [00:16<00:11,  2.98s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0458, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.8378, 'compress@10': 1.0, 'time@10': 3.5071}:  70%|███████   | 7/10 [00:16<00:08,  2.67s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0463, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8387, 'compress@10': 1.0, 'time@10': 3.4107}:  70%|███████   | 7/10 [00:19<00:08,  2.67s/it]  {'epoch': 5, 'num_users': 6.125, 'loss': 0.0463, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8387, 'compress@10': 1.0, 'time@10': 3.4107}:  80%|████████  | 8/10 [00:19<00:05,  2.70s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8622, 'compress@10': 1.0, 'time@10': 3.6719}:  80%|████████  | 8/10 [00:22<00:05,  2.70s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0504, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8622, 'compress@10': 1.0, 'time@10': 3.6719}:  90%|█████████ | 9/10 [00:22<00:02,  2.88s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 3.6634}:  90%|█████████ | 9/10 [00:26<00:02,  2.88s/it]   {'epoch': 5, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 3.6634}: 100%|██████████| 10/10 [00:26<00:00,  3.11s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0497, 'hit_ratio@10': 0.8529, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 3.6634}: 100%|██████████| 10/10 [00:26<00:00,  2.64s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.049700286754275666
Avg hit ratio: 0.8528537129725585
Avg ndcg: 0.8624152252080183
Avg compression ratio: 1.0
Avg train time: 3.663417387008667
Std train time: 1.9637027573971677
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 3.0398}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0457, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 3.0398}:  10%|█         | 1/10 [00:01<00:14,  1.56s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0429, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 2.7591}:  10%|█         | 1/10 [00:04<00:14,  1.56s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0429, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8635, 'compress@10': 1.0, 'time@10': 2.7591}:  20%|██        | 2/10 [00:04<00:16,  2.12s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0296, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8592, 'compress@10': 1.0, 'time@10': 2.134}:  20%|██        | 2/10 [00:04<00:16,  2.12s/it] {'epoch': 6, 'num_users': 5.0, 'loss': 0.0296, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8592, 'compress@10': 1.0, 'time@10': 2.134}:  30%|███       | 3/10 [00:04<00:09,  1.37s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 2.148}:  30%|███       | 3/10 [00:06<00:09,  1.37s/it]  {'epoch': 6, 'num_users': 5.0, 'loss': 0.036, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 2.148}:  40%|████      | 4/10 [00:06<00:10,  1.71s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0414, 'hit_ratio@10': 0.7776, 'ndcg@10': 0.8439, 'compress@10': 1.0, 'time@10': 3.3706}:  40%|████      | 4/10 [00:10<00:10,  1.71s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0414, 'hit_ratio@10': 0.7776, 'ndcg@10': 0.8439, 'compress@10': 1.0, 'time@10': 3.3706}:  50%|█████     | 5/10 [00:10<00:12,  2.60s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0437, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.842, 'compress@10': 1.0, 'time@10': 3.4256}:  50%|█████     | 5/10 [00:14<00:12,  2.60s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0437, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.842, 'compress@10': 1.0, 'time@10': 3.4256}:  60%|██████    | 6/10 [00:14<00:11,  2.99s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0441, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 3.5176}:  60%|██████    | 6/10 [00:16<00:11,  2.99s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0441, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 3.5176}:  70%|███████   | 7/10 [00:16<00:08,  2.69s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0446, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8467, 'compress@10': 1.0, 'time@10': 3.4281}:  70%|███████   | 7/10 [00:19<00:08,  2.69s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0446, 'hit_ratio@10': 0.8314, 'ndcg@10': 0.8467, 'compress@10': 1.0, 'time@10': 3.4281}:  80%|████████  | 8/10 [00:19<00:05,  2.74s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.6948}:  80%|████████  | 8/10 [00:22<00:05,  2.74s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0486, 'hit_ratio@10': 0.8184, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 3.6948}:  90%|█████████ | 9/10 [00:22<00:02,  2.80s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8658, 'compress@10': 1.0, 'time@10': 3.6826}:  90%|█████████ | 9/10 [00:26<00:02,  2.80s/it]   {'epoch': 6, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8658, 'compress@10': 1.0, 'time@10': 3.6826}: 100%|██████████| 10/10 [00:26<00:00,  3.05s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0475, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8658, 'compress@10': 1.0, 'time@10': 3.6826}: 100%|██████████| 10/10 [00:26<00:00,  2.62s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.0474728833785802
Avg hit ratio: 0.8297231446161837
Avg ndcg: 0.8657951476625305
Avg compression ratio: 1.0
Avg train time: 3.6825851440429687
Std train time: 1.9603021144905863
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 3.0625}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 3.0625}:  10%|█         | 1/10 [00:01<00:14,  1.57s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8598, 'compress@10': 1.0, 'time@10': 2.7763}:  10%|█         | 1/10 [00:04<00:14,  1.57s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8598, 'compress@10': 1.0, 'time@10': 2.7763}:  20%|██        | 2/10 [00:04<00:17,  2.13s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 2.177}:  20%|██        | 2/10 [00:04<00:17,  2.13s/it]  {'epoch': 7, 'num_users': 5.0, 'loss': 0.029, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 2.177}:  30%|███       | 3/10 [00:04<00:09,  1.40s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8446, 'compress@10': 1.0, 'time@10': 2.1894}:  30%|███       | 3/10 [00:06<00:09,  1.40s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.757, 'ndcg@10': 0.8446, 'compress@10': 1.0, 'time@10': 2.1894}:  40%|████      | 4/10 [00:06<00:10,  1.74s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0404, 'hit_ratio@10': 0.7776, 'ndcg@10': 0.8391, 'compress@10': 1.0, 'time@10': 3.3525}:  40%|████      | 4/10 [00:10<00:10,  1.74s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0404, 'hit_ratio@10': 0.7776, 'ndcg@10': 0.8391, 'compress@10': 1.0, 'time@10': 3.3525}:  50%|█████     | 5/10 [00:10<00:12,  2.57s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.042, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8386, 'compress@10': 1.0, 'time@10': 3.407}:  50%|█████     | 5/10 [00:14<00:12,  2.57s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.042, 'hit_ratio@10': 0.7961, 'ndcg@10': 0.8386, 'compress@10': 1.0, 'time@10': 3.407}:  60%|██████    | 6/10 [00:14<00:11,  2.96s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.042, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8373, 'compress@10': 1.0, 'time@10': 3.5058}:  60%|██████    | 6/10 [00:16<00:11,  2.96s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.042, 'hit_ratio@10': 0.8195, 'ndcg@10': 0.8373, 'compress@10': 1.0, 'time@10': 3.5058}:  70%|███████   | 7/10 [00:16<00:08,  2.68s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.042, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8393, 'compress@10': 1.0, 'time@10': 3.4145}:  70%|███████   | 7/10 [00:19<00:08,  2.68s/it]  {'epoch': 7, 'num_users': 6.125, 'loss': 0.042, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8393, 'compress@10': 1.0, 'time@10': 3.4145}:  80%|████████  | 8/10 [00:19<00:05,  2.72s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0448, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8406, 'compress@10': 1.0, 'time@10': 3.6777}:  80%|████████  | 8/10 [00:22<00:05,  2.72s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0448, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.8406, 'compress@10': 1.0, 'time@10': 3.6777}:  90%|█████████ | 9/10 [00:22<00:02,  2.79s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0442, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8456, 'compress@10': 1.0, 'time@10': 3.6625}:  90%|█████████ | 9/10 [00:26<00:02,  2.79s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0442, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8456, 'compress@10': 1.0, 'time@10': 3.6625}: 100%|██████████| 10/10 [00:26<00:00,  3.03s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0442, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.8456, 'compress@10': 1.0, 'time@10': 3.6625}: 100%|██████████| 10/10 [00:26<00:00,  2.61s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04419875854370307
Avg hit ratio: 0.8428400277330669
Avg ndcg: 0.8455517475260722
Avg compression ratio: 1.0
Avg train time: 3.6625192642211912
Std train time: 1.8802700532850594
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0536, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8438, 'compress@10': 1.0, 'time@10': 3.1419}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0536, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8438, 'compress@10': 1.0, 'time@10': 3.1419}:  10%|█         | 1/10 [00:01<00:14,  1.61s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8579, 'compress@10': 1.0, 'time@10': 2.7919}:  10%|█         | 1/10 [00:04<00:14,  1.61s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8579, 'compress@10': 1.0, 'time@10': 2.7919}:  20%|██        | 2/10 [00:04<00:16,  2.12s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8555, 'compress@10': 1.0, 'time@10': 2.1652}:  20%|██        | 2/10 [00:04<00:16,  2.12s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0308, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8555, 'compress@10': 1.0, 'time@10': 2.1652}:  30%|███       | 3/10 [00:04<00:09,  1.38s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8387, 'compress@10': 1.0, 'time@10': 2.1822}:  30%|███       | 3/10 [00:06<00:09,  1.38s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0366, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8387, 'compress@10': 1.0, 'time@10': 2.1822}:  40%|████      | 4/10 [00:06<00:10,  1.73s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0398, 'hit_ratio@10': 0.7945, 'ndcg@10': 0.8372, 'compress@10': 1.0, 'time@10': 3.3379}:  40%|████      | 4/10 [00:10<00:10,  1.73s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0398, 'hit_ratio@10': 0.7945, 'ndcg@10': 0.8372, 'compress@10': 1.0, 'time@10': 3.3379}:  50%|█████     | 5/10 [00:10<00:12,  2.55s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0405, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.8391, 'compress@10': 1.0, 'time@10': 3.4051}:  50%|█████     | 5/10 [00:14<00:12,  2.55s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0405, 'hit_ratio@10': 0.8102, 'ndcg@10': 0.8391, 'compress@10': 1.0, 'time@10': 3.4051}:  60%|██████    | 6/10 [00:14<00:11,  2.97s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0408, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8476, 'compress@10': 1.0, 'time@10': 3.4878}:  60%|██████    | 6/10 [00:16<00:11,  2.97s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0408, 'hit_ratio@10': 0.8259, 'ndcg@10': 0.8476, 'compress@10': 1.0, 'time@10': 3.4878}:  70%|███████   | 7/10 [00:16<00:07,  2.66s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0394, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 3.4038}:  70%|███████   | 7/10 [00:19<00:07,  2.66s/it]  {'epoch': 8, 'num_users': 6.125, 'loss': 0.0394, 'hit_ratio@10': 0.8405, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 3.4038}:  80%|████████  | 8/10 [00:19<00:05,  2.72s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0392, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8592, 'compress@10': 1.0, 'time@10': 3.6378}:  80%|████████  | 8/10 [00:22<00:05,  2.72s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0392, 'hit_ratio@10': 0.8297, 'ndcg@10': 0.8592, 'compress@10': 1.0, 'time@10': 3.6378}:  90%|█████████ | 9/10 [00:22<00:02,  2.74s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0386, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 3.5999}:  90%|█████████ | 9/10 [00:25<00:02,  2.74s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0386, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 3.5999}: 100%|██████████| 10/10 [00:25<00:00,  2.92s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0386, 'hit_ratio@10': 0.8422, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 3.5999}: 100%|██████████| 10/10 [00:25<00:00,  2.56s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.038611479412068835
Avg hit ratio: 0.8421617705064225
Avg ndcg: 0.8603837042580658
Avg compression ratio: 1.0
Avg train time: 3.5999340295791624
Std train time: 1.8495967650298386
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 2.7749}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0439, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 2.7749}:  10%|█         | 1/10 [00:01<00:12,  1.42s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8668, 'compress@10': 1.0, 'time@10': 2.5436}:  10%|█         | 1/10 [00:03<00:12,  1.42s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0396, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8668, 'compress@10': 1.0, 'time@10': 2.5436}:  20%|██        | 2/10 [00:03<00:15,  1.97s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8614, 'compress@10': 1.0, 'time@10': 1.9895}:  20%|██        | 2/10 [00:04<00:15,  1.97s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8614, 'compress@10': 1.0, 'time@10': 1.9895}:  30%|███       | 3/10 [00:04<00:09,  1.29s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 2.0334}:  30%|███       | 3/10 [00:06<00:09,  1.29s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8524, 'compress@10': 1.0, 'time@10': 2.0334}:  40%|████      | 4/10 [00:06<00:09,  1.65s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0359, 'hit_ratio@10': 0.7985, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 3.3039}:  40%|████      | 4/10 [00:10<00:09,  1.65s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0359, 'hit_ratio@10': 0.7985, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 3.3039}:  50%|█████     | 5/10 [00:10<00:12,  2.58s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0365, 'hit_ratio@10': 0.8136, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 3.3437}:  50%|█████     | 5/10 [00:14<00:12,  2.58s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0365, 'hit_ratio@10': 0.8136, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 3.3437}:  60%|██████    | 6/10 [00:14<00:11,  2.92s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0362, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 3.4359}:  60%|██████    | 6/10 [00:16<00:11,  2.92s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0362, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 3.4359}:  70%|███████   | 7/10 [00:16<00:07,  2.63s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0355, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8603, 'compress@10': 1.0, 'time@10': 3.3588}:  70%|███████   | 7/10 [00:19<00:07,  2.63s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.0355, 'hit_ratio@10': 0.848, 'ndcg@10': 0.8603, 'compress@10': 1.0, 'time@10': 3.3588}:  80%|████████  | 8/10 [00:19<00:05,  2.70s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0345, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.5948}:  80%|████████  | 8/10 [00:21<00:05,  2.70s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0345, 'hit_ratio@10': 0.8395, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.5948}:  90%|█████████ | 9/10 [00:21<00:02,  2.73s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0339, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8717, 'compress@10': 1.0, 'time@10': 3.5915}:  90%|█████████ | 9/10 [00:25<00:02,  2.73s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0339, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8717, 'compress@10': 1.0, 'time@10': 3.5915}: 100%|██████████| 10/10 [00:25<00:00,  2.99s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0339, 'hit_ratio@10': 0.8533, 'ndcg@10': 0.8717, 'compress@10': 1.0, 'time@10': 3.5915}: 100%|██████████| 10/10 [00:25<00:00,  2.55s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.03388425947724457
Avg hit ratio: 0.8532916406362926
Avg ndcg: 0.8717071226210725
Avg compression ratio: 1.0
Avg train time: 3.5914868354797362
Std train time: 1.9751004040111788
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 3.0006}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0481, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8551, 'compress@10': 1.0, 'time@10': 3.0006}:  10%|█         | 1/10 [00:01<00:14,  1.56s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 2.7528}:  10%|█         | 1/10 [00:04<00:14,  1.56s/it]  {'epoch': 10, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 2.7528}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8636, 'compress@10': 1.0, 'time@10': 2.1743}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0283, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8636, 'compress@10': 1.0, 'time@10': 2.1743}:  30%|███       | 3/10 [00:04<00:09,  1.41s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 2.1953}:  30%|███       | 3/10 [00:06<00:09,  1.41s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0331, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8489, 'compress@10': 1.0, 'time@10': 2.1953}:  40%|████      | 4/10 [00:06<00:10,  1.76s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0353, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8539, 'compress@10': 1.0, 'time@10': 3.4089}:  40%|████      | 4/10 [00:11<00:10,  1.76s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0353, 'hit_ratio@10': 0.8382, 'ndcg@10': 0.8539, 'compress@10': 1.0, 'time@10': 3.4089}:  50%|█████     | 5/10 [00:11<00:13,  2.63s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0348, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.857, 'compress@10': 1.0, 'time@10': 3.4532}:  50%|█████     | 5/10 [00:14<00:13,  2.63s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.0348, 'hit_ratio@10': 0.8467, 'ndcg@10': 0.857, 'compress@10': 1.0, 'time@10': 3.4532}:  60%|██████    | 6/10 [00:14<00:11,  3.00s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0348, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8644, 'compress@10': 1.0, 'time@10': 3.4961}:  60%|██████    | 6/10 [00:16<00:11,  3.00s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0348, 'hit_ratio@10': 0.8571, 'ndcg@10': 0.8644, 'compress@10': 1.0, 'time@10': 3.4961}:  70%|███████   | 7/10 [00:16<00:07,  2.64s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.034, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8682, 'compress@10': 1.0, 'time@10': 3.4145}:  70%|███████   | 7/10 [00:19<00:07,  2.64s/it]  {'epoch': 10, 'num_users': 6.125, 'loss': 0.034, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8682, 'compress@10': 1.0, 'time@10': 3.4145}:  80%|████████  | 8/10 [00:19<00:05,  2.72s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0335, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8765, 'compress@10': 1.0, 'time@10': 3.6806}:  80%|████████  | 8/10 [00:22<00:05,  2.72s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0335, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8765, 'compress@10': 1.0, 'time@10': 3.6806}:  90%|█████████ | 9/10 [00:22<00:02,  2.79s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0337, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8761, 'compress@10': 1.0, 'time@10': 3.6692}:  90%|█████████ | 9/10 [00:26<00:02,  2.79s/it]  {'epoch': 10, 'num_users': 6.3, 'loss': 0.0337, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8761, 'compress@10': 1.0, 'time@10': 3.6692}: 100%|██████████| 10/10 [00:26<00:00,  3.04s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0337, 'hit_ratio@10': 0.8663, 'ndcg@10': 0.8761, 'compress@10': 1.0, 'time@10': 3.6692}: 100%|██████████| 10/10 [00:26<00:00,  2.62s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.03370749442270972
Avg hit ratio: 0.8662916406362926
Avg ndcg: 0.8760664074708728
Avg compression ratio: 1.0
Avg train time: 3.6692264795303347
Std train time: 1.9289730407638501
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 3.0069}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0411, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8685, 'compress@10': 1.0, 'time@10': 3.0069}:  10%|█         | 1/10 [00:01<00:13,  1.54s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 2.7399}:  10%|█         | 1/10 [00:04<00:13,  1.54s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0365, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8817, 'compress@10': 1.0, 'time@10': 2.7399}:  20%|██        | 2/10 [00:04<00:16,  2.11s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 2.1501}:  20%|██        | 2/10 [00:04<00:16,  2.11s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0263, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 2.1501}:  30%|███       | 3/10 [00:04<00:09,  1.39s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8566, 'compress@10': 1.0, 'time@10': 2.1803}:  30%|███       | 3/10 [00:06<00:09,  1.39s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0315, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8566, 'compress@10': 1.0, 'time@10': 2.1803}:  40%|████      | 4/10 [00:06<00:10,  1.75s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0331, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8597, 'compress@10': 1.0, 'time@10': 3.3933}:  40%|████      | 4/10 [00:11<00:10,  1.75s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0331, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8597, 'compress@10': 1.0, 'time@10': 3.3933}:  50%|█████     | 5/10 [00:11<00:13,  2.62s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0332, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8636, 'compress@10': 1.0, 'time@10': 3.4465}:  50%|█████     | 5/10 [00:14<00:13,  2.62s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0332, 'hit_ratio@10': 0.8518, 'ndcg@10': 0.8636, 'compress@10': 1.0, 'time@10': 3.4465}:  60%|██████    | 6/10 [00:14<00:12,  3.01s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0342, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 3.5157}:  60%|██████    | 6/10 [00:16<00:12,  3.01s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0342, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8683, 'compress@10': 1.0, 'time@10': 3.5157}:  70%|███████   | 7/10 [00:16<00:08,  2.68s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0334, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.8736, 'compress@10': 1.0, 'time@10': 3.4263}:  70%|███████   | 7/10 [00:19<00:08,  2.68s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0334, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.8736, 'compress@10': 1.0, 'time@10': 3.4263}:  80%|████████  | 8/10 [00:19<00:05,  2.73s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8798, 'compress@10': 1.0, 'time@10': 3.6442}:  80%|████████  | 8/10 [00:22<00:05,  2.73s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.032, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8798, 'compress@10': 1.0, 'time@10': 3.6442}:  90%|█████████ | 9/10 [00:22<00:02,  2.73s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8837, 'compress@10': 1.0, 'time@10': 3.6415}:  90%|█████████ | 9/10 [00:26<00:02,  2.73s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8837, 'compress@10': 1.0, 'time@10': 3.6415}: 100%|██████████| 10/10 [00:26<00:00,  3.02s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0316, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8837, 'compress@10': 1.0, 'time@10': 3.6415}: 100%|██████████| 10/10 [00:26<00:00,  2.60s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.031586894385859786
Avg hit ratio: 0.8653998657445177
Avg ndcg: 0.8836825187525473
Avg compression ratio: 1.0
Avg train time: 3.6414796829223635
Std train time: 1.8927441702668721
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8741, 'compress@10': 1.0, 'time@10': 3.0139}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8741, 'compress@10': 1.0, 'time@10': 3.0139}:  10%|█         | 1/10 [00:01<00:13,  1.54s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 2.7574}:  10%|█         | 1/10 [00:04<00:13,  1.54s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0358, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 2.7574}:  20%|██        | 2/10 [00:04<00:17,  2.13s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.874, 'compress@10': 1.0, 'time@10': 2.1641}:  20%|██        | 2/10 [00:04<00:17,  2.13s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0261, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.874, 'compress@10': 1.0, 'time@10': 2.1641}:  30%|███       | 3/10 [00:04<00:09,  1.40s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 2.1757}:  30%|███       | 3/10 [00:06<00:09,  1.40s/it]   {'epoch': 12, 'num_users': 5.0, 'loss': 0.03, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 2.1757}:  40%|████      | 4/10 [00:06<00:10,  1.73s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0318, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 3.3916}:  40%|████      | 4/10 [00:11<00:10,  1.73s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0318, 'hit_ratio@10': 0.8494, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 3.3916}:  50%|█████     | 5/10 [00:11<00:13,  2.61s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0351, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 3.4464}:  50%|█████     | 5/10 [00:14<00:13,  2.61s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0351, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.863, 'compress@10': 1.0, 'time@10': 3.4464}:  60%|██████    | 6/10 [00:14<00:11,  3.00s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0353, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 3.5266}:  60%|██████    | 6/10 [00:16<00:11,  3.00s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0353, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 3.5266}:  70%|███████   | 7/10 [00:16<00:08,  2.69s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0338, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8697, 'compress@10': 1.0, 'time@10': 3.4362}:  70%|███████   | 7/10 [00:19<00:08,  2.69s/it] {'epoch': 12, 'num_users': 6.125, 'loss': 0.0338, 'hit_ratio@10': 0.8854, 'ndcg@10': 0.8697, 'compress@10': 1.0, 'time@10': 3.4362}:  80%|████████  | 8/10 [00:19<00:05,  2.74s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.6513}:  80%|████████  | 8/10 [00:22<00:05,  2.74s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0321, 'hit_ratio@10': 0.8632, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 3.6513}:  90%|█████████ | 9/10 [00:22<00:02,  2.73s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8774, 'compress@10': 1.0, 'time@10': 3.6202}:  90%|█████████ | 9/10 [00:25<00:02,  2.73s/it]   {'epoch': 12, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8774, 'compress@10': 1.0, 'time@10': 3.6202}: 100%|██████████| 10/10 [00:25<00:00,  2.93s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0325, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.8774, 'compress@10': 1.0, 'time@10': 3.6202}: 100%|██████████| 10/10 [00:25<00:00,  2.58s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03253537817730217
Avg hit ratio: 0.8723205006651525
Avg ndcg: 0.8773613808933345
Avg compression ratio: 1.0
Avg train time: 3.6202022790908814
Std train time: 1.8986645350581954
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 2.8951}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0333, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8821, 'compress@10': 1.0, 'time@10': 2.8951}:  10%|█         | 1/10 [00:01<00:13,  1.48s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 2.5923}:  10%|█         | 1/10 [00:03<00:13,  1.48s/it] {'epoch': 13, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 2.5923}:  20%|██        | 2/10 [00:03<00:15,  1.98s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8803, 'compress@10': 1.0, 'time@10': 2.0212}:  20%|██        | 2/10 [00:04<00:15,  1.98s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.023, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8803, 'compress@10': 1.0, 'time@10': 2.0212}:  30%|███       | 3/10 [00:04<00:09,  1.29s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 2.0304}:  30%|███       | 3/10 [00:06<00:09,  1.29s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0266, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8753, 'compress@10': 1.0, 'time@10': 2.0304}:  40%|████      | 4/10 [00:06<00:09,  1.61s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.2832}:  40%|████      | 4/10 [00:10<00:09,  1.61s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0294, 'hit_ratio@10': 0.8599, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 3.2832}:  50%|█████     | 5/10 [00:10<00:12,  2.54s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.03, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8829, 'compress@10': 1.0, 'time@10': 3.3632}:  50%|█████     | 5/10 [00:14<00:12,  2.54s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.03, 'hit_ratio@10': 0.8758, 'ndcg@10': 0.8829, 'compress@10': 1.0, 'time@10': 3.3632}:  60%|██████    | 6/10 [00:14<00:11,  2.97s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0302, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.8855, 'compress@10': 1.0, 'time@10': 3.4746}:  60%|██████    | 6/10 [00:16<00:11,  2.97s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0302, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.8855, 'compress@10': 1.0, 'time@10': 3.4746}:  70%|███████   | 7/10 [00:16<00:08,  2.69s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0295, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.3826}:  70%|███████   | 7/10 [00:19<00:08,  2.69s/it]  {'epoch': 13, 'num_users': 6.125, 'loss': 0.0295, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.889, 'compress@10': 1.0, 'time@10': 3.3826}:  80%|████████  | 8/10 [00:19<00:05,  2.72s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0287, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.579}:  80%|████████  | 8/10 [00:21<00:05,  2.72s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0287, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 3.579}:  90%|█████████ | 9/10 [00:21<00:02,  2.68s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8984, 'compress@10': 1.0, 'time@10': 3.5682}:  90%|█████████ | 9/10 [00:25<00:02,  2.68s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8984, 'compress@10': 1.0, 'time@10': 3.5682}: 100%|██████████| 10/10 [00:25<00:00,  2.94s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8984, 'compress@10': 1.0, 'time@10': 3.5682}: 100%|██████████| 10/10 [00:25<00:00,  2.54s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.028013806022521598
Avg hit ratio: 0.8849357509119817
Avg ndcg: 0.898419153680484
Avg compression ratio: 1.0
Avg train time: 3.568153429031372
Std train time: 1.9365015603325095
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0326, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8839, 'compress@10': 1.0, 'time@10': 2.984}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0326, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8839, 'compress@10': 1.0, 'time@10': 2.984}:  10%|█         | 1/10 [00:01<00:13,  1.53s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8895, 'compress@10': 1.0, 'time@10': 2.7604}:  10%|█         | 1/10 [00:04<00:13,  1.53s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0316, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8895, 'compress@10': 1.0, 'time@10': 2.7604}:  20%|██        | 2/10 [00:04<00:17,  2.15s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 2.1897}:  20%|██        | 2/10 [00:04<00:17,  2.15s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8766, 'compress@10': 1.0, 'time@10': 2.1897}:  30%|███       | 3/10 [00:04<00:09,  1.43s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 2.1964}:  30%|███       | 3/10 [00:06<00:09,  1.43s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8659, 'compress@10': 1.0, 'time@10': 2.1964}:  40%|████      | 4/10 [00:06<00:10,  1.75s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 3.4559}:  40%|████      | 4/10 [00:11<00:10,  1.75s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0282, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8773, 'compress@10': 1.0, 'time@10': 3.4559}:  50%|█████     | 5/10 [00:11<00:13,  2.67s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0299, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.885, 'compress@10': 1.0, 'time@10': 3.5003}:  50%|█████     | 5/10 [00:14<00:13,  2.67s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0299, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.885, 'compress@10': 1.0, 'time@10': 3.5003}:  60%|██████    | 6/10 [00:14<00:12,  3.04s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0309, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.8863, 'compress@10': 1.0, 'time@10': 3.5728}:  60%|██████    | 6/10 [00:17<00:12,  3.04s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0309, 'hit_ratio@10': 0.8875, 'ndcg@10': 0.8863, 'compress@10': 1.0, 'time@10': 3.5728}:  70%|███████   | 7/10 [00:17<00:08,  2.71s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0298, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 3.4731}:  70%|███████   | 7/10 [00:19<00:08,  2.71s/it] {'epoch': 14, 'num_users': 6.125, 'loss': 0.0298, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 3.4731}:  80%|████████  | 8/10 [00:19<00:05,  2.74s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.884, 'ndcg@10': 0.8991, 'compress@10': 1.0, 'time@10': 3.7256}:  80%|████████  | 8/10 [00:22<00:05,  2.74s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0289, 'hit_ratio@10': 0.884, 'ndcg@10': 0.8991, 'compress@10': 1.0, 'time@10': 3.7256}:  90%|█████████ | 9/10 [00:22<00:02,  2.80s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.7065}:  90%|█████████ | 9/10 [00:26<00:02,  2.80s/it]  {'epoch': 14, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.7065}: 100%|██████████| 10/10 [00:26<00:00,  3.04s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0297, 'hit_ratio@10': 0.8933, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.7065}: 100%|██████████| 10/10 [00:26<00:00,  2.63s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.029685596624244893
Avg hit ratio: 0.8932849572611883
Avg ndcg: 0.8971384031897104
Avg compression ratio: 1.0
Avg train time: 3.706516218185425
Std train time: 1.9809282006771176
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.886, 'compress@10': 1.0, 'time@10': 2.9244}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0296, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.886, 'compress@10': 1.0, 'time@10': 2.9244}:  10%|█         | 1/10 [00:01<00:13,  1.50s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9063, 'compress@10': 1.0, 'time@10': 2.7041}:  10%|█         | 1/10 [00:04<00:13,  1.50s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9063, 'compress@10': 1.0, 'time@10': 2.7041}:  20%|██        | 2/10 [00:04<00:16,  2.10s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 2.1243}:  20%|██        | 2/10 [00:04<00:16,  2.10s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0215, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8877, 'compress@10': 1.0, 'time@10': 2.1243}:  30%|███       | 3/10 [00:04<00:09,  1.38s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8805, 'compress@10': 1.0, 'time@10': 2.1715}:  30%|███       | 3/10 [00:06<00:09,  1.38s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8805, 'compress@10': 1.0, 'time@10': 2.1715}:  40%|████      | 4/10 [00:06<00:10,  1.76s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8879, 'compress@10': 1.0, 'time@10': 3.421}:  40%|████      | 4/10 [00:11<00:10,  1.76s/it] {'epoch': 15, 'num_users': 5.8, 'loss': 0.0259, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8879, 'compress@10': 1.0, 'time@10': 3.421}:  50%|█████     | 5/10 [00:11<00:13,  2.66s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8972, 'compress@10': 1.0, 'time@10': 3.468}:  50%|█████     | 5/10 [00:14<00:13,  2.66s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8972, 'compress@10': 1.0, 'time@10': 3.468}:  60%|██████    | 6/10 [00:14<00:12,  3.03s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0283, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.5397}:  60%|██████    | 6/10 [00:16<00:12,  3.03s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0283, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8971, 'compress@10': 1.0, 'time@10': 3.5397}:  70%|███████   | 7/10 [00:16<00:08,  2.70s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.4505}:  70%|███████   | 7/10 [00:19<00:08,  2.70s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0278, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 3.4505}:  80%|████████  | 8/10 [00:19<00:05,  2.75s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0275, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 3.7004}:  80%|████████  | 8/10 [00:22<00:05,  2.75s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0275, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 3.7004}:  90%|█████████ | 9/10 [00:22<00:02,  2.79s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9086, 'compress@10': 1.0, 'time@10': 3.6859}:  90%|█████████ | 9/10 [00:26<00:02,  2.79s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9086, 'compress@10': 1.0, 'time@10': 3.6859}: 100%|██████████| 10/10 [00:26<00:00,  3.11s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0281, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9086, 'compress@10': 1.0, 'time@10': 3.6859}: 100%|██████████| 10/10 [00:26<00:00,  2.65s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.028132514075780556
Avg hit ratio: 0.8932344522106831
Avg ndcg: 0.9086333104571054
Avg compression ratio: 1.0
Avg train time: 3.6859017610549927
Std train time: 1.9648980834537662
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.893, 'compress@10': 1.0, 'time@10': 3.2889}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.893, 'compress@10': 1.0, 'time@10': 3.2889}:  10%|█         | 1/10 [00:01<00:15,  1.68s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.909, 'compress@10': 1.0, 'time@10': 2.8608}:  10%|█         | 1/10 [00:04<00:15,  1.68s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0261, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.909, 'compress@10': 1.0, 'time@10': 2.8608}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8895, 'compress@10': 1.0, 'time@10': 2.203}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8895, 'compress@10': 1.0, 'time@10': 2.203}:  30%|███       | 3/10 [00:04<00:09,  1.38s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 2.201}:  30%|███       | 3/10 [00:06<00:09,  1.38s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0223, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 2.201}:  40%|████      | 4/10 [00:06<00:10,  1.72s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0245, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 3.4097}:  40%|████      | 4/10 [00:11<00:10,  1.72s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0245, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8937, 'compress@10': 1.0, 'time@10': 3.4097}:  50%|█████     | 5/10 [00:11<00:12,  2.60s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0252, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.4531}:  50%|█████     | 5/10 [00:14<00:12,  2.60s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0252, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.8982, 'compress@10': 1.0, 'time@10': 3.4531}:  60%|██████    | 6/10 [00:14<00:11,  2.98s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0259, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.5304}:  60%|██████    | 6/10 [00:16<00:11,  2.98s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0259, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.8998, 'compress@10': 1.0, 'time@10': 3.5304}:  70%|███████   | 7/10 [00:16<00:08,  2.67s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0259, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 3.4412}:  70%|███████   | 7/10 [00:19<00:08,  2.67s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0259, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9005, 'compress@10': 1.0, 'time@10': 3.4412}:  80%|████████  | 8/10 [00:19<00:05,  2.73s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9245, 'compress@10': 1.0, 'time@10': 3.6829}:  80%|████████  | 8/10 [00:22<00:05,  2.73s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0288, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9245, 'compress@10': 1.0, 'time@10': 3.6829}:  90%|█████████ | 9/10 [00:22<00:02,  2.77s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0274, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.927, 'compress@10': 1.0, 'time@10': 3.6611}:  90%|█████████ | 9/10 [00:25<00:02,  2.77s/it]    {'epoch': 16, 'num_users': 6.3, 'loss': 0.0274, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.927, 'compress@10': 1.0, 'time@10': 3.6611}: 100%|██████████| 10/10 [00:25<00:00,  3.00s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0274, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.927, 'compress@10': 1.0, 'time@10': 3.6611}: 100%|██████████| 10/10 [00:25<00:00,  2.60s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.027407884516451854
Avg hit ratio: 0.886935750911982
Avg ndcg: 0.9269887242362979
Avg compression ratio: 1.0
Avg train time: 3.661091423034668
Std train time: 1.9282777394923538
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8953, 'compress@10': 1.0, 'time@10': 3.0166}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0271, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8953, 'compress@10': 1.0, 'time@10': 3.0166}:  10%|█         | 1/10 [00:01<00:13,  1.55s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9127, 'compress@10': 1.0, 'time@10': 2.7378}:  10%|█         | 1/10 [00:04<00:13,  1.55s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.9127, 'compress@10': 1.0, 'time@10': 2.7378}:  20%|██        | 2/10 [00:04<00:16,  2.10s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.892, 'compress@10': 1.0, 'time@10': 2.1203}:  20%|██        | 2/10 [00:04<00:16,  2.10s/it] {'epoch': 17, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.892, 'compress@10': 1.0, 'time@10': 2.1203}:  30%|███       | 3/10 [00:04<00:09,  1.36s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 2.0939}:  30%|███       | 3/10 [00:06<00:09,  1.36s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8903, 'compress@10': 1.0, 'time@10': 2.0939}:  40%|████      | 4/10 [00:06<00:09,  1.63s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 3.2181}:  40%|████      | 4/10 [00:10<00:09,  1.63s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0216, 'hit_ratio@10': 0.8567, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 3.2181}:  50%|█████     | 5/10 [00:10<00:12,  2.45s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0236, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9034, 'compress@10': 1.0, 'time@10': 3.2761}:  50%|█████     | 5/10 [00:14<00:12,  2.45s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0236, 'hit_ratio@10': 0.8732, 'ndcg@10': 0.9034, 'compress@10': 1.0, 'time@10': 3.2761}:  60%|██████    | 6/10 [00:14<00:11,  2.84s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0245, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 3.3872}:  60%|██████    | 6/10 [00:16<00:11,  2.84s/it] {'epoch': 17, 'num_users': 6.2857, 'loss': 0.0245, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 3.3872}:  70%|███████   | 7/10 [00:16<00:07,  2.59s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0237, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 3.314}:  70%|███████   | 7/10 [00:18<00:07,  2.59s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0237, 'hit_ratio@10': 0.8963, 'ndcg@10': 0.9061, 'compress@10': 1.0, 'time@10': 3.314}:  80%|████████  | 8/10 [00:18<00:05,  2.67s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 3.5996}:  80%|████████  | 8/10 [00:21<00:05,  2.67s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0302, 'hit_ratio@10': 0.8793, 'ndcg@10': 0.8988, 'compress@10': 1.0, 'time@10': 3.5996}:  90%|█████████ | 9/10 [00:21<00:02,  2.76s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0311, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.5968}:  90%|█████████ | 9/10 [00:25<00:02,  2.76s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0311, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.5968}: 100%|██████████| 10/10 [00:25<00:00,  3.03s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0311, 'hit_ratio@10': 0.8891, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 3.5968}: 100%|██████████| 10/10 [00:25<00:00,  2.56s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.031135149283848067
Avg hit ratio: 0.889078608054839
Avg ndcg: 0.8966977530746976
Avg compression ratio: 1.0
Avg train time: 3.59681613445282
Std train time: 1.8579807660260053
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8953, 'compress@10': 1.0, 'time@10': 2.9888}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0266, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8953, 'compress@10': 1.0, 'time@10': 2.9888}:  10%|█         | 1/10 [00:01<00:13,  1.53s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9124, 'compress@10': 1.0, 'time@10': 2.7367}:  10%|█         | 1/10 [00:04<00:13,  1.53s/it] {'epoch': 18, 'num_users': 7.0, 'loss': 0.025, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9124, 'compress@10': 1.0, 'time@10': 2.7367}:  20%|██        | 2/10 [00:04<00:16,  2.11s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 2.1461}:  20%|██        | 2/10 [00:04<00:16,  2.11s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0183, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 2.1461}:  30%|███       | 3/10 [00:04<00:09,  1.38s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 2.1311}:  30%|███       | 3/10 [00:06<00:09,  1.38s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 2.1311}:  40%|████      | 4/10 [00:06<00:10,  1.68s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0233, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 3.2278}:  40%|████      | 4/10 [00:10<00:10,  1.68s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0233, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.8981, 'compress@10': 1.0, 'time@10': 3.2278}:  50%|█████     | 5/10 [00:10<00:12,  2.46s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0247, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9063, 'compress@10': 1.0, 'time@10': 3.2867}:  50%|█████     | 5/10 [00:14<00:12,  2.46s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0247, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9063, 'compress@10': 1.0, 'time@10': 3.2867}:  60%|██████    | 6/10 [00:14<00:11,  2.85s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9089, 'compress@10': 1.0, 'time@10': 3.4058}:  60%|██████    | 6/10 [00:16<00:11,  2.85s/it] {'epoch': 18, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9089, 'compress@10': 1.0, 'time@10': 3.4058}:  70%|███████   | 7/10 [00:16<00:07,  2.61s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0238, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9075, 'compress@10': 1.0, 'time@10': 3.3373}:  70%|███████   | 7/10 [00:19<00:07,  2.61s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0238, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9075, 'compress@10': 1.0, 'time@10': 3.3373}:  80%|████████  | 8/10 [00:19<00:05,  2.70s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9142, 'compress@10': 1.0, 'time@10': 3.5952}:  80%|████████  | 8/10 [00:22<00:05,  2.70s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0237, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9142, 'compress@10': 1.0, 'time@10': 3.5952}:  90%|█████████ | 9/10 [00:22<00:02,  2.75s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 3.5913}:  90%|█████████ | 9/10 [00:25<00:02,  2.75s/it]   {'epoch': 18, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 3.5913}: 100%|██████████| 10/10 [00:25<00:00,  3.01s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0232, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 3.5913}: 100%|██████████| 10/10 [00:25<00:00,  2.56s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.02318874027047397
Avg hit ratio: 0.8915670873175117
Avg ndcg: 0.9179911804182586
Avg compression ratio: 1.0
Avg train time: 3.5913475513458253
Std train time: 1.7896910878056538
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8927, 'compress@10': 1.0, 'time@10': 3.103}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0235, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8927, 'compress@10': 1.0, 'time@10': 3.103}:  10%|█         | 1/10 [00:01<00:14,  1.59s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.92, 'compress@10': 1.0, 'time@10': 2.8293}:  10%|█         | 1/10 [00:04<00:14,  1.59s/it] {'epoch': 19, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.92, 'compress@10': 1.0, 'time@10': 2.8293}:  20%|██        | 2/10 [00:04<00:17,  2.18s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 2.2028}:  20%|██        | 2/10 [00:04<00:17,  2.18s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8969, 'compress@10': 1.0, 'time@10': 2.2028}:  30%|███       | 3/10 [00:04<00:09,  1.42s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 2.2151}:  30%|███       | 3/10 [00:06<00:09,  1.42s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0186, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 2.2151}:  40%|████      | 4/10 [00:06<00:10,  1.76s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.9071, 'compress@10': 1.0, 'time@10': 3.4702}:  40%|████      | 4/10 [00:11<00:10,  1.76s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8503, 'ndcg@10': 0.9071, 'compress@10': 1.0, 'time@10': 3.4702}:  50%|█████     | 5/10 [00:11<00:13,  2.67s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9131, 'compress@10': 1.0, 'time@10': 3.4975}:  50%|█████     | 5/10 [00:14<00:13,  2.67s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0207, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9131, 'compress@10': 1.0, 'time@10': 3.4975}:  60%|██████    | 6/10 [00:14<00:12,  3.01s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0232, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9137, 'compress@10': 1.0, 'time@10': 3.5685}:  60%|██████    | 6/10 [00:16<00:12,  3.01s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0232, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9137, 'compress@10': 1.0, 'time@10': 3.5685}:  70%|███████   | 7/10 [00:16<00:08,  2.69s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0238, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9102, 'compress@10': 1.0, 'time@10': 3.4807}:  70%|███████   | 7/10 [00:19<00:08,  2.69s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0238, 'hit_ratio@10': 0.8923, 'ndcg@10': 0.9102, 'compress@10': 1.0, 'time@10': 3.4807}:  80%|████████  | 8/10 [00:19<00:05,  2.76s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9038, 'compress@10': 1.0, 'time@10': 3.7365}:  80%|████████  | 8/10 [00:22<00:05,  2.76s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0262, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.9038, 'compress@10': 1.0, 'time@10': 3.7365}:  90%|█████████ | 9/10 [00:22<00:02,  2.81s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0265, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9088, 'compress@10': 1.0, 'time@10': 3.7179}:  90%|█████████ | 9/10 [00:26<00:02,  2.81s/it]   {'epoch': 19, 'num_users': 6.3, 'loss': 0.0265, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9088, 'compress@10': 1.0, 'time@10': 3.7179}: 100%|██████████| 10/10 [00:26<00:00,  3.05s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0265, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9088, 'compress@10': 1.0, 'time@10': 3.7179}: 100%|██████████| 10/10 [00:26<00:00,  2.64s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.026452026131190666
Avg hit ratio: 0.8887099444603688
Avg ndcg: 0.9087746437878991
Avg compression ratio: 1.0
Avg train time: 3.7179245710372926
Std train time: 1.98550406893206
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.0008}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0242, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8964, 'compress@10': 1.0, 'time@10': 3.0008}:  10%|█         | 1/10 [00:01<00:13,  1.54s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9226, 'compress@10': 1.0, 'time@10': 2.7688}:  10%|█         | 1/10 [00:04<00:13,  1.54s/it] {'epoch': 20, 'num_users': 7.0, 'loss': 0.022, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9226, 'compress@10': 1.0, 'time@10': 2.7688}:  20%|██        | 2/10 [00:04<00:17,  2.15s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.1628}:  20%|██        | 2/10 [00:04<00:17,  2.15s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.1628}:  30%|███       | 3/10 [00:04<00:09,  1.40s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.1693}:  30%|███       | 3/10 [00:06<00:09,  1.40s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.1693}:  40%|████      | 4/10 [00:06<00:10,  1.73s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0203, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.9178, 'compress@10': 1.0, 'time@10': 3.4067}:  40%|████      | 4/10 [00:11<00:10,  1.73s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0203, 'hit_ratio@10': 0.8431, 'ndcg@10': 0.9178, 'compress@10': 1.0, 'time@10': 3.4067}:  50%|█████     | 5/10 [00:11<00:13,  2.63s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0225, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9196, 'compress@10': 1.0, 'time@10': 3.453}:  50%|█████     | 5/10 [00:14<00:13,  2.63s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0225, 'hit_ratio@10': 0.8619, 'ndcg@10': 0.9196, 'compress@10': 1.0, 'time@10': 3.453}:  60%|██████    | 6/10 [00:14<00:11,  3.00s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0232, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 3.4947}:  60%|██████    | 6/10 [00:16<00:11,  3.00s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0232, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.9161, 'compress@10': 1.0, 'time@10': 3.4947}:  70%|███████   | 7/10 [00:16<00:07,  2.64s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.022, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 3.4086}:  70%|███████   | 7/10 [00:19<00:07,  2.64s/it]  {'epoch': 20, 'num_users': 6.125, 'loss': 0.022, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 3.4086}:  80%|████████  | 8/10 [00:19<00:05,  2.71s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.6607}:  80%|████████  | 8/10 [00:22<00:05,  2.71s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0223, 'hit_ratio@10': 0.8749, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 3.6607}:  90%|█████████ | 9/10 [00:22<00:02,  2.76s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9264, 'compress@10': 1.0, 'time@10': 3.6541}:  90%|█████████ | 9/10 [00:26<00:02,  2.76s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9264, 'compress@10': 1.0, 'time@10': 3.6541}: 100%|██████████| 10/10 [00:26<00:00,  3.03s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0228, 'hit_ratio@10': 0.8851, 'ndcg@10': 0.9264, 'compress@10': 1.0, 'time@10': 3.6541}: 100%|██████████| 10/10 [00:26<00:00,  2.61s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.022840067509210468
Avg hit ratio: 0.8851385158889403
Avg ndcg: 0.9264174649605034
Avg compression ratio: 1.0
Avg train time: 3.654112195968628
Std train time: 1.951060031082184
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9023, 'compress@10': 1.0, 'time@10': 2.9598}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9023, 'compress@10': 1.0, 'time@10': 2.9598}:  10%|█         | 1/10 [00:01<00:13,  1.52s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9259, 'compress@10': 1.0, 'time@10': 2.7585}:  10%|█         | 1/10 [00:04<00:13,  1.52s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0216, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9259, 'compress@10': 1.0, 'time@10': 2.7585}:  20%|██        | 2/10 [00:04<00:17,  2.15s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9008, 'compress@10': 1.0, 'time@10': 2.1653}:  20%|██        | 2/10 [00:04<00:17,  2.15s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9008, 'compress@10': 1.0, 'time@10': 2.1653}:  30%|███       | 3/10 [00:04<00:09,  1.41s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 2.1879}:  30%|███       | 3/10 [00:06<00:09,  1.41s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0174, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9029, 'compress@10': 1.0, 'time@10': 2.1879}:  40%|████      | 4/10 [00:06<00:10,  1.76s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 3.3583}:  40%|████      | 4/10 [00:10<00:10,  1.76s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8894, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 3.3583}:  50%|█████     | 5/10 [00:10<00:12,  2.59s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0197, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 3.3601}:  50%|█████     | 5/10 [00:14<00:12,  2.59s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0197, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 3.3601}:  60%|██████    | 6/10 [00:14<00:11,  2.87s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0191, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 3.4032}:  60%|██████    | 6/10 [00:16<00:11,  2.87s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0191, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 3.4032}:  70%|███████   | 7/10 [00:16<00:07,  2.54s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0193, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.3114}:  70%|███████   | 7/10 [00:18<00:07,  2.54s/it]  {'epoch': 21, 'num_users': 6.125, 'loss': 0.0193, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 3.3114}:  80%|████████  | 8/10 [00:18<00:05,  2.59s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9187, 'compress@10': 1.0, 'time@10': 3.5315}:  80%|████████  | 8/10 [00:21<00:05,  2.59s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0231, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9187, 'compress@10': 1.0, 'time@10': 3.5315}:  90%|█████████ | 9/10 [00:21<00:02,  2.62s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9239, 'compress@10': 1.0, 'time@10': 3.5101}:  90%|█████████ | 9/10 [00:25<00:02,  2.62s/it]    {'epoch': 21, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9239, 'compress@10': 1.0, 'time@10': 3.5101}: 100%|██████████| 10/10 [00:25<00:00,  2.85s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0224, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9239, 'compress@10': 1.0, 'time@10': 3.5101}: 100%|██████████| 10/10 [00:25<00:00,  2.50s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.022388814330512603
Avg hit ratio: 0.9060365944185979
Avg ndcg: 0.9238616448453199
Avg compression ratio: 1.0
Avg train time: 3.5100941896438598
Std train time: 1.835113443758337
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9057, 'compress@10': 1.0, 'time@10': 3.1467}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9057, 'compress@10': 1.0, 'time@10': 3.1467}:  10%|█         | 1/10 [00:01<00:14,  1.61s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9253, 'compress@10': 1.0, 'time@10': 2.8232}:  10%|█         | 1/10 [00:04<00:14,  1.61s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0208, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9253, 'compress@10': 1.0, 'time@10': 2.8232}:  20%|██        | 2/10 [00:04<00:17,  2.15s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9004, 'compress@10': 1.0, 'time@10': 2.2023}:  20%|██        | 2/10 [00:04<00:17,  2.15s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0152, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9004, 'compress@10': 1.0, 'time@10': 2.2023}:  30%|███       | 3/10 [00:04<00:09,  1.41s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.2069}:  30%|███       | 3/10 [00:06<00:09,  1.41s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.2069}:  40%|████      | 4/10 [00:06<00:10,  1.74s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0189, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9135, 'compress@10': 1.0, 'time@10': 3.4482}:  40%|████      | 4/10 [00:11<00:10,  1.74s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0189, 'hit_ratio@10': 0.8537, 'ndcg@10': 0.9135, 'compress@10': 1.0, 'time@10': 3.4482}:  50%|█████     | 5/10 [00:11<00:13,  2.64s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9201, 'compress@10': 1.0, 'time@10': 3.4942}:  50%|█████     | 5/10 [00:14<00:13,  2.64s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0186, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9201, 'compress@10': 1.0, 'time@10': 3.4942}:  60%|██████    | 6/10 [00:14<00:12,  3.02s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9204, 'compress@10': 1.0, 'time@10': 3.5622}:  60%|██████    | 6/10 [00:16<00:12,  3.02s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0209, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9204, 'compress@10': 1.0, 'time@10': 3.5622}:  70%|███████   | 7/10 [00:16<00:08,  2.70s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0213, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 3.4717}:  70%|███████   | 7/10 [00:19<00:08,  2.70s/it] {'epoch': 22, 'num_users': 6.125, 'loss': 0.0213, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 3.4717}:  80%|████████  | 8/10 [00:19<00:05,  2.75s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0247, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9396, 'compress@10': 1.0, 'time@10': 3.6872}:  80%|████████  | 8/10 [00:22<00:05,  2.75s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0247, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9396, 'compress@10': 1.0, 'time@10': 3.6872}:  90%|█████████ | 9/10 [00:22<00:02,  2.75s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.025, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.938, 'compress@10': 1.0, 'time@10': 3.6536}:  90%|█████████ | 9/10 [00:25<00:02,  2.75s/it]     {'epoch': 22, 'num_users': 6.3, 'loss': 0.025, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.938, 'compress@10': 1.0, 'time@10': 3.6536}: 100%|██████████| 10/10 [00:25<00:00,  2.95s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.025, 'hit_ratio@10': 0.8869, 'ndcg@10': 0.938, 'compress@10': 1.0, 'time@10': 3.6536}: 100%|██████████| 10/10 [00:25<00:00,  2.60s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.02502299442758498
Avg hit ratio: 0.8869096102916136
Avg ndcg: 0.938031512966876
Avg compression ratio: 1.0
Avg train time: 3.653616523742676
Std train time: 1.9365198228869311
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 2.937}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0192, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9031, 'compress@10': 1.0, 'time@10': 2.937}:  10%|█         | 1/10 [00:01<00:13,  1.51s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9274, 'compress@10': 1.0, 'time@10': 2.7065}:  10%|█         | 1/10 [00:04<00:13,  1.51s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9274, 'compress@10': 1.0, 'time@10': 2.7065}:  20%|██        | 2/10 [00:04<00:16,  2.12s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9018, 'compress@10': 1.0, 'time@10': 2.136}:  20%|██        | 2/10 [00:04<00:16,  2.12s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9018, 'compress@10': 1.0, 'time@10': 2.136}:  30%|███       | 3/10 [00:04<00:09,  1.39s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 2.1463}:  30%|███       | 3/10 [00:06<00:09,  1.39s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0148, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.905, 'compress@10': 1.0, 'time@10': 2.1463}:  40%|████      | 4/10 [00:06<00:10,  1.72s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 3.3591}:  40%|████      | 4/10 [00:10<00:10,  1.72s/it] {'epoch': 23, 'num_users': 5.8, 'loss': 0.017, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 3.3591}:  50%|█████     | 5/10 [00:10<00:12,  2.59s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9265, 'compress@10': 1.0, 'time@10': 3.4098}:  50%|█████     | 5/10 [00:14<00:12,  2.59s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9265, 'compress@10': 1.0, 'time@10': 3.4098}:  60%|██████    | 6/10 [00:14<00:11,  2.98s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0198, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9252, 'compress@10': 1.0, 'time@10': 3.4951}:  60%|██████    | 6/10 [00:16<00:11,  2.98s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0198, 'hit_ratio@10': 0.8987, 'ndcg@10': 0.9252, 'compress@10': 1.0, 'time@10': 3.4951}:  70%|███████   | 7/10 [00:16<00:08,  2.67s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0189, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 3.4128}:  70%|███████   | 7/10 [00:19<00:08,  2.67s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0189, 'hit_ratio@10': 0.9078, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 3.4128}:  80%|████████  | 8/10 [00:19<00:05,  2.73s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0228, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9452, 'compress@10': 1.0, 'time@10': 3.6848}:  80%|████████  | 8/10 [00:22<00:05,  2.73s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0228, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9452, 'compress@10': 1.0, 'time@10': 3.6848}:  90%|█████████ | 9/10 [00:22<00:02,  2.81s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.6812}:  90%|█████████ | 9/10 [00:26<00:02,  2.81s/it]    {'epoch': 23, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.6812}: 100%|██████████| 10/10 [00:26<00:00,  3.08s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.6812}: 100%|██████████| 10/10 [00:26<00:00,  2.62s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.021985797611606524
Avg hit ratio: 0.9011128603522491
Avg ndcg: 0.9478967658439277
Avg compression ratio: 1.0
Avg train time: 3.6811707496643065
Std train time: 1.9382821196857765
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8993, 'compress@10': 1.0, 'time@10': 3.0328}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8993, 'compress@10': 1.0, 'time@10': 3.0328}:  10%|█         | 1/10 [00:01<00:13,  1.55s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 2.7778}:  10%|█         | 1/10 [00:04<00:13,  1.55s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 2.7778}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 2.1703}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.0134, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 2.1703}:  30%|███       | 3/10 [00:04<00:09,  1.40s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9077, 'compress@10': 1.0, 'time@10': 2.1931}:  30%|███       | 3/10 [00:06<00:09,  1.40s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9077, 'compress@10': 1.0, 'time@10': 2.1931}:  40%|████      | 4/10 [00:06<00:10,  1.75s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9175, 'compress@10': 1.0, 'time@10': 3.4201}:  40%|████      | 4/10 [00:11<00:10,  1.75s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0166, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9175, 'compress@10': 1.0, 'time@10': 3.4201}:  50%|█████     | 5/10 [00:11<00:13,  2.64s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 3.4631}:  50%|█████     | 5/10 [00:14<00:13,  2.64s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0157, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 3.4631}:  60%|██████    | 6/10 [00:14<00:12,  3.00s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.928, 'compress@10': 1.0, 'time@10': 3.5462}:  60%|██████    | 6/10 [00:16<00:12,  3.00s/it] {'epoch': 24, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.928, 'compress@10': 1.0, 'time@10': 3.5462}:  70%|███████   | 7/10 [00:16<00:08,  2.70s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9303, 'compress@10': 1.0, 'time@10': 3.4472}:  70%|███████   | 7/10 [00:19<00:08,  2.70s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0152, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9303, 'compress@10': 1.0, 'time@10': 3.4472}:  80%|████████  | 8/10 [00:19<00:05,  2.73s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9245, 'compress@10': 1.0, 'time@10': 3.6904}:  80%|████████  | 8/10 [00:22<00:05,  2.73s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.8906, 'ndcg@10': 0.9245, 'compress@10': 1.0, 'time@10': 3.6904}:  90%|█████████ | 9/10 [00:22<00:02,  2.77s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9247, 'compress@10': 1.0, 'time@10': 3.6774}:  90%|█████████ | 9/10 [00:26<00:02,  2.77s/it]  {'epoch': 24, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9247, 'compress@10': 1.0, 'time@10': 3.6774}: 100%|██████████| 10/10 [00:26<00:00,  3.02s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9247, 'compress@10': 1.0, 'time@10': 3.6774}: 100%|██████████| 10/10 [00:26<00:00,  2.61s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.0193243070946659
Avg hit ratio: 0.899259301724497
Avg ndcg: 0.924730895890986
Avg compression ratio: 1.0
Avg train time: 3.6774157285690308
Std train time: 1.9397153065609443
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8866, 'compress@10': 1.0, 'time@10': 2.959}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8866, 'compress@10': 1.0, 'time@10': 2.959}:  10%|█         | 1/10 [00:01<00:13,  1.52s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 2.8005}:  10%|█         | 1/10 [00:04<00:13,  1.52s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.021, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9188, 'compress@10': 1.0, 'time@10': 2.8005}:  20%|██        | 2/10 [00:04<00:17,  2.20s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 2.1867}:  20%|██        | 2/10 [00:04<00:17,  2.20s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 2.1867}:  30%|███       | 3/10 [00:04<00:10,  1.43s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 2.2048}:  30%|███       | 3/10 [00:07<00:10,  1.43s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 2.2048}:  40%|████      | 4/10 [00:07<00:10,  1.77s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9179, 'compress@10': 1.0, 'time@10': 3.4422}:  40%|████      | 4/10 [00:11<00:10,  1.77s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0178, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9179, 'compress@10': 1.0, 'time@10': 3.4422}:  50%|█████     | 5/10 [00:11<00:13,  2.67s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 3.4811}:  50%|█████     | 5/10 [00:14<00:13,  2.67s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 3.4811}:  60%|██████    | 6/10 [00:14<00:12,  3.02s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0198, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9233, 'compress@10': 1.0, 'time@10': 3.5063}:  60%|██████    | 6/10 [00:16<00:12,  3.02s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0198, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9233, 'compress@10': 1.0, 'time@10': 3.5063}:  70%|███████   | 7/10 [00:16<00:07,  2.65s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9227, 'compress@10': 1.0, 'time@10': 3.3939}:  70%|███████   | 7/10 [00:19<00:07,  2.65s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9227, 'compress@10': 1.0, 'time@10': 3.3939}:  80%|████████  | 8/10 [00:19<00:05,  2.65s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.927, 'compress@10': 1.0, 'time@10': 3.6332}:  80%|████████  | 8/10 [00:22<00:05,  2.65s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.927, 'compress@10': 1.0, 'time@10': 3.6332}:  90%|█████████ | 9/10 [00:22<00:02,  2.70s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9313, 'compress@10': 1.0, 'time@10': 3.6245}:  90%|█████████ | 9/10 [00:25<00:02,  2.70s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9313, 'compress@10': 1.0, 'time@10': 3.6245}: 100%|██████████| 10/10 [00:25<00:00,  2.97s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9313, 'compress@10': 1.0, 'time@10': 3.6245}: 100%|██████████| 10/10 [00:25<00:00,  2.59s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.01852924627289657
Avg hit ratio: 0.9021958096610048
Avg ndcg: 0.9313406280754368
Avg compression ratio: 1.0
Avg train time: 3.624521994590759
Std train time: 1.9455368992837043
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9006, 'compress@10': 1.0, 'time@10': 2.9039}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0168, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9006, 'compress@10': 1.0, 'time@10': 2.9039}:  10%|█         | 1/10 [00:01<00:13,  1.49s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9329, 'compress@10': 1.0, 'time@10': 2.6122}:  10%|█         | 1/10 [00:03<00:13,  1.49s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9329, 'compress@10': 1.0, 'time@10': 2.6122}:  20%|██        | 2/10 [00:03<00:15,  2.00s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 2.0342}:  20%|██        | 2/10 [00:04<00:15,  2.00s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 2.0342}:  30%|███       | 3/10 [00:04<00:09,  1.30s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9102, 'compress@10': 1.0, 'time@10': 2.0552}:  30%|███       | 3/10 [00:06<00:09,  1.30s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9102, 'compress@10': 1.0, 'time@10': 2.0552}:  40%|████      | 4/10 [00:06<00:09,  1.64s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0179, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9242, 'compress@10': 1.0, 'time@10': 3.3181}:  40%|████      | 4/10 [00:10<00:09,  1.64s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0179, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9242, 'compress@10': 1.0, 'time@10': 3.3181}:  50%|█████     | 5/10 [00:10<00:12,  2.57s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9335, 'compress@10': 1.0, 'time@10': 3.3889}:  50%|█████     | 5/10 [00:14<00:12,  2.57s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9335, 'compress@10': 1.0, 'time@10': 3.3889}:  60%|██████    | 6/10 [00:14<00:11,  2.98s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9314, 'compress@10': 1.0, 'time@10': 3.4869}:  60%|██████    | 6/10 [00:16<00:11,  2.98s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0189, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9314, 'compress@10': 1.0, 'time@10': 3.4869}:  70%|███████   | 7/10 [00:16<00:08,  2.69s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.4027}:  70%|███████   | 7/10 [00:19<00:08,  2.69s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.4027}:  80%|████████  | 8/10 [00:19<00:05,  2.74s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9351, 'compress@10': 1.0, 'time@10': 3.6434}:  80%|████████  | 8/10 [00:22<00:05,  2.74s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0173, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9351, 'compress@10': 1.0, 'time@10': 3.6434}:  90%|█████████ | 9/10 [00:22<00:02,  2.76s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9402, 'compress@10': 1.0, 'time@10': 3.6317}:  90%|█████████ | 9/10 [00:25<00:02,  2.76s/it]     {'epoch': 26, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9402, 'compress@10': 1.0, 'time@10': 3.6317}: 100%|██████████| 10/10 [00:25<00:00,  3.01s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9402, 'compress@10': 1.0, 'time@10': 3.6317}: 100%|██████████| 10/10 [00:25<00:00,  2.58s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.017044113651439294
Avg hit ratio: 0.9049735874387826
Avg ndcg: 0.9401532914163129
Avg compression ratio: 1.0
Avg train time: 3.6317041873931886
Std train time: 1.9802364906998076
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9092, 'compress@10': 1.0, 'time@10': 3.0251}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0126, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9092, 'compress@10': 1.0, 'time@10': 3.0251}:  10%|█         | 1/10 [00:01<00:13,  1.55s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9463, 'compress@10': 1.0, 'time@10': 2.7871}:  10%|█         | 1/10 [00:04<00:13,  1.55s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9463, 'compress@10': 1.0, 'time@10': 2.7871}:  20%|██        | 2/10 [00:04<00:17,  2.16s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 2.1861}:  20%|██        | 2/10 [00:04<00:17,  2.16s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 2.1861}:  30%|███       | 3/10 [00:04<00:09,  1.42s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 2.1682}:  30%|███       | 3/10 [00:06<00:09,  1.42s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 2.1682}:  40%|████      | 4/10 [00:06<00:10,  1.71s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.929, 'compress@10': 1.0, 'time@10': 3.3814}:  40%|████      | 4/10 [00:10<00:10,  1.71s/it] {'epoch': 27, 'num_users': 5.8, 'loss': 0.0147, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.929, 'compress@10': 1.0, 'time@10': 3.3814}:  50%|█████     | 5/10 [00:10<00:12,  2.59s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9356, 'compress@10': 1.0, 'time@10': 3.3813}:  50%|█████     | 5/10 [00:14<00:12,  2.59s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.874, 'ndcg@10': 0.9356, 'compress@10': 1.0, 'time@10': 3.3813}:  60%|██████    | 6/10 [00:14<00:11,  2.87s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9374, 'compress@10': 1.0, 'time@10': 3.4519}:  60%|██████    | 6/10 [00:16<00:11,  2.87s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.8863, 'ndcg@10': 0.9374, 'compress@10': 1.0, 'time@10': 3.4519}:  70%|███████   | 7/10 [00:16<00:07,  2.58s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9402, 'compress@10': 1.0, 'time@10': 3.3614}:  70%|███████   | 7/10 [00:19<00:07,  2.58s/it]  {'epoch': 27, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9402, 'compress@10': 1.0, 'time@10': 3.3614}:  80%|████████  | 8/10 [00:19<00:05,  2.64s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9589, 'compress@10': 1.0, 'time@10': 3.6039}:  80%|████████  | 8/10 [00:21<00:05,  2.64s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8767, 'ndcg@10': 0.9589, 'compress@10': 1.0, 'time@10': 3.6039}:  90%|█████████ | 9/10 [00:21<00:02,  2.69s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9571, 'compress@10': 1.0, 'time@10': 3.6044}:  90%|█████████ | 9/10 [00:25<00:02,  2.69s/it]   {'epoch': 27, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9571, 'compress@10': 1.0, 'time@10': 3.6044}: 100%|██████████| 10/10 [00:25<00:00,  2.99s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.016, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.9571, 'compress@10': 1.0, 'time@10': 3.6044}: 100%|██████████| 10/10 [00:25<00:00,  2.56s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.016020034331232086
Avg hit ratio: 0.8867247395125155
Avg ndcg: 0.9570868564050627
Avg compression ratio: 1.0
Avg train time: 3.6044122219085692
Std train time: 1.9137282524779073
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 3.1028}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 3.1028}:  10%|█         | 1/10 [00:01<00:14,  1.60s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9287, 'compress@10': 1.0, 'time@10': 2.7929}:  10%|█         | 1/10 [00:04<00:14,  1.60s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0127, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9287, 'compress@10': 1.0, 'time@10': 2.7929}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9027, 'compress@10': 1.0, 'time@10': 2.181}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9027, 'compress@10': 1.0, 'time@10': 2.181}:  30%|███       | 3/10 [00:04<00:09,  1.40s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 2.2023}:  30%|███       | 3/10 [00:06<00:09,  1.40s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0117, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 2.2023}:  40%|████      | 4/10 [00:06<00:10,  1.75s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9226, 'compress@10': 1.0, 'time@10': 3.3739}:  40%|████      | 4/10 [00:11<00:10,  1.75s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0134, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9226, 'compress@10': 1.0, 'time@10': 3.3739}:  50%|█████     | 5/10 [00:11<00:12,  2.59s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0149, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9305, 'compress@10': 1.0, 'time@10': 3.4214}:  50%|█████     | 5/10 [00:14<00:12,  2.59s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0149, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9305, 'compress@10': 1.0, 'time@10': 3.4214}:  60%|██████    | 6/10 [00:14<00:11,  2.97s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0168, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9293, 'compress@10': 1.0, 'time@10': 3.4987}:  60%|██████    | 6/10 [00:16<00:11,  2.97s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0168, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9293, 'compress@10': 1.0, 'time@10': 3.4987}:  70%|███████   | 7/10 [00:16<00:07,  2.66s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9308, 'compress@10': 1.0, 'time@10': 3.4102}:  70%|███████   | 7/10 [00:19<00:07,  2.66s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9308, 'compress@10': 1.0, 'time@10': 3.4102}:  80%|████████  | 8/10 [00:19<00:05,  2.71s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9426, 'compress@10': 1.0, 'time@10': 3.6813}:  80%|████████  | 8/10 [00:22<00:05,  2.71s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0221, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9426, 'compress@10': 1.0, 'time@10': 3.6813}:  90%|█████████ | 9/10 [00:22<00:02,  2.79s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9458, 'compress@10': 1.0, 'time@10': 3.6727}:  90%|█████████ | 9/10 [00:26<00:02,  2.79s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9458, 'compress@10': 1.0, 'time@10': 3.6727}: 100%|██████████| 10/10 [00:26<00:00,  3.05s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.9458, 'compress@10': 1.0, 'time@10': 3.6727}: 100%|██████████| 10/10 [00:26<00:00,  2.62s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.020734011265801638
Avg hit ratio: 0.9021164445816398
Avg ndcg: 0.945830359058386
Avg compression ratio: 1.0
Avg train time: 3.672733998298645
Std train time: 1.8961407696137846
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 3.017}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8918, 'compress@10': 1.0, 'time@10': 3.017}:  10%|█         | 1/10 [00:01<00:13,  1.55s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9278, 'compress@10': 1.0, 'time@10': 2.7748}:  10%|█         | 1/10 [00:04<00:13,  1.55s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0176, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9278, 'compress@10': 1.0, 'time@10': 2.7748}:  20%|██        | 2/10 [00:04<00:17,  2.15s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9021, 'compress@10': 1.0, 'time@10': 2.1883}:  20%|██        | 2/10 [00:04<00:17,  2.15s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0126, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9021, 'compress@10': 1.0, 'time@10': 2.1883}:  30%|███       | 3/10 [00:04<00:09,  1.42s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 2.2026}:  30%|███       | 3/10 [00:06<00:09,  1.42s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 2.2026}:  40%|████      | 4/10 [00:06<00:10,  1.76s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9236, 'compress@10': 1.0, 'time@10': 3.4021}:  40%|████      | 4/10 [00:11<00:10,  1.76s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9236, 'compress@10': 1.0, 'time@10': 3.4021}:  50%|█████     | 5/10 [00:11<00:13,  2.62s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.932, 'compress@10': 1.0, 'time@10': 3.4209}:  50%|█████     | 5/10 [00:14<00:13,  2.62s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.932, 'compress@10': 1.0, 'time@10': 3.4209}:  60%|██████    | 6/10 [00:14<00:11,  2.93s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9318, 'compress@10': 1.0, 'time@10': 3.5013}:  60%|██████    | 6/10 [00:16<00:11,  2.93s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0165, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9318, 'compress@10': 1.0, 'time@10': 3.5013}:  70%|███████   | 7/10 [00:16<00:07,  2.64s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9313, 'compress@10': 1.0, 'time@10': 3.4218}:  70%|███████   | 7/10 [00:19<00:07,  2.64s/it]  {'epoch': 29, 'num_users': 6.125, 'loss': 0.0172, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9313, 'compress@10': 1.0, 'time@10': 3.4218}:  80%|████████  | 8/10 [00:19<00:05,  2.72s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9217, 'compress@10': 1.0, 'time@10': 3.6157}:  80%|████████  | 8/10 [00:22<00:05,  2.72s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0195, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9217, 'compress@10': 1.0, 'time@10': 3.6157}:  90%|█████████ | 9/10 [00:22<00:02,  2.69s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 3.5797}:  90%|█████████ | 9/10 [00:25<00:02,  2.69s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 3.5797}: 100%|██████████| 10/10 [00:25<00:00,  2.88s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0193, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 3.5797}: 100%|██████████| 10/10 [00:25<00:00,  2.55s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.019330407621621762
Avg hit ratio: 0.8960334952728841
Avg ndcg: 0.9282600176800374
Avg compression ratio: 1.0
Avg train time: 3.579738426208496
Std train time: 1.855353692842745
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9165, 'compress@10': 1.0, 'time@10': 3.0341}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9165, 'compress@10': 1.0, 'time@10': 3.0341}:  10%|█         | 1/10 [00:01<00:13,  1.55s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.951, 'compress@10': 1.0, 'time@10': 2.7702}:  10%|█         | 1/10 [00:04<00:13,  1.55s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.951, 'compress@10': 1.0, 'time@10': 2.7702}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9175, 'compress@10': 1.0, 'time@10': 2.1836}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9175, 'compress@10': 1.0, 'time@10': 2.1836}:  30%|███       | 3/10 [00:04<00:09,  1.41s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9227, 'compress@10': 1.0, 'time@10': 2.1908}:  30%|███       | 3/10 [00:06<00:09,  1.41s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9227, 'compress@10': 1.0, 'time@10': 2.1908}:  40%|████      | 4/10 [00:06<00:10,  1.75s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9392, 'compress@10': 1.0, 'time@10': 3.4331}:  40%|████      | 4/10 [00:11<00:10,  1.75s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9392, 'compress@10': 1.0, 'time@10': 3.4331}:  50%|█████     | 5/10 [00:11<00:13,  2.65s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 3.4688}:  50%|█████     | 5/10 [00:14<00:13,  2.65s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0155, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 3.4688}:  60%|██████    | 6/10 [00:14<00:12,  3.00s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9451, 'compress@10': 1.0, 'time@10': 3.5747}:  60%|██████    | 6/10 [00:16<00:12,  3.00s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0144, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9451, 'compress@10': 1.0, 'time@10': 3.5747}:  70%|███████   | 7/10 [00:16<00:08,  2.72s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9466, 'compress@10': 1.0, 'time@10': 3.4819}:  70%|███████   | 7/10 [00:19<00:08,  2.72s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9466, 'compress@10': 1.0, 'time@10': 3.4819}:  80%|████████  | 8/10 [00:19<00:05,  2.77s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9483, 'compress@10': 1.0, 'time@10': 3.7275}:  80%|████████  | 8/10 [00:22<00:05,  2.77s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9483, 'compress@10': 1.0, 'time@10': 3.7275}:  90%|█████████ | 9/10 [00:22<00:02,  2.80s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.948, 'compress@10': 1.0, 'time@10': 3.7084}:  90%|█████████ | 9/10 [00:26<00:02,  2.80s/it]    {'epoch': 30, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.948, 'compress@10': 1.0, 'time@10': 3.7084}: 100%|██████████| 10/10 [00:26<00:00,  3.04s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.9021, 'ndcg@10': 0.948, 'compress@10': 1.0, 'time@10': 3.7084}: 100%|██████████| 10/10 [00:26<00:00,  2.63s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.014296521061252265
Avg hit ratio: 0.9021164445816398
Avg ndcg: 0.9479650454701662
Avg compression ratio: 1.0
Avg train time: 3.7084426403045656
Std train time: 1.9604961616654206
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9199, 'compress@10': 1.0, 'time@10': 2.9467}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9199, 'compress@10': 1.0, 'time@10': 2.9467}:  10%|█         | 1/10 [00:01<00:13,  1.52s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9563, 'compress@10': 1.0, 'time@10': 2.6662}:  10%|█         | 1/10 [00:03<00:13,  1.52s/it] {'epoch': 31, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9563, 'compress@10': 1.0, 'time@10': 2.6662}:  20%|██        | 2/10 [00:03<00:16,  2.05s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 2.0745}:  20%|██        | 2/10 [00:04<00:16,  2.05s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9211, 'compress@10': 1.0, 'time@10': 2.0745}:  30%|███       | 3/10 [00:04<00:09,  1.33s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9274, 'compress@10': 1.0, 'time@10': 2.1077}:  30%|███       | 3/10 [00:06<00:09,  1.33s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0145, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9274, 'compress@10': 1.0, 'time@10': 2.1077}:  40%|████      | 4/10 [00:06<00:10,  1.69s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9402, 'compress@10': 1.0, 'time@10': 3.3637}:  40%|████      | 4/10 [00:10<00:10,  1.69s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0156, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9402, 'compress@10': 1.0, 'time@10': 3.3637}:  50%|█████     | 5/10 [00:10<00:13,  2.61s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0156, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9455, 'compress@10': 1.0, 'time@10': 3.4199}:  50%|█████     | 5/10 [00:14<00:13,  2.61s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0156, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9455, 'compress@10': 1.0, 'time@10': 3.4199}:  60%|██████    | 6/10 [00:14<00:11,  3.00s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0173, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9437, 'compress@10': 1.0, 'time@10': 3.5043}:  60%|██████    | 6/10 [00:16<00:11,  3.00s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0173, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9437, 'compress@10': 1.0, 'time@10': 3.5043}:  70%|███████   | 7/10 [00:16<00:08,  2.69s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9462, 'compress@10': 1.0, 'time@10': 3.3938}:  70%|███████   | 7/10 [00:19<00:08,  2.69s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0161, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9462, 'compress@10': 1.0, 'time@10': 3.3938}:  80%|████████  | 8/10 [00:19<00:05,  2.68s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9472, 'compress@10': 1.0, 'time@10': 3.6506}:  80%|████████  | 8/10 [00:22<00:05,  2.68s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8934, 'ndcg@10': 0.9472, 'compress@10': 1.0, 'time@10': 3.6506}:  90%|█████████ | 9/10 [00:22<00:02,  2.74s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.95, 'compress@10': 1.0, 'time@10': 3.6473}:  90%|█████████ | 9/10 [00:25<00:02,  2.74s/it]     {'epoch': 31, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.95, 'compress@10': 1.0, 'time@10': 3.6473}: 100%|██████████| 10/10 [00:25<00:00,  3.02s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.95, 'compress@10': 1.0, 'time@10': 3.6473}: 100%|██████████| 10/10 [00:25<00:00,  2.59s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.015254698549039436
Avg hit ratio: 0.9018271460665348
Avg ndcg: 0.9499924014811668
Avg compression ratio: 1.0
Avg train time: 3.647346830368042
Std train time: 1.991242366316459
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9217, 'compress@10': 1.0, 'time@10': 2.777}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9217, 'compress@10': 1.0, 'time@10': 2.777}:  10%|█         | 1/10 [00:01<00:12,  1.43s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9412, 'compress@10': 1.0, 'time@10': 2.5266}:  10%|█         | 1/10 [00:03<00:12,  1.43s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0089, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9412, 'compress@10': 1.0, 'time@10': 2.5266}:  20%|██        | 2/10 [00:03<00:15,  1.95s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.855, 'ndcg@10': 0.911, 'compress@10': 1.0, 'time@10': 1.9845}:  20%|██        | 2/10 [00:04<00:15,  1.95s/it]  {'epoch': 32, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.855, 'ndcg@10': 0.911, 'compress@10': 1.0, 'time@10': 1.9845}:  30%|███       | 3/10 [00:04<00:08,  1.28s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9157, 'compress@10': 1.0, 'time@10': 2.074}:  30%|███       | 3/10 [00:06<00:08,  1.28s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9157, 'compress@10': 1.0, 'time@10': 2.074}:  40%|████      | 4/10 [00:06<00:10,  1.71s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9282, 'compress@10': 1.0, 'time@10': 3.3115}:  40%|████      | 4/10 [00:10<00:10,  1.71s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9282, 'compress@10': 1.0, 'time@10': 3.3115}:  50%|█████     | 5/10 [00:10<00:12,  2.60s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 3.3668}:  50%|█████     | 5/10 [00:14<00:12,  2.60s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 3.3668}:  60%|██████    | 6/10 [00:14<00:11,  2.97s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9363, 'compress@10': 1.0, 'time@10': 3.4618}:  60%|██████    | 6/10 [00:16<00:11,  2.97s/it] {'epoch': 32, 'num_users': 6.2857, 'loss': 0.0132, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9363, 'compress@10': 1.0, 'time@10': 3.4618}:  70%|███████   | 7/10 [00:16<00:08,  2.67s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9336, 'compress@10': 1.0, 'time@10': 3.37}:  70%|███████   | 7/10 [00:19<00:08,  2.67s/it]  {'epoch': 32, 'num_users': 6.125, 'loss': 0.0146, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9336, 'compress@10': 1.0, 'time@10': 3.37}:  80%|████████  | 8/10 [00:19<00:05,  2.70s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9464, 'compress@10': 1.0, 'time@10': 3.61}:  80%|████████  | 8/10 [00:22<00:05,  2.70s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0156, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9464, 'compress@10': 1.0, 'time@10': 3.61}:  90%|█████████ | 9/10 [00:22<00:02,  2.73s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9502, 'compress@10': 1.0, 'time@10': 3.6082}:  90%|█████████ | 9/10 [00:25<00:02,  2.73s/it] {'epoch': 32, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9502, 'compress@10': 1.0, 'time@10': 3.6082}: 100%|██████████| 10/10 [00:25<00:00,  3.01s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.9111, 'ndcg@10': 0.9502, 'compress@10': 1.0, 'time@10': 3.6082}: 100%|██████████| 10/10 [00:25<00:00,  2.57s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.015134673492058274
Avg hit ratio: 0.9111359018269034
Avg ndcg: 0.9501659740654196
Avg compression ratio: 1.0
Avg train time: 3.6081770420074464
Std train time: 1.941740732222212
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9253, 'compress@10': 1.0, 'time@10': 3.2569}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9253, 'compress@10': 1.0, 'time@10': 3.2569}:  10%|█         | 1/10 [00:01<00:14,  1.66s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8769, 'ndcg@10': 1.0082, 'compress@10': 1.0, 'time@10': 2.8922}:  10%|█         | 1/10 [00:04<00:14,  1.66s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0274, 'hit_ratio@10': 0.8769, 'ndcg@10': 1.0082, 'compress@10': 1.0, 'time@10': 2.8922}:  20%|██        | 2/10 [00:04<00:17,  2.19s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9557, 'compress@10': 1.0, 'time@10': 2.2504}:  20%|██        | 2/10 [00:04<00:17,  2.19s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.019, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9557, 'compress@10': 1.0, 'time@10': 2.2504}:  30%|███       | 3/10 [00:04<00:10,  1.43s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.9515, 'compress@10': 1.0, 'time@10': 2.2364}:  30%|███       | 3/10 [00:06<00:10,  1.43s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8313, 'ndcg@10': 0.9515, 'compress@10': 1.0, 'time@10': 2.2364}:  40%|████      | 4/10 [00:06<00:10,  1.75s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0184, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9596, 'compress@10': 1.0, 'time@10': 3.4847}:  40%|████      | 4/10 [00:11<00:10,  1.75s/it] {'epoch': 33, 'num_users': 5.8, 'loss': 0.0184, 'hit_ratio@10': 0.861, 'ndcg@10': 0.9596, 'compress@10': 1.0, 'time@10': 3.4847}:  50%|█████     | 5/10 [00:11<00:13,  2.66s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9618, 'compress@10': 1.0, 'time@10': 3.5188}:  50%|█████     | 5/10 [00:14<00:13,  2.66s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0165, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9618, 'compress@10': 1.0, 'time@10': 3.5188}:  60%|██████    | 6/10 [00:14<00:12,  3.02s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9599, 'compress@10': 1.0, 'time@10': 3.5777}:  60%|██████    | 6/10 [00:16<00:12,  3.02s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9599, 'compress@10': 1.0, 'time@10': 3.5777}:  70%|███████   | 7/10 [00:16<00:08,  2.69s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0173, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9598, 'compress@10': 1.0, 'time@10': 3.4711}:  70%|███████   | 7/10 [00:19<00:08,  2.69s/it]  {'epoch': 33, 'num_users': 6.125, 'loss': 0.0173, 'hit_ratio@10': 0.899, 'ndcg@10': 0.9598, 'compress@10': 1.0, 'time@10': 3.4711}:  80%|████████  | 8/10 [00:19<00:05,  2.71s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0224, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9617, 'compress@10': 1.0, 'time@10': 3.7167}:  80%|████████  | 8/10 [00:22<00:05,  2.71s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0224, 'hit_ratio@10': 0.8817, 'ndcg@10': 0.9617, 'compress@10': 1.0, 'time@10': 3.7167}:  90%|█████████ | 9/10 [00:22<00:02,  2.76s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9608, 'compress@10': 1.0, 'time@10': 3.6839}:  90%|█████████ | 9/10 [00:26<00:02,  2.76s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9608, 'compress@10': 1.0, 'time@10': 3.6839}: 100%|██████████| 10/10 [00:26<00:00,  2.97s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9608, 'compress@10': 1.0, 'time@10': 3.6839}: 100%|██████████| 10/10 [00:26<00:00,  2.60s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.021862527904058134
Avg hit ratio: 0.8912362602498426
Avg ndcg: 0.9608298855878218
Avg compression ratio: 1.0
Avg train time: 3.6838605403900146
Std train time: 1.979002884409205
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.904, 'compress@10': 1.0, 'time@10': 2.7435}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.904, 'compress@10': 1.0, 'time@10': 2.7435}:  10%|█         | 1/10 [00:01<00:12,  1.41s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9329, 'compress@10': 1.0, 'time@10': 2.537}:  10%|█         | 1/10 [00:03<00:12,  1.41s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9329, 'compress@10': 1.0, 'time@10': 2.537}:  20%|██        | 2/10 [00:03<00:15,  1.97s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 2.0104}:  20%|██        | 2/10 [00:04<00:15,  1.97s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 2.0104}:  30%|███       | 3/10 [00:04<00:09,  1.31s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9168, 'compress@10': 1.0, 'time@10': 2.058}:  30%|███       | 3/10 [00:06<00:09,  1.31s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.9168, 'compress@10': 1.0, 'time@10': 2.058}:  40%|████      | 4/10 [00:06<00:10,  1.67s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9305, 'compress@10': 1.0, 'time@10': 3.326}:  40%|████      | 4/10 [00:10<00:10,  1.67s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8804, 'ndcg@10': 0.9305, 'compress@10': 1.0, 'time@10': 3.326}:  50%|█████     | 5/10 [00:10<00:12,  2.60s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0104, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9375, 'compress@10': 1.0, 'time@10': 3.3876}:  50%|█████     | 5/10 [00:14<00:12,  2.60s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0104, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9375, 'compress@10': 1.0, 'time@10': 3.3876}:  60%|██████    | 6/10 [00:14<00:11,  2.98s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9373, 'compress@10': 1.0, 'time@10': 3.4722}:  60%|██████    | 6/10 [00:16<00:11,  2.98s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.9373, 'compress@10': 1.0, 'time@10': 3.4722}:  70%|███████   | 7/10 [00:16<00:08,  2.67s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.9415, 'compress@10': 1.0, 'time@10': 3.3915}:  70%|███████   | 7/10 [00:19<00:08,  2.67s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9139, 'ndcg@10': 0.9415, 'compress@10': 1.0, 'time@10': 3.3915}:  80%|████████  | 8/10 [00:19<00:05,  2.73s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 3.6758}:  80%|████████  | 8/10 [00:22<00:05,  2.73s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.8917, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 3.6758}:  90%|█████████ | 9/10 [00:22<00:02,  2.82s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9445, 'compress@10': 1.0, 'time@10': 3.6657}:  90%|█████████ | 9/10 [00:26<00:02,  2.82s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9445, 'compress@10': 1.0, 'time@10': 3.6657}: 100%|██████████| 10/10 [00:26<00:00,  3.07s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.9003, 'ndcg@10': 0.9445, 'compress@10': 1.0, 'time@10': 3.6657}: 100%|██████████| 10/10 [00:26<00:00,  2.60s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.014158933859347888
Avg hit ratio: 0.9002787589697606
Avg ndcg: 0.9444736549464929
Avg compression ratio: 1.0
Avg train time: 3.6657479286193846
Std train time: 2.0133899217161986
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 3.0582}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0169, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9052, 'compress@10': 1.0, 'time@10': 3.0582}:  10%|█         | 1/10 [00:01<00:14,  1.57s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9683, 'compress@10': 1.0, 'time@10': 2.781}:  10%|█         | 1/10 [00:04<00:14,  1.57s/it] {'epoch': 35, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9683, 'compress@10': 1.0, 'time@10': 2.781}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 2.1846}:  20%|██        | 2/10 [00:04<00:17,  2.14s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 2.1846}:  30%|███       | 3/10 [00:04<00:09,  1.40s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9353, 'compress@10': 1.0, 'time@10': 2.1929}:  30%|███       | 3/10 [00:06<00:09,  1.40s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9353, 'compress@10': 1.0, 'time@10': 2.1929}:  40%|████      | 4/10 [00:06<00:10,  1.74s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0164, 'hit_ratio@10': 0.874, 'ndcg@10': 0.946, 'compress@10': 1.0, 'time@10': 3.381}:  40%|████      | 4/10 [00:10<00:10,  1.74s/it]  {'epoch': 35, 'num_users': 5.8, 'loss': 0.0164, 'hit_ratio@10': 0.874, 'ndcg@10': 0.946, 'compress@10': 1.0, 'time@10': 3.381}:  50%|█████     | 5/10 [00:10<00:12,  2.59s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9564, 'compress@10': 1.0, 'time@10': 3.4145}:  50%|█████     | 5/10 [00:14<00:12,  2.59s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.02, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9564, 'compress@10': 1.0, 'time@10': 3.4145}:  60%|██████    | 6/10 [00:14<00:11,  2.94s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0191, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9542, 'compress@10': 1.0, 'time@10': 3.5241}:  60%|██████    | 6/10 [00:16<00:11,  2.94s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0191, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9542, 'compress@10': 1.0, 'time@10': 3.5241}:  70%|███████   | 7/10 [00:16<00:08,  2.68s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9638, 'compress@10': 1.0, 'time@10': 3.4373}:  70%|███████   | 7/10 [00:19<00:08,  2.68s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9638, 'compress@10': 1.0, 'time@10': 3.4373}:  80%|████████  | 8/10 [00:19<00:05,  2.74s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9649, 'compress@10': 1.0, 'time@10': 3.6831}:  80%|████████  | 8/10 [00:22<00:05,  2.74s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0222, 'hit_ratio@10': 0.8977, 'ndcg@10': 0.9649, 'compress@10': 1.0, 'time@10': 3.6831}:  90%|█████████ | 9/10 [00:22<00:02,  2.77s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0208, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9662, 'compress@10': 1.0, 'time@10': 3.6789}:  90%|█████████ | 9/10 [00:26<00:02,  2.77s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0208, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9662, 'compress@10': 1.0, 'time@10': 3.6789}: 100%|██████████| 10/10 [00:26<00:00,  3.05s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0208, 'hit_ratio@10': 0.9056, 'ndcg@10': 0.9662, 'compress@10': 1.0, 'time@10': 3.6789}: 100%|██████████| 10/10 [00:26<00:00,  2.61s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.020823812102255312
Avg hit ratio: 0.9056243810895763
Avg ndcg: 0.9661638977479565
Avg compression ratio: 1.0
Avg train time: 3.6789470672607423
Std train time: 1.8930379872364345
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.926, 'compress@10': 1.0, 'time@10': 3.1193}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.926, 'compress@10': 1.0, 'time@10': 3.1193}:  10%|█         | 1/10 [00:01<00:14,  1.60s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9431, 'compress@10': 1.0, 'time@10': 2.7609}:  10%|█         | 1/10 [00:04<00:14,  1.60s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9431, 'compress@10': 1.0, 'time@10': 2.7609}:  20%|██        | 2/10 [00:04<00:16,  2.09s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9123, 'compress@10': 1.0, 'time@10': 2.1686}:  20%|██        | 2/10 [00:04<00:16,  2.09s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0086, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9123, 'compress@10': 1.0, 'time@10': 2.1686}:  30%|███       | 3/10 [00:04<00:09,  1.38s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9217, 'compress@10': 1.0, 'time@10': 2.1803}:  30%|███       | 3/10 [00:06<00:09,  1.38s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9217, 'compress@10': 1.0, 'time@10': 2.1803}:  40%|████      | 4/10 [00:06<00:10,  1.73s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9334, 'compress@10': 1.0, 'time@10': 3.4314}:  40%|████      | 4/10 [00:11<00:10,  1.73s/it]  {'epoch': 36, 'num_users': 5.8, 'loss': 0.0112, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9334, 'compress@10': 1.0, 'time@10': 3.4314}:  50%|█████     | 5/10 [00:11<00:13,  2.64s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9402, 'compress@10': 1.0, 'time@10': 3.4986}:  50%|█████     | 5/10 [00:14<00:13,  2.64s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0105, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9402, 'compress@10': 1.0, 'time@10': 3.4986}:  60%|██████    | 6/10 [00:14<00:12,  3.06s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 3.5224}:  60%|██████    | 6/10 [00:16<00:12,  3.06s/it] {'epoch': 36, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9414, 'compress@10': 1.0, 'time@10': 3.5224}:  70%|███████   | 7/10 [00:16<00:08,  2.67s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9425, 'compress@10': 1.0, 'time@10': 3.3986}:  70%|███████   | 7/10 [00:19<00:08,  2.67s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0105, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9425, 'compress@10': 1.0, 'time@10': 3.3986}:  80%|████████  | 8/10 [00:19<00:05,  2.64s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9362, 'compress@10': 1.0, 'time@10': 3.6217}:  80%|████████  | 8/10 [00:22<00:05,  2.64s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.9362, 'compress@10': 1.0, 'time@10': 3.6217}:  90%|█████████ | 9/10 [00:22<00:02,  2.67s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9367, 'compress@10': 1.0, 'time@10': 3.6211}:  90%|█████████ | 9/10 [00:25<00:02,  2.67s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9367, 'compress@10': 1.0, 'time@10': 3.6211}: 100%|██████████| 10/10 [00:25<00:00,  2.98s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0127, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9367, 'compress@10': 1.0, 'time@10': 3.6211}: 100%|██████████| 10/10 [00:25<00:00,  2.58s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.012695626280103242
Avg hit ratio: 0.8985450160102113
Avg ndcg: 0.9367341903851789
Avg compression ratio: 1.0
Avg train time: 3.6210785150527953
Std train time: 1.9562962447863088
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9217, 'compress@10': 1.0, 'time@10': 3.1428}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9217, 'compress@10': 1.0, 'time@10': 3.1428}:  10%|█         | 1/10 [00:01<00:14,  1.61s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 2.7883}:  10%|█         | 1/10 [00:04<00:14,  1.61s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0078, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 2.7883}:  20%|██        | 2/10 [00:04<00:16,  2.12s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9134, 'compress@10': 1.0, 'time@10': 2.1624}:  20%|██        | 2/10 [00:04<00:16,  2.12s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9134, 'compress@10': 1.0, 'time@10': 2.1624}:  30%|███       | 3/10 [00:04<00:09,  1.38s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9201, 'compress@10': 1.0, 'time@10': 2.1712}:  30%|███       | 3/10 [00:06<00:09,  1.38s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9201, 'compress@10': 1.0, 'time@10': 2.1712}:  40%|████      | 4/10 [00:06<00:10,  1.71s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.874, 'ndcg@10': 0.935, 'compress@10': 1.0, 'time@10': 3.3943}:  40%|████      | 4/10 [00:10<00:10,  1.71s/it]  {'epoch': 37, 'num_users': 5.8, 'loss': 0.0098, 'hit_ratio@10': 0.874, 'ndcg@10': 0.935, 'compress@10': 1.0, 'time@10': 3.3943}:  50%|█████     | 5/10 [00:10<00:13,  2.60s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9417, 'compress@10': 1.0, 'time@10': 3.4442}:  50%|█████     | 5/10 [00:14<00:13,  2.60s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.8913, 'ndcg@10': 0.9417, 'compress@10': 1.0, 'time@10': 3.4442}:  60%|██████    | 6/10 [00:14<00:11,  2.99s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9432, 'compress@10': 1.0, 'time@10': 3.5266}:  60%|██████    | 6/10 [00:16<00:11,  2.99s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0104, 'hit_ratio@10': 0.9011, 'ndcg@10': 0.9432, 'compress@10': 1.0, 'time@10': 3.5266}:  70%|███████   | 7/10 [00:16<00:08,  2.68s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9463, 'compress@10': 1.0, 'time@10': 3.4311}:  70%|███████   | 7/10 [00:19<00:08,  2.68s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9099, 'ndcg@10': 0.9463, 'compress@10': 1.0, 'time@10': 3.4311}:  80%|████████  | 8/10 [00:19<00:05,  2.72s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9485, 'compress@10': 1.0, 'time@10': 3.6771}:  80%|████████  | 8/10 [00:22<00:05,  2.72s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0095, 'hit_ratio@10': 0.9008, 'ndcg@10': 0.9485, 'compress@10': 1.0, 'time@10': 3.6771}:  90%|█████████ | 9/10 [00:22<00:02,  2.76s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9514, 'compress@10': 1.0, 'time@10': 3.6651}:  90%|█████████ | 9/10 [00:26<00:02,  2.76s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9514, 'compress@10': 1.0, 'time@10': 3.6651}: 100%|██████████| 10/10 [00:26<00:00,  3.02s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0089, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9514, 'compress@10': 1.0, 'time@10': 3.6651}: 100%|██████████| 10/10 [00:26<00:00,  2.60s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.008888319180521421
Avg hit ratio: 0.9084815239467192
Avg ndcg: 0.9513717452111441
Avg compression ratio: 1.0
Avg train time: 3.665089964866638
Std train time: 1.9432161715228935
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9351, 'compress@10': 1.0, 'time@10': 3.2409}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0224, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9351, 'compress@10': 1.0, 'time@10': 3.2409}:  10%|█         | 1/10 [00:01<00:14,  1.66s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9496, 'compress@10': 1.0, 'time@10': 2.9601}:  10%|█         | 1/10 [00:04<00:14,  1.66s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9496, 'compress@10': 1.0, 'time@10': 2.9601}:  20%|██        | 2/10 [00:04<00:18,  2.28s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9166, 'compress@10': 1.0, 'time@10': 2.2702}:  20%|██        | 2/10 [00:04<00:18,  2.28s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9166, 'compress@10': 1.0, 'time@10': 2.2702}:  30%|███       | 3/10 [00:04<00:10,  1.46s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9251, 'compress@10': 1.0, 'time@10': 2.2263}:  30%|███       | 3/10 [00:06<00:10,  1.46s/it] {'epoch': 38, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9251, 'compress@10': 1.0, 'time@10': 2.2263}:  40%|████      | 4/10 [00:06<00:10,  1.72s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9419, 'compress@10': 1.0, 'time@10': 3.3873}:  40%|████      | 4/10 [00:11<00:10,  1.72s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8682, 'ndcg@10': 0.9419, 'compress@10': 1.0, 'time@10': 3.3873}:  50%|█████     | 5/10 [00:11<00:12,  2.56s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 3.4305}:  50%|█████     | 5/10 [00:14<00:12,  2.56s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8865, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 3.4305}:  60%|██████    | 6/10 [00:14<00:11,  2.95s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9465, 'compress@10': 1.0, 'time@10': 3.5289}:  60%|██████    | 6/10 [00:16<00:11,  2.95s/it] {'epoch': 38, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.897, 'ndcg@10': 0.9465, 'compress@10': 1.0, 'time@10': 3.5289}:  70%|███████   | 7/10 [00:16<00:08,  2.67s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9536, 'compress@10': 1.0, 'time@10': 3.4517}:  70%|███████   | 7/10 [00:19<00:08,  2.67s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0155, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9536, 'compress@10': 1.0, 'time@10': 3.4517}:  80%|████████  | 8/10 [00:19<00:05,  2.76s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 3.7048}:  80%|████████  | 8/10 [00:22<00:05,  2.76s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0164, 'hit_ratio@10': 0.8881, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 3.7048}:  90%|█████████ | 9/10 [00:22<00:02,  2.80s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.897, 'ndcg@10': 0.953, 'compress@10': 1.0, 'time@10': 3.6924}:  90%|█████████ | 9/10 [00:26<00:02,  2.80s/it]     {'epoch': 38, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.897, 'ndcg@10': 0.953, 'compress@10': 1.0, 'time@10': 3.6924}: 100%|██████████| 10/10 [00:26<00:00,  3.06s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0161, 'hit_ratio@10': 0.897, 'ndcg@10': 0.953, 'compress@10': 1.0, 'time@10': 3.6924}: 100%|██████████| 10/10 [00:26<00:00,  2.63s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.016093890972377806
Avg hit ratio: 0.8970299110434935
Avg ndcg: 0.9529731394485468
Avg compression ratio: 1.0
Avg train time: 3.692446541786194
Std train time: 1.8818942389947233
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.926, 'compress@10': 1.0, 'time@10': 3.314}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.926, 'compress@10': 1.0, 'time@10': 3.314}:  10%|█         | 1/10 [00:01<00:15,  1.69s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 2.9311}:  10%|█         | 1/10 [00:04<00:15,  1.69s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0064, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 2.9311}:  20%|██        | 2/10 [00:04<00:17,  2.22s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9148, 'compress@10': 1.0, 'time@10': 2.2793}:  20%|██        | 2/10 [00:04<00:17,  2.22s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0048, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9148, 'compress@10': 1.0, 'time@10': 2.2793}:  30%|███       | 3/10 [00:04<00:10,  1.44s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9252, 'compress@10': 1.0, 'time@10': 2.2725}:  30%|███       | 3/10 [00:07<00:10,  1.44s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.007, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9252, 'compress@10': 1.0, 'time@10': 2.2725}:  40%|████      | 4/10 [00:07<00:10,  1.78s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0083, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.935, 'compress@10': 1.0, 'time@10': 3.414}:  40%|████      | 4/10 [00:11<00:10,  1.78s/it] {'epoch': 39, 'num_users': 5.8, 'loss': 0.0083, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.935, 'compress@10': 1.0, 'time@10': 3.414}:  50%|█████     | 5/10 [00:11<00:12,  2.59s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9417, 'compress@10': 1.0, 'time@10': 3.4593}:  50%|█████     | 5/10 [00:14<00:12,  2.59s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9417, 'compress@10': 1.0, 'time@10': 3.4593}:  60%|██████    | 6/10 [00:14<00:11,  2.97s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0068, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9438, 'compress@10': 1.0, 'time@10': 3.5478}:  60%|██████    | 6/10 [00:16<00:11,  2.97s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0068, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9438, 'compress@10': 1.0, 'time@10': 3.5478}:  70%|███████   | 7/10 [00:16<00:08,  2.68s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0081, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 3.4561}:  70%|███████   | 7/10 [00:19<00:08,  2.68s/it]  {'epoch': 39, 'num_users': 6.125, 'loss': 0.0081, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9409, 'compress@10': 1.0, 'time@10': 3.4561}:  80%|████████  | 8/10 [00:19<00:05,  2.74s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9456, 'compress@10': 1.0, 'time@10': 3.7168}:  80%|████████  | 8/10 [00:22<00:05,  2.74s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0092, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9456, 'compress@10': 1.0, 'time@10': 3.7168}:  90%|█████████ | 9/10 [00:22<00:02,  2.80s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0104, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.945, 'compress@10': 1.0, 'time@10': 3.7023}:  90%|█████████ | 9/10 [00:26<00:02,  2.80s/it]    {'epoch': 39, 'num_users': 6.3, 'loss': 0.0104, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.945, 'compress@10': 1.0, 'time@10': 3.7023}: 100%|██████████| 10/10 [00:26<00:00,  3.05s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0104, 'hit_ratio@10': 0.9071, 'ndcg@10': 0.945, 'compress@10': 1.0, 'time@10': 3.7023}: 100%|██████████| 10/10 [00:26<00:00,  2.63s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.010368232118202163
Avg hit ratio: 0.9070934031069854
Avg ndcg: 0.9450057000169435
Avg compression ratio: 1.0
Avg train time: 3.7023218631744386
Std train time: 1.8621822541901694
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9431, 'compress@10': 1.0, 'time@10': 3.0952}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0098, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9431, 'compress@10': 1.0, 'time@10': 3.0952}:  10%|█         | 1/10 [00:01<00:14,  1.58s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9554, 'compress@10': 1.0, 'time@10': 2.8006}:  10%|█         | 1/10 [00:04<00:14,  1.58s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9554, 'compress@10': 1.0, 'time@10': 2.8006}:  20%|██        | 2/10 [00:04<00:17,  2.15s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9205, 'compress@10': 1.0, 'time@10': 2.1855}:  20%|██        | 2/10 [00:04<00:17,  2.15s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0051, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9205, 'compress@10': 1.0, 'time@10': 2.1855}:  30%|███       | 3/10 [00:04<00:09,  1.40s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9298, 'compress@10': 1.0, 'time@10': 2.2053}:  30%|███       | 3/10 [00:06<00:09,  1.40s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9298, 'compress@10': 1.0, 'time@10': 2.2053}:  40%|████      | 4/10 [00:06<00:10,  1.76s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0084, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9399, 'compress@10': 1.0, 'time@10': 3.3995}:  40%|████      | 4/10 [00:11<00:10,  1.76s/it]  {'epoch': 40, 'num_users': 5.8, 'loss': 0.0084, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9399, 'compress@10': 1.0, 'time@10': 3.3995}:  50%|█████     | 5/10 [00:11<00:13,  2.61s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9459, 'compress@10': 1.0, 'time@10': 3.4247}:  50%|█████     | 5/10 [00:14<00:13,  2.61s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0086, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9459, 'compress@10': 1.0, 'time@10': 3.4247}:  60%|██████    | 6/10 [00:14<00:11,  2.94s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9471, 'compress@10': 1.0, 'time@10': 3.5127}:  60%|██████    | 6/10 [00:16<00:11,  2.94s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.9471, 'compress@10': 1.0, 'time@10': 3.5127}:  70%|███████   | 7/10 [00:16<00:07,  2.65s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 3.4368}:  70%|███████   | 7/10 [00:19<00:07,  2.65s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0099, 'hit_ratio@10': 0.9074, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 3.4368}:  80%|████████  | 8/10 [00:19<00:05,  2.75s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9441, 'compress@10': 1.0, 'time@10': 3.6868}:  80%|████████  | 8/10 [00:22<00:05,  2.75s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0153, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9441, 'compress@10': 1.0, 'time@10': 3.6868}:  90%|█████████ | 9/10 [00:22<00:02,  2.79s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 3.6766}:  90%|█████████ | 9/10 [00:26<00:02,  2.79s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 3.6766}: 100%|██████████| 10/10 [00:26<00:00,  3.04s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0139, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 3.6766}: 100%|██████████| 10/10 [00:26<00:00,  2.62s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.013872530923285867
Avg hit ratio: 0.8950529525181479
Avg ndcg: 0.947411176627806
Avg compression ratio: 1.0
Avg train time: 3.6765568971633913
Std train time: 1.9012087994074698
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9339, 'compress@10': 1.0, 'time@10': 3.0645}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0164, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9339, 'compress@10': 1.0, 'time@10': 3.0645}:  10%|█         | 1/10 [00:01<00:14,  1.57s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.949, 'compress@10': 1.0, 'time@10': 2.7081}:  10%|█         | 1/10 [00:03<00:14,  1.57s/it] {'epoch': 41, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.949, 'compress@10': 1.0, 'time@10': 2.7081}:  20%|██        | 2/10 [00:03<00:16,  2.05s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9162, 'compress@10': 1.0, 'time@10': 2.0953}:  20%|██        | 2/10 [00:04<00:16,  2.05s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0094, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9162, 'compress@10': 1.0, 'time@10': 2.0953}:  30%|███       | 3/10 [00:04<00:09,  1.33s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9238, 'compress@10': 1.0, 'time@10': 2.071}:  30%|███       | 3/10 [00:06<00:09,  1.33s/it]  {'epoch': 41, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9238, 'compress@10': 1.0, 'time@10': 2.071}:  40%|████      | 4/10 [00:06<00:09,  1.61s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9342, 'compress@10': 1.0, 'time@10': 3.2919}:  40%|████      | 4/10 [00:10<00:09,  1.61s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0119, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9342, 'compress@10': 1.0, 'time@10': 3.2919}:  50%|█████     | 5/10 [00:10<00:12,  2.52s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 3.3716}:  50%|█████     | 5/10 [00:14<00:12,  2.52s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0146, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9447, 'compress@10': 1.0, 'time@10': 3.3716}:  60%|██████    | 6/10 [00:14<00:11,  2.95s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9441, 'compress@10': 1.0, 'time@10': 3.4397}:  60%|██████    | 6/10 [00:16<00:11,  2.95s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0147, 'hit_ratio@10': 0.9033, 'ndcg@10': 0.9441, 'compress@10': 1.0, 'time@10': 3.4397}:  70%|███████   | 7/10 [00:16<00:07,  2.63s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0162, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9433, 'compress@10': 1.0, 'time@10': 3.3546}:  70%|███████   | 7/10 [00:19<00:07,  2.63s/it] {'epoch': 41, 'num_users': 6.125, 'loss': 0.0162, 'hit_ratio@10': 0.9118, 'ndcg@10': 0.9433, 'compress@10': 1.0, 'time@10': 3.3546}:  80%|████████  | 8/10 [00:19<00:05,  2.68s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9583, 'compress@10': 1.0, 'time@10': 3.6103}:  80%|████████  | 8/10 [00:22<00:05,  2.68s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0176, 'hit_ratio@10': 0.8994, 'ndcg@10': 0.9583, 'compress@10': 1.0, 'time@10': 3.6103}:  90%|█████████ | 9/10 [00:22<00:02,  2.74s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.9606, 'compress@10': 1.0, 'time@10': 3.6021}:  90%|█████████ | 9/10 [00:25<00:02,  2.74s/it]   {'epoch': 41, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.9606, 'compress@10': 1.0, 'time@10': 3.6021}: 100%|██████████| 10/10 [00:25<00:00,  3.00s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0177, 'hit_ratio@10': 0.9072, 'ndcg@10': 0.9606, 'compress@10': 1.0, 'time@10': 3.6021}: 100%|██████████| 10/10 [00:25<00:00,  2.56s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.017667414013832976
Avg hit ratio: 0.9071958096610049
Avg ndcg: 0.960631251079025
Avg compression ratio: 1.0
Avg train time: 3.6021316289901733
Std train time: 1.9449686966037418
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 3.1545}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 3.1545}:  10%|█         | 1/10 [00:01<00:14,  1.62s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9575, 'compress@10': 1.0, 'time@10': 2.8441}:  10%|█         | 1/10 [00:04<00:14,  1.62s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9575, 'compress@10': 1.0, 'time@10': 2.8441}:  20%|██        | 2/10 [00:04<00:17,  2.18s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9219, 'compress@10': 1.0, 'time@10': 2.2267}:  20%|██        | 2/10 [00:04<00:17,  2.18s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0144, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9219, 'compress@10': 1.0, 'time@10': 2.2267}:  30%|███       | 3/10 [00:04<00:09,  1.43s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9286, 'compress@10': 1.0, 'time@10': 2.224}:  30%|███       | 3/10 [00:06<00:09,  1.43s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9286, 'compress@10': 1.0, 'time@10': 2.224}:  40%|████      | 4/10 [00:06<00:10,  1.75s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9374, 'compress@10': 1.0, 'time@10': 3.3253}:  40%|████      | 4/10 [00:10<00:10,  1.75s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0146, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9374, 'compress@10': 1.0, 'time@10': 3.3253}:  50%|█████     | 5/10 [00:10<00:12,  2.53s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.944, 'compress@10': 1.0, 'time@10': 3.3749}:  50%|█████     | 5/10 [00:14<00:12,  2.53s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0129, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.944, 'compress@10': 1.0, 'time@10': 3.3749}:  60%|██████    | 6/10 [00:14<00:11,  2.91s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9457, 'compress@10': 1.0, 'time@10': 3.4649}:  60%|██████    | 6/10 [00:16<00:11,  2.91s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0115, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9457, 'compress@10': 1.0, 'time@10': 3.4649}:  70%|███████   | 7/10 [00:16<00:07,  2.63s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.3799}:  70%|███████   | 7/10 [00:19<00:07,  2.63s/it]  {'epoch': 42, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.3799}:  80%|████████  | 8/10 [00:19<00:05,  2.69s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9548, 'compress@10': 1.0, 'time@10': 3.6085}:  80%|████████  | 8/10 [00:22<00:05,  2.69s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0136, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9548, 'compress@10': 1.0, 'time@10': 3.6085}:  90%|█████████ | 9/10 [00:22<00:02,  2.71s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9545, 'compress@10': 1.0, 'time@10': 3.6038}:  90%|█████████ | 9/10 [00:25<00:02,  2.71s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9545, 'compress@10': 1.0, 'time@10': 3.6038}: 100%|██████████| 10/10 [00:25<00:00,  3.04s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0142, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.9545, 'compress@10': 1.0, 'time@10': 3.6038}: 100%|██████████| 10/10 [00:25<00:00,  2.59s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.014197331775264197
Avg hit ratio: 0.9013791173926997
Avg ndcg: 0.9544767620618442
Avg compression ratio: 1.0
Avg train time: 3.6037597179412844
Std train time: 1.769805291760918
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0044, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9398, 'compress@10': 1.0, 'time@10': 3.171}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0044, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9398, 'compress@10': 1.0, 'time@10': 3.171}:  10%|█         | 1/10 [00:01<00:14,  1.63s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9811, 'compress@10': 1.0, 'time@10': 2.8632}:  10%|█         | 1/10 [00:04<00:14,  1.63s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9811, 'compress@10': 1.0, 'time@10': 2.8632}:  20%|██        | 2/10 [00:04<00:17,  2.19s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9376, 'compress@10': 1.0, 'time@10': 2.2346}:  20%|██        | 2/10 [00:04<00:17,  2.19s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0166, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9376, 'compress@10': 1.0, 'time@10': 2.2346}:  30%|███       | 3/10 [00:04<00:10,  1.43s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9431, 'compress@10': 1.0, 'time@10': 2.2267}:  30%|███       | 3/10 [00:06<00:10,  1.43s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.9431, 'compress@10': 1.0, 'time@10': 2.2267}:  40%|████      | 4/10 [00:06<00:10,  1.75s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.95, 'compress@10': 1.0, 'time@10': 3.4801}:  40%|████      | 4/10 [00:11<00:10,  1.75s/it]  {'epoch': 43, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.95, 'compress@10': 1.0, 'time@10': 3.4801}:  50%|█████     | 5/10 [00:11<00:13,  2.66s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9547, 'compress@10': 1.0, 'time@10': 3.5085}:  50%|█████     | 5/10 [00:14<00:13,  2.66s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9547, 'compress@10': 1.0, 'time@10': 3.5085}:  60%|██████    | 6/10 [00:14<00:12,  3.01s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9543, 'compress@10': 1.0, 'time@10': 3.5978}:  60%|██████    | 6/10 [00:17<00:12,  3.01s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0154, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.9543, 'compress@10': 1.0, 'time@10': 3.5978}:  70%|███████   | 7/10 [00:17<00:08,  2.72s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9628, 'compress@10': 1.0, 'time@10': 3.5088}:  70%|███████   | 7/10 [00:19<00:08,  2.72s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0153, 'hit_ratio@10': 0.9091, 'ndcg@10': 0.9628, 'compress@10': 1.0, 'time@10': 3.5088}:  80%|████████  | 8/10 [00:19<00:05,  2.78s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9603, 'compress@10': 1.0, 'time@10': 3.7513}:  80%|████████  | 8/10 [00:22<00:05,  2.78s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0157, 'hit_ratio@10': 0.8969, 'ndcg@10': 0.9603, 'compress@10': 1.0, 'time@10': 3.7513}:  90%|█████████ | 9/10 [00:22<00:02,  2.81s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.905, 'ndcg@10': 0.962, 'compress@10': 1.0, 'time@10': 3.7474}:  90%|█████████ | 9/10 [00:26<00:02,  2.81s/it]     {'epoch': 43, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.905, 'ndcg@10': 0.962, 'compress@10': 1.0, 'time@10': 3.7474}: 100%|██████████| 10/10 [00:26<00:00,  3.10s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0143, 'hit_ratio@10': 0.905, 'ndcg@10': 0.962, 'compress@10': 1.0, 'time@10': 3.7474}: 100%|██████████| 10/10 [00:26<00:00,  2.66s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.01431747303240547
Avg hit ratio: 0.9049735874387826
Avg ndcg: 0.961955057559105
Avg compression ratio: 1.0
Avg train time: 3.7473955392837524
Std train time: 1.975376944226219
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9452, 'compress@10': 1.0, 'time@10': 3.1079}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0091, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9452, 'compress@10': 1.0, 'time@10': 3.1079}:  10%|█         | 1/10 [00:01<00:14,  1.60s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9673, 'compress@10': 1.0, 'time@10': 2.8486}:  10%|█         | 1/10 [00:04<00:14,  1.60s/it] {'epoch': 44, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9673, 'compress@10': 1.0, 'time@10': 2.8486}:  20%|██        | 2/10 [00:04<00:17,  2.20s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9284, 'compress@10': 1.0, 'time@10': 2.2313}:  20%|██        | 2/10 [00:04<00:17,  2.20s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9284, 'compress@10': 1.0, 'time@10': 2.2313}:  30%|███       | 3/10 [00:04<00:10,  1.44s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9362, 'compress@10': 1.0, 'time@10': 2.2403}:  30%|███       | 3/10 [00:07<00:10,  1.44s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9362, 'compress@10': 1.0, 'time@10': 2.2403}:  40%|████      | 4/10 [00:07<00:10,  1.78s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9455, 'compress@10': 1.0, 'time@10': 3.4825}:  40%|████      | 4/10 [00:11<00:10,  1.78s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9455, 'compress@10': 1.0, 'time@10': 3.4825}:  50%|█████     | 5/10 [00:11<00:13,  2.68s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9506, 'compress@10': 1.0, 'time@10': 3.527}:  50%|█████     | 5/10 [00:15<00:13,  2.68s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0106, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9506, 'compress@10': 1.0, 'time@10': 3.527}:  60%|██████    | 6/10 [00:15<00:12,  3.05s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9505, 'compress@10': 1.0, 'time@10': 3.6401}:  60%|██████    | 6/10 [00:17<00:12,  3.05s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0108, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9505, 'compress@10': 1.0, 'time@10': 3.6401}:  70%|███████   | 7/10 [00:17<00:08,  2.78s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 3.5395}:  70%|███████   | 7/10 [00:20<00:08,  2.78s/it]  {'epoch': 44, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 3.5395}:  80%|████████  | 8/10 [00:20<00:05,  2.81s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0103, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9534, 'compress@10': 1.0, 'time@10': 3.814}:  80%|████████  | 8/10 [00:23<00:05,  2.81s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0103, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9534, 'compress@10': 1.0, 'time@10': 3.814}:  90%|█████████ | 9/10 [00:23<00:02,  2.88s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9558, 'compress@10': 1.0, 'time@10': 3.7775}:  90%|█████████ | 9/10 [00:26<00:02,  2.88s/it]  {'epoch': 44, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9558, 'compress@10': 1.0, 'time@10': 3.7775}: 100%|██████████| 10/10 [00:26<00:00,  3.07s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0095, 'hit_ratio@10': 0.896, 'ndcg@10': 0.9558, 'compress@10': 1.0, 'time@10': 3.7775}: 100%|██████████| 10/10 [00:26<00:00,  2.67s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.009477870666583402
Avg hit ratio: 0.8960334952728841
Avg ndcg: 0.9557623742245094
Avg compression ratio: 1.0
Avg train time: 3.7774866104125975
Std train time: 1.9997784440670296
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9387, 'compress@10': 1.0, 'time@10': 3.1661}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0073, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9387, 'compress@10': 1.0, 'time@10': 3.1661}:  10%|█         | 1/10 [00:01<00:14,  1.62s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9532, 'compress@10': 1.0, 'time@10': 2.9179}:  10%|█         | 1/10 [00:04<00:14,  1.62s/it] {'epoch': 45, 'num_users': 7.0, 'loss': 0.005, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9532, 'compress@10': 1.0, 'time@10': 2.9179}:  20%|██        | 2/10 [00:04<00:18,  2.26s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 2.2776}:  20%|██        | 2/10 [00:04<00:18,  2.26s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0037, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.919, 'compress@10': 1.0, 'time@10': 2.2776}:  30%|███       | 3/10 [00:04<00:10,  1.47s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9287, 'compress@10': 1.0, 'time@10': 2.2702}:  30%|███       | 3/10 [00:07<00:10,  1.47s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.006, 'hit_ratio@10': 0.8402, 'ndcg@10': 0.9287, 'compress@10': 1.0, 'time@10': 2.2702}:  40%|████      | 4/10 [00:07<00:10,  1.79s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9392, 'compress@10': 1.0, 'time@10': 3.5379}:  40%|████      | 4/10 [00:11<00:10,  1.79s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0081, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.9392, 'compress@10': 1.0, 'time@10': 3.5379}:  50%|█████     | 5/10 [00:11<00:13,  2.71s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9439, 'compress@10': 1.0, 'time@10': 3.5734}:  50%|█████     | 5/10 [00:15<00:13,  2.71s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0112, 'hit_ratio@10': 0.8794, 'ndcg@10': 0.9439, 'compress@10': 1.0, 'time@10': 3.5734}:  60%|██████    | 6/10 [00:15<00:12,  3.08s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9462, 'compress@10': 1.0, 'time@10': 3.6209}:  60%|██████    | 6/10 [00:17<00:12,  3.08s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8909, 'ndcg@10': 0.9462, 'compress@10': 1.0, 'time@10': 3.6209}:  70%|███████   | 7/10 [00:17<00:08,  2.72s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 3.4907}:  70%|███████   | 7/10 [00:19<00:08,  2.72s/it]  {'epoch': 45, 'num_users': 6.125, 'loss': 0.0107, 'hit_ratio@10': 0.901, 'ndcg@10': 0.9498, 'compress@10': 1.0, 'time@10': 3.4907}:  80%|████████  | 8/10 [00:19<00:05,  2.69s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.95, 'compress@10': 1.0, 'time@10': 3.7078}:  80%|████████  | 8/10 [00:22<00:05,  2.69s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0112, 'hit_ratio@10': 0.8898, 'ndcg@10': 0.95, 'compress@10': 1.0, 'time@10': 3.7078}:  90%|█████████ | 9/10 [00:22<00:02,  2.71s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9496, 'compress@10': 1.0, 'time@10': 3.6849}:  90%|█████████ | 9/10 [00:26<00:02,  2.71s/it] {'epoch': 45, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9496, 'compress@10': 1.0, 'time@10': 3.6849}: 100%|██████████| 10/10 [00:26<00:00,  2.96s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0122, 'hit_ratio@10': 0.8985, 'ndcg@10': 0.9496, 'compress@10': 1.0, 'time@10': 3.6849}: 100%|██████████| 10/10 [00:26<00:00,  2.62s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.012186327941376574
Avg hit ratio: 0.8985219745355568
Avg ndcg: 0.9496494872475318
Avg compression ratio: 1.0
Avg train time: 3.6849002122879027
Std train time: 1.9811662486060253
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9539, 'compress@10': 1.0, 'time@10': 3.1583}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0215, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9539, 'compress@10': 1.0, 'time@10': 3.1583}:  10%|█         | 1/10 [00:01<00:14,  1.61s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9608, 'compress@10': 1.0, 'time@10': 2.8585}:  10%|█         | 1/10 [00:04<00:14,  1.61s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.9576, 'ndcg@10': 0.9608, 'compress@10': 1.0, 'time@10': 2.8585}:  20%|██        | 2/10 [00:04<00:17,  2.19s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9241, 'compress@10': 1.0, 'time@10': 2.2162}:  20%|██        | 2/10 [00:04<00:17,  2.19s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.9241, 'compress@10': 1.0, 'time@10': 2.2162}:  30%|███       | 3/10 [00:04<00:09,  1.42s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9333, 'compress@10': 1.0, 'time@10': 2.2245}:  30%|███       | 3/10 [00:06<00:09,  1.42s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0092, 'hit_ratio@10': 0.8806, 'ndcg@10': 0.9333, 'compress@10': 1.0, 'time@10': 2.2245}:  40%|████      | 4/10 [00:06<00:10,  1.76s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9428, 'compress@10': 1.0, 'time@10': 3.4528}:  40%|████      | 4/10 [00:11<00:10,  1.76s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0094, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.9428, 'compress@10': 1.0, 'time@10': 3.4528}:  50%|█████     | 5/10 [00:11<00:13,  2.65s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.4559}:  50%|█████     | 5/10 [00:14<00:13,  2.65s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.9063, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.4559}:  60%|██████    | 6/10 [00:14<00:11,  2.94s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 3.4996}:  60%|██████    | 6/10 [00:16<00:11,  2.94s/it] {'epoch': 46, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 3.4996}:  70%|███████   | 7/10 [00:16<00:07,  2.61s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9212, 'ndcg@10': 0.9614, 'compress@10': 1.0, 'time@10': 3.4219}:  70%|███████   | 7/10 [00:19<00:07,  2.61s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0121, 'hit_ratio@10': 0.9212, 'ndcg@10': 0.9614, 'compress@10': 1.0, 'time@10': 3.4219}:  80%|████████  | 8/10 [00:19<00:05,  2.70s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9651, 'compress@10': 1.0, 'time@10': 3.6952}:  80%|████████  | 8/10 [00:22<00:05,  2.70s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.914, 'ndcg@10': 0.9651, 'compress@10': 1.0, 'time@10': 3.6952}:  90%|█████████ | 9/10 [00:22<00:02,  2.79s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9204, 'ndcg@10': 0.9663, 'compress@10': 1.0, 'time@10': 3.6898}:  90%|█████████ | 9/10 [00:26<00:02,  2.79s/it]  {'epoch': 46, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9204, 'ndcg@10': 0.9663, 'compress@10': 1.0, 'time@10': 3.6898}: 100%|██████████| 10/10 [00:26<00:00,  3.06s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9204, 'ndcg@10': 0.9663, 'compress@10': 1.0, 'time@10': 3.6898}: 100%|██████████| 10/10 [00:26<00:00,  2.62s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.011699829465390872
Avg hit ratio: 0.9203652925079071
Avg ndcg: 0.9662896558887623
Avg compression ratio: 1.0
Avg train time: 3.68976776599884
Std train time: 1.965415795098902
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 2.9979}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0094, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 2.9979}:  10%|█         | 1/10 [00:01<00:13,  1.53s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9582, 'compress@10': 1.0, 'time@10': 2.7561}:  10%|█         | 1/10 [00:04<00:13,  1.53s/it] {'epoch': 47, 'num_users': 7.0, 'loss': 0.0061, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9582, 'compress@10': 1.0, 'time@10': 2.7561}:  20%|██        | 2/10 [00:04<00:17,  2.15s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0044, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 2.1567}:  20%|██        | 2/10 [00:04<00:17,  2.15s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0044, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 2.1567}:  30%|███       | 3/10 [00:04<00:09,  1.40s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9316, 'compress@10': 1.0, 'time@10': 2.177}:  30%|███       | 3/10 [00:06<00:09,  1.40s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.9316, 'compress@10': 1.0, 'time@10': 2.177}:  40%|████      | 4/10 [00:06<00:10,  1.75s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9407, 'compress@10': 1.0, 'time@10': 3.4666}:  40%|████      | 4/10 [00:11<00:10,  1.75s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9407, 'compress@10': 1.0, 'time@10': 3.4666}:  50%|█████     | 5/10 [00:11<00:13,  2.69s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9465, 'compress@10': 1.0, 'time@10': 3.5046}:  50%|█████     | 5/10 [00:14<00:13,  2.69s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0088, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9465, 'compress@10': 1.0, 'time@10': 3.5046}:  60%|██████    | 6/10 [00:14<00:12,  3.04s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9478, 'compress@10': 1.0, 'time@10': 3.5866}:  60%|██████    | 6/10 [00:17<00:12,  3.04s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0093, 'hit_ratio@10': 0.8955, 'ndcg@10': 0.9478, 'compress@10': 1.0, 'time@10': 3.5866}:  70%|███████   | 7/10 [00:17<00:08,  2.73s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9452, 'compress@10': 1.0, 'time@10': 3.4942}:  70%|███████   | 7/10 [00:19<00:08,  2.73s/it]  {'epoch': 47, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.905, 'ndcg@10': 0.9452, 'compress@10': 1.0, 'time@10': 3.4942}:  80%|████████  | 8/10 [00:19<00:05,  2.79s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.7522}:  80%|████████  | 8/10 [00:22<00:05,  2.79s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0161, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.9479, 'compress@10': 1.0, 'time@10': 3.7522}:  90%|█████████ | 9/10 [00:22<00:02,  2.84s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9503, 'compress@10': 1.0, 'time@10': 3.7373}:  90%|█████████ | 9/10 [00:26<00:02,  2.84s/it]   {'epoch': 47, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9503, 'compress@10': 1.0, 'time@10': 3.7373}: 100%|██████████| 10/10 [00:26<00:00,  3.09s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9503, 'compress@10': 1.0, 'time@10': 3.7373}: 100%|██████████| 10/10 [00:26<00:00,  2.66s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.015384532949940933
Avg hit ratio: 0.8931763524157412
Avg ndcg: 0.9503050103179753
Avg compression ratio: 1.0
Avg train time: 3.737309956550598
Std train time: 2.02860305383314
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 3.076}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0082, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 3.076}:  10%|█         | 1/10 [00:01<00:14,  1.58s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9524, 'compress@10': 1.0, 'time@10': 2.7487}:  10%|█         | 1/10 [00:04<00:14,  1.58s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9524, 'compress@10': 1.0, 'time@10': 2.7487}:  20%|██        | 2/10 [00:04<00:16,  2.10s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9185, 'compress@10': 1.0, 'time@10': 2.1621}:  20%|██        | 2/10 [00:04<00:16,  2.10s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0056, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9185, 'compress@10': 1.0, 'time@10': 2.1621}:  30%|███       | 3/10 [00:04<00:09,  1.38s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 2.2097}:  30%|███       | 3/10 [00:06<00:09,  1.38s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0073, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9291, 'compress@10': 1.0, 'time@10': 2.2097}:  40%|████      | 4/10 [00:06<00:10,  1.78s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9394, 'compress@10': 1.0, 'time@10': 3.4734}:  40%|████      | 4/10 [00:11<00:10,  1.78s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0079, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9394, 'compress@10': 1.0, 'time@10': 3.4734}:  50%|█████     | 5/10 [00:11<00:13,  2.69s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9455, 'compress@10': 1.0, 'time@10': 3.545}:  50%|█████     | 5/10 [00:15<00:13,  2.69s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0083, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9455, 'compress@10': 1.0, 'time@10': 3.545}:  60%|██████    | 6/10 [00:15<00:12,  3.12s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9476, 'compress@10': 1.0, 'time@10': 3.6143}:  60%|██████    | 6/10 [00:17<00:12,  3.12s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0076, 'hit_ratio@10': 0.8766, 'ndcg@10': 0.9476, 'compress@10': 1.0, 'time@10': 3.6143}:  70%|███████   | 7/10 [00:17<00:08,  2.77s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9505, 'compress@10': 1.0, 'time@10': 3.522}:  70%|███████   | 7/10 [00:20<00:08,  2.77s/it]  {'epoch': 48, 'num_users': 6.125, 'loss': 0.0076, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.9505, 'compress@10': 1.0, 'time@10': 3.522}:  80%|████████  | 8/10 [00:20<00:05,  2.82s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0084, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9527, 'compress@10': 1.0, 'time@10': 3.7758}:  80%|████████  | 8/10 [00:23<00:05,  2.82s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0084, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.9527, 'compress@10': 1.0, 'time@10': 3.7758}:  90%|█████████ | 9/10 [00:23<00:02,  2.86s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9581, 'compress@10': 1.0, 'time@10': 3.7636}:  90%|█████████ | 9/10 [00:26<00:02,  2.86s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9581, 'compress@10': 1.0, 'time@10': 3.7636}: 100%|██████████| 10/10 [00:26<00:00,  3.12s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0096, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9581, 'compress@10': 1.0, 'time@10': 3.7636}: 100%|██████████| 10/10 [00:26<00:00,  2.68s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.00956153039545323
Avg hit ratio: 0.8856085080737033
Avg ndcg: 0.9581072625173593
Avg compression ratio: 1.0
Avg train time: 3.7635934352874756
Std train time: 1.9932684006573915
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 3.3462}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 3.3462}:  10%|█         | 1/10 [00:01<00:15,  1.71s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 1.0, 'time@10': 2.9771}:  10%|█         | 1/10 [00:04<00:15,  1.71s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9576, 'compress@10': 1.0, 'time@10': 2.9771}:  20%|██        | 2/10 [00:04<00:18,  2.26s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9241, 'compress@10': 1.0, 'time@10': 2.3303}:  20%|██        | 2/10 [00:04<00:18,  2.26s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9241, 'compress@10': 1.0, 'time@10': 2.3303}:  30%|███       | 3/10 [00:04<00:10,  1.49s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9338, 'compress@10': 1.0, 'time@10': 2.2754}:  30%|███       | 3/10 [00:07<00:10,  1.49s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.9338, 'compress@10': 1.0, 'time@10': 2.2754}:  40%|████      | 4/10 [00:07<00:10,  1.75s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9426, 'compress@10': 1.0, 'time@10': 3.5925}:  40%|████      | 4/10 [00:11<00:10,  1.75s/it]  {'epoch': 49, 'num_users': 5.8, 'loss': 0.0082, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9426, 'compress@10': 1.0, 'time@10': 3.5925}:  50%|█████     | 5/10 [00:11<00:13,  2.74s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9485, 'compress@10': 1.0, 'time@10': 3.632}:  50%|█████     | 5/10 [00:15<00:13,  2.74s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9485, 'compress@10': 1.0, 'time@10': 3.632}:  60%|██████    | 6/10 [00:15<00:12,  3.12s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9504, 'compress@10': 1.0, 'time@10': 3.6863}:  60%|██████    | 6/10 [00:17<00:12,  3.12s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0105, 'hit_ratio@10': 0.8919, 'ndcg@10': 0.9504, 'compress@10': 1.0, 'time@10': 3.6863}:  70%|███████   | 7/10 [00:17<00:08,  2.77s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9571, 'compress@10': 1.0, 'time@10': 3.5897}:  70%|███████   | 7/10 [00:20<00:08,  2.77s/it] {'epoch': 49, 'num_users': 6.125, 'loss': 0.0115, 'hit_ratio@10': 0.9018, 'ndcg@10': 0.9571, 'compress@10': 1.0, 'time@10': 3.5897}:  80%|████████  | 8/10 [00:20<00:05,  2.83s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9583, 'compress@10': 1.0, 'time@10': 3.8314}:  80%|████████  | 8/10 [00:23<00:05,  2.83s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0113, 'hit_ratio@10': 0.8905, 'ndcg@10': 0.9583, 'compress@10': 1.0, 'time@10': 3.8314}:  90%|█████████ | 9/10 [00:23<00:02,  2.86s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9602, 'compress@10': 1.0, 'time@10': 3.8145}:  90%|█████████ | 9/10 [00:27<00:02,  2.86s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9602, 'compress@10': 1.0, 'time@10': 3.8145}: 100%|██████████| 10/10 [00:27<00:00,  3.12s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0105, 'hit_ratio@10': 0.8992, 'ndcg@10': 0.9602, 'compress@10': 1.0, 'time@10': 3.8145}: 100%|██████████| 10/10 [00:27<00:00,  2.70s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.010480337827840417
Avg hit ratio: 0.899179936645132
Avg ndcg: 0.9601716175199805
Avg compression ratio: 1.0
Avg train time: 3.8145191192626955
Std train time: 2.060118207685699
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
