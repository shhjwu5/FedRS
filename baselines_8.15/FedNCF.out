  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1621, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.505, 'compress@10': 1.0, 'time@10': 3.4108}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1621, 'hit_ratio@10': 0.5263, 'ndcg@10': 0.505, 'compress@10': 1.0, 'time@10': 3.4108}:  10%|█         | 1/10 [00:01<00:15,  1.74s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1213, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.6363, 'compress@10': 1.0, 'time@10': 2.747}:  10%|█         | 1/10 [00:03<00:15,  1.74s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1213, 'hit_ratio@10': 0.6503, 'ndcg@10': 0.6363, 'compress@10': 1.0, 'time@10': 2.747}:  20%|██        | 2/10 [00:03<00:15,  1.96s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8026, 'hit_ratio@10': 0.5764, 'ndcg@10': 0.4242, 'compress@10': 1.0, 'time@10': 2.0971}:  20%|██        | 2/10 [00:04<00:15,  1.96s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.8026, 'hit_ratio@10': 0.5764, 'ndcg@10': 0.4242, 'compress@10': 1.0, 'time@10': 2.0971}:  30%|███       | 3/10 [00:04<00:08,  1.27s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6258, 'hit_ratio@10': 0.6376, 'ndcg@10': 0.4779, 'compress@10': 1.0, 'time@10': 2.0335}:  30%|███       | 3/10 [00:06<00:08,  1.27s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.6258, 'hit_ratio@10': 0.6376, 'ndcg@10': 0.4779, 'compress@10': 1.0, 'time@10': 2.0335}:  40%|████      | 4/10 [00:06<00:09,  1.51s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5193, 'hit_ratio@10': 0.6741, 'ndcg@10': 0.5333, 'compress@10': 1.0, 'time@10': 3.0853}:  40%|████      | 4/10 [00:09<00:09,  1.51s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.5193, 'hit_ratio@10': 0.6741, 'ndcg@10': 0.5333, 'compress@10': 1.0, 'time@10': 3.0853}:  50%|█████     | 5/10 [00:09<00:11,  2.29s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4471, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.5762, 'compress@10': 1.0, 'time@10': 3.0771}:  50%|█████     | 5/10 [00:12<00:11,  2.29s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.4471, 'hit_ratio@10': 0.6766, 'ndcg@10': 0.5762, 'compress@10': 1.0, 'time@10': 3.0771}:  60%|██████    | 6/10 [00:12<00:10,  2.56s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3981, 'hit_ratio@10': 0.6828, 'ndcg@10': 0.5801, 'compress@10': 1.0, 'time@10': 3.1233}:  60%|██████    | 6/10 [00:14<00:10,  2.56s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3981, 'hit_ratio@10': 0.6828, 'ndcg@10': 0.5801, 'compress@10': 1.0, 'time@10': 3.1233}:  70%|███████   | 7/10 [00:14<00:06,  2.30s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3541, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.6073, 'compress@10': 1.0, 'time@10': 3.0173}:  70%|███████   | 7/10 [00:17<00:06,  2.30s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3541, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.6073, 'compress@10': 1.0, 'time@10': 3.0173}:  80%|████████  | 8/10 [00:17<00:04,  2.30s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3198, 'hit_ratio@10': 0.712, 'ndcg@10': 0.6411, 'compress@10': 1.0, 'time@10': 3.2284}:  80%|████████  | 8/10 [00:19<00:04,  2.30s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.3198, 'hit_ratio@10': 0.712, 'ndcg@10': 0.6411, 'compress@10': 1.0, 'time@10': 3.2284}:  90%|█████████ | 9/10 [00:19<00:02,  2.36s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2931, 'hit_ratio@10': 0.734, 'ndcg@10': 0.6608, 'compress@10': 1.0, 'time@10': 3.1992}:  90%|█████████ | 9/10 [00:22<00:02,  2.36s/it]   {'epoch': 0, 'num_users': 6.3, 'loss': 0.2931, 'hit_ratio@10': 0.734, 'ndcg@10': 0.6608, 'compress@10': 1.0, 'time@10': 3.1992}: 100%|██████████| 10/10 [00:22<00:00,  2.55s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2931, 'hit_ratio@10': 0.734, 'ndcg@10': 0.6608, 'compress@10': 1.0, 'time@10': 3.1992}: 100%|██████████| 10/10 [00:22<00:00,  2.25s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.29308401852896665
Avg hit ratio: 0.7339787837139281
Avg ndcg: 0.6608095800700653
Avg compression ratio: 1.0
Avg train time: 3.1992197275161742
Std train time: 1.7203681789227945
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0525, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8328, 'compress@10': 1.0, 'time@10': 2.4428}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0525, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8328, 'compress@10': 1.0, 'time@10': 2.4428}:  10%|█         | 1/10 [00:01<00:11,  1.26s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0528, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8435, 'compress@10': 1.0, 'time@10': 2.2304}:  10%|█         | 1/10 [00:03<00:11,  1.26s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0528, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8435, 'compress@10': 1.0, 'time@10': 2.2304}:  20%|██        | 2/10 [00:03<00:13,  1.73s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0438, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8099, 'compress@10': 1.0, 'time@10': 1.7412}:  20%|██        | 2/10 [00:03<00:13,  1.73s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0438, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8099, 'compress@10': 1.0, 'time@10': 1.7412}:  30%|███       | 3/10 [00:03<00:07,  1.13s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0454, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8181, 'compress@10': 1.0, 'time@10': 1.7478}:  30%|███       | 3/10 [00:05<00:07,  1.13s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0454, 'hit_ratio@10': 0.7927, 'ndcg@10': 0.8181, 'compress@10': 1.0, 'time@10': 1.7478}:  40%|████      | 4/10 [00:05<00:08,  1.39s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0535, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8116, 'compress@10': 1.0, 'time@10': 2.7572}:  40%|████      | 4/10 [00:08<00:08,  1.39s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0535, 'hit_ratio@10': 0.7982, 'ndcg@10': 0.8116, 'compress@10': 1.0, 'time@10': 2.7572}:  50%|█████     | 5/10 [00:08<00:10,  2.13s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0575, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8119, 'compress@10': 1.0, 'time@10': 2.8111}:  50%|█████     | 5/10 [00:12<00:10,  2.13s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0575, 'hit_ratio@10': 0.7911, 'ndcg@10': 0.8119, 'compress@10': 1.0, 'time@10': 2.8111}:  60%|██████    | 6/10 [00:12<00:09,  2.47s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0554, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8206, 'compress@10': 1.0, 'time@10': 2.913}:  60%|██████    | 6/10 [00:13<00:09,  2.47s/it] {'epoch': 1, 'num_users': 6.2857, 'loss': 0.0554, 'hit_ratio@10': 0.8152, 'ndcg@10': 0.8206, 'compress@10': 1.0, 'time@10': 2.913}:  70%|███████   | 7/10 [00:13<00:06,  2.25s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0532, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8271, 'compress@10': 1.0, 'time@10': 2.8357}:  70%|███████   | 7/10 [00:16<00:06,  2.25s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0532, 'hit_ratio@10': 0.8276, 'ndcg@10': 0.8271, 'compress@10': 1.0, 'time@10': 2.8357}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0511, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8368, 'compress@10': 1.0, 'time@10': 3.0464}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0511, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8368, 'compress@10': 1.0, 'time@10': 3.0464}:  90%|█████████ | 9/10 [00:18<00:02,  2.31s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0506, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8377, 'compress@10': 1.0, 'time@10': 3.0404}:  90%|█████████ | 9/10 [00:21<00:02,  2.31s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.0506, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8377, 'compress@10': 1.0, 'time@10': 3.0404}: 100%|██████████| 10/10 [00:21<00:00,  2.53s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0506, 'hit_ratio@10': 0.821, 'ndcg@10': 0.8377, 'compress@10': 1.0, 'time@10': 3.0404}: 100%|██████████| 10/10 [00:21<00:00,  2.16s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.050641205228130884
Avg hit ratio: 0.8209612398542789
Avg ndcg: 0.8377286073479947
Avg compression ratio: 1.0
Avg train time: 3.0404179811477663
Std train time: 1.6112215181494627
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 2.4895}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8493, 'compress@10': 1.0, 'time@10': 2.4895}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 2.3057}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it] {'epoch': 2, 'num_users': 7.0, 'loss': 0.0508, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 2.3057}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8542, 'compress@10': 1.0, 'time@10': 1.8134}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8542, 'compress@10': 1.0, 'time@10': 1.8134}:  30%|███       | 3/10 [00:03<00:08,  1.18s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0397, 'hit_ratio@10': 0.757, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 1.8181}:  30%|███       | 3/10 [00:05<00:08,  1.18s/it]  {'epoch': 2, 'num_users': 5.0, 'loss': 0.0397, 'hit_ratio@10': 0.757, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 1.8181}:  40%|████      | 4/10 [00:05<00:08,  1.45s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.048, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.841, 'compress@10': 1.0, 'time@10': 2.9096}:  40%|████      | 4/10 [00:09<00:08,  1.45s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.048, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.841, 'compress@10': 1.0, 'time@10': 2.9096}:  50%|█████     | 5/10 [00:09<00:11,  2.25s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0527, 'hit_ratio@10': 0.7632, 'ndcg@10': 0.8381, 'compress@10': 1.0, 'time@10': 2.9548}:  50%|█████     | 5/10 [00:12<00:11,  2.25s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0527, 'hit_ratio@10': 0.7632, 'ndcg@10': 0.8381, 'compress@10': 1.0, 'time@10': 2.9548}:  60%|██████    | 6/10 [00:12<00:10,  2.58s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0514, 'hit_ratio@10': 0.7913, 'ndcg@10': 0.8405, 'compress@10': 1.0, 'time@10': 2.9928}:  60%|██████    | 6/10 [00:14<00:10,  2.58s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0514, 'hit_ratio@10': 0.7913, 'ndcg@10': 0.8405, 'compress@10': 1.0, 'time@10': 2.9928}:  70%|███████   | 7/10 [00:14<00:06,  2.28s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0525, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8383, 'compress@10': 1.0, 'time@10': 2.9187}:  70%|███████   | 7/10 [00:16<00:06,  2.28s/it] {'epoch': 2, 'num_users': 6.125, 'loss': 0.0525, 'hit_ratio@10': 0.8067, 'ndcg@10': 0.8383, 'compress@10': 1.0, 'time@10': 2.9187}:  80%|████████  | 8/10 [00:16<00:04,  2.33s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0519, 'hit_ratio@10': 0.8028, 'ndcg@10': 0.8451, 'compress@10': 1.0, 'time@10': 3.1224}:  80%|████████  | 8/10 [00:19<00:04,  2.33s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0519, 'hit_ratio@10': 0.8028, 'ndcg@10': 0.8451, 'compress@10': 1.0, 'time@10': 3.1224}:  90%|█████████ | 9/10 [00:19<00:02,  2.35s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0514, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 3.0992}:  90%|█████████ | 9/10 [00:22<00:02,  2.35s/it]    {'epoch': 2, 'num_users': 6.3, 'loss': 0.0514, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 3.0992}: 100%|██████████| 10/10 [00:22<00:00,  2.53s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0514, 'hit_ratio@10': 0.8157, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 3.0992}: 100%|██████████| 10/10 [00:22<00:00,  2.21s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.051429526295787134
Avg hit ratio: 0.8156596525526917
Avg ndcg: 0.8459860247681037
Avg compression ratio: 1.0
Avg train time: 3.0991613626480103
Std train time: 1.6975098152232388
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 2.4048}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0487, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 2.4048}:  10%|█         | 1/10 [00:01<00:11,  1.24s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 2.2123}:  10%|█         | 1/10 [00:03<00:11,  1.24s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0492, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8508, 'compress@10': 1.0, 'time@10': 2.2123}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8507, 'compress@10': 1.0, 'time@10': 1.7581}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0341, 'hit_ratio@10': 0.7117, 'ndcg@10': 0.8507, 'compress@10': 1.0, 'time@10': 1.7581}:  30%|███       | 3/10 [00:03<00:08,  1.14s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0403, 'hit_ratio@10': 0.757, 'ndcg@10': 0.841, 'compress@10': 1.0, 'time@10': 1.7561}:  30%|███       | 3/10 [00:05<00:08,  1.14s/it]  {'epoch': 3, 'num_users': 5.0, 'loss': 0.0403, 'hit_ratio@10': 0.757, 'ndcg@10': 0.841, 'compress@10': 1.0, 'time@10': 1.7561}:  40%|████      | 4/10 [00:05<00:08,  1.40s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.8326, 'compress@10': 1.0, 'time@10': 2.7486}:  40%|████      | 4/10 [00:08<00:08,  1.40s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0476, 'hit_ratio@10': 0.7736, 'ndcg@10': 0.8326, 'compress@10': 1.0, 'time@10': 2.7486}:  50%|█████     | 5/10 [00:08<00:10,  2.12s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0516, 'hit_ratio@10': 0.7743, 'ndcg@10': 0.8309, 'compress@10': 1.0, 'time@10': 2.8239}:  50%|█████     | 5/10 [00:12<00:10,  2.12s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0516, 'hit_ratio@10': 0.7743, 'ndcg@10': 0.8309, 'compress@10': 1.0, 'time@10': 2.8239}:  60%|██████    | 6/10 [00:12<00:09,  2.50s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0516, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8343, 'compress@10': 1.0, 'time@10': 2.8786}:  60%|██████    | 6/10 [00:13<00:09,  2.50s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0516, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8343, 'compress@10': 1.0, 'time@10': 2.8786}:  70%|███████   | 7/10 [00:13<00:06,  2.22s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0536, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8334, 'compress@10': 1.0, 'time@10': 2.799}:  70%|███████   | 7/10 [00:16<00:06,  2.22s/it]  {'epoch': 3, 'num_users': 6.125, 'loss': 0.0536, 'hit_ratio@10': 0.8186, 'ndcg@10': 0.8334, 'compress@10': 1.0, 'time@10': 2.799}:  80%|████████  | 8/10 [00:16<00:04,  2.24s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0518, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 3.0312}:  80%|████████  | 8/10 [00:18<00:04,  2.24s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0518, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 3.0312}:  90%|█████████ | 9/10 [00:18<00:02,  2.32s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8436, 'compress@10': 1.0, 'time@10': 3.0247}:  90%|█████████ | 9/10 [00:21<00:02,  2.32s/it]   {'epoch': 3, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8436, 'compress@10': 1.0, 'time@10': 3.0247}: 100%|██████████| 10/10 [00:21<00:00,  2.53s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8252, 'ndcg@10': 0.8436, 'compress@10': 1.0, 'time@10': 3.0247}: 100%|██████████| 10/10 [00:21<00:00,  2.16s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.051088604933944
Avg hit ratio: 0.8251834620765012
Avg ndcg: 0.8435706347616971
Avg compression ratio: 1.0
Avg train time: 3.024672269821167
Std train time: 1.5984570152586988
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8627, 'compress@10': 1.0, 'time@10': 2.6743}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8627, 'compress@10': 1.0, 'time@10': 2.6743}:  10%|█         | 1/10 [00:01<00:12,  1.37s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 2.3403}:  10%|█         | 1/10 [00:03<00:12,  1.37s/it] {'epoch': 4, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 2.3403}:  20%|██        | 2/10 [00:03<00:14,  1.77s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0334, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 1.8155}:  20%|██        | 2/10 [00:03<00:14,  1.77s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0334, 'hit_ratio@10': 0.7225, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 1.8155}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0395, 'hit_ratio@10': 0.774, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 1.8339}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it]  {'epoch': 4, 'num_users': 5.0, 'loss': 0.0395, 'hit_ratio@10': 0.774, 'ndcg@10': 0.846, 'compress@10': 1.0, 'time@10': 1.8339}:  40%|████      | 4/10 [00:05<00:08,  1.46s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.7872, 'ndcg@10': 0.8381, 'compress@10': 1.0, 'time@10': 2.8622}:  40%|████      | 4/10 [00:09<00:08,  1.46s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.046, 'hit_ratio@10': 0.7872, 'ndcg@10': 0.8381, 'compress@10': 1.0, 'time@10': 2.8622}:  50%|█████     | 5/10 [00:09<00:11,  2.21s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0494, 'hit_ratio@10': 0.7856, 'ndcg@10': 0.8358, 'compress@10': 1.0, 'time@10': 2.9508}:  50%|█████     | 5/10 [00:12<00:11,  2.21s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0494, 'hit_ratio@10': 0.7856, 'ndcg@10': 0.8358, 'compress@10': 1.0, 'time@10': 2.9508}:  60%|██████    | 6/10 [00:12<00:10,  2.63s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0486, 'hit_ratio@10': 0.8105, 'ndcg@10': 0.8422, 'compress@10': 1.0, 'time@10': 2.9955}:  60%|██████    | 6/10 [00:14<00:10,  2.63s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0486, 'hit_ratio@10': 0.8105, 'ndcg@10': 0.8422, 'compress@10': 1.0, 'time@10': 2.9955}:  70%|███████   | 7/10 [00:14<00:06,  2.31s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0497, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.842, 'compress@10': 1.0, 'time@10': 2.9027}:  70%|███████   | 7/10 [00:16<00:06,  2.31s/it]  {'epoch': 4, 'num_users': 6.125, 'loss': 0.0497, 'hit_ratio@10': 0.8271, 'ndcg@10': 0.842, 'compress@10': 1.0, 'time@10': 2.9027}:  80%|████████  | 8/10 [00:16<00:04,  2.31s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0492, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8478, 'compress@10': 1.0, 'time@10': 3.0954}:  80%|████████  | 8/10 [00:19<00:04,  2.31s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0492, 'hit_ratio@10': 0.8145, 'ndcg@10': 0.8478, 'compress@10': 1.0, 'time@10': 3.0954}:  90%|█████████ | 9/10 [00:19<00:02,  2.32s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 3.0761}:  90%|█████████ | 9/10 [00:21<00:02,  2.32s/it]    {'epoch': 4, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 3.0761}: 100%|██████████| 10/10 [00:21<00:00,  2.51s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8263, 'ndcg@10': 0.848, 'compress@10': 1.0, 'time@10': 3.0761}: 100%|██████████| 10/10 [00:21<00:00,  2.20s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.048666123447028184
Avg hit ratio: 0.8262664113852569
Avg ndcg: 0.8480237304489577
Avg compression ratio: 1.0
Avg train time: 3.0761055946350098
Std train time: 1.6288431024769807
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 2.4241}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0486, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 2.4241}:  10%|█         | 1/10 [00:01<00:11,  1.24s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 2.2738}:  10%|█         | 1/10 [00:03<00:11,  1.24s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 2.2738}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8534, 'compress@10': 1.0, 'time@10': 1.805}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8534, 'compress@10': 1.0, 'time@10': 1.805}:  30%|███       | 3/10 [00:03<00:08,  1.18s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0373, 'hit_ratio@10': 0.8016, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 1.8022}:  30%|███       | 3/10 [00:05<00:08,  1.18s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0373, 'hit_ratio@10': 0.8016, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 1.8022}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0431, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8438, 'compress@10': 1.0, 'time@10': 2.8642}:  40%|████      | 4/10 [00:09<00:08,  1.44s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0431, 'hit_ratio@10': 0.8053, 'ndcg@10': 0.8438, 'compress@10': 1.0, 'time@10': 2.8642}:  50%|█████     | 5/10 [00:09<00:11,  2.21s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0462, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.8415, 'compress@10': 1.0, 'time@10': 2.9047}:  50%|█████     | 5/10 [00:12<00:11,  2.21s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0462, 'hit_ratio@10': 0.8044, 'ndcg@10': 0.8415, 'compress@10': 1.0, 'time@10': 2.9047}:  60%|██████    | 6/10 [00:12<00:10,  2.53s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0455, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8415, 'compress@10': 1.0, 'time@10': 2.9671}:  60%|██████    | 6/10 [00:14<00:10,  2.53s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0455, 'hit_ratio@10': 0.8266, 'ndcg@10': 0.8415, 'compress@10': 1.0, 'time@10': 2.9671}:  70%|███████   | 7/10 [00:14<00:06,  2.26s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0459, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8426, 'compress@10': 1.0, 'time@10': 2.8907}:  70%|███████   | 7/10 [00:16<00:06,  2.26s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0459, 'hit_ratio@10': 0.8412, 'ndcg@10': 0.8426, 'compress@10': 1.0, 'time@10': 2.8907}:  80%|████████  | 8/10 [00:16<00:04,  2.30s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0447, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8505, 'compress@10': 1.0, 'time@10': 3.0863}:  80%|████████  | 8/10 [00:18<00:04,  2.30s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0447, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8505, 'compress@10': 1.0, 'time@10': 3.0863}:  90%|█████████ | 9/10 [00:18<00:02,  2.32s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0441, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8517, 'compress@10': 1.0, 'time@10': 3.071}:  90%|█████████ | 9/10 [00:21<00:02,  2.32s/it]     {'epoch': 5, 'num_users': 6.3, 'loss': 0.0441, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8517, 'compress@10': 1.0, 'time@10': 3.071}: 100%|██████████| 10/10 [00:21<00:00,  2.52s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0441, 'hit_ratio@10': 0.849, 'ndcg@10': 0.8517, 'compress@10': 1.0, 'time@10': 3.071}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.044118389778070886
Avg hit ratio: 0.848977112870152
Avg ndcg: 0.8517476437561683
Avg compression ratio: 1.0
Avg train time: 3.0709768533706665
Std train time: 1.6502588542247756
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8476, 'compress@10': 1.0, 'time@10': 2.5571}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0484, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8476, 'compress@10': 1.0, 'time@10': 2.5571}:  10%|█         | 1/10 [00:01<00:11,  1.31s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8598, 'compress@10': 1.0, 'time@10': 2.3004}:  10%|█         | 1/10 [00:03<00:11,  1.31s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7818, 'ndcg@10': 0.8598, 'compress@10': 1.0, 'time@10': 2.3004}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 1.8147}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0316, 'hit_ratio@10': 0.7593, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 1.8147}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.8016, 'ndcg@10': 0.8585, 'compress@10': 1.0, 'time@10': 1.8195}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.8016, 'ndcg@10': 0.8585, 'compress@10': 1.0, 'time@10': 1.8195}:  40%|████      | 4/10 [00:05<00:08,  1.45s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8505, 'compress@10': 1.0, 'time@10': 2.8406}:  40%|████      | 4/10 [00:09<00:08,  1.45s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0416, 'hit_ratio@10': 0.8133, 'ndcg@10': 0.8505, 'compress@10': 1.0, 'time@10': 2.8406}:  50%|█████     | 5/10 [00:09<00:10,  2.19s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0441, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 2.8888}:  50%|█████     | 5/10 [00:12<00:10,  2.19s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0441, 'hit_ratio@10': 0.8148, 'ndcg@10': 0.8471, 'compress@10': 1.0, 'time@10': 2.8888}:  60%|██████    | 6/10 [00:12<00:10,  2.52s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0442, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 3.0069}:  60%|██████    | 6/10 [00:14<00:10,  2.52s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.0442, 'hit_ratio@10': 0.8355, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 3.0069}:  70%|███████   | 7/10 [00:14<00:06,  2.31s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.0441, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 2.9185}:  70%|███████   | 7/10 [00:16<00:06,  2.31s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.0441, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8548, 'compress@10': 1.0, 'time@10': 2.9185}:  80%|████████  | 8/10 [00:16<00:04,  2.32s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.044, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8705, 'compress@10': 1.0, 'time@10': 3.1201}:  80%|████████  | 8/10 [00:19<00:04,  2.32s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.044, 'hit_ratio@10': 0.8372, 'ndcg@10': 0.8705, 'compress@10': 1.0, 'time@10': 3.1201}:  90%|█████████ | 9/10 [00:19<00:02,  2.35s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0435, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 3.1041}:  90%|█████████ | 9/10 [00:22<00:02,  2.35s/it]  {'epoch': 6, 'num_users': 6.3, 'loss': 0.0435, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 3.1041}: 100%|██████████| 10/10 [00:22<00:00,  2.55s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0435, 'hit_ratio@10': 0.8466, 'ndcg@10': 0.8713, 'compress@10': 1.0, 'time@10': 3.1041}: 100%|██████████| 10/10 [00:22<00:00,  2.20s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04353244529609936
Avg hit ratio: 0.8466279065209456
Avg ndcg: 0.8713119784543011
Avg compression ratio: 1.0
Avg train time: 3.104059028625488
Std train time: 1.6260968074404965
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8414, 'compress@10': 1.0, 'time@10': 2.5115}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8414, 'compress@10': 1.0, 'time@10': 2.5115}:  10%|█         | 1/10 [00:01<00:11,  1.29s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 2.285}:  10%|█         | 1/10 [00:03<00:11,  1.29s/it] {'epoch': 7, 'num_users': 7.0, 'loss': 0.0431, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 2.285}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 1.7748}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 1.7748}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 1.779}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0359, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 1.779}:  40%|████      | 4/10 [00:05<00:08,  1.42s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0404, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 2.8106}:  40%|████      | 4/10 [00:09<00:08,  1.42s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0404, 'hit_ratio@10': 0.8342, 'ndcg@10': 0.8502, 'compress@10': 1.0, 'time@10': 2.8106}:  50%|█████     | 5/10 [00:09<00:10,  2.17s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0421, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 2.8672}:  50%|█████     | 5/10 [00:12<00:10,  2.17s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0421, 'hit_ratio@10': 0.8359, 'ndcg@10': 0.8479, 'compress@10': 1.0, 'time@10': 2.8672}:  60%|██████    | 6/10 [00:12<00:10,  2.51s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0418, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8466, 'compress@10': 1.0, 'time@10': 2.9417}:  60%|██████    | 6/10 [00:14<00:10,  2.51s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0418, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8466, 'compress@10': 1.0, 'time@10': 2.9417}:  70%|███████   | 7/10 [00:14<00:06,  2.26s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.8504, 'compress@10': 1.0, 'time@10': 2.8804}:  70%|███████   | 7/10 [00:16<00:06,  2.26s/it] {'epoch': 7, 'num_users': 6.125, 'loss': 0.0413, 'hit_ratio@10': 0.8612, 'ndcg@10': 0.8504, 'compress@10': 1.0, 'time@10': 2.8804}:  80%|████████  | 8/10 [00:16<00:04,  2.34s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.041, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8569, 'compress@10': 1.0, 'time@10': 3.0881}:  80%|████████  | 8/10 [00:18<00:04,  2.34s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.041, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8569, 'compress@10': 1.0, 'time@10': 3.0881}:  90%|█████████ | 9/10 [00:18<00:02,  2.36s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 3.0658}:  90%|█████████ | 9/10 [00:21<00:02,  2.36s/it]  {'epoch': 7, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 3.0658}: 100%|██████████| 10/10 [00:21<00:00,  2.53s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0407, 'hit_ratio@10': 0.8536, 'ndcg@10': 0.8581, 'compress@10': 1.0, 'time@10': 3.0658}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.04068393572036709
Avg hit ratio: 0.8535874559321079
Avg ndcg: 0.8581106970266396
Avg compression ratio: 1.0
Avg train time: 3.0657971620559694
Std train time: 1.6321012676219167
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8457, 'compress@10': 1.0, 'time@10': 2.7843}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0491, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8457, 'compress@10': 1.0, 'time@10': 2.7843}:  10%|█         | 1/10 [00:01<00:12,  1.43s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8636, 'compress@10': 1.0, 'time@10': 2.4547}:  10%|█         | 1/10 [00:03<00:12,  1.43s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8636, 'compress@10': 1.0, 'time@10': 2.4547}:  20%|██        | 2/10 [00:03<00:14,  1.86s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8593, 'compress@10': 1.0, 'time@10': 1.9374}:  20%|██        | 2/10 [00:04<00:14,  1.86s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8593, 'compress@10': 1.0, 'time@10': 1.9374}:  30%|███       | 3/10 [00:04<00:08,  1.23s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8608, 'compress@10': 1.0, 'time@10': 1.9721}:  30%|███       | 3/10 [00:06<00:08,  1.23s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.8258, 'ndcg@10': 0.8608, 'compress@10': 1.0, 'time@10': 1.9721}:  40%|████      | 4/10 [00:06<00:09,  1.58s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0388, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8588, 'compress@10': 1.0, 'time@10': 2.993}:  40%|████      | 4/10 [00:09<00:09,  1.58s/it] {'epoch': 8, 'num_users': 5.8, 'loss': 0.0388, 'hit_ratio@10': 0.8367, 'ndcg@10': 0.8588, 'compress@10': 1.0, 'time@10': 2.993}:  50%|█████     | 5/10 [00:09<00:11,  2.30s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0398, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 3.0558}:  50%|█████     | 5/10 [00:13<00:11,  2.30s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0398, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8568, 'compress@10': 1.0, 'time@10': 3.0558}:  60%|██████    | 6/10 [00:13<00:10,  2.68s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0398, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 3.1617}:  60%|██████    | 6/10 [00:15<00:10,  2.68s/it] {'epoch': 8, 'num_users': 6.2857, 'loss': 0.0398, 'hit_ratio@10': 0.856, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 3.1617}:  70%|███████   | 7/10 [00:15<00:07,  2.44s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0383, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.0911}:  70%|███████   | 7/10 [00:17<00:07,  2.44s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.0383, 'hit_ratio@10': 0.8633, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 3.0911}:  80%|████████  | 8/10 [00:17<00:04,  2.50s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0382, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8734, 'compress@10': 1.0, 'time@10': 3.2625}:  80%|████████  | 8/10 [00:20<00:04,  2.50s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.0382, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8734, 'compress@10': 1.0, 'time@10': 3.2625}:  90%|█████████ | 9/10 [00:20<00:02,  2.45s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0374, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8755, 'compress@10': 1.0, 'time@10': 3.2455}:  90%|█████████ | 9/10 [00:23<00:02,  2.45s/it]   {'epoch': 8, 'num_users': 6.3, 'loss': 0.0374, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8755, 'compress@10': 1.0, 'time@10': 3.2455}: 100%|██████████| 10/10 [00:23<00:00,  2.66s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0374, 'hit_ratio@10': 0.8541, 'ndcg@10': 0.8755, 'compress@10': 1.0, 'time@10': 3.2455}: 100%|██████████| 10/10 [00:23<00:00,  2.32s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.0373916328684938
Avg hit ratio: 0.854088875659334
Avg ndcg: 0.875533244236047
Avg compression ratio: 1.0
Avg train time: 3.2455338716506956
Std train time: 1.6029000275351737
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8467, 'compress@10': 1.0, 'time@10': 2.8299}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8467, 'compress@10': 1.0, 'time@10': 2.8299}:  10%|█         | 1/10 [00:01<00:13,  1.45s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0397, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8679, 'compress@10': 1.0, 'time@10': 2.4699}:  10%|█         | 1/10 [00:03<00:13,  1.45s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0397, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8679, 'compress@10': 1.0, 'time@10': 2.4699}:  20%|██        | 2/10 [00:03<00:14,  1.86s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 1.9046}:  20%|██        | 2/10 [00:04<00:14,  1.86s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0276, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 1.9046}:  30%|███       | 3/10 [00:04<00:08,  1.20s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0337, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 1.8812}:  30%|███       | 3/10 [00:05<00:08,  1.20s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0337, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 1.8812}:  40%|████      | 4/10 [00:05<00:08,  1.46s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.037, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 2.9646}:  40%|████      | 4/10 [00:09<00:08,  1.46s/it] {'epoch': 9, 'num_users': 5.8, 'loss': 0.037, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8655, 'compress@10': 1.0, 'time@10': 2.9646}:  50%|█████     | 5/10 [00:09<00:11,  2.26s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0377, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8646, 'compress@10': 1.0, 'time@10': 2.9728}:  50%|█████     | 5/10 [00:12<00:11,  2.26s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0377, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8646, 'compress@10': 1.0, 'time@10': 2.9728}:  60%|██████    | 6/10 [00:12<00:10,  2.53s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0374, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8664, 'compress@10': 1.0, 'time@10': 3.0341}:  60%|██████    | 6/10 [00:14<00:10,  2.53s/it] {'epoch': 9, 'num_users': 6.2857, 'loss': 0.0374, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8664, 'compress@10': 1.0, 'time@10': 3.0341}:  70%|███████   | 7/10 [00:14<00:06,  2.27s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.037, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8689, 'compress@10': 1.0, 'time@10': 2.956}:  70%|███████   | 7/10 [00:16<00:06,  2.27s/it]  {'epoch': 9, 'num_users': 6.125, 'loss': 0.037, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8689, 'compress@10': 1.0, 'time@10': 2.956}:  80%|████████  | 8/10 [00:16<00:04,  2.33s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0359, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8755, 'compress@10': 1.0, 'time@10': 3.1488}:  80%|████████  | 8/10 [00:19<00:04,  2.33s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0359, 'hit_ratio@10': 0.8483, 'ndcg@10': 0.8755, 'compress@10': 1.0, 'time@10': 3.1488}:  90%|█████████ | 9/10 [00:19<00:02,  2.34s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0359, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8746, 'compress@10': 1.0, 'time@10': 3.1254}:  90%|█████████ | 9/10 [00:22<00:02,  2.34s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0359, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8746, 'compress@10': 1.0, 'time@10': 3.1254}: 100%|██████████| 10/10 [00:22<00:00,  2.53s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0359, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.8746, 'compress@10': 1.0, 'time@10': 3.1254}: 100%|██████████| 10/10 [00:22<00:00,  2.21s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.0358946737437887
Avg hit ratio: 0.8589395482842003
Avg ndcg: 0.8745783716411429
Avg compression ratio: 1.0
Avg train time: 3.1254112005233763
Std train time: 1.699581521395257
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8476, 'compress@10': 1.0, 'time@10': 2.4603}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0459, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8476, 'compress@10': 1.0, 'time@10': 2.4603}:  10%|█         | 1/10 [00:01<00:11,  1.27s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0374, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8755, 'compress@10': 1.0, 'time@10': 2.2456}:  10%|█         | 1/10 [00:03<00:11,  1.27s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0374, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8755, 'compress@10': 1.0, 'time@10': 2.2456}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 1.756}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it] {'epoch': 10, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8672, 'compress@10': 1.0, 'time@10': 1.756}:  30%|███       | 3/10 [00:03<00:07,  1.14s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 1.7626}:  30%|███       | 3/10 [00:05<00:07,  1.14s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8706, 'compress@10': 1.0, 'time@10': 1.7626}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0343, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8695, 'compress@10': 1.0, 'time@10': 2.8629}:  40%|████      | 4/10 [00:09<00:08,  1.41s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0343, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8695, 'compress@10': 1.0, 'time@10': 2.8629}:  50%|█████     | 5/10 [00:09<00:11,  2.22s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.037, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 2.8784}:  50%|█████     | 5/10 [00:12<00:11,  2.22s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.037, 'hit_ratio@10': 0.8363, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 2.8784}:  60%|██████    | 6/10 [00:12<00:09,  2.48s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0361, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 2.9278}:  60%|██████    | 6/10 [00:13<00:09,  2.48s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0361, 'hit_ratio@10': 0.854, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 2.9278}:  70%|███████   | 7/10 [00:13<00:06,  2.22s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0346, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8754, 'compress@10': 1.0, 'time@10': 2.8467}:  70%|███████   | 7/10 [00:16<00:06,  2.22s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0346, 'hit_ratio@10': 0.8651, 'ndcg@10': 0.8754, 'compress@10': 1.0, 'time@10': 2.8467}:  80%|████████  | 8/10 [00:16<00:04,  2.25s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0344, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 3.0678}:  80%|████████  | 8/10 [00:18<00:04,  2.25s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0344, 'hit_ratio@10': 0.8515, 'ndcg@10': 0.8818, 'compress@10': 1.0, 'time@10': 3.0678}:  90%|█████████ | 9/10 [00:18<00:02,  2.31s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0333, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.884, 'compress@10': 1.0, 'time@10': 3.052}:  90%|█████████ | 9/10 [00:21<00:02,  2.31s/it]     {'epoch': 10, 'num_users': 6.3, 'loss': 0.0333, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.884, 'compress@10': 1.0, 'time@10': 3.052}: 100%|██████████| 10/10 [00:21<00:00,  2.51s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0333, 'hit_ratio@10': 0.8618, 'ndcg@10': 0.884, 'compress@10': 1.0, 'time@10': 3.052}: 100%|██████████| 10/10 [00:21<00:00,  2.16s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.0333262495621587
Avg hit ratio: 0.861796691141343
Avg ndcg: 0.8839764636676369
Avg compression ratio: 1.0
Avg train time: 3.0519839763641357
Std train time: 1.725177452548818
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8375, 'compress@10': 1.0, 'time@10': 2.4303}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0496, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8375, 'compress@10': 1.0, 'time@10': 2.4303}:  10%|█         | 1/10 [00:01<00:11,  1.25s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0393, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 2.2289}:  10%|█         | 1/10 [00:03<00:11,  1.25s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0393, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8653, 'compress@10': 1.0, 'time@10': 2.2289}:  20%|██        | 2/10 [00:03<00:13,  1.73s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 1.7465}:  20%|██        | 2/10 [00:03<00:13,  1.73s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0278, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 1.7465}:  30%|███       | 3/10 [00:03<00:07,  1.13s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 1.7824}:  30%|███       | 3/10 [00:05<00:07,  1.13s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0323, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8638, 'compress@10': 1.0, 'time@10': 1.7824}:  40%|████      | 4/10 [00:05<00:08,  1.45s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0345, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 2.8311}:  40%|████      | 4/10 [00:09<00:08,  1.45s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0345, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.8662, 'compress@10': 1.0, 'time@10': 2.8311}:  50%|█████     | 5/10 [00:09<00:11,  2.20s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0352, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 2.8873}:  50%|█████     | 5/10 [00:12<00:11,  2.20s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0352, 'hit_ratio@10': 0.8489, 'ndcg@10': 0.8661, 'compress@10': 1.0, 'time@10': 2.8873}:  60%|██████    | 6/10 [00:12<00:10,  2.54s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0362, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8709, 'compress@10': 1.0, 'time@10': 2.9495}:  60%|██████    | 6/10 [00:14<00:10,  2.54s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0362, 'hit_ratio@10': 0.8648, 'ndcg@10': 0.8709, 'compress@10': 1.0, 'time@10': 2.9495}:  70%|███████   | 7/10 [00:14<00:06,  2.27s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0349, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 2.866}:  70%|███████   | 7/10 [00:16<00:06,  2.27s/it]  {'epoch': 11, 'num_users': 6.125, 'loss': 0.0349, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8756, 'compress@10': 1.0, 'time@10': 2.866}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.034, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8824, 'compress@10': 1.0, 'time@10': 3.0909}:  80%|████████  | 8/10 [00:18<00:04,  2.28s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.034, 'hit_ratio@10': 0.8631, 'ndcg@10': 0.8824, 'compress@10': 1.0, 'time@10': 3.0909}:  90%|█████████ | 9/10 [00:18<00:02,  2.34s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 3.0686}:  90%|█████████ | 9/10 [00:21<00:02,  2.34s/it]  {'epoch': 11, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 3.0686}: 100%|██████████| 10/10 [00:21<00:00,  2.52s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0332, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 3.0686}: 100%|██████████| 10/10 [00:21<00:00,  2.18s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03320216918080655
Avg hit ratio: 0.8744979898426417
Avg ndcg: 0.8857477044321241
Avg compression ratio: 1.0
Avg train time: 3.0686316967010496
Std train time: 1.6679575964056916
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8476, 'compress@10': 1.0, 'time@10': 2.4012}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.042, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8476, 'compress@10': 1.0, 'time@10': 2.4012}:  10%|█         | 1/10 [00:01<00:11,  1.23s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8761, 'compress@10': 1.0, 'time@10': 2.2133}:  10%|█         | 1/10 [00:03<00:11,  1.23s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0347, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8761, 'compress@10': 1.0, 'time@10': 2.2133}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 1.7312}:  20%|██        | 2/10 [00:03<00:13,  1.72s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0251, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8676, 'compress@10': 1.0, 'time@10': 1.7312}:  30%|███       | 3/10 [00:03<00:07,  1.13s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 1.7604}:  30%|███       | 3/10 [00:05<00:07,  1.13s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0293, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 1.7604}:  40%|████      | 4/10 [00:05<00:08,  1.42s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.875, 'compress@10': 1.0, 'time@10': 2.8082}:  40%|████      | 4/10 [00:09<00:08,  1.42s/it] {'epoch': 12, 'num_users': 5.8, 'loss': 0.0322, 'hit_ratio@10': 0.8454, 'ndcg@10': 0.875, 'compress@10': 1.0, 'time@10': 2.8082}:  50%|█████     | 5/10 [00:09<00:10,  2.19s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0323, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8761, 'compress@10': 1.0, 'time@10': 2.8546}:  50%|█████     | 5/10 [00:12<00:10,  2.19s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0323, 'hit_ratio@10': 0.8637, 'ndcg@10': 0.8761, 'compress@10': 1.0, 'time@10': 2.8546}:  60%|██████    | 6/10 [00:12<00:10,  2.50s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0329, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 2.9332}:  60%|██████    | 6/10 [00:13<00:10,  2.50s/it] {'epoch': 12, 'num_users': 6.2857, 'loss': 0.0329, 'hit_ratio@10': 0.8775, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 2.9332}:  70%|███████   | 7/10 [00:13<00:06,  2.25s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0314, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 2.8624}:  70%|███████   | 7/10 [00:16<00:06,  2.25s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0314, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8777, 'compress@10': 1.0, 'time@10': 2.8624}:  80%|████████  | 8/10 [00:16<00:04,  2.30s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0308, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 3.0714}:  80%|████████  | 8/10 [00:18<00:04,  2.30s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.0308, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 3.0714}:  90%|█████████ | 9/10 [00:18<00:02,  2.33s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 3.0588}:  90%|█████████ | 9/10 [00:21<00:02,  2.33s/it]    {'epoch': 12, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 3.0588}: 100%|██████████| 10/10 [00:21<00:00,  2.53s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.031, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.8853, 'compress@10': 1.0, 'time@10': 3.0588}: 100%|██████████| 10/10 [00:21<00:00,  2.18s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.031042234160641575
Avg hit ratio: 0.8805297358743879
Avg ndcg: 0.8852624098224371
Avg compression ratio: 1.0
Avg train time: 3.0588177919387816
Std train time: 1.6491461186814294
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0402, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8526, 'compress@10': 1.0, 'time@10': 2.4829}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0402, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8526, 'compress@10': 1.0, 'time@10': 2.4829}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.882, 'compress@10': 1.0, 'time@10': 2.2786}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it] {'epoch': 13, 'num_users': 7.0, 'loss': 0.0337, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.882, 'compress@10': 1.0, 'time@10': 2.2786}:  20%|██        | 2/10 [00:03<00:14,  1.77s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 1.7927}:  20%|██        | 2/10 [00:03<00:14,  1.77s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0248, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8716, 'compress@10': 1.0, 'time@10': 1.7927}:  30%|███       | 3/10 [00:03<00:08,  1.16s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8792, 'compress@10': 1.0, 'time@10': 1.8065}:  30%|███       | 3/10 [00:05<00:08,  1.16s/it] {'epoch': 13, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8792, 'compress@10': 1.0, 'time@10': 1.8065}:  40%|████      | 4/10 [00:05<00:08,  1.45s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0304, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 2.8331}:  40%|████      | 4/10 [00:09<00:08,  1.45s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0304, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.8809, 'compress@10': 1.0, 'time@10': 2.8331}:  50%|█████     | 5/10 [00:09<00:10,  2.19s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0304, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8846, 'compress@10': 1.0, 'time@10': 2.9524}:  50%|█████     | 5/10 [00:12<00:10,  2.19s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.0304, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.8846, 'compress@10': 1.0, 'time@10': 2.9524}:  60%|██████    | 6/10 [00:12<00:10,  2.66s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.8892, 'compress@10': 1.0, 'time@10': 3.0428}:  60%|██████    | 6/10 [00:14<00:10,  2.66s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0296, 'hit_ratio@10': 0.8982, 'ndcg@10': 0.8892, 'compress@10': 1.0, 'time@10': 3.0428}:  70%|███████   | 7/10 [00:14<00:07,  2.39s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0287, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 2.9449}:  70%|███████   | 7/10 [00:16<00:07,  2.39s/it] {'epoch': 13, 'num_users': 6.125, 'loss': 0.0287, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 2.9449}:  80%|████████  | 8/10 [00:16<00:04,  2.36s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.8987, 'compress@10': 1.0, 'time@10': 3.1363}:  80%|████████  | 8/10 [00:19<00:04,  2.36s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0276, 'hit_ratio@10': 0.8796, 'ndcg@10': 0.8987, 'compress@10': 1.0, 'time@10': 3.1363}:  90%|█████████ | 9/10 [00:19<00:02,  2.36s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 3.1092}:  90%|█████████ | 9/10 [00:22<00:02,  2.36s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 3.1092}: 100%|██████████| 10/10 [00:22<00:00,  2.53s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0268, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9019, 'compress@10': 1.0, 'time@10': 3.1092}: 100%|██████████| 10/10 [00:22<00:00,  2.22s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.026831873895780865
Avg hit ratio: 0.8893417659495759
Avg ndcg: 0.9018584919672561
Avg compression ratio: 1.0
Avg train time: 3.109153127670288
Std train time: 1.6306495671917296
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0329, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.879, 'compress@10': 1.0, 'time@10': 2.4609}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0329, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.879, 'compress@10': 1.0, 'time@10': 2.4609}:  10%|█         | 1/10 [00:01<00:11,  1.26s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 2.2716}:  10%|█         | 1/10 [00:03<00:11,  1.26s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.893, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 2.2716}:  20%|██        | 2/10 [00:03<00:14,  1.77s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 1.7979}:  20%|██        | 2/10 [00:03<00:14,  1.77s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.022, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.8811, 'compress@10': 1.0, 'time@10': 1.7979}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 1.8096}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.026, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8832, 'compress@10': 1.0, 'time@10': 1.8096}:  40%|████      | 4/10 [00:05<00:08,  1.46s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0274, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8874, 'compress@10': 1.0, 'time@10': 2.8949}:  40%|████      | 4/10 [00:09<00:08,  1.46s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0274, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.8874, 'compress@10': 1.0, 'time@10': 2.8949}:  50%|█████     | 5/10 [00:09<00:11,  2.25s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0294, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 2.9668}:  50%|█████     | 5/10 [00:12<00:11,  2.25s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0294, 'hit_ratio@10': 0.8967, 'ndcg@10': 0.8934, 'compress@10': 1.0, 'time@10': 2.9668}:  60%|██████    | 6/10 [00:12<00:10,  2.63s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.031, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.893, 'compress@10': 1.0, 'time@10': 3.0128}:  60%|██████    | 6/10 [00:14<00:10,  2.63s/it]  {'epoch': 14, 'num_users': 6.2857, 'loss': 0.031, 'hit_ratio@10': 0.9057, 'ndcg@10': 0.893, 'compress@10': 1.0, 'time@10': 3.0128}:  70%|███████   | 7/10 [00:14<00:06,  2.32s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0296, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 2.9168}:  70%|███████   | 7/10 [00:16<00:06,  2.32s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0296, 'hit_ratio@10': 0.9104, 'ndcg@10': 0.8954, 'compress@10': 1.0, 'time@10': 2.9168}:  80%|████████  | 8/10 [00:16<00:04,  2.31s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0294, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.908, 'compress@10': 1.0, 'time@10': 3.1068}:  80%|████████  | 8/10 [00:19<00:04,  2.31s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0294, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.908, 'compress@10': 1.0, 'time@10': 3.1068}:  90%|█████████ | 9/10 [00:19<00:02,  2.32s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9119, 'compress@10': 1.0, 'time@10': 3.0859}:  90%|█████████ | 9/10 [00:22<00:02,  2.32s/it]    {'epoch': 14, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9119, 'compress@10': 1.0, 'time@10': 3.0859}: 100%|██████████| 10/10 [00:22<00:00,  2.51s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.028, 'hit_ratio@10': 0.906, 'ndcg@10': 0.9119, 'compress@10': 1.0, 'time@10': 3.0859}: 100%|██████████| 10/10 [00:22<00:00,  2.20s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.02801919972968449
Avg hit ratio: 0.9060334952728841
Avg ndcg: 0.9118667602272307
Avg compression ratio: 1.0
Avg train time: 3.0858935832977297
Std train time: 1.6843794299917512
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8874, 'compress@10': 1.0, 'time@10': 2.4113}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0462, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8874, 'compress@10': 1.0, 'time@10': 2.4113}:  10%|█         | 1/10 [00:01<00:11,  1.24s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 2.2432}:  10%|█         | 1/10 [00:03<00:11,  1.24s/it] {'epoch': 15, 'num_users': 7.0, 'loss': 0.0356, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 2.2432}:  20%|██        | 2/10 [00:03<00:14,  1.75s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8849, 'compress@10': 1.0, 'time@10': 1.7619}:  20%|██        | 2/10 [00:03<00:14,  1.75s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0262, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8849, 'compress@10': 1.0, 'time@10': 1.7619}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8896, 'compress@10': 1.0, 'time@10': 1.7746}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0284, 'hit_ratio@10': 0.8398, 'ndcg@10': 0.8896, 'compress@10': 1.0, 'time@10': 1.7746}:  40%|████      | 4/10 [00:05<00:08,  1.43s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0297, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 2.7789}:  40%|████      | 4/10 [00:09<00:08,  1.43s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0297, 'hit_ratio@10': 0.8639, 'ndcg@10': 0.8933, 'compress@10': 1.0, 'time@10': 2.7789}:  50%|█████     | 5/10 [00:09<00:10,  2.15s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0293, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 2.8244}:  50%|█████     | 5/10 [00:12<00:10,  2.15s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0293, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 2.8244}:  60%|██████    | 6/10 [00:12<00:09,  2.48s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0292, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.8959, 'compress@10': 1.0, 'time@10': 2.9053}:  60%|██████    | 6/10 [00:13<00:09,  2.48s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0292, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.8959, 'compress@10': 1.0, 'time@10': 2.9053}:  70%|███████   | 7/10 [00:13<00:06,  2.23s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0281, 'hit_ratio@10': 0.9, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.8311}:  70%|███████   | 7/10 [00:16<00:06,  2.23s/it]    {'epoch': 15, 'num_users': 6.125, 'loss': 0.0281, 'hit_ratio@10': 0.9, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.8311}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9048, 'compress@10': 1.0, 'time@10': 3.0501}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9048, 'compress@10': 1.0, 'time@10': 3.0501}:  90%|█████████ | 9/10 [00:18<00:02,  2.32s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0274, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9044, 'compress@10': 1.0, 'time@10': 3.0386}:  90%|█████████ | 9/10 [00:21<00:02,  2.32s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0274, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9044, 'compress@10': 1.0, 'time@10': 3.0386}: 100%|██████████| 10/10 [00:21<00:00,  2.52s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0274, 'hit_ratio@10': 0.8949, 'ndcg@10': 0.9044, 'compress@10': 1.0, 'time@10': 3.0386}: 100%|██████████| 10/10 [00:21<00:00,  2.17s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.027447304237773102
Avg hit ratio: 0.8948722588484899
Avg ndcg: 0.9043755277898546
Avg compression ratio: 1.0
Avg train time: 3.038641881942749
Std train time: 1.604128255117637
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 2.4074}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0262, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8924, 'compress@10': 1.0, 'time@10': 2.4074}:  10%|█         | 1/10 [00:01<00:11,  1.24s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 2.2305}:  10%|█         | 1/10 [00:03<00:11,  1.24s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9072, 'compress@10': 1.0, 'time@10': 2.2305}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8883, 'compress@10': 1.0, 'time@10': 1.7492}:  20%|██        | 2/10 [00:03<00:13,  1.74s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0192, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.8883, 'compress@10': 1.0, 'time@10': 1.7492}:  30%|███       | 3/10 [00:03<00:07,  1.14s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 1.769}:  30%|███       | 3/10 [00:05<00:07,  1.14s/it]  {'epoch': 16, 'num_users': 5.0, 'loss': 0.0227, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8931, 'compress@10': 1.0, 'time@10': 1.769}:  40%|████      | 4/10 [00:05<00:08,  1.43s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 2.793}:  40%|████      | 4/10 [00:09<00:08,  1.43s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0243, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.8973, 'compress@10': 1.0, 'time@10': 2.793}:  50%|█████     | 5/10 [00:09<00:10,  2.17s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9046, 'compress@10': 1.0, 'time@10': 2.8632}:  50%|█████     | 5/10 [00:12<00:10,  2.17s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.028, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9046, 'compress@10': 1.0, 'time@10': 2.8632}:  60%|██████    | 6/10 [00:12<00:10,  2.53s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.027, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9078, 'compress@10': 1.0, 'time@10': 2.9969}:  60%|██████    | 6/10 [00:14<00:10,  2.53s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.027, 'hit_ratio@10': 0.8951, 'ndcg@10': 0.9078, 'compress@10': 1.0, 'time@10': 2.9969}:  70%|███████   | 7/10 [00:14<00:07,  2.34s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0267, 'hit_ratio@10': 0.901, 'ndcg@10': 0.909, 'compress@10': 1.0, 'time@10': 2.9504}:  70%|███████   | 7/10 [00:16<00:07,  2.34s/it]  {'epoch': 16, 'num_users': 6.125, 'loss': 0.0267, 'hit_ratio@10': 0.901, 'ndcg@10': 0.909, 'compress@10': 1.0, 'time@10': 2.9504}:  80%|████████  | 8/10 [00:16<00:04,  2.44s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0273, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9286, 'compress@10': 1.0, 'time@10': 3.1782}:  80%|████████  | 8/10 [00:19<00:04,  2.44s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0273, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9286, 'compress@10': 1.0, 'time@10': 3.1782}:  90%|█████████ | 9/10 [00:19<00:02,  2.47s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 3.1812}:  90%|█████████ | 9/10 [00:22<00:02,  2.47s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 3.1812}: 100%|██████████| 10/10 [00:22<00:00,  2.71s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0264, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 3.1812}: 100%|██████████| 10/10 [00:22<00:00,  2.27s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.026432483435403532
Avg hit ratio: 0.8956909722987823
Avg ndcg: 0.9299286830036332
Avg compression ratio: 1.0
Avg train time: 3.1812281131744387
Std train time: 1.6488484277913502
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0309, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 2.5578}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0309, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8949, 'compress@10': 1.0, 'time@10': 2.5578}:  10%|█         | 1/10 [00:01<00:11,  1.31s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 2.3327}:  10%|█         | 1/10 [00:03<00:11,  1.31s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0268, 'hit_ratio@10': 0.8667, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 2.3327}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 1.8312}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]  {'epoch': 17, 'num_users': 5.0, 'loss': 0.0201, 'hit_ratio@10': 0.8159, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 1.8312}:  30%|███       | 3/10 [00:03<00:08,  1.18s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 1.8291}:  30%|███       | 3/10 [00:05<00:08,  1.18s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0231, 'hit_ratio@10': 0.853, 'ndcg@10': 0.8958, 'compress@10': 1.0, 'time@10': 1.8291}:  40%|████      | 4/10 [00:05<00:08,  1.45s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 2.8542}:  40%|████      | 4/10 [00:09<00:08,  1.45s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.024, 'hit_ratio@10': 0.8744, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 2.8542}:  50%|█████     | 5/10 [00:09<00:10,  2.20s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0236, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9053, 'compress@10': 1.0, 'time@10': 2.8936}:  50%|█████     | 5/10 [00:12<00:10,  2.20s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0236, 'hit_ratio@10': 0.8916, 'ndcg@10': 0.9053, 'compress@10': 1.0, 'time@10': 2.8936}:  60%|██████    | 6/10 [00:12<00:10,  2.51s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0253, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.907, 'compress@10': 1.0, 'time@10': 2.9616}:  60%|██████    | 6/10 [00:14<00:10,  2.51s/it] {'epoch': 17, 'num_users': 6.2857, 'loss': 0.0253, 'hit_ratio@10': 0.9014, 'ndcg@10': 0.907, 'compress@10': 1.0, 'time@10': 2.9616}:  70%|███████   | 7/10 [00:14<00:06,  2.25s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0248, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 2.8794}:  70%|███████   | 7/10 [00:16<00:06,  2.25s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0248, 'hit_ratio@10': 0.9066, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 2.8794}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 3.0778}:  80%|████████  | 8/10 [00:18<00:04,  2.28s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0278, 'hit_ratio@10': 0.8852, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 3.0778}:  90%|█████████ | 9/10 [00:18<00:02,  2.31s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0274, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9218, 'compress@10': 1.0, 'time@10': 3.0586}:  90%|█████████ | 9/10 [00:21<00:02,  2.31s/it]   {'epoch': 17, 'num_users': 6.3, 'loss': 0.0274, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9218, 'compress@10': 1.0, 'time@10': 3.0586}: 100%|██████████| 10/10 [00:21<00:00,  2.50s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0274, 'hit_ratio@10': 0.8944, 'ndcg@10': 0.9218, 'compress@10': 1.0, 'time@10': 3.0586}: 100%|██████████| 10/10 [00:21<00:00,  2.18s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02743895890074266
Avg hit ratio: 0.8944211310289409
Avg ndcg: 0.9217870563326697
Avg compression ratio: 1.0
Avg train time: 3.058614420890808
Std train time: 1.6159789329169847
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0281, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 2.5024}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0281, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.894, 'compress@10': 1.0, 'time@10': 2.5024}:  10%|█         | 1/10 [00:01<00:11,  1.30s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 2.392}:  10%|█         | 1/10 [00:03<00:11,  1.30s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9097, 'compress@10': 1.0, 'time@10': 2.392}:  20%|██        | 2/10 [00:03<00:15,  1.90s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 1.8627}:  20%|██        | 2/10 [00:04<00:15,  1.90s/it] {'epoch': 18, 'num_users': 5.0, 'loss': 0.0197, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.89, 'compress@10': 1.0, 'time@10': 1.8627}:  30%|███       | 3/10 [00:04<00:08,  1.23s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8947, 'compress@10': 1.0, 'time@10': 1.8577}:  30%|███       | 3/10 [00:05<00:08,  1.23s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0229, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.8947, 'compress@10': 1.0, 'time@10': 1.8577}:  40%|████      | 4/10 [00:05<00:08,  1.49s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.872, 'ndcg@10': 0.896, 'compress@10': 1.0, 'time@10': 2.8682}:  40%|████      | 4/10 [00:09<00:08,  1.49s/it]  {'epoch': 18, 'num_users': 5.8, 'loss': 0.0252, 'hit_ratio@10': 0.872, 'ndcg@10': 0.896, 'compress@10': 1.0, 'time@10': 2.8682}:  50%|█████     | 5/10 [00:09<00:11,  2.21s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0243, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 2.8943}:  50%|█████     | 5/10 [00:12<00:11,  2.21s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0243, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9016, 'compress@10': 1.0, 'time@10': 2.8943}:  60%|██████    | 6/10 [00:12<00:09,  2.50s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9013, 'compress@10': 1.0, 'time@10': 2.9475}:  60%|██████    | 6/10 [00:14<00:09,  2.50s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0243, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9013, 'compress@10': 1.0, 'time@10': 2.9475}:  70%|███████   | 7/10 [00:14<00:06,  2.23s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9059, 'compress@10': 1.0, 'time@10': 2.8699}:  70%|███████   | 7/10 [00:16<00:06,  2.23s/it] {'epoch': 18, 'num_users': 6.125, 'loss': 0.0239, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9059, 'compress@10': 1.0, 'time@10': 2.8699}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0296, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9175, 'compress@10': 1.0, 'time@10': 3.0684}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0296, 'hit_ratio@10': 0.8839, 'ndcg@10': 0.9175, 'compress@10': 1.0, 'time@10': 3.0684}:  90%|█████████ | 9/10 [00:18<00:02,  2.30s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.03, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9164, 'compress@10': 1.0, 'time@10': 3.0589}:  90%|█████████ | 9/10 [00:21<00:02,  2.30s/it]     {'epoch': 18, 'num_users': 6.3, 'loss': 0.03, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9164, 'compress@10': 1.0, 'time@10': 3.0589}: 100%|██████████| 10/10 [00:21<00:00,  2.52s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.03, 'hit_ratio@10': 0.8932, 'ndcg@10': 0.9164, 'compress@10': 1.0, 'time@10': 3.0589}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.029971807632819397
Avg hit ratio: 0.8931953245773281
Avg ndcg: 0.9164438685045366
Avg compression ratio: 1.0
Avg train time: 3.058891701698303
Std train time: 1.5953268474990463
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 2.5022}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0248, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 2.5022}:  10%|█         | 1/10 [00:01<00:11,  1.29s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.913, 'compress@10': 1.0, 'time@10': 2.3251}:  10%|█         | 1/10 [00:03<00:11,  1.29s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0243, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.913, 'compress@10': 1.0, 'time@10': 2.3251}:  20%|██        | 2/10 [00:03<00:14,  1.81s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 1.8235}:  20%|██        | 2/10 [00:03<00:14,  1.81s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 1.8235}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9007, 'compress@10': 1.0, 'time@10': 1.835}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0208, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9007, 'compress@10': 1.0, 'time@10': 1.835}:  40%|████      | 4/10 [00:05<00:08,  1.47s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9028, 'compress@10': 1.0, 'time@10': 2.8794}:  40%|████      | 4/10 [00:09<00:08,  1.47s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0228, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9028, 'compress@10': 1.0, 'time@10': 2.8794}:  50%|█████     | 5/10 [00:09<00:11,  2.23s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0254, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9116, 'compress@10': 1.0, 'time@10': 2.9391}:  50%|█████     | 5/10 [00:12<00:11,  2.23s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0254, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9116, 'compress@10': 1.0, 'time@10': 2.9391}:  60%|██████    | 6/10 [00:12<00:10,  2.58s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.916, 'compress@10': 1.0, 'time@10': 2.9847}:  60%|██████    | 6/10 [00:14<00:10,  2.58s/it] {'epoch': 19, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.916, 'compress@10': 1.0, 'time@10': 2.9847}:  70%|███████   | 7/10 [00:14<00:06,  2.28s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 2.8915}:  70%|███████   | 7/10 [00:16<00:06,  2.28s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.918, 'compress@10': 1.0, 'time@10': 2.8915}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0263, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9187, 'compress@10': 1.0, 'time@10': 3.0801}:  80%|████████  | 8/10 [00:18<00:04,  2.28s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0263, 'hit_ratio@10': 0.887, 'ndcg@10': 0.9187, 'compress@10': 1.0, 'time@10': 3.0801}:  90%|█████████ | 9/10 [00:18<00:02,  2.30s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9231, 'compress@10': 1.0, 'time@10': 3.0896}:  90%|█████████ | 9/10 [00:22<00:02,  2.30s/it]  {'epoch': 19, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9231, 'compress@10': 1.0, 'time@10': 3.0896}: 100%|██████████| 10/10 [00:22<00:00,  2.58s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0251, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9231, 'compress@10': 1.0, 'time@10': 3.0896}: 100%|██████████| 10/10 [00:22<00:00,  2.21s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.025107967254238327
Avg hit ratio: 0.896052467434471
Avg ndcg: 0.9230859570704497
Avg compression ratio: 1.0
Avg train time: 3.0896249294281004
Std train time: 1.6321174960889397
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0253, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 2.4312}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0253, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 2.4312}:  10%|█         | 1/10 [00:01<00:11,  1.25s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9247, 'compress@10': 1.0, 'time@10': 2.25}:  10%|█         | 1/10 [00:03<00:11,  1.25s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9247, 'compress@10': 1.0, 'time@10': 2.25}:  20%|██        | 2/10 [00:03<00:14,  1.75s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 1.7526}:  20%|██        | 2/10 [00:03<00:14,  1.75s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 1.7526}:  30%|███       | 3/10 [00:03<00:07,  1.14s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9107, 'compress@10': 1.0, 'time@10': 1.7663}:  30%|███       | 3/10 [00:05<00:07,  1.14s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0187, 'hit_ratio@10': 0.8449, 'ndcg@10': 0.9107, 'compress@10': 1.0, 'time@10': 1.7663}:  40%|████      | 4/10 [00:05<00:08,  1.42s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9157, 'compress@10': 1.0, 'time@10': 2.8138}:  40%|████      | 4/10 [00:09<00:08,  1.42s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.0194, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9157, 'compress@10': 1.0, 'time@10': 2.8138}:  50%|█████     | 5/10 [00:09<00:10,  2.18s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9219, 'compress@10': 1.0, 'time@10': 2.8498}:  50%|█████     | 5/10 [00:12<00:10,  2.18s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.9219, 'compress@10': 1.0, 'time@10': 2.8498}:  60%|██████    | 6/10 [00:12<00:09,  2.48s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.0217, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9196, 'compress@10': 1.0, 'time@10': 2.923}:  60%|██████    | 6/10 [00:13<00:09,  2.48s/it] {'epoch': 20, 'num_users': 6.2857, 'loss': 0.0217, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.9196, 'compress@10': 1.0, 'time@10': 2.923}:  70%|███████   | 7/10 [00:13<00:06,  2.23s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0213, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9218, 'compress@10': 1.0, 'time@10': 2.8465}:  70%|███████   | 7/10 [00:16<00:06,  2.23s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0213, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.9218, 'compress@10': 1.0, 'time@10': 2.8465}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9262, 'compress@10': 1.0, 'time@10': 3.0939}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0215, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9262, 'compress@10': 1.0, 'time@10': 3.0939}:  90%|█████████ | 9/10 [00:18<00:02,  2.36s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9275, 'compress@10': 1.0, 'time@10': 3.0735}:  90%|█████████ | 9/10 [00:21<00:02,  2.36s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9275, 'compress@10': 1.0, 'time@10': 3.0735}: 100%|██████████| 10/10 [00:21<00:00,  2.54s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0222, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9275, 'compress@10': 1.0, 'time@10': 3.0735}: 100%|██████████| 10/10 [00:21<00:00,  2.18s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.02223719076245002
Avg hit ratio: 0.9046238960058994
Avg ndcg: 0.9274706641785745
Avg compression ratio: 1.0
Avg train time: 3.0735328912734987
Std train time: 1.6893247098951845
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9098, 'compress@10': 1.0, 'time@10': 2.8525}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0231, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9098, 'compress@10': 1.0, 'time@10': 2.8525}:  10%|█         | 1/10 [00:01<00:13,  1.46s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9331, 'compress@10': 1.0, 'time@10': 2.5831}:  10%|█         | 1/10 [00:03<00:13,  1.46s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0188, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9331, 'compress@10': 1.0, 'time@10': 2.5831}:  20%|██        | 2/10 [00:03<00:15,  1.98s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 2.0265}:  20%|██        | 2/10 [00:04<00:15,  1.98s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0142, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9056, 'compress@10': 1.0, 'time@10': 2.0265}:  30%|███       | 3/10 [00:04<00:09,  1.30s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 2.0178}:  30%|███       | 3/10 [00:06<00:09,  1.30s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8369, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 2.0178}:  40%|████      | 4/10 [00:06<00:09,  1.59s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0209, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.9148, 'compress@10': 1.0, 'time@10': 2.9881}:  40%|████      | 4/10 [00:09<00:09,  1.59s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0209, 'hit_ratio@10': 0.8655, 'ndcg@10': 0.9148, 'compress@10': 1.0, 'time@10': 2.9881}:  50%|█████     | 5/10 [00:09<00:11,  2.27s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9213, 'compress@10': 1.0, 'time@10': 2.9955}:  50%|█████     | 5/10 [00:12<00:11,  2.27s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9213, 'compress@10': 1.0, 'time@10': 2.9955}:  60%|██████    | 6/10 [00:12<00:10,  2.54s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0198, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9204, 'compress@10': 1.0, 'time@10': 3.0279}:  60%|██████    | 6/10 [00:14<00:10,  2.54s/it] {'epoch': 21, 'num_users': 6.2857, 'loss': 0.0198, 'hit_ratio@10': 0.895, 'ndcg@10': 0.9204, 'compress@10': 1.0, 'time@10': 3.0279}:  70%|███████   | 7/10 [00:14<00:06,  2.25s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9225, 'compress@10': 1.0, 'time@10': 2.9422}:  70%|███████   | 7/10 [00:16<00:06,  2.25s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0199, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9225, 'compress@10': 1.0, 'time@10': 2.9422}:  80%|████████  | 8/10 [00:16<00:04,  2.29s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9228, 'compress@10': 1.0, 'time@10': 3.1466}:  80%|████████  | 8/10 [00:19<00:04,  2.29s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8866, 'ndcg@10': 0.9228, 'compress@10': 1.0, 'time@10': 3.1466}:  90%|█████████ | 9/10 [00:19<00:02,  2.33s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9239, 'compress@10': 1.0, 'time@10': 3.1204}:  90%|█████████ | 9/10 [00:22<00:02,  2.33s/it]   {'epoch': 21, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9239, 'compress@10': 1.0, 'time@10': 3.1204}: 100%|██████████| 10/10 [00:22<00:00,  2.51s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0219, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9239, 'compress@10': 1.0, 'time@10': 3.1204}: 100%|██████████| 10/10 [00:22<00:00,  2.22s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.02188798440082419
Avg hit ratio: 0.8956838038400008
Avg ndcg: 0.923911042528345
Avg compression ratio: 1.0
Avg train time: 3.1204464435577393
Std train time: 1.5606524241599415
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9084, 'compress@10': 1.0, 'time@10': 2.3272}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9084, 'compress@10': 1.0, 'time@10': 2.3272}:  10%|█         | 1/10 [00:01<00:10,  1.20s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.924, 'compress@10': 1.0, 'time@10': 2.2268}:  10%|█         | 1/10 [00:03<00:10,  1.20s/it] {'epoch': 22, 'num_users': 7.0, 'loss': 0.0202, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.924, 'compress@10': 1.0, 'time@10': 2.2268}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 1.7514}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0151, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 1.7514}:  30%|███       | 3/10 [00:03<00:08,  1.16s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 1.7895}:  30%|███       | 3/10 [00:05<00:08,  1.16s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0205, 'hit_ratio@10': 0.8101, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 1.7895}:  40%|████      | 4/10 [00:05<00:08,  1.47s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0217, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8869, 'compress@10': 1.0, 'time@10': 2.788}:  40%|████      | 4/10 [00:09<00:08,  1.47s/it] {'epoch': 22, 'num_users': 5.8, 'loss': 0.0217, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.8869, 'compress@10': 1.0, 'time@10': 2.788}:  50%|█████     | 5/10 [00:09<00:10,  2.17s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0262, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 2.826}:  50%|█████     | 5/10 [00:12<00:10,  2.17s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0262, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.8997, 'compress@10': 1.0, 'time@10': 2.826}:  60%|██████    | 6/10 [00:12<00:09,  2.47s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0239, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.906, 'compress@10': 1.0, 'time@10': 2.8828}:  60%|██████    | 6/10 [00:13<00:09,  2.47s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0239, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.906, 'compress@10': 1.0, 'time@10': 2.8828}:  70%|███████   | 7/10 [00:13<00:06,  2.20s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 2.8571}:  70%|███████   | 7/10 [00:16<00:06,  2.20s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0232, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9091, 'compress@10': 1.0, 'time@10': 2.8571}:  80%|████████  | 8/10 [00:16<00:04,  2.36s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0219, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 3.1062}:  80%|████████  | 8/10 [00:19<00:04,  2.36s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0219, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 3.1062}:  90%|█████████ | 9/10 [00:19<00:02,  2.44s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9204, 'compress@10': 1.0, 'time@10': 3.0957}:  90%|█████████ | 9/10 [00:22<00:02,  2.44s/it]   {'epoch': 22, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9204, 'compress@10': 1.0, 'time@10': 3.0957}: 100%|██████████| 10/10 [00:22<00:00,  2.63s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8878, 'ndcg@10': 0.9204, 'compress@10': 1.0, 'time@10': 3.0957}: 100%|██████████| 10/10 [00:22<00:00,  2.22s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.02068072289966424
Avg hit ratio: 0.8878266609828579
Avg ndcg: 0.9204209020684957
Avg compression ratio: 1.0
Avg train time: 3.0957109689712525
Std train time: 1.6133731728792473
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9081, 'compress@10': 1.0, 'time@10': 2.4896}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0233, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9081, 'compress@10': 1.0, 'time@10': 2.4896}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9302, 'compress@10': 1.0, 'time@10': 2.3018}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0232, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9302, 'compress@10': 1.0, 'time@10': 2.3018}:  20%|██        | 2/10 [00:03<00:14,  1.79s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9037, 'compress@10': 1.0, 'time@10': 1.7932}:  20%|██        | 2/10 [00:03<00:14,  1.79s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.017, 'hit_ratio@10': 0.7944, 'ndcg@10': 0.9037, 'compress@10': 1.0, 'time@10': 1.7932}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.9135, 'compress@10': 1.0, 'time@10': 1.8001}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0167, 'hit_ratio@10': 0.8279, 'ndcg@10': 0.9135, 'compress@10': 1.0, 'time@10': 1.8001}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.9178, 'compress@10': 1.0, 'time@10': 2.8553}:  40%|████      | 4/10 [00:09<00:08,  1.44s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0181, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.9178, 'compress@10': 1.0, 'time@10': 2.8553}:  50%|█████     | 5/10 [00:09<00:11,  2.21s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9256, 'compress@10': 1.0, 'time@10': 2.8832}:  50%|█████     | 5/10 [00:12<00:11,  2.21s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9256, 'compress@10': 1.0, 'time@10': 2.8832}:  60%|██████    | 6/10 [00:12<00:09,  2.50s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9248, 'compress@10': 1.0, 'time@10': 2.9895}:  60%|██████    | 6/10 [00:14<00:09,  2.50s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0186, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.9248, 'compress@10': 1.0, 'time@10': 2.9895}:  70%|███████   | 7/10 [00:14<00:06,  2.29s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.927, 'compress@10': 1.0, 'time@10': 2.9129}:  70%|███████   | 7/10 [00:16<00:06,  2.29s/it]  {'epoch': 23, 'num_users': 6.125, 'loss': 0.0183, 'hit_ratio@10': 0.9001, 'ndcg@10': 0.927, 'compress@10': 1.0, 'time@10': 2.9129}:  80%|████████  | 8/10 [00:16<00:04,  2.33s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.1036}:  80%|████████  | 8/10 [00:18<00:04,  2.33s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9321, 'compress@10': 1.0, 'time@10': 3.1036}:  90%|█████████ | 9/10 [00:18<00:02,  2.33s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9323, 'compress@10': 1.0, 'time@10': 3.0859}:  90%|█████████ | 9/10 [00:21<00:02,  2.33s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9323, 'compress@10': 1.0, 'time@10': 3.0859}: 100%|██████████| 10/10 [00:21<00:00,  2.53s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0207, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9323, 'compress@10': 1.0, 'time@10': 3.0859}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.020747076406364064
Avg hit ratio: 0.8892552324114293
Avg ndcg: 0.9323286592758592
Avg compression ratio: 1.0
Avg train time: 3.085875082015991
Std train time: 1.6542022768509155
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9083, 'compress@10': 1.0, 'time@10': 2.4837}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9083, 'compress@10': 1.0, 'time@10': 2.4837}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9357, 'compress@10': 1.0, 'time@10': 2.2623}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0173, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9357, 'compress@10': 1.0, 'time@10': 2.2623}:  20%|██        | 2/10 [00:03<00:13,  1.75s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 1.7659}:  20%|██        | 2/10 [00:03<00:13,  1.75s/it] {'epoch': 24, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.9074, 'compress@10': 1.0, 'time@10': 1.7659}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 1.7986}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8938, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 1.7986}:  40%|████      | 4/10 [00:05<00:08,  1.46s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9227, 'compress@10': 1.0, 'time@10': 2.8102}:  40%|████      | 4/10 [00:09<00:08,  1.46s/it] {'epoch': 24, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.911, 'ndcg@10': 0.9227, 'compress@10': 1.0, 'time@10': 2.8102}:  50%|█████     | 5/10 [00:09<00:10,  2.19s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0182, 'hit_ratio@10': 0.9222, 'ndcg@10': 0.927, 'compress@10': 1.0, 'time@10': 2.8513}:  50%|█████     | 5/10 [00:12<00:10,  2.19s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.0182, 'hit_ratio@10': 0.9222, 'ndcg@10': 0.927, 'compress@10': 1.0, 'time@10': 2.8513}:  60%|██████    | 6/10 [00:12<00:09,  2.49s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.9276, 'ndcg@10': 0.9268, 'compress@10': 1.0, 'time@10': 2.915}:  60%|██████    | 6/10 [00:14<00:09,  2.49s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0187, 'hit_ratio@10': 0.9276, 'ndcg@10': 0.9268, 'compress@10': 1.0, 'time@10': 2.915}:  70%|███████   | 7/10 [00:14<00:06,  2.24s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.9331, 'ndcg@10': 0.9285, 'compress@10': 1.0, 'time@10': 2.8472}:  70%|███████   | 7/10 [00:16<00:06,  2.24s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.9331, 'ndcg@10': 0.9285, 'compress@10': 1.0, 'time@10': 2.8472}:  80%|████████  | 8/10 [00:16<00:04,  2.29s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.9119, 'ndcg@10': 0.9281, 'compress@10': 1.0, 'time@10': 3.1187}:  80%|████████  | 8/10 [00:19<00:04,  2.29s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.9119, 'ndcg@10': 0.9281, 'compress@10': 1.0, 'time@10': 3.1187}:  90%|█████████ | 9/10 [00:19<00:02,  2.41s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9301, 'compress@10': 1.0, 'time@10': 3.1245}:  90%|█████████ | 9/10 [00:22<00:02,  2.41s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9301, 'compress@10': 1.0, 'time@10': 3.1245}: 100%|██████████| 10/10 [00:22<00:00,  2.66s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.9185, 'ndcg@10': 0.9301, 'compress@10': 1.0, 'time@10': 3.1245}: 100%|██████████| 10/10 [00:22<00:00,  2.23s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.019537648419278398
Avg hit ratio: 0.9184584824720649
Avg ndcg: 0.9301246200057636
Avg compression ratio: 1.0
Avg train time: 3.1244932413101196
Std train time: 1.668669064847013
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8946, 'compress@10': 1.0, 'time@10': 2.5204}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8946, 'compress@10': 1.0, 'time@10': 2.5204}:  10%|█         | 1/10 [00:01<00:11,  1.30s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9277, 'compress@10': 1.0, 'time@10': 2.3553}:  10%|█         | 1/10 [00:03<00:11,  1.30s/it] {'epoch': 25, 'num_users': 7.0, 'loss': 0.015, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9277, 'compress@10': 1.0, 'time@10': 2.3553}:  20%|██        | 2/10 [00:03<00:14,  1.84s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 1.834}:  20%|██        | 2/10 [00:03<00:14,  1.84s/it] {'epoch': 25, 'num_users': 5.0, 'loss': 0.0114, 'hit_ratio@10': 0.8596, 'ndcg@10': 0.902, 'compress@10': 1.0, 'time@10': 1.834}:  30%|███       | 3/10 [00:03<00:08,  1.20s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9132, 'compress@10': 1.0, 'time@10': 1.8447}:  30%|███       | 3/10 [00:05<00:08,  1.20s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.015, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9132, 'compress@10': 1.0, 'time@10': 1.8447}:  40%|████      | 4/10 [00:05<00:08,  1.48s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9195, 'compress@10': 1.0, 'time@10': 2.8826}:  40%|████      | 4/10 [00:09<00:08,  1.48s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.9046, 'ndcg@10': 0.9195, 'compress@10': 1.0, 'time@10': 2.8826}:  50%|█████     | 5/10 [00:09<00:11,  2.23s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9326, 'compress@10': 1.0, 'time@10': 2.9089}:  50%|█████     | 5/10 [00:12<00:11,  2.23s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0192, 'hit_ratio@10': 0.9168, 'ndcg@10': 0.9326, 'compress@10': 1.0, 'time@10': 2.9089}:  60%|██████    | 6/10 [00:12<00:10,  2.52s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.923, 'ndcg@10': 0.9349, 'compress@10': 1.0, 'time@10': 2.9863}:  60%|██████    | 6/10 [00:14<00:10,  2.52s/it] {'epoch': 25, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.923, 'ndcg@10': 0.9349, 'compress@10': 1.0, 'time@10': 2.9863}:  70%|███████   | 7/10 [00:14<00:06,  2.27s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0181, 'hit_ratio@10': 0.929, 'ndcg@10': 0.9347, 'compress@10': 1.0, 'time@10': 2.8926}:  70%|███████   | 7/10 [00:16<00:06,  2.27s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0181, 'hit_ratio@10': 0.929, 'ndcg@10': 0.9347, 'compress@10': 1.0, 'time@10': 2.8926}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.959, 'compress@10': 1.0, 'time@10': 3.1017}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.0203, 'hit_ratio@10': 0.9083, 'ndcg@10': 0.959, 'compress@10': 1.0, 'time@10': 3.1017}:  90%|█████████ | 9/10 [00:18<00:02,  2.32s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.9152, 'ndcg@10': 0.96, 'compress@10': 1.0, 'time@10': 3.0797}:  90%|█████████ | 9/10 [00:21<00:02,  2.32s/it]    {'epoch': 25, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.9152, 'ndcg@10': 0.96, 'compress@10': 1.0, 'time@10': 3.0797}: 100%|██████████| 10/10 [00:21<00:00,  2.51s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0199, 'hit_ratio@10': 0.9152, 'ndcg@10': 0.96, 'compress@10': 1.0, 'time@10': 3.0797}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.019937756002074612
Avg hit ratio: 0.915232676020452
Avg ndcg: 0.9599606428458076
Avg compression ratio: 1.0
Avg train time: 3.079692029953003
Std train time: 1.6487697117113294
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 2.6294}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0279, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.873, 'compress@10': 1.0, 'time@10': 2.6294}:  10%|█         | 1/10 [00:01<00:12,  1.35s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9187, 'compress@10': 1.0, 'time@10': 2.3608}:  10%|█         | 1/10 [00:03<00:12,  1.35s/it] {'epoch': 26, 'num_users': 7.0, 'loss': 0.02, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9187, 'compress@10': 1.0, 'time@10': 2.3608}:  20%|██        | 2/10 [00:03<00:14,  1.81s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.896, 'compress@10': 1.0, 'time@10': 1.8378}:  20%|██        | 2/10 [00:03<00:14,  1.81s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.896, 'compress@10': 1.0, 'time@10': 1.8378}:  30%|███       | 3/10 [00:03<00:08,  1.18s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.85, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 1.8422}:  30%|███       | 3/10 [00:05<00:08,  1.18s/it] {'epoch': 26, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.85, 'ndcg@10': 0.9103, 'compress@10': 1.0, 'time@10': 1.8422}:  40%|████      | 4/10 [00:05<00:08,  1.46s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9227, 'compress@10': 1.0, 'time@10': 2.8493}:  40%|████      | 4/10 [00:09<00:08,  1.46s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0177, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9227, 'compress@10': 1.0, 'time@10': 2.8493}:  50%|█████     | 5/10 [00:09<00:10,  2.19s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0159, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9302, 'compress@10': 1.0, 'time@10': 2.8887}:  50%|█████     | 5/10 [00:12<00:10,  2.19s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0159, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9302, 'compress@10': 1.0, 'time@10': 2.8887}:  60%|██████    | 6/10 [00:12<00:10,  2.50s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0168, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9316, 'compress@10': 1.0, 'time@10': 2.9872}:  60%|██████    | 6/10 [00:14<00:10,  2.50s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0168, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9316, 'compress@10': 1.0, 'time@10': 2.9872}:  70%|███████   | 7/10 [00:14<00:06,  2.28s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9337, 'compress@10': 1.0, 'time@10': 2.9109}:  70%|███████   | 7/10 [00:16<00:06,  2.28s/it] {'epoch': 26, 'num_users': 6.125, 'loss': 0.0168, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9337, 'compress@10': 1.0, 'time@10': 2.9109}:  80%|████████  | 8/10 [00:16<00:04,  2.33s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9251, 'compress@10': 1.0, 'time@10': 3.1079}:  80%|████████  | 8/10 [00:19<00:04,  2.33s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0209, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9251, 'compress@10': 1.0, 'time@10': 3.1079}:  90%|█████████ | 9/10 [00:19<00:02,  2.34s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 3.0964}:  90%|█████████ | 9/10 [00:22<00:02,  2.34s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 3.0964}: 100%|██████████| 10/10 [00:22<00:00,  2.56s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0218, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9299, 'compress@10': 1.0, 'time@10': 3.0964}: 100%|██████████| 10/10 [00:22<00:00,  2.21s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.021785966508328695
Avg hit ratio: 0.9038041045918804
Avg ndcg: 0.9299389514905222
Avg compression ratio: 1.0
Avg train time: 3.0963544607162476
Std train time: 1.6017652637793605
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8946, 'compress@10': 1.0, 'time@10': 2.4838}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8946, 'compress@10': 1.0, 'time@10': 2.4838}:  10%|█         | 1/10 [00:01<00:11,  1.30s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9231, 'compress@10': 1.0, 'time@10': 2.3512}:  10%|█         | 1/10 [00:03<00:11,  1.30s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0214, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9231, 'compress@10': 1.0, 'time@10': 2.3512}:  20%|██        | 2/10 [00:03<00:14,  1.86s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 1.8299}:  20%|██        | 2/10 [00:03<00:14,  1.86s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0156, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.8989, 'compress@10': 1.0, 'time@10': 1.8299}:  30%|███       | 3/10 [00:03<00:08,  1.21s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.85, 'ndcg@10': 0.9121, 'compress@10': 1.0, 'time@10': 1.859}:  30%|███       | 3/10 [00:05<00:08,  1.21s/it]   {'epoch': 27, 'num_users': 5.0, 'loss': 0.0175, 'hit_ratio@10': 0.85, 'ndcg@10': 0.9121, 'compress@10': 1.0, 'time@10': 1.859}:  40%|████      | 4/10 [00:05<00:09,  1.51s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0182, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9266, 'compress@10': 1.0, 'time@10': 2.9304}:  40%|████      | 4/10 [00:09<00:09,  1.51s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0182, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9266, 'compress@10': 1.0, 'time@10': 2.9304}:  50%|█████     | 5/10 [00:09<00:11,  2.28s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0171, 'hit_ratio@10': 0.893, 'ndcg@10': 0.933, 'compress@10': 1.0, 'time@10': 2.9347}:  50%|█████     | 5/10 [00:12<00:11,  2.28s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0171, 'hit_ratio@10': 0.893, 'ndcg@10': 0.933, 'compress@10': 1.0, 'time@10': 2.9347}:  60%|██████    | 6/10 [00:12<00:10,  2.52s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9306, 'compress@10': 1.0, 'time@10': 2.9836}:  60%|██████    | 6/10 [00:14<00:10,  2.52s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9306, 'compress@10': 1.0, 'time@10': 2.9836}:  70%|███████   | 7/10 [00:14<00:06,  2.25s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9339, 'compress@10': 1.0, 'time@10': 2.9088}:  70%|███████   | 7/10 [00:16<00:06,  2.25s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9339, 'compress@10': 1.0, 'time@10': 2.9088}:  80%|████████  | 8/10 [00:16<00:04,  2.30s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9489, 'compress@10': 1.0, 'time@10': 3.1362}:  80%|████████  | 8/10 [00:19<00:04,  2.30s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0181, 'hit_ratio@10': 0.8956, 'ndcg@10': 0.9489, 'compress@10': 1.0, 'time@10': 3.1362}:  90%|█████████ | 9/10 [00:19<00:02,  2.37s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 3.112}:  90%|█████████ | 9/10 [00:22<00:02,  2.37s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 3.112}: 100%|██████████| 10/10 [00:22<00:00,  2.54s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0184, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 3.112}: 100%|██████████| 10/10 [00:22<00:00,  2.22s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.01842613244101655
Avg hit ratio: 0.9038041045918804
Avg ndcg: 0.9485868265132871
Avg compression ratio: 1.0
Avg train time: 3.1120136260986326
Std train time: 1.6977046381988
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8946, 'compress@10': 1.0, 'time@10': 2.4689}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8946, 'compress@10': 1.0, 'time@10': 2.4689}:  10%|█         | 1/10 [00:01<00:11,  1.27s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9457, 'compress@10': 1.0, 'time@10': 2.2659}:  10%|█         | 1/10 [00:03<00:11,  1.27s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9457, 'compress@10': 1.0, 'time@10': 2.2659}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.914, 'compress@10': 1.0, 'time@10': 1.7752}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8119, 'ndcg@10': 0.914, 'compress@10': 1.0, 'time@10': 1.7752}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.85, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 1.7808}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it] {'epoch': 28, 'num_users': 5.0, 'loss': 0.0165, 'hit_ratio@10': 0.85, 'ndcg@10': 0.9232, 'compress@10': 1.0, 'time@10': 1.7808}:  40%|████      | 4/10 [00:05<00:08,  1.42s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9357, 'compress@10': 1.0, 'time@10': 2.8354}:  40%|████      | 4/10 [00:09<00:08,  1.42s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0172, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9357, 'compress@10': 1.0, 'time@10': 2.8354}:  50%|█████     | 5/10 [00:09<00:10,  2.19s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9462, 'compress@10': 1.0, 'time@10': 2.8741}:  50%|█████     | 5/10 [00:12<00:10,  2.19s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9462, 'compress@10': 1.0, 'time@10': 2.8741}:  60%|██████    | 6/10 [00:12<00:10,  2.50s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0174, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9466, 'compress@10': 1.0, 'time@10': 2.9532}:  60%|██████    | 6/10 [00:14<00:10,  2.50s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0174, 'hit_ratio@10': 0.9026, 'ndcg@10': 0.9466, 'compress@10': 1.0, 'time@10': 2.9532}:  70%|███████   | 7/10 [00:14<00:06,  2.26s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 2.8694}:  70%|███████   | 7/10 [00:16<00:06,  2.26s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0175, 'hit_ratio@10': 0.9112, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 2.8694}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9397, 'compress@10': 1.0, 'time@10': 3.0672}:  80%|████████  | 8/10 [00:18<00:04,  2.28s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0202, 'hit_ratio@10': 0.8893, 'ndcg@10': 0.9397, 'compress@10': 1.0, 'time@10': 3.0672}:  90%|█████████ | 9/10 [00:18<00:02,  2.31s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9428, 'compress@10': 1.0, 'time@10': 3.0502}:  90%|█████████ | 9/10 [00:21<00:02,  2.31s/it]   {'epoch': 28, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9428, 'compress@10': 1.0, 'time@10': 3.0502}: 100%|██████████| 10/10 [00:21<00:00,  2.50s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0195, 'hit_ratio@10': 0.8981, 'ndcg@10': 0.9428, 'compress@10': 1.0, 'time@10': 3.0502}: 100%|██████████| 10/10 [00:21<00:00,  2.17s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.019534604557788875
Avg hit ratio: 0.8980898188775945
Avg ndcg: 0.9428192599521029
Avg compression ratio: 1.0
Avg train time: 3.0502030849456787
Std train time: 1.6526823453860908
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.5891}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.5891}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9312, 'compress@10': 1.0, 'time@10': 2.3387}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0131, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9312, 'compress@10': 1.0, 'time@10': 2.3387}:  20%|██        | 2/10 [00:03<00:14,  1.81s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9044, 'compress@10': 1.0, 'time@10': 1.8145}:  20%|██        | 2/10 [00:03<00:14,  1.81s/it]  {'epoch': 29, 'num_users': 5.0, 'loss': 0.01, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9044, 'compress@10': 1.0, 'time@10': 1.8145}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9176, 'compress@10': 1.0, 'time@10': 1.8102}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0129, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9176, 'compress@10': 1.0, 'time@10': 1.8102}:  40%|████      | 4/10 [00:05<00:08,  1.43s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 2.7956}:  40%|████      | 4/10 [00:09<00:08,  1.43s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0138, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 2.7956}:  50%|█████     | 5/10 [00:09<00:10,  2.14s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 2.8407}:  50%|█████     | 5/10 [00:12<00:10,  2.14s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8995, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 2.8407}:  60%|██████    | 6/10 [00:12<00:09,  2.47s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9377, 'compress@10': 1.0, 'time@10': 2.9098}:  60%|██████    | 6/10 [00:13<00:09,  2.47s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0127, 'hit_ratio@10': 0.9081, 'ndcg@10': 0.9377, 'compress@10': 1.0, 'time@10': 2.9098}:  70%|███████   | 7/10 [00:13<00:06,  2.22s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9386, 'compress@10': 1.0, 'time@10': 2.8388}:  70%|███████   | 7/10 [00:16<00:06,  2.22s/it]  {'epoch': 29, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.916, 'ndcg@10': 0.9386, 'compress@10': 1.0, 'time@10': 2.8388}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9456, 'compress@10': 1.0, 'time@10': 3.0512}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8968, 'ndcg@10': 0.9456, 'compress@10': 1.0, 'time@10': 3.0512}:  90%|█████████ | 9/10 [00:18<00:02,  2.31s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9493, 'compress@10': 1.0, 'time@10': 3.0386}:  90%|█████████ | 9/10 [00:21<00:02,  2.31s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9493, 'compress@10': 1.0, 'time@10': 3.0386}: 100%|██████████| 10/10 [00:21<00:00,  2.51s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0179, 'hit_ratio@10': 0.9048, 'ndcg@10': 0.9493, 'compress@10': 1.0, 'time@10': 3.0386}: 100%|██████████| 10/10 [00:21<00:00,  2.17s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.01788773745150528
Avg hit ratio: 0.9048307302959255
Avg ndcg: 0.9493379077924156
Avg compression ratio: 1.0
Avg train time: 3.038638734817505
Std train time: 1.5812439615253209
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.8794}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0181, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.8794}:  10%|█         | 1/10 [00:01<00:13,  1.48s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9323, 'compress@10': 1.0, 'time@10': 2.5032}:  10%|█         | 1/10 [00:03<00:13,  1.48s/it] {'epoch': 30, 'num_users': 7.0, 'loss': 0.0187, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9323, 'compress@10': 1.0, 'time@10': 2.5032}:  20%|██        | 2/10 [00:03<00:15,  1.88s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9051, 'compress@10': 1.0, 'time@10': 1.929}:  20%|██        | 2/10 [00:04<00:15,  1.88s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9051, 'compress@10': 1.0, 'time@10': 1.929}:  30%|███       | 3/10 [00:04<00:08,  1.22s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9172, 'compress@10': 1.0, 'time@10': 1.9001}:  30%|███       | 3/10 [00:05<00:08,  1.22s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9172, 'compress@10': 1.0, 'time@10': 1.9001}:  40%|████      | 4/10 [00:05<00:08,  1.47s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.931, 'compress@10': 1.0, 'time@10': 2.8806}:  40%|████      | 4/10 [00:09<00:08,  1.47s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0168, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.931, 'compress@10': 1.0, 'time@10': 2.8806}:  50%|█████     | 5/10 [00:09<00:10,  2.18s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.938, 'compress@10': 1.0, 'time@10': 2.9153}:  50%|█████     | 5/10 [00:12<00:10,  2.18s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0162, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.938, 'compress@10': 1.0, 'time@10': 2.9153}:  60%|██████    | 6/10 [00:12<00:09,  2.50s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0171, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9357, 'compress@10': 1.0, 'time@10': 2.9653}:  60%|██████    | 6/10 [00:14<00:09,  2.50s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0171, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9357, 'compress@10': 1.0, 'time@10': 2.9653}:  70%|███████   | 7/10 [00:14<00:06,  2.23s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0166, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.939, 'compress@10': 1.0, 'time@10': 2.8821}:  70%|███████   | 7/10 [00:16<00:06,  2.23s/it]  {'epoch': 30, 'num_users': 6.125, 'loss': 0.0166, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.939, 'compress@10': 1.0, 'time@10': 2.8821}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9577, 'compress@10': 1.0, 'time@10': 3.0984}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.0183, 'hit_ratio@10': 0.8988, 'ndcg@10': 0.9577, 'compress@10': 1.0, 'time@10': 3.0984}:  90%|█████████ | 9/10 [00:18<00:02,  2.32s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9561, 'compress@10': 1.0, 'time@10': 3.0822}:  90%|█████████ | 9/10 [00:21<00:02,  2.32s/it]   {'epoch': 30, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9561, 'compress@10': 1.0, 'time@10': 3.0822}: 100%|██████████| 10/10 [00:21<00:00,  2.53s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0187, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9561, 'compress@10': 1.0, 'time@10': 3.0822}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.018691938038015832
Avg hit ratio: 0.9066842889236778
Avg ndcg: 0.9560780762636224
Avg compression ratio: 1.0
Avg train time: 3.082154965400696
Std train time: 1.5944027170102562
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 2.5856}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9032, 'compress@10': 1.0, 'time@10': 2.5856}:  10%|█         | 1/10 [00:01<00:11,  1.33s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9454, 'compress@10': 1.0, 'time@10': 2.3139}:  10%|█         | 1/10 [00:03<00:11,  1.33s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0174, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9454, 'compress@10': 1.0, 'time@10': 2.3139}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9138, 'compress@10': 1.0, 'time@10': 1.8034}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0127, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9138, 'compress@10': 1.0, 'time@10': 1.8034}:  30%|███       | 3/10 [00:03<00:08,  1.16s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9243, 'compress@10': 1.0, 'time@10': 1.804}:  30%|███       | 3/10 [00:05<00:08,  1.16s/it] {'epoch': 31, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9243, 'compress@10': 1.0, 'time@10': 1.804}:  40%|████      | 4/10 [00:05<00:08,  1.43s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9367, 'compress@10': 1.0, 'time@10': 2.8324}:  40%|████      | 4/10 [00:09<00:08,  1.43s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.015, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9367, 'compress@10': 1.0, 'time@10': 2.8324}:  50%|█████     | 5/10 [00:09<00:10,  2.18s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 2.8689}:  50%|█████     | 5/10 [00:12<00:10,  2.18s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.017, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 2.8689}:  60%|██████    | 6/10 [00:12<00:09,  2.49s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 2.9274}:  60%|██████    | 6/10 [00:13<00:09,  2.49s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0162, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 2.9274}:  70%|███████   | 7/10 [00:13<00:06,  2.23s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0154, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9501, 'compress@10': 1.0, 'time@10': 2.8595}:  70%|███████   | 7/10 [00:16<00:06,  2.23s/it] {'epoch': 31, 'num_users': 6.125, 'loss': 0.0154, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9501, 'compress@10': 1.0, 'time@10': 2.8595}:  80%|████████  | 8/10 [00:16<00:04,  2.29s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9506, 'compress@10': 1.0, 'time@10': 3.081}:  80%|████████  | 8/10 [00:18<00:04,  2.29s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.0158, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9506, 'compress@10': 1.0, 'time@10': 3.081}:  90%|█████████ | 9/10 [00:18<00:02,  2.34s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9531, 'compress@10': 1.0, 'time@10': 3.0693}:  90%|█████████ | 9/10 [00:21<00:02,  2.34s/it]  {'epoch': 31, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9531, 'compress@10': 1.0, 'time@10': 3.0693}: 100%|██████████| 10/10 [00:21<00:00,  2.55s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0154, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9531, 'compress@10': 1.0, 'time@10': 3.0693}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.015360505219469318
Avg hit ratio: 0.8792362602498427
Avg ndcg: 0.9531307023131849
Avg compression ratio: 1.0
Avg train time: 3.0693079471588134
Std train time: 1.6386072250912451
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9082, 'compress@10': 1.0, 'time@10': 2.5071}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0189, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9082, 'compress@10': 1.0, 'time@10': 2.5071}:  10%|█         | 1/10 [00:01<00:11,  1.31s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9344, 'compress@10': 1.0, 'time@10': 2.3084}:  10%|█         | 1/10 [00:03<00:11,  1.31s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0128, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9344, 'compress@10': 1.0, 'time@10': 2.3084}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 1.8031}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 1.8031}:  30%|███       | 3/10 [00:03<00:08,  1.18s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 1.8062}:  30%|███       | 3/10 [00:05<00:08,  1.18s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0122, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9197, 'compress@10': 1.0, 'time@10': 1.8062}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9312, 'compress@10': 1.0, 'time@10': 2.8027}:  40%|████      | 4/10 [00:09<00:08,  1.44s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0127, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9312, 'compress@10': 1.0, 'time@10': 2.8027}:  50%|█████     | 5/10 [00:09<00:10,  2.16s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9385, 'compress@10': 1.0, 'time@10': 2.8873}:  50%|█████     | 5/10 [00:12<00:10,  2.16s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0111, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9385, 'compress@10': 1.0, 'time@10': 2.8873}:  60%|██████    | 6/10 [00:12<00:10,  2.56s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9404, 'compress@10': 1.0, 'time@10': 2.9456}:  60%|██████    | 6/10 [00:14<00:10,  2.56s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.0111, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9404, 'compress@10': 1.0, 'time@10': 2.9456}:  70%|███████   | 7/10 [00:14<00:06,  2.28s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9433, 'compress@10': 1.0, 'time@10': 2.8608}:  70%|███████   | 7/10 [00:16<00:06,  2.28s/it] {'epoch': 32, 'num_users': 6.125, 'loss': 0.0112, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9433, 'compress@10': 1.0, 'time@10': 2.8608}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9495, 'compress@10': 1.0, 'time@10': 3.0586}:  80%|████████  | 8/10 [00:18<00:04,  2.28s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.8787, 'ndcg@10': 0.9495, 'compress@10': 1.0, 'time@10': 3.0586}:  90%|█████████ | 9/10 [00:18<00:02,  2.31s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9521, 'compress@10': 1.0, 'time@10': 3.04}:  90%|█████████ | 9/10 [00:21<00:02,  2.31s/it]     {'epoch': 32, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9521, 'compress@10': 1.0, 'time@10': 3.04}: 100%|██████████| 10/10 [00:21<00:00,  2.49s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8885, 'ndcg@10': 0.9521, 'compress@10': 1.0, 'time@10': 3.04}: 100%|██████████| 10/10 [00:21<00:00,  2.18s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.012561525357621377
Avg hit ratio: 0.8885450160102113
Avg ndcg: 0.9521159330647011
Avg compression ratio: 1.0
Avg train time: 3.039997625350952
Std train time: 1.5836699151068216
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9082, 'compress@10': 1.0, 'time@10': 2.3724}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0163, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9082, 'compress@10': 1.0, 'time@10': 2.3724}:  10%|█         | 1/10 [00:01<00:10,  1.22s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0081, 'compress@10': 1.0, 'time@10': 2.2346}:  10%|█         | 1/10 [00:03<00:10,  1.22s/it] {'epoch': 33, 'num_users': 7.0, 'loss': 0.0295, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0081, 'compress@10': 1.0, 'time@10': 2.2346}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9556, 'compress@10': 1.0, 'time@10': 1.7514}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0206, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9556, 'compress@10': 1.0, 'time@10': 1.7514}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9535, 'compress@10': 1.0, 'time@10': 1.7752}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0211, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9535, 'compress@10': 1.0, 'time@10': 1.7752}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9608, 'compress@10': 1.0, 'time@10': 2.805}:  40%|████      | 4/10 [00:09<00:08,  1.44s/it] {'epoch': 33, 'num_users': 5.8, 'loss': 0.0207, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9608, 'compress@10': 1.0, 'time@10': 2.805}:  50%|█████     | 5/10 [00:09<00:10,  2.18s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0191, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9628, 'compress@10': 1.0, 'time@10': 2.8549}:  50%|█████     | 5/10 [00:12<00:10,  2.18s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0191, 'hit_ratio@10': 0.8978, 'ndcg@10': 0.9628, 'compress@10': 1.0, 'time@10': 2.8549}:  60%|██████    | 6/10 [00:12<00:10,  2.51s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0191, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9584, 'compress@10': 1.0, 'time@10': 2.9082}:  60%|██████    | 6/10 [00:13<00:10,  2.51s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0191, 'hit_ratio@10': 0.9067, 'ndcg@10': 0.9584, 'compress@10': 1.0, 'time@10': 2.9082}:  70%|███████   | 7/10 [00:13<00:06,  2.23s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9575, 'compress@10': 1.0, 'time@10': 2.8542}:  70%|███████   | 7/10 [00:16<00:06,  2.23s/it] {'epoch': 33, 'num_users': 6.125, 'loss': 0.0184, 'hit_ratio@10': 0.9148, 'ndcg@10': 0.9575, 'compress@10': 1.0, 'time@10': 2.8542}:  80%|████████  | 8/10 [00:16<00:04,  2.32s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9675, 'compress@10': 1.0, 'time@10': 3.0877}:  80%|████████  | 8/10 [00:18<00:04,  2.32s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0193, 'hit_ratio@10': 0.902, 'ndcg@10': 0.9675, 'compress@10': 1.0, 'time@10': 3.0877}:  90%|█████████ | 9/10 [00:18<00:02,  2.38s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.965, 'compress@10': 1.0, 'time@10': 3.0662}:  90%|█████████ | 9/10 [00:21<00:02,  2.38s/it]   {'epoch': 33, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.965, 'compress@10': 1.0, 'time@10': 3.0662}: 100%|██████████| 10/10 [00:21<00:00,  2.54s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0201, 'hit_ratio@10': 0.9095, 'ndcg@10': 0.965, 'compress@10': 1.0, 'time@10': 3.0662}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.020067461082406552
Avg hit ratio: 0.9095414317808206
Avg ndcg: 0.9650135602882731
Avg compression ratio: 1.0
Avg train time: 3.0661506175994875
Std train time: 1.642529517101287
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 2.4831}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0136, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 2.4831}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 2.2654}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0112, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 2.2654}:  20%|██        | 2/10 [00:03<00:14,  1.75s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9075, 'compress@10': 1.0, 'time@10': 1.7676}:  20%|██        | 2/10 [00:03<00:14,  1.75s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9075, 'compress@10': 1.0, 'time@10': 1.7676}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9202, 'compress@10': 1.0, 'time@10': 1.8128}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9202, 'compress@10': 1.0, 'time@10': 1.8128}:  40%|████      | 4/10 [00:05<00:08,  1.48s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.933, 'compress@10': 1.0, 'time@10': 2.8165}:  40%|████      | 4/10 [00:09<00:08,  1.48s/it] {'epoch': 34, 'num_users': 5.8, 'loss': 0.0117, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.933, 'compress@10': 1.0, 'time@10': 2.8165}:  50%|█████     | 5/10 [00:09<00:10,  2.19s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9461, 'compress@10': 1.0, 'time@10': 2.8606}:  50%|█████     | 5/10 [00:12<00:10,  2.19s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.014, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9461, 'compress@10': 1.0, 'time@10': 2.8606}:  60%|██████    | 6/10 [00:12<00:10,  2.51s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9465, 'compress@10': 1.0, 'time@10': 2.9407}:  60%|██████    | 6/10 [00:14<00:10,  2.51s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0139, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9465, 'compress@10': 1.0, 'time@10': 2.9407}:  70%|███████   | 7/10 [00:14<00:06,  2.26s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 2.8594}:  70%|███████   | 7/10 [00:16<00:06,  2.26s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 2.8594}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9385, 'compress@10': 1.0, 'time@10': 3.0558}:  80%|████████  | 8/10 [00:18<00:04,  2.28s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9385, 'compress@10': 1.0, 'time@10': 3.0558}:  90%|█████████ | 9/10 [00:18<00:02,  2.30s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9423, 'compress@10': 1.0, 'time@10': 3.0531}:  90%|█████████ | 9/10 [00:21<00:02,  2.30s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9423, 'compress@10': 1.0, 'time@10': 3.0531}: 100%|██████████| 10/10 [00:21<00:00,  2.54s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9423, 'compress@10': 1.0, 'time@10': 3.0531}: 100%|██████████| 10/10 [00:21<00:00,  2.18s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.0157326609101534
Avg hit ratio: 0.9028307302959255
Avg ndcg: 0.9422868153560386
Avg compression ratio: 1.0
Avg train time: 3.0531008720397947
Std train time: 1.588365209545597
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 2.6347}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0149, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 2.6347}:  10%|█         | 1/10 [00:01<00:12,  1.35s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0257, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9742, 'compress@10': 1.0, 'time@10': 2.3239}:  10%|█         | 1/10 [00:03<00:12,  1.35s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0257, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9742, 'compress@10': 1.0, 'time@10': 2.3239}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.933, 'compress@10': 1.0, 'time@10': 1.8054}:  20%|██        | 2/10 [00:03<00:14,  1.76s/it]  {'epoch': 35, 'num_users': 5.0, 'loss': 0.018, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.933, 'compress@10': 1.0, 'time@10': 1.8054}:  30%|███       | 3/10 [00:03<00:08,  1.15s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9405, 'compress@10': 1.0, 'time@10': 1.7985}:  30%|███       | 3/10 [00:05<00:08,  1.15s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0178, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9405, 'compress@10': 1.0, 'time@10': 1.7985}:  40%|████      | 4/10 [00:05<00:08,  1.41s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0161, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9482, 'compress@10': 1.0, 'time@10': 2.8271}:  40%|████      | 4/10 [00:09<00:08,  1.41s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0161, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9482, 'compress@10': 1.0, 'time@10': 2.8271}:  50%|█████     | 5/10 [00:09<00:10,  2.17s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.953, 'compress@10': 1.0, 'time@10': 2.8838}:  50%|█████     | 5/10 [00:12<00:10,  2.17s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.953, 'compress@10': 1.0, 'time@10': 2.8838}:  60%|██████    | 6/10 [00:12<00:10,  2.52s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9524, 'compress@10': 1.0, 'time@10': 3.0103}:  60%|██████    | 6/10 [00:14<00:10,  2.52s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0133, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9524, 'compress@10': 1.0, 'time@10': 3.0103}:  70%|███████   | 7/10 [00:14<00:06,  2.33s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9537, 'compress@10': 1.0, 'time@10': 2.9242}:  70%|███████   | 7/10 [00:16<00:06,  2.33s/it] {'epoch': 35, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9537, 'compress@10': 1.0, 'time@10': 2.9242}:  80%|████████  | 8/10 [00:16<00:04,  2.34s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9544, 'compress@10': 1.0, 'time@10': 3.1245}:  80%|████████  | 8/10 [00:19<00:04,  2.34s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9544, 'compress@10': 1.0, 'time@10': 3.1245}:  90%|█████████ | 9/10 [00:19<00:02,  2.36s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9563, 'compress@10': 1.0, 'time@10': 3.1141}:  90%|█████████ | 9/10 [00:22<00:02,  2.36s/it]   {'epoch': 35, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9563, 'compress@10': 1.0, 'time@10': 3.1141}: 100%|██████████| 10/10 [00:22<00:00,  2.57s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.0124, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9563, 'compress@10': 1.0, 'time@10': 3.1141}: 100%|██████████| 10/10 [00:22<00:00,  2.21s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.012387345271629168
Avg hit ratio: 0.8935219745355569
Avg ndcg: 0.9563001672087914
Avg compression ratio: 1.0
Avg train time: 3.114117407798767
Std train time: 1.6446053868826025
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 2.4233}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0147, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 2.4233}:  10%|█         | 1/10 [00:01<00:11,  1.25s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9467, 'compress@10': 1.0, 'time@10': 2.2751}:  10%|█         | 1/10 [00:03<00:11,  1.25s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9467, 'compress@10': 1.0, 'time@10': 2.2751}:  20%|██        | 2/10 [00:03<00:14,  1.79s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 1.8042}:  20%|██        | 2/10 [00:03<00:14,  1.79s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0109, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 1.8042}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9253, 'compress@10': 1.0, 'time@10': 1.8358}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.8492, 'ndcg@10': 0.9253, 'compress@10': 1.0, 'time@10': 1.8358}:  40%|████      | 4/10 [00:05<00:08,  1.50s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9394, 'compress@10': 1.0, 'time@10': 2.9737}:  40%|████      | 4/10 [00:09<00:08,  1.50s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0149, 'hit_ratio@10': 0.8753, 'ndcg@10': 0.9394, 'compress@10': 1.0, 'time@10': 2.9737}:  50%|█████     | 5/10 [00:09<00:11,  2.33s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9458, 'compress@10': 1.0, 'time@10': 2.9723}:  50%|█████     | 5/10 [00:12<00:11,  2.33s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8887, 'ndcg@10': 0.9458, 'compress@10': 1.0, 'time@10': 2.9723}:  60%|██████    | 6/10 [00:12<00:10,  2.56s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9466, 'compress@10': 1.0, 'time@10': 3.0124}:  60%|██████    | 6/10 [00:14<00:10,  2.56s/it] {'epoch': 36, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8989, 'ndcg@10': 0.9466, 'compress@10': 1.0, 'time@10': 3.0124}:  70%|███████   | 7/10 [00:14<00:06,  2.26s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9495, 'compress@10': 1.0, 'time@10': 2.9196}:  70%|███████   | 7/10 [00:16<00:06,  2.26s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0125, 'hit_ratio@10': 0.908, 'ndcg@10': 0.9495, 'compress@10': 1.0, 'time@10': 2.9196}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9506, 'compress@10': 1.0, 'time@10': 3.1109}:  80%|████████  | 8/10 [00:18<00:04,  2.28s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0126, 'hit_ratio@10': 0.8833, 'ndcg@10': 0.9506, 'compress@10': 1.0, 'time@10': 3.1109}:  90%|█████████ | 9/10 [00:18<00:02,  2.30s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9499, 'compress@10': 1.0, 'time@10': 3.0919}:  90%|█████████ | 9/10 [00:21<00:02,  2.30s/it]   {'epoch': 36, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9499, 'compress@10': 1.0, 'time@10': 3.0919}: 100%|██████████| 10/10 [00:21<00:00,  2.50s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0132, 'hit_ratio@10': 0.8927, 'ndcg@10': 0.9499, 'compress@10': 1.0, 'time@10': 3.0919}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.013155155647665112
Avg hit ratio: 0.892664831678414
Avg ndcg: 0.9499085103389862
Avg compression ratio: 1.0
Avg train time: 3.091932940483093
Std train time: 1.7464322292971943
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 2.8256}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 2.8256}:  10%|█         | 1/10 [00:01<00:13,  1.45s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9413, 'compress@10': 1.0, 'time@10': 2.571}:  10%|█         | 1/10 [00:03<00:13,  1.45s/it] {'epoch': 37, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9413, 'compress@10': 1.0, 'time@10': 2.571}:  20%|██        | 2/10 [00:03<00:15,  1.98s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9111, 'compress@10': 1.0, 'time@10': 1.9702}:  20%|██        | 2/10 [00:04<00:15,  1.98s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0058, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9111, 'compress@10': 1.0, 'time@10': 1.9702}:  30%|███       | 3/10 [00:04<00:08,  1.27s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9228, 'compress@10': 1.0, 'time@10': 1.9249}:  30%|███       | 3/10 [00:06<00:08,  1.27s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0083, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9228, 'compress@10': 1.0, 'time@10': 1.9249}:  40%|████      | 4/10 [00:06<00:08,  1.49s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.009, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9352, 'compress@10': 1.0, 'time@10': 2.9128}:  40%|████      | 4/10 [00:09<00:08,  1.49s/it] {'epoch': 37, 'num_users': 5.8, 'loss': 0.009, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9352, 'compress@10': 1.0, 'time@10': 2.9128}:  50%|█████     | 5/10 [00:09<00:11,  2.20s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9424, 'compress@10': 1.0, 'time@10': 2.9248}:  50%|█████     | 5/10 [00:12<00:11,  2.20s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9424, 'compress@10': 1.0, 'time@10': 2.9248}:  60%|██████    | 6/10 [00:12<00:09,  2.48s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9442, 'compress@10': 1.0, 'time@10': 3.0203}:  60%|██████    | 6/10 [00:14<00:09,  2.48s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9442, 'compress@10': 1.0, 'time@10': 3.0203}:  70%|███████   | 7/10 [00:14<00:06,  2.27s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 2.9401}:  70%|███████   | 7/10 [00:16<00:06,  2.27s/it] {'epoch': 37, 'num_users': 6.125, 'loss': 0.0123, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 2.9401}:  80%|████████  | 8/10 [00:16<00:04,  2.31s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9569, 'compress@10': 1.0, 'time@10': 3.1354}:  80%|████████  | 8/10 [00:19<00:04,  2.31s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.9009, 'ndcg@10': 0.9569, 'compress@10': 1.0, 'time@10': 3.1354}:  90%|█████████ | 9/10 [00:19<00:02,  2.34s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9589, 'compress@10': 1.0, 'time@10': 3.1215}:  90%|█████████ | 9/10 [00:22<00:02,  2.34s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9589, 'compress@10': 1.0, 'time@10': 3.1215}: 100%|██████████| 10/10 [00:22<00:00,  2.55s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.9085, 'ndcg@10': 0.9589, 'compress@10': 1.0, 'time@10': 3.1215}: 100%|██████████| 10/10 [00:22<00:00,  2.22s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.012624624027001935
Avg hit ratio: 0.9085450160102113
Avg ndcg: 0.9588677272949934
Avg compression ratio: 1.0
Avg train time: 3.121547889709473
Std train time: 1.5921311506202493
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 2.7494}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 2.7494}:  10%|█         | 1/10 [00:01<00:12,  1.41s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9425, 'compress@10': 1.0, 'time@10': 2.4178}:  10%|█         | 1/10 [00:03<00:12,  1.41s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0134, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9425, 'compress@10': 1.0, 'time@10': 2.4178}:  20%|██        | 2/10 [00:03<00:14,  1.83s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9141, 'compress@10': 1.0, 'time@10': 1.8791}:  20%|██        | 2/10 [00:03<00:14,  1.83s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9141, 'compress@10': 1.0, 'time@10': 1.8791}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 1.8611}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0113, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9257, 'compress@10': 1.0, 'time@10': 1.8611}:  40%|████      | 4/10 [00:05<00:08,  1.45s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9411, 'compress@10': 1.0, 'time@10': 2.8471}:  40%|████      | 4/10 [00:09<00:08,  1.45s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0128, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9411, 'compress@10': 1.0, 'time@10': 2.8471}:  50%|█████     | 5/10 [00:09<00:10,  2.16s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 2.9097}:  50%|█████     | 5/10 [00:12<00:10,  2.16s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0125, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.9468, 'compress@10': 1.0, 'time@10': 2.9097}:  60%|██████    | 6/10 [00:12<00:10,  2.54s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9371, 'compress@10': 1.0, 'time@10': 2.9707}:  60%|██████    | 6/10 [00:14<00:10,  2.54s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9371, 'compress@10': 1.0, 'time@10': 2.9707}:  70%|███████   | 7/10 [00:14<00:06,  2.26s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.941, 'compress@10': 1.0, 'time@10': 2.8875}:  70%|███████   | 7/10 [00:16<00:06,  2.26s/it]  {'epoch': 38, 'num_users': 6.125, 'loss': 0.0137, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.941, 'compress@10': 1.0, 'time@10': 2.8875}:  80%|████████  | 8/10 [00:16<00:04,  2.29s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9365, 'compress@10': 1.0, 'time@10': 3.1016}:  80%|████████  | 8/10 [00:18<00:04,  2.29s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0178, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9365, 'compress@10': 1.0, 'time@10': 3.1016}:  90%|█████████ | 9/10 [00:18<00:02,  2.34s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9379, 'compress@10': 1.0, 'time@10': 3.0882}:  90%|█████████ | 9/10 [00:21<00:02,  2.34s/it]   {'epoch': 38, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9379, 'compress@10': 1.0, 'time@10': 3.0882}: 100%|██████████| 10/10 [00:21<00:00,  2.54s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.0185, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9379, 'compress@10': 1.0, 'time@10': 3.0882}: 100%|██████████| 10/10 [00:21<00:00,  2.20s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.018545127951789482
Avg hit ratio: 0.8993386668038619
Avg ndcg: 0.9379072560832252
Avg compression ratio: 1.0
Avg train time: 3.0881947755813597
Std train time: 1.5932637105464647
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 2.4819}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 2.4819}:  10%|█         | 1/10 [00:01<00:11,  1.28s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9422, 'compress@10': 1.0, 'time@10': 2.3442}:  10%|█         | 1/10 [00:03<00:11,  1.28s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0101, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9422, 'compress@10': 1.0, 'time@10': 2.3442}:  20%|██        | 2/10 [00:03<00:14,  1.84s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9138, 'compress@10': 1.0, 'time@10': 1.835}:  20%|██        | 2/10 [00:03<00:14,  1.84s/it] {'epoch': 39, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9138, 'compress@10': 1.0, 'time@10': 1.835}:  30%|███       | 3/10 [00:03<00:08,  1.20s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9238, 'compress@10': 1.0, 'time@10': 1.8485}:  30%|███       | 3/10 [00:05<00:08,  1.20s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0099, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9238, 'compress@10': 1.0, 'time@10': 1.8485}:  40%|████      | 4/10 [00:05<00:08,  1.49s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.935, 'compress@10': 1.0, 'time@10': 2.8832}:  40%|████      | 4/10 [00:09<00:08,  1.49s/it] {'epoch': 39, 'num_users': 5.8, 'loss': 0.0091, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.935, 'compress@10': 1.0, 'time@10': 2.8832}:  50%|█████     | 5/10 [00:09<00:11,  2.23s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9426, 'compress@10': 1.0, 'time@10': 2.9152}:  50%|█████     | 5/10 [00:12<00:11,  2.23s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9426, 'compress@10': 1.0, 'time@10': 2.9152}:  60%|██████    | 6/10 [00:12<00:10,  2.53s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9446, 'compress@10': 1.0, 'time@10': 2.9682}:  60%|██████    | 6/10 [00:14<00:10,  2.53s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0085, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9446, 'compress@10': 1.0, 'time@10': 2.9682}:  70%|███████   | 7/10 [00:14<00:06,  2.25s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.947, 'compress@10': 1.0, 'time@10': 2.8995}:  70%|███████   | 7/10 [00:16<00:06,  2.25s/it]  {'epoch': 39, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.947, 'compress@10': 1.0, 'time@10': 2.8995}:  80%|████████  | 8/10 [00:16<00:04,  2.32s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.9656, 'compress@10': 1.0, 'time@10': 3.1134}:  80%|████████  | 8/10 [00:19<00:04,  2.32s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.0122, 'hit_ratio@10': 0.9041, 'ndcg@10': 0.9656, 'compress@10': 1.0, 'time@10': 3.1134}:  90%|█████████ | 9/10 [00:19<00:02,  2.36s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9667, 'compress@10': 1.0, 'time@10': 3.0925}:  90%|█████████ | 9/10 [00:22<00:02,  2.36s/it]   {'epoch': 39, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9667, 'compress@10': 1.0, 'time@10': 3.0925}: 100%|██████████| 10/10 [00:22<00:00,  2.54s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0117, 'hit_ratio@10': 0.9114, 'ndcg@10': 0.9667, 'compress@10': 1.0, 'time@10': 3.0925}: 100%|██████████| 10/10 [00:22<00:00,  2.21s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.011733487342504411
Avg hit ratio: 0.9114021588673541
Avg ndcg: 0.9667489831157685
Avg compression ratio: 1.0
Avg train time: 3.0924869537353517
Std train time: 1.635555815089702
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 2.4451}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 2.4451}:  10%|█         | 1/10 [00:01<00:11,  1.26s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9907, 'compress@10': 1.0, 'time@10': 2.2496}:  10%|█         | 1/10 [00:03<00:11,  1.26s/it] {'epoch': 40, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9907, 'compress@10': 1.0, 'time@10': 2.2496}:  20%|██        | 2/10 [00:03<00:13,  1.75s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9462, 'compress@10': 1.0, 'time@10': 1.758}:  20%|██        | 2/10 [00:03<00:13,  1.75s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9462, 'compress@10': 1.0, 'time@10': 1.758}:  30%|███       | 3/10 [00:03<00:07,  1.14s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9492, 'compress@10': 1.0, 'time@10': 1.7738}:  30%|███       | 3/10 [00:05<00:07,  1.14s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0161, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9492, 'compress@10': 1.0, 'time@10': 1.7738}:  40%|████      | 4/10 [00:05<00:08,  1.42s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9642, 'compress@10': 1.0, 'time@10': 2.7966}:  40%|████      | 4/10 [00:09<00:08,  1.42s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0174, 'hit_ratio@10': 0.8818, 'ndcg@10': 0.9642, 'compress@10': 1.0, 'time@10': 2.7966}:  50%|█████     | 5/10 [00:09<00:10,  2.17s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9662, 'compress@10': 1.0, 'time@10': 2.8356}:  50%|█████     | 5/10 [00:12<00:10,  2.17s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0188, 'hit_ratio@10': 0.8941, 'ndcg@10': 0.9662, 'compress@10': 1.0, 'time@10': 2.8356}:  60%|██████    | 6/10 [00:12<00:09,  2.47s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0172, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9646, 'compress@10': 1.0, 'time@10': 2.9267}:  60%|██████    | 6/10 [00:13<00:09,  2.47s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0172, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9646, 'compress@10': 1.0, 'time@10': 2.9267}:  70%|███████   | 7/10 [00:13<00:06,  2.24s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9645, 'compress@10': 1.0, 'time@10': 2.842}:  70%|███████   | 7/10 [00:16<00:06,  2.24s/it]   {'epoch': 40, 'num_users': 6.125, 'loss': 0.0163, 'hit_ratio@10': 0.912, 'ndcg@10': 0.9645, 'compress@10': 1.0, 'time@10': 2.842}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9762, 'compress@10': 1.0, 'time@10': 3.0925}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.9027, 'ndcg@10': 0.9762, 'compress@10': 1.0, 'time@10': 3.0925}:  90%|█████████ | 9/10 [00:18<00:02,  2.36s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9755, 'compress@10': 1.0, 'time@10': 3.0973}:  90%|█████████ | 9/10 [00:22<00:02,  2.36s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9755, 'compress@10': 1.0, 'time@10': 3.0973}: 100%|██████████| 10/10 [00:22<00:00,  2.62s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0191, 'hit_ratio@10': 0.9102, 'ndcg@10': 0.9755, 'compress@10': 1.0, 'time@10': 3.0973}: 100%|██████████| 10/10 [00:22<00:00,  2.20s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.019066708070105236
Avg hit ratio: 0.9101763524157412
Avg ndcg: 0.9755473143233878
Avg compression ratio: 1.0
Avg train time: 3.0973252058029175
Std train time: 1.6664252574505167
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9263, 'compress@10': 1.0, 'time@10': 2.398}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9263, 'compress@10': 1.0, 'time@10': 2.398}:  10%|█         | 1/10 [00:01<00:11,  1.23s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9503, 'compress@10': 1.0, 'time@10': 2.2844}:  10%|█         | 1/10 [00:03<00:11,  1.23s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0138, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9503, 'compress@10': 1.0, 'time@10': 2.2844}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9192, 'compress@10': 1.0, 'time@10': 1.7758}:  20%|██        | 2/10 [00:03<00:14,  1.80s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0098, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9192, 'compress@10': 1.0, 'time@10': 1.7758}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9295, 'compress@10': 1.0, 'time@10': 1.7882}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9295, 'compress@10': 1.0, 'time@10': 1.7882}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9392, 'compress@10': 1.0, 'time@10': 2.772}:  40%|████      | 4/10 [00:09<00:08,  1.44s/it] {'epoch': 41, 'num_users': 5.8, 'loss': 0.0099, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9392, 'compress@10': 1.0, 'time@10': 2.772}:  50%|█████     | 5/10 [00:09<00:10,  2.14s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9454, 'compress@10': 1.0, 'time@10': 2.8303}:  50%|█████     | 5/10 [00:12<00:10,  2.14s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.009, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9454, 'compress@10': 1.0, 'time@10': 2.8303}:  60%|██████    | 6/10 [00:12<00:09,  2.49s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.01, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9465, 'compress@10': 1.0, 'time@10': 2.8909}:  60%|██████    | 6/10 [00:13<00:09,  2.49s/it] {'epoch': 41, 'num_users': 6.2857, 'loss': 0.01, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9465, 'compress@10': 1.0, 'time@10': 2.8909}:  70%|███████   | 7/10 [00:13<00:06,  2.22s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9495, 'compress@10': 1.0, 'time@10': 2.8187}:  70%|███████   | 7/10 [00:16<00:06,  2.22s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0095, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9495, 'compress@10': 1.0, 'time@10': 2.8187}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 3.084}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0109, 'hit_ratio@10': 0.8903, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 3.084}:  90%|█████████ | 9/10 [00:18<00:02,  2.38s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.899, 'ndcg@10': 0.951, 'compress@10': 1.0, 'time@10': 3.0768}:  90%|█████████ | 9/10 [00:21<00:02,  2.38s/it]    {'epoch': 41, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.899, 'ndcg@10': 0.951, 'compress@10': 1.0, 'time@10': 3.0768}: 100%|██████████| 10/10 [00:21<00:00,  2.59s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0112, 'hit_ratio@10': 0.899, 'ndcg@10': 0.951, 'compress@10': 1.0, 'time@10': 3.0768}: 100%|██████████| 10/10 [00:21<00:00,  2.20s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.011197922652686959
Avg hit ratio: 0.8989700032093919
Avg ndcg: 0.951043427811865
Avg compression ratio: 1.0
Avg train time: 3.0768326997756956
Std train time: 1.629691339658715
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9298, 'compress@10': 1.0, 'time@10': 2.6326}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9298, 'compress@10': 1.0, 'time@10': 2.6326}:  10%|█         | 1/10 [00:01<00:12,  1.35s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9482, 'compress@10': 1.0, 'time@10': 2.3961}:  10%|█         | 1/10 [00:03<00:12,  1.35s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0085, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9482, 'compress@10': 1.0, 'time@10': 2.3961}:  20%|██        | 2/10 [00:03<00:14,  1.85s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9179, 'compress@10': 1.0, 'time@10': 1.8657}:  20%|██        | 2/10 [00:03<00:14,  1.85s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0062, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9179, 'compress@10': 1.0, 'time@10': 1.8657}:  30%|███       | 3/10 [00:03<00:08,  1.20s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9277, 'compress@10': 1.0, 'time@10': 1.8466}:  30%|███       | 3/10 [00:05<00:08,  1.20s/it] {'epoch': 42, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9277, 'compress@10': 1.0, 'time@10': 1.8466}:  40%|████      | 4/10 [00:05<00:08,  1.45s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9435, 'compress@10': 1.0, 'time@10': 2.9542}:  40%|████      | 4/10 [00:09<00:08,  1.45s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.011, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9435, 'compress@10': 1.0, 'time@10': 2.9542}:  50%|█████     | 5/10 [00:09<00:11,  2.27s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 2.9773}:  50%|█████     | 5/10 [00:12<00:11,  2.27s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0138, 'hit_ratio@10': 0.8961, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 2.9773}:  60%|██████    | 6/10 [00:12<00:10,  2.56s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 3.0137}:  60%|██████    | 6/10 [00:14<00:10,  2.56s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0141, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 3.0137}:  70%|███████   | 7/10 [00:14<00:06,  2.26s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9533, 'compress@10': 1.0, 'time@10': 2.9195}:  70%|███████   | 7/10 [00:16<00:06,  2.26s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0131, 'hit_ratio@10': 0.9135, 'ndcg@10': 0.9533, 'compress@10': 1.0, 'time@10': 2.9195}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9543, 'compress@10': 1.0, 'time@10': 3.1171}:  80%|████████  | 8/10 [00:19<00:04,  2.28s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0128, 'hit_ratio@10': 0.8946, 'ndcg@10': 0.9543, 'compress@10': 1.0, 'time@10': 3.1171}:  90%|█████████ | 9/10 [00:19<00:02,  2.31s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9567, 'compress@10': 1.0, 'time@10': 3.0972}:  90%|█████████ | 9/10 [00:21<00:02,  2.31s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9567, 'compress@10': 1.0, 'time@10': 3.0972}: 100%|██████████| 10/10 [00:21<00:00,  2.51s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.9028, 'ndcg@10': 0.9567, 'compress@10': 1.0, 'time@10': 3.0972}: 100%|██████████| 10/10 [00:21<00:00,  2.20s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.012125515318213872
Avg hit ratio: 0.9028307302959255
Avg ndcg: 0.9566953872802619
Avg compression ratio: 1.0
Avg train time: 3.097187900543213
Std train time: 1.724944304024903
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 2.8627}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0092, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 2.8627}:  10%|█         | 1/10 [00:01<00:13,  1.47s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.962, 'compress@10': 1.0, 'time@10': 2.5396}:  10%|█         | 1/10 [00:03<00:13,  1.47s/it] {'epoch': 43, 'num_users': 7.0, 'loss': 0.0125, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.962, 'compress@10': 1.0, 'time@10': 2.5396}:  20%|██        | 2/10 [00:03<00:15,  1.93s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9271, 'compress@10': 1.0, 'time@10': 1.9597}:  20%|██        | 2/10 [00:04<00:15,  1.93s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0088, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9271, 'compress@10': 1.0, 'time@10': 1.9597}:  30%|███       | 3/10 [00:04<00:08,  1.25s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9339, 'compress@10': 1.0, 'time@10': 1.9147}:  30%|███       | 3/10 [00:05<00:08,  1.25s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9339, 'compress@10': 1.0, 'time@10': 1.9147}:  40%|████      | 4/10 [00:05<00:08,  1.47s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9427, 'compress@10': 1.0, 'time@10': 2.9115}:  40%|████      | 4/10 [00:09<00:08,  1.47s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0103, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9427, 'compress@10': 1.0, 'time@10': 2.9115}:  50%|█████     | 5/10 [00:09<00:10,  2.20s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9482, 'compress@10': 1.0, 'time@10': 2.9394}:  50%|█████     | 5/10 [00:12<00:10,  2.20s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9482, 'compress@10': 1.0, 'time@10': 2.9394}:  60%|██████    | 6/10 [00:12<00:10,  2.51s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0081, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9495, 'compress@10': 1.0, 'time@10': 2.9893}:  60%|██████    | 6/10 [00:14<00:10,  2.51s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0081, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9495, 'compress@10': 1.0, 'time@10': 2.9893}:  70%|███████   | 7/10 [00:14<00:06,  2.24s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0079, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9521, 'compress@10': 1.0, 'time@10': 2.9073}:  70%|███████   | 7/10 [00:16<00:06,  2.24s/it] {'epoch': 43, 'num_users': 6.125, 'loss': 0.0079, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9521, 'compress@10': 1.0, 'time@10': 2.9073}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0083, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9537, 'compress@10': 1.0, 'time@10': 3.1122}:  80%|████████  | 8/10 [00:19<00:04,  2.28s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0083, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9537, 'compress@10': 1.0, 'time@10': 3.1122}:  90%|█████████ | 9/10 [00:19<00:02,  2.32s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0079, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.956, 'compress@10': 1.0, 'time@10': 3.0904}:  90%|█████████ | 9/10 [00:21<00:02,  2.32s/it]   {'epoch': 43, 'num_users': 6.3, 'loss': 0.0079, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.956, 'compress@10': 1.0, 'time@10': 3.0904}: 100%|██████████| 10/10 [00:21<00:00,  2.51s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.0079, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.956, 'compress@10': 1.0, 'time@10': 3.0904}: 100%|██████████| 10/10 [00:21<00:00,  2.20s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.007949326403723974
Avg hit ratio: 0.890664831678414
Avg ndcg: 0.9560370130353718
Avg compression ratio: 1.0
Avg train time: 3.090407133102417
Std train time: 1.603009832232858
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 2.5589}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0105, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 2.5589}:  10%|█         | 1/10 [00:01<00:11,  1.31s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9459, 'compress@10': 1.0, 'time@10': 2.3061}:  10%|█         | 1/10 [00:03<00:11,  1.31s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9459, 'compress@10': 1.0, 'time@10': 2.3061}:  20%|██        | 2/10 [00:03<00:14,  1.77s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9163, 'compress@10': 1.0, 'time@10': 1.8434}:  20%|██        | 2/10 [00:03<00:14,  1.77s/it] {'epoch': 44, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9163, 'compress@10': 1.0, 'time@10': 1.8434}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 1.8331}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0095, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 1.8331}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.948, 'compress@10': 1.0, 'time@10': 2.8677}:  40%|████      | 4/10 [00:09<00:08,  1.44s/it] {'epoch': 44, 'num_users': 5.8, 'loss': 0.0118, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.948, 'compress@10': 1.0, 'time@10': 2.8677}:  50%|█████     | 5/10 [00:09<00:10,  2.20s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9572, 'compress@10': 1.0, 'time@10': 2.9387}:  50%|█████     | 5/10 [00:12<00:10,  2.20s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0135, 'hit_ratio@10': 0.8697, 'ndcg@10': 0.9572, 'compress@10': 1.0, 'time@10': 2.9387}:  60%|██████    | 6/10 [00:12<00:10,  2.58s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9574, 'compress@10': 1.0, 'time@10': 3.0033}:  60%|██████    | 6/10 [00:14<00:10,  2.58s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0122, 'hit_ratio@10': 0.8826, 'ndcg@10': 0.9574, 'compress@10': 1.0, 'time@10': 3.0033}:  70%|███████   | 7/10 [00:14<00:06,  2.30s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9586, 'compress@10': 1.0, 'time@10': 2.9258}:  70%|███████   | 7/10 [00:16<00:06,  2.30s/it] {'epoch': 44, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8937, 'ndcg@10': 0.9586, 'compress@10': 1.0, 'time@10': 2.9258}:  80%|████████  | 8/10 [00:16<00:04,  2.34s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9651, 'compress@10': 1.0, 'time@10': 3.1312}:  80%|████████  | 8/10 [00:19<00:04,  2.34s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0149, 'hit_ratio@10': 0.8706, 'ndcg@10': 0.9651, 'compress@10': 1.0, 'time@10': 3.1312}:  90%|█████████ | 9/10 [00:19<00:02,  2.37s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.963, 'compress@10': 1.0, 'time@10': 3.1107}:  90%|█████████ | 9/10 [00:22<00:02,  2.37s/it]    {'epoch': 44, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.963, 'compress@10': 1.0, 'time@10': 3.1107}: 100%|██████████| 10/10 [00:22<00:00,  2.55s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0153, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.963, 'compress@10': 1.0, 'time@10': 3.1107}: 100%|██████████| 10/10 [00:22<00:00,  2.21s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.015292044156075837
Avg hit ratio: 0.881259301724497
Avg ndcg: 0.9630145460645837
Avg compression ratio: 1.0
Avg train time: 3.1107170581817627
Std train time: 1.6297622024484404
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9351, 'compress@10': 1.0, 'time@10': 2.8735}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.007, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9351, 'compress@10': 1.0, 'time@10': 2.8735}:  10%|█         | 1/10 [00:01<00:13,  1.48s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9536, 'compress@10': 1.0, 'time@10': 2.4662}:  10%|█         | 1/10 [00:03<00:13,  1.48s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9536, 'compress@10': 1.0, 'time@10': 2.4662}:  20%|██        | 2/10 [00:03<00:14,  1.84s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9214, 'compress@10': 1.0, 'time@10': 1.9029}:  20%|██        | 2/10 [00:03<00:14,  1.84s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0097, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9214, 'compress@10': 1.0, 'time@10': 1.9029}:  30%|███       | 3/10 [00:03<00:08,  1.19s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9316, 'compress@10': 1.0, 'time@10': 1.8742}:  30%|███       | 3/10 [00:05<00:08,  1.19s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9316, 'compress@10': 1.0, 'time@10': 1.8742}:  40%|████      | 4/10 [00:05<00:08,  1.44s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9413, 'compress@10': 1.0, 'time@10': 3.0376}:  40%|████      | 4/10 [00:09<00:08,  1.44s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0093, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9413, 'compress@10': 1.0, 'time@10': 3.0376}:  50%|█████     | 5/10 [00:09<00:11,  2.32s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9472, 'compress@10': 1.0, 'time@10': 3.0773}:  50%|█████     | 5/10 [00:13<00:11,  2.32s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9472, 'compress@10': 1.0, 'time@10': 3.0773}:  60%|██████    | 6/10 [00:13<00:10,  2.66s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.949, 'compress@10': 1.0, 'time@10': 3.1201}:  60%|██████    | 6/10 [00:14<00:10,  2.66s/it] {'epoch': 45, 'num_users': 6.2857, 'loss': 0.0107, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.949, 'compress@10': 1.0, 'time@10': 3.1201}:  70%|███████   | 7/10 [00:14<00:07,  2.35s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 3.0167}:  70%|███████   | 7/10 [00:17<00:07,  2.35s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0111, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 3.0167}:  80%|████████  | 8/10 [00:17<00:04,  2.35s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9644, 'compress@10': 1.0, 'time@10': 3.2286}:  80%|████████  | 8/10 [00:19<00:04,  2.35s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8874, 'ndcg@10': 0.9644, 'compress@10': 1.0, 'time@10': 3.2286}:  90%|█████████ | 9/10 [00:19<00:02,  2.40s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9657, 'compress@10': 1.0, 'time@10': 3.1987}:  90%|█████████ | 9/10 [00:22<00:02,  2.40s/it]   {'epoch': 45, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9657, 'compress@10': 1.0, 'time@10': 3.1987}: 100%|██████████| 10/10 [00:22<00:00,  2.57s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0121, 'hit_ratio@10': 0.8964, 'ndcg@10': 0.9657, 'compress@10': 1.0, 'time@10': 3.1987}: 100%|██████████| 10/10 [00:22<00:00,  2.26s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.012125735645397786
Avg hit ratio: 0.8964021588673541
Avg ndcg: 0.9656785145738317
Avg compression ratio: 1.0
Avg train time: 3.198677396774292
Std train time: 1.82633991596829
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 2.3999}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0108, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 2.3999}:  10%|█         | 1/10 [00:01<00:11,  1.23s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9501, 'compress@10': 1.0, 'time@10': 2.3467}:  10%|█         | 1/10 [00:03<00:11,  1.23s/it] {'epoch': 46, 'num_users': 7.0, 'loss': 0.011, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9501, 'compress@10': 1.0, 'time@10': 2.3467}:  20%|██        | 2/10 [00:03<00:15,  1.88s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 1.8529}:  20%|██        | 2/10 [00:04<00:15,  1.88s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 1.8529}:  30%|███       | 3/10 [00:04<00:08,  1.23s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9297, 'compress@10': 1.0, 'time@10': 1.833}:  30%|███       | 3/10 [00:05<00:08,  1.23s/it] {'epoch': 46, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9297, 'compress@10': 1.0, 'time@10': 1.833}:  40%|████      | 4/10 [00:05<00:08,  1.46s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.9459, 'compress@10': 1.0, 'time@10': 2.828}:  40%|████      | 4/10 [00:09<00:08,  1.46s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8396, 'ndcg@10': 0.9459, 'compress@10': 1.0, 'time@10': 2.828}:  50%|█████     | 5/10 [00:09<00:10,  2.17s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9531, 'compress@10': 1.0, 'time@10': 2.8912}:  50%|█████     | 5/10 [00:12<00:10,  2.17s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8589, 'ndcg@10': 0.9531, 'compress@10': 1.0, 'time@10': 2.8912}:  60%|██████    | 6/10 [00:12<00:10,  2.54s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9531, 'compress@10': 1.0, 'time@10': 2.9557}:  60%|██████    | 6/10 [00:14<00:10,  2.54s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0143, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9531, 'compress@10': 1.0, 'time@10': 2.9557}:  70%|███████   | 7/10 [00:14<00:06,  2.27s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9591, 'compress@10': 1.0, 'time@10': 2.8875}:  70%|███████   | 7/10 [00:16<00:06,  2.27s/it]  {'epoch': 46, 'num_users': 6.125, 'loss': 0.014, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.9591, 'compress@10': 1.0, 'time@10': 2.8875}:  80%|████████  | 8/10 [00:16<00:04,  2.33s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9591, 'compress@10': 1.0, 'time@10': 3.1123}:  80%|████████  | 8/10 [00:19<00:04,  2.33s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0147, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9591, 'compress@10': 1.0, 'time@10': 3.1123}:  90%|█████████ | 9/10 [00:19<00:02,  2.38s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9585, 'compress@10': 1.0, 'time@10': 3.0908}:  90%|█████████ | 9/10 [00:22<00:02,  2.38s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9585, 'compress@10': 1.0, 'time@10': 3.0908}: 100%|██████████| 10/10 [00:22<00:00,  2.55s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0151, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9585, 'compress@10': 1.0, 'time@10': 3.0908}: 100%|██████████| 10/10 [00:22<00:00,  2.21s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.015147287562210704
Avg hit ratio: 0.8805219745355568
Avg ndcg: 0.9584670639270483
Avg compression ratio: 1.0
Avg train time: 3.0907848119735717
Std train time: 1.597183490955774
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9351, 'compress@10': 1.0, 'time@10': 2.6571}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0079, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9351, 'compress@10': 1.0, 'time@10': 2.6571}:  10%|█         | 1/10 [00:01<00:12,  1.37s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0053, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9514, 'compress@10': 1.0, 'time@10': 2.3945}:  10%|█         | 1/10 [00:03<00:12,  1.37s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0053, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9514, 'compress@10': 1.0, 'time@10': 2.3945}:  20%|██        | 2/10 [00:03<00:14,  1.84s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0039, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.92, 'compress@10': 1.0, 'time@10': 1.8694}:  20%|██        | 2/10 [00:03<00:14,  1.84s/it]  {'epoch': 47, 'num_users': 5.0, 'loss': 0.0039, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.92, 'compress@10': 1.0, 'time@10': 1.8694}:  30%|███       | 3/10 [00:03<00:08,  1.20s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.93, 'compress@10': 1.0, 'time@10': 1.889}:  30%|███       | 3/10 [00:05<00:08,  1.20s/it] {'epoch': 47, 'num_users': 5.0, 'loss': 0.0065, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.93, 'compress@10': 1.0, 'time@10': 1.889}:  40%|████      | 4/10 [00:05<00:09,  1.52s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0067, 'hit_ratio@10': 0.855, 'ndcg@10': 0.94, 'compress@10': 1.0, 'time@10': 2.8933}:  40%|████      | 4/10 [00:09<00:09,  1.52s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0067, 'hit_ratio@10': 0.855, 'ndcg@10': 0.94, 'compress@10': 1.0, 'time@10': 2.8933}:  50%|█████     | 5/10 [00:09<00:11,  2.23s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9461, 'compress@10': 1.0, 'time@10': 2.9642}:  50%|█████     | 5/10 [00:12<00:11,  2.23s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0061, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9461, 'compress@10': 1.0, 'time@10': 2.9642}:  60%|██████    | 6/10 [00:12<00:10,  2.61s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0055, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9481, 'compress@10': 1.0, 'time@10': 3.0095}:  60%|██████    | 6/10 [00:14<00:10,  2.61s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0055, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9481, 'compress@10': 1.0, 'time@10': 3.0095}:  70%|███████   | 7/10 [00:14<00:06,  2.31s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0056, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9508, 'compress@10': 1.0, 'time@10': 2.9206}:  70%|███████   | 7/10 [00:16<00:06,  2.31s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0056, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9508, 'compress@10': 1.0, 'time@10': 2.9206}:  80%|████████  | 8/10 [00:16<00:04,  2.31s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0058, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9526, 'compress@10': 1.0, 'time@10': 3.1318}:  80%|████████  | 8/10 [00:19<00:04,  2.31s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.0058, 'hit_ratio@10': 0.8783, 'ndcg@10': 0.9526, 'compress@10': 1.0, 'time@10': 3.1318}:  90%|█████████ | 9/10 [00:19<00:02,  2.36s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.955, 'compress@10': 1.0, 'time@10': 3.1092}:  90%|█████████ | 9/10 [00:22<00:02,  2.36s/it]    {'epoch': 47, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.955, 'compress@10': 1.0, 'time@10': 3.1092}: 100%|██████████| 10/10 [00:22<00:00,  2.54s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0059, 'hit_ratio@10': 0.8882, 'ndcg@10': 0.955, 'compress@10': 1.0, 'time@10': 3.1092}: 100%|██████████| 10/10 [00:22<00:00,  2.22s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.005883434229702392
Avg hit ratio: 0.8881993938903957
Avg ndcg: 0.9550429048643491
Avg compression ratio: 1.0
Avg train time: 3.1092185497283937
Std train time: 1.6096105877895497
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.94, 'compress@10': 1.0, 'time@10': 2.461}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.94, 'compress@10': 1.0, 'time@10': 2.461}:  10%|█         | 1/10 [00:01<00:11,  1.26s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9763, 'compress@10': 1.0, 'time@10': 2.3407}:  10%|█         | 1/10 [00:03<00:11,  1.26s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0153, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9763, 'compress@10': 1.0, 'time@10': 2.3407}:  20%|██        | 2/10 [00:03<00:14,  1.85s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9366, 'compress@10': 1.0, 'time@10': 1.8659}:  20%|██        | 2/10 [00:04<00:14,  1.85s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9366, 'compress@10': 1.0, 'time@10': 1.8659}:  30%|███       | 3/10 [00:04<00:08,  1.23s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9412, 'compress@10': 1.0, 'time@10': 1.8968}:  30%|███       | 3/10 [00:06<00:08,  1.23s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9412, 'compress@10': 1.0, 'time@10': 1.8968}:  40%|████      | 4/10 [00:06<00:09,  1.54s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9532, 'compress@10': 1.0, 'time@10': 2.8871}:  40%|████      | 4/10 [00:09<00:09,  1.54s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0124, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9532, 'compress@10': 1.0, 'time@10': 2.8871}:  50%|█████     | 5/10 [00:09<00:11,  2.23s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.9587, 'compress@10': 1.0, 'time@10': 2.9305}:  50%|█████     | 5/10 [00:12<00:11,  2.23s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0136, 'hit_ratio@10': 0.8573, 'ndcg@10': 0.9587, 'compress@10': 1.0, 'time@10': 2.9305}:  60%|██████    | 6/10 [00:12<00:10,  2.56s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9589, 'compress@10': 1.0, 'time@10': 2.9825}:  60%|██████    | 6/10 [00:14<00:10,  2.56s/it] {'epoch': 48, 'num_users': 6.2857, 'loss': 0.0119, 'hit_ratio@10': 0.872, 'ndcg@10': 0.9589, 'compress@10': 1.0, 'time@10': 2.9825}:  70%|███████   | 7/10 [00:14<00:06,  2.27s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9601, 'compress@10': 1.0, 'time@10': 2.8916}:  70%|███████   | 7/10 [00:16<00:06,  2.27s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.8844, 'ndcg@10': 0.9601, 'compress@10': 1.0, 'time@10': 2.8916}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9608, 'compress@10': 1.0, 'time@10': 3.0937}:  80%|████████  | 8/10 [00:19<00:04,  2.28s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0118, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9608, 'compress@10': 1.0, 'time@10': 3.0937}:  90%|█████████ | 9/10 [00:19<00:02,  2.31s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.891, 'ndcg@10': 0.963, 'compress@10': 1.0, 'time@10': 3.0797}:  90%|█████████ | 9/10 [00:22<00:02,  2.31s/it]     {'epoch': 48, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.891, 'ndcg@10': 0.963, 'compress@10': 1.0, 'time@10': 3.0797}: 100%|██████████| 10/10 [00:22<00:00,  2.52s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0118, 'hit_ratio@10': 0.891, 'ndcg@10': 0.963, 'compress@10': 1.0, 'time@10': 3.0797}: 100%|██████████| 10/10 [00:22<00:00,  2.20s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.011776037956165074
Avg hit ratio: 0.8909541301935191
Avg ndcg: 0.9629962920717363
Avg compression ratio: 1.0
Avg train time: 3.0796560525894163
Std train time: 1.5684421678310247
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.94, 'compress@10': 1.0, 'time@10': 2.4423}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0074, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.94, 'compress@10': 1.0, 'time@10': 2.4423}:  10%|█         | 1/10 [00:01<00:11,  1.26s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9509, 'compress@10': 1.0, 'time@10': 2.2729}:  10%|█         | 1/10 [00:03<00:11,  1.26s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0107, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9509, 'compress@10': 1.0, 'time@10': 2.2729}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9196, 'compress@10': 1.0, 'time@10': 1.7749}:  20%|██        | 2/10 [00:03<00:14,  1.78s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.8181, 'ndcg@10': 0.9196, 'compress@10': 1.0, 'time@10': 1.7749}:  30%|███       | 3/10 [00:03<00:08,  1.17s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9308, 'compress@10': 1.0, 'time@10': 1.8135}:  30%|███       | 3/10 [00:05<00:08,  1.17s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0085, 'hit_ratio@10': 0.8368, 'ndcg@10': 0.9308, 'compress@10': 1.0, 'time@10': 1.8135}:  40%|████      | 4/10 [00:05<00:08,  1.48s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9417, 'compress@10': 1.0, 'time@10': 2.8621}:  40%|████      | 4/10 [00:09<00:08,  1.48s/it]  {'epoch': 49, 'num_users': 5.8, 'loss': 0.01, 'hit_ratio@10': 0.8614, 'ndcg@10': 0.9417, 'compress@10': 1.0, 'time@10': 2.8621}:  50%|█████     | 5/10 [00:09<00:11,  2.23s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9477, 'compress@10': 1.0, 'time@10': 2.9158}:  50%|█████     | 5/10 [00:12<00:11,  2.23s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0093, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9477, 'compress@10': 1.0, 'time@10': 2.9158}:  60%|██████    | 6/10 [00:12<00:10,  2.57s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9512, 'compress@10': 1.0, 'time@10': 2.9731}:  60%|██████    | 6/10 [00:14<00:10,  2.57s/it] {'epoch': 49, 'num_users': 6.2857, 'loss': 0.0112, 'hit_ratio@10': 0.889, 'ndcg@10': 0.9512, 'compress@10': 1.0, 'time@10': 2.9731}:  70%|███████   | 7/10 [00:14<00:06,  2.28s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9527, 'compress@10': 1.0, 'time@10': 2.8971}:  70%|███████   | 7/10 [00:16<00:06,  2.28s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8993, 'ndcg@10': 0.9527, 'compress@10': 1.0, 'time@10': 2.8971}:  80%|████████  | 8/10 [00:16<00:04,  2.32s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9553, 'compress@10': 1.0, 'time@10': 3.1184}:  80%|████████  | 8/10 [00:19<00:04,  2.32s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9553, 'compress@10': 1.0, 'time@10': 3.1184}:  90%|█████████ | 9/10 [00:19<00:02,  2.37s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9561, 'compress@10': 1.0, 'time@10': 3.1361}:  90%|█████████ | 9/10 [00:22<00:02,  2.37s/it]    {'epoch': 49, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9561, 'compress@10': 1.0, 'time@10': 3.1361}: 100%|██████████| 10/10 [00:22<00:00,  2.67s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.017, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9561, 'compress@10': 1.0, 'time@10': 3.1361}: 100%|██████████| 10/10 [00:22<00:00,  2.25s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.016985576844429546
Avg hit ratio: 0.8857109146277228
Avg ndcg: 0.9560838765193507
Avg compression ratio: 1.0
Avg train time: 3.1360678672790527
Std train time: 1.6631029978268574
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 10, 10, 10, 10, 10, 10, 10, 10]
