  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1459, 'hit_ratio@10': 0.6316, 'ndcg@10': 0.5116, 'compress@10': 1.0, 'time@10': 3.8694}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1459, 'hit_ratio@10': 0.6316, 'ndcg@10': 0.5116, 'compress@10': 1.0, 'time@10': 3.8694}:  10%|█         | 1/10 [00:01<00:17,  1.97s/it]{'epoch': 0, 'num_users': 7.0, 'loss': 0.1069, 'hit_ratio@10': 0.6868, 'ndcg@10': 0.655, 'compress@10': 1.0, 'time@10': 3.0302}:  10%|█         | 1/10 [00:04<00:17,  1.97s/it] {'epoch': 0, 'num_users': 7.0, 'loss': 0.1069, 'hit_ratio@10': 0.6868, 'ndcg@10': 0.655, 'compress@10': 1.0, 'time@10': 3.0302}:  20%|██        | 2/10 [00:04<00:16,  2.12s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7022, 'hit_ratio@10': 0.5531, 'ndcg@10': 0.4477, 'compress@10': 1.0, 'time@10': 2.2998}:  20%|██        | 2/10 [00:04<00:16,  2.12s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.7022, 'hit_ratio@10': 0.5531, 'ndcg@10': 0.4477, 'compress@10': 1.0, 'time@10': 2.2998}:  30%|███       | 3/10 [00:04<00:09,  1.36s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5481, 'hit_ratio@10': 0.6291, 'ndcg@10': 0.5107, 'compress@10': 1.0, 'time@10': 2.2027}:  30%|███       | 3/10 [00:06<00:09,  1.36s/it]{'epoch': 0, 'num_users': 5.0, 'loss': 0.5481, 'hit_ratio@10': 0.6291, 'ndcg@10': 0.5107, 'compress@10': 1.0, 'time@10': 2.2027}:  40%|████      | 4/10 [00:06<00:09,  1.60s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4569, 'hit_ratio@10': 0.6673, 'ndcg@10': 0.5601, 'compress@10': 1.0, 'time@10': 3.2056}:  40%|████      | 4/10 [00:10<00:09,  1.60s/it]{'epoch': 0, 'num_users': 5.8, 'loss': 0.4569, 'hit_ratio@10': 0.6673, 'ndcg@10': 0.5601, 'compress@10': 1.0, 'time@10': 3.2056}:  50%|█████     | 5/10 [00:10<00:11,  2.34s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.3948, 'hit_ratio@10': 0.6709, 'ndcg@10': 0.6018, 'compress@10': 1.0, 'time@10': 3.215}:  50%|█████     | 5/10 [00:13<00:11,  2.34s/it]{'epoch': 0, 'num_users': 6.1667, 'loss': 0.3948, 'hit_ratio@10': 0.6709, 'ndcg@10': 0.6018, 'compress@10': 1.0, 'time@10': 3.215}:  60%|██████    | 6/10 [00:13<00:10,  2.67s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3519, 'hit_ratio@10': 0.6836, 'ndcg@10': 0.6031, 'compress@10': 1.0, 'time@10': 3.2717}:  60%|██████    | 6/10 [00:15<00:10,  2.67s/it]{'epoch': 0, 'num_users': 6.2857, 'loss': 0.3519, 'hit_ratio@10': 0.6836, 'ndcg@10': 0.6031, 'compress@10': 1.0, 'time@10': 3.2717}:  70%|███████   | 7/10 [00:15<00:07,  2.40s/it]{'epoch': 0, 'num_users': 6.125, 'loss': 0.3135, 'hit_ratio@10': 0.7124, 'ndcg@10': 0.6283, 'compress@10': 1.0, 'time@10': 3.1627}:  70%|███████   | 7/10 [00:17<00:07,  2.40s/it] {'epoch': 0, 'num_users': 6.125, 'loss': 0.3135, 'hit_ratio@10': 0.7124, 'ndcg@10': 0.6283, 'compress@10': 1.0, 'time@10': 3.1627}:  80%|████████  | 8/10 [00:17<00:04,  2.41s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2838, 'hit_ratio@10': 0.7095, 'ndcg@10': 0.6599, 'compress@10': 1.0, 'time@10': 3.367}:  80%|████████  | 8/10 [00:20<00:04,  2.41s/it]{'epoch': 0, 'num_users': 6.3333, 'loss': 0.2838, 'hit_ratio@10': 0.7095, 'ndcg@10': 0.6599, 'compress@10': 1.0, 'time@10': 3.367}:  90%|█████████ | 9/10 [00:20<00:02,  2.45s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2606, 'hit_ratio@10': 0.7317, 'ndcg@10': 0.6791, 'compress@10': 1.0, 'time@10': 3.3369}:  90%|█████████ | 9/10 [00:23<00:02,  2.45s/it]  {'epoch': 0, 'num_users': 6.3, 'loss': 0.2606, 'hit_ratio@10': 0.7317, 'ndcg@10': 0.6791, 'compress@10': 1.0, 'time@10': 3.3369}: 100%|██████████| 10/10 [00:23<00:00,  2.65s/it]{'epoch': 0, 'num_users': 6.3, 'loss': 0.2606, 'hit_ratio@10': 0.7317, 'ndcg@10': 0.6791, 'compress@10': 1.0, 'time@10': 3.3369}: 100%|██████████| 10/10 [00:23<00:00,  2.35s/it]
Epoch: 0
Avg # of users: 6.3
Avg Loss: 0.26058008893389567
Avg hit ratio: 0.7317078644803602
Avg ndcg: 0.6790590827310707
Avg compression ratio: 1.0
Avg train time: 3.3369127750396728
Std train time: 1.695097820976925
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 11, 10, 9, 10, 10, 10, 10, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0513, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8444, 'compress@10': 1.0, 'time@10': 2.6323}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0513, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8444, 'compress@10': 1.0, 'time@10': 2.6323}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 1, 'num_users': 7.0, 'loss': 0.0521, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8494, 'compress@10': 1.0, 'time@10': 2.485}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it]  {'epoch': 1, 'num_users': 7.0, 'loss': 0.0521, 'hit_ratio@10': 0.798, 'ndcg@10': 0.8494, 'compress@10': 1.0, 'time@10': 2.485}:  20%|██        | 2/10 [00:03<00:15,  1.96s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0399, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8272, 'compress@10': 1.0, 'time@10': 1.9558}:  20%|██        | 2/10 [00:04<00:15,  1.96s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0399, 'hit_ratio@10': 0.7701, 'ndcg@10': 0.8272, 'compress@10': 1.0, 'time@10': 1.9558}:  30%|███       | 3/10 [00:04<00:08,  1.29s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0424, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8311, 'compress@10': 1.0, 'time@10': 1.9501}:  30%|███       | 3/10 [00:06<00:08,  1.29s/it]{'epoch': 1, 'num_users': 5.0, 'loss': 0.0424, 'hit_ratio@10': 0.8008, 'ndcg@10': 0.8311, 'compress@10': 1.0, 'time@10': 1.9501}:  40%|████      | 4/10 [00:06<00:09,  1.56s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0513, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8224, 'compress@10': 1.0, 'time@10': 2.8787}:  40%|████      | 4/10 [00:09<00:09,  1.56s/it]{'epoch': 1, 'num_users': 5.8, 'loss': 0.0513, 'hit_ratio@10': 0.8086, 'ndcg@10': 0.8224, 'compress@10': 1.0, 'time@10': 2.8787}:  50%|█████     | 5/10 [00:09<00:10,  2.20s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0555, 'hit_ratio@10': 0.7998, 'ndcg@10': 0.8209, 'compress@10': 1.0, 'time@10': 2.9442}:  50%|█████     | 5/10 [00:12<00:10,  2.20s/it]{'epoch': 1, 'num_users': 6.1667, 'loss': 0.0555, 'hit_ratio@10': 0.7998, 'ndcg@10': 0.8209, 'compress@10': 1.0, 'time@10': 2.9442}:  60%|██████    | 6/10 [00:12<00:10,  2.58s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0537, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8271, 'compress@10': 1.0, 'time@10': 3.0169}:  60%|██████    | 6/10 [00:14<00:10,  2.58s/it]{'epoch': 1, 'num_users': 6.2857, 'loss': 0.0537, 'hit_ratio@10': 0.8227, 'ndcg@10': 0.8271, 'compress@10': 1.0, 'time@10': 3.0169}:  70%|███████   | 7/10 [00:14<00:06,  2.31s/it]{'epoch': 1, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8335, 'compress@10': 1.0, 'time@10': 2.9402}:  70%|███████   | 7/10 [00:17<00:06,  2.31s/it] {'epoch': 1, 'num_users': 6.125, 'loss': 0.0517, 'hit_ratio@10': 0.8341, 'ndcg@10': 0.8335, 'compress@10': 1.0, 'time@10': 2.9402}:  80%|████████  | 8/10 [00:17<00:04,  2.35s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.8425, 'compress@10': 1.0, 'time@10': 3.1701}:  80%|████████  | 8/10 [00:19<00:04,  2.35s/it]{'epoch': 1, 'num_users': 6.3333, 'loss': 0.0499, 'hit_ratio@10': 0.8208, 'ndcg@10': 0.8425, 'compress@10': 1.0, 'time@10': 3.1701}:  90%|█████████ | 9/10 [00:19<00:02,  2.41s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8433, 'compress@10': 1.0, 'time@10': 3.162}:  90%|█████████ | 9/10 [00:22<00:02,  2.41s/it]    {'epoch': 1, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8433, 'compress@10': 1.0, 'time@10': 3.162}: 100%|██████████| 10/10 [00:22<00:00,  2.64s/it]{'epoch': 1, 'num_users': 6.3, 'loss': 0.0495, 'hit_ratio@10': 0.8319, 'ndcg@10': 0.8433, 'compress@10': 1.0, 'time@10': 3.162}: 100%|██████████| 10/10 [00:22<00:00,  2.27s/it]
Epoch: 1
Avg # of users: 6.3
Avg Loss: 0.049462470058650385
Avg hit ratio: 0.8319013320201776
Avg ndcg: 0.8433051204987981
Avg compression ratio: 1.0
Avg train time: 3.1620153188705444
Std train time: 1.5316571937883445
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 12, 10, 8, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 2.6337}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0478, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 2.6337}:  10%|█         | 1/10 [00:01<00:12,  1.35s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8496, 'compress@10': 1.0, 'time@10': 2.4204}:  10%|█         | 1/10 [00:03<00:12,  1.35s/it]{'epoch': 2, 'num_users': 7.0, 'loss': 0.0498, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8496, 'compress@10': 1.0, 'time@10': 2.4204}:  20%|██        | 2/10 [00:03<00:15,  1.88s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8521, 'compress@10': 1.0, 'time@10': 1.9517}:  20%|██        | 2/10 [00:04<00:15,  1.88s/it] {'epoch': 2, 'num_users': 5.0, 'loss': 0.034, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8521, 'compress@10': 1.0, 'time@10': 1.9517}:  30%|███       | 3/10 [00:04<00:08,  1.27s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 1.9539}:  30%|███       | 3/10 [00:06<00:08,  1.27s/it]{'epoch': 2, 'num_users': 5.0, 'loss': 0.0376, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8515, 'compress@10': 1.0, 'time@10': 1.9539}:  40%|████      | 4/10 [00:06<00:09,  1.56s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8388, 'compress@10': 1.0, 'time@10': 2.7291}:  40%|████      | 4/10 [00:09<00:09,  1.56s/it]{'epoch': 2, 'num_users': 5.8, 'loss': 0.0472, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8388, 'compress@10': 1.0, 'time@10': 2.7291}:  50%|█████     | 5/10 [00:09<00:10,  2.06s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0515, 'hit_ratio@10': 0.7813, 'ndcg@10': 0.8358, 'compress@10': 1.0, 'time@10': 2.8213}:  50%|█████     | 5/10 [00:12<00:10,  2.06s/it]{'epoch': 2, 'num_users': 6.1667, 'loss': 0.0515, 'hit_ratio@10': 0.7813, 'ndcg@10': 0.8358, 'compress@10': 1.0, 'time@10': 2.8213}:  60%|██████    | 6/10 [00:12<00:09,  2.49s/it]{'epoch': 2, 'num_users': 6.2857, 'loss': 0.0501, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 2.9172}:  60%|██████    | 6/10 [00:14<00:09,  2.49s/it] {'epoch': 2, 'num_users': 6.2857, 'loss': 0.0501, 'hit_ratio@10': 0.8069, 'ndcg@10': 0.838, 'compress@10': 1.0, 'time@10': 2.9172}:  70%|███████   | 7/10 [00:14<00:06,  2.26s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0504, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8431, 'compress@10': 1.0, 'time@10': 2.8577}:  70%|███████   | 7/10 [00:16<00:06,  2.26s/it]{'epoch': 2, 'num_users': 6.125, 'loss': 0.0504, 'hit_ratio@10': 0.8203, 'ndcg@10': 0.8431, 'compress@10': 1.0, 'time@10': 2.8577}:  80%|████████  | 8/10 [00:16<00:04,  2.33s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.818, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 3.0382}:  80%|████████  | 8/10 [00:18<00:04,  2.33s/it]{'epoch': 2, 'num_users': 6.3333, 'loss': 0.0505, 'hit_ratio@10': 0.818, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 3.0382}:  90%|█████████ | 9/10 [00:18<00:02,  2.31s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 3.0363}:  90%|█████████ | 9/10 [00:22<00:02,  2.31s/it]  {'epoch': 2, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 3.0363}: 100%|██████████| 10/10 [00:22<00:00,  2.54s/it]{'epoch': 2, 'num_users': 6.3, 'loss': 0.0499, 'hit_ratio@10': 0.8294, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 3.0363}: 100%|██████████| 10/10 [00:22<00:00,  2.20s/it]
Epoch: 2
Avg # of users: 6.3
Avg Loss: 0.04991482733828078
Avg hit ratio: 0.8294128527575048
Avg ndcg: 0.8535276728673896
Avg compression ratio: 1.0
Avg train time: 3.0362709283828737
Std train time: 1.2890122868383826
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 13, 10, 7, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 2.644}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0468, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8554, 'compress@10': 1.0, 'time@10': 2.644}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 2.3992}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it]{'epoch': 3, 'num_users': 7.0, 'loss': 0.0483, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8535, 'compress@10': 1.0, 'time@10': 2.3992}:  20%|██        | 2/10 [00:03<00:14,  1.85s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 1.9526}:  20%|██        | 2/10 [00:04<00:14,  1.85s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0326, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 1.9526}:  30%|███       | 3/10 [00:04<00:08,  1.26s/it]{'epoch': 3, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 1.935}:  30%|███       | 3/10 [00:06<00:08,  1.26s/it] {'epoch': 3, 'num_users': 5.0, 'loss': 0.0364, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 1.935}:  40%|████      | 4/10 [00:06<00:09,  1.52s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8419, 'compress@10': 1.0, 'time@10': 2.5573}:  40%|████      | 4/10 [00:08<00:09,  1.52s/it]{'epoch': 3, 'num_users': 5.8, 'loss': 0.0459, 'hit_ratio@10': 0.7825, 'ndcg@10': 0.8419, 'compress@10': 1.0, 'time@10': 2.5573}:  50%|█████     | 5/10 [00:08<00:09,  1.90s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0498, 'hit_ratio@10': 0.7854, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 2.6671}:  50%|█████     | 5/10 [00:11<00:09,  1.90s/it]{'epoch': 3, 'num_users': 6.1667, 'loss': 0.0498, 'hit_ratio@10': 0.7854, 'ndcg@10': 0.8392, 'compress@10': 1.0, 'time@10': 2.6671}:  60%|██████    | 6/10 [00:11<00:09,  2.36s/it]{'epoch': 3, 'num_users': 6.2857, 'loss': 0.0498, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.837, 'compress@10': 1.0, 'time@10': 2.7864}:  60%|██████    | 6/10 [00:13<00:09,  2.36s/it] {'epoch': 3, 'num_users': 6.2857, 'loss': 0.0498, 'hit_ratio@10': 0.8104, 'ndcg@10': 0.837, 'compress@10': 1.0, 'time@10': 2.7864}:  70%|███████   | 7/10 [00:13<00:06,  2.17s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0516, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 2.7391}:  70%|███████   | 7/10 [00:16<00:06,  2.17s/it]{'epoch': 3, 'num_users': 6.125, 'loss': 0.0516, 'hit_ratio@10': 0.8269, 'ndcg@10': 0.8481, 'compress@10': 1.0, 'time@10': 2.7391}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0513, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 2.9357}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 3, 'num_users': 6.3333, 'loss': 0.0513, 'hit_ratio@10': 0.8176, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 2.9357}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0513, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8509, 'compress@10': 1.0, 'time@10': 2.9504}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]    {'epoch': 3, 'num_users': 6.3, 'loss': 0.0513, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8509, 'compress@10': 1.0, 'time@10': 2.9504}: 100%|██████████| 10/10 [00:21<00:00,  2.53s/it]{'epoch': 3, 'num_users': 6.3, 'loss': 0.0513, 'hit_ratio@10': 0.829, 'ndcg@10': 0.8509, 'compress@10': 1.0, 'time@10': 2.9504}: 100%|██████████| 10/10 [00:21<00:00,  2.15s/it]
Epoch: 3
Avg # of users: 6.3
Avg Loss: 0.05132683443482722
Avg hit ratio: 0.8290001543448063
Avg ndcg: 0.850882718725348
Avg compression ratio: 1.0
Avg train time: 2.950405240058899
Std train time: 1.1381204937097247
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 14, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8563, 'compress@10': 1.0, 'time@10': 2.5877}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0472, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8563, 'compress@10': 1.0, 'time@10': 2.5877}:  10%|█         | 1/10 [00:01<00:11,  1.33s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 2.3583}:  10%|█         | 1/10 [00:03<00:11,  1.33s/it]{'epoch': 4, 'num_users': 7.0, 'loss': 0.0477, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 2.3583}:  20%|██        | 2/10 [00:03<00:14,  1.82s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 1.9676}:  20%|██        | 2/10 [00:04<00:14,  1.82s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0321, 'hit_ratio@10': 0.7332, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 1.9676}:  30%|███       | 3/10 [00:04<00:08,  1.28s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0354, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 1.9575}:  30%|███       | 3/10 [00:06<00:08,  1.28s/it]{'epoch': 4, 'num_users': 5.0, 'loss': 0.0354, 'hit_ratio@10': 0.7731, 'ndcg@10': 0.8567, 'compress@10': 1.0, 'time@10': 1.9575}:  40%|████      | 4/10 [00:06<00:09,  1.55s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8425, 'compress@10': 1.0, 'time@10': 2.4371}:  40%|████      | 4/10 [00:08<00:09,  1.55s/it]{'epoch': 4, 'num_users': 5.8, 'loss': 0.0452, 'hit_ratio@10': 0.7865, 'ndcg@10': 0.8425, 'compress@10': 1.0, 'time@10': 2.4371}:  50%|█████     | 5/10 [00:08<00:08,  1.79s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.7962, 'ndcg@10': 0.8404, 'compress@10': 1.0, 'time@10': 2.5654}:  50%|█████     | 5/10 [00:11<00:08,  1.79s/it]{'epoch': 4, 'num_users': 6.1667, 'loss': 0.0484, 'hit_ratio@10': 0.7962, 'ndcg@10': 0.8404, 'compress@10': 1.0, 'time@10': 2.5654}:  60%|██████    | 6/10 [00:11<00:09,  2.28s/it]{'epoch': 4, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.8415, 'compress@10': 1.0, 'time@10': 2.699}:  60%|██████    | 6/10 [00:13<00:09,  2.28s/it] {'epoch': 4, 'num_users': 6.2857, 'loss': 0.0483, 'hit_ratio@10': 0.8196, 'ndcg@10': 0.8415, 'compress@10': 1.0, 'time@10': 2.699}:  70%|███████   | 7/10 [00:13<00:06,  2.12s/it]{'epoch': 4, 'num_users': 6.125, 'loss': 0.0503, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8525, 'compress@10': 1.0, 'time@10': 2.6743}:  70%|███████   | 7/10 [00:15<00:06,  2.12s/it] {'epoch': 4, 'num_users': 6.125, 'loss': 0.0503, 'hit_ratio@10': 0.835, 'ndcg@10': 0.8525, 'compress@10': 1.0, 'time@10': 2.6743}:  80%|████████  | 8/10 [00:15<00:04,  2.25s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0519, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8687, 'compress@10': 1.0, 'time@10': 2.8645}:  80%|████████  | 8/10 [00:18<00:04,  2.25s/it]{'epoch': 4, 'num_users': 6.3333, 'loss': 0.0519, 'hit_ratio@10': 0.8247, 'ndcg@10': 0.8687, 'compress@10': 1.0, 'time@10': 2.8645}:  90%|█████████ | 9/10 [00:18<00:02,  2.25s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 2.8856}:  90%|█████████ | 9/10 [00:21<00:02,  2.25s/it]   {'epoch': 4, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 2.8856}: 100%|██████████| 10/10 [00:21<00:00,  2.51s/it]{'epoch': 4, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8354, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 2.8856}: 100%|██████████| 10/10 [00:21<00:00,  2.12s/it]
Epoch: 4
Avg # of users: 6.3
Avg Loss: 0.051069709856793745
Avg hit ratio: 0.8354445987892507
Avg ndcg: 0.8665531913529836
Avg compression ratio: 1.0
Avg train time: 2.8856173276901247
Std train time: 0.9769806253477908
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 15, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 2.638}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8573, 'compress@10': 1.0, 'time@10': 2.638}:  10%|█         | 1/10 [00:01<00:12,  1.35s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 2.4015}:  10%|█         | 1/10 [00:03<00:12,  1.35s/it]{'epoch': 5, 'num_users': 7.0, 'loss': 0.0467, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 2.4015}:  20%|██        | 2/10 [00:03<00:14,  1.85s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8564, 'compress@10': 1.0, 'time@10': 2.0091}:  20%|██        | 2/10 [00:04<00:14,  1.85s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.7916, 'ndcg@10': 0.8564, 'compress@10': 1.0, 'time@10': 2.0091}:  30%|███       | 3/10 [00:04<00:09,  1.30s/it]{'epoch': 5, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 2.0255}:  30%|███       | 3/10 [00:06<00:09,  1.30s/it] {'epoch': 5, 'num_users': 5.0, 'loss': 0.0351, 'hit_ratio@10': 0.8169, 'ndcg@10': 0.856, 'compress@10': 1.0, 'time@10': 2.0255}:  40%|████      | 4/10 [00:06<00:09,  1.62s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0444, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8419, 'compress@10': 1.0, 'time@10': 2.5715}:  40%|████      | 4/10 [00:08<00:09,  1.62s/it]{'epoch': 5, 'num_users': 5.8, 'loss': 0.0444, 'hit_ratio@10': 0.8215, 'ndcg@10': 0.8419, 'compress@10': 1.0, 'time@10': 2.5715}:  50%|█████     | 5/10 [00:08<00:09,  1.91s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0471, 'hit_ratio@10': 0.8253, 'ndcg@10': 0.8414, 'compress@10': 1.0, 'time@10': 2.7274}:  50%|█████     | 5/10 [00:12<00:09,  1.91s/it]{'epoch': 5, 'num_users': 6.1667, 'loss': 0.0471, 'hit_ratio@10': 0.8253, 'ndcg@10': 0.8414, 'compress@10': 1.0, 'time@10': 2.7274}:  60%|██████    | 6/10 [00:12<00:09,  2.46s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0461, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8433, 'compress@10': 1.0, 'time@10': 2.8517}:  60%|██████    | 6/10 [00:14<00:09,  2.46s/it]{'epoch': 5, 'num_users': 6.2857, 'loss': 0.0461, 'hit_ratio@10': 0.8446, 'ndcg@10': 0.8433, 'compress@10': 1.0, 'time@10': 2.8517}:  70%|███████   | 7/10 [00:14<00:06,  2.26s/it]{'epoch': 5, 'num_users': 6.125, 'loss': 0.0478, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 2.7984}:  70%|███████   | 7/10 [00:16<00:06,  2.26s/it] {'epoch': 5, 'num_users': 6.125, 'loss': 0.0478, 'hit_ratio@10': 0.8569, 'ndcg@10': 0.8543, 'compress@10': 1.0, 'time@10': 2.7984}:  80%|████████  | 8/10 [00:16<00:04,  2.32s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0507, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8615, 'compress@10': 1.0, 'time@10': 2.9886}:  80%|████████  | 8/10 [00:18<00:04,  2.32s/it]{'epoch': 5, 'num_users': 6.3333, 'loss': 0.0507, 'hit_ratio@10': 0.8474, 'ndcg@10': 0.8615, 'compress@10': 1.0, 'time@10': 2.9886}:  90%|█████████ | 9/10 [00:18<00:02,  2.31s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8592, 'compress@10': 1.0, 'time@10': 3.001}:  90%|█████████ | 9/10 [00:22<00:02,  2.31s/it]    {'epoch': 5, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8592, 'compress@10': 1.0, 'time@10': 3.001}: 100%|██████████| 10/10 [00:22<00:00,  2.57s/it]{'epoch': 5, 'num_users': 6.3, 'loss': 0.0504, 'hit_ratio@10': 0.8558, 'ndcg@10': 0.8592, 'compress@10': 1.0, 'time@10': 3.001}: 100%|██████████| 10/10 [00:22<00:00,  2.20s/it]
Epoch: 5
Avg # of users: 6.3
Avg Loss: 0.05040271067037975
Avg hit ratio: 0.8558132623837208
Avg ndcg: 0.8592422019563308
Avg compression ratio: 1.0
Avg train time: 3.0009633779525755
Std train time: 1.0562546213207422
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 16, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 1.0, 'time@10': 2.6387}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0455, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.861, 'compress@10': 1.0, 'time@10': 2.6387}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 2.4003}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it]{'epoch': 6, 'num_users': 7.0, 'loss': 0.0445, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8617, 'compress@10': 1.0, 'time@10': 2.4003}:  20%|██        | 2/10 [00:03<00:14,  1.85s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 2.0353}:  20%|██        | 2/10 [00:04<00:14,  1.85s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0298, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8602, 'compress@10': 1.0, 'time@10': 2.0353}:  30%|███       | 3/10 [00:04<00:09,  1.32s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8674, 'compress@10': 1.0, 'time@10': 2.0084}:  30%|███       | 3/10 [00:06<00:09,  1.32s/it]{'epoch': 6, 'num_users': 5.0, 'loss': 0.0363, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8674, 'compress@10': 1.0, 'time@10': 2.0084}:  40%|████      | 4/10 [00:06<00:09,  1.57s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0449, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 2.4703}:  40%|████      | 4/10 [00:08<00:09,  1.57s/it]{'epoch': 6, 'num_users': 5.8, 'loss': 0.0449, 'hit_ratio@10': 0.8468, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 2.4703}:  50%|█████     | 5/10 [00:08<00:08,  1.80s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0465, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 2.5968}:  50%|█████     | 5/10 [00:11<00:08,  1.80s/it]{'epoch': 6, 'num_users': 6.1667, 'loss': 0.0465, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8503, 'compress@10': 1.0, 'time@10': 2.5968}:  60%|██████    | 6/10 [00:11<00:09,  2.30s/it]{'epoch': 6, 'num_users': 6.2857, 'loss': 0.046, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 2.7121}:  60%|██████    | 6/10 [00:13<00:09,  2.30s/it] {'epoch': 6, 'num_users': 6.2857, 'loss': 0.046, 'hit_ratio@10': 0.8658, 'ndcg@10': 0.8532, 'compress@10': 1.0, 'time@10': 2.7121}:  70%|███████   | 7/10 [00:13<00:06,  2.11s/it]{'epoch': 6, 'num_users': 6.125, 'loss': 0.047, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 2.6799}:  70%|███████   | 7/10 [00:15<00:06,  2.11s/it] {'epoch': 6, 'num_users': 6.125, 'loss': 0.047, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 2.6799}:  80%|████████  | 8/10 [00:15<00:04,  2.23s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0501, 'hit_ratio@10': 0.867, 'ndcg@10': 0.885, 'compress@10': 1.0, 'time@10': 2.8824}:  80%|████████  | 8/10 [00:18<00:04,  2.23s/it]{'epoch': 6, 'num_users': 6.3333, 'loss': 0.0501, 'hit_ratio@10': 0.867, 'ndcg@10': 0.885, 'compress@10': 1.0, 'time@10': 2.8824}:  90%|█████████ | 9/10 [00:18<00:02,  2.25s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.882, 'compress@10': 1.0, 'time@10': 2.9069}:  90%|█████████ | 9/10 [00:21<00:02,  2.25s/it]  {'epoch': 6, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.882, 'compress@10': 1.0, 'time@10': 2.9069}: 100%|██████████| 10/10 [00:21<00:00,  2.53s/it]{'epoch': 6, 'num_users': 6.3, 'loss': 0.0487, 'hit_ratio@10': 0.8735, 'ndcg@10': 0.882, 'compress@10': 1.0, 'time@10': 2.9069}: 100%|██████████| 10/10 [00:21<00:00,  2.14s/it]
Epoch: 6
Avg # of users: 6.3
Avg Loss: 0.04867912074452534
Avg hit ratio: 0.8735239638686159
Avg ndcg: 0.8820407159143333
Avg compression ratio: 1.0
Avg train time: 2.9068650245666503
Std train time: 0.9638934847775118
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 17, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8487, 'compress@10': 1.0, 'time@10': 2.6712}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0488, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8487, 'compress@10': 1.0, 'time@10': 2.6712}:  10%|█         | 1/10 [00:01<00:12,  1.37s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 2.4575}:  10%|█         | 1/10 [00:03<00:12,  1.37s/it]{'epoch': 7, 'num_users': 7.0, 'loss': 0.0444, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8547, 'compress@10': 1.0, 'time@10': 2.4575}:  20%|██        | 2/10 [00:03<00:15,  1.91s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8555, 'compress@10': 1.0, 'time@10': 2.116}:  20%|██        | 2/10 [00:04<00:15,  1.91s/it] {'epoch': 7, 'num_users': 5.0, 'loss': 0.0297, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.8555, 'compress@10': 1.0, 'time@10': 2.116}:  30%|███       | 3/10 [00:04<00:09,  1.38s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0402, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 2.0652}:  30%|███       | 3/10 [00:06<00:09,  1.38s/it]{'epoch': 7, 'num_users': 5.0, 'loss': 0.0402, 'hit_ratio@10': 0.8526, 'ndcg@10': 0.8719, 'compress@10': 1.0, 'time@10': 2.0652}:  40%|████      | 4/10 [00:06<00:09,  1.60s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 2.5327}:  40%|████      | 4/10 [00:08<00:09,  1.60s/it]{'epoch': 7, 'num_users': 5.8, 'loss': 0.0474, 'hit_ratio@10': 0.8501, 'ndcg@10': 0.8558, 'compress@10': 1.0, 'time@10': 2.5327}:  50%|█████     | 5/10 [00:08<00:09,  1.83s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0481, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 2.6423}:  50%|█████     | 5/10 [00:11<00:09,  1.83s/it]{'epoch': 7, 'num_users': 6.1667, 'loss': 0.0481, 'hit_ratio@10': 0.8566, 'ndcg@10': 0.855, 'compress@10': 1.0, 'time@10': 2.6423}:  60%|██████    | 6/10 [00:11<00:09,  2.31s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0475, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 2.7728}:  60%|██████    | 6/10 [00:13<00:09,  2.31s/it]{'epoch': 7, 'num_users': 6.2857, 'loss': 0.0475, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.852, 'compress@10': 1.0, 'time@10': 2.7728}:  70%|███████   | 7/10 [00:13<00:06,  2.15s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0479, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 2.7258}:  70%|███████   | 7/10 [00:16<00:06,  2.15s/it]{'epoch': 7, 'num_users': 6.125, 'loss': 0.0479, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.8624, 'compress@10': 1.0, 'time@10': 2.7258}:  80%|████████  | 8/10 [00:16<00:04,  2.24s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0512, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8729, 'compress@10': 1.0, 'time@10': 2.9309}:  80%|████████  | 8/10 [00:18<00:04,  2.24s/it]{'epoch': 7, 'num_users': 6.3333, 'loss': 0.0512, 'hit_ratio@10': 0.8555, 'ndcg@10': 0.8729, 'compress@10': 1.0, 'time@10': 2.9309}:  90%|█████████ | 9/10 [00:18<00:02,  2.26s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 2.9454}:  90%|█████████ | 9/10 [00:21<00:02,  2.26s/it]   {'epoch': 7, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 2.9454}: 100%|██████████| 10/10 [00:21<00:00,  2.53s/it]{'epoch': 7, 'num_users': 6.3, 'loss': 0.0511, 'hit_ratio@10': 0.8654, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 2.9454}: 100%|██████████| 10/10 [00:21<00:00,  2.15s/it]
Epoch: 7
Avg # of users: 6.3
Avg Loss: 0.05109182593952426
Avg hit ratio: 0.8653875769580353
Avg ndcg: 0.8743503419542753
Avg compression ratio: 1.0
Avg train time: 2.9454448223114014
Std train time: 0.9715333050991833
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 18, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8598, 'compress@10': 1.0, 'time@10': 2.6495}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0427, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8598, 'compress@10': 1.0, 'time@10': 2.6495}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 2.4059}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it]{'epoch': 8, 'num_users': 7.0, 'loss': 0.0422, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8594, 'compress@10': 1.0, 'time@10': 2.4059}:  20%|██        | 2/10 [00:03<00:14,  1.85s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8586, 'compress@10': 1.0, 'time@10': 2.088}:  20%|██        | 2/10 [00:04<00:14,  1.85s/it] {'epoch': 8, 'num_users': 5.0, 'loss': 0.0282, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8586, 'compress@10': 1.0, 'time@10': 2.088}:  30%|███       | 3/10 [00:04<00:09,  1.36s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0365, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8324, 'compress@10': 1.0, 'time@10': 2.0763}:  30%|███       | 3/10 [00:06<00:09,  1.36s/it]{'epoch': 8, 'num_users': 5.0, 'loss': 0.0365, 'hit_ratio@10': 0.8088, 'ndcg@10': 0.8324, 'compress@10': 1.0, 'time@10': 2.0763}:  40%|████      | 4/10 [00:06<00:09,  1.64s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0438, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8252, 'compress@10': 1.0, 'time@10': 2.5539}:  40%|████      | 4/10 [00:08<00:09,  1.64s/it]{'epoch': 8, 'num_users': 5.8, 'loss': 0.0438, 'hit_ratio@10': 0.8151, 'ndcg@10': 0.8252, 'compress@10': 1.0, 'time@10': 2.5539}:  50%|█████     | 5/10 [00:08<00:09,  1.87s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0444, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8292, 'compress@10': 1.0, 'time@10': 2.6646}:  50%|█████     | 5/10 [00:11<00:09,  1.87s/it]{'epoch': 8, 'num_users': 6.1667, 'loss': 0.0444, 'hit_ratio@10': 0.8274, 'ndcg@10': 0.8292, 'compress@10': 1.0, 'time@10': 2.6646}:  60%|██████    | 6/10 [00:11<00:09,  2.34s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0457, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8391, 'compress@10': 1.0, 'time@10': 2.7871}:  60%|██████    | 6/10 [00:13<00:09,  2.34s/it]{'epoch': 8, 'num_users': 6.2857, 'loss': 0.0457, 'hit_ratio@10': 0.8463, 'ndcg@10': 0.8391, 'compress@10': 1.0, 'time@10': 2.7871}:  70%|███████   | 7/10 [00:13<00:06,  2.16s/it]{'epoch': 8, 'num_users': 6.125, 'loss': 0.046, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8499, 'compress@10': 1.0, 'time@10': 2.7375}:  70%|███████   | 7/10 [00:16<00:06,  2.16s/it]  {'epoch': 8, 'num_users': 6.125, 'loss': 0.046, 'hit_ratio@10': 0.8584, 'ndcg@10': 0.8499, 'compress@10': 1.0, 'time@10': 2.7375}:  80%|████████  | 8/10 [00:16<00:04,  2.25s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 2.9296}:  80%|████████  | 8/10 [00:18<00:04,  2.25s/it]{'epoch': 8, 'num_users': 6.3333, 'loss': 0.05, 'hit_ratio@10': 0.8455, 'ndcg@10': 0.8599, 'compress@10': 1.0, 'time@10': 2.9296}:  90%|█████████ | 9/10 [00:18<00:02,  2.25s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0484, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8618, 'compress@10': 1.0, 'time@10': 2.9494}:  90%|█████████ | 9/10 [00:21<00:02,  2.25s/it] {'epoch': 8, 'num_users': 6.3, 'loss': 0.0484, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8618, 'compress@10': 1.0, 'time@10': 2.9494}: 100%|██████████| 10/10 [00:21<00:00,  2.53s/it]{'epoch': 8, 'num_users': 6.3, 'loss': 0.0484, 'hit_ratio@10': 0.8564, 'ndcg@10': 0.8618, 'compress@10': 1.0, 'time@10': 2.9494}: 100%|██████████| 10/10 [00:21<00:00,  2.16s/it]
Epoch: 8
Avg # of users: 6.3
Avg Loss: 0.04841888252933976
Avg hit ratio: 0.8564474847921367
Avg ndcg: 0.8618163601961338
Avg compression ratio: 1.0
Avg train time: 2.9493959665298464
Std train time: 0.9547190418443715
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 19, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8431, 'compress@10': 1.0, 'time@10': 2.7494}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0447, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8431, 'compress@10': 1.0, 'time@10': 2.7494}:  10%|█         | 1/10 [00:01<00:12,  1.41s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 2.4888}:  10%|█         | 1/10 [00:03<00:12,  1.41s/it]{'epoch': 9, 'num_users': 7.0, 'loss': 0.0419, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8518, 'compress@10': 1.0, 'time@10': 2.4888}:  20%|██        | 2/10 [00:03<00:15,  1.91s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 2.1725}:  20%|██        | 2/10 [00:04<00:15,  1.91s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0279, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8536, 'compress@10': 1.0, 'time@10': 2.1725}:  30%|███       | 3/10 [00:04<00:09,  1.41s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8504, 'compress@10': 1.0, 'time@10': 2.1225}:  30%|███       | 3/10 [00:06<00:09,  1.41s/it]{'epoch': 9, 'num_users': 5.0, 'loss': 0.0314, 'hit_ratio@10': 0.8178, 'ndcg@10': 0.8504, 'compress@10': 1.0, 'time@10': 2.1225}:  40%|████      | 4/10 [00:06<00:09,  1.65s/it]{'epoch': 9, 'num_users': 5.8, 'loss': 0.0391, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.84, 'compress@10': 1.0, 'time@10': 2.5569}:  40%|████      | 4/10 [00:08<00:09,  1.65s/it]  {'epoch': 9, 'num_users': 5.8, 'loss': 0.0391, 'hit_ratio@10': 0.8262, 'ndcg@10': 0.84, 'compress@10': 1.0, 'time@10': 2.5569}:  50%|█████     | 5/10 [00:08<00:09,  1.84s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0395, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 2.7041}:  50%|█████     | 5/10 [00:12<00:09,  1.84s/it]{'epoch': 9, 'num_users': 6.1667, 'loss': 0.0395, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8432, 'compress@10': 1.0, 'time@10': 2.7041}:  60%|██████    | 6/10 [00:12<00:09,  2.40s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0401, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8403, 'compress@10': 1.0, 'time@10': 2.8527}:  60%|██████    | 6/10 [00:14<00:09,  2.40s/it]{'epoch': 9, 'num_users': 6.2857, 'loss': 0.0401, 'hit_ratio@10': 0.8575, 'ndcg@10': 0.8403, 'compress@10': 1.0, 'time@10': 2.8527}:  70%|███████   | 7/10 [00:14<00:06,  2.24s/it]{'epoch': 9, 'num_users': 6.125, 'loss': 0.0407, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8466, 'compress@10': 1.0, 'time@10': 2.7998}:  70%|███████   | 7/10 [00:16<00:06,  2.24s/it] {'epoch': 9, 'num_users': 6.125, 'loss': 0.0407, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.8466, 'compress@10': 1.0, 'time@10': 2.7998}:  80%|████████  | 8/10 [00:16<00:04,  2.32s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0415, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8614, 'compress@10': 1.0, 'time@10': 2.9918}:  80%|████████  | 8/10 [00:18<00:04,  2.32s/it]{'epoch': 9, 'num_users': 6.3333, 'loss': 0.0415, 'hit_ratio@10': 0.8574, 'ndcg@10': 0.8614, 'compress@10': 1.0, 'time@10': 2.9918}:  90%|█████████ | 9/10 [00:18<00:02,  2.31s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0406, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 2.9982}:  90%|█████████ | 9/10 [00:21<00:02,  2.31s/it]   {'epoch': 9, 'num_users': 6.3, 'loss': 0.0406, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 2.9982}: 100%|██████████| 10/10 [00:21<00:00,  2.55s/it]{'epoch': 9, 'num_users': 6.3, 'loss': 0.0406, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.8652, 'compress@10': 1.0, 'time@10': 2.9982}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 9
Avg # of users: 6.3
Avg Loss: 0.04061431800540931
Avg hit ratio: 0.8670982784429304
Avg ndcg: 0.8651765226886206
Avg compression ratio: 1.0
Avg train time: 2.998185873031616
Std train time: 0.9451544262633174
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 20, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.7105}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0409, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8583, 'compress@10': 1.0, 'time@10': 2.7105}:  10%|█         | 1/10 [00:01<00:12,  1.39s/it]{'epoch': 10, 'num_users': 7.0, 'loss': 0.0397, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.4759}:  10%|█         | 1/10 [00:03<00:12,  1.39s/it] {'epoch': 10, 'num_users': 7.0, 'loss': 0.0397, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.862, 'compress@10': 1.0, 'time@10': 2.4759}:  20%|██        | 2/10 [00:03<00:15,  1.93s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0265, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 2.2058}:  20%|██        | 2/10 [00:04<00:15,  1.93s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0265, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8604, 'compress@10': 1.0, 'time@10': 2.2058}:  30%|███       | 3/10 [00:04<00:10,  1.44s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0289, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 2.1441}:  30%|███       | 3/10 [00:06<00:10,  1.44s/it]{'epoch': 10, 'num_users': 5.0, 'loss': 0.0289, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8621, 'compress@10': 1.0, 'time@10': 2.1441}:  40%|████      | 4/10 [00:06<00:09,  1.66s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0366, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8499, 'compress@10': 1.0, 'time@10': 2.6114}:  40%|████      | 4/10 [00:08<00:09,  1.66s/it]{'epoch': 10, 'num_users': 5.8, 'loss': 0.0366, 'hit_ratio@10': 0.8548, 'ndcg@10': 0.8499, 'compress@10': 1.0, 'time@10': 2.6114}:  50%|█████     | 5/10 [00:08<00:09,  1.88s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.038, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 2.7141}:  50%|█████     | 5/10 [00:12<00:09,  1.88s/it]{'epoch': 10, 'num_users': 6.1667, 'loss': 0.038, 'hit_ratio@10': 0.8642, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 2.7141}:  60%|██████    | 6/10 [00:12<00:09,  2.35s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0388, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8587, 'compress@10': 1.0, 'time@10': 2.8162}:  60%|██████    | 6/10 [00:13<00:09,  2.35s/it]{'epoch': 10, 'num_users': 6.2857, 'loss': 0.0388, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.8587, 'compress@10': 1.0, 'time@10': 2.8162}:  70%|███████   | 7/10 [00:13<00:06,  2.16s/it]{'epoch': 10, 'num_users': 6.125, 'loss': 0.0389, 'hit_ratio@10': 0.886, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 2.7715}:  70%|███████   | 7/10 [00:16<00:06,  2.16s/it]    {'epoch': 10, 'num_users': 6.125, 'loss': 0.0389, 'hit_ratio@10': 0.886, 'ndcg@10': 0.86, 'compress@10': 1.0, 'time@10': 2.7715}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0408, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8694, 'compress@10': 1.0, 'time@10': 2.9572}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 10, 'num_users': 6.3333, 'loss': 0.0408, 'hit_ratio@10': 0.8733, 'ndcg@10': 0.8694, 'compress@10': 1.0, 'time@10': 2.9572}:  90%|█████████ | 9/10 [00:18<00:02,  2.26s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8695, 'compress@10': 1.0, 'time@10': 2.9675}:  90%|█████████ | 9/10 [00:21<00:02,  2.26s/it]   {'epoch': 10, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8695, 'compress@10': 1.0, 'time@10': 2.9675}: 100%|██████████| 10/10 [00:21<00:00,  2.52s/it]{'epoch': 10, 'num_users': 6.3, 'loss': 0.0402, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.8695, 'compress@10': 1.0, 'time@10': 2.9675}: 100%|██████████| 10/10 [00:21<00:00,  2.17s/it]
Epoch: 10
Avg # of users: 6.3
Avg Loss: 0.040214864321281754
Avg hit ratio: 0.8813839927286446
Avg ndcg: 0.8694719455164707
Avg compression ratio: 1.0
Avg train time: 2.967529296875
Std train time: 0.9121810350897452
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8442, 'compress@10': 1.0, 'time@10': 2.74}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0461, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8442, 'compress@10': 1.0, 'time@10': 2.74}:  10%|█         | 1/10 [00:01<00:12,  1.40s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 2.4791}:  10%|█         | 1/10 [00:03<00:12,  1.40s/it]{'epoch': 11, 'num_users': 7.0, 'loss': 0.0403, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 2.4791}:  20%|██        | 2/10 [00:03<00:15,  1.91s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8603, 'compress@10': 1.0, 'time@10': 2.2312}:  20%|██        | 2/10 [00:04<00:15,  1.91s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0269, 'hit_ratio@10': 0.7984, 'ndcg@10': 0.8603, 'compress@10': 1.0, 'time@10': 2.2312}:  30%|███       | 3/10 [00:04<00:10,  1.45s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8634, 'compress@10': 1.0, 'time@10': 2.1509}:  30%|███       | 3/10 [00:06<00:10,  1.45s/it]{'epoch': 11, 'num_users': 5.0, 'loss': 0.0313, 'hit_ratio@10': 0.8309, 'ndcg@10': 0.8634, 'compress@10': 1.0, 'time@10': 2.1509}:  40%|████      | 4/10 [00:06<00:09,  1.64s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 2.5906}:  40%|████      | 4/10 [00:08<00:09,  1.64s/it]{'epoch': 11, 'num_users': 5.8, 'loss': 0.0379, 'hit_ratio@10': 0.8407, 'ndcg@10': 0.8514, 'compress@10': 1.0, 'time@10': 2.5906}:  50%|█████     | 5/10 [00:08<00:09,  1.85s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0395, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 2.6929}:  50%|█████     | 5/10 [00:12<00:09,  1.85s/it]{'epoch': 11, 'num_users': 6.1667, 'loss': 0.0395, 'hit_ratio@10': 0.8525, 'ndcg@10': 0.8531, 'compress@10': 1.0, 'time@10': 2.6929}:  60%|██████    | 6/10 [00:12<00:10,  2.54s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8526, 'compress@10': 1.0, 'time@10': 2.8038}:  60%|██████    | 6/10 [00:14<00:10,  2.54s/it]{'epoch': 11, 'num_users': 6.2857, 'loss': 0.0386, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.8526, 'compress@10': 1.0, 'time@10': 2.8038}:  70%|███████   | 7/10 [00:14<00:06,  2.29s/it]{'epoch': 11, 'num_users': 6.125, 'loss': 0.0375, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8563, 'compress@10': 1.0, 'time@10': 2.7572}:  70%|███████   | 7/10 [00:16<00:06,  2.29s/it] {'epoch': 11, 'num_users': 6.125, 'loss': 0.0375, 'hit_ratio@10': 0.8772, 'ndcg@10': 0.8563, 'compress@10': 1.0, 'time@10': 2.7572}:  80%|████████  | 8/10 [00:16<00:04,  2.35s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0371, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 2.9543}:  80%|████████  | 8/10 [00:19<00:04,  2.35s/it]{'epoch': 11, 'num_users': 6.3333, 'loss': 0.0371, 'hit_ratio@10': 0.8623, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 2.9543}:  90%|█████████ | 9/10 [00:19<00:02,  2.34s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0361, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 2.9698}:  90%|█████████ | 9/10 [00:22<00:02,  2.34s/it]     {'epoch': 11, 'num_users': 6.3, 'loss': 0.0361, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 2.9698}: 100%|██████████| 10/10 [00:22<00:00,  2.59s/it]{'epoch': 11, 'num_users': 6.3, 'loss': 0.0361, 'hit_ratio@10': 0.8715, 'ndcg@10': 0.87, 'compress@10': 1.0, 'time@10': 2.9698}: 100%|██████████| 10/10 [00:22<00:00,  2.23s/it]
Epoch: 11
Avg # of users: 6.3
Avg Loss: 0.03614092918908014
Avg hit ratio: 0.8715042934805244
Avg ndcg: 0.8700391216728052
Avg compression ratio: 1.0
Avg train time: 2.969820237159729
Std train time: 0.9067357022956233
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8462, 'compress@10': 1.0, 'time@10': 2.6535}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0408, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8462, 'compress@10': 1.0, 'time@10': 2.6535}:  10%|█         | 1/10 [00:01<00:12,  1.37s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 2.4208}:  10%|█         | 1/10 [00:03<00:12,  1.37s/it]{'epoch': 12, 'num_users': 7.0, 'loss': 0.0363, 'hit_ratio@10': 0.8404, 'ndcg@10': 0.8643, 'compress@10': 1.0, 'time@10': 2.4208}:  20%|██        | 2/10 [00:03<00:14,  1.87s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 2.1972}:  20%|██        | 2/10 [00:04<00:14,  1.87s/it] {'epoch': 12, 'num_users': 5.0, 'loss': 0.0242, 'hit_ratio@10': 0.846, 'ndcg@10': 0.8619, 'compress@10': 1.0, 'time@10': 2.1972}:  30%|███       | 3/10 [00:04<00:10,  1.44s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 2.1337}:  30%|███       | 3/10 [00:06<00:10,  1.44s/it]{'epoch': 12, 'num_users': 5.0, 'loss': 0.0318, 'hit_ratio@10': 0.8577, 'ndcg@10': 0.8533, 'compress@10': 1.0, 'time@10': 2.1337}:  40%|████      | 4/10 [00:06<00:09,  1.65s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8447, 'compress@10': 1.0, 'time@10': 2.5769}:  40%|████      | 4/10 [00:08<00:09,  1.65s/it]{'epoch': 12, 'num_users': 5.8, 'loss': 0.0377, 'hit_ratio@10': 0.8662, 'ndcg@10': 0.8447, 'compress@10': 1.0, 'time@10': 2.5769}:  50%|█████     | 5/10 [00:08<00:09,  1.86s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0371, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8496, 'compress@10': 1.0, 'time@10': 2.6865}:  50%|█████     | 5/10 [00:11<00:09,  1.86s/it]{'epoch': 12, 'num_users': 6.1667, 'loss': 0.0371, 'hit_ratio@10': 0.8774, 'ndcg@10': 0.8496, 'compress@10': 1.0, 'time@10': 2.6865}:  60%|██████    | 6/10 [00:11<00:09,  2.34s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0369, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 2.8157}:  60%|██████    | 6/10 [00:13<00:09,  2.34s/it]{'epoch': 12, 'num_users': 6.2857, 'loss': 0.0369, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.8577, 'compress@10': 1.0, 'time@10': 2.8157}:  70%|███████   | 7/10 [00:13<00:06,  2.17s/it]{'epoch': 12, 'num_users': 6.125, 'loss': 0.0348, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 2.767}:  70%|███████   | 7/10 [00:16<00:06,  2.17s/it]  {'epoch': 12, 'num_users': 6.125, 'loss': 0.0348, 'hit_ratio@10': 0.8959, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 2.767}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.036, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8845, 'compress@10': 1.0, 'time@10': 2.9624}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it]{'epoch': 12, 'num_users': 6.3333, 'loss': 0.036, 'hit_ratio@10': 0.8789, 'ndcg@10': 0.8845, 'compress@10': 1.0, 'time@10': 2.9624}:  90%|█████████ | 9/10 [00:18<00:02,  2.28s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8844, 'compress@10': 1.0, 'time@10': 2.9772}:  90%|█████████ | 9/10 [00:21<00:02,  2.28s/it]  {'epoch': 12, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8844, 'compress@10': 1.0, 'time@10': 2.9772}: 100%|██████████| 10/10 [00:21<00:00,  2.54s/it]{'epoch': 12, 'num_users': 6.3, 'loss': 0.0358, 'hit_ratio@10': 0.8864, 'ndcg@10': 0.8844, 'compress@10': 1.0, 'time@10': 2.9772}: 100%|██████████| 10/10 [00:21<00:00,  2.17s/it]
Epoch: 12
Avg # of users: 6.3
Avg Loss: 0.03584573303391071
Avg hit ratio: 0.8864408014170323
Avg ndcg: 0.8844058256768476
Avg compression ratio: 1.0
Avg train time: 2.977185535430908
Std train time: 0.9137733881681002
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 2.5795}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0381, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.858, 'compress@10': 1.0, 'time@10': 2.5795}:  10%|█         | 1/10 [00:01<00:11,  1.32s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0342, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 2.3975}:  10%|█         | 1/10 [00:03<00:11,  1.32s/it]{'epoch': 13, 'num_users': 7.0, 'loss': 0.0342, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8745, 'compress@10': 1.0, 'time@10': 2.3975}:  20%|██        | 2/10 [00:03<00:14,  1.87s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8687, 'compress@10': 1.0, 'time@10': 2.1699}:  20%|██        | 2/10 [00:04<00:14,  1.87s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0228, 'hit_ratio@10': 0.8284, 'ndcg@10': 0.8687, 'compress@10': 1.0, 'time@10': 2.1699}:  30%|███       | 3/10 [00:04<00:09,  1.43s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8665, 'compress@10': 1.0, 'time@10': 2.1152}:  30%|███       | 3/10 [00:06<00:09,  1.43s/it]{'epoch': 13, 'num_users': 5.0, 'loss': 0.0271, 'hit_ratio@10': 0.8535, 'ndcg@10': 0.8665, 'compress@10': 1.0, 'time@10': 2.1152}:  40%|████      | 4/10 [00:06<00:09,  1.65s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0332, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8566, 'compress@10': 1.0, 'time@10': 2.5713}:  40%|████      | 4/10 [00:08<00:09,  1.65s/it]{'epoch': 13, 'num_users': 5.8, 'loss': 0.0332, 'hit_ratio@10': 0.8628, 'ndcg@10': 0.8566, 'compress@10': 1.0, 'time@10': 2.5713}:  50%|█████     | 5/10 [00:08<00:09,  1.86s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.033, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 2.6891}:  50%|█████     | 5/10 [00:12<00:09,  1.86s/it]{'epoch': 13, 'num_users': 6.1667, 'loss': 0.033, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.8609, 'compress@10': 1.0, 'time@10': 2.6891}:  60%|██████    | 6/10 [00:12<00:09,  2.35s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0327, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.8614, 'compress@10': 1.0, 'time@10': 2.8023}:  60%|██████    | 6/10 [00:13<00:09,  2.35s/it]{'epoch': 13, 'num_users': 6.2857, 'loss': 0.0327, 'hit_ratio@10': 0.8899, 'ndcg@10': 0.8614, 'compress@10': 1.0, 'time@10': 2.8023}:  70%|███████   | 7/10 [00:13<00:06,  2.17s/it]{'epoch': 13, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 2.7562}:  70%|███████   | 7/10 [00:16<00:06,  2.17s/it]  {'epoch': 13, 'num_users': 6.125, 'loss': 0.0316, 'hit_ratio@10': 0.8965, 'ndcg@10': 0.867, 'compress@10': 1.0, 'time@10': 2.7562}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.8734, 'compress@10': 1.0, 'time@10': 2.9448}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 13, 'num_users': 6.3333, 'loss': 0.0318, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.8734, 'compress@10': 1.0, 'time@10': 2.9448}:  90%|█████████ | 9/10 [00:18<00:02,  2.26s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.8805, 'compress@10': 1.0, 'time@10': 2.9589}:  90%|█████████ | 9/10 [00:21<00:02,  2.26s/it]   {'epoch': 13, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.8805, 'compress@10': 1.0, 'time@10': 2.9589}: 100%|██████████| 10/10 [00:21<00:00,  2.53s/it]{'epoch': 13, 'num_users': 6.3, 'loss': 0.0304, 'hit_ratio@10': 0.8892, 'ndcg@10': 0.8805, 'compress@10': 1.0, 'time@10': 2.9589}: 100%|██████████| 10/10 [00:21<00:00,  2.16s/it]
Epoch: 13
Avg # of users: 6.3
Avg Loss: 0.03039728340632007
Avg hit ratio: 0.8892440215886734
Avg ndcg: 0.880521005541118
Avg compression ratio: 1.0
Avg train time: 2.9589309453964234
Std train time: 0.9069390043866624
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.053, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8295, 'compress@10': 1.0, 'time@10': 2.6324}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 14, 'num_users': 7.0, 'loss': 0.053, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8295, 'compress@10': 1.0, 'time@10': 2.6324}:  10%|█         | 1/10 [00:01<00:12,  1.35s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0413, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 2.4469}:  10%|█         | 1/10 [00:03<00:12,  1.35s/it]{'epoch': 14, 'num_users': 7.0, 'loss': 0.0413, 'hit_ratio@10': 0.8141, 'ndcg@10': 0.8688, 'compress@10': 1.0, 'time@10': 2.4469}:  20%|██        | 2/10 [00:03<00:15,  1.91s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 2.2252}:  20%|██        | 2/10 [00:04<00:15,  1.91s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0275, 'hit_ratio@10': 0.7808, 'ndcg@10': 0.8649, 'compress@10': 1.0, 'time@10': 2.2252}:  30%|███       | 3/10 [00:04<00:10,  1.46s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 2.1492}:  30%|███       | 3/10 [00:06<00:10,  1.46s/it]{'epoch': 14, 'num_users': 5.0, 'loss': 0.0285, 'hit_ratio@10': 0.8267, 'ndcg@10': 0.8666, 'compress@10': 1.0, 'time@10': 2.1492}:  40%|████      | 4/10 [00:06<00:09,  1.66s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0338, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8572, 'compress@10': 1.0, 'time@10': 2.6107}:  40%|████      | 4/10 [00:08<00:09,  1.66s/it]{'epoch': 14, 'num_users': 5.8, 'loss': 0.0338, 'hit_ratio@10': 0.8414, 'ndcg@10': 0.8572, 'compress@10': 1.0, 'time@10': 2.6107}:  50%|█████     | 5/10 [00:08<00:09,  1.88s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0331, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 2.7091}:  50%|█████     | 5/10 [00:12<00:09,  1.88s/it]{'epoch': 14, 'num_users': 6.1667, 'loss': 0.0331, 'hit_ratio@10': 0.8604, 'ndcg@10': 0.8637, 'compress@10': 1.0, 'time@10': 2.7091}:  60%|██████    | 6/10 [00:12<00:09,  2.34s/it]{'epoch': 14, 'num_users': 6.2857, 'loss': 0.0322, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8717, 'compress@10': 1.0, 'time@10': 2.82}:  60%|██████    | 6/10 [00:13<00:09,  2.34s/it]  {'epoch': 14, 'num_users': 6.2857, 'loss': 0.0322, 'hit_ratio@10': 0.8746, 'ndcg@10': 0.8717, 'compress@10': 1.0, 'time@10': 2.82}:  70%|███████   | 7/10 [00:13<00:06,  2.16s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0317, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 2.7653}:  70%|███████   | 7/10 [00:16<00:06,  2.16s/it]{'epoch': 14, 'num_users': 6.125, 'loss': 0.0317, 'hit_ratio@10': 0.8867, 'ndcg@10': 0.8737, 'compress@10': 1.0, 'time@10': 2.7653}:  80%|████████  | 8/10 [00:16<00:04,  2.24s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0319, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 2.9594}:  80%|████████  | 8/10 [00:18<00:04,  2.24s/it]{'epoch': 14, 'num_users': 6.3333, 'loss': 0.0319, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 2.9594}:  90%|█████████ | 9/10 [00:18<00:02,  2.26s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0321, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.8876, 'compress@10': 1.0, 'time@10': 2.979}:  90%|█████████ | 9/10 [00:21<00:02,  2.26s/it]    {'epoch': 14, 'num_users': 6.3, 'loss': 0.0321, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.8876, 'compress@10': 1.0, 'time@10': 2.979}: 100%|██████████| 10/10 [00:21<00:00,  2.55s/it]{'epoch': 14, 'num_users': 6.3, 'loss': 0.0321, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.8876, 'compress@10': 1.0, 'time@10': 2.979}: 100%|██████████| 10/10 [00:21<00:00,  2.17s/it]
Epoch: 14
Avg # of users: 6.3
Avg Loss: 0.032123767876233555
Avg hit ratio: 0.8871011644458164
Avg ndcg: 0.8875696122375899
Avg compression ratio: 1.0
Avg train time: 2.9789906978607177
Std train time: 0.9172298083337489
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.034, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8758, 'compress@10': 1.0, 'time@10': 2.646}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 15, 'num_users': 7.0, 'loss': 0.034, 'hit_ratio@10': 0.7895, 'ndcg@10': 0.8758, 'compress@10': 1.0, 'time@10': 2.646}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 2.405}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it]{'epoch': 15, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8302, 'ndcg@10': 0.8944, 'compress@10': 1.0, 'time@10': 2.405}:  20%|██        | 2/10 [00:03<00:14,  1.85s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.882, 'compress@10': 1.0, 'time@10': 2.1865}:  20%|██        | 2/10 [00:04<00:14,  1.85s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0207, 'hit_ratio@10': 0.8392, 'ndcg@10': 0.882, 'compress@10': 1.0, 'time@10': 2.1865}:  30%|███       | 3/10 [00:04<00:09,  1.42s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 2.1188}:  30%|███       | 3/10 [00:06<00:09,  1.42s/it]{'epoch': 15, 'num_users': 5.0, 'loss': 0.0219, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.8862, 'compress@10': 1.0, 'time@10': 2.1188}:  40%|████      | 4/10 [00:06<00:09,  1.63s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0277, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8733, 'compress@10': 1.0, 'time@10': 2.6071}:  40%|████      | 4/10 [00:08<00:09,  1.63s/it]{'epoch': 15, 'num_users': 5.8, 'loss': 0.0277, 'hit_ratio@10': 0.8764, 'ndcg@10': 0.8733, 'compress@10': 1.0, 'time@10': 2.6071}:  50%|█████     | 5/10 [00:08<00:09,  1.88s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0286, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.7063}:  50%|█████     | 5/10 [00:11<00:09,  1.88s/it]{'epoch': 15, 'num_users': 6.1667, 'loss': 0.0286, 'hit_ratio@10': 0.8896, 'ndcg@10': 0.8769, 'compress@10': 1.0, 'time@10': 2.7063}:  60%|██████    | 6/10 [00:11<00:09,  2.34s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0298, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.8806, 'compress@10': 1.0, 'time@10': 2.8215}:  60%|██████    | 6/10 [00:13<00:09,  2.34s/it]{'epoch': 15, 'num_users': 6.2857, 'loss': 0.0298, 'hit_ratio@10': 0.8996, 'ndcg@10': 0.8806, 'compress@10': 1.0, 'time@10': 2.8215}:  70%|███████   | 7/10 [00:13<00:06,  2.16s/it]{'epoch': 15, 'num_users': 6.125, 'loss': 0.0295, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.8812, 'compress@10': 1.0, 'time@10': 2.7753}:  70%|███████   | 7/10 [00:16<00:06,  2.16s/it] {'epoch': 15, 'num_users': 6.125, 'loss': 0.0295, 'hit_ratio@10': 0.9086, 'ndcg@10': 0.8812, 'compress@10': 1.0, 'time@10': 2.7753}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0297, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 2.9652}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it]{'epoch': 15, 'num_users': 6.3333, 'loss': 0.0297, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.8902, 'compress@10': 1.0, 'time@10': 2.9652}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.8962, 'compress@10': 1.0, 'time@10': 2.9776}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]   {'epoch': 15, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.8962, 'compress@10': 1.0, 'time@10': 2.9776}: 100%|██████████| 10/10 [00:21<00:00,  2.54s/it]{'epoch': 15, 'num_users': 6.3, 'loss': 0.0277, 'hit_ratio@10': 0.9075, 'ndcg@10': 0.8962, 'compress@10': 1.0, 'time@10': 2.9776}: 100%|██████████| 10/10 [00:21<00:00,  2.17s/it]
Epoch: 15
Avg # of users: 6.3
Avg Loss: 0.02770565042902224
Avg hit ratio: 0.9074698280402865
Avg ndcg: 0.8961985968173141
Avg compression ratio: 1.0
Avg train time: 2.9775919914245605
Std train time: 0.9385948750114244
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 2.7979}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 16, 'num_users': 7.0, 'loss': 0.031, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8823, 'compress@10': 1.0, 'time@10': 2.7979}:  10%|█         | 1/10 [00:01<00:12,  1.44s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 2.5585}:  10%|█         | 1/10 [00:03<00:12,  1.44s/it]{'epoch': 16, 'num_users': 7.0, 'loss': 0.0294, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.8999, 'compress@10': 1.0, 'time@10': 2.5585}:  20%|██        | 2/10 [00:03<00:15,  1.98s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 2.347}:  20%|██        | 2/10 [00:04<00:15,  1.98s/it] {'epoch': 16, 'num_users': 5.0, 'loss': 0.0196, 'hit_ratio@10': 0.8091, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 2.347}:  30%|███       | 3/10 [00:04<00:10,  1.53s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 2.2413}:  30%|███       | 3/10 [00:06<00:10,  1.53s/it]{'epoch': 16, 'num_users': 5.0, 'loss': 0.0246, 'hit_ratio@10': 0.8301, 'ndcg@10': 0.8856, 'compress@10': 1.0, 'time@10': 2.2413}:  40%|████      | 4/10 [00:06<00:10,  1.70s/it]{'epoch': 16, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 2.6508}:  40%|████      | 4/10 [00:08<00:10,  1.70s/it] {'epoch': 16, 'num_users': 5.8, 'loss': 0.0292, 'hit_ratio@10': 0.844, 'ndcg@10': 0.8744, 'compress@10': 1.0, 'time@10': 2.6508}:  50%|█████     | 5/10 [00:08<00:09,  1.88s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0301, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 2.7623}:  50%|█████     | 5/10 [00:12<00:09,  1.88s/it]{'epoch': 16, 'num_users': 6.1667, 'loss': 0.0301, 'hit_ratio@10': 0.8626, 'ndcg@10': 0.8801, 'compress@10': 1.0, 'time@10': 2.7623}:  60%|██████    | 6/10 [00:12<00:09,  2.38s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0301, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8783, 'compress@10': 1.0, 'time@10': 2.8618}:  60%|██████    | 6/10 [00:14<00:09,  2.38s/it]{'epoch': 16, 'num_users': 6.2857, 'loss': 0.0301, 'hit_ratio@10': 0.8765, 'ndcg@10': 0.8783, 'compress@10': 1.0, 'time@10': 2.8618}:  70%|███████   | 7/10 [00:14<00:06,  2.19s/it]{'epoch': 16, 'num_users': 6.125, 'loss': 0.0294, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 2.8032}:  70%|███████   | 7/10 [00:16<00:06,  2.19s/it] {'epoch': 16, 'num_users': 6.125, 'loss': 0.0294, 'hit_ratio@10': 0.8884, 'ndcg@10': 0.8795, 'compress@10': 1.0, 'time@10': 2.8032}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 3.0022}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 16, 'num_users': 6.3333, 'loss': 0.0284, 'hit_ratio@10': 0.8754, 'ndcg@10': 0.8873, 'compress@10': 1.0, 'time@10': 3.0022}:  90%|█████████ | 9/10 [00:18<00:02,  2.28s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8858, 'compress@10': 1.0, 'time@10': 3.0071}:  90%|█████████ | 9/10 [00:21<00:02,  2.28s/it]   {'epoch': 16, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8858, 'compress@10': 1.0, 'time@10': 3.0071}: 100%|██████████| 10/10 [00:21<00:00,  2.53s/it]{'epoch': 16, 'num_users': 6.3, 'loss': 0.0293, 'hit_ratio@10': 0.8856, 'ndcg@10': 0.8858, 'compress@10': 1.0, 'time@10': 3.0071}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 16
Avg # of users: 6.3
Avg Loss: 0.029311836728462066
Avg hit ratio: 0.8855901287921661
Avg ndcg: 0.8857940058961349
Avg compression ratio: 1.0
Avg train time: 3.007102632522583
Std train time: 0.8778298409768857
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8563, 'compress@10': 1.0, 'time@10': 2.6965}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 17, 'num_users': 7.0, 'loss': 0.0474, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8563, 'compress@10': 1.0, 'time@10': 2.6965}:  10%|█         | 1/10 [00:01<00:12,  1.39s/it]{'epoch': 17, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 2.457}:  10%|█         | 1/10 [00:03<00:12,  1.39s/it]  {'epoch': 17, 'num_users': 7.0, 'loss': 0.038, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.8899, 'compress@10': 1.0, 'time@10': 2.457}:  20%|██        | 2/10 [00:03<00:15,  1.90s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8789, 'compress@10': 1.0, 'time@10': 2.2177}:  20%|██        | 2/10 [00:04<00:15,  1.90s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0253, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8789, 'compress@10': 1.0, 'time@10': 2.2177}:  30%|███       | 3/10 [00:04<00:10,  1.45s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 2.1492}:  30%|███       | 3/10 [00:06<00:10,  1.45s/it]{'epoch': 17, 'num_users': 5.0, 'loss': 0.0291, 'hit_ratio@10': 0.8139, 'ndcg@10': 0.8742, 'compress@10': 1.0, 'time@10': 2.1492}:  40%|████      | 4/10 [00:06<00:09,  1.66s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0321, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 2.5849}:  40%|████      | 4/10 [00:08<00:09,  1.66s/it]{'epoch': 17, 'num_users': 5.8, 'loss': 0.0321, 'hit_ratio@10': 0.8311, 'ndcg@10': 0.8673, 'compress@10': 1.0, 'time@10': 2.5849}:  50%|█████     | 5/10 [00:08<00:09,  1.86s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0308, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 2.6968}:  50%|█████     | 5/10 [00:12<00:09,  1.86s/it]{'epoch': 17, 'num_users': 6.1667, 'loss': 0.0308, 'hit_ratio@10': 0.8519, 'ndcg@10': 0.8771, 'compress@10': 1.0, 'time@10': 2.6968}:  60%|██████    | 6/10 [00:12<00:09,  2.35s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 2.8039}:  60%|██████    | 6/10 [00:13<00:09,  2.35s/it]{'epoch': 17, 'num_users': 6.2857, 'loss': 0.0293, 'hit_ratio@10': 0.8673, 'ndcg@10': 0.8857, 'compress@10': 1.0, 'time@10': 2.8039}:  70%|███████   | 7/10 [00:13<00:06,  2.15s/it]{'epoch': 17, 'num_users': 6.125, 'loss': 0.0282, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 2.7592}:  70%|███████   | 7/10 [00:16<00:06,  2.15s/it] {'epoch': 17, 'num_users': 6.125, 'loss': 0.0282, 'hit_ratio@10': 0.8803, 'ndcg@10': 0.8887, 'compress@10': 1.0, 'time@10': 2.7592}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 2.9487}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 17, 'num_users': 6.3333, 'loss': 0.0266, 'hit_ratio@10': 0.8714, 'ndcg@10': 0.8956, 'compress@10': 1.0, 'time@10': 2.9487}:  90%|█████████ | 9/10 [00:18<00:02,  2.26s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0249, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9013, 'compress@10': 1.0, 'time@10': 2.9633}:  90%|█████████ | 9/10 [00:21<00:02,  2.26s/it]    {'epoch': 17, 'num_users': 6.3, 'loss': 0.0249, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9013, 'compress@10': 1.0, 'time@10': 2.9633}: 100%|██████████| 10/10 [00:21<00:00,  2.53s/it]{'epoch': 17, 'num_users': 6.3, 'loss': 0.0249, 'hit_ratio@10': 0.882, 'ndcg@10': 0.9013, 'compress@10': 1.0, 'time@10': 2.9633}: 100%|██████████| 10/10 [00:21<00:00,  2.17s/it]
Epoch: 17
Avg # of users: 6.3
Avg Loss: 0.02490553692706179
Avg hit ratio: 0.8819956587460831
Avg ndcg: 0.901285571784293
Avg compression ratio: 1.0
Avg train time: 2.9633152008056642
Std train time: 0.8881083131851574
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 2.6533}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0307, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.8772, 'compress@10': 1.0, 'time@10': 2.6533}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 2.4142}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it]{'epoch': 18, 'num_users': 7.0, 'loss': 0.0286, 'hit_ratio@10': 0.8243, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 2.4142}:  20%|██        | 2/10 [00:03<00:14,  1.86s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 2.1963}:  20%|██        | 2/10 [00:04<00:14,  1.86s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0191, 'hit_ratio@10': 0.7876, 'ndcg@10': 0.8901, 'compress@10': 1.0, 'time@10': 2.1963}:  30%|███       | 3/10 [00:04<00:10,  1.43s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 2.1266}:  30%|███       | 3/10 [00:06<00:10,  1.43s/it]{'epoch': 18, 'num_users': 5.0, 'loss': 0.0213, 'hit_ratio@10': 0.8229, 'ndcg@10': 0.8878, 'compress@10': 1.0, 'time@10': 2.1266}:  40%|████      | 4/10 [00:06<00:09,  1.64s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8786, 'compress@10': 1.0, 'time@10': 2.5803}:  40%|████      | 4/10 [00:08<00:09,  1.64s/it]{'epoch': 18, 'num_users': 5.8, 'loss': 0.0253, 'hit_ratio@10': 0.8383, 'ndcg@10': 0.8786, 'compress@10': 1.0, 'time@10': 2.5803}:  50%|█████     | 5/10 [00:08<00:09,  1.85s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8881, 'compress@10': 1.0, 'time@10': 2.697}:  50%|█████     | 5/10 [00:11<00:09,  1.85s/it]{'epoch': 18, 'num_users': 6.1667, 'loss': 0.0237, 'hit_ratio@10': 0.8615, 'ndcg@10': 0.8881, 'compress@10': 1.0, 'time@10': 2.697}:  60%|██████    | 6/10 [00:11<00:09,  2.35s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0257, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.891, 'compress@10': 1.0, 'time@10': 2.8228}:  60%|██████    | 6/10 [00:13<00:09,  2.35s/it]{'epoch': 18, 'num_users': 6.2857, 'loss': 0.0257, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.891, 'compress@10': 1.0, 'time@10': 2.8228}:  70%|███████   | 7/10 [00:13<00:06,  2.18s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0248, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.7714}:  70%|███████   | 7/10 [00:16<00:06,  2.18s/it]{'epoch': 18, 'num_users': 6.125, 'loss': 0.0248, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.7714}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0247, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9014, 'compress@10': 1.0, 'time@10': 2.971}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 18, 'num_users': 6.3333, 'loss': 0.0247, 'hit_ratio@10': 0.8747, 'ndcg@10': 0.9014, 'compress@10': 1.0, 'time@10': 2.971}:  90%|█████████ | 9/10 [00:18<00:02,  2.29s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9112, 'compress@10': 1.0, 'time@10': 2.9842}:  90%|█████████ | 9/10 [00:21<00:02,  2.29s/it]  {'epoch': 18, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9112, 'compress@10': 1.0, 'time@10': 2.9842}: 100%|██████████| 10/10 [00:21<00:00,  2.55s/it]{'epoch': 18, 'num_users': 6.3, 'loss': 0.0259, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9112, 'compress@10': 1.0, 'time@10': 2.9842}: 100%|██████████| 10/10 [00:21<00:00,  2.17s/it]
Epoch: 18
Avg # of users: 6.3
Avg Loss: 0.025886360124080465
Avg hit ratio: 0.8849321666825911
Avg ndcg: 0.9112247847526349
Avg compression ratio: 1.0
Avg train time: 2.984237790107727
Std train time: 0.9316601470615948
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8808, 'compress@10': 1.0, 'time@10': 2.6611}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0313, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8808, 'compress@10': 1.0, 'time@10': 2.6611}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 2.4241}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it]{'epoch': 19, 'num_users': 7.0, 'loss': 0.0265, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 2.4241}:  20%|██        | 2/10 [00:03<00:14,  1.87s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 2.1913}:  20%|██        | 2/10 [00:04<00:14,  1.87s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0177, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8943, 'compress@10': 1.0, 'time@10': 2.1913}:  30%|███       | 3/10 [00:04<00:09,  1.43s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 2.1427}:  30%|███       | 3/10 [00:06<00:09,  1.43s/it]{'epoch': 19, 'num_users': 5.0, 'loss': 0.0194, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8915, 'compress@10': 1.0, 'time@10': 2.1427}:  40%|████      | 4/10 [00:06<00:09,  1.67s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0233, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8846, 'compress@10': 1.0, 'time@10': 2.5803}:  40%|████      | 4/10 [00:08<00:09,  1.67s/it]{'epoch': 19, 'num_users': 5.8, 'loss': 0.0233, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8846, 'compress@10': 1.0, 'time@10': 2.5803}:  50%|█████     | 5/10 [00:08<00:09,  1.86s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0233, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.891, 'compress@10': 1.0, 'time@10': 2.7096}:  50%|█████     | 5/10 [00:12<00:09,  1.86s/it]{'epoch': 19, 'num_users': 6.1667, 'loss': 0.0233, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.891, 'compress@10': 1.0, 'time@10': 2.7096}:  60%|██████    | 6/10 [00:12<00:09,  2.38s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 2.8236}:  60%|██████    | 6/10 [00:13<00:09,  2.38s/it]{'epoch': 19, 'num_users': 6.2857, 'loss': 0.0236, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.8909, 'compress@10': 1.0, 'time@10': 2.8236}:  70%|███████   | 7/10 [00:13<00:06,  2.19s/it]{'epoch': 19, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8914, 'compress@10': 1.0, 'time@10': 2.7723}:  70%|███████   | 7/10 [00:16<00:06,  2.19s/it] {'epoch': 19, 'num_users': 6.125, 'loss': 0.0236, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.8914, 'compress@10': 1.0, 'time@10': 2.7723}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 2.9642}:  80%|████████  | 8/10 [00:18<00:04,  2.28s/it]{'epoch': 19, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8646, 'ndcg@10': 0.8979, 'compress@10': 1.0, 'time@10': 2.9642}:  90%|█████████ | 9/10 [00:18<00:02,  2.28s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 2.9826}:  90%|█████████ | 9/10 [00:21<00:02,  2.28s/it]    {'epoch': 19, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 2.9826}: 100%|██████████| 10/10 [00:21<00:00,  2.56s/it]{'epoch': 19, 'num_users': 6.3, 'loss': 0.0233, 'hit_ratio@10': 0.8759, 'ndcg@10': 0.903, 'compress@10': 1.0, 'time@10': 2.9826}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 19
Avg # of users: 6.3
Avg Loss: 0.023251528965793494
Avg hit ratio: 0.8759096102916137
Avg ndcg: 0.9030102917697314
Avg compression ratio: 1.0
Avg train time: 2.982636070251465
Std train time: 0.9039505108059329
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 2.808}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0287, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8884, 'compress@10': 1.0, 'time@10': 2.808}:  10%|█         | 1/10 [00:01<00:12,  1.44s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9141, 'compress@10': 1.0, 'time@10': 2.5493}:  10%|█         | 1/10 [00:03<00:12,  1.44s/it]{'epoch': 20, 'num_users': 7.0, 'loss': 0.0244, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9141, 'compress@10': 1.0, 'time@10': 2.5493}:  20%|██        | 2/10 [00:03<00:15,  1.96s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 2.2705}:  20%|██        | 2/10 [00:04<00:15,  1.96s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0163, 'hit_ratio@10': 0.8052, 'ndcg@10': 0.8951, 'compress@10': 1.0, 'time@10': 2.2705}:  30%|███       | 3/10 [00:04<00:10,  1.47s/it]{'epoch': 20, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 2.1885}:  30%|███       | 3/10 [00:06<00:10,  1.47s/it] {'epoch': 20, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.836, 'ndcg@10': 0.8921, 'compress@10': 1.0, 'time@10': 2.1885}:  40%|████      | 4/10 [00:06<00:10,  1.67s/it]{'epoch': 20, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.886, 'compress@10': 1.0, 'time@10': 2.6177}:  40%|████      | 4/10 [00:08<00:10,  1.67s/it] {'epoch': 20, 'num_users': 5.8, 'loss': 0.022, 'hit_ratio@10': 0.8488, 'ndcg@10': 0.886, 'compress@10': 1.0, 'time@10': 2.6177}:  50%|█████     | 5/10 [00:08<00:09,  1.87s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.887, 'compress@10': 1.0, 'time@10': 2.7223}:  50%|█████     | 5/10 [00:12<00:09,  1.87s/it]{'epoch': 20, 'num_users': 6.1667, 'loss': 0.0241, 'hit_ratio@10': 0.8703, 'ndcg@10': 0.887, 'compress@10': 1.0, 'time@10': 2.7223}:  60%|██████    | 6/10 [00:12<00:09,  2.35s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.023, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8952, 'compress@10': 1.0, 'time@10': 2.8507}:  60%|██████    | 6/10 [00:13<00:09,  2.35s/it]{'epoch': 20, 'num_users': 6.2857, 'loss': 0.023, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.8952, 'compress@10': 1.0, 'time@10': 2.8507}:  70%|███████   | 7/10 [00:13<00:06,  2.18s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0233, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 2.7944}:  70%|███████   | 7/10 [00:16<00:06,  2.18s/it]{'epoch': 20, 'num_users': 6.125, 'loss': 0.0233, 'hit_ratio@10': 0.8942, 'ndcg@10': 0.8936, 'compress@10': 1.0, 'time@10': 2.7944}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9135, 'compress@10': 1.0, 'time@10': 2.9851}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 20, 'num_users': 6.3333, 'loss': 0.0241, 'hit_ratio@10': 0.8805, 'ndcg@10': 0.9135, 'compress@10': 1.0, 'time@10': 2.9851}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9189, 'compress@10': 1.0, 'time@10': 3.0001}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]   {'epoch': 20, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9189, 'compress@10': 1.0, 'time@10': 3.0001}: 100%|██████████| 10/10 [00:21<00:00,  2.55s/it]{'epoch': 20, 'num_users': 6.3, 'loss': 0.0225, 'hit_ratio@10': 0.8902, 'ndcg@10': 0.9189, 'compress@10': 1.0, 'time@10': 3.0001}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 20
Avg # of users: 6.3
Avg Loss: 0.022487726583680527
Avg hit ratio: 0.890195324577328
Avg ndcg: 0.9188939044246007
Avg compression ratio: 1.0
Avg train time: 3.0001115798950195
Std train time: 0.9056985093530476
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8858, 'compress@10': 1.0, 'time@10': 2.6431}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0278, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8858, 'compress@10': 1.0, 'time@10': 2.6431}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9165, 'compress@10': 1.0, 'time@10': 2.4251}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it]{'epoch': 21, 'num_users': 7.0, 'loss': 0.0241, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9165, 'compress@10': 1.0, 'time@10': 2.4251}:  20%|██        | 2/10 [00:03<00:15,  1.88s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 2.1874}:  20%|██        | 2/10 [00:04<00:15,  1.88s/it] {'epoch': 21, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8967, 'compress@10': 1.0, 'time@10': 2.1874}:  30%|███       | 3/10 [00:04<00:09,  1.43s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.1522}:  30%|███       | 3/10 [00:06<00:09,  1.43s/it]{'epoch': 21, 'num_users': 5.0, 'loss': 0.0185, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.1522}:  40%|████      | 4/10 [00:06<00:10,  1.69s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8927, 'compress@10': 1.0, 'time@10': 2.5932}:  40%|████      | 4/10 [00:08<00:10,  1.69s/it]{'epoch': 21, 'num_users': 5.8, 'loss': 0.0214, 'hit_ratio@10': 0.8202, 'ndcg@10': 0.8927, 'compress@10': 1.0, 'time@10': 2.5932}:  50%|█████     | 5/10 [00:08<00:09,  1.88s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0216, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.9023, 'compress@10': 1.0, 'time@10': 2.7017}:  50%|█████     | 5/10 [00:12<00:09,  1.88s/it]{'epoch': 21, 'num_users': 6.1667, 'loss': 0.0216, 'hit_ratio@10': 0.8465, 'ndcg@10': 0.9023, 'compress@10': 1.0, 'time@10': 2.7017}:  60%|██████    | 6/10 [00:12<00:09,  2.35s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0229, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9047, 'compress@10': 1.0, 'time@10': 2.8108}:  60%|██████    | 6/10 [00:13<00:09,  2.35s/it]{'epoch': 21, 'num_users': 6.2857, 'loss': 0.0229, 'hit_ratio@10': 0.8627, 'ndcg@10': 0.9047, 'compress@10': 1.0, 'time@10': 2.8108}:  70%|███████   | 7/10 [00:13<00:06,  2.16s/it]{'epoch': 21, 'num_users': 6.125, 'loss': 0.0215, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9107, 'compress@10': 1.0, 'time@10': 2.7597}:  70%|███████   | 7/10 [00:16<00:06,  2.16s/it] {'epoch': 21, 'num_users': 6.125, 'loss': 0.0215, 'hit_ratio@10': 0.8763, 'ndcg@10': 0.9107, 'compress@10': 1.0, 'time@10': 2.7597}:  80%|████████  | 8/10 [00:16<00:04,  2.25s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0251, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9369, 'compress@10': 1.0, 'time@10': 2.9567}:  80%|████████  | 8/10 [00:18<00:04,  2.25s/it]{'epoch': 21, 'num_users': 6.3333, 'loss': 0.0251, 'hit_ratio@10': 0.8678, 'ndcg@10': 0.9369, 'compress@10': 1.0, 'time@10': 2.9567}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9354, 'compress@10': 1.0, 'time@10': 2.966}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]    {'epoch': 21, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9354, 'compress@10': 1.0, 'time@10': 2.966}: 100%|██████████| 10/10 [00:21<00:00,  2.52s/it]{'epoch': 21, 'num_users': 6.3, 'loss': 0.0257, 'hit_ratio@10': 0.8788, 'ndcg@10': 0.9354, 'compress@10': 1.0, 'time@10': 2.966}: 100%|██████████| 10/10 [00:21<00:00,  2.17s/it]
Epoch: 21
Avg # of users: 6.3
Avg Loss: 0.025690325484967736
Avg hit ratio: 0.8787667531487566
Avg ndcg: 0.9354047349458936
Avg compression ratio: 1.0
Avg train time: 2.965982985496521
Std train time: 0.9022419936223592
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 2.8112}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0247, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8922, 'compress@10': 1.0, 'time@10': 2.8112}:  10%|█         | 1/10 [00:01<00:12,  1.44s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9303, 'compress@10': 1.0, 'time@10': 2.5129}:  10%|█         | 1/10 [00:03<00:12,  1.44s/it]{'epoch': 22, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9303, 'compress@10': 1.0, 'time@10': 2.5129}:  20%|██        | 2/10 [00:03<00:15,  1.92s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9059, 'compress@10': 1.0, 'time@10': 2.255}:  20%|██        | 2/10 [00:04<00:15,  1.92s/it] {'epoch': 22, 'num_users': 5.0, 'loss': 0.0139, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9059, 'compress@10': 1.0, 'time@10': 2.255}:  30%|███       | 3/10 [00:04<00:10,  1.46s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.7922, 'ndcg@10': 0.9098, 'compress@10': 1.0, 'time@10': 2.1696}:  30%|███       | 3/10 [00:06<00:10,  1.46s/it]{'epoch': 22, 'num_users': 5.0, 'loss': 0.0168, 'hit_ratio@10': 0.7922, 'ndcg@10': 0.9098, 'compress@10': 1.0, 'time@10': 2.1696}:  40%|████      | 4/10 [00:06<00:09,  1.65s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.9025, 'compress@10': 1.0, 'time@10': 2.6113}:  40%|████      | 4/10 [00:08<00:09,  1.65s/it]{'epoch': 22, 'num_users': 5.8, 'loss': 0.0196, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.9025, 'compress@10': 1.0, 'time@10': 2.6113}:  50%|█████     | 5/10 [00:08<00:09,  1.87s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 2.7417}:  50%|█████     | 5/10 [00:12<00:09,  1.87s/it]{'epoch': 22, 'num_users': 6.1667, 'loss': 0.0194, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 2.7417}:  60%|██████    | 6/10 [00:12<00:09,  2.40s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 2.8493}:  60%|██████    | 6/10 [00:14<00:09,  2.40s/it]{'epoch': 22, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 2.8493}:  70%|███████   | 7/10 [00:14<00:06,  2.20s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0194, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9119, 'compress@10': 1.0, 'time@10': 2.7928}:  70%|███████   | 7/10 [00:16<00:06,  2.20s/it]{'epoch': 22, 'num_users': 6.125, 'loss': 0.0194, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9119, 'compress@10': 1.0, 'time@10': 2.7928}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 2.9912}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it]{'epoch': 22, 'num_users': 6.3333, 'loss': 0.0234, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9147, 'compress@10': 1.0, 'time@10': 2.9912}:  90%|█████████ | 9/10 [00:18<00:02,  2.29s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9198, 'compress@10': 1.0, 'time@10': 3.0051}:  90%|█████████ | 9/10 [00:21<00:02,  2.29s/it]    {'epoch': 22, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9198, 'compress@10': 1.0, 'time@10': 3.0051}: 100%|██████████| 10/10 [00:21<00:00,  2.56s/it]{'epoch': 22, 'num_users': 6.3, 'loss': 0.022, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9198, 'compress@10': 1.0, 'time@10': 3.0051}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 22
Avg # of users: 6.3
Avg Loss: 0.021974741093827577
Avg hit ratio: 0.8698266609828579
Avg ndcg: 0.9198377435655344
Avg compression ratio: 1.0
Avg train time: 3.0050961494445803
Std train time: 0.9269533558885051
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.709}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0252, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8968, 'compress@10': 1.0, 'time@10': 2.709}:  10%|█         | 1/10 [00:01<00:12,  1.39s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9248, 'compress@10': 1.0, 'time@10': 2.4279}:  10%|█         | 1/10 [00:03<00:12,  1.39s/it]{'epoch': 23, 'num_users': 7.0, 'loss': 0.0199, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9248, 'compress@10': 1.0, 'time@10': 2.4279}:  20%|██        | 2/10 [00:03<00:14,  1.86s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9022, 'compress@10': 1.0, 'time@10': 2.2003}:  20%|██        | 2/10 [00:04<00:14,  1.86s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.0133, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9022, 'compress@10': 1.0, 'time@10': 2.2003}:  30%|███       | 3/10 [00:04<00:09,  1.42s/it]{'epoch': 23, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.7922, 'ndcg@10': 0.9009, 'compress@10': 1.0, 'time@10': 2.1425}:  30%|███       | 3/10 [00:06<00:09,  1.42s/it] {'epoch': 23, 'num_users': 5.0, 'loss': 0.016, 'hit_ratio@10': 0.7922, 'ndcg@10': 0.9009, 'compress@10': 1.0, 'time@10': 2.1425}:  40%|████      | 4/10 [00:06<00:09,  1.65s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 2.6065}:  40%|████      | 4/10 [00:08<00:09,  1.65s/it]{'epoch': 23, 'num_users': 5.8, 'loss': 0.0187, 'hit_ratio@10': 0.8138, 'ndcg@10': 0.8961, 'compress@10': 1.0, 'time@10': 2.6065}:  50%|█████     | 5/10 [00:08<00:09,  1.88s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9057, 'compress@10': 1.0, 'time@10': 2.7057}:  50%|█████     | 5/10 [00:12<00:09,  1.88s/it]{'epoch': 23, 'num_users': 6.1667, 'loss': 0.0184, 'hit_ratio@10': 0.8411, 'ndcg@10': 0.9057, 'compress@10': 1.0, 'time@10': 2.7057}:  60%|██████    | 6/10 [00:12<00:09,  2.34s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9114, 'compress@10': 1.0, 'time@10': 2.8399}:  60%|██████    | 6/10 [00:13<00:09,  2.34s/it]{'epoch': 23, 'num_users': 6.2857, 'loss': 0.0178, 'hit_ratio@10': 0.8581, 'ndcg@10': 0.9114, 'compress@10': 1.0, 'time@10': 2.8399}:  70%|███████   | 7/10 [00:13<00:06,  2.19s/it]{'epoch': 23, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 2.7941}:  70%|███████   | 7/10 [00:16<00:06,  2.19s/it] {'epoch': 23, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9065, 'compress@10': 1.0, 'time@10': 2.7941}:  80%|████████  | 8/10 [00:16<00:04,  2.29s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 2.9731}:  80%|████████  | 8/10 [00:18<00:04,  2.29s/it]{'epoch': 23, 'num_users': 6.3333, 'loss': 0.0192, 'hit_ratio@10': 0.8579, 'ndcg@10': 0.9096, 'compress@10': 1.0, 'time@10': 2.9731}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9167, 'compress@10': 1.0, 'time@10': 2.9864}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]   {'epoch': 23, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9167, 'compress@10': 1.0, 'time@10': 2.9864}: 100%|██████████| 10/10 [00:21<00:00,  2.54s/it]{'epoch': 23, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.8698, 'ndcg@10': 0.9167, 'compress@10': 1.0, 'time@10': 2.9864}: 100%|██████████| 10/10 [00:21<00:00,  2.18s/it]
Epoch: 23
Avg # of users: 6.3
Avg Loss: 0.018120539343731035
Avg hit ratio: 0.8698266609828579
Avg ndcg: 0.9167370459139521
Avg compression ratio: 1.0
Avg train time: 2.9863582372665407
Std train time: 0.9114590046412608
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.6378}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0239, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.8986, 'compress@10': 1.0, 'time@10': 2.6378}:  10%|█         | 1/10 [00:01<00:12,  1.35s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 2.4179}:  10%|█         | 1/10 [00:03<00:12,  1.35s/it]{'epoch': 24, 'num_users': 7.0, 'loss': 0.0223, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9207, 'compress@10': 1.0, 'time@10': 2.4179}:  20%|██        | 2/10 [00:03<00:14,  1.87s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 2.1929}:  20%|██        | 2/10 [00:04<00:14,  1.87s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0149, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.8995, 'compress@10': 1.0, 'time@10': 2.1929}:  30%|███       | 3/10 [00:04<00:10,  1.43s/it]{'epoch': 24, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 2.1343}:  30%|███       | 3/10 [00:06<00:10,  1.43s/it]   {'epoch': 24, 'num_users': 5.0, 'loss': 0.0164, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9, 'compress@10': 1.0, 'time@10': 2.1343}:  40%|████      | 4/10 [00:06<00:09,  1.66s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 2.5581}:  40%|████      | 4/10 [00:08<00:09,  1.66s/it]{'epoch': 24, 'num_users': 5.8, 'loss': 0.0186, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.8963, 'compress@10': 1.0, 'time@10': 2.5581}:  50%|█████     | 5/10 [00:08<00:09,  1.84s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.021, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9123, 'compress@10': 1.0, 'time@10': 2.6702}:  50%|█████     | 5/10 [00:11<00:09,  1.84s/it]{'epoch': 24, 'num_users': 6.1667, 'loss': 0.021, 'hit_ratio@10': 0.8495, 'ndcg@10': 0.9123, 'compress@10': 1.0, 'time@10': 2.6702}:  60%|██████    | 6/10 [00:11<00:09,  2.33s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9139, 'compress@10': 1.0, 'time@10': 2.7944}:  60%|██████    | 6/10 [00:13<00:09,  2.33s/it]{'epoch': 24, 'num_users': 6.2857, 'loss': 0.0224, 'hit_ratio@10': 0.8652, 'ndcg@10': 0.9139, 'compress@10': 1.0, 'time@10': 2.7944}:  70%|███████   | 7/10 [00:13<00:06,  2.16s/it]{'epoch': 24, 'num_users': 6.125, 'loss': 0.0211, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9192, 'compress@10': 1.0, 'time@10': 2.7477}:  70%|███████   | 7/10 [00:16<00:06,  2.16s/it] {'epoch': 24, 'num_users': 6.125, 'loss': 0.0211, 'hit_ratio@10': 0.8785, 'ndcg@10': 0.9192, 'compress@10': 1.0, 'time@10': 2.7477}:  80%|████████  | 8/10 [00:16<00:04,  2.25s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9389, 'compress@10': 1.0, 'time@10': 2.9733}:  80%|████████  | 8/10 [00:18<00:04,  2.25s/it]{'epoch': 24, 'num_users': 6.3333, 'loss': 0.0238, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9389, 'compress@10': 1.0, 'time@10': 2.9733}:  90%|█████████ | 9/10 [00:18<00:02,  2.31s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9381, 'compress@10': 1.0, 'time@10': 3.0012}:  90%|█████████ | 9/10 [00:21<00:02,  2.31s/it]   {'epoch': 24, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9381, 'compress@10': 1.0, 'time@10': 3.0012}: 100%|██████████| 10/10 [00:21<00:00,  2.61s/it]{'epoch': 24, 'num_users': 6.3, 'loss': 0.0234, 'hit_ratio@10': 0.8748, 'ndcg@10': 0.9381, 'compress@10': 1.0, 'time@10': 3.0012}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 24
Avg # of users: 6.3
Avg Loss: 0.023442450552577054
Avg hit ratio: 0.8748302452122486
Avg ndcg: 0.9380947579767713
Avg compression ratio: 1.0
Avg train time: 3.001227593421936
Std train time: 0.9441296284846912
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9013, 'compress@10': 1.0, 'time@10': 2.7338}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0209, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9013, 'compress@10': 1.0, 'time@10': 2.7338}:  10%|█         | 1/10 [00:01<00:12,  1.40s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9433, 'compress@10': 1.0, 'time@10': 2.4862}:  10%|█         | 1/10 [00:03<00:12,  1.40s/it]{'epoch': 25, 'num_users': 7.0, 'loss': 0.0197, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9433, 'compress@10': 1.0, 'time@10': 2.4862}:  20%|██        | 2/10 [00:03<00:15,  1.91s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9146, 'compress@10': 1.0, 'time@10': 2.2489}:  20%|██        | 2/10 [00:04<00:15,  1.91s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9146, 'compress@10': 1.0, 'time@10': 2.2489}:  30%|███       | 3/10 [00:04<00:10,  1.46s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.7922, 'ndcg@10': 0.9154, 'compress@10': 1.0, 'time@10': 2.1679}:  30%|███       | 3/10 [00:06<00:10,  1.46s/it]{'epoch': 25, 'num_users': 5.0, 'loss': 0.0147, 'hit_ratio@10': 0.7922, 'ndcg@10': 0.9154, 'compress@10': 1.0, 'time@10': 2.1679}:  40%|████      | 4/10 [00:06<00:09,  1.66s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0169, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.9094, 'compress@10': 1.0, 'time@10': 2.5826}:  40%|████      | 4/10 [00:08<00:09,  1.66s/it]{'epoch': 25, 'num_users': 5.8, 'loss': 0.0169, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.9094, 'compress@10': 1.0, 'time@10': 2.5826}:  50%|█████     | 5/10 [00:08<00:09,  1.84s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 2.6937}:  50%|█████     | 5/10 [00:12<00:09,  1.84s/it]{'epoch': 25, 'num_users': 6.1667, 'loss': 0.0166, 'hit_ratio@10': 0.8441, 'ndcg@10': 0.9177, 'compress@10': 1.0, 'time@10': 2.6937}:  60%|██████    | 6/10 [00:12<00:09,  2.33s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0168, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 2.8117}:  60%|██████    | 6/10 [00:13<00:09,  2.33s/it]{'epoch': 25, 'num_users': 6.2857, 'loss': 0.0168, 'hit_ratio@10': 0.8606, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 2.8117}:  70%|███████   | 7/10 [00:13<00:06,  2.16s/it]{'epoch': 25, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9216, 'compress@10': 1.0, 'time@10': 2.7684}:  70%|███████   | 7/10 [00:16<00:06,  2.16s/it] {'epoch': 25, 'num_users': 6.125, 'loss': 0.0167, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.9216, 'compress@10': 1.0, 'time@10': 2.7684}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 25, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9198, 'compress@10': 1.0, 'time@10': 2.9636}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it] {'epoch': 25, 'num_users': 6.3333, 'loss': 0.018, 'hit_ratio@10': 0.863, 'ndcg@10': 0.9198, 'compress@10': 1.0, 'time@10': 2.9636}:  90%|█████████ | 9/10 [00:18<00:02,  2.28s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0169, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 2.9901}:  90%|█████████ | 9/10 [00:21<00:02,  2.28s/it]  {'epoch': 25, 'num_users': 6.3, 'loss': 0.0169, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 2.9901}: 100%|██████████| 10/10 [00:21<00:00,  2.58s/it]{'epoch': 25, 'num_users': 6.3, 'loss': 0.0169, 'hit_ratio@10': 0.8745, 'ndcg@10': 0.925, 'compress@10': 1.0, 'time@10': 2.9901}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 25
Avg # of users: 6.3
Avg Loss: 0.016884323254627312
Avg hit ratio: 0.8744615816177786
Avg ndcg: 0.9249727421050971
Avg compression ratio: 1.0
Avg train time: 2.9900551319122313
Std train time: 0.8855921234225775
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 2.7753}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0219, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9055, 'compress@10': 1.0, 'time@10': 2.7753}:  10%|█         | 1/10 [00:01<00:12,  1.43s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9356, 'compress@10': 1.0, 'time@10': 2.5005}:  10%|█         | 1/10 [00:03<00:12,  1.43s/it]{'epoch': 26, 'num_users': 7.0, 'loss': 0.0156, 'hit_ratio@10': 0.8345, 'ndcg@10': 0.9356, 'compress@10': 1.0, 'time@10': 2.5005}:  20%|██        | 2/10 [00:03<00:15,  1.92s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 2.2448}:  20%|██        | 2/10 [00:04<00:15,  1.92s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.7468, 'ndcg@10': 0.9095, 'compress@10': 1.0, 'time@10': 2.2448}:  30%|███       | 3/10 [00:04<00:10,  1.45s/it]{'epoch': 26, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.7922, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 2.1709}:  30%|███       | 3/10 [00:06<00:10,  1.45s/it]  {'epoch': 26, 'num_users': 5.0, 'loss': 0.0131, 'hit_ratio@10': 0.7922, 'ndcg@10': 0.91, 'compress@10': 1.0, 'time@10': 2.1709}:  40%|████      | 4/10 [00:06<00:09,  1.66s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.9063, 'compress@10': 1.0, 'time@10': 2.6241}:  40%|████      | 4/10 [00:08<00:09,  1.66s/it]{'epoch': 26, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8218, 'ndcg@10': 0.9063, 'compress@10': 1.0, 'time@10': 2.6241}:  50%|█████     | 5/10 [00:08<00:09,  1.88s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 2.7414}:  50%|█████     | 5/10 [00:12<00:09,  1.88s/it]{'epoch': 26, 'num_users': 6.1667, 'loss': 0.0142, 'hit_ratio@10': 0.8478, 'ndcg@10': 0.9173, 'compress@10': 1.0, 'time@10': 2.7414}:  60%|██████    | 6/10 [00:12<00:09,  2.38s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.9209, 'compress@10': 1.0, 'time@10': 2.8453}:  60%|██████    | 6/10 [00:13<00:09,  2.38s/it]{'epoch': 26, 'num_users': 6.2857, 'loss': 0.0135, 'hit_ratio@10': 0.8638, 'ndcg@10': 0.9209, 'compress@10': 1.0, 'time@10': 2.8453}:  70%|███████   | 7/10 [00:13<00:06,  2.18s/it]{'epoch': 26, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 2.79}:  70%|███████   | 7/10 [00:16<00:06,  2.18s/it]   {'epoch': 26, 'num_users': 6.125, 'loss': 0.0147, 'hit_ratio@10': 0.8773, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 2.79}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9352, 'compress@10': 1.0, 'time@10': 2.9825}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 26, 'num_users': 6.3333, 'loss': 0.0166, 'hit_ratio@10': 0.8687, 'ndcg@10': 0.9352, 'compress@10': 1.0, 'time@10': 2.9825}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9391, 'compress@10': 1.0, 'time@10': 2.9932}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]   {'epoch': 26, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9391, 'compress@10': 1.0, 'time@10': 2.9932}: 100%|██████████| 10/10 [00:21<00:00,  2.54s/it]{'epoch': 26, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8795, 'ndcg@10': 0.9391, 'compress@10': 1.0, 'time@10': 2.9932}: 100%|██████████| 10/10 [00:21<00:00,  2.18s/it]
Epoch: 26
Avg # of users: 6.3
Avg Loss: 0.015675889897077668
Avg hit ratio: 0.8795409466971437
Avg ndcg: 0.9390602364239806
Avg compression ratio: 1.0
Avg train time: 2.993199110031128
Std train time: 0.9182712828136654
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 2.6604}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0213, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 2.6604}:  10%|█         | 1/10 [00:01<00:12,  1.37s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9347, 'compress@10': 1.0, 'time@10': 2.4357}:  10%|█         | 1/10 [00:03<00:12,  1.37s/it]{'epoch': 27, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9347, 'compress@10': 1.0, 'time@10': 2.4357}:  20%|██        | 2/10 [00:03<00:15,  1.88s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9088, 'compress@10': 1.0, 'time@10': 2.1888}:  20%|██        | 2/10 [00:04<00:15,  1.88s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0123, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9088, 'compress@10': 1.0, 'time@10': 2.1888}:  30%|███       | 3/10 [00:04<00:09,  1.43s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 2.1202}:  30%|███       | 3/10 [00:06<00:09,  1.43s/it]{'epoch': 27, 'num_users': 5.0, 'loss': 0.0143, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 2.1202}:  40%|████      | 4/10 [00:06<00:09,  1.63s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.9087, 'compress@10': 1.0, 'time@10': 2.5526}:  40%|████      | 4/10 [00:08<00:09,  1.63s/it]{'epoch': 27, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8282, 'ndcg@10': 0.9087, 'compress@10': 1.0, 'time@10': 2.5526}:  50%|█████     | 5/10 [00:08<00:09,  1.83s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0181, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9182, 'compress@10': 1.0, 'time@10': 2.6568}:  50%|█████     | 5/10 [00:11<00:09,  1.83s/it]{'epoch': 27, 'num_users': 6.1667, 'loss': 0.0181, 'hit_ratio@10': 0.8532, 'ndcg@10': 0.9182, 'compress@10': 1.0, 'time@10': 2.6568}:  60%|██████    | 6/10 [00:11<00:09,  2.30s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9202, 'compress@10': 1.0, 'time@10': 2.7733}:  60%|██████    | 6/10 [00:13<00:09,  2.30s/it]{'epoch': 27, 'num_users': 6.2857, 'loss': 0.0195, 'hit_ratio@10': 0.8684, 'ndcg@10': 0.9202, 'compress@10': 1.0, 'time@10': 2.7733}:  70%|███████   | 7/10 [00:13<00:06,  2.13s/it]{'epoch': 27, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9235, 'compress@10': 1.0, 'time@10': 2.7231}:  70%|███████   | 7/10 [00:16<00:06,  2.13s/it] {'epoch': 27, 'num_users': 6.125, 'loss': 0.0187, 'hit_ratio@10': 0.8813, 'ndcg@10': 0.9235, 'compress@10': 1.0, 'time@10': 2.7231}:  80%|████████  | 8/10 [00:16<00:04,  2.22s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9259, 'compress@10': 1.0, 'time@10': 2.9185}:  80%|████████  | 8/10 [00:18<00:04,  2.22s/it]{'epoch': 27, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9259, 'compress@10': 1.0, 'time@10': 2.9185}:  90%|█████████ | 9/10 [00:18<00:02,  2.24s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.927, 'compress@10': 1.0, 'time@10': 2.9383}:  90%|█████████ | 9/10 [00:21<00:02,  2.24s/it]    {'epoch': 27, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.927, 'compress@10': 1.0, 'time@10': 2.9383}: 100%|██████████| 10/10 [00:21<00:00,  2.52s/it]{'epoch': 27, 'num_users': 6.3, 'loss': 0.0189, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.927, 'compress@10': 1.0, 'time@10': 2.9383}: 100%|██████████| 10/10 [00:21<00:00,  2.15s/it]
Epoch: 27
Avg # of users: 6.3
Avg Loss: 0.0188709855210542
Avg hit ratio: 0.8770524674344709
Avg ndcg: 0.9269593006045251
Avg compression ratio: 1.0
Avg train time: 2.938319516181946
Std train time: 0.8991922725249208
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 2.644}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0183, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9093, 'compress@10': 1.0, 'time@10': 2.644}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 2.4733}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it]{'epoch': 28, 'num_users': 7.0, 'loss': 0.0211, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 2.4733}:  20%|██        | 2/10 [00:03<00:15,  1.93s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9201, 'compress@10': 1.0, 'time@10': 2.2536}:  20%|██        | 2/10 [00:04<00:15,  1.93s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0141, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9201, 'compress@10': 1.0, 'time@10': 2.2536}:  30%|███       | 3/10 [00:04<00:10,  1.48s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9205, 'compress@10': 1.0, 'time@10': 2.1731}:  30%|███       | 3/10 [00:06<00:10,  1.48s/it]{'epoch': 28, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.9205, 'compress@10': 1.0, 'time@10': 2.1731}:  40%|████      | 4/10 [00:06<00:10,  1.67s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.9175, 'compress@10': 1.0, 'time@10': 2.6778}:  40%|████      | 4/10 [00:08<00:10,  1.67s/it]{'epoch': 28, 'num_users': 5.8, 'loss': 0.0167, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.9175, 'compress@10': 1.0, 'time@10': 2.6778}:  50%|█████     | 5/10 [00:08<00:09,  1.93s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0177, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9284, 'compress@10': 1.0, 'time@10': 2.7753}:  50%|█████     | 5/10 [00:12<00:09,  1.93s/it]{'epoch': 28, 'num_users': 6.1667, 'loss': 0.0177, 'hit_ratio@10': 0.8565, 'ndcg@10': 0.9284, 'compress@10': 1.0, 'time@10': 2.7753}:  60%|██████    | 6/10 [00:12<00:09,  2.40s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9284, 'compress@10': 1.0, 'time@10': 2.8816}:  60%|██████    | 6/10 [00:14<00:09,  2.40s/it]{'epoch': 28, 'num_users': 6.2857, 'loss': 0.0179, 'hit_ratio@10': 0.8713, 'ndcg@10': 0.9284, 'compress@10': 1.0, 'time@10': 2.8816}:  70%|███████   | 7/10 [00:14<00:06,  2.21s/it]{'epoch': 28, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 2.8339}:  70%|███████   | 7/10 [00:16<00:06,  2.21s/it] {'epoch': 28, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.8838, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 2.8339}:  80%|████████  | 8/10 [00:16<00:04,  2.32s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.936, 'compress@10': 1.0, 'time@10': 3.0244}:  80%|████████  | 8/10 [00:18<00:04,  2.32s/it]{'epoch': 28, 'num_users': 6.3333, 'loss': 0.0168, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.936, 'compress@10': 1.0, 'time@10': 3.0244}:  90%|█████████ | 9/10 [00:18<00:02,  2.32s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.94, 'compress@10': 1.0, 'time@10': 3.0277}:  90%|█████████ | 9/10 [00:22<00:02,  2.32s/it]    {'epoch': 28, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.94, 'compress@10': 1.0, 'time@10': 3.0277}: 100%|██████████| 10/10 [00:22<00:00,  2.56s/it]{'epoch': 28, 'num_users': 6.3, 'loss': 0.0157, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.94, 'compress@10': 1.0, 'time@10': 3.0277}: 100%|██████████| 10/10 [00:22<00:00,  2.21s/it]
Epoch: 28
Avg # of users: 6.3
Avg Loss: 0.01565896662657368
Avg hit ratio: 0.8790524674344707
Avg ndcg: 0.9400012529357363
Avg compression ratio: 1.0
Avg train time: 3.027744245529175
Std train time: 0.9498293276317986
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 2.685}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0182, 'hit_ratio@10': 0.8947, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 2.685}:  10%|█         | 1/10 [00:01<00:12,  1.39s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9411, 'compress@10': 1.0, 'time@10': 2.4272}:  10%|█         | 1/10 [00:03<00:12,  1.39s/it]{'epoch': 29, 'num_users': 7.0, 'loss': 0.0144, 'hit_ratio@10': 0.8506, 'ndcg@10': 0.9411, 'compress@10': 1.0, 'time@10': 2.4272}:  20%|██        | 2/10 [00:03<00:14,  1.87s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9131, 'compress@10': 1.0, 'time@10': 2.1811}:  20%|██        | 2/10 [00:04<00:14,  1.87s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0096, 'hit_ratio@10': 0.7575, 'ndcg@10': 0.9131, 'compress@10': 1.0, 'time@10': 2.1811}:  30%|███       | 3/10 [00:04<00:09,  1.42s/it]{'epoch': 29, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.917, 'compress@10': 1.0, 'time@10': 2.1126}:  30%|███       | 3/10 [00:06<00:09,  1.42s/it] {'epoch': 29, 'num_users': 5.0, 'loss': 0.0119, 'hit_ratio@10': 0.8003, 'ndcg@10': 0.917, 'compress@10': 1.0, 'time@10': 2.1126}:  40%|████      | 4/10 [00:06<00:09,  1.63s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 2.5727}:  40%|████      | 4/10 [00:08<00:09,  1.63s/it]{'epoch': 29, 'num_users': 5.8, 'loss': 0.0137, 'hit_ratio@10': 0.8322, 'ndcg@10': 0.9144, 'compress@10': 1.0, 'time@10': 2.5727}:  50%|█████     | 5/10 [00:08<00:09,  1.85s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9234, 'compress@10': 1.0, 'time@10': 2.6946}:  50%|█████     | 5/10 [00:12<00:09,  1.85s/it]{'epoch': 29, 'num_users': 6.1667, 'loss': 0.0123, 'hit_ratio@10': 0.8528, 'ndcg@10': 0.9234, 'compress@10': 1.0, 'time@10': 2.6946}:  60%|██████    | 6/10 [00:12<00:09,  2.36s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9274, 'compress@10': 1.0, 'time@10': 2.8123}:  60%|██████    | 6/10 [00:13<00:09,  2.36s/it]{'epoch': 29, 'num_users': 6.2857, 'loss': 0.0117, 'hit_ratio@10': 0.8681, 'ndcg@10': 0.9274, 'compress@10': 1.0, 'time@10': 2.8123}:  70%|███████   | 7/10 [00:13<00:06,  2.17s/it]{'epoch': 29, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 2.7747}:  70%|███████   | 7/10 [00:16<00:06,  2.17s/it]  {'epoch': 29, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9283, 'compress@10': 1.0, 'time@10': 2.7747}:  80%|████████  | 8/10 [00:16<00:04,  2.29s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9378, 'compress@10': 1.0, 'time@10': 2.9705}:  80%|████████  | 8/10 [00:18<00:04,  2.29s/it]{'epoch': 29, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9378, 'compress@10': 1.0, 'time@10': 2.9705}:  90%|█████████ | 9/10 [00:18<00:02,  2.30s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9407, 'compress@10': 1.0, 'time@10': 2.9859}:  90%|█████████ | 9/10 [00:21<00:02,  2.30s/it]   {'epoch': 29, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9407, 'compress@10': 1.0, 'time@10': 2.9859}: 100%|██████████| 10/10 [00:21<00:00,  2.56s/it]{'epoch': 29, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.8768, 'ndcg@10': 0.9407, 'compress@10': 1.0, 'time@10': 2.9859}: 100%|██████████| 10/10 [00:21<00:00,  2.18s/it]
Epoch: 29
Avg # of users: 6.3
Avg Loss: 0.015642588206414232
Avg hit ratio: 0.8768302452122485
Avg ndcg: 0.9407086164629115
Avg compression ratio: 1.0
Avg train time: 2.9858558416366576
Std train time: 0.9313561850411953
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 1.0, 'time@10': 2.6956}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0167, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 1.0, 'time@10': 2.6956}:  10%|█         | 1/10 [00:01<00:12,  1.39s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9387, 'compress@10': 1.0, 'time@10': 2.476}:  10%|█         | 1/10 [00:03<00:12,  1.39s/it]{'epoch': 30, 'num_users': 7.0, 'loss': 0.0111, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9387, 'compress@10': 1.0, 'time@10': 2.476}:  20%|██        | 2/10 [00:03<00:15,  1.92s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 2.2353}:  20%|██        | 2/10 [00:04<00:15,  1.92s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0074, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9115, 'compress@10': 1.0, 'time@10': 2.2353}:  30%|███       | 3/10 [00:04<00:10,  1.46s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9148, 'compress@10': 1.0, 'time@10': 2.1505}:  30%|███       | 3/10 [00:06<00:10,  1.46s/it]{'epoch': 30, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9148, 'compress@10': 1.0, 'time@10': 2.1505}:  40%|████      | 4/10 [00:06<00:09,  1.65s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9138, 'compress@10': 1.0, 'time@10': 2.5825}:  40%|████      | 4/10 [00:08<00:09,  1.65s/it]{'epoch': 30, 'num_users': 5.8, 'loss': 0.0123, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9138, 'compress@10': 1.0, 'time@10': 2.5825}:  50%|█████     | 5/10 [00:08<00:09,  1.84s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9236, 'compress@10': 1.0, 'time@10': 2.6867}:  50%|█████     | 5/10 [00:11<00:09,  1.84s/it]{'epoch': 30, 'num_users': 6.1667, 'loss': 0.0114, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9236, 'compress@10': 1.0, 'time@10': 2.6867}:  60%|██████    | 6/10 [00:11<00:09,  2.32s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9261, 'compress@10': 1.0, 'time@10': 2.8047}:  60%|██████    | 6/10 [00:13<00:09,  2.32s/it]{'epoch': 30, 'num_users': 6.2857, 'loss': 0.0118, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9261, 'compress@10': 1.0, 'time@10': 2.8047}:  70%|███████   | 7/10 [00:13<00:06,  2.15s/it]{'epoch': 30, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9303, 'compress@10': 1.0, 'time@10': 2.7698}:  70%|███████   | 7/10 [00:16<00:06,  2.15s/it] {'epoch': 30, 'num_users': 6.125, 'loss': 0.0118, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9303, 'compress@10': 1.0, 'time@10': 2.7698}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9305, 'compress@10': 1.0, 'time@10': 2.9872}:  80%|████████  | 8/10 [00:18<00:04,  2.28s/it]{'epoch': 30, 'num_users': 6.3333, 'loss': 0.013, 'hit_ratio@10': 0.8668, 'ndcg@10': 0.9305, 'compress@10': 1.0, 'time@10': 2.9872}:  90%|█████████ | 9/10 [00:18<00:02,  2.32s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9348, 'compress@10': 1.0, 'time@10': 2.9992}:  90%|█████████ | 9/10 [00:21<00:02,  2.32s/it]  {'epoch': 30, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9348, 'compress@10': 1.0, 'time@10': 2.9992}: 100%|██████████| 10/10 [00:21<00:00,  2.57s/it]{'epoch': 30, 'num_users': 6.3, 'loss': 0.0126, 'hit_ratio@10': 0.8779, 'ndcg@10': 0.9348, 'compress@10': 1.0, 'time@10': 2.9992}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 30
Avg # of users: 6.3
Avg Loss: 0.012602247549388204
Avg hit ratio: 0.8778870539006363
Avg ndcg: 0.9348419366473424
Avg compression ratio: 1.0
Avg train time: 2.999231767654419
Std train time: 0.9305374950622486
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 1.0, 'time@10': 2.8041}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0184, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.917, 'compress@10': 1.0, 'time@10': 2.8041}:  10%|█         | 1/10 [00:01<00:12,  1.44s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9602, 'compress@10': 1.0, 'time@10': 2.5096}:  10%|█         | 1/10 [00:03<00:12,  1.44s/it]{'epoch': 31, 'num_users': 7.0, 'loss': 0.0218, 'hit_ratio@10': 0.893, 'ndcg@10': 0.9602, 'compress@10': 1.0, 'time@10': 2.5096}:  20%|██        | 2/10 [00:03<00:15,  1.92s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9258, 'compress@10': 1.0, 'time@10': 2.2453}:  20%|██        | 2/10 [00:04<00:15,  1.92s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0146, 'hit_ratio@10': 0.7858, 'ndcg@10': 0.9258, 'compress@10': 1.0, 'time@10': 2.2453}:  30%|███       | 3/10 [00:04<00:10,  1.45s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9256, 'compress@10': 1.0, 'time@10': 2.1831}:  30%|███       | 3/10 [00:06<00:10,  1.45s/it]{'epoch': 31, 'num_users': 5.0, 'loss': 0.0154, 'hit_ratio@10': 0.8126, 'ndcg@10': 0.9256, 'compress@10': 1.0, 'time@10': 2.1831}:  40%|████      | 4/10 [00:06<00:10,  1.68s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9231, 'compress@10': 1.0, 'time@10': 2.6261}:  40%|████      | 4/10 [00:08<00:10,  1.68s/it]{'epoch': 31, 'num_users': 5.8, 'loss': 0.0162, 'hit_ratio@10': 0.8421, 'ndcg@10': 0.9231, 'compress@10': 1.0, 'time@10': 2.6261}:  50%|█████     | 5/10 [00:08<00:09,  1.88s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0158, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 2.7243}:  50%|█████     | 5/10 [00:12<00:09,  1.88s/it]{'epoch': 31, 'num_users': 6.1667, 'loss': 0.0158, 'hit_ratio@10': 0.8647, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 2.7243}:  60%|██████    | 6/10 [00:12<00:09,  2.35s/it]{'epoch': 31, 'num_users': 6.2857, 'loss': 0.0177, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9352, 'compress@10': 1.0, 'time@10': 2.818}:  60%|██████    | 6/10 [00:13<00:09,  2.35s/it] {'epoch': 31, 'num_users': 6.2857, 'loss': 0.0177, 'hit_ratio@10': 0.8726, 'ndcg@10': 0.9352, 'compress@10': 1.0, 'time@10': 2.818}:  70%|███████   | 7/10 [00:13<00:06,  2.14s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9382, 'compress@10': 1.0, 'time@10': 2.7733}:  70%|███████   | 7/10 [00:16<00:06,  2.14s/it]{'epoch': 31, 'num_users': 6.125, 'loss': 0.0169, 'hit_ratio@10': 0.8849, 'ndcg@10': 0.9382, 'compress@10': 1.0, 'time@10': 2.7733}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9413, 'compress@10': 1.0, 'time@10': 2.9633}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 31, 'num_users': 6.3333, 'loss': 0.016, 'hit_ratio@10': 0.8755, 'ndcg@10': 0.9413, 'compress@10': 1.0, 'time@10': 2.9633}:  90%|█████████ | 9/10 [00:18<00:02,  2.26s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9464, 'compress@10': 1.0, 'time@10': 2.991}:  90%|█████████ | 9/10 [00:21<00:02,  2.26s/it]   {'epoch': 31, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9464, 'compress@10': 1.0, 'time@10': 2.991}: 100%|██████████| 10/10 [00:21<00:00,  2.58s/it]{'epoch': 31, 'num_users': 6.3, 'loss': 0.0183, 'hit_ratio@10': 0.8857, 'ndcg@10': 0.9464, 'compress@10': 1.0, 'time@10': 2.991}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 31
Avg # of users: 6.3
Avg Loss: 0.018256842897286997
Avg hit ratio: 0.8856842889236777
Avg ndcg: 0.9463765968512545
Avg compression ratio: 1.0
Avg train time: 2.990995407104492
Std train time: 0.8944403339212218
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 2.7098}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 2.7098}:  10%|█         | 1/10 [00:01<00:12,  1.39s/it]{'epoch': 32, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9713, 'compress@10': 1.0, 'time@10': 2.461}:  10%|█         | 1/10 [00:03<00:12,  1.39s/it] {'epoch': 32, 'num_users': 7.0, 'loss': 0.0205, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9713, 'compress@10': 1.0, 'time@10': 2.461}:  20%|██        | 2/10 [00:03<00:15,  1.90s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9333, 'compress@10': 1.0, 'time@10': 2.2182}:  20%|██        | 2/10 [00:04<00:15,  1.90s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.0137, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9333, 'compress@10': 1.0, 'time@10': 2.2182}:  30%|███       | 3/10 [00:04<00:10,  1.44s/it]{'epoch': 32, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.9357, 'compress@10': 1.0, 'time@10': 2.1495}:  30%|███       | 3/10 [00:06<00:10,  1.44s/it] {'epoch': 32, 'num_users': 5.0, 'loss': 0.014, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.9357, 'compress@10': 1.0, 'time@10': 2.1495}:  40%|████      | 4/10 [00:06<00:09,  1.66s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.9333, 'compress@10': 1.0, 'time@10': 2.5853}:  40%|████      | 4/10 [00:08<00:09,  1.66s/it]{'epoch': 32, 'num_users': 5.8, 'loss': 0.0148, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.9333, 'compress@10': 1.0, 'time@10': 2.5853}:  50%|█████     | 5/10 [00:08<00:09,  1.85s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9402, 'compress@10': 1.0, 'time@10': 2.6873}:  50%|█████     | 5/10 [00:11<00:09,  1.85s/it]{'epoch': 32, 'num_users': 6.1667, 'loss': 0.0187, 'hit_ratio@10': 0.8502, 'ndcg@10': 0.9402, 'compress@10': 1.0, 'time@10': 2.6873}:  60%|██████    | 6/10 [00:11<00:09,  2.32s/it]{'epoch': 32, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9408, 'compress@10': 1.0, 'time@10': 2.8056}:  60%|██████    | 6/10 [00:13<00:09,  2.32s/it] {'epoch': 32, 'num_users': 6.2857, 'loss': 0.018, 'hit_ratio@10': 0.8659, 'ndcg@10': 0.9408, 'compress@10': 1.0, 'time@10': 2.8056}:  70%|███████   | 7/10 [00:13<00:06,  2.15s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9431, 'compress@10': 1.0, 'time@10': 2.7613}:  70%|███████   | 7/10 [00:16<00:06,  2.15s/it]{'epoch': 32, 'num_users': 6.125, 'loss': 0.0171, 'hit_ratio@10': 0.8791, 'ndcg@10': 0.9431, 'compress@10': 1.0, 'time@10': 2.7613}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9495, 'compress@10': 1.0, 'time@10': 2.9487}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 32, 'num_users': 6.3333, 'loss': 0.0182, 'hit_ratio@10': 0.8671, 'ndcg@10': 0.9495, 'compress@10': 1.0, 'time@10': 2.9487}:  90%|█████████ | 9/10 [00:18<00:02,  2.26s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9508, 'compress@10': 1.0, 'time@10': 2.9636}:  90%|█████████ | 9/10 [00:21<00:02,  2.26s/it]   {'epoch': 32, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9508, 'compress@10': 1.0, 'time@10': 2.9636}: 100%|██████████| 10/10 [00:21<00:00,  2.53s/it]{'epoch': 32, 'num_users': 6.3, 'loss': 0.0181, 'hit_ratio@10': 0.8782, 'ndcg@10': 0.9508, 'compress@10': 1.0, 'time@10': 2.9636}: 100%|██████████| 10/10 [00:21<00:00,  2.17s/it]
Epoch: 32
Avg # of users: 6.3
Avg Loss: 0.018094213087437673
Avg hit ratio: 0.878153310941087
Avg ndcg: 0.9507831048923455
Avg compression ratio: 1.0
Avg train time: 2.96356406211853
Std train time: 0.8883214021718039
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 1.0, 'time@10': 2.6507}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 1.0, 'time@10': 2.6507}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9421, 'compress@10': 1.0, 'time@10': 2.4228}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it]{'epoch': 33, 'num_users': 7.0, 'loss': 0.0095, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9421, 'compress@10': 1.0, 'time@10': 2.4228}:  20%|██        | 2/10 [00:03<00:14,  1.87s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9138, 'compress@10': 1.0, 'time@10': 2.2129}:  20%|██        | 2/10 [00:04<00:14,  1.87s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9138, 'compress@10': 1.0, 'time@10': 2.2129}:  30%|███       | 3/10 [00:04<00:10,  1.44s/it]{'epoch': 33, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 2.1376}:  30%|███       | 3/10 [00:06<00:10,  1.44s/it] {'epoch': 33, 'num_users': 5.0, 'loss': 0.009, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9191, 'compress@10': 1.0, 'time@10': 2.1376}:  40%|████      | 4/10 [00:06<00:09,  1.64s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9202, 'compress@10': 1.0, 'time@10': 2.5793}:  40%|████      | 4/10 [00:08<00:09,  1.64s/it]{'epoch': 33, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9202, 'compress@10': 1.0, 'time@10': 2.5793}:  50%|█████     | 5/10 [00:08<00:09,  1.85s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9294, 'compress@10': 1.0, 'time@10': 2.6883}:  50%|█████     | 5/10 [00:11<00:09,  1.85s/it]{'epoch': 33, 'num_users': 6.1667, 'loss': 0.0095, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9294, 'compress@10': 1.0, 'time@10': 2.6883}:  60%|██████    | 6/10 [00:11<00:09,  2.33s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9324, 'compress@10': 1.0, 'time@10': 2.8176}:  60%|██████    | 6/10 [00:13<00:09,  2.33s/it]{'epoch': 33, 'num_users': 6.2857, 'loss': 0.0089, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9324, 'compress@10': 1.0, 'time@10': 2.8176}:  70%|███████   | 7/10 [00:13<00:06,  2.17s/it]{'epoch': 33, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9363, 'compress@10': 1.0, 'time@10': 2.7644}:  70%|███████   | 7/10 [00:16<00:06,  2.17s/it]  {'epoch': 33, 'num_users': 6.125, 'loss': 0.0089, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9363, 'compress@10': 1.0, 'time@10': 2.7644}:  80%|████████  | 8/10 [00:16<00:04,  2.25s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9406, 'compress@10': 1.0, 'time@10': 2.9588}:  80%|████████  | 8/10 [00:18<00:04,  2.25s/it]{'epoch': 33, 'num_users': 6.3333, 'loss': 0.0129, 'hit_ratio@10': 0.8708, 'ndcg@10': 0.9406, 'compress@10': 1.0, 'time@10': 2.9588}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.944, 'compress@10': 1.0, 'time@10': 2.9766}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]    {'epoch': 33, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.944, 'compress@10': 1.0, 'time@10': 2.9766}: 100%|██████████| 10/10 [00:21<00:00,  2.55s/it]{'epoch': 33, 'num_users': 6.3, 'loss': 0.0125, 'hit_ratio@10': 0.8815, 'ndcg@10': 0.944, 'compress@10': 1.0, 'time@10': 2.9766}: 100%|██████████| 10/10 [00:21<00:00,  2.17s/it]
Epoch: 33
Avg # of users: 6.3
Avg Loss: 0.012530593929259416
Avg hit ratio: 0.8814815239467192
Avg ndcg: 0.9440099106165671
Avg compression ratio: 1.0
Avg train time: 2.9765720129013062
Std train time: 0.9113885229153377
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 1.0, 'time@10': 2.5694}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 34, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9212, 'compress@10': 1.0, 'time@10': 2.5694}:  10%|█         | 1/10 [00:01<00:11,  1.32s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0096, 'compress@10': 1.0, 'time@10': 2.3835}:  10%|█         | 1/10 [00:03<00:11,  1.32s/it]{'epoch': 34, 'num_users': 7.0, 'loss': 0.0238, 'hit_ratio@10': 0.893, 'ndcg@10': 1.0096, 'compress@10': 1.0, 'time@10': 2.3835}:  20%|██        | 2/10 [00:03<00:14,  1.86s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9588, 'compress@10': 1.0, 'time@10': 2.1901}:  20%|██        | 2/10 [00:04<00:14,  1.86s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0159, 'hit_ratio@10': 0.8335, 'ndcg@10': 0.9588, 'compress@10': 1.0, 'time@10': 2.1901}:  30%|███       | 3/10 [00:04<00:10,  1.44s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9592, 'compress@10': 1.0, 'time@10': 2.1552}:  30%|███       | 3/10 [00:06<00:10,  1.44s/it]{'epoch': 34, 'num_users': 5.0, 'loss': 0.0171, 'hit_ratio@10': 0.8572, 'ndcg@10': 0.9592, 'compress@10': 1.0, 'time@10': 2.1552}:  40%|████      | 4/10 [00:06<00:10,  1.69s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9515, 'compress@10': 1.0, 'time@10': 2.6122}:  40%|████      | 4/10 [00:08<00:10,  1.69s/it]{'epoch': 34, 'num_users': 5.8, 'loss': 0.0171, 'hit_ratio@10': 0.8778, 'ndcg@10': 0.9515, 'compress@10': 1.0, 'time@10': 2.6122}:  50%|█████     | 5/10 [00:08<00:09,  1.90s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9539, 'compress@10': 1.0, 'time@10': 2.7351}:  50%|█████     | 5/10 [00:12<00:09,  1.90s/it]{'epoch': 34, 'num_users': 6.1667, 'loss': 0.0169, 'hit_ratio@10': 0.8945, 'ndcg@10': 0.9539, 'compress@10': 1.0, 'time@10': 2.7351}:  60%|██████    | 6/10 [00:12<00:09,  2.40s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0161, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9534, 'compress@10': 1.0, 'time@10': 2.8387}:  60%|██████    | 6/10 [00:13<00:09,  2.40s/it]{'epoch': 34, 'num_users': 6.2857, 'loss': 0.0161, 'hit_ratio@10': 0.9038, 'ndcg@10': 0.9534, 'compress@10': 1.0, 'time@10': 2.8387}:  70%|███████   | 7/10 [00:13<00:06,  2.20s/it]{'epoch': 34, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9537, 'compress@10': 1.0, 'time@10': 2.7868}:  70%|███████   | 7/10 [00:16<00:06,  2.20s/it] {'epoch': 34, 'num_users': 6.125, 'loss': 0.0159, 'hit_ratio@10': 0.9123, 'ndcg@10': 0.9537, 'compress@10': 1.0, 'time@10': 2.7868}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9517, 'compress@10': 1.0, 'time@10': 2.9693}:  80%|████████  | 8/10 [00:18<00:04,  2.28s/it]{'epoch': 34, 'num_users': 6.3333, 'loss': 0.0189, 'hit_ratio@10': 0.8966, 'ndcg@10': 0.9517, 'compress@10': 1.0, 'time@10': 2.9693}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9542, 'compress@10': 1.0, 'time@10': 2.9811}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]   {'epoch': 34, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9542, 'compress@10': 1.0, 'time@10': 2.9811}: 100%|██████████| 10/10 [00:21<00:00,  2.54s/it]{'epoch': 34, 'num_users': 6.3, 'loss': 0.0176, 'hit_ratio@10': 0.9047, 'ndcg@10': 0.9542, 'compress@10': 1.0, 'time@10': 2.9811}: 100%|██████████| 10/10 [00:21<00:00,  2.18s/it]
Epoch: 34
Avg # of users: 6.3
Avg Loss: 0.01763965931399902
Avg hit ratio: 0.9046842889236777
Avg ndcg: 0.9541550095772978
Avg compression ratio: 1.0
Avg train time: 2.9810696840286255
Std train time: 0.8917050576153058
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9243, 'compress@10': 1.0, 'time@10': 2.7319}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0145, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9243, 'compress@10': 1.0, 'time@10': 2.7319}:  10%|█         | 1/10 [00:01<00:12,  1.40s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9436, 'compress@10': 1.0, 'time@10': 2.4601}:  10%|█         | 1/10 [00:03<00:12,  1.40s/it]{'epoch': 35, 'num_users': 7.0, 'loss': 0.0097, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9436, 'compress@10': 1.0, 'time@10': 2.4601}:  20%|██        | 2/10 [00:03<00:15,  1.89s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9148, 'compress@10': 1.0, 'time@10': 2.2224}:  20%|██        | 2/10 [00:04<00:15,  1.89s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9148, 'compress@10': 1.0, 'time@10': 2.2224}:  30%|███       | 3/10 [00:04<00:10,  1.44s/it]{'epoch': 35, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 2.142}:  30%|███       | 3/10 [00:06<00:10,  1.44s/it] {'epoch': 35, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9223, 'compress@10': 1.0, 'time@10': 2.142}:  40%|████      | 4/10 [00:06<00:09,  1.64s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 2.5753}:  40%|████      | 4/10 [00:08<00:09,  1.64s/it]{'epoch': 35, 'num_users': 5.8, 'loss': 0.0105, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9221, 'compress@10': 1.0, 'time@10': 2.5753}:  50%|█████     | 5/10 [00:08<00:09,  1.84s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9351, 'compress@10': 1.0, 'time@10': 2.6901}:  50%|█████     | 5/10 [00:11<00:09,  1.84s/it]{'epoch': 35, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9351, 'compress@10': 1.0, 'time@10': 2.6901}:  60%|██████    | 6/10 [00:11<00:09,  2.33s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9419, 'compress@10': 1.0, 'time@10': 2.8043}:  60%|██████    | 6/10 [00:13<00:09,  2.33s/it]{'epoch': 35, 'num_users': 6.2857, 'loss': 0.0153, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9419, 'compress@10': 1.0, 'time@10': 2.8043}:  70%|███████   | 7/10 [00:13<00:06,  2.15s/it]{'epoch': 35, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9407, 'compress@10': 1.0, 'time@10': 2.761}:  70%|███████   | 7/10 [00:16<00:06,  2.15s/it]  {'epoch': 35, 'num_users': 6.125, 'loss': 0.0158, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.9407, 'compress@10': 1.0, 'time@10': 2.761}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9601, 'compress@10': 1.0, 'time@10': 2.9654}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 35, 'num_users': 6.3333, 'loss': 0.0188, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9601, 'compress@10': 1.0, 'time@10': 2.9654}:  90%|█████████ | 9/10 [00:18<00:02,  2.28s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9608, 'compress@10': 1.0, 'time@10': 2.9791}:  90%|█████████ | 9/10 [00:21<00:02,  2.28s/it]       {'epoch': 35, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9608, 'compress@10': 1.0, 'time@10': 2.9791}: 100%|██████████| 10/10 [00:21<00:00,  2.55s/it]{'epoch': 35, 'num_users': 6.3, 'loss': 0.018, 'hit_ratio@10': 0.9, 'ndcg@10': 0.9608, 'compress@10': 1.0, 'time@10': 2.9791}: 100%|██████████| 10/10 [00:21<00:00,  2.17s/it]
Epoch: 35
Avg # of users: 6.3
Avg Loss: 0.017991779417748342
Avg hit ratio: 0.8999735874387828
Avg ndcg: 0.9607897755398049
Avg compression ratio: 1.0
Avg train time: 2.979092812538147
Std train time: 0.9161199309560386
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9176, 'compress@10': 1.0, 'time@10': 2.7417}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0119, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9176, 'compress@10': 1.0, 'time@10': 2.7417}:  10%|█         | 1/10 [00:01<00:12,  1.43s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9766, 'compress@10': 1.0, 'time@10': 2.5128}:  10%|█         | 1/10 [00:03<00:12,  1.43s/it]{'epoch': 36, 'num_users': 7.0, 'loss': 0.0194, 'hit_ratio@10': 0.8608, 'ndcg@10': 0.9766, 'compress@10': 1.0, 'time@10': 2.5128}:  20%|██        | 2/10 [00:03<00:15,  1.95s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9368, 'compress@10': 1.0, 'time@10': 2.2824}:  20%|██        | 2/10 [00:04<00:15,  1.95s/it] {'epoch': 36, 'num_users': 5.0, 'loss': 0.013, 'hit_ratio@10': 0.7643, 'ndcg@10': 0.9368, 'compress@10': 1.0, 'time@10': 2.2824}:  30%|███       | 3/10 [00:04<00:10,  1.49s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.941, 'compress@10': 1.0, 'time@10': 2.1934}:  30%|███       | 3/10 [00:06<00:10,  1.49s/it]{'epoch': 36, 'num_users': 5.0, 'loss': 0.0128, 'hit_ratio@10': 0.7965, 'ndcg@10': 0.941, 'compress@10': 1.0, 'time@10': 2.1934}:  40%|████      | 4/10 [00:06<00:10,  1.68s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.9395, 'compress@10': 1.0, 'time@10': 2.6221}:  40%|████      | 4/10 [00:08<00:10,  1.68s/it]{'epoch': 36, 'num_users': 5.8, 'loss': 0.0132, 'hit_ratio@10': 0.8292, 'ndcg@10': 0.9395, 'compress@10': 1.0, 'time@10': 2.6221}:  50%|█████     | 5/10 [00:08<00:09,  1.87s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9455, 'compress@10': 1.0, 'time@10': 2.718}:  50%|█████     | 5/10 [00:12<00:09,  1.87s/it]{'epoch': 36, 'num_users': 6.1667, 'loss': 0.0119, 'hit_ratio@10': 0.8539, 'ndcg@10': 0.9455, 'compress@10': 1.0, 'time@10': 2.718}:  60%|██████    | 6/10 [00:12<00:09,  2.33s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9451, 'compress@10': 1.0, 'time@10': 2.8581}:  60%|██████    | 6/10 [00:13<00:09,  2.33s/it]{'epoch': 36, 'num_users': 6.2857, 'loss': 0.0128, 'hit_ratio@10': 0.8634, 'ndcg@10': 0.9451, 'compress@10': 1.0, 'time@10': 2.8581}:  70%|███████   | 7/10 [00:13<00:06,  2.19s/it]{'epoch': 36, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 2.8219}:  70%|███████   | 7/10 [00:16<00:06,  2.19s/it] {'epoch': 36, 'num_users': 6.125, 'loss': 0.0117, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9474, 'compress@10': 1.0, 'time@10': 2.8219}:  80%|████████  | 8/10 [00:16<00:04,  2.32s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9499, 'compress@10': 1.0, 'time@10': 3.024}:  80%|████████  | 8/10 [00:18<00:04,  2.32s/it]{'epoch': 36, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8683, 'ndcg@10': 0.9499, 'compress@10': 1.0, 'time@10': 3.024}:  90%|█████████ | 9/10 [00:18<00:02,  2.33s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9525, 'compress@10': 1.0, 'time@10': 3.0317}:  90%|█████████ | 9/10 [00:22<00:02,  2.33s/it]  {'epoch': 36, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9525, 'compress@10': 1.0, 'time@10': 3.0317}: 100%|██████████| 10/10 [00:22<00:00,  2.58s/it]{'epoch': 36, 'num_users': 6.3, 'loss': 0.0129, 'hit_ratio@10': 0.8792, 'ndcg@10': 0.9525, 'compress@10': 1.0, 'time@10': 3.0317}: 100%|██████████| 10/10 [00:22<00:00,  2.21s/it]
Epoch: 36
Avg # of users: 6.3
Avg Loss: 0.012856521049115444
Avg hit ratio: 0.8792326760204519
Avg ndcg: 0.9525386534269659
Avg compression ratio: 1.0
Avg train time: 3.0316779613494873
Std train time: 0.91176370205697
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9002, 'compress@10': 1.0, 'time@10': 2.6031}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0177, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9002, 'compress@10': 1.0, 'time@10': 2.6031}:  10%|█         | 1/10 [00:01<00:12,  1.34s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9315, 'compress@10': 1.0, 'time@10': 2.4074}:  10%|█         | 1/10 [00:03<00:12,  1.34s/it]{'epoch': 37, 'num_users': 7.0, 'loss': 0.0129, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9315, 'compress@10': 1.0, 'time@10': 2.4074}:  20%|██        | 2/10 [00:03<00:14,  1.87s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 2.1739}:  20%|██        | 2/10 [00:04<00:14,  1.87s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.0087, 'hit_ratio@10': 0.855, 'ndcg@10': 0.9067, 'compress@10': 1.0, 'time@10': 2.1739}:  30%|███       | 3/10 [00:04<00:09,  1.42s/it]{'epoch': 37, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9168, 'compress@10': 1.0, 'time@10': 2.11}:  30%|███       | 3/10 [00:06<00:09,  1.42s/it] {'epoch': 37, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8734, 'ndcg@10': 0.9168, 'compress@10': 1.0, 'time@10': 2.11}:  40%|████      | 4/10 [00:06<00:09,  1.63s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9201, 'compress@10': 1.0, 'time@10': 2.5609}:  40%|████      | 4/10 [00:08<00:09,  1.63s/it]{'epoch': 37, 'num_users': 5.8, 'loss': 0.0115, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9201, 'compress@10': 1.0, 'time@10': 2.5609}:  50%|█████     | 5/10 [00:08<00:09,  1.84s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9342, 'compress@10': 1.0, 'time@10': 2.676}:  50%|█████     | 5/10 [00:11<00:09,  1.84s/it]{'epoch': 37, 'num_users': 6.1667, 'loss': 0.0139, 'hit_ratio@10': 0.9052, 'ndcg@10': 0.9342, 'compress@10': 1.0, 'time@10': 2.676}:  60%|██████    | 6/10 [00:11<00:09,  2.34s/it]{'epoch': 37, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9373, 'compress@10': 1.0, 'time@10': 2.7967}:  60%|██████    | 6/10 [00:13<00:09,  2.34s/it] {'epoch': 37, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.913, 'ndcg@10': 0.9373, 'compress@10': 1.0, 'time@10': 2.7967}:  70%|███████   | 7/10 [00:13<00:06,  2.16s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9376, 'compress@10': 1.0, 'time@10': 2.7597}:  70%|███████   | 7/10 [00:16<00:06,  2.16s/it]{'epoch': 37, 'num_users': 6.125, 'loss': 0.0132, 'hit_ratio@10': 0.9203, 'ndcg@10': 0.9376, 'compress@10': 1.0, 'time@10': 2.7597}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 2.9646}:  80%|████████  | 8/10 [00:18<00:04,  2.28s/it]{'epoch': 37, 'num_users': 6.3333, 'loss': 0.0146, 'hit_ratio@10': 0.8974, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 2.9646}:  90%|█████████ | 9/10 [00:18<00:02,  2.30s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9527, 'compress@10': 1.0, 'time@10': 2.9733}:  90%|█████████ | 9/10 [00:21<00:02,  2.30s/it]   {'epoch': 37, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9527, 'compress@10': 1.0, 'time@10': 2.9733}: 100%|██████████| 10/10 [00:21<00:00,  2.54s/it]{'epoch': 37, 'num_users': 6.3, 'loss': 0.0159, 'hit_ratio@10': 0.9054, 'ndcg@10': 0.9527, 'compress@10': 1.0, 'time@10': 2.9733}: 100%|██████████| 10/10 [00:21<00:00,  2.17s/it]
Epoch: 37
Avg # of users: 6.3
Avg Loss: 0.015888497478834963
Avg hit ratio: 0.9054216161126177
Avg ndcg: 0.9526752364572811
Avg compression ratio: 1.0
Avg train time: 2.973332953453064
Std train time: 0.9292778266353086
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9117, 'compress@10': 1.0, 'time@10': 2.7969}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0143, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9117, 'compress@10': 1.0, 'time@10': 2.7969}:  10%|█         | 1/10 [00:01<00:12,  1.43s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9759, 'compress@10': 1.0, 'time@10': 2.5159}:  10%|█         | 1/10 [00:03<00:12,  1.43s/it]{'epoch': 38, 'num_users': 7.0, 'loss': 0.0229, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9759, 'compress@10': 1.0, 'time@10': 2.5159}:  20%|██        | 2/10 [00:03<00:15,  1.93s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9363, 'compress@10': 1.0, 'time@10': 2.2534}:  20%|██        | 2/10 [00:04<00:15,  1.93s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0153, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9363, 'compress@10': 1.0, 'time@10': 2.2534}:  30%|███       | 3/10 [00:04<00:10,  1.46s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9389, 'compress@10': 1.0, 'time@10': 2.1925}:  30%|███       | 3/10 [00:06<00:10,  1.46s/it]{'epoch': 38, 'num_users': 5.0, 'loss': 0.0158, 'hit_ratio@10': 0.8135, 'ndcg@10': 0.9389, 'compress@10': 1.0, 'time@10': 2.1925}:  40%|████      | 4/10 [00:06<00:10,  1.69s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9389, 'compress@10': 1.0, 'time@10': 2.6348}:  40%|████      | 4/10 [00:08<00:10,  1.69s/it]{'epoch': 38, 'num_users': 5.8, 'loss': 0.0155, 'hit_ratio@10': 0.8428, 'ndcg@10': 0.9389, 'compress@10': 1.0, 'time@10': 2.6348}:  50%|█████     | 5/10 [00:08<00:09,  1.89s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9448, 'compress@10': 1.0, 'time@10': 2.7337}:  50%|█████     | 5/10 [00:12<00:09,  1.89s/it]{'epoch': 38, 'num_users': 6.1667, 'loss': 0.0143, 'hit_ratio@10': 0.8616, 'ndcg@10': 0.9448, 'compress@10': 1.0, 'time@10': 2.7337}:  60%|██████    | 6/10 [00:12<00:09,  2.36s/it]{'epoch': 38, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9466, 'compress@10': 1.0, 'time@10': 2.851}:  60%|██████    | 6/10 [00:13<00:09,  2.36s/it]  {'epoch': 38, 'num_users': 6.2857, 'loss': 0.013, 'hit_ratio@10': 0.8756, 'ndcg@10': 0.9466, 'compress@10': 1.0, 'time@10': 2.851}:  70%|███████   | 7/10 [00:13<00:06,  2.18s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9448, 'compress@10': 1.0, 'time@10': 2.7981}:  70%|███████   | 7/10 [00:16<00:06,  2.18s/it]{'epoch': 38, 'num_users': 6.125, 'loss': 0.0142, 'hit_ratio@10': 0.8876, 'ndcg@10': 0.9448, 'compress@10': 1.0, 'time@10': 2.7981}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 38, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9458, 'compress@10': 1.0, 'time@10': 2.986}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it] {'epoch': 38, 'num_users': 6.3333, 'loss': 0.0143, 'hit_ratio@10': 0.881, 'ndcg@10': 0.9458, 'compress@10': 1.0, 'time@10': 2.986}:  90%|█████████ | 9/10 [00:18<00:02,  2.27s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9488, 'compress@10': 1.0, 'time@10': 3.0095}:  90%|█████████ | 9/10 [00:21<00:02,  2.27s/it]  {'epoch': 38, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9488, 'compress@10': 1.0, 'time@10': 3.0095}: 100%|██████████| 10/10 [00:21<00:00,  2.58s/it]{'epoch': 38, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8907, 'ndcg@10': 0.9488, 'compress@10': 1.0, 'time@10': 3.0095}: 100%|██████████| 10/10 [00:21<00:00,  2.20s/it]
Epoch: 38
Avg # of users: 6.3
Avg Loss: 0.013004615639391093
Avg hit ratio: 0.890664831678414
Avg ndcg: 0.9488100213867444
Avg compression ratio: 1.0
Avg train time: 3.009538722038269
Std train time: 0.9027237822253014
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9138, 'compress@10': 1.0, 'time@10': 2.5864}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 39, 'num_users': 7.0, 'loss': 0.014, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9138, 'compress@10': 1.0, 'time@10': 2.5864}:  10%|█         | 1/10 [00:01<00:11,  1.33s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9416, 'compress@10': 1.0, 'time@10': 2.4091}:  10%|█         | 1/10 [00:03<00:11,  1.33s/it]{'epoch': 39, 'num_users': 7.0, 'loss': 0.0132, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9416, 'compress@10': 1.0, 'time@10': 2.4091}:  20%|██        | 2/10 [00:03<00:15,  1.88s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9135, 'compress@10': 1.0, 'time@10': 2.1845}:  20%|██        | 2/10 [00:04<00:15,  1.88s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0089, 'hit_ratio@10': 0.8442, 'ndcg@10': 0.9135, 'compress@10': 1.0, 'time@10': 2.1845}:  30%|███       | 3/10 [00:04<00:10,  1.43s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 2.1184}:  30%|███       | 3/10 [00:06<00:10,  1.43s/it]{'epoch': 39, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.8653, 'ndcg@10': 0.9237, 'compress@10': 1.0, 'time@10': 2.1184}:  40%|████      | 4/10 [00:06<00:09,  1.64s/it]{'epoch': 39, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9264, 'compress@10': 1.0, 'time@10': 2.564}:  40%|████      | 4/10 [00:08<00:09,  1.64s/it] {'epoch': 39, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9264, 'compress@10': 1.0, 'time@10': 2.564}:  50%|█████     | 5/10 [00:08<00:09,  1.85s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.937, 'compress@10': 1.0, 'time@10': 2.6899}:  50%|█████     | 5/10 [00:12<00:09,  1.85s/it]{'epoch': 39, 'num_users': 6.1667, 'loss': 0.0131, 'hit_ratio@10': 0.8998, 'ndcg@10': 0.937, 'compress@10': 1.0, 'time@10': 2.6899}:  60%|██████    | 6/10 [00:12<00:09,  2.37s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9464, 'compress@10': 1.0, 'time@10': 2.8082}:  60%|██████    | 6/10 [00:13<00:09,  2.37s/it]{'epoch': 39, 'num_users': 6.2857, 'loss': 0.0146, 'hit_ratio@10': 0.9084, 'ndcg@10': 0.9464, 'compress@10': 1.0, 'time@10': 2.8082}:  70%|███████   | 7/10 [00:13<00:06,  2.19s/it]{'epoch': 39, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9491, 'compress@10': 1.0, 'time@10': 2.7568}:  70%|███████   | 7/10 [00:16<00:06,  2.19s/it] {'epoch': 39, 'num_users': 6.125, 'loss': 0.0133, 'hit_ratio@10': 0.9163, 'ndcg@10': 0.9491, 'compress@10': 1.0, 'time@10': 2.7568}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 39, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9647, 'compress@10': 1.0, 'time@10': 2.942}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it] {'epoch': 39, 'num_users': 6.3333, 'loss': 0.015, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9647, 'compress@10': 1.0, 'time@10': 2.942}:  90%|█████████ | 9/10 [00:18<00:02,  2.26s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0169, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9607, 'compress@10': 1.0, 'time@10': 2.9614}:  90%|█████████ | 9/10 [00:21<00:02,  2.26s/it] {'epoch': 39, 'num_users': 6.3, 'loss': 0.0169, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9607, 'compress@10': 1.0, 'time@10': 2.9614}: 100%|██████████| 10/10 [00:21<00:00,  2.54s/it]{'epoch': 39, 'num_users': 6.3, 'loss': 0.0169, 'hit_ratio@10': 0.9022, 'ndcg@10': 0.9607, 'compress@10': 1.0, 'time@10': 2.9614}: 100%|██████████| 10/10 [00:21<00:00,  2.17s/it]
Epoch: 39
Avg # of users: 6.3
Avg Loss: 0.01690917396870447
Avg hit ratio: 0.9021958096610048
Avg ndcg: 0.960678260574222
Avg compression ratio: 1.0
Avg train time: 2.9614123344421386
Std train time: 0.900268697149587
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 2.6341}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 2.6341}:  10%|█         | 1/10 [00:01<00:12,  1.35s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9429, 'compress@10': 1.0, 'time@10': 2.4157}:  10%|█         | 1/10 [00:03<00:12,  1.35s/it]{'epoch': 40, 'num_users': 7.0, 'loss': 0.0077, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9429, 'compress@10': 1.0, 'time@10': 2.4157}:  20%|██        | 2/10 [00:03<00:14,  1.87s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 2.1726}:  20%|██        | 2/10 [00:04<00:14,  1.87s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0052, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 2.1726}:  30%|███       | 3/10 [00:04<00:09,  1.42s/it]{'epoch': 40, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 2.112}:  30%|███       | 3/10 [00:06<00:09,  1.42s/it] {'epoch': 40, 'num_users': 5.0, 'loss': 0.0071, 'hit_ratio@10': 0.8376, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 2.112}:  40%|████      | 4/10 [00:06<00:09,  1.63s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0083, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9279, 'compress@10': 1.0, 'time@10': 2.5463}:  40%|████      | 4/10 [00:08<00:09,  1.63s/it]{'epoch': 40, 'num_users': 5.8, 'loss': 0.0083, 'hit_ratio@10': 0.8621, 'ndcg@10': 0.9279, 'compress@10': 1.0, 'time@10': 2.5463}:  50%|█████     | 5/10 [00:08<00:09,  1.83s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 2.6661}:  50%|█████     | 5/10 [00:11<00:09,  1.83s/it]{'epoch': 40, 'num_users': 6.1667, 'loss': 0.0074, 'hit_ratio@10': 0.8814, 'ndcg@10': 0.9359, 'compress@10': 1.0, 'time@10': 2.6661}:  60%|██████    | 6/10 [00:11<00:09,  2.33s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0084, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9381, 'compress@10': 1.0, 'time@10': 2.7997}:  60%|██████    | 6/10 [00:13<00:09,  2.33s/it]{'epoch': 40, 'num_users': 6.2857, 'loss': 0.0084, 'hit_ratio@10': 0.8926, 'ndcg@10': 0.9381, 'compress@10': 1.0, 'time@10': 2.7997}:  70%|███████   | 7/10 [00:13<00:06,  2.17s/it]{'epoch': 40, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9344, 'compress@10': 1.0, 'time@10': 2.7533}:  70%|███████   | 7/10 [00:16<00:06,  2.17s/it] {'epoch': 40, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.9025, 'ndcg@10': 0.9344, 'compress@10': 1.0, 'time@10': 2.7533}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9328, 'compress@10': 1.0, 'time@10': 2.9506}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it]{'epoch': 40, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.8911, 'ndcg@10': 0.9328, 'compress@10': 1.0, 'time@10': 2.9506}:  90%|█████████ | 9/10 [00:18<00:02,  2.28s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9371, 'compress@10': 1.0, 'time@10': 2.9563}:  90%|█████████ | 9/10 [00:21<00:02,  2.28s/it]   {'epoch': 40, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9371, 'compress@10': 1.0, 'time@10': 2.9563}: 100%|██████████| 10/10 [00:21<00:00,  2.51s/it]{'epoch': 40, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8997, 'ndcg@10': 0.9371, 'compress@10': 1.0, 'time@10': 2.9563}: 100%|██████████| 10/10 [00:21<00:00,  2.16s/it]
Epoch: 40
Avg # of users: 6.3
Avg Loss: 0.011506410283416209
Avg hit ratio: 0.8997073303983321
Avg ndcg: 0.9371439209402957
Avg compression ratio: 1.0
Avg train time: 2.9562955856323243
Std train time: 0.9150574097317266
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 2.8412}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0137, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9152, 'compress@10': 1.0, 'time@10': 2.8412}:  10%|█         | 1/10 [00:01<00:13,  1.46s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9408, 'compress@10': 1.0, 'time@10': 2.5853}:  10%|█         | 1/10 [00:03<00:13,  1.46s/it]{'epoch': 41, 'num_users': 7.0, 'loss': 0.0115, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9408, 'compress@10': 1.0, 'time@10': 2.5853}:  20%|██        | 2/10 [00:03<00:15,  2.00s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 2.3309}:  20%|██        | 2/10 [00:04<00:15,  2.00s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0077, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9129, 'compress@10': 1.0, 'time@10': 2.3309}:  30%|███       | 3/10 [00:04<00:10,  1.52s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9233, 'compress@10': 1.0, 'time@10': 2.2563}:  30%|███       | 3/10 [00:06<00:10,  1.52s/it]{'epoch': 41, 'num_users': 5.0, 'loss': 0.0101, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9233, 'compress@10': 1.0, 'time@10': 2.2563}:  40%|████      | 4/10 [00:06<00:10,  1.74s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9266, 'compress@10': 1.0, 'time@10': 2.7155}:  40%|████      | 4/10 [00:09<00:10,  1.74s/it]{'epoch': 41, 'num_users': 5.8, 'loss': 0.0108, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.9266, 'compress@10': 1.0, 'time@10': 2.7155}:  50%|█████     | 5/10 [00:09<00:09,  1.95s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9432, 'compress@10': 1.0, 'time@10': 2.8005}:  50%|█████     | 5/10 [00:12<00:09,  1.95s/it]{'epoch': 41, 'num_users': 6.1667, 'loss': 0.0147, 'hit_ratio@10': 0.8723, 'ndcg@10': 0.9432, 'compress@10': 1.0, 'time@10': 2.8005}:  60%|██████    | 6/10 [00:12<00:09,  2.40s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9435, 'compress@10': 1.0, 'time@10': 2.8946}:  60%|██████    | 6/10 [00:14<00:09,  2.40s/it]{'epoch': 41, 'num_users': 6.2857, 'loss': 0.0149, 'hit_ratio@10': 0.8848, 'ndcg@10': 0.9435, 'compress@10': 1.0, 'time@10': 2.8946}:  70%|███████   | 7/10 [00:14<00:06,  2.19s/it]{'epoch': 41, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.947, 'compress@10': 1.0, 'time@10': 2.8443}:  70%|███████   | 7/10 [00:16<00:06,  2.19s/it]  {'epoch': 41, 'num_users': 6.125, 'loss': 0.0143, 'hit_ratio@10': 0.8957, 'ndcg@10': 0.947, 'compress@10': 1.0, 'time@10': 2.8443}:  80%|████████  | 8/10 [00:16<00:04,  2.30s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9653, 'compress@10': 1.0, 'time@10': 3.0446}:  80%|████████  | 8/10 [00:19<00:04,  2.30s/it]{'epoch': 41, 'num_users': 6.3333, 'loss': 0.0159, 'hit_ratio@10': 0.8819, 'ndcg@10': 0.9653, 'compress@10': 1.0, 'time@10': 3.0446}:  90%|█████████ | 9/10 [00:19<00:02,  2.32s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9657, 'compress@10': 1.0, 'time@10': 3.055}:  90%|█████████ | 9/10 [00:22<00:02,  2.32s/it]    {'epoch': 41, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9657, 'compress@10': 1.0, 'time@10': 3.055}: 100%|██████████| 10/10 [00:22<00:00,  2.59s/it]{'epoch': 41, 'num_users': 6.3, 'loss': 0.0156, 'hit_ratio@10': 0.8914, 'ndcg@10': 0.9657, 'compress@10': 1.0, 'time@10': 3.055}: 100%|██████████| 10/10 [00:22<00:00,  2.23s/it]
Epoch: 41
Avg # of users: 6.3
Avg Loss: 0.015567393240773799
Avg hit ratio: 0.8914021588673542
Avg ndcg: 0.9657074293824126
Avg compression ratio: 1.0
Avg train time: 3.055049252510071
Std train time: 0.9182361326991813
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 3.045}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 3.045}:  10%|█         | 1/10 [00:01<00:14,  1.56s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0057, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9429, 'compress@10': 1.0, 'time@10': 2.6237}:  10%|█         | 1/10 [00:03<00:14,  1.56s/it]{'epoch': 42, 'num_users': 7.0, 'loss': 0.0057, 'hit_ratio@10': 0.9253, 'ndcg@10': 0.9429, 'compress@10': 1.0, 'time@10': 2.6237}:  20%|██        | 2/10 [00:03<00:15,  1.96s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0039, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 2.3199}:  20%|██        | 2/10 [00:04<00:15,  1.96s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0039, 'hit_ratio@10': 0.8073, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 2.3199}:  30%|███       | 3/10 [00:04<00:10,  1.47s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 2.2317}:  30%|███       | 3/10 [00:06<00:10,  1.47s/it]{'epoch': 42, 'num_users': 5.0, 'loss': 0.0063, 'hit_ratio@10': 0.8287, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 2.2317}:  40%|████      | 4/10 [00:06<00:10,  1.68s/it]{'epoch': 42, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.855, 'ndcg@10': 0.928, 'compress@10': 1.0, 'time@10': 2.6771}:  40%|████      | 4/10 [00:08<00:10,  1.68s/it]  {'epoch': 42, 'num_users': 5.8, 'loss': 0.0076, 'hit_ratio@10': 0.855, 'ndcg@10': 0.928, 'compress@10': 1.0, 'time@10': 2.6771}:  50%|█████     | 5/10 [00:08<00:09,  1.89s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9361, 'compress@10': 1.0, 'time@10': 2.804}:  50%|█████     | 5/10 [00:12<00:09,  1.89s/it]{'epoch': 42, 'num_users': 6.1667, 'loss': 0.0084, 'hit_ratio@10': 0.8717, 'ndcg@10': 0.9361, 'compress@10': 1.0, 'time@10': 2.804}:  60%|██████    | 6/10 [00:12<00:09,  2.43s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0074, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9393, 'compress@10': 1.0, 'time@10': 2.9016}:  60%|██████    | 6/10 [00:14<00:09,  2.43s/it]{'epoch': 42, 'num_users': 6.2857, 'loss': 0.0074, 'hit_ratio@10': 0.8843, 'ndcg@10': 0.9393, 'compress@10': 1.0, 'time@10': 2.9016}:  70%|███████   | 7/10 [00:14<00:06,  2.22s/it]{'epoch': 42, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 2.8437}:  70%|███████   | 7/10 [00:16<00:06,  2.22s/it] {'epoch': 42, 'num_users': 6.125, 'loss': 0.0116, 'hit_ratio@10': 0.8952, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 2.8437}:  80%|████████  | 8/10 [00:16<00:04,  2.30s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9478, 'compress@10': 1.0, 'time@10': 3.0318}:  80%|████████  | 8/10 [00:18<00:04,  2.30s/it]{'epoch': 42, 'num_users': 6.3333, 'loss': 0.0133, 'hit_ratio@10': 0.8847, 'ndcg@10': 0.9478, 'compress@10': 1.0, 'time@10': 3.0318}:  90%|█████████ | 9/10 [00:18<00:02,  2.30s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 3.0419}:  90%|█████████ | 9/10 [00:22<00:02,  2.30s/it]   {'epoch': 42, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 3.0419}: 100%|██████████| 10/10 [00:22<00:00,  2.57s/it]{'epoch': 42, 'num_users': 6.3, 'loss': 0.0138, 'hit_ratio@10': 0.8939, 'ndcg@10': 0.9518, 'compress@10': 1.0, 'time@10': 3.0419}: 100%|██████████| 10/10 [00:22<00:00,  2.22s/it]
Epoch: 42
Avg # of users: 6.3
Avg Loss: 0.013755807428883288
Avg hit ratio: 0.8939136796046814
Avg ndcg: 0.9518466661802251
Avg compression ratio: 1.0
Avg train time: 3.041925311088562
Std train time: 0.9271860078418165
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 2.7256}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0122, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 2.7256}:  10%|█         | 1/10 [00:01<00:12,  1.41s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 2.4553}:  10%|█         | 1/10 [00:03<00:12,  1.41s/it]{'epoch': 43, 'num_users': 7.0, 'loss': 0.0152, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 2.4553}:  20%|██        | 2/10 [00:03<00:15,  1.89s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 2.2086}:  20%|██        | 2/10 [00:04<00:15,  1.89s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.0102, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 2.2086}:  30%|███       | 3/10 [00:04<00:10,  1.43s/it]{'epoch': 43, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9282, 'compress@10': 1.0, 'time@10': 2.1268}:  30%|███       | 3/10 [00:06<00:10,  1.43s/it] {'epoch': 43, 'num_users': 5.0, 'loss': 0.011, 'hit_ratio@10': 0.8296, 'ndcg@10': 0.9282, 'compress@10': 1.0, 'time@10': 2.1268}:  40%|████      | 4/10 [00:06<00:09,  1.62s/it]{'epoch': 43, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.931, 'compress@10': 1.0, 'time@10': 2.573}:  40%|████      | 4/10 [00:08<00:09,  1.62s/it] {'epoch': 43, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8557, 'ndcg@10': 0.931, 'compress@10': 1.0, 'time@10': 2.573}:  50%|█████     | 5/10 [00:08<00:09,  1.84s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9385, 'compress@10': 1.0, 'time@10': 2.6828}:  50%|█████     | 5/10 [00:11<00:09,  1.84s/it]{'epoch': 43, 'num_users': 6.1667, 'loss': 0.0099, 'hit_ratio@10': 0.876, 'ndcg@10': 0.9385, 'compress@10': 1.0, 'time@10': 2.6828}:  60%|██████    | 6/10 [00:11<00:09,  2.32s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0098, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9413, 'compress@10': 1.0, 'time@10': 2.8004}:  60%|██████    | 6/10 [00:13<00:09,  2.32s/it]{'epoch': 43, 'num_users': 6.2857, 'loss': 0.0098, 'hit_ratio@10': 0.888, 'ndcg@10': 0.9413, 'compress@10': 1.0, 'time@10': 2.8004}:  70%|███████   | 7/10 [00:13<00:06,  2.16s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9377, 'compress@10': 1.0, 'time@10': 2.7589}:  70%|███████   | 7/10 [00:16<00:06,  2.16s/it]{'epoch': 43, 'num_users': 6.125, 'loss': 0.0106, 'hit_ratio@10': 0.8984, 'ndcg@10': 0.9377, 'compress@10': 1.0, 'time@10': 2.7589}:  80%|████████  | 8/10 [00:16<00:04,  2.27s/it]{'epoch': 43, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9534, 'compress@10': 1.0, 'time@10': 2.958}:  80%|████████  | 8/10 [00:18<00:04,  2.27s/it] {'epoch': 43, 'num_users': 6.3333, 'loss': 0.0124, 'hit_ratio@10': 0.878, 'ndcg@10': 0.9534, 'compress@10': 1.0, 'time@10': 2.958}:  90%|█████████ | 9/10 [00:18<00:02,  2.28s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9536, 'compress@10': 1.0, 'time@10': 2.9626}:  90%|█████████ | 9/10 [00:21<00:02,  2.28s/it]  {'epoch': 43, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9536, 'compress@10': 1.0, 'time@10': 2.9626}: 100%|██████████| 10/10 [00:21<00:00,  2.52s/it]{'epoch': 43, 'num_users': 6.3, 'loss': 0.013, 'hit_ratio@10': 0.8879, 'ndcg@10': 0.9536, 'compress@10': 1.0, 'time@10': 2.9626}: 100%|██████████| 10/10 [00:21<00:00,  2.16s/it]
Epoch: 43
Avg # of users: 6.3
Avg Loss: 0.01301112985584738
Avg hit ratio: 0.8879100953752908
Avg ndcg: 0.9536071827137181
Avg compression ratio: 1.0
Avg train time: 2.9625605821609495
Std train time: 0.9202636324979305
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 2.6545}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0104, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9194, 'compress@10': 1.0, 'time@10': 2.6545}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9555, 'compress@10': 1.0, 'time@10': 2.4434}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it]{'epoch': 44, 'num_users': 7.0, 'loss': 0.0114, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9555, 'compress@10': 1.0, 'time@10': 2.4434}:  20%|██        | 2/10 [00:03<00:15,  1.90s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9227, 'compress@10': 1.0, 'time@10': 2.2308}:  20%|██        | 2/10 [00:04<00:15,  1.90s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0076, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9227, 'compress@10': 1.0, 'time@10': 2.2308}:  30%|███       | 3/10 [00:04<00:10,  1.46s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9316, 'compress@10': 1.0, 'time@10': 2.1544}:  30%|███       | 3/10 [00:06<00:10,  1.46s/it]{'epoch': 44, 'num_users': 5.0, 'loss': 0.0091, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9316, 'compress@10': 1.0, 'time@10': 2.1544}:  40%|████      | 4/10 [00:06<00:09,  1.66s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9348, 'compress@10': 1.0, 'time@10': 2.6162}:  40%|████      | 4/10 [00:08<00:09,  1.66s/it]{'epoch': 44, 'num_users': 5.8, 'loss': 0.0096, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9348, 'compress@10': 1.0, 'time@10': 2.6162}:  50%|█████     | 5/10 [00:08<00:09,  1.88s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 2.7151}:  50%|█████     | 5/10 [00:12<00:09,  1.88s/it]{'epoch': 44, 'num_users': 6.1667, 'loss': 0.0134, 'hit_ratio@10': 0.8556, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 2.7151}:  60%|██████    | 6/10 [00:12<00:09,  2.34s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9533, 'compress@10': 1.0, 'time@10': 2.8372}:  60%|██████    | 6/10 [00:13<00:09,  2.34s/it]{'epoch': 44, 'num_users': 6.2857, 'loss': 0.0137, 'hit_ratio@10': 0.8705, 'ndcg@10': 0.9533, 'compress@10': 1.0, 'time@10': 2.8372}:  70%|███████   | 7/10 [00:13<00:06,  2.17s/it]{'epoch': 44, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9569, 'compress@10': 1.0, 'time@10': 2.783}:  70%|███████   | 7/10 [00:16<00:06,  2.17s/it]  {'epoch': 44, 'num_users': 6.125, 'loss': 0.0134, 'hit_ratio@10': 0.8831, 'ndcg@10': 0.9569, 'compress@10': 1.0, 'time@10': 2.783}:  80%|████████  | 8/10 [00:16<00:04,  2.26s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9564, 'compress@10': 1.0, 'time@10': 2.9887}:  80%|████████  | 8/10 [00:18<00:04,  2.26s/it]{'epoch': 44, 'num_users': 6.3333, 'loss': 0.0141, 'hit_ratio@10': 0.8771, 'ndcg@10': 0.9564, 'compress@10': 1.0, 'time@10': 2.9887}:  90%|█████████ | 9/10 [00:18<00:02,  2.29s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9584, 'compress@10': 1.0, 'time@10': 3.0266}:  90%|█████████ | 9/10 [00:22<00:02,  2.29s/it]   {'epoch': 44, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9584, 'compress@10': 1.0, 'time@10': 3.0266}: 100%|██████████| 10/10 [00:22<00:00,  2.64s/it]{'epoch': 44, 'num_users': 6.3, 'loss': 0.0131, 'hit_ratio@10': 0.8871, 'ndcg@10': 0.9584, 'compress@10': 1.0, 'time@10': 3.0266}: 100%|██████████| 10/10 [00:22<00:00,  2.21s/it]
Epoch: 44
Avg # of users: 6.3
Avg Loss: 0.01305331666931736
Avg hit ratio: 0.8870934031069855
Avg ndcg: 0.9584484076388172
Avg compression ratio: 1.0
Avg train time: 3.0266035318374636
Std train time: 0.9465394515166246
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 2.8214}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0103, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9181, 'compress@10': 1.0, 'time@10': 2.8214}:  10%|█         | 1/10 [00:01<00:13,  1.45s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9429, 'compress@10': 1.0, 'time@10': 2.5261}:  10%|█         | 1/10 [00:03<00:13,  1.45s/it]{'epoch': 45, 'num_users': 7.0, 'loss': 0.0062, 'hit_ratio@10': 0.9414, 'ndcg@10': 0.9429, 'compress@10': 1.0, 'time@10': 2.5261}:  20%|██        | 2/10 [00:03<00:15,  1.93s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 2.2555}:  20%|██        | 2/10 [00:04<00:15,  1.93s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0042, 'hit_ratio@10': 0.8657, 'ndcg@10': 0.9143, 'compress@10': 1.0, 'time@10': 2.2555}:  30%|███       | 3/10 [00:04<00:10,  1.46s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 2.1609}:  30%|███       | 3/10 [00:06<00:10,  1.46s/it]{'epoch': 45, 'num_users': 5.0, 'loss': 0.0067, 'hit_ratio@10': 0.8725, 'ndcg@10': 0.9249, 'compress@10': 1.0, 'time@10': 2.1609}:  40%|████      | 4/10 [00:06<00:09,  1.64s/it]{'epoch': 45, 'num_users': 5.8, 'loss': 0.0078, 'hit_ratio@10': 0.89, 'ndcg@10': 0.93, 'compress@10': 1.0, 'time@10': 2.5839}:  40%|████      | 4/10 [00:08<00:09,  1.64s/it]    {'epoch': 45, 'num_users': 5.8, 'loss': 0.0078, 'hit_ratio@10': 0.89, 'ndcg@10': 0.93, 'compress@10': 1.0, 'time@10': 2.5839}:  50%|█████     | 5/10 [00:08<00:09,  1.83s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9377, 'compress@10': 1.0, 'time@10': 2.6953}:  50%|█████     | 5/10 [00:11<00:09,  1.83s/it]{'epoch': 45, 'num_users': 6.1667, 'loss': 0.0087, 'hit_ratio@10': 0.8972, 'ndcg@10': 0.9377, 'compress@10': 1.0, 'time@10': 2.6953}:  60%|██████    | 6/10 [00:11<00:09,  2.33s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9386, 'compress@10': 1.0, 'time@10': 2.8193}:  60%|██████    | 6/10 [00:13<00:09,  2.33s/it]{'epoch': 45, 'num_users': 6.2857, 'loss': 0.0102, 'hit_ratio@10': 0.9062, 'ndcg@10': 0.9386, 'compress@10': 1.0, 'time@10': 2.8193}:  70%|███████   | 7/10 [00:13<00:06,  2.16s/it]{'epoch': 45, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9557, 'compress@10': 1.0, 'time@10': 2.7866}:  70%|███████   | 7/10 [00:16<00:06,  2.16s/it] {'epoch': 45, 'num_users': 6.125, 'loss': 0.0122, 'hit_ratio@10': 0.9143, 'ndcg@10': 0.9557, 'compress@10': 1.0, 'time@10': 2.7866}:  80%|████████  | 8/10 [00:16<00:04,  2.30s/it]{'epoch': 45, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.97, 'compress@10': 1.0, 'time@10': 2.9893}:  80%|████████  | 8/10 [00:18<00:04,  2.30s/it] {'epoch': 45, 'num_users': 6.3333, 'loss': 0.0139, 'hit_ratio@10': 0.8953, 'ndcg@10': 0.97, 'compress@10': 1.0, 'time@10': 2.9893}:  90%|█████████ | 9/10 [00:18<00:02,  2.31s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9697, 'compress@10': 1.0, 'time@10': 3.0009}:  90%|█████████ | 9/10 [00:21<00:02,  2.31s/it] {'epoch': 45, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9697, 'compress@10': 1.0, 'time@10': 3.0009}: 100%|██████████| 10/10 [00:21<00:00,  2.57s/it]{'epoch': 45, 'num_users': 6.3, 'loss': 0.0152, 'hit_ratio@10': 0.9035, 'ndcg@10': 0.9697, 'compress@10': 1.0, 'time@10': 3.0009}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 45
Avg # of users: 6.3
Avg Loss: 0.015230892478834968
Avg hit ratio: 0.9034886924055006
Avg ndcg: 0.969680400137053
Avg compression ratio: 1.0
Avg train time: 3.0008678436279297
Std train time: 0.9136993944047549
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 1.0, 'time@10': 2.7475}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9222, 'compress@10': 1.0, 'time@10': 2.7475}:  10%|█         | 1/10 [00:01<00:12,  1.41s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9572, 'compress@10': 1.0, 'time@10': 2.4934}:  10%|█         | 1/10 [00:03<00:12,  1.41s/it]{'epoch': 46, 'num_users': 7.0, 'loss': 0.0157, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9572, 'compress@10': 1.0, 'time@10': 2.4934}:  20%|██        | 2/10 [00:03<00:15,  1.92s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9238, 'compress@10': 1.0, 'time@10': 2.2773}:  20%|██        | 2/10 [00:04<00:15,  1.92s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0105, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9238, 'compress@10': 1.0, 'time@10': 2.2773}:  30%|███       | 3/10 [00:04<00:10,  1.48s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 2.1865}:  30%|███       | 3/10 [00:06<00:10,  1.48s/it]{'epoch': 46, 'num_users': 5.0, 'loss': 0.0115, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9325, 'compress@10': 1.0, 'time@10': 2.1865}:  40%|████      | 4/10 [00:06<00:10,  1.67s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9372, 'compress@10': 1.0, 'time@10': 2.6181}:  40%|████      | 4/10 [00:08<00:10,  1.67s/it]{'epoch': 46, 'num_users': 5.8, 'loss': 0.0113, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9372, 'compress@10': 1.0, 'time@10': 2.6181}:  50%|█████     | 5/10 [00:08<00:09,  1.86s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9437, 'compress@10': 1.0, 'time@10': 2.7246}:  50%|█████     | 5/10 [00:12<00:09,  1.86s/it]{'epoch': 46, 'num_users': 6.1667, 'loss': 0.0097, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9437, 'compress@10': 1.0, 'time@10': 2.7246}:  60%|██████    | 6/10 [00:12<00:09,  2.35s/it]{'epoch': 46, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.946, 'compress@10': 1.0, 'time@10': 2.8405}:  60%|██████    | 6/10 [00:13<00:09,  2.35s/it] {'epoch': 46, 'num_users': 6.2857, 'loss': 0.0086, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.946, 'compress@10': 1.0, 'time@10': 2.8405}:  70%|███████   | 7/10 [00:13<00:06,  2.17s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0084, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9483, 'compress@10': 1.0, 'time@10': 2.7945}:  70%|███████   | 7/10 [00:16<00:06,  2.17s/it]{'epoch': 46, 'num_users': 6.125, 'loss': 0.0084, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9483, 'compress@10': 1.0, 'time@10': 2.7945}:  80%|████████  | 8/10 [00:16<00:04,  2.28s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0098, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 2.9789}:  80%|████████  | 8/10 [00:18<00:04,  2.28s/it]{'epoch': 46, 'num_users': 6.3333, 'loss': 0.0098, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9487, 'compress@10': 1.0, 'time@10': 2.9789}:  90%|█████████ | 9/10 [00:18<00:02,  2.28s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0091, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 2.9979}:  90%|█████████ | 9/10 [00:21<00:02,  2.28s/it]   {'epoch': 46, 'num_users': 6.3, 'loss': 0.0091, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 2.9979}: 100%|██████████| 10/10 [00:21<00:00,  2.56s/it]{'epoch': 46, 'num_users': 6.3, 'loss': 0.0091, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9516, 'compress@10': 1.0, 'time@10': 2.9979}: 100%|██████████| 10/10 [00:21<00:00,  2.19s/it]
Epoch: 46
Avg # of users: 6.3
Avg Loss: 0.009148024656505873
Avg hit ratio: 0.8935450160102112
Avg ndcg: 0.9515548754537514
Avg compression ratio: 1.0
Avg train time: 2.9979132175445558
Std train time: 0.8796921517682653
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9248, 'compress@10': 1.0, 'time@10': 2.7162}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0096, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9248, 'compress@10': 1.0, 'time@10': 2.7162}:  10%|█         | 1/10 [00:01<00:12,  1.39s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9606, 'compress@10': 1.0, 'time@10': 2.4695}:  10%|█         | 1/10 [00:03<00:12,  1.39s/it]{'epoch': 47, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.8769, 'ndcg@10': 0.9606, 'compress@10': 1.0, 'time@10': 2.4695}:  20%|██        | 2/10 [00:03<00:15,  1.91s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9261, 'compress@10': 1.0, 'time@10': 2.2514}:  20%|██        | 2/10 [00:04<00:15,  1.91s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0103, 'hit_ratio@10': 0.7751, 'ndcg@10': 0.9261, 'compress@10': 1.0, 'time@10': 2.2514}:  30%|███       | 3/10 [00:04<00:10,  1.47s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9342, 'compress@10': 1.0, 'time@10': 2.1759}:  30%|███       | 3/10 [00:06<00:10,  1.47s/it]{'epoch': 47, 'num_users': 5.0, 'loss': 0.0112, 'hit_ratio@10': 0.8045, 'ndcg@10': 0.9342, 'compress@10': 1.0, 'time@10': 2.1759}:  40%|████      | 4/10 [00:06<00:10,  1.67s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9388, 'compress@10': 1.0, 'time@10': 2.6577}:  40%|████      | 4/10 [00:08<00:10,  1.67s/it]{'epoch': 47, 'num_users': 5.8, 'loss': 0.0114, 'hit_ratio@10': 0.8356, 'ndcg@10': 0.9388, 'compress@10': 1.0, 'time@10': 2.6577}:  50%|█████     | 5/10 [00:08<00:09,  1.91s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9467, 'compress@10': 1.0, 'time@10': 2.761}:  50%|█████     | 5/10 [00:12<00:09,  1.91s/it]{'epoch': 47, 'num_users': 6.1667, 'loss': 0.0144, 'hit_ratio@10': 0.8593, 'ndcg@10': 0.9467, 'compress@10': 1.0, 'time@10': 2.761}:  60%|██████    | 6/10 [00:12<00:09,  2.39s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 2.8764}:  60%|██████    | 6/10 [00:14<00:09,  2.39s/it]{'epoch': 47, 'num_users': 6.2857, 'loss': 0.0138, 'hit_ratio@10': 0.8737, 'ndcg@10': 0.9486, 'compress@10': 1.0, 'time@10': 2.8764}:  70%|███████   | 7/10 [00:14<00:06,  2.20s/it]{'epoch': 47, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9513, 'compress@10': 1.0, 'time@10': 2.8258}:  70%|███████   | 7/10 [00:16<00:06,  2.20s/it] {'epoch': 47, 'num_users': 6.125, 'loss': 0.0126, 'hit_ratio@10': 0.8859, 'ndcg@10': 0.9513, 'compress@10': 1.0, 'time@10': 2.8258}:  80%|████████  | 8/10 [00:16<00:04,  2.30s/it]{'epoch': 47, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9659, 'compress@10': 1.0, 'time@10': 3.0564}:  80%|████████  | 8/10 [00:19<00:04,  2.30s/it]  {'epoch': 47, 'num_users': 6.3333, 'loss': 0.014, 'hit_ratio@10': 0.87, 'ndcg@10': 0.9659, 'compress@10': 1.0, 'time@10': 3.0564}:  90%|█████████ | 9/10 [00:19<00:02,  2.36s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9646, 'compress@10': 1.0, 'time@10': 3.0641}:  90%|█████████ | 9/10 [00:22<00:02,  2.36s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9646, 'compress@10': 1.0, 'time@10': 3.0641}: 100%|██████████| 10/10 [00:22<00:00,  2.61s/it]{'epoch': 47, 'num_users': 6.3, 'loss': 0.0155, 'hit_ratio@10': 0.8807, 'ndcg@10': 0.9646, 'compress@10': 1.0, 'time@10': 3.0641}: 100%|██████████| 10/10 [00:22<00:00,  2.22s/it]
Epoch: 47
Avg # of users: 6.3
Avg Loss: 0.015460999789866875
Avg hit ratio: 0.8807441967577792
Avg ndcg: 0.9645781375597284
Avg compression ratio: 1.0
Avg train time: 3.06408805847168
Std train time: 0.9986735744762563
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 1.0, 'time@10': 2.6573}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0086, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9266, 'compress@10': 1.0, 'time@10': 2.6573}:  10%|█         | 1/10 [00:01<00:12,  1.36s/it]{'epoch': 48, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 1.0, 'time@10': 2.422}:  10%|█         | 1/10 [00:03<00:12,  1.36s/it] {'epoch': 48, 'num_users': 7.0, 'loss': 0.0099, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9453, 'compress@10': 1.0, 'time@10': 2.422}:  20%|██        | 2/10 [00:03<00:14,  1.87s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 2.2023}:  20%|██        | 2/10 [00:04<00:14,  1.87s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.0066, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9159, 'compress@10': 1.0, 'time@10': 2.2023}:  30%|███       | 3/10 [00:04<00:10,  1.43s/it]{'epoch': 48, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 2.1419}:  30%|███       | 3/10 [00:06<00:10,  1.43s/it] {'epoch': 48, 'num_users': 5.0, 'loss': 0.008, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9272, 'compress@10': 1.0, 'time@10': 2.1419}:  40%|████      | 4/10 [00:06<00:09,  1.66s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9336, 'compress@10': 1.0, 'time@10': 2.6277}:  40%|████      | 4/10 [00:08<00:09,  1.66s/it]{'epoch': 48, 'num_users': 5.8, 'loss': 0.0086, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9336, 'compress@10': 1.0, 'time@10': 2.6277}:  50%|█████     | 5/10 [00:08<00:09,  1.90s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9426, 'compress@10': 1.0, 'time@10': 2.753}:  50%|█████     | 5/10 [00:12<00:09,  1.90s/it]{'epoch': 48, 'num_users': 6.1667, 'loss': 0.0102, 'hit_ratio@10': 0.8664, 'ndcg@10': 0.9426, 'compress@10': 1.0, 'time@10': 2.753}:  60%|██████    | 6/10 [00:12<00:09,  2.42s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9451, 'compress@10': 1.0, 'time@10': 2.8583}:  60%|██████    | 6/10 [00:14<00:09,  2.42s/it]{'epoch': 48, 'num_users': 6.2857, 'loss': 0.0099, 'hit_ratio@10': 0.8797, 'ndcg@10': 0.9451, 'compress@10': 1.0, 'time@10': 2.8583}:  70%|███████   | 7/10 [00:14<00:06,  2.21s/it]{'epoch': 48, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9494, 'compress@10': 1.0, 'time@10': 2.8067}:  70%|███████   | 7/10 [00:16<00:06,  2.21s/it] {'epoch': 48, 'num_users': 6.125, 'loss': 0.0113, 'hit_ratio@10': 0.8912, 'ndcg@10': 0.9494, 'compress@10': 1.0, 'time@10': 2.8067}:  80%|████████  | 8/10 [00:16<00:04,  2.30s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 3.0006}:  80%|████████  | 8/10 [00:18<00:04,  2.30s/it]{'epoch': 48, 'num_users': 6.3333, 'loss': 0.0123, 'hit_ratio@10': 0.8842, 'ndcg@10': 0.9497, 'compress@10': 1.0, 'time@10': 3.0006}:  90%|█████████ | 9/10 [00:18<00:02,  2.30s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9525, 'compress@10': 1.0, 'time@10': 3.0287}:  90%|█████████ | 9/10 [00:22<00:02,  2.30s/it]   {'epoch': 48, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9525, 'compress@10': 1.0, 'time@10': 3.0287}: 100%|██████████| 10/10 [00:22<00:00,  2.61s/it]{'epoch': 48, 'num_users': 6.3, 'loss': 0.0115, 'hit_ratio@10': 0.8935, 'ndcg@10': 0.9525, 'compress@10': 1.0, 'time@10': 3.0287}: 100%|██████████| 10/10 [00:22<00:00,  2.21s/it]
Epoch: 48
Avg # of users: 6.3
Avg Loss: 0.011492343747807577
Avg hit ratio: 0.8935450160102112
Avg ndcg: 0.9524568845083257
Avg compression ratio: 1.0
Avg train time: 3.0287408113479612
Std train time: 0.9501447874868999
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
  0%|          | 0/10 [00:00<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9312, 'compress@10': 1.0, 'time@10': 2.5495}:   0%|          | 0/10 [00:01<?, ?it/s]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0087, 'hit_ratio@10': 0.9474, 'ndcg@10': 0.9312, 'compress@10': 1.0, 'time@10': 2.5495}:  10%|█         | 1/10 [00:01<00:11,  1.31s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9745, 'compress@10': 1.0, 'time@10': 2.3511}:  10%|█         | 1/10 [00:03<00:11,  1.31s/it]{'epoch': 49, 'num_users': 7.0, 'loss': 0.0155, 'hit_ratio@10': 0.9092, 'ndcg@10': 0.9745, 'compress@10': 1.0, 'time@10': 2.3511}:  20%|██        | 2/10 [00:03<00:14,  1.83s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9354, 'compress@10': 1.0, 'time@10': 2.1327}:  20%|██        | 2/10 [00:04<00:14,  1.83s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0104, 'hit_ratio@10': 0.7966, 'ndcg@10': 0.9354, 'compress@10': 1.0, 'time@10': 2.1327}:  30%|███       | 3/10 [00:04<00:09,  1.40s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9421, 'compress@10': 1.0, 'time@10': 2.0815}:  30%|███       | 3/10 [00:06<00:09,  1.40s/it]{'epoch': 49, 'num_users': 5.0, 'loss': 0.0106, 'hit_ratio@10': 0.8207, 'ndcg@10': 0.9421, 'compress@10': 1.0, 'time@10': 2.0815}:  40%|████      | 4/10 [00:06<00:09,  1.62s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9462, 'compress@10': 1.0, 'time@10': 2.5373}:  40%|████      | 4/10 [00:08<00:09,  1.62s/it]{'epoch': 49, 'num_users': 5.8, 'loss': 0.0106, 'hit_ratio@10': 0.8485, 'ndcg@10': 0.9462, 'compress@10': 1.0, 'time@10': 2.5373}:  50%|█████     | 5/10 [00:08<00:09,  1.84s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9511, 'compress@10': 1.0, 'time@10': 2.6709}:  50%|█████     | 5/10 [00:11<00:09,  1.84s/it]{'epoch': 49, 'num_users': 6.1667, 'loss': 0.0092, 'hit_ratio@10': 0.8701, 'ndcg@10': 0.9511, 'compress@10': 1.0, 'time@10': 2.6709}:  60%|██████    | 6/10 [00:11<00:09,  2.36s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9553, 'compress@10': 1.0, 'time@10': 2.8279}:  60%|██████    | 6/10 [00:13<00:09,  2.36s/it]{'epoch': 49, 'num_users': 6.2857, 'loss': 0.0103, 'hit_ratio@10': 0.8829, 'ndcg@10': 0.9553, 'compress@10': 1.0, 'time@10': 2.8279}:  70%|███████   | 7/10 [00:13<00:06,  2.22s/it]{'epoch': 49, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9563, 'compress@10': 1.0, 'time@10': 2.7797}:  70%|███████   | 7/10 [00:16<00:06,  2.22s/it]  {'epoch': 49, 'num_users': 6.125, 'loss': 0.0104, 'hit_ratio@10': 0.894, 'ndcg@10': 0.9563, 'compress@10': 1.0, 'time@10': 2.7797}:  80%|████████  | 8/10 [00:16<00:04,  2.30s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9712, 'compress@10': 1.0, 'time@10': 2.9758}:  80%|████████  | 8/10 [00:18<00:04,  2.30s/it]{'epoch': 49, 'num_users': 6.3333, 'loss': 0.0121, 'hit_ratio@10': 0.8835, 'ndcg@10': 0.9712, 'compress@10': 1.0, 'time@10': 2.9758}:  90%|█████████ | 9/10 [00:18<00:02,  2.30s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9716, 'compress@10': 1.0, 'time@10': 2.9889}:  90%|█████████ | 9/10 [00:21<00:02,  2.30s/it]   {'epoch': 49, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9716, 'compress@10': 1.0, 'time@10': 2.9889}: 100%|██████████| 10/10 [00:21<00:00,  2.56s/it]{'epoch': 49, 'num_users': 6.3, 'loss': 0.0136, 'hit_ratio@10': 0.8929, 'ndcg@10': 0.9716, 'compress@10': 1.0, 'time@10': 2.9889}: 100%|██████████| 10/10 [00:21<00:00,  2.18s/it]
Epoch: 49
Avg # of users: 6.3
Avg Loss: 0.013637242489366968
Avg hit ratio: 0.8929100953752906
Avg ndcg: 0.9715754606959577
Avg compression ratio: 1.0
Avg train time: 2.988874816894531
Std train time: 0.9507185238343324
[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
[10, 10, 21, 10, 6, 10, 10, 10, 9, 10]
